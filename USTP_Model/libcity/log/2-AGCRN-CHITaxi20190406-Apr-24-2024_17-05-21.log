2024-04-24 17:05:21,945 - INFO - Log directory: ./libcity/log
2024-04-24 17:05:21,945 - INFO - Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=2
2024-04-24 17:05:21,945 - INFO - {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 489935582, 'exp_id': 2, 'max_epoch': 200, 'patience': 15, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cache_dataset': False, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-24 17:05:21,945 - INFO - Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-24 17:05:21,945 - INFO - set_weight_link_or_dist: dist
2024-04-24 17:05:21,945 - INFO - init_weight_inf_or_zero: inf
2024-04-24 17:05:21,960 - INFO - Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-24 17:05:21,960 - INFO - Start Calculate the weight by Gauss kernel!
2024-04-24 17:05:21,960 - INFO - Loading file CHITaxi20190406.dyna
2024-04-24 17:05:22,085 - INFO - Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-24 17:05:22,210 - INFO - Dataset created
2024-04-24 17:05:22,210 - INFO - x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-04-24 17:05:22,210 - INFO - train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-04-24 17:05:22,210 - INFO - eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-04-24 17:05:22,210 - INFO - test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-04-24 17:05:22,241 - INFO - StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-24 17:05:22,241 - INFO - NoneScaler
2024-04-24 17:05:22,366 - INFO - AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-24 17:05:22,366 - INFO - node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-24 17:05:22,366 - INFO - encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-04-24 17:05:22,366 - INFO - encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 17:05:22,366 - INFO - encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-04-24 17:05:22,366 - INFO - encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 17:05:22,366 - INFO - encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-24 17:05:22,366 - INFO - encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 17:05:22,366 - INFO - encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-24 17:05:22,366 - INFO - encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 17:05:22,366 - INFO - end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-24 17:05:22,366 - INFO - end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-24 17:05:22,366 - INFO - Total parameter numbers: 751130
2024-04-24 17:05:22,366 - INFO - You select `adam` optimizer.
2024-04-24 17:05:22,366 - WARNING - Received none train loss func and will use the loss func defined in the model.
2024-04-24 17:05:22,366 - INFO - Start training ...
2024-04-24 17:05:22,366 - INFO - num_batches:48
2024-04-24 17:05:26,630 - INFO - epoch complete!
2024-04-24 17:05:26,630 - INFO - evaluating now!
2024-04-24 17:05:26,849 - INFO - Epoch [0/200] train_loss: 24.3097, val_loss: 17.0231, lr: 0.003000, 4.48s
2024-04-24 17:05:26,864 - INFO - Saved model at 0
2024-04-24 17:05:26,864 - INFO - Val loss decrease from inf to 17.0231, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-24 17:05:31,092 - INFO - epoch complete!
2024-04-24 17:05:31,092 - INFO - evaluating now!
2024-04-24 17:05:31,311 - INFO - Epoch [1/200] train_loss: 13.3683, val_loss: 12.1201, lr: 0.003000, 4.45s
2024-04-24 17:05:31,326 - INFO - Saved model at 1
2024-04-24 17:05:31,326 - INFO - Val loss decrease from 17.0231 to 12.1201, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-24 17:05:35,546 - INFO - epoch complete!
2024-04-24 17:05:35,546 - INFO - evaluating now!
2024-04-24 17:05:35,749 - INFO - Epoch [2/200] train_loss: 10.0454, val_loss: 9.5780, lr: 0.003000, 4.42s
2024-04-24 17:05:35,765 - INFO - Saved model at 2
2024-04-24 17:05:35,765 - INFO - Val loss decrease from 12.1201 to 9.5780, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-24 17:05:40,052 - INFO - epoch complete!
2024-04-24 17:05:40,052 - INFO - evaluating now!
2024-04-24 17:05:40,270 - INFO - Epoch [3/200] train_loss: 8.2480, val_loss: 8.0120, lr: 0.003000, 4.50s
2024-04-24 17:05:40,285 - INFO - Saved model at 3
2024-04-24 17:05:40,285 - INFO - Val loss decrease from 9.5780 to 8.0120, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-24 17:05:44,538 - INFO - epoch complete!
2024-04-24 17:05:44,538 - INFO - evaluating now!
2024-04-24 17:05:44,757 - INFO - Epoch [4/200] train_loss: 7.3068, val_loss: 7.1825, lr: 0.003000, 4.47s
2024-04-24 17:05:44,772 - INFO - Saved model at 4
2024-04-24 17:05:44,772 - INFO - Val loss decrease from 8.0120 to 7.1825, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-24 17:05:48,964 - INFO - epoch complete!
2024-04-24 17:05:48,964 - INFO - evaluating now!
2024-04-24 17:05:49,183 - INFO - Epoch [5/200] train_loss: 6.7423, val_loss: 6.6705, lr: 0.003000, 4.41s
2024-04-24 17:05:49,199 - INFO - Saved model at 5
2024-04-24 17:05:49,199 - INFO - Val loss decrease from 7.1825 to 6.6705, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-24 17:05:53,417 - INFO - epoch complete!
2024-04-24 17:05:53,417 - INFO - evaluating now!
2024-04-24 17:05:53,652 - INFO - Epoch [6/200] train_loss: 6.2508, val_loss: 6.2477, lr: 0.003000, 4.45s
2024-04-24 17:05:53,668 - INFO - Saved model at 6
2024-04-24 17:05:53,668 - INFO - Val loss decrease from 6.6705 to 6.2477, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-24 17:05:57,935 - INFO - epoch complete!
2024-04-24 17:05:57,935 - INFO - evaluating now!
2024-04-24 17:05:58,154 - INFO - Epoch [7/200] train_loss: 6.0337, val_loss: 6.1599, lr: 0.003000, 4.49s
2024-04-24 17:05:58,170 - INFO - Saved model at 7
2024-04-24 17:05:58,170 - INFO - Val loss decrease from 6.2477 to 6.1599, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-24 17:06:02,374 - INFO - epoch complete!
2024-04-24 17:06:02,374 - INFO - evaluating now!
2024-04-24 17:06:02,608 - INFO - Epoch [8/200] train_loss: 5.7257, val_loss: 5.8622, lr: 0.003000, 4.44s
2024-04-24 17:06:02,608 - INFO - Saved model at 8
2024-04-24 17:06:02,608 - INFO - Val loss decrease from 6.1599 to 5.8622, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-24 17:06:06,858 - INFO - epoch complete!
2024-04-24 17:06:06,858 - INFO - evaluating now!
2024-04-24 17:06:07,061 - INFO - Epoch [9/200] train_loss: 5.5518, val_loss: 5.7285, lr: 0.003000, 4.45s
2024-04-24 17:06:07,076 - INFO - Saved model at 9
2024-04-24 17:06:07,076 - INFO - Val loss decrease from 5.8622 to 5.7285, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-24 17:06:11,359 - INFO - epoch complete!
2024-04-24 17:06:11,359 - INFO - evaluating now!
2024-04-24 17:06:11,562 - INFO - Epoch [10/200] train_loss: 5.3868, val_loss: 5.6644, lr: 0.003000, 4.49s
2024-04-24 17:06:11,577 - INFO - Saved model at 10
2024-04-24 17:06:11,577 - INFO - Val loss decrease from 5.7285 to 5.6644, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-24 17:06:15,826 - INFO - epoch complete!
2024-04-24 17:06:15,826 - INFO - evaluating now!
2024-04-24 17:06:16,059 - INFO - Epoch [11/200] train_loss: 5.2808, val_loss: 5.5072, lr: 0.003000, 4.48s
2024-04-24 17:06:16,070 - INFO - Saved model at 11
2024-04-24 17:06:16,070 - INFO - Val loss decrease from 5.6644 to 5.5072, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-24 17:06:20,271 - INFO - epoch complete!
2024-04-24 17:06:20,271 - INFO - evaluating now!
2024-04-24 17:06:20,522 - INFO - Epoch [12/200] train_loss: 5.1707, val_loss: 5.4597, lr: 0.003000, 4.45s
2024-04-24 17:06:20,538 - INFO - Saved model at 12
2024-04-24 17:06:20,538 - INFO - Val loss decrease from 5.5072 to 5.4597, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-24 17:06:25,003 - INFO - epoch complete!
2024-04-24 17:06:25,003 - INFO - evaluating now!
2024-04-24 17:06:25,297 - INFO - Epoch [13/200] train_loss: 5.0687, val_loss: 5.5582, lr: 0.003000, 4.76s
2024-04-24 17:06:29,791 - INFO - epoch complete!
2024-04-24 17:06:29,791 - INFO - evaluating now!
2024-04-24 17:06:30,047 - INFO - Epoch [14/200] train_loss: 5.0478, val_loss: 5.6511, lr: 0.003000, 4.75s
2024-04-24 17:06:34,537 - INFO - epoch complete!
2024-04-24 17:06:34,537 - INFO - evaluating now!
2024-04-24 17:06:34,794 - INFO - Epoch [15/200] train_loss: 4.9255, val_loss: 5.4371, lr: 0.003000, 4.75s
2024-04-24 17:06:34,810 - INFO - Saved model at 15
2024-04-24 17:06:34,810 - INFO - Val loss decrease from 5.4597 to 5.4371, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-24 17:06:39,205 - INFO - epoch complete!
2024-04-24 17:06:39,205 - INFO - evaluating now!
2024-04-24 17:06:39,437 - INFO - Epoch [16/200] train_loss: 4.7539, val_loss: 5.2147, lr: 0.003000, 4.63s
2024-04-24 17:06:39,454 - INFO - Saved model at 16
2024-04-24 17:06:39,454 - INFO - Val loss decrease from 5.4371 to 5.2147, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-24 17:06:43,871 - INFO - epoch complete!
2024-04-24 17:06:43,871 - INFO - evaluating now!
2024-04-24 17:06:44,090 - INFO - Epoch [17/200] train_loss: 4.8111, val_loss: 5.3344, lr: 0.003000, 4.64s
2024-04-24 17:06:48,499 - INFO - epoch complete!
2024-04-24 17:06:48,499 - INFO - evaluating now!
2024-04-24 17:06:48,718 - INFO - Epoch [18/200] train_loss: 4.6873, val_loss: 5.3465, lr: 0.003000, 4.63s
2024-04-24 17:06:53,101 - INFO - epoch complete!
2024-04-24 17:06:53,101 - INFO - evaluating now!
2024-04-24 17:06:53,335 - INFO - Epoch [19/200] train_loss: 4.5994, val_loss: 5.4380, lr: 0.003000, 4.62s
2024-04-24 17:06:57,899 - INFO - epoch complete!
2024-04-24 17:06:57,899 - INFO - evaluating now!
2024-04-24 17:06:58,180 - INFO - Epoch [20/200] train_loss: 4.5823, val_loss: 5.1773, lr: 0.003000, 4.85s
2024-04-24 17:06:58,196 - INFO - Saved model at 20
2024-04-24 17:06:58,196 - INFO - Val loss decrease from 5.2147 to 5.1773, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-24 17:07:03,309 - INFO - epoch complete!
2024-04-24 17:07:03,309 - INFO - evaluating now!
2024-04-24 17:07:03,527 - INFO - Epoch [21/200] train_loss: 4.5541, val_loss: 5.2996, lr: 0.003000, 5.33s
2024-04-24 17:07:07,778 - INFO - epoch complete!
2024-04-24 17:07:07,778 - INFO - evaluating now!
2024-04-24 17:07:07,998 - INFO - Epoch [22/200] train_loss: 4.5228, val_loss: 5.2071, lr: 0.003000, 4.47s
2024-04-24 17:07:12,264 - INFO - epoch complete!
2024-04-24 17:07:12,264 - INFO - evaluating now!
2024-04-24 17:07:12,483 - INFO - Epoch [23/200] train_loss: 4.4216, val_loss: 5.1674, lr: 0.003000, 4.49s
2024-04-24 17:07:12,498 - INFO - Saved model at 23
2024-04-24 17:07:12,498 - INFO - Val loss decrease from 5.1773 to 5.1674, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-24 17:07:16,748 - INFO - epoch complete!
2024-04-24 17:07:16,748 - INFO - evaluating now!
2024-04-24 17:07:16,967 - INFO - Epoch [24/200] train_loss: 4.3265, val_loss: 5.1727, lr: 0.003000, 4.47s
2024-04-24 17:07:21,178 - INFO - epoch complete!
2024-04-24 17:07:21,178 - INFO - evaluating now!
2024-04-24 17:07:21,397 - INFO - Epoch [25/200] train_loss: 4.2842, val_loss: 5.2108, lr: 0.003000, 4.43s
2024-04-24 17:07:25,787 - INFO - epoch complete!
2024-04-24 17:07:25,787 - INFO - evaluating now!
2024-04-24 17:07:26,020 - INFO - Epoch [26/200] train_loss: 4.2592, val_loss: 5.0373, lr: 0.003000, 4.62s
2024-04-24 17:07:26,020 - INFO - Saved model at 26
2024-04-24 17:07:26,020 - INFO - Val loss decrease from 5.1674 to 5.0373, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-04-24 17:07:30,378 - INFO - epoch complete!
2024-04-24 17:07:30,378 - INFO - evaluating now!
2024-04-24 17:07:30,596 - INFO - Epoch [27/200] train_loss: 4.2413, val_loss: 5.1307, lr: 0.003000, 4.58s
2024-04-24 17:07:34,947 - INFO - epoch complete!
2024-04-24 17:07:34,947 - INFO - evaluating now!
2024-04-24 17:07:35,165 - INFO - Epoch [28/200] train_loss: 4.1993, val_loss: 5.2269, lr: 0.003000, 4.57s
2024-04-24 17:07:39,383 - INFO - epoch complete!
2024-04-24 17:07:39,383 - INFO - evaluating now!
2024-04-24 17:07:39,602 - INFO - Epoch [29/200] train_loss: 4.1259, val_loss: 5.3773, lr: 0.003000, 4.44s
2024-04-24 17:07:43,888 - INFO - epoch complete!
2024-04-24 17:07:43,888 - INFO - evaluating now!
2024-04-24 17:07:44,108 - INFO - Epoch [30/200] train_loss: 4.1447, val_loss: 5.1954, lr: 0.003000, 4.51s
2024-04-24 17:07:48,395 - INFO - epoch complete!
2024-04-24 17:07:48,395 - INFO - evaluating now!
2024-04-24 17:07:48,613 - INFO - Epoch [31/200] train_loss: 4.0638, val_loss: 5.1084, lr: 0.003000, 4.51s
2024-04-24 17:07:52,879 - INFO - epoch complete!
2024-04-24 17:07:52,879 - INFO - evaluating now!
2024-04-24 17:07:53,098 - INFO - Epoch [32/200] train_loss: 3.9976, val_loss: 5.1069, lr: 0.003000, 4.48s
2024-04-24 17:07:57,368 - INFO - epoch complete!
2024-04-24 17:07:57,368 - INFO - evaluating now!
2024-04-24 17:07:57,571 - INFO - Epoch [33/200] train_loss: 4.0042, val_loss: 5.1741, lr: 0.003000, 4.47s
2024-04-24 17:08:01,789 - INFO - epoch complete!
2024-04-24 17:08:01,789 - INFO - evaluating now!
2024-04-24 17:08:02,009 - INFO - Epoch [34/200] train_loss: 4.0256, val_loss: 5.0521, lr: 0.003000, 4.44s
2024-04-24 17:08:06,274 - INFO - epoch complete!
2024-04-24 17:08:06,274 - INFO - evaluating now!
2024-04-24 17:08:06,493 - INFO - Epoch [35/200] train_loss: 3.9842, val_loss: 5.0250, lr: 0.003000, 4.48s
2024-04-24 17:08:06,508 - INFO - Saved model at 35
2024-04-24 17:08:06,508 - INFO - Val loss decrease from 5.0373 to 5.0250, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-04-24 17:08:10,759 - INFO - epoch complete!
2024-04-24 17:08:10,759 - INFO - evaluating now!
2024-04-24 17:08:10,977 - INFO - Epoch [36/200] train_loss: 3.9445, val_loss: 5.0699, lr: 0.003000, 4.47s
2024-04-24 17:08:15,431 - INFO - epoch complete!
2024-04-24 17:08:15,431 - INFO - evaluating now!
2024-04-24 17:08:15,682 - INFO - Epoch [37/200] train_loss: 3.8905, val_loss: 5.1848, lr: 0.003000, 4.70s
2024-04-24 17:08:20,042 - INFO - epoch complete!
2024-04-24 17:08:20,042 - INFO - evaluating now!
2024-04-24 17:08:20,261 - INFO - Epoch [38/200] train_loss: 3.8594, val_loss: 5.1071, lr: 0.003000, 4.58s
2024-04-24 17:08:24,671 - INFO - epoch complete!
2024-04-24 17:08:24,671 - INFO - evaluating now!
2024-04-24 17:08:24,920 - INFO - Epoch [39/200] train_loss: 3.7812, val_loss: 5.0415, lr: 0.003000, 4.66s
2024-04-24 17:08:29,187 - INFO - epoch complete!
2024-04-24 17:08:29,187 - INFO - evaluating now!
2024-04-24 17:08:29,420 - INFO - Epoch [40/200] train_loss: 3.7873, val_loss: 4.9970, lr: 0.003000, 4.50s
2024-04-24 17:08:29,436 - INFO - Saved model at 40
2024-04-24 17:08:29,436 - INFO - Val loss decrease from 5.0250 to 4.9970, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-04-24 17:08:33,702 - INFO - epoch complete!
2024-04-24 17:08:33,702 - INFO - evaluating now!
2024-04-24 17:08:33,905 - INFO - Epoch [41/200] train_loss: 3.8177, val_loss: 5.0990, lr: 0.003000, 4.47s
2024-04-24 17:08:38,223 - INFO - epoch complete!
2024-04-24 17:08:38,223 - INFO - evaluating now!
2024-04-24 17:08:38,468 - INFO - Epoch [42/200] train_loss: 3.7598, val_loss: 5.0266, lr: 0.003000, 4.56s
2024-04-24 17:08:42,784 - INFO - epoch complete!
2024-04-24 17:08:42,784 - INFO - evaluating now!
2024-04-24 17:08:43,003 - INFO - Epoch [43/200] train_loss: 3.7141, val_loss: 4.9870, lr: 0.003000, 4.53s
2024-04-24 17:08:43,019 - INFO - Saved model at 43
2024-04-24 17:08:43,019 - INFO - Val loss decrease from 4.9970 to 4.9870, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-04-24 17:08:47,339 - INFO - epoch complete!
2024-04-24 17:08:47,339 - INFO - evaluating now!
2024-04-24 17:08:47,557 - INFO - Epoch [44/200] train_loss: 3.7023, val_loss: 4.8950, lr: 0.003000, 4.54s
2024-04-24 17:08:47,573 - INFO - Saved model at 44
2024-04-24 17:08:47,573 - INFO - Val loss decrease from 4.9870 to 4.8950, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-04-24 17:08:51,805 - INFO - epoch complete!
2024-04-24 17:08:51,805 - INFO - evaluating now!
2024-04-24 17:08:52,024 - INFO - Epoch [45/200] train_loss: 3.6969, val_loss: 5.0201, lr: 0.003000, 4.45s
2024-04-24 17:08:56,257 - INFO - epoch complete!
2024-04-24 17:08:56,257 - INFO - evaluating now!
2024-04-24 17:08:56,476 - INFO - Epoch [46/200] train_loss: 3.6461, val_loss: 4.9349, lr: 0.003000, 4.45s
2024-04-24 17:09:00,742 - INFO - epoch complete!
2024-04-24 17:09:00,742 - INFO - evaluating now!
2024-04-24 17:09:00,947 - INFO - Epoch [47/200] train_loss: 3.6520, val_loss: 4.8913, lr: 0.003000, 4.47s
2024-04-24 17:09:00,963 - INFO - Saved model at 47
2024-04-24 17:09:00,963 - INFO - Val loss decrease from 4.8950 to 4.8913, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch47.tar
2024-04-24 17:09:05,209 - INFO - epoch complete!
2024-04-24 17:09:05,209 - INFO - evaluating now!
2024-04-24 17:09:05,428 - INFO - Epoch [48/200] train_loss: 3.6470, val_loss: 5.0104, lr: 0.003000, 4.46s
2024-04-24 17:09:09,678 - INFO - epoch complete!
2024-04-24 17:09:09,678 - INFO - evaluating now!
2024-04-24 17:09:09,881 - INFO - Epoch [49/200] train_loss: 3.6461, val_loss: 4.9341, lr: 0.003000, 4.45s
2024-04-24 17:09:14,178 - INFO - epoch complete!
2024-04-24 17:09:14,178 - INFO - evaluating now!
2024-04-24 17:09:14,396 - INFO - Epoch [50/200] train_loss: 3.6895, val_loss: 5.1950, lr: 0.003000, 4.52s
2024-04-24 17:09:18,694 - INFO - epoch complete!
2024-04-24 17:09:18,694 - INFO - evaluating now!
2024-04-24 17:09:18,913 - INFO - Epoch [51/200] train_loss: 3.6252, val_loss: 4.9959, lr: 0.003000, 4.52s
2024-04-24 17:09:23,257 - INFO - epoch complete!
2024-04-24 17:09:23,257 - INFO - evaluating now!
2024-04-24 17:09:23,475 - INFO - Epoch [52/200] train_loss: 3.5639, val_loss: 4.8766, lr: 0.003000, 4.56s
2024-04-24 17:09:23,491 - INFO - Saved model at 52
2024-04-24 17:09:23,491 - INFO - Val loss decrease from 4.8913 to 4.8766, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch52.tar
2024-04-24 17:09:27,879 - INFO - epoch complete!
2024-04-24 17:09:27,879 - INFO - evaluating now!
2024-04-24 17:09:28,099 - INFO - Epoch [53/200] train_loss: 3.5596, val_loss: 4.9314, lr: 0.003000, 4.61s
2024-04-24 17:09:32,490 - INFO - epoch complete!
2024-04-24 17:09:32,490 - INFO - evaluating now!
2024-04-24 17:09:32,724 - INFO - Epoch [54/200] train_loss: 3.5369, val_loss: 4.9288, lr: 0.003000, 4.63s
2024-04-24 17:09:36,977 - INFO - epoch complete!
2024-04-24 17:09:36,978 - INFO - evaluating now!
2024-04-24 17:09:37,194 - INFO - Epoch [55/200] train_loss: 3.4804, val_loss: 4.9572, lr: 0.003000, 4.47s
2024-04-24 17:09:41,465 - INFO - epoch complete!
2024-04-24 17:09:41,465 - INFO - evaluating now!
2024-04-24 17:09:41,684 - INFO - Epoch [56/200] train_loss: 3.4513, val_loss: 4.9731, lr: 0.003000, 4.49s
2024-04-24 17:09:45,946 - INFO - epoch complete!
2024-04-24 17:09:45,946 - INFO - evaluating now!
2024-04-24 17:09:46,165 - INFO - Epoch [57/200] train_loss: 3.4622, val_loss: 5.0133, lr: 0.003000, 4.48s
2024-04-24 17:09:50,590 - INFO - epoch complete!
2024-04-24 17:09:50,590 - INFO - evaluating now!
2024-04-24 17:09:50,809 - INFO - Epoch [58/200] train_loss: 3.4806, val_loss: 4.9284, lr: 0.003000, 4.64s
2024-04-24 17:09:55,217 - INFO - epoch complete!
2024-04-24 17:09:55,217 - INFO - evaluating now!
2024-04-24 17:09:55,467 - INFO - Epoch [59/200] train_loss: 3.4159, val_loss: 4.8727, lr: 0.003000, 4.66s
2024-04-24 17:09:55,483 - INFO - Saved model at 59
2024-04-24 17:09:55,483 - INFO - Val loss decrease from 4.8766 to 4.8727, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch59.tar
2024-04-24 17:09:59,763 - INFO - epoch complete!
2024-04-24 17:09:59,763 - INFO - evaluating now!
2024-04-24 17:09:59,997 - INFO - Epoch [60/200] train_loss: 3.4178, val_loss: 4.9698, lr: 0.003000, 4.51s
2024-04-24 17:10:04,385 - INFO - epoch complete!
2024-04-24 17:10:04,385 - INFO - evaluating now!
2024-04-24 17:10:04,620 - INFO - Epoch [61/200] train_loss: 3.4015, val_loss: 4.9389, lr: 0.003000, 4.62s
2024-04-24 17:10:08,842 - INFO - epoch complete!
2024-04-24 17:10:08,842 - INFO - evaluating now!
2024-04-24 17:10:09,061 - INFO - Epoch [62/200] train_loss: 3.3708, val_loss: 4.9889, lr: 0.003000, 4.44s
2024-04-24 17:10:13,232 - INFO - epoch complete!
2024-04-24 17:10:13,232 - INFO - evaluating now!
2024-04-24 17:10:13,451 - INFO - Epoch [63/200] train_loss: 3.4235, val_loss: 5.1119, lr: 0.003000, 4.39s
2024-04-24 17:10:17,679 - INFO - epoch complete!
2024-04-24 17:10:17,679 - INFO - evaluating now!
2024-04-24 17:10:17,903 - INFO - Epoch [64/200] train_loss: 3.3904, val_loss: 5.0404, lr: 0.003000, 4.45s
2024-04-24 17:10:22,132 - INFO - epoch complete!
2024-04-24 17:10:22,132 - INFO - evaluating now!
2024-04-24 17:10:22,351 - INFO - Epoch [65/200] train_loss: 3.3454, val_loss: 4.8861, lr: 0.003000, 4.45s
2024-04-24 17:10:26,585 - INFO - epoch complete!
2024-04-24 17:10:26,585 - INFO - evaluating now!
2024-04-24 17:10:26,804 - INFO - Epoch [66/200] train_loss: 3.3421, val_loss: 4.9660, lr: 0.003000, 4.45s
2024-04-24 17:10:31,071 - INFO - epoch complete!
2024-04-24 17:10:31,071 - INFO - evaluating now!
2024-04-24 17:10:31,290 - INFO - Epoch [67/200] train_loss: 3.3028, val_loss: 4.8776, lr: 0.003000, 4.49s
2024-04-24 17:10:35,523 - INFO - epoch complete!
2024-04-24 17:10:35,523 - INFO - evaluating now!
2024-04-24 17:10:35,727 - INFO - Epoch [68/200] train_loss: 3.3087, val_loss: 5.0424, lr: 0.003000, 4.44s
2024-04-24 17:10:39,964 - INFO - epoch complete!
2024-04-24 17:10:39,964 - INFO - evaluating now!
2024-04-24 17:10:40,183 - INFO - Epoch [69/200] train_loss: 3.3378, val_loss: 5.0543, lr: 0.003000, 4.46s
2024-04-24 17:10:44,417 - INFO - epoch complete!
2024-04-24 17:10:44,417 - INFO - evaluating now!
2024-04-24 17:10:44,645 - INFO - Epoch [70/200] train_loss: 3.3461, val_loss: 5.0074, lr: 0.003000, 4.46s
2024-04-24 17:10:48,868 - INFO - epoch complete!
2024-04-24 17:10:48,868 - INFO - evaluating now!
2024-04-24 17:10:49,117 - INFO - Epoch [71/200] train_loss: 3.3295, val_loss: 4.9450, lr: 0.003000, 4.47s
2024-04-24 17:10:53,521 - INFO - epoch complete!
2024-04-24 17:10:53,521 - INFO - evaluating now!
2024-04-24 17:10:53,739 - INFO - Epoch [72/200] train_loss: 3.2923, val_loss: 5.0073, lr: 0.003000, 4.62s
2024-04-24 17:10:57,991 - INFO - epoch complete!
2024-04-24 17:10:57,991 - INFO - evaluating now!
2024-04-24 17:10:58,210 - INFO - Epoch [73/200] train_loss: 3.2669, val_loss: 4.9972, lr: 0.003000, 4.47s
2024-04-24 17:11:02,492 - INFO - epoch complete!
2024-04-24 17:11:02,492 - INFO - evaluating now!
2024-04-24 17:11:02,710 - INFO - Epoch [74/200] train_loss: 3.2684, val_loss: 4.9988, lr: 0.003000, 4.50s
2024-04-24 17:11:02,710 - WARNING - Early stopping at epoch: 74
2024-04-24 17:11:02,710 - INFO - Trained totally 75 epochs, average train time is 4.308s, average eval time is 0.224s
2024-04-24 17:11:02,710 - INFO - Loaded model at 59
2024-04-24 17:11:02,710 - INFO - Saved model at ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406.m
2024-04-24 17:11:02,726 - INFO - Start evaluating ...
2024-04-24 17:11:03,523 - INFO - Note that you select the single mode to evaluate!
2024-04-24 17:11:03,523 - INFO - Evaluate result is saved at ./libcity/cache/2/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-24 17:11:03,523 - INFO - 
         MAE       RMSE
1   2.407902   7.037494
2   2.482743   7.647453
3   2.594321   8.536983
4   2.721655   9.406630
5   2.880660  10.430064
6   3.033554  11.360340
7   3.035288  11.965289
8   3.137964  12.244785
9   3.138640  12.342006
10  3.221520  12.528167
11  3.269823  12.716112
12  3.412304  13.155329
2024-04-24 17:11:03,523 - INFO - ----------------------------------------------------------------------------
2024-04-24 17:11:03,523 - INFO - # 3, Kownledge Graph Embedding: None, Experiment ids: 3
2024-04-24 17:11:03,523 - INFO - ----------------------------------------------------------------------------
2024-04-24 17:11:03,523 - INFO - Log directory: ./libcity/log
2024-04-24 17:11:03,523 - INFO - Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=3
2024-04-24 17:11:03,523 - INFO - {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 518061525, 'exp_id': 3, 'max_epoch': 200, 'patience': 15, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cache_dataset': False, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-24 17:11:03,538 - INFO - Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-24 17:11:03,538 - INFO - set_weight_link_or_dist: dist
2024-04-24 17:11:03,538 - INFO - init_weight_inf_or_zero: inf
2024-04-24 17:11:03,554 - INFO - Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-24 17:11:03,554 - INFO - Start Calculate the weight by Gauss kernel!
2024-04-24 17:11:03,554 - INFO - Loading file CHITaxi20190406.dyna
2024-04-24 17:11:03,663 - INFO - Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-24 17:11:03,788 - INFO - Dataset created
2024-04-24 17:11:03,788 - INFO - x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-04-24 17:11:03,788 - INFO - train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-04-24 17:11:03,788 - INFO - eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-04-24 17:11:03,788 - INFO - test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-04-24 17:11:03,820 - INFO - StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-24 17:11:03,820 - INFO - NoneScaler
2024-04-24 17:11:03,929 - INFO - AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-24 17:11:03,929 - INFO - node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-24 17:11:03,929 - INFO - encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-04-24 17:11:03,929 - INFO - encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 17:11:03,929 - INFO - encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-04-24 17:11:03,929 - INFO - encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 17:11:03,929 - INFO - encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-24 17:11:03,929 - INFO - encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 17:11:03,929 - INFO - encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-24 17:11:03,929 - INFO - encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 17:11:03,929 - INFO - end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-24 17:11:03,929 - INFO - end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-24 17:11:03,929 - INFO - Total parameter numbers: 751130
2024-04-24 17:11:03,929 - INFO - You select `adam` optimizer.
2024-04-24 17:11:03,945 - WARNING - Received none train loss func and will use the loss func defined in the model.
2024-04-24 17:11:03,945 - INFO - Start training ...
2024-04-24 17:11:03,945 - INFO - num_batches:48
2024-04-24 17:11:08,234 - INFO - epoch complete!
2024-04-24 17:11:08,234 - INFO - evaluating now!
2024-04-24 17:11:08,452 - INFO - Epoch [0/200] train_loss: 23.5917, val_loss: 16.9103, lr: 0.003000, 4.51s
2024-04-24 17:11:08,468 - INFO - Saved model at 0
2024-04-24 17:11:08,468 - INFO - Val loss decrease from inf to 16.9103, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-24 17:11:12,696 - INFO - epoch complete!
2024-04-24 17:11:12,696 - INFO - evaluating now!
2024-04-24 17:11:12,915 - INFO - Epoch [1/200] train_loss: 13.3135, val_loss: 12.1789, lr: 0.003000, 4.45s
2024-04-24 17:11:12,931 - INFO - Saved model at 1
2024-04-24 17:11:12,931 - INFO - Val loss decrease from 16.9103 to 12.1789, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-24 17:11:17,176 - INFO - epoch complete!
2024-04-24 17:11:17,176 - INFO - evaluating now!
2024-04-24 17:11:17,400 - INFO - Epoch [2/200] train_loss: 9.9324, val_loss: 9.2792, lr: 0.003000, 4.47s
2024-04-24 17:11:17,414 - INFO - Saved model at 2
2024-04-24 17:11:17,414 - INFO - Val loss decrease from 12.1789 to 9.2792, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-24 17:11:21,696 - INFO - epoch complete!
2024-04-24 17:11:21,696 - INFO - evaluating now!
2024-04-24 17:11:21,914 - INFO - Epoch [3/200] train_loss: 8.1108, val_loss: 7.8696, lr: 0.003000, 4.50s
2024-04-24 17:11:21,930 - INFO - Saved model at 3
2024-04-24 17:11:21,930 - INFO - Val loss decrease from 9.2792 to 7.8696, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-24 17:11:26,228 - INFO - epoch complete!
2024-04-24 17:11:26,228 - INFO - evaluating now!
2024-04-24 17:11:26,444 - INFO - Epoch [4/200] train_loss: 7.1982, val_loss: 7.0934, lr: 0.003000, 4.51s
2024-04-24 17:11:26,460 - INFO - Saved model at 4
2024-04-24 17:11:26,460 - INFO - Val loss decrease from 7.8696 to 7.0934, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-24 17:11:30,748 - INFO - epoch complete!
2024-04-24 17:11:30,748 - INFO - evaluating now!
2024-04-24 17:11:30,982 - INFO - Epoch [5/200] train_loss: 6.5369, val_loss: 6.5978, lr: 0.003000, 4.52s
2024-04-24 17:11:30,998 - INFO - Saved model at 5
2024-04-24 17:11:30,998 - INFO - Val loss decrease from 7.0934 to 6.5978, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-24 17:11:35,221 - INFO - epoch complete!
2024-04-24 17:11:35,221 - INFO - evaluating now!
2024-04-24 17:11:35,425 - INFO - Epoch [6/200] train_loss: 6.2324, val_loss: 6.1120, lr: 0.003000, 4.43s
2024-04-24 17:11:35,440 - INFO - Saved model at 6
2024-04-24 17:11:35,440 - INFO - Val loss decrease from 6.5978 to 6.1120, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-24 17:11:39,647 - INFO - epoch complete!
2024-04-24 17:11:39,647 - INFO - evaluating now!
2024-04-24 17:11:39,866 - INFO - Epoch [7/200] train_loss: 5.9105, val_loss: 5.9887, lr: 0.003000, 4.43s
2024-04-24 17:11:39,882 - INFO - Saved model at 7
2024-04-24 17:11:39,882 - INFO - Val loss decrease from 6.1120 to 5.9887, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-24 17:11:44,186 - INFO - epoch complete!
2024-04-24 17:11:44,186 - INFO - evaluating now!
2024-04-24 17:11:44,405 - INFO - Epoch [8/200] train_loss: 5.7174, val_loss: 5.8265, lr: 0.003000, 4.52s
2024-04-24 17:11:44,421 - INFO - Saved model at 8
2024-04-24 17:11:44,421 - INFO - Val loss decrease from 5.9887 to 5.8265, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-24 17:11:48,695 - INFO - epoch complete!
2024-04-24 17:11:48,695 - INFO - evaluating now!
2024-04-24 17:11:48,914 - INFO - Epoch [9/200] train_loss: 5.5033, val_loss: 5.8521, lr: 0.003000, 4.49s
2024-04-24 17:11:53,120 - INFO - epoch complete!
2024-04-24 17:11:53,120 - INFO - evaluating now!
2024-04-24 17:11:53,339 - INFO - Epoch [10/200] train_loss: 5.3662, val_loss: 5.5374, lr: 0.003000, 4.42s
2024-04-24 17:11:53,354 - INFO - Saved model at 10
2024-04-24 17:11:53,354 - INFO - Val loss decrease from 5.8265 to 5.5374, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-24 17:11:57,558 - INFO - epoch complete!
2024-04-24 17:11:57,558 - INFO - evaluating now!
2024-04-24 17:11:57,780 - INFO - Epoch [11/200] train_loss: 5.2150, val_loss: 5.5431, lr: 0.003000, 4.43s
2024-04-24 17:12:02,138 - INFO - epoch complete!
2024-04-24 17:12:02,138 - INFO - evaluating now!
2024-04-24 17:12:02,357 - INFO - Epoch [12/200] train_loss: 5.1242, val_loss: 5.6765, lr: 0.003000, 4.58s
2024-04-24 17:12:06,622 - INFO - epoch complete!
2024-04-24 17:12:06,622 - INFO - evaluating now!
2024-04-24 17:12:06,840 - INFO - Epoch [13/200] train_loss: 5.0202, val_loss: 5.4915, lr: 0.003000, 4.48s
2024-04-24 17:12:06,856 - INFO - Saved model at 13
2024-04-24 17:12:06,856 - INFO - Val loss decrease from 5.5374 to 5.4915, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-24 17:12:11,140 - INFO - epoch complete!
2024-04-24 17:12:11,140 - INFO - evaluating now!
2024-04-24 17:12:11,343 - INFO - Epoch [14/200] train_loss: 4.8892, val_loss: 5.3427, lr: 0.003000, 4.49s
2024-04-24 17:12:11,359 - INFO - Saved model at 14
2024-04-24 17:12:11,359 - INFO - Val loss decrease from 5.4915 to 5.3427, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-24 17:12:15,628 - INFO - epoch complete!
2024-04-24 17:12:15,628 - INFO - evaluating now!
2024-04-24 17:12:15,847 - INFO - Epoch [15/200] train_loss: 4.8627, val_loss: 5.2940, lr: 0.003000, 4.49s
2024-04-24 17:12:15,862 - INFO - Saved model at 15
2024-04-24 17:12:15,862 - INFO - Val loss decrease from 5.3427 to 5.2940, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-24 17:12:20,132 - INFO - epoch complete!
2024-04-24 17:12:20,132 - INFO - evaluating now!
2024-04-24 17:12:20,335 - INFO - Epoch [16/200] train_loss: 4.7817, val_loss: 5.2680, lr: 0.003000, 4.47s
2024-04-24 17:12:20,350 - INFO - Saved model at 16
2024-04-24 17:12:20,350 - INFO - Val loss decrease from 5.2940 to 5.2680, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-24 17:12:24,622 - INFO - epoch complete!
2024-04-24 17:12:24,622 - INFO - evaluating now!
2024-04-24 17:12:24,841 - INFO - Epoch [17/200] train_loss: 4.6739, val_loss: 5.3673, lr: 0.003000, 4.49s
2024-04-24 17:12:29,163 - INFO - epoch complete!
2024-04-24 17:12:29,163 - INFO - evaluating now!
2024-04-24 17:12:29,399 - INFO - Epoch [18/200] train_loss: 4.5979, val_loss: 5.1445, lr: 0.003000, 4.56s
2024-04-24 17:12:29,413 - INFO - Saved model at 18
2024-04-24 17:12:29,413 - INFO - Val loss decrease from 5.2680 to 5.1445, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-24 17:12:33,698 - INFO - epoch complete!
2024-04-24 17:12:33,698 - INFO - evaluating now!
2024-04-24 17:12:33,911 - INFO - Epoch [19/200] train_loss: 4.5173, val_loss: 5.1893, lr: 0.003000, 4.50s
2024-04-24 17:12:38,199 - INFO - epoch complete!
2024-04-24 17:12:38,199 - INFO - evaluating now!
2024-04-24 17:12:38,421 - INFO - Epoch [20/200] train_loss: 4.5457, val_loss: 5.3581, lr: 0.003000, 4.51s
2024-04-24 17:12:42,695 - INFO - epoch complete!
2024-04-24 17:12:42,695 - INFO - evaluating now!
2024-04-24 17:12:42,922 - INFO - Epoch [21/200] train_loss: 4.4693, val_loss: 5.1312, lr: 0.003000, 4.50s
2024-04-24 17:12:42,938 - INFO - Saved model at 21
2024-04-24 17:12:42,938 - INFO - Val loss decrease from 5.1445 to 5.1312, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-24 17:12:47,251 - INFO - epoch complete!
2024-04-24 17:12:47,251 - INFO - evaluating now!
2024-04-24 17:12:47,470 - INFO - Epoch [22/200] train_loss: 4.3650, val_loss: 4.9795, lr: 0.003000, 4.53s
2024-04-24 17:12:47,486 - INFO - Saved model at 22
2024-04-24 17:12:47,486 - INFO - Val loss decrease from 5.1312 to 4.9795, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-24 17:12:51,704 - INFO - epoch complete!
2024-04-24 17:12:51,704 - INFO - evaluating now!
2024-04-24 17:12:51,933 - INFO - Epoch [23/200] train_loss: 4.3898, val_loss: 5.1185, lr: 0.003000, 4.45s
2024-04-24 17:12:56,220 - INFO - epoch complete!
2024-04-24 17:12:56,220 - INFO - evaluating now!
2024-04-24 17:12:56,450 - INFO - Epoch [24/200] train_loss: 4.2983, val_loss: 5.1531, lr: 0.003000, 4.50s
2024-04-24 17:13:00,722 - INFO - epoch complete!
2024-04-24 17:13:00,722 - INFO - evaluating now!
2024-04-24 17:13:00,925 - INFO - Epoch [25/200] train_loss: 4.2730, val_loss: 5.0716, lr: 0.003000, 4.48s
2024-04-24 17:13:05,186 - INFO - epoch complete!
2024-04-24 17:13:05,186 - INFO - evaluating now!
2024-04-24 17:13:05,404 - INFO - Epoch [26/200] train_loss: 4.1795, val_loss: 5.1103, lr: 0.003000, 4.46s
2024-04-24 17:13:09,650 - INFO - epoch complete!
2024-04-24 17:13:09,650 - INFO - evaluating now!
2024-04-24 17:13:09,868 - INFO - Epoch [27/200] train_loss: 4.1479, val_loss: 5.2628, lr: 0.003000, 4.46s
2024-04-24 17:13:14,118 - INFO - epoch complete!
2024-04-24 17:13:14,118 - INFO - evaluating now!
2024-04-24 17:13:14,337 - INFO - Epoch [28/200] train_loss: 4.1086, val_loss: 5.0934, lr: 0.003000, 4.47s
2024-04-24 17:13:18,601 - INFO - epoch complete!
2024-04-24 17:13:18,601 - INFO - evaluating now!
2024-04-24 17:13:18,820 - INFO - Epoch [29/200] train_loss: 4.1553, val_loss: 5.0249, lr: 0.003000, 4.48s
2024-04-24 17:13:23,023 - INFO - epoch complete!
2024-04-24 17:13:23,023 - INFO - evaluating now!
2024-04-24 17:13:23,242 - INFO - Epoch [30/200] train_loss: 4.0801, val_loss: 5.2652, lr: 0.003000, 4.42s
2024-04-24 17:13:27,530 - INFO - epoch complete!
2024-04-24 17:13:27,530 - INFO - evaluating now!
2024-04-24 17:13:27,749 - INFO - Epoch [31/200] train_loss: 4.0488, val_loss: 5.2635, lr: 0.003000, 4.51s
2024-04-24 17:13:31,998 - INFO - epoch complete!
2024-04-24 17:13:31,998 - INFO - evaluating now!
2024-04-24 17:13:32,233 - INFO - Epoch [32/200] train_loss: 4.0054, val_loss: 5.0566, lr: 0.003000, 4.48s
2024-04-24 17:13:36,472 - INFO - epoch complete!
2024-04-24 17:13:36,472 - INFO - evaluating now!
2024-04-24 17:13:36,691 - INFO - Epoch [33/200] train_loss: 3.9978, val_loss: 5.3145, lr: 0.003000, 4.46s
2024-04-24 17:13:40,879 - INFO - epoch complete!
2024-04-24 17:13:40,879 - INFO - evaluating now!
2024-04-24 17:13:41,098 - INFO - Epoch [34/200] train_loss: 3.9238, val_loss: 5.0417, lr: 0.003000, 4.41s
2024-04-24 17:13:45,287 - INFO - epoch complete!
2024-04-24 17:13:45,287 - INFO - evaluating now!
2024-04-24 17:13:45,505 - INFO - Epoch [35/200] train_loss: 3.8735, val_loss: 5.0100, lr: 0.003000, 4.41s
2024-04-24 17:13:49,777 - INFO - epoch complete!
2024-04-24 17:13:49,777 - INFO - evaluating now!
2024-04-24 17:13:50,014 - INFO - Epoch [36/200] train_loss: 3.7962, val_loss: 5.0622, lr: 0.003000, 4.51s
2024-04-24 17:13:54,284 - INFO - epoch complete!
2024-04-24 17:13:54,284 - INFO - evaluating now!
2024-04-24 17:13:54,534 - INFO - Epoch [37/200] train_loss: 3.7986, val_loss: 4.9249, lr: 0.003000, 4.52s
2024-04-24 17:13:54,534 - INFO - Saved model at 37
2024-04-24 17:13:54,534 - INFO - Val loss decrease from 4.9795 to 4.9249, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-04-24 17:13:58,779 - INFO - epoch complete!
2024-04-24 17:13:58,779 - INFO - evaluating now!
2024-04-24 17:13:58,997 - INFO - Epoch [38/200] train_loss: 3.7980, val_loss: 5.1517, lr: 0.003000, 4.46s
2024-04-24 17:14:03,263 - INFO - epoch complete!
2024-04-24 17:14:03,263 - INFO - evaluating now!
2024-04-24 17:14:03,482 - INFO - Epoch [39/200] train_loss: 3.7829, val_loss: 5.1251, lr: 0.003000, 4.49s
2024-04-24 17:14:07,745 - INFO - epoch complete!
2024-04-24 17:14:07,745 - INFO - evaluating now!
2024-04-24 17:14:07,964 - INFO - Epoch [40/200] train_loss: 3.7494, val_loss: 5.1690, lr: 0.003000, 4.48s
2024-04-24 17:14:12,261 - INFO - epoch complete!
2024-04-24 17:14:12,261 - INFO - evaluating now!
2024-04-24 17:14:12,480 - INFO - Epoch [41/200] train_loss: 3.7179, val_loss: 5.1247, lr: 0.003000, 4.52s
2024-04-24 17:14:16,816 - INFO - epoch complete!
2024-04-24 17:14:16,816 - INFO - evaluating now!
2024-04-24 17:14:17,050 - INFO - Epoch [42/200] train_loss: 3.6993, val_loss: 5.1125, lr: 0.003000, 4.57s
2024-04-24 17:14:21,437 - INFO - epoch complete!
2024-04-24 17:14:21,437 - INFO - evaluating now!
2024-04-24 17:14:21,656 - INFO - Epoch [43/200] train_loss: 3.6365, val_loss: 5.0175, lr: 0.003000, 4.61s
2024-04-24 17:14:25,982 - INFO - epoch complete!
2024-04-24 17:14:25,982 - INFO - evaluating now!
2024-04-24 17:14:26,232 - INFO - Epoch [44/200] train_loss: 3.6310, val_loss: 5.0476, lr: 0.003000, 4.58s
2024-04-24 17:14:30,510 - INFO - epoch complete!
2024-04-24 17:14:30,510 - INFO - evaluating now!
2024-04-24 17:14:30,753 - INFO - Epoch [45/200] train_loss: 3.6334, val_loss: 5.0890, lr: 0.003000, 4.52s
2024-04-24 17:14:35,401 - INFO - epoch complete!
2024-04-24 17:14:35,401 - INFO - evaluating now!
2024-04-24 17:14:35,619 - INFO - Epoch [46/200] train_loss: 3.6508, val_loss: 5.0694, lr: 0.003000, 4.87s
2024-04-24 17:14:40,182 - INFO - epoch complete!
2024-04-24 17:14:40,182 - INFO - evaluating now!
2024-04-24 17:14:40,417 - INFO - Epoch [47/200] train_loss: 3.5901, val_loss: 5.0337, lr: 0.003000, 4.80s
2024-04-24 17:14:44,741 - INFO - epoch complete!
2024-04-24 17:14:44,741 - INFO - evaluating now!
2024-04-24 17:14:44,960 - INFO - Epoch [48/200] train_loss: 3.5321, val_loss: 5.1139, lr: 0.003000, 4.54s
2024-04-24 17:14:49,197 - INFO - epoch complete!
2024-04-24 17:14:49,197 - INFO - evaluating now!
2024-04-24 17:14:49,447 - INFO - Epoch [49/200] train_loss: 3.5161, val_loss: 5.0510, lr: 0.003000, 4.49s
2024-04-24 17:14:53,900 - INFO - epoch complete!
2024-04-24 17:14:53,900 - INFO - evaluating now!
2024-04-24 17:14:54,118 - INFO - Epoch [50/200] train_loss: 3.5178, val_loss: 5.0205, lr: 0.003000, 4.67s
2024-04-24 17:14:58,479 - INFO - epoch complete!
2024-04-24 17:14:58,479 - INFO - evaluating now!
2024-04-24 17:14:58,713 - INFO - Epoch [51/200] train_loss: 3.4948, val_loss: 5.0192, lr: 0.003000, 4.59s
2024-04-24 17:15:03,114 - INFO - epoch complete!
2024-04-24 17:15:03,114 - INFO - evaluating now!
2024-04-24 17:15:03,349 - INFO - Epoch [52/200] train_loss: 3.4410, val_loss: 5.0759, lr: 0.003000, 4.64s
2024-04-24 17:15:03,349 - WARNING - Early stopping at epoch: 52
2024-04-24 17:15:03,349 - INFO - Trained totally 53 epochs, average train time is 4.288s, average eval time is 0.223s
2024-04-24 17:15:03,364 - INFO - Loaded model at 37
2024-04-24 17:15:03,364 - INFO - Saved model at ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406.m
2024-04-24 17:15:03,380 - INFO - Start evaluating ...
2024-04-24 17:15:04,239 - INFO - Note that you select the single mode to evaluate!
2024-04-24 17:15:04,239 - INFO - Evaluate result is saved at ./libcity/cache/3/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-24 17:15:04,239 - INFO - 
         MAE       RMSE
1   2.398649   6.830305
2   2.463653   7.397891
3   2.727581   8.934153
4   2.878957  10.055517
5   3.024338  11.146607
6   3.139875  11.835061
7   3.197009  12.462067
8   3.211239  12.914290
9   3.298157  13.192359
10  3.314514  13.506054
11  3.416773  13.913516
12  3.579450  14.610716
2024-04-24 17:15:04,239 - INFO - ----------------------------------------------------------------------------
2024-04-24 17:15:04,239 - INFO - # 4, Kownledge Graph Embedding: None, Experiment ids: 4
2024-04-24 17:15:04,239 - INFO - ----------------------------------------------------------------------------
2024-04-24 17:15:04,239 - INFO - Log directory: ./libcity/log
2024-04-24 17:15:04,239 - INFO - Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=4
2024-04-24 17:15:04,239 - INFO - {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 953783882, 'exp_id': 4, 'max_epoch': 200, 'patience': 15, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cache_dataset': False, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-24 17:15:04,255 - INFO - Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-24 17:15:04,255 - INFO - set_weight_link_or_dist: dist
2024-04-24 17:15:04,255 - INFO - init_weight_inf_or_zero: inf
2024-04-24 17:15:04,275 - INFO - Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-24 17:15:04,275 - INFO - Start Calculate the weight by Gauss kernel!
2024-04-24 17:15:04,276 - INFO - Loading file CHITaxi20190406.dyna
2024-04-24 17:15:04,395 - INFO - Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-24 17:15:04,505 - INFO - Dataset created
2024-04-24 17:15:04,505 - INFO - x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-04-24 17:15:04,520 - INFO - train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-04-24 17:15:04,520 - INFO - eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-04-24 17:15:04,520 - INFO - test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-04-24 17:15:04,536 - INFO - StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-24 17:15:04,536 - INFO - NoneScaler
2024-04-24 17:15:04,661 - INFO - AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-24 17:15:04,661 - INFO - node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-24 17:15:04,661 - INFO - encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-04-24 17:15:04,661 - INFO - encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 17:15:04,661 - INFO - encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-04-24 17:15:04,661 - INFO - encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 17:15:04,661 - INFO - encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-24 17:15:04,661 - INFO - encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 17:15:04,661 - INFO - encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-24 17:15:04,661 - INFO - encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 17:15:04,661 - INFO - end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-24 17:15:04,661 - INFO - end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-24 17:15:04,661 - INFO - Total parameter numbers: 751130
2024-04-24 17:15:04,661 - INFO - You select `adam` optimizer.
2024-04-24 17:15:04,661 - WARNING - Received none train loss func and will use the loss func defined in the model.
2024-04-24 17:15:04,661 - INFO - Start training ...
2024-04-24 17:15:04,661 - INFO - num_batches:48
2024-04-24 17:15:09,036 - INFO - epoch complete!
2024-04-24 17:15:09,036 - INFO - evaluating now!
2024-04-24 17:15:09,255 - INFO - Epoch [0/200] train_loss: 24.3993, val_loss: 17.0828, lr: 0.003000, 4.59s
2024-04-24 17:15:09,271 - INFO - Saved model at 0
2024-04-24 17:15:09,271 - INFO - Val loss decrease from inf to 17.0828, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-24 17:15:13,520 - INFO - epoch complete!
2024-04-24 17:15:13,520 - INFO - evaluating now!
2024-04-24 17:15:13,739 - INFO - Epoch [1/200] train_loss: 13.8298, val_loss: 12.9231, lr: 0.003000, 4.47s
2024-04-24 17:15:13,754 - INFO - Saved model at 1
2024-04-24 17:15:13,754 - INFO - Val loss decrease from 17.0828 to 12.9231, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-24 17:15:18,004 - INFO - epoch complete!
2024-04-24 17:15:18,004 - INFO - evaluating now!
2024-04-24 17:15:18,223 - INFO - Epoch [2/200] train_loss: 10.8497, val_loss: 10.3163, lr: 0.003000, 4.47s
2024-04-24 17:15:18,223 - INFO - Saved model at 2
2024-04-24 17:15:18,223 - INFO - Val loss decrease from 12.9231 to 10.3163, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-24 17:15:22,441 - INFO - epoch complete!
2024-04-24 17:15:22,441 - INFO - evaluating now!
2024-04-24 17:15:22,675 - INFO - Epoch [3/200] train_loss: 8.9987, val_loss: 8.6287, lr: 0.003000, 4.45s
2024-04-24 17:15:22,691 - INFO - Saved model at 3
2024-04-24 17:15:22,691 - INFO - Val loss decrease from 10.3163 to 8.6287, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-24 17:15:26,986 - INFO - epoch complete!
2024-04-24 17:15:26,986 - INFO - evaluating now!
2024-04-24 17:15:27,205 - INFO - Epoch [4/200] train_loss: 7.9229, val_loss: 7.7157, lr: 0.003000, 4.51s
2024-04-24 17:15:27,221 - INFO - Saved model at 4
2024-04-24 17:15:27,221 - INFO - Val loss decrease from 8.6287 to 7.7157, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-24 17:15:31,535 - INFO - epoch complete!
2024-04-24 17:15:31,535 - INFO - evaluating now!
2024-04-24 17:15:31,770 - INFO - Epoch [5/200] train_loss: 7.1678, val_loss: 6.9342, lr: 0.003000, 4.55s
2024-04-24 17:15:31,786 - INFO - Saved model at 5
2024-04-24 17:15:31,786 - INFO - Val loss decrease from 7.7157 to 6.9342, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-24 17:15:36,137 - INFO - epoch complete!
2024-04-24 17:15:36,137 - INFO - evaluating now!
2024-04-24 17:15:36,371 - INFO - Epoch [6/200] train_loss: 6.6718, val_loss: 6.6516, lr: 0.003000, 4.59s
2024-04-24 17:15:36,387 - INFO - Saved model at 6
2024-04-24 17:15:36,387 - INFO - Val loss decrease from 6.9342 to 6.6516, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-24 17:15:40,747 - INFO - epoch complete!
2024-04-24 17:15:40,747 - INFO - evaluating now!
2024-04-24 17:15:40,966 - INFO - Epoch [7/200] train_loss: 6.2279, val_loss: 6.0788, lr: 0.003000, 4.58s
2024-04-24 17:15:40,982 - INFO - Saved model at 7
2024-04-24 17:15:40,982 - INFO - Val loss decrease from 6.6516 to 6.0788, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-24 17:15:45,278 - INFO - epoch complete!
2024-04-24 17:15:45,278 - INFO - evaluating now!
2024-04-24 17:15:45,497 - INFO - Epoch [8/200] train_loss: 5.9897, val_loss: 6.0906, lr: 0.003000, 4.51s
2024-04-24 17:15:49,824 - INFO - epoch complete!
2024-04-24 17:15:49,824 - INFO - evaluating now!
2024-04-24 17:15:50,043 - INFO - Epoch [9/200] train_loss: 5.7424, val_loss: 5.8318, lr: 0.003000, 4.55s
2024-04-24 17:15:50,058 - INFO - Saved model at 9
2024-04-24 17:15:50,058 - INFO - Val loss decrease from 6.0788 to 5.8318, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-24 17:15:54,443 - INFO - epoch complete!
2024-04-24 17:15:54,443 - INFO - evaluating now!
2024-04-24 17:15:54,694 - INFO - Epoch [10/200] train_loss: 5.6189, val_loss: 5.8626, lr: 0.003000, 4.64s
2024-04-24 17:15:59,087 - INFO - epoch complete!
2024-04-24 17:15:59,087 - INFO - evaluating now!
2024-04-24 17:15:59,306 - INFO - Epoch [11/200] train_loss: 5.4738, val_loss: 5.8289, lr: 0.003000, 4.61s
2024-04-24 17:15:59,306 - INFO - Saved model at 11
2024-04-24 17:15:59,306 - INFO - Val loss decrease from 5.8318 to 5.8289, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-24 17:16:03,606 - INFO - epoch complete!
2024-04-24 17:16:03,606 - INFO - evaluating now!
2024-04-24 17:16:03,810 - INFO - Epoch [12/200] train_loss: 5.3144, val_loss: 5.6364, lr: 0.003000, 4.50s
2024-04-24 17:16:03,825 - INFO - Saved model at 12
2024-04-24 17:16:03,825 - INFO - Val loss decrease from 5.8289 to 5.6364, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-24 17:16:08,149 - INFO - epoch complete!
2024-04-24 17:16:08,149 - INFO - evaluating now!
2024-04-24 17:16:08,383 - INFO - Epoch [13/200] train_loss: 5.1326, val_loss: 5.5557, lr: 0.003000, 4.56s
2024-04-24 17:16:08,399 - INFO - Saved model at 13
2024-04-24 17:16:08,399 - INFO - Val loss decrease from 5.6364 to 5.5557, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-24 17:16:12,961 - INFO - epoch complete!
2024-04-24 17:16:12,961 - INFO - evaluating now!
2024-04-24 17:16:13,185 - INFO - Epoch [14/200] train_loss: 5.0227, val_loss: 5.4138, lr: 0.003000, 4.79s
2024-04-24 17:16:13,198 - INFO - Saved model at 14
2024-04-24 17:16:13,198 - INFO - Val loss decrease from 5.5557 to 5.4138, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-24 17:16:17,495 - INFO - epoch complete!
2024-04-24 17:16:17,495 - INFO - evaluating now!
2024-04-24 17:16:17,745 - INFO - Epoch [15/200] train_loss: 4.9384, val_loss: 5.4313, lr: 0.003000, 4.55s
2024-04-24 17:16:22,121 - INFO - epoch complete!
2024-04-24 17:16:22,121 - INFO - evaluating now!
2024-04-24 17:16:22,355 - INFO - Epoch [16/200] train_loss: 4.9313, val_loss: 5.5415, lr: 0.003000, 4.61s
2024-04-24 17:16:26,714 - INFO - epoch complete!
2024-04-24 17:16:26,714 - INFO - evaluating now!
2024-04-24 17:16:26,933 - INFO - Epoch [17/200] train_loss: 4.8561, val_loss: 5.3061, lr: 0.003000, 4.58s
2024-04-24 17:16:26,948 - INFO - Saved model at 17
2024-04-24 17:16:26,948 - INFO - Val loss decrease from 5.4138 to 5.3061, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-24 17:16:31,296 - INFO - epoch complete!
2024-04-24 17:16:31,296 - INFO - evaluating now!
2024-04-24 17:16:31,531 - INFO - Epoch [18/200] train_loss: 4.7412, val_loss: 5.2165, lr: 0.003000, 4.58s
2024-04-24 17:16:31,546 - INFO - Saved model at 18
2024-04-24 17:16:31,546 - INFO - Val loss decrease from 5.3061 to 5.2165, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-24 17:16:35,873 - INFO - epoch complete!
2024-04-24 17:16:35,873 - INFO - evaluating now!
2024-04-24 17:16:36,107 - INFO - Epoch [19/200] train_loss: 4.6567, val_loss: 5.0862, lr: 0.003000, 4.56s
2024-04-24 17:16:36,107 - INFO - Saved model at 19
2024-04-24 17:16:36,107 - INFO - Val loss decrease from 5.2165 to 5.0862, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-24 17:16:40,424 - INFO - epoch complete!
2024-04-24 17:16:40,424 - INFO - evaluating now!
2024-04-24 17:16:40,659 - INFO - Epoch [20/200] train_loss: 4.6136, val_loss: 5.4444, lr: 0.003000, 4.55s
2024-04-24 17:16:45,018 - INFO - epoch complete!
2024-04-24 17:16:45,018 - INFO - evaluating now!
2024-04-24 17:16:45,299 - INFO - Epoch [21/200] train_loss: 4.5857, val_loss: 5.3802, lr: 0.003000, 4.64s
2024-04-24 17:16:49,688 - INFO - epoch complete!
2024-04-24 17:16:49,688 - INFO - evaluating now!
2024-04-24 17:16:49,907 - INFO - Epoch [22/200] train_loss: 4.4951, val_loss: 5.2309, lr: 0.003000, 4.61s
2024-04-24 17:16:54,189 - INFO - epoch complete!
2024-04-24 17:16:54,189 - INFO - evaluating now!
2024-04-24 17:16:54,407 - INFO - Epoch [23/200] train_loss: 4.3886, val_loss: 5.2217, lr: 0.003000, 4.50s
2024-04-24 17:16:58,629 - INFO - epoch complete!
2024-04-24 17:16:58,629 - INFO - evaluating now!
2024-04-24 17:16:58,847 - INFO - Epoch [24/200] train_loss: 4.4189, val_loss: 5.3036, lr: 0.003000, 4.44s
2024-04-24 17:17:03,337 - INFO - epoch complete!
2024-04-24 17:17:03,337 - INFO - evaluating now!
2024-04-24 17:17:03,556 - INFO - Epoch [25/200] train_loss: 4.3877, val_loss: 5.2872, lr: 0.003000, 4.71s
2024-04-24 17:17:07,846 - INFO - epoch complete!
2024-04-24 17:17:07,846 - INFO - evaluating now!
2024-04-24 17:17:08,064 - INFO - Epoch [26/200] train_loss: 4.3513, val_loss: 5.2678, lr: 0.003000, 4.51s
2024-04-24 17:17:12,392 - INFO - epoch complete!
2024-04-24 17:17:12,392 - INFO - evaluating now!
2024-04-24 17:17:12,611 - INFO - Epoch [27/200] train_loss: 4.2845, val_loss: 5.0977, lr: 0.003000, 4.55s
2024-04-24 17:17:16,964 - INFO - epoch complete!
2024-04-24 17:17:16,964 - INFO - evaluating now!
2024-04-24 17:17:17,199 - INFO - Epoch [28/200] train_loss: 4.2371, val_loss: 5.1241, lr: 0.003000, 4.59s
2024-04-24 17:17:21,507 - INFO - epoch complete!
2024-04-24 17:17:21,507 - INFO - evaluating now!
2024-04-24 17:17:21,742 - INFO - Epoch [29/200] train_loss: 4.2050, val_loss: 5.2493, lr: 0.003000, 4.54s
2024-04-24 17:17:26,206 - INFO - epoch complete!
2024-04-24 17:17:26,207 - INFO - evaluating now!
2024-04-24 17:17:26,431 - INFO - Epoch [30/200] train_loss: 4.1804, val_loss: 5.2683, lr: 0.003000, 4.69s
2024-04-24 17:17:30,749 - INFO - epoch complete!
2024-04-24 17:17:30,749 - INFO - evaluating now!
2024-04-24 17:17:30,983 - INFO - Epoch [31/200] train_loss: 4.1228, val_loss: 5.1226, lr: 0.003000, 4.55s
2024-04-24 17:17:35,352 - INFO - epoch complete!
2024-04-24 17:17:35,352 - INFO - evaluating now!
2024-04-24 17:17:35,586 - INFO - Epoch [32/200] train_loss: 4.1279, val_loss: 5.1589, lr: 0.003000, 4.60s
2024-04-24 17:17:39,924 - INFO - epoch complete!
2024-04-24 17:17:39,924 - INFO - evaluating now!
2024-04-24 17:17:40,142 - INFO - Epoch [33/200] train_loss: 4.0959, val_loss: 5.1104, lr: 0.003000, 4.56s
2024-04-24 17:17:44,548 - INFO - epoch complete!
2024-04-24 17:17:44,548 - INFO - evaluating now!
2024-04-24 17:17:44,767 - INFO - Epoch [34/200] train_loss: 4.0284, val_loss: 5.0148, lr: 0.003000, 4.62s
2024-04-24 17:17:44,782 - INFO - Saved model at 34
2024-04-24 17:17:44,782 - INFO - Val loss decrease from 5.0862 to 5.0148, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-04-24 17:17:49,190 - INFO - epoch complete!
2024-04-24 17:17:49,190 - INFO - evaluating now!
2024-04-24 17:17:49,424 - INFO - Epoch [35/200] train_loss: 3.9858, val_loss: 5.0740, lr: 0.003000, 4.64s
2024-04-24 17:17:53,771 - INFO - epoch complete!
2024-04-24 17:17:53,771 - INFO - evaluating now!
2024-04-24 17:17:53,990 - INFO - Epoch [36/200] train_loss: 3.9701, val_loss: 5.1255, lr: 0.003000, 4.57s
2024-04-24 17:17:58,295 - INFO - epoch complete!
2024-04-24 17:17:58,295 - INFO - evaluating now!
2024-04-24 17:17:58,513 - INFO - Epoch [37/200] train_loss: 3.9468, val_loss: 5.1674, lr: 0.003000, 4.52s
2024-04-24 17:18:02,796 - INFO - epoch complete!
2024-04-24 17:18:02,796 - INFO - evaluating now!
2024-04-24 17:18:03,014 - INFO - Epoch [38/200] train_loss: 3.8940, val_loss: 5.1241, lr: 0.003000, 4.50s
2024-04-24 17:18:07,343 - INFO - epoch complete!
2024-04-24 17:18:07,343 - INFO - evaluating now!
2024-04-24 17:18:07,562 - INFO - Epoch [39/200] train_loss: 3.8842, val_loss: 5.1768, lr: 0.003000, 4.55s
2024-04-24 17:18:12,003 - INFO - epoch complete!
2024-04-24 17:18:12,004 - INFO - evaluating now!
2024-04-24 17:18:12,235 - INFO - Epoch [40/200] train_loss: 3.8922, val_loss: 4.9991, lr: 0.003000, 4.67s
2024-04-24 17:18:12,249 - INFO - Saved model at 40
2024-04-24 17:18:12,249 - INFO - Val loss decrease from 5.0148 to 4.9991, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-04-24 17:18:16,769 - INFO - epoch complete!
2024-04-24 17:18:16,769 - INFO - evaluating now!
2024-04-24 17:18:16,991 - INFO - Epoch [41/200] train_loss: 3.8531, val_loss: 5.1165, lr: 0.003000, 4.74s
2024-04-24 17:18:21,599 - INFO - epoch complete!
2024-04-24 17:18:21,600 - INFO - evaluating now!
2024-04-24 17:18:21,838 - INFO - Epoch [42/200] train_loss: 3.8646, val_loss: 5.2452, lr: 0.003000, 4.85s
2024-04-24 17:18:26,285 - INFO - epoch complete!
2024-04-24 17:18:26,285 - INFO - evaluating now!
2024-04-24 17:18:26,547 - INFO - Epoch [43/200] train_loss: 3.8290, val_loss: 4.9815, lr: 0.003000, 4.71s
2024-04-24 17:18:26,562 - INFO - Saved model at 43
2024-04-24 17:18:26,562 - INFO - Val loss decrease from 4.9991 to 4.9815, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-04-24 17:18:31,170 - INFO - epoch complete!
2024-04-24 17:18:31,171 - INFO - evaluating now!
2024-04-24 17:18:31,415 - INFO - Epoch [44/200] train_loss: 3.7739, val_loss: 5.0697, lr: 0.003000, 4.85s
2024-04-24 17:18:35,932 - INFO - epoch complete!
2024-04-24 17:18:35,934 - INFO - evaluating now!
2024-04-24 17:18:36,176 - INFO - Epoch [45/200] train_loss: 3.7782, val_loss: 5.1661, lr: 0.003000, 4.76s
2024-04-24 17:18:40,633 - INFO - epoch complete!
2024-04-24 17:18:40,639 - INFO - evaluating now!
2024-04-24 17:18:40,869 - INFO - Epoch [46/200] train_loss: 3.7587, val_loss: 5.1395, lr: 0.003000, 4.69s
2024-04-24 17:18:45,380 - INFO - epoch complete!
2024-04-24 17:18:45,380 - INFO - evaluating now!
2024-04-24 17:18:45,628 - INFO - Epoch [47/200] train_loss: 3.7337, val_loss: 5.1917, lr: 0.003000, 4.76s
2024-04-24 17:18:50,090 - INFO - epoch complete!
2024-04-24 17:18:50,090 - INFO - evaluating now!
2024-04-24 17:18:50,320 - INFO - Epoch [48/200] train_loss: 3.7453, val_loss: 5.0074, lr: 0.003000, 4.69s
2024-04-24 17:18:54,843 - INFO - epoch complete!
2024-04-24 17:18:54,843 - INFO - evaluating now!
2024-04-24 17:18:55,092 - INFO - Epoch [49/200] train_loss: 3.6972, val_loss: 5.0404, lr: 0.003000, 4.77s
2024-04-24 17:18:59,578 - INFO - epoch complete!
2024-04-24 17:18:59,578 - INFO - evaluating now!
2024-04-24 17:18:59,802 - INFO - Epoch [50/200] train_loss: 3.6825, val_loss: 5.1045, lr: 0.003000, 4.71s
2024-04-24 17:19:04,179 - INFO - epoch complete!
2024-04-24 17:19:04,179 - INFO - evaluating now!
2024-04-24 17:19:04,409 - INFO - Epoch [51/200] train_loss: 3.6858, val_loss: 5.0123, lr: 0.003000, 4.61s
2024-04-24 17:19:09,352 - INFO - epoch complete!
2024-04-24 17:19:09,352 - INFO - evaluating now!
2024-04-24 17:19:09,571 - INFO - Epoch [52/200] train_loss: 3.6281, val_loss: 5.0969, lr: 0.003000, 5.16s
2024-04-24 17:19:14,157 - INFO - epoch complete!
2024-04-24 17:19:14,158 - INFO - evaluating now!
2024-04-24 17:19:14,385 - INFO - Epoch [53/200] train_loss: 3.6536, val_loss: 5.0832, lr: 0.003000, 4.80s
2024-04-24 17:19:18,917 - INFO - epoch complete!
2024-04-24 17:19:18,917 - INFO - evaluating now!
2024-04-24 17:19:19,151 - INFO - Epoch [54/200] train_loss: 3.6181, val_loss: 4.9737, lr: 0.003000, 4.77s
2024-04-24 17:19:19,167 - INFO - Saved model at 54
2024-04-24 17:19:19,167 - INFO - Val loss decrease from 4.9815 to 4.9737, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch54.tar
2024-04-24 17:19:23,541 - INFO - epoch complete!
2024-04-24 17:19:23,541 - INFO - evaluating now!
2024-04-24 17:19:23,759 - INFO - Epoch [55/200] train_loss: 3.5973, val_loss: 5.0913, lr: 0.003000, 4.59s
2024-04-24 17:19:28,091 - INFO - epoch complete!
2024-04-24 17:19:28,091 - INFO - evaluating now!
2024-04-24 17:19:28,330 - INFO - Epoch [56/200] train_loss: 3.5738, val_loss: 4.9953, lr: 0.003000, 4.57s
2024-04-24 17:19:32,617 - INFO - epoch complete!
2024-04-24 17:19:32,617 - INFO - evaluating now!
2024-04-24 17:19:32,835 - INFO - Epoch [57/200] train_loss: 3.5390, val_loss: 4.9708, lr: 0.003000, 4.51s
2024-04-24 17:19:32,851 - INFO - Saved model at 57
2024-04-24 17:19:32,851 - INFO - Val loss decrease from 4.9737 to 4.9708, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch57.tar
2024-04-24 17:19:37,094 - INFO - epoch complete!
2024-04-24 17:19:37,096 - INFO - evaluating now!
2024-04-24 17:19:37,306 - INFO - Epoch [58/200] train_loss: 3.5509, val_loss: 4.9420, lr: 0.003000, 4.46s
2024-04-24 17:19:37,322 - INFO - Saved model at 58
2024-04-24 17:19:37,322 - INFO - Val loss decrease from 4.9708 to 4.9420, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch58.tar
2024-04-24 17:19:41,545 - INFO - epoch complete!
2024-04-24 17:19:41,545 - INFO - evaluating now!
2024-04-24 17:19:41,780 - INFO - Epoch [59/200] train_loss: 3.5262, val_loss: 5.1063, lr: 0.003000, 4.46s
2024-04-24 17:19:46,047 - INFO - epoch complete!
2024-04-24 17:19:46,047 - INFO - evaluating now!
2024-04-24 17:19:46,266 - INFO - Epoch [60/200] train_loss: 3.5118, val_loss: 5.0964, lr: 0.003000, 4.49s
2024-04-24 17:19:50,717 - INFO - epoch complete!
2024-04-24 17:19:50,717 - INFO - evaluating now!
2024-04-24 17:19:50,967 - INFO - Epoch [61/200] train_loss: 3.5241, val_loss: 5.0721, lr: 0.003000, 4.70s
2024-04-24 17:19:55,407 - INFO - epoch complete!
2024-04-24 17:19:55,407 - INFO - evaluating now!
2024-04-24 17:19:55,641 - INFO - Epoch [62/200] train_loss: 3.5139, val_loss: 4.9186, lr: 0.003000, 4.67s
2024-04-24 17:19:55,657 - INFO - Saved model at 62
2024-04-24 17:19:55,657 - INFO - Val loss decrease from 4.9420 to 4.9186, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch62.tar
2024-04-24 17:20:00,051 - INFO - epoch complete!
2024-04-24 17:20:00,051 - INFO - evaluating now!
2024-04-24 17:20:00,270 - INFO - Epoch [63/200] train_loss: 3.4674, val_loss: 5.1088, lr: 0.003000, 4.61s
2024-04-24 17:20:04,552 - INFO - epoch complete!
2024-04-24 17:20:04,552 - INFO - evaluating now!
2024-04-24 17:20:04,771 - INFO - Epoch [64/200] train_loss: 3.4736, val_loss: 4.9992, lr: 0.003000, 4.50s
2024-04-24 17:20:08,958 - INFO - epoch complete!
2024-04-24 17:20:08,958 - INFO - evaluating now!
2024-04-24 17:20:09,176 - INFO - Epoch [65/200] train_loss: 3.4637, val_loss: 5.1289, lr: 0.003000, 4.41s
2024-04-24 17:20:13,364 - INFO - epoch complete!
2024-04-24 17:20:13,364 - INFO - evaluating now!
2024-04-24 17:20:13,583 - INFO - Epoch [66/200] train_loss: 3.4831, val_loss: 4.9984, lr: 0.003000, 4.41s
2024-04-24 17:20:17,785 - INFO - epoch complete!
2024-04-24 17:20:17,785 - INFO - evaluating now!
2024-04-24 17:20:17,988 - INFO - Epoch [67/200] train_loss: 3.4548, val_loss: 5.0522, lr: 0.003000, 4.41s
2024-04-24 17:20:22,191 - INFO - epoch complete!
2024-04-24 17:20:22,191 - INFO - evaluating now!
2024-04-24 17:20:22,410 - INFO - Epoch [68/200] train_loss: 3.4450, val_loss: 5.0233, lr: 0.003000, 4.42s
2024-04-24 17:20:26,597 - INFO - epoch complete!
2024-04-24 17:20:26,597 - INFO - evaluating now!
2024-04-24 17:20:26,816 - INFO - Epoch [69/200] train_loss: 3.4227, val_loss: 5.0680, lr: 0.003000, 4.41s
2024-04-24 17:20:31,019 - INFO - epoch complete!
2024-04-24 17:20:31,019 - INFO - evaluating now!
2024-04-24 17:20:31,238 - INFO - Epoch [70/200] train_loss: 3.4102, val_loss: 5.0355, lr: 0.003000, 4.42s
2024-04-24 17:20:35,519 - INFO - epoch complete!
2024-04-24 17:20:35,519 - INFO - evaluating now!
2024-04-24 17:20:35,753 - INFO - Epoch [71/200] train_loss: 3.3729, val_loss: 4.9679, lr: 0.003000, 4.52s
2024-04-24 17:20:40,205 - INFO - epoch complete!
2024-04-24 17:20:40,205 - INFO - evaluating now!
2024-04-24 17:20:40,451 - INFO - Epoch [72/200] train_loss: 3.4018, val_loss: 5.1516, lr: 0.003000, 4.70s
2024-04-24 17:20:44,937 - INFO - epoch complete!
2024-04-24 17:20:44,937 - INFO - evaluating now!
2024-04-24 17:20:45,174 - INFO - Epoch [73/200] train_loss: 3.4192, val_loss: 5.0395, lr: 0.003000, 4.72s
2024-04-24 17:20:49,697 - INFO - epoch complete!
2024-04-24 17:20:49,697 - INFO - evaluating now!
2024-04-24 17:20:49,933 - INFO - Epoch [74/200] train_loss: 3.3873, val_loss: 4.9322, lr: 0.003000, 4.76s
2024-04-24 17:20:54,394 - INFO - epoch complete!
2024-04-24 17:20:54,394 - INFO - evaluating now!
2024-04-24 17:20:54,659 - INFO - Epoch [75/200] train_loss: 3.3600, val_loss: 4.9192, lr: 0.003000, 4.73s
2024-04-24 17:20:59,226 - INFO - epoch complete!
2024-04-24 17:20:59,226 - INFO - evaluating now!
2024-04-24 17:20:59,468 - INFO - Epoch [76/200] train_loss: 3.3280, val_loss: 5.0363, lr: 0.003000, 4.81s
2024-04-24 17:21:04,235 - INFO - epoch complete!
2024-04-24 17:21:04,236 - INFO - evaluating now!
2024-04-24 17:21:04,459 - INFO - Epoch [77/200] train_loss: 3.3441, val_loss: 5.0874, lr: 0.003000, 4.99s
2024-04-24 17:21:04,459 - WARNING - Early stopping at epoch: 77
2024-04-24 17:21:04,459 - INFO - Trained totally 78 epochs, average train time is 4.379s, average eval time is 0.229s
2024-04-24 17:21:04,467 - INFO - Loaded model at 62
2024-04-24 17:21:04,469 - INFO - Saved model at ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406.m
2024-04-24 17:21:04,483 - INFO - Start evaluating ...
2024-04-24 17:21:05,319 - INFO - Note that you select the single mode to evaluate!
2024-04-24 17:21:05,323 - INFO - Evaluate result is saved at ./libcity/cache/4/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-24 17:21:05,325 - INFO - 
         MAE       RMSE
1   2.425505   7.406904
2   2.451481   7.666263
3   2.673751   8.924689
4   2.826959  10.013276
5   2.944658  11.050618
6   3.060838  11.968384
7   3.151416  12.442049
8   3.266382  12.916754
9   3.363385  13.245315
10  3.480272  13.611792
11  3.516340  14.346223
12  3.646206  15.238609
2024-04-24 17:21:05,330 - INFO - ----------------------------------------------------------------------------
2024-04-24 17:21:05,331 - INFO - Kownledge Graph Embedding: None, Experiment ids: [0, 1, 2, 3, 4]
2024-04-24 17:21:05,336 - INFO - ----------------------------------------------------------------------------
2024-04-24 17:21:05,338 - INFO - Average: 
         MAE       RMSE
0   2.434666   7.283184
1   2.468846   7.704733
2   2.686903   8.930756
3   2.861544   9.981807
4   3.021114  11.053188
5   3.114263  11.936358
6   3.186800  12.538813
7   3.250810  12.979554
8   3.322800  13.199687
9   3.368808  13.417543
10  3.432454  13.782110
11  3.574872  14.420435 
2024-04-24 17:21:05,340 - INFO - Standard deviation: 
         MAE      RMSE
0   0.090794  0.431877
1   0.046959  0.300150
2   0.080649  0.295663
3   0.117998  0.337185
4   0.124158  0.377081
5   0.115196  0.392203
6   0.126967  0.416421
7   0.126492  0.471775
8   0.113910  0.481096
9   0.113888  0.461727
10  0.103408  0.566199
11  0.098939  0.726629
2024-04-24 17:21:05,344 - INFO - ----------------------------------------------------------------------------
2024-04-24 17:21:05,347 - INFO - 12 steps Average: 
        MAE       RMSE
0  3.060323  11.435681
2024-04-24 17:21:05,349 - INFO - 12 steps Standard deviation: 
        MAE      RMSE
0  0.104947  0.438167
