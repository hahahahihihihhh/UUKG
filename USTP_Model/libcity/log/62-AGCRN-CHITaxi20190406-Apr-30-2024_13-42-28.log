2024-04-30 13:42:28,563 - INFO - Log directory: ./libcity/log
2024-04-30 13:42:28,564 - INFO - Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=62
2024-04-30 13:42:28,564 - INFO - {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 161843251, 'exp_id': 62, 'load_external': True, 'embedding_model': 'RandomE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 13:42:28,566 - INFO - Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 13:42:28,571 - INFO - set_weight_link_or_dist: dist
2024-04-30 13:42:28,571 - INFO - init_weight_inf_or_zero: inf
2024-04-30 13:42:28,584 - INFO - Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 13:42:28,584 - INFO - Start Calculate the weight by Gauss kernel!
2024-04-30 13:42:28,584 - INFO - Loading file CHITaxi20190406.dyna
2024-04-30 13:42:28,712 - INFO - Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 13:42:30,717 - INFO - Dataset created
2024-04-30 13:42:30,717 - INFO - x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 13:42:30,820 - INFO - train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 13:42:30,820 - INFO - eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 13:42:30,820 - INFO - test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 13:42:30,940 - INFO - StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 13:42:30,940 - INFO - NoneScaler
2024-04-30 13:42:32,606 - INFO - AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 13:42:32,606 - INFO - node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 13:42:32,606 - INFO - encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 13:42:32,607 - INFO - encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 13:42:32,607 - INFO - encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 13:42:32,607 - INFO - encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 13:42:32,607 - INFO - encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 13:42:32,607 - INFO - encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 13:42:32,608 - INFO - encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 13:42:32,608 - INFO - encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 13:42:32,608 - INFO - end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 13:42:32,608 - INFO - end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 13:42:32,608 - INFO - Total parameter numbers: 874010
2024-04-30 13:42:32,608 - INFO - You select `adam` optimizer.
2024-04-30 13:42:32,609 - WARNING - Received none train loss func and will use the loss func defined in the model.
2024-04-30 13:42:32,609 - INFO - Start training ...
2024-04-30 13:42:32,609 - INFO - num_batches:48
2024-04-30 13:42:37,781 - INFO - epoch complete!
2024-04-30 13:42:37,781 - INFO - evaluating now!
2024-04-30 13:42:38,122 - INFO - Epoch [0/200] train_loss: 24.2974, val_loss: 17.0333, lr: 0.003000, 5.51s
2024-04-30 13:42:38,137 - INFO - Saved model at 0
2024-04-30 13:42:38,137 - INFO - Val loss decrease from inf to 17.0333, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 13:42:43,121 - INFO - epoch complete!
2024-04-30 13:42:43,121 - INFO - evaluating now!
2024-04-30 13:42:43,472 - INFO - Epoch [1/200] train_loss: 13.6850, val_loss: 12.8007, lr: 0.003000, 5.33s
2024-04-30 13:42:43,486 - INFO - Saved model at 1
2024-04-30 13:42:43,486 - INFO - Val loss decrease from 17.0333 to 12.8007, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 13:42:48,495 - INFO - epoch complete!
2024-04-30 13:42:48,496 - INFO - evaluating now!
2024-04-30 13:42:48,816 - INFO - Epoch [2/200] train_loss: 10.6674, val_loss: 10.1027, lr: 0.003000, 5.33s
2024-04-30 13:42:48,831 - INFO - Saved model at 2
2024-04-30 13:42:48,831 - INFO - Val loss decrease from 12.8007 to 10.1027, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 13:42:53,846 - INFO - epoch complete!
2024-04-30 13:42:53,846 - INFO - evaluating now!
2024-04-30 13:42:54,198 - INFO - Epoch [3/200] train_loss: 8.8392, val_loss: 8.4110, lr: 0.003000, 5.37s
2024-04-30 13:42:54,214 - INFO - Saved model at 3
2024-04-30 13:42:54,214 - INFO - Val loss decrease from 10.1027 to 8.4110, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 13:42:59,134 - INFO - epoch complete!
2024-04-30 13:42:59,135 - INFO - evaluating now!
2024-04-30 13:42:59,456 - INFO - Epoch [4/200] train_loss: 7.5733, val_loss: 7.3804, lr: 0.003000, 5.24s
2024-04-30 13:42:59,491 - INFO - Saved model at 4
2024-04-30 13:42:59,491 - INFO - Val loss decrease from 8.4110 to 7.3804, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 13:43:04,459 - INFO - epoch complete!
2024-04-30 13:43:04,460 - INFO - evaluating now!
2024-04-30 13:43:04,793 - INFO - Epoch [5/200] train_loss: 6.9777, val_loss: 6.9025, lr: 0.003000, 5.30s
2024-04-30 13:43:04,809 - INFO - Saved model at 5
2024-04-30 13:43:04,809 - INFO - Val loss decrease from 7.3804 to 6.9025, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 13:43:09,801 - INFO - epoch complete!
2024-04-30 13:43:09,801 - INFO - evaluating now!
2024-04-30 13:43:10,116 - INFO - Epoch [6/200] train_loss: 6.4022, val_loss: 6.6853, lr: 0.003000, 5.31s
2024-04-30 13:43:10,132 - INFO - Saved model at 6
2024-04-30 13:43:10,132 - INFO - Val loss decrease from 6.9025 to 6.6853, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 13:43:14,951 - INFO - epoch complete!
2024-04-30 13:43:14,951 - INFO - evaluating now!
2024-04-30 13:43:15,283 - INFO - Epoch [7/200] train_loss: 6.2421, val_loss: 6.4182, lr: 0.003000, 5.15s
2024-04-30 13:43:15,295 - INFO - Saved model at 7
2024-04-30 13:43:15,295 - INFO - Val loss decrease from 6.6853 to 6.4182, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 13:43:20,225 - INFO - epoch complete!
2024-04-30 13:43:20,225 - INFO - evaluating now!
2024-04-30 13:43:20,552 - INFO - Epoch [8/200] train_loss: 5.9156, val_loss: 6.0319, lr: 0.003000, 5.26s
2024-04-30 13:43:20,571 - INFO - Saved model at 8
2024-04-30 13:43:20,571 - INFO - Val loss decrease from 6.4182 to 6.0319, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 13:43:25,659 - INFO - epoch complete!
2024-04-30 13:43:25,659 - INFO - evaluating now!
2024-04-30 13:43:25,985 - INFO - Epoch [9/200] train_loss: 5.6707, val_loss: 5.8308, lr: 0.003000, 5.41s
2024-04-30 13:43:25,999 - INFO - Saved model at 9
2024-04-30 13:43:25,999 - INFO - Val loss decrease from 6.0319 to 5.8308, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 13:43:30,987 - INFO - epoch complete!
2024-04-30 13:43:30,988 - INFO - evaluating now!
2024-04-30 13:43:31,309 - INFO - Epoch [10/200] train_loss: 5.5183, val_loss: 5.8872, lr: 0.003000, 5.31s
2024-04-30 13:43:36,332 - INFO - epoch complete!
2024-04-30 13:43:36,332 - INFO - evaluating now!
2024-04-30 13:43:36,654 - INFO - Epoch [11/200] train_loss: 5.3861, val_loss: 5.5589, lr: 0.003000, 5.35s
2024-04-30 13:43:36,668 - INFO - Saved model at 11
2024-04-30 13:43:36,668 - INFO - Val loss decrease from 5.8308 to 5.5589, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 13:43:41,544 - INFO - epoch complete!
2024-04-30 13:43:41,544 - INFO - evaluating now!
2024-04-30 13:43:41,860 - INFO - Epoch [12/200] train_loss: 5.2360, val_loss: 5.6918, lr: 0.003000, 5.19s
2024-04-30 13:43:46,909 - INFO - epoch complete!
2024-04-30 13:43:46,909 - INFO - evaluating now!
2024-04-30 13:43:47,252 - INFO - Epoch [13/200] train_loss: 5.1414, val_loss: 5.5398, lr: 0.003000, 5.39s
2024-04-30 13:43:47,268 - INFO - Saved model at 13
2024-04-30 13:43:47,268 - INFO - Val loss decrease from 5.5589 to 5.5398, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 13:43:52,227 - INFO - epoch complete!
2024-04-30 13:43:52,228 - INFO - evaluating now!
2024-04-30 13:43:52,551 - INFO - Epoch [14/200] train_loss: 5.0591, val_loss: 5.4575, lr: 0.003000, 5.28s
2024-04-30 13:43:52,565 - INFO - Saved model at 14
2024-04-30 13:43:52,565 - INFO - Val loss decrease from 5.5398 to 5.4575, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 13:43:57,532 - INFO - epoch complete!
2024-04-30 13:43:57,532 - INFO - evaluating now!
2024-04-30 13:43:57,853 - INFO - Epoch [15/200] train_loss: 4.9243, val_loss: 5.3623, lr: 0.003000, 5.29s
2024-04-30 13:43:57,867 - INFO - Saved model at 15
2024-04-30 13:43:57,867 - INFO - Val loss decrease from 5.4575 to 5.3623, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 13:44:02,855 - INFO - epoch complete!
2024-04-30 13:44:02,855 - INFO - evaluating now!
2024-04-30 13:44:03,210 - INFO - Epoch [16/200] train_loss: 4.9240, val_loss: 5.1952, lr: 0.003000, 5.34s
2024-04-30 13:44:03,226 - INFO - Saved model at 16
2024-04-30 13:44:03,226 - INFO - Val loss decrease from 5.3623 to 5.1952, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 13:44:08,144 - INFO - epoch complete!
2024-04-30 13:44:08,145 - INFO - evaluating now!
2024-04-30 13:44:08,475 - INFO - Epoch [17/200] train_loss: 4.7578, val_loss: 5.2881, lr: 0.003000, 5.25s
2024-04-30 13:44:13,402 - INFO - epoch complete!
2024-04-30 13:44:13,403 - INFO - evaluating now!
2024-04-30 13:44:13,729 - INFO - Epoch [18/200] train_loss: 4.7108, val_loss: 5.5329, lr: 0.003000, 5.25s
2024-04-30 13:44:18,615 - INFO - epoch complete!
2024-04-30 13:44:18,615 - INFO - evaluating now!
2024-04-30 13:44:18,933 - INFO - Epoch [19/200] train_loss: 4.6918, val_loss: 5.3062, lr: 0.003000, 5.20s
2024-04-30 13:44:23,923 - INFO - epoch complete!
2024-04-30 13:44:23,923 - INFO - evaluating now!
2024-04-30 13:44:24,246 - INFO - Epoch [20/200] train_loss: 4.5725, val_loss: 5.2413, lr: 0.003000, 5.31s
2024-04-30 13:44:29,261 - INFO - epoch complete!
2024-04-30 13:44:29,261 - INFO - evaluating now!
2024-04-30 13:44:29,591 - INFO - Epoch [21/200] train_loss: 4.5443, val_loss: 5.0867, lr: 0.003000, 5.35s
2024-04-30 13:44:29,613 - INFO - Saved model at 21
2024-04-30 13:44:29,613 - INFO - Val loss decrease from 5.1952 to 5.0867, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-30 13:44:34,586 - INFO - epoch complete!
2024-04-30 13:44:34,586 - INFO - evaluating now!
2024-04-30 13:44:34,954 - INFO - Epoch [22/200] train_loss: 4.5097, val_loss: 5.2482, lr: 0.003000, 5.34s
2024-04-30 13:44:39,942 - INFO - epoch complete!
2024-04-30 13:44:39,942 - INFO - evaluating now!
2024-04-30 13:44:40,290 - INFO - Epoch [23/200] train_loss: 4.4959, val_loss: 5.2304, lr: 0.003000, 5.34s
2024-04-30 13:44:45,235 - INFO - epoch complete!
2024-04-30 13:44:45,235 - INFO - evaluating now!
2024-04-30 13:44:45,560 - INFO - Epoch [24/200] train_loss: 4.3917, val_loss: 5.1413, lr: 0.003000, 5.27s
2024-04-30 13:44:50,554 - INFO - epoch complete!
2024-04-30 13:44:50,555 - INFO - evaluating now!
2024-04-30 13:44:50,875 - INFO - Epoch [25/200] train_loss: 4.3568, val_loss: 5.1167, lr: 0.003000, 5.31s
2024-04-30 13:44:55,872 - INFO - epoch complete!
2024-04-30 13:44:55,872 - INFO - evaluating now!
2024-04-30 13:44:56,191 - INFO - Epoch [26/200] train_loss: 4.2916, val_loss: 5.2066, lr: 0.003000, 5.32s
2024-04-30 13:45:01,123 - INFO - epoch complete!
2024-04-30 13:45:01,123 - INFO - evaluating now!
2024-04-30 13:45:01,445 - INFO - Epoch [27/200] train_loss: 4.2681, val_loss: 5.2578, lr: 0.003000, 5.25s
2024-04-30 13:45:06,345 - INFO - epoch complete!
2024-04-30 13:45:06,345 - INFO - evaluating now!
2024-04-30 13:45:06,667 - INFO - Epoch [28/200] train_loss: 4.1915, val_loss: 5.2233, lr: 0.003000, 5.22s
2024-04-30 13:45:11,794 - INFO - epoch complete!
2024-04-30 13:45:11,795 - INFO - evaluating now!
2024-04-30 13:45:12,132 - INFO - Epoch [29/200] train_loss: 4.1930, val_loss: 5.0768, lr: 0.003000, 5.46s
2024-04-30 13:45:12,164 - INFO - Saved model at 29
2024-04-30 13:45:12,164 - INFO - Val loss decrease from 5.0867 to 5.0768, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-04-30 13:45:17,076 - INFO - epoch complete!
2024-04-30 13:45:17,077 - INFO - evaluating now!
2024-04-30 13:45:17,397 - INFO - Epoch [30/200] train_loss: 4.1845, val_loss: 5.1775, lr: 0.003000, 5.23s
2024-04-30 13:45:22,400 - INFO - epoch complete!
2024-04-30 13:45:22,400 - INFO - evaluating now!
2024-04-30 13:45:22,724 - INFO - Epoch [31/200] train_loss: 4.1335, val_loss: 5.1398, lr: 0.003000, 5.33s
2024-04-30 13:45:27,707 - INFO - epoch complete!
2024-04-30 13:45:27,708 - INFO - evaluating now!
2024-04-30 13:45:28,029 - INFO - Epoch [32/200] train_loss: 4.1755, val_loss: 5.1692, lr: 0.003000, 5.30s
2024-04-30 13:45:33,178 - INFO - epoch complete!
2024-04-30 13:45:33,178 - INFO - evaluating now!
2024-04-30 13:45:33,520 - INFO - Epoch [33/200] train_loss: 4.0577, val_loss: 5.0087, lr: 0.003000, 5.49s
2024-04-30 13:45:33,534 - INFO - Saved model at 33
2024-04-30 13:45:33,534 - INFO - Val loss decrease from 5.0768 to 5.0087, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-04-30 13:45:38,511 - INFO - epoch complete!
2024-04-30 13:45:38,511 - INFO - evaluating now!
2024-04-30 13:45:38,852 - INFO - Epoch [34/200] train_loss: 4.0075, val_loss: 5.0762, lr: 0.003000, 5.32s
2024-04-30 13:45:43,793 - INFO - epoch complete!
2024-04-30 13:45:43,793 - INFO - evaluating now!
2024-04-30 13:45:44,108 - INFO - Epoch [35/200] train_loss: 4.0050, val_loss: 4.9456, lr: 0.003000, 5.26s
2024-04-30 13:45:44,123 - INFO - Saved model at 35
2024-04-30 13:45:44,123 - INFO - Val loss decrease from 5.0087 to 4.9456, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-04-30 13:45:49,195 - INFO - epoch complete!
2024-04-30 13:45:49,196 - INFO - evaluating now!
2024-04-30 13:45:49,567 - INFO - Epoch [36/200] train_loss: 3.9723, val_loss: 5.1473, lr: 0.003000, 5.44s
2024-04-30 13:45:54,438 - INFO - epoch complete!
2024-04-30 13:45:54,439 - INFO - evaluating now!
2024-04-30 13:45:54,756 - INFO - Epoch [37/200] train_loss: 3.9130, val_loss: 5.0543, lr: 0.003000, 5.19s
2024-04-30 13:45:59,719 - INFO - epoch complete!
2024-04-30 13:45:59,719 - INFO - evaluating now!
2024-04-30 13:46:00,071 - INFO - Epoch [38/200] train_loss: 3.9046, val_loss: 4.9310, lr: 0.003000, 5.31s
2024-04-30 13:46:00,086 - INFO - Saved model at 38
2024-04-30 13:46:00,086 - INFO - Val loss decrease from 4.9456 to 4.9310, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-04-30 13:46:05,170 - INFO - epoch complete!
2024-04-30 13:46:05,171 - INFO - evaluating now!
2024-04-30 13:46:05,493 - INFO - Epoch [39/200] train_loss: 3.8565, val_loss: 5.0307, lr: 0.003000, 5.41s
2024-04-30 13:46:10,446 - INFO - epoch complete!
2024-04-30 13:46:10,446 - INFO - evaluating now!
2024-04-30 13:46:10,778 - INFO - Epoch [40/200] train_loss: 3.8434, val_loss: 5.0283, lr: 0.003000, 5.28s
2024-04-30 13:46:16,079 - INFO - epoch complete!
2024-04-30 13:46:16,080 - INFO - evaluating now!
2024-04-30 13:46:16,398 - INFO - Epoch [41/200] train_loss: 3.8811, val_loss: 5.1278, lr: 0.003000, 5.62s
2024-04-30 13:46:21,436 - INFO - epoch complete!
2024-04-30 13:46:21,436 - INFO - evaluating now!
2024-04-30 13:46:21,756 - INFO - Epoch [42/200] train_loss: 3.8179, val_loss: 5.0839, lr: 0.003000, 5.36s
2024-04-30 13:46:26,684 - INFO - epoch complete!
2024-04-30 13:46:26,684 - INFO - evaluating now!
2024-04-30 13:46:27,021 - INFO - Epoch [43/200] train_loss: 3.7800, val_loss: 4.9675, lr: 0.003000, 5.26s
2024-04-30 13:46:31,899 - INFO - epoch complete!
2024-04-30 13:46:31,899 - INFO - evaluating now!
2024-04-30 13:46:32,239 - INFO - Epoch [44/200] train_loss: 3.7428, val_loss: 4.9650, lr: 0.003000, 5.22s
2024-04-30 13:46:37,129 - INFO - epoch complete!
2024-04-30 13:46:37,129 - INFO - evaluating now!
2024-04-30 13:46:37,446 - INFO - Epoch [45/200] train_loss: 3.7750, val_loss: 5.0396, lr: 0.003000, 5.21s
2024-04-30 13:46:42,364 - INFO - epoch complete!
2024-04-30 13:46:42,365 - INFO - evaluating now!
2024-04-30 13:46:42,681 - INFO - Epoch [46/200] train_loss: 3.7257, val_loss: 4.9991, lr: 0.003000, 5.24s
2024-04-30 13:46:47,604 - INFO - epoch complete!
2024-04-30 13:46:47,605 - INFO - evaluating now!
2024-04-30 13:46:47,926 - INFO - Epoch [47/200] train_loss: 3.6753, val_loss: 5.0611, lr: 0.003000, 5.24s
2024-04-30 13:46:52,775 - INFO - epoch complete!
2024-04-30 13:46:52,775 - INFO - evaluating now!
2024-04-30 13:46:53,107 - INFO - Epoch [48/200] train_loss: 3.6999, val_loss: 5.0454, lr: 0.003000, 5.18s
2024-04-30 13:46:58,097 - INFO - epoch complete!
2024-04-30 13:46:58,097 - INFO - evaluating now!
2024-04-30 13:46:58,449 - INFO - Epoch [49/200] train_loss: 3.7080, val_loss: 5.0654, lr: 0.003000, 5.34s
2024-04-30 13:47:03,307 - INFO - epoch complete!
2024-04-30 13:47:03,307 - INFO - evaluating now!
2024-04-30 13:47:03,625 - INFO - Epoch [50/200] train_loss: 3.6785, val_loss: 5.1095, lr: 0.003000, 5.18s
2024-04-30 13:47:08,647 - INFO - epoch complete!
2024-04-30 13:47:08,647 - INFO - evaluating now!
2024-04-30 13:47:08,965 - INFO - Epoch [51/200] train_loss: 3.6436, val_loss: 5.0257, lr: 0.003000, 5.34s
2024-04-30 13:47:13,855 - INFO - epoch complete!
2024-04-30 13:47:13,855 - INFO - evaluating now!
2024-04-30 13:47:14,191 - INFO - Epoch [52/200] train_loss: 3.5926, val_loss: 5.1106, lr: 0.003000, 5.23s
2024-04-30 13:47:19,196 - INFO - epoch complete!
2024-04-30 13:47:19,197 - INFO - evaluating now!
2024-04-30 13:47:19,533 - INFO - Epoch [53/200] train_loss: 3.5844, val_loss: 5.1847, lr: 0.003000, 5.34s
2024-04-30 13:47:19,533 - WARNING - Early stopping at epoch: 53
2024-04-30 13:47:19,533 - INFO - Trained totally 54 epochs, average train time is 4.976s, average eval time is 0.330s
2024-04-30 13:47:19,544 - INFO - Loaded model at 38
2024-04-30 13:47:19,545 - INFO - Saved model at ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 13:47:19,561 - INFO - Start evaluating ...
2024-04-30 13:47:20,649 - INFO - Note that you select the single mode to evaluate!
2024-04-30 13:47:20,653 - INFO - Evaluate result is saved at ./libcity/cache/62/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-30 13:47:20,656 - INFO - 
         MAE       RMSE
1   2.358956   8.244007
2   2.456604   8.389101
3   2.612338   9.149607
4   2.767368   9.771390
5   2.939622  10.512023
6   3.001518  11.049467
7   3.030400  11.553320
8   3.077859  11.984326
9   3.109704  12.224664
10  3.149710  12.390594
11  3.188781  12.474319
12  3.348340  12.856530
2024-04-30 13:47:20,726 - INFO - ----------------------------------------------------------------------------
2024-04-30 13:47:20,726 - INFO - # 3, Kownledge Graph Embedding: RandomE, Experiment ids: 63
2024-04-30 13:47:20,727 - INFO - ----------------------------------------------------------------------------
2024-04-30 13:47:20,729 - INFO - Log directory: ./libcity/log
2024-04-30 13:47:20,729 - INFO - Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=63
2024-04-30 13:47:20,730 - INFO - {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 356778723, 'exp_id': 63, 'load_external': True, 'embedding_model': 'RandomE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 13:47:20,732 - INFO - Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 13:47:20,737 - INFO - set_weight_link_or_dist: dist
2024-04-30 13:47:20,737 - INFO - init_weight_inf_or_zero: inf
2024-04-30 13:47:20,749 - INFO - Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 13:47:20,750 - INFO - Start Calculate the weight by Gauss kernel!
2024-04-30 13:47:20,750 - INFO - Loading file CHITaxi20190406.dyna
2024-04-30 13:47:20,878 - INFO - Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 13:47:22,624 - INFO - Dataset created
2024-04-30 13:47:22,624 - INFO - x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 13:47:22,714 - INFO - train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 13:47:22,715 - INFO - eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 13:47:22,715 - INFO - test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 13:47:22,824 - INFO - StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 13:47:22,824 - INFO - NoneScaler
2024-04-30 13:47:24,450 - INFO - AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 13:47:24,450 - INFO - node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 13:47:24,450 - INFO - encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 13:47:24,450 - INFO - encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 13:47:24,451 - INFO - encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 13:47:24,451 - INFO - encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 13:47:24,451 - INFO - encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 13:47:24,451 - INFO - encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 13:47:24,451 - INFO - encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 13:47:24,452 - INFO - encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 13:47:24,452 - INFO - end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 13:47:24,452 - INFO - end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 13:47:24,452 - INFO - Total parameter numbers: 874010
2024-04-30 13:47:24,452 - INFO - You select `adam` optimizer.
2024-04-30 13:47:24,453 - WARNING - Received none train loss func and will use the loss func defined in the model.
2024-04-30 13:47:24,453 - INFO - Start training ...
2024-04-30 13:47:24,453 - INFO - num_batches:48
2024-04-30 13:47:29,552 - INFO - epoch complete!
2024-04-30 13:47:29,553 - INFO - evaluating now!
2024-04-30 13:47:29,868 - INFO - Epoch [0/200] train_loss: 23.3033, val_loss: 16.9743, lr: 0.003000, 5.41s
2024-04-30 13:47:29,883 - INFO - Saved model at 0
2024-04-30 13:47:29,883 - INFO - Val loss decrease from inf to 16.9743, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 13:47:34,791 - INFO - epoch complete!
2024-04-30 13:47:34,792 - INFO - evaluating now!
2024-04-30 13:47:35,158 - INFO - Epoch [1/200] train_loss: 13.1841, val_loss: 11.9581, lr: 0.003000, 5.27s
2024-04-30 13:47:35,174 - INFO - Saved model at 1
2024-04-30 13:47:35,174 - INFO - Val loss decrease from 16.9743 to 11.9581, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 13:47:40,379 - INFO - epoch complete!
2024-04-30 13:47:40,379 - INFO - evaluating now!
2024-04-30 13:47:40,713 - INFO - Epoch [2/200] train_loss: 9.9760, val_loss: 9.0814, lr: 0.003000, 5.54s
2024-04-30 13:47:40,734 - INFO - Saved model at 2
2024-04-30 13:47:40,734 - INFO - Val loss decrease from 11.9581 to 9.0814, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 13:47:45,893 - INFO - epoch complete!
2024-04-30 13:47:45,893 - INFO - evaluating now!
2024-04-30 13:47:46,253 - INFO - Epoch [3/200] train_loss: 8.2008, val_loss: 7.6421, lr: 0.003000, 5.52s
2024-04-30 13:47:46,269 - INFO - Saved model at 3
2024-04-30 13:47:46,269 - INFO - Val loss decrease from 9.0814 to 7.6421, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 13:47:51,445 - INFO - epoch complete!
2024-04-30 13:47:51,445 - INFO - evaluating now!
2024-04-30 13:47:51,767 - INFO - Epoch [4/200] train_loss: 7.3517, val_loss: 7.1257, lr: 0.003000, 5.50s
2024-04-30 13:47:51,783 - INFO - Saved model at 4
2024-04-30 13:47:51,783 - INFO - Val loss decrease from 7.6421 to 7.1257, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 13:47:56,698 - INFO - epoch complete!
2024-04-30 13:47:56,698 - INFO - evaluating now!
2024-04-30 13:47:57,058 - INFO - Epoch [5/200] train_loss: 6.7186, val_loss: 6.4556, lr: 0.003000, 5.27s
2024-04-30 13:47:57,075 - INFO - Saved model at 5
2024-04-30 13:47:57,075 - INFO - Val loss decrease from 7.1257 to 6.4556, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 13:48:02,104 - INFO - epoch complete!
2024-04-30 13:48:02,104 - INFO - evaluating now!
2024-04-30 13:48:02,424 - INFO - Epoch [6/200] train_loss: 6.2570, val_loss: 6.1772, lr: 0.003000, 5.35s
2024-04-30 13:48:02,438 - INFO - Saved model at 6
2024-04-30 13:48:02,438 - INFO - Val loss decrease from 6.4556 to 6.1772, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 13:48:07,282 - INFO - epoch complete!
2024-04-30 13:48:07,282 - INFO - evaluating now!
2024-04-30 13:48:07,604 - INFO - Epoch [7/200] train_loss: 6.0047, val_loss: 6.0450, lr: 0.003000, 5.17s
2024-04-30 13:48:07,616 - INFO - Saved model at 7
2024-04-30 13:48:07,616 - INFO - Val loss decrease from 6.1772 to 6.0450, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 13:48:12,580 - INFO - epoch complete!
2024-04-30 13:48:12,580 - INFO - evaluating now!
2024-04-30 13:48:12,913 - INFO - Epoch [8/200] train_loss: 5.7253, val_loss: 5.7637, lr: 0.003000, 5.30s
2024-04-30 13:48:12,951 - INFO - Saved model at 8
2024-04-30 13:48:12,951 - INFO - Val loss decrease from 6.0450 to 5.7637, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 13:48:17,835 - INFO - epoch complete!
2024-04-30 13:48:17,835 - INFO - evaluating now!
2024-04-30 13:48:18,159 - INFO - Epoch [9/200] train_loss: 5.5438, val_loss: 5.6416, lr: 0.003000, 5.21s
2024-04-30 13:48:18,175 - INFO - Saved model at 9
2024-04-30 13:48:18,175 - INFO - Val loss decrease from 5.7637 to 5.6416, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 13:48:23,044 - INFO - epoch complete!
2024-04-30 13:48:23,044 - INFO - evaluating now!
2024-04-30 13:48:23,367 - INFO - Epoch [10/200] train_loss: 5.3910, val_loss: 5.5799, lr: 0.003000, 5.19s
2024-04-30 13:48:23,384 - INFO - Saved model at 10
2024-04-30 13:48:23,384 - INFO - Val loss decrease from 5.6416 to 5.5799, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 13:48:28,231 - INFO - epoch complete!
2024-04-30 13:48:28,235 - INFO - evaluating now!
2024-04-30 13:48:28,552 - INFO - Epoch [11/200] train_loss: 5.2083, val_loss: 5.4314, lr: 0.003000, 5.17s
2024-04-30 13:48:28,568 - INFO - Saved model at 11
2024-04-30 13:48:28,568 - INFO - Val loss decrease from 5.5799 to 5.4314, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 13:48:33,585 - INFO - epoch complete!
2024-04-30 13:48:33,589 - INFO - evaluating now!
2024-04-30 13:48:33,889 - INFO - Epoch [12/200] train_loss: 5.1691, val_loss: 5.5551, lr: 0.003000, 5.32s
2024-04-30 13:48:38,891 - INFO - epoch complete!
2024-04-30 13:48:38,891 - INFO - evaluating now!
2024-04-30 13:48:39,230 - INFO - Epoch [13/200] train_loss: 5.0822, val_loss: 5.5157, lr: 0.003000, 5.34s
2024-04-30 13:48:44,172 - INFO - epoch complete!
2024-04-30 13:48:44,172 - INFO - evaluating now!
2024-04-30 13:48:44,492 - INFO - Epoch [14/200] train_loss: 4.9709, val_loss: 5.5854, lr: 0.003000, 5.26s
2024-04-30 13:48:49,676 - INFO - epoch complete!
2024-04-30 13:48:49,677 - INFO - evaluating now!
2024-04-30 13:48:50,010 - INFO - Epoch [15/200] train_loss: 4.8262, val_loss: 5.2630, lr: 0.003000, 5.52s
2024-04-30 13:48:50,026 - INFO - Saved model at 15
2024-04-30 13:48:50,026 - INFO - Val loss decrease from 5.4314 to 5.2630, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 13:48:54,874 - INFO - epoch complete!
2024-04-30 13:48:54,874 - INFO - evaluating now!
2024-04-30 13:48:55,190 - INFO - Epoch [16/200] train_loss: 4.7785, val_loss: 5.2284, lr: 0.003000, 5.16s
2024-04-30 13:48:55,206 - INFO - Saved model at 16
2024-04-30 13:48:55,206 - INFO - Val loss decrease from 5.2630 to 5.2284, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 13:49:00,188 - INFO - epoch complete!
2024-04-30 13:49:00,188 - INFO - evaluating now!
2024-04-30 13:49:00,511 - INFO - Epoch [17/200] train_loss: 4.6692, val_loss: 5.3963, lr: 0.003000, 5.31s
2024-04-30 13:49:05,432 - INFO - epoch complete!
2024-04-30 13:49:05,432 - INFO - evaluating now!
2024-04-30 13:49:05,768 - INFO - Epoch [18/200] train_loss: 4.6134, val_loss: 5.2960, lr: 0.003000, 5.26s
2024-04-30 13:49:10,941 - INFO - epoch complete!
2024-04-30 13:49:10,945 - INFO - evaluating now!
2024-04-30 13:49:11,276 - INFO - Epoch [19/200] train_loss: 4.6088, val_loss: 5.2268, lr: 0.003000, 5.51s
2024-04-30 13:49:11,290 - INFO - Saved model at 19
2024-04-30 13:49:11,290 - INFO - Val loss decrease from 5.2284 to 5.2268, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 13:49:16,237 - INFO - epoch complete!
2024-04-30 13:49:16,237 - INFO - evaluating now!
2024-04-30 13:49:16,573 - INFO - Epoch [20/200] train_loss: 4.4988, val_loss: 5.4247, lr: 0.003000, 5.28s
2024-04-30 13:49:21,637 - INFO - epoch complete!
2024-04-30 13:49:21,637 - INFO - evaluating now!
2024-04-30 13:49:21,957 - INFO - Epoch [21/200] train_loss: 4.4348, val_loss: 5.1203, lr: 0.003000, 5.38s
2024-04-30 13:49:21,977 - INFO - Saved model at 21
2024-04-30 13:49:21,977 - INFO - Val loss decrease from 5.2268 to 5.1203, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-30 13:49:27,169 - INFO - epoch complete!
2024-04-30 13:49:27,169 - INFO - evaluating now!
2024-04-30 13:49:27,504 - INFO - Epoch [22/200] train_loss: 4.4054, val_loss: 5.0565, lr: 0.003000, 5.53s
2024-04-30 13:49:27,516 - INFO - Saved model at 22
2024-04-30 13:49:27,520 - INFO - Val loss decrease from 5.1203 to 5.0565, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-30 13:49:32,719 - INFO - epoch complete!
2024-04-30 13:49:32,719 - INFO - evaluating now!
2024-04-30 13:49:33,066 - INFO - Epoch [23/200] train_loss: 4.3370, val_loss: 5.2477, lr: 0.003000, 5.55s
2024-04-30 13:49:38,168 - INFO - epoch complete!
2024-04-30 13:49:38,168 - INFO - evaluating now!
2024-04-30 13:49:38,514 - INFO - Epoch [24/200] train_loss: 4.2902, val_loss: 5.2373, lr: 0.003000, 5.45s
2024-04-30 13:49:43,864 - INFO - epoch complete!
2024-04-30 13:49:43,864 - INFO - evaluating now!
2024-04-30 13:49:44,218 - INFO - Epoch [25/200] train_loss: 4.2352, val_loss: 5.1317, lr: 0.003000, 5.70s
2024-04-30 13:49:49,248 - INFO - epoch complete!
2024-04-30 13:49:49,248 - INFO - evaluating now!
2024-04-30 13:49:49,578 - INFO - Epoch [26/200] train_loss: 4.2489, val_loss: 5.2111, lr: 0.003000, 5.36s
2024-04-30 13:49:54,572 - INFO - epoch complete!
2024-04-30 13:49:54,572 - INFO - evaluating now!
2024-04-30 13:49:54,919 - INFO - Epoch [27/200] train_loss: 4.2203, val_loss: 4.9912, lr: 0.003000, 5.34s
2024-04-30 13:49:54,935 - INFO - Saved model at 27
2024-04-30 13:49:54,935 - INFO - Val loss decrease from 5.0565 to 4.9912, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-30 13:49:59,932 - INFO - epoch complete!
2024-04-30 13:49:59,936 - INFO - evaluating now!
2024-04-30 13:50:00,275 - INFO - Epoch [28/200] train_loss: 4.1585, val_loss: 5.0167, lr: 0.003000, 5.34s
2024-04-30 13:50:05,341 - INFO - epoch complete!
2024-04-30 13:50:05,341 - INFO - evaluating now!
2024-04-30 13:50:05,665 - INFO - Epoch [29/200] train_loss: 4.1063, val_loss: 5.1309, lr: 0.003000, 5.39s
2024-04-30 13:50:10,749 - INFO - epoch complete!
2024-04-30 13:50:10,749 - INFO - evaluating now!
2024-04-30 13:50:11,106 - INFO - Epoch [30/200] train_loss: 4.0760, val_loss: 5.1630, lr: 0.003000, 5.44s
2024-04-30 13:50:16,164 - INFO - epoch complete!
2024-04-30 13:50:16,164 - INFO - evaluating now!
2024-04-30 13:50:16,511 - INFO - Epoch [31/200] train_loss: 4.0344, val_loss: 5.0969, lr: 0.003000, 5.40s
2024-04-30 13:50:21,593 - INFO - epoch complete!
2024-04-30 13:50:21,593 - INFO - evaluating now!
2024-04-30 13:50:21,921 - INFO - Epoch [32/200] train_loss: 3.9823, val_loss: 5.1096, lr: 0.003000, 5.41s
2024-04-30 13:50:26,834 - INFO - epoch complete!
2024-04-30 13:50:26,834 - INFO - evaluating now!
2024-04-30 13:50:27,158 - INFO - Epoch [33/200] train_loss: 3.9990, val_loss: 5.3164, lr: 0.003000, 5.24s
2024-04-30 13:50:32,092 - INFO - epoch complete!
2024-04-30 13:50:32,092 - INFO - evaluating now!
2024-04-30 13:50:32,440 - INFO - Epoch [34/200] train_loss: 3.9904, val_loss: 5.1746, lr: 0.003000, 5.28s
2024-04-30 13:50:37,347 - INFO - epoch complete!
2024-04-30 13:50:37,347 - INFO - evaluating now!
2024-04-30 13:50:37,686 - INFO - Epoch [35/200] train_loss: 3.9496, val_loss: 4.8998, lr: 0.003000, 5.25s
2024-04-30 13:50:37,702 - INFO - Saved model at 35
2024-04-30 13:50:37,702 - INFO - Val loss decrease from 4.9912 to 4.8998, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-04-30 13:50:42,766 - INFO - epoch complete!
2024-04-30 13:50:42,766 - INFO - evaluating now!
2024-04-30 13:50:43,084 - INFO - Epoch [36/200] train_loss: 3.9135, val_loss: 5.0976, lr: 0.003000, 5.38s
2024-04-30 13:50:47,948 - INFO - epoch complete!
2024-04-30 13:50:47,948 - INFO - evaluating now!
2024-04-30 13:50:48,264 - INFO - Epoch [37/200] train_loss: 3.8905, val_loss: 5.0971, lr: 0.003000, 5.18s
2024-04-30 13:50:53,254 - INFO - epoch complete!
2024-04-30 13:50:53,254 - INFO - evaluating now!
2024-04-30 13:50:53,577 - INFO - Epoch [38/200] train_loss: 3.9123, val_loss: 5.0761, lr: 0.003000, 5.31s
2024-04-30 13:50:58,446 - INFO - epoch complete!
2024-04-30 13:50:58,446 - INFO - evaluating now!
2024-04-30 13:50:58,769 - INFO - Epoch [39/200] train_loss: 3.8289, val_loss: 5.1901, lr: 0.003000, 5.19s
2024-04-30 13:51:03,759 - INFO - epoch complete!
2024-04-30 13:51:03,759 - INFO - evaluating now!
2024-04-30 13:51:04,098 - INFO - Epoch [40/200] train_loss: 3.8206, val_loss: 5.0720, lr: 0.003000, 5.33s
2024-04-30 13:51:09,000 - INFO - epoch complete!
2024-04-30 13:51:09,000 - INFO - evaluating now!
2024-04-30 13:51:09,324 - INFO - Epoch [41/200] train_loss: 3.7459, val_loss: 5.0230, lr: 0.003000, 5.23s
2024-04-30 13:51:14,313 - INFO - epoch complete!
2024-04-30 13:51:14,313 - INFO - evaluating now!
2024-04-30 13:51:14,631 - INFO - Epoch [42/200] train_loss: 3.7105, val_loss: 5.1553, lr: 0.003000, 5.31s
2024-04-30 13:51:19,595 - INFO - epoch complete!
2024-04-30 13:51:19,595 - INFO - evaluating now!
2024-04-30 13:51:19,921 - INFO - Epoch [43/200] train_loss: 3.7312, val_loss: 5.0373, lr: 0.003000, 5.29s
2024-04-30 13:51:24,963 - INFO - epoch complete!
2024-04-30 13:51:24,967 - INFO - evaluating now!
2024-04-30 13:51:25,283 - INFO - Epoch [44/200] train_loss: 3.7341, val_loss: 5.0575, lr: 0.003000, 5.36s
2024-04-30 13:51:30,238 - INFO - epoch complete!
2024-04-30 13:51:30,238 - INFO - evaluating now!
2024-04-30 13:51:30,570 - INFO - Epoch [45/200] train_loss: 3.7131, val_loss: 5.1213, lr: 0.003000, 5.29s
2024-04-30 13:51:35,657 - INFO - epoch complete!
2024-04-30 13:51:35,657 - INFO - evaluating now!
2024-04-30 13:51:35,988 - INFO - Epoch [46/200] train_loss: 3.6727, val_loss: 4.9980, lr: 0.003000, 5.42s
2024-04-30 13:51:41,041 - INFO - epoch complete!
2024-04-30 13:51:41,041 - INFO - evaluating now!
2024-04-30 13:51:41,388 - INFO - Epoch [47/200] train_loss: 3.6529, val_loss: 5.0809, lr: 0.003000, 5.40s
2024-04-30 13:51:46,802 - INFO - epoch complete!
2024-04-30 13:51:46,802 - INFO - evaluating now!
2024-04-30 13:51:47,122 - INFO - Epoch [48/200] train_loss: 3.6729, val_loss: 5.0043, lr: 0.003000, 5.73s
2024-04-30 13:51:52,296 - INFO - epoch complete!
2024-04-30 13:51:52,296 - INFO - evaluating now!
2024-04-30 13:51:52,630 - INFO - Epoch [49/200] train_loss: 3.6216, val_loss: 4.9572, lr: 0.003000, 5.51s
2024-04-30 13:51:57,588 - INFO - epoch complete!
2024-04-30 13:51:57,588 - INFO - evaluating now!
2024-04-30 13:51:57,908 - INFO - Epoch [50/200] train_loss: 3.6505, val_loss: 5.0284, lr: 0.003000, 5.28s
2024-04-30 13:51:57,908 - WARNING - Early stopping at epoch: 50
2024-04-30 13:51:57,908 - INFO - Trained totally 51 epochs, average train time is 5.023s, average eval time is 0.331s
2024-04-30 13:51:57,916 - INFO - Loaded model at 35
2024-04-30 13:51:57,920 - INFO - Saved model at ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 13:51:57,932 - INFO - Start evaluating ...
2024-04-30 13:51:59,018 - INFO - Note that you select the single mode to evaluate!
2024-04-30 13:51:59,022 - INFO - Evaluate result is saved at ./libcity/cache/63/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-30 13:51:59,022 - INFO - 
         MAE       RMSE
1   2.301378   7.012411
2   2.380831   7.648026
3   2.584703   8.839448
4   2.844681   9.956094
5   2.934685  10.950421
6   3.071083  11.764246
7   3.127645  12.435740
8   3.147113  12.832911
9   3.226073  13.220431
10  3.301084  13.482250
11  3.351990  13.910652
12  3.448333  14.462047
2024-04-30 13:51:59,082 - INFO - ----------------------------------------------------------------------------
2024-04-30 13:51:59,082 - INFO - # 4, Kownledge Graph Embedding: RandomE, Experiment ids: 64
2024-04-30 13:51:59,082 - INFO - ----------------------------------------------------------------------------
2024-04-30 13:51:59,086 - INFO - Log directory: ./libcity/log
2024-04-30 13:51:59,086 - INFO - Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=64
2024-04-30 13:51:59,086 - INFO - {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 861339244, 'exp_id': 64, 'load_external': True, 'embedding_model': 'RandomE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 13:51:59,086 - INFO - Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 13:51:59,090 - INFO - set_weight_link_or_dist: dist
2024-04-30 13:51:59,090 - INFO - init_weight_inf_or_zero: inf
2024-04-30 13:51:59,102 - INFO - Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 13:51:59,102 - INFO - Start Calculate the weight by Gauss kernel!
2024-04-30 13:51:59,106 - INFO - Loading file CHITaxi20190406.dyna
2024-04-30 13:51:59,233 - INFO - Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 13:52:00,963 - INFO - Dataset created
2024-04-30 13:52:00,963 - INFO - x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 13:52:01,052 - INFO - train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 13:52:01,052 - INFO - eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 13:52:01,052 - INFO - test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 13:52:01,180 - INFO - StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 13:52:01,180 - INFO - NoneScaler
2024-04-30 13:52:02,731 - INFO - AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 13:52:02,732 - INFO - node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 13:52:02,733 - INFO - encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 13:52:02,733 - INFO - encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 13:52:02,733 - INFO - encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 13:52:02,733 - INFO - encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 13:52:02,734 - INFO - encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 13:52:02,734 - INFO - encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 13:52:02,734 - INFO - encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 13:52:02,734 - INFO - encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 13:52:02,734 - INFO - end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 13:52:02,734 - INFO - end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 13:52:02,734 - INFO - Total parameter numbers: 874010
2024-04-30 13:52:02,734 - INFO - You select `adam` optimizer.
2024-04-30 13:52:02,734 - WARNING - Received none train loss func and will use the loss func defined in the model.
2024-04-30 13:52:02,734 - INFO - Start training ...
2024-04-30 13:52:02,734 - INFO - num_batches:48
2024-04-30 13:52:07,910 - INFO - epoch complete!
2024-04-30 13:52:07,910 - INFO - evaluating now!
2024-04-30 13:52:08,230 - INFO - Epoch [0/200] train_loss: 25.7553, val_loss: 17.8452, lr: 0.003000, 5.50s
2024-04-30 13:52:08,246 - INFO - Saved model at 0
2024-04-30 13:52:08,246 - INFO - Val loss decrease from inf to 17.8452, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 13:52:13,106 - INFO - epoch complete!
2024-04-30 13:52:13,106 - INFO - evaluating now!
2024-04-30 13:52:13,426 - INFO - Epoch [1/200] train_loss: 14.6429, val_loss: 13.7092, lr: 0.003000, 5.18s
2024-04-30 13:52:13,442 - INFO - Saved model at 1
2024-04-30 13:52:13,442 - INFO - Val loss decrease from 17.8452 to 13.7092, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 13:52:18,495 - INFO - epoch complete!
2024-04-30 13:52:18,495 - INFO - evaluating now!
2024-04-30 13:52:18,823 - INFO - Epoch [2/200] train_loss: 11.0693, val_loss: 10.1163, lr: 0.003000, 5.38s
2024-04-30 13:52:18,835 - INFO - Saved model at 2
2024-04-30 13:52:18,835 - INFO - Val loss decrease from 13.7092 to 10.1163, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 13:52:23,874 - INFO - epoch complete!
2024-04-30 13:52:23,874 - INFO - evaluating now!
2024-04-30 13:52:24,194 - INFO - Epoch [3/200] train_loss: 8.8199, val_loss: 8.3338, lr: 0.003000, 5.36s
2024-04-30 13:52:24,210 - INFO - Saved model at 3
2024-04-30 13:52:24,210 - INFO - Val loss decrease from 10.1163 to 8.3338, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 13:52:29,211 - INFO - epoch complete!
2024-04-30 13:52:29,211 - INFO - evaluating now!
2024-04-30 13:52:29,561 - INFO - Epoch [4/200] train_loss: 7.8022, val_loss: 7.3965, lr: 0.003000, 5.35s
2024-04-30 13:52:29,577 - INFO - Saved model at 4
2024-04-30 13:52:29,578 - INFO - Val loss decrease from 8.3338 to 7.3965, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 13:52:34,537 - INFO - epoch complete!
2024-04-30 13:52:34,541 - INFO - evaluating now!
2024-04-30 13:52:34,857 - INFO - Epoch [5/200] train_loss: 7.0418, val_loss: 6.7413, lr: 0.003000, 5.28s
2024-04-30 13:52:34,873 - INFO - Saved model at 5
2024-04-30 13:52:34,873 - INFO - Val loss decrease from 7.3965 to 6.7413, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 13:52:39,771 - INFO - epoch complete!
2024-04-30 13:52:39,771 - INFO - evaluating now!
2024-04-30 13:52:40,091 - INFO - Epoch [6/200] train_loss: 6.6157, val_loss: 6.4332, lr: 0.003000, 5.22s
2024-04-30 13:52:40,103 - INFO - Saved model at 6
2024-04-30 13:52:40,103 - INFO - Val loss decrease from 6.7413 to 6.4332, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 13:52:45,011 - INFO - epoch complete!
2024-04-30 13:52:45,011 - INFO - evaluating now!
2024-04-30 13:52:45,325 - INFO - Epoch [7/200] train_loss: 6.2604, val_loss: 6.2132, lr: 0.003000, 5.22s
2024-04-30 13:52:45,341 - INFO - Saved model at 7
2024-04-30 13:52:45,341 - INFO - Val loss decrease from 6.4332 to 6.2132, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 13:52:50,234 - INFO - epoch complete!
2024-04-30 13:52:50,234 - INFO - evaluating now!
2024-04-30 13:52:50,551 - INFO - Epoch [8/200] train_loss: 6.0588, val_loss: 6.0614, lr: 0.003000, 5.21s
2024-04-30 13:52:50,567 - INFO - Saved model at 8
2024-04-30 13:52:50,567 - INFO - Val loss decrease from 6.2132 to 6.0614, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 13:52:55,560 - INFO - epoch complete!
2024-04-30 13:52:55,560 - INFO - evaluating now!
2024-04-30 13:52:55,883 - INFO - Epoch [9/200] train_loss: 5.7737, val_loss: 5.8112, lr: 0.003000, 5.32s
2024-04-30 13:52:55,899 - INFO - Saved model at 9
2024-04-30 13:52:55,899 - INFO - Val loss decrease from 6.0614 to 5.8112, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 13:53:00,760 - INFO - epoch complete!
2024-04-30 13:53:00,760 - INFO - evaluating now!
2024-04-30 13:53:01,080 - INFO - Epoch [10/200] train_loss: 5.5944, val_loss: 5.7126, lr: 0.003000, 5.18s
2024-04-30 13:53:01,096 - INFO - Saved model at 10
2024-04-30 13:53:01,096 - INFO - Val loss decrease from 5.8112 to 5.7126, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 13:53:06,012 - INFO - epoch complete!
2024-04-30 13:53:06,012 - INFO - evaluating now!
2024-04-30 13:53:06,333 - INFO - Epoch [11/200] train_loss: 5.4443, val_loss: 5.7148, lr: 0.003000, 5.24s
2024-04-30 13:53:11,202 - INFO - epoch complete!
2024-04-30 13:53:11,202 - INFO - evaluating now!
2024-04-30 13:53:11,520 - INFO - Epoch [12/200] train_loss: 5.3293, val_loss: 5.6139, lr: 0.003000, 5.19s
2024-04-30 13:53:11,536 - INFO - Saved model at 12
2024-04-30 13:53:11,536 - INFO - Val loss decrease from 5.7126 to 5.6139, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 13:53:16,391 - INFO - epoch complete!
2024-04-30 13:53:16,395 - INFO - evaluating now!
2024-04-30 13:53:16,717 - INFO - Epoch [13/200] train_loss: 5.1830, val_loss: 5.5727, lr: 0.003000, 5.18s
2024-04-30 13:53:16,732 - INFO - Saved model at 13
2024-04-30 13:53:16,732 - INFO - Val loss decrease from 5.6139 to 5.5727, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 13:53:21,754 - INFO - epoch complete!
2024-04-30 13:53:21,754 - INFO - evaluating now!
2024-04-30 13:53:22,078 - INFO - Epoch [14/200] train_loss: 5.1097, val_loss: 5.2621, lr: 0.003000, 5.35s
2024-04-30 13:53:22,114 - INFO - Saved model at 14
2024-04-30 13:53:22,114 - INFO - Val loss decrease from 5.5727 to 5.2621, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 13:53:26,991 - INFO - epoch complete!
2024-04-30 13:53:26,991 - INFO - evaluating now!
2024-04-30 13:53:27,309 - INFO - Epoch [15/200] train_loss: 5.0361, val_loss: 5.3328, lr: 0.003000, 5.20s
2024-04-30 13:53:32,349 - INFO - epoch complete!
2024-04-30 13:53:32,349 - INFO - evaluating now!
2024-04-30 13:53:32,685 - INFO - Epoch [16/200] train_loss: 4.8962, val_loss: 5.2524, lr: 0.003000, 5.38s
2024-04-30 13:53:32,701 - INFO - Saved model at 16
2024-04-30 13:53:32,701 - INFO - Val loss decrease from 5.2621 to 5.2524, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 13:53:37,636 - INFO - epoch complete!
2024-04-30 13:53:37,636 - INFO - evaluating now!
2024-04-30 13:53:37,955 - INFO - Epoch [17/200] train_loss: 4.8553, val_loss: 5.2408, lr: 0.003000, 5.25s
2024-04-30 13:53:37,975 - INFO - Saved model at 17
2024-04-30 13:53:37,975 - INFO - Val loss decrease from 5.2524 to 5.2408, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 13:53:42,929 - INFO - epoch complete!
2024-04-30 13:53:42,930 - INFO - evaluating now!
2024-04-30 13:53:43,258 - INFO - Epoch [18/200] train_loss: 4.7024, val_loss: 5.2960, lr: 0.003000, 5.28s
2024-04-30 13:53:48,530 - INFO - epoch complete!
2024-04-30 13:53:48,530 - INFO - evaluating now!
2024-04-30 13:53:48,856 - INFO - Epoch [19/200] train_loss: 4.6448, val_loss: 5.1879, lr: 0.003000, 5.60s
2024-04-30 13:53:48,872 - INFO - Saved model at 19
2024-04-30 13:53:48,872 - INFO - Val loss decrease from 5.2408 to 5.1879, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 13:53:53,838 - INFO - epoch complete!
2024-04-30 13:53:53,838 - INFO - evaluating now!
2024-04-30 13:53:54,154 - INFO - Epoch [20/200] train_loss: 4.6554, val_loss: 5.3300, lr: 0.003000, 5.28s
2024-04-30 13:53:59,021 - INFO - epoch complete!
2024-04-30 13:53:59,021 - INFO - evaluating now!
2024-04-30 13:53:59,338 - INFO - Epoch [21/200] train_loss: 4.5827, val_loss: 5.5254, lr: 0.003000, 5.18s
2024-04-30 13:54:04,324 - INFO - epoch complete!
2024-04-30 13:54:04,324 - INFO - evaluating now!
2024-04-30 13:54:04,644 - INFO - Epoch [22/200] train_loss: 4.5774, val_loss: 5.0595, lr: 0.003000, 5.31s
2024-04-30 13:54:04,656 - INFO - Saved model at 22
2024-04-30 13:54:04,659 - INFO - Val loss decrease from 5.1879 to 5.0595, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-30 13:54:09,514 - INFO - epoch complete!
2024-04-30 13:54:09,514 - INFO - evaluating now!
2024-04-30 13:54:09,838 - INFO - Epoch [23/200] train_loss: 4.4496, val_loss: 4.9836, lr: 0.003000, 5.18s
2024-04-30 13:54:09,854 - INFO - Saved model at 23
2024-04-30 13:54:09,854 - INFO - Val loss decrease from 5.0595 to 4.9836, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-30 13:54:14,703 - INFO - epoch complete!
2024-04-30 13:54:14,703 - INFO - evaluating now!
2024-04-30 13:54:15,030 - INFO - Epoch [24/200] train_loss: 4.4906, val_loss: 5.0728, lr: 0.003000, 5.18s
2024-04-30 13:54:20,040 - INFO - epoch complete!
2024-04-30 13:54:20,040 - INFO - evaluating now!
2024-04-30 13:54:20,388 - INFO - Epoch [25/200] train_loss: 4.3672, val_loss: 5.0255, lr: 0.003000, 5.36s
2024-04-30 13:54:25,506 - INFO - epoch complete!
2024-04-30 13:54:25,506 - INFO - evaluating now!
2024-04-30 13:54:25,830 - INFO - Epoch [26/200] train_loss: 4.3205, val_loss: 5.1157, lr: 0.003000, 5.44s
2024-04-30 13:54:30,803 - INFO - epoch complete!
2024-04-30 13:54:30,803 - INFO - evaluating now!
2024-04-30 13:54:31,164 - INFO - Epoch [27/200] train_loss: 4.2893, val_loss: 5.0476, lr: 0.003000, 5.33s
2024-04-30 13:54:36,153 - INFO - epoch complete!
2024-04-30 13:54:36,154 - INFO - evaluating now!
2024-04-30 13:54:36,486 - INFO - Epoch [28/200] train_loss: 4.2461, val_loss: 4.9864, lr: 0.003000, 5.32s
2024-04-30 13:54:41,392 - INFO - epoch complete!
2024-04-30 13:54:41,392 - INFO - evaluating now!
2024-04-30 13:54:41,712 - INFO - Epoch [29/200] train_loss: 4.2191, val_loss: 5.0418, lr: 0.003000, 5.23s
2024-04-30 13:54:46,569 - INFO - epoch complete!
2024-04-30 13:54:46,569 - INFO - evaluating now!
2024-04-30 13:54:46,901 - INFO - Epoch [30/200] train_loss: 4.1891, val_loss: 5.1414, lr: 0.003000, 5.19s
2024-04-30 13:54:51,997 - INFO - epoch complete!
2024-04-30 13:54:51,997 - INFO - evaluating now!
2024-04-30 13:54:52,332 - INFO - Epoch [31/200] train_loss: 4.1543, val_loss: 5.1197, lr: 0.003000, 5.43s
2024-04-30 13:54:57,249 - INFO - epoch complete!
2024-04-30 13:54:57,249 - INFO - evaluating now!
2024-04-30 13:54:57,593 - INFO - Epoch [32/200] train_loss: 4.1024, val_loss: 4.9585, lr: 0.003000, 5.26s
2024-04-30 13:54:57,609 - INFO - Saved model at 32
2024-04-30 13:54:57,609 - INFO - Val loss decrease from 4.9836 to 4.9585, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-04-30 13:55:02,659 - INFO - epoch complete!
2024-04-30 13:55:02,659 - INFO - evaluating now!
2024-04-30 13:55:02,979 - INFO - Epoch [33/200] train_loss: 4.0924, val_loss: 5.0005, lr: 0.003000, 5.37s
2024-04-30 13:55:07,858 - INFO - epoch complete!
2024-04-30 13:55:07,858 - INFO - evaluating now!
2024-04-30 13:55:08,178 - INFO - Epoch [34/200] train_loss: 4.0441, val_loss: 5.2202, lr: 0.003000, 5.20s
2024-04-30 13:55:13,118 - INFO - epoch complete!
2024-04-30 13:55:13,118 - INFO - evaluating now!
2024-04-30 13:55:13,438 - INFO - Epoch [35/200] train_loss: 4.0206, val_loss: 5.1102, lr: 0.003000, 5.26s
2024-04-30 13:55:18,343 - INFO - epoch complete!
2024-04-30 13:55:18,347 - INFO - evaluating now!
2024-04-30 13:55:18,677 - INFO - Epoch [36/200] train_loss: 3.9921, val_loss: 5.0658, lr: 0.003000, 5.24s
2024-04-30 13:55:23,597 - INFO - epoch complete!
2024-04-30 13:55:23,597 - INFO - evaluating now!
2024-04-30 13:55:23,914 - INFO - Epoch [37/200] train_loss: 3.9566, val_loss: 5.0747, lr: 0.003000, 5.24s
2024-04-30 13:55:28,863 - INFO - epoch complete!
2024-04-30 13:55:28,863 - INFO - evaluating now!
2024-04-30 13:55:29,247 - INFO - Epoch [38/200] train_loss: 3.9387, val_loss: 5.0504, lr: 0.003000, 5.33s
2024-04-30 13:55:34,346 - INFO - epoch complete!
2024-04-30 13:55:34,346 - INFO - evaluating now!
2024-04-30 13:55:34,670 - INFO - Epoch [39/200] train_loss: 3.8835, val_loss: 5.1756, lr: 0.003000, 5.42s
2024-04-30 13:55:39,593 - INFO - epoch complete!
2024-04-30 13:55:39,593 - INFO - evaluating now!
2024-04-30 13:55:39,934 - INFO - Epoch [40/200] train_loss: 3.8607, val_loss: 4.9411, lr: 0.003000, 5.26s
2024-04-30 13:55:39,950 - INFO - Saved model at 40
2024-04-30 13:55:39,950 - INFO - Val loss decrease from 4.9585 to 4.9411, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-04-30 13:55:44,953 - INFO - epoch complete!
2024-04-30 13:55:44,953 - INFO - evaluating now!
2024-04-30 13:55:45,285 - INFO - Epoch [41/200] train_loss: 3.8617, val_loss: 5.1295, lr: 0.003000, 5.34s
2024-04-30 13:55:50,227 - INFO - epoch complete!
2024-04-30 13:55:50,227 - INFO - evaluating now!
2024-04-30 13:55:50,539 - INFO - Epoch [42/200] train_loss: 3.8492, val_loss: 5.1279, lr: 0.003000, 5.25s
2024-04-30 13:55:55,432 - INFO - epoch complete!
2024-04-30 13:55:55,432 - INFO - evaluating now!
2024-04-30 13:55:55,750 - INFO - Epoch [43/200] train_loss: 3.8059, val_loss: 5.0498, lr: 0.003000, 5.21s
2024-04-30 13:56:00,603 - INFO - epoch complete!
2024-04-30 13:56:00,603 - INFO - evaluating now!
2024-04-30 13:56:00,938 - INFO - Epoch [44/200] train_loss: 3.7883, val_loss: 4.9662, lr: 0.003000, 5.19s
2024-04-30 13:56:05,904 - INFO - epoch complete!
2024-04-30 13:56:05,904 - INFO - evaluating now!
2024-04-30 13:56:06,243 - INFO - Epoch [45/200] train_loss: 3.7545, val_loss: 5.0079, lr: 0.003000, 5.31s
2024-04-30 13:56:11,238 - INFO - epoch complete!
2024-04-30 13:56:11,239 - INFO - evaluating now!
2024-04-30 13:56:11,557 - INFO - Epoch [46/200] train_loss: 3.7283, val_loss: 5.1201, lr: 0.003000, 5.31s
2024-04-30 13:56:16,396 - INFO - epoch complete!
2024-04-30 13:56:16,396 - INFO - evaluating now!
2024-04-30 13:56:16,708 - INFO - Epoch [47/200] train_loss: 3.7242, val_loss: 4.9715, lr: 0.003000, 5.15s
2024-04-30 13:56:21,597 - INFO - epoch complete!
2024-04-30 13:56:21,598 - INFO - evaluating now!
2024-04-30 13:56:21,920 - INFO - Epoch [48/200] train_loss: 3.6936, val_loss: 5.0705, lr: 0.003000, 5.21s
2024-04-30 13:56:27,077 - INFO - epoch complete!
2024-04-30 13:56:27,078 - INFO - evaluating now!
2024-04-30 13:56:27,424 - INFO - Epoch [49/200] train_loss: 3.6879, val_loss: 4.9793, lr: 0.003000, 5.50s
2024-04-30 13:56:32,494 - INFO - epoch complete!
2024-04-30 13:56:32,494 - INFO - evaluating now!
2024-04-30 13:56:32,817 - INFO - Epoch [50/200] train_loss: 3.6600, val_loss: 4.9965, lr: 0.003000, 5.39s
2024-04-30 13:56:37,648 - INFO - epoch complete!
2024-04-30 13:56:37,648 - INFO - evaluating now!
2024-04-30 13:56:37,964 - INFO - Epoch [51/200] train_loss: 3.6257, val_loss: 5.1832, lr: 0.003000, 5.15s
2024-04-30 13:56:42,820 - INFO - epoch complete!
2024-04-30 13:56:42,821 - INFO - evaluating now!
2024-04-30 13:56:43,138 - INFO - Epoch [52/200] train_loss: 3.6507, val_loss: 5.1357, lr: 0.003000, 5.17s
2024-04-30 13:56:47,975 - INFO - epoch complete!
2024-04-30 13:56:47,976 - INFO - evaluating now!
2024-04-30 13:56:48,290 - INFO - Epoch [53/200] train_loss: 3.5969, val_loss: 5.1253, lr: 0.003000, 5.15s
2024-04-30 13:56:53,132 - INFO - epoch complete!
2024-04-30 13:56:53,133 - INFO - evaluating now!
2024-04-30 13:56:53,447 - INFO - Epoch [54/200] train_loss: 3.6001, val_loss: 5.0595, lr: 0.003000, 5.16s
2024-04-30 13:56:58,280 - INFO - epoch complete!
2024-04-30 13:56:58,280 - INFO - evaluating now!
2024-04-30 13:56:58,597 - INFO - Epoch [55/200] train_loss: 3.5583, val_loss: 5.1001, lr: 0.003000, 5.15s
2024-04-30 13:56:58,597 - WARNING - Early stopping at epoch: 55
2024-04-30 13:56:58,597 - INFO - Trained totally 56 epochs, average train time is 4.950s, average eval time is 0.326s
2024-04-30 13:56:58,606 - INFO - Loaded model at 40
2024-04-30 13:56:58,606 - INFO - Saved model at ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 13:56:58,636 - INFO - Start evaluating ...
2024-04-30 13:56:59,689 - INFO - Note that you select the single mode to evaluate!
2024-04-30 13:56:59,693 - INFO - Evaluate result is saved at ./libcity/cache/64/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-30 13:56:59,696 - INFO - 
         MAE       RMSE
1   2.324439   7.068739
2   2.406960   7.577626
3   2.645696   8.612447
4   2.859747   9.585836
5   3.012558  10.567939
6   3.109751  11.437161
7   3.180910  12.157609
8   3.213002  12.686480
9   3.234504  12.946233
10  3.290901  13.180164
11  3.287098  13.208997
12  3.428070  13.600412
2024-04-30 13:56:59,759 - INFO - ----------------------------------------------------------------------------
2024-04-30 13:56:59,759 - INFO - Kownledge Graph Embedding: RandomE, Experiment ids: [60, 61, 62, 63, 64]
2024-04-30 13:56:59,765 - INFO - ----------------------------------------------------------------------------
2024-04-30 13:56:59,767 - INFO - Average: 
         MAE       RMSE
0   2.348369   7.350126
1   2.459799   7.915213
2   2.643444   8.888180
3   2.829751   9.760631
4   2.962718  10.702956
5   3.071199  11.550785
6   3.145853  12.314554
7   3.215151  12.844245
8   3.260177  13.062296
9   3.307553  13.176170
10  3.345571  13.317908
11  3.452502  13.692047 
2024-04-30 13:56:59,769 - INFO - Standard deviation: 
         MAE      RMSE
0   0.043893  0.462137
1   0.071354  0.292490
2   0.048967  0.172939
3   0.039962  0.125933
4   0.044114  0.177631
5   0.039665  0.316191
6   0.062876  0.453035
7   0.095536  0.519015
8   0.097251  0.482886
9   0.091480  0.413679
10  0.101677  0.506243
11  0.068751  0.571770
2024-04-30 13:56:59,775 - INFO - ----------------------------------------------------------------------------
2024-04-30 13:56:59,777 - INFO - 12 steps Average: 
        MAE       RMSE
0  3.003507  11.214593
2024-04-30 13:56:59,779 - INFO - 12 steps Standard deviation: 
        MAE      RMSE
0  0.067127  0.374496
