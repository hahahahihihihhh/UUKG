2024-04-24 15:56:46,867 - INFO - Log directory: ./libcity/log
2024-04-24 15:56:46,868 - INFO - Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=4
2024-04-24 15:56:46,868 - INFO - {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'embedding_model': 'TransE', 'seed': 155120739, 'exp_id': 4, 'max_epoch': 200, 'patience': 15, 'output_window': 12, 'load_external': False, 'metrics': ['MAE', 'RMSE'], 'cache_dataset': False, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-24 15:56:46,870 - INFO - Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-24 15:56:46,875 - INFO - set_weight_link_or_dist: dist
2024-04-24 15:56:46,875 - INFO - init_weight_inf_or_zero: inf
2024-04-24 15:56:46,887 - INFO - Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-24 15:56:46,887 - INFO - Start Calculate the weight by Gauss kernel!
2024-04-24 15:56:46,887 - INFO - Loading file CHITaxi20190406.dyna
2024-04-24 15:56:47,014 - INFO - Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-24 15:56:47,129 - INFO - Dataset created
2024-04-24 15:56:47,129 - INFO - x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-04-24 15:56:47,133 - INFO - train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-04-24 15:56:47,133 - INFO - eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-04-24 15:56:47,133 - INFO - test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-04-24 15:56:47,159 - INFO - StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-24 15:56:47,159 - INFO - NoneScaler
2024-04-24 15:56:47,287 - INFO - AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-24 15:56:47,288 - INFO - node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-24 15:56:47,288 - INFO - encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-04-24 15:56:47,288 - INFO - encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 15:56:47,288 - INFO - encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-04-24 15:56:47,288 - INFO - encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 15:56:47,288 - INFO - encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-24 15:56:47,289 - INFO - encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 15:56:47,289 - INFO - encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-24 15:56:47,289 - INFO - encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 15:56:47,289 - INFO - end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-24 15:56:47,289 - INFO - end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-24 15:56:47,289 - INFO - Total parameter numbers: 751130
2024-04-24 15:56:47,290 - INFO - You select `adam` optimizer.
2024-04-24 15:56:47,290 - WARNING - Received none train loss func and will use the loss func defined in the model.
2024-04-24 15:56:47,290 - INFO - Start training ...
2024-04-24 15:56:47,290 - INFO - num_batches:48
2024-04-24 15:56:51,579 - INFO - epoch complete!
2024-04-24 15:56:51,579 - INFO - evaluating now!
2024-04-24 15:56:51,804 - INFO - Epoch [0/200] train_loss: 23.4012, val_loss: 16.8245, lr: 0.003000, 4.51s
2024-04-24 15:56:51,817 - INFO - Saved model at 0
2024-04-24 15:56:51,817 - INFO - Val loss decrease from inf to 16.8245, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-24 15:56:56,120 - INFO - epoch complete!
2024-04-24 15:56:56,120 - INFO - evaluating now!
2024-04-24 15:56:56,340 - INFO - Epoch [1/200] train_loss: 12.9978, val_loss: 11.9771, lr: 0.003000, 4.52s
2024-04-24 15:56:56,354 - INFO - Saved model at 1
2024-04-24 15:56:56,354 - INFO - Val loss decrease from 16.8245 to 11.9771, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-24 15:57:00,604 - INFO - epoch complete!
2024-04-24 15:57:00,604 - INFO - evaluating now!
2024-04-24 15:57:00,838 - INFO - Epoch [2/200] train_loss: 9.9568, val_loss: 9.3463, lr: 0.003000, 4.48s
2024-04-24 15:57:00,858 - INFO - Saved model at 2
2024-04-24 15:57:00,858 - INFO - Val loss decrease from 11.9771 to 9.3463, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-24 15:57:05,105 - INFO - epoch complete!
2024-04-24 15:57:05,106 - INFO - evaluating now!
2024-04-24 15:57:05,329 - INFO - Epoch [3/200] train_loss: 8.5268, val_loss: 8.0658, lr: 0.003000, 4.47s
2024-04-24 15:57:05,342 - INFO - Saved model at 3
2024-04-24 15:57:05,342 - INFO - Val loss decrease from 9.3463 to 8.0658, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-24 15:57:09,633 - INFO - epoch complete!
2024-04-24 15:57:09,633 - INFO - evaluating now!
2024-04-24 15:57:09,856 - INFO - Epoch [4/200] train_loss: 7.5899, val_loss: 7.2014, lr: 0.003000, 4.51s
2024-04-24 15:57:09,869 - INFO - Saved model at 4
2024-04-24 15:57:09,869 - INFO - Val loss decrease from 8.0658 to 7.2014, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-24 15:57:14,208 - INFO - epoch complete!
2024-04-24 15:57:14,209 - INFO - evaluating now!
2024-04-24 15:57:14,434 - INFO - Epoch [5/200] train_loss: 6.8826, val_loss: 6.6617, lr: 0.003000, 4.57s
2024-04-24 15:57:14,447 - INFO - Saved model at 5
2024-04-24 15:57:14,448 - INFO - Val loss decrease from 7.2014 to 6.6617, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-24 15:57:18,981 - INFO - epoch complete!
2024-04-24 15:57:18,981 - INFO - evaluating now!
2024-04-24 15:57:19,212 - INFO - Epoch [6/200] train_loss: 6.4723, val_loss: 6.4357, lr: 0.003000, 4.76s
2024-04-24 15:57:19,226 - INFO - Saved model at 6
2024-04-24 15:57:19,226 - INFO - Val loss decrease from 6.6617 to 6.4357, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-24 15:57:23,546 - INFO - epoch complete!
2024-04-24 15:57:23,546 - INFO - evaluating now!
2024-04-24 15:57:23,773 - INFO - Epoch [7/200] train_loss: 6.0984, val_loss: 6.1360, lr: 0.003000, 4.55s
2024-04-24 15:57:23,785 - INFO - Saved model at 7
2024-04-24 15:57:23,785 - INFO - Val loss decrease from 6.4357 to 6.1360, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-24 15:57:28,114 - INFO - epoch complete!
2024-04-24 15:57:28,114 - INFO - evaluating now!
2024-04-24 15:57:28,342 - INFO - Epoch [8/200] train_loss: 5.9618, val_loss: 5.8489, lr: 0.003000, 4.56s
2024-04-24 15:57:28,356 - INFO - Saved model at 8
2024-04-24 15:57:28,356 - INFO - Val loss decrease from 6.1360 to 5.8489, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-24 15:57:32,705 - INFO - epoch complete!
2024-04-24 15:57:32,706 - INFO - evaluating now!
2024-04-24 15:57:32,929 - INFO - Epoch [9/200] train_loss: 5.6555, val_loss: 6.0450, lr: 0.003000, 4.57s
2024-04-24 15:57:37,247 - INFO - epoch complete!
2024-04-24 15:57:37,248 - INFO - evaluating now!
2024-04-24 15:57:37,505 - INFO - Epoch [10/200] train_loss: 5.5116, val_loss: 5.7021, lr: 0.003000, 4.57s
2024-04-24 15:57:37,518 - INFO - Saved model at 10
2024-04-24 15:57:37,518 - INFO - Val loss decrease from 5.8489 to 5.7021, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-24 15:57:41,929 - INFO - epoch complete!
2024-04-24 15:57:41,930 - INFO - evaluating now!
2024-04-24 15:57:42,163 - INFO - Epoch [11/200] train_loss: 5.4661, val_loss: 5.7500, lr: 0.003000, 4.65s
2024-04-24 15:57:46,455 - INFO - epoch complete!
2024-04-24 15:57:46,456 - INFO - evaluating now!
2024-04-24 15:57:46,685 - INFO - Epoch [12/200] train_loss: 5.2694, val_loss: 5.4974, lr: 0.003000, 4.52s
2024-04-24 15:57:46,697 - INFO - Saved model at 12
2024-04-24 15:57:46,697 - INFO - Val loss decrease from 5.7021 to 5.4974, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-24 15:57:51,033 - INFO - epoch complete!
2024-04-24 15:57:51,033 - INFO - evaluating now!
2024-04-24 15:57:51,258 - INFO - Epoch [13/200] train_loss: 5.1211, val_loss: 5.4690, lr: 0.003000, 4.56s
2024-04-24 15:57:51,270 - INFO - Saved model at 13
2024-04-24 15:57:51,272 - INFO - Val loss decrease from 5.4974 to 5.4690, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-24 15:57:55,633 - INFO - epoch complete!
2024-04-24 15:57:55,634 - INFO - evaluating now!
2024-04-24 15:57:55,859 - INFO - Epoch [14/200] train_loss: 5.1209, val_loss: 5.6146, lr: 0.003000, 4.59s
2024-04-24 15:58:00,243 - INFO - epoch complete!
2024-04-24 15:58:00,244 - INFO - evaluating now!
2024-04-24 15:58:00,469 - INFO - Epoch [15/200] train_loss: 4.9818, val_loss: 5.3339, lr: 0.003000, 4.61s
2024-04-24 15:58:00,483 - INFO - Saved model at 15
2024-04-24 15:58:00,484 - INFO - Val loss decrease from 5.4690 to 5.3339, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-24 15:58:04,811 - INFO - epoch complete!
2024-04-24 15:58:04,811 - INFO - evaluating now!
2024-04-24 15:58:05,049 - INFO - Epoch [16/200] train_loss: 4.8948, val_loss: 5.3768, lr: 0.003000, 4.56s
2024-04-24 15:58:09,380 - INFO - epoch complete!
2024-04-24 15:58:09,381 - INFO - evaluating now!
2024-04-24 15:58:09,623 - INFO - Epoch [17/200] train_loss: 4.8149, val_loss: 5.3630, lr: 0.003000, 4.57s
2024-04-24 15:58:14,032 - INFO - epoch complete!
2024-04-24 15:58:14,032 - INFO - evaluating now!
2024-04-24 15:58:14,260 - INFO - Epoch [18/200] train_loss: 4.6900, val_loss: 5.1167, lr: 0.003000, 4.64s
2024-04-24 15:58:14,273 - INFO - Saved model at 18
2024-04-24 15:58:14,273 - INFO - Val loss decrease from 5.3339 to 5.1167, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-24 15:58:18,991 - INFO - epoch complete!
2024-04-24 15:58:18,991 - INFO - evaluating now!
2024-04-24 15:58:19,229 - INFO - Epoch [19/200] train_loss: 4.7057, val_loss: 5.4544, lr: 0.003000, 4.96s
2024-04-24 15:58:23,768 - INFO - epoch complete!
2024-04-24 15:58:23,768 - INFO - evaluating now!
2024-04-24 15:58:24,008 - INFO - Epoch [20/200] train_loss: 4.5969, val_loss: 5.3470, lr: 0.003000, 4.78s
2024-04-24 15:58:28,392 - INFO - epoch complete!
2024-04-24 15:58:28,392 - INFO - evaluating now!
2024-04-24 15:58:28,616 - INFO - Epoch [21/200] train_loss: 4.5174, val_loss: 5.2958, lr: 0.003000, 4.61s
2024-04-24 15:58:32,888 - INFO - epoch complete!
2024-04-24 15:58:32,888 - INFO - evaluating now!
2024-04-24 15:58:33,133 - INFO - Epoch [22/200] train_loss: 4.5145, val_loss: 5.5778, lr: 0.003000, 4.52s
2024-04-24 15:58:37,521 - INFO - epoch complete!
2024-04-24 15:58:37,522 - INFO - evaluating now!
2024-04-24 15:58:37,755 - INFO - Epoch [23/200] train_loss: 4.4506, val_loss: 5.3556, lr: 0.003000, 4.62s
2024-04-24 15:58:42,138 - INFO - epoch complete!
2024-04-24 15:58:42,138 - INFO - evaluating now!
2024-04-24 15:58:42,390 - INFO - Epoch [24/200] train_loss: 4.4048, val_loss: 5.4819, lr: 0.003000, 4.63s
2024-04-24 15:58:46,996 - INFO - epoch complete!
2024-04-24 15:58:46,996 - INFO - evaluating now!
2024-04-24 15:58:47,279 - INFO - Epoch [25/200] train_loss: 4.3559, val_loss: 5.1339, lr: 0.003000, 4.89s
2024-04-24 15:58:51,607 - INFO - epoch complete!
2024-04-24 15:58:51,608 - INFO - evaluating now!
2024-04-24 15:58:51,856 - INFO - Epoch [26/200] train_loss: 4.2920, val_loss: 5.2845, lr: 0.003000, 4.58s
2024-04-24 15:58:56,166 - INFO - epoch complete!
2024-04-24 15:58:56,166 - INFO - evaluating now!
2024-04-24 15:58:56,427 - INFO - Epoch [27/200] train_loss: 4.2615, val_loss: 5.0136, lr: 0.003000, 4.57s
2024-04-24 15:58:56,440 - INFO - Saved model at 27
2024-04-24 15:58:56,441 - INFO - Val loss decrease from 5.1167 to 5.0136, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-24 15:59:00,699 - INFO - epoch complete!
2024-04-24 15:59:00,699 - INFO - evaluating now!
2024-04-24 15:59:00,923 - INFO - Epoch [28/200] train_loss: 4.2731, val_loss: 5.2022, lr: 0.003000, 4.48s
2024-04-24 15:59:05,212 - INFO - epoch complete!
2024-04-24 15:59:05,212 - INFO - evaluating now!
2024-04-24 15:59:05,436 - INFO - Epoch [29/200] train_loss: 4.2124, val_loss: 5.0432, lr: 0.003000, 4.51s
2024-04-24 15:59:09,733 - INFO - epoch complete!
2024-04-24 15:59:09,734 - INFO - evaluating now!
2024-04-24 15:59:09,958 - INFO - Epoch [30/200] train_loss: 4.1835, val_loss: 4.9555, lr: 0.003000, 4.52s
2024-04-24 15:59:09,971 - INFO - Saved model at 30
2024-04-24 15:59:09,971 - INFO - Val loss decrease from 5.0136 to 4.9555, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-04-24 15:59:14,220 - INFO - epoch complete!
2024-04-24 15:59:14,220 - INFO - evaluating now!
2024-04-24 15:59:14,447 - INFO - Epoch [31/200] train_loss: 4.1295, val_loss: 5.1789, lr: 0.003000, 4.48s
2024-04-24 15:59:18,690 - INFO - epoch complete!
2024-04-24 15:59:18,691 - INFO - evaluating now!
2024-04-24 15:59:18,916 - INFO - Epoch [32/200] train_loss: 4.0723, val_loss: 5.2254, lr: 0.003000, 4.47s
2024-04-24 15:59:23,298 - INFO - epoch complete!
2024-04-24 15:59:23,298 - INFO - evaluating now!
2024-04-24 15:59:23,521 - INFO - Epoch [33/200] train_loss: 4.0244, val_loss: 5.1144, lr: 0.003000, 4.60s
2024-04-24 15:59:27,794 - INFO - epoch complete!
2024-04-24 15:59:27,794 - INFO - evaluating now!
2024-04-24 15:59:28,017 - INFO - Epoch [34/200] train_loss: 4.0376, val_loss: 5.1143, lr: 0.003000, 4.49s
2024-04-24 15:59:32,269 - INFO - epoch complete!
2024-04-24 15:59:32,269 - INFO - evaluating now!
2024-04-24 15:59:32,493 - INFO - Epoch [35/200] train_loss: 4.0024, val_loss: 5.1493, lr: 0.003000, 4.48s
2024-04-24 15:59:36,782 - INFO - epoch complete!
2024-04-24 15:59:36,782 - INFO - evaluating now!
2024-04-24 15:59:37,023 - INFO - Epoch [36/200] train_loss: 4.0107, val_loss: 5.0653, lr: 0.003000, 4.53s
2024-04-24 15:59:41,436 - INFO - epoch complete!
2024-04-24 15:59:41,436 - INFO - evaluating now!
2024-04-24 15:59:41,660 - INFO - Epoch [37/200] train_loss: 3.9667, val_loss: 5.1911, lr: 0.003000, 4.64s
2024-04-24 15:59:45,908 - INFO - epoch complete!
2024-04-24 15:59:45,908 - INFO - evaluating now!
2024-04-24 15:59:46,132 - INFO - Epoch [38/200] train_loss: 3.9187, val_loss: 5.1117, lr: 0.003000, 4.47s
2024-04-24 15:59:50,388 - INFO - epoch complete!
2024-04-24 15:59:50,388 - INFO - evaluating now!
2024-04-24 15:59:50,611 - INFO - Epoch [39/200] train_loss: 3.9197, val_loss: 5.0927, lr: 0.003000, 4.48s
2024-04-24 15:59:54,863 - INFO - epoch complete!
2024-04-24 15:59:54,863 - INFO - evaluating now!
2024-04-24 15:59:55,087 - INFO - Epoch [40/200] train_loss: 3.9232, val_loss: 5.0066, lr: 0.003000, 4.48s
2024-04-24 15:59:59,342 - INFO - epoch complete!
2024-04-24 15:59:59,342 - INFO - evaluating now!
2024-04-24 15:59:59,565 - INFO - Epoch [41/200] train_loss: 3.8236, val_loss: 5.2096, lr: 0.003000, 4.48s
2024-04-24 16:00:03,924 - INFO - epoch complete!
2024-04-24 16:00:03,924 - INFO - evaluating now!
2024-04-24 16:00:04,146 - INFO - Epoch [42/200] train_loss: 3.8055, val_loss: 5.1247, lr: 0.003000, 4.58s
2024-04-24 16:00:08,453 - INFO - epoch complete!
2024-04-24 16:00:08,454 - INFO - evaluating now!
2024-04-24 16:00:08,673 - INFO - Epoch [43/200] train_loss: 3.7694, val_loss: 5.2043, lr: 0.003000, 4.53s
2024-04-24 16:00:12,945 - INFO - epoch complete!
2024-04-24 16:00:12,946 - INFO - evaluating now!
2024-04-24 16:00:13,174 - INFO - Epoch [44/200] train_loss: 3.8085, val_loss: 4.9231, lr: 0.003000, 4.50s
2024-04-24 16:00:13,187 - INFO - Saved model at 44
2024-04-24 16:00:13,188 - INFO - Val loss decrease from 4.9555 to 4.9231, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-04-24 16:00:17,440 - INFO - epoch complete!
2024-04-24 16:00:17,440 - INFO - evaluating now!
2024-04-24 16:00:17,664 - INFO - Epoch [45/200] train_loss: 3.7410, val_loss: 5.0876, lr: 0.003000, 4.48s
2024-04-24 16:00:21,925 - INFO - epoch complete!
2024-04-24 16:00:21,926 - INFO - evaluating now!
2024-04-24 16:00:22,149 - INFO - Epoch [46/200] train_loss: 3.6968, val_loss: 5.0066, lr: 0.003000, 4.48s
2024-04-24 16:00:26,403 - INFO - epoch complete!
2024-04-24 16:00:26,403 - INFO - evaluating now!
2024-04-24 16:00:26,627 - INFO - Epoch [47/200] train_loss: 3.7193, val_loss: 5.0890, lr: 0.003000, 4.48s
2024-04-24 16:00:30,911 - INFO - epoch complete!
2024-04-24 16:00:30,911 - INFO - evaluating now!
2024-04-24 16:00:31,135 - INFO - Epoch [48/200] train_loss: 3.7223, val_loss: 5.0286, lr: 0.003000, 4.51s
2024-04-24 16:00:35,417 - INFO - epoch complete!
2024-04-24 16:00:35,417 - INFO - evaluating now!
2024-04-24 16:00:35,663 - INFO - Epoch [49/200] train_loss: 3.6416, val_loss: 5.1712, lr: 0.003000, 4.53s
2024-04-24 16:00:39,930 - INFO - epoch complete!
2024-04-24 16:00:39,931 - INFO - evaluating now!
2024-04-24 16:00:40,155 - INFO - Epoch [50/200] train_loss: 3.6353, val_loss: 5.0156, lr: 0.003000, 4.49s
2024-04-24 16:00:44,424 - INFO - epoch complete!
2024-04-24 16:00:44,424 - INFO - evaluating now!
2024-04-24 16:00:44,648 - INFO - Epoch [51/200] train_loss: 3.6546, val_loss: 5.0911, lr: 0.003000, 4.49s
2024-04-24 16:00:48,962 - INFO - epoch complete!
2024-04-24 16:00:48,963 - INFO - evaluating now!
2024-04-24 16:00:49,189 - INFO - Epoch [52/200] train_loss: 3.6088, val_loss: 5.1222, lr: 0.003000, 4.54s
2024-04-24 16:00:53,508 - INFO - epoch complete!
2024-04-24 16:00:53,508 - INFO - evaluating now!
2024-04-24 16:00:53,745 - INFO - Epoch [53/200] train_loss: 3.6253, val_loss: 5.2557, lr: 0.003000, 4.56s
2024-04-24 16:00:58,148 - INFO - epoch complete!
2024-04-24 16:00:58,149 - INFO - evaluating now!
2024-04-24 16:00:58,372 - INFO - Epoch [54/200] train_loss: 3.5766, val_loss: 5.0514, lr: 0.003000, 4.63s
2024-04-24 16:01:02,745 - INFO - epoch complete!
2024-04-24 16:01:02,745 - INFO - evaluating now!
2024-04-24 16:01:02,971 - INFO - Epoch [55/200] train_loss: 3.5290, val_loss: 5.1786, lr: 0.003000, 4.60s
2024-04-24 16:01:07,601 - INFO - epoch complete!
2024-04-24 16:01:07,602 - INFO - evaluating now!
2024-04-24 16:01:07,821 - INFO - Epoch [56/200] train_loss: 3.5620, val_loss: 5.1248, lr: 0.003000, 4.85s
2024-04-24 16:01:12,184 - INFO - epoch complete!
2024-04-24 16:01:12,185 - INFO - evaluating now!
2024-04-24 16:01:12,414 - INFO - Epoch [57/200] train_loss: 3.5386, val_loss: 5.1001, lr: 0.003000, 4.59s
2024-04-24 16:01:16,820 - INFO - epoch complete!
2024-04-24 16:01:16,820 - INFO - evaluating now!
2024-04-24 16:01:17,047 - INFO - Epoch [58/200] train_loss: 3.5206, val_loss: 5.1462, lr: 0.003000, 4.63s
2024-04-24 16:01:21,502 - INFO - epoch complete!
2024-04-24 16:01:21,502 - INFO - evaluating now!
2024-04-24 16:01:21,725 - INFO - Epoch [59/200] train_loss: 3.5075, val_loss: 5.1648, lr: 0.003000, 4.68s
2024-04-24 16:01:21,726 - WARNING - Early stopping at epoch: 59
2024-04-24 16:01:21,726 - INFO - Trained totally 60 epochs, average train time is 4.339s, average eval time is 0.230s
2024-04-24 16:01:21,734 - INFO - Loaded model at 44
2024-04-24 16:01:21,734 - INFO - Saved model at ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406.m
2024-04-24 16:01:21,747 - INFO - Start evaluating ...
2024-04-24 16:01:22,557 - INFO - Note that you select the single mode to evaluate!
2024-04-24 16:01:22,560 - INFO - Evaluate result is saved at ./libcity/cache/4/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-24 16:01:22,562 - INFO - 
         MAE       RMSE
1   2.392552   7.174065
2   2.496755   7.763762
3   2.610265   8.689969
4   2.730084   9.429088
5   2.905642  10.249805
6   2.984178  10.985509
7   3.102407  11.495355
8   3.222847  12.146036
9   3.287190  12.480294
10  3.305521  12.731279
11  3.434649  13.045012
12  3.503419  13.571084
2024-04-24 16:01:22,568 - INFO - ----------------------------------------------------------------------------
2024-04-24 16:01:22,568 - INFO - Kownledge Graph Embedding: False, Experiment ids: [0, 1, 2, 3, 4]
2024-04-24 16:01:22,573 - INFO - ----------------------------------------------------------------------------
2024-04-24 16:01:22,576 - INFO - Average: 
         MAE       RMSE
0   2.384957   7.224564
1   2.492162   7.828604
2   2.675877   8.882849
3   2.818493   9.735227
4   2.959794  10.609444
5   3.049097  11.398686
6   3.107586  11.915361
7   3.152551  12.388348
8   3.193414  12.697428
9   3.233116  12.932398
10  3.329865  13.290116
11  3.436312  13.845850 
2024-04-24 16:01:22,578 - INFO - Standard deviation: 
         MAE      RMSE
0   0.044853  0.253540
1   0.053394  0.252837
2   0.046930  0.244489
3   0.052114  0.330097
4   0.050030  0.394407
5   0.060079  0.462365
6   0.048143  0.468794
7   0.068308  0.376967
8   0.077058  0.337371
9   0.079009  0.395292
10  0.094271  0.531898
11  0.083948  0.653284
2024-04-24 16:01:22,583 - INFO - ----------------------------------------------------------------------------
2024-04-24 16:01:22,585 - INFO - 12 steps Average: 
        MAE       RMSE
0  2.986102  11.062406
2024-04-24 16:01:22,587 - INFO - 12 steps Standard deviation: 
        MAE      RMSE
0  0.063178  0.391778
