2024-04-24 14:59:47,043 - INFO - Log directory: ./libcity/log
2024-04-24 14:59:47,044 - INFO - Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=7
2024-04-24 14:59:47,044 - INFO - {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'embedding_model': 'TransE', 'seed': 96887160, 'exp_id': 7, 'max_epoch': 200, 'patience': 15, 'output_window': 12, 'load_external': True, 'metrics': ['MAE', 'RMSE'], 'cache_dataset': False, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-24 14:59:47,046 - INFO - Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-24 14:59:47,051 - INFO - set_weight_link_or_dist: dist
2024-04-24 14:59:47,051 - INFO - init_weight_inf_or_zero: inf
2024-04-24 14:59:47,063 - INFO - Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-24 14:59:47,063 - INFO - Start Calculate the weight by Gauss kernel!
2024-04-24 14:59:47,064 - INFO - Loading file CHITaxi20190406.dyna
2024-04-24 14:59:47,195 - INFO - Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-24 14:59:49,014 - INFO - Dataset created
2024-04-24 14:59:49,014 - INFO - x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-24 14:59:49,083 - INFO - train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-24 14:59:49,083 - INFO - eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-24 14:59:49,083 - INFO - test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-24 14:59:49,175 - INFO - StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-24 14:59:49,176 - INFO - NoneScaler
2024-04-24 14:59:50,385 - INFO - AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-24 14:59:50,385 - INFO - node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-24 14:59:50,385 - INFO - encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-24 14:59:50,385 - INFO - encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 14:59:50,386 - INFO - encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-24 14:59:50,386 - INFO - encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 14:59:50,386 - INFO - encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-24 14:59:50,386 - INFO - encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 14:59:50,386 - INFO - encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-24 14:59:50,386 - INFO - encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 14:59:50,386 - INFO - end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-24 14:59:50,386 - INFO - end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-24 14:59:50,387 - INFO - Total parameter numbers: 874010
2024-04-24 14:59:50,387 - INFO - You select `adam` optimizer.
2024-04-24 14:59:50,387 - WARNING - Received none train loss func and will use the loss func defined in the model.
2024-04-24 14:59:50,387 - INFO - Start training ...
2024-04-24 14:59:50,387 - INFO - num_batches:48
2024-04-24 14:59:55,754 - INFO - epoch complete!
2024-04-24 14:59:55,754 - INFO - evaluating now!
2024-04-24 14:59:56,090 - INFO - Epoch [0/200] train_loss: 24.1972, val_loss: 18.9319, lr: 0.003000, 5.70s
2024-04-24 14:59:56,104 - INFO - Saved model at 0
2024-04-24 14:59:56,105 - INFO - Val loss decrease from inf to 18.9319, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-24 15:00:01,275 - INFO - epoch complete!
2024-04-24 15:00:01,275 - INFO - evaluating now!
2024-04-24 15:00:01,610 - INFO - Epoch [1/200] train_loss: 15.4982, val_loss: 14.9350, lr: 0.003000, 5.51s
2024-04-24 15:00:01,625 - INFO - Saved model at 1
2024-04-24 15:00:01,625 - INFO - Val loss decrease from 18.9319 to 14.9350, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-24 15:00:06,766 - INFO - epoch complete!
2024-04-24 15:00:06,766 - INFO - evaluating now!
2024-04-24 15:00:07,092 - INFO - Epoch [2/200] train_loss: 13.1244, val_loss: 13.3724, lr: 0.003000, 5.47s
2024-04-24 15:00:07,106 - INFO - Saved model at 2
2024-04-24 15:00:07,107 - INFO - Val loss decrease from 14.9350 to 13.3724, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-24 15:00:12,126 - INFO - epoch complete!
2024-04-24 15:00:12,127 - INFO - evaluating now!
2024-04-24 15:00:12,454 - INFO - Epoch [3/200] train_loss: 11.7581, val_loss: 11.4774, lr: 0.003000, 5.35s
2024-04-24 15:00:12,468 - INFO - Saved model at 3
2024-04-24 15:00:12,468 - INFO - Val loss decrease from 13.3724 to 11.4774, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-24 15:00:17,477 - INFO - epoch complete!
2024-04-24 15:00:17,477 - INFO - evaluating now!
2024-04-24 15:00:17,796 - INFO - Epoch [4/200] train_loss: 9.7812, val_loss: 9.4709, lr: 0.003000, 5.33s
2024-04-24 15:00:17,810 - INFO - Saved model at 4
2024-04-24 15:00:17,810 - INFO - Val loss decrease from 11.4774 to 9.4709, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-24 15:00:22,753 - INFO - epoch complete!
2024-04-24 15:00:22,753 - INFO - evaluating now!
2024-04-24 15:00:23,123 - INFO - Epoch [5/200] train_loss: 8.4556, val_loss: 8.1541, lr: 0.003000, 5.31s
2024-04-24 15:00:23,137 - INFO - Saved model at 5
2024-04-24 15:00:23,137 - INFO - Val loss decrease from 9.4709 to 8.1541, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-24 15:00:28,181 - INFO - epoch complete!
2024-04-24 15:00:28,182 - INFO - evaluating now!
2024-04-24 15:00:28,689 - INFO - Epoch [6/200] train_loss: 7.6206, val_loss: 7.3470, lr: 0.003000, 5.55s
2024-04-24 15:00:28,704 - INFO - Saved model at 6
2024-04-24 15:00:28,704 - INFO - Val loss decrease from 8.1541 to 7.3470, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-24 15:00:33,774 - INFO - epoch complete!
2024-04-24 15:00:33,774 - INFO - evaluating now!
2024-04-24 15:00:34,107 - INFO - Epoch [7/200] train_loss: 7.1489, val_loss: 6.8521, lr: 0.003000, 5.40s
2024-04-24 15:00:34,121 - INFO - Saved model at 7
2024-04-24 15:00:34,121 - INFO - Val loss decrease from 7.3470 to 6.8521, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-24 15:00:39,474 - INFO - epoch complete!
2024-04-24 15:00:39,475 - INFO - evaluating now!
2024-04-24 15:00:39,876 - INFO - Epoch [8/200] train_loss: 6.7283, val_loss: 6.5455, lr: 0.003000, 5.75s
2024-04-24 15:00:39,892 - INFO - Saved model at 8
2024-04-24 15:00:39,893 - INFO - Val loss decrease from 6.8521 to 6.5455, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-24 15:00:45,562 - INFO - epoch complete!
2024-04-24 15:00:45,563 - INFO - evaluating now!
2024-04-24 15:00:46,075 - INFO - Epoch [9/200] train_loss: 6.4220, val_loss: 6.2820, lr: 0.003000, 6.18s
2024-04-24 15:00:46,094 - INFO - Saved model at 9
2024-04-24 15:00:46,095 - INFO - Val loss decrease from 6.5455 to 6.2820, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-24 15:00:52,153 - INFO - epoch complete!
2024-04-24 15:00:52,153 - INFO - evaluating now!
2024-04-24 15:00:52,547 - INFO - Epoch [10/200] train_loss: 6.1172, val_loss: 6.3233, lr: 0.003000, 6.45s
2024-04-24 15:00:57,998 - INFO - epoch complete!
2024-04-24 15:00:57,999 - INFO - evaluating now!
2024-04-24 15:00:58,336 - INFO - Epoch [11/200] train_loss: 5.9915, val_loss: 6.2990, lr: 0.003000, 5.79s
2024-04-24 15:01:03,552 - INFO - epoch complete!
2024-04-24 15:01:03,553 - INFO - evaluating now!
2024-04-24 15:01:03,869 - INFO - Epoch [12/200] train_loss: 5.7902, val_loss: 5.8689, lr: 0.003000, 5.53s
2024-04-24 15:01:03,883 - INFO - Saved model at 12
2024-04-24 15:01:03,883 - INFO - Val loss decrease from 6.2820 to 5.8689, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-24 15:01:09,192 - INFO - epoch complete!
2024-04-24 15:01:09,192 - INFO - evaluating now!
2024-04-24 15:01:09,534 - INFO - Epoch [13/200] train_loss: 5.6378, val_loss: 5.7740, lr: 0.003000, 5.65s
2024-04-24 15:01:09,549 - INFO - Saved model at 13
2024-04-24 15:01:09,549 - INFO - Val loss decrease from 5.8689 to 5.7740, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-24 15:01:14,773 - INFO - epoch complete!
2024-04-24 15:01:14,773 - INFO - evaluating now!
2024-04-24 15:01:15,104 - INFO - Epoch [14/200] train_loss: 5.6252, val_loss: 5.7836, lr: 0.003000, 5.55s
2024-04-24 15:01:20,296 - INFO - epoch complete!
2024-04-24 15:01:20,296 - INFO - evaluating now!
2024-04-24 15:01:20,670 - INFO - Epoch [15/200] train_loss: 5.3950, val_loss: 5.7816, lr: 0.003000, 5.57s
2024-04-24 15:01:26,067 - INFO - epoch complete!
2024-04-24 15:01:26,067 - INFO - evaluating now!
2024-04-24 15:01:26,401 - INFO - Epoch [16/200] train_loss: 5.2765, val_loss: 5.6556, lr: 0.003000, 5.73s
2024-04-24 15:01:26,419 - INFO - Saved model at 16
2024-04-24 15:01:26,419 - INFO - Val loss decrease from 5.7740 to 5.6556, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-24 15:01:31,833 - INFO - epoch complete!
2024-04-24 15:01:31,833 - INFO - evaluating now!
2024-04-24 15:01:32,167 - INFO - Epoch [17/200] train_loss: 5.3231, val_loss: 5.5919, lr: 0.003000, 5.75s
2024-04-24 15:01:32,182 - INFO - Saved model at 17
2024-04-24 15:01:32,182 - INFO - Val loss decrease from 5.6556 to 5.5919, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-24 15:01:37,222 - INFO - epoch complete!
2024-04-24 15:01:37,222 - INFO - evaluating now!
2024-04-24 15:01:37,582 - INFO - Epoch [18/200] train_loss: 5.1867, val_loss: 5.6343, lr: 0.003000, 5.40s
2024-04-24 15:01:42,697 - INFO - epoch complete!
2024-04-24 15:01:42,697 - INFO - evaluating now!
2024-04-24 15:01:43,063 - INFO - Epoch [19/200] train_loss: 5.1242, val_loss: 5.5377, lr: 0.003000, 5.48s
2024-04-24 15:01:43,078 - INFO - Saved model at 19
2024-04-24 15:01:43,078 - INFO - Val loss decrease from 5.5919 to 5.5377, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-24 15:01:48,354 - INFO - epoch complete!
2024-04-24 15:01:48,355 - INFO - evaluating now!
2024-04-24 15:01:48,732 - INFO - Epoch [20/200] train_loss: 4.9626, val_loss: 5.7134, lr: 0.003000, 5.65s
2024-04-24 15:01:53,878 - INFO - epoch complete!
2024-04-24 15:01:53,878 - INFO - evaluating now!
2024-04-24 15:01:54,232 - INFO - Epoch [21/200] train_loss: 4.9489, val_loss: 5.6084, lr: 0.003000, 5.50s
2024-04-24 15:01:59,236 - INFO - epoch complete!
2024-04-24 15:01:59,236 - INFO - evaluating now!
2024-04-24 15:01:59,564 - INFO - Epoch [22/200] train_loss: 4.9714, val_loss: 5.7614, lr: 0.003000, 5.33s
2024-04-24 15:02:04,651 - INFO - epoch complete!
2024-04-24 15:02:04,651 - INFO - evaluating now!
2024-04-24 15:02:05,007 - INFO - Epoch [23/200] train_loss: 4.8004, val_loss: 5.3263, lr: 0.003000, 5.44s
2024-04-24 15:02:05,022 - INFO - Saved model at 23
2024-04-24 15:02:05,022 - INFO - Val loss decrease from 5.5377 to 5.3263, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-24 15:02:10,151 - INFO - epoch complete!
2024-04-24 15:02:10,151 - INFO - evaluating now!
2024-04-24 15:02:10,489 - INFO - Epoch [24/200] train_loss: 4.7188, val_loss: 5.4863, lr: 0.003000, 5.47s
2024-04-24 15:02:15,640 - INFO - epoch complete!
2024-04-24 15:02:15,641 - INFO - evaluating now!
2024-04-24 15:02:15,961 - INFO - Epoch [25/200] train_loss: 4.7486, val_loss: 5.2233, lr: 0.003000, 5.47s
2024-04-24 15:02:15,975 - INFO - Saved model at 25
2024-04-24 15:02:15,976 - INFO - Val loss decrease from 5.3263 to 5.2233, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-24 15:02:21,012 - INFO - epoch complete!
2024-04-24 15:02:21,012 - INFO - evaluating now!
2024-04-24 15:02:21,341 - INFO - Epoch [26/200] train_loss: 4.7178, val_loss: 5.3266, lr: 0.003000, 5.36s
2024-04-24 15:02:26,257 - INFO - epoch complete!
2024-04-24 15:02:26,257 - INFO - evaluating now!
2024-04-24 15:02:26,596 - INFO - Epoch [27/200] train_loss: 4.6918, val_loss: 5.3896, lr: 0.003000, 5.25s
2024-04-24 15:02:31,511 - INFO - epoch complete!
2024-04-24 15:02:31,512 - INFO - evaluating now!
2024-04-24 15:02:31,868 - INFO - Epoch [28/200] train_loss: 4.5690, val_loss: 5.1185, lr: 0.003000, 5.27s
2024-04-24 15:02:31,883 - INFO - Saved model at 28
2024-04-24 15:02:31,883 - INFO - Val loss decrease from 5.2233 to 5.1185, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-04-24 15:02:37,242 - INFO - epoch complete!
2024-04-24 15:02:37,243 - INFO - evaluating now!
2024-04-24 15:02:37,640 - INFO - Epoch [29/200] train_loss: 4.5092, val_loss: 5.1730, lr: 0.003000, 5.76s
2024-04-24 15:02:42,954 - INFO - epoch complete!
2024-04-24 15:02:42,955 - INFO - evaluating now!
2024-04-24 15:02:43,312 - INFO - Epoch [30/200] train_loss: 4.5653, val_loss: 5.2494, lr: 0.003000, 5.67s
2024-04-24 15:02:48,320 - INFO - epoch complete!
2024-04-24 15:02:48,320 - INFO - evaluating now!
2024-04-24 15:02:48,663 - INFO - Epoch [31/200] train_loss: 4.4278, val_loss: 5.1643, lr: 0.003000, 5.35s
2024-04-24 15:02:53,725 - INFO - epoch complete!
2024-04-24 15:02:53,725 - INFO - evaluating now!
2024-04-24 15:02:54,049 - INFO - Epoch [32/200] train_loss: 4.4285, val_loss: 5.2781, lr: 0.003000, 5.38s
2024-04-24 15:02:59,190 - INFO - epoch complete!
2024-04-24 15:02:59,191 - INFO - evaluating now!
2024-04-24 15:02:59,532 - INFO - Epoch [33/200] train_loss: 4.3458, val_loss: 5.2010, lr: 0.003000, 5.48s
2024-04-24 15:03:04,592 - INFO - epoch complete!
2024-04-24 15:03:04,593 - INFO - evaluating now!
2024-04-24 15:03:04,908 - INFO - Epoch [34/200] train_loss: 4.3272, val_loss: 5.1684, lr: 0.003000, 5.38s
2024-04-24 15:03:09,979 - INFO - epoch complete!
2024-04-24 15:03:09,980 - INFO - evaluating now!
2024-04-24 15:03:10,296 - INFO - Epoch [35/200] train_loss: 4.2854, val_loss: 5.0942, lr: 0.003000, 5.39s
2024-04-24 15:03:10,310 - INFO - Saved model at 35
2024-04-24 15:03:10,310 - INFO - Val loss decrease from 5.1185 to 5.0942, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-04-24 15:03:15,216 - INFO - epoch complete!
2024-04-24 15:03:15,217 - INFO - evaluating now!
2024-04-24 15:03:15,536 - INFO - Epoch [36/200] train_loss: 4.2501, val_loss: 5.3014, lr: 0.003000, 5.23s
2024-04-24 15:03:20,580 - INFO - epoch complete!
2024-04-24 15:03:20,580 - INFO - evaluating now!
2024-04-24 15:03:20,924 - INFO - Epoch [37/200] train_loss: 4.2445, val_loss: 5.2307, lr: 0.003000, 5.39s
2024-04-24 15:03:26,055 - INFO - epoch complete!
2024-04-24 15:03:26,055 - INFO - evaluating now!
2024-04-24 15:03:26,378 - INFO - Epoch [38/200] train_loss: 4.1663, val_loss: 5.1635, lr: 0.003000, 5.45s
2024-04-24 15:03:31,599 - INFO - epoch complete!
2024-04-24 15:03:31,599 - INFO - evaluating now!
2024-04-24 15:03:31,951 - INFO - Epoch [39/200] train_loss: 4.1738, val_loss: 5.0333, lr: 0.003000, 5.57s
2024-04-24 15:03:31,967 - INFO - Saved model at 39
2024-04-24 15:03:31,967 - INFO - Val loss decrease from 5.0942 to 5.0333, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-04-24 15:03:37,046 - INFO - epoch complete!
2024-04-24 15:03:37,047 - INFO - evaluating now!
2024-04-24 15:03:37,398 - INFO - Epoch [40/200] train_loss: 4.1414, val_loss: 5.0298, lr: 0.003000, 5.43s
2024-04-24 15:03:37,414 - INFO - Saved model at 40
2024-04-24 15:03:37,414 - INFO - Val loss decrease from 5.0333 to 5.0298, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-04-24 15:03:42,799 - INFO - epoch complete!
2024-04-24 15:03:42,799 - INFO - evaluating now!
2024-04-24 15:03:43,138 - INFO - Epoch [41/200] train_loss: 4.1115, val_loss: 5.0625, lr: 0.003000, 5.72s
2024-04-24 15:03:48,742 - INFO - epoch complete!
2024-04-24 15:03:48,742 - INFO - evaluating now!
2024-04-24 15:03:49,064 - INFO - Epoch [42/200] train_loss: 4.1686, val_loss: 4.9599, lr: 0.003000, 5.93s
2024-04-24 15:03:49,079 - INFO - Saved model at 42
2024-04-24 15:03:49,079 - INFO - Val loss decrease from 5.0298 to 4.9599, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-04-24 15:03:54,508 - INFO - epoch complete!
2024-04-24 15:03:54,508 - INFO - evaluating now!
2024-04-24 15:03:54,850 - INFO - Epoch [43/200] train_loss: 4.0696, val_loss: 5.0979, lr: 0.003000, 5.77s
2024-04-24 15:04:00,215 - INFO - epoch complete!
2024-04-24 15:04:00,215 - INFO - evaluating now!
2024-04-24 15:04:00,540 - INFO - Epoch [44/200] train_loss: 4.0034, val_loss: 5.0823, lr: 0.003000, 5.69s
2024-04-24 15:04:05,843 - INFO - epoch complete!
2024-04-24 15:04:05,844 - INFO - evaluating now!
2024-04-24 15:04:06,182 - INFO - Epoch [45/200] train_loss: 3.9621, val_loss: 5.0572, lr: 0.003000, 5.64s
2024-04-24 15:04:11,507 - INFO - epoch complete!
2024-04-24 15:04:11,507 - INFO - evaluating now!
2024-04-24 15:04:11,885 - INFO - Epoch [46/200] train_loss: 4.0378, val_loss: 5.1354, lr: 0.003000, 5.70s
2024-04-24 15:04:17,127 - INFO - epoch complete!
2024-04-24 15:04:17,128 - INFO - evaluating now!
2024-04-24 15:04:17,453 - INFO - Epoch [47/200] train_loss: 3.9432, val_loss: 5.0578, lr: 0.003000, 5.57s
2024-04-24 15:04:22,543 - INFO - epoch complete!
2024-04-24 15:04:22,543 - INFO - evaluating now!
2024-04-24 15:04:22,870 - INFO - Epoch [48/200] train_loss: 3.8974, val_loss: 5.1581, lr: 0.003000, 5.42s
2024-04-24 15:04:27,876 - INFO - epoch complete!
2024-04-24 15:04:27,876 - INFO - evaluating now!
2024-04-24 15:04:28,194 - INFO - Epoch [49/200] train_loss: 3.9509, val_loss: 5.1264, lr: 0.003000, 5.32s
2024-04-24 15:04:33,257 - INFO - epoch complete!
2024-04-24 15:04:33,257 - INFO - evaluating now!
2024-04-24 15:04:33,576 - INFO - Epoch [50/200] train_loss: 3.9523, val_loss: 5.1350, lr: 0.003000, 5.38s
2024-04-24 15:04:38,883 - INFO - epoch complete!
2024-04-24 15:04:38,884 - INFO - evaluating now!
2024-04-24 15:04:39,285 - INFO - Epoch [51/200] train_loss: 3.9309, val_loss: 4.9351, lr: 0.003000, 5.71s
2024-04-24 15:04:39,299 - INFO - Saved model at 51
2024-04-24 15:04:39,300 - INFO - Val loss decrease from 4.9599 to 4.9351, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-04-24 15:04:44,354 - INFO - epoch complete!
2024-04-24 15:04:44,354 - INFO - evaluating now!
2024-04-24 15:04:44,678 - INFO - Epoch [52/200] train_loss: 3.8466, val_loss: 5.0130, lr: 0.003000, 5.38s
2024-04-24 15:04:49,663 - INFO - epoch complete!
2024-04-24 15:04:49,663 - INFO - evaluating now!
2024-04-24 15:04:49,980 - INFO - Epoch [53/200] train_loss: 3.8164, val_loss: 5.1330, lr: 0.003000, 5.30s
2024-04-24 15:04:54,988 - INFO - epoch complete!
2024-04-24 15:04:54,989 - INFO - evaluating now!
2024-04-24 15:04:55,317 - INFO - Epoch [54/200] train_loss: 3.7722, val_loss: 4.9692, lr: 0.003000, 5.34s
2024-04-24 15:05:00,344 - INFO - epoch complete!
2024-04-24 15:05:00,344 - INFO - evaluating now!
2024-04-24 15:05:00,663 - INFO - Epoch [55/200] train_loss: 3.7799, val_loss: 4.9793, lr: 0.003000, 5.35s
2024-04-24 15:05:05,725 - INFO - epoch complete!
2024-04-24 15:05:05,725 - INFO - evaluating now!
2024-04-24 15:05:06,041 - INFO - Epoch [56/200] train_loss: 3.7500, val_loss: 4.9635, lr: 0.003000, 5.38s
2024-04-24 15:05:11,182 - INFO - epoch complete!
2024-04-24 15:05:11,182 - INFO - evaluating now!
2024-04-24 15:05:11,534 - INFO - Epoch [57/200] train_loss: 3.7288, val_loss: 4.9816, lr: 0.003000, 5.49s
2024-04-24 15:05:16,573 - INFO - epoch complete!
2024-04-24 15:05:16,574 - INFO - evaluating now!
2024-04-24 15:05:16,891 - INFO - Epoch [58/200] train_loss: 3.7817, val_loss: 5.0216, lr: 0.003000, 5.36s
2024-04-24 15:05:22,013 - INFO - epoch complete!
2024-04-24 15:05:22,014 - INFO - evaluating now!
2024-04-24 15:05:22,329 - INFO - Epoch [59/200] train_loss: 3.7259, val_loss: 4.8821, lr: 0.003000, 5.44s
2024-04-24 15:05:22,344 - INFO - Saved model at 59
2024-04-24 15:05:22,344 - INFO - Val loss decrease from 4.9351 to 4.8821, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch59.tar
2024-04-24 15:05:27,352 - INFO - epoch complete!
2024-04-24 15:05:27,353 - INFO - evaluating now!
2024-04-24 15:05:27,691 - INFO - Epoch [60/200] train_loss: 3.7044, val_loss: 5.1373, lr: 0.003000, 5.35s
2024-04-24 15:05:32,752 - INFO - epoch complete!
2024-04-24 15:05:32,753 - INFO - evaluating now!
2024-04-24 15:05:33,066 - INFO - Epoch [61/200] train_loss: 3.7014, val_loss: 5.0211, lr: 0.003000, 5.37s
2024-04-24 15:05:38,064 - INFO - epoch complete!
2024-04-24 15:05:38,064 - INFO - evaluating now!
2024-04-24 15:05:38,381 - INFO - Epoch [62/200] train_loss: 3.6653, val_loss: 5.2157, lr: 0.003000, 5.31s
2024-04-24 15:05:43,446 - INFO - epoch complete!
2024-04-24 15:05:43,446 - INFO - evaluating now!
2024-04-24 15:05:43,791 - INFO - Epoch [63/200] train_loss: 3.6929, val_loss: 5.0708, lr: 0.003000, 5.41s
2024-04-24 15:05:48,837 - INFO - epoch complete!
2024-04-24 15:05:48,837 - INFO - evaluating now!
2024-04-24 15:05:49,175 - INFO - Epoch [64/200] train_loss: 3.7039, val_loss: 5.0312, lr: 0.003000, 5.38s
2024-04-24 15:05:54,176 - INFO - epoch complete!
2024-04-24 15:05:54,176 - INFO - evaluating now!
2024-04-24 15:05:54,513 - INFO - Epoch [65/200] train_loss: 3.6140, val_loss: 5.0480, lr: 0.003000, 5.34s
2024-04-24 15:05:59,443 - INFO - epoch complete!
2024-04-24 15:05:59,443 - INFO - evaluating now!
2024-04-24 15:05:59,780 - INFO - Epoch [66/200] train_loss: 3.6562, val_loss: 4.9533, lr: 0.003000, 5.27s
2024-04-24 15:06:04,983 - INFO - epoch complete!
2024-04-24 15:06:04,983 - INFO - evaluating now!
2024-04-24 15:06:05,301 - INFO - Epoch [67/200] train_loss: 3.5932, val_loss: 5.1767, lr: 0.003000, 5.52s
2024-04-24 15:06:10,457 - INFO - epoch complete!
2024-04-24 15:06:10,457 - INFO - evaluating now!
2024-04-24 15:06:10,787 - INFO - Epoch [68/200] train_loss: 3.6377, val_loss: 5.1416, lr: 0.003000, 5.49s
2024-04-24 15:06:15,843 - INFO - epoch complete!
2024-04-24 15:06:15,843 - INFO - evaluating now!
2024-04-24 15:06:16,164 - INFO - Epoch [69/200] train_loss: 3.6479, val_loss: 5.1022, lr: 0.003000, 5.38s
2024-04-24 15:06:21,035 - INFO - epoch complete!
2024-04-24 15:06:21,035 - INFO - evaluating now!
2024-04-24 15:06:21,356 - INFO - Epoch [70/200] train_loss: 3.6082, val_loss: 5.0141, lr: 0.003000, 5.19s
2024-04-24 15:06:26,283 - INFO - epoch complete!
2024-04-24 15:06:26,284 - INFO - evaluating now!
2024-04-24 15:06:26,593 - INFO - Epoch [71/200] train_loss: 3.5476, val_loss: 5.0423, lr: 0.003000, 5.24s
2024-04-24 15:06:31,638 - INFO - epoch complete!
2024-04-24 15:06:31,638 - INFO - evaluating now!
2024-04-24 15:06:31,967 - INFO - Epoch [72/200] train_loss: 3.5202, val_loss: 4.9973, lr: 0.003000, 5.37s
2024-04-24 15:06:37,170 - INFO - epoch complete!
2024-04-24 15:06:37,171 - INFO - evaluating now!
2024-04-24 15:06:37,493 - INFO - Epoch [73/200] train_loss: 3.4944, val_loss: 5.0393, lr: 0.003000, 5.52s
2024-04-24 15:06:42,560 - INFO - epoch complete!
2024-04-24 15:06:42,560 - INFO - evaluating now!
2024-04-24 15:06:42,869 - INFO - Epoch [74/200] train_loss: 3.5007, val_loss: 5.0422, lr: 0.003000, 5.37s
2024-04-24 15:06:42,869 - WARNING - Early stopping at epoch: 74
2024-04-24 15:06:42,869 - INFO - Trained totally 75 epochs, average train time is 5.152s, average eval time is 0.342s
2024-04-24 15:06:42,877 - INFO - Loaded model at 59
2024-04-24 15:06:42,878 - INFO - Saved model at ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406.m
2024-04-24 15:06:42,891 - INFO - Start evaluating ...
2024-04-24 15:06:43,940 - INFO - Note that you select the single mode to evaluate!
2024-04-24 15:06:43,940 - INFO - Evaluate result is saved at ./libcity/cache/7/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-24 15:06:43,940 - INFO - 
         MAE       RMSE
1   2.564602   7.092932
2   2.627521   7.760072
3   2.784872   8.676744
4   2.892684   9.306130
5   2.995881   9.934743
6   3.059822  10.493694
7   3.161344  11.107627
8   3.181549  11.632455
9   3.294138  12.172544
10  3.359680  12.626396
11  3.468339  12.912018
12  3.492805  13.301882
2024-04-24 15:06:43,987 - INFO - ----------------------------------------------------------------------------
2024-04-24 15:06:43,987 - INFO - # 3, Kownledge Graph Embedding: TransE, Experiment ids: 8
2024-04-24 15:06:43,987 - INFO - ----------------------------------------------------------------------------
2024-04-24 15:06:43,987 - INFO - Log directory: ./libcity/log
2024-04-24 15:06:43,987 - INFO - Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=8
2024-04-24 15:06:43,987 - INFO - {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'embedding_model': 'TransE', 'seed': 16294481, 'exp_id': 8, 'max_epoch': 200, 'patience': 15, 'output_window': 12, 'load_external': True, 'metrics': ['MAE', 'RMSE'], 'cache_dataset': False, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-24 15:06:43,987 - INFO - Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-24 15:06:43,987 - INFO - set_weight_link_or_dist: dist
2024-04-24 15:06:44,003 - INFO - init_weight_inf_or_zero: inf
2024-04-24 15:06:44,003 - INFO - Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-24 15:06:44,003 - INFO - Start Calculate the weight by Gauss kernel!
2024-04-24 15:06:44,003 - INFO - Loading file CHITaxi20190406.dyna
2024-04-24 15:06:44,128 - INFO - Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-24 15:06:47,101 - INFO - Dataset created
2024-04-24 15:06:47,101 - INFO - x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-24 15:06:47,179 - INFO - train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-24 15:06:47,179 - INFO - eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-24 15:06:47,179 - INFO - test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-24 15:06:47,258 - INFO - StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-24 15:06:47,258 - INFO - NoneScaler
2024-04-24 15:06:48,422 - INFO - AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-24 15:06:48,422 - INFO - node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-24 15:06:48,422 - INFO - encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-24 15:06:48,438 - INFO - encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 15:06:48,438 - INFO - encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-24 15:06:48,438 - INFO - encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 15:06:48,438 - INFO - encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-24 15:06:48,438 - INFO - encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 15:06:48,438 - INFO - encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-24 15:06:48,438 - INFO - encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 15:06:48,438 - INFO - end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-24 15:06:48,438 - INFO - end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-24 15:06:48,438 - INFO - Total parameter numbers: 874010
2024-04-24 15:06:48,438 - INFO - You select `adam` optimizer.
2024-04-24 15:06:48,438 - WARNING - Received none train loss func and will use the loss func defined in the model.
2024-04-24 15:06:48,438 - INFO - Start training ...
2024-04-24 15:06:48,438 - INFO - num_batches:48
2024-04-24 15:06:53,623 - INFO - epoch complete!
2024-04-24 15:06:53,623 - INFO - evaluating now!
2024-04-24 15:06:53,920 - INFO - Epoch [0/200] train_loss: 23.9916, val_loss: 18.6401, lr: 0.003000, 5.48s
2024-04-24 15:06:53,935 - INFO - Saved model at 0
2024-04-24 15:06:53,935 - INFO - Val loss decrease from inf to 18.6401, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-24 15:06:58,797 - INFO - epoch complete!
2024-04-24 15:06:58,798 - INFO - evaluating now!
2024-04-24 15:06:59,118 - INFO - Epoch [1/200] train_loss: 15.2330, val_loss: 14.7861, lr: 0.003000, 5.18s
2024-04-24 15:06:59,132 - INFO - Saved model at 1
2024-04-24 15:06:59,133 - INFO - Val loss decrease from 18.6401 to 14.7861, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-24 15:07:04,282 - INFO - epoch complete!
2024-04-24 15:07:04,282 - INFO - evaluating now!
2024-04-24 15:07:04,633 - INFO - Epoch [2/200] train_loss: 12.8129, val_loss: 12.8116, lr: 0.003000, 5.50s
2024-04-24 15:07:04,654 - INFO - Saved model at 2
2024-04-24 15:07:04,654 - INFO - Val loss decrease from 14.7861 to 12.8116, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-24 15:07:09,726 - INFO - epoch complete!
2024-04-24 15:07:09,726 - INFO - evaluating now!
2024-04-24 15:07:10,049 - INFO - Epoch [3/200] train_loss: 11.0159, val_loss: 10.2918, lr: 0.003000, 5.40s
2024-04-24 15:07:10,081 - INFO - Saved model at 3
2024-04-24 15:07:10,081 - INFO - Val loss decrease from 12.8116 to 10.2918, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-24 15:07:15,093 - INFO - epoch complete!
2024-04-24 15:07:15,093 - INFO - evaluating now!
2024-04-24 15:07:15,448 - INFO - Epoch [4/200] train_loss: 9.0754, val_loss: 8.7024, lr: 0.003000, 5.37s
2024-04-24 15:07:15,465 - INFO - Saved model at 4
2024-04-24 15:07:15,465 - INFO - Val loss decrease from 10.2918 to 8.7024, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-24 15:07:20,410 - INFO - epoch complete!
2024-04-24 15:07:20,411 - INFO - evaluating now!
2024-04-24 15:07:20,738 - INFO - Epoch [5/200] train_loss: 8.1294, val_loss: 7.7864, lr: 0.003000, 5.27s
2024-04-24 15:07:20,752 - INFO - Saved model at 5
2024-04-24 15:07:20,752 - INFO - Val loss decrease from 8.7024 to 7.7864, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-24 15:07:25,633 - INFO - epoch complete!
2024-04-24 15:07:25,634 - INFO - evaluating now!
2024-04-24 15:07:25,949 - INFO - Epoch [6/200] train_loss: 7.4992, val_loss: 7.3037, lr: 0.003000, 5.20s
2024-04-24 15:07:25,962 - INFO - Saved model at 6
2024-04-24 15:07:25,963 - INFO - Val loss decrease from 7.7864 to 7.3037, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-24 15:07:30,901 - INFO - epoch complete!
2024-04-24 15:07:30,901 - INFO - evaluating now!
2024-04-24 15:07:31,216 - INFO - Epoch [7/200] train_loss: 6.8997, val_loss: 6.8926, lr: 0.003000, 5.25s
2024-04-24 15:07:31,229 - INFO - Saved model at 7
2024-04-24 15:07:31,230 - INFO - Val loss decrease from 7.3037 to 6.8926, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-24 15:07:36,221 - INFO - epoch complete!
2024-04-24 15:07:36,221 - INFO - evaluating now!
2024-04-24 15:07:36,542 - INFO - Epoch [8/200] train_loss: 6.5972, val_loss: 6.8655, lr: 0.003000, 5.31s
2024-04-24 15:07:36,558 - INFO - Saved model at 8
2024-04-24 15:07:36,558 - INFO - Val loss decrease from 6.8926 to 6.8655, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-24 15:07:41,585 - INFO - epoch complete!
2024-04-24 15:07:41,585 - INFO - evaluating now!
2024-04-24 15:07:41,985 - INFO - Epoch [9/200] train_loss: 6.4775, val_loss: 6.5447, lr: 0.003000, 5.43s
2024-04-24 15:07:41,998 - INFO - Saved model at 9
2024-04-24 15:07:41,999 - INFO - Val loss decrease from 6.8655 to 6.5447, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-24 15:07:46,876 - INFO - epoch complete!
2024-04-24 15:07:46,876 - INFO - evaluating now!
2024-04-24 15:07:47,194 - INFO - Epoch [10/200] train_loss: 6.1281, val_loss: 6.2869, lr: 0.003000, 5.19s
2024-04-24 15:07:47,209 - INFO - Saved model at 10
2024-04-24 15:07:47,209 - INFO - Val loss decrease from 6.5447 to 6.2869, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-24 15:07:52,089 - INFO - epoch complete!
2024-04-24 15:07:52,089 - INFO - evaluating now!
2024-04-24 15:07:52,407 - INFO - Epoch [11/200] train_loss: 5.9613, val_loss: 6.0733, lr: 0.003000, 5.20s
2024-04-24 15:07:52,422 - INFO - Saved model at 11
2024-04-24 15:07:52,423 - INFO - Val loss decrease from 6.2869 to 6.0733, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-24 15:07:57,287 - INFO - epoch complete!
2024-04-24 15:07:57,288 - INFO - evaluating now!
2024-04-24 15:07:57,607 - INFO - Epoch [12/200] train_loss: 5.7137, val_loss: 5.7632, lr: 0.003000, 5.18s
2024-04-24 15:07:57,621 - INFO - Saved model at 12
2024-04-24 15:07:57,621 - INFO - Val loss decrease from 6.0733 to 5.7632, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-24 15:08:02,595 - INFO - epoch complete!
2024-04-24 15:08:02,596 - INFO - evaluating now!
2024-04-24 15:08:02,911 - INFO - Epoch [13/200] train_loss: 5.6189, val_loss: 5.7690, lr: 0.003000, 5.29s
2024-04-24 15:08:07,797 - INFO - epoch complete!
2024-04-24 15:08:07,798 - INFO - evaluating now!
2024-04-24 15:08:08,114 - INFO - Epoch [14/200] train_loss: 5.5629, val_loss: 5.6928, lr: 0.003000, 5.20s
2024-04-24 15:08:08,127 - INFO - Saved model at 14
2024-04-24 15:08:08,128 - INFO - Val loss decrease from 5.7632 to 5.6928, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-24 15:08:12,996 - INFO - epoch complete!
2024-04-24 15:08:12,997 - INFO - evaluating now!
2024-04-24 15:08:13,312 - INFO - Epoch [15/200] train_loss: 5.3210, val_loss: 5.6099, lr: 0.003000, 5.18s
2024-04-24 15:08:13,326 - INFO - Saved model at 15
2024-04-24 15:08:13,326 - INFO - Val loss decrease from 5.6928 to 5.6099, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-24 15:08:18,248 - INFO - epoch complete!
2024-04-24 15:08:18,249 - INFO - evaluating now!
2024-04-24 15:08:18,585 - INFO - Epoch [16/200] train_loss: 5.3344, val_loss: 5.7047, lr: 0.003000, 5.26s
2024-04-24 15:08:23,615 - INFO - epoch complete!
2024-04-24 15:08:23,615 - INFO - evaluating now!
2024-04-24 15:08:23,942 - INFO - Epoch [17/200] train_loss: 5.1637, val_loss: 5.5809, lr: 0.003000, 5.36s
2024-04-24 15:08:23,957 - INFO - Saved model at 17
2024-04-24 15:08:23,957 - INFO - Val loss decrease from 5.6099 to 5.5809, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-24 15:08:28,922 - INFO - epoch complete!
2024-04-24 15:08:28,922 - INFO - evaluating now!
2024-04-24 15:08:29,234 - INFO - Epoch [18/200] train_loss: 5.1681, val_loss: 5.7272, lr: 0.003000, 5.28s
2024-04-24 15:08:34,219 - INFO - epoch complete!
2024-04-24 15:08:34,219 - INFO - evaluating now!
2024-04-24 15:08:34,541 - INFO - Epoch [19/200] train_loss: 5.0671, val_loss: 5.4144, lr: 0.003000, 5.31s
2024-04-24 15:08:34,556 - INFO - Saved model at 19
2024-04-24 15:08:34,556 - INFO - Val loss decrease from 5.5809 to 5.4144, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-24 15:08:39,494 - INFO - epoch complete!
2024-04-24 15:08:39,494 - INFO - evaluating now!
2024-04-24 15:08:39,810 - INFO - Epoch [20/200] train_loss: 4.9972, val_loss: 5.6683, lr: 0.003000, 5.25s
2024-04-24 15:08:44,856 - INFO - epoch complete!
2024-04-24 15:08:44,857 - INFO - evaluating now!
2024-04-24 15:08:45,212 - INFO - Epoch [21/200] train_loss: 5.0417, val_loss: 5.5013, lr: 0.003000, 5.40s
2024-04-24 15:08:50,533 - INFO - epoch complete!
2024-04-24 15:08:50,533 - INFO - evaluating now!
2024-04-24 15:08:51,173 - INFO - Epoch [22/200] train_loss: 4.8142, val_loss: 5.3534, lr: 0.003000, 5.96s
2024-04-24 15:08:51,197 - INFO - Saved model at 22
2024-04-24 15:08:51,198 - INFO - Val loss decrease from 5.4144 to 5.3534, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-24 15:08:58,010 - INFO - epoch complete!
2024-04-24 15:08:58,010 - INFO - evaluating now!
2024-04-24 15:08:58,408 - INFO - Epoch [23/200] train_loss: 4.7793, val_loss: 5.4144, lr: 0.003000, 7.21s
2024-04-24 15:09:03,867 - INFO - epoch complete!
2024-04-24 15:09:03,867 - INFO - evaluating now!
2024-04-24 15:09:04,243 - INFO - Epoch [24/200] train_loss: 4.7733, val_loss: 5.2809, lr: 0.003000, 5.83s
2024-04-24 15:09:04,259 - INFO - Saved model at 24
2024-04-24 15:09:04,259 - INFO - Val loss decrease from 5.3534 to 5.2809, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-04-24 15:09:09,359 - INFO - epoch complete!
2024-04-24 15:09:09,359 - INFO - evaluating now!
2024-04-24 15:09:09,748 - INFO - Epoch [25/200] train_loss: 4.7485, val_loss: 5.1982, lr: 0.003000, 5.49s
2024-04-24 15:09:09,764 - INFO - Saved model at 25
2024-04-24 15:09:09,764 - INFO - Val loss decrease from 5.2809 to 5.1982, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-24 15:09:14,896 - INFO - epoch complete!
2024-04-24 15:09:14,896 - INFO - evaluating now!
2024-04-24 15:09:15,215 - INFO - Epoch [26/200] train_loss: 4.6770, val_loss: 5.2249, lr: 0.003000, 5.45s
2024-04-24 15:09:20,344 - INFO - epoch complete!
2024-04-24 15:09:20,345 - INFO - evaluating now!
2024-04-24 15:09:20,683 - INFO - Epoch [27/200] train_loss: 4.5796, val_loss: 5.1248, lr: 0.003000, 5.47s
2024-04-24 15:09:20,698 - INFO - Saved model at 27
2024-04-24 15:09:20,698 - INFO - Val loss decrease from 5.1982 to 5.1248, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-24 15:09:25,778 - INFO - epoch complete!
2024-04-24 15:09:25,779 - INFO - evaluating now!
2024-04-24 15:09:26,097 - INFO - Epoch [28/200] train_loss: 4.5164, val_loss: 5.3059, lr: 0.003000, 5.40s
2024-04-24 15:09:31,253 - INFO - epoch complete!
2024-04-24 15:09:31,253 - INFO - evaluating now!
2024-04-24 15:09:31,596 - INFO - Epoch [29/200] train_loss: 4.4967, val_loss: 5.1943, lr: 0.003000, 5.50s
2024-04-24 15:09:36,729 - INFO - epoch complete!
2024-04-24 15:09:36,729 - INFO - evaluating now!
2024-04-24 15:09:37,069 - INFO - Epoch [30/200] train_loss: 4.4930, val_loss: 5.2646, lr: 0.003000, 5.47s
2024-04-24 15:09:42,211 - INFO - epoch complete!
2024-04-24 15:09:42,211 - INFO - evaluating now!
2024-04-24 15:09:42,552 - INFO - Epoch [31/200] train_loss: 4.4049, val_loss: 5.1277, lr: 0.003000, 5.48s
2024-04-24 15:09:47,825 - INFO - epoch complete!
2024-04-24 15:09:47,825 - INFO - evaluating now!
2024-04-24 15:09:48,173 - INFO - Epoch [32/200] train_loss: 4.3707, val_loss: 5.3161, lr: 0.003000, 5.62s
2024-04-24 15:09:53,450 - INFO - epoch complete!
2024-04-24 15:09:53,450 - INFO - evaluating now!
2024-04-24 15:09:53,766 - INFO - Epoch [33/200] train_loss: 4.3519, val_loss: 5.1401, lr: 0.003000, 5.59s
2024-04-24 15:09:58,736 - INFO - epoch complete!
2024-04-24 15:09:58,737 - INFO - evaluating now!
2024-04-24 15:09:59,062 - INFO - Epoch [34/200] train_loss: 4.3693, val_loss: 5.1846, lr: 0.003000, 5.30s
2024-04-24 15:10:04,440 - INFO - epoch complete!
2024-04-24 15:10:04,440 - INFO - evaluating now!
2024-04-24 15:10:04,799 - INFO - Epoch [35/200] train_loss: 4.3449, val_loss: 5.1789, lr: 0.003000, 5.74s
2024-04-24 15:10:10,379 - INFO - epoch complete!
2024-04-24 15:10:10,380 - INFO - evaluating now!
2024-04-24 15:10:10,719 - INFO - Epoch [36/200] train_loss: 4.3285, val_loss: 5.0813, lr: 0.003000, 5.92s
2024-04-24 15:10:10,735 - INFO - Saved model at 36
2024-04-24 15:10:10,735 - INFO - Val loss decrease from 5.1248 to 5.0813, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-04-24 15:10:15,917 - INFO - epoch complete!
2024-04-24 15:10:15,917 - INFO - evaluating now!
2024-04-24 15:10:16,272 - INFO - Epoch [37/200] train_loss: 4.2067, val_loss: 5.2459, lr: 0.003000, 5.54s
2024-04-24 15:10:21,788 - INFO - epoch complete!
2024-04-24 15:10:21,789 - INFO - evaluating now!
2024-04-24 15:10:22,158 - INFO - Epoch [38/200] train_loss: 4.2192, val_loss: 5.1547, lr: 0.003000, 5.89s
2024-04-24 15:10:27,547 - INFO - epoch complete!
2024-04-24 15:10:27,547 - INFO - evaluating now!
2024-04-24 15:10:27,887 - INFO - Epoch [39/200] train_loss: 4.1870, val_loss: 5.1068, lr: 0.003000, 5.73s
2024-04-24 15:10:33,695 - INFO - epoch complete!
2024-04-24 15:10:33,695 - INFO - evaluating now!
2024-04-24 15:10:34,284 - INFO - Epoch [40/200] train_loss: 4.1040, val_loss: 5.0565, lr: 0.003000, 6.40s
2024-04-24 15:10:34,301 - INFO - Saved model at 40
2024-04-24 15:10:34,302 - INFO - Val loss decrease from 5.0813 to 5.0565, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-04-24 15:10:40,113 - INFO - epoch complete!
2024-04-24 15:10:40,113 - INFO - evaluating now!
2024-04-24 15:10:40,556 - INFO - Epoch [41/200] train_loss: 4.0416, val_loss: 5.1554, lr: 0.003000, 6.25s
2024-04-24 15:10:46,049 - INFO - epoch complete!
2024-04-24 15:10:46,050 - INFO - evaluating now!
2024-04-24 15:10:46,426 - INFO - Epoch [42/200] train_loss: 4.0635, val_loss: 5.0680, lr: 0.003000, 5.87s
2024-04-24 15:10:51,816 - INFO - epoch complete!
2024-04-24 15:10:51,817 - INFO - evaluating now!
2024-04-24 15:10:52,184 - INFO - Epoch [43/200] train_loss: 4.0102, val_loss: 5.1313, lr: 0.003000, 5.76s
2024-04-24 15:10:57,274 - INFO - epoch complete!
2024-04-24 15:10:57,274 - INFO - evaluating now!
2024-04-24 15:10:57,608 - INFO - Epoch [44/200] train_loss: 3.9932, val_loss: 5.2050, lr: 0.003000, 5.42s
2024-04-24 15:11:02,659 - INFO - epoch complete!
2024-04-24 15:11:02,659 - INFO - evaluating now!
2024-04-24 15:11:02,995 - INFO - Epoch [45/200] train_loss: 3.9849, val_loss: 5.1267, lr: 0.003000, 5.39s
2024-04-24 15:11:08,038 - INFO - epoch complete!
2024-04-24 15:11:08,038 - INFO - evaluating now!
2024-04-24 15:11:08,410 - INFO - Epoch [46/200] train_loss: 3.9446, val_loss: 4.9280, lr: 0.003000, 5.41s
2024-04-24 15:11:08,426 - INFO - Saved model at 46
2024-04-24 15:11:08,427 - INFO - Val loss decrease from 5.0565 to 4.9280, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-04-24 15:11:13,800 - INFO - epoch complete!
2024-04-24 15:11:13,800 - INFO - evaluating now!
2024-04-24 15:11:14,111 - INFO - Epoch [47/200] train_loss: 3.9545, val_loss: 4.9711, lr: 0.003000, 5.68s
2024-04-24 15:11:19,373 - INFO - epoch complete!
2024-04-24 15:11:19,373 - INFO - evaluating now!
2024-04-24 15:11:19,757 - INFO - Epoch [48/200] train_loss: 3.9237, val_loss: 5.1811, lr: 0.003000, 5.65s
2024-04-24 15:11:25,264 - INFO - epoch complete!
2024-04-24 15:11:25,264 - INFO - evaluating now!
2024-04-24 15:11:25,663 - INFO - Epoch [49/200] train_loss: 3.8882, val_loss: 5.1891, lr: 0.003000, 5.91s
2024-04-24 15:11:30,791 - INFO - epoch complete!
2024-04-24 15:11:30,791 - INFO - evaluating now!
2024-04-24 15:11:31,101 - INFO - Epoch [50/200] train_loss: 3.9081, val_loss: 5.1424, lr: 0.003000, 5.44s
2024-04-24 15:11:36,019 - INFO - epoch complete!
2024-04-24 15:11:36,019 - INFO - evaluating now!
2024-04-24 15:11:36,342 - INFO - Epoch [51/200] train_loss: 3.9216, val_loss: 5.1225, lr: 0.003000, 5.24s
2024-04-24 15:11:41,303 - INFO - epoch complete!
2024-04-24 15:11:41,303 - INFO - evaluating now!
2024-04-24 15:11:41,623 - INFO - Epoch [52/200] train_loss: 3.8330, val_loss: 4.9961, lr: 0.003000, 5.28s
2024-04-24 15:11:46,555 - INFO - epoch complete!
2024-04-24 15:11:46,556 - INFO - evaluating now!
2024-04-24 15:11:46,871 - INFO - Epoch [53/200] train_loss: 3.8433, val_loss: 5.0249, lr: 0.003000, 5.25s
2024-04-24 15:11:51,902 - INFO - epoch complete!
2024-04-24 15:11:51,902 - INFO - evaluating now!
2024-04-24 15:11:52,227 - INFO - Epoch [54/200] train_loss: 3.7836, val_loss: 5.0704, lr: 0.003000, 5.36s
2024-04-24 15:11:57,259 - INFO - epoch complete!
2024-04-24 15:11:57,259 - INFO - evaluating now!
2024-04-24 15:11:57,584 - INFO - Epoch [55/200] train_loss: 3.7747, val_loss: 5.2846, lr: 0.003000, 5.36s
2024-04-24 15:12:02,682 - INFO - epoch complete!
2024-04-24 15:12:02,682 - INFO - evaluating now!
2024-04-24 15:12:03,044 - INFO - Epoch [56/200] train_loss: 3.7138, val_loss: 5.1051, lr: 0.003000, 5.46s
2024-04-24 15:12:08,109 - INFO - epoch complete!
2024-04-24 15:12:08,110 - INFO - evaluating now!
2024-04-24 15:12:08,490 - INFO - Epoch [57/200] train_loss: 3.7224, val_loss: 5.0057, lr: 0.003000, 5.44s
2024-04-24 15:12:13,490 - INFO - epoch complete!
2024-04-24 15:12:13,490 - INFO - evaluating now!
2024-04-24 15:12:13,815 - INFO - Epoch [58/200] train_loss: 3.7393, val_loss: 5.1495, lr: 0.003000, 5.33s
2024-04-24 15:12:18,765 - INFO - epoch complete!
2024-04-24 15:12:18,765 - INFO - evaluating now!
2024-04-24 15:12:19,085 - INFO - Epoch [59/200] train_loss: 3.6851, val_loss: 5.1639, lr: 0.003000, 5.27s
2024-04-24 15:12:24,219 - INFO - epoch complete!
2024-04-24 15:12:24,219 - INFO - evaluating now!
2024-04-24 15:12:24,576 - INFO - Epoch [60/200] train_loss: 3.7007, val_loss: 5.1242, lr: 0.003000, 5.49s
2024-04-24 15:12:29,575 - INFO - epoch complete!
2024-04-24 15:12:29,576 - INFO - evaluating now!
2024-04-24 15:12:29,904 - INFO - Epoch [61/200] train_loss: 3.7026, val_loss: 5.0299, lr: 0.003000, 5.33s
2024-04-24 15:12:29,904 - WARNING - Early stopping at epoch: 61
2024-04-24 15:12:29,904 - INFO - Trained totally 62 epochs, average train time is 5.151s, average eval time is 0.349s
2024-04-24 15:12:29,913 - INFO - Loaded model at 46
2024-04-24 15:12:29,914 - INFO - Saved model at ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406.m
2024-04-24 15:12:29,929 - INFO - Start evaluating ...
2024-04-24 15:12:30,996 - INFO - Note that you select the single mode to evaluate!
2024-04-24 15:12:30,999 - INFO - Evaluate result is saved at ./libcity/cache/8/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-24 15:12:31,002 - INFO - 
         MAE       RMSE
1   2.362098   7.181606
2   2.418838   7.813941
3   2.632657   8.727929
4   2.745310   9.390656
5   2.882153   9.940593
6   3.057303  10.574887
7   3.095530  11.116147
8   3.201628  11.577088
9   3.244949  11.831866
10  3.307585  12.088893
11  3.214162  12.357812
12  3.389692  13.073077
2024-04-24 15:12:31,049 - INFO - ----------------------------------------------------------------------------
2024-04-24 15:12:31,049 - INFO - # 4, Kownledge Graph Embedding: TransE, Experiment ids: 9
2024-04-24 15:12:31,049 - INFO - ----------------------------------------------------------------------------
2024-04-24 15:12:31,051 - INFO - Log directory: ./libcity/log
2024-04-24 15:12:31,051 - INFO - Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=9
2024-04-24 15:12:31,051 - INFO - {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'embedding_model': 'TransE', 'seed': 429296137, 'exp_id': 9, 'max_epoch': 200, 'patience': 15, 'output_window': 12, 'load_external': True, 'metrics': ['MAE', 'RMSE'], 'cache_dataset': False, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-24 15:12:31,053 - INFO - Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-24 15:12:31,059 - INFO - set_weight_link_or_dist: dist
2024-04-24 15:12:31,059 - INFO - init_weight_inf_or_zero: inf
2024-04-24 15:12:31,071 - INFO - Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-24 15:12:31,071 - INFO - Start Calculate the weight by Gauss kernel!
2024-04-24 15:12:31,072 - INFO - Loading file CHITaxi20190406.dyna
2024-04-24 15:12:31,197 - INFO - Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-24 15:12:34,287 - INFO - Dataset created
2024-04-24 15:12:34,287 - INFO - x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-24 15:12:34,359 - INFO - train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-24 15:12:34,359 - INFO - eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-24 15:12:34,359 - INFO - test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-24 15:12:34,446 - INFO - StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-24 15:12:34,446 - INFO - NoneScaler
2024-04-24 15:12:35,645 - INFO - AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-24 15:12:35,646 - INFO - node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-24 15:12:35,646 - INFO - encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-24 15:12:35,646 - INFO - encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 15:12:35,646 - INFO - encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-24 15:12:35,646 - INFO - encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 15:12:35,646 - INFO - encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-24 15:12:35,647 - INFO - encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 15:12:35,647 - INFO - encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-24 15:12:35,647 - INFO - encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 15:12:35,647 - INFO - end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-24 15:12:35,647 - INFO - end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-24 15:12:35,648 - INFO - Total parameter numbers: 874010
2024-04-24 15:12:35,648 - INFO - You select `adam` optimizer.
2024-04-24 15:12:35,648 - WARNING - Received none train loss func and will use the loss func defined in the model.
2024-04-24 15:12:35,648 - INFO - Start training ...
2024-04-24 15:12:35,648 - INFO - num_batches:48
2024-04-24 15:12:40,721 - INFO - epoch complete!
2024-04-24 15:12:40,721 - INFO - evaluating now!
2024-04-24 15:12:41,037 - INFO - Epoch [0/200] train_loss: 24.2208, val_loss: 18.6136, lr: 0.003000, 5.39s
2024-04-24 15:12:41,051 - INFO - Saved model at 0
2024-04-24 15:12:41,051 - INFO - Val loss decrease from inf to 18.6136, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-24 15:12:45,949 - INFO - epoch complete!
2024-04-24 15:12:45,950 - INFO - evaluating now!
2024-04-24 15:12:46,266 - INFO - Epoch [1/200] train_loss: 15.6336, val_loss: 15.3062, lr: 0.003000, 5.22s
2024-04-24 15:12:46,280 - INFO - Saved model at 1
2024-04-24 15:12:46,280 - INFO - Val loss decrease from 18.6136 to 15.3062, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-24 15:12:51,357 - INFO - epoch complete!
2024-04-24 15:12:51,357 - INFO - evaluating now!
2024-04-24 15:12:51,726 - INFO - Epoch [2/200] train_loss: 12.5758, val_loss: 12.1413, lr: 0.003000, 5.45s
2024-04-24 15:12:51,747 - INFO - Saved model at 2
2024-04-24 15:12:51,747 - INFO - Val loss decrease from 15.3062 to 12.1413, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-24 15:12:56,661 - INFO - epoch complete!
2024-04-24 15:12:56,661 - INFO - evaluating now!
2024-04-24 15:12:56,974 - INFO - Epoch [3/200] train_loss: 10.2669, val_loss: 9.6533, lr: 0.003000, 5.23s
2024-04-24 15:12:57,009 - INFO - Saved model at 3
2024-04-24 15:12:57,009 - INFO - Val loss decrease from 12.1413 to 9.6533, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-24 15:13:01,943 - INFO - epoch complete!
2024-04-24 15:13:01,943 - INFO - evaluating now!
2024-04-24 15:13:02,259 - INFO - Epoch [4/200] train_loss: 8.9126, val_loss: 8.6231, lr: 0.003000, 5.25s
2024-04-24 15:13:02,273 - INFO - Saved model at 4
2024-04-24 15:13:02,273 - INFO - Val loss decrease from 9.6533 to 8.6231, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-24 15:13:07,178 - INFO - epoch complete!
2024-04-24 15:13:07,179 - INFO - evaluating now!
2024-04-24 15:13:07,493 - INFO - Epoch [5/200] train_loss: 7.9097, val_loss: 7.6509, lr: 0.003000, 5.22s
2024-04-24 15:13:07,508 - INFO - Saved model at 5
2024-04-24 15:13:07,508 - INFO - Val loss decrease from 8.6231 to 7.6509, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-24 15:13:12,478 - INFO - epoch complete!
2024-04-24 15:13:12,478 - INFO - evaluating now!
2024-04-24 15:13:12,821 - INFO - Epoch [6/200] train_loss: 7.0862, val_loss: 7.0865, lr: 0.003000, 5.31s
2024-04-24 15:13:12,835 - INFO - Saved model at 6
2024-04-24 15:13:12,835 - INFO - Val loss decrease from 7.6509 to 7.0865, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-24 15:13:17,715 - INFO - epoch complete!
2024-04-24 15:13:17,716 - INFO - evaluating now!
2024-04-24 15:13:18,028 - INFO - Epoch [7/200] train_loss: 6.8601, val_loss: 6.7411, lr: 0.003000, 5.19s
2024-04-24 15:13:18,042 - INFO - Saved model at 7
2024-04-24 15:13:18,043 - INFO - Val loss decrease from 7.0865 to 6.7411, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-24 15:13:23,046 - INFO - epoch complete!
2024-04-24 15:13:23,046 - INFO - evaluating now!
2024-04-24 15:13:23,385 - INFO - Epoch [8/200] train_loss: 6.3036, val_loss: 6.4191, lr: 0.003000, 5.34s
2024-04-24 15:13:23,399 - INFO - Saved model at 8
2024-04-24 15:13:23,400 - INFO - Val loss decrease from 6.7411 to 6.4191, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-24 15:13:28,557 - INFO - epoch complete!
2024-04-24 15:13:28,557 - INFO - evaluating now!
2024-04-24 15:13:28,884 - INFO - Epoch [9/200] train_loss: 6.2100, val_loss: 6.7101, lr: 0.003000, 5.48s
2024-04-24 15:13:33,849 - INFO - epoch complete!
2024-04-24 15:13:33,850 - INFO - evaluating now!
2024-04-24 15:13:34,164 - INFO - Epoch [10/200] train_loss: 6.1023, val_loss: 6.2298, lr: 0.003000, 5.28s
2024-04-24 15:13:34,178 - INFO - Saved model at 10
2024-04-24 15:13:34,178 - INFO - Val loss decrease from 6.4191 to 6.2298, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-24 15:13:39,079 - INFO - epoch complete!
2024-04-24 15:13:39,080 - INFO - evaluating now!
2024-04-24 15:13:39,425 - INFO - Epoch [11/200] train_loss: 5.8832, val_loss: 6.0699, lr: 0.003000, 5.25s
2024-04-24 15:13:39,439 - INFO - Saved model at 11
2024-04-24 15:13:39,440 - INFO - Val loss decrease from 6.2298 to 6.0699, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-24 15:13:44,319 - INFO - epoch complete!
2024-04-24 15:13:44,319 - INFO - evaluating now!
2024-04-24 15:13:44,629 - INFO - Epoch [12/200] train_loss: 5.7550, val_loss: 6.2323, lr: 0.003000, 5.19s
2024-04-24 15:13:49,527 - INFO - epoch complete!
2024-04-24 15:13:49,528 - INFO - evaluating now!
2024-04-24 15:13:49,849 - INFO - Epoch [13/200] train_loss: 5.5412, val_loss: 5.8682, lr: 0.003000, 5.22s
2024-04-24 15:13:49,862 - INFO - Saved model at 13
2024-04-24 15:13:49,863 - INFO - Val loss decrease from 6.0699 to 5.8682, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-24 15:13:54,744 - INFO - epoch complete!
2024-04-24 15:13:54,744 - INFO - evaluating now!
2024-04-24 15:13:55,059 - INFO - Epoch [14/200] train_loss: 5.3977, val_loss: 5.8144, lr: 0.003000, 5.20s
2024-04-24 15:13:55,073 - INFO - Saved model at 14
2024-04-24 15:13:55,074 - INFO - Val loss decrease from 5.8682 to 5.8144, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-24 15:13:59,989 - INFO - epoch complete!
2024-04-24 15:13:59,990 - INFO - evaluating now!
2024-04-24 15:14:00,289 - INFO - Epoch [15/200] train_loss: 5.2806, val_loss: 5.6447, lr: 0.003000, 5.21s
2024-04-24 15:14:00,303 - INFO - Saved model at 15
2024-04-24 15:14:00,303 - INFO - Val loss decrease from 5.8144 to 5.6447, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-24 15:14:05,211 - INFO - epoch complete!
2024-04-24 15:14:05,212 - INFO - evaluating now!
2024-04-24 15:14:05,529 - INFO - Epoch [16/200] train_loss: 5.1864, val_loss: 5.7898, lr: 0.003000, 5.23s
2024-04-24 15:14:10,437 - INFO - epoch complete!
2024-04-24 15:14:10,438 - INFO - evaluating now!
2024-04-24 15:14:10,754 - INFO - Epoch [17/200] train_loss: 5.1323, val_loss: 5.5435, lr: 0.003000, 5.22s
2024-04-24 15:14:10,768 - INFO - Saved model at 17
2024-04-24 15:14:10,768 - INFO - Val loss decrease from 5.6447 to 5.5435, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-24 15:14:15,732 - INFO - epoch complete!
2024-04-24 15:14:15,733 - INFO - evaluating now!
2024-04-24 15:14:16,055 - INFO - Epoch [18/200] train_loss: 5.0952, val_loss: 5.7013, lr: 0.003000, 5.29s
2024-04-24 15:14:21,053 - INFO - epoch complete!
2024-04-24 15:14:21,054 - INFO - evaluating now!
2024-04-24 15:14:21,370 - INFO - Epoch [19/200] train_loss: 5.0183, val_loss: 5.4143, lr: 0.003000, 5.31s
2024-04-24 15:14:21,390 - INFO - Saved model at 19
2024-04-24 15:14:21,390 - INFO - Val loss decrease from 5.5435 to 5.4143, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-24 15:14:26,287 - INFO - epoch complete!
2024-04-24 15:14:26,287 - INFO - evaluating now!
2024-04-24 15:14:26,605 - INFO - Epoch [20/200] train_loss: 5.0581, val_loss: 5.5099, lr: 0.003000, 5.21s
2024-04-24 15:14:31,603 - INFO - epoch complete!
2024-04-24 15:14:31,604 - INFO - evaluating now!
2024-04-24 15:14:31,933 - INFO - Epoch [21/200] train_loss: 4.9004, val_loss: 5.3757, lr: 0.003000, 5.33s
2024-04-24 15:14:31,949 - INFO - Saved model at 21
2024-04-24 15:14:31,949 - INFO - Val loss decrease from 5.4143 to 5.3757, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-24 15:14:37,659 - INFO - epoch complete!
2024-04-24 15:14:37,660 - INFO - evaluating now!
2024-04-24 15:14:38,146 - INFO - Epoch [22/200] train_loss: 4.7619, val_loss: 5.4691, lr: 0.003000, 6.20s
2024-04-24 15:14:43,895 - INFO - epoch complete!
2024-04-24 15:14:43,896 - INFO - evaluating now!
2024-04-24 15:14:44,220 - INFO - Epoch [23/200] train_loss: 4.7459, val_loss: 5.2097, lr: 0.003000, 6.07s
2024-04-24 15:14:44,235 - INFO - Saved model at 23
2024-04-24 15:14:44,235 - INFO - Val loss decrease from 5.3757 to 5.2097, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-24 15:14:49,215 - INFO - epoch complete!
2024-04-24 15:14:49,215 - INFO - evaluating now!
2024-04-24 15:14:49,543 - INFO - Epoch [24/200] train_loss: 4.6521, val_loss: 5.2684, lr: 0.003000, 5.31s
2024-04-24 15:14:54,515 - INFO - epoch complete!
2024-04-24 15:14:54,515 - INFO - evaluating now!
2024-04-24 15:14:54,867 - INFO - Epoch [25/200] train_loss: 4.7367, val_loss: 5.2419, lr: 0.003000, 5.32s
2024-04-24 15:14:59,921 - INFO - epoch complete!
2024-04-24 15:14:59,922 - INFO - evaluating now!
2024-04-24 15:15:00,240 - INFO - Epoch [26/200] train_loss: 4.6537, val_loss: 5.3476, lr: 0.003000, 5.37s
2024-04-24 15:15:05,177 - INFO - epoch complete!
2024-04-24 15:15:05,177 - INFO - evaluating now!
2024-04-24 15:15:05,491 - INFO - Epoch [27/200] train_loss: 4.5800, val_loss: 5.6782, lr: 0.003000, 5.25s
2024-04-24 15:15:10,448 - INFO - epoch complete!
2024-04-24 15:15:10,448 - INFO - evaluating now!
2024-04-24 15:15:10,780 - INFO - Epoch [28/200] train_loss: 4.6174, val_loss: 5.3260, lr: 0.003000, 5.29s
2024-04-24 15:15:15,746 - INFO - epoch complete!
2024-04-24 15:15:15,746 - INFO - evaluating now!
2024-04-24 15:15:16,074 - INFO - Epoch [29/200] train_loss: 4.5033, val_loss: 5.1874, lr: 0.003000, 5.29s
2024-04-24 15:15:16,104 - INFO - Saved model at 29
2024-04-24 15:15:16,105 - INFO - Val loss decrease from 5.2097 to 5.1874, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-04-24 15:15:21,124 - INFO - epoch complete!
2024-04-24 15:15:21,124 - INFO - evaluating now!
2024-04-24 15:15:21,449 - INFO - Epoch [30/200] train_loss: 4.4983, val_loss: 5.3161, lr: 0.003000, 5.34s
2024-04-24 15:15:26,393 - INFO - epoch complete!
2024-04-24 15:15:26,393 - INFO - evaluating now!
2024-04-24 15:15:26,714 - INFO - Epoch [31/200] train_loss: 4.4282, val_loss: 5.2086, lr: 0.003000, 5.26s
2024-04-24 15:15:31,711 - INFO - epoch complete!
2024-04-24 15:15:31,712 - INFO - evaluating now!
2024-04-24 15:15:32,029 - INFO - Epoch [32/200] train_loss: 4.3466, val_loss: 5.2374, lr: 0.003000, 5.31s
2024-04-24 15:15:37,124 - INFO - epoch complete!
2024-04-24 15:15:37,125 - INFO - evaluating now!
2024-04-24 15:15:37,440 - INFO - Epoch [33/200] train_loss: 4.3264, val_loss: 5.2696, lr: 0.003000, 5.41s
2024-04-24 15:15:42,403 - INFO - epoch complete!
2024-04-24 15:15:42,404 - INFO - evaluating now!
2024-04-24 15:15:42,726 - INFO - Epoch [34/200] train_loss: 4.3139, val_loss: 5.2957, lr: 0.003000, 5.28s
2024-04-24 15:15:47,659 - INFO - epoch complete!
2024-04-24 15:15:47,659 - INFO - evaluating now!
2024-04-24 15:15:47,980 - INFO - Epoch [35/200] train_loss: 4.2711, val_loss: 5.2533, lr: 0.003000, 5.25s
2024-04-24 15:15:52,954 - INFO - epoch complete!
2024-04-24 15:15:52,955 - INFO - evaluating now!
2024-04-24 15:15:53,276 - INFO - Epoch [36/200] train_loss: 4.2973, val_loss: 5.1978, lr: 0.003000, 5.29s
2024-04-24 15:15:58,249 - INFO - epoch complete!
2024-04-24 15:15:58,250 - INFO - evaluating now!
2024-04-24 15:15:58,591 - INFO - Epoch [37/200] train_loss: 4.3085, val_loss: 5.3578, lr: 0.003000, 5.32s
2024-04-24 15:16:03,643 - INFO - epoch complete!
2024-04-24 15:16:03,643 - INFO - evaluating now!
2024-04-24 15:16:03,968 - INFO - Epoch [38/200] train_loss: 4.2250, val_loss: 5.2476, lr: 0.003000, 5.38s
2024-04-24 15:16:08,907 - INFO - epoch complete!
2024-04-24 15:16:08,908 - INFO - evaluating now!
2024-04-24 15:16:09,230 - INFO - Epoch [39/200] train_loss: 4.1567, val_loss: 5.1443, lr: 0.003000, 5.26s
2024-04-24 15:16:09,243 - INFO - Saved model at 39
2024-04-24 15:16:09,244 - INFO - Val loss decrease from 5.1874 to 5.1443, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-04-24 15:16:14,188 - INFO - epoch complete!
2024-04-24 15:16:14,188 - INFO - evaluating now!
2024-04-24 15:16:14,523 - INFO - Epoch [40/200] train_loss: 4.1596, val_loss: 5.2311, lr: 0.003000, 5.28s
2024-04-24 15:16:19,650 - INFO - epoch complete!
2024-04-24 15:16:19,650 - INFO - evaluating now!
2024-04-24 15:16:19,976 - INFO - Epoch [41/200] train_loss: 4.2020, val_loss: 5.3831, lr: 0.003000, 5.45s
2024-04-24 15:16:24,989 - INFO - epoch complete!
2024-04-24 15:16:24,989 - INFO - evaluating now!
2024-04-24 15:16:25,313 - INFO - Epoch [42/200] train_loss: 4.1336, val_loss: 5.2583, lr: 0.003000, 5.34s
2024-04-24 15:16:30,288 - INFO - epoch complete!
2024-04-24 15:16:30,289 - INFO - evaluating now!
2024-04-24 15:16:30,606 - INFO - Epoch [43/200] train_loss: 4.0864, val_loss: 5.3430, lr: 0.003000, 5.29s
2024-04-24 15:16:35,561 - INFO - epoch complete!
2024-04-24 15:16:35,561 - INFO - evaluating now!
2024-04-24 15:16:35,880 - INFO - Epoch [44/200] train_loss: 4.0581, val_loss: 5.1059, lr: 0.003000, 5.27s
2024-04-24 15:16:35,909 - INFO - Saved model at 44
2024-04-24 15:16:35,909 - INFO - Val loss decrease from 5.1443 to 5.1059, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-04-24 15:16:40,887 - INFO - epoch complete!
2024-04-24 15:16:40,887 - INFO - evaluating now!
2024-04-24 15:16:41,206 - INFO - Epoch [45/200] train_loss: 3.9931, val_loss: 5.1307, lr: 0.003000, 5.30s
2024-04-24 15:16:46,172 - INFO - epoch complete!
2024-04-24 15:16:46,173 - INFO - evaluating now!
2024-04-24 15:16:46,503 - INFO - Epoch [46/200] train_loss: 3.9219, val_loss: 5.1306, lr: 0.003000, 5.30s
2024-04-24 15:16:51,462 - INFO - epoch complete!
2024-04-24 15:16:51,462 - INFO - evaluating now!
2024-04-24 15:16:51,779 - INFO - Epoch [47/200] train_loss: 3.9262, val_loss: 5.2722, lr: 0.003000, 5.28s
2024-04-24 15:16:56,728 - INFO - epoch complete!
2024-04-24 15:16:56,728 - INFO - evaluating now!
2024-04-24 15:16:57,037 - INFO - Epoch [48/200] train_loss: 4.0840, val_loss: 5.2037, lr: 0.003000, 5.26s
2024-04-24 15:17:02,079 - INFO - epoch complete!
2024-04-24 15:17:02,080 - INFO - evaluating now!
2024-04-24 15:17:02,446 - INFO - Epoch [49/200] train_loss: 3.9626, val_loss: 5.1984, lr: 0.003000, 5.41s
2024-04-24 15:17:07,409 - INFO - epoch complete!
2024-04-24 15:17:07,409 - INFO - evaluating now!
2024-04-24 15:17:07,719 - INFO - Epoch [50/200] train_loss: 3.8511, val_loss: 5.1756, lr: 0.003000, 5.27s
2024-04-24 15:17:12,737 - INFO - epoch complete!
2024-04-24 15:17:12,737 - INFO - evaluating now!
2024-04-24 15:17:13,056 - INFO - Epoch [51/200] train_loss: 3.8594, val_loss: 5.3219, lr: 0.003000, 5.34s
2024-04-24 15:17:18,095 - INFO - epoch complete!
2024-04-24 15:17:18,095 - INFO - evaluating now!
2024-04-24 15:17:18,423 - INFO - Epoch [52/200] train_loss: 3.9470, val_loss: 5.2403, lr: 0.003000, 5.37s
2024-04-24 15:17:23,579 - INFO - epoch complete!
2024-04-24 15:17:23,579 - INFO - evaluating now!
2024-04-24 15:17:23,898 - INFO - Epoch [53/200] train_loss: 3.8809, val_loss: 5.0604, lr: 0.003000, 5.47s
2024-04-24 15:17:23,913 - INFO - Saved model at 53
2024-04-24 15:17:23,913 - INFO - Val loss decrease from 5.1059 to 5.0604, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch53.tar
2024-04-24 15:17:29,016 - INFO - epoch complete!
2024-04-24 15:17:29,016 - INFO - evaluating now!
2024-04-24 15:17:29,351 - INFO - Epoch [54/200] train_loss: 3.8113, val_loss: 5.1351, lr: 0.003000, 5.44s
2024-04-24 15:17:34,348 - INFO - epoch complete!
2024-04-24 15:17:34,349 - INFO - evaluating now!
2024-04-24 15:17:34,674 - INFO - Epoch [55/200] train_loss: 3.7557, val_loss: 5.2657, lr: 0.003000, 5.32s
2024-04-24 15:17:39,579 - INFO - epoch complete!
2024-04-24 15:17:39,580 - INFO - evaluating now!
2024-04-24 15:17:39,890 - INFO - Epoch [56/200] train_loss: 3.7840, val_loss: 5.3760, lr: 0.003000, 5.22s
2024-04-24 15:17:44,758 - INFO - epoch complete!
2024-04-24 15:17:44,758 - INFO - evaluating now!
2024-04-24 15:17:45,076 - INFO - Epoch [57/200] train_loss: 3.8144, val_loss: 5.1531, lr: 0.003000, 5.18s
2024-04-24 15:17:49,931 - INFO - epoch complete!
2024-04-24 15:17:49,931 - INFO - evaluating now!
2024-04-24 15:17:50,239 - INFO - Epoch [58/200] train_loss: 3.7694, val_loss: 5.1472, lr: 0.003000, 5.16s
2024-04-24 15:17:55,072 - INFO - epoch complete!
2024-04-24 15:17:55,072 - INFO - evaluating now!
2024-04-24 15:17:55,380 - INFO - Epoch [59/200] train_loss: 3.7203, val_loss: 5.1699, lr: 0.003000, 5.14s
2024-04-24 15:18:00,208 - INFO - epoch complete!
2024-04-24 15:18:00,208 - INFO - evaluating now!
2024-04-24 15:18:00,520 - INFO - Epoch [60/200] train_loss: 3.6841, val_loss: 5.0551, lr: 0.003000, 5.14s
2024-04-24 15:18:00,534 - INFO - Saved model at 60
2024-04-24 15:18:00,534 - INFO - Val loss decrease from 5.0604 to 5.0551, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch60.tar
2024-04-24 15:18:05,361 - INFO - epoch complete!
2024-04-24 15:18:05,361 - INFO - evaluating now!
2024-04-24 15:18:05,674 - INFO - Epoch [61/200] train_loss: 3.7443, val_loss: 5.2486, lr: 0.003000, 5.14s
2024-04-24 15:18:10,523 - INFO - epoch complete!
2024-04-24 15:18:10,523 - INFO - evaluating now!
2024-04-24 15:18:10,836 - INFO - Epoch [62/200] train_loss: 3.8092, val_loss: 5.2369, lr: 0.003000, 5.16s
2024-04-24 15:18:15,718 - INFO - epoch complete!
2024-04-24 15:18:15,718 - INFO - evaluating now!
2024-04-24 15:18:16,034 - INFO - Epoch [63/200] train_loss: 3.7883, val_loss: 5.1306, lr: 0.003000, 5.20s
2024-04-24 15:18:20,941 - INFO - epoch complete!
2024-04-24 15:18:20,942 - INFO - evaluating now!
2024-04-24 15:18:21,254 - INFO - Epoch [64/200] train_loss: 3.6691, val_loss: 5.1327, lr: 0.003000, 5.22s
2024-04-24 15:18:26,130 - INFO - epoch complete!
2024-04-24 15:18:26,130 - INFO - evaluating now!
2024-04-24 15:18:26,439 - INFO - Epoch [65/200] train_loss: 3.6443, val_loss: 5.0441, lr: 0.003000, 5.18s
2024-04-24 15:18:26,453 - INFO - Saved model at 65
2024-04-24 15:18:26,453 - INFO - Val loss decrease from 5.0551 to 5.0441, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch65.tar
2024-04-24 15:18:31,288 - INFO - epoch complete!
2024-04-24 15:18:31,288 - INFO - evaluating now!
2024-04-24 15:18:31,607 - INFO - Epoch [66/200] train_loss: 3.6397, val_loss: 5.1353, lr: 0.003000, 5.15s
2024-04-24 15:18:36,566 - INFO - epoch complete!
2024-04-24 15:18:36,567 - INFO - evaluating now!
2024-04-24 15:18:36,907 - INFO - Epoch [67/200] train_loss: 3.6038, val_loss: 5.1440, lr: 0.003000, 5.30s
2024-04-24 15:18:41,802 - INFO - epoch complete!
2024-04-24 15:18:41,803 - INFO - evaluating now!
2024-04-24 15:18:42,124 - INFO - Epoch [68/200] train_loss: 3.6407, val_loss: 5.2578, lr: 0.003000, 5.22s
2024-04-24 15:18:46,974 - INFO - epoch complete!
2024-04-24 15:18:46,974 - INFO - evaluating now!
2024-04-24 15:18:47,282 - INFO - Epoch [69/200] train_loss: 3.6710, val_loss: 5.1786, lr: 0.003000, 5.16s
2024-04-24 15:18:52,217 - INFO - epoch complete!
2024-04-24 15:18:52,218 - INFO - evaluating now!
2024-04-24 15:18:52,528 - INFO - Epoch [70/200] train_loss: 3.5760, val_loss: 5.1363, lr: 0.003000, 5.24s
2024-04-24 15:18:57,400 - INFO - epoch complete!
2024-04-24 15:18:57,400 - INFO - evaluating now!
2024-04-24 15:18:57,710 - INFO - Epoch [71/200] train_loss: 3.5813, val_loss: 5.1383, lr: 0.003000, 5.18s
2024-04-24 15:19:02,640 - INFO - epoch complete!
2024-04-24 15:19:02,640 - INFO - evaluating now!
2024-04-24 15:19:02,961 - INFO - Epoch [72/200] train_loss: 3.6642, val_loss: 5.1286, lr: 0.003000, 5.25s
2024-04-24 15:19:07,939 - INFO - epoch complete!
2024-04-24 15:19:07,940 - INFO - evaluating now!
2024-04-24 15:19:08,269 - INFO - Epoch [73/200] train_loss: 3.6552, val_loss: 5.0787, lr: 0.003000, 5.31s
2024-04-24 15:19:13,152 - INFO - epoch complete!
2024-04-24 15:19:13,152 - INFO - evaluating now!
2024-04-24 15:19:13,466 - INFO - Epoch [74/200] train_loss: 3.5525, val_loss: 5.1705, lr: 0.003000, 5.20s
2024-04-24 15:19:18,474 - INFO - epoch complete!
2024-04-24 15:19:18,474 - INFO - evaluating now!
2024-04-24 15:19:18,814 - INFO - Epoch [75/200] train_loss: 3.5097, val_loss: 5.0514, lr: 0.003000, 5.35s
2024-04-24 15:19:23,728 - INFO - epoch complete!
2024-04-24 15:19:23,728 - INFO - evaluating now!
2024-04-24 15:19:24,037 - INFO - Epoch [76/200] train_loss: 3.5186, val_loss: 5.2216, lr: 0.003000, 5.22s
2024-04-24 15:19:28,910 - INFO - epoch complete!
2024-04-24 15:19:28,910 - INFO - evaluating now!
2024-04-24 15:19:29,220 - INFO - Epoch [77/200] train_loss: 3.5643, val_loss: 5.1476, lr: 0.003000, 5.18s
2024-04-24 15:19:34,113 - INFO - epoch complete!
2024-04-24 15:19:34,113 - INFO - evaluating now!
2024-04-24 15:19:34,430 - INFO - Epoch [78/200] train_loss: 3.5448, val_loss: 5.1664, lr: 0.003000, 5.21s
2024-04-24 15:19:39,405 - INFO - epoch complete!
2024-04-24 15:19:39,405 - INFO - evaluating now!
2024-04-24 15:19:39,728 - INFO - Epoch [79/200] train_loss: 3.5688, val_loss: 5.0365, lr: 0.003000, 5.30s
2024-04-24 15:19:39,745 - INFO - Saved model at 79
2024-04-24 15:19:39,745 - INFO - Val loss decrease from 5.0441 to 5.0365, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch79.tar
2024-04-24 15:19:44,748 - INFO - epoch complete!
2024-04-24 15:19:44,749 - INFO - evaluating now!
2024-04-24 15:19:45,074 - INFO - Epoch [80/200] train_loss: 3.4740, val_loss: 5.1408, lr: 0.003000, 5.33s
2024-04-24 15:19:49,952 - INFO - epoch complete!
2024-04-24 15:19:49,953 - INFO - evaluating now!
2024-04-24 15:19:50,281 - INFO - Epoch [81/200] train_loss: 3.4637, val_loss: 5.1806, lr: 0.003000, 5.21s
2024-04-24 15:19:55,195 - INFO - epoch complete!
2024-04-24 15:19:55,195 - INFO - evaluating now!
2024-04-24 15:19:55,502 - INFO - Epoch [82/200] train_loss: 3.4574, val_loss: 4.9969, lr: 0.003000, 5.22s
2024-04-24 15:19:55,516 - INFO - Saved model at 82
2024-04-24 15:19:55,516 - INFO - Val loss decrease from 5.0365 to 4.9969, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch82.tar
2024-04-24 15:20:00,344 - INFO - epoch complete!
2024-04-24 15:20:00,344 - INFO - evaluating now!
2024-04-24 15:20:00,675 - INFO - Epoch [83/200] train_loss: 3.4789, val_loss: 5.2393, lr: 0.003000, 5.16s
2024-04-24 15:20:05,553 - INFO - epoch complete!
2024-04-24 15:20:05,554 - INFO - evaluating now!
2024-04-24 15:20:05,866 - INFO - Epoch [84/200] train_loss: 3.4278, val_loss: 5.0822, lr: 0.003000, 5.19s
2024-04-24 15:20:10,706 - INFO - epoch complete!
2024-04-24 15:20:10,706 - INFO - evaluating now!
2024-04-24 15:20:11,014 - INFO - Epoch [85/200] train_loss: 3.4428, val_loss: 5.0884, lr: 0.003000, 5.15s
2024-04-24 15:20:15,849 - INFO - epoch complete!
2024-04-24 15:20:15,850 - INFO - evaluating now!
2024-04-24 15:20:16,159 - INFO - Epoch [86/200] train_loss: 3.4007, val_loss: 5.0492, lr: 0.003000, 5.15s
2024-04-24 15:20:20,992 - INFO - epoch complete!
2024-04-24 15:20:20,992 - INFO - evaluating now!
2024-04-24 15:20:21,297 - INFO - Epoch [87/200] train_loss: 3.3914, val_loss: 5.0992, lr: 0.003000, 5.14s
2024-04-24 15:20:26,253 - INFO - epoch complete!
2024-04-24 15:20:26,253 - INFO - evaluating now!
2024-04-24 15:20:26,565 - INFO - Epoch [88/200] train_loss: 3.3726, val_loss: 5.1564, lr: 0.003000, 5.27s
2024-04-24 15:20:31,678 - INFO - epoch complete!
2024-04-24 15:20:31,678 - INFO - evaluating now!
2024-04-24 15:20:31,999 - INFO - Epoch [89/200] train_loss: 3.3713, val_loss: 5.0917, lr: 0.003000, 5.43s
2024-04-24 15:20:36,937 - INFO - epoch complete!
2024-04-24 15:20:36,937 - INFO - evaluating now!
2024-04-24 15:20:37,259 - INFO - Epoch [90/200] train_loss: 3.3725, val_loss: 5.1347, lr: 0.003000, 5.26s
2024-04-24 15:20:42,130 - INFO - epoch complete!
2024-04-24 15:20:42,130 - INFO - evaluating now!
2024-04-24 15:20:42,439 - INFO - Epoch [91/200] train_loss: 3.3482, val_loss: 5.1579, lr: 0.003000, 5.18s
2024-04-24 15:20:47,327 - INFO - epoch complete!
2024-04-24 15:20:47,327 - INFO - evaluating now!
2024-04-24 15:20:47,652 - INFO - Epoch [92/200] train_loss: 3.3591, val_loss: 5.1480, lr: 0.003000, 5.21s
2024-04-24 15:20:52,556 - INFO - epoch complete!
2024-04-24 15:20:52,557 - INFO - evaluating now!
2024-04-24 15:20:52,870 - INFO - Epoch [93/200] train_loss: 3.3632, val_loss: 5.1276, lr: 0.003000, 5.22s
2024-04-24 15:20:57,813 - INFO - epoch complete!
2024-04-24 15:20:57,814 - INFO - evaluating now!
2024-04-24 15:20:58,122 - INFO - Epoch [94/200] train_loss: 3.3895, val_loss: 5.1719, lr: 0.003000, 5.25s
2024-04-24 15:21:02,914 - INFO - epoch complete!
2024-04-24 15:21:02,914 - INFO - evaluating now!
2024-04-24 15:21:03,230 - INFO - Epoch [95/200] train_loss: 3.3731, val_loss: 5.1803, lr: 0.003000, 5.11s
2024-04-24 15:21:08,030 - INFO - epoch complete!
2024-04-24 15:21:08,030 - INFO - evaluating now!
2024-04-24 15:21:08,342 - INFO - Epoch [96/200] train_loss: 3.4972, val_loss: 5.1414, lr: 0.003000, 5.11s
2024-04-24 15:21:13,162 - INFO - epoch complete!
2024-04-24 15:21:13,162 - INFO - evaluating now!
2024-04-24 15:21:13,485 - INFO - Epoch [97/200] train_loss: 3.4012, val_loss: 5.1399, lr: 0.003000, 5.14s
2024-04-24 15:21:13,485 - WARNING - Early stopping at epoch: 97
2024-04-24 15:21:13,485 - INFO - Trained totally 98 epochs, average train time is 4.956s, average eval time is 0.322s
2024-04-24 15:21:13,494 - INFO - Loaded model at 82
2024-04-24 15:21:13,494 - INFO - Saved model at ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406.m
2024-04-24 15:21:13,495 - INFO - Start evaluating ...
2024-04-24 15:21:14,525 - INFO - Note that you select the single mode to evaluate!
2024-04-24 15:21:14,541 - INFO - Evaluate result is saved at ./libcity/cache/9/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-24 15:21:14,541 - INFO - 
         MAE       RMSE
1   2.391185   6.859993
2   2.443256   7.653529
3   2.659058   8.718288
4   2.835227   9.617441
5   2.964370  10.708393
6   3.125168  12.001645
7   3.239353  13.093000
8   3.306148  13.800850
9   3.326673  13.923235
10  3.327157  13.802596
11  3.327606  13.713902
12  3.397913  13.863517
2024-04-24 15:21:14,588 - INFO - ----------------------------------------------------------------------------
2024-04-24 15:21:14,588 - INFO - Kownledge Graph Embedding: True, Experiment ids: [5, 6, 7, 8, 9]
2024-04-24 15:21:14,588 - INFO - ----------------------------------------------------------------------------
2024-04-24 15:21:14,588 - INFO - Average: 
         MAE       RMSE
0   2.379641   7.103011
1   2.468801   7.764760
2   2.654561   8.768877
3   2.802158   9.504019
4   2.922731  10.227367
5   3.031240  11.017959
6   3.114030  11.692876
7   3.206168  12.262926
8   3.248974  12.587805
9   3.308590  12.853420
10  3.347177  13.143820
11  3.468738  13.675714 
2024-04-24 15:21:14,588 - INFO - Standard deviation: 
         MAE      RMSE
0   0.101246  0.133000
1   0.080431  0.085783
2   0.082122  0.083514
3   0.079026  0.141653
4   0.113410  0.307857
5   0.090079  0.575575
6   0.097717  0.770627
7   0.052353  0.833559
8   0.065796  0.743950
9   0.046231  0.605053
10  0.089469  0.510491
11  0.081326  0.422674
2024-04-24 15:21:14,603 - INFO - ----------------------------------------------------------------------------
2024-04-24 15:21:14,603 - INFO - 12 steps Average: 
        MAE       RMSE
0  2.996067  10.883546
2024-04-24 15:21:14,603 - INFO - 12 steps Standard deviation: 
        MAE      RMSE
0  0.081601  0.434478
