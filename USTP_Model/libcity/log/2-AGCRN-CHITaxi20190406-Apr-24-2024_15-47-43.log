2024-04-24 15:47:43,642 - INFO - Log directory: ./libcity/log
2024-04-24 15:47:43,643 - INFO - Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=2
2024-04-24 15:47:43,643 - INFO - {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'embedding_model': 'TransE', 'seed': 76723204, 'exp_id': 2, 'max_epoch': 200, 'patience': 15, 'output_window': 12, 'load_external': False, 'metrics': ['MAE', 'RMSE'], 'cache_dataset': False, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-24 15:47:43,645 - INFO - Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-24 15:47:43,649 - INFO - set_weight_link_or_dist: dist
2024-04-24 15:47:43,649 - INFO - init_weight_inf_or_zero: inf
2024-04-24 15:47:43,661 - INFO - Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-24 15:47:43,661 - INFO - Start Calculate the weight by Gauss kernel!
2024-04-24 15:47:43,661 - INFO - Loading file CHITaxi20190406.dyna
2024-04-24 15:47:43,780 - INFO - Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-24 15:47:43,898 - INFO - Dataset created
2024-04-24 15:47:43,898 - INFO - x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-04-24 15:47:43,902 - INFO - train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-04-24 15:47:43,902 - INFO - eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-04-24 15:47:43,902 - INFO - test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-04-24 15:47:43,927 - INFO - StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-24 15:47:43,927 - INFO - NoneScaler
2024-04-24 15:47:44,058 - INFO - AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-24 15:47:44,059 - INFO - node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-24 15:47:44,059 - INFO - encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-04-24 15:47:44,059 - INFO - encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 15:47:44,059 - INFO - encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-04-24 15:47:44,059 - INFO - encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 15:47:44,059 - INFO - encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-24 15:47:44,059 - INFO - encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 15:47:44,059 - INFO - encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-24 15:47:44,060 - INFO - encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 15:47:44,060 - INFO - end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-24 15:47:44,060 - INFO - end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-24 15:47:44,060 - INFO - Total parameter numbers: 751130
2024-04-24 15:47:44,060 - INFO - You select `adam` optimizer.
2024-04-24 15:47:44,060 - WARNING - Received none train loss func and will use the loss func defined in the model.
2024-04-24 15:47:44,060 - INFO - Start training ...
2024-04-24 15:47:44,061 - INFO - num_batches:48
2024-04-24 15:47:48,342 - INFO - epoch complete!
2024-04-24 15:47:48,343 - INFO - evaluating now!
2024-04-24 15:47:48,566 - INFO - Epoch [0/200] train_loss: 24.0567, val_loss: 16.2842, lr: 0.003000, 4.50s
2024-04-24 15:47:48,579 - INFO - Saved model at 0
2024-04-24 15:47:48,579 - INFO - Val loss decrease from inf to 16.2842, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-24 15:47:52,859 - INFO - epoch complete!
2024-04-24 15:47:52,860 - INFO - evaluating now!
2024-04-24 15:47:53,082 - INFO - Epoch [1/200] train_loss: 13.0200, val_loss: 11.9725, lr: 0.003000, 4.50s
2024-04-24 15:47:53,095 - INFO - Saved model at 1
2024-04-24 15:47:53,095 - INFO - Val loss decrease from 16.2842 to 11.9725, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-24 15:47:57,543 - INFO - epoch complete!
2024-04-24 15:47:57,543 - INFO - evaluating now!
2024-04-24 15:47:57,773 - INFO - Epoch [2/200] train_loss: 9.8316, val_loss: 8.8132, lr: 0.003000, 4.68s
2024-04-24 15:47:57,787 - INFO - Saved model at 2
2024-04-24 15:47:57,787 - INFO - Val loss decrease from 11.9725 to 8.8132, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-24 15:48:02,133 - INFO - epoch complete!
2024-04-24 15:48:02,134 - INFO - evaluating now!
2024-04-24 15:48:02,396 - INFO - Epoch [3/200] train_loss: 8.1072, val_loss: 7.7637, lr: 0.003000, 4.61s
2024-04-24 15:48:02,409 - INFO - Saved model at 3
2024-04-24 15:48:02,409 - INFO - Val loss decrease from 8.8132 to 7.7637, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-24 15:48:06,770 - INFO - epoch complete!
2024-04-24 15:48:06,770 - INFO - evaluating now!
2024-04-24 15:48:06,995 - INFO - Epoch [4/200] train_loss: 7.2910, val_loss: 7.1004, lr: 0.003000, 4.59s
2024-04-24 15:48:07,008 - INFO - Saved model at 4
2024-04-24 15:48:07,008 - INFO - Val loss decrease from 7.7637 to 7.1004, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-24 15:48:11,326 - INFO - epoch complete!
2024-04-24 15:48:11,326 - INFO - evaluating now!
2024-04-24 15:48:11,546 - INFO - Epoch [5/200] train_loss: 6.7673, val_loss: 6.4655, lr: 0.003000, 4.54s
2024-04-24 15:48:11,559 - INFO - Saved model at 5
2024-04-24 15:48:11,559 - INFO - Val loss decrease from 7.1004 to 6.4655, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-24 15:48:15,840 - INFO - epoch complete!
2024-04-24 15:48:15,840 - INFO - evaluating now!
2024-04-24 15:48:16,070 - INFO - Epoch [6/200] train_loss: 6.3217, val_loss: 6.2670, lr: 0.003000, 4.51s
2024-04-24 15:48:16,083 - INFO - Saved model at 6
2024-04-24 15:48:16,084 - INFO - Val loss decrease from 6.4655 to 6.2670, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-24 15:48:20,432 - INFO - epoch complete!
2024-04-24 15:48:20,433 - INFO - evaluating now!
2024-04-24 15:48:20,659 - INFO - Epoch [7/200] train_loss: 5.9496, val_loss: 6.2005, lr: 0.003000, 4.57s
2024-04-24 15:48:20,671 - INFO - Saved model at 7
2024-04-24 15:48:20,671 - INFO - Val loss decrease from 6.2670 to 6.2005, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-24 15:48:25,009 - INFO - epoch complete!
2024-04-24 15:48:25,009 - INFO - evaluating now!
2024-04-24 15:48:25,238 - INFO - Epoch [8/200] train_loss: 5.7998, val_loss: 5.7134, lr: 0.003000, 4.56s
2024-04-24 15:48:25,251 - INFO - Saved model at 8
2024-04-24 15:48:25,251 - INFO - Val loss decrease from 6.2005 to 5.7134, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-24 15:48:29,669 - INFO - epoch complete!
2024-04-24 15:48:29,670 - INFO - evaluating now!
2024-04-24 15:48:29,892 - INFO - Epoch [9/200] train_loss: 5.5203, val_loss: 5.6606, lr: 0.003000, 4.64s
2024-04-24 15:48:29,906 - INFO - Saved model at 9
2024-04-24 15:48:29,906 - INFO - Val loss decrease from 5.7134 to 5.6606, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-24 15:48:34,273 - INFO - epoch complete!
2024-04-24 15:48:34,273 - INFO - evaluating now!
2024-04-24 15:48:34,501 - INFO - Epoch [10/200] train_loss: 5.3773, val_loss: 5.7533, lr: 0.003000, 4.59s
2024-04-24 15:48:38,793 - INFO - epoch complete!
2024-04-24 15:48:38,794 - INFO - evaluating now!
2024-04-24 15:48:39,019 - INFO - Epoch [11/200] train_loss: 5.2499, val_loss: 5.5182, lr: 0.003000, 4.52s
2024-04-24 15:48:39,034 - INFO - Saved model at 11
2024-04-24 15:48:39,034 - INFO - Val loss decrease from 5.6606 to 5.5182, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-24 15:48:43,349 - INFO - epoch complete!
2024-04-24 15:48:43,349 - INFO - evaluating now!
2024-04-24 15:48:43,571 - INFO - Epoch [12/200] train_loss: 5.1923, val_loss: 5.4708, lr: 0.003000, 4.54s
2024-04-24 15:48:43,585 - INFO - Saved model at 12
2024-04-24 15:48:43,585 - INFO - Val loss decrease from 5.5182 to 5.4708, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-24 15:48:48,023 - INFO - epoch complete!
2024-04-24 15:48:48,024 - INFO - evaluating now!
2024-04-24 15:48:48,249 - INFO - Epoch [13/200] train_loss: 5.0232, val_loss: 5.3612, lr: 0.003000, 4.66s
2024-04-24 15:48:48,262 - INFO - Saved model at 13
2024-04-24 15:48:48,262 - INFO - Val loss decrease from 5.4708 to 5.3612, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-24 15:48:52,581 - INFO - epoch complete!
2024-04-24 15:48:52,581 - INFO - evaluating now!
2024-04-24 15:48:52,805 - INFO - Epoch [14/200] train_loss: 4.9182, val_loss: 5.2631, lr: 0.003000, 4.54s
2024-04-24 15:48:52,818 - INFO - Saved model at 14
2024-04-24 15:48:52,818 - INFO - Val loss decrease from 5.3612 to 5.2631, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-24 15:48:57,145 - INFO - epoch complete!
2024-04-24 15:48:57,145 - INFO - evaluating now!
2024-04-24 15:48:57,373 - INFO - Epoch [15/200] train_loss: 4.8546, val_loss: 5.4605, lr: 0.003000, 4.55s
2024-04-24 15:49:01,736 - INFO - epoch complete!
2024-04-24 15:49:01,736 - INFO - evaluating now!
2024-04-24 15:49:01,994 - INFO - Epoch [16/200] train_loss: 4.7750, val_loss: 5.2695, lr: 0.003000, 4.62s
2024-04-24 15:49:06,315 - INFO - epoch complete!
2024-04-24 15:49:06,316 - INFO - evaluating now!
2024-04-24 15:49:06,540 - INFO - Epoch [17/200] train_loss: 4.7019, val_loss: 5.3004, lr: 0.003000, 4.55s
2024-04-24 15:49:10,841 - INFO - epoch complete!
2024-04-24 15:49:10,842 - INFO - evaluating now!
2024-04-24 15:49:11,066 - INFO - Epoch [18/200] train_loss: 4.6128, val_loss: 5.1146, lr: 0.003000, 4.53s
2024-04-24 15:49:11,078 - INFO - Saved model at 18
2024-04-24 15:49:11,078 - INFO - Val loss decrease from 5.2631 to 5.1146, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-24 15:49:15,431 - INFO - epoch complete!
2024-04-24 15:49:15,431 - INFO - evaluating now!
2024-04-24 15:49:15,651 - INFO - Epoch [19/200] train_loss: 4.5955, val_loss: 5.2564, lr: 0.003000, 4.57s
2024-04-24 15:49:19,926 - INFO - epoch complete!
2024-04-24 15:49:19,926 - INFO - evaluating now!
2024-04-24 15:49:20,153 - INFO - Epoch [20/200] train_loss: 4.5199, val_loss: 5.2769, lr: 0.003000, 4.50s
2024-04-24 15:49:24,641 - INFO - epoch complete!
2024-04-24 15:49:24,642 - INFO - evaluating now!
2024-04-24 15:49:24,867 - INFO - Epoch [21/200] train_loss: 4.4969, val_loss: 5.0712, lr: 0.003000, 4.71s
2024-04-24 15:49:24,880 - INFO - Saved model at 21
2024-04-24 15:49:24,880 - INFO - Val loss decrease from 5.1146 to 5.0712, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-24 15:49:29,159 - INFO - epoch complete!
2024-04-24 15:49:29,159 - INFO - evaluating now!
2024-04-24 15:49:29,377 - INFO - Epoch [22/200] train_loss: 4.3933, val_loss: 5.1964, lr: 0.003000, 4.50s
2024-04-24 15:49:33,629 - INFO - epoch complete!
2024-04-24 15:49:33,630 - INFO - evaluating now!
2024-04-24 15:49:33,852 - INFO - Epoch [23/200] train_loss: 4.4557, val_loss: 5.2695, lr: 0.003000, 4.47s
2024-04-24 15:49:38,143 - INFO - epoch complete!
2024-04-24 15:49:38,143 - INFO - evaluating now!
2024-04-24 15:49:38,367 - INFO - Epoch [24/200] train_loss: 4.3892, val_loss: 5.1061, lr: 0.003000, 4.52s
2024-04-24 15:49:42,633 - INFO - epoch complete!
2024-04-24 15:49:42,633 - INFO - evaluating now!
2024-04-24 15:49:42,860 - INFO - Epoch [25/200] train_loss: 4.2532, val_loss: 5.1503, lr: 0.003000, 4.49s
2024-04-24 15:49:47,154 - INFO - epoch complete!
2024-04-24 15:49:47,154 - INFO - evaluating now!
2024-04-24 15:49:47,373 - INFO - Epoch [26/200] train_loss: 4.2160, val_loss: 5.1383, lr: 0.003000, 4.51s
2024-04-24 15:49:51,570 - INFO - epoch complete!
2024-04-24 15:49:51,571 - INFO - evaluating now!
2024-04-24 15:49:51,789 - INFO - Epoch [27/200] train_loss: 4.2440, val_loss: 4.9533, lr: 0.003000, 4.42s
2024-04-24 15:49:51,802 - INFO - Saved model at 27
2024-04-24 15:49:51,802 - INFO - Val loss decrease from 5.0712 to 4.9533, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-24 15:49:56,034 - INFO - epoch complete!
2024-04-24 15:49:56,035 - INFO - evaluating now!
2024-04-24 15:49:56,263 - INFO - Epoch [28/200] train_loss: 4.1411, val_loss: 5.0747, lr: 0.003000, 4.46s
2024-04-24 15:50:00,531 - INFO - epoch complete!
2024-04-24 15:50:00,531 - INFO - evaluating now!
2024-04-24 15:50:00,766 - INFO - Epoch [29/200] train_loss: 4.1204, val_loss: 5.1791, lr: 0.003000, 4.50s
2024-04-24 15:50:05,116 - INFO - epoch complete!
2024-04-24 15:50:05,117 - INFO - evaluating now!
2024-04-24 15:50:05,344 - INFO - Epoch [30/200] train_loss: 4.0570, val_loss: 5.0394, lr: 0.003000, 4.58s
2024-04-24 15:50:09,623 - INFO - epoch complete!
2024-04-24 15:50:09,623 - INFO - evaluating now!
2024-04-24 15:50:09,848 - INFO - Epoch [31/200] train_loss: 4.0584, val_loss: 5.1098, lr: 0.003000, 4.50s
2024-04-24 15:50:14,110 - INFO - epoch complete!
2024-04-24 15:50:14,110 - INFO - evaluating now!
2024-04-24 15:50:14,327 - INFO - Epoch [32/200] train_loss: 4.0508, val_loss: 5.0434, lr: 0.003000, 4.48s
2024-04-24 15:50:18,522 - INFO - epoch complete!
2024-04-24 15:50:18,522 - INFO - evaluating now!
2024-04-24 15:50:18,741 - INFO - Epoch [33/200] train_loss: 4.0351, val_loss: 5.1211, lr: 0.003000, 4.41s
2024-04-24 15:50:22,953 - INFO - epoch complete!
2024-04-24 15:50:22,953 - INFO - evaluating now!
2024-04-24 15:50:23,173 - INFO - Epoch [34/200] train_loss: 3.9553, val_loss: 5.0522, lr: 0.003000, 4.43s
2024-04-24 15:50:27,392 - INFO - epoch complete!
2024-04-24 15:50:27,392 - INFO - evaluating now!
2024-04-24 15:50:27,612 - INFO - Epoch [35/200] train_loss: 3.9418, val_loss: 5.1509, lr: 0.003000, 4.44s
2024-04-24 15:50:31,842 - INFO - epoch complete!
2024-04-24 15:50:31,842 - INFO - evaluating now!
2024-04-24 15:50:32,070 - INFO - Epoch [36/200] train_loss: 3.9112, val_loss: 5.0586, lr: 0.003000, 4.46s
2024-04-24 15:50:36,285 - INFO - epoch complete!
2024-04-24 15:50:36,285 - INFO - evaluating now!
2024-04-24 15:50:36,502 - INFO - Epoch [37/200] train_loss: 3.8831, val_loss: 5.0883, lr: 0.003000, 4.43s
2024-04-24 15:50:40,735 - INFO - epoch complete!
2024-04-24 15:50:40,736 - INFO - evaluating now!
2024-04-24 15:50:40,960 - INFO - Epoch [38/200] train_loss: 3.8230, val_loss: 5.0206, lr: 0.003000, 4.46s
2024-04-24 15:50:45,178 - INFO - epoch complete!
2024-04-24 15:50:45,179 - INFO - evaluating now!
2024-04-24 15:50:45,398 - INFO - Epoch [39/200] train_loss: 3.7894, val_loss: 4.9671, lr: 0.003000, 4.44s
2024-04-24 15:50:49,638 - INFO - epoch complete!
2024-04-24 15:50:49,639 - INFO - evaluating now!
2024-04-24 15:50:49,873 - INFO - Epoch [40/200] train_loss: 3.8225, val_loss: 5.0525, lr: 0.003000, 4.47s
2024-04-24 15:50:54,128 - INFO - epoch complete!
2024-04-24 15:50:54,128 - INFO - evaluating now!
2024-04-24 15:50:54,366 - INFO - Epoch [41/200] train_loss: 3.8366, val_loss: 5.0965, lr: 0.003000, 4.49s
2024-04-24 15:50:58,577 - INFO - epoch complete!
2024-04-24 15:50:58,577 - INFO - evaluating now!
2024-04-24 15:50:58,796 - INFO - Epoch [42/200] train_loss: 3.7700, val_loss: 5.0995, lr: 0.003000, 4.43s
2024-04-24 15:50:58,797 - WARNING - Early stopping at epoch: 42
2024-04-24 15:50:58,797 - INFO - Trained totally 43 epochs, average train time is 4.297s, average eval time is 0.226s
2024-04-24 15:50:58,804 - INFO - Loaded model at 27
2024-04-24 15:50:58,805 - INFO - Saved model at ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406.m
2024-04-24 15:50:58,819 - INFO - Start evaluating ...
2024-04-24 15:50:59,647 - INFO - Note that you select the single mode to evaluate!
2024-04-24 15:50:59,652 - INFO - Evaluate result is saved at ./libcity/cache/2/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-24 15:50:59,655 - INFO - 
         MAE       RMSE
1   2.393532   7.434793
2   2.505852   8.018730
3   2.657019   8.880871
4   2.807612   9.682956
5   2.923605  10.426500
6   3.022019  11.190213
7   3.063206  11.680338
8   3.081429  12.024096
9   3.103438  12.258116
10  3.118416  12.416412
11  3.199126  12.728439
12  3.338762  13.243343
2024-04-24 15:50:59,660 - INFO - ----------------------------------------------------------------------------
2024-04-24 15:50:59,660 - INFO - # 3, Kownledge Graph Embedding: None, Experiment ids: 3
2024-04-24 15:50:59,661 - INFO - ----------------------------------------------------------------------------
2024-04-24 15:50:59,663 - INFO - Log directory: ./libcity/log
2024-04-24 15:50:59,663 - INFO - Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=3
2024-04-24 15:50:59,663 - INFO - {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'embedding_model': 'TransE', 'seed': 388264350, 'exp_id': 3, 'max_epoch': 200, 'patience': 15, 'output_window': 12, 'load_external': False, 'metrics': ['MAE', 'RMSE'], 'cache_dataset': False, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-24 15:50:59,666 - INFO - Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-24 15:50:59,669 - INFO - set_weight_link_or_dist: dist
2024-04-24 15:50:59,670 - INFO - init_weight_inf_or_zero: inf
2024-04-24 15:50:59,681 - INFO - Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-24 15:50:59,681 - INFO - Start Calculate the weight by Gauss kernel!
2024-04-24 15:50:59,682 - INFO - Loading file CHITaxi20190406.dyna
2024-04-24 15:50:59,812 - INFO - Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-24 15:50:59,934 - INFO - Dataset created
2024-04-24 15:50:59,935 - INFO - x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-04-24 15:50:59,940 - INFO - train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-04-24 15:50:59,940 - INFO - eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-04-24 15:50:59,940 - INFO - test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-04-24 15:50:59,967 - INFO - StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-24 15:50:59,968 - INFO - NoneScaler
2024-04-24 15:51:00,102 - INFO - AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-24 15:51:00,102 - INFO - node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-24 15:51:00,102 - INFO - encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-04-24 15:51:00,102 - INFO - encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 15:51:00,103 - INFO - encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-04-24 15:51:00,103 - INFO - encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 15:51:00,103 - INFO - encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-24 15:51:00,103 - INFO - encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 15:51:00,103 - INFO - encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-24 15:51:00,103 - INFO - encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 15:51:00,103 - INFO - end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-24 15:51:00,104 - INFO - end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-24 15:51:00,104 - INFO - Total parameter numbers: 751130
2024-04-24 15:51:00,104 - INFO - You select `adam` optimizer.
2024-04-24 15:51:00,104 - WARNING - Received none train loss func and will use the loss func defined in the model.
2024-04-24 15:51:00,104 - INFO - Start training ...
2024-04-24 15:51:00,105 - INFO - num_batches:48
2024-04-24 15:51:04,523 - INFO - epoch complete!
2024-04-24 15:51:04,524 - INFO - evaluating now!
2024-04-24 15:51:04,741 - INFO - Epoch [0/200] train_loss: 23.5171, val_loss: 17.0789, lr: 0.003000, 4.64s
2024-04-24 15:51:04,754 - INFO - Saved model at 0
2024-04-24 15:51:04,754 - INFO - Val loss decrease from inf to 17.0789, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-24 15:51:09,004 - INFO - epoch complete!
2024-04-24 15:51:09,004 - INFO - evaluating now!
2024-04-24 15:51:09,227 - INFO - Epoch [1/200] train_loss: 13.3966, val_loss: 12.3822, lr: 0.003000, 4.47s
2024-04-24 15:51:09,239 - INFO - Saved model at 1
2024-04-24 15:51:09,240 - INFO - Val loss decrease from 17.0789 to 12.3822, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-24 15:51:13,512 - INFO - epoch complete!
2024-04-24 15:51:13,513 - INFO - evaluating now!
2024-04-24 15:51:13,734 - INFO - Epoch [2/200] train_loss: 10.2085, val_loss: 9.2717, lr: 0.003000, 4.49s
2024-04-24 15:51:13,747 - INFO - Saved model at 2
2024-04-24 15:51:13,747 - INFO - Val loss decrease from 12.3822 to 9.2717, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-24 15:51:18,101 - INFO - epoch complete!
2024-04-24 15:51:18,101 - INFO - evaluating now!
2024-04-24 15:51:18,327 - INFO - Epoch [3/200] train_loss: 8.2524, val_loss: 7.9365, lr: 0.003000, 4.58s
2024-04-24 15:51:18,340 - INFO - Saved model at 3
2024-04-24 15:51:18,340 - INFO - Val loss decrease from 9.2717 to 7.9365, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-24 15:51:22,671 - INFO - epoch complete!
2024-04-24 15:51:22,672 - INFO - evaluating now!
2024-04-24 15:51:22,899 - INFO - Epoch [4/200] train_loss: 7.3522, val_loss: 7.1196, lr: 0.003000, 4.56s
2024-04-24 15:51:22,918 - INFO - Saved model at 4
2024-04-24 15:51:22,918 - INFO - Val loss decrease from 7.9365 to 7.1196, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-24 15:51:27,226 - INFO - epoch complete!
2024-04-24 15:51:27,226 - INFO - evaluating now!
2024-04-24 15:51:27,444 - INFO - Epoch [5/200] train_loss: 6.6672, val_loss: 6.5555, lr: 0.003000, 4.53s
2024-04-24 15:51:27,457 - INFO - Saved model at 5
2024-04-24 15:51:27,457 - INFO - Val loss decrease from 7.1196 to 6.5555, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-24 15:51:31,675 - INFO - epoch complete!
2024-04-24 15:51:31,676 - INFO - evaluating now!
2024-04-24 15:51:31,900 - INFO - Epoch [6/200] train_loss: 6.2823, val_loss: 6.3083, lr: 0.003000, 4.44s
2024-04-24 15:51:31,913 - INFO - Saved model at 6
2024-04-24 15:51:31,913 - INFO - Val loss decrease from 6.5555 to 6.3083, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-24 15:51:36,177 - INFO - epoch complete!
2024-04-24 15:51:36,177 - INFO - evaluating now!
2024-04-24 15:51:36,394 - INFO - Epoch [7/200] train_loss: 5.9332, val_loss: 6.1775, lr: 0.003000, 4.48s
2024-04-24 15:51:36,406 - INFO - Saved model at 7
2024-04-24 15:51:36,407 - INFO - Val loss decrease from 6.3083 to 6.1775, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-24 15:51:40,631 - INFO - epoch complete!
2024-04-24 15:51:40,632 - INFO - evaluating now!
2024-04-24 15:51:40,849 - INFO - Epoch [8/200] train_loss: 5.7919, val_loss: 5.8987, lr: 0.003000, 4.44s
2024-04-24 15:51:40,862 - INFO - Saved model at 8
2024-04-24 15:51:40,862 - INFO - Val loss decrease from 6.1775 to 5.8987, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-24 15:51:45,062 - INFO - epoch complete!
2024-04-24 15:51:45,062 - INFO - evaluating now!
2024-04-24 15:51:45,279 - INFO - Epoch [9/200] train_loss: 5.5663, val_loss: 5.7428, lr: 0.003000, 4.42s
2024-04-24 15:51:45,291 - INFO - Saved model at 9
2024-04-24 15:51:45,291 - INFO - Val loss decrease from 5.8987 to 5.7428, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-24 15:51:49,488 - INFO - epoch complete!
2024-04-24 15:51:49,489 - INFO - evaluating now!
2024-04-24 15:51:49,709 - INFO - Epoch [10/200] train_loss: 5.3944, val_loss: 5.8752, lr: 0.003000, 4.42s
2024-04-24 15:51:53,912 - INFO - epoch complete!
2024-04-24 15:51:53,912 - INFO - evaluating now!
2024-04-24 15:51:54,134 - INFO - Epoch [11/200] train_loss: 5.3059, val_loss: 5.6311, lr: 0.003000, 4.42s
2024-04-24 15:51:54,149 - INFO - Saved model at 11
2024-04-24 15:51:54,149 - INFO - Val loss decrease from 5.7428 to 5.6311, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-24 15:51:58,501 - INFO - epoch complete!
2024-04-24 15:51:58,501 - INFO - evaluating now!
2024-04-24 15:51:58,727 - INFO - Epoch [12/200] train_loss: 5.1389, val_loss: 5.8246, lr: 0.003000, 4.58s
2024-04-24 15:52:03,008 - INFO - epoch complete!
2024-04-24 15:52:03,008 - INFO - evaluating now!
2024-04-24 15:52:03,240 - INFO - Epoch [13/200] train_loss: 5.0355, val_loss: 5.5196, lr: 0.003000, 4.51s
2024-04-24 15:52:03,255 - INFO - Saved model at 13
2024-04-24 15:52:03,255 - INFO - Val loss decrease from 5.6311 to 5.5196, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-24 15:52:07,523 - INFO - epoch complete!
2024-04-24 15:52:07,523 - INFO - evaluating now!
2024-04-24 15:52:07,741 - INFO - Epoch [14/200] train_loss: 4.8879, val_loss: 5.4350, lr: 0.003000, 4.49s
2024-04-24 15:52:07,754 - INFO - Saved model at 14
2024-04-24 15:52:07,754 - INFO - Val loss decrease from 5.5196 to 5.4350, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-24 15:52:11,967 - INFO - epoch complete!
2024-04-24 15:52:11,968 - INFO - evaluating now!
2024-04-24 15:52:12,183 - INFO - Epoch [15/200] train_loss: 4.9093, val_loss: 5.4376, lr: 0.003000, 4.43s
2024-04-24 15:52:16,475 - INFO - epoch complete!
2024-04-24 15:52:16,476 - INFO - evaluating now!
2024-04-24 15:52:16,694 - INFO - Epoch [16/200] train_loss: 4.8087, val_loss: 5.3849, lr: 0.003000, 4.51s
2024-04-24 15:52:16,707 - INFO - Saved model at 16
2024-04-24 15:52:16,707 - INFO - Val loss decrease from 5.4350 to 5.3849, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-24 15:52:21,031 - INFO - epoch complete!
2024-04-24 15:52:21,031 - INFO - evaluating now!
2024-04-24 15:52:21,261 - INFO - Epoch [17/200] train_loss: 4.7350, val_loss: 5.3292, lr: 0.003000, 4.55s
2024-04-24 15:52:21,275 - INFO - Saved model at 17
2024-04-24 15:52:21,275 - INFO - Val loss decrease from 5.3849 to 5.3292, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-24 15:52:25,652 - INFO - epoch complete!
2024-04-24 15:52:25,653 - INFO - evaluating now!
2024-04-24 15:52:25,875 - INFO - Epoch [18/200] train_loss: 4.6476, val_loss: 5.3425, lr: 0.003000, 4.60s
2024-04-24 15:52:30,130 - INFO - epoch complete!
2024-04-24 15:52:30,131 - INFO - evaluating now!
2024-04-24 15:52:30,358 - INFO - Epoch [19/200] train_loss: 4.6138, val_loss: 5.1472, lr: 0.003000, 4.48s
2024-04-24 15:52:30,377 - INFO - Saved model at 19
2024-04-24 15:52:30,377 - INFO - Val loss decrease from 5.3292 to 5.1472, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-24 15:52:34,659 - INFO - epoch complete!
2024-04-24 15:52:34,659 - INFO - evaluating now!
2024-04-24 15:52:34,877 - INFO - Epoch [20/200] train_loss: 4.6908, val_loss: 5.3017, lr: 0.003000, 4.50s
2024-04-24 15:52:39,088 - INFO - epoch complete!
2024-04-24 15:52:39,089 - INFO - evaluating now!
2024-04-24 15:52:39,309 - INFO - Epoch [21/200] train_loss: 4.5460, val_loss: 5.3119, lr: 0.003000, 4.43s
2024-04-24 15:52:43,541 - INFO - epoch complete!
2024-04-24 15:52:43,542 - INFO - evaluating now!
2024-04-24 15:52:43,760 - INFO - Epoch [22/200] train_loss: 4.4472, val_loss: 5.2459, lr: 0.003000, 4.45s
2024-04-24 15:52:47,985 - INFO - epoch complete!
2024-04-24 15:52:47,985 - INFO - evaluating now!
2024-04-24 15:52:48,207 - INFO - Epoch [23/200] train_loss: 4.4060, val_loss: 5.2088, lr: 0.003000, 4.45s
2024-04-24 15:52:52,459 - INFO - epoch complete!
2024-04-24 15:52:52,459 - INFO - evaluating now!
2024-04-24 15:52:52,682 - INFO - Epoch [24/200] train_loss: 4.3187, val_loss: 5.2068, lr: 0.003000, 4.47s
2024-04-24 15:52:56,941 - INFO - epoch complete!
2024-04-24 15:52:56,941 - INFO - evaluating now!
2024-04-24 15:52:57,161 - INFO - Epoch [25/200] train_loss: 4.2842, val_loss: 5.1514, lr: 0.003000, 4.48s
2024-04-24 15:53:01,511 - INFO - epoch complete!
2024-04-24 15:53:01,511 - INFO - evaluating now!
2024-04-24 15:53:01,737 - INFO - Epoch [26/200] train_loss: 4.2181, val_loss: 5.3108, lr: 0.003000, 4.58s
2024-04-24 15:53:05,965 - INFO - epoch complete!
2024-04-24 15:53:05,965 - INFO - evaluating now!
2024-04-24 15:53:06,194 - INFO - Epoch [27/200] train_loss: 4.2274, val_loss: 5.2716, lr: 0.003000, 4.46s
2024-04-24 15:53:10,414 - INFO - epoch complete!
2024-04-24 15:53:10,414 - INFO - evaluating now!
2024-04-24 15:53:10,641 - INFO - Epoch [28/200] train_loss: 4.2025, val_loss: 5.2387, lr: 0.003000, 4.45s
2024-04-24 15:53:14,875 - INFO - epoch complete!
2024-04-24 15:53:14,875 - INFO - evaluating now!
2024-04-24 15:53:15,095 - INFO - Epoch [29/200] train_loss: 4.1254, val_loss: 5.1724, lr: 0.003000, 4.45s
2024-04-24 15:53:19,392 - INFO - epoch complete!
2024-04-24 15:53:19,393 - INFO - evaluating now!
2024-04-24 15:53:19,613 - INFO - Epoch [30/200] train_loss: 4.1643, val_loss: 5.1985, lr: 0.003000, 4.52s
2024-04-24 15:53:23,954 - INFO - epoch complete!
2024-04-24 15:53:23,954 - INFO - evaluating now!
2024-04-24 15:53:24,184 - INFO - Epoch [31/200] train_loss: 4.0671, val_loss: 5.1773, lr: 0.003000, 4.57s
2024-04-24 15:53:28,529 - INFO - epoch complete!
2024-04-24 15:53:28,530 - INFO - evaluating now!
2024-04-24 15:53:28,763 - INFO - Epoch [32/200] train_loss: 4.0267, val_loss: 5.1200, lr: 0.003000, 4.58s
2024-04-24 15:53:28,776 - INFO - Saved model at 32
2024-04-24 15:53:28,776 - INFO - Val loss decrease from 5.1472 to 5.1200, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-04-24 15:53:33,060 - INFO - epoch complete!
2024-04-24 15:53:33,060 - INFO - evaluating now!
2024-04-24 15:53:33,278 - INFO - Epoch [33/200] train_loss: 4.0075, val_loss: 5.3412, lr: 0.003000, 4.50s
2024-04-24 15:53:37,611 - INFO - epoch complete!
2024-04-24 15:53:37,612 - INFO - evaluating now!
2024-04-24 15:53:37,831 - INFO - Epoch [34/200] train_loss: 4.0117, val_loss: 5.0117, lr: 0.003000, 4.55s
2024-04-24 15:53:37,845 - INFO - Saved model at 34
2024-04-24 15:53:37,845 - INFO - Val loss decrease from 5.1200 to 5.0117, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-04-24 15:53:42,343 - INFO - epoch complete!
2024-04-24 15:53:42,344 - INFO - evaluating now!
2024-04-24 15:53:42,638 - INFO - Epoch [35/200] train_loss: 3.9891, val_loss: 5.2247, lr: 0.003000, 4.79s
2024-04-24 15:53:46,980 - INFO - epoch complete!
2024-04-24 15:53:46,980 - INFO - evaluating now!
2024-04-24 15:53:47,215 - INFO - Epoch [36/200] train_loss: 3.9277, val_loss: 5.1169, lr: 0.003000, 4.58s
2024-04-24 15:53:51,663 - INFO - epoch complete!
2024-04-24 15:53:51,663 - INFO - evaluating now!
2024-04-24 15:53:51,912 - INFO - Epoch [37/200] train_loss: 3.8978, val_loss: 4.9916, lr: 0.003000, 4.70s
2024-04-24 15:53:51,926 - INFO - Saved model at 37
2024-04-24 15:53:51,926 - INFO - Val loss decrease from 5.0117 to 4.9916, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-04-24 15:53:56,281 - INFO - epoch complete!
2024-04-24 15:53:56,282 - INFO - evaluating now!
2024-04-24 15:53:56,593 - INFO - Epoch [38/200] train_loss: 3.8363, val_loss: 5.0095, lr: 0.003000, 4.67s
2024-04-24 15:54:01,044 - INFO - epoch complete!
2024-04-24 15:54:01,044 - INFO - evaluating now!
2024-04-24 15:54:01,269 - INFO - Epoch [39/200] train_loss: 3.8453, val_loss: 5.2204, lr: 0.003000, 4.68s
2024-04-24 15:54:05,556 - INFO - epoch complete!
2024-04-24 15:54:05,556 - INFO - evaluating now!
2024-04-24 15:54:05,776 - INFO - Epoch [40/200] train_loss: 3.8214, val_loss: 5.2544, lr: 0.003000, 4.51s
2024-04-24 15:54:10,113 - INFO - epoch complete!
2024-04-24 15:54:10,114 - INFO - evaluating now!
2024-04-24 15:54:10,340 - INFO - Epoch [41/200] train_loss: 3.7842, val_loss: 5.0142, lr: 0.003000, 4.56s
2024-04-24 15:54:14,634 - INFO - epoch complete!
2024-04-24 15:54:14,634 - INFO - evaluating now!
2024-04-24 15:54:14,857 - INFO - Epoch [42/200] train_loss: 3.8374, val_loss: 4.9554, lr: 0.003000, 4.52s
2024-04-24 15:54:14,871 - INFO - Saved model at 42
2024-04-24 15:54:14,871 - INFO - Val loss decrease from 4.9916 to 4.9554, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-04-24 15:54:19,134 - INFO - epoch complete!
2024-04-24 15:54:19,135 - INFO - evaluating now!
2024-04-24 15:54:19,360 - INFO - Epoch [43/200] train_loss: 3.7756, val_loss: 5.1333, lr: 0.003000, 4.49s
2024-04-24 15:54:23,654 - INFO - epoch complete!
2024-04-24 15:54:23,655 - INFO - evaluating now!
2024-04-24 15:54:23,882 - INFO - Epoch [44/200] train_loss: 3.7673, val_loss: 5.2274, lr: 0.003000, 4.52s
2024-04-24 15:54:28,290 - INFO - epoch complete!
2024-04-24 15:54:28,290 - INFO - evaluating now!
2024-04-24 15:54:28,519 - INFO - Epoch [45/200] train_loss: 3.7766, val_loss: 5.0435, lr: 0.003000, 4.64s
2024-04-24 15:54:32,949 - INFO - epoch complete!
2024-04-24 15:54:32,949 - INFO - evaluating now!
2024-04-24 15:54:33,183 - INFO - Epoch [46/200] train_loss: 3.7053, val_loss: 5.0755, lr: 0.003000, 4.66s
2024-04-24 15:54:37,554 - INFO - epoch complete!
2024-04-24 15:54:37,554 - INFO - evaluating now!
2024-04-24 15:54:37,781 - INFO - Epoch [47/200] train_loss: 3.6774, val_loss: 5.1043, lr: 0.003000, 4.60s
2024-04-24 15:54:42,102 - INFO - epoch complete!
2024-04-24 15:54:42,103 - INFO - evaluating now!
2024-04-24 15:54:42,327 - INFO - Epoch [48/200] train_loss: 3.6678, val_loss: 4.9337, lr: 0.003000, 4.55s
2024-04-24 15:54:42,340 - INFO - Saved model at 48
2024-04-24 15:54:42,340 - INFO - Val loss decrease from 4.9554 to 4.9337, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-04-24 15:54:46,619 - INFO - epoch complete!
2024-04-24 15:54:46,620 - INFO - evaluating now!
2024-04-24 15:54:46,849 - INFO - Epoch [49/200] train_loss: 3.6742, val_loss: 4.9811, lr: 0.003000, 4.51s
2024-04-24 15:54:51,230 - INFO - epoch complete!
2024-04-24 15:54:51,230 - INFO - evaluating now!
2024-04-24 15:54:51,459 - INFO - Epoch [50/200] train_loss: 3.6160, val_loss: 4.9714, lr: 0.003000, 4.61s
2024-04-24 15:54:55,802 - INFO - epoch complete!
2024-04-24 15:54:55,803 - INFO - evaluating now!
2024-04-24 15:54:56,020 - INFO - Epoch [51/200] train_loss: 3.5890, val_loss: 5.1616, lr: 0.003000, 4.56s
2024-04-24 15:55:00,371 - INFO - epoch complete!
2024-04-24 15:55:00,371 - INFO - evaluating now!
2024-04-24 15:55:00,595 - INFO - Epoch [52/200] train_loss: 3.5675, val_loss: 5.2828, lr: 0.003000, 4.58s
2024-04-24 15:55:04,882 - INFO - epoch complete!
2024-04-24 15:55:04,882 - INFO - evaluating now!
2024-04-24 15:55:05,108 - INFO - Epoch [53/200] train_loss: 3.5942, val_loss: 5.0161, lr: 0.003000, 4.51s
2024-04-24 15:55:09,396 - INFO - epoch complete!
2024-04-24 15:55:09,397 - INFO - evaluating now!
2024-04-24 15:55:09,629 - INFO - Epoch [54/200] train_loss: 3.5683, val_loss: 5.0255, lr: 0.003000, 4.52s
2024-04-24 15:55:13,902 - INFO - epoch complete!
2024-04-24 15:55:13,903 - INFO - evaluating now!
2024-04-24 15:55:14,125 - INFO - Epoch [55/200] train_loss: 3.5691, val_loss: 4.9499, lr: 0.003000, 4.50s
2024-04-24 15:55:18,498 - INFO - epoch complete!
2024-04-24 15:55:18,499 - INFO - evaluating now!
2024-04-24 15:55:18,723 - INFO - Epoch [56/200] train_loss: 3.5346, val_loss: 5.0227, lr: 0.003000, 4.60s
2024-04-24 15:55:23,089 - INFO - epoch complete!
2024-04-24 15:55:23,089 - INFO - evaluating now!
2024-04-24 15:55:23,329 - INFO - Epoch [57/200] train_loss: 3.5088, val_loss: 4.9802, lr: 0.003000, 4.61s
2024-04-24 15:55:27,648 - INFO - epoch complete!
2024-04-24 15:55:27,648 - INFO - evaluating now!
2024-04-24 15:55:27,876 - INFO - Epoch [58/200] train_loss: 3.5124, val_loss: 5.0817, lr: 0.003000, 4.55s
2024-04-24 15:55:32,186 - INFO - epoch complete!
2024-04-24 15:55:32,186 - INFO - evaluating now!
2024-04-24 15:55:32,411 - INFO - Epoch [59/200] train_loss: 3.5006, val_loss: 5.1549, lr: 0.003000, 4.53s
2024-04-24 15:55:36,743 - INFO - epoch complete!
2024-04-24 15:55:36,744 - INFO - evaluating now!
2024-04-24 15:55:36,968 - INFO - Epoch [60/200] train_loss: 3.4571, val_loss: 4.9112, lr: 0.003000, 4.56s
2024-04-24 15:55:36,983 - INFO - Saved model at 60
2024-04-24 15:55:36,983 - INFO - Val loss decrease from 4.9337 to 4.9112, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch60.tar
2024-04-24 15:55:41,430 - INFO - epoch complete!
2024-04-24 15:55:41,430 - INFO - evaluating now!
2024-04-24 15:55:41,657 - INFO - Epoch [61/200] train_loss: 3.4737, val_loss: 4.9430, lr: 0.003000, 4.67s
2024-04-24 15:55:46,003 - INFO - epoch complete!
2024-04-24 15:55:46,003 - INFO - evaluating now!
2024-04-24 15:55:46,230 - INFO - Epoch [62/200] train_loss: 3.4608, val_loss: 4.9603, lr: 0.003000, 4.57s
2024-04-24 15:55:50,549 - INFO - epoch complete!
2024-04-24 15:55:50,549 - INFO - evaluating now!
2024-04-24 15:55:50,783 - INFO - Epoch [63/200] train_loss: 3.4151, val_loss: 5.0138, lr: 0.003000, 4.55s
2024-04-24 15:55:55,134 - INFO - epoch complete!
2024-04-24 15:55:55,134 - INFO - evaluating now!
2024-04-24 15:55:55,360 - INFO - Epoch [64/200] train_loss: 3.4150, val_loss: 5.1254, lr: 0.003000, 4.58s
2024-04-24 15:55:59,692 - INFO - epoch complete!
2024-04-24 15:55:59,692 - INFO - evaluating now!
2024-04-24 15:55:59,916 - INFO - Epoch [65/200] train_loss: 3.3909, val_loss: 4.9641, lr: 0.003000, 4.56s
2024-04-24 15:56:04,339 - INFO - epoch complete!
2024-04-24 15:56:04,340 - INFO - evaluating now!
2024-04-24 15:56:04,567 - INFO - Epoch [66/200] train_loss: 3.3710, val_loss: 5.0017, lr: 0.003000, 4.65s
2024-04-24 15:56:09,019 - INFO - epoch complete!
2024-04-24 15:56:09,020 - INFO - evaluating now!
2024-04-24 15:56:09,264 - INFO - Epoch [67/200] train_loss: 3.3626, val_loss: 4.9846, lr: 0.003000, 4.70s
2024-04-24 15:56:13,643 - INFO - epoch complete!
2024-04-24 15:56:13,644 - INFO - evaluating now!
2024-04-24 15:56:13,865 - INFO - Epoch [68/200] train_loss: 3.3728, val_loss: 5.1113, lr: 0.003000, 4.60s
2024-04-24 15:56:18,173 - INFO - epoch complete!
2024-04-24 15:56:18,173 - INFO - evaluating now!
2024-04-24 15:56:18,413 - INFO - Epoch [69/200] train_loss: 3.3765, val_loss: 5.0863, lr: 0.003000, 4.55s
2024-04-24 15:56:22,727 - INFO - epoch complete!
2024-04-24 15:56:22,728 - INFO - evaluating now!
2024-04-24 15:56:22,957 - INFO - Epoch [70/200] train_loss: 3.3615, val_loss: 5.0589, lr: 0.003000, 4.54s
2024-04-24 15:56:27,325 - INFO - epoch complete!
2024-04-24 15:56:27,326 - INFO - evaluating now!
2024-04-24 15:56:27,556 - INFO - Epoch [71/200] train_loss: 3.3445, val_loss: 5.0073, lr: 0.003000, 4.60s
2024-04-24 15:56:31,946 - INFO - epoch complete!
2024-04-24 15:56:31,947 - INFO - evaluating now!
2024-04-24 15:56:32,172 - INFO - Epoch [72/200] train_loss: 3.3276, val_loss: 4.9656, lr: 0.003000, 4.62s
2024-04-24 15:56:36,590 - INFO - epoch complete!
2024-04-24 15:56:36,590 - INFO - evaluating now!
2024-04-24 15:56:36,817 - INFO - Epoch [73/200] train_loss: 3.2970, val_loss: 4.9665, lr: 0.003000, 4.64s
2024-04-24 15:56:41,207 - INFO - epoch complete!
2024-04-24 15:56:41,207 - INFO - evaluating now!
2024-04-24 15:56:41,432 - INFO - Epoch [74/200] train_loss: 3.3362, val_loss: 5.0806, lr: 0.003000, 4.62s
2024-04-24 15:56:45,705 - INFO - epoch complete!
2024-04-24 15:56:45,705 - INFO - evaluating now!
2024-04-24 15:56:45,949 - INFO - Epoch [75/200] train_loss: 3.3178, val_loss: 5.1653, lr: 0.003000, 4.52s
2024-04-24 15:56:45,949 - WARNING - Early stopping at epoch: 75
2024-04-24 15:56:45,949 - INFO - Trained totally 76 epochs, average train time is 4.318s, average eval time is 0.227s
2024-04-24 15:56:45,957 - INFO - Loaded model at 60
2024-04-24 15:56:45,958 - INFO - Saved model at ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406.m
2024-04-24 15:56:45,971 - INFO - Start evaluating ...
2024-04-24 15:56:46,853 - INFO - Note that you select the single mode to evaluate!
2024-04-24 15:56:46,857 - INFO - Evaluate result is saved at ./libcity/cache/3/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-24 15:56:46,859 - INFO - 
         MAE       RMSE
1   2.316513   6.843215
2   2.438999   7.533939
3   2.666271   9.004161
4   2.842166  10.200020
5   2.965494  11.287341
6   3.058602  12.164453
7   3.131796  12.693393
8   3.194040  12.961001
9   3.277385  13.264045
10  3.336536  13.447107
11  3.424057  13.774369
12  3.536379  14.246633
2024-04-24 15:56:46,865 - INFO - ----------------------------------------------------------------------------
2024-04-24 15:56:46,865 - INFO - # 4, Kownledge Graph Embedding: None, Experiment ids: 4
2024-04-24 15:56:46,865 - INFO - ----------------------------------------------------------------------------
2024-04-24 15:56:46,867 - INFO - Log directory: ./libcity/log
2024-04-24 15:56:46,868 - INFO - Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=4
2024-04-24 15:56:46,868 - INFO - {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'embedding_model': 'TransE', 'seed': 155120739, 'exp_id': 4, 'max_epoch': 200, 'patience': 15, 'output_window': 12, 'load_external': False, 'metrics': ['MAE', 'RMSE'], 'cache_dataset': False, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-24 15:56:46,870 - INFO - Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-24 15:56:46,875 - INFO - set_weight_link_or_dist: dist
2024-04-24 15:56:46,875 - INFO - init_weight_inf_or_zero: inf
2024-04-24 15:56:46,887 - INFO - Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-24 15:56:46,887 - INFO - Start Calculate the weight by Gauss kernel!
2024-04-24 15:56:46,887 - INFO - Loading file CHITaxi20190406.dyna
2024-04-24 15:56:47,014 - INFO - Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-24 15:56:47,129 - INFO - Dataset created
2024-04-24 15:56:47,129 - INFO - x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-04-24 15:56:47,133 - INFO - train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-04-24 15:56:47,133 - INFO - eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-04-24 15:56:47,133 - INFO - test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-04-24 15:56:47,159 - INFO - StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-24 15:56:47,159 - INFO - NoneScaler
2024-04-24 15:56:47,287 - INFO - AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-24 15:56:47,288 - INFO - node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-24 15:56:47,288 - INFO - encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-04-24 15:56:47,288 - INFO - encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 15:56:47,288 - INFO - encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-04-24 15:56:47,288 - INFO - encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 15:56:47,288 - INFO - encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-24 15:56:47,289 - INFO - encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 15:56:47,289 - INFO - encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-24 15:56:47,289 - INFO - encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 15:56:47,289 - INFO - end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-24 15:56:47,289 - INFO - end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-24 15:56:47,289 - INFO - Total parameter numbers: 751130
2024-04-24 15:56:47,290 - INFO - You select `adam` optimizer.
2024-04-24 15:56:47,290 - WARNING - Received none train loss func and will use the loss func defined in the model.
2024-04-24 15:56:47,290 - INFO - Start training ...
2024-04-24 15:56:47,290 - INFO - num_batches:48
2024-04-24 15:56:51,579 - INFO - epoch complete!
2024-04-24 15:56:51,579 - INFO - evaluating now!
2024-04-24 15:56:51,804 - INFO - Epoch [0/200] train_loss: 23.4012, val_loss: 16.8245, lr: 0.003000, 4.51s
2024-04-24 15:56:51,817 - INFO - Saved model at 0
2024-04-24 15:56:51,817 - INFO - Val loss decrease from inf to 16.8245, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-24 15:56:56,120 - INFO - epoch complete!
2024-04-24 15:56:56,120 - INFO - evaluating now!
2024-04-24 15:56:56,340 - INFO - Epoch [1/200] train_loss: 12.9978, val_loss: 11.9771, lr: 0.003000, 4.52s
2024-04-24 15:56:56,354 - INFO - Saved model at 1
2024-04-24 15:56:56,354 - INFO - Val loss decrease from 16.8245 to 11.9771, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-24 15:57:00,604 - INFO - epoch complete!
2024-04-24 15:57:00,604 - INFO - evaluating now!
2024-04-24 15:57:00,838 - INFO - Epoch [2/200] train_loss: 9.9568, val_loss: 9.3463, lr: 0.003000, 4.48s
2024-04-24 15:57:00,858 - INFO - Saved model at 2
2024-04-24 15:57:00,858 - INFO - Val loss decrease from 11.9771 to 9.3463, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-24 15:57:05,105 - INFO - epoch complete!
2024-04-24 15:57:05,106 - INFO - evaluating now!
2024-04-24 15:57:05,329 - INFO - Epoch [3/200] train_loss: 8.5268, val_loss: 8.0658, lr: 0.003000, 4.47s
2024-04-24 15:57:05,342 - INFO - Saved model at 3
2024-04-24 15:57:05,342 - INFO - Val loss decrease from 9.3463 to 8.0658, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-24 15:57:09,633 - INFO - epoch complete!
2024-04-24 15:57:09,633 - INFO - evaluating now!
2024-04-24 15:57:09,856 - INFO - Epoch [4/200] train_loss: 7.5899, val_loss: 7.2014, lr: 0.003000, 4.51s
2024-04-24 15:57:09,869 - INFO - Saved model at 4
2024-04-24 15:57:09,869 - INFO - Val loss decrease from 8.0658 to 7.2014, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-24 15:57:14,208 - INFO - epoch complete!
2024-04-24 15:57:14,209 - INFO - evaluating now!
2024-04-24 15:57:14,434 - INFO - Epoch [5/200] train_loss: 6.8826, val_loss: 6.6617, lr: 0.003000, 4.57s
2024-04-24 15:57:14,447 - INFO - Saved model at 5
2024-04-24 15:57:14,448 - INFO - Val loss decrease from 7.2014 to 6.6617, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-24 15:57:18,981 - INFO - epoch complete!
2024-04-24 15:57:18,981 - INFO - evaluating now!
2024-04-24 15:57:19,212 - INFO - Epoch [6/200] train_loss: 6.4723, val_loss: 6.4357, lr: 0.003000, 4.76s
2024-04-24 15:57:19,226 - INFO - Saved model at 6
2024-04-24 15:57:19,226 - INFO - Val loss decrease from 6.6617 to 6.4357, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-24 15:57:23,546 - INFO - epoch complete!
2024-04-24 15:57:23,546 - INFO - evaluating now!
2024-04-24 15:57:23,773 - INFO - Epoch [7/200] train_loss: 6.0984, val_loss: 6.1360, lr: 0.003000, 4.55s
2024-04-24 15:57:23,785 - INFO - Saved model at 7
2024-04-24 15:57:23,785 - INFO - Val loss decrease from 6.4357 to 6.1360, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-24 15:57:28,114 - INFO - epoch complete!
2024-04-24 15:57:28,114 - INFO - evaluating now!
2024-04-24 15:57:28,342 - INFO - Epoch [8/200] train_loss: 5.9618, val_loss: 5.8489, lr: 0.003000, 4.56s
2024-04-24 15:57:28,356 - INFO - Saved model at 8
2024-04-24 15:57:28,356 - INFO - Val loss decrease from 6.1360 to 5.8489, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-24 15:57:32,705 - INFO - epoch complete!
2024-04-24 15:57:32,706 - INFO - evaluating now!
2024-04-24 15:57:32,929 - INFO - Epoch [9/200] train_loss: 5.6555, val_loss: 6.0450, lr: 0.003000, 4.57s
2024-04-24 15:57:37,247 - INFO - epoch complete!
2024-04-24 15:57:37,248 - INFO - evaluating now!
2024-04-24 15:57:37,505 - INFO - Epoch [10/200] train_loss: 5.5116, val_loss: 5.7021, lr: 0.003000, 4.57s
2024-04-24 15:57:37,518 - INFO - Saved model at 10
2024-04-24 15:57:37,518 - INFO - Val loss decrease from 5.8489 to 5.7021, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-24 15:57:41,929 - INFO - epoch complete!
2024-04-24 15:57:41,930 - INFO - evaluating now!
2024-04-24 15:57:42,163 - INFO - Epoch [11/200] train_loss: 5.4661, val_loss: 5.7500, lr: 0.003000, 4.65s
2024-04-24 15:57:46,455 - INFO - epoch complete!
2024-04-24 15:57:46,456 - INFO - evaluating now!
2024-04-24 15:57:46,685 - INFO - Epoch [12/200] train_loss: 5.2694, val_loss: 5.4974, lr: 0.003000, 4.52s
2024-04-24 15:57:46,697 - INFO - Saved model at 12
2024-04-24 15:57:46,697 - INFO - Val loss decrease from 5.7021 to 5.4974, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-24 15:57:51,033 - INFO - epoch complete!
2024-04-24 15:57:51,033 - INFO - evaluating now!
2024-04-24 15:57:51,258 - INFO - Epoch [13/200] train_loss: 5.1211, val_loss: 5.4690, lr: 0.003000, 4.56s
2024-04-24 15:57:51,270 - INFO - Saved model at 13
2024-04-24 15:57:51,272 - INFO - Val loss decrease from 5.4974 to 5.4690, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-24 15:57:55,633 - INFO - epoch complete!
2024-04-24 15:57:55,634 - INFO - evaluating now!
2024-04-24 15:57:55,859 - INFO - Epoch [14/200] train_loss: 5.1209, val_loss: 5.6146, lr: 0.003000, 4.59s
2024-04-24 15:58:00,243 - INFO - epoch complete!
2024-04-24 15:58:00,244 - INFO - evaluating now!
2024-04-24 15:58:00,469 - INFO - Epoch [15/200] train_loss: 4.9818, val_loss: 5.3339, lr: 0.003000, 4.61s
2024-04-24 15:58:00,483 - INFO - Saved model at 15
2024-04-24 15:58:00,484 - INFO - Val loss decrease from 5.4690 to 5.3339, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-24 15:58:04,811 - INFO - epoch complete!
2024-04-24 15:58:04,811 - INFO - evaluating now!
2024-04-24 15:58:05,049 - INFO - Epoch [16/200] train_loss: 4.8948, val_loss: 5.3768, lr: 0.003000, 4.56s
2024-04-24 15:58:09,380 - INFO - epoch complete!
2024-04-24 15:58:09,381 - INFO - evaluating now!
2024-04-24 15:58:09,623 - INFO - Epoch [17/200] train_loss: 4.8149, val_loss: 5.3630, lr: 0.003000, 4.57s
2024-04-24 15:58:14,032 - INFO - epoch complete!
2024-04-24 15:58:14,032 - INFO - evaluating now!
2024-04-24 15:58:14,260 - INFO - Epoch [18/200] train_loss: 4.6900, val_loss: 5.1167, lr: 0.003000, 4.64s
2024-04-24 15:58:14,273 - INFO - Saved model at 18
2024-04-24 15:58:14,273 - INFO - Val loss decrease from 5.3339 to 5.1167, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-24 15:58:18,991 - INFO - epoch complete!
2024-04-24 15:58:18,991 - INFO - evaluating now!
2024-04-24 15:58:19,229 - INFO - Epoch [19/200] train_loss: 4.7057, val_loss: 5.4544, lr: 0.003000, 4.96s
2024-04-24 15:58:23,768 - INFO - epoch complete!
2024-04-24 15:58:23,768 - INFO - evaluating now!
2024-04-24 15:58:24,008 - INFO - Epoch [20/200] train_loss: 4.5969, val_loss: 5.3470, lr: 0.003000, 4.78s
2024-04-24 15:58:28,392 - INFO - epoch complete!
2024-04-24 15:58:28,392 - INFO - evaluating now!
2024-04-24 15:58:28,616 - INFO - Epoch [21/200] train_loss: 4.5174, val_loss: 5.2958, lr: 0.003000, 4.61s
2024-04-24 15:58:32,888 - INFO - epoch complete!
2024-04-24 15:58:32,888 - INFO - evaluating now!
2024-04-24 15:58:33,133 - INFO - Epoch [22/200] train_loss: 4.5145, val_loss: 5.5778, lr: 0.003000, 4.52s
2024-04-24 15:58:37,521 - INFO - epoch complete!
2024-04-24 15:58:37,522 - INFO - evaluating now!
2024-04-24 15:58:37,755 - INFO - Epoch [23/200] train_loss: 4.4506, val_loss: 5.3556, lr: 0.003000, 4.62s
2024-04-24 15:58:42,138 - INFO - epoch complete!
2024-04-24 15:58:42,138 - INFO - evaluating now!
2024-04-24 15:58:42,390 - INFO - Epoch [24/200] train_loss: 4.4048, val_loss: 5.4819, lr: 0.003000, 4.63s
2024-04-24 15:58:46,996 - INFO - epoch complete!
2024-04-24 15:58:46,996 - INFO - evaluating now!
2024-04-24 15:58:47,279 - INFO - Epoch [25/200] train_loss: 4.3559, val_loss: 5.1339, lr: 0.003000, 4.89s
2024-04-24 15:58:51,607 - INFO - epoch complete!
2024-04-24 15:58:51,608 - INFO - evaluating now!
2024-04-24 15:58:51,856 - INFO - Epoch [26/200] train_loss: 4.2920, val_loss: 5.2845, lr: 0.003000, 4.58s
2024-04-24 15:58:56,166 - INFO - epoch complete!
2024-04-24 15:58:56,166 - INFO - evaluating now!
2024-04-24 15:58:56,427 - INFO - Epoch [27/200] train_loss: 4.2615, val_loss: 5.0136, lr: 0.003000, 4.57s
2024-04-24 15:58:56,440 - INFO - Saved model at 27
2024-04-24 15:58:56,441 - INFO - Val loss decrease from 5.1167 to 5.0136, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-24 15:59:00,699 - INFO - epoch complete!
2024-04-24 15:59:00,699 - INFO - evaluating now!
2024-04-24 15:59:00,923 - INFO - Epoch [28/200] train_loss: 4.2731, val_loss: 5.2022, lr: 0.003000, 4.48s
2024-04-24 15:59:05,212 - INFO - epoch complete!
2024-04-24 15:59:05,212 - INFO - evaluating now!
2024-04-24 15:59:05,436 - INFO - Epoch [29/200] train_loss: 4.2124, val_loss: 5.0432, lr: 0.003000, 4.51s
2024-04-24 15:59:09,733 - INFO - epoch complete!
2024-04-24 15:59:09,734 - INFO - evaluating now!
2024-04-24 15:59:09,958 - INFO - Epoch [30/200] train_loss: 4.1835, val_loss: 4.9555, lr: 0.003000, 4.52s
2024-04-24 15:59:09,971 - INFO - Saved model at 30
2024-04-24 15:59:09,971 - INFO - Val loss decrease from 5.0136 to 4.9555, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-04-24 15:59:14,220 - INFO - epoch complete!
2024-04-24 15:59:14,220 - INFO - evaluating now!
2024-04-24 15:59:14,447 - INFO - Epoch [31/200] train_loss: 4.1295, val_loss: 5.1789, lr: 0.003000, 4.48s
2024-04-24 15:59:18,690 - INFO - epoch complete!
2024-04-24 15:59:18,691 - INFO - evaluating now!
2024-04-24 15:59:18,916 - INFO - Epoch [32/200] train_loss: 4.0723, val_loss: 5.2254, lr: 0.003000, 4.47s
2024-04-24 15:59:23,298 - INFO - epoch complete!
2024-04-24 15:59:23,298 - INFO - evaluating now!
2024-04-24 15:59:23,521 - INFO - Epoch [33/200] train_loss: 4.0244, val_loss: 5.1144, lr: 0.003000, 4.60s
2024-04-24 15:59:27,794 - INFO - epoch complete!
2024-04-24 15:59:27,794 - INFO - evaluating now!
2024-04-24 15:59:28,017 - INFO - Epoch [34/200] train_loss: 4.0376, val_loss: 5.1143, lr: 0.003000, 4.49s
2024-04-24 15:59:32,269 - INFO - epoch complete!
2024-04-24 15:59:32,269 - INFO - evaluating now!
2024-04-24 15:59:32,493 - INFO - Epoch [35/200] train_loss: 4.0024, val_loss: 5.1493, lr: 0.003000, 4.48s
2024-04-24 15:59:36,782 - INFO - epoch complete!
2024-04-24 15:59:36,782 - INFO - evaluating now!
2024-04-24 15:59:37,023 - INFO - Epoch [36/200] train_loss: 4.0107, val_loss: 5.0653, lr: 0.003000, 4.53s
2024-04-24 15:59:41,436 - INFO - epoch complete!
2024-04-24 15:59:41,436 - INFO - evaluating now!
2024-04-24 15:59:41,660 - INFO - Epoch [37/200] train_loss: 3.9667, val_loss: 5.1911, lr: 0.003000, 4.64s
2024-04-24 15:59:45,908 - INFO - epoch complete!
2024-04-24 15:59:45,908 - INFO - evaluating now!
2024-04-24 15:59:46,132 - INFO - Epoch [38/200] train_loss: 3.9187, val_loss: 5.1117, lr: 0.003000, 4.47s
2024-04-24 15:59:50,388 - INFO - epoch complete!
2024-04-24 15:59:50,388 - INFO - evaluating now!
2024-04-24 15:59:50,611 - INFO - Epoch [39/200] train_loss: 3.9197, val_loss: 5.0927, lr: 0.003000, 4.48s
2024-04-24 15:59:54,863 - INFO - epoch complete!
2024-04-24 15:59:54,863 - INFO - evaluating now!
2024-04-24 15:59:55,087 - INFO - Epoch [40/200] train_loss: 3.9232, val_loss: 5.0066, lr: 0.003000, 4.48s
2024-04-24 15:59:59,342 - INFO - epoch complete!
2024-04-24 15:59:59,342 - INFO - evaluating now!
2024-04-24 15:59:59,565 - INFO - Epoch [41/200] train_loss: 3.8236, val_loss: 5.2096, lr: 0.003000, 4.48s
2024-04-24 16:00:03,924 - INFO - epoch complete!
2024-04-24 16:00:03,924 - INFO - evaluating now!
2024-04-24 16:00:04,146 - INFO - Epoch [42/200] train_loss: 3.8055, val_loss: 5.1247, lr: 0.003000, 4.58s
2024-04-24 16:00:08,453 - INFO - epoch complete!
2024-04-24 16:00:08,454 - INFO - evaluating now!
2024-04-24 16:00:08,673 - INFO - Epoch [43/200] train_loss: 3.7694, val_loss: 5.2043, lr: 0.003000, 4.53s
2024-04-24 16:00:12,945 - INFO - epoch complete!
2024-04-24 16:00:12,946 - INFO - evaluating now!
2024-04-24 16:00:13,174 - INFO - Epoch [44/200] train_loss: 3.8085, val_loss: 4.9231, lr: 0.003000, 4.50s
2024-04-24 16:00:13,187 - INFO - Saved model at 44
2024-04-24 16:00:13,188 - INFO - Val loss decrease from 4.9555 to 4.9231, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-04-24 16:00:17,440 - INFO - epoch complete!
2024-04-24 16:00:17,440 - INFO - evaluating now!
2024-04-24 16:00:17,664 - INFO - Epoch [45/200] train_loss: 3.7410, val_loss: 5.0876, lr: 0.003000, 4.48s
2024-04-24 16:00:21,925 - INFO - epoch complete!
2024-04-24 16:00:21,926 - INFO - evaluating now!
2024-04-24 16:00:22,149 - INFO - Epoch [46/200] train_loss: 3.6968, val_loss: 5.0066, lr: 0.003000, 4.48s
2024-04-24 16:00:26,403 - INFO - epoch complete!
2024-04-24 16:00:26,403 - INFO - evaluating now!
2024-04-24 16:00:26,627 - INFO - Epoch [47/200] train_loss: 3.7193, val_loss: 5.0890, lr: 0.003000, 4.48s
2024-04-24 16:00:30,911 - INFO - epoch complete!
2024-04-24 16:00:30,911 - INFO - evaluating now!
2024-04-24 16:00:31,135 - INFO - Epoch [48/200] train_loss: 3.7223, val_loss: 5.0286, lr: 0.003000, 4.51s
2024-04-24 16:00:35,417 - INFO - epoch complete!
2024-04-24 16:00:35,417 - INFO - evaluating now!
2024-04-24 16:00:35,663 - INFO - Epoch [49/200] train_loss: 3.6416, val_loss: 5.1712, lr: 0.003000, 4.53s
2024-04-24 16:00:39,930 - INFO - epoch complete!
2024-04-24 16:00:39,931 - INFO - evaluating now!
2024-04-24 16:00:40,155 - INFO - Epoch [50/200] train_loss: 3.6353, val_loss: 5.0156, lr: 0.003000, 4.49s
2024-04-24 16:00:44,424 - INFO - epoch complete!
2024-04-24 16:00:44,424 - INFO - evaluating now!
2024-04-24 16:00:44,648 - INFO - Epoch [51/200] train_loss: 3.6546, val_loss: 5.0911, lr: 0.003000, 4.49s
2024-04-24 16:00:48,962 - INFO - epoch complete!
2024-04-24 16:00:48,963 - INFO - evaluating now!
2024-04-24 16:00:49,189 - INFO - Epoch [52/200] train_loss: 3.6088, val_loss: 5.1222, lr: 0.003000, 4.54s
2024-04-24 16:00:53,508 - INFO - epoch complete!
2024-04-24 16:00:53,508 - INFO - evaluating now!
2024-04-24 16:00:53,745 - INFO - Epoch [53/200] train_loss: 3.6253, val_loss: 5.2557, lr: 0.003000, 4.56s
2024-04-24 16:00:58,148 - INFO - epoch complete!
2024-04-24 16:00:58,149 - INFO - evaluating now!
2024-04-24 16:00:58,372 - INFO - Epoch [54/200] train_loss: 3.5766, val_loss: 5.0514, lr: 0.003000, 4.63s
2024-04-24 16:01:02,745 - INFO - epoch complete!
2024-04-24 16:01:02,745 - INFO - evaluating now!
2024-04-24 16:01:02,971 - INFO - Epoch [55/200] train_loss: 3.5290, val_loss: 5.1786, lr: 0.003000, 4.60s
2024-04-24 16:01:07,601 - INFO - epoch complete!
2024-04-24 16:01:07,602 - INFO - evaluating now!
2024-04-24 16:01:07,821 - INFO - Epoch [56/200] train_loss: 3.5620, val_loss: 5.1248, lr: 0.003000, 4.85s
2024-04-24 16:01:12,184 - INFO - epoch complete!
2024-04-24 16:01:12,185 - INFO - evaluating now!
2024-04-24 16:01:12,414 - INFO - Epoch [57/200] train_loss: 3.5386, val_loss: 5.1001, lr: 0.003000, 4.59s
2024-04-24 16:01:16,820 - INFO - epoch complete!
2024-04-24 16:01:16,820 - INFO - evaluating now!
2024-04-24 16:01:17,047 - INFO - Epoch [58/200] train_loss: 3.5206, val_loss: 5.1462, lr: 0.003000, 4.63s
2024-04-24 16:01:21,502 - INFO - epoch complete!
2024-04-24 16:01:21,502 - INFO - evaluating now!
2024-04-24 16:01:21,725 - INFO - Epoch [59/200] train_loss: 3.5075, val_loss: 5.1648, lr: 0.003000, 4.68s
2024-04-24 16:01:21,726 - WARNING - Early stopping at epoch: 59
2024-04-24 16:01:21,726 - INFO - Trained totally 60 epochs, average train time is 4.339s, average eval time is 0.230s
2024-04-24 16:01:21,734 - INFO - Loaded model at 44
2024-04-24 16:01:21,734 - INFO - Saved model at ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406.m
2024-04-24 16:01:21,747 - INFO - Start evaluating ...
2024-04-24 16:01:22,557 - INFO - Note that you select the single mode to evaluate!
2024-04-24 16:01:22,560 - INFO - Evaluate result is saved at ./libcity/cache/4/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-24 16:01:22,562 - INFO - 
         MAE       RMSE
1   2.392552   7.174065
2   2.496755   7.763762
3   2.610265   8.689969
4   2.730084   9.429088
5   2.905642  10.249805
6   2.984178  10.985509
7   3.102407  11.495355
8   3.222847  12.146036
9   3.287190  12.480294
10  3.305521  12.731279
11  3.434649  13.045012
12  3.503419  13.571084
2024-04-24 16:01:22,568 - INFO - ----------------------------------------------------------------------------
2024-04-24 16:01:22,568 - INFO - Kownledge Graph Embedding: False, Experiment ids: [0, 1, 2, 3, 4]
2024-04-24 16:01:22,573 - INFO - ----------------------------------------------------------------------------
2024-04-24 16:01:22,576 - INFO - Average: 
         MAE       RMSE
0   2.384957   7.224564
1   2.492162   7.828604
2   2.675877   8.882849
3   2.818493   9.735227
4   2.959794  10.609444
5   3.049097  11.398686
6   3.107586  11.915361
7   3.152551  12.388348
8   3.193414  12.697428
9   3.233116  12.932398
10  3.329865  13.290116
11  3.436312  13.845850 
2024-04-24 16:01:22,578 - INFO - Standard deviation: 
         MAE      RMSE
0   0.044853  0.253540
1   0.053394  0.252837
2   0.046930  0.244489
3   0.052114  0.330097
4   0.050030  0.394407
5   0.060079  0.462365
6   0.048143  0.468794
7   0.068308  0.376967
8   0.077058  0.337371
9   0.079009  0.395292
10  0.094271  0.531898
11  0.083948  0.653284
2024-04-24 16:01:22,583 - INFO - ----------------------------------------------------------------------------
2024-04-24 16:01:22,585 - INFO - 12 steps Average: 
        MAE       RMSE
0  2.986102  11.062406
2024-04-24 16:01:22,587 - INFO - 12 steps Standard deviation: 
        MAE      RMSE
0  0.063178  0.391778
