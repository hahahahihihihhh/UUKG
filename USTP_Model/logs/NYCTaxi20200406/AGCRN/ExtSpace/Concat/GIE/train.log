2024-09-06 17:06:01 INFO     Saving logs in: ./logs/NYCTaxi20200406\AGCRN\ExtSpace\GIE
2024-09-06 17:06:01 INFO     ----------------------------------------------------------------------------
2024-09-06 17:06:01 INFO     # 0, Kownledge Graph Embedding: GIE, Experiment ids: 3015
2024-09-06 17:06:01 INFO     ----------------------------------------------------------------------------
2024-09-06 17:06:01 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=NYCTaxi20200406, exp_id=3015
2024-09-06 17:06:01 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'NYCTaxi20200406', 'saved_model': True, 'train': True, 'exp_id': 3015, 'embedding_model': 'GIE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['NYCTaxi20200406'], 'geo_file': 'NYCTaxi20200406', 'rel_file': 'NYCTaxi20200406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-06 17:06:01 INFO     Loaded file NYCTaxi20200406.geo, num_nodes=260
2024-09-06 17:06:01 INFO     set_weight_link_or_dist: dist
2024-09-06 17:06:01 INFO     init_weight_inf_or_zero: inf
2024-09-06 17:06:02 INFO     Loaded file NYCTaxi20200406.rel, shape=(260, 260)
2024-09-06 17:06:02 INFO     Start Calculate the weight by Gauss kernel!
2024-09-06 17:06:02 INFO     Loading file NYCTaxi20200406.dyna
2024-09-06 17:06:02 INFO     Loaded file NYCTaxi20200406.dyna, shape=(4368, 260, 2)
2024-09-06 17:06:11 INFO     Dataset created
2024-09-06 17:06:11 INFO     x shape: (4345, 12, 260, 34), y shape: (4345, 12, 260, 34)
2024-09-06 17:06:11 INFO     train	x: (3042, 12, 260, 34), y: (3042, 12, 260, 34)
2024-09-06 17:06:11 INFO     eval	x: (434, 12, 260, 34), y: (434, 12, 260, 34)
2024-09-06 17:06:11 INFO     test	x: (869, 12, 260, 34), y: (869, 12, 260, 34)
2024-09-06 17:06:11 INFO     StandardScaler mean: 0.7727858064026704, std: 2.3026817046377195
2024-09-06 17:06:12 INFO     NormalScaler max: 0.659603814907769
2024-09-06 17:06:19 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-06 17:06:19 INFO     node_embeddings	torch.Size([260, 10])	cuda:0	True
2024-09-06 17:06:19 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-06 17:06:19 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-06 17:06:19 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-06 17:06:19 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-06 17:06:19 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-06 17:06:19 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-06 17:06:19 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-06 17:06:19 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-06 17:06:19 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-06 17:06:19 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-06 17:06:19 INFO     Total parameter numbers: 875840
2024-09-06 17:06:19 INFO     You select `adam` optimizer.
2024-09-06 17:06:19 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-06 17:06:19 INFO     Start training ...
2024-09-06 17:06:19 INFO     num_batches:48
2024-09-06 17:06:31 INFO     epoch complete!
2024-09-06 17:06:31 INFO     evaluating now!
2024-09-06 17:06:31 INFO     Epoch [0/200] train_loss: 1.8736, val_loss: 2.3875, lr: 0.003000, 11.92s
2024-09-06 17:06:31 INFO     Saved model at 0
2024-09-06 17:06:31 INFO     Val loss decrease from inf to 2.3875, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch0.tar
2024-09-06 17:06:40 INFO     epoch complete!
2024-09-06 17:06:40 INFO     evaluating now!
2024-09-06 17:06:41 INFO     Epoch [1/200] train_loss: 1.4926, val_loss: 2.0591, lr: 0.003000, 9.83s
2024-09-06 17:06:41 INFO     Saved model at 1
2024-09-06 17:06:41 INFO     Val loss decrease from 2.3875 to 2.0591, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch1.tar
2024-09-06 17:06:50 INFO     epoch complete!
2024-09-06 17:06:50 INFO     evaluating now!
2024-09-06 17:06:51 INFO     Epoch [2/200] train_loss: 1.3411, val_loss: 1.8449, lr: 0.003000, 9.78s
2024-09-06 17:06:51 INFO     Saved model at 2
2024-09-06 17:06:51 INFO     Val loss decrease from 2.0591 to 1.8449, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch2.tar
2024-09-06 17:07:00 INFO     epoch complete!
2024-09-06 17:07:00 INFO     evaluating now!
2024-09-06 17:07:01 INFO     Epoch [3/200] train_loss: 1.2806, val_loss: 1.8062, lr: 0.003000, 9.72s
2024-09-06 17:07:01 INFO     Saved model at 3
2024-09-06 17:07:01 INFO     Val loss decrease from 1.8449 to 1.8062, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch3.tar
2024-09-06 17:07:10 INFO     epoch complete!
2024-09-06 17:07:10 INFO     evaluating now!
2024-09-06 17:07:10 INFO     Epoch [4/200] train_loss: 1.2366, val_loss: 1.7118, lr: 0.003000, 9.72s
2024-09-06 17:07:10 INFO     Saved model at 4
2024-09-06 17:07:10 INFO     Val loss decrease from 1.8062 to 1.7118, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch4.tar
2024-09-06 17:07:19 INFO     epoch complete!
2024-09-06 17:07:19 INFO     evaluating now!
2024-09-06 17:07:20 INFO     Epoch [5/200] train_loss: 1.2035, val_loss: 1.6889, lr: 0.003000, 9.74s
2024-09-06 17:07:20 INFO     Saved model at 5
2024-09-06 17:07:20 INFO     Val loss decrease from 1.7118 to 1.6889, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch5.tar
2024-09-06 17:07:29 INFO     epoch complete!
2024-09-06 17:07:29 INFO     evaluating now!
2024-09-06 17:07:30 INFO     Epoch [6/200] train_loss: 1.1842, val_loss: 1.6652, lr: 0.003000, 9.77s
2024-09-06 17:07:30 INFO     Saved model at 6
2024-09-06 17:07:30 INFO     Val loss decrease from 1.6889 to 1.6652, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch6.tar
2024-09-06 17:07:39 INFO     epoch complete!
2024-09-06 17:07:39 INFO     evaluating now!
2024-09-06 17:07:40 INFO     Epoch [7/200] train_loss: 1.1739, val_loss: 1.6080, lr: 0.003000, 9.74s
2024-09-06 17:07:40 INFO     Saved model at 7
2024-09-06 17:07:40 INFO     Val loss decrease from 1.6652 to 1.6080, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch7.tar
2024-09-06 17:07:49 INFO     epoch complete!
2024-09-06 17:07:49 INFO     evaluating now!
2024-09-06 17:07:49 INFO     Epoch [8/200] train_loss: 1.1554, val_loss: 1.5924, lr: 0.003000, 9.75s
2024-09-06 17:07:49 INFO     Saved model at 8
2024-09-06 17:07:49 INFO     Val loss decrease from 1.6080 to 1.5924, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch8.tar
2024-09-06 17:07:58 INFO     epoch complete!
2024-09-06 17:07:58 INFO     evaluating now!
2024-09-06 17:07:59 INFO     Epoch [9/200] train_loss: 1.1477, val_loss: 1.5806, lr: 0.003000, 9.73s
2024-09-06 17:07:59 INFO     Saved model at 9
2024-09-06 17:07:59 INFO     Val loss decrease from 1.5924 to 1.5806, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch9.tar
2024-09-06 17:08:08 INFO     epoch complete!
2024-09-06 17:08:08 INFO     evaluating now!
2024-09-06 17:08:09 INFO     Epoch [10/200] train_loss: 1.1359, val_loss: 1.5436, lr: 0.003000, 9.73s
2024-09-06 17:08:09 INFO     Saved model at 10
2024-09-06 17:08:09 INFO     Val loss decrease from 1.5806 to 1.5436, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch10.tar
2024-09-06 17:08:18 INFO     epoch complete!
2024-09-06 17:08:18 INFO     evaluating now!
2024-09-06 17:08:19 INFO     Epoch [11/200] train_loss: 1.1284, val_loss: 1.5196, lr: 0.003000, 9.74s
2024-09-06 17:08:19 INFO     Saved model at 11
2024-09-06 17:08:19 INFO     Val loss decrease from 1.5436 to 1.5196, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch11.tar
2024-09-06 17:08:28 INFO     epoch complete!
2024-09-06 17:08:28 INFO     evaluating now!
2024-09-06 17:08:28 INFO     Epoch [12/200] train_loss: 1.1226, val_loss: 1.5805, lr: 0.003000, 9.73s
2024-09-06 17:08:37 INFO     epoch complete!
2024-09-06 17:08:37 INFO     evaluating now!
2024-09-06 17:08:38 INFO     Epoch [13/200] train_loss: 1.1166, val_loss: 1.5242, lr: 0.003000, 9.80s
2024-09-06 17:08:47 INFO     epoch complete!
2024-09-06 17:08:47 INFO     evaluating now!
2024-09-06 17:08:48 INFO     Epoch [14/200] train_loss: 1.1093, val_loss: 1.4951, lr: 0.003000, 9.75s
2024-09-06 17:08:48 INFO     Saved model at 14
2024-09-06 17:08:48 INFO     Val loss decrease from 1.5196 to 1.4951, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch14.tar
2024-09-06 17:08:57 INFO     epoch complete!
2024-09-06 17:08:57 INFO     evaluating now!
2024-09-06 17:08:58 INFO     Epoch [15/200] train_loss: 1.1035, val_loss: 1.5431, lr: 0.003000, 9.73s
2024-09-06 17:09:07 INFO     epoch complete!
2024-09-06 17:09:07 INFO     evaluating now!
2024-09-06 17:09:07 INFO     Epoch [16/200] train_loss: 1.1023, val_loss: 1.5308, lr: 0.003000, 9.73s
2024-09-06 17:09:16 INFO     epoch complete!
2024-09-06 17:09:16 INFO     evaluating now!
2024-09-06 17:09:17 INFO     Epoch [17/200] train_loss: 1.1013, val_loss: 1.4909, lr: 0.003000, 9.73s
2024-09-06 17:09:17 INFO     Saved model at 17
2024-09-06 17:09:17 INFO     Val loss decrease from 1.4951 to 1.4909, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch17.tar
2024-09-06 17:09:26 INFO     epoch complete!
2024-09-06 17:09:26 INFO     evaluating now!
2024-09-06 17:09:27 INFO     Epoch [18/200] train_loss: 1.0885, val_loss: 1.4918, lr: 0.003000, 9.83s
2024-09-06 17:09:36 INFO     epoch complete!
2024-09-06 17:09:36 INFO     evaluating now!
2024-09-06 17:09:37 INFO     Epoch [19/200] train_loss: 1.0902, val_loss: 1.4849, lr: 0.003000, 9.81s
2024-09-06 17:09:37 INFO     Saved model at 19
2024-09-06 17:09:37 INFO     Val loss decrease from 1.4909 to 1.4849, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch19.tar
2024-09-06 17:09:46 INFO     epoch complete!
2024-09-06 17:09:46 INFO     evaluating now!
2024-09-06 17:09:47 INFO     Epoch [20/200] train_loss: 1.0794, val_loss: 1.5282, lr: 0.003000, 9.94s
2024-09-06 17:09:56 INFO     epoch complete!
2024-09-06 17:09:56 INFO     evaluating now!
2024-09-06 17:09:57 INFO     Epoch [21/200] train_loss: 1.0712, val_loss: 1.5190, lr: 0.003000, 9.86s
2024-09-06 17:10:06 INFO     epoch complete!
2024-09-06 17:10:06 INFO     evaluating now!
2024-09-06 17:10:07 INFO     Epoch [22/200] train_loss: 1.0692, val_loss: 1.4875, lr: 0.003000, 9.87s
2024-09-06 17:10:16 INFO     epoch complete!
2024-09-06 17:10:16 INFO     evaluating now!
2024-09-06 17:10:16 INFO     Epoch [23/200] train_loss: 1.0634, val_loss: 1.4788, lr: 0.003000, 9.80s
2024-09-06 17:10:16 INFO     Saved model at 23
2024-09-06 17:10:16 INFO     Val loss decrease from 1.4849 to 1.4788, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch23.tar
2024-09-06 17:10:25 INFO     epoch complete!
2024-09-06 17:10:25 INFO     evaluating now!
2024-09-06 17:10:26 INFO     Epoch [24/200] train_loss: 1.0638, val_loss: 1.4770, lr: 0.003000, 9.80s
2024-09-06 17:10:26 INFO     Saved model at 24
2024-09-06 17:10:26 INFO     Val loss decrease from 1.4788 to 1.4770, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch24.tar
2024-09-06 17:10:36 INFO     epoch complete!
2024-09-06 17:10:36 INFO     evaluating now!
2024-09-06 17:10:36 INFO     Epoch [25/200] train_loss: 1.0574, val_loss: 1.4838, lr: 0.003000, 10.07s
2024-09-06 17:10:46 INFO     epoch complete!
2024-09-06 17:10:46 INFO     evaluating now!
2024-09-06 17:10:46 INFO     Epoch [26/200] train_loss: 1.0491, val_loss: 1.4758, lr: 0.003000, 10.19s
2024-09-06 17:10:46 INFO     Saved model at 26
2024-09-06 17:10:46 INFO     Val loss decrease from 1.4770 to 1.4758, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch26.tar
2024-09-06 17:10:56 INFO     epoch complete!
2024-09-06 17:10:56 INFO     evaluating now!
2024-09-06 17:10:56 INFO     Epoch [27/200] train_loss: 1.0469, val_loss: 1.4768, lr: 0.003000, 9.95s
2024-09-06 17:11:06 INFO     epoch complete!
2024-09-06 17:11:06 INFO     evaluating now!
2024-09-06 17:11:06 INFO     Epoch [28/200] train_loss: 1.0451, val_loss: 1.4792, lr: 0.003000, 9.86s
2024-09-06 17:11:15 INFO     epoch complete!
2024-09-06 17:11:15 INFO     evaluating now!
2024-09-06 17:11:16 INFO     Epoch [29/200] train_loss: 1.0412, val_loss: 1.4863, lr: 0.003000, 9.78s
2024-09-06 17:11:25 INFO     epoch complete!
2024-09-06 17:11:25 INFO     evaluating now!
2024-09-06 17:11:26 INFO     Epoch [30/200] train_loss: 1.0386, val_loss: 1.4743, lr: 0.003000, 10.03s
2024-09-06 17:11:26 INFO     Saved model at 30
2024-09-06 17:11:26 INFO     Val loss decrease from 1.4758 to 1.4743, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch30.tar
2024-09-06 17:11:35 INFO     epoch complete!
2024-09-06 17:11:35 INFO     evaluating now!
2024-09-06 17:11:36 INFO     Epoch [31/200] train_loss: 1.0372, val_loss: 1.4799, lr: 0.003000, 9.91s
2024-09-06 17:11:45 INFO     epoch complete!
2024-09-06 17:11:45 INFO     evaluating now!
2024-09-06 17:11:46 INFO     Epoch [32/200] train_loss: 1.0334, val_loss: 1.4643, lr: 0.003000, 9.82s
2024-09-06 17:11:46 INFO     Saved model at 32
2024-09-06 17:11:46 INFO     Val loss decrease from 1.4743 to 1.4643, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch32.tar
2024-09-06 17:11:55 INFO     epoch complete!
2024-09-06 17:11:55 INFO     evaluating now!
2024-09-06 17:11:56 INFO     Epoch [33/200] train_loss: 1.0343, val_loss: 1.4756, lr: 0.003000, 9.92s
2024-09-06 17:12:05 INFO     epoch complete!
2024-09-06 17:12:05 INFO     evaluating now!
2024-09-06 17:12:06 INFO     Epoch [34/200] train_loss: 1.0321, val_loss: 1.4703, lr: 0.003000, 9.85s
2024-09-06 17:12:15 INFO     epoch complete!
2024-09-06 17:12:15 INFO     evaluating now!
2024-09-06 17:12:15 INFO     Epoch [35/200] train_loss: 1.0255, val_loss: 1.4678, lr: 0.003000, 9.91s
2024-09-06 17:12:25 INFO     epoch complete!
2024-09-06 17:12:25 INFO     evaluating now!
2024-09-06 17:12:25 INFO     Epoch [36/200] train_loss: 1.0231, val_loss: 1.4667, lr: 0.003000, 9.81s
2024-09-06 17:12:34 INFO     epoch complete!
2024-09-06 17:12:34 INFO     evaluating now!
2024-09-06 17:12:35 INFO     Epoch [37/200] train_loss: 1.0209, val_loss: 1.4697, lr: 0.003000, 9.82s
2024-09-06 17:12:44 INFO     epoch complete!
2024-09-06 17:12:44 INFO     evaluating now!
2024-09-06 17:12:45 INFO     Epoch [38/200] train_loss: 1.0200, val_loss: 1.4735, lr: 0.003000, 9.85s
2024-09-06 17:12:54 INFO     epoch complete!
2024-09-06 17:12:54 INFO     evaluating now!
2024-09-06 17:12:55 INFO     Epoch [39/200] train_loss: 1.0189, val_loss: 1.4637, lr: 0.003000, 9.82s
2024-09-06 17:12:55 INFO     Saved model at 39
2024-09-06 17:12:55 INFO     Val loss decrease from 1.4643 to 1.4637, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch39.tar
2024-09-06 17:13:04 INFO     epoch complete!
2024-09-06 17:13:04 INFO     evaluating now!
2024-09-06 17:13:05 INFO     Epoch [40/200] train_loss: 1.0216, val_loss: 1.4641, lr: 0.003000, 9.90s
2024-09-06 17:13:14 INFO     epoch complete!
2024-09-06 17:13:14 INFO     evaluating now!
2024-09-06 17:13:15 INFO     Epoch [41/200] train_loss: 1.0137, val_loss: 1.4733, lr: 0.003000, 9.84s
2024-09-06 17:13:24 INFO     epoch complete!
2024-09-06 17:13:24 INFO     evaluating now!
2024-09-06 17:13:24 INFO     Epoch [42/200] train_loss: 1.0113, val_loss: 1.4774, lr: 0.003000, 9.78s
2024-09-06 17:13:33 INFO     epoch complete!
2024-09-06 17:13:33 INFO     evaluating now!
2024-09-06 17:13:34 INFO     Epoch [43/200] train_loss: 1.0098, val_loss: 1.4707, lr: 0.003000, 9.81s
2024-09-06 17:13:43 INFO     epoch complete!
2024-09-06 17:13:43 INFO     evaluating now!
2024-09-06 17:13:44 INFO     Epoch [44/200] train_loss: 1.0099, val_loss: 1.4755, lr: 0.003000, 9.81s
2024-09-06 17:13:53 INFO     epoch complete!
2024-09-06 17:13:53 INFO     evaluating now!
2024-09-06 17:13:54 INFO     Epoch [45/200] train_loss: 1.0069, val_loss: 1.4634, lr: 0.003000, 9.79s
2024-09-06 17:13:54 INFO     Saved model at 45
2024-09-06 17:13:54 INFO     Val loss decrease from 1.4637 to 1.4634, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch45.tar
2024-09-06 17:14:03 INFO     epoch complete!
2024-09-06 17:14:03 INFO     evaluating now!
2024-09-06 17:14:04 INFO     Epoch [46/200] train_loss: 1.0038, val_loss: 1.4730, lr: 0.003000, 9.91s
2024-09-06 17:14:13 INFO     epoch complete!
2024-09-06 17:14:13 INFO     evaluating now!
2024-09-06 17:14:14 INFO     Epoch [47/200] train_loss: 1.0035, val_loss: 1.4762, lr: 0.003000, 9.87s
2024-09-06 17:14:23 INFO     epoch complete!
2024-09-06 17:14:23 INFO     evaluating now!
2024-09-06 17:14:23 INFO     Epoch [48/200] train_loss: 1.0033, val_loss: 1.4791, lr: 0.003000, 9.94s
2024-09-06 17:14:33 INFO     epoch complete!
2024-09-06 17:14:33 INFO     evaluating now!
2024-09-06 17:14:33 INFO     Epoch [49/200] train_loss: 1.0014, val_loss: 1.4574, lr: 0.003000, 9.80s
2024-09-06 17:14:33 INFO     Saved model at 49
2024-09-06 17:14:33 INFO     Val loss decrease from 1.4634 to 1.4574, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch49.tar
2024-09-06 17:14:42 INFO     epoch complete!
2024-09-06 17:14:42 INFO     evaluating now!
2024-09-06 17:14:43 INFO     Epoch [50/200] train_loss: 0.9995, val_loss: 1.4655, lr: 0.003000, 9.81s
2024-09-06 17:14:52 INFO     epoch complete!
2024-09-06 17:14:52 INFO     evaluating now!
2024-09-06 17:14:53 INFO     Epoch [51/200] train_loss: 1.0019, val_loss: 1.4796, lr: 0.003000, 9.80s
2024-09-06 17:15:02 INFO     epoch complete!
2024-09-06 17:15:02 INFO     evaluating now!
2024-09-06 17:15:03 INFO     Epoch [52/200] train_loss: 0.9997, val_loss: 1.4634, lr: 0.003000, 9.81s
2024-09-06 17:15:12 INFO     epoch complete!
2024-09-06 17:15:12 INFO     evaluating now!
2024-09-06 17:15:12 INFO     Epoch [53/200] train_loss: 0.9944, val_loss: 1.4719, lr: 0.003000, 9.78s
2024-09-06 17:15:22 INFO     epoch complete!
2024-09-06 17:15:22 INFO     evaluating now!
2024-09-06 17:15:22 INFO     Epoch [54/200] train_loss: 0.9916, val_loss: 1.4748, lr: 0.003000, 9.82s
2024-09-06 17:15:31 INFO     epoch complete!
2024-09-06 17:15:31 INFO     evaluating now!
2024-09-06 17:15:32 INFO     Epoch [55/200] train_loss: 0.9909, val_loss: 1.4668, lr: 0.003000, 9.83s
2024-09-06 17:15:41 INFO     epoch complete!
2024-09-06 17:15:41 INFO     evaluating now!
2024-09-06 17:15:42 INFO     Epoch [56/200] train_loss: 0.9889, val_loss: 1.4780, lr: 0.003000, 9.94s
2024-09-06 17:15:51 INFO     epoch complete!
2024-09-06 17:15:51 INFO     evaluating now!
2024-09-06 17:15:52 INFO     Epoch [57/200] train_loss: 0.9873, val_loss: 1.4798, lr: 0.003000, 9.84s
2024-09-06 17:16:01 INFO     epoch complete!
2024-09-06 17:16:01 INFO     evaluating now!
2024-09-06 17:16:02 INFO     Epoch [58/200] train_loss: 0.9862, val_loss: 1.4723, lr: 0.003000, 9.83s
2024-09-06 17:16:11 INFO     epoch complete!
2024-09-06 17:16:11 INFO     evaluating now!
2024-09-06 17:16:12 INFO     Epoch [59/200] train_loss: 0.9886, val_loss: 1.4831, lr: 0.003000, 10.14s
2024-09-06 17:16:21 INFO     epoch complete!
2024-09-06 17:16:21 INFO     evaluating now!
2024-09-06 17:16:22 INFO     Epoch [60/200] train_loss: 0.9854, val_loss: 1.4691, lr: 0.003000, 9.89s
2024-09-06 17:16:31 INFO     epoch complete!
2024-09-06 17:16:31 INFO     evaluating now!
2024-09-06 17:16:32 INFO     Epoch [61/200] train_loss: 0.9822, val_loss: 1.4813, lr: 0.003000, 9.87s
2024-09-06 17:16:41 INFO     epoch complete!
2024-09-06 17:16:41 INFO     evaluating now!
2024-09-06 17:16:41 INFO     Epoch [62/200] train_loss: 0.9798, val_loss: 1.4786, lr: 0.003000, 9.81s
2024-09-06 17:16:51 INFO     epoch complete!
2024-09-06 17:16:51 INFO     evaluating now!
2024-09-06 17:16:51 INFO     Epoch [63/200] train_loss: 0.9803, val_loss: 1.4816, lr: 0.003000, 9.90s
2024-09-06 17:17:00 INFO     epoch complete!
2024-09-06 17:17:00 INFO     evaluating now!
2024-09-06 17:17:01 INFO     Epoch [64/200] train_loss: 0.9792, val_loss: 1.5033, lr: 0.003000, 9.84s
2024-09-06 17:17:01 WARNING  Early stopping at epoch: 64
2024-09-06 17:17:01 INFO     Trained totally 65 epochs, average train time is 9.154s, average eval time is 0.715s
2024-09-06 17:17:01 INFO     Loaded model at 49
2024-09-06 17:17:01 INFO     Saved model at ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406.m
2024-09-06 17:17:01 INFO     Start evaluating ...
2024-09-06 17:17:04 INFO     Note that you select the single mode to evaluate!
2024-09-06 17:17:04 INFO     Evaluate result is saved at ./libcity/cache/3015/evaluate_cache\2024_09_06_17_17_04_AGCRN_NYCTaxi20200406.csv
2024-09-06 17:17:04 INFO     
         MAE      RMSE
1   1.354813  2.518134
2   1.356537  2.497528
3   1.349826  2.452491
4   1.362674  2.499805
5   1.362825  2.518435
6   1.367048  2.523139
7   1.374897  2.549584
8   1.386034  2.591251
9   1.401526  2.654662
10  1.418770  2.708495
11  1.436572  2.784847
12  1.467409  2.902073
2024-09-06 17:17:05 INFO     ----------------------------------------------------------------------------
2024-09-06 17:17:05 INFO     # 1, Kownledge Graph Embedding: GIE, Experiment ids: 3016
2024-09-06 17:17:05 INFO     ----------------------------------------------------------------------------
2024-09-06 17:17:05 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=NYCTaxi20200406, exp_id=3015
2024-09-06 17:17:05 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'NYCTaxi20200406', 'saved_model': True, 'train': True, 'exp_id': 3015, 'embedding_model': 'GIE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['NYCTaxi20200406'], 'geo_file': 'NYCTaxi20200406', 'rel_file': 'NYCTaxi20200406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-06 17:17:05 INFO     Loaded file NYCTaxi20200406.geo, num_nodes=260
2024-09-06 17:17:05 INFO     set_weight_link_or_dist: dist
2024-09-06 17:17:05 INFO     init_weight_inf_or_zero: inf
2024-09-06 17:17:05 INFO     Loaded file NYCTaxi20200406.rel, shape=(260, 260)
2024-09-06 17:17:05 INFO     Start Calculate the weight by Gauss kernel!
2024-09-06 17:17:05 INFO     Loading file NYCTaxi20200406.dyna
2024-09-06 17:17:05 INFO     Loaded file NYCTaxi20200406.dyna, shape=(4368, 260, 2)
2024-09-06 17:17:14 INFO     Dataset created
2024-09-06 17:17:14 INFO     x shape: (4345, 12, 260, 34), y shape: (4345, 12, 260, 34)
2024-09-06 17:17:14 INFO     train	x: (3042, 12, 260, 34), y: (3042, 12, 260, 34)
2024-09-06 17:17:14 INFO     eval	x: (434, 12, 260, 34), y: (434, 12, 260, 34)
2024-09-06 17:17:14 INFO     test	x: (869, 12, 260, 34), y: (869, 12, 260, 34)
2024-09-06 17:17:14 INFO     StandardScaler mean: 0.7727858064026704, std: 2.3026817046377195
2024-09-06 17:17:15 INFO     NormalScaler max: 0.659603814907769
2024-09-06 17:17:21 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-06 17:17:21 INFO     node_embeddings	torch.Size([260, 10])	cuda:0	True
2024-09-06 17:17:21 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-06 17:17:21 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-06 17:17:21 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-06 17:17:21 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-06 17:17:21 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-06 17:17:21 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-06 17:17:21 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-06 17:17:21 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-06 17:17:21 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-06 17:17:21 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-06 17:17:21 INFO     Total parameter numbers: 875840
2024-09-06 17:17:21 INFO     You select `adam` optimizer.
2024-09-06 17:17:21 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-06 17:17:21 INFO     Start training ...
2024-09-06 17:17:21 INFO     num_batches:48
2024-09-06 17:17:30 INFO     epoch complete!
2024-09-06 17:17:30 INFO     evaluating now!
2024-09-06 17:17:31 INFO     Epoch [0/200] train_loss: 1.8608, val_loss: 2.3104, lr: 0.003000, 10.24s
2024-09-06 17:17:31 INFO     Saved model at 0
2024-09-06 17:17:31 INFO     Val loss decrease from inf to 2.3104, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch0.tar
2024-09-06 17:17:40 INFO     epoch complete!
2024-09-06 17:17:40 INFO     evaluating now!
2024-09-06 17:17:41 INFO     Epoch [1/200] train_loss: 1.4545, val_loss: 1.9929, lr: 0.003000, 9.78s
2024-09-06 17:17:41 INFO     Saved model at 1
2024-09-06 17:17:41 INFO     Val loss decrease from 2.3104 to 1.9929, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch1.tar
2024-09-06 17:17:50 INFO     epoch complete!
2024-09-06 17:17:50 INFO     evaluating now!
2024-09-06 17:17:51 INFO     Epoch [2/200] train_loss: 1.3182, val_loss: 1.8312, lr: 0.003000, 9.78s
2024-09-06 17:17:51 INFO     Saved model at 2
2024-09-06 17:17:51 INFO     Val loss decrease from 1.9929 to 1.8312, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch2.tar
2024-09-06 17:18:00 INFO     epoch complete!
2024-09-06 17:18:00 INFO     evaluating now!
2024-09-06 17:18:01 INFO     Epoch [3/200] train_loss: 1.2707, val_loss: 1.7559, lr: 0.003000, 9.79s
2024-09-06 17:18:01 INFO     Saved model at 3
2024-09-06 17:18:01 INFO     Val loss decrease from 1.8312 to 1.7559, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch3.tar
2024-09-06 17:18:10 INFO     epoch complete!
2024-09-06 17:18:10 INFO     evaluating now!
2024-09-06 17:18:10 INFO     Epoch [4/200] train_loss: 1.2336, val_loss: 1.7082, lr: 0.003000, 9.82s
2024-09-06 17:18:10 INFO     Saved model at 4
2024-09-06 17:18:10 INFO     Val loss decrease from 1.7559 to 1.7082, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch4.tar
2024-09-06 17:18:19 INFO     epoch complete!
2024-09-06 17:18:19 INFO     evaluating now!
2024-09-06 17:18:20 INFO     Epoch [5/200] train_loss: 1.2080, val_loss: 1.6892, lr: 0.003000, 9.78s
2024-09-06 17:18:20 INFO     Saved model at 5
2024-09-06 17:18:20 INFO     Val loss decrease from 1.7082 to 1.6892, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch5.tar
2024-09-06 17:18:29 INFO     epoch complete!
2024-09-06 17:18:29 INFO     evaluating now!
2024-09-06 17:18:30 INFO     Epoch [6/200] train_loss: 1.1881, val_loss: 1.6562, lr: 0.003000, 9.82s
2024-09-06 17:18:30 INFO     Saved model at 6
2024-09-06 17:18:30 INFO     Val loss decrease from 1.6892 to 1.6562, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch6.tar
2024-09-06 17:18:39 INFO     epoch complete!
2024-09-06 17:18:39 INFO     evaluating now!
2024-09-06 17:18:40 INFO     Epoch [7/200] train_loss: 1.1745, val_loss: 1.6459, lr: 0.003000, 9.81s
2024-09-06 17:18:40 INFO     Saved model at 7
2024-09-06 17:18:40 INFO     Val loss decrease from 1.6562 to 1.6459, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch7.tar
2024-09-06 17:18:49 INFO     epoch complete!
2024-09-06 17:18:49 INFO     evaluating now!
2024-09-06 17:18:50 INFO     Epoch [8/200] train_loss: 1.1638, val_loss: 1.5935, lr: 0.003000, 9.81s
2024-09-06 17:18:50 INFO     Saved model at 8
2024-09-06 17:18:50 INFO     Val loss decrease from 1.6459 to 1.5935, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch8.tar
2024-09-06 17:18:59 INFO     epoch complete!
2024-09-06 17:18:59 INFO     evaluating now!
2024-09-06 17:18:59 INFO     Epoch [9/200] train_loss: 1.1537, val_loss: 1.5754, lr: 0.003000, 9.79s
2024-09-06 17:18:59 INFO     Saved model at 9
2024-09-06 17:18:59 INFO     Val loss decrease from 1.5935 to 1.5754, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch9.tar
2024-09-06 17:19:09 INFO     epoch complete!
2024-09-06 17:19:09 INFO     evaluating now!
2024-09-06 17:19:09 INFO     Epoch [10/200] train_loss: 1.1401, val_loss: 1.5784, lr: 0.003000, 9.84s
2024-09-06 17:19:19 INFO     epoch complete!
2024-09-06 17:19:19 INFO     evaluating now!
2024-09-06 17:19:19 INFO     Epoch [11/200] train_loss: 1.1376, val_loss: 1.6177, lr: 0.003000, 10.00s
2024-09-06 17:19:29 INFO     epoch complete!
2024-09-06 17:19:29 INFO     evaluating now!
2024-09-06 17:19:29 INFO     Epoch [12/200] train_loss: 1.1339, val_loss: 1.5459, lr: 0.003000, 10.05s
2024-09-06 17:19:29 INFO     Saved model at 12
2024-09-06 17:19:29 INFO     Val loss decrease from 1.5754 to 1.5459, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch12.tar
2024-09-06 17:19:39 INFO     epoch complete!
2024-09-06 17:19:39 INFO     evaluating now!
2024-09-06 17:19:40 INFO     Epoch [13/200] train_loss: 1.1216, val_loss: 1.5351, lr: 0.003000, 10.37s
2024-09-06 17:19:40 INFO     Saved model at 13
2024-09-06 17:19:40 INFO     Val loss decrease from 1.5459 to 1.5351, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch13.tar
2024-09-06 17:19:49 INFO     epoch complete!
2024-09-06 17:19:49 INFO     evaluating now!
2024-09-06 17:19:50 INFO     Epoch [14/200] train_loss: 1.1205, val_loss: 1.5230, lr: 0.003000, 10.04s
2024-09-06 17:19:50 INFO     Saved model at 14
2024-09-06 17:19:50 INFO     Val loss decrease from 1.5351 to 1.5230, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch14.tar
2024-09-06 17:19:59 INFO     epoch complete!
2024-09-06 17:19:59 INFO     evaluating now!
2024-09-06 17:20:00 INFO     Epoch [15/200] train_loss: 1.1124, val_loss: 1.5262, lr: 0.003000, 9.96s
2024-09-06 17:20:09 INFO     epoch complete!
2024-09-06 17:20:09 INFO     evaluating now!
2024-09-06 17:20:10 INFO     Epoch [16/200] train_loss: 1.1063, val_loss: 1.5203, lr: 0.003000, 10.39s
2024-09-06 17:20:10 INFO     Saved model at 16
2024-09-06 17:20:10 INFO     Val loss decrease from 1.5230 to 1.5203, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch16.tar
2024-09-06 17:20:19 INFO     epoch complete!
2024-09-06 17:20:19 INFO     evaluating now!
2024-09-06 17:20:20 INFO     Epoch [17/200] train_loss: 1.1052, val_loss: 1.5197, lr: 0.003000, 9.94s
2024-09-06 17:20:20 INFO     Saved model at 17
2024-09-06 17:20:20 INFO     Val loss decrease from 1.5203 to 1.5197, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch17.tar
2024-09-06 17:20:29 INFO     epoch complete!
2024-09-06 17:20:29 INFO     evaluating now!
2024-09-06 17:20:30 INFO     Epoch [18/200] train_loss: 1.0984, val_loss: 1.5001, lr: 0.003000, 10.13s
2024-09-06 17:20:30 INFO     Saved model at 18
2024-09-06 17:20:30 INFO     Val loss decrease from 1.5197 to 1.5001, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch18.tar
2024-09-06 17:20:40 INFO     epoch complete!
2024-09-06 17:20:40 INFO     evaluating now!
2024-09-06 17:20:40 INFO     Epoch [19/200] train_loss: 1.0905, val_loss: 1.5009, lr: 0.003000, 10.15s
2024-09-06 17:20:50 INFO     epoch complete!
2024-09-06 17:20:50 INFO     evaluating now!
2024-09-06 17:20:51 INFO     Epoch [20/200] train_loss: 1.0891, val_loss: 1.5259, lr: 0.003000, 10.23s
2024-09-06 17:21:00 INFO     epoch complete!
2024-09-06 17:21:00 INFO     evaluating now!
2024-09-06 17:21:00 INFO     Epoch [21/200] train_loss: 1.0803, val_loss: 1.5096, lr: 0.003000, 9.79s
2024-09-06 17:21:10 INFO     epoch complete!
2024-09-06 17:21:10 INFO     evaluating now!
2024-09-06 17:21:10 INFO     Epoch [22/200] train_loss: 1.0738, val_loss: 1.4845, lr: 0.003000, 9.82s
2024-09-06 17:21:10 INFO     Saved model at 22
2024-09-06 17:21:10 INFO     Val loss decrease from 1.5001 to 1.4845, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch22.tar
2024-09-06 17:21:19 INFO     epoch complete!
2024-09-06 17:21:19 INFO     evaluating now!
2024-09-06 17:21:20 INFO     Epoch [23/200] train_loss: 1.0696, val_loss: 1.4706, lr: 0.003000, 9.81s
2024-09-06 17:21:20 INFO     Saved model at 23
2024-09-06 17:21:20 INFO     Val loss decrease from 1.4845 to 1.4706, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch23.tar
2024-09-06 17:21:29 INFO     epoch complete!
2024-09-06 17:21:29 INFO     evaluating now!
2024-09-06 17:21:30 INFO     Epoch [24/200] train_loss: 1.0651, val_loss: 1.4934, lr: 0.003000, 9.87s
2024-09-06 17:21:39 INFO     epoch complete!
2024-09-06 17:21:39 INFO     evaluating now!
2024-09-06 17:21:40 INFO     Epoch [25/200] train_loss: 1.0582, val_loss: 1.4584, lr: 0.003000, 9.97s
2024-09-06 17:21:40 INFO     Saved model at 25
2024-09-06 17:21:40 INFO     Val loss decrease from 1.4706 to 1.4584, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch25.tar
2024-09-06 17:21:49 INFO     epoch complete!
2024-09-06 17:21:49 INFO     evaluating now!
2024-09-06 17:21:50 INFO     Epoch [26/200] train_loss: 1.0580, val_loss: 1.5016, lr: 0.003000, 9.94s
2024-09-06 17:21:59 INFO     epoch complete!
2024-09-06 17:21:59 INFO     evaluating now!
2024-09-06 17:22:00 INFO     Epoch [27/200] train_loss: 1.0538, val_loss: 1.4890, lr: 0.003000, 9.82s
2024-09-06 17:22:09 INFO     epoch complete!
2024-09-06 17:22:09 INFO     evaluating now!
2024-09-06 17:22:10 INFO     Epoch [28/200] train_loss: 1.0483, val_loss: 1.4866, lr: 0.003000, 9.82s
2024-09-06 17:22:19 INFO     epoch complete!
2024-09-06 17:22:19 INFO     evaluating now!
2024-09-06 17:22:19 INFO     Epoch [29/200] train_loss: 1.0451, val_loss: 1.4876, lr: 0.003000, 9.79s
2024-09-06 17:22:28 INFO     epoch complete!
2024-09-06 17:22:28 INFO     evaluating now!
2024-09-06 17:22:29 INFO     Epoch [30/200] train_loss: 1.0422, val_loss: 1.4810, lr: 0.003000, 9.80s
2024-09-06 17:22:38 INFO     epoch complete!
2024-09-06 17:22:38 INFO     evaluating now!
2024-09-06 17:22:39 INFO     Epoch [31/200] train_loss: 1.0400, val_loss: 1.4830, lr: 0.003000, 9.79s
2024-09-06 17:22:48 INFO     epoch complete!
2024-09-06 17:22:48 INFO     evaluating now!
2024-09-06 17:22:49 INFO     Epoch [32/200] train_loss: 1.0362, val_loss: 1.4884, lr: 0.003000, 9.79s
2024-09-06 17:22:58 INFO     epoch complete!
2024-09-06 17:22:58 INFO     evaluating now!
2024-09-06 17:22:58 INFO     Epoch [33/200] train_loss: 1.0343, val_loss: 1.4802, lr: 0.003000, 9.80s
2024-09-06 17:23:08 INFO     epoch complete!
2024-09-06 17:23:08 INFO     evaluating now!
2024-09-06 17:23:08 INFO     Epoch [34/200] train_loss: 1.0322, val_loss: 1.4790, lr: 0.003000, 9.77s
2024-09-06 17:23:17 INFO     epoch complete!
2024-09-06 17:23:17 INFO     evaluating now!
2024-09-06 17:23:18 INFO     Epoch [35/200] train_loss: 1.0303, val_loss: 1.4788, lr: 0.003000, 9.81s
2024-09-06 17:23:27 INFO     epoch complete!
2024-09-06 17:23:27 INFO     evaluating now!
2024-09-06 17:23:28 INFO     Epoch [36/200] train_loss: 1.0285, val_loss: 1.4889, lr: 0.003000, 9.80s
2024-09-06 17:23:37 INFO     epoch complete!
2024-09-06 17:23:37 INFO     evaluating now!
2024-09-06 17:23:38 INFO     Epoch [37/200] train_loss: 1.0305, val_loss: 1.4756, lr: 0.003000, 9.79s
2024-09-06 17:23:47 INFO     epoch complete!
2024-09-06 17:23:47 INFO     evaluating now!
2024-09-06 17:23:47 INFO     Epoch [38/200] train_loss: 1.0292, val_loss: 1.4734, lr: 0.003000, 9.81s
2024-09-06 17:23:57 INFO     epoch complete!
2024-09-06 17:23:57 INFO     evaluating now!
2024-09-06 17:23:57 INFO     Epoch [39/200] train_loss: 1.0219, val_loss: 1.4687, lr: 0.003000, 9.81s
2024-09-06 17:24:06 INFO     epoch complete!
2024-09-06 17:24:06 INFO     evaluating now!
2024-09-06 17:24:07 INFO     Epoch [40/200] train_loss: 1.0205, val_loss: 1.4818, lr: 0.003000, 9.76s
2024-09-06 17:24:07 WARNING  Early stopping at epoch: 40
2024-09-06 17:24:07 INFO     Trained totally 41 epochs, average train time is 9.180s, average eval time is 0.719s
2024-09-06 17:24:07 INFO     Loaded model at 25
2024-09-06 17:24:07 INFO     Saved model at ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406.m
2024-09-06 17:24:07 INFO     Start evaluating ...
2024-09-06 17:24:10 INFO     Note that you select the single mode to evaluate!
2024-09-06 17:24:10 INFO     Evaluate result is saved at ./libcity/cache/3015/evaluate_cache\2024_09_06_17_24_10_AGCRN_NYCTaxi20200406.csv
2024-09-06 17:24:10 INFO     
         MAE      RMSE
1   1.333526  2.436571
2   1.332458  2.421805
3   1.325812  2.414228
4   1.334340  2.458593
5   1.353183  2.494109
6   1.363135  2.525157
7   1.371914  2.560700
8   1.382843  2.584657
9   1.390830  2.623672
10  1.400000  2.676534
11  1.414947  2.748160
12  1.448149  2.845552
2024-09-06 17:24:11 INFO     ----------------------------------------------------------------------------
2024-09-06 17:24:11 INFO     # 2, Kownledge Graph Embedding: GIE, Experiment ids: 3017
2024-09-06 17:24:11 INFO     ----------------------------------------------------------------------------
2024-09-06 17:24:11 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=NYCTaxi20200406, exp_id=3015
2024-09-06 17:24:11 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'NYCTaxi20200406', 'saved_model': True, 'train': True, 'exp_id': 3015, 'embedding_model': 'GIE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['NYCTaxi20200406'], 'geo_file': 'NYCTaxi20200406', 'rel_file': 'NYCTaxi20200406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-06 17:24:11 INFO     Loaded file NYCTaxi20200406.geo, num_nodes=260
2024-09-06 17:24:11 INFO     set_weight_link_or_dist: dist
2024-09-06 17:24:11 INFO     init_weight_inf_or_zero: inf
2024-09-06 17:24:11 INFO     Loaded file NYCTaxi20200406.rel, shape=(260, 260)
2024-09-06 17:24:11 INFO     Start Calculate the weight by Gauss kernel!
2024-09-06 17:24:11 INFO     Loading file NYCTaxi20200406.dyna
2024-09-06 17:24:11 INFO     Loaded file NYCTaxi20200406.dyna, shape=(4368, 260, 2)
2024-09-06 17:24:16 INFO     Dataset created
2024-09-06 17:24:16 INFO     x shape: (4345, 12, 260, 34), y shape: (4345, 12, 260, 34)
2024-09-06 17:24:16 INFO     train	x: (3042, 12, 260, 34), y: (3042, 12, 260, 34)
2024-09-06 17:24:16 INFO     eval	x: (434, 12, 260, 34), y: (434, 12, 260, 34)
2024-09-06 17:24:16 INFO     test	x: (869, 12, 260, 34), y: (869, 12, 260, 34)
2024-09-06 17:24:16 INFO     StandardScaler mean: 0.7727858064026704, std: 2.3026817046377195
2024-09-06 17:24:17 INFO     NormalScaler max: 0.659603814907769
2024-09-06 17:24:23 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-06 17:24:23 INFO     node_embeddings	torch.Size([260, 10])	cuda:0	True
2024-09-06 17:24:23 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-06 17:24:23 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-06 17:24:23 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-06 17:24:23 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-06 17:24:23 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-06 17:24:23 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-06 17:24:23 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-06 17:24:23 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-06 17:24:23 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-06 17:24:23 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-06 17:24:23 INFO     Total parameter numbers: 875840
2024-09-06 17:24:23 INFO     You select `adam` optimizer.
2024-09-06 17:24:23 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-06 17:24:23 INFO     Start training ...
2024-09-06 17:24:23 INFO     num_batches:48
2024-09-06 17:24:32 INFO     epoch complete!
2024-09-06 17:24:32 INFO     evaluating now!
2024-09-06 17:24:33 INFO     Epoch [0/200] train_loss: 1.8680, val_loss: 2.3575, lr: 0.003000, 10.16s
2024-09-06 17:24:33 INFO     Saved model at 0
2024-09-06 17:24:33 INFO     Val loss decrease from inf to 2.3575, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch0.tar
2024-09-06 17:24:42 INFO     epoch complete!
2024-09-06 17:24:42 INFO     evaluating now!
2024-09-06 17:24:43 INFO     Epoch [1/200] train_loss: 1.4667, val_loss: 1.9753, lr: 0.003000, 9.80s
2024-09-06 17:24:43 INFO     Saved model at 1
2024-09-06 17:24:43 INFO     Val loss decrease from 2.3575 to 1.9753, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch1.tar
2024-09-06 17:24:52 INFO     epoch complete!
2024-09-06 17:24:52 INFO     evaluating now!
2024-09-06 17:24:53 INFO     Epoch [2/200] train_loss: 1.3307, val_loss: 1.8781, lr: 0.003000, 9.78s
2024-09-06 17:24:53 INFO     Saved model at 2
2024-09-06 17:24:53 INFO     Val loss decrease from 1.9753 to 1.8781, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch2.tar
2024-09-06 17:25:02 INFO     epoch complete!
2024-09-06 17:25:02 INFO     evaluating now!
2024-09-06 17:25:02 INFO     Epoch [3/200] train_loss: 1.2694, val_loss: 1.7777, lr: 0.003000, 9.80s
2024-09-06 17:25:02 INFO     Saved model at 3
2024-09-06 17:25:02 INFO     Val loss decrease from 1.8781 to 1.7777, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch3.tar
2024-09-06 17:25:11 INFO     epoch complete!
2024-09-06 17:25:11 INFO     evaluating now!
2024-09-06 17:25:12 INFO     Epoch [4/200] train_loss: 1.2259, val_loss: 1.7087, lr: 0.003000, 9.78s
2024-09-06 17:25:12 INFO     Saved model at 4
2024-09-06 17:25:12 INFO     Val loss decrease from 1.7777 to 1.7087, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch4.tar
2024-09-06 17:25:21 INFO     epoch complete!
2024-09-06 17:25:21 INFO     evaluating now!
2024-09-06 17:25:22 INFO     Epoch [5/200] train_loss: 1.1973, val_loss: 1.6704, lr: 0.003000, 9.80s
2024-09-06 17:25:22 INFO     Saved model at 5
2024-09-06 17:25:22 INFO     Val loss decrease from 1.7087 to 1.6704, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch5.tar
2024-09-06 17:25:31 INFO     epoch complete!
2024-09-06 17:25:31 INFO     evaluating now!
2024-09-06 17:25:32 INFO     Epoch [6/200] train_loss: 1.1849, val_loss: 1.6455, lr: 0.003000, 9.83s
2024-09-06 17:25:32 INFO     Saved model at 6
2024-09-06 17:25:32 INFO     Val loss decrease from 1.6704 to 1.6455, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch6.tar
2024-09-06 17:25:41 INFO     epoch complete!
2024-09-06 17:25:41 INFO     evaluating now!
2024-09-06 17:25:42 INFO     Epoch [7/200] train_loss: 1.1625, val_loss: 1.5978, lr: 0.003000, 9.81s
2024-09-06 17:25:42 INFO     Saved model at 7
2024-09-06 17:25:42 INFO     Val loss decrease from 1.6455 to 1.5978, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch7.tar
2024-09-06 17:25:51 INFO     epoch complete!
2024-09-06 17:25:51 INFO     evaluating now!
2024-09-06 17:25:51 INFO     Epoch [8/200] train_loss: 1.1483, val_loss: 1.5650, lr: 0.003000, 9.79s
2024-09-06 17:25:51 INFO     Saved model at 8
2024-09-06 17:25:51 INFO     Val loss decrease from 1.5978 to 1.5650, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch8.tar
2024-09-06 17:26:01 INFO     epoch complete!
2024-09-06 17:26:01 INFO     evaluating now!
2024-09-06 17:26:01 INFO     Epoch [9/200] train_loss: 1.1406, val_loss: 1.5435, lr: 0.003000, 9.83s
2024-09-06 17:26:01 INFO     Saved model at 9
2024-09-06 17:26:01 INFO     Val loss decrease from 1.5650 to 1.5435, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch9.tar
2024-09-06 17:26:10 INFO     epoch complete!
2024-09-06 17:26:10 INFO     evaluating now!
2024-09-06 17:26:11 INFO     Epoch [10/200] train_loss: 1.1340, val_loss: 1.5722, lr: 0.003000, 9.81s
2024-09-06 17:26:20 INFO     epoch complete!
2024-09-06 17:26:20 INFO     evaluating now!
2024-09-06 17:26:21 INFO     Epoch [11/200] train_loss: 1.1275, val_loss: 1.5444, lr: 0.003000, 9.84s
2024-09-06 17:26:30 INFO     epoch complete!
2024-09-06 17:26:30 INFO     evaluating now!
2024-09-06 17:26:31 INFO     Epoch [12/200] train_loss: 1.1157, val_loss: 1.5270, lr: 0.003000, 9.83s
2024-09-06 17:26:31 INFO     Saved model at 12
2024-09-06 17:26:31 INFO     Val loss decrease from 1.5435 to 1.5270, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch12.tar
2024-09-06 17:26:40 INFO     epoch complete!
2024-09-06 17:26:40 INFO     evaluating now!
2024-09-06 17:26:41 INFO     Epoch [13/200] train_loss: 1.1151, val_loss: 1.5142, lr: 0.003000, 9.79s
2024-09-06 17:26:41 INFO     Saved model at 13
2024-09-06 17:26:41 INFO     Val loss decrease from 1.5270 to 1.5142, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch13.tar
2024-09-06 17:26:50 INFO     epoch complete!
2024-09-06 17:26:50 INFO     evaluating now!
2024-09-06 17:26:50 INFO     Epoch [14/200] train_loss: 1.1026, val_loss: 1.4963, lr: 0.003000, 9.80s
2024-09-06 17:26:50 INFO     Saved model at 14
2024-09-06 17:26:50 INFO     Val loss decrease from 1.5142 to 1.4963, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch14.tar
2024-09-06 17:27:00 INFO     epoch complete!
2024-09-06 17:27:00 INFO     evaluating now!
2024-09-06 17:27:00 INFO     Epoch [15/200] train_loss: 1.1046, val_loss: 1.5177, lr: 0.003000, 9.85s
2024-09-06 17:27:09 INFO     epoch complete!
2024-09-06 17:27:09 INFO     evaluating now!
2024-09-06 17:27:10 INFO     Epoch [16/200] train_loss: 1.0962, val_loss: 1.4937, lr: 0.003000, 9.73s
2024-09-06 17:27:10 INFO     Saved model at 16
2024-09-06 17:27:10 INFO     Val loss decrease from 1.4963 to 1.4937, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch16.tar
2024-09-06 17:27:19 INFO     epoch complete!
2024-09-06 17:27:19 INFO     evaluating now!
2024-09-06 17:27:20 INFO     Epoch [17/200] train_loss: 1.0937, val_loss: 1.5152, lr: 0.003000, 9.85s
2024-09-06 17:27:29 INFO     epoch complete!
2024-09-06 17:27:29 INFO     evaluating now!
2024-09-06 17:27:30 INFO     Epoch [18/200] train_loss: 1.0850, val_loss: 1.4779, lr: 0.003000, 9.81s
2024-09-06 17:27:30 INFO     Saved model at 18
2024-09-06 17:27:30 INFO     Val loss decrease from 1.4937 to 1.4779, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch18.tar
2024-09-06 17:27:39 INFO     epoch complete!
2024-09-06 17:27:39 INFO     evaluating now!
2024-09-06 17:27:40 INFO     Epoch [19/200] train_loss: 1.0835, val_loss: 1.4946, lr: 0.003000, 9.78s
2024-09-06 17:27:49 INFO     epoch complete!
2024-09-06 17:27:49 INFO     evaluating now!
2024-09-06 17:27:49 INFO     Epoch [20/200] train_loss: 1.0783, val_loss: 1.4931, lr: 0.003000, 9.77s
2024-09-06 17:27:58 INFO     epoch complete!
2024-09-06 17:27:58 INFO     evaluating now!
2024-09-06 17:27:59 INFO     Epoch [21/200] train_loss: 1.0735, val_loss: 1.4897, lr: 0.003000, 10.00s
2024-09-06 17:28:09 INFO     epoch complete!
2024-09-06 17:28:09 INFO     evaluating now!
2024-09-06 17:28:09 INFO     Epoch [22/200] train_loss: 1.0665, val_loss: 1.4745, lr: 0.003000, 10.10s
2024-09-06 17:28:09 INFO     Saved model at 22
2024-09-06 17:28:09 INFO     Val loss decrease from 1.4779 to 1.4745, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch22.tar
2024-09-06 17:28:19 INFO     epoch complete!
2024-09-06 17:28:19 INFO     evaluating now!
2024-09-06 17:28:20 INFO     Epoch [23/200] train_loss: 1.0621, val_loss: 1.4606, lr: 0.003000, 10.62s
2024-09-06 17:28:20 INFO     Saved model at 23
2024-09-06 17:28:20 INFO     Val loss decrease from 1.4745 to 1.4606, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch23.tar
2024-09-06 17:28:29 INFO     epoch complete!
2024-09-06 17:28:29 INFO     evaluating now!
2024-09-06 17:28:30 INFO     Epoch [24/200] train_loss: 1.0605, val_loss: 1.4505, lr: 0.003000, 10.06s
2024-09-06 17:28:30 INFO     Saved model at 24
2024-09-06 17:28:30 INFO     Val loss decrease from 1.4606 to 1.4505, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch24.tar
2024-09-06 17:28:40 INFO     epoch complete!
2024-09-06 17:28:40 INFO     evaluating now!
2024-09-06 17:28:40 INFO     Epoch [25/200] train_loss: 1.0589, val_loss: 1.4416, lr: 0.003000, 10.13s
2024-09-06 17:28:40 INFO     Saved model at 25
2024-09-06 17:28:40 INFO     Val loss decrease from 1.4505 to 1.4416, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch25.tar
2024-09-06 17:28:49 INFO     epoch complete!
2024-09-06 17:28:49 INFO     evaluating now!
2024-09-06 17:28:50 INFO     Epoch [26/200] train_loss: 1.0548, val_loss: 1.4586, lr: 0.003000, 9.94s
2024-09-06 17:28:59 INFO     epoch complete!
2024-09-06 17:28:59 INFO     evaluating now!
2024-09-06 17:29:00 INFO     Epoch [27/200] train_loss: 1.0511, val_loss: 1.4753, lr: 0.003000, 10.00s
2024-09-06 17:29:10 INFO     epoch complete!
2024-09-06 17:29:10 INFO     evaluating now!
2024-09-06 17:29:10 INFO     Epoch [28/200] train_loss: 1.0512, val_loss: 1.4709, lr: 0.003000, 10.04s
2024-09-06 17:29:19 INFO     epoch complete!
2024-09-06 17:29:19 INFO     evaluating now!
2024-09-06 17:29:20 INFO     Epoch [29/200] train_loss: 1.0562, val_loss: 1.4566, lr: 0.003000, 9.93s
2024-09-06 17:29:29 INFO     epoch complete!
2024-09-06 17:29:29 INFO     evaluating now!
2024-09-06 17:29:30 INFO     Epoch [30/200] train_loss: 1.0464, val_loss: 1.4642, lr: 0.003000, 9.90s
2024-09-06 17:29:39 INFO     epoch complete!
2024-09-06 17:29:39 INFO     evaluating now!
2024-09-06 17:29:40 INFO     Epoch [31/200] train_loss: 1.0411, val_loss: 1.4569, lr: 0.003000, 9.92s
2024-09-06 17:29:49 INFO     epoch complete!
2024-09-06 17:29:49 INFO     evaluating now!
2024-09-06 17:29:50 INFO     Epoch [32/200] train_loss: 1.0395, val_loss: 1.4595, lr: 0.003000, 10.04s
2024-09-06 17:29:59 INFO     epoch complete!
2024-09-06 17:29:59 INFO     evaluating now!
2024-09-06 17:30:00 INFO     Epoch [33/200] train_loss: 1.0398, val_loss: 1.4644, lr: 0.003000, 9.82s
2024-09-06 17:30:09 INFO     epoch complete!
2024-09-06 17:30:09 INFO     evaluating now!
2024-09-06 17:30:10 INFO     Epoch [34/200] train_loss: 1.0353, val_loss: 1.4824, lr: 0.003000, 9.83s
2024-09-06 17:30:19 INFO     epoch complete!
2024-09-06 17:30:19 INFO     evaluating now!
2024-09-06 17:30:19 INFO     Epoch [35/200] train_loss: 1.0337, val_loss: 1.4702, lr: 0.003000, 9.76s
2024-09-06 17:30:29 INFO     epoch complete!
2024-09-06 17:30:29 INFO     evaluating now!
2024-09-06 17:30:29 INFO     Epoch [36/200] train_loss: 1.0306, val_loss: 1.4724, lr: 0.003000, 10.00s
2024-09-06 17:30:39 INFO     epoch complete!
2024-09-06 17:30:39 INFO     evaluating now!
2024-09-06 17:30:39 INFO     Epoch [37/200] train_loss: 1.0315, val_loss: 1.4734, lr: 0.003000, 9.89s
2024-09-06 17:30:48 INFO     epoch complete!
2024-09-06 17:30:48 INFO     evaluating now!
2024-09-06 17:30:49 INFO     Epoch [38/200] train_loss: 1.0280, val_loss: 1.4709, lr: 0.003000, 9.81s
2024-09-06 17:30:58 INFO     epoch complete!
2024-09-06 17:30:58 INFO     evaluating now!
2024-09-06 17:30:59 INFO     Epoch [39/200] train_loss: 1.0282, val_loss: 1.4487, lr: 0.003000, 9.88s
2024-09-06 17:31:08 INFO     epoch complete!
2024-09-06 17:31:08 INFO     evaluating now!
2024-09-06 17:31:09 INFO     Epoch [40/200] train_loss: 1.0268, val_loss: 1.4549, lr: 0.003000, 9.78s
2024-09-06 17:31:09 WARNING  Early stopping at epoch: 40
2024-09-06 17:31:09 INFO     Trained totally 41 epochs, average train time is 9.178s, average eval time is 0.717s
2024-09-06 17:31:09 INFO     Loaded model at 25
2024-09-06 17:31:09 INFO     Saved model at ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406.m
2024-09-06 17:31:09 INFO     Start evaluating ...
2024-09-06 17:31:12 INFO     Note that you select the single mode to evaluate!
2024-09-06 17:31:12 INFO     Evaluate result is saved at ./libcity/cache/3015/evaluate_cache\2024_09_06_17_31_12_AGCRN_NYCTaxi20200406.csv
2024-09-06 17:31:12 INFO     
         MAE      RMSE
1   1.337073  2.441073
2   1.336587  2.422106
3   1.330977  2.390479
4   1.338216  2.416562
5   1.342415  2.427739
6   1.346334  2.441813
7   1.355812  2.489805
8   1.368049  2.536171
9   1.397051  2.596504
10  1.405394  2.645418
11  1.429397  2.738390
12  1.452356  2.829923
2024-09-06 17:31:12 INFO     ----------------------------------------------------------------------------
2024-09-06 17:31:12 INFO     # 3, Kownledge Graph Embedding: GIE, Experiment ids: 3018
2024-09-06 17:31:12 INFO     ----------------------------------------------------------------------------
2024-09-06 17:31:12 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=NYCTaxi20200406, exp_id=3015
2024-09-06 17:31:12 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'NYCTaxi20200406', 'saved_model': True, 'train': True, 'exp_id': 3015, 'embedding_model': 'GIE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['NYCTaxi20200406'], 'geo_file': 'NYCTaxi20200406', 'rel_file': 'NYCTaxi20200406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-06 17:31:12 INFO     Loaded file NYCTaxi20200406.geo, num_nodes=260
2024-09-06 17:31:12 INFO     set_weight_link_or_dist: dist
2024-09-06 17:31:12 INFO     init_weight_inf_or_zero: inf
2024-09-06 17:31:12 INFO     Loaded file NYCTaxi20200406.rel, shape=(260, 260)
2024-09-06 17:31:12 INFO     Start Calculate the weight by Gauss kernel!
2024-09-06 17:31:12 INFO     Loading file NYCTaxi20200406.dyna
2024-09-06 17:31:13 INFO     Loaded file NYCTaxi20200406.dyna, shape=(4368, 260, 2)
2024-09-06 17:31:18 INFO     Dataset created
2024-09-06 17:31:18 INFO     x shape: (4345, 12, 260, 34), y shape: (4345, 12, 260, 34)
2024-09-06 17:31:18 INFO     train	x: (3042, 12, 260, 34), y: (3042, 12, 260, 34)
2024-09-06 17:31:18 INFO     eval	x: (434, 12, 260, 34), y: (434, 12, 260, 34)
2024-09-06 17:31:18 INFO     test	x: (869, 12, 260, 34), y: (869, 12, 260, 34)
2024-09-06 17:31:18 INFO     StandardScaler mean: 0.7727858064026704, std: 2.3026817046377195
2024-09-06 17:31:19 INFO     NormalScaler max: 0.659603814907769
2024-09-06 17:31:25 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-06 17:31:25 INFO     node_embeddings	torch.Size([260, 10])	cuda:0	True
2024-09-06 17:31:25 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-06 17:31:25 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-06 17:31:25 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-06 17:31:25 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-06 17:31:25 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-06 17:31:25 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-06 17:31:25 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-06 17:31:25 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-06 17:31:25 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-06 17:31:25 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-06 17:31:25 INFO     Total parameter numbers: 875840
2024-09-06 17:31:25 INFO     You select `adam` optimizer.
2024-09-06 17:31:25 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-06 17:31:25 INFO     Start training ...
2024-09-06 17:31:25 INFO     num_batches:48
2024-09-06 17:31:34 INFO     epoch complete!
2024-09-06 17:31:34 INFO     evaluating now!
2024-09-06 17:31:35 INFO     Epoch [0/200] train_loss: 1.8779, val_loss: 2.3750, lr: 0.003000, 10.07s
2024-09-06 17:31:35 INFO     Saved model at 0
2024-09-06 17:31:35 INFO     Val loss decrease from inf to 2.3750, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch0.tar
2024-09-06 17:31:44 INFO     epoch complete!
2024-09-06 17:31:44 INFO     evaluating now!
2024-09-06 17:31:45 INFO     Epoch [1/200] train_loss: 1.4773, val_loss: 2.0005, lr: 0.003000, 9.86s
2024-09-06 17:31:45 INFO     Saved model at 1
2024-09-06 17:31:45 INFO     Val loss decrease from 2.3750 to 2.0005, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch1.tar
2024-09-06 17:31:54 INFO     epoch complete!
2024-09-06 17:31:54 INFO     evaluating now!
2024-09-06 17:31:55 INFO     Epoch [2/200] train_loss: 1.3425, val_loss: 1.8738, lr: 0.003000, 10.21s
2024-09-06 17:31:55 INFO     Saved model at 2
2024-09-06 17:31:55 INFO     Val loss decrease from 2.0005 to 1.8738, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch2.tar
2024-09-06 17:32:04 INFO     epoch complete!
2024-09-06 17:32:04 INFO     evaluating now!
2024-09-06 17:32:05 INFO     Epoch [3/200] train_loss: 1.2913, val_loss: 1.7981, lr: 0.003000, 10.10s
2024-09-06 17:32:05 INFO     Saved model at 3
2024-09-06 17:32:05 INFO     Val loss decrease from 1.8738 to 1.7981, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch3.tar
2024-09-06 17:32:15 INFO     epoch complete!
2024-09-06 17:32:15 INFO     evaluating now!
2024-09-06 17:32:15 INFO     Epoch [4/200] train_loss: 1.2553, val_loss: 1.7318, lr: 0.003000, 10.12s
2024-09-06 17:32:15 INFO     Saved model at 4
2024-09-06 17:32:15 INFO     Val loss decrease from 1.7981 to 1.7318, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch4.tar
2024-09-06 17:32:25 INFO     epoch complete!
2024-09-06 17:32:25 INFO     evaluating now!
2024-09-06 17:32:25 INFO     Epoch [5/200] train_loss: 1.2216, val_loss: 1.6929, lr: 0.003000, 10.04s
2024-09-06 17:32:25 INFO     Saved model at 5
2024-09-06 17:32:25 INFO     Val loss decrease from 1.7318 to 1.6929, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch5.tar
2024-09-06 17:32:35 INFO     epoch complete!
2024-09-06 17:32:35 INFO     evaluating now!
2024-09-06 17:32:35 INFO     Epoch [6/200] train_loss: 1.1928, val_loss: 1.6708, lr: 0.003000, 9.85s
2024-09-06 17:32:35 INFO     Saved model at 6
2024-09-06 17:32:35 INFO     Val loss decrease from 1.6929 to 1.6708, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch6.tar
2024-09-06 17:32:44 INFO     epoch complete!
2024-09-06 17:32:44 INFO     evaluating now!
2024-09-06 17:32:45 INFO     Epoch [7/200] train_loss: 1.1740, val_loss: 1.6376, lr: 0.003000, 9.84s
2024-09-06 17:32:45 INFO     Saved model at 7
2024-09-06 17:32:45 INFO     Val loss decrease from 1.6708 to 1.6376, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch7.tar
2024-09-06 17:32:54 INFO     epoch complete!
2024-09-06 17:32:54 INFO     evaluating now!
2024-09-06 17:32:55 INFO     Epoch [8/200] train_loss: 1.1645, val_loss: 1.5909, lr: 0.003000, 9.84s
2024-09-06 17:32:55 INFO     Saved model at 8
2024-09-06 17:32:55 INFO     Val loss decrease from 1.6376 to 1.5909, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch8.tar
2024-09-06 17:33:04 INFO     epoch complete!
2024-09-06 17:33:04 INFO     evaluating now!
2024-09-06 17:33:05 INFO     Epoch [9/200] train_loss: 1.1503, val_loss: 1.5908, lr: 0.003000, 9.83s
2024-09-06 17:33:05 INFO     Saved model at 9
2024-09-06 17:33:05 INFO     Val loss decrease from 1.5909 to 1.5908, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch9.tar
2024-09-06 17:33:14 INFO     epoch complete!
2024-09-06 17:33:14 INFO     evaluating now!
2024-09-06 17:33:15 INFO     Epoch [10/200] train_loss: 1.1476, val_loss: 1.5639, lr: 0.003000, 9.82s
2024-09-06 17:33:15 INFO     Saved model at 10
2024-09-06 17:33:15 INFO     Val loss decrease from 1.5908 to 1.5639, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch10.tar
2024-09-06 17:33:24 INFO     epoch complete!
2024-09-06 17:33:24 INFO     evaluating now!
2024-09-06 17:33:25 INFO     Epoch [11/200] train_loss: 1.1326, val_loss: 1.5671, lr: 0.003000, 9.88s
2024-09-06 17:33:34 INFO     epoch complete!
2024-09-06 17:33:34 INFO     evaluating now!
2024-09-06 17:33:34 INFO     Epoch [12/200] train_loss: 1.1259, val_loss: 1.5518, lr: 0.003000, 9.82s
2024-09-06 17:33:34 INFO     Saved model at 12
2024-09-06 17:33:34 INFO     Val loss decrease from 1.5639 to 1.5518, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch12.tar
2024-09-06 17:33:43 INFO     epoch complete!
2024-09-06 17:33:43 INFO     evaluating now!
2024-09-06 17:33:44 INFO     Epoch [13/200] train_loss: 1.1245, val_loss: 1.5169, lr: 0.003000, 9.83s
2024-09-06 17:33:44 INFO     Saved model at 13
2024-09-06 17:33:44 INFO     Val loss decrease from 1.5518 to 1.5169, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch13.tar
2024-09-06 17:33:53 INFO     epoch complete!
2024-09-06 17:33:53 INFO     evaluating now!
2024-09-06 17:33:54 INFO     Epoch [14/200] train_loss: 1.1140, val_loss: 1.4979, lr: 0.003000, 9.87s
2024-09-06 17:33:54 INFO     Saved model at 14
2024-09-06 17:33:54 INFO     Val loss decrease from 1.5169 to 1.4979, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch14.tar
2024-09-06 17:34:03 INFO     epoch complete!
2024-09-06 17:34:03 INFO     evaluating now!
2024-09-06 17:34:04 INFO     Epoch [15/200] train_loss: 1.1138, val_loss: 1.5067, lr: 0.003000, 9.82s
2024-09-06 17:34:13 INFO     epoch complete!
2024-09-06 17:34:13 INFO     evaluating now!
2024-09-06 17:34:14 INFO     Epoch [16/200] train_loss: 1.1088, val_loss: 1.5172, lr: 0.003000, 9.84s
2024-09-06 17:34:23 INFO     epoch complete!
2024-09-06 17:34:23 INFO     evaluating now!
2024-09-06 17:34:24 INFO     Epoch [17/200] train_loss: 1.1002, val_loss: 1.4809, lr: 0.003000, 9.83s
2024-09-06 17:34:24 INFO     Saved model at 17
2024-09-06 17:34:24 INFO     Val loss decrease from 1.4979 to 1.4809, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch17.tar
2024-09-06 17:34:33 INFO     epoch complete!
2024-09-06 17:34:33 INFO     evaluating now!
2024-09-06 17:34:33 INFO     Epoch [18/200] train_loss: 1.0980, val_loss: 1.5071, lr: 0.003000, 9.85s
2024-09-06 17:34:43 INFO     epoch complete!
2024-09-06 17:34:43 INFO     evaluating now!
2024-09-06 17:34:43 INFO     Epoch [19/200] train_loss: 1.0899, val_loss: 1.5319, lr: 0.003000, 9.81s
2024-09-06 17:34:52 INFO     epoch complete!
2024-09-06 17:34:52 INFO     evaluating now!
2024-09-06 17:34:53 INFO     Epoch [20/200] train_loss: 1.0872, val_loss: 1.5271, lr: 0.003000, 9.84s
2024-09-06 17:35:02 INFO     epoch complete!
2024-09-06 17:35:02 INFO     evaluating now!
2024-09-06 17:35:03 INFO     Epoch [21/200] train_loss: 1.0800, val_loss: 1.4822, lr: 0.003000, 9.84s
2024-09-06 17:35:12 INFO     epoch complete!
2024-09-06 17:35:12 INFO     evaluating now!
2024-09-06 17:35:13 INFO     Epoch [22/200] train_loss: 1.0759, val_loss: 1.4655, lr: 0.003000, 9.83s
2024-09-06 17:35:13 INFO     Saved model at 22
2024-09-06 17:35:13 INFO     Val loss decrease from 1.4809 to 1.4655, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch22.tar
2024-09-06 17:35:22 INFO     epoch complete!
2024-09-06 17:35:22 INFO     evaluating now!
2024-09-06 17:35:23 INFO     Epoch [23/200] train_loss: 1.0712, val_loss: 1.4521, lr: 0.003000, 9.81s
2024-09-06 17:35:23 INFO     Saved model at 23
2024-09-06 17:35:23 INFO     Val loss decrease from 1.4655 to 1.4521, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch23.tar
2024-09-06 17:35:32 INFO     epoch complete!
2024-09-06 17:35:32 INFO     evaluating now!
2024-09-06 17:35:32 INFO     Epoch [24/200] train_loss: 1.0632, val_loss: 1.4649, lr: 0.003000, 9.85s
2024-09-06 17:35:42 INFO     epoch complete!
2024-09-06 17:35:42 INFO     evaluating now!
2024-09-06 17:35:42 INFO     Epoch [25/200] train_loss: 1.0598, val_loss: 1.4599, lr: 0.003000, 9.86s
2024-09-06 17:35:51 INFO     epoch complete!
2024-09-06 17:35:51 INFO     evaluating now!
2024-09-06 17:35:52 INFO     Epoch [26/200] train_loss: 1.0548, val_loss: 1.4763, lr: 0.003000, 9.82s
2024-09-06 17:36:01 INFO     epoch complete!
2024-09-06 17:36:01 INFO     evaluating now!
2024-09-06 17:36:02 INFO     Epoch [27/200] train_loss: 1.0509, val_loss: 1.4546, lr: 0.003000, 9.84s
2024-09-06 17:36:11 INFO     epoch complete!
2024-09-06 17:36:11 INFO     evaluating now!
2024-09-06 17:36:12 INFO     Epoch [28/200] train_loss: 1.0482, val_loss: 1.4720, lr: 0.003000, 9.86s
2024-09-06 17:36:21 INFO     epoch complete!
2024-09-06 17:36:21 INFO     evaluating now!
2024-09-06 17:36:22 INFO     Epoch [29/200] train_loss: 1.0459, val_loss: 1.4435, lr: 0.003000, 9.83s
2024-09-06 17:36:22 INFO     Saved model at 29
2024-09-06 17:36:22 INFO     Val loss decrease from 1.4521 to 1.4435, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch29.tar
2024-09-06 17:36:31 INFO     epoch complete!
2024-09-06 17:36:31 INFO     evaluating now!
2024-09-06 17:36:32 INFO     Epoch [30/200] train_loss: 1.0420, val_loss: 1.4557, lr: 0.003000, 9.83s
2024-09-06 17:36:41 INFO     epoch complete!
2024-09-06 17:36:41 INFO     evaluating now!
2024-09-06 17:36:42 INFO     Epoch [31/200] train_loss: 1.0431, val_loss: 1.4503, lr: 0.003000, 10.01s
2024-09-06 17:36:51 INFO     epoch complete!
2024-09-06 17:36:51 INFO     evaluating now!
2024-09-06 17:36:51 INFO     Epoch [32/200] train_loss: 1.0376, val_loss: 1.4618, lr: 0.003000, 9.90s
2024-09-06 17:37:01 INFO     epoch complete!
2024-09-06 17:37:01 INFO     evaluating now!
2024-09-06 17:37:02 INFO     Epoch [33/200] train_loss: 1.0355, val_loss: 1.4394, lr: 0.003000, 10.15s
2024-09-06 17:37:02 INFO     Saved model at 33
2024-09-06 17:37:02 INFO     Val loss decrease from 1.4435 to 1.4394, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch33.tar
2024-09-06 17:37:11 INFO     epoch complete!
2024-09-06 17:37:11 INFO     evaluating now!
2024-09-06 17:37:11 INFO     Epoch [34/200] train_loss: 1.0329, val_loss: 1.4635, lr: 0.003000, 9.91s
2024-09-06 17:37:21 INFO     epoch complete!
2024-09-06 17:37:21 INFO     evaluating now!
2024-09-06 17:37:21 INFO     Epoch [35/200] train_loss: 1.0306, val_loss: 1.4613, lr: 0.003000, 9.84s
2024-09-06 17:37:30 INFO     epoch complete!
2024-09-06 17:37:30 INFO     evaluating now!
2024-09-06 17:37:31 INFO     Epoch [36/200] train_loss: 1.0293, val_loss: 1.4566, lr: 0.003000, 9.81s
2024-09-06 17:37:40 INFO     epoch complete!
2024-09-06 17:37:40 INFO     evaluating now!
2024-09-06 17:37:41 INFO     Epoch [37/200] train_loss: 1.0262, val_loss: 1.4574, lr: 0.003000, 9.82s
2024-09-06 17:37:50 INFO     epoch complete!
2024-09-06 17:37:50 INFO     evaluating now!
2024-09-06 17:37:51 INFO     Epoch [38/200] train_loss: 1.0230, val_loss: 1.4540, lr: 0.003000, 9.82s
2024-09-06 17:38:00 INFO     epoch complete!
2024-09-06 17:38:00 INFO     evaluating now!
2024-09-06 17:38:01 INFO     Epoch [39/200] train_loss: 1.0234, val_loss: 1.4665, lr: 0.003000, 9.79s
2024-09-06 17:38:10 INFO     epoch complete!
2024-09-06 17:38:10 INFO     evaluating now!
2024-09-06 17:38:10 INFO     Epoch [40/200] train_loss: 1.0225, val_loss: 1.4611, lr: 0.003000, 9.80s
2024-09-06 17:38:20 INFO     epoch complete!
2024-09-06 17:38:20 INFO     evaluating now!
2024-09-06 17:38:20 INFO     Epoch [41/200] train_loss: 1.0212, val_loss: 1.4495, lr: 0.003000, 9.87s
2024-09-06 17:38:29 INFO     epoch complete!
2024-09-06 17:38:29 INFO     evaluating now!
2024-09-06 17:38:30 INFO     Epoch [42/200] train_loss: 1.0171, val_loss: 1.4607, lr: 0.003000, 9.79s
2024-09-06 17:38:39 INFO     epoch complete!
2024-09-06 17:38:39 INFO     evaluating now!
2024-09-06 17:38:40 INFO     Epoch [43/200] train_loss: 1.0144, val_loss: 1.4650, lr: 0.003000, 9.78s
2024-09-06 17:38:49 INFO     epoch complete!
2024-09-06 17:38:49 INFO     evaluating now!
2024-09-06 17:38:50 INFO     Epoch [44/200] train_loss: 1.0129, val_loss: 1.4469, lr: 0.003000, 9.80s
2024-09-06 17:38:59 INFO     epoch complete!
2024-09-06 17:38:59 INFO     evaluating now!
2024-09-06 17:38:59 INFO     Epoch [45/200] train_loss: 1.0113, val_loss: 1.4587, lr: 0.003000, 9.80s
2024-09-06 17:39:09 INFO     epoch complete!
2024-09-06 17:39:09 INFO     evaluating now!
2024-09-06 17:39:09 INFO     Epoch [46/200] train_loss: 1.0092, val_loss: 1.4620, lr: 0.003000, 9.79s
2024-09-06 17:39:18 INFO     epoch complete!
2024-09-06 17:39:18 INFO     evaluating now!
2024-09-06 17:39:19 INFO     Epoch [47/200] train_loss: 1.0072, val_loss: 1.4651, lr: 0.003000, 9.84s
2024-09-06 17:39:28 INFO     epoch complete!
2024-09-06 17:39:28 INFO     evaluating now!
2024-09-06 17:39:29 INFO     Epoch [48/200] train_loss: 1.0069, val_loss: 1.4600, lr: 0.003000, 9.80s
2024-09-06 17:39:29 WARNING  Early stopping at epoch: 48
2024-09-06 17:39:29 INFO     Trained totally 49 epochs, average train time is 9.150s, average eval time is 0.721s
2024-09-06 17:39:29 INFO     Loaded model at 33
2024-09-06 17:39:29 INFO     Saved model at ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406.m
2024-09-06 17:39:29 INFO     Start evaluating ...
2024-09-06 17:39:32 INFO     Note that you select the single mode to evaluate!
2024-09-06 17:39:32 INFO     Evaluate result is saved at ./libcity/cache/3015/evaluate_cache\2024_09_06_17_39_32_AGCRN_NYCTaxi20200406.csv
2024-09-06 17:39:32 INFO     
         MAE      RMSE
1   1.328641  2.470783
2   1.325304  2.456329
3   1.322520  2.424853
4   1.343350  2.475818
5   1.345676  2.489938
6   1.342582  2.490075
7   1.344235  2.514896
8   1.356035  2.537612
9   1.361501  2.589626
10  1.384669  2.647919
11  1.397246  2.721160
12  1.423952  2.831217
2024-09-06 17:39:32 INFO     ----------------------------------------------------------------------------
2024-09-06 17:39:32 INFO     # 4, Kownledge Graph Embedding: GIE, Experiment ids: 3019
2024-09-06 17:39:32 INFO     ----------------------------------------------------------------------------
2024-09-06 17:39:32 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=NYCTaxi20200406, exp_id=3015
2024-09-06 17:39:32 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'NYCTaxi20200406', 'saved_model': True, 'train': True, 'exp_id': 3015, 'embedding_model': 'GIE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['NYCTaxi20200406'], 'geo_file': 'NYCTaxi20200406', 'rel_file': 'NYCTaxi20200406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-06 17:39:32 INFO     Loaded file NYCTaxi20200406.geo, num_nodes=260
2024-09-06 17:39:32 INFO     set_weight_link_or_dist: dist
2024-09-06 17:39:32 INFO     init_weight_inf_or_zero: inf
2024-09-06 17:39:32 INFO     Loaded file NYCTaxi20200406.rel, shape=(260, 260)
2024-09-06 17:39:32 INFO     Start Calculate the weight by Gauss kernel!
2024-09-06 17:39:32 INFO     Loading file NYCTaxi20200406.dyna
2024-09-06 17:39:33 INFO     Loaded file NYCTaxi20200406.dyna, shape=(4368, 260, 2)
2024-09-06 17:39:37 INFO     Dataset created
2024-09-06 17:39:37 INFO     x shape: (4345, 12, 260, 34), y shape: (4345, 12, 260, 34)
2024-09-06 17:39:38 INFO     train	x: (3042, 12, 260, 34), y: (3042, 12, 260, 34)
2024-09-06 17:39:38 INFO     eval	x: (434, 12, 260, 34), y: (434, 12, 260, 34)
2024-09-06 17:39:38 INFO     test	x: (869, 12, 260, 34), y: (869, 12, 260, 34)
2024-09-06 17:39:38 INFO     StandardScaler mean: 0.7727858064026704, std: 2.3026817046377195
2024-09-06 17:39:38 INFO     NormalScaler max: 0.659603814907769
2024-09-06 17:39:44 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-06 17:39:44 INFO     node_embeddings	torch.Size([260, 10])	cuda:0	True
2024-09-06 17:39:44 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-06 17:39:44 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-06 17:39:44 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-06 17:39:44 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-06 17:39:44 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-06 17:39:44 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-06 17:39:44 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-06 17:39:44 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-06 17:39:44 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-06 17:39:44 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-06 17:39:44 INFO     Total parameter numbers: 875840
2024-09-06 17:39:44 INFO     You select `adam` optimizer.
2024-09-06 17:39:44 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-06 17:39:44 INFO     Start training ...
2024-09-06 17:39:44 INFO     num_batches:48
2024-09-06 17:39:54 INFO     epoch complete!
2024-09-06 17:39:54 INFO     evaluating now!
2024-09-06 17:39:55 INFO     Epoch [0/200] train_loss: 1.8933, val_loss: 2.4296, lr: 0.003000, 10.09s
2024-09-06 17:39:55 INFO     Saved model at 0
2024-09-06 17:39:55 INFO     Val loss decrease from inf to 2.4296, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch0.tar
2024-09-06 17:40:04 INFO     epoch complete!
2024-09-06 17:40:04 INFO     evaluating now!
2024-09-06 17:40:04 INFO     Epoch [1/200] train_loss: 1.4566, val_loss: 1.9944, lr: 0.003000, 9.81s
2024-09-06 17:40:04 INFO     Saved model at 1
2024-09-06 17:40:04 INFO     Val loss decrease from 2.4296 to 1.9944, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch1.tar
2024-09-06 17:40:14 INFO     epoch complete!
2024-09-06 17:40:14 INFO     evaluating now!
2024-09-06 17:40:14 INFO     Epoch [2/200] train_loss: 1.3343, val_loss: 1.8951, lr: 0.003000, 10.04s
2024-09-06 17:40:14 INFO     Saved model at 2
2024-09-06 17:40:14 INFO     Val loss decrease from 1.9944 to 1.8951, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch2.tar
2024-09-06 17:40:24 INFO     epoch complete!
2024-09-06 17:40:24 INFO     evaluating now!
2024-09-06 17:40:24 INFO     Epoch [3/200] train_loss: 1.2824, val_loss: 1.7757, lr: 0.003000, 9.94s
2024-09-06 17:40:24 INFO     Saved model at 3
2024-09-06 17:40:24 INFO     Val loss decrease from 1.8951 to 1.7757, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch3.tar
2024-09-06 17:40:34 INFO     epoch complete!
2024-09-06 17:40:34 INFO     evaluating now!
2024-09-06 17:40:34 INFO     Epoch [4/200] train_loss: 1.2337, val_loss: 1.6974, lr: 0.003000, 9.95s
2024-09-06 17:40:34 INFO     Saved model at 4
2024-09-06 17:40:34 INFO     Val loss decrease from 1.7757 to 1.6974, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch4.tar
2024-09-06 17:40:43 INFO     epoch complete!
2024-09-06 17:40:43 INFO     evaluating now!
2024-09-06 17:40:44 INFO     Epoch [5/200] train_loss: 1.2005, val_loss: 1.6693, lr: 0.003000, 9.75s
2024-09-06 17:40:44 INFO     Saved model at 5
2024-09-06 17:40:44 INFO     Val loss decrease from 1.6974 to 1.6693, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch5.tar
2024-09-06 17:40:53 INFO     epoch complete!
2024-09-06 17:40:53 INFO     evaluating now!
2024-09-06 17:40:54 INFO     Epoch [6/200] train_loss: 1.1803, val_loss: 1.5981, lr: 0.003000, 9.79s
2024-09-06 17:40:54 INFO     Saved model at 6
2024-09-06 17:40:54 INFO     Val loss decrease from 1.6693 to 1.5981, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch6.tar
2024-09-06 17:41:03 INFO     epoch complete!
2024-09-06 17:41:03 INFO     evaluating now!
2024-09-06 17:41:04 INFO     Epoch [7/200] train_loss: 1.1628, val_loss: 1.5640, lr: 0.003000, 9.76s
2024-09-06 17:41:04 INFO     Saved model at 7
2024-09-06 17:41:04 INFO     Val loss decrease from 1.5981 to 1.5640, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch7.tar
2024-09-06 17:41:13 INFO     epoch complete!
2024-09-06 17:41:13 INFO     evaluating now!
2024-09-06 17:41:13 INFO     Epoch [8/200] train_loss: 1.1510, val_loss: 1.5951, lr: 0.003000, 9.73s
2024-09-06 17:41:23 INFO     epoch complete!
2024-09-06 17:41:23 INFO     evaluating now!
2024-09-06 17:41:23 INFO     Epoch [9/200] train_loss: 1.1420, val_loss: 1.5829, lr: 0.003000, 9.80s
2024-09-06 17:41:32 INFO     epoch complete!
2024-09-06 17:41:32 INFO     evaluating now!
2024-09-06 17:41:33 INFO     Epoch [10/200] train_loss: 1.1382, val_loss: 1.5785, lr: 0.003000, 9.80s
2024-09-06 17:41:42 INFO     epoch complete!
2024-09-06 17:41:42 INFO     evaluating now!
2024-09-06 17:41:43 INFO     Epoch [11/200] train_loss: 1.1248, val_loss: 1.5229, lr: 0.003000, 9.79s
2024-09-06 17:41:43 INFO     Saved model at 11
2024-09-06 17:41:43 INFO     Val loss decrease from 1.5640 to 1.5229, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch11.tar
2024-09-06 17:41:52 INFO     epoch complete!
2024-09-06 17:41:52 INFO     evaluating now!
2024-09-06 17:41:53 INFO     Epoch [12/200] train_loss: 1.1157, val_loss: 1.5340, lr: 0.003000, 9.81s
2024-09-06 17:42:02 INFO     epoch complete!
2024-09-06 17:42:02 INFO     evaluating now!
2024-09-06 17:42:03 INFO     Epoch [13/200] train_loss: 1.1106, val_loss: 1.5153, lr: 0.003000, 9.82s
2024-09-06 17:42:03 INFO     Saved model at 13
2024-09-06 17:42:03 INFO     Val loss decrease from 1.5229 to 1.5153, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch13.tar
2024-09-06 17:42:12 INFO     epoch complete!
2024-09-06 17:42:12 INFO     evaluating now!
2024-09-06 17:42:12 INFO     Epoch [14/200] train_loss: 1.1048, val_loss: 1.5282, lr: 0.003000, 9.94s
2024-09-06 17:42:22 INFO     epoch complete!
2024-09-06 17:42:22 INFO     evaluating now!
2024-09-06 17:42:22 INFO     Epoch [15/200] train_loss: 1.0995, val_loss: 1.4849, lr: 0.003000, 9.87s
2024-09-06 17:42:22 INFO     Saved model at 15
2024-09-06 17:42:22 INFO     Val loss decrease from 1.5153 to 1.4849, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch15.tar
2024-09-06 17:42:31 INFO     epoch complete!
2024-09-06 17:42:31 INFO     evaluating now!
2024-09-06 17:42:32 INFO     Epoch [16/200] train_loss: 1.0948, val_loss: 1.5718, lr: 0.003000, 9.83s
2024-09-06 17:42:41 INFO     epoch complete!
2024-09-06 17:42:41 INFO     evaluating now!
2024-09-06 17:42:42 INFO     Epoch [17/200] train_loss: 1.0955, val_loss: 1.4856, lr: 0.003000, 9.77s
2024-09-06 17:42:51 INFO     epoch complete!
2024-09-06 17:42:51 INFO     evaluating now!
2024-09-06 17:42:52 INFO     Epoch [18/200] train_loss: 1.0841, val_loss: 1.4779, lr: 0.003000, 9.76s
2024-09-06 17:42:52 INFO     Saved model at 18
2024-09-06 17:42:52 INFO     Val loss decrease from 1.4849 to 1.4779, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch18.tar
2024-09-06 17:43:01 INFO     epoch complete!
2024-09-06 17:43:01 INFO     evaluating now!
2024-09-06 17:43:02 INFO     Epoch [19/200] train_loss: 1.0781, val_loss: 1.4788, lr: 0.003000, 9.81s
2024-09-06 17:43:11 INFO     epoch complete!
2024-09-06 17:43:11 INFO     evaluating now!
2024-09-06 17:43:11 INFO     Epoch [20/200] train_loss: 1.0687, val_loss: 1.4866, lr: 0.003000, 9.80s
2024-09-06 17:43:20 INFO     epoch complete!
2024-09-06 17:43:20 INFO     evaluating now!
2024-09-06 17:43:21 INFO     Epoch [21/200] train_loss: 1.0800, val_loss: 1.4956, lr: 0.003000, 9.80s
2024-09-06 17:43:30 INFO     epoch complete!
2024-09-06 17:43:30 INFO     evaluating now!
2024-09-06 17:43:31 INFO     Epoch [22/200] train_loss: 1.0658, val_loss: 1.4897, lr: 0.003000, 9.78s
2024-09-06 17:43:40 INFO     epoch complete!
2024-09-06 17:43:40 INFO     evaluating now!
2024-09-06 17:43:41 INFO     Epoch [23/200] train_loss: 1.0595, val_loss: 1.4616, lr: 0.003000, 9.77s
2024-09-06 17:43:41 INFO     Saved model at 23
2024-09-06 17:43:41 INFO     Val loss decrease from 1.4779 to 1.4616, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch23.tar
2024-09-06 17:43:50 INFO     epoch complete!
2024-09-06 17:43:50 INFO     evaluating now!
2024-09-06 17:43:50 INFO     Epoch [24/200] train_loss: 1.0543, val_loss: 1.4514, lr: 0.003000, 9.76s
2024-09-06 17:43:50 INFO     Saved model at 24
2024-09-06 17:43:50 INFO     Val loss decrease from 1.4616 to 1.4514, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch24.tar
2024-09-06 17:44:00 INFO     epoch complete!
2024-09-06 17:44:00 INFO     evaluating now!
2024-09-06 17:44:00 INFO     Epoch [25/200] train_loss: 1.0525, val_loss: 1.4593, lr: 0.003000, 9.80s
2024-09-06 17:44:09 INFO     epoch complete!
2024-09-06 17:44:09 INFO     evaluating now!
2024-09-06 17:44:10 INFO     Epoch [26/200] train_loss: 1.0487, val_loss: 1.4499, lr: 0.003000, 9.81s
2024-09-06 17:44:10 INFO     Saved model at 26
2024-09-06 17:44:10 INFO     Val loss decrease from 1.4514 to 1.4499, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch26.tar
2024-09-06 17:44:19 INFO     epoch complete!
2024-09-06 17:44:19 INFO     evaluating now!
2024-09-06 17:44:20 INFO     Epoch [27/200] train_loss: 1.0473, val_loss: 1.4716, lr: 0.003000, 9.98s
2024-09-06 17:44:29 INFO     epoch complete!
2024-09-06 17:44:29 INFO     evaluating now!
2024-09-06 17:44:30 INFO     Epoch [28/200] train_loss: 1.0454, val_loss: 1.4563, lr: 0.003000, 10.04s
2024-09-06 17:44:39 INFO     epoch complete!
2024-09-06 17:44:39 INFO     evaluating now!
2024-09-06 17:44:40 INFO     Epoch [29/200] train_loss: 1.0399, val_loss: 1.4647, lr: 0.003000, 10.05s
2024-09-06 17:44:50 INFO     epoch complete!
2024-09-06 17:44:50 INFO     evaluating now!
2024-09-06 17:44:51 INFO     Epoch [30/200] train_loss: 1.0363, val_loss: 1.4551, lr: 0.003000, 10.89s
2024-09-06 17:45:01 INFO     epoch complete!
2024-09-06 17:45:01 INFO     evaluating now!
2024-09-06 17:45:02 INFO     Epoch [31/200] train_loss: 1.0356, val_loss: 1.4448, lr: 0.003000, 10.79s
2024-09-06 17:45:02 INFO     Saved model at 31
2024-09-06 17:45:02 INFO     Val loss decrease from 1.4499 to 1.4448, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch31.tar
2024-09-06 17:45:11 INFO     epoch complete!
2024-09-06 17:45:11 INFO     evaluating now!
2024-09-06 17:45:12 INFO     Epoch [32/200] train_loss: 1.0337, val_loss: 1.4502, lr: 0.003000, 10.33s
2024-09-06 17:45:21 INFO     epoch complete!
2024-09-06 17:45:21 INFO     evaluating now!
2024-09-06 17:45:22 INFO     Epoch [33/200] train_loss: 1.0319, val_loss: 1.4496, lr: 0.003000, 9.98s
2024-09-06 17:45:31 INFO     epoch complete!
2024-09-06 17:45:31 INFO     evaluating now!
2024-09-06 17:45:32 INFO     Epoch [34/200] train_loss: 1.0282, val_loss: 1.4333, lr: 0.003000, 9.98s
2024-09-06 17:45:32 INFO     Saved model at 34
2024-09-06 17:45:32 INFO     Val loss decrease from 1.4448 to 1.4333, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch34.tar
2024-09-06 17:45:41 INFO     epoch complete!
2024-09-06 17:45:41 INFO     evaluating now!
2024-09-06 17:45:42 INFO     Epoch [35/200] train_loss: 1.0257, val_loss: 1.4648, lr: 0.003000, 10.02s
2024-09-06 17:45:52 INFO     epoch complete!
2024-09-06 17:45:52 INFO     evaluating now!
2024-09-06 17:45:52 INFO     Epoch [36/200] train_loss: 1.0251, val_loss: 1.4385, lr: 0.003000, 10.07s
2024-09-06 17:46:01 INFO     epoch complete!
2024-09-06 17:46:01 INFO     evaluating now!
2024-09-06 17:46:02 INFO     Epoch [37/200] train_loss: 1.0232, val_loss: 1.4576, lr: 0.003000, 9.79s
2024-09-06 17:46:11 INFO     epoch complete!
2024-09-06 17:46:11 INFO     evaluating now!
2024-09-06 17:46:12 INFO     Epoch [38/200] train_loss: 1.0201, val_loss: 1.4681, lr: 0.003000, 9.77s
2024-09-06 17:46:21 INFO     epoch complete!
2024-09-06 17:46:21 INFO     evaluating now!
2024-09-06 17:46:22 INFO     Epoch [39/200] train_loss: 1.0206, val_loss: 1.4605, lr: 0.003000, 9.79s
2024-09-06 17:46:31 INFO     epoch complete!
2024-09-06 17:46:31 INFO     evaluating now!
2024-09-06 17:46:31 INFO     Epoch [40/200] train_loss: 1.0164, val_loss: 1.4533, lr: 0.003000, 9.79s
2024-09-06 17:46:41 INFO     epoch complete!
2024-09-06 17:46:41 INFO     evaluating now!
2024-09-06 17:46:41 INFO     Epoch [41/200] train_loss: 1.0155, val_loss: 1.4518, lr: 0.003000, 9.83s
2024-09-06 17:46:51 INFO     epoch complete!
2024-09-06 17:46:51 INFO     evaluating now!
2024-09-06 17:46:51 INFO     Epoch [42/200] train_loss: 1.0127, val_loss: 1.4584, lr: 0.003000, 10.01s
2024-09-06 17:47:00 INFO     epoch complete!
2024-09-06 17:47:00 INFO     evaluating now!
2024-09-06 17:47:01 INFO     Epoch [43/200] train_loss: 1.0101, val_loss: 1.4475, lr: 0.003000, 9.97s
2024-09-06 17:47:10 INFO     epoch complete!
2024-09-06 17:47:10 INFO     evaluating now!
2024-09-06 17:47:11 INFO     Epoch [44/200] train_loss: 1.0102, val_loss: 1.4529, lr: 0.003000, 9.81s
2024-09-06 17:47:20 INFO     epoch complete!
2024-09-06 17:47:20 INFO     evaluating now!
2024-09-06 17:47:21 INFO     Epoch [45/200] train_loss: 1.0088, val_loss: 1.4552, lr: 0.003000, 9.79s
2024-09-06 17:47:30 INFO     epoch complete!
2024-09-06 17:47:30 INFO     evaluating now!
2024-09-06 17:47:31 INFO     Epoch [46/200] train_loss: 1.0061, val_loss: 1.4497, lr: 0.003000, 9.76s
2024-09-06 17:47:40 INFO     epoch complete!
2024-09-06 17:47:40 INFO     evaluating now!
2024-09-06 17:47:41 INFO     Epoch [47/200] train_loss: 1.0056, val_loss: 1.4521, lr: 0.003000, 10.53s
2024-09-06 17:47:50 INFO     epoch complete!
2024-09-06 17:47:50 INFO     evaluating now!
2024-09-06 17:47:51 INFO     Epoch [48/200] train_loss: 1.0038, val_loss: 1.4609, lr: 0.003000, 10.07s
2024-09-06 17:48:00 INFO     epoch complete!
2024-09-06 17:48:00 INFO     evaluating now!
2024-09-06 17:48:01 INFO     Epoch [49/200] train_loss: 1.0025, val_loss: 1.4570, lr: 0.003000, 9.98s
2024-09-06 17:48:01 WARNING  Early stopping at epoch: 49
2024-09-06 17:48:01 INFO     Trained totally 50 epochs, average train time is 9.200s, average eval time is 0.728s
2024-09-06 17:48:01 INFO     Loaded model at 34
2024-09-06 17:48:01 INFO     Saved model at ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406.m
2024-09-06 17:48:01 INFO     Start evaluating ...
2024-09-06 17:48:05 INFO     Note that you select the single mode to evaluate!
2024-09-06 17:48:05 INFO     Evaluate result is saved at ./libcity/cache/3015/evaluate_cache\2024_09_06_17_48_05_AGCRN_NYCTaxi20200406.csv
2024-09-06 17:48:05 INFO     
         MAE      RMSE
1   1.319354  2.458996
2   1.318950  2.433420
3   1.315988  2.407028
4   1.323746  2.442889
5   1.327874  2.458588
6   1.331449  2.456939
7   1.343659  2.498928
8   1.348359  2.509813
9   1.363490  2.564797
10  1.374406  2.612747
11  1.391531  2.682292
12  1.417501  2.782747
2024-09-06 17:48:05 INFO     ----------------------------------------------------------------------------
2024-09-06 17:48:05 INFO     Kownledge Graph Embedding: GIE, Experiment ids: [3015, 3016, 3017, 3018, 3019]
2024-09-06 17:48:05 INFO     ----------------------------------------------------------------------------
2024-09-06 17:48:05 INFO     Average: 
         MAE      RMSE
0   1.334681  2.465111
1   1.333967  2.446238
2   1.329025  2.417816
3   1.340465  2.458733
4   1.346395  2.477762
5   1.350109  2.487425
6   1.358103  2.522783
7   1.368264  2.551901
8   1.382879  2.605852
9   1.396648  2.658223
10  1.413939  2.734970
11  1.441873  2.838303 
2024-09-06 17:48:05 INFO     Standard deviation: 
         MAE      RMSE
0   0.011694  0.029235
1   0.012799  0.028552
2   0.011481  0.020632
3   0.012835  0.028314
4   0.011622  0.031432
5   0.013234  0.033811
6   0.013259  0.027838
7   0.014657  0.031127
8   0.016998  0.030777
9   0.015591  0.032251
10  0.017510  0.033583
11  0.018528  0.038278
2024-09-06 17:48:05 INFO     ----------------------------------------------------------------------------
2024-09-06 17:48:05 INFO     12 steps Average: 
        MAE      RMSE
0  1.366362  2.555426
2024-09-06 17:48:05 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.014184  0.030486
