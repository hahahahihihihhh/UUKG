2024-09-04 10:13:53 INFO     Saving logs in: ./logs/NYCTaxi20200406\AGCRN\ExtSpace\GIE
2024-09-04 10:13:53 INFO     ----------------------------------------------------------------------------
2024-09-04 10:13:53 INFO     # 0, Kownledge Graph Embedding: GIE, Experiment ids: 3015
2024-09-04 10:13:53 INFO     ----------------------------------------------------------------------------
2024-09-04 10:13:53 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=NYCTaxi20200406, exp_id=3015
2024-09-04 10:13:53 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'NYCTaxi20200406', 'saved_model': True, 'train': True, 'exp_id': 3015, 'embedding_model': 'GIE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['NYCTaxi20200406'], 'geo_file': 'NYCTaxi20200406', 'rel_file': 'NYCTaxi20200406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-04 10:13:53 INFO     Loaded file NYCTaxi20200406.geo, num_nodes=260
2024-09-04 10:13:53 INFO     set_weight_link_or_dist: dist
2024-09-04 10:13:53 INFO     init_weight_inf_or_zero: inf
2024-09-04 10:13:54 INFO     Loaded file NYCTaxi20200406.rel, shape=(260, 260)
2024-09-04 10:13:54 INFO     Start Calculate the weight by Gauss kernel!
2024-09-04 10:13:54 INFO     Loading file NYCTaxi20200406.dyna
2024-09-04 10:13:54 INFO     Loaded file NYCTaxi20200406.dyna, shape=(4368, 260, 2)
2024-09-04 10:14:01 INFO     Dataset created
2024-09-04 10:14:01 INFO     x shape: (4345, 12, 260, 34), y shape: (4345, 12, 260, 34)
2024-09-04 10:14:01 INFO     train	x: (3042, 12, 260, 34), y: (3042, 12, 260, 34)
2024-09-04 10:14:01 INFO     eval	x: (434, 12, 260, 34), y: (434, 12, 260, 34)
2024-09-04 10:14:01 INFO     test	x: (869, 12, 260, 34), y: (869, 12, 260, 34)
2024-09-04 10:14:02 INFO     StandardScaler mean: 0.7727858064026704, std: 2.3026817046377195
2024-09-04 10:14:02 INFO     NormalScaler max: 0.659603814907769
2024-09-04 10:14:11 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-04 10:14:11 INFO     node_embeddings	torch.Size([260, 10])	cuda:0	True
2024-09-04 10:14:11 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-04 10:14:11 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-04 10:14:11 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-04 10:14:11 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-04 10:14:11 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-04 10:14:11 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-04 10:14:11 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-04 10:14:11 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-04 10:14:11 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-04 10:14:11 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-04 10:14:11 INFO     Total parameter numbers: 875840
2024-09-04 10:14:11 INFO     You select `adam` optimizer.
2024-09-04 10:14:11 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-04 10:14:11 INFO     Start training ...
2024-09-04 10:14:11 INFO     num_batches:48
2024-09-04 10:15:05 INFO     epoch complete!
2024-09-04 10:15:05 INFO     evaluating now!
2024-09-04 10:15:06 INFO     Epoch [0/200] train_loss: 1.8575, val_loss: 2.3344, lr: 0.003000, 54.40s
2024-09-04 10:15:06 INFO     Saved model at 0
2024-09-04 10:15:06 INFO     Val loss decrease from inf to 2.3344, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch0.tar
2024-09-04 10:15:57 INFO     epoch complete!
2024-09-04 10:15:57 INFO     evaluating now!
2024-09-04 10:15:58 INFO     Epoch [1/200] train_loss: 1.4746, val_loss: 1.9666, lr: 0.003000, 52.57s
2024-09-04 10:15:58 INFO     Saved model at 1
2024-09-04 10:15:58 INFO     Val loss decrease from 2.3344 to 1.9666, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch1.tar
2024-09-04 10:16:50 INFO     epoch complete!
2024-09-04 10:16:50 INFO     evaluating now!
2024-09-04 10:16:51 INFO     Epoch [2/200] train_loss: 1.3253, val_loss: 1.8366, lr: 0.003000, 52.54s
2024-09-04 10:16:51 INFO     Saved model at 2
2024-09-04 10:16:51 INFO     Val loss decrease from 1.9666 to 1.8366, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch2.tar
2024-09-04 10:17:43 INFO     epoch complete!
2024-09-04 10:17:43 INFO     evaluating now!
2024-09-04 10:17:44 INFO     Epoch [3/200] train_loss: 1.2561, val_loss: 1.7988, lr: 0.003000, 52.76s
2024-09-04 10:17:44 INFO     Saved model at 3
2024-09-04 10:17:44 INFO     Val loss decrease from 1.8366 to 1.7988, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch3.tar
2024-09-04 10:18:36 INFO     epoch complete!
2024-09-04 10:18:36 INFO     evaluating now!
2024-09-04 10:18:37 INFO     Epoch [4/200] train_loss: 1.2166, val_loss: 1.7423, lr: 0.003000, 52.85s
2024-09-04 10:18:37 INFO     Saved model at 4
2024-09-04 10:18:37 INFO     Val loss decrease from 1.7988 to 1.7423, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch4.tar
2024-09-04 10:19:28 INFO     epoch complete!
2024-09-04 10:19:28 INFO     evaluating now!
2024-09-04 10:19:29 INFO     Epoch [5/200] train_loss: 1.1964, val_loss: 1.6706, lr: 0.003000, 52.55s
2024-09-04 10:19:29 INFO     Saved model at 5
2024-09-04 10:19:29 INFO     Val loss decrease from 1.7423 to 1.6706, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch5.tar
2024-09-04 10:20:20 INFO     epoch complete!
2024-09-04 10:20:20 INFO     evaluating now!
2024-09-04 10:20:21 INFO     Epoch [6/200] train_loss: 1.1838, val_loss: 1.7046, lr: 0.003000, 52.19s
2024-09-04 10:21:13 INFO     epoch complete!
2024-09-04 10:21:13 INFO     evaluating now!
2024-09-04 10:21:14 INFO     Epoch [7/200] train_loss: 1.1760, val_loss: 1.6446, lr: 0.003000, 52.67s
2024-09-04 10:21:14 INFO     Saved model at 7
2024-09-04 10:21:14 INFO     Val loss decrease from 1.6706 to 1.6446, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch7.tar
2024-09-04 10:22:07 INFO     epoch complete!
2024-09-04 10:22:07 INFO     evaluating now!
2024-09-04 10:22:08 INFO     Epoch [8/200] train_loss: 1.1720, val_loss: 1.6471, lr: 0.003000, 53.45s
2024-09-04 10:22:58 INFO     epoch complete!
2024-09-04 10:22:58 INFO     evaluating now!
2024-09-04 10:22:59 INFO     Epoch [9/200] train_loss: 1.1589, val_loss: 1.5644, lr: 0.003000, 51.96s
2024-09-04 10:23:00 INFO     Saved model at 9
2024-09-04 10:23:00 INFO     Val loss decrease from 1.6446 to 1.5644, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch9.tar
2024-09-04 10:23:51 INFO     epoch complete!
2024-09-04 10:23:51 INFO     evaluating now!
2024-09-04 10:23:51 INFO     Epoch [10/200] train_loss: 1.1468, val_loss: 1.5567, lr: 0.003000, 51.79s
2024-09-04 10:23:51 INFO     Saved model at 10
2024-09-04 10:23:51 INFO     Val loss decrease from 1.5644 to 1.5567, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch10.tar
2024-09-04 10:24:44 INFO     epoch complete!
2024-09-04 10:24:44 INFO     evaluating now!
2024-09-04 10:24:45 INFO     Epoch [11/200] train_loss: 1.1355, val_loss: 1.5877, lr: 0.003000, 53.47s
2024-09-04 10:25:37 INFO     epoch complete!
2024-09-04 10:25:37 INFO     evaluating now!
2024-09-04 10:25:38 INFO     Epoch [12/200] train_loss: 1.1316, val_loss: 1.5536, lr: 0.003000, 52.92s
2024-09-04 10:25:38 INFO     Saved model at 12
2024-09-04 10:25:38 INFO     Val loss decrease from 1.5567 to 1.5536, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch12.tar
2024-09-04 10:26:32 INFO     epoch complete!
2024-09-04 10:26:32 INFO     evaluating now!
2024-09-04 10:26:33 INFO     Epoch [13/200] train_loss: 1.1226, val_loss: 1.5080, lr: 0.003000, 54.82s
2024-09-04 10:26:33 INFO     Saved model at 13
2024-09-04 10:26:33 INFO     Val loss decrease from 1.5536 to 1.5080, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch13.tar
2024-09-04 10:27:25 INFO     epoch complete!
2024-09-04 10:27:25 INFO     evaluating now!
2024-09-04 10:27:27 INFO     Epoch [14/200] train_loss: 1.1155, val_loss: 1.5375, lr: 0.003000, 53.96s
2024-09-04 10:28:19 INFO     epoch complete!
2024-09-04 10:28:19 INFO     evaluating now!
2024-09-04 10:28:20 INFO     Epoch [15/200] train_loss: 1.1064, val_loss: 1.4797, lr: 0.003000, 53.38s
2024-09-04 10:28:20 INFO     Saved model at 15
2024-09-04 10:28:20 INFO     Val loss decrease from 1.5080 to 1.4797, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch15.tar
2024-09-04 10:29:13 INFO     epoch complete!
2024-09-04 10:29:13 INFO     evaluating now!
2024-09-04 10:29:14 INFO     Epoch [16/200] train_loss: 1.1095, val_loss: 1.5174, lr: 0.003000, 53.79s
2024-09-04 10:30:11 INFO     epoch complete!
2024-09-04 10:30:11 INFO     evaluating now!
2024-09-04 10:30:11 INFO     Epoch [17/200] train_loss: 1.0989, val_loss: 1.5062, lr: 0.003000, 57.73s
2024-09-04 10:31:07 INFO     epoch complete!
2024-09-04 10:31:07 INFO     evaluating now!
2024-09-04 10:31:08 INFO     Epoch [18/200] train_loss: 1.0929, val_loss: 1.4660, lr: 0.003000, 56.22s
2024-09-04 10:31:08 INFO     Saved model at 18
2024-09-04 10:31:08 INFO     Val loss decrease from 1.4797 to 1.4660, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch18.tar
2024-09-04 10:32:00 INFO     epoch complete!
2024-09-04 10:32:00 INFO     evaluating now!
2024-09-04 10:32:00 INFO     Epoch [19/200] train_loss: 1.0948, val_loss: 1.5164, lr: 0.003000, 52.79s
2024-09-04 10:32:52 INFO     epoch complete!
2024-09-04 10:32:52 INFO     evaluating now!
2024-09-04 10:32:52 INFO     Epoch [20/200] train_loss: 1.0858, val_loss: 1.4868, lr: 0.003000, 51.86s
2024-09-04 10:33:46 INFO     epoch complete!
2024-09-04 10:33:46 INFO     evaluating now!
2024-09-04 10:33:47 INFO     Epoch [21/200] train_loss: 1.0774, val_loss: 1.4600, lr: 0.003000, 54.55s
2024-09-04 10:33:47 INFO     Saved model at 21
2024-09-04 10:33:47 INFO     Val loss decrease from 1.4660 to 1.4600, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch21.tar
2024-09-04 10:34:44 INFO     epoch complete!
2024-09-04 10:34:44 INFO     evaluating now!
2024-09-04 10:34:45 INFO     Epoch [22/200] train_loss: 1.0757, val_loss: 1.4575, lr: 0.003000, 58.56s
2024-09-04 10:34:45 INFO     Saved model at 22
2024-09-04 10:34:45 INFO     Val loss decrease from 1.4600 to 1.4575, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch22.tar
2024-09-04 10:35:41 INFO     epoch complete!
2024-09-04 10:35:41 INFO     evaluating now!
2024-09-04 10:35:42 INFO     Epoch [23/200] train_loss: 1.0705, val_loss: 1.4614, lr: 0.003000, 56.29s
2024-09-04 10:36:35 INFO     epoch complete!
2024-09-04 10:36:35 INFO     evaluating now!
2024-09-04 10:36:36 INFO     Epoch [24/200] train_loss: 1.0653, val_loss: 1.4390, lr: 0.003000, 53.83s
2024-09-04 10:36:36 INFO     Saved model at 24
2024-09-04 10:36:36 INFO     Val loss decrease from 1.4575 to 1.4390, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch24.tar
2024-09-04 10:37:30 INFO     epoch complete!
2024-09-04 10:37:30 INFO     evaluating now!
2024-09-04 10:37:31 INFO     Epoch [25/200] train_loss: 1.0622, val_loss: 1.4393, lr: 0.003000, 55.42s
2024-09-04 10:38:25 INFO     epoch complete!
2024-09-04 10:38:25 INFO     evaluating now!
2024-09-04 10:38:25 INFO     Epoch [26/200] train_loss: 1.0624, val_loss: 1.4893, lr: 0.003000, 54.41s
2024-09-04 10:39:22 INFO     epoch complete!
2024-09-04 10:39:22 INFO     evaluating now!
2024-09-04 10:39:23 INFO     Epoch [27/200] train_loss: 1.0636, val_loss: 1.4937, lr: 0.003000, 57.50s
2024-09-04 10:40:16 INFO     epoch complete!
2024-09-04 10:40:16 INFO     evaluating now!
2024-09-04 10:40:17 INFO     Epoch [28/200] train_loss: 1.0593, val_loss: 1.4518, lr: 0.003000, 54.06s
2024-09-04 10:41:10 INFO     epoch complete!
2024-09-04 10:41:10 INFO     evaluating now!
2024-09-04 10:41:10 INFO     Epoch [29/200] train_loss: 1.0488, val_loss: 1.4570, lr: 0.003000, 53.39s
2024-09-04 10:42:03 INFO     epoch complete!
2024-09-04 10:42:03 INFO     evaluating now!
2024-09-04 10:42:04 INFO     Epoch [30/200] train_loss: 1.0462, val_loss: 1.4478, lr: 0.003000, 53.35s
2024-09-04 10:43:00 INFO     epoch complete!
2024-09-04 10:43:00 INFO     evaluating now!
2024-09-04 10:43:01 INFO     Epoch [31/200] train_loss: 1.0431, val_loss: 1.4574, lr: 0.003000, 56.97s
2024-09-04 10:43:55 INFO     epoch complete!
2024-09-04 10:43:55 INFO     evaluating now!
2024-09-04 10:43:56 INFO     Epoch [32/200] train_loss: 1.0422, val_loss: 1.4569, lr: 0.003000, 55.21s
2024-09-04 10:44:52 INFO     epoch complete!
2024-09-04 10:44:52 INFO     evaluating now!
2024-09-04 10:44:52 INFO     Epoch [33/200] train_loss: 1.0416, val_loss: 1.4450, lr: 0.003000, 56.41s
2024-09-04 10:45:49 INFO     epoch complete!
2024-09-04 10:45:49 INFO     evaluating now!
2024-09-04 10:45:50 INFO     Epoch [34/200] train_loss: 1.0379, val_loss: 1.4528, lr: 0.003000, 57.73s
2024-09-04 10:46:44 INFO     epoch complete!
2024-09-04 10:46:44 INFO     evaluating now!
2024-09-04 10:46:45 INFO     Epoch [35/200] train_loss: 1.0330, val_loss: 1.4437, lr: 0.003000, 55.30s
2024-09-04 10:47:45 INFO     epoch complete!
2024-09-04 10:47:45 INFO     evaluating now!
2024-09-04 10:47:45 INFO     Epoch [36/200] train_loss: 1.0342, val_loss: 1.4465, lr: 0.003000, 59.99s
2024-09-04 10:48:38 INFO     epoch complete!
2024-09-04 10:48:38 INFO     evaluating now!
2024-09-04 10:48:39 INFO     Epoch [37/200] train_loss: 1.0295, val_loss: 1.4461, lr: 0.003000, 53.82s
2024-09-04 10:49:34 INFO     epoch complete!
2024-09-04 10:49:34 INFO     evaluating now!
2024-09-04 10:49:35 INFO     Epoch [38/200] train_loss: 1.0290, val_loss: 1.4569, lr: 0.003000, 55.64s
2024-09-04 10:50:32 INFO     epoch complete!
2024-09-04 10:50:32 INFO     evaluating now!
2024-09-04 10:50:33 INFO     Epoch [39/200] train_loss: 1.0261, val_loss: 1.4583, lr: 0.003000, 57.73s
2024-09-04 10:50:33 WARNING  Early stopping at epoch: 39
2024-09-04 10:50:33 INFO     Trained totally 40 epochs, average train time is 53.676s, average eval time is 0.844s
2024-09-04 10:50:33 INFO     Loaded model at 24
2024-09-04 10:50:33 INFO     Saved model at ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406.m
2024-09-04 10:50:33 INFO     Start evaluating ...
2024-09-04 10:50:36 INFO     Note that you select the single mode to evaluate!
2024-09-04 10:50:36 INFO     Evaluate result is saved at ./libcity/cache/3015/evaluate_cache\2024_09_04_10_50_36_AGCRN_NYCTaxi20200406.csv
2024-09-04 10:50:36 INFO     
         MAE      RMSE
1   1.306544  2.387410
2   1.312836  2.374114
3   1.312138  2.368068
4   1.325396  2.405019
5   1.340198  2.438380
6   1.336833  2.449897
7   1.357649  2.492976
8   1.372635  2.527339
9   1.375670  2.570769
10  1.381706  2.624575
11  1.400036  2.693619
12  1.428892  2.791515
2024-09-04 10:50:36 INFO     ----------------------------------------------------------------------------
2024-09-04 10:50:36 INFO     # 1, Kownledge Graph Embedding: GIE, Experiment ids: 3016
2024-09-04 10:50:36 INFO     ----------------------------------------------------------------------------
2024-09-04 10:50:36 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=NYCTaxi20200406, exp_id=3015
2024-09-04 10:50:36 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'NYCTaxi20200406', 'saved_model': True, 'train': True, 'exp_id': 3015, 'embedding_model': 'GIE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['NYCTaxi20200406'], 'geo_file': 'NYCTaxi20200406', 'rel_file': 'NYCTaxi20200406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-04 10:50:36 INFO     Loaded file NYCTaxi20200406.geo, num_nodes=260
2024-09-04 10:50:36 INFO     set_weight_link_or_dist: dist
2024-09-04 10:50:36 INFO     init_weight_inf_or_zero: inf
2024-09-04 10:50:37 INFO     Loaded file NYCTaxi20200406.rel, shape=(260, 260)
2024-09-04 10:50:37 INFO     Start Calculate the weight by Gauss kernel!
2024-09-04 10:50:37 INFO     Loading file NYCTaxi20200406.dyna
2024-09-04 10:50:37 INFO     Loaded file NYCTaxi20200406.dyna, shape=(4368, 260, 2)
2024-09-04 10:50:43 INFO     Dataset created
2024-09-04 10:50:43 INFO     x shape: (4345, 12, 260, 34), y shape: (4345, 12, 260, 34)
2024-09-04 10:50:43 INFO     train	x: (3042, 12, 260, 34), y: (3042, 12, 260, 34)
2024-09-04 10:50:43 INFO     eval	x: (434, 12, 260, 34), y: (434, 12, 260, 34)
2024-09-04 10:50:43 INFO     test	x: (869, 12, 260, 34), y: (869, 12, 260, 34)
2024-09-04 10:50:44 INFO     StandardScaler mean: 0.7727858064026704, std: 2.3026817046377195
2024-09-04 10:50:44 INFO     NormalScaler max: 0.659603814907769
2024-09-04 10:50:51 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-04 10:50:51 INFO     node_embeddings	torch.Size([260, 10])	cuda:0	True
2024-09-04 10:50:51 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-04 10:50:51 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-04 10:50:51 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-04 10:50:51 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-04 10:50:51 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-04 10:50:51 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-04 10:50:51 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-04 10:50:51 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-04 10:50:51 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-04 10:50:51 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-04 10:50:51 INFO     Total parameter numbers: 875840
2024-09-04 10:50:51 INFO     You select `adam` optimizer.
2024-09-04 10:50:51 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-04 10:50:51 INFO     Start training ...
2024-09-04 10:50:51 INFO     num_batches:48
2024-09-04 10:51:45 INFO     epoch complete!
2024-09-04 10:51:45 INFO     evaluating now!
2024-09-04 10:51:46 INFO     Epoch [0/200] train_loss: 1.8959, val_loss: 2.3678, lr: 0.003000, 55.30s
2024-09-04 10:51:46 INFO     Saved model at 0
2024-09-04 10:51:46 INFO     Val loss decrease from inf to 2.3678, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch0.tar
2024-09-04 10:52:40 INFO     epoch complete!
2024-09-04 10:52:40 INFO     evaluating now!
2024-09-04 10:52:41 INFO     Epoch [1/200] train_loss: 1.4651, val_loss: 1.9825, lr: 0.003000, 54.28s
2024-09-04 10:52:41 INFO     Saved model at 1
2024-09-04 10:52:41 INFO     Val loss decrease from 2.3678 to 1.9825, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch1.tar
2024-09-04 10:53:35 INFO     epoch complete!
2024-09-04 10:53:35 INFO     evaluating now!
2024-09-04 10:53:36 INFO     Epoch [2/200] train_loss: 1.3286, val_loss: 1.8438, lr: 0.003000, 55.19s
2024-09-04 10:53:36 INFO     Saved model at 2
2024-09-04 10:53:36 INFO     Val loss decrease from 1.9825 to 1.8438, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch2.tar
2024-09-04 10:54:31 INFO     epoch complete!
2024-09-04 10:54:31 INFO     evaluating now!
2024-09-04 10:54:32 INFO     Epoch [3/200] train_loss: 1.2571, val_loss: 1.7497, lr: 0.003000, 55.95s
2024-09-04 10:54:32 INFO     Saved model at 3
2024-09-04 10:54:32 INFO     Val loss decrease from 1.8438 to 1.7497, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch3.tar
2024-09-04 10:55:25 INFO     epoch complete!
2024-09-04 10:55:25 INFO     evaluating now!
2024-09-04 10:55:26 INFO     Epoch [4/200] train_loss: 1.2147, val_loss: 1.6622, lr: 0.003000, 54.61s
2024-09-04 10:55:26 INFO     Saved model at 4
2024-09-04 10:55:26 INFO     Val loss decrease from 1.7497 to 1.6622, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch4.tar
2024-09-04 10:56:24 INFO     epoch complete!
2024-09-04 10:56:24 INFO     evaluating now!
2024-09-04 10:56:25 INFO     Epoch [5/200] train_loss: 1.1897, val_loss: 1.6504, lr: 0.003000, 58.33s
2024-09-04 10:56:25 INFO     Saved model at 5
2024-09-04 10:56:25 INFO     Val loss decrease from 1.6622 to 1.6504, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch5.tar
2024-09-04 10:57:19 INFO     epoch complete!
2024-09-04 10:57:19 INFO     evaluating now!
2024-09-04 10:57:20 INFO     Epoch [6/200] train_loss: 1.1796, val_loss: 1.6249, lr: 0.003000, 55.36s
2024-09-04 10:57:20 INFO     Saved model at 6
2024-09-04 10:57:20 INFO     Val loss decrease from 1.6504 to 1.6249, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch6.tar
2024-09-04 10:58:12 INFO     epoch complete!
2024-09-04 10:58:12 INFO     evaluating now!
2024-09-04 10:58:13 INFO     Epoch [7/200] train_loss: 1.1589, val_loss: 1.5687, lr: 0.003000, 52.84s
2024-09-04 10:58:13 INFO     Saved model at 7
2024-09-04 10:58:13 INFO     Val loss decrease from 1.6249 to 1.5687, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch7.tar
2024-09-04 10:59:07 INFO     epoch complete!
2024-09-04 10:59:07 INFO     evaluating now!
2024-09-04 10:59:08 INFO     Epoch [8/200] train_loss: 1.1525, val_loss: 1.5590, lr: 0.003000, 55.15s
2024-09-04 10:59:08 INFO     Saved model at 8
2024-09-04 10:59:08 INFO     Val loss decrease from 1.5687 to 1.5590, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch8.tar
2024-09-04 11:00:04 INFO     epoch complete!
2024-09-04 11:00:04 INFO     evaluating now!
2024-09-04 11:00:05 INFO     Epoch [9/200] train_loss: 1.1452, val_loss: 1.5631, lr: 0.003000, 57.04s
2024-09-04 11:01:05 INFO     epoch complete!
2024-09-04 11:01:05 INFO     evaluating now!
2024-09-04 11:01:06 INFO     Epoch [10/200] train_loss: 1.1359, val_loss: 1.5475, lr: 0.003000, 60.82s
2024-09-04 11:01:06 INFO     Saved model at 10
2024-09-04 11:01:06 INFO     Val loss decrease from 1.5590 to 1.5475, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch10.tar
2024-09-04 11:02:03 INFO     epoch complete!
2024-09-04 11:02:03 INFO     evaluating now!
2024-09-04 11:02:04 INFO     Epoch [11/200] train_loss: 1.1288, val_loss: 1.5384, lr: 0.003000, 57.66s
2024-09-04 11:02:04 INFO     Saved model at 11
2024-09-04 11:02:04 INFO     Val loss decrease from 1.5475 to 1.5384, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch11.tar
2024-09-04 11:02:58 INFO     epoch complete!
2024-09-04 11:02:58 INFO     evaluating now!
2024-09-04 11:02:59 INFO     Epoch [12/200] train_loss: 1.1182, val_loss: 1.5348, lr: 0.003000, 54.94s
2024-09-04 11:02:59 INFO     Saved model at 12
2024-09-04 11:02:59 INFO     Val loss decrease from 1.5384 to 1.5348, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch12.tar
2024-09-04 11:03:52 INFO     epoch complete!
2024-09-04 11:03:52 INFO     evaluating now!
2024-09-04 11:03:53 INFO     Epoch [13/200] train_loss: 1.1160, val_loss: 1.5044, lr: 0.003000, 54.43s
2024-09-04 11:03:53 INFO     Saved model at 13
2024-09-04 11:03:53 INFO     Val loss decrease from 1.5348 to 1.5044, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch13.tar
2024-09-04 11:04:45 INFO     epoch complete!
2024-09-04 11:04:45 INFO     evaluating now!
2024-09-04 11:04:46 INFO     Epoch [14/200] train_loss: 1.1021, val_loss: 1.5325, lr: 0.003000, 52.58s
2024-09-04 11:05:38 INFO     epoch complete!
2024-09-04 11:05:38 INFO     evaluating now!
2024-09-04 11:05:39 INFO     Epoch [15/200] train_loss: 1.1003, val_loss: 1.4960, lr: 0.003000, 53.02s
2024-09-04 11:05:39 INFO     Saved model at 15
2024-09-04 11:05:39 INFO     Val loss decrease from 1.5044 to 1.4960, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch15.tar
2024-09-04 11:06:30 INFO     epoch complete!
2024-09-04 11:06:30 INFO     evaluating now!
2024-09-04 11:06:31 INFO     Epoch [16/200] train_loss: 1.0990, val_loss: 1.5368, lr: 0.003000, 52.72s
2024-09-04 11:07:27 INFO     epoch complete!
2024-09-04 11:07:27 INFO     evaluating now!
2024-09-04 11:07:28 INFO     Epoch [17/200] train_loss: 1.0888, val_loss: 1.5101, lr: 0.003000, 56.45s
2024-09-04 11:08:22 INFO     epoch complete!
2024-09-04 11:08:22 INFO     evaluating now!
2024-09-04 11:08:23 INFO     Epoch [18/200] train_loss: 1.0845, val_loss: 1.4654, lr: 0.003000, 54.92s
2024-09-04 11:08:23 INFO     Saved model at 18
2024-09-04 11:08:23 INFO     Val loss decrease from 1.4960 to 1.4654, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch18.tar
2024-09-04 11:09:16 INFO     epoch complete!
2024-09-04 11:09:16 INFO     evaluating now!
2024-09-04 11:09:17 INFO     Epoch [19/200] train_loss: 1.0778, val_loss: 1.4666, lr: 0.003000, 53.90s
2024-09-04 11:10:11 INFO     epoch complete!
2024-09-04 11:10:11 INFO     evaluating now!
2024-09-04 11:10:12 INFO     Epoch [20/200] train_loss: 1.0743, val_loss: 1.4882, lr: 0.003000, 55.18s
2024-09-04 11:11:11 INFO     epoch complete!
2024-09-04 11:11:11 INFO     evaluating now!
2024-09-04 11:11:11 INFO     Epoch [21/200] train_loss: 1.0674, val_loss: 1.4735, lr: 0.003000, 59.54s
2024-09-04 11:12:05 INFO     epoch complete!
2024-09-04 11:12:05 INFO     evaluating now!
2024-09-04 11:12:06 INFO     Epoch [22/200] train_loss: 1.0617, val_loss: 1.4887, lr: 0.003000, 54.87s
2024-09-04 11:13:02 INFO     epoch complete!
2024-09-04 11:13:02 INFO     evaluating now!
2024-09-04 11:13:03 INFO     Epoch [23/200] train_loss: 1.0584, val_loss: 1.4764, lr: 0.003000, 56.47s
2024-09-04 11:13:55 INFO     epoch complete!
2024-09-04 11:13:55 INFO     evaluating now!
2024-09-04 11:13:56 INFO     Epoch [24/200] train_loss: 1.0528, val_loss: 1.4709, lr: 0.003000, 52.78s
2024-09-04 11:14:53 INFO     epoch complete!
2024-09-04 11:14:53 INFO     evaluating now!
2024-09-04 11:14:54 INFO     Epoch [25/200] train_loss: 1.0493, val_loss: 1.4600, lr: 0.003000, 58.57s
2024-09-04 11:14:54 INFO     Saved model at 25
2024-09-04 11:14:54 INFO     Val loss decrease from 1.4654 to 1.4600, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch25.tar
2024-09-04 11:15:47 INFO     epoch complete!
2024-09-04 11:15:47 INFO     evaluating now!
2024-09-04 11:15:48 INFO     Epoch [26/200] train_loss: 1.0547, val_loss: 1.4698, lr: 0.003000, 54.09s
2024-09-04 11:16:40 INFO     epoch complete!
2024-09-04 11:16:40 INFO     evaluating now!
2024-09-04 11:16:41 INFO     Epoch [27/200] train_loss: 1.0460, val_loss: 1.4669, lr: 0.003000, 53.14s
2024-09-04 11:17:37 INFO     epoch complete!
2024-09-04 11:17:37 INFO     evaluating now!
2024-09-04 11:17:38 INFO     Epoch [28/200] train_loss: 1.0415, val_loss: 1.4649, lr: 0.003000, 56.31s
2024-09-04 11:18:33 INFO     epoch complete!
2024-09-04 11:18:33 INFO     evaluating now!
2024-09-04 11:18:34 INFO     Epoch [29/200] train_loss: 1.0380, val_loss: 1.4703, lr: 0.003000, 56.45s
2024-09-04 11:19:29 INFO     epoch complete!
2024-09-04 11:19:29 INFO     evaluating now!
2024-09-04 11:19:31 INFO     Epoch [30/200] train_loss: 1.0351, val_loss: 1.4576, lr: 0.003000, 57.23s
2024-09-04 11:19:31 INFO     Saved model at 30
2024-09-04 11:19:31 INFO     Val loss decrease from 1.4600 to 1.4576, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch30.tar
2024-09-04 11:20:23 INFO     epoch complete!
2024-09-04 11:20:23 INFO     evaluating now!
2024-09-04 11:20:24 INFO     Epoch [31/200] train_loss: 1.0320, val_loss: 1.4601, lr: 0.003000, 52.58s
2024-09-04 11:21:14 INFO     epoch complete!
2024-09-04 11:21:14 INFO     evaluating now!
2024-09-04 11:21:15 INFO     Epoch [32/200] train_loss: 1.0311, val_loss: 1.4618, lr: 0.003000, 51.50s
2024-09-04 11:22:09 INFO     epoch complete!
2024-09-04 11:22:09 INFO     evaluating now!
2024-09-04 11:22:10 INFO     Epoch [33/200] train_loss: 1.0284, val_loss: 1.4511, lr: 0.003000, 54.24s
2024-09-04 11:22:10 INFO     Saved model at 33
2024-09-04 11:22:10 INFO     Val loss decrease from 1.4576 to 1.4511, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch33.tar
2024-09-04 11:23:01 INFO     epoch complete!
2024-09-04 11:23:01 INFO     evaluating now!
2024-09-04 11:23:02 INFO     Epoch [34/200] train_loss: 1.0252, val_loss: 1.4515, lr: 0.003000, 52.55s
2024-09-04 11:23:54 INFO     epoch complete!
2024-09-04 11:23:54 INFO     evaluating now!
2024-09-04 11:23:55 INFO     Epoch [35/200] train_loss: 1.0238, val_loss: 1.4605, lr: 0.003000, 52.37s
2024-09-04 11:24:46 INFO     epoch complete!
2024-09-04 11:24:46 INFO     evaluating now!
2024-09-04 11:24:47 INFO     Epoch [36/200] train_loss: 1.0198, val_loss: 1.4573, lr: 0.003000, 52.49s
2024-09-04 11:25:39 INFO     epoch complete!
2024-09-04 11:25:39 INFO     evaluating now!
2024-09-04 11:25:40 INFO     Epoch [37/200] train_loss: 1.0181, val_loss: 1.4624, lr: 0.003000, 52.53s
2024-09-04 11:26:32 INFO     epoch complete!
2024-09-04 11:26:32 INFO     evaluating now!
2024-09-04 11:26:32 INFO     Epoch [38/200] train_loss: 1.0159, val_loss: 1.4422, lr: 0.003000, 52.75s
2024-09-04 11:26:32 INFO     Saved model at 38
2024-09-04 11:26:32 INFO     Val loss decrease from 1.4511 to 1.4422, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch38.tar
2024-09-04 11:27:24 INFO     epoch complete!
2024-09-04 11:27:24 INFO     evaluating now!
2024-09-04 11:27:25 INFO     Epoch [39/200] train_loss: 1.0145, val_loss: 1.4517, lr: 0.003000, 52.41s
2024-09-04 11:28:14 INFO     epoch complete!
2024-09-04 11:28:14 INFO     evaluating now!
2024-09-04 11:28:15 INFO     Epoch [40/200] train_loss: 1.0146, val_loss: 1.4441, lr: 0.003000, 50.55s
2024-09-04 11:29:05 INFO     epoch complete!
2024-09-04 11:29:05 INFO     evaluating now!
2024-09-04 11:29:06 INFO     Epoch [41/200] train_loss: 1.0129, val_loss: 1.4500, lr: 0.003000, 50.56s
2024-09-04 11:29:57 INFO     epoch complete!
2024-09-04 11:29:57 INFO     evaluating now!
2024-09-04 11:29:58 INFO     Epoch [42/200] train_loss: 1.0107, val_loss: 1.4622, lr: 0.003000, 52.49s
2024-09-04 11:30:48 INFO     epoch complete!
2024-09-04 11:30:48 INFO     evaluating now!
2024-09-04 11:30:49 INFO     Epoch [43/200] train_loss: 1.0077, val_loss: 1.4628, lr: 0.003000, 50.55s
2024-09-04 11:31:39 INFO     epoch complete!
2024-09-04 11:31:39 INFO     evaluating now!
2024-09-04 11:31:40 INFO     Epoch [44/200] train_loss: 1.0057, val_loss: 1.4631, lr: 0.003000, 50.57s
2024-09-04 11:32:29 INFO     epoch complete!
2024-09-04 11:32:29 INFO     evaluating now!
2024-09-04 11:32:30 INFO     Epoch [45/200] train_loss: 1.0022, val_loss: 1.4570, lr: 0.003000, 50.54s
2024-09-04 11:33:20 INFO     epoch complete!
2024-09-04 11:33:20 INFO     evaluating now!
2024-09-04 11:33:21 INFO     Epoch [46/200] train_loss: 1.0024, val_loss: 1.4677, lr: 0.003000, 50.57s
2024-09-04 11:34:10 INFO     epoch complete!
2024-09-04 11:34:10 INFO     evaluating now!
2024-09-04 11:34:11 INFO     Epoch [47/200] train_loss: 1.0007, val_loss: 1.4610, lr: 0.003000, 50.54s
2024-09-04 11:35:01 INFO     epoch complete!
2024-09-04 11:35:01 INFO     evaluating now!
2024-09-04 11:35:02 INFO     Epoch [48/200] train_loss: 0.9987, val_loss: 1.4602, lr: 0.003000, 50.55s
2024-09-04 11:35:51 INFO     epoch complete!
2024-09-04 11:35:51 INFO     evaluating now!
2024-09-04 11:35:52 INFO     Epoch [49/200] train_loss: 0.9987, val_loss: 1.4669, lr: 0.003000, 50.53s
2024-09-04 11:36:42 INFO     epoch complete!
2024-09-04 11:36:42 INFO     evaluating now!
2024-09-04 11:36:43 INFO     Epoch [50/200] train_loss: 0.9956, val_loss: 1.4701, lr: 0.003000, 50.67s
2024-09-04 11:37:32 INFO     epoch complete!
2024-09-04 11:37:32 INFO     evaluating now!
2024-09-04 11:37:33 INFO     Epoch [51/200] train_loss: 0.9938, val_loss: 1.4750, lr: 0.003000, 50.56s
2024-09-04 11:38:23 INFO     epoch complete!
2024-09-04 11:38:23 INFO     evaluating now!
2024-09-04 11:38:24 INFO     Epoch [52/200] train_loss: 0.9922, val_loss: 1.4598, lr: 0.003000, 50.56s
2024-09-04 11:39:14 INFO     epoch complete!
2024-09-04 11:39:14 INFO     evaluating now!
2024-09-04 11:39:15 INFO     Epoch [53/200] train_loss: 0.9919, val_loss: 1.4806, lr: 0.003000, 50.55s
2024-09-04 11:39:15 WARNING  Early stopping at epoch: 53
2024-09-04 11:39:15 INFO     Trained totally 54 epochs, average train time is 52.832s, average eval time is 0.933s
2024-09-04 11:39:15 INFO     Loaded model at 38
2024-09-04 11:39:15 INFO     Saved model at ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406.m
2024-09-04 11:39:15 INFO     Start evaluating ...
2024-09-04 11:39:18 INFO     Note that you select the single mode to evaluate!
2024-09-04 11:39:18 INFO     Evaluate result is saved at ./libcity/cache/3015/evaluate_cache\2024_09_04_11_39_18_AGCRN_NYCTaxi20200406.csv
2024-09-04 11:39:18 INFO     
         MAE      RMSE
1   1.340937  2.429132
2   1.337822  2.399332
3   1.333532  2.364370
4   1.349202  2.405870
5   1.360876  2.446008
6   1.372985  2.458545
7   1.379316  2.504964
8   1.392395  2.540231
9   1.408688  2.604321
10  1.420147  2.661193
11  1.439695  2.729907
12  1.467143  2.840785
2024-09-04 11:39:18 INFO     ----------------------------------------------------------------------------
2024-09-04 11:39:18 INFO     # 2, Kownledge Graph Embedding: GIE, Experiment ids: 3017
2024-09-04 11:39:18 INFO     ----------------------------------------------------------------------------
2024-09-04 11:39:18 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=NYCTaxi20200406, exp_id=3015
2024-09-04 11:39:18 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'NYCTaxi20200406', 'saved_model': True, 'train': True, 'exp_id': 3015, 'embedding_model': 'GIE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['NYCTaxi20200406'], 'geo_file': 'NYCTaxi20200406', 'rel_file': 'NYCTaxi20200406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-04 11:39:18 INFO     Loaded file NYCTaxi20200406.geo, num_nodes=260
2024-09-04 11:39:18 INFO     set_weight_link_or_dist: dist
2024-09-04 11:39:18 INFO     init_weight_inf_or_zero: inf
2024-09-04 11:39:18 INFO     Loaded file NYCTaxi20200406.rel, shape=(260, 260)
2024-09-04 11:39:18 INFO     Start Calculate the weight by Gauss kernel!
2024-09-04 11:39:18 INFO     Loading file NYCTaxi20200406.dyna
2024-09-04 11:39:19 INFO     Loaded file NYCTaxi20200406.dyna, shape=(4368, 260, 2)
2024-09-04 11:39:24 INFO     Dataset created
2024-09-04 11:39:24 INFO     x shape: (4345, 12, 260, 34), y shape: (4345, 12, 260, 34)
2024-09-04 11:39:24 INFO     train	x: (3042, 12, 260, 34), y: (3042, 12, 260, 34)
2024-09-04 11:39:24 INFO     eval	x: (434, 12, 260, 34), y: (434, 12, 260, 34)
2024-09-04 11:39:24 INFO     test	x: (869, 12, 260, 34), y: (869, 12, 260, 34)
2024-09-04 11:39:24 INFO     StandardScaler mean: 0.7727858064026704, std: 2.3026817046377195
2024-09-04 11:39:25 INFO     NormalScaler max: 0.659603814907769
2024-09-04 11:39:32 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-04 11:39:32 INFO     node_embeddings	torch.Size([260, 10])	cuda:0	True
2024-09-04 11:39:32 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-04 11:39:32 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-04 11:39:32 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-04 11:39:32 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-04 11:39:32 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-04 11:39:32 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-04 11:39:32 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-04 11:39:32 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-04 11:39:32 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-04 11:39:32 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-04 11:39:32 INFO     Total parameter numbers: 875840
2024-09-04 11:39:32 INFO     You select `adam` optimizer.
2024-09-04 11:39:32 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-04 11:39:32 INFO     Start training ...
2024-09-04 11:39:32 INFO     num_batches:48
2024-09-04 11:40:22 INFO     epoch complete!
2024-09-04 11:40:22 INFO     evaluating now!
2024-09-04 11:40:23 INFO     Epoch [0/200] train_loss: 1.8664, val_loss: 2.3313, lr: 0.003000, 50.75s
2024-09-04 11:40:23 INFO     Saved model at 0
2024-09-04 11:40:23 INFO     Val loss decrease from inf to 2.3313, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch0.tar
2024-09-04 11:41:12 INFO     epoch complete!
2024-09-04 11:41:12 INFO     evaluating now!
2024-09-04 11:41:13 INFO     Epoch [1/200] train_loss: 1.4551, val_loss: 1.9453, lr: 0.003000, 50.55s
2024-09-04 11:41:13 INFO     Saved model at 1
2024-09-04 11:41:13 INFO     Val loss decrease from 2.3313 to 1.9453, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch1.tar
2024-09-04 11:42:03 INFO     epoch complete!
2024-09-04 11:42:03 INFO     evaluating now!
2024-09-04 11:42:04 INFO     Epoch [2/200] train_loss: 1.3424, val_loss: 1.8726, lr: 0.003000, 50.58s
2024-09-04 11:42:04 INFO     Saved model at 2
2024-09-04 11:42:04 INFO     Val loss decrease from 1.9453 to 1.8726, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch2.tar
2024-09-04 11:42:53 INFO     epoch complete!
2024-09-04 11:42:53 INFO     evaluating now!
2024-09-04 11:42:54 INFO     Epoch [3/200] train_loss: 1.2876, val_loss: 1.7892, lr: 0.003000, 50.58s
2024-09-04 11:42:54 INFO     Saved model at 3
2024-09-04 11:42:54 INFO     Val loss decrease from 1.8726 to 1.7892, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch3.tar
2024-09-04 11:43:44 INFO     epoch complete!
2024-09-04 11:43:44 INFO     evaluating now!
2024-09-04 11:43:45 INFO     Epoch [4/200] train_loss: 1.2416, val_loss: 1.7426, lr: 0.003000, 50.56s
2024-09-04 11:43:45 INFO     Saved model at 4
2024-09-04 11:43:45 INFO     Val loss decrease from 1.7892 to 1.7426, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch4.tar
2024-09-04 11:44:35 INFO     epoch complete!
2024-09-04 11:44:35 INFO     evaluating now!
2024-09-04 11:44:36 INFO     Epoch [5/200] train_loss: 1.2089, val_loss: 1.7160, lr: 0.003000, 50.56s
2024-09-04 11:44:36 INFO     Saved model at 5
2024-09-04 11:44:36 INFO     Val loss decrease from 1.7426 to 1.7160, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch5.tar
2024-09-04 11:45:25 INFO     epoch complete!
2024-09-04 11:45:25 INFO     evaluating now!
2024-09-04 11:45:26 INFO     Epoch [6/200] train_loss: 1.1855, val_loss: 1.6499, lr: 0.003000, 50.56s
2024-09-04 11:45:26 INFO     Saved model at 6
2024-09-04 11:45:26 INFO     Val loss decrease from 1.7160 to 1.6499, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch6.tar
2024-09-04 11:46:16 INFO     epoch complete!
2024-09-04 11:46:16 INFO     evaluating now!
2024-09-04 11:46:17 INFO     Epoch [7/200] train_loss: 1.1715, val_loss: 1.6349, lr: 0.003000, 50.57s
2024-09-04 11:46:17 INFO     Saved model at 7
2024-09-04 11:46:17 INFO     Val loss decrease from 1.6499 to 1.6349, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch7.tar
2024-09-04 11:47:06 INFO     epoch complete!
2024-09-04 11:47:06 INFO     evaluating now!
2024-09-04 11:47:07 INFO     Epoch [8/200] train_loss: 1.1576, val_loss: 1.5572, lr: 0.003000, 50.57s
2024-09-04 11:47:07 INFO     Saved model at 8
2024-09-04 11:47:07 INFO     Val loss decrease from 1.6349 to 1.5572, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch8.tar
2024-09-04 11:47:57 INFO     epoch complete!
2024-09-04 11:47:57 INFO     evaluating now!
2024-09-04 11:47:58 INFO     Epoch [9/200] train_loss: 1.1501, val_loss: 1.6328, lr: 0.003000, 50.60s
2024-09-04 11:48:47 INFO     epoch complete!
2024-09-04 11:48:47 INFO     evaluating now!
2024-09-04 11:48:48 INFO     Epoch [10/200] train_loss: 1.1390, val_loss: 1.5330, lr: 0.003000, 50.58s
2024-09-04 11:48:48 INFO     Saved model at 10
2024-09-04 11:48:48 INFO     Val loss decrease from 1.5572 to 1.5330, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch10.tar
2024-09-04 11:49:38 INFO     epoch complete!
2024-09-04 11:49:38 INFO     evaluating now!
2024-09-04 11:49:39 INFO     Epoch [11/200] train_loss: 1.1319, val_loss: 1.5176, lr: 0.003000, 50.57s
2024-09-04 11:49:39 INFO     Saved model at 11
2024-09-04 11:49:39 INFO     Val loss decrease from 1.5330 to 1.5176, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch11.tar
2024-09-04 11:50:29 INFO     epoch complete!
2024-09-04 11:50:29 INFO     evaluating now!
2024-09-04 11:50:30 INFO     Epoch [12/200] train_loss: 1.1253, val_loss: 1.5882, lr: 0.003000, 50.57s
2024-09-04 11:51:19 INFO     epoch complete!
2024-09-04 11:51:19 INFO     evaluating now!
2024-09-04 11:51:20 INFO     Epoch [13/200] train_loss: 1.1216, val_loss: 1.5359, lr: 0.003000, 50.57s
2024-09-04 11:52:10 INFO     epoch complete!
2024-09-04 11:52:10 INFO     evaluating now!
2024-09-04 11:52:11 INFO     Epoch [14/200] train_loss: 1.1164, val_loss: 1.4947, lr: 0.003000, 50.59s
2024-09-04 11:52:11 INFO     Saved model at 14
2024-09-04 11:52:11 INFO     Val loss decrease from 1.5176 to 1.4947, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch14.tar
2024-09-04 11:53:00 INFO     epoch complete!
2024-09-04 11:53:00 INFO     evaluating now!
2024-09-04 11:53:01 INFO     Epoch [15/200] train_loss: 1.1061, val_loss: 1.5581, lr: 0.003000, 50.61s
2024-09-04 11:53:51 INFO     epoch complete!
2024-09-04 11:53:51 INFO     evaluating now!
2024-09-04 11:53:52 INFO     Epoch [16/200] train_loss: 1.1010, val_loss: 1.5113, lr: 0.003000, 50.56s
2024-09-04 11:54:42 INFO     epoch complete!
2024-09-04 11:54:42 INFO     evaluating now!
2024-09-04 11:54:43 INFO     Epoch [17/200] train_loss: 1.0977, val_loss: 1.5394, lr: 0.003000, 50.56s
2024-09-04 11:55:32 INFO     epoch complete!
2024-09-04 11:55:32 INFO     evaluating now!
2024-09-04 11:55:33 INFO     Epoch [18/200] train_loss: 1.0920, val_loss: 1.5128, lr: 0.003000, 50.59s
2024-09-04 11:56:23 INFO     epoch complete!
2024-09-04 11:56:23 INFO     evaluating now!
2024-09-04 11:56:24 INFO     Epoch [19/200] train_loss: 1.0858, val_loss: 1.5225, lr: 0.003000, 50.57s
2024-09-04 11:57:13 INFO     epoch complete!
2024-09-04 11:57:13 INFO     evaluating now!
2024-09-04 11:57:14 INFO     Epoch [20/200] train_loss: 1.0823, val_loss: 1.4713, lr: 0.003000, 50.55s
2024-09-04 11:57:14 INFO     Saved model at 20
2024-09-04 11:57:14 INFO     Val loss decrease from 1.4947 to 1.4713, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch20.tar
2024-09-04 11:58:04 INFO     epoch complete!
2024-09-04 11:58:04 INFO     evaluating now!
2024-09-04 11:58:05 INFO     Epoch [21/200] train_loss: 1.0771, val_loss: 1.5025, lr: 0.003000, 50.58s
2024-09-04 11:58:54 INFO     epoch complete!
2024-09-04 11:58:54 INFO     evaluating now!
2024-09-04 11:58:55 INFO     Epoch [22/200] train_loss: 1.0763, val_loss: 1.5347, lr: 0.003000, 50.57s
2024-09-04 11:59:45 INFO     epoch complete!
2024-09-04 11:59:45 INFO     evaluating now!
2024-09-04 11:59:46 INFO     Epoch [23/200] train_loss: 1.0664, val_loss: 1.5163, lr: 0.003000, 50.55s
2024-09-04 12:00:36 INFO     epoch complete!
2024-09-04 12:00:36 INFO     evaluating now!
2024-09-04 12:00:37 INFO     Epoch [24/200] train_loss: 1.0615, val_loss: 1.4704, lr: 0.003000, 50.59s
2024-09-04 12:00:37 INFO     Saved model at 24
2024-09-04 12:00:37 INFO     Val loss decrease from 1.4713 to 1.4704, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch24.tar
2024-09-04 12:01:26 INFO     epoch complete!
2024-09-04 12:01:26 INFO     evaluating now!
2024-09-04 12:01:27 INFO     Epoch [25/200] train_loss: 1.0592, val_loss: 1.4712, lr: 0.003000, 50.59s
2024-09-04 12:02:17 INFO     epoch complete!
2024-09-04 12:02:17 INFO     evaluating now!
2024-09-04 12:02:18 INFO     Epoch [26/200] train_loss: 1.0531, val_loss: 1.4730, lr: 0.003000, 50.58s
2024-09-04 12:03:07 INFO     epoch complete!
2024-09-04 12:03:07 INFO     evaluating now!
2024-09-04 12:03:08 INFO     Epoch [27/200] train_loss: 1.0508, val_loss: 1.4847, lr: 0.003000, 50.59s
2024-09-04 12:03:58 INFO     epoch complete!
2024-09-04 12:03:58 INFO     evaluating now!
2024-09-04 12:03:59 INFO     Epoch [28/200] train_loss: 1.0507, val_loss: 1.4800, lr: 0.003000, 50.56s
2024-09-04 12:04:48 INFO     epoch complete!
2024-09-04 12:04:48 INFO     evaluating now!
2024-09-04 12:04:49 INFO     Epoch [29/200] train_loss: 1.0450, val_loss: 1.4773, lr: 0.003000, 50.56s
2024-09-04 12:05:39 INFO     epoch complete!
2024-09-04 12:05:39 INFO     evaluating now!
2024-09-04 12:05:40 INFO     Epoch [30/200] train_loss: 1.0428, val_loss: 1.4608, lr: 0.003000, 50.57s
2024-09-04 12:05:40 INFO     Saved model at 30
2024-09-04 12:05:40 INFO     Val loss decrease from 1.4704 to 1.4608, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch30.tar
2024-09-04 12:06:30 INFO     epoch complete!
2024-09-04 12:06:30 INFO     evaluating now!
2024-09-04 12:06:31 INFO     Epoch [31/200] train_loss: 1.0406, val_loss: 1.4523, lr: 0.003000, 50.58s
2024-09-04 12:06:31 INFO     Saved model at 31
2024-09-04 12:06:31 INFO     Val loss decrease from 1.4608 to 1.4523, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch31.tar
2024-09-04 12:07:20 INFO     epoch complete!
2024-09-04 12:07:20 INFO     evaluating now!
2024-09-04 12:07:21 INFO     Epoch [32/200] train_loss: 1.0373, val_loss: 1.4555, lr: 0.003000, 50.62s
2024-09-04 12:08:11 INFO     epoch complete!
2024-09-04 12:08:11 INFO     evaluating now!
2024-09-04 12:08:12 INFO     Epoch [33/200] train_loss: 1.0333, val_loss: 1.4625, lr: 0.003000, 50.55s
2024-09-04 12:09:01 INFO     epoch complete!
2024-09-04 12:09:01 INFO     evaluating now!
2024-09-04 12:09:02 INFO     Epoch [34/200] train_loss: 1.0315, val_loss: 1.4615, lr: 0.003000, 50.53s
2024-09-04 12:09:52 INFO     epoch complete!
2024-09-04 12:09:52 INFO     evaluating now!
2024-09-04 12:09:53 INFO     Epoch [35/200] train_loss: 1.0293, val_loss: 1.4450, lr: 0.003000, 50.55s
2024-09-04 12:09:53 INFO     Saved model at 35
2024-09-04 12:09:53 INFO     Val loss decrease from 1.4523 to 1.4450, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch35.tar
2024-09-04 12:10:50 INFO     epoch complete!
2024-09-04 12:10:50 INFO     evaluating now!
2024-09-04 12:10:51 INFO     Epoch [36/200] train_loss: 1.0293, val_loss: 1.4528, lr: 0.003000, 57.63s
2024-09-04 12:11:45 INFO     epoch complete!
2024-09-04 12:11:45 INFO     evaluating now!
2024-09-04 12:11:46 INFO     Epoch [37/200] train_loss: 1.0258, val_loss: 1.4554, lr: 0.003000, 55.52s
2024-09-04 12:12:39 INFO     epoch complete!
2024-09-04 12:12:39 INFO     evaluating now!
2024-09-04 12:12:40 INFO     Epoch [38/200] train_loss: 1.0226, val_loss: 1.4631, lr: 0.003000, 53.90s
2024-09-04 12:13:34 INFO     epoch complete!
2024-09-04 12:13:34 INFO     evaluating now!
2024-09-04 12:13:35 INFO     Epoch [39/200] train_loss: 1.0208, val_loss: 1.4674, lr: 0.003000, 55.17s
2024-09-04 12:14:31 INFO     epoch complete!
2024-09-04 12:14:31 INFO     evaluating now!
2024-09-04 12:14:32 INFO     Epoch [40/200] train_loss: 1.0205, val_loss: 1.4644, lr: 0.003000, 56.84s
2024-09-04 12:15:24 INFO     epoch complete!
2024-09-04 12:15:24 INFO     evaluating now!
2024-09-04 12:15:25 INFO     Epoch [41/200] train_loss: 1.0176, val_loss: 1.4620, lr: 0.003000, 53.26s
2024-09-04 12:16:18 INFO     epoch complete!
2024-09-04 12:16:18 INFO     evaluating now!
2024-09-04 12:16:18 INFO     Epoch [42/200] train_loss: 1.0156, val_loss: 1.4561, lr: 0.003000, 53.27s
2024-09-04 12:17:12 INFO     epoch complete!
2024-09-04 12:17:12 INFO     evaluating now!
2024-09-04 12:17:13 INFO     Epoch [43/200] train_loss: 1.0154, val_loss: 1.4518, lr: 0.003000, 54.11s
2024-09-04 12:18:06 INFO     epoch complete!
2024-09-04 12:18:06 INFO     evaluating now!
2024-09-04 12:18:07 INFO     Epoch [44/200] train_loss: 1.0125, val_loss: 1.4510, lr: 0.003000, 54.29s
2024-09-04 12:19:01 INFO     epoch complete!
2024-09-04 12:19:01 INFO     evaluating now!
2024-09-04 12:19:02 INFO     Epoch [45/200] train_loss: 1.0135, val_loss: 1.4613, lr: 0.003000, 54.83s
2024-09-04 12:19:55 INFO     epoch complete!
2024-09-04 12:19:55 INFO     evaluating now!
2024-09-04 12:19:55 INFO     Epoch [46/200] train_loss: 1.0093, val_loss: 1.4582, lr: 0.003000, 53.71s
2024-09-04 12:20:49 INFO     epoch complete!
2024-09-04 12:20:49 INFO     evaluating now!
2024-09-04 12:20:50 INFO     Epoch [47/200] train_loss: 1.0068, val_loss: 1.4482, lr: 0.003000, 54.41s
2024-09-04 12:21:49 INFO     epoch complete!
2024-09-04 12:21:49 INFO     evaluating now!
2024-09-04 12:21:50 INFO     Epoch [48/200] train_loss: 1.0064, val_loss: 1.4537, lr: 0.003000, 60.46s
2024-09-04 12:22:51 INFO     epoch complete!
2024-09-04 12:22:51 INFO     evaluating now!
2024-09-04 12:22:52 INFO     Epoch [49/200] train_loss: 1.0039, val_loss: 1.4592, lr: 0.003000, 61.74s
2024-09-04 12:23:47 INFO     epoch complete!
2024-09-04 12:23:47 INFO     evaluating now!
2024-09-04 12:23:48 INFO     Epoch [50/200] train_loss: 1.0023, val_loss: 1.4559, lr: 0.003000, 55.95s
2024-09-04 12:23:48 WARNING  Early stopping at epoch: 50
2024-09-04 12:23:48 INFO     Trained totally 51 epochs, average train time is 51.133s, average eval time is 0.943s
2024-09-04 12:23:48 INFO     Loaded model at 35
2024-09-04 12:23:48 INFO     Saved model at ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406.m
2024-09-04 12:23:48 INFO     Start evaluating ...
2024-09-04 12:23:51 INFO     Note that you select the single mode to evaluate!
2024-09-04 12:23:51 INFO     Evaluate result is saved at ./libcity/cache/3015/evaluate_cache\2024_09_04_12_23_51_AGCRN_NYCTaxi20200406.csv
2024-09-04 12:23:51 INFO     
         MAE      RMSE
1   1.332092  2.420914
2   1.332376  2.414584
3   1.332470  2.401793
4   1.343267  2.440321
5   1.354536  2.474953
6   1.358039  2.487662
7   1.374823  2.539944
8   1.399235  2.596329
9   1.412614  2.668456
10  1.432487  2.739459
11  1.453396  2.823130
12  1.472152  2.914350
2024-09-04 12:23:51 INFO     ----------------------------------------------------------------------------
2024-09-04 12:23:51 INFO     # 3, Kownledge Graph Embedding: GIE, Experiment ids: 3018
2024-09-04 12:23:51 INFO     ----------------------------------------------------------------------------
2024-09-04 12:23:51 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=NYCTaxi20200406, exp_id=3015
2024-09-04 12:23:51 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'NYCTaxi20200406', 'saved_model': True, 'train': True, 'exp_id': 3015, 'embedding_model': 'GIE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['NYCTaxi20200406'], 'geo_file': 'NYCTaxi20200406', 'rel_file': 'NYCTaxi20200406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-04 12:23:51 INFO     Loaded file NYCTaxi20200406.geo, num_nodes=260
2024-09-04 12:23:51 INFO     set_weight_link_or_dist: dist
2024-09-04 12:23:51 INFO     init_weight_inf_or_zero: inf
2024-09-04 12:23:52 INFO     Loaded file NYCTaxi20200406.rel, shape=(260, 260)
2024-09-04 12:23:52 INFO     Start Calculate the weight by Gauss kernel!
2024-09-04 12:23:52 INFO     Loading file NYCTaxi20200406.dyna
2024-09-04 12:23:52 INFO     Loaded file NYCTaxi20200406.dyna, shape=(4368, 260, 2)
2024-09-04 12:23:57 INFO     Dataset created
2024-09-04 12:23:57 INFO     x shape: (4345, 12, 260, 34), y shape: (4345, 12, 260, 34)
2024-09-04 12:23:57 INFO     train	x: (3042, 12, 260, 34), y: (3042, 12, 260, 34)
2024-09-04 12:23:57 INFO     eval	x: (434, 12, 260, 34), y: (434, 12, 260, 34)
2024-09-04 12:23:57 INFO     test	x: (869, 12, 260, 34), y: (869, 12, 260, 34)
2024-09-04 12:23:58 INFO     StandardScaler mean: 0.7727858064026704, std: 2.3026817046377195
2024-09-04 12:23:58 INFO     NormalScaler max: 0.659603814907769
2024-09-04 12:24:05 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-04 12:24:05 INFO     node_embeddings	torch.Size([260, 10])	cuda:0	True
2024-09-04 12:24:05 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-04 12:24:05 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-04 12:24:05 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-04 12:24:05 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-04 12:24:05 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-04 12:24:05 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-04 12:24:05 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-04 12:24:05 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-04 12:24:05 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-04 12:24:05 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-04 12:24:05 INFO     Total parameter numbers: 875840
2024-09-04 12:24:05 INFO     You select `adam` optimizer.
2024-09-04 12:24:05 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-04 12:24:05 INFO     Start training ...
2024-09-04 12:24:05 INFO     num_batches:48
2024-09-04 12:24:58 INFO     epoch complete!
2024-09-04 12:24:58 INFO     evaluating now!
2024-09-04 12:24:59 INFO     Epoch [0/200] train_loss: 1.8510, val_loss: 2.3792, lr: 0.003000, 53.67s
2024-09-04 12:24:59 INFO     Saved model at 0
2024-09-04 12:24:59 INFO     Val loss decrease from inf to 2.3792, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch0.tar
2024-09-04 12:25:53 INFO     epoch complete!
2024-09-04 12:25:53 INFO     evaluating now!
2024-09-04 12:25:54 INFO     Epoch [1/200] train_loss: 1.4925, val_loss: 2.0232, lr: 0.003000, 54.86s
2024-09-04 12:25:54 INFO     Saved model at 1
2024-09-04 12:25:54 INFO     Val loss decrease from 2.3792 to 2.0232, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch1.tar
2024-09-04 12:26:48 INFO     epoch complete!
2024-09-04 12:26:48 INFO     evaluating now!
2024-09-04 12:26:49 INFO     Epoch [2/200] train_loss: 1.3327, val_loss: 1.8502, lr: 0.003000, 55.28s
2024-09-04 12:26:49 INFO     Saved model at 2
2024-09-04 12:26:49 INFO     Val loss decrease from 2.0232 to 1.8502, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch2.tar
2024-09-04 12:27:41 INFO     epoch complete!
2024-09-04 12:27:41 INFO     evaluating now!
2024-09-04 12:27:43 INFO     Epoch [3/200] train_loss: 1.2705, val_loss: 1.7734, lr: 0.003000, 53.56s
2024-09-04 12:27:43 INFO     Saved model at 3
2024-09-04 12:27:43 INFO     Val loss decrease from 1.8502 to 1.7734, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch3.tar
2024-09-04 12:28:36 INFO     epoch complete!
2024-09-04 12:28:36 INFO     evaluating now!
2024-09-04 12:28:37 INFO     Epoch [4/200] train_loss: 1.2266, val_loss: 1.7046, lr: 0.003000, 54.70s
2024-09-04 12:28:37 INFO     Saved model at 4
2024-09-04 12:28:37 INFO     Val loss decrease from 1.7734 to 1.7046, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch4.tar
2024-09-04 12:29:30 INFO     epoch complete!
2024-09-04 12:29:30 INFO     evaluating now!
2024-09-04 12:29:31 INFO     Epoch [5/200] train_loss: 1.2039, val_loss: 1.6738, lr: 0.003000, 53.45s
2024-09-04 12:29:31 INFO     Saved model at 5
2024-09-04 12:29:31 INFO     Val loss decrease from 1.7046 to 1.6738, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch5.tar
2024-09-04 12:30:24 INFO     epoch complete!
2024-09-04 12:30:24 INFO     evaluating now!
2024-09-04 12:30:24 INFO     Epoch [6/200] train_loss: 1.1907, val_loss: 1.6569, lr: 0.003000, 53.70s
2024-09-04 12:30:24 INFO     Saved model at 6
2024-09-04 12:30:24 INFO     Val loss decrease from 1.6738 to 1.6569, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch6.tar
2024-09-04 12:31:22 INFO     epoch complete!
2024-09-04 12:31:22 INFO     evaluating now!
2024-09-04 12:31:23 INFO     Epoch [7/200] train_loss: 1.1762, val_loss: 1.5907, lr: 0.003000, 58.42s
2024-09-04 12:31:23 INFO     Saved model at 7
2024-09-04 12:31:23 INFO     Val loss decrease from 1.6569 to 1.5907, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch7.tar
2024-09-04 12:32:19 INFO     epoch complete!
2024-09-04 12:32:19 INFO     evaluating now!
2024-09-04 12:32:20 INFO     Epoch [8/200] train_loss: 1.1601, val_loss: 1.6170, lr: 0.003000, 56.83s
2024-09-04 12:33:14 INFO     epoch complete!
2024-09-04 12:33:14 INFO     evaluating now!
2024-09-04 12:33:15 INFO     Epoch [9/200] train_loss: 1.1492, val_loss: 1.5834, lr: 0.003000, 55.48s
2024-09-04 12:33:15 INFO     Saved model at 9
2024-09-04 12:33:15 INFO     Val loss decrease from 1.5907 to 1.5834, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch9.tar
2024-09-04 12:34:14 INFO     epoch complete!
2024-09-04 12:34:14 INFO     evaluating now!
2024-09-04 12:34:14 INFO     Epoch [10/200] train_loss: 1.1433, val_loss: 1.5734, lr: 0.003000, 59.21s
2024-09-04 12:34:14 INFO     Saved model at 10
2024-09-04 12:34:14 INFO     Val loss decrease from 1.5834 to 1.5734, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch10.tar
2024-09-04 12:35:14 INFO     epoch complete!
2024-09-04 12:35:14 INFO     evaluating now!
2024-09-04 12:35:15 INFO     Epoch [11/200] train_loss: 1.1343, val_loss: 1.5337, lr: 0.003000, 60.56s
2024-09-04 12:35:15 INFO     Saved model at 11
2024-09-04 12:35:15 INFO     Val loss decrease from 1.5734 to 1.5337, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch11.tar
2024-09-04 12:36:07 INFO     epoch complete!
2024-09-04 12:36:07 INFO     evaluating now!
2024-09-04 12:36:08 INFO     Epoch [12/200] train_loss: 1.1282, val_loss: 1.5468, lr: 0.003000, 52.77s
2024-09-04 12:36:59 INFO     epoch complete!
2024-09-04 12:36:59 INFO     evaluating now!
2024-09-04 12:37:00 INFO     Epoch [13/200] train_loss: 1.1191, val_loss: 1.5522, lr: 0.003000, 52.73s
2024-09-04 12:37:52 INFO     epoch complete!
2024-09-04 12:37:52 INFO     evaluating now!
2024-09-04 12:37:53 INFO     Epoch [14/200] train_loss: 1.1115, val_loss: 1.5268, lr: 0.003000, 52.46s
2024-09-04 12:37:53 INFO     Saved model at 14
2024-09-04 12:37:53 INFO     Val loss decrease from 1.5337 to 1.5268, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch14.tar
2024-09-04 12:38:45 INFO     epoch complete!
2024-09-04 12:38:45 INFO     evaluating now!
2024-09-04 12:38:46 INFO     Epoch [15/200] train_loss: 1.1057, val_loss: 1.5199, lr: 0.003000, 52.84s
2024-09-04 12:38:46 INFO     Saved model at 15
2024-09-04 12:38:46 INFO     Val loss decrease from 1.5268 to 1.5199, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch15.tar
2024-09-04 12:39:37 INFO     epoch complete!
2024-09-04 12:39:37 INFO     evaluating now!
2024-09-04 12:39:38 INFO     Epoch [16/200] train_loss: 1.1060, val_loss: 1.4959, lr: 0.003000, 52.38s
2024-09-04 12:39:38 INFO     Saved model at 16
2024-09-04 12:39:38 INFO     Val loss decrease from 1.5199 to 1.4959, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch16.tar
2024-09-04 12:40:30 INFO     epoch complete!
2024-09-04 12:40:30 INFO     evaluating now!
2024-09-04 12:40:31 INFO     Epoch [17/200] train_loss: 1.0925, val_loss: 1.4822, lr: 0.003000, 52.84s
2024-09-04 12:40:31 INFO     Saved model at 17
2024-09-04 12:40:31 INFO     Val loss decrease from 1.4959 to 1.4822, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch17.tar
2024-09-04 12:41:24 INFO     epoch complete!
2024-09-04 12:41:24 INFO     evaluating now!
2024-09-04 12:41:25 INFO     Epoch [18/200] train_loss: 1.0871, val_loss: 1.4833, lr: 0.003000, 53.56s
2024-09-04 12:42:18 INFO     epoch complete!
2024-09-04 12:42:18 INFO     evaluating now!
2024-09-04 12:42:18 INFO     Epoch [19/200] train_loss: 1.0804, val_loss: 1.5094, lr: 0.003000, 53.76s
2024-09-04 12:43:11 INFO     epoch complete!
2024-09-04 12:43:11 INFO     evaluating now!
2024-09-04 12:43:12 INFO     Epoch [20/200] train_loss: 1.0811, val_loss: 1.4843, lr: 0.003000, 53.41s
2024-09-04 12:44:06 INFO     epoch complete!
2024-09-04 12:44:06 INFO     evaluating now!
2024-09-04 12:44:07 INFO     Epoch [21/200] train_loss: 1.0784, val_loss: 1.4763, lr: 0.003000, 54.81s
2024-09-04 12:44:07 INFO     Saved model at 21
2024-09-04 12:44:07 INFO     Val loss decrease from 1.4822 to 1.4763, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch21.tar
2024-09-04 12:44:59 INFO     epoch complete!
2024-09-04 12:44:59 INFO     evaluating now!
2024-09-04 12:45:00 INFO     Epoch [22/200] train_loss: 1.0667, val_loss: 1.4813, lr: 0.003000, 53.20s
2024-09-04 12:45:53 INFO     epoch complete!
2024-09-04 12:45:53 INFO     evaluating now!
2024-09-04 12:45:54 INFO     Epoch [23/200] train_loss: 1.0629, val_loss: 1.4684, lr: 0.003000, 53.73s
2024-09-04 12:45:54 INFO     Saved model at 23
2024-09-04 12:45:54 INFO     Val loss decrease from 1.4763 to 1.4684, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch23.tar
2024-09-04 12:46:46 INFO     epoch complete!
2024-09-04 12:46:46 INFO     evaluating now!
2024-09-04 12:46:46 INFO     Epoch [24/200] train_loss: 1.0572, val_loss: 1.4441, lr: 0.003000, 52.73s
2024-09-04 12:46:46 INFO     Saved model at 24
2024-09-04 12:46:46 INFO     Val loss decrease from 1.4684 to 1.4441, saving to ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406_epoch24.tar
2024-09-04 12:47:39 INFO     epoch complete!
2024-09-04 12:47:39 INFO     evaluating now!
2024-09-04 12:47:40 INFO     Epoch [25/200] train_loss: 1.0549, val_loss: 1.4693, lr: 0.003000, 53.33s
2024-09-04 12:48:34 INFO     epoch complete!
2024-09-04 12:48:34 INFO     evaluating now!
2024-09-04 12:48:35 INFO     Epoch [26/200] train_loss: 1.0535, val_loss: 1.4769, lr: 0.003000, 55.37s
2024-09-04 12:49:29 INFO     epoch complete!
2024-09-04 12:49:29 INFO     evaluating now!
2024-09-04 12:49:29 INFO     Epoch [27/200] train_loss: 1.0463, val_loss: 1.4625, lr: 0.003000, 54.39s
2024-09-04 12:50:22 INFO     epoch complete!
2024-09-04 12:50:22 INFO     evaluating now!
2024-09-04 12:50:23 INFO     Epoch [28/200] train_loss: 1.0433, val_loss: 1.4529, lr: 0.003000, 53.15s
2024-09-04 12:51:16 INFO     epoch complete!
2024-09-04 12:51:16 INFO     evaluating now!
2024-09-04 12:51:17 INFO     Epoch [29/200] train_loss: 1.0392, val_loss: 1.4698, lr: 0.003000, 54.56s
2024-09-04 12:52:13 INFO     epoch complete!
2024-09-04 12:52:13 INFO     evaluating now!
2024-09-04 12:52:13 INFO     Epoch [30/200] train_loss: 1.0384, val_loss: 1.4782, lr: 0.003000, 56.29s
2024-09-04 12:53:11 INFO     epoch complete!
2024-09-04 12:53:11 INFO     evaluating now!
2024-09-04 12:53:11 INFO     Epoch [31/200] train_loss: 1.0363, val_loss: 1.4668, lr: 0.003000, 58.07s
2024-09-04 12:54:13 INFO     epoch complete!
2024-09-04 12:54:13 INFO     evaluating now!
2024-09-04 12:54:14 INFO     Epoch [32/200] train_loss: 1.0331, val_loss: 1.4498, lr: 0.003000, 62.08s
2024-09-04 12:55:12 INFO     epoch complete!
2024-09-04 12:55:12 INFO     evaluating now!
2024-09-04 12:55:13 INFO     Epoch [33/200] train_loss: 1.0309, val_loss: 1.4641, lr: 0.003000, 59.84s
2024-09-04 12:56:05 INFO     epoch complete!
2024-09-04 12:56:05 INFO     evaluating now!
2024-09-04 12:56:05 INFO     Epoch [34/200] train_loss: 1.0311, val_loss: 1.4928, lr: 0.003000, 51.86s
2024-09-04 12:56:58 INFO     epoch complete!
2024-09-04 12:56:58 INFO     evaluating now!
2024-09-04 12:56:59 INFO     Epoch [35/200] train_loss: 1.0292, val_loss: 1.4627, lr: 0.003000, 53.71s
2024-09-04 12:57:51 INFO     epoch complete!
2024-09-04 12:57:51 INFO     evaluating now!
2024-09-04 12:57:52 INFO     Epoch [36/200] train_loss: 1.0233, val_loss: 1.4688, lr: 0.003000, 52.64s
2024-09-04 12:58:45 INFO     epoch complete!
2024-09-04 12:58:45 INFO     evaluating now!
2024-09-04 12:58:45 INFO     Epoch [37/200] train_loss: 1.0221, val_loss: 1.4514, lr: 0.003000, 53.80s
2024-09-04 12:59:38 INFO     epoch complete!
2024-09-04 12:59:38 INFO     evaluating now!
2024-09-04 12:59:39 INFO     Epoch [38/200] train_loss: 1.0183, val_loss: 1.4573, lr: 0.003000, 53.77s
2024-09-04 13:00:33 INFO     epoch complete!
2024-09-04 13:00:33 INFO     evaluating now!
2024-09-04 13:00:34 INFO     Epoch [39/200] train_loss: 1.0176, val_loss: 1.4520, lr: 0.003000, 54.58s
2024-09-04 13:00:34 WARNING  Early stopping at epoch: 39
2024-09-04 13:00:34 INFO     Trained totally 40 epochs, average train time is 53.884s, average eval time is 0.826s
2024-09-04 13:00:34 INFO     Loaded model at 24
2024-09-04 13:00:34 INFO     Saved model at ./libcity/cache/3015/model_cache/AGCRN_NYCTaxi20200406.m
2024-09-04 13:00:34 INFO     Start evaluating ...
2024-09-04 13:00:37 INFO     Note that you select the single mode to evaluate!
2024-09-04 13:00:37 INFO     Evaluate result is saved at ./libcity/cache/3015/evaluate_cache\2024_09_04_13_00_37_AGCRN_NYCTaxi20200406.csv
2024-09-04 13:00:37 INFO     
         MAE      RMSE
1   1.347207  2.464178
2   1.346700  2.465366
3   1.340266  2.427905
4   1.349437  2.462556
5   1.351082  2.492150
6   1.362982  2.526717
7   1.378288  2.585270
8   1.392982  2.634909
9   1.409812  2.696678
10  1.429356  2.758977
11  1.442770  2.836457
12  1.466397  2.916256
2024-09-04 13:00:38 INFO     ----------------------------------------------------------------------------
2024-09-04 13:00:38 INFO     # 4, Kownledge Graph Embedding: GIE, Experiment ids: 3019
2024-09-04 13:00:38 INFO     ----------------------------------------------------------------------------
2024-09-04 13:00:38 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=NYCTaxi20200406, exp_id=3015
2024-09-04 13:00:38 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'NYCTaxi20200406', 'saved_model': True, 'train': True, 'exp_id': 3015, 'embedding_model': 'GIE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['NYCTaxi20200406'], 'geo_file': 'NYCTaxi20200406', 'rel_file': 'NYCTaxi20200406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-04 13:00:38 INFO     Loaded file NYCTaxi20200406.geo, num_nodes=260
2024-09-04 13:00:38 INFO     set_weight_link_or_dist: dist
2024-09-04 13:00:38 INFO     init_weight_inf_or_zero: inf
2024-09-04 13:00:38 INFO     Loaded file NYCTaxi20200406.rel, shape=(260, 260)
2024-09-04 13:00:38 INFO     Start Calculate the weight by Gauss kernel!
2024-09-04 13:00:38 INFO     Loading file NYCTaxi20200406.dyna
2024-09-04 13:00:38 INFO     Loaded file NYCTaxi20200406.dyna, shape=(4368, 260, 2)
2024-09-04 13:00:43 INFO     Dataset created
2024-09-04 13:00:43 INFO     x shape: (4345, 12, 260, 34), y shape: (4345, 12, 260, 34)
2024-09-04 13:00:44 INFO     train	x: (3042, 12, 260, 34), y: (3042, 12, 260, 34)
2024-09-04 13:00:44 INFO     eval	x: (434, 12, 260, 34), y: (434, 12, 260, 34)
2024-09-04 13:00:44 INFO     test	x: (869, 12, 260, 34), y: (869, 12, 260, 34)
2024-09-04 13:00:44 INFO     StandardScaler mean: 0.7727858064026704, std: 2.3026817046377195
2024-09-04 13:00:44 INFO     NormalScaler max: 0.659603814907769
