2024-09-04 09:35:06 INFO     Saving logs in: ./logs/NYCTaxi20200406\AGCRN\ExtNone\
2024-09-04 09:35:06 INFO     ----------------------------------------------------------------------------
2024-09-04 09:35:06 INFO     # 0, Kownledge Graph Embedding: Normal, Experiment ids: 3000
2024-09-04 09:35:06 INFO     ----------------------------------------------------------------------------
2024-09-04 09:35:06 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=NYCTaxi20200406, exp_id=3000
2024-09-04 09:35:06 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'NYCTaxi20200406', 'saved_model': True, 'train': True, 'exp_id': 3000, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['NYCTaxi20200406'], 'geo_file': 'NYCTaxi20200406', 'rel_file': 'NYCTaxi20200406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-04 09:35:06 INFO     Loaded file NYCTaxi20200406.geo, num_nodes=260
2024-09-04 09:35:06 INFO     set_weight_link_or_dist: dist
2024-09-04 09:35:06 INFO     init_weight_inf_or_zero: inf
2024-09-04 09:35:07 INFO     Loaded file NYCTaxi20200406.rel, shape=(260, 260)
2024-09-04 09:35:07 INFO     Start Calculate the weight by Gauss kernel!
2024-09-04 09:35:07 INFO     Loading file NYCTaxi20200406.dyna
2024-09-04 09:35:07 INFO     Loaded file NYCTaxi20200406.dyna, shape=(4368, 260, 2)
2024-09-04 09:35:08 INFO     Dataset created
2024-09-04 09:35:08 INFO     x shape: (4345, 12, 260, 2), y shape: (4345, 12, 260, 2)
2024-09-04 09:35:08 INFO     train	x: (3042, 12, 260, 2), y: (3042, 12, 260, 2)
2024-09-04 09:35:08 INFO     eval	x: (434, 12, 260, 2), y: (434, 12, 260, 2)
2024-09-04 09:35:08 INFO     test	x: (869, 12, 260, 2), y: (869, 12, 260, 2)
2024-09-04 09:35:08 INFO     StandardScaler mean: 0.7727858064026704, std: 2.3026817046377195
2024-09-04 09:35:08 INFO     NoneScaler
2024-09-04 09:35:10 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-04 09:35:10 INFO     node_embeddings	torch.Size([260, 10])	cuda:0	True
2024-09-04 09:35:10 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-04 09:35:10 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-04 09:35:10 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-04 09:35:10 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-04 09:35:10 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-04 09:35:10 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-04 09:35:10 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-04 09:35:10 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-04 09:35:10 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-04 09:35:10 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-04 09:35:10 INFO     Total parameter numbers: 752960
2024-09-04 09:35:10 INFO     You select `adam` optimizer.
2024-09-04 09:35:10 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-04 09:35:10 INFO     Start training ...
2024-09-04 09:35:10 INFO     num_batches:48
2024-09-04 09:35:21 INFO     epoch complete!
2024-09-04 09:35:21 INFO     evaluating now!
2024-09-04 09:35:21 INFO     Epoch [0/200] train_loss: 1.8855, val_loss: 2.3919, lr: 0.003000, 11.27s
2024-09-04 09:35:21 INFO     Saved model at 0
2024-09-04 09:35:21 INFO     Val loss decrease from inf to 2.3919, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch0.tar
2024-09-04 09:35:29 INFO     epoch complete!
2024-09-04 09:35:29 INFO     evaluating now!
2024-09-04 09:35:29 INFO     Epoch [1/200] train_loss: 1.5104, val_loss: 2.0623, lr: 0.003000, 7.80s
2024-09-04 09:35:29 INFO     Saved model at 1
2024-09-04 09:35:29 INFO     Val loss decrease from 2.3919 to 2.0623, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch1.tar
2024-09-04 09:35:36 INFO     epoch complete!
2024-09-04 09:35:36 INFO     evaluating now!
2024-09-04 09:35:37 INFO     Epoch [2/200] train_loss: 1.3384, val_loss: 1.8537, lr: 0.003000, 7.82s
2024-09-04 09:35:37 INFO     Saved model at 2
2024-09-04 09:35:37 INFO     Val loss decrease from 2.0623 to 1.8537, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch2.tar
2024-09-04 09:35:44 INFO     epoch complete!
2024-09-04 09:35:44 INFO     evaluating now!
2024-09-04 09:35:45 INFO     Epoch [3/200] train_loss: 1.2544, val_loss: 1.7553, lr: 0.003000, 7.85s
2024-09-04 09:35:45 INFO     Saved model at 3
2024-09-04 09:35:45 INFO     Val loss decrease from 1.8537 to 1.7553, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch3.tar
2024-09-04 09:35:52 INFO     epoch complete!
2024-09-04 09:35:52 INFO     evaluating now!
2024-09-04 09:35:52 INFO     Epoch [4/200] train_loss: 1.2117, val_loss: 1.6762, lr: 0.003000, 7.90s
2024-09-04 09:35:52 INFO     Saved model at 4
2024-09-04 09:35:52 INFO     Val loss decrease from 1.7553 to 1.6762, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch4.tar
2024-09-04 09:36:00 INFO     epoch complete!
2024-09-04 09:36:00 INFO     evaluating now!
2024-09-04 09:36:00 INFO     Epoch [5/200] train_loss: 1.1936, val_loss: 1.6771, lr: 0.003000, 7.90s
2024-09-04 09:36:08 INFO     epoch complete!
2024-09-04 09:36:08 INFO     evaluating now!
2024-09-04 09:36:08 INFO     Epoch [6/200] train_loss: 1.1790, val_loss: 1.6022, lr: 0.003000, 7.73s
2024-09-04 09:36:08 INFO     Saved model at 6
2024-09-04 09:36:08 INFO     Val loss decrease from 1.6762 to 1.6022, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch6.tar
2024-09-04 09:36:16 INFO     epoch complete!
2024-09-04 09:36:16 INFO     evaluating now!
2024-09-04 09:36:16 INFO     Epoch [7/200] train_loss: 1.1609, val_loss: 1.6059, lr: 0.003000, 7.76s
2024-09-04 09:36:23 INFO     epoch complete!
2024-09-04 09:36:23 INFO     evaluating now!
2024-09-04 09:36:24 INFO     Epoch [8/200] train_loss: 1.1490, val_loss: 1.5674, lr: 0.003000, 7.72s
2024-09-04 09:36:24 INFO     Saved model at 8
2024-09-04 09:36:24 INFO     Val loss decrease from 1.6022 to 1.5674, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch8.tar
2024-09-04 09:36:31 INFO     epoch complete!
2024-09-04 09:36:31 INFO     evaluating now!
2024-09-04 09:36:31 INFO     Epoch [9/200] train_loss: 1.1397, val_loss: 1.5470, lr: 0.003000, 7.80s
2024-09-04 09:36:31 INFO     Saved model at 9
2024-09-04 09:36:31 INFO     Val loss decrease from 1.5674 to 1.5470, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch9.tar
2024-09-04 09:36:39 INFO     epoch complete!
2024-09-04 09:36:39 INFO     evaluating now!
2024-09-04 09:36:39 INFO     Epoch [10/200] train_loss: 1.1294, val_loss: 1.5125, lr: 0.003000, 7.75s
2024-09-04 09:36:39 INFO     Saved model at 10
2024-09-04 09:36:39 INFO     Val loss decrease from 1.5470 to 1.5125, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch10.tar
2024-09-04 09:36:47 INFO     epoch complete!
2024-09-04 09:36:47 INFO     evaluating now!
2024-09-04 09:36:47 INFO     Epoch [11/200] train_loss: 1.1217, val_loss: 1.5221, lr: 0.003000, 7.74s
2024-09-04 09:36:54 INFO     epoch complete!
2024-09-04 09:36:54 INFO     evaluating now!
2024-09-04 09:36:55 INFO     Epoch [12/200] train_loss: 1.1146, val_loss: 1.4820, lr: 0.003000, 7.73s
2024-09-04 09:36:55 INFO     Saved model at 12
2024-09-04 09:36:55 INFO     Val loss decrease from 1.5125 to 1.4820, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch12.tar
2024-09-04 09:37:02 INFO     epoch complete!
2024-09-04 09:37:02 INFO     evaluating now!
2024-09-04 09:37:02 INFO     Epoch [13/200] train_loss: 1.1053, val_loss: 1.5206, lr: 0.003000, 7.76s
2024-09-04 09:37:10 INFO     epoch complete!
2024-09-04 09:37:10 INFO     evaluating now!
2024-09-04 09:37:10 INFO     Epoch [14/200] train_loss: 1.1041, val_loss: 1.4938, lr: 0.003000, 7.91s
2024-09-04 09:37:18 INFO     epoch complete!
2024-09-04 09:37:18 INFO     evaluating now!
2024-09-04 09:37:18 INFO     Epoch [15/200] train_loss: 1.0965, val_loss: 1.4651, lr: 0.003000, 7.84s
2024-09-04 09:37:18 INFO     Saved model at 15
2024-09-04 09:37:18 INFO     Val loss decrease from 1.4820 to 1.4651, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch15.tar
2024-09-04 09:37:26 INFO     epoch complete!
2024-09-04 09:37:26 INFO     evaluating now!
2024-09-04 09:37:26 INFO     Epoch [16/200] train_loss: 1.0905, val_loss: 1.4802, lr: 0.003000, 7.92s
2024-09-04 09:37:34 INFO     epoch complete!
2024-09-04 09:37:34 INFO     evaluating now!
2024-09-04 09:37:34 INFO     Epoch [17/200] train_loss: 1.0885, val_loss: 1.4675, lr: 0.003000, 7.82s
2024-09-04 09:37:41 INFO     epoch complete!
2024-09-04 09:37:41 INFO     evaluating now!
2024-09-04 09:37:42 INFO     Epoch [18/200] train_loss: 1.0851, val_loss: 1.4658, lr: 0.003000, 7.81s
2024-09-04 09:37:49 INFO     epoch complete!
2024-09-04 09:37:49 INFO     evaluating now!
2024-09-04 09:37:49 INFO     Epoch [19/200] train_loss: 1.0805, val_loss: 1.4609, lr: 0.003000, 7.77s
2024-09-04 09:37:50 INFO     Saved model at 19
2024-09-04 09:37:50 INFO     Val loss decrease from 1.4651 to 1.4609, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch19.tar
2024-09-04 09:37:57 INFO     epoch complete!
2024-09-04 09:37:57 INFO     evaluating now!
2024-09-04 09:37:57 INFO     Epoch [20/200] train_loss: 1.0742, val_loss: 1.4516, lr: 0.003000, 7.73s
2024-09-04 09:37:57 INFO     Saved model at 20
2024-09-04 09:37:57 INFO     Val loss decrease from 1.4609 to 1.4516, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch20.tar
2024-09-04 09:38:05 INFO     epoch complete!
2024-09-04 09:38:05 INFO     evaluating now!
2024-09-04 09:38:05 INFO     Epoch [21/200] train_loss: 1.0661, val_loss: 1.4521, lr: 0.003000, 7.82s
2024-09-04 09:38:13 INFO     epoch complete!
2024-09-04 09:38:13 INFO     evaluating now!
2024-09-04 09:38:13 INFO     Epoch [22/200] train_loss: 1.0667, val_loss: 1.4475, lr: 0.003000, 7.83s
2024-09-04 09:38:13 INFO     Saved model at 22
2024-09-04 09:38:13 INFO     Val loss decrease from 1.4516 to 1.4475, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch22.tar
2024-09-04 09:38:20 INFO     epoch complete!
2024-09-04 09:38:20 INFO     evaluating now!
2024-09-04 09:38:21 INFO     Epoch [23/200] train_loss: 1.0598, val_loss: 1.4630, lr: 0.003000, 7.84s
2024-09-04 09:38:28 INFO     epoch complete!
2024-09-04 09:38:28 INFO     evaluating now!
2024-09-04 09:38:29 INFO     Epoch [24/200] train_loss: 1.0607, val_loss: 1.4572, lr: 0.003000, 7.78s
2024-09-04 09:38:36 INFO     epoch complete!
2024-09-04 09:38:36 INFO     evaluating now!
2024-09-04 09:38:36 INFO     Epoch [25/200] train_loss: 1.0560, val_loss: 1.4711, lr: 0.003000, 7.78s
2024-09-04 09:38:44 INFO     epoch complete!
2024-09-04 09:38:44 INFO     evaluating now!
2024-09-04 09:38:44 INFO     Epoch [26/200] train_loss: 1.0500, val_loss: 1.4826, lr: 0.003000, 7.85s
2024-09-04 09:38:52 INFO     epoch complete!
2024-09-04 09:38:52 INFO     evaluating now!
2024-09-04 09:38:52 INFO     Epoch [27/200] train_loss: 1.0502, val_loss: 1.4615, lr: 0.003000, 7.73s
2024-09-04 09:38:59 INFO     epoch complete!
2024-09-04 09:38:59 INFO     evaluating now!
2024-09-04 09:39:00 INFO     Epoch [28/200] train_loss: 1.0460, val_loss: 1.4597, lr: 0.003000, 7.74s
2024-09-04 09:39:07 INFO     epoch complete!
2024-09-04 09:39:07 INFO     evaluating now!
2024-09-04 09:39:07 INFO     Epoch [29/200] train_loss: 1.0440, val_loss: 1.4449, lr: 0.003000, 7.75s
2024-09-04 09:39:07 INFO     Saved model at 29
2024-09-04 09:39:07 INFO     Val loss decrease from 1.4475 to 1.4449, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch29.tar
2024-09-04 09:39:15 INFO     epoch complete!
2024-09-04 09:39:15 INFO     evaluating now!
2024-09-04 09:39:15 INFO     Epoch [30/200] train_loss: 1.0403, val_loss: 1.4522, lr: 0.003000, 7.76s
2024-09-04 09:39:23 INFO     epoch complete!
2024-09-04 09:39:23 INFO     evaluating now!
2024-09-04 09:39:23 INFO     Epoch [31/200] train_loss: 1.0368, val_loss: 1.4785, lr: 0.003000, 7.83s
2024-09-04 09:39:31 INFO     epoch complete!
2024-09-04 09:39:31 INFO     evaluating now!
2024-09-04 09:39:31 INFO     Epoch [32/200] train_loss: 1.0387, val_loss: 1.4319, lr: 0.003000, 7.95s
2024-09-04 09:39:31 INFO     Saved model at 32
2024-09-04 09:39:31 INFO     Val loss decrease from 1.4449 to 1.4319, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch32.tar
2024-09-04 09:39:38 INFO     epoch complete!
2024-09-04 09:39:38 INFO     evaluating now!
2024-09-04 09:39:39 INFO     Epoch [33/200] train_loss: 1.0351, val_loss: 1.4435, lr: 0.003000, 7.90s
2024-09-04 09:39:46 INFO     epoch complete!
2024-09-04 09:39:46 INFO     evaluating now!
2024-09-04 09:39:47 INFO     Epoch [34/200] train_loss: 1.0314, val_loss: 1.4564, lr: 0.003000, 7.75s
2024-09-04 09:39:54 INFO     epoch complete!
2024-09-04 09:39:54 INFO     evaluating now!
2024-09-04 09:39:54 INFO     Epoch [35/200] train_loss: 1.0293, val_loss: 1.4466, lr: 0.003000, 7.86s
2024-09-04 09:40:02 INFO     epoch complete!
2024-09-04 09:40:02 INFO     evaluating now!
2024-09-04 09:40:02 INFO     Epoch [36/200] train_loss: 1.0266, val_loss: 1.4401, lr: 0.003000, 7.82s
2024-09-04 09:40:10 INFO     epoch complete!
2024-09-04 09:40:10 INFO     evaluating now!
2024-09-04 09:40:10 INFO     Epoch [37/200] train_loss: 1.0243, val_loss: 1.4578, lr: 0.003000, 7.83s
2024-09-04 09:40:18 INFO     epoch complete!
2024-09-04 09:40:18 INFO     evaluating now!
2024-09-04 09:40:18 INFO     Epoch [38/200] train_loss: 1.0224, val_loss: 1.4328, lr: 0.003000, 7.77s
2024-09-04 09:40:25 INFO     epoch complete!
2024-09-04 09:40:25 INFO     evaluating now!
2024-09-04 09:40:26 INFO     Epoch [39/200] train_loss: 1.0190, val_loss: 1.4447, lr: 0.003000, 7.75s
2024-09-04 09:40:33 INFO     epoch complete!
2024-09-04 09:40:33 INFO     evaluating now!
2024-09-04 09:40:33 INFO     Epoch [40/200] train_loss: 1.0187, val_loss: 1.4532, lr: 0.003000, 7.82s
2024-09-04 09:40:41 INFO     epoch complete!
2024-09-04 09:40:41 INFO     evaluating now!
2024-09-04 09:40:41 INFO     Epoch [41/200] train_loss: 1.0166, val_loss: 1.4411, lr: 0.003000, 7.78s
2024-09-04 09:40:49 INFO     epoch complete!
2024-09-04 09:40:49 INFO     evaluating now!
2024-09-04 09:40:49 INFO     Epoch [42/200] train_loss: 1.0147, val_loss: 1.4620, lr: 0.003000, 7.78s
2024-09-04 09:40:56 INFO     epoch complete!
2024-09-04 09:40:56 INFO     evaluating now!
2024-09-04 09:40:57 INFO     Epoch [43/200] train_loss: 1.0125, val_loss: 1.4522, lr: 0.003000, 7.72s
2024-09-04 09:41:04 INFO     epoch complete!
2024-09-04 09:41:04 INFO     evaluating now!
2024-09-04 09:41:04 INFO     Epoch [44/200] train_loss: 1.0104, val_loss: 1.4473, lr: 0.003000, 7.71s
2024-09-04 09:41:12 INFO     epoch complete!
2024-09-04 09:41:12 INFO     evaluating now!
2024-09-04 09:41:12 INFO     Epoch [45/200] train_loss: 1.0090, val_loss: 1.4447, lr: 0.003000, 7.82s
2024-09-04 09:41:20 INFO     epoch complete!
2024-09-04 09:41:20 INFO     evaluating now!
2024-09-04 09:41:20 INFO     Epoch [46/200] train_loss: 1.0075, val_loss: 1.4370, lr: 0.003000, 7.74s
2024-09-04 09:41:27 INFO     epoch complete!
2024-09-04 09:41:27 INFO     evaluating now!
2024-09-04 09:41:28 INFO     Epoch [47/200] train_loss: 1.0076, val_loss: 1.4421, lr: 0.003000, 7.69s
2024-09-04 09:41:28 WARNING  Early stopping at epoch: 47
2024-09-04 09:41:28 INFO     Trained totally 48 epochs, average train time is 7.524s, average eval time is 0.345s
2024-09-04 09:41:28 INFO     Loaded model at 32
2024-09-04 09:41:28 INFO     Saved model at ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406.m
2024-09-04 09:41:28 INFO     Start evaluating ...
2024-09-04 09:41:30 INFO     Note that you select the single mode to evaluate!
2024-09-04 09:41:30 INFO     Evaluate result is saved at ./libcity/cache/3000/evaluate_cache\2024_09_04_09_41_30_AGCRN_NYCTaxi20200406.csv
2024-09-04 09:41:30 INFO     
         MAE      RMSE
1   1.306625  2.381655
2   1.315958  2.392948
3   1.307947  2.348996
4   1.323651  2.404117
5   1.330443  2.433671
6   1.330600  2.436959
7   1.345753  2.487574
8   1.344606  2.493263
9   1.361963  2.547035
10  1.370698  2.570452
11  1.381471  2.625368
12  1.414387  2.724739
2024-09-04 09:41:30 INFO     ----------------------------------------------------------------------------
2024-09-04 09:41:30 INFO     # 1, Kownledge Graph Embedding: Normal, Experiment ids: 3001
2024-09-04 09:41:30 INFO     ----------------------------------------------------------------------------
2024-09-04 09:41:30 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=NYCTaxi20200406, exp_id=3000
2024-09-04 09:41:30 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'NYCTaxi20200406', 'saved_model': True, 'train': True, 'exp_id': 3000, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['NYCTaxi20200406'], 'geo_file': 'NYCTaxi20200406', 'rel_file': 'NYCTaxi20200406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-04 09:41:30 INFO     Loaded file NYCTaxi20200406.geo, num_nodes=260
2024-09-04 09:41:30 INFO     set_weight_link_or_dist: dist
2024-09-04 09:41:30 INFO     init_weight_inf_or_zero: inf
2024-09-04 09:41:30 INFO     Loaded file NYCTaxi20200406.rel, shape=(260, 260)
2024-09-04 09:41:30 INFO     Start Calculate the weight by Gauss kernel!
2024-09-04 09:41:30 INFO     Loading file NYCTaxi20200406.dyna
2024-09-04 09:41:31 INFO     Loaded file NYCTaxi20200406.dyna, shape=(4368, 260, 2)
2024-09-04 09:41:31 INFO     Dataset created
2024-09-04 09:41:31 INFO     x shape: (4345, 12, 260, 2), y shape: (4345, 12, 260, 2)
2024-09-04 09:41:31 INFO     train	x: (3042, 12, 260, 2), y: (3042, 12, 260, 2)
2024-09-04 09:41:31 INFO     eval	x: (434, 12, 260, 2), y: (434, 12, 260, 2)
2024-09-04 09:41:31 INFO     test	x: (869, 12, 260, 2), y: (869, 12, 260, 2)
2024-09-04 09:41:32 INFO     StandardScaler mean: 0.7727858064026704, std: 2.3026817046377195
2024-09-04 09:41:32 INFO     NoneScaler
2024-09-04 09:41:32 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-04 09:41:32 INFO     node_embeddings	torch.Size([260, 10])	cuda:0	True
2024-09-04 09:41:32 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-04 09:41:32 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-04 09:41:32 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-04 09:41:32 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-04 09:41:32 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-04 09:41:32 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-04 09:41:32 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-04 09:41:32 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-04 09:41:32 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-04 09:41:32 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-04 09:41:32 INFO     Total parameter numbers: 752960
2024-09-04 09:41:32 INFO     You select `adam` optimizer.
2024-09-04 09:41:32 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-04 09:41:32 INFO     Start training ...
2024-09-04 09:41:32 INFO     num_batches:48
2024-09-04 09:41:40 INFO     epoch complete!
2024-09-04 09:41:40 INFO     evaluating now!
2024-09-04 09:41:40 INFO     Epoch [0/200] train_loss: 1.8813, val_loss: 2.3120, lr: 0.003000, 8.09s
2024-09-04 09:41:40 INFO     Saved model at 0
2024-09-04 09:41:40 INFO     Val loss decrease from inf to 2.3120, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch0.tar
2024-09-04 09:41:47 INFO     epoch complete!
2024-09-04 09:41:47 INFO     evaluating now!
2024-09-04 09:41:48 INFO     Epoch [1/200] train_loss: 1.4618, val_loss: 1.9560, lr: 0.003000, 7.68s
2024-09-04 09:41:48 INFO     Saved model at 1
2024-09-04 09:41:48 INFO     Val loss decrease from 2.3120 to 1.9560, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch1.tar
2024-09-04 09:41:55 INFO     epoch complete!
2024-09-04 09:41:55 INFO     evaluating now!
2024-09-04 09:41:55 INFO     Epoch [2/200] train_loss: 1.3166, val_loss: 1.8241, lr: 0.003000, 7.69s
2024-09-04 09:41:55 INFO     Saved model at 2
2024-09-04 09:41:55 INFO     Val loss decrease from 1.9560 to 1.8241, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch2.tar
2024-09-04 09:42:03 INFO     epoch complete!
2024-09-04 09:42:03 INFO     evaluating now!
2024-09-04 09:42:03 INFO     Epoch [3/200] train_loss: 1.2490, val_loss: 1.7728, lr: 0.003000, 7.73s
2024-09-04 09:42:03 INFO     Saved model at 3
2024-09-04 09:42:03 INFO     Val loss decrease from 1.8241 to 1.7728, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch3.tar
2024-09-04 09:42:11 INFO     epoch complete!
2024-09-04 09:42:11 INFO     evaluating now!
2024-09-04 09:42:11 INFO     Epoch [4/200] train_loss: 1.2146, val_loss: 1.6694, lr: 0.003000, 7.79s
2024-09-04 09:42:11 INFO     Saved model at 4
2024-09-04 09:42:11 INFO     Val loss decrease from 1.7728 to 1.6694, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch4.tar
2024-09-04 09:42:18 INFO     epoch complete!
2024-09-04 09:42:18 INFO     evaluating now!
2024-09-04 09:42:19 INFO     Epoch [5/200] train_loss: 1.1887, val_loss: 1.6391, lr: 0.003000, 7.73s
2024-09-04 09:42:19 INFO     Saved model at 5
2024-09-04 09:42:19 INFO     Val loss decrease from 1.6694 to 1.6391, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch5.tar
2024-09-04 09:42:26 INFO     epoch complete!
2024-09-04 09:42:26 INFO     evaluating now!
2024-09-04 09:42:26 INFO     Epoch [6/200] train_loss: 1.1737, val_loss: 1.6334, lr: 0.003000, 7.74s
2024-09-04 09:42:26 INFO     Saved model at 6
2024-09-04 09:42:26 INFO     Val loss decrease from 1.6391 to 1.6334, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch6.tar
2024-09-04 09:42:34 INFO     epoch complete!
2024-09-04 09:42:34 INFO     evaluating now!
2024-09-04 09:42:34 INFO     Epoch [7/200] train_loss: 1.1627, val_loss: 1.5905, lr: 0.003000, 7.68s
2024-09-04 09:42:34 INFO     Saved model at 7
2024-09-04 09:42:34 INFO     Val loss decrease from 1.6334 to 1.5905, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch7.tar
2024-09-04 09:42:42 INFO     epoch complete!
2024-09-04 09:42:42 INFO     evaluating now!
2024-09-04 09:42:42 INFO     Epoch [8/200] train_loss: 1.1520, val_loss: 1.6054, lr: 0.003000, 7.80s
2024-09-04 09:42:49 INFO     epoch complete!
2024-09-04 09:42:49 INFO     evaluating now!
2024-09-04 09:42:50 INFO     Epoch [9/200] train_loss: 1.1372, val_loss: 1.5660, lr: 0.003000, 7.71s
2024-09-04 09:42:50 INFO     Saved model at 9
2024-09-04 09:42:50 INFO     Val loss decrease from 1.5905 to 1.5660, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch9.tar
2024-09-04 09:42:57 INFO     epoch complete!
2024-09-04 09:42:57 INFO     evaluating now!
2024-09-04 09:42:57 INFO     Epoch [10/200] train_loss: 1.1324, val_loss: 1.5894, lr: 0.003000, 7.73s
2024-09-04 09:43:05 INFO     epoch complete!
2024-09-04 09:43:05 INFO     evaluating now!
2024-09-04 09:43:05 INFO     Epoch [11/200] train_loss: 1.1216, val_loss: 1.5137, lr: 0.003000, 7.70s
2024-09-04 09:43:05 INFO     Saved model at 11
2024-09-04 09:43:05 INFO     Val loss decrease from 1.5660 to 1.5137, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch11.tar
2024-09-04 09:43:13 INFO     epoch complete!
2024-09-04 09:43:13 INFO     evaluating now!
2024-09-04 09:43:13 INFO     Epoch [12/200] train_loss: 1.1195, val_loss: 1.5207, lr: 0.003000, 7.74s
2024-09-04 09:43:20 INFO     epoch complete!
2024-09-04 09:43:20 INFO     evaluating now!
2024-09-04 09:43:21 INFO     Epoch [13/200] train_loss: 1.1119, val_loss: 1.4942, lr: 0.003000, 7.69s
2024-09-04 09:43:21 INFO     Saved model at 13
2024-09-04 09:43:21 INFO     Val loss decrease from 1.5137 to 1.4942, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch13.tar
2024-09-04 09:43:28 INFO     epoch complete!
2024-09-04 09:43:28 INFO     evaluating now!
2024-09-04 09:43:28 INFO     Epoch [14/200] train_loss: 1.1150, val_loss: 1.5130, lr: 0.003000, 7.75s
2024-09-04 09:43:36 INFO     epoch complete!
2024-09-04 09:43:36 INFO     evaluating now!
2024-09-04 09:43:36 INFO     Epoch [15/200] train_loss: 1.0972, val_loss: 1.5004, lr: 0.003000, 7.70s
2024-09-04 09:43:43 INFO     epoch complete!
2024-09-04 09:43:43 INFO     evaluating now!
2024-09-04 09:43:44 INFO     Epoch [16/200] train_loss: 1.0932, val_loss: 1.5147, lr: 0.003000, 7.74s
2024-09-04 09:43:51 INFO     epoch complete!
2024-09-04 09:43:51 INFO     evaluating now!
2024-09-04 09:43:51 INFO     Epoch [17/200] train_loss: 1.0866, val_loss: 1.4739, lr: 0.003000, 7.71s
2024-09-04 09:43:51 INFO     Saved model at 17
2024-09-04 09:43:51 INFO     Val loss decrease from 1.4942 to 1.4739, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch17.tar
2024-09-04 09:43:59 INFO     epoch complete!
2024-09-04 09:43:59 INFO     evaluating now!
2024-09-04 09:43:59 INFO     Epoch [18/200] train_loss: 1.0814, val_loss: 1.5180, lr: 0.003000, 7.78s
2024-09-04 09:44:07 INFO     epoch complete!
2024-09-04 09:44:07 INFO     evaluating now!
2024-09-04 09:44:07 INFO     Epoch [19/200] train_loss: 1.0779, val_loss: 1.4774, lr: 0.003000, 7.75s
2024-09-04 09:44:14 INFO     epoch complete!
2024-09-04 09:44:14 INFO     evaluating now!
2024-09-04 09:44:15 INFO     Epoch [20/200] train_loss: 1.0746, val_loss: 1.4622, lr: 0.003000, 7.74s
2024-09-04 09:44:15 INFO     Saved model at 20
2024-09-04 09:44:15 INFO     Val loss decrease from 1.4739 to 1.4622, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch20.tar
2024-09-04 09:44:22 INFO     epoch complete!
2024-09-04 09:44:22 INFO     evaluating now!
2024-09-04 09:44:22 INFO     Epoch [21/200] train_loss: 1.0670, val_loss: 1.4891, lr: 0.003000, 7.69s
2024-09-04 09:44:30 INFO     epoch complete!
2024-09-04 09:44:30 INFO     evaluating now!
2024-09-04 09:44:30 INFO     Epoch [22/200] train_loss: 1.0692, val_loss: 1.4660, lr: 0.003000, 7.69s
2024-09-04 09:44:37 INFO     epoch complete!
2024-09-04 09:44:37 INFO     evaluating now!
2024-09-04 09:44:38 INFO     Epoch [23/200] train_loss: 1.0619, val_loss: 1.4712, lr: 0.003000, 7.66s
2024-09-04 09:44:45 INFO     epoch complete!
2024-09-04 09:44:45 INFO     evaluating now!
2024-09-04 09:44:46 INFO     Epoch [24/200] train_loss: 1.0582, val_loss: 1.4499, lr: 0.003000, 7.73s
2024-09-04 09:44:46 INFO     Saved model at 24
2024-09-04 09:44:46 INFO     Val loss decrease from 1.4622 to 1.4499, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch24.tar
2024-09-04 09:44:53 INFO     epoch complete!
2024-09-04 09:44:53 INFO     evaluating now!
2024-09-04 09:44:53 INFO     Epoch [25/200] train_loss: 1.0516, val_loss: 1.4768, lr: 0.003000, 7.82s
2024-09-04 09:45:01 INFO     epoch complete!
2024-09-04 09:45:01 INFO     evaluating now!
2024-09-04 09:45:01 INFO     Epoch [26/200] train_loss: 1.0492, val_loss: 1.4751, lr: 0.003000, 7.78s
2024-09-04 09:45:09 INFO     epoch complete!
2024-09-04 09:45:09 INFO     evaluating now!
2024-09-04 09:45:09 INFO     Epoch [27/200] train_loss: 1.0468, val_loss: 1.4557, lr: 0.003000, 7.77s
2024-09-04 09:45:16 INFO     epoch complete!
2024-09-04 09:45:16 INFO     evaluating now!
2024-09-04 09:45:17 INFO     Epoch [28/200] train_loss: 1.0506, val_loss: 1.4413, lr: 0.003000, 7.82s
2024-09-04 09:45:17 INFO     Saved model at 28
2024-09-04 09:45:17 INFO     Val loss decrease from 1.4499 to 1.4413, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch28.tar
2024-09-04 09:45:24 INFO     epoch complete!
2024-09-04 09:45:24 INFO     evaluating now!
2024-09-04 09:45:25 INFO     Epoch [29/200] train_loss: 1.0436, val_loss: 1.4771, lr: 0.003000, 7.81s
2024-09-04 09:45:32 INFO     epoch complete!
2024-09-04 09:45:32 INFO     evaluating now!
2024-09-04 09:45:32 INFO     Epoch [30/200] train_loss: 1.0377, val_loss: 1.4457, lr: 0.003000, 7.78s
2024-09-04 09:45:40 INFO     epoch complete!
2024-09-04 09:45:40 INFO     evaluating now!
2024-09-04 09:45:40 INFO     Epoch [31/200] train_loss: 1.0347, val_loss: 1.4540, lr: 0.003000, 7.81s
2024-09-04 09:45:48 INFO     epoch complete!
2024-09-04 09:45:48 INFO     evaluating now!
2024-09-04 09:45:48 INFO     Epoch [32/200] train_loss: 1.0331, val_loss: 1.4441, lr: 0.003000, 7.66s
2024-09-04 09:45:55 INFO     epoch complete!
2024-09-04 09:45:55 INFO     evaluating now!
2024-09-04 09:45:56 INFO     Epoch [33/200] train_loss: 1.0337, val_loss: 1.4514, lr: 0.003000, 7.74s
2024-09-04 09:46:03 INFO     epoch complete!
2024-09-04 09:46:03 INFO     evaluating now!
2024-09-04 09:46:03 INFO     Epoch [34/200] train_loss: 1.0314, val_loss: 1.4463, lr: 0.003000, 7.74s
2024-09-04 09:46:11 INFO     epoch complete!
2024-09-04 09:46:11 INFO     evaluating now!
2024-09-04 09:46:11 INFO     Epoch [35/200] train_loss: 1.0277, val_loss: 1.4638, lr: 0.003000, 7.73s
2024-09-04 09:46:18 INFO     epoch complete!
2024-09-04 09:46:18 INFO     evaluating now!
2024-09-04 09:46:19 INFO     Epoch [36/200] train_loss: 1.0253, val_loss: 1.4697, lr: 0.003000, 7.66s
2024-09-04 09:46:26 INFO     epoch complete!
2024-09-04 09:46:26 INFO     evaluating now!
2024-09-04 09:46:26 INFO     Epoch [37/200] train_loss: 1.0263, val_loss: 1.4703, lr: 0.003000, 7.75s
2024-09-04 09:46:34 INFO     epoch complete!
2024-09-04 09:46:34 INFO     evaluating now!
2024-09-04 09:46:34 INFO     Epoch [38/200] train_loss: 1.0230, val_loss: 1.4514, lr: 0.003000, 7.65s
2024-09-04 09:46:42 INFO     epoch complete!
2024-09-04 09:46:42 INFO     evaluating now!
2024-09-04 09:46:42 INFO     Epoch [39/200] train_loss: 1.0202, val_loss: 1.4686, lr: 0.003000, 7.73s
2024-09-04 09:46:49 INFO     epoch complete!
2024-09-04 09:46:49 INFO     evaluating now!
2024-09-04 09:46:50 INFO     Epoch [40/200] train_loss: 1.0180, val_loss: 1.4647, lr: 0.003000, 7.66s
2024-09-04 09:46:57 INFO     epoch complete!
2024-09-04 09:46:57 INFO     evaluating now!
2024-09-04 09:46:57 INFO     Epoch [41/200] train_loss: 1.0155, val_loss: 1.4593, lr: 0.003000, 7.70s
2024-09-04 09:47:05 INFO     epoch complete!
2024-09-04 09:47:05 INFO     evaluating now!
2024-09-04 09:47:05 INFO     Epoch [42/200] train_loss: 1.0151, val_loss: 1.4470, lr: 0.003000, 7.77s
2024-09-04 09:47:12 INFO     epoch complete!
2024-09-04 09:47:12 INFO     evaluating now!
2024-09-04 09:47:13 INFO     Epoch [43/200] train_loss: 1.0140, val_loss: 1.4745, lr: 0.003000, 7.76s
2024-09-04 09:47:13 WARNING  Early stopping at epoch: 43
2024-09-04 09:47:13 INFO     Trained totally 44 epochs, average train time is 7.401s, average eval time is 0.340s
2024-09-04 09:47:13 INFO     Loaded model at 28
2024-09-04 09:47:13 INFO     Saved model at ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406.m
2024-09-04 09:47:13 INFO     Start evaluating ...
2024-09-04 09:47:15 INFO     Note that you select the single mode to evaluate!
2024-09-04 09:47:15 INFO     Evaluate result is saved at ./libcity/cache/3000/evaluate_cache\2024_09_04_09_47_15_AGCRN_NYCTaxi20200406.csv
2024-09-04 09:47:15 INFO     
         MAE      RMSE
1   1.330263  2.397292
2   1.332927  2.395144
3   1.328271  2.373892
4   1.339615  2.399085
5   1.335611  2.434551
6   1.339278  2.432544
7   1.356619  2.498081
8   1.366804  2.523306
9   1.385646  2.594542
10  1.388376  2.640066
11  1.410450  2.704673
12  1.427626  2.792398
2024-09-04 09:47:15 INFO     ----------------------------------------------------------------------------
2024-09-04 09:47:15 INFO     # 2, Kownledge Graph Embedding: Normal, Experiment ids: 3002
2024-09-04 09:47:15 INFO     ----------------------------------------------------------------------------
2024-09-04 09:47:15 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=NYCTaxi20200406, exp_id=3000
2024-09-04 09:47:15 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'NYCTaxi20200406', 'saved_model': True, 'train': True, 'exp_id': 3000, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['NYCTaxi20200406'], 'geo_file': 'NYCTaxi20200406', 'rel_file': 'NYCTaxi20200406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-04 09:47:15 INFO     Loaded file NYCTaxi20200406.geo, num_nodes=260
2024-09-04 09:47:15 INFO     set_weight_link_or_dist: dist
2024-09-04 09:47:15 INFO     init_weight_inf_or_zero: inf
2024-09-04 09:47:15 INFO     Loaded file NYCTaxi20200406.rel, shape=(260, 260)
2024-09-04 09:47:15 INFO     Start Calculate the weight by Gauss kernel!
2024-09-04 09:47:15 INFO     Loading file NYCTaxi20200406.dyna
2024-09-04 09:47:16 INFO     Loaded file NYCTaxi20200406.dyna, shape=(4368, 260, 2)
2024-09-04 09:47:16 INFO     Dataset created
2024-09-04 09:47:16 INFO     x shape: (4345, 12, 260, 2), y shape: (4345, 12, 260, 2)
2024-09-04 09:47:16 INFO     train	x: (3042, 12, 260, 2), y: (3042, 12, 260, 2)
2024-09-04 09:47:16 INFO     eval	x: (434, 12, 260, 2), y: (434, 12, 260, 2)
2024-09-04 09:47:16 INFO     test	x: (869, 12, 260, 2), y: (869, 12, 260, 2)
2024-09-04 09:47:16 INFO     StandardScaler mean: 0.7727858064026704, std: 2.3026817046377195
2024-09-04 09:47:16 INFO     NoneScaler
2024-09-04 09:47:17 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-04 09:47:17 INFO     node_embeddings	torch.Size([260, 10])	cuda:0	True
2024-09-04 09:47:17 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-04 09:47:17 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-04 09:47:17 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-04 09:47:17 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-04 09:47:17 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-04 09:47:17 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-04 09:47:17 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-04 09:47:17 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-04 09:47:17 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-04 09:47:17 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-04 09:47:17 INFO     Total parameter numbers: 752960
2024-09-04 09:47:17 INFO     You select `adam` optimizer.
2024-09-04 09:47:17 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-04 09:47:17 INFO     Start training ...
2024-09-04 09:47:17 INFO     num_batches:48
2024-09-04 09:47:24 INFO     epoch complete!
2024-09-04 09:47:24 INFO     evaluating now!
2024-09-04 09:47:25 INFO     Epoch [0/200] train_loss: 1.8608, val_loss: 2.3486, lr: 0.003000, 8.08s
2024-09-04 09:47:25 INFO     Saved model at 0
2024-09-04 09:47:25 INFO     Val loss decrease from inf to 2.3486, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch0.tar
2024-09-04 09:47:32 INFO     epoch complete!
2024-09-04 09:47:32 INFO     evaluating now!
2024-09-04 09:47:33 INFO     Epoch [1/200] train_loss: 1.4962, val_loss: 2.0261, lr: 0.003000, 7.77s
2024-09-04 09:47:33 INFO     Saved model at 1
2024-09-04 09:47:33 INFO     Val loss decrease from 2.3486 to 2.0261, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch1.tar
2024-09-04 09:47:40 INFO     epoch complete!
2024-09-04 09:47:40 INFO     evaluating now!
2024-09-04 09:47:40 INFO     Epoch [2/200] train_loss: 1.3382, val_loss: 1.8565, lr: 0.003000, 7.76s
2024-09-04 09:47:40 INFO     Saved model at 2
2024-09-04 09:47:40 INFO     Val loss decrease from 2.0261 to 1.8565, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch2.tar
2024-09-04 09:47:48 INFO     epoch complete!
2024-09-04 09:47:48 INFO     evaluating now!
2024-09-04 09:47:48 INFO     Epoch [3/200] train_loss: 1.2603, val_loss: 1.7415, lr: 0.003000, 7.79s
2024-09-04 09:47:48 INFO     Saved model at 3
2024-09-04 09:47:48 INFO     Val loss decrease from 1.8565 to 1.7415, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch3.tar
2024-09-04 09:47:56 INFO     epoch complete!
2024-09-04 09:47:56 INFO     evaluating now!
2024-09-04 09:47:56 INFO     Epoch [4/200] train_loss: 1.2229, val_loss: 1.7405, lr: 0.003000, 7.80s
2024-09-04 09:47:56 INFO     Saved model at 4
2024-09-04 09:47:56 INFO     Val loss decrease from 1.7415 to 1.7405, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch4.tar
2024-09-04 09:48:03 INFO     epoch complete!
2024-09-04 09:48:03 INFO     evaluating now!
2024-09-04 09:48:04 INFO     Epoch [5/200] train_loss: 1.1968, val_loss: 1.6637, lr: 0.003000, 7.73s
2024-09-04 09:48:04 INFO     Saved model at 5
2024-09-04 09:48:04 INFO     Val loss decrease from 1.7405 to 1.6637, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch5.tar
2024-09-04 09:48:11 INFO     epoch complete!
2024-09-04 09:48:11 INFO     evaluating now!
2024-09-04 09:48:11 INFO     Epoch [6/200] train_loss: 1.1762, val_loss: 1.5909, lr: 0.003000, 7.78s
2024-09-04 09:48:11 INFO     Saved model at 6
2024-09-04 09:48:11 INFO     Val loss decrease from 1.6637 to 1.5909, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch6.tar
2024-09-04 09:48:19 INFO     epoch complete!
2024-09-04 09:48:19 INFO     evaluating now!
2024-09-04 09:48:19 INFO     Epoch [7/200] train_loss: 1.1652, val_loss: 1.6066, lr: 0.003000, 7.76s
2024-09-04 09:48:27 INFO     epoch complete!
2024-09-04 09:48:27 INFO     evaluating now!
2024-09-04 09:48:27 INFO     Epoch [8/200] train_loss: 1.1529, val_loss: 1.5744, lr: 0.003000, 7.82s
2024-09-04 09:48:27 INFO     Saved model at 8
2024-09-04 09:48:27 INFO     Val loss decrease from 1.5909 to 1.5744, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch8.tar
2024-09-04 09:48:34 INFO     epoch complete!
2024-09-04 09:48:34 INFO     evaluating now!
2024-09-04 09:48:35 INFO     Epoch [9/200] train_loss: 1.1452, val_loss: 1.5282, lr: 0.003000, 7.75s
2024-09-04 09:48:35 INFO     Saved model at 9
2024-09-04 09:48:35 INFO     Val loss decrease from 1.5744 to 1.5282, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch9.tar
2024-09-04 09:48:42 INFO     epoch complete!
2024-09-04 09:48:42 INFO     evaluating now!
2024-09-04 09:48:43 INFO     Epoch [10/200] train_loss: 1.1341, val_loss: 1.6011, lr: 0.003000, 7.78s
2024-09-04 09:48:50 INFO     epoch complete!
2024-09-04 09:48:50 INFO     evaluating now!
2024-09-04 09:48:50 INFO     Epoch [11/200] train_loss: 1.1277, val_loss: 1.5279, lr: 0.003000, 7.77s
2024-09-04 09:48:50 INFO     Saved model at 11
2024-09-04 09:48:50 INFO     Val loss decrease from 1.5282 to 1.5279, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch11.tar
2024-09-04 09:48:58 INFO     epoch complete!
2024-09-04 09:48:58 INFO     evaluating now!
2024-09-04 09:48:58 INFO     Epoch [12/200] train_loss: 1.1152, val_loss: 1.4769, lr: 0.003000, 7.80s
2024-09-04 09:48:58 INFO     Saved model at 12
2024-09-04 09:48:58 INFO     Val loss decrease from 1.5279 to 1.4769, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch12.tar
2024-09-04 09:49:06 INFO     epoch complete!
2024-09-04 09:49:06 INFO     evaluating now!
2024-09-04 09:49:06 INFO     Epoch [13/200] train_loss: 1.1082, val_loss: 1.5062, lr: 0.003000, 7.71s
2024-09-04 09:49:13 INFO     epoch complete!
2024-09-04 09:49:13 INFO     evaluating now!
2024-09-04 09:49:14 INFO     Epoch [14/200] train_loss: 1.1033, val_loss: 1.4973, lr: 0.003000, 7.74s
2024-09-04 09:49:21 INFO     epoch complete!
2024-09-04 09:49:21 INFO     evaluating now!
2024-09-04 09:49:21 INFO     Epoch [15/200] train_loss: 1.0949, val_loss: 1.5039, lr: 0.003000, 7.82s
2024-09-04 09:49:29 INFO     epoch complete!
2024-09-04 09:49:29 INFO     evaluating now!
2024-09-04 09:49:29 INFO     Epoch [16/200] train_loss: 1.0940, val_loss: 1.4939, lr: 0.003000, 7.79s
2024-09-04 09:49:37 INFO     epoch complete!
2024-09-04 09:49:37 INFO     evaluating now!
2024-09-04 09:49:37 INFO     Epoch [17/200] train_loss: 1.0882, val_loss: 1.4729, lr: 0.003000, 7.78s
2024-09-04 09:49:37 INFO     Saved model at 17
2024-09-04 09:49:37 INFO     Val loss decrease from 1.4769 to 1.4729, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch17.tar
2024-09-04 09:49:45 INFO     epoch complete!
2024-09-04 09:49:45 INFO     evaluating now!
2024-09-04 09:49:45 INFO     Epoch [18/200] train_loss: 1.0817, val_loss: 1.5065, lr: 0.003000, 7.77s
2024-09-04 09:49:52 INFO     epoch complete!
2024-09-04 09:49:52 INFO     evaluating now!
2024-09-04 09:49:53 INFO     Epoch [19/200] train_loss: 1.0761, val_loss: 1.4909, lr: 0.003000, 7.71s
2024-09-04 09:50:00 INFO     epoch complete!
2024-09-04 09:50:00 INFO     evaluating now!
2024-09-04 09:50:00 INFO     Epoch [20/200] train_loss: 1.0686, val_loss: 1.4719, lr: 0.003000, 7.82s
2024-09-04 09:50:00 INFO     Saved model at 20
2024-09-04 09:50:00 INFO     Val loss decrease from 1.4729 to 1.4719, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch20.tar
2024-09-04 09:50:08 INFO     epoch complete!
2024-09-04 09:50:08 INFO     evaluating now!
2024-09-04 09:50:08 INFO     Epoch [21/200] train_loss: 1.0689, val_loss: 1.4856, lr: 0.003000, 7.79s
2024-09-04 09:50:16 INFO     epoch complete!
2024-09-04 09:50:16 INFO     evaluating now!
2024-09-04 09:50:16 INFO     Epoch [22/200] train_loss: 1.0619, val_loss: 1.4658, lr: 0.003000, 7.81s
2024-09-04 09:50:16 INFO     Saved model at 22
2024-09-04 09:50:16 INFO     Val loss decrease from 1.4719 to 1.4658, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch22.tar
2024-09-04 09:50:23 INFO     epoch complete!
2024-09-04 09:50:23 INFO     evaluating now!
2024-09-04 09:50:24 INFO     Epoch [23/200] train_loss: 1.0592, val_loss: 1.4554, lr: 0.003000, 7.78s
2024-09-04 09:50:24 INFO     Saved model at 23
2024-09-04 09:50:24 INFO     Val loss decrease from 1.4658 to 1.4554, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch23.tar
2024-09-04 09:50:31 INFO     epoch complete!
2024-09-04 09:50:31 INFO     evaluating now!
2024-09-04 09:50:32 INFO     Epoch [24/200] train_loss: 1.0581, val_loss: 1.4827, lr: 0.003000, 7.80s
2024-09-04 09:50:39 INFO     epoch complete!
2024-09-04 09:50:39 INFO     evaluating now!
2024-09-04 09:50:39 INFO     Epoch [25/200] train_loss: 1.0515, val_loss: 1.4758, lr: 0.003000, 7.77s
2024-09-04 09:50:47 INFO     epoch complete!
2024-09-04 09:50:47 INFO     evaluating now!
2024-09-04 09:50:47 INFO     Epoch [26/200] train_loss: 1.0488, val_loss: 1.4640, lr: 0.003000, 7.83s
2024-09-04 09:50:55 INFO     epoch complete!
2024-09-04 09:50:55 INFO     evaluating now!
2024-09-04 09:50:55 INFO     Epoch [27/200] train_loss: 1.0445, val_loss: 1.4474, lr: 0.003000, 7.78s
2024-09-04 09:50:55 INFO     Saved model at 27
2024-09-04 09:50:55 INFO     Val loss decrease from 1.4554 to 1.4474, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch27.tar
2024-09-04 09:51:02 INFO     epoch complete!
2024-09-04 09:51:02 INFO     evaluating now!
2024-09-04 09:51:03 INFO     Epoch [28/200] train_loss: 1.0438, val_loss: 1.4609, lr: 0.003000, 7.77s
2024-09-04 09:51:10 INFO     epoch complete!
2024-09-04 09:51:10 INFO     evaluating now!
2024-09-04 09:51:11 INFO     Epoch [29/200] train_loss: 1.0426, val_loss: 1.4596, lr: 0.003000, 7.78s
2024-09-04 09:51:18 INFO     epoch complete!
2024-09-04 09:51:18 INFO     evaluating now!
2024-09-04 09:51:18 INFO     Epoch [30/200] train_loss: 1.0414, val_loss: 1.4712, lr: 0.003000, 7.74s
2024-09-04 09:51:26 INFO     epoch complete!
2024-09-04 09:51:26 INFO     evaluating now!
2024-09-04 09:51:26 INFO     Epoch [31/200] train_loss: 1.0373, val_loss: 1.4758, lr: 0.003000, 7.79s
2024-09-04 09:51:34 INFO     epoch complete!
2024-09-04 09:51:34 INFO     evaluating now!
2024-09-04 09:51:34 INFO     Epoch [32/200] train_loss: 1.0345, val_loss: 1.4701, lr: 0.003000, 7.80s
2024-09-04 09:51:41 INFO     epoch complete!
2024-09-04 09:51:41 INFO     evaluating now!
2024-09-04 09:51:42 INFO     Epoch [33/200] train_loss: 1.0317, val_loss: 1.4798, lr: 0.003000, 7.80s
2024-09-04 09:51:49 INFO     epoch complete!
2024-09-04 09:51:49 INFO     evaluating now!
2024-09-04 09:51:49 INFO     Epoch [34/200] train_loss: 1.0298, val_loss: 1.4598, lr: 0.003000, 7.75s
2024-09-04 09:51:57 INFO     epoch complete!
2024-09-04 09:51:57 INFO     evaluating now!
2024-09-04 09:51:57 INFO     Epoch [35/200] train_loss: 1.0251, val_loss: 1.4511, lr: 0.003000, 7.86s
2024-09-04 09:52:05 INFO     epoch complete!
2024-09-04 09:52:05 INFO     evaluating now!
2024-09-04 09:52:05 INFO     Epoch [36/200] train_loss: 1.0251, val_loss: 1.4683, lr: 0.003000, 7.81s
2024-09-04 09:52:13 INFO     epoch complete!
2024-09-04 09:52:13 INFO     evaluating now!
2024-09-04 09:52:13 INFO     Epoch [37/200] train_loss: 1.0234, val_loss: 1.4580, lr: 0.003000, 7.79s
2024-09-04 09:52:20 INFO     epoch complete!
2024-09-04 09:52:20 INFO     evaluating now!
2024-09-04 09:52:21 INFO     Epoch [38/200] train_loss: 1.0220, val_loss: 1.4960, lr: 0.003000, 7.76s
2024-09-04 09:52:28 INFO     epoch complete!
2024-09-04 09:52:28 INFO     evaluating now!
2024-09-04 09:52:28 INFO     Epoch [39/200] train_loss: 1.0194, val_loss: 1.4669, lr: 0.003000, 7.75s
2024-09-04 09:52:36 INFO     epoch complete!
2024-09-04 09:52:36 INFO     evaluating now!
2024-09-04 09:52:36 INFO     Epoch [40/200] train_loss: 1.0211, val_loss: 1.4864, lr: 0.003000, 7.70s
2024-09-04 09:52:43 INFO     epoch complete!
2024-09-04 09:52:43 INFO     evaluating now!
2024-09-04 09:52:44 INFO     Epoch [41/200] train_loss: 1.0183, val_loss: 1.4674, lr: 0.003000, 7.72s
2024-09-04 09:52:51 INFO     epoch complete!
2024-09-04 09:52:51 INFO     evaluating now!
2024-09-04 09:52:51 INFO     Epoch [42/200] train_loss: 1.0136, val_loss: 1.4701, lr: 0.003000, 7.70s
2024-09-04 09:52:51 WARNING  Early stopping at epoch: 42
2024-09-04 09:52:51 INFO     Trained totally 43 epochs, average train time is 7.439s, average eval time is 0.341s
2024-09-04 09:52:51 INFO     Loaded model at 27
2024-09-04 09:52:51 INFO     Saved model at ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406.m
2024-09-04 09:52:51 INFO     Start evaluating ...
2024-09-04 09:52:54 INFO     Note that you select the single mode to evaluate!
2024-09-04 09:52:54 INFO     Evaluate result is saved at ./libcity/cache/3000/evaluate_cache\2024_09_04_09_52_54_AGCRN_NYCTaxi20200406.csv
2024-09-04 09:52:54 INFO     
         MAE      RMSE
1   1.305824  2.356159
2   1.304301  2.334912
3   1.301018  2.315380
4   1.306673  2.339400
5   1.322490  2.397700
6   1.334227  2.435732
7   1.352005  2.495369
8   1.364359  2.541761
9   1.376912  2.604246
10  1.400500  2.674432
11  1.419535  2.742269
12  1.452772  2.837473
2024-09-04 09:52:54 INFO     ----------------------------------------------------------------------------
2024-09-04 09:52:54 INFO     # 3, Kownledge Graph Embedding: Normal, Experiment ids: 3003
2024-09-04 09:52:54 INFO     ----------------------------------------------------------------------------
2024-09-04 09:52:54 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=NYCTaxi20200406, exp_id=3000
2024-09-04 09:52:54 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'NYCTaxi20200406', 'saved_model': True, 'train': True, 'exp_id': 3000, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['NYCTaxi20200406'], 'geo_file': 'NYCTaxi20200406', 'rel_file': 'NYCTaxi20200406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-04 09:52:54 INFO     Loaded file NYCTaxi20200406.geo, num_nodes=260
2024-09-04 09:52:54 INFO     set_weight_link_or_dist: dist
2024-09-04 09:52:54 INFO     init_weight_inf_or_zero: inf
2024-09-04 09:52:54 INFO     Loaded file NYCTaxi20200406.rel, shape=(260, 260)
2024-09-04 09:52:54 INFO     Start Calculate the weight by Gauss kernel!
2024-09-04 09:52:54 INFO     Loading file NYCTaxi20200406.dyna
2024-09-04 09:52:54 INFO     Loaded file NYCTaxi20200406.dyna, shape=(4368, 260, 2)
2024-09-04 09:52:55 INFO     Dataset created
2024-09-04 09:52:55 INFO     x shape: (4345, 12, 260, 2), y shape: (4345, 12, 260, 2)
2024-09-04 09:52:55 INFO     train	x: (3042, 12, 260, 2), y: (3042, 12, 260, 2)
2024-09-04 09:52:55 INFO     eval	x: (434, 12, 260, 2), y: (434, 12, 260, 2)
2024-09-04 09:52:55 INFO     test	x: (869, 12, 260, 2), y: (869, 12, 260, 2)
2024-09-04 09:52:55 INFO     StandardScaler mean: 0.7727858064026704, std: 2.3026817046377195
2024-09-04 09:52:55 INFO     NoneScaler
2024-09-04 09:52:56 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-04 09:52:56 INFO     node_embeddings	torch.Size([260, 10])	cuda:0	True
2024-09-04 09:52:56 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-04 09:52:56 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-04 09:52:56 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-04 09:52:56 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-04 09:52:56 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-04 09:52:56 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-04 09:52:56 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-04 09:52:56 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-04 09:52:56 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-04 09:52:56 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-04 09:52:56 INFO     Total parameter numbers: 752960
2024-09-04 09:52:56 INFO     You select `adam` optimizer.
2024-09-04 09:52:56 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-04 09:52:56 INFO     Start training ...
2024-09-04 09:52:56 INFO     num_batches:48
2024-09-04 09:53:03 INFO     epoch complete!
2024-09-04 09:53:03 INFO     evaluating now!
2024-09-04 09:53:03 INFO     Epoch [0/200] train_loss: 1.8776, val_loss: 2.3330, lr: 0.003000, 7.97s
2024-09-04 09:53:04 INFO     Saved model at 0
2024-09-04 09:53:04 INFO     Val loss decrease from inf to 2.3330, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch0.tar
2024-09-04 09:53:11 INFO     epoch complete!
2024-09-04 09:53:11 INFO     evaluating now!
2024-09-04 09:53:11 INFO     Epoch [1/200] train_loss: 1.4609, val_loss: 1.9579, lr: 0.003000, 7.74s
2024-09-04 09:53:11 INFO     Saved model at 1
2024-09-04 09:53:11 INFO     Val loss decrease from 2.3330 to 1.9579, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch1.tar
2024-09-04 09:53:19 INFO     epoch complete!
2024-09-04 09:53:19 INFO     evaluating now!
2024-09-04 09:53:19 INFO     Epoch [2/200] train_loss: 1.3127, val_loss: 1.7929, lr: 0.003000, 7.72s
2024-09-04 09:53:19 INFO     Saved model at 2
2024-09-04 09:53:19 INFO     Val loss decrease from 1.9579 to 1.7929, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch2.tar
2024-09-04 09:53:26 INFO     epoch complete!
2024-09-04 09:53:26 INFO     evaluating now!
2024-09-04 09:53:27 INFO     Epoch [3/200] train_loss: 1.2499, val_loss: 1.7787, lr: 0.003000, 7.75s
2024-09-04 09:53:27 INFO     Saved model at 3
2024-09-04 09:53:27 INFO     Val loss decrease from 1.7929 to 1.7787, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch3.tar
2024-09-04 09:53:34 INFO     epoch complete!
2024-09-04 09:53:34 INFO     evaluating now!
2024-09-04 09:53:34 INFO     Epoch [4/200] train_loss: 1.2099, val_loss: 1.7124, lr: 0.003000, 7.71s
2024-09-04 09:53:34 INFO     Saved model at 4
2024-09-04 09:53:34 INFO     Val loss decrease from 1.7787 to 1.7124, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch4.tar
2024-09-04 09:53:42 INFO     epoch complete!
2024-09-04 09:53:42 INFO     evaluating now!
2024-09-04 09:53:42 INFO     Epoch [5/200] train_loss: 1.1901, val_loss: 1.6328, lr: 0.003000, 7.72s
2024-09-04 09:53:42 INFO     Saved model at 5
2024-09-04 09:53:42 INFO     Val loss decrease from 1.7124 to 1.6328, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch5.tar
2024-09-04 09:53:50 INFO     epoch complete!
2024-09-04 09:53:50 INFO     evaluating now!
2024-09-04 09:53:50 INFO     Epoch [6/200] train_loss: 1.1766, val_loss: 1.6024, lr: 0.003000, 7.72s
2024-09-04 09:53:50 INFO     Saved model at 6
2024-09-04 09:53:50 INFO     Val loss decrease from 1.6328 to 1.6024, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch6.tar
2024-09-04 09:53:57 INFO     epoch complete!
2024-09-04 09:53:57 INFO     evaluating now!
2024-09-04 09:53:58 INFO     Epoch [7/200] train_loss: 1.1725, val_loss: 1.6120, lr: 0.003000, 7.71s
2024-09-04 09:54:05 INFO     epoch complete!
2024-09-04 09:54:05 INFO     evaluating now!
2024-09-04 09:54:05 INFO     Epoch [8/200] train_loss: 1.1497, val_loss: 1.5682, lr: 0.003000, 7.68s
2024-09-04 09:54:05 INFO     Saved model at 8
2024-09-04 09:54:05 INFO     Val loss decrease from 1.6024 to 1.5682, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch8.tar
2024-09-04 09:54:13 INFO     epoch complete!
2024-09-04 09:54:13 INFO     evaluating now!
2024-09-04 09:54:13 INFO     Epoch [9/200] train_loss: 1.1489, val_loss: 1.5773, lr: 0.003000, 7.68s
2024-09-04 09:54:20 INFO     epoch complete!
2024-09-04 09:54:20 INFO     evaluating now!
2024-09-04 09:54:21 INFO     Epoch [10/200] train_loss: 1.1305, val_loss: 1.5390, lr: 0.003000, 7.69s
2024-09-04 09:54:21 INFO     Saved model at 10
2024-09-04 09:54:21 INFO     Val loss decrease from 1.5682 to 1.5390, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch10.tar
2024-09-04 09:54:28 INFO     epoch complete!
2024-09-04 09:54:28 INFO     evaluating now!
2024-09-04 09:54:28 INFO     Epoch [11/200] train_loss: 1.1229, val_loss: 1.5228, lr: 0.003000, 7.75s
2024-09-04 09:54:29 INFO     Saved model at 11
2024-09-04 09:54:29 INFO     Val loss decrease from 1.5390 to 1.5228, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch11.tar
2024-09-04 09:54:36 INFO     epoch complete!
2024-09-04 09:54:36 INFO     evaluating now!
2024-09-04 09:54:36 INFO     Epoch [12/200] train_loss: 1.1181, val_loss: 1.5155, lr: 0.003000, 7.72s
2024-09-04 09:54:36 INFO     Saved model at 12
2024-09-04 09:54:36 INFO     Val loss decrease from 1.5228 to 1.5155, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch12.tar
2024-09-04 09:54:44 INFO     epoch complete!
2024-09-04 09:54:44 INFO     evaluating now!
2024-09-04 09:54:44 INFO     Epoch [13/200] train_loss: 1.1086, val_loss: 1.4922, lr: 0.003000, 7.74s
2024-09-04 09:54:44 INFO     Saved model at 13
2024-09-04 09:54:44 INFO     Val loss decrease from 1.5155 to 1.4922, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch13.tar
2024-09-04 09:54:51 INFO     epoch complete!
2024-09-04 09:54:51 INFO     evaluating now!
2024-09-04 09:54:52 INFO     Epoch [14/200] train_loss: 1.1062, val_loss: 1.4732, lr: 0.003000, 7.69s
2024-09-04 09:54:52 INFO     Saved model at 14
2024-09-04 09:54:52 INFO     Val loss decrease from 1.4922 to 1.4732, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch14.tar
2024-09-04 09:54:59 INFO     epoch complete!
2024-09-04 09:54:59 INFO     evaluating now!
2024-09-04 09:54:59 INFO     Epoch [15/200] train_loss: 1.0987, val_loss: 1.4810, lr: 0.003000, 7.73s
2024-09-04 09:55:07 INFO     epoch complete!
2024-09-04 09:55:07 INFO     evaluating now!
2024-09-04 09:55:07 INFO     Epoch [16/200] train_loss: 1.0901, val_loss: 1.4872, lr: 0.003000, 7.68s
2024-09-04 09:55:14 INFO     epoch complete!
2024-09-04 09:55:14 INFO     evaluating now!
2024-09-04 09:55:15 INFO     Epoch [17/200] train_loss: 1.0879, val_loss: 1.4817, lr: 0.003000, 7.72s
2024-09-04 09:55:22 INFO     epoch complete!
2024-09-04 09:55:22 INFO     evaluating now!
2024-09-04 09:55:23 INFO     Epoch [18/200] train_loss: 1.0835, val_loss: 1.4682, lr: 0.003000, 7.71s
2024-09-04 09:55:23 INFO     Saved model at 18
2024-09-04 09:55:23 INFO     Val loss decrease from 1.4732 to 1.4682, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch18.tar
2024-09-04 09:55:30 INFO     epoch complete!
2024-09-04 09:55:30 INFO     evaluating now!
2024-09-04 09:55:30 INFO     Epoch [19/200] train_loss: 1.0766, val_loss: 1.4588, lr: 0.003000, 7.72s
2024-09-04 09:55:30 INFO     Saved model at 19
2024-09-04 09:55:30 INFO     Val loss decrease from 1.4682 to 1.4588, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch19.tar
2024-09-04 09:55:38 INFO     epoch complete!
2024-09-04 09:55:38 INFO     evaluating now!
2024-09-04 09:55:38 INFO     Epoch [20/200] train_loss: 1.0727, val_loss: 1.4644, lr: 0.003000, 7.70s
2024-09-04 09:55:45 INFO     epoch complete!
2024-09-04 09:55:45 INFO     evaluating now!
2024-09-04 09:55:46 INFO     Epoch [21/200] train_loss: 1.0705, val_loss: 1.4497, lr: 0.003000, 7.73s
2024-09-04 09:55:46 INFO     Saved model at 21
2024-09-04 09:55:46 INFO     Val loss decrease from 1.4588 to 1.4497, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch21.tar
2024-09-04 09:55:53 INFO     epoch complete!
2024-09-04 09:55:53 INFO     evaluating now!
2024-09-04 09:55:53 INFO     Epoch [22/200] train_loss: 1.0637, val_loss: 1.4552, lr: 0.003000, 7.68s
2024-09-04 09:56:01 INFO     epoch complete!
2024-09-04 09:56:01 INFO     evaluating now!
2024-09-04 09:56:01 INFO     Epoch [23/200] train_loss: 1.0599, val_loss: 1.4562, lr: 0.003000, 7.70s
2024-09-04 09:56:08 INFO     epoch complete!
2024-09-04 09:56:08 INFO     evaluating now!
2024-09-04 09:56:09 INFO     Epoch [24/200] train_loss: 1.0580, val_loss: 1.4288, lr: 0.003000, 7.68s
2024-09-04 09:56:09 INFO     Saved model at 24
2024-09-04 09:56:09 INFO     Val loss decrease from 1.4497 to 1.4288, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch24.tar
2024-09-04 09:56:16 INFO     epoch complete!
2024-09-04 09:56:16 INFO     evaluating now!
2024-09-04 09:56:16 INFO     Epoch [25/200] train_loss: 1.0535, val_loss: 1.4231, lr: 0.003000, 7.68s
2024-09-04 09:56:16 INFO     Saved model at 25
2024-09-04 09:56:16 INFO     Val loss decrease from 1.4288 to 1.4231, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch25.tar
2024-09-04 09:56:24 INFO     epoch complete!
2024-09-04 09:56:24 INFO     evaluating now!
2024-09-04 09:56:24 INFO     Epoch [26/200] train_loss: 1.0502, val_loss: 1.4389, lr: 0.003000, 7.67s
2024-09-04 09:56:32 INFO     epoch complete!
2024-09-04 09:56:32 INFO     evaluating now!
2024-09-04 09:56:32 INFO     Epoch [27/200] train_loss: 1.0534, val_loss: 1.4383, lr: 0.003000, 7.76s
2024-09-04 09:56:39 INFO     epoch complete!
2024-09-04 09:56:39 INFO     evaluating now!
2024-09-04 09:56:40 INFO     Epoch [28/200] train_loss: 1.0456, val_loss: 1.4309, lr: 0.003000, 7.70s
2024-09-04 09:56:47 INFO     epoch complete!
2024-09-04 09:56:47 INFO     evaluating now!
2024-09-04 09:56:47 INFO     Epoch [29/200] train_loss: 1.0421, val_loss: 1.4380, lr: 0.003000, 7.71s
2024-09-04 09:56:55 INFO     epoch complete!
2024-09-04 09:56:55 INFO     evaluating now!
2024-09-04 09:56:55 INFO     Epoch [30/200] train_loss: 1.0395, val_loss: 1.4287, lr: 0.003000, 7.70s
2024-09-04 09:57:02 INFO     epoch complete!
2024-09-04 09:57:02 INFO     evaluating now!
2024-09-04 09:57:03 INFO     Epoch [31/200] train_loss: 1.0366, val_loss: 1.4327, lr: 0.003000, 7.74s
2024-09-04 09:57:10 INFO     epoch complete!
2024-09-04 09:57:10 INFO     evaluating now!
2024-09-04 09:57:10 INFO     Epoch [32/200] train_loss: 1.0344, val_loss: 1.4366, lr: 0.003000, 7.68s
2024-09-04 09:57:18 INFO     epoch complete!
2024-09-04 09:57:18 INFO     evaluating now!
2024-09-04 09:57:18 INFO     Epoch [33/200] train_loss: 1.0336, val_loss: 1.4532, lr: 0.003000, 7.71s
2024-09-04 09:57:26 INFO     epoch complete!
2024-09-04 09:57:26 INFO     evaluating now!
2024-09-04 09:57:26 INFO     Epoch [34/200] train_loss: 1.0340, val_loss: 1.4487, lr: 0.003000, 7.68s
2024-09-04 09:57:33 INFO     epoch complete!
2024-09-04 09:57:33 INFO     evaluating now!
2024-09-04 09:57:34 INFO     Epoch [35/200] train_loss: 1.0295, val_loss: 1.4284, lr: 0.003000, 7.71s
2024-09-04 09:57:41 INFO     epoch complete!
2024-09-04 09:57:41 INFO     evaluating now!
2024-09-04 09:57:41 INFO     Epoch [36/200] train_loss: 1.0272, val_loss: 1.4564, lr: 0.003000, 7.70s
2024-09-04 09:57:49 INFO     epoch complete!
2024-09-04 09:57:49 INFO     evaluating now!
2024-09-04 09:57:49 INFO     Epoch [37/200] train_loss: 1.0296, val_loss: 1.4472, lr: 0.003000, 7.68s
2024-09-04 09:57:57 INFO     epoch complete!
2024-09-04 09:57:57 INFO     evaluating now!
2024-09-04 09:57:57 INFO     Epoch [38/200] train_loss: 1.0239, val_loss: 1.4314, lr: 0.003000, 7.93s
2024-09-04 09:58:04 INFO     epoch complete!
2024-09-04 09:58:04 INFO     evaluating now!
2024-09-04 09:58:05 INFO     Epoch [39/200] train_loss: 1.0211, val_loss: 1.4248, lr: 0.003000, 7.78s
2024-09-04 09:58:12 INFO     epoch complete!
2024-09-04 09:58:12 INFO     evaluating now!
2024-09-04 09:58:12 INFO     Epoch [40/200] train_loss: 1.0203, val_loss: 1.4276, lr: 0.003000, 7.75s
2024-09-04 09:58:12 WARNING  Early stopping at epoch: 40
2024-09-04 09:58:12 INFO     Trained totally 41 epochs, average train time is 7.385s, average eval time is 0.336s
2024-09-04 09:58:12 INFO     Loaded model at 25
2024-09-04 09:58:12 INFO     Saved model at ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406.m
2024-09-04 09:58:12 INFO     Start evaluating ...
2024-09-04 09:58:15 INFO     Note that you select the single mode to evaluate!
2024-09-04 09:58:15 INFO     Evaluate result is saved at ./libcity/cache/3000/evaluate_cache\2024_09_04_09_58_15_AGCRN_NYCTaxi20200406.csv
2024-09-04 09:58:15 INFO     
         MAE      RMSE
1   1.305240  2.346493
2   1.308922  2.341388
3   1.297413  2.298445
4   1.311288  2.330874
5   1.315548  2.344236
6   1.321183  2.355678
7   1.328138  2.393528
8   1.339104  2.432725
9   1.350538  2.483336
10  1.360555  2.533843
11  1.374672  2.605792
12  1.395991  2.686728
2024-09-04 09:58:15 INFO     ----------------------------------------------------------------------------
2024-09-04 09:58:15 INFO     # 4, Kownledge Graph Embedding: Normal, Experiment ids: 3004
2024-09-04 09:58:15 INFO     ----------------------------------------------------------------------------
2024-09-04 09:58:15 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=NYCTaxi20200406, exp_id=3000
2024-09-04 09:58:15 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'NYCTaxi20200406', 'saved_model': True, 'train': True, 'exp_id': 3000, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['NYCTaxi20200406'], 'geo_file': 'NYCTaxi20200406', 'rel_file': 'NYCTaxi20200406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-04 09:58:15 INFO     Loaded file NYCTaxi20200406.geo, num_nodes=260
2024-09-04 09:58:15 INFO     set_weight_link_or_dist: dist
2024-09-04 09:58:15 INFO     init_weight_inf_or_zero: inf
2024-09-04 09:58:15 INFO     Loaded file NYCTaxi20200406.rel, shape=(260, 260)
2024-09-04 09:58:15 INFO     Start Calculate the weight by Gauss kernel!
2024-09-04 09:58:15 INFO     Loading file NYCTaxi20200406.dyna
2024-09-04 09:58:15 INFO     Loaded file NYCTaxi20200406.dyna, shape=(4368, 260, 2)
2024-09-04 09:58:16 INFO     Dataset created
2024-09-04 09:58:16 INFO     x shape: (4345, 12, 260, 2), y shape: (4345, 12, 260, 2)
2024-09-04 09:58:16 INFO     train	x: (3042, 12, 260, 2), y: (3042, 12, 260, 2)
2024-09-04 09:58:16 INFO     eval	x: (434, 12, 260, 2), y: (434, 12, 260, 2)
2024-09-04 09:58:16 INFO     test	x: (869, 12, 260, 2), y: (869, 12, 260, 2)
2024-09-04 09:58:16 INFO     StandardScaler mean: 0.7727858064026704, std: 2.3026817046377195
2024-09-04 09:58:16 INFO     NoneScaler
2024-09-04 09:58:16 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-04 09:58:16 INFO     node_embeddings	torch.Size([260, 10])	cuda:0	True
2024-09-04 09:58:16 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-04 09:58:16 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-04 09:58:16 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-04 09:58:16 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-04 09:58:16 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-04 09:58:16 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-04 09:58:16 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-04 09:58:16 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-04 09:58:16 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-04 09:58:16 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-04 09:58:16 INFO     Total parameter numbers: 752960
2024-09-04 09:58:16 INFO     You select `adam` optimizer.
2024-09-04 09:58:16 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-04 09:58:16 INFO     Start training ...
2024-09-04 09:58:16 INFO     num_batches:48
2024-09-04 09:58:24 INFO     epoch complete!
2024-09-04 09:58:24 INFO     evaluating now!
2024-09-04 09:58:24 INFO     Epoch [0/200] train_loss: 1.8900, val_loss: 2.3076, lr: 0.003000, 8.00s
2024-09-04 09:58:24 INFO     Saved model at 0
2024-09-04 09:58:24 INFO     Val loss decrease from inf to 2.3076, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch0.tar
2024-09-04 09:58:32 INFO     epoch complete!
2024-09-04 09:58:32 INFO     evaluating now!
2024-09-04 09:58:32 INFO     Epoch [1/200] train_loss: 1.4559, val_loss: 1.9451, lr: 0.003000, 7.77s
2024-09-04 09:58:32 INFO     Saved model at 1
2024-09-04 09:58:32 INFO     Val loss decrease from 2.3076 to 1.9451, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch1.tar
2024-09-04 09:58:40 INFO     epoch complete!
2024-09-04 09:58:40 INFO     evaluating now!
2024-09-04 09:58:40 INFO     Epoch [2/200] train_loss: 1.3235, val_loss: 1.8067, lr: 0.003000, 7.66s
2024-09-04 09:58:40 INFO     Saved model at 2
2024-09-04 09:58:40 INFO     Val loss decrease from 1.9451 to 1.8067, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch2.tar
2024-09-04 09:58:47 INFO     epoch complete!
2024-09-04 09:58:47 INFO     evaluating now!
2024-09-04 09:58:48 INFO     Epoch [3/200] train_loss: 1.2497, val_loss: 1.7182, lr: 0.003000, 7.68s
2024-09-04 09:58:48 INFO     Saved model at 3
2024-09-04 09:58:48 INFO     Val loss decrease from 1.8067 to 1.7182, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch3.tar
2024-09-04 09:58:55 INFO     epoch complete!
2024-09-04 09:58:55 INFO     evaluating now!
2024-09-04 09:58:55 INFO     Epoch [4/200] train_loss: 1.2100, val_loss: 1.6622, lr: 0.003000, 7.65s
2024-09-04 09:58:55 INFO     Saved model at 4
2024-09-04 09:58:55 INFO     Val loss decrease from 1.7182 to 1.6622, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch4.tar
2024-09-04 09:59:03 INFO     epoch complete!
2024-09-04 09:59:03 INFO     evaluating now!
2024-09-04 09:59:03 INFO     Epoch [5/200] train_loss: 1.1854, val_loss: 1.6257, lr: 0.003000, 7.68s
2024-09-04 09:59:03 INFO     Saved model at 5
2024-09-04 09:59:03 INFO     Val loss decrease from 1.6622 to 1.6257, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch5.tar
2024-09-04 09:59:10 INFO     epoch complete!
2024-09-04 09:59:10 INFO     evaluating now!
2024-09-04 09:59:11 INFO     Epoch [6/200] train_loss: 1.1662, val_loss: 1.5707, lr: 0.003000, 7.68s
2024-09-04 09:59:11 INFO     Saved model at 6
2024-09-04 09:59:11 INFO     Val loss decrease from 1.6257 to 1.5707, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch6.tar
2024-09-04 09:59:18 INFO     epoch complete!
2024-09-04 09:59:18 INFO     evaluating now!
2024-09-04 09:59:18 INFO     Epoch [7/200] train_loss: 1.1523, val_loss: 1.5351, lr: 0.003000, 7.81s
2024-09-04 09:59:18 INFO     Saved model at 7
2024-09-04 09:59:18 INFO     Val loss decrease from 1.5707 to 1.5351, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch7.tar
2024-09-04 09:59:26 INFO     epoch complete!
2024-09-04 09:59:26 INFO     evaluating now!
2024-09-04 09:59:26 INFO     Epoch [8/200] train_loss: 1.1489, val_loss: 1.5631, lr: 0.003000, 7.85s
2024-09-04 09:59:34 INFO     epoch complete!
2024-09-04 09:59:34 INFO     evaluating now!
2024-09-04 09:59:34 INFO     Epoch [9/200] train_loss: 1.1284, val_loss: 1.5074, lr: 0.003000, 7.73s
2024-09-04 09:59:34 INFO     Saved model at 9
2024-09-04 09:59:34 INFO     Val loss decrease from 1.5351 to 1.5074, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch9.tar
2024-09-04 09:59:41 INFO     epoch complete!
2024-09-04 09:59:41 INFO     evaluating now!
2024-09-04 09:59:42 INFO     Epoch [10/200] train_loss: 1.1237, val_loss: 1.4958, lr: 0.003000, 7.75s
2024-09-04 09:59:42 INFO     Saved model at 10
2024-09-04 09:59:42 INFO     Val loss decrease from 1.5074 to 1.4958, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch10.tar
2024-09-04 09:59:49 INFO     epoch complete!
2024-09-04 09:59:49 INFO     evaluating now!
2024-09-04 09:59:50 INFO     Epoch [11/200] train_loss: 1.1137, val_loss: 1.4761, lr: 0.003000, 7.72s
2024-09-04 09:59:50 INFO     Saved model at 11
2024-09-04 09:59:50 INFO     Val loss decrease from 1.4958 to 1.4761, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch11.tar
2024-09-04 09:59:57 INFO     epoch complete!
2024-09-04 09:59:57 INFO     evaluating now!
2024-09-04 09:59:57 INFO     Epoch [12/200] train_loss: 1.1083, val_loss: 1.4754, lr: 0.003000, 7.73s
2024-09-04 09:59:57 INFO     Saved model at 12
2024-09-04 09:59:57 INFO     Val loss decrease from 1.4761 to 1.4754, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch12.tar
2024-09-04 10:00:05 INFO     epoch complete!
2024-09-04 10:00:05 INFO     evaluating now!
2024-09-04 10:00:05 INFO     Epoch [13/200] train_loss: 1.1011, val_loss: 1.4812, lr: 0.003000, 7.74s
2024-09-04 10:00:12 INFO     epoch complete!
2024-09-04 10:00:12 INFO     evaluating now!
2024-09-04 10:00:13 INFO     Epoch [14/200] train_loss: 1.1056, val_loss: 1.4865, lr: 0.003000, 7.73s
2024-09-04 10:00:20 INFO     epoch complete!
2024-09-04 10:00:20 INFO     evaluating now!
2024-09-04 10:00:20 INFO     Epoch [15/200] train_loss: 1.0927, val_loss: 1.4923, lr: 0.003000, 7.68s
2024-09-04 10:00:28 INFO     epoch complete!
2024-09-04 10:00:28 INFO     evaluating now!
2024-09-04 10:00:28 INFO     Epoch [16/200] train_loss: 1.0836, val_loss: 1.4832, lr: 0.003000, 7.84s
2024-09-04 10:00:36 INFO     epoch complete!
2024-09-04 10:00:36 INFO     evaluating now!
2024-09-04 10:00:36 INFO     Epoch [17/200] train_loss: 1.0793, val_loss: 1.4734, lr: 0.003000, 7.69s
2024-09-04 10:00:36 INFO     Saved model at 17
2024-09-04 10:00:36 INFO     Val loss decrease from 1.4754 to 1.4734, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch17.tar
2024-09-04 10:00:43 INFO     epoch complete!
2024-09-04 10:00:43 INFO     evaluating now!
2024-09-04 10:00:44 INFO     Epoch [18/200] train_loss: 1.0724, val_loss: 1.4888, lr: 0.003000, 7.73s
2024-09-04 10:00:51 INFO     epoch complete!
2024-09-04 10:00:51 INFO     evaluating now!
2024-09-04 10:00:51 INFO     Epoch [19/200] train_loss: 1.0690, val_loss: 1.4734, lr: 0.003000, 7.68s
2024-09-04 10:00:51 INFO     Saved model at 19
2024-09-04 10:00:51 INFO     Val loss decrease from 1.4734 to 1.4734, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch19.tar
2024-09-04 10:00:59 INFO     epoch complete!
2024-09-04 10:00:59 INFO     evaluating now!
2024-09-04 10:00:59 INFO     Epoch [20/200] train_loss: 1.0678, val_loss: 1.4816, lr: 0.003000, 7.70s
2024-09-04 10:01:06 INFO     epoch complete!
2024-09-04 10:01:06 INFO     evaluating now!
2024-09-04 10:01:07 INFO     Epoch [21/200] train_loss: 1.0604, val_loss: 1.4561, lr: 0.003000, 7.72s
2024-09-04 10:01:07 INFO     Saved model at 21
2024-09-04 10:01:07 INFO     Val loss decrease from 1.4734 to 1.4561, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch21.tar
2024-09-04 10:01:14 INFO     epoch complete!
2024-09-04 10:01:14 INFO     evaluating now!
2024-09-04 10:01:15 INFO     Epoch [22/200] train_loss: 1.0555, val_loss: 1.4378, lr: 0.003000, 7.73s
2024-09-04 10:01:15 INFO     Saved model at 22
2024-09-04 10:01:15 INFO     Val loss decrease from 1.4561 to 1.4378, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch22.tar
2024-09-04 10:01:22 INFO     epoch complete!
2024-09-04 10:01:22 INFO     evaluating now!
2024-09-04 10:01:22 INFO     Epoch [23/200] train_loss: 1.0548, val_loss: 1.4628, lr: 0.003000, 7.71s
2024-09-04 10:01:30 INFO     epoch complete!
2024-09-04 10:01:30 INFO     evaluating now!
2024-09-04 10:01:30 INFO     Epoch [24/200] train_loss: 1.0503, val_loss: 1.4463, lr: 0.003000, 7.74s
2024-09-04 10:01:37 INFO     epoch complete!
2024-09-04 10:01:37 INFO     evaluating now!
2024-09-04 10:01:38 INFO     Epoch [25/200] train_loss: 1.0460, val_loss: 1.4397, lr: 0.003000, 7.69s
2024-09-04 10:01:45 INFO     epoch complete!
2024-09-04 10:01:45 INFO     evaluating now!
2024-09-04 10:01:45 INFO     Epoch [26/200] train_loss: 1.0422, val_loss: 1.4388, lr: 0.003000, 7.72s
2024-09-04 10:01:53 INFO     epoch complete!
2024-09-04 10:01:53 INFO     evaluating now!
2024-09-04 10:01:53 INFO     Epoch [27/200] train_loss: 1.0415, val_loss: 1.4522, lr: 0.003000, 7.69s
2024-09-04 10:02:00 INFO     epoch complete!
2024-09-04 10:02:00 INFO     evaluating now!
2024-09-04 10:02:01 INFO     Epoch [28/200] train_loss: 1.0375, val_loss: 1.4354, lr: 0.003000, 7.72s
2024-09-04 10:02:01 INFO     Saved model at 28
2024-09-04 10:02:01 INFO     Val loss decrease from 1.4378 to 1.4354, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch28.tar
2024-09-04 10:02:08 INFO     epoch complete!
2024-09-04 10:02:08 INFO     evaluating now!
2024-09-04 10:02:09 INFO     Epoch [29/200] train_loss: 1.0364, val_loss: 1.4543, lr: 0.003000, 7.69s
2024-09-04 10:02:16 INFO     epoch complete!
2024-09-04 10:02:16 INFO     evaluating now!
2024-09-04 10:02:16 INFO     Epoch [30/200] train_loss: 1.0348, val_loss: 1.4409, lr: 0.003000, 7.75s
2024-09-04 10:02:24 INFO     epoch complete!
2024-09-04 10:02:24 INFO     evaluating now!
2024-09-04 10:02:24 INFO     Epoch [31/200] train_loss: 1.0310, val_loss: 1.4543, lr: 0.003000, 7.71s
2024-09-04 10:02:31 INFO     epoch complete!
2024-09-04 10:02:31 INFO     evaluating now!
2024-09-04 10:02:32 INFO     Epoch [32/200] train_loss: 1.0299, val_loss: 1.4483, lr: 0.003000, 7.70s
2024-09-04 10:02:39 INFO     epoch complete!
2024-09-04 10:02:39 INFO     evaluating now!
2024-09-04 10:02:39 INFO     Epoch [33/200] train_loss: 1.0282, val_loss: 1.4490, lr: 0.003000, 7.70s
2024-09-04 10:02:47 INFO     epoch complete!
2024-09-04 10:02:47 INFO     evaluating now!
2024-09-04 10:02:47 INFO     Epoch [34/200] train_loss: 1.0249, val_loss: 1.4468, lr: 0.003000, 7.73s
2024-09-04 10:02:54 INFO     epoch complete!
2024-09-04 10:02:54 INFO     evaluating now!
2024-09-04 10:02:55 INFO     Epoch [35/200] train_loss: 1.0225, val_loss: 1.4474, lr: 0.003000, 7.70s
2024-09-04 10:03:02 INFO     epoch complete!
2024-09-04 10:03:02 INFO     evaluating now!
2024-09-04 10:03:03 INFO     Epoch [36/200] train_loss: 1.0225, val_loss: 1.4474, lr: 0.003000, 7.72s
2024-09-04 10:03:10 INFO     epoch complete!
2024-09-04 10:03:10 INFO     evaluating now!
2024-09-04 10:03:10 INFO     Epoch [37/200] train_loss: 1.0194, val_loss: 1.4548, lr: 0.003000, 7.80s
2024-09-04 10:03:18 INFO     epoch complete!
2024-09-04 10:03:18 INFO     evaluating now!
2024-09-04 10:03:18 INFO     Epoch [38/200] train_loss: 1.0167, val_loss: 1.4338, lr: 0.003000, 7.98s
2024-09-04 10:03:18 INFO     Saved model at 38
2024-09-04 10:03:18 INFO     Val loss decrease from 1.4354 to 1.4338, saving to ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406_epoch38.tar
2024-09-04 10:03:26 INFO     epoch complete!
2024-09-04 10:03:26 INFO     evaluating now!
2024-09-04 10:03:26 INFO     Epoch [39/200] train_loss: 1.0161, val_loss: 1.4597, lr: 0.003000, 7.85s
2024-09-04 10:03:34 INFO     epoch complete!
2024-09-04 10:03:34 INFO     evaluating now!
2024-09-04 10:03:34 INFO     Epoch [40/200] train_loss: 1.0136, val_loss: 1.4378, lr: 0.003000, 7.75s
2024-09-04 10:03:41 INFO     epoch complete!
2024-09-04 10:03:41 INFO     evaluating now!
2024-09-04 10:03:42 INFO     Epoch [41/200] train_loss: 1.0109, val_loss: 1.4469, lr: 0.003000, 7.74s
2024-09-04 10:03:49 INFO     epoch complete!
2024-09-04 10:03:49 INFO     evaluating now!
2024-09-04 10:03:49 INFO     Epoch [42/200] train_loss: 1.0100, val_loss: 1.4534, lr: 0.003000, 7.72s
2024-09-04 10:03:57 INFO     epoch complete!
2024-09-04 10:03:57 INFO     evaluating now!
2024-09-04 10:03:57 INFO     Epoch [43/200] train_loss: 1.0080, val_loss: 1.4580, lr: 0.003000, 7.81s
2024-09-04 10:04:05 INFO     epoch complete!
2024-09-04 10:04:05 INFO     evaluating now!
2024-09-04 10:04:05 INFO     Epoch [44/200] train_loss: 1.0075, val_loss: 1.4368, lr: 0.003000, 7.75s
2024-09-04 10:04:12 INFO     epoch complete!
2024-09-04 10:04:12 INFO     evaluating now!
2024-09-04 10:04:13 INFO     Epoch [45/200] train_loss: 1.0073, val_loss: 1.4502, lr: 0.003000, 7.74s
2024-09-04 10:04:20 INFO     epoch complete!
2024-09-04 10:04:20 INFO     evaluating now!
2024-09-04 10:04:20 INFO     Epoch [46/200] train_loss: 1.0034, val_loss: 1.4589, lr: 0.003000, 7.73s
2024-09-04 10:04:28 INFO     epoch complete!
2024-09-04 10:04:28 INFO     evaluating now!
2024-09-04 10:04:28 INFO     Epoch [47/200] train_loss: 1.0008, val_loss: 1.4432, lr: 0.003000, 7.78s
2024-09-04 10:04:36 INFO     epoch complete!
2024-09-04 10:04:36 INFO     evaluating now!
2024-09-04 10:04:36 INFO     Epoch [48/200] train_loss: 0.9991, val_loss: 1.4565, lr: 0.003000, 7.77s
2024-09-04 10:04:43 INFO     epoch complete!
2024-09-04 10:04:43 INFO     evaluating now!
2024-09-04 10:04:44 INFO     Epoch [49/200] train_loss: 0.9971, val_loss: 1.4528, lr: 0.003000, 7.85s
2024-09-04 10:04:51 INFO     epoch complete!
2024-09-04 10:04:51 INFO     evaluating now!
2024-09-04 10:04:52 INFO     Epoch [50/200] train_loss: 0.9965, val_loss: 1.4632, lr: 0.003000, 7.77s
2024-09-04 10:04:59 INFO     epoch complete!
2024-09-04 10:04:59 INFO     evaluating now!
2024-09-04 10:04:59 INFO     Epoch [51/200] train_loss: 0.9953, val_loss: 1.4697, lr: 0.003000, 7.73s
2024-09-04 10:05:07 INFO     epoch complete!
2024-09-04 10:05:07 INFO     evaluating now!
2024-09-04 10:05:07 INFO     Epoch [52/200] train_loss: 0.9935, val_loss: 1.4637, lr: 0.003000, 7.75s
2024-09-04 10:05:15 INFO     epoch complete!
2024-09-04 10:05:15 INFO     evaluating now!
2024-09-04 10:05:15 INFO     Epoch [53/200] train_loss: 0.9909, val_loss: 1.4653, lr: 0.003000, 7.80s
2024-09-04 10:05:15 WARNING  Early stopping at epoch: 53
2024-09-04 10:05:15 INFO     Trained totally 54 epochs, average train time is 7.403s, average eval time is 0.341s
2024-09-04 10:05:15 INFO     Loaded model at 38
2024-09-04 10:05:15 INFO     Saved model at ./libcity/cache/3000/model_cache/AGCRN_NYCTaxi20200406.m
2024-09-04 10:05:15 INFO     Start evaluating ...
2024-09-04 10:05:17 INFO     Note that you select the single mode to evaluate!
2024-09-04 10:05:17 INFO     Evaluate result is saved at ./libcity/cache/3000/evaluate_cache\2024_09_04_10_05_17_AGCRN_NYCTaxi20200406.csv
2024-09-04 10:05:17 INFO     
         MAE      RMSE
1   1.310790  2.351512
2   1.314331  2.333240
3   1.309638  2.292953
4   1.318004  2.311828
5   1.319667  2.332180
6   1.325435  2.347242
7   1.339137  2.409335
8   1.351407  2.451433
9   1.363941  2.503453
10  1.383359  2.563804
11  1.391076  2.619166
12  1.420013  2.718354
2024-09-04 10:05:17 INFO     ----------------------------------------------------------------------------
2024-09-04 10:05:17 INFO     Kownledge Graph Embedding: Normal, Experiment ids: [3000, 3001, 3002, 3003, 3004]
2024-09-04 10:05:17 INFO     ----------------------------------------------------------------------------
2024-09-04 10:05:17 INFO     Average: 
         MAE      RMSE
0   1.311748  2.366622
1   1.315288  2.359526
2   1.308857  2.325933
3   1.319846  2.357061
4   1.324752  2.388468
5   1.330145  2.401631
6   1.344330  2.456777
7   1.353256  2.488498
8   1.367800  2.546522
9   1.380698  2.596519
10  1.395441  2.659454
11  1.422158  2.751938 
2024-09-04 10:05:17 INFO     Standard deviation: 
         MAE      RMSE
0   0.009460  0.019543
1   0.009734  0.028325
2   0.010684  0.030941
3   0.011449  0.037481
4   0.007294  0.043306
5   0.006368  0.041077
6   0.010011  0.045596
7   0.010820  0.041366
8   0.012235  0.047928
9   0.013885  0.052239
10  0.017037  0.053977
11  0.018530  0.054906
2024-09-04 10:05:17 INFO     ----------------------------------------------------------------------------
2024-09-04 10:05:17 INFO     12 steps Average: 
       MAE      RMSE
0  1.34786  2.474913
2024-09-04 10:05:17 INFO     12 steps Standard deviation: 
        MAE     RMSE
0  0.011459  0.04139
