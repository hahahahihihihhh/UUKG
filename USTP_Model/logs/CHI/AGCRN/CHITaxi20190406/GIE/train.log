2024-04-25 16:12:17 INFO     ----------------------------------------------------------------------------
2024-04-25 16:12:17 INFO     # 0, Kownledge Graph Embedding: GIE, Experiment ids: 15
2024-04-25 16:12:17 INFO     ----------------------------------------------------------------------------
2024-04-25 16:12:19 INFO     Log directory: ./libcity/log
2024-04-25 16:12:19 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=15
2024-04-25 16:12:19 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 977183867, 'exp_id': 15, 'load_external': True, 'embedding_model': 'GIE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-25 16:12:21 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-25 16:12:21 INFO     set_weight_link_or_dist: dist
2024-04-25 16:12:21 INFO     init_weight_inf_or_zero: inf
2024-04-25 16:12:21 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-25 16:12:21 INFO     Start Calculate the weight by Gauss kernel!
2024-04-25 16:12:21 INFO     Loading file CHITaxi20190406.dyna
2024-04-25 16:12:21 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-25 16:12:24 INFO     Dataset created
2024-04-25 16:12:24 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-25 16:12:24 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-25 16:12:24 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-25 16:12:24 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-25 16:12:25 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-25 16:12:25 INFO     NoneScaler
2024-04-25 16:12:36 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-25 16:12:36 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-25 16:12:36 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-25 16:12:36 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 16:12:36 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-25 16:12:36 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 16:12:36 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-25 16:12:36 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 16:12:36 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-25 16:12:36 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 16:12:36 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-25 16:12:36 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-25 16:12:36 INFO     Total parameter numbers: 874010
2024-04-25 16:12:36 INFO     You select `adam` optimizer.
2024-04-25 16:12:36 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-25 16:12:36 INFO     Start training ...
2024-04-25 16:12:36 INFO     num_batches:48
2024-04-25 16:12:43 INFO     epoch complete!
2024-04-25 16:12:43 INFO     evaluating now!
2024-04-25 16:12:43 INFO     Epoch [0/200] train_loss: 24.5545, val_loss: 18.4019, lr: 0.003000, 6.85s
2024-04-25 16:12:43 INFO     Saved model at 0
2024-04-25 16:12:43 INFO     Val loss decrease from inf to 18.4019, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-25 16:12:50 INFO     epoch complete!
2024-04-25 16:12:50 INFO     evaluating now!
2024-04-25 16:12:50 INFO     Epoch [1/200] train_loss: 14.9097, val_loss: 14.3577, lr: 0.003000, 6.54s
2024-04-25 16:12:50 INFO     Saved model at 1
2024-04-25 16:12:50 INFO     Val loss decrease from 18.4019 to 14.3577, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-25 16:12:56 INFO     epoch complete!
2024-04-25 16:12:56 INFO     evaluating now!
2024-04-25 16:12:57 INFO     Epoch [2/200] train_loss: 11.4173, val_loss: 10.6075, lr: 0.003000, 6.51s
2024-04-25 16:12:57 INFO     Saved model at 2
2024-04-25 16:12:57 INFO     Val loss decrease from 14.3577 to 10.6075, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-25 16:13:03 INFO     epoch complete!
2024-04-25 16:13:03 INFO     evaluating now!
2024-04-25 16:13:04 INFO     Epoch [3/200] train_loss: 9.1788, val_loss: 8.4138, lr: 0.003000, 6.73s
2024-04-25 16:13:04 INFO     Saved model at 3
2024-04-25 16:13:04 INFO     Val loss decrease from 10.6075 to 8.4138, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-25 16:13:10 INFO     epoch complete!
2024-04-25 16:13:10 INFO     evaluating now!
2024-04-25 16:13:10 INFO     Epoch [4/200] train_loss: 7.9618, val_loss: 7.8189, lr: 0.003000, 6.55s
2024-04-25 16:13:11 INFO     Saved model at 4
2024-04-25 16:13:11 INFO     Val loss decrease from 8.4138 to 7.8189, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-25 16:13:17 INFO     epoch complete!
2024-04-25 16:13:17 INFO     evaluating now!
2024-04-25 16:13:18 INFO     Epoch [5/200] train_loss: 7.2694, val_loss: 7.2229, lr: 0.003000, 6.71s
2024-04-25 16:13:18 INFO     Saved model at 5
2024-04-25 16:13:18 INFO     Val loss decrease from 7.8189 to 7.2229, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-25 16:13:24 INFO     epoch complete!
2024-04-25 16:13:24 INFO     evaluating now!
2024-04-25 16:13:25 INFO     Epoch [6/200] train_loss: 6.7375, val_loss: 6.8361, lr: 0.003000, 6.66s
2024-04-25 16:13:25 INFO     Saved model at 6
2024-04-25 16:13:25 INFO     Val loss decrease from 7.2229 to 6.8361, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-25 16:13:31 INFO     epoch complete!
2024-04-25 16:13:31 INFO     evaluating now!
2024-04-25 16:13:32 INFO     Epoch [7/200] train_loss: 6.3085, val_loss: 6.4045, lr: 0.003000, 6.68s
2024-04-25 16:13:32 INFO     Saved model at 7
2024-04-25 16:13:32 INFO     Val loss decrease from 6.8361 to 6.4045, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-25 16:13:38 INFO     epoch complete!
2024-04-25 16:13:38 INFO     evaluating now!
2024-04-25 16:13:39 INFO     Epoch [8/200] train_loss: 6.0093, val_loss: 6.1466, lr: 0.003000, 6.79s
2024-04-25 16:13:39 INFO     Saved model at 8
2024-04-25 16:13:39 INFO     Val loss decrease from 6.4045 to 6.1466, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-25 16:13:45 INFO     epoch complete!
2024-04-25 16:13:45 INFO     evaluating now!
2024-04-25 16:13:46 INFO     Epoch [9/200] train_loss: 5.8429, val_loss: 5.9933, lr: 0.003000, 6.77s
2024-04-25 16:13:46 INFO     Saved model at 9
2024-04-25 16:13:46 INFO     Val loss decrease from 6.1466 to 5.9933, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-25 16:13:52 INFO     epoch complete!
2024-04-25 16:13:52 INFO     evaluating now!
2024-04-25 16:13:52 INFO     Epoch [10/200] train_loss: 5.6483, val_loss: 5.8549, lr: 0.003000, 6.74s
2024-04-25 16:13:53 INFO     Saved model at 10
2024-04-25 16:13:53 INFO     Val loss decrease from 5.9933 to 5.8549, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-25 16:13:59 INFO     epoch complete!
2024-04-25 16:13:59 INFO     evaluating now!
2024-04-25 16:14:00 INFO     Epoch [11/200] train_loss: 5.5155, val_loss: 6.1168, lr: 0.003000, 6.84s
2024-04-25 16:14:06 INFO     epoch complete!
2024-04-25 16:14:06 INFO     evaluating now!
2024-04-25 16:14:07 INFO     Epoch [12/200] train_loss: 5.3662, val_loss: 5.7291, lr: 0.003000, 6.89s
2024-04-25 16:14:07 INFO     Saved model at 12
2024-04-25 16:14:07 INFO     Val loss decrease from 5.8549 to 5.7291, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-25 16:14:13 INFO     epoch complete!
2024-04-25 16:14:13 INFO     evaluating now!
2024-04-25 16:14:14 INFO     Epoch [13/200] train_loss: 5.2529, val_loss: 5.6851, lr: 0.003000, 6.78s
2024-04-25 16:14:14 INFO     Saved model at 13
2024-04-25 16:14:14 INFO     Val loss decrease from 5.7291 to 5.6851, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-25 16:14:20 INFO     epoch complete!
2024-04-25 16:14:20 INFO     evaluating now!
2024-04-25 16:14:21 INFO     Epoch [14/200] train_loss: 5.1504, val_loss: 5.5029, lr: 0.003000, 6.80s
2024-04-25 16:14:21 INFO     Saved model at 14
2024-04-25 16:14:21 INFO     Val loss decrease from 5.6851 to 5.5029, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-25 16:14:27 INFO     epoch complete!
2024-04-25 16:14:27 INFO     evaluating now!
2024-04-25 16:14:28 INFO     Epoch [15/200] train_loss: 5.0403, val_loss: 5.6292, lr: 0.003000, 6.86s
2024-04-25 16:14:34 INFO     epoch complete!
2024-04-25 16:14:34 INFO     evaluating now!
2024-04-25 16:14:34 INFO     Epoch [16/200] train_loss: 5.0170, val_loss: 5.5148, lr: 0.003000, 6.72s
2024-04-25 16:14:41 INFO     epoch complete!
2024-04-25 16:14:41 INFO     evaluating now!
2024-04-25 16:14:41 INFO     Epoch [17/200] train_loss: 4.8563, val_loss: 5.5554, lr: 0.003000, 6.75s
2024-04-25 16:14:48 INFO     epoch complete!
2024-04-25 16:14:48 INFO     evaluating now!
2024-04-25 16:14:48 INFO     Epoch [18/200] train_loss: 4.8771, val_loss: 5.3347, lr: 0.003000, 7.05s
2024-04-25 16:14:48 INFO     Saved model at 18
2024-04-25 16:14:48 INFO     Val loss decrease from 5.5029 to 5.3347, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-25 16:14:55 INFO     epoch complete!
2024-04-25 16:14:55 INFO     evaluating now!
2024-04-25 16:14:55 INFO     Epoch [19/200] train_loss: 4.7942, val_loss: 5.2283, lr: 0.003000, 6.98s
2024-04-25 16:14:56 INFO     Saved model at 19
2024-04-25 16:14:56 INFO     Val loss decrease from 5.3347 to 5.2283, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-25 16:15:02 INFO     epoch complete!
2024-04-25 16:15:02 INFO     evaluating now!
2024-04-25 16:15:03 INFO     Epoch [20/200] train_loss: 4.7038, val_loss: 5.1731, lr: 0.003000, 7.27s
2024-04-25 16:15:03 INFO     Saved model at 20
2024-04-25 16:15:03 INFO     Val loss decrease from 5.2283 to 5.1731, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-25 16:15:09 INFO     epoch complete!
2024-04-25 16:15:09 INFO     evaluating now!
2024-04-25 16:15:10 INFO     Epoch [21/200] train_loss: 4.6280, val_loss: 5.3022, lr: 0.003000, 6.87s
2024-04-25 16:15:16 INFO     epoch complete!
2024-04-25 16:15:16 INFO     evaluating now!
2024-04-25 16:15:17 INFO     Epoch [22/200] train_loss: 4.6197, val_loss: 5.3002, lr: 0.003000, 6.91s
2024-04-25 16:15:23 INFO     epoch complete!
2024-04-25 16:15:23 INFO     evaluating now!
2024-04-25 16:15:24 INFO     Epoch [23/200] train_loss: 4.5793, val_loss: 5.3548, lr: 0.003000, 6.88s
2024-04-25 16:15:30 INFO     epoch complete!
2024-04-25 16:15:30 INFO     evaluating now!
2024-04-25 16:15:31 INFO     Epoch [24/200] train_loss: 4.4938, val_loss: 5.2247, lr: 0.003000, 6.80s
2024-04-25 16:15:37 INFO     epoch complete!
2024-04-25 16:15:37 INFO     evaluating now!
2024-04-25 16:15:37 INFO     Epoch [25/200] train_loss: 4.3832, val_loss: 5.1873, lr: 0.003000, 6.77s
2024-04-25 16:15:44 INFO     epoch complete!
2024-04-25 16:15:44 INFO     evaluating now!
2024-04-25 16:15:44 INFO     Epoch [26/200] train_loss: 4.4349, val_loss: 5.2087, lr: 0.003000, 6.97s
2024-04-25 16:15:51 INFO     epoch complete!
2024-04-25 16:15:51 INFO     evaluating now!
2024-04-25 16:15:51 INFO     Epoch [27/200] train_loss: 4.3380, val_loss: 5.3225, lr: 0.003000, 6.96s
2024-04-25 16:15:58 INFO     epoch complete!
2024-04-25 16:15:58 INFO     evaluating now!
2024-04-25 16:15:58 INFO     Epoch [28/200] train_loss: 4.3034, val_loss: 5.1567, lr: 0.003000, 6.97s
2024-04-25 16:15:58 INFO     Saved model at 28
2024-04-25 16:15:58 INFO     Val loss decrease from 5.1731 to 5.1567, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-04-25 16:16:05 INFO     epoch complete!
2024-04-25 16:16:05 INFO     evaluating now!
2024-04-25 16:16:05 INFO     Epoch [29/200] train_loss: 4.2265, val_loss: 5.1986, lr: 0.003000, 6.85s
2024-04-25 16:16:12 INFO     epoch complete!
2024-04-25 16:16:12 INFO     evaluating now!
2024-04-25 16:16:12 INFO     Epoch [30/200] train_loss: 4.2630, val_loss: 5.1498, lr: 0.003000, 6.91s
2024-04-25 16:16:12 INFO     Saved model at 30
2024-04-25 16:16:12 INFO     Val loss decrease from 5.1567 to 5.1498, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-04-25 16:16:19 INFO     epoch complete!
2024-04-25 16:16:19 INFO     evaluating now!
2024-04-25 16:16:19 INFO     Epoch [31/200] train_loss: 4.1849, val_loss: 5.3403, lr: 0.003000, 6.87s
2024-04-25 16:16:25 INFO     epoch complete!
2024-04-25 16:16:25 INFO     evaluating now!
2024-04-25 16:16:26 INFO     Epoch [32/200] train_loss: 4.1552, val_loss: 5.1978, lr: 0.003000, 6.69s
2024-04-25 16:16:32 INFO     epoch complete!
2024-04-25 16:16:32 INFO     evaluating now!
2024-04-25 16:16:33 INFO     Epoch [33/200] train_loss: 4.0938, val_loss: 5.1883, lr: 0.003000, 6.65s
2024-04-25 16:16:39 INFO     epoch complete!
2024-04-25 16:16:39 INFO     evaluating now!
2024-04-25 16:16:39 INFO     Epoch [34/200] train_loss: 4.0920, val_loss: 5.1068, lr: 0.003000, 6.75s
2024-04-25 16:16:40 INFO     Saved model at 34
2024-04-25 16:16:40 INFO     Val loss decrease from 5.1498 to 5.1068, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-04-25 16:16:46 INFO     epoch complete!
2024-04-25 16:16:46 INFO     evaluating now!
2024-04-25 16:16:46 INFO     Epoch [35/200] train_loss: 4.0240, val_loss: 5.1726, lr: 0.003000, 6.65s
2024-04-25 16:16:53 INFO     epoch complete!
2024-04-25 16:16:53 INFO     evaluating now!
2024-04-25 16:16:53 INFO     Epoch [36/200] train_loss: 3.9807, val_loss: 5.1213, lr: 0.003000, 6.81s
2024-04-25 16:16:59 INFO     epoch complete!
2024-04-25 16:16:59 INFO     evaluating now!
2024-04-25 16:17:00 INFO     Epoch [37/200] train_loss: 3.9849, val_loss: 5.2317, lr: 0.003000, 6.83s
2024-04-25 16:17:06 INFO     epoch complete!
2024-04-25 16:17:06 INFO     evaluating now!
2024-04-25 16:17:07 INFO     Epoch [38/200] train_loss: 3.9709, val_loss: 5.2842, lr: 0.003000, 6.66s
2024-04-25 16:17:13 INFO     epoch complete!
2024-04-25 16:17:13 INFO     evaluating now!
2024-04-25 16:17:13 INFO     Epoch [39/200] train_loss: 3.9230, val_loss: 4.9863, lr: 0.003000, 6.75s
2024-04-25 16:17:13 INFO     Saved model at 39
2024-04-25 16:17:13 INFO     Val loss decrease from 5.1068 to 4.9863, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-04-25 16:17:20 INFO     epoch complete!
2024-04-25 16:17:20 INFO     evaluating now!
2024-04-25 16:17:20 INFO     Epoch [40/200] train_loss: 3.8882, val_loss: 5.2252, lr: 0.003000, 6.76s
2024-04-25 16:17:26 INFO     epoch complete!
2024-04-25 16:17:26 INFO     evaluating now!
2024-04-25 16:17:27 INFO     Epoch [41/200] train_loss: 3.9358, val_loss: 5.2041, lr: 0.003000, 6.71s
2024-04-25 16:17:33 INFO     epoch complete!
2024-04-25 16:17:33 INFO     evaluating now!
2024-04-25 16:17:34 INFO     Epoch [42/200] train_loss: 3.9119, val_loss: 5.0472, lr: 0.003000, 6.84s
2024-04-25 16:17:40 INFO     epoch complete!
2024-04-25 16:17:40 INFO     evaluating now!
2024-04-25 16:17:41 INFO     Epoch [43/200] train_loss: 3.8291, val_loss: 5.0032, lr: 0.003000, 6.77s
2024-04-25 16:17:47 INFO     epoch complete!
2024-04-25 16:17:47 INFO     evaluating now!
2024-04-25 16:17:47 INFO     Epoch [44/200] train_loss: 3.7572, val_loss: 5.1196, lr: 0.003000, 6.68s
2024-04-25 16:17:54 INFO     epoch complete!
2024-04-25 16:17:54 INFO     evaluating now!
2024-04-25 16:17:54 INFO     Epoch [45/200] train_loss: 3.7932, val_loss: 5.1343, lr: 0.003000, 6.78s
2024-04-25 16:18:00 INFO     epoch complete!
2024-04-25 16:18:00 INFO     evaluating now!
2024-04-25 16:18:01 INFO     Epoch [46/200] train_loss: 3.8540, val_loss: 5.0829, lr: 0.003000, 6.74s
2024-04-25 16:18:07 INFO     epoch complete!
2024-04-25 16:18:07 INFO     evaluating now!
2024-04-25 16:18:08 INFO     Epoch [47/200] train_loss: 3.7647, val_loss: 4.9508, lr: 0.003000, 6.77s
2024-04-25 16:18:08 INFO     Saved model at 47
2024-04-25 16:18:08 INFO     Val loss decrease from 4.9863 to 4.9508, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch47.tar
2024-04-25 16:18:14 INFO     epoch complete!
2024-04-25 16:18:14 INFO     evaluating now!
2024-04-25 16:18:15 INFO     Epoch [48/200] train_loss: 3.6960, val_loss: 5.0308, lr: 0.003000, 6.77s
2024-04-25 16:18:21 INFO     epoch complete!
2024-04-25 16:18:21 INFO     evaluating now!
2024-04-25 16:18:21 INFO     Epoch [49/200] train_loss: 3.7187, val_loss: 5.0816, lr: 0.003000, 6.85s
2024-04-25 16:18:28 INFO     epoch complete!
2024-04-25 16:18:28 INFO     evaluating now!
2024-04-25 16:18:28 INFO     Epoch [50/200] train_loss: 3.7168, val_loss: 5.1302, lr: 0.003000, 6.95s
2024-04-25 16:18:35 INFO     epoch complete!
2024-04-25 16:18:35 INFO     evaluating now!
2024-04-25 16:18:35 INFO     Epoch [51/200] train_loss: 3.6577, val_loss: 5.1993, lr: 0.003000, 6.66s
2024-04-25 16:18:41 INFO     epoch complete!
2024-04-25 16:18:41 INFO     evaluating now!
2024-04-25 16:18:42 INFO     Epoch [52/200] train_loss: 3.6513, val_loss: 5.1819, lr: 0.003000, 6.66s
2024-04-25 16:18:48 INFO     epoch complete!
2024-04-25 16:18:48 INFO     evaluating now!
2024-04-25 16:18:48 INFO     Epoch [53/200] train_loss: 3.6934, val_loss: 4.9781, lr: 0.003000, 6.72s
2024-04-25 16:18:55 INFO     epoch complete!
2024-04-25 16:18:55 INFO     evaluating now!
2024-04-25 16:18:55 INFO     Epoch [54/200] train_loss: 3.5896, val_loss: 4.9864, lr: 0.003000, 6.62s
2024-04-25 16:19:01 INFO     epoch complete!
2024-04-25 16:19:01 INFO     evaluating now!
2024-04-25 16:19:02 INFO     Epoch [55/200] train_loss: 3.6518, val_loss: 5.0009, lr: 0.003000, 6.95s
2024-04-25 16:19:08 INFO     epoch complete!
2024-04-25 16:19:08 INFO     evaluating now!
2024-04-25 16:19:09 INFO     Epoch [56/200] train_loss: 3.5719, val_loss: 4.9404, lr: 0.003000, 6.67s
2024-04-25 16:19:09 INFO     Saved model at 56
2024-04-25 16:19:09 INFO     Val loss decrease from 4.9508 to 4.9404, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch56.tar
2024-04-25 16:19:15 INFO     epoch complete!
2024-04-25 16:19:15 INFO     evaluating now!
2024-04-25 16:19:16 INFO     Epoch [57/200] train_loss: 3.5261, val_loss: 5.0083, lr: 0.003000, 6.81s
2024-04-25 16:19:22 INFO     epoch complete!
2024-04-25 16:19:22 INFO     evaluating now!
2024-04-25 16:19:22 INFO     Epoch [58/200] train_loss: 3.5394, val_loss: 5.1078, lr: 0.003000, 6.77s
2024-04-25 16:19:29 INFO     epoch complete!
2024-04-25 16:19:29 INFO     evaluating now!
2024-04-25 16:19:29 INFO     Epoch [59/200] train_loss: 3.5024, val_loss: 4.9611, lr: 0.003000, 6.67s
2024-04-25 16:19:35 INFO     epoch complete!
2024-04-25 16:19:35 INFO     evaluating now!
2024-04-25 16:19:36 INFO     Epoch [60/200] train_loss: 3.5118, val_loss: 5.1960, lr: 0.003000, 6.75s
2024-04-25 16:19:42 INFO     epoch complete!
2024-04-25 16:19:42 INFO     evaluating now!
2024-04-25 16:19:43 INFO     Epoch [61/200] train_loss: 3.5182, val_loss: 4.9542, lr: 0.003000, 6.73s
2024-04-25 16:19:49 INFO     epoch complete!
2024-04-25 16:19:49 INFO     evaluating now!
2024-04-25 16:19:49 INFO     Epoch [62/200] train_loss: 3.4701, val_loss: 5.0206, lr: 0.003000, 6.81s
2024-04-25 16:19:56 INFO     epoch complete!
2024-04-25 16:19:56 INFO     evaluating now!
2024-04-25 16:19:56 INFO     Epoch [63/200] train_loss: 3.4892, val_loss: 5.0036, lr: 0.003000, 6.70s
2024-04-25 16:20:03 INFO     epoch complete!
2024-04-25 16:20:03 INFO     evaluating now!
2024-04-25 16:20:03 INFO     Epoch [64/200] train_loss: 3.4631, val_loss: 5.0139, lr: 0.003000, 7.15s
2024-04-25 16:20:09 INFO     epoch complete!
2024-04-25 16:20:09 INFO     evaluating now!
2024-04-25 16:20:10 INFO     Epoch [65/200] train_loss: 3.4727, val_loss: 5.0046, lr: 0.003000, 6.71s
2024-04-25 16:20:16 INFO     epoch complete!
2024-04-25 16:20:16 INFO     evaluating now!
2024-04-25 16:20:17 INFO     Epoch [66/200] train_loss: 3.4562, val_loss: 4.9426, lr: 0.003000, 6.75s
2024-04-25 16:20:23 INFO     epoch complete!
2024-04-25 16:20:23 INFO     evaluating now!
2024-04-25 16:20:23 INFO     Epoch [67/200] train_loss: 3.4137, val_loss: 4.9374, lr: 0.003000, 6.71s
2024-04-25 16:20:24 INFO     Saved model at 67
2024-04-25 16:20:24 INFO     Val loss decrease from 4.9404 to 4.9374, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch67.tar
2024-04-25 16:20:30 INFO     epoch complete!
2024-04-25 16:20:30 INFO     evaluating now!
2024-04-25 16:20:30 INFO     Epoch [68/200] train_loss: 3.3758, val_loss: 5.1107, lr: 0.003000, 6.71s
2024-04-25 16:20:37 INFO     epoch complete!
2024-04-25 16:20:37 INFO     evaluating now!
2024-04-25 16:20:37 INFO     Epoch [69/200] train_loss: 3.4164, val_loss: 5.1631, lr: 0.003000, 6.68s
2024-04-25 16:20:43 INFO     epoch complete!
2024-04-25 16:20:43 INFO     evaluating now!
2024-04-25 16:20:44 INFO     Epoch [70/200] train_loss: 3.4533, val_loss: 5.0529, lr: 0.003000, 6.66s
2024-04-25 16:20:50 INFO     epoch complete!
2024-04-25 16:20:50 INFO     evaluating now!
2024-04-25 16:20:50 INFO     Epoch [71/200] train_loss: 3.4000, val_loss: 4.9562, lr: 0.003000, 6.72s
2024-04-25 16:20:57 INFO     epoch complete!
2024-04-25 16:20:57 INFO     evaluating now!
2024-04-25 16:20:57 INFO     Epoch [72/200] train_loss: 3.4080, val_loss: 5.0047, lr: 0.003000, 6.60s
2024-04-25 16:21:03 INFO     epoch complete!
2024-04-25 16:21:03 INFO     evaluating now!
2024-04-25 16:21:04 INFO     Epoch [73/200] train_loss: 3.3658, val_loss: 4.9469, lr: 0.003000, 6.73s
2024-04-25 16:21:10 INFO     epoch complete!
2024-04-25 16:21:10 INFO     evaluating now!
2024-04-25 16:21:10 INFO     Epoch [74/200] train_loss: 3.3334, val_loss: 5.1768, lr: 0.003000, 6.69s
2024-04-25 16:21:17 INFO     epoch complete!
2024-04-25 16:21:17 INFO     evaluating now!
2024-04-25 16:21:17 INFO     Epoch [75/200] train_loss: 3.3518, val_loss: 5.1681, lr: 0.003000, 6.88s
2024-04-25 16:21:24 INFO     epoch complete!
2024-04-25 16:21:24 INFO     evaluating now!
2024-04-25 16:21:24 INFO     Epoch [76/200] train_loss: 3.3235, val_loss: 5.0086, lr: 0.003000, 6.84s
2024-04-25 16:21:31 INFO     epoch complete!
2024-04-25 16:21:31 INFO     evaluating now!
2024-04-25 16:21:31 INFO     Epoch [77/200] train_loss: 3.3016, val_loss: 4.9849, lr: 0.003000, 7.15s
2024-04-25 16:21:38 INFO     epoch complete!
2024-04-25 16:21:38 INFO     evaluating now!
2024-04-25 16:21:38 INFO     Epoch [78/200] train_loss: 3.2977, val_loss: 5.0107, lr: 0.003000, 7.08s
2024-04-25 16:21:45 INFO     epoch complete!
2024-04-25 16:21:45 INFO     evaluating now!
2024-04-25 16:21:45 INFO     Epoch [79/200] train_loss: 3.2683, val_loss: 5.0493, lr: 0.003000, 6.95s
2024-04-25 16:21:52 INFO     epoch complete!
2024-04-25 16:21:52 INFO     evaluating now!
2024-04-25 16:21:52 INFO     Epoch [80/200] train_loss: 3.2557, val_loss: 5.2113, lr: 0.003000, 6.97s
2024-04-25 16:21:59 INFO     epoch complete!
2024-04-25 16:21:59 INFO     evaluating now!
2024-04-25 16:21:59 INFO     Epoch [81/200] train_loss: 3.3391, val_loss: 5.0094, lr: 0.003000, 6.95s
2024-04-25 16:22:06 INFO     epoch complete!
2024-04-25 16:22:06 INFO     evaluating now!
2024-04-25 16:22:06 INFO     Epoch [82/200] train_loss: 3.2896, val_loss: 5.0966, lr: 0.003000, 7.21s
2024-04-25 16:22:06 WARNING  Early stopping at epoch: 82
2024-04-25 16:22:06 INFO     Trained totally 83 epochs, average train time is 6.308s, average eval time is 0.490s
2024-04-25 16:22:07 INFO     Loaded model at 67
2024-04-25 16:22:07 INFO     Saved model at ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406.m
2024-04-25 16:22:07 INFO     Start evaluating ...
2024-04-25 16:22:09 INFO     Note that you select the single mode to evaluate!
2024-04-25 16:22:09 INFO     Evaluate result is saved at ./libcity/cache/15/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-25 16:22:09 INFO     
         MAE       RMSE
1   2.368667   6.891988
2   2.505645   7.591132
3   2.657413   8.692170
4   2.867856   9.579685
5   3.054777  10.869210
6   3.220518  12.252403
7   3.331330  13.415757
8   3.426220  14.141146
9   3.486459  14.478880
10  3.559867  14.720124
11  3.659086  15.154085
12  3.727010  15.787997
2024-04-25 16:22:09 INFO     ----------------------------------------------------------------------------
2024-04-25 16:22:09 INFO     # 1, Kownledge Graph Embedding: GIE, Experiment ids: 16
2024-04-25 16:22:09 INFO     ----------------------------------------------------------------------------
2024-04-25 16:22:11 INFO     Log directory: ./libcity/log
2024-04-25 16:22:11 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=16
2024-04-25 16:22:11 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 544396953, 'exp_id': 16, 'load_external': True, 'embedding_model': 'GIE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-25 16:22:11 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-25 16:22:11 INFO     set_weight_link_or_dist: dist
2024-04-25 16:22:11 INFO     init_weight_inf_or_zero: inf
2024-04-25 16:22:11 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-25 16:22:11 INFO     Start Calculate the weight by Gauss kernel!
2024-04-25 16:22:11 INFO     Loading file CHITaxi20190406.dyna
2024-04-25 16:22:12 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-25 16:22:15 INFO     Dataset created
2024-04-25 16:22:15 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-25 16:22:15 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-25 16:22:15 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-25 16:22:15 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-25 16:22:15 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-25 16:22:15 INFO     NoneScaler
2024-04-25 16:22:18 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-25 16:22:18 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-25 16:22:18 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-25 16:22:18 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 16:22:18 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-25 16:22:18 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 16:22:18 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-25 16:22:18 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 16:22:18 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-25 16:22:18 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 16:22:18 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-25 16:22:18 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-25 16:22:18 INFO     Total parameter numbers: 874010
2024-04-25 16:22:18 INFO     You select `adam` optimizer.
2024-04-25 16:22:18 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-25 16:22:18 INFO     Start training ...
2024-04-25 16:22:18 INFO     num_batches:48
2024-04-25 16:22:24 INFO     epoch complete!
2024-04-25 16:22:24 INFO     evaluating now!
2024-04-25 16:22:25 INFO     Epoch [0/200] train_loss: 25.3026, val_loss: 18.1371, lr: 0.003000, 6.93s
2024-04-25 16:22:25 INFO     Saved model at 0
2024-04-25 16:22:25 INFO     Val loss decrease from inf to 18.1371, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-25 16:22:32 INFO     epoch complete!
2024-04-25 16:22:32 INFO     evaluating now!
2024-04-25 16:22:32 INFO     Epoch [1/200] train_loss: 15.1927, val_loss: 14.7702, lr: 0.003000, 7.04s
2024-04-25 16:22:32 INFO     Saved model at 1
2024-04-25 16:22:32 INFO     Val loss decrease from 18.1371 to 14.7702, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-25 16:22:39 INFO     epoch complete!
2024-04-25 16:22:39 INFO     evaluating now!
2024-04-25 16:22:39 INFO     Epoch [2/200] train_loss: 12.1976, val_loss: 11.5878, lr: 0.003000, 6.94s
2024-04-25 16:22:39 INFO     Saved model at 2
2024-04-25 16:22:39 INFO     Val loss decrease from 14.7702 to 11.5878, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-25 16:22:46 INFO     epoch complete!
2024-04-25 16:22:46 INFO     evaluating now!
2024-04-25 16:22:46 INFO     Epoch [3/200] train_loss: 9.7982, val_loss: 9.3409, lr: 0.003000, 6.94s
2024-04-25 16:22:47 INFO     Saved model at 3
2024-04-25 16:22:47 INFO     Val loss decrease from 11.5878 to 9.3409, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-25 16:22:53 INFO     epoch complete!
2024-04-25 16:22:53 INFO     evaluating now!
2024-04-25 16:22:54 INFO     Epoch [4/200] train_loss: 8.2982, val_loss: 7.9175, lr: 0.003000, 6.98s
2024-04-25 16:22:54 INFO     Saved model at 4
2024-04-25 16:22:54 INFO     Val loss decrease from 9.3409 to 7.9175, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-25 16:23:00 INFO     epoch complete!
2024-04-25 16:23:00 INFO     evaluating now!
2024-04-25 16:23:01 INFO     Epoch [5/200] train_loss: 7.5327, val_loss: 7.5627, lr: 0.003000, 7.13s
2024-04-25 16:23:01 INFO     Saved model at 5
2024-04-25 16:23:01 INFO     Val loss decrease from 7.9175 to 7.5627, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-25 16:23:08 INFO     epoch complete!
2024-04-25 16:23:08 INFO     evaluating now!
2024-04-25 16:23:08 INFO     Epoch [6/200] train_loss: 6.9710, val_loss: 6.7240, lr: 0.003000, 6.97s
2024-04-25 16:23:08 INFO     Saved model at 6
2024-04-25 16:23:08 INFO     Val loss decrease from 7.5627 to 6.7240, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-25 16:23:15 INFO     epoch complete!
2024-04-25 16:23:15 INFO     evaluating now!
2024-04-25 16:23:15 INFO     Epoch [7/200] train_loss: 6.4483, val_loss: 6.4969, lr: 0.003000, 6.91s
2024-04-25 16:23:16 INFO     Saved model at 7
2024-04-25 16:23:16 INFO     Val loss decrease from 6.7240 to 6.4969, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-25 16:23:22 INFO     epoch complete!
2024-04-25 16:23:22 INFO     evaluating now!
2024-04-25 16:23:23 INFO     Epoch [8/200] train_loss: 6.1335, val_loss: 6.6420, lr: 0.003000, 6.84s
2024-04-25 16:23:29 INFO     epoch complete!
2024-04-25 16:23:29 INFO     evaluating now!
2024-04-25 16:23:29 INFO     Epoch [9/200] train_loss: 6.0115, val_loss: 6.0955, lr: 0.003000, 6.94s
2024-04-25 16:23:30 INFO     Saved model at 9
2024-04-25 16:23:30 INFO     Val loss decrease from 6.4969 to 6.0955, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-25 16:23:36 INFO     epoch complete!
2024-04-25 16:23:36 INFO     evaluating now!
2024-04-25 16:23:37 INFO     Epoch [10/200] train_loss: 5.6920, val_loss: 5.8627, lr: 0.003000, 7.06s
2024-04-25 16:23:37 INFO     Saved model at 10
2024-04-25 16:23:37 INFO     Val loss decrease from 6.0955 to 5.8627, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-25 16:23:43 INFO     epoch complete!
2024-04-25 16:23:43 INFO     evaluating now!
2024-04-25 16:23:44 INFO     Epoch [11/200] train_loss: 5.6645, val_loss: 5.9977, lr: 0.003000, 6.90s
2024-04-25 16:23:50 INFO     epoch complete!
2024-04-25 16:23:50 INFO     evaluating now!
2024-04-25 16:23:51 INFO     Epoch [12/200] train_loss: 5.4277, val_loss: 5.8342, lr: 0.003000, 6.85s
2024-04-25 16:23:51 INFO     Saved model at 12
2024-04-25 16:23:51 INFO     Val loss decrease from 5.8627 to 5.8342, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-25 16:23:58 INFO     epoch complete!
2024-04-25 16:23:58 INFO     evaluating now!
2024-04-25 16:23:58 INFO     Epoch [13/200] train_loss: 5.3368, val_loss: 5.9302, lr: 0.003000, 7.13s
2024-04-25 16:24:04 INFO     epoch complete!
2024-04-25 16:24:04 INFO     evaluating now!
2024-04-25 16:24:05 INFO     Epoch [14/200] train_loss: 5.3063, val_loss: 5.6425, lr: 0.003000, 6.84s
2024-04-25 16:24:05 INFO     Saved model at 14
2024-04-25 16:24:05 INFO     Val loss decrease from 5.8342 to 5.6425, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-25 16:24:12 INFO     epoch complete!
2024-04-25 16:24:12 INFO     evaluating now!
2024-04-25 16:24:12 INFO     Epoch [15/200] train_loss: 5.1403, val_loss: 5.4708, lr: 0.003000, 6.97s
2024-04-25 16:24:12 INFO     Saved model at 15
2024-04-25 16:24:12 INFO     Val loss decrease from 5.6425 to 5.4708, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-25 16:24:19 INFO     epoch complete!
2024-04-25 16:24:19 INFO     evaluating now!
2024-04-25 16:24:19 INFO     Epoch [16/200] train_loss: 5.0387, val_loss: 5.6113, lr: 0.003000, 6.91s
2024-04-25 16:24:26 INFO     epoch complete!
2024-04-25 16:24:26 INFO     evaluating now!
2024-04-25 16:24:26 INFO     Epoch [17/200] train_loss: 4.9116, val_loss: 5.4144, lr: 0.003000, 6.89s
2024-04-25 16:24:26 INFO     Saved model at 17
2024-04-25 16:24:26 INFO     Val loss decrease from 5.4708 to 5.4144, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-25 16:24:33 INFO     epoch complete!
2024-04-25 16:24:33 INFO     evaluating now!
2024-04-25 16:24:33 INFO     Epoch [18/200] train_loss: 4.8987, val_loss: 5.4414, lr: 0.003000, 7.19s
2024-04-25 16:24:40 INFO     epoch complete!
2024-04-25 16:24:40 INFO     evaluating now!
2024-04-25 16:24:40 INFO     Epoch [19/200] train_loss: 4.8619, val_loss: 5.4981, lr: 0.003000, 7.02s
2024-04-25 16:24:47 INFO     epoch complete!
2024-04-25 16:24:47 INFO     evaluating now!
2024-04-25 16:24:48 INFO     Epoch [20/200] train_loss: 4.8004, val_loss: 5.1991, lr: 0.003000, 7.05s
2024-04-25 16:24:48 INFO     Saved model at 20
2024-04-25 16:24:48 INFO     Val loss decrease from 5.4144 to 5.1991, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-25 16:24:54 INFO     epoch complete!
2024-04-25 16:24:54 INFO     evaluating now!
2024-04-25 16:24:55 INFO     Epoch [21/200] train_loss: 4.7145, val_loss: 5.2115, lr: 0.003000, 6.91s
2024-04-25 16:25:01 INFO     epoch complete!
2024-04-25 16:25:01 INFO     evaluating now!
2024-04-25 16:25:02 INFO     Epoch [22/200] train_loss: 4.5994, val_loss: 5.1776, lr: 0.003000, 7.02s
2024-04-25 16:25:02 INFO     Saved model at 22
2024-04-25 16:25:02 INFO     Val loss decrease from 5.1991 to 5.1776, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-25 16:25:09 INFO     epoch complete!
2024-04-25 16:25:09 INFO     evaluating now!
2024-04-25 16:25:09 INFO     Epoch [23/200] train_loss: 4.5378, val_loss: 5.3006, lr: 0.003000, 7.19s
2024-04-25 16:25:16 INFO     epoch complete!
2024-04-25 16:25:16 INFO     evaluating now!
2024-04-25 16:25:16 INFO     Epoch [24/200] train_loss: 4.6131, val_loss: 5.2201, lr: 0.003000, 7.16s
2024-04-25 16:25:23 INFO     epoch complete!
2024-04-25 16:25:23 INFO     evaluating now!
2024-04-25 16:25:23 INFO     Epoch [25/200] train_loss: 4.4630, val_loss: 5.0446, lr: 0.003000, 7.14s
2024-04-25 16:25:23 INFO     Saved model at 25
2024-04-25 16:25:23 INFO     Val loss decrease from 5.1776 to 5.0446, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-25 16:25:30 INFO     epoch complete!
2024-04-25 16:25:30 INFO     evaluating now!
2024-04-25 16:25:31 INFO     Epoch [26/200] train_loss: 4.4760, val_loss: 5.0985, lr: 0.003000, 7.05s
2024-04-25 16:25:37 INFO     epoch complete!
2024-04-25 16:25:37 INFO     evaluating now!
2024-04-25 16:25:38 INFO     Epoch [27/200] train_loss: 4.4066, val_loss: 5.1194, lr: 0.003000, 7.13s
2024-04-25 16:25:44 INFO     epoch complete!
2024-04-25 16:25:44 INFO     evaluating now!
2024-04-25 16:25:45 INFO     Epoch [28/200] train_loss: 4.3104, val_loss: 5.0730, lr: 0.003000, 7.15s
2024-04-25 16:25:51 INFO     epoch complete!
2024-04-25 16:25:51 INFO     evaluating now!
2024-04-25 16:25:52 INFO     Epoch [29/200] train_loss: 4.3047, val_loss: 5.1096, lr: 0.003000, 7.18s
2024-04-25 16:25:58 INFO     epoch complete!
2024-04-25 16:25:58 INFO     evaluating now!
2024-04-25 16:25:59 INFO     Epoch [30/200] train_loss: 4.2858, val_loss: 5.1283, lr: 0.003000, 6.88s
2024-04-25 16:26:06 INFO     epoch complete!
2024-04-25 16:26:06 INFO     evaluating now!
2024-04-25 16:26:06 INFO     Epoch [31/200] train_loss: 4.2092, val_loss: 5.0021, lr: 0.003000, 7.22s
2024-04-25 16:26:06 INFO     Saved model at 31
2024-04-25 16:26:06 INFO     Val loss decrease from 5.0446 to 5.0021, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-04-25 16:26:13 INFO     epoch complete!
2024-04-25 16:26:13 INFO     evaluating now!
2024-04-25 16:26:13 INFO     Epoch [32/200] train_loss: 4.1293, val_loss: 5.3100, lr: 0.003000, 7.10s
2024-04-25 16:26:20 INFO     epoch complete!
2024-04-25 16:26:20 INFO     evaluating now!
2024-04-25 16:26:21 INFO     Epoch [33/200] train_loss: 4.1573, val_loss: 5.1297, lr: 0.003000, 7.27s
2024-04-25 16:26:27 INFO     epoch complete!
2024-04-25 16:26:27 INFO     evaluating now!
2024-04-25 16:26:28 INFO     Epoch [34/200] train_loss: 4.1651, val_loss: 5.1982, lr: 0.003000, 7.31s
2024-04-25 16:26:35 INFO     epoch complete!
2024-04-25 16:26:35 INFO     evaluating now!
2024-04-25 16:26:35 INFO     Epoch [35/200] train_loss: 4.0852, val_loss: 5.0667, lr: 0.003000, 7.43s
2024-04-25 16:26:42 INFO     epoch complete!
2024-04-25 16:26:42 INFO     evaluating now!
2024-04-25 16:26:43 INFO     Epoch [36/200] train_loss: 4.0580, val_loss: 5.1135, lr: 0.003000, 7.32s
2024-04-25 16:26:50 INFO     epoch complete!
2024-04-25 16:26:50 INFO     evaluating now!
2024-04-25 16:26:50 INFO     Epoch [37/200] train_loss: 4.0510, val_loss: 5.2657, lr: 0.003000, 7.33s
2024-04-25 16:26:57 INFO     epoch complete!
2024-04-25 16:26:57 INFO     evaluating now!
2024-04-25 16:26:57 INFO     Epoch [38/200] train_loss: 4.0053, val_loss: 5.0497, lr: 0.003000, 7.29s
2024-04-25 16:27:04 INFO     epoch complete!
2024-04-25 16:27:04 INFO     evaluating now!
2024-04-25 16:27:05 INFO     Epoch [39/200] train_loss: 3.9311, val_loss: 5.0036, lr: 0.003000, 7.33s
2024-04-25 16:27:11 INFO     epoch complete!
2024-04-25 16:27:11 INFO     evaluating now!
2024-04-25 16:27:12 INFO     Epoch [40/200] train_loss: 3.8992, val_loss: 5.0067, lr: 0.003000, 7.16s
2024-04-25 16:27:19 INFO     epoch complete!
2024-04-25 16:27:19 INFO     evaluating now!
2024-04-25 16:27:19 INFO     Epoch [41/200] train_loss: 3.9285, val_loss: 5.2085, lr: 0.003000, 7.39s
2024-04-25 16:27:26 INFO     epoch complete!
2024-04-25 16:27:26 INFO     evaluating now!
2024-04-25 16:27:26 INFO     Epoch [42/200] train_loss: 3.8784, val_loss: 5.0881, lr: 0.003000, 7.19s
2024-04-25 16:27:33 INFO     epoch complete!
2024-04-25 16:27:33 INFO     evaluating now!
2024-04-25 16:27:34 INFO     Epoch [43/200] train_loss: 3.8265, val_loss: 4.9911, lr: 0.003000, 7.14s
2024-04-25 16:27:34 INFO     Saved model at 43
2024-04-25 16:27:34 INFO     Val loss decrease from 5.0021 to 4.9911, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-04-25 16:27:40 INFO     epoch complete!
2024-04-25 16:27:40 INFO     evaluating now!
2024-04-25 16:27:41 INFO     Epoch [44/200] train_loss: 3.8095, val_loss: 5.0177, lr: 0.003000, 6.86s
2024-04-25 16:27:47 INFO     epoch complete!
2024-04-25 16:27:47 INFO     evaluating now!
2024-04-25 16:27:48 INFO     Epoch [45/200] train_loss: 3.7891, val_loss: 4.9318, lr: 0.003000, 7.07s
2024-04-25 16:27:48 INFO     Saved model at 45
2024-04-25 16:27:48 INFO     Val loss decrease from 4.9911 to 4.9318, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-04-25 16:27:54 INFO     epoch complete!
2024-04-25 16:27:54 INFO     evaluating now!
2024-04-25 16:27:55 INFO     Epoch [46/200] train_loss: 3.7805, val_loss: 5.0790, lr: 0.003000, 6.96s
2024-04-25 16:28:01 INFO     epoch complete!
2024-04-25 16:28:01 INFO     evaluating now!
2024-04-25 16:28:02 INFO     Epoch [47/200] train_loss: 3.7513, val_loss: 5.0790, lr: 0.003000, 7.06s
2024-04-25 16:28:08 INFO     epoch complete!
2024-04-25 16:28:08 INFO     evaluating now!
2024-04-25 16:28:09 INFO     Epoch [48/200] train_loss: 3.7204, val_loss: 5.1840, lr: 0.003000, 6.87s
2024-04-25 16:28:15 INFO     epoch complete!
2024-04-25 16:28:15 INFO     evaluating now!
2024-04-25 16:28:16 INFO     Epoch [49/200] train_loss: 3.7163, val_loss: 4.8985, lr: 0.003000, 6.84s
2024-04-25 16:28:16 INFO     Saved model at 49
2024-04-25 16:28:16 INFO     Val loss decrease from 4.9318 to 4.8985, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-04-25 16:28:22 INFO     epoch complete!
2024-04-25 16:28:22 INFO     evaluating now!
2024-04-25 16:28:23 INFO     Epoch [50/200] train_loss: 3.6685, val_loss: 4.9921, lr: 0.003000, 6.94s
2024-04-25 16:28:29 INFO     epoch complete!
2024-04-25 16:28:29 INFO     evaluating now!
2024-04-25 16:28:30 INFO     Epoch [51/200] train_loss: 3.6695, val_loss: 5.1246, lr: 0.003000, 7.11s
2024-04-25 16:28:37 INFO     epoch complete!
2024-04-25 16:28:37 INFO     evaluating now!
2024-04-25 16:28:37 INFO     Epoch [52/200] train_loss: 3.6537, val_loss: 5.1327, lr: 0.003000, 7.30s
2024-04-25 16:28:44 INFO     epoch complete!
2024-04-25 16:28:44 INFO     evaluating now!
2024-04-25 16:28:44 INFO     Epoch [53/200] train_loss: 3.6298, val_loss: 5.1154, lr: 0.003000, 7.18s
2024-04-25 16:28:51 INFO     epoch complete!
2024-04-25 16:28:51 INFO     evaluating now!
2024-04-25 16:28:52 INFO     Epoch [54/200] train_loss: 3.6584, val_loss: 5.0398, lr: 0.003000, 7.20s
2024-04-25 16:28:58 INFO     epoch complete!
2024-04-25 16:28:58 INFO     evaluating now!
2024-04-25 16:28:59 INFO     Epoch [55/200] train_loss: 3.6932, val_loss: 5.0503, lr: 0.003000, 7.24s
2024-04-25 16:29:06 INFO     epoch complete!
2024-04-25 16:29:06 INFO     evaluating now!
2024-04-25 16:29:06 INFO     Epoch [56/200] train_loss: 3.5655, val_loss: 5.0240, lr: 0.003000, 7.24s
2024-04-25 16:29:13 INFO     epoch complete!
2024-04-25 16:29:13 INFO     evaluating now!
2024-04-25 16:29:13 INFO     Epoch [57/200] train_loss: 3.5537, val_loss: 5.0262, lr: 0.003000, 7.21s
2024-04-25 16:29:20 INFO     epoch complete!
2024-04-25 16:29:20 INFO     evaluating now!
2024-04-25 16:29:20 INFO     Epoch [58/200] train_loss: 3.5087, val_loss: 5.0544, lr: 0.003000, 7.19s
2024-04-25 16:29:27 INFO     epoch complete!
2024-04-25 16:29:27 INFO     evaluating now!
2024-04-25 16:29:28 INFO     Epoch [59/200] train_loss: 3.5261, val_loss: 5.0738, lr: 0.003000, 7.16s
2024-04-25 16:29:34 INFO     epoch complete!
2024-04-25 16:29:34 INFO     evaluating now!
2024-04-25 16:29:35 INFO     Epoch [60/200] train_loss: 3.5257, val_loss: 5.0725, lr: 0.003000, 7.28s
2024-04-25 16:29:41 INFO     epoch complete!
2024-04-25 16:29:41 INFO     evaluating now!
2024-04-25 16:29:42 INFO     Epoch [61/200] train_loss: 3.5496, val_loss: 5.0799, lr: 0.003000, 7.02s
2024-04-25 16:29:49 INFO     epoch complete!
2024-04-25 16:29:49 INFO     evaluating now!
2024-04-25 16:29:49 INFO     Epoch [62/200] train_loss: 3.5265, val_loss: 5.0517, lr: 0.003000, 7.06s
2024-04-25 16:29:56 INFO     epoch complete!
2024-04-25 16:29:56 INFO     evaluating now!
2024-04-25 16:29:56 INFO     Epoch [63/200] train_loss: 3.4654, val_loss: 5.0151, lr: 0.003000, 7.06s
2024-04-25 16:30:03 INFO     epoch complete!
2024-04-25 16:30:03 INFO     evaluating now!
2024-04-25 16:30:03 INFO     Epoch [64/200] train_loss: 3.4689, val_loss: 5.1016, lr: 0.003000, 7.35s
2024-04-25 16:30:03 WARNING  Early stopping at epoch: 64
2024-04-25 16:30:03 INFO     Trained totally 65 epochs, average train time is 6.604s, average eval time is 0.485s
2024-04-25 16:30:04 INFO     Loaded model at 49
2024-04-25 16:30:04 INFO     Saved model at ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406.m
2024-04-25 16:30:04 INFO     Start evaluating ...
2024-04-25 16:30:06 INFO     Note that you select the single mode to evaluate!
2024-04-25 16:30:06 INFO     Evaluate result is saved at ./libcity/cache/16/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-25 16:30:06 INFO     
         MAE       RMSE
1   2.431849   6.999757
2   2.450170   7.458751
3   2.620157   8.537425
4   2.774487   9.501597
5   3.035665  10.361936
6   3.081260  10.973278
7   3.127244  11.580202
8   3.203649  12.048460
9   3.259404  12.363639
10  3.302067  12.786807
11  3.432851  13.374366
12  3.608401  14.085630
2024-04-25 16:30:07 INFO     ----------------------------------------------------------------------------
2024-04-25 16:30:07 INFO     # 2, Kownledge Graph Embedding: GIE, Experiment ids: 17
2024-04-25 16:30:07 INFO     ----------------------------------------------------------------------------
2024-04-25 16:30:08 INFO     Log directory: ./libcity/log
2024-04-25 16:30:08 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=17
2024-04-25 16:30:08 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 982819570, 'exp_id': 17, 'load_external': True, 'embedding_model': 'GIE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-25 16:30:08 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-25 16:30:08 INFO     set_weight_link_or_dist: dist
2024-04-25 16:30:08 INFO     init_weight_inf_or_zero: inf
2024-04-25 16:30:08 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-25 16:30:08 INFO     Start Calculate the weight by Gauss kernel!
2024-04-25 16:30:08 INFO     Loading file CHITaxi20190406.dyna
2024-04-25 16:30:08 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-25 16:30:12 INFO     Dataset created
2024-04-25 16:30:12 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-25 16:30:12 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-25 16:30:12 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-25 16:30:12 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-25 16:30:12 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-25 16:30:12 INFO     NoneScaler
2024-04-25 16:30:14 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-25 16:30:14 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-25 16:30:14 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-25 16:30:14 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 16:30:14 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-25 16:30:14 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 16:30:14 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-25 16:30:14 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 16:30:14 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-25 16:30:14 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 16:30:14 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-25 16:30:14 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-25 16:30:14 INFO     Total parameter numbers: 874010
2024-04-25 16:30:14 INFO     You select `adam` optimizer.
2024-04-25 16:30:14 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-25 16:30:14 INFO     Start training ...
2024-04-25 16:30:14 INFO     num_batches:48
2024-04-25 16:30:21 INFO     epoch complete!
2024-04-25 16:30:21 INFO     evaluating now!
2024-04-25 16:30:21 INFO     Epoch [0/200] train_loss: 24.5846, val_loss: 18.0951, lr: 0.003000, 6.49s
2024-04-25 16:30:21 INFO     Saved model at 0
2024-04-25 16:30:21 INFO     Val loss decrease from inf to 18.0951, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-25 16:30:28 INFO     epoch complete!
2024-04-25 16:30:28 INFO     evaluating now!
2024-04-25 16:30:28 INFO     Epoch [1/200] train_loss: 14.3965, val_loss: 13.5152, lr: 0.003000, 7.03s
2024-04-25 16:30:29 INFO     Saved model at 1
2024-04-25 16:30:29 INFO     Val loss decrease from 18.0951 to 13.5152, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-25 16:30:35 INFO     epoch complete!
2024-04-25 16:30:35 INFO     evaluating now!
2024-04-25 16:30:35 INFO     Epoch [2/200] train_loss: 11.0960, val_loss: 10.4554, lr: 0.003000, 6.56s
2024-04-25 16:30:35 INFO     Saved model at 2
2024-04-25 16:30:35 INFO     Val loss decrease from 13.5152 to 10.4554, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-25 16:30:42 INFO     epoch complete!
2024-04-25 16:30:42 INFO     evaluating now!
2024-04-25 16:30:42 INFO     Epoch [3/200] train_loss: 9.1444, val_loss: 8.7061, lr: 0.003000, 6.63s
2024-04-25 16:30:42 INFO     Saved model at 3
2024-04-25 16:30:42 INFO     Val loss decrease from 10.4554 to 8.7061, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-25 16:30:48 INFO     epoch complete!
2024-04-25 16:30:48 INFO     evaluating now!
2024-04-25 16:30:49 INFO     Epoch [4/200] train_loss: 7.9539, val_loss: 7.8159, lr: 0.003000, 6.59s
2024-04-25 16:30:49 INFO     Saved model at 4
2024-04-25 16:30:49 INFO     Val loss decrease from 8.7061 to 7.8159, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-25 16:30:56 INFO     epoch complete!
2024-04-25 16:30:56 INFO     evaluating now!
2024-04-25 16:30:56 INFO     Epoch [5/200] train_loss: 7.2846, val_loss: 7.0731, lr: 0.003000, 6.93s
2024-04-25 16:30:56 INFO     Saved model at 5
2024-04-25 16:30:56 INFO     Val loss decrease from 7.8159 to 7.0731, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-25 16:31:03 INFO     epoch complete!
2024-04-25 16:31:03 INFO     evaluating now!
2024-04-25 16:31:03 INFO     Epoch [6/200] train_loss: 6.7496, val_loss: 6.5381, lr: 0.003000, 6.72s
2024-04-25 16:31:03 INFO     Saved model at 6
2024-04-25 16:31:03 INFO     Val loss decrease from 7.0731 to 6.5381, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-25 16:31:10 INFO     epoch complete!
2024-04-25 16:31:10 INFO     evaluating now!
2024-04-25 16:31:10 INFO     Epoch [7/200] train_loss: 6.3695, val_loss: 6.6284, lr: 0.003000, 6.74s
2024-04-25 16:31:16 INFO     epoch complete!
2024-04-25 16:31:16 INFO     evaluating now!
2024-04-25 16:31:17 INFO     Epoch [8/200] train_loss: 6.0958, val_loss: 6.1060, lr: 0.003000, 6.60s
2024-04-25 16:31:17 INFO     Saved model at 8
2024-04-25 16:31:17 INFO     Val loss decrease from 6.5381 to 6.1060, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-25 16:31:23 INFO     epoch complete!
2024-04-25 16:31:23 INFO     evaluating now!
2024-04-25 16:31:24 INFO     Epoch [9/200] train_loss: 5.8774, val_loss: 5.8910, lr: 0.003000, 6.63s
2024-04-25 16:31:24 INFO     Saved model at 9
2024-04-25 16:31:24 INFO     Val loss decrease from 6.1060 to 5.8910, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-25 16:31:30 INFO     epoch complete!
2024-04-25 16:31:30 INFO     evaluating now!
2024-04-25 16:31:30 INFO     Epoch [10/200] train_loss: 5.6588, val_loss: 5.7569, lr: 0.003000, 6.66s
2024-04-25 16:31:31 INFO     Saved model at 10
2024-04-25 16:31:31 INFO     Val loss decrease from 5.8910 to 5.7569, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-25 16:31:37 INFO     epoch complete!
2024-04-25 16:31:37 INFO     evaluating now!
2024-04-25 16:31:37 INFO     Epoch [11/200] train_loss: 5.6991, val_loss: 5.6808, lr: 0.003000, 6.60s
2024-04-25 16:31:37 INFO     Saved model at 11
2024-04-25 16:31:37 INFO     Val loss decrease from 5.7569 to 5.6808, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-25 16:31:44 INFO     epoch complete!
2024-04-25 16:31:44 INFO     evaluating now!
2024-04-25 16:31:44 INFO     Epoch [12/200] train_loss: 5.4321, val_loss: 5.6428, lr: 0.003000, 6.60s
2024-04-25 16:31:44 INFO     Saved model at 12
2024-04-25 16:31:44 INFO     Val loss decrease from 5.6808 to 5.6428, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-25 16:31:50 INFO     epoch complete!
2024-04-25 16:31:50 INFO     evaluating now!
2024-04-25 16:31:51 INFO     Epoch [13/200] train_loss: 5.3332, val_loss: 5.6460, lr: 0.003000, 6.56s
2024-04-25 16:31:57 INFO     epoch complete!
2024-04-25 16:31:57 INFO     evaluating now!
2024-04-25 16:31:57 INFO     Epoch [14/200] train_loss: 5.2583, val_loss: 5.4830, lr: 0.003000, 6.19s
2024-04-25 16:31:57 INFO     Saved model at 14
2024-04-25 16:31:57 INFO     Val loss decrease from 5.6428 to 5.4830, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-25 16:32:03 INFO     epoch complete!
2024-04-25 16:32:03 INFO     evaluating now!
2024-04-25 16:32:03 INFO     Epoch [15/200] train_loss: 5.1130, val_loss: 5.4994, lr: 0.003000, 6.16s
2024-04-25 16:32:09 INFO     epoch complete!
2024-04-25 16:32:09 INFO     evaluating now!
2024-04-25 16:32:10 INFO     Epoch [16/200] train_loss: 4.9897, val_loss: 5.3366, lr: 0.003000, 6.30s
2024-04-25 16:32:10 INFO     Saved model at 16
2024-04-25 16:32:10 INFO     Val loss decrease from 5.4830 to 5.3366, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-25 16:32:16 INFO     epoch complete!
2024-04-25 16:32:16 INFO     evaluating now!
2024-04-25 16:32:16 INFO     Epoch [17/200] train_loss: 4.8723, val_loss: 5.4024, lr: 0.003000, 6.19s
2024-04-25 16:32:22 INFO     epoch complete!
2024-04-25 16:32:22 INFO     evaluating now!
2024-04-25 16:32:22 INFO     Epoch [18/200] train_loss: 4.8407, val_loss: 5.2724, lr: 0.003000, 6.28s
2024-04-25 16:32:23 INFO     Saved model at 18
2024-04-25 16:32:23 INFO     Val loss decrease from 5.3366 to 5.2724, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-25 16:32:28 INFO     epoch complete!
2024-04-25 16:32:28 INFO     evaluating now!
2024-04-25 16:32:29 INFO     Epoch [19/200] train_loss: 4.7637, val_loss: 5.3611, lr: 0.003000, 6.06s
2024-04-25 16:32:34 INFO     epoch complete!
2024-04-25 16:32:34 INFO     evaluating now!
2024-04-25 16:32:35 INFO     Epoch [20/200] train_loss: 4.7485, val_loss: 5.1924, lr: 0.003000, 6.24s
2024-04-25 16:32:35 INFO     Saved model at 20
2024-04-25 16:32:35 INFO     Val loss decrease from 5.2724 to 5.1924, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-25 16:32:41 INFO     epoch complete!
2024-04-25 16:32:41 INFO     evaluating now!
2024-04-25 16:32:42 INFO     Epoch [21/200] train_loss: 4.6385, val_loss: 5.1222, lr: 0.003000, 6.80s
2024-04-25 16:32:42 INFO     Saved model at 21
2024-04-25 16:32:42 INFO     Val loss decrease from 5.1924 to 5.1222, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-25 16:32:49 INFO     epoch complete!
2024-04-25 16:32:49 INFO     evaluating now!
2024-04-25 16:32:49 INFO     Epoch [22/200] train_loss: 4.6507, val_loss: 4.9729, lr: 0.003000, 6.91s
2024-04-25 16:32:49 INFO     Saved model at 22
2024-04-25 16:32:49 INFO     Val loss decrease from 5.1222 to 4.9729, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-25 16:32:56 INFO     epoch complete!
2024-04-25 16:32:56 INFO     evaluating now!
2024-04-25 16:32:56 INFO     Epoch [23/200] train_loss: 4.5734, val_loss: 5.1888, lr: 0.003000, 6.77s
2024-04-25 16:33:02 INFO     epoch complete!
2024-04-25 16:33:02 INFO     evaluating now!
2024-04-25 16:33:03 INFO     Epoch [24/200] train_loss: 4.5245, val_loss: 5.1695, lr: 0.003000, 6.70s
2024-04-25 16:33:09 INFO     epoch complete!
2024-04-25 16:33:09 INFO     evaluating now!
2024-04-25 16:33:10 INFO     Epoch [25/200] train_loss: 4.5134, val_loss: 5.0209, lr: 0.003000, 6.77s
2024-04-25 16:33:16 INFO     epoch complete!
2024-04-25 16:33:16 INFO     evaluating now!
2024-04-25 16:33:16 INFO     Epoch [26/200] train_loss: 4.3951, val_loss: 5.0558, lr: 0.003000, 6.82s
2024-04-25 16:33:23 INFO     epoch complete!
2024-04-25 16:33:23 INFO     evaluating now!
2024-04-25 16:33:23 INFO     Epoch [27/200] train_loss: 4.3873, val_loss: 5.2497, lr: 0.003000, 6.66s
2024-04-25 16:33:29 INFO     epoch complete!
2024-04-25 16:33:29 INFO     evaluating now!
2024-04-25 16:33:30 INFO     Epoch [28/200] train_loss: 4.3265, val_loss: 5.1415, lr: 0.003000, 6.77s
2024-04-25 16:33:36 INFO     epoch complete!
2024-04-25 16:33:36 INFO     evaluating now!
2024-04-25 16:33:37 INFO     Epoch [29/200] train_loss: 4.2515, val_loss: 4.9993, lr: 0.003000, 6.94s
2024-04-25 16:33:43 INFO     epoch complete!
2024-04-25 16:33:43 INFO     evaluating now!
2024-04-25 16:33:44 INFO     Epoch [30/200] train_loss: 4.2785, val_loss: 5.1256, lr: 0.003000, 6.84s
2024-04-25 16:33:50 INFO     epoch complete!
2024-04-25 16:33:50 INFO     evaluating now!
2024-04-25 16:33:50 INFO     Epoch [31/200] train_loss: 4.2064, val_loss: 4.9732, lr: 0.003000, 6.84s
2024-04-25 16:33:57 INFO     epoch complete!
2024-04-25 16:33:57 INFO     evaluating now!
2024-04-25 16:33:57 INFO     Epoch [32/200] train_loss: 4.2282, val_loss: 5.2438, lr: 0.003000, 6.85s
2024-04-25 16:34:04 INFO     epoch complete!
2024-04-25 16:34:04 INFO     evaluating now!
2024-04-25 16:34:04 INFO     Epoch [33/200] train_loss: 4.1127, val_loss: 5.1339, lr: 0.003000, 6.98s
2024-04-25 16:34:11 INFO     epoch complete!
2024-04-25 16:34:11 INFO     evaluating now!
2024-04-25 16:34:11 INFO     Epoch [34/200] train_loss: 4.1300, val_loss: 5.2075, lr: 0.003000, 6.75s
2024-04-25 16:34:17 INFO     epoch complete!
2024-04-25 16:34:17 INFO     evaluating now!
2024-04-25 16:34:18 INFO     Epoch [35/200] train_loss: 4.0824, val_loss: 5.1238, lr: 0.003000, 6.92s
2024-04-25 16:34:24 INFO     epoch complete!
2024-04-25 16:34:24 INFO     evaluating now!
2024-04-25 16:34:25 INFO     Epoch [36/200] train_loss: 4.1045, val_loss: 5.0846, lr: 0.003000, 6.88s
2024-04-25 16:34:31 INFO     epoch complete!
2024-04-25 16:34:31 INFO     evaluating now!
2024-04-25 16:34:31 INFO     Epoch [37/200] train_loss: 4.0477, val_loss: 4.9789, lr: 0.003000, 6.55s
2024-04-25 16:34:31 WARNING  Early stopping at epoch: 37
2024-04-25 16:34:31 INFO     Trained totally 38 epochs, average train time is 6.198s, average eval time is 0.444s
2024-04-25 16:34:32 INFO     Loaded model at 22
2024-04-25 16:34:32 INFO     Saved model at ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406.m
2024-04-25 16:34:32 INFO     Start evaluating ...
2024-04-25 16:34:34 INFO     Note that you select the single mode to evaluate!
2024-04-25 16:34:34 INFO     Evaluate result is saved at ./libcity/cache/17/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-25 16:34:34 INFO     
         MAE       RMSE
1   2.531060   7.916941
2   2.644506   8.276090
3   2.787455   9.224002
4   2.972466   9.932498
5   3.033308  10.467086
6   3.117303  10.887083
7   3.179769  11.351384
8   3.220925  11.709892
9   3.240513  12.048777
10  3.289110  12.367810
11  3.301362  12.818500
12  3.519314  13.708160
2024-04-25 16:34:34 INFO     ----------------------------------------------------------------------------
2024-04-25 16:34:34 INFO     # 3, Kownledge Graph Embedding: GIE, Experiment ids: 18
2024-04-25 16:34:34 INFO     ----------------------------------------------------------------------------
2024-04-25 16:34:35 INFO     Log directory: ./libcity/log
2024-04-25 16:34:35 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=18
2024-04-25 16:34:35 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 182278133, 'exp_id': 18, 'load_external': True, 'embedding_model': 'GIE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-25 16:34:35 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-25 16:34:35 INFO     set_weight_link_or_dist: dist
2024-04-25 16:34:35 INFO     init_weight_inf_or_zero: inf
2024-04-25 16:34:35 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-25 16:34:35 INFO     Start Calculate the weight by Gauss kernel!
2024-04-25 16:34:35 INFO     Loading file CHITaxi20190406.dyna
2024-04-25 16:34:35 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-25 16:34:39 INFO     Dataset created
2024-04-25 16:34:39 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-25 16:34:39 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-25 16:34:39 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-25 16:34:39 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-25 16:34:39 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-25 16:34:39 INFO     NoneScaler
2024-04-25 16:34:41 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-25 16:34:41 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-25 16:34:41 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-25 16:34:41 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 16:34:41 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-25 16:34:41 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 16:34:41 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-25 16:34:41 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 16:34:41 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-25 16:34:41 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 16:34:41 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-25 16:34:41 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-25 16:34:41 INFO     Total parameter numbers: 874010
2024-04-25 16:34:41 INFO     You select `adam` optimizer.
2024-04-25 16:34:41 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-25 16:34:41 INFO     Start training ...
2024-04-25 16:34:41 INFO     num_batches:48
2024-04-25 16:34:47 INFO     epoch complete!
2024-04-25 16:34:47 INFO     evaluating now!
2024-04-25 16:34:47 INFO     Epoch [0/200] train_loss: 23.6333, val_loss: 17.6721, lr: 0.003000, 6.21s
2024-04-25 16:34:48 INFO     Saved model at 0
2024-04-25 16:34:48 INFO     Val loss decrease from inf to 17.6721, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-25 16:34:54 INFO     epoch complete!
2024-04-25 16:34:54 INFO     evaluating now!
2024-04-25 16:34:54 INFO     Epoch [1/200] train_loss: 14.1014, val_loss: 13.5635, lr: 0.003000, 6.44s
2024-04-25 16:34:54 INFO     Saved model at 1
2024-04-25 16:34:54 INFO     Val loss decrease from 17.6721 to 13.5635, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-25 16:35:00 INFO     epoch complete!
2024-04-25 16:35:00 INFO     evaluating now!
2024-04-25 16:35:01 INFO     Epoch [2/200] train_loss: 11.0245, val_loss: 10.3963, lr: 0.003000, 6.56s
2024-04-25 16:35:01 INFO     Saved model at 2
2024-04-25 16:35:01 INFO     Val loss decrease from 13.5635 to 10.3963, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-25 16:35:07 INFO     epoch complete!
2024-04-25 16:35:07 INFO     evaluating now!
2024-04-25 16:35:07 INFO     Epoch [3/200] train_loss: 9.0106, val_loss: 8.6068, lr: 0.003000, 6.28s
2024-04-25 16:35:07 INFO     Saved model at 3
2024-04-25 16:35:07 INFO     Val loss decrease from 10.3963 to 8.6068, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-25 16:35:13 INFO     epoch complete!
2024-04-25 16:35:13 INFO     evaluating now!
2024-04-25 16:35:14 INFO     Epoch [4/200] train_loss: 7.8614, val_loss: 7.4944, lr: 0.003000, 6.38s
2024-04-25 16:35:14 INFO     Saved model at 4
2024-04-25 16:35:14 INFO     Val loss decrease from 8.6068 to 7.4944, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-25 16:35:20 INFO     epoch complete!
2024-04-25 16:35:20 INFO     evaluating now!
2024-04-25 16:35:20 INFO     Epoch [5/200] train_loss: 7.2691, val_loss: 7.2829, lr: 0.003000, 6.30s
2024-04-25 16:35:21 INFO     Saved model at 5
2024-04-25 16:35:21 INFO     Val loss decrease from 7.4944 to 7.2829, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-25 16:35:26 INFO     epoch complete!
2024-04-25 16:35:26 INFO     evaluating now!
2024-04-25 16:35:27 INFO     Epoch [6/200] train_loss: 6.8517, val_loss: 6.7424, lr: 0.003000, 6.24s
2024-04-25 16:35:27 INFO     Saved model at 6
2024-04-25 16:35:27 INFO     Val loss decrease from 7.2829 to 6.7424, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-25 16:35:33 INFO     epoch complete!
2024-04-25 16:35:33 INFO     evaluating now!
2024-04-25 16:35:33 INFO     Epoch [7/200] train_loss: 6.4081, val_loss: 6.3426, lr: 0.003000, 6.27s
2024-04-25 16:35:33 INFO     Saved model at 7
2024-04-25 16:35:33 INFO     Val loss decrease from 6.7424 to 6.3426, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-25 16:35:39 INFO     epoch complete!
2024-04-25 16:35:39 INFO     evaluating now!
2024-04-25 16:35:40 INFO     Epoch [8/200] train_loss: 6.0818, val_loss: 6.2647, lr: 0.003000, 6.12s
2024-04-25 16:35:40 INFO     Saved model at 8
2024-04-25 16:35:40 INFO     Val loss decrease from 6.3426 to 6.2647, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-25 16:35:46 INFO     epoch complete!
2024-04-25 16:35:46 INFO     evaluating now!
2024-04-25 16:35:46 INFO     Epoch [9/200] train_loss: 5.9734, val_loss: 6.1415, lr: 0.003000, 6.19s
2024-04-25 16:35:46 INFO     Saved model at 9
2024-04-25 16:35:46 INFO     Val loss decrease from 6.2647 to 6.1415, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-25 16:35:52 INFO     epoch complete!
2024-04-25 16:35:52 INFO     evaluating now!
2024-04-25 16:35:53 INFO     Epoch [10/200] train_loss: 5.7752, val_loss: 5.9171, lr: 0.003000, 6.34s
2024-04-25 16:35:53 INFO     Saved model at 10
2024-04-25 16:35:53 INFO     Val loss decrease from 6.1415 to 5.9171, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-25 16:35:59 INFO     epoch complete!
2024-04-25 16:35:59 INFO     evaluating now!
2024-04-25 16:35:59 INFO     Epoch [11/200] train_loss: 5.5992, val_loss: 5.6890, lr: 0.003000, 6.52s
2024-04-25 16:36:00 INFO     Saved model at 11
2024-04-25 16:36:00 INFO     Val loss decrease from 5.9171 to 5.6890, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-25 16:36:06 INFO     epoch complete!
2024-04-25 16:36:06 INFO     evaluating now!
2024-04-25 16:36:06 INFO     Epoch [12/200] train_loss: 5.4859, val_loss: 5.8707, lr: 0.003000, 6.52s
2024-04-25 16:36:12 INFO     epoch complete!
2024-04-25 16:36:12 INFO     evaluating now!
2024-04-25 16:36:13 INFO     Epoch [13/200] train_loss: 5.3382, val_loss: 5.7773, lr: 0.003000, 6.34s
2024-04-25 16:36:18 INFO     epoch complete!
2024-04-25 16:36:18 INFO     evaluating now!
2024-04-25 16:36:19 INFO     Epoch [14/200] train_loss: 5.3829, val_loss: 5.4820, lr: 0.003000, 6.26s
2024-04-25 16:36:19 INFO     Saved model at 14
2024-04-25 16:36:19 INFO     Val loss decrease from 5.6890 to 5.4820, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-25 16:36:25 INFO     epoch complete!
2024-04-25 16:36:25 INFO     evaluating now!
2024-04-25 16:36:26 INFO     Epoch [15/200] train_loss: 5.1419, val_loss: 5.6285, lr: 0.003000, 6.25s
2024-04-25 16:36:31 INFO     epoch complete!
2024-04-25 16:36:31 INFO     evaluating now!
2024-04-25 16:36:32 INFO     Epoch [16/200] train_loss: 5.1097, val_loss: 5.4536, lr: 0.003000, 6.32s
2024-04-25 16:36:32 INFO     Saved model at 16
2024-04-25 16:36:32 INFO     Val loss decrease from 5.4820 to 5.4536, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-25 16:36:38 INFO     epoch complete!
2024-04-25 16:36:38 INFO     evaluating now!
2024-04-25 16:36:38 INFO     Epoch [17/200] train_loss: 4.9801, val_loss: 5.4070, lr: 0.003000, 6.17s
2024-04-25 16:36:38 INFO     Saved model at 17
2024-04-25 16:36:38 INFO     Val loss decrease from 5.4536 to 5.4070, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-25 16:36:44 INFO     epoch complete!
2024-04-25 16:36:44 INFO     evaluating now!
2024-04-25 16:36:44 INFO     Epoch [18/200] train_loss: 4.9075, val_loss: 5.5111, lr: 0.003000, 6.06s
2024-04-25 16:36:50 INFO     epoch complete!
2024-04-25 16:36:50 INFO     evaluating now!
2024-04-25 16:36:50 INFO     Epoch [19/200] train_loss: 4.9201, val_loss: 5.4046, lr: 0.003000, 5.95s
2024-04-25 16:36:51 INFO     Saved model at 19
2024-04-25 16:36:51 INFO     Val loss decrease from 5.4070 to 5.4046, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-25 16:36:57 INFO     epoch complete!
2024-04-25 16:36:57 INFO     evaluating now!
2024-04-25 16:36:57 INFO     Epoch [20/200] train_loss: 4.8403, val_loss: 5.2892, lr: 0.003000, 6.26s
2024-04-25 16:36:57 INFO     Saved model at 20
2024-04-25 16:36:57 INFO     Val loss decrease from 5.4046 to 5.2892, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-25 16:37:03 INFO     epoch complete!
2024-04-25 16:37:03 INFO     evaluating now!
2024-04-25 16:37:04 INFO     Epoch [21/200] train_loss: 4.6862, val_loss: 5.2898, lr: 0.003000, 6.21s
2024-04-25 16:37:09 INFO     epoch complete!
2024-04-25 16:37:09 INFO     evaluating now!
2024-04-25 16:37:10 INFO     Epoch [22/200] train_loss: 4.7184, val_loss: 5.4044, lr: 0.003000, 6.09s
2024-04-25 16:37:15 INFO     epoch complete!
2024-04-25 16:37:15 INFO     evaluating now!
2024-04-25 16:37:16 INFO     Epoch [23/200] train_loss: 4.6313, val_loss: 5.2420, lr: 0.003000, 6.15s
2024-04-25 16:37:16 INFO     Saved model at 23
2024-04-25 16:37:16 INFO     Val loss decrease from 5.2892 to 5.2420, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-25 16:37:22 INFO     epoch complete!
2024-04-25 16:37:22 INFO     evaluating now!
2024-04-25 16:37:22 INFO     Epoch [24/200] train_loss: 4.5888, val_loss: 5.1983, lr: 0.003000, 6.14s
2024-04-25 16:37:22 INFO     Saved model at 24
2024-04-25 16:37:22 INFO     Val loss decrease from 5.2420 to 5.1983, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-04-25 16:37:28 INFO     epoch complete!
2024-04-25 16:37:28 INFO     evaluating now!
2024-04-25 16:37:29 INFO     Epoch [25/200] train_loss: 4.5237, val_loss: 5.4065, lr: 0.003000, 6.27s
2024-04-25 16:37:34 INFO     epoch complete!
2024-04-25 16:37:34 INFO     evaluating now!
2024-04-25 16:37:35 INFO     Epoch [26/200] train_loss: 4.4880, val_loss: 5.1061, lr: 0.003000, 6.09s
2024-04-25 16:37:35 INFO     Saved model at 26
2024-04-25 16:37:35 INFO     Val loss decrease from 5.1983 to 5.1061, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-04-25 16:37:41 INFO     epoch complete!
2024-04-25 16:37:41 INFO     evaluating now!
2024-04-25 16:37:41 INFO     Epoch [27/200] train_loss: 4.4509, val_loss: 5.2260, lr: 0.003000, 6.19s
2024-04-25 16:37:47 INFO     epoch complete!
2024-04-25 16:37:47 INFO     evaluating now!
2024-04-25 16:37:47 INFO     Epoch [28/200] train_loss: 4.4243, val_loss: 5.0574, lr: 0.003000, 6.13s
2024-04-25 16:37:48 INFO     Saved model at 28
2024-04-25 16:37:48 INFO     Val loss decrease from 5.1061 to 5.0574, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-04-25 16:37:53 INFO     epoch complete!
2024-04-25 16:37:53 INFO     evaluating now!
2024-04-25 16:37:54 INFO     Epoch [29/200] train_loss: 4.3890, val_loss: 5.3210, lr: 0.003000, 6.20s
2024-04-25 16:38:00 INFO     epoch complete!
2024-04-25 16:38:00 INFO     evaluating now!
2024-04-25 16:38:00 INFO     Epoch [30/200] train_loss: 4.3176, val_loss: 5.2811, lr: 0.003000, 6.23s
2024-04-25 16:38:06 INFO     epoch complete!
2024-04-25 16:38:06 INFO     evaluating now!
2024-04-25 16:38:06 INFO     Epoch [31/200] train_loss: 4.3389, val_loss: 5.2114, lr: 0.003000, 6.23s
2024-04-25 16:38:12 INFO     epoch complete!
2024-04-25 16:38:12 INFO     evaluating now!
2024-04-25 16:38:12 INFO     Epoch [32/200] train_loss: 4.2596, val_loss: 5.0880, lr: 0.003000, 6.22s
2024-04-25 16:38:18 INFO     epoch complete!
2024-04-25 16:38:18 INFO     evaluating now!
2024-04-25 16:38:19 INFO     Epoch [33/200] train_loss: 4.1706, val_loss: 5.2192, lr: 0.003000, 6.30s
2024-04-25 16:38:25 INFO     epoch complete!
2024-04-25 16:38:25 INFO     evaluating now!
2024-04-25 16:38:25 INFO     Epoch [34/200] train_loss: 4.2126, val_loss: 5.2652, lr: 0.003000, 6.31s
2024-04-25 16:38:31 INFO     epoch complete!
2024-04-25 16:38:31 INFO     evaluating now!
2024-04-25 16:38:31 INFO     Epoch [35/200] train_loss: 4.1162, val_loss: 5.1387, lr: 0.003000, 6.27s
2024-04-25 16:38:37 INFO     epoch complete!
2024-04-25 16:38:37 INFO     evaluating now!
2024-04-25 16:38:38 INFO     Epoch [36/200] train_loss: 4.0834, val_loss: 5.0000, lr: 0.003000, 6.26s
2024-04-25 16:38:38 INFO     Saved model at 36
2024-04-25 16:38:38 INFO     Val loss decrease from 5.0574 to 5.0000, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-04-25 16:38:44 INFO     epoch complete!
2024-04-25 16:38:44 INFO     evaluating now!
2024-04-25 16:38:44 INFO     Epoch [37/200] train_loss: 4.1310, val_loss: 5.2143, lr: 0.003000, 6.28s
2024-04-25 16:38:50 INFO     epoch complete!
2024-04-25 16:38:50 INFO     evaluating now!
2024-04-25 16:38:50 INFO     Epoch [38/200] train_loss: 4.1065, val_loss: 5.2354, lr: 0.003000, 6.34s
2024-04-25 16:38:56 INFO     epoch complete!
2024-04-25 16:38:56 INFO     evaluating now!
2024-04-25 16:38:57 INFO     Epoch [39/200] train_loss: 4.0093, val_loss: 5.2474, lr: 0.003000, 6.17s
2024-04-25 16:39:03 INFO     epoch complete!
2024-04-25 16:39:03 INFO     evaluating now!
2024-04-25 16:39:03 INFO     Epoch [40/200] train_loss: 4.0834, val_loss: 5.2188, lr: 0.003000, 6.85s
2024-04-25 16:39:10 INFO     epoch complete!
2024-04-25 16:39:10 INFO     evaluating now!
2024-04-25 16:39:10 INFO     Epoch [41/200] train_loss: 3.9758, val_loss: 5.0357, lr: 0.003000, 7.04s
2024-04-25 16:39:17 INFO     epoch complete!
2024-04-25 16:39:17 INFO     evaluating now!
2024-04-25 16:39:17 INFO     Epoch [42/200] train_loss: 3.9486, val_loss: 5.3476, lr: 0.003000, 6.75s
2024-04-25 16:39:24 INFO     epoch complete!
2024-04-25 16:39:24 INFO     evaluating now!
2024-04-25 16:39:24 INFO     Epoch [43/200] train_loss: 3.9863, val_loss: 5.2310, lr: 0.003000, 6.81s
2024-04-25 16:39:30 INFO     epoch complete!
2024-04-25 16:39:30 INFO     evaluating now!
2024-04-25 16:39:30 INFO     Epoch [44/200] train_loss: 3.9772, val_loss: 5.2471, lr: 0.003000, 6.43s
2024-04-25 16:39:36 INFO     epoch complete!
2024-04-25 16:39:36 INFO     evaluating now!
2024-04-25 16:39:37 INFO     Epoch [45/200] train_loss: 3.9230, val_loss: 5.0555, lr: 0.003000, 6.26s
2024-04-25 16:39:42 INFO     epoch complete!
2024-04-25 16:39:42 INFO     evaluating now!
2024-04-25 16:39:43 INFO     Epoch [46/200] train_loss: 3.9506, val_loss: 5.0774, lr: 0.003000, 6.06s
2024-04-25 16:39:48 INFO     epoch complete!
2024-04-25 16:39:48 INFO     evaluating now!
2024-04-25 16:39:49 INFO     Epoch [47/200] train_loss: 3.8217, val_loss: 5.0820, lr: 0.003000, 6.10s
2024-04-25 16:39:55 INFO     epoch complete!
2024-04-25 16:39:55 INFO     evaluating now!
2024-04-25 16:39:55 INFO     Epoch [48/200] train_loss: 3.8256, val_loss: 5.1778, lr: 0.003000, 6.10s
2024-04-25 16:40:01 INFO     epoch complete!
2024-04-25 16:40:01 INFO     evaluating now!
2024-04-25 16:40:02 INFO     Epoch [49/200] train_loss: 3.7970, val_loss: 5.0721, lr: 0.003000, 6.81s
2024-04-25 16:40:08 INFO     epoch complete!
2024-04-25 16:40:08 INFO     evaluating now!
2024-04-25 16:40:08 INFO     Epoch [50/200] train_loss: 3.7919, val_loss: 5.0232, lr: 0.003000, 6.57s
2024-04-25 16:40:14 INFO     epoch complete!
2024-04-25 16:40:14 INFO     evaluating now!
2024-04-25 16:40:15 INFO     Epoch [51/200] train_loss: 3.7957, val_loss: 5.0835, lr: 0.003000, 6.15s
2024-04-25 16:40:15 WARNING  Early stopping at epoch: 51
2024-04-25 16:40:15 INFO     Trained totally 52 epochs, average train time is 5.889s, average eval time is 0.417s
2024-04-25 16:40:15 INFO     Loaded model at 36
2024-04-25 16:40:15 INFO     Saved model at ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406.m
2024-04-25 16:40:15 INFO     Start evaluating ...
2024-04-25 16:40:17 INFO     Note that you select the single mode to evaluate!
2024-04-25 16:40:17 INFO     Evaluate result is saved at ./libcity/cache/18/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-25 16:40:17 INFO     
         MAE       RMSE
1   2.515187   7.976556
2   2.610811   8.428834
3   2.740063   9.087998
4   2.832858   9.660939
5   2.935803  10.347236
6   3.049593  11.072997
7   3.099906  11.662388
8   3.206727  12.390827
9   3.314123  12.754724
10  3.365872  13.232017
11  3.461323  13.573291
12  3.642814  14.314761
2024-04-25 16:40:17 INFO     ----------------------------------------------------------------------------
2024-04-25 16:40:17 INFO     # 4, Kownledge Graph Embedding: GIE, Experiment ids: 19
2024-04-25 16:40:17 INFO     ----------------------------------------------------------------------------
2024-04-25 16:40:19 INFO     Log directory: ./libcity/log
2024-04-25 16:40:19 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=19
2024-04-25 16:40:19 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 339769828, 'exp_id': 19, 'load_external': True, 'embedding_model': 'GIE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-25 16:40:19 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-25 16:40:19 INFO     set_weight_link_or_dist: dist
2024-04-25 16:40:19 INFO     init_weight_inf_or_zero: inf
2024-04-25 16:40:19 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-25 16:40:19 INFO     Start Calculate the weight by Gauss kernel!
2024-04-25 16:40:19 INFO     Loading file CHITaxi20190406.dyna
2024-04-25 16:40:19 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-25 16:40:23 INFO     Dataset created
2024-04-25 16:40:23 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-25 16:40:23 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-25 16:40:23 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-25 16:40:23 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-25 16:40:23 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-25 16:40:23 INFO     NoneScaler
2024-04-25 16:40:25 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-25 16:40:25 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-25 16:40:25 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-25 16:40:25 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 16:40:25 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-25 16:40:25 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 16:40:25 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-25 16:40:25 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 16:40:25 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-25 16:40:25 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 16:40:25 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-25 16:40:25 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-25 16:40:25 INFO     Total parameter numbers: 874010
2024-04-25 16:40:25 INFO     You select `adam` optimizer.
2024-04-25 16:40:25 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-25 16:40:25 INFO     Start training ...
2024-04-25 16:40:25 INFO     num_batches:48
2024-04-25 16:40:32 INFO     epoch complete!
2024-04-25 16:40:32 INFO     evaluating now!
2024-04-25 16:40:32 INFO     Epoch [0/200] train_loss: 23.7295, val_loss: 17.2225, lr: 0.003000, 6.97s
2024-04-25 16:40:33 INFO     Saved model at 0
2024-04-25 16:40:33 INFO     Val loss decrease from inf to 17.2225, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-25 16:40:39 INFO     epoch complete!
2024-04-25 16:40:39 INFO     evaluating now!
2024-04-25 16:40:40 INFO     Epoch [1/200] train_loss: 13.7138, val_loss: 12.9236, lr: 0.003000, 6.97s
2024-04-25 16:40:40 INFO     Saved model at 1
2024-04-25 16:40:40 INFO     Val loss decrease from 17.2225 to 12.9236, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-25 16:40:46 INFO     epoch complete!
2024-04-25 16:40:46 INFO     evaluating now!
2024-04-25 16:40:47 INFO     Epoch [2/200] train_loss: 10.6909, val_loss: 10.0230, lr: 0.003000, 6.95s
2024-04-25 16:40:47 INFO     Saved model at 2
2024-04-25 16:40:47 INFO     Val loss decrease from 12.9236 to 10.0230, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-25 16:40:54 INFO     epoch complete!
2024-04-25 16:40:54 INFO     evaluating now!
2024-04-25 16:40:54 INFO     Epoch [3/200] train_loss: 8.8447, val_loss: 8.5703, lr: 0.003000, 7.03s
2024-04-25 16:40:54 INFO     Saved model at 3
2024-04-25 16:40:54 INFO     Val loss decrease from 10.0230 to 8.5703, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-25 16:41:01 INFO     epoch complete!
2024-04-25 16:41:01 INFO     evaluating now!
2024-04-25 16:41:02 INFO     Epoch [4/200] train_loss: 7.7237, val_loss: 7.3786, lr: 0.003000, 7.16s
2024-04-25 16:41:02 INFO     Saved model at 4
2024-04-25 16:41:02 INFO     Val loss decrease from 8.5703 to 7.3786, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-25 16:41:09 INFO     epoch complete!
2024-04-25 16:41:09 INFO     evaluating now!
2024-04-25 16:41:09 INFO     Epoch [5/200] train_loss: 7.0854, val_loss: 6.9972, lr: 0.003000, 7.16s
2024-04-25 16:41:09 INFO     Saved model at 5
2024-04-25 16:41:09 INFO     Val loss decrease from 7.3786 to 6.9972, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-25 16:41:16 INFO     epoch complete!
2024-04-25 16:41:16 INFO     evaluating now!
2024-04-25 16:41:17 INFO     Epoch [6/200] train_loss: 6.5104, val_loss: 6.5772, lr: 0.003000, 7.06s
2024-04-25 16:41:17 INFO     Saved model at 6
2024-04-25 16:41:17 INFO     Val loss decrease from 6.9972 to 6.5772, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-25 16:41:23 INFO     epoch complete!
2024-04-25 16:41:23 INFO     evaluating now!
2024-04-25 16:41:24 INFO     Epoch [7/200] train_loss: 6.1026, val_loss: 6.2523, lr: 0.003000, 7.04s
2024-04-25 16:41:24 INFO     Saved model at 7
2024-04-25 16:41:24 INFO     Val loss decrease from 6.5772 to 6.2523, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-25 16:41:31 INFO     epoch complete!
2024-04-25 16:41:31 INFO     evaluating now!
2024-04-25 16:41:31 INFO     Epoch [8/200] train_loss: 5.8946, val_loss: 5.8924, lr: 0.003000, 7.10s
2024-04-25 16:41:31 INFO     Saved model at 8
2024-04-25 16:41:31 INFO     Val loss decrease from 6.2523 to 5.8924, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-25 16:41:38 INFO     epoch complete!
2024-04-25 16:41:38 INFO     evaluating now!
2024-04-25 16:41:38 INFO     Epoch [9/200] train_loss: 5.6091, val_loss: 5.9459, lr: 0.003000, 7.08s
2024-04-25 16:41:45 INFO     epoch complete!
2024-04-25 16:41:45 INFO     evaluating now!
2024-04-25 16:41:45 INFO     Epoch [10/200] train_loss: 5.4735, val_loss: 5.7071, lr: 0.003000, 6.95s
2024-04-25 16:41:46 INFO     Saved model at 10
2024-04-25 16:41:46 INFO     Val loss decrease from 5.8924 to 5.7071, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-25 16:41:52 INFO     epoch complete!
2024-04-25 16:41:52 INFO     evaluating now!
2024-04-25 16:41:52 INFO     Epoch [11/200] train_loss: 5.3169, val_loss: 5.6706, lr: 0.003000, 6.59s
2024-04-25 16:41:52 INFO     Saved model at 11
2024-04-25 16:41:52 INFO     Val loss decrease from 5.7071 to 5.6706, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-25 16:41:59 INFO     epoch complete!
2024-04-25 16:41:59 INFO     evaluating now!
2024-04-25 16:41:59 INFO     Epoch [12/200] train_loss: 5.2913, val_loss: 5.6857, lr: 0.003000, 7.08s
2024-04-25 16:42:06 INFO     epoch complete!
2024-04-25 16:42:06 INFO     evaluating now!
2024-04-25 16:42:07 INFO     Epoch [13/200] train_loss: 5.0835, val_loss: 5.5297, lr: 0.003000, 7.05s
2024-04-25 16:42:07 INFO     Saved model at 13
2024-04-25 16:42:07 INFO     Val loss decrease from 5.6706 to 5.5297, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-25 16:42:13 INFO     epoch complete!
2024-04-25 16:42:13 INFO     evaluating now!
2024-04-25 16:42:14 INFO     Epoch [14/200] train_loss: 4.9859, val_loss: 5.5971, lr: 0.003000, 7.20s
2024-04-25 16:42:20 INFO     epoch complete!
2024-04-25 16:42:20 INFO     evaluating now!
2024-04-25 16:42:21 INFO     Epoch [15/200] train_loss: 4.9252, val_loss: 5.3093, lr: 0.003000, 6.96s
2024-04-25 16:42:21 INFO     Saved model at 15
2024-04-25 16:42:21 INFO     Val loss decrease from 5.5297 to 5.3093, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-25 16:42:28 INFO     epoch complete!
2024-04-25 16:42:28 INFO     evaluating now!
2024-04-25 16:42:28 INFO     Epoch [16/200] train_loss: 4.8479, val_loss: 5.5288, lr: 0.003000, 6.83s
2024-04-25 16:42:34 INFO     epoch complete!
2024-04-25 16:42:34 INFO     evaluating now!
2024-04-25 16:42:35 INFO     Epoch [17/200] train_loss: 4.8033, val_loss: 5.2226, lr: 0.003000, 6.73s
2024-04-25 16:42:35 INFO     Saved model at 17
2024-04-25 16:42:35 INFO     Val loss decrease from 5.3093 to 5.2226, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-25 16:42:41 INFO     epoch complete!
2024-04-25 16:42:41 INFO     evaluating now!
2024-04-25 16:42:42 INFO     Epoch [18/200] train_loss: 4.6632, val_loss: 5.2584, lr: 0.003000, 6.84s
2024-04-25 16:42:48 INFO     epoch complete!
2024-04-25 16:42:48 INFO     evaluating now!
2024-04-25 16:42:49 INFO     Epoch [19/200] train_loss: 4.6198, val_loss: 5.4676, lr: 0.003000, 6.88s
2024-04-25 16:42:55 INFO     epoch complete!
2024-04-25 16:42:55 INFO     evaluating now!
2024-04-25 16:42:55 INFO     Epoch [20/200] train_loss: 4.5796, val_loss: 5.2694, lr: 0.003000, 6.71s
2024-04-25 16:43:02 INFO     epoch complete!
2024-04-25 16:43:02 INFO     evaluating now!
2024-04-25 16:43:02 INFO     Epoch [21/200] train_loss: 4.5203, val_loss: 5.1783, lr: 0.003000, 6.91s
2024-04-25 16:43:02 INFO     Saved model at 21
2024-04-25 16:43:02 INFO     Val loss decrease from 5.2226 to 5.1783, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-25 16:43:09 INFO     epoch complete!
2024-04-25 16:43:09 INFO     evaluating now!
2024-04-25 16:43:09 INFO     Epoch [22/200] train_loss: 4.5163, val_loss: 5.3530, lr: 0.003000, 6.94s
2024-04-25 16:43:16 INFO     epoch complete!
2024-04-25 16:43:16 INFO     evaluating now!
2024-04-25 16:43:16 INFO     Epoch [23/200] train_loss: 4.5144, val_loss: 5.3317, lr: 0.003000, 6.79s
2024-04-25 16:43:23 INFO     epoch complete!
2024-04-25 16:43:23 INFO     evaluating now!
2024-04-25 16:43:23 INFO     Epoch [24/200] train_loss: 4.4219, val_loss: 5.3065, lr: 0.003000, 6.94s
2024-04-25 16:43:30 INFO     epoch complete!
2024-04-25 16:43:30 INFO     evaluating now!
2024-04-25 16:43:30 INFO     Epoch [25/200] train_loss: 4.3721, val_loss: 5.1141, lr: 0.003000, 6.85s
2024-04-25 16:43:30 INFO     Saved model at 25
2024-04-25 16:43:30 INFO     Val loss decrease from 5.1783 to 5.1141, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-25 16:43:36 INFO     epoch complete!
2024-04-25 16:43:36 INFO     evaluating now!
2024-04-25 16:43:37 INFO     Epoch [26/200] train_loss: 4.3007, val_loss: 5.2257, lr: 0.003000, 6.53s
2024-04-25 16:43:43 INFO     epoch complete!
2024-04-25 16:43:43 INFO     evaluating now!
2024-04-25 16:43:44 INFO     Epoch [27/200] train_loss: 4.2333, val_loss: 5.1003, lr: 0.003000, 6.82s
2024-04-25 16:43:44 INFO     Saved model at 27
2024-04-25 16:43:44 INFO     Val loss decrease from 5.1141 to 5.1003, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-25 16:43:50 INFO     epoch complete!
2024-04-25 16:43:50 INFO     evaluating now!
2024-04-25 16:43:51 INFO     Epoch [28/200] train_loss: 4.2318, val_loss: 5.1373, lr: 0.003000, 6.78s
2024-04-25 16:43:57 INFO     epoch complete!
2024-04-25 16:43:57 INFO     evaluating now!
2024-04-25 16:43:57 INFO     Epoch [29/200] train_loss: 4.1859, val_loss: 5.0733, lr: 0.003000, 6.83s
2024-04-25 16:43:58 INFO     Saved model at 29
2024-04-25 16:43:58 INFO     Val loss decrease from 5.1003 to 5.0733, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-04-25 16:44:04 INFO     epoch complete!
2024-04-25 16:44:04 INFO     evaluating now!
2024-04-25 16:44:04 INFO     Epoch [30/200] train_loss: 4.1678, val_loss: 5.2015, lr: 0.003000, 6.44s
2024-04-25 16:44:11 INFO     epoch complete!
2024-04-25 16:44:11 INFO     evaluating now!
2024-04-25 16:44:11 INFO     Epoch [31/200] train_loss: 4.1600, val_loss: 5.1583, lr: 0.003000, 6.95s
2024-04-25 16:44:18 INFO     epoch complete!
2024-04-25 16:44:18 INFO     evaluating now!
2024-04-25 16:44:18 INFO     Epoch [32/200] train_loss: 4.0899, val_loss: 5.1535, lr: 0.003000, 6.87s
2024-04-25 16:44:24 INFO     epoch complete!
2024-04-25 16:44:24 INFO     evaluating now!
2024-04-25 16:44:25 INFO     Epoch [33/200] train_loss: 4.0338, val_loss: 5.1235, lr: 0.003000, 6.72s
2024-04-25 16:44:31 INFO     epoch complete!
2024-04-25 16:44:31 INFO     evaluating now!
2024-04-25 16:44:32 INFO     Epoch [34/200] train_loss: 4.0461, val_loss: 5.2577, lr: 0.003000, 6.76s
2024-04-25 16:44:38 INFO     epoch complete!
2024-04-25 16:44:38 INFO     evaluating now!
2024-04-25 16:44:38 INFO     Epoch [35/200] train_loss: 4.0118, val_loss: 5.1847, lr: 0.003000, 6.72s
2024-04-25 16:44:45 INFO     epoch complete!
2024-04-25 16:44:45 INFO     evaluating now!
2024-04-25 16:44:45 INFO     Epoch [36/200] train_loss: 3.9387, val_loss: 5.0915, lr: 0.003000, 6.74s
2024-04-25 16:44:51 INFO     epoch complete!
2024-04-25 16:44:51 INFO     evaluating now!
2024-04-25 16:44:52 INFO     Epoch [37/200] train_loss: 3.9045, val_loss: 5.0872, lr: 0.003000, 6.67s
2024-04-25 16:44:58 INFO     epoch complete!
2024-04-25 16:44:58 INFO     evaluating now!
2024-04-25 16:44:59 INFO     Epoch [38/200] train_loss: 3.8767, val_loss: 5.1419, lr: 0.003000, 6.88s
2024-04-25 16:45:05 INFO     epoch complete!
2024-04-25 16:45:05 INFO     evaluating now!
2024-04-25 16:45:06 INFO     Epoch [39/200] train_loss: 3.8686, val_loss: 5.1109, lr: 0.003000, 6.88s
2024-04-25 16:45:12 INFO     epoch complete!
2024-04-25 16:45:12 INFO     evaluating now!
2024-04-25 16:45:12 INFO     Epoch [40/200] train_loss: 3.8742, val_loss: 5.0034, lr: 0.003000, 6.92s
2024-04-25 16:45:13 INFO     Saved model at 40
2024-04-25 16:45:13 INFO     Val loss decrease from 5.0733 to 5.0034, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-04-25 16:45:19 INFO     epoch complete!
2024-04-25 16:45:19 INFO     evaluating now!
2024-04-25 16:45:20 INFO     Epoch [41/200] train_loss: 3.8012, val_loss: 5.0686, lr: 0.003000, 6.73s
2024-04-25 16:45:26 INFO     epoch complete!
2024-04-25 16:45:26 INFO     evaluating now!
2024-04-25 16:45:26 INFO     Epoch [42/200] train_loss: 3.7691, val_loss: 5.1852, lr: 0.003000, 6.72s
2024-04-25 16:45:33 INFO     epoch complete!
2024-04-25 16:45:33 INFO     evaluating now!
2024-04-25 16:45:33 INFO     Epoch [43/200] train_loss: 3.7448, val_loss: 5.1449, lr: 0.003000, 6.78s
2024-04-25 16:45:39 INFO     epoch complete!
2024-04-25 16:45:39 INFO     evaluating now!
2024-04-25 16:45:40 INFO     Epoch [44/200] train_loss: 3.8036, val_loss: 5.0307, lr: 0.003000, 6.81s
2024-04-25 16:45:46 INFO     epoch complete!
2024-04-25 16:45:46 INFO     evaluating now!
2024-04-25 16:45:47 INFO     Epoch [45/200] train_loss: 3.7278, val_loss: 4.9210, lr: 0.003000, 6.84s
2024-04-25 16:45:47 INFO     Saved model at 45
2024-04-25 16:45:47 INFO     Val loss decrease from 5.0034 to 4.9210, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-04-25 16:45:53 INFO     epoch complete!
2024-04-25 16:45:53 INFO     evaluating now!
2024-04-25 16:45:54 INFO     Epoch [46/200] train_loss: 3.6597, val_loss: 5.0170, lr: 0.003000, 7.00s
2024-04-25 16:46:01 INFO     epoch complete!
2024-04-25 16:46:01 INFO     evaluating now!
2024-04-25 16:46:01 INFO     Epoch [47/200] train_loss: 3.6541, val_loss: 5.1388, lr: 0.003000, 7.08s
2024-04-25 16:46:08 INFO     epoch complete!
2024-04-25 16:46:08 INFO     evaluating now!
2024-04-25 16:46:08 INFO     Epoch [48/200] train_loss: 3.6976, val_loss: 5.0674, lr: 0.003000, 6.96s
2024-04-25 16:46:15 INFO     epoch complete!
2024-04-25 16:46:15 INFO     evaluating now!
2024-04-25 16:46:15 INFO     Epoch [49/200] train_loss: 3.6920, val_loss: 4.9174, lr: 0.003000, 7.08s
2024-04-25 16:46:15 INFO     Saved model at 49
2024-04-25 16:46:15 INFO     Val loss decrease from 4.9210 to 4.9174, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-04-25 16:46:22 INFO     epoch complete!
2024-04-25 16:46:22 INFO     evaluating now!
2024-04-25 16:46:22 INFO     Epoch [50/200] train_loss: 3.6163, val_loss: 5.0404, lr: 0.003000, 6.95s
2024-04-25 16:46:29 INFO     epoch complete!
2024-04-25 16:46:29 INFO     evaluating now!
2024-04-25 16:46:29 INFO     Epoch [51/200] train_loss: 3.6840, val_loss: 5.7212, lr: 0.003000, 6.94s
2024-04-25 16:46:36 INFO     epoch complete!
2024-04-25 16:46:36 INFO     evaluating now!
2024-04-25 16:46:36 INFO     Epoch [52/200] train_loss: 3.9371, val_loss: 5.1678, lr: 0.003000, 6.77s
2024-04-25 16:46:42 INFO     epoch complete!
2024-04-25 16:46:42 INFO     evaluating now!
2024-04-25 16:46:43 INFO     Epoch [53/200] train_loss: 3.6526, val_loss: 4.9405, lr: 0.003000, 6.79s
2024-04-25 16:46:49 INFO     epoch complete!
2024-04-25 16:46:49 INFO     evaluating now!
2024-04-25 16:46:50 INFO     Epoch [54/200] train_loss: 3.5937, val_loss: 5.1549, lr: 0.003000, 6.76s
2024-04-25 16:46:56 INFO     epoch complete!
2024-04-25 16:46:56 INFO     evaluating now!
2024-04-25 16:46:56 INFO     Epoch [55/200] train_loss: 3.5535, val_loss: 5.0499, lr: 0.003000, 6.76s
2024-04-25 16:47:03 INFO     epoch complete!
2024-04-25 16:47:03 INFO     evaluating now!
2024-04-25 16:47:03 INFO     Epoch [56/200] train_loss: 3.5460, val_loss: 4.9531, lr: 0.003000, 6.96s
2024-04-25 16:47:10 INFO     epoch complete!
2024-04-25 16:47:10 INFO     evaluating now!
2024-04-25 16:47:10 INFO     Epoch [57/200] train_loss: 3.5058, val_loss: 5.1686, lr: 0.003000, 6.72s
2024-04-25 16:47:16 INFO     epoch complete!
2024-04-25 16:47:16 INFO     evaluating now!
2024-04-25 16:47:17 INFO     Epoch [58/200] train_loss: 3.4894, val_loss: 4.9514, lr: 0.003000, 6.59s
2024-04-25 16:47:23 INFO     epoch complete!
2024-04-25 16:47:23 INFO     evaluating now!
2024-04-25 16:47:23 INFO     Epoch [59/200] train_loss: 3.4402, val_loss: 5.0130, lr: 0.003000, 6.71s
2024-04-25 16:47:29 INFO     epoch complete!
2024-04-25 16:47:29 INFO     evaluating now!
2024-04-25 16:47:30 INFO     Epoch [60/200] train_loss: 3.4449, val_loss: 4.8715, lr: 0.003000, 6.56s
2024-04-25 16:47:30 INFO     Saved model at 60
2024-04-25 16:47:30 INFO     Val loss decrease from 4.9174 to 4.8715, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch60.tar
2024-04-25 16:47:37 INFO     epoch complete!
2024-04-25 16:47:37 INFO     evaluating now!
2024-04-25 16:47:37 INFO     Epoch [61/200] train_loss: 3.4307, val_loss: 4.9349, lr: 0.003000, 6.96s
2024-04-25 16:47:44 INFO     epoch complete!
2024-04-25 16:47:44 INFO     evaluating now!
2024-04-25 16:47:44 INFO     Epoch [62/200] train_loss: 3.4153, val_loss: 4.8949, lr: 0.003000, 7.04s
2024-04-25 16:47:50 INFO     epoch complete!
2024-04-25 16:47:51 INFO     evaluating now!
2024-04-25 16:47:51 INFO     Epoch [63/200] train_loss: 3.4130, val_loss: 4.8726, lr: 0.003000, 6.79s
2024-04-25 16:47:57 INFO     epoch complete!
2024-04-25 16:47:57 INFO     evaluating now!
2024-04-25 16:47:58 INFO     Epoch [64/200] train_loss: 3.4383, val_loss: 4.9799, lr: 0.003000, 6.97s
2024-04-25 16:48:04 INFO     epoch complete!
2024-04-25 16:48:04 INFO     evaluating now!
2024-04-25 16:48:05 INFO     Epoch [65/200] train_loss: 3.3878, val_loss: 4.9646, lr: 0.003000, 6.83s
2024-04-25 16:48:11 INFO     epoch complete!
2024-04-25 16:48:11 INFO     evaluating now!
2024-04-25 16:48:11 INFO     Epoch [66/200] train_loss: 3.3541, val_loss: 5.0492, lr: 0.003000, 6.72s
2024-04-25 16:48:18 INFO     epoch complete!
2024-04-25 16:48:18 INFO     evaluating now!
2024-04-25 16:48:18 INFO     Epoch [67/200] train_loss: 3.3544, val_loss: 4.9227, lr: 0.003000, 6.75s
2024-04-25 16:48:25 INFO     epoch complete!
2024-04-25 16:48:25 INFO     evaluating now!
2024-04-25 16:48:25 INFO     Epoch [68/200] train_loss: 3.3410, val_loss: 4.9501, lr: 0.003000, 6.79s
2024-04-25 16:48:31 INFO     epoch complete!
2024-04-25 16:48:31 INFO     evaluating now!
2024-04-25 16:48:32 INFO     Epoch [69/200] train_loss: 3.3403, val_loss: 4.9801, lr: 0.003000, 6.90s
2024-04-25 16:48:38 INFO     epoch complete!
2024-04-25 16:48:38 INFO     evaluating now!
2024-04-25 16:48:39 INFO     Epoch [70/200] train_loss: 3.3395, val_loss: 4.8911, lr: 0.003000, 6.92s
2024-04-25 16:48:45 INFO     epoch complete!
2024-04-25 16:48:45 INFO     evaluating now!
2024-04-25 16:48:46 INFO     Epoch [71/200] train_loss: 3.3123, val_loss: 5.0144, lr: 0.003000, 6.87s
2024-04-25 16:48:52 INFO     epoch complete!
2024-04-25 16:48:52 INFO     evaluating now!
2024-04-25 16:48:53 INFO     Epoch [72/200] train_loss: 3.3683, val_loss: 4.9362, lr: 0.003000, 6.80s
2024-04-25 16:48:59 INFO     epoch complete!
2024-04-25 16:48:59 INFO     evaluating now!
2024-04-25 16:48:59 INFO     Epoch [73/200] train_loss: 3.3148, val_loss: 4.9069, lr: 0.003000, 6.92s
2024-04-25 16:49:06 INFO     epoch complete!
2024-04-25 16:49:06 INFO     evaluating now!
2024-04-25 16:49:06 INFO     Epoch [74/200] train_loss: 3.2716, val_loss: 5.0028, lr: 0.003000, 6.75s
2024-04-25 16:49:12 INFO     epoch complete!
2024-04-25 16:49:12 INFO     evaluating now!
2024-04-25 16:49:13 INFO     Epoch [75/200] train_loss: 3.2829, val_loss: 4.9233, lr: 0.003000, 6.74s
2024-04-25 16:49:13 WARNING  Early stopping at epoch: 75
2024-04-25 16:49:13 INFO     Trained totally 76 epochs, average train time is 6.389s, average eval time is 0.471s
2024-04-25 16:49:13 INFO     Loaded model at 60
2024-04-25 16:49:13 INFO     Saved model at ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406.m
2024-04-25 16:49:14 INFO     Start evaluating ...
2024-04-25 16:49:16 INFO     Note that you select the single mode to evaluate!
2024-04-25 16:49:16 INFO     Evaluate result is saved at ./libcity/cache/19/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-25 16:49:16 INFO     
         MAE       RMSE
1   2.358360   7.404491
2   2.495791   8.201313
3   2.645886   9.059690
4   2.720959   9.584571
5   2.810902  10.085893
6   2.952072  10.993286
7   3.091208  12.011343
8   3.204058  12.830489
9   3.252872  13.076252
10  3.245181  13.090529
11  3.266766  13.157438
12  3.346843  13.366268
2024-04-25 16:49:16 INFO     ----------------------------------------------------------------------------
2024-04-25 16:49:16 INFO     Kownledge Graph Embedding: GIE, Experiment ids: [15, 16, 17, 18, 19]
2024-04-25 16:49:17 INFO     ----------------------------------------------------------------------------
2024-04-25 16:49:17 INFO     Average: 
         MAE       RMSE
0   2.441024   7.437947
1   2.541385   7.991224
2   2.690195   8.920257
3   2.833725   9.651858
4   2.974091  10.426272
5   3.084149  11.235810
6   3.165891  12.004215
7   3.252316  12.624163
8   3.310674  12.944454
9   3.352419  13.239458
10  3.424278  13.615536
11  3.568876  14.252563 
2024-04-25 16:49:17 INFO     Standard deviation: 
         MAE      RMSE
0   0.071777  0.449608
1   0.073662  0.389972
2   0.063071  0.260163
3   0.085604  0.149101
4   0.091548  0.254599
5   0.087570  0.511727
6   0.088304  0.736929
7   0.087182  0.844462
8   0.091438  0.842308
9   0.110688  0.797405
10  0.138924  0.808975
11  0.129453  0.833209
2024-04-25 16:49:17 INFO     ----------------------------------------------------------------------------
2024-04-25 16:49:17 INFO     12 steps Average: 
        MAE       RMSE
0  3.053252  11.195313
2024-04-25 16:49:17 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.093268  0.573205
