2024-04-24 14:48:28 INFO     ----------------------------------------------------------------------------
2024-04-24 14:48:28 INFO     # 0, Kownledge Graph Embedding: TransE, Experiment ids: 5
2024-04-24 14:48:28 INFO     ----------------------------------------------------------------------------
2024-04-24 14:48:28 INFO     Log directory: ./libcity/log
2024-04-24 14:48:28 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=5
2024-04-24 14:48:28 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'embedding_model': 'TransE', 'seed': 146034833, 'exp_id': 5, 'max_epoch': 200, 'patience': 15, 'output_window': 12, 'load_external': True, 'metrics': ['MAE', 'RMSE'], 'cache_dataset': False, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-24 14:48:28 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-24 14:48:28 INFO     set_weight_link_or_dist: dist
2024-04-24 14:48:28 INFO     init_weight_inf_or_zero: inf
2024-04-24 14:48:28 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-24 14:48:28 INFO     Start Calculate the weight by Gauss kernel!
2024-04-24 14:48:28 INFO     Loading file CHITaxi20190406.dyna
2024-04-24 14:48:28 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-24 14:48:30 INFO     Dataset created
2024-04-24 14:48:30 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-24 14:48:30 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-24 14:48:30 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-24 14:48:30 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-24 14:48:30 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-24 14:48:30 INFO     NoneScaler
2024-04-24 14:48:34 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-24 14:48:34 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-24 14:48:34 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-24 14:48:34 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 14:48:34 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-24 14:48:34 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 14:48:34 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-24 14:48:34 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 14:48:34 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-24 14:48:34 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 14:48:34 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-24 14:48:34 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-24 14:48:34 INFO     Total parameter numbers: 874010
2024-04-24 14:48:34 INFO     You select `adam` optimizer.
2024-04-24 14:48:34 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-24 14:48:34 INFO     Start training ...
2024-04-24 14:48:34 INFO     num_batches:48
2024-04-24 14:48:46 INFO     epoch complete!
2024-04-24 14:48:46 INFO     evaluating now!
2024-04-24 14:48:47 INFO     Epoch [0/200] train_loss: 24.3654, val_loss: 19.0900, lr: 0.003000, 12.68s
2024-04-24 14:48:47 INFO     Saved model at 0
2024-04-24 14:48:47 INFO     Val loss decrease from inf to 19.0900, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-24 14:48:53 INFO     epoch complete!
2024-04-24 14:48:53 INFO     evaluating now!
2024-04-24 14:48:53 INFO     Epoch [1/200] train_loss: 15.7822, val_loss: 15.3960, lr: 0.003000, 5.88s
2024-04-24 14:48:53 INFO     Saved model at 1
2024-04-24 14:48:53 INFO     Val loss decrease from 19.0900 to 15.3960, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-24 14:48:58 INFO     epoch complete!
2024-04-24 14:48:58 INFO     evaluating now!
2024-04-24 14:48:58 INFO     Epoch [2/200] train_loss: 13.2121, val_loss: 13.3349, lr: 0.003000, 5.38s
2024-04-24 14:48:58 INFO     Saved model at 2
2024-04-24 14:48:58 INFO     Val loss decrease from 15.3960 to 13.3349, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-24 14:49:03 INFO     epoch complete!
2024-04-24 14:49:03 INFO     evaluating now!
2024-04-24 14:49:04 INFO     Epoch [3/200] train_loss: 11.3442, val_loss: 10.7315, lr: 0.003000, 5.43s
2024-04-24 14:49:04 INFO     Saved model at 3
2024-04-24 14:49:04 INFO     Val loss decrease from 13.3349 to 10.7315, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-24 14:49:09 INFO     epoch complete!
2024-04-24 14:49:09 INFO     evaluating now!
2024-04-24 14:49:09 INFO     Epoch [4/200] train_loss: 9.2831, val_loss: 8.9289, lr: 0.003000, 5.54s
2024-04-24 14:49:09 INFO     Saved model at 4
2024-04-24 14:49:09 INFO     Val loss decrease from 10.7315 to 8.9289, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-24 14:49:14 INFO     epoch complete!
2024-04-24 14:49:14 INFO     evaluating now!
2024-04-24 14:49:15 INFO     Epoch [5/200] train_loss: 8.2181, val_loss: 8.1504, lr: 0.003000, 5.36s
2024-04-24 14:49:15 INFO     Saved model at 5
2024-04-24 14:49:15 INFO     Val loss decrease from 8.9289 to 8.1504, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-24 14:49:20 INFO     epoch complete!
2024-04-24 14:49:20 INFO     evaluating now!
2024-04-24 14:49:20 INFO     Epoch [6/200] train_loss: 7.4656, val_loss: 7.3185, lr: 0.003000, 5.29s
2024-04-24 14:49:20 INFO     Saved model at 6
2024-04-24 14:49:20 INFO     Val loss decrease from 8.1504 to 7.3185, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-24 14:49:25 INFO     epoch complete!
2024-04-24 14:49:25 INFO     evaluating now!
2024-04-24 14:49:25 INFO     Epoch [7/200] train_loss: 7.0113, val_loss: 6.6776, lr: 0.003000, 5.35s
2024-04-24 14:49:25 INFO     Saved model at 7
2024-04-24 14:49:25 INFO     Val loss decrease from 7.3185 to 6.6776, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-24 14:49:31 INFO     epoch complete!
2024-04-24 14:49:31 INFO     evaluating now!
2024-04-24 14:49:31 INFO     Epoch [8/200] train_loss: 6.5819, val_loss: 6.4231, lr: 0.003000, 5.56s
2024-04-24 14:49:31 INFO     Saved model at 8
2024-04-24 14:49:31 INFO     Val loss decrease from 6.6776 to 6.4231, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-24 14:49:36 INFO     epoch complete!
2024-04-24 14:49:36 INFO     evaluating now!
2024-04-24 14:49:36 INFO     Epoch [9/200] train_loss: 6.2674, val_loss: 6.2592, lr: 0.003000, 5.56s
2024-04-24 14:49:36 INFO     Saved model at 9
2024-04-24 14:49:36 INFO     Val loss decrease from 6.4231 to 6.2592, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-24 14:49:41 INFO     epoch complete!
2024-04-24 14:49:41 INFO     evaluating now!
2024-04-24 14:49:42 INFO     Epoch [10/200] train_loss: 5.9903, val_loss: 6.3231, lr: 0.003000, 5.23s
2024-04-24 14:49:47 INFO     epoch complete!
2024-04-24 14:49:47 INFO     evaluating now!
2024-04-24 14:49:47 INFO     Epoch [11/200] train_loss: 5.8634, val_loss: 6.3646, lr: 0.003000, 5.24s
2024-04-24 14:49:52 INFO     epoch complete!
2024-04-24 14:49:52 INFO     evaluating now!
2024-04-24 14:49:52 INFO     Epoch [12/200] train_loss: 5.6949, val_loss: 6.1271, lr: 0.003000, 5.23s
2024-04-24 14:49:52 INFO     Saved model at 12
2024-04-24 14:49:52 INFO     Val loss decrease from 6.2592 to 6.1271, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-24 14:49:57 INFO     epoch complete!
2024-04-24 14:49:57 INFO     evaluating now!
2024-04-24 14:49:58 INFO     Epoch [13/200] train_loss: 5.5433, val_loss: 6.0659, lr: 0.003000, 5.53s
2024-04-24 14:49:58 INFO     Saved model at 13
2024-04-24 14:49:58 INFO     Val loss decrease from 6.1271 to 6.0659, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-24 14:50:03 INFO     epoch complete!
2024-04-24 14:50:03 INFO     evaluating now!
2024-04-24 14:50:03 INFO     Epoch [14/200] train_loss: 5.4583, val_loss: 5.8805, lr: 0.003000, 5.44s
2024-04-24 14:50:03 INFO     Saved model at 14
2024-04-24 14:50:03 INFO     Val loss decrease from 6.0659 to 5.8805, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-24 14:50:08 INFO     epoch complete!
2024-04-24 14:50:08 INFO     evaluating now!
2024-04-24 14:50:09 INFO     Epoch [15/200] train_loss: 5.3861, val_loss: 5.6566, lr: 0.003000, 5.36s
2024-04-24 14:50:09 INFO     Saved model at 15
2024-04-24 14:50:09 INFO     Val loss decrease from 5.8805 to 5.6566, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-24 14:50:14 INFO     epoch complete!
2024-04-24 14:50:14 INFO     evaluating now!
2024-04-24 14:50:14 INFO     Epoch [16/200] train_loss: 5.2795, val_loss: 5.6994, lr: 0.003000, 5.33s
2024-04-24 14:50:19 INFO     epoch complete!
2024-04-24 14:50:19 INFO     evaluating now!
2024-04-24 14:50:19 INFO     Epoch [17/200] train_loss: 5.1659, val_loss: 5.6770, lr: 0.003000, 5.36s
2024-04-24 14:50:24 INFO     epoch complete!
2024-04-24 14:50:24 INFO     evaluating now!
2024-04-24 14:50:25 INFO     Epoch [18/200] train_loss: 5.1066, val_loss: 5.8166, lr: 0.003000, 5.38s
2024-04-24 14:50:30 INFO     epoch complete!
2024-04-24 14:50:30 INFO     evaluating now!
2024-04-24 14:50:30 INFO     Epoch [19/200] train_loss: 5.1066, val_loss: 5.4966, lr: 0.003000, 5.61s
2024-04-24 14:50:30 INFO     Saved model at 19
2024-04-24 14:50:30 INFO     Val loss decrease from 5.6566 to 5.4966, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-24 14:50:35 INFO     epoch complete!
2024-04-24 14:50:35 INFO     evaluating now!
2024-04-24 14:50:36 INFO     Epoch [20/200] train_loss: 4.9232, val_loss: 5.4114, lr: 0.003000, 5.51s
2024-04-24 14:50:36 INFO     Saved model at 20
2024-04-24 14:50:36 INFO     Val loss decrease from 5.4966 to 5.4114, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-24 14:50:41 INFO     epoch complete!
2024-04-24 14:50:41 INFO     evaluating now!
2024-04-24 14:50:41 INFO     Epoch [21/200] train_loss: 4.8460, val_loss: 5.6354, lr: 0.003000, 5.34s
2024-04-24 14:50:46 INFO     epoch complete!
2024-04-24 14:50:46 INFO     evaluating now!
2024-04-24 14:50:46 INFO     Epoch [22/200] train_loss: 4.8428, val_loss: 5.4825, lr: 0.003000, 5.35s
2024-04-24 14:50:51 INFO     epoch complete!
2024-04-24 14:50:51 INFO     evaluating now!
2024-04-24 14:50:52 INFO     Epoch [23/200] train_loss: 4.7301, val_loss: 5.3524, lr: 0.003000, 5.30s
2024-04-24 14:50:52 INFO     Saved model at 23
2024-04-24 14:50:52 INFO     Val loss decrease from 5.4114 to 5.3524, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-24 14:50:57 INFO     epoch complete!
2024-04-24 14:50:57 INFO     evaluating now!
2024-04-24 14:50:57 INFO     Epoch [24/200] train_loss: 4.6243, val_loss: 5.3226, lr: 0.003000, 5.23s
2024-04-24 14:50:57 INFO     Saved model at 24
2024-04-24 14:50:57 INFO     Val loss decrease from 5.3524 to 5.3226, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-04-24 14:51:02 INFO     epoch complete!
2024-04-24 14:51:02 INFO     evaluating now!
2024-04-24 14:51:02 INFO     Epoch [25/200] train_loss: 4.7471, val_loss: 5.4348, lr: 0.003000, 5.27s
2024-04-24 14:51:07 INFO     epoch complete!
2024-04-24 14:51:07 INFO     evaluating now!
2024-04-24 14:51:08 INFO     Epoch [26/200] train_loss: 4.7520, val_loss: 5.3827, lr: 0.003000, 5.27s
2024-04-24 14:51:13 INFO     epoch complete!
2024-04-24 14:51:13 INFO     evaluating now!
2024-04-24 14:51:13 INFO     Epoch [27/200] train_loss: 4.6443, val_loss: 5.1567, lr: 0.003000, 5.29s
2024-04-24 14:51:13 INFO     Saved model at 27
2024-04-24 14:51:13 INFO     Val loss decrease from 5.3226 to 5.1567, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-24 14:51:18 INFO     epoch complete!
2024-04-24 14:51:18 INFO     evaluating now!
2024-04-24 14:51:18 INFO     Epoch [28/200] train_loss: 4.5622, val_loss: 5.2326, lr: 0.003000, 5.35s
2024-04-24 14:51:23 INFO     epoch complete!
2024-04-24 14:51:23 INFO     evaluating now!
2024-04-24 14:51:24 INFO     Epoch [29/200] train_loss: 4.4451, val_loss: 5.2455, lr: 0.003000, 5.31s
2024-04-24 14:51:29 INFO     epoch complete!
2024-04-24 14:51:29 INFO     evaluating now!
2024-04-24 14:51:29 INFO     Epoch [30/200] train_loss: 4.3708, val_loss: 5.1157, lr: 0.003000, 5.53s
2024-04-24 14:51:29 INFO     Saved model at 30
2024-04-24 14:51:29 INFO     Val loss decrease from 5.1567 to 5.1157, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-04-24 14:51:34 INFO     epoch complete!
2024-04-24 14:51:34 INFO     evaluating now!
2024-04-24 14:51:35 INFO     Epoch [31/200] train_loss: 4.3594, val_loss: 5.2747, lr: 0.003000, 5.76s
2024-04-24 14:51:41 INFO     epoch complete!
2024-04-24 14:51:41 INFO     evaluating now!
2024-04-24 14:51:41 INFO     Epoch [32/200] train_loss: 4.3227, val_loss: 5.0658, lr: 0.003000, 6.05s
2024-04-24 14:51:41 INFO     Saved model at 32
2024-04-24 14:51:41 INFO     Val loss decrease from 5.1157 to 5.0658, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-04-24 14:51:46 INFO     epoch complete!
2024-04-24 14:51:46 INFO     evaluating now!
2024-04-24 14:51:46 INFO     Epoch [33/200] train_loss: 4.2783, val_loss: 5.1610, lr: 0.003000, 5.55s
2024-04-24 14:51:52 INFO     epoch complete!
2024-04-24 14:51:52 INFO     evaluating now!
2024-04-24 14:51:52 INFO     Epoch [34/200] train_loss: 4.2236, val_loss: 5.1191, lr: 0.003000, 5.67s
2024-04-24 14:51:57 INFO     epoch complete!
2024-04-24 14:51:57 INFO     evaluating now!
2024-04-24 14:51:58 INFO     Epoch [35/200] train_loss: 4.2351, val_loss: 5.3245, lr: 0.003000, 5.55s
2024-04-24 14:52:03 INFO     epoch complete!
2024-04-24 14:52:03 INFO     evaluating now!
2024-04-24 14:52:03 INFO     Epoch [36/200] train_loss: 4.1778, val_loss: 5.1338, lr: 0.003000, 5.41s
2024-04-24 14:52:08 INFO     epoch complete!
2024-04-24 14:52:08 INFO     evaluating now!
2024-04-24 14:52:09 INFO     Epoch [37/200] train_loss: 4.1284, val_loss: 5.1860, lr: 0.003000, 5.59s
2024-04-24 14:52:14 INFO     epoch complete!
2024-04-24 14:52:14 INFO     evaluating now!
2024-04-24 14:52:15 INFO     Epoch [38/200] train_loss: 4.0757, val_loss: 5.0426, lr: 0.003000, 5.98s
2024-04-24 14:52:15 INFO     Saved model at 38
2024-04-24 14:52:15 INFO     Val loss decrease from 5.0658 to 5.0426, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-04-24 14:52:20 INFO     epoch complete!
2024-04-24 14:52:20 INFO     evaluating now!
2024-04-24 14:52:21 INFO     Epoch [39/200] train_loss: 4.1813, val_loss: 5.1680, lr: 0.003000, 6.14s
2024-04-24 14:52:26 INFO     epoch complete!
2024-04-24 14:52:26 INFO     evaluating now!
2024-04-24 14:52:27 INFO     Epoch [40/200] train_loss: 4.1239, val_loss: 5.2381, lr: 0.003000, 5.72s
2024-04-24 14:52:32 INFO     epoch complete!
2024-04-24 14:52:32 INFO     evaluating now!
2024-04-24 14:52:32 INFO     Epoch [41/200] train_loss: 4.0382, val_loss: 4.9254, lr: 0.003000, 5.47s
2024-04-24 14:52:32 INFO     Saved model at 41
2024-04-24 14:52:32 INFO     Val loss decrease from 5.0426 to 4.9254, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-04-24 14:52:37 INFO     epoch complete!
2024-04-24 14:52:37 INFO     evaluating now!
2024-04-24 14:52:38 INFO     Epoch [42/200] train_loss: 4.0104, val_loss: 5.2644, lr: 0.003000, 5.64s
2024-04-24 14:52:43 INFO     epoch complete!
2024-04-24 14:52:43 INFO     evaluating now!
2024-04-24 14:52:43 INFO     Epoch [43/200] train_loss: 4.0432, val_loss: 5.1007, lr: 0.003000, 5.66s
2024-04-24 14:52:49 INFO     epoch complete!
2024-04-24 14:52:49 INFO     evaluating now!
2024-04-24 14:52:49 INFO     Epoch [44/200] train_loss: 3.9693, val_loss: 5.1256, lr: 0.003000, 5.69s
2024-04-24 14:52:54 INFO     epoch complete!
2024-04-24 14:52:54 INFO     evaluating now!
2024-04-24 14:52:55 INFO     Epoch [45/200] train_loss: 3.9502, val_loss: 5.1731, lr: 0.003000, 5.80s
2024-04-24 14:53:00 INFO     epoch complete!
2024-04-24 14:53:00 INFO     evaluating now!
2024-04-24 14:53:01 INFO     Epoch [46/200] train_loss: 3.9535, val_loss: 5.2906, lr: 0.003000, 5.77s
2024-04-24 14:53:06 INFO     epoch complete!
2024-04-24 14:53:06 INFO     evaluating now!
2024-04-24 14:53:06 INFO     Epoch [47/200] train_loss: 3.9609, val_loss: 4.9831, lr: 0.003000, 5.68s
2024-04-24 14:53:12 INFO     epoch complete!
2024-04-24 14:53:12 INFO     evaluating now!
2024-04-24 14:53:12 INFO     Epoch [48/200] train_loss: 3.9197, val_loss: 5.1946, lr: 0.003000, 5.55s
2024-04-24 14:53:17 INFO     epoch complete!
2024-04-24 14:53:17 INFO     evaluating now!
2024-04-24 14:53:17 INFO     Epoch [49/200] train_loss: 3.8631, val_loss: 5.1914, lr: 0.003000, 5.51s
2024-04-24 14:53:22 INFO     epoch complete!
2024-04-24 14:53:22 INFO     evaluating now!
2024-04-24 14:53:23 INFO     Epoch [50/200] train_loss: 3.8408, val_loss: 5.0286, lr: 0.003000, 5.29s
2024-04-24 14:53:28 INFO     epoch complete!
2024-04-24 14:53:28 INFO     evaluating now!
2024-04-24 14:53:28 INFO     Epoch [51/200] train_loss: 3.8259, val_loss: 5.0308, lr: 0.003000, 5.25s
2024-04-24 14:53:33 INFO     epoch complete!
2024-04-24 14:53:33 INFO     evaluating now!
2024-04-24 14:53:33 INFO     Epoch [52/200] train_loss: 3.8037, val_loss: 5.1763, lr: 0.003000, 5.31s
2024-04-24 14:53:38 INFO     epoch complete!
2024-04-24 14:53:38 INFO     evaluating now!
2024-04-24 14:53:39 INFO     Epoch [53/200] train_loss: 3.8420, val_loss: 5.0848, lr: 0.003000, 5.36s
2024-04-24 14:53:44 INFO     epoch complete!
2024-04-24 14:53:44 INFO     evaluating now!
2024-04-24 14:53:44 INFO     Epoch [54/200] train_loss: 3.7380, val_loss: 5.1455, lr: 0.003000, 5.66s
2024-04-24 14:53:49 INFO     epoch complete!
2024-04-24 14:53:49 INFO     evaluating now!
2024-04-24 14:53:50 INFO     Epoch [55/200] train_loss: 3.7398, val_loss: 5.0003, lr: 0.003000, 5.36s
2024-04-24 14:53:55 INFO     epoch complete!
2024-04-24 14:53:55 INFO     evaluating now!
2024-04-24 14:53:55 INFO     Epoch [56/200] train_loss: 3.7611, val_loss: 5.0938, lr: 0.003000, 5.30s
2024-04-24 14:53:55 WARNING  Early stopping at epoch: 56
2024-04-24 14:53:55 INFO     Trained totally 57 epochs, average train time is 5.274s, average eval time is 0.343s
2024-04-24 14:53:55 INFO     Loaded model at 41
2024-04-24 14:53:55 INFO     Saved model at ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406.m
2024-04-24 14:53:55 INFO     Start evaluating ...
2024-04-24 14:53:56 INFO     Note that you select the single mode to evaluate!
2024-04-24 14:53:56 INFO     Evaluate result is saved at ./libcity/cache/5/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-24 14:53:56 INFO     
         MAE       RMSE
1   2.307323   7.253043
2   2.443666   7.897511
3   2.527877   8.912097
4   2.678016   9.513812
5   2.723107  10.089754
6   2.858935  10.680016
7   2.943213  11.182976
8   3.153824  11.823126
9   3.132585  12.169113
10  3.222429  12.492132
11  3.304691  13.046559
12  3.450057  13.921595
2024-04-24 14:53:56 INFO     ----------------------------------------------------------------------------
2024-04-24 14:53:56 INFO     # 1, Kownledge Graph Embedding: TransE, Experiment ids: 6
2024-04-24 14:53:56 INFO     ----------------------------------------------------------------------------
2024-04-24 14:53:56 INFO     Log directory: ./libcity/log
2024-04-24 14:53:56 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=6
2024-04-24 14:53:56 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'embedding_model': 'TransE', 'seed': 812547272, 'exp_id': 6, 'max_epoch': 200, 'patience': 15, 'output_window': 12, 'load_external': True, 'metrics': ['MAE', 'RMSE'], 'cache_dataset': False, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-24 14:53:56 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-24 14:53:56 INFO     set_weight_link_or_dist: dist
2024-04-24 14:53:56 INFO     init_weight_inf_or_zero: inf
2024-04-24 14:53:56 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-24 14:53:56 INFO     Start Calculate the weight by Gauss kernel!
2024-04-24 14:53:56 INFO     Loading file CHITaxi20190406.dyna
2024-04-24 14:53:56 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-24 14:53:58 INFO     Dataset created
2024-04-24 14:53:58 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-24 14:53:58 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-24 14:53:58 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-24 14:53:58 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-24 14:53:58 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-24 14:53:58 INFO     NoneScaler
2024-04-24 14:53:59 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-24 14:53:59 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-24 14:53:59 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-24 14:53:59 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 14:53:59 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-24 14:53:59 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 14:53:59 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-24 14:53:59 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 14:53:59 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-24 14:53:59 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 14:53:59 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-24 14:53:59 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-24 14:53:59 INFO     Total parameter numbers: 874010
2024-04-24 14:53:59 INFO     You select `adam` optimizer.
2024-04-24 14:53:59 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-24 14:53:59 INFO     Start training ...
2024-04-24 14:53:59 INFO     num_batches:48
2024-04-24 14:54:05 INFO     epoch complete!
2024-04-24 14:54:05 INFO     evaluating now!
2024-04-24 14:54:05 INFO     Epoch [0/200] train_loss: 24.9016, val_loss: 18.9790, lr: 0.003000, 5.63s
2024-04-24 14:54:05 INFO     Saved model at 0
2024-04-24 14:54:05 INFO     Val loss decrease from inf to 18.9790, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-24 14:54:10 INFO     epoch complete!
2024-04-24 14:54:10 INFO     evaluating now!
2024-04-24 14:54:10 INFO     Epoch [1/200] train_loss: 15.7632, val_loss: 15.5332, lr: 0.003000, 5.30s
2024-04-24 14:54:10 INFO     Saved model at 1
2024-04-24 14:54:10 INFO     Val loss decrease from 18.9790 to 15.5332, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-24 14:54:15 INFO     epoch complete!
2024-04-24 14:54:15 INFO     evaluating now!
2024-04-24 14:54:16 INFO     Epoch [2/200] train_loss: 13.3362, val_loss: 13.3233, lr: 0.003000, 5.24s
2024-04-24 14:54:16 INFO     Saved model at 2
2024-04-24 14:54:16 INFO     Val loss decrease from 15.5332 to 13.3233, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-24 14:54:21 INFO     epoch complete!
2024-04-24 14:54:21 INFO     evaluating now!
2024-04-24 14:54:21 INFO     Epoch [3/200] train_loss: 11.1688, val_loss: 11.0333, lr: 0.003000, 5.55s
2024-04-24 14:54:21 INFO     Saved model at 3
2024-04-24 14:54:21 INFO     Val loss decrease from 13.3233 to 11.0333, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-24 14:54:26 INFO     epoch complete!
2024-04-24 14:54:26 INFO     evaluating now!
2024-04-24 14:54:26 INFO     Epoch [4/200] train_loss: 9.5183, val_loss: 9.4793, lr: 0.003000, 5.25s
2024-04-24 14:54:26 INFO     Saved model at 4
2024-04-24 14:54:26 INFO     Val loss decrease from 11.0333 to 9.4793, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-24 14:54:32 INFO     epoch complete!
2024-04-24 14:54:32 INFO     evaluating now!
2024-04-24 14:54:32 INFO     Epoch [5/200] train_loss: 8.3731, val_loss: 8.1717, lr: 0.003000, 5.58s
2024-04-24 14:54:32 INFO     Saved model at 5
2024-04-24 14:54:32 INFO     Val loss decrease from 9.4793 to 8.1717, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-24 14:54:37 INFO     epoch complete!
2024-04-24 14:54:37 INFO     evaluating now!
2024-04-24 14:54:38 INFO     Epoch [6/200] train_loss: 7.6900, val_loss: 7.5008, lr: 0.003000, 5.44s
2024-04-24 14:54:38 INFO     Saved model at 6
2024-04-24 14:54:38 INFO     Val loss decrease from 8.1717 to 7.5008, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-24 14:54:43 INFO     epoch complete!
2024-04-24 14:54:43 INFO     evaluating now!
2024-04-24 14:54:43 INFO     Epoch [7/200] train_loss: 7.1765, val_loss: 7.2014, lr: 0.003000, 5.53s
2024-04-24 14:54:43 INFO     Saved model at 7
2024-04-24 14:54:43 INFO     Val loss decrease from 7.5008 to 7.2014, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-24 14:54:48 INFO     epoch complete!
2024-04-24 14:54:48 INFO     evaluating now!
2024-04-24 14:54:49 INFO     Epoch [8/200] train_loss: 6.8480, val_loss: 6.8877, lr: 0.003000, 5.56s
2024-04-24 14:54:49 INFO     Saved model at 8
2024-04-24 14:54:49 INFO     Val loss decrease from 7.2014 to 6.8877, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-24 14:54:54 INFO     epoch complete!
2024-04-24 14:54:54 INFO     evaluating now!
2024-04-24 14:54:54 INFO     Epoch [9/200] train_loss: 6.5799, val_loss: 6.4485, lr: 0.003000, 5.41s
2024-04-24 14:54:54 INFO     Saved model at 9
2024-04-24 14:54:54 INFO     Val loss decrease from 6.8877 to 6.4485, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-24 14:54:59 INFO     epoch complete!
2024-04-24 14:54:59 INFO     evaluating now!
2024-04-24 14:55:00 INFO     Epoch [10/200] train_loss: 6.2956, val_loss: 6.2762, lr: 0.003000, 5.43s
2024-04-24 14:55:00 INFO     Saved model at 10
2024-04-24 14:55:00 INFO     Val loss decrease from 6.4485 to 6.2762, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-24 14:55:05 INFO     epoch complete!
2024-04-24 14:55:05 INFO     evaluating now!
2024-04-24 14:55:05 INFO     Epoch [11/200] train_loss: 6.1711, val_loss: 6.4191, lr: 0.003000, 5.53s
2024-04-24 14:55:10 INFO     epoch complete!
2024-04-24 14:55:10 INFO     evaluating now!
2024-04-24 14:55:10 INFO     Epoch [12/200] train_loss: 5.9184, val_loss: 6.1726, lr: 0.003000, 5.26s
2024-04-24 14:55:10 INFO     Saved model at 12
2024-04-24 14:55:10 INFO     Val loss decrease from 6.2762 to 6.1726, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-24 14:55:15 INFO     epoch complete!
2024-04-24 14:55:15 INFO     evaluating now!
2024-04-24 14:55:16 INFO     Epoch [13/200] train_loss: 5.7932, val_loss: 5.9835, lr: 0.003000, 5.25s
2024-04-24 14:55:16 INFO     Saved model at 13
2024-04-24 14:55:16 INFO     Val loss decrease from 6.1726 to 5.9835, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-24 14:55:21 INFO     epoch complete!
2024-04-24 14:55:21 INFO     evaluating now!
2024-04-24 14:55:21 INFO     Epoch [14/200] train_loss: 5.6724, val_loss: 5.9387, lr: 0.003000, 5.42s
2024-04-24 14:55:21 INFO     Saved model at 14
2024-04-24 14:55:21 INFO     Val loss decrease from 5.9835 to 5.9387, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-24 14:55:26 INFO     epoch complete!
2024-04-24 14:55:26 INFO     evaluating now!
2024-04-24 14:55:26 INFO     Epoch [15/200] train_loss: 5.6673, val_loss: 6.0465, lr: 0.003000, 5.34s
2024-04-24 14:55:31 INFO     epoch complete!
2024-04-24 14:55:31 INFO     evaluating now!
2024-04-24 14:55:32 INFO     Epoch [16/200] train_loss: 5.5964, val_loss: 5.7778, lr: 0.003000, 5.24s
2024-04-24 14:55:32 INFO     Saved model at 16
2024-04-24 14:55:32 INFO     Val loss decrease from 5.9387 to 5.7778, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-24 14:55:37 INFO     epoch complete!
2024-04-24 14:55:37 INFO     evaluating now!
2024-04-24 14:55:37 INFO     Epoch [17/200] train_loss: 5.5261, val_loss: 5.7471, lr: 0.003000, 5.32s
2024-04-24 14:55:37 INFO     Saved model at 17
2024-04-24 14:55:37 INFO     Val loss decrease from 5.7778 to 5.7471, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-24 14:55:42 INFO     epoch complete!
2024-04-24 14:55:42 INFO     evaluating now!
2024-04-24 14:55:42 INFO     Epoch [18/200] train_loss: 5.3588, val_loss: 5.7528, lr: 0.003000, 5.25s
2024-04-24 14:55:47 INFO     epoch complete!
2024-04-24 14:55:47 INFO     evaluating now!
2024-04-24 14:55:47 INFO     Epoch [19/200] train_loss: 5.2968, val_loss: 5.6773, lr: 0.003000, 5.24s
2024-04-24 14:55:47 INFO     Saved model at 19
2024-04-24 14:55:47 INFO     Val loss decrease from 5.7471 to 5.6773, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-24 14:55:52 INFO     epoch complete!
2024-04-24 14:55:52 INFO     evaluating now!
2024-04-24 14:55:53 INFO     Epoch [20/200] train_loss: 5.1807, val_loss: 5.7483, lr: 0.003000, 5.27s
2024-04-24 14:55:58 INFO     epoch complete!
2024-04-24 14:55:58 INFO     evaluating now!
2024-04-24 14:55:58 INFO     Epoch [21/200] train_loss: 5.1094, val_loss: 5.6166, lr: 0.003000, 5.30s
2024-04-24 14:55:58 INFO     Saved model at 21
2024-04-24 14:55:58 INFO     Val loss decrease from 5.6773 to 5.6166, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-24 14:56:03 INFO     epoch complete!
2024-04-24 14:56:03 INFO     evaluating now!
2024-04-24 14:56:03 INFO     Epoch [22/200] train_loss: 4.9896, val_loss: 5.4145, lr: 0.003000, 5.24s
2024-04-24 14:56:03 INFO     Saved model at 22
2024-04-24 14:56:03 INFO     Val loss decrease from 5.6166 to 5.4145, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-24 14:56:08 INFO     epoch complete!
2024-04-24 14:56:08 INFO     evaluating now!
2024-04-24 14:56:09 INFO     Epoch [23/200] train_loss: 4.9714, val_loss: 5.7787, lr: 0.003000, 5.27s
2024-04-24 14:56:14 INFO     epoch complete!
2024-04-24 14:56:14 INFO     evaluating now!
2024-04-24 14:56:14 INFO     Epoch [24/200] train_loss: 5.0015, val_loss: 5.6950, lr: 0.003000, 5.27s
2024-04-24 14:56:19 INFO     epoch complete!
2024-04-24 14:56:19 INFO     evaluating now!
2024-04-24 14:56:19 INFO     Epoch [25/200] train_loss: 4.8977, val_loss: 5.4036, lr: 0.003000, 5.50s
2024-04-24 14:56:19 INFO     Saved model at 25
2024-04-24 14:56:19 INFO     Val loss decrease from 5.4145 to 5.4036, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-24 14:56:24 INFO     epoch complete!
2024-04-24 14:56:24 INFO     evaluating now!
2024-04-24 14:56:25 INFO     Epoch [26/200] train_loss: 4.8178, val_loss: 5.5917, lr: 0.003000, 5.42s
2024-04-24 14:56:30 INFO     epoch complete!
2024-04-24 14:56:30 INFO     evaluating now!
2024-04-24 14:56:30 INFO     Epoch [27/200] train_loss: 4.8000, val_loss: 5.4029, lr: 0.003000, 5.38s
2024-04-24 14:56:30 INFO     Saved model at 27
2024-04-24 14:56:30 INFO     Val loss decrease from 5.4036 to 5.4029, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-24 14:56:35 INFO     epoch complete!
2024-04-24 14:56:35 INFO     evaluating now!
2024-04-24 14:56:35 INFO     Epoch [28/200] train_loss: 4.7216, val_loss: 5.4362, lr: 0.003000, 5.26s
2024-04-24 14:56:40 INFO     epoch complete!
2024-04-24 14:56:40 INFO     evaluating now!
2024-04-24 14:56:41 INFO     Epoch [29/200] train_loss: 4.7095, val_loss: 5.6148, lr: 0.003000, 5.34s
2024-04-24 14:56:46 INFO     epoch complete!
2024-04-24 14:56:46 INFO     evaluating now!
2024-04-24 14:56:46 INFO     Epoch [30/200] train_loss: 4.6994, val_loss: 5.6516, lr: 0.003000, 5.36s
2024-04-24 14:56:51 INFO     epoch complete!
2024-04-24 14:56:51 INFO     evaluating now!
2024-04-24 14:56:52 INFO     Epoch [31/200] train_loss: 4.6034, val_loss: 5.2397, lr: 0.003000, 5.44s
2024-04-24 14:56:52 INFO     Saved model at 31
2024-04-24 14:56:52 INFO     Val loss decrease from 5.4029 to 5.2397, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-04-24 14:56:57 INFO     epoch complete!
2024-04-24 14:56:57 INFO     evaluating now!
2024-04-24 14:56:57 INFO     Epoch [32/200] train_loss: 4.5079, val_loss: 5.3401, lr: 0.003000, 5.35s
2024-04-24 14:57:02 INFO     epoch complete!
2024-04-24 14:57:02 INFO     evaluating now!
2024-04-24 14:57:02 INFO     Epoch [33/200] train_loss: 4.4612, val_loss: 5.3750, lr: 0.003000, 5.32s
2024-04-24 14:57:07 INFO     epoch complete!
2024-04-24 14:57:07 INFO     evaluating now!
2024-04-24 14:57:07 INFO     Epoch [34/200] train_loss: 4.4532, val_loss: 5.3928, lr: 0.003000, 5.22s
2024-04-24 14:57:12 INFO     epoch complete!
2024-04-24 14:57:12 INFO     evaluating now!
2024-04-24 14:57:13 INFO     Epoch [35/200] train_loss: 4.4368, val_loss: 5.2062, lr: 0.003000, 5.24s
2024-04-24 14:57:13 INFO     Saved model at 35
2024-04-24 14:57:13 INFO     Val loss decrease from 5.2397 to 5.2062, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-04-24 14:57:18 INFO     epoch complete!
2024-04-24 14:57:18 INFO     evaluating now!
2024-04-24 14:57:18 INFO     Epoch [36/200] train_loss: 4.3713, val_loss: 5.3157, lr: 0.003000, 5.37s
2024-04-24 14:57:23 INFO     epoch complete!
2024-04-24 14:57:23 INFO     evaluating now!
2024-04-24 14:57:24 INFO     Epoch [37/200] train_loss: 4.4864, val_loss: 5.2796, lr: 0.003000, 5.53s
2024-04-24 14:57:29 INFO     epoch complete!
2024-04-24 14:57:29 INFO     evaluating now!
2024-04-24 14:57:29 INFO     Epoch [38/200] train_loss: 4.3051, val_loss: 5.0723, lr: 0.003000, 5.50s
2024-04-24 14:57:29 INFO     Saved model at 38
2024-04-24 14:57:29 INFO     Val loss decrease from 5.2062 to 5.0723, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-04-24 14:57:34 INFO     epoch complete!
2024-04-24 14:57:34 INFO     evaluating now!
2024-04-24 14:57:35 INFO     Epoch [39/200] train_loss: 4.2680, val_loss: 5.2124, lr: 0.003000, 5.62s
2024-04-24 14:57:40 INFO     epoch complete!
2024-04-24 14:57:40 INFO     evaluating now!
2024-04-24 14:57:40 INFO     Epoch [40/200] train_loss: 4.2366, val_loss: 5.2253, lr: 0.003000, 5.58s
2024-04-24 14:57:46 INFO     epoch complete!
2024-04-24 14:57:46 INFO     evaluating now!
2024-04-24 14:57:46 INFO     Epoch [41/200] train_loss: 4.3363, val_loss: 5.1279, lr: 0.003000, 5.70s
2024-04-24 14:57:51 INFO     epoch complete!
2024-04-24 14:57:51 INFO     evaluating now!
2024-04-24 14:57:52 INFO     Epoch [42/200] train_loss: 4.2190, val_loss: 5.2761, lr: 0.003000, 5.52s
2024-04-24 14:57:57 INFO     epoch complete!
2024-04-24 14:57:57 INFO     evaluating now!
2024-04-24 14:57:57 INFO     Epoch [43/200] train_loss: 4.2454, val_loss: 5.1247, lr: 0.003000, 5.64s
2024-04-24 14:58:03 INFO     epoch complete!
2024-04-24 14:58:03 INFO     evaluating now!
2024-04-24 14:58:03 INFO     Epoch [44/200] train_loss: 4.2964, val_loss: 5.0419, lr: 0.003000, 5.72s
2024-04-24 14:58:03 INFO     Saved model at 44
2024-04-24 14:58:03 INFO     Val loss decrease from 5.0723 to 5.0419, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-04-24 14:58:08 INFO     epoch complete!
2024-04-24 14:58:08 INFO     evaluating now!
2024-04-24 14:58:09 INFO     Epoch [45/200] train_loss: 4.2143, val_loss: 5.1427, lr: 0.003000, 5.62s
2024-04-24 14:58:14 INFO     epoch complete!
2024-04-24 14:58:14 INFO     evaluating now!
2024-04-24 14:58:14 INFO     Epoch [46/200] train_loss: 4.1557, val_loss: 5.1641, lr: 0.003000, 5.58s
2024-04-24 14:58:19 INFO     epoch complete!
2024-04-24 14:58:19 INFO     evaluating now!
2024-04-24 14:58:20 INFO     Epoch [47/200] train_loss: 4.1540, val_loss: 4.9159, lr: 0.003000, 5.59s
2024-04-24 14:58:20 INFO     Saved model at 47
2024-04-24 14:58:20 INFO     Val loss decrease from 5.0419 to 4.9159, saving to ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406_epoch47.tar
2024-04-24 14:58:25 INFO     epoch complete!
2024-04-24 14:58:25 INFO     evaluating now!
2024-04-24 14:58:26 INFO     Epoch [48/200] train_loss: 4.0538, val_loss: 5.1977, lr: 0.003000, 5.75s
2024-04-24 14:58:31 INFO     epoch complete!
2024-04-24 14:58:31 INFO     evaluating now!
2024-04-24 14:58:31 INFO     Epoch [49/200] train_loss: 4.0120, val_loss: 4.9495, lr: 0.003000, 5.63s
2024-04-24 14:58:36 INFO     epoch complete!
2024-04-24 14:58:36 INFO     evaluating now!
2024-04-24 14:58:37 INFO     Epoch [50/200] train_loss: 4.0410, val_loss: 5.2721, lr: 0.003000, 5.52s
2024-04-24 14:58:42 INFO     epoch complete!
2024-04-24 14:58:42 INFO     evaluating now!
2024-04-24 14:58:42 INFO     Epoch [51/200] train_loss: 4.0897, val_loss: 5.1039, lr: 0.003000, 5.71s
2024-04-24 14:58:48 INFO     epoch complete!
2024-04-24 14:58:48 INFO     evaluating now!
2024-04-24 14:58:48 INFO     Epoch [52/200] train_loss: 3.9335, val_loss: 5.0283, lr: 0.003000, 5.84s
2024-04-24 14:58:54 INFO     epoch complete!
2024-04-24 14:58:54 INFO     evaluating now!
2024-04-24 14:58:54 INFO     Epoch [53/200] train_loss: 3.8880, val_loss: 5.0566, lr: 0.003000, 5.68s
2024-04-24 14:58:59 INFO     epoch complete!
2024-04-24 14:58:59 INFO     evaluating now!
2024-04-24 14:59:00 INFO     Epoch [54/200] train_loss: 3.8864, val_loss: 5.0280, lr: 0.003000, 5.78s
2024-04-24 14:59:05 INFO     epoch complete!
2024-04-24 14:59:05 INFO     evaluating now!
2024-04-24 14:59:05 INFO     Epoch [55/200] train_loss: 3.9067, val_loss: 5.1004, lr: 0.003000, 5.79s
2024-04-24 14:59:11 INFO     epoch complete!
2024-04-24 14:59:11 INFO     evaluating now!
2024-04-24 14:59:11 INFO     Epoch [56/200] train_loss: 3.9064, val_loss: 5.0770, lr: 0.003000, 5.75s
2024-04-24 14:59:17 INFO     epoch complete!
2024-04-24 14:59:17 INFO     evaluating now!
2024-04-24 14:59:17 INFO     Epoch [57/200] train_loss: 3.8897, val_loss: 5.1117, lr: 0.003000, 5.71s
2024-04-24 14:59:22 INFO     epoch complete!
2024-04-24 14:59:22 INFO     evaluating now!
2024-04-24 14:59:22 INFO     Epoch [58/200] train_loss: 3.8537, val_loss: 5.0836, lr: 0.003000, 5.50s
2024-04-24 14:59:28 INFO     epoch complete!
2024-04-24 14:59:28 INFO     evaluating now!
2024-04-24 14:59:28 INFO     Epoch [59/200] train_loss: 3.8047, val_loss: 5.0308, lr: 0.003000, 5.59s
2024-04-24 14:59:33 INFO     epoch complete!
2024-04-24 14:59:33 INFO     evaluating now!
2024-04-24 14:59:34 INFO     Epoch [60/200] train_loss: 3.7810, val_loss: 5.1291, lr: 0.003000, 5.81s
2024-04-24 14:59:39 INFO     epoch complete!
2024-04-24 14:59:39 INFO     evaluating now!
2024-04-24 14:59:40 INFO     Epoch [61/200] train_loss: 3.7641, val_loss: 5.0056, lr: 0.003000, 5.80s
2024-04-24 14:59:45 INFO     epoch complete!
2024-04-24 14:59:45 INFO     evaluating now!
2024-04-24 14:59:45 INFO     Epoch [62/200] train_loss: 3.7903, val_loss: 5.0403, lr: 0.003000, 5.75s
2024-04-24 14:59:45 WARNING  Early stopping at epoch: 62
2024-04-24 14:59:45 INFO     Trained totally 63 epochs, average train time is 5.141s, average eval time is 0.343s
2024-04-24 14:59:45 INFO     Loaded model at 47
2024-04-24 14:59:45 INFO     Saved model at ./libcity/cache/6/model_cache/AGCRN_CHITaxi20190406.m
2024-04-24 14:59:45 INFO     Start evaluating ...
2024-04-24 14:59:46 INFO     Note that you select the single mode to evaluate!
2024-04-24 14:59:46 INFO     Evaluate result is saved at ./libcity/cache/6/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-24 14:59:46 INFO     
         MAE       RMSE
1   2.272998   7.127480
2   2.410722   7.698748
3   2.668338   8.809325
4   2.859555   9.692054
5   3.048142  10.463350
6   3.054974  11.339555
7   3.130711  11.964632
8   3.187691  12.481109
9   3.246524  12.842265
10  3.326099  13.257082
11  3.421086  13.688809
12  3.613226  14.218501
2024-04-24 14:59:47 INFO     ----------------------------------------------------------------------------
2024-04-24 14:59:47 INFO     # 2, Kownledge Graph Embedding: TransE, Experiment ids: 7
2024-04-24 14:59:47 INFO     ----------------------------------------------------------------------------
2024-04-24 14:59:47 INFO     Log directory: ./libcity/log
2024-04-24 14:59:47 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=7
2024-04-24 14:59:47 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'embedding_model': 'TransE', 'seed': 96887160, 'exp_id': 7, 'max_epoch': 200, 'patience': 15, 'output_window': 12, 'load_external': True, 'metrics': ['MAE', 'RMSE'], 'cache_dataset': False, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-24 14:59:47 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-24 14:59:47 INFO     set_weight_link_or_dist: dist
2024-04-24 14:59:47 INFO     init_weight_inf_or_zero: inf
2024-04-24 14:59:47 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-24 14:59:47 INFO     Start Calculate the weight by Gauss kernel!
2024-04-24 14:59:47 INFO     Loading file CHITaxi20190406.dyna
2024-04-24 14:59:47 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-24 14:59:49 INFO     Dataset created
2024-04-24 14:59:49 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-24 14:59:49 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-24 14:59:49 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-24 14:59:49 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-24 14:59:49 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-24 14:59:49 INFO     NoneScaler
2024-04-24 14:59:50 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-24 14:59:50 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-24 14:59:50 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-24 14:59:50 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 14:59:50 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-24 14:59:50 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 14:59:50 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-24 14:59:50 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 14:59:50 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-24 14:59:50 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 14:59:50 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-24 14:59:50 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-24 14:59:50 INFO     Total parameter numbers: 874010
2024-04-24 14:59:50 INFO     You select `adam` optimizer.
2024-04-24 14:59:50 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-24 14:59:50 INFO     Start training ...
2024-04-24 14:59:50 INFO     num_batches:48
2024-04-24 14:59:55 INFO     epoch complete!
2024-04-24 14:59:55 INFO     evaluating now!
2024-04-24 14:59:56 INFO     Epoch [0/200] train_loss: 24.1972, val_loss: 18.9319, lr: 0.003000, 5.70s
2024-04-24 14:59:56 INFO     Saved model at 0
2024-04-24 14:59:56 INFO     Val loss decrease from inf to 18.9319, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-24 15:00:01 INFO     epoch complete!
2024-04-24 15:00:01 INFO     evaluating now!
2024-04-24 15:00:01 INFO     Epoch [1/200] train_loss: 15.4982, val_loss: 14.9350, lr: 0.003000, 5.51s
2024-04-24 15:00:01 INFO     Saved model at 1
2024-04-24 15:00:01 INFO     Val loss decrease from 18.9319 to 14.9350, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-24 15:00:06 INFO     epoch complete!
2024-04-24 15:00:06 INFO     evaluating now!
2024-04-24 15:00:07 INFO     Epoch [2/200] train_loss: 13.1244, val_loss: 13.3724, lr: 0.003000, 5.47s
2024-04-24 15:00:07 INFO     Saved model at 2
2024-04-24 15:00:07 INFO     Val loss decrease from 14.9350 to 13.3724, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-24 15:00:12 INFO     epoch complete!
2024-04-24 15:00:12 INFO     evaluating now!
2024-04-24 15:00:12 INFO     Epoch [3/200] train_loss: 11.7581, val_loss: 11.4774, lr: 0.003000, 5.35s
2024-04-24 15:00:12 INFO     Saved model at 3
2024-04-24 15:00:12 INFO     Val loss decrease from 13.3724 to 11.4774, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-24 15:00:17 INFO     epoch complete!
2024-04-24 15:00:17 INFO     evaluating now!
2024-04-24 15:00:17 INFO     Epoch [4/200] train_loss: 9.7812, val_loss: 9.4709, lr: 0.003000, 5.33s
2024-04-24 15:00:17 INFO     Saved model at 4
2024-04-24 15:00:17 INFO     Val loss decrease from 11.4774 to 9.4709, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-24 15:00:22 INFO     epoch complete!
2024-04-24 15:00:22 INFO     evaluating now!
2024-04-24 15:00:23 INFO     Epoch [5/200] train_loss: 8.4556, val_loss: 8.1541, lr: 0.003000, 5.31s
2024-04-24 15:00:23 INFO     Saved model at 5
2024-04-24 15:00:23 INFO     Val loss decrease from 9.4709 to 8.1541, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-24 15:00:28 INFO     epoch complete!
2024-04-24 15:00:28 INFO     evaluating now!
2024-04-24 15:00:28 INFO     Epoch [6/200] train_loss: 7.6206, val_loss: 7.3470, lr: 0.003000, 5.55s
2024-04-24 15:00:28 INFO     Saved model at 6
2024-04-24 15:00:28 INFO     Val loss decrease from 8.1541 to 7.3470, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-24 15:00:33 INFO     epoch complete!
2024-04-24 15:00:33 INFO     evaluating now!
2024-04-24 15:00:34 INFO     Epoch [7/200] train_loss: 7.1489, val_loss: 6.8521, lr: 0.003000, 5.40s
2024-04-24 15:00:34 INFO     Saved model at 7
2024-04-24 15:00:34 INFO     Val loss decrease from 7.3470 to 6.8521, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-24 15:00:39 INFO     epoch complete!
2024-04-24 15:00:39 INFO     evaluating now!
2024-04-24 15:00:39 INFO     Epoch [8/200] train_loss: 6.7283, val_loss: 6.5455, lr: 0.003000, 5.75s
2024-04-24 15:00:39 INFO     Saved model at 8
2024-04-24 15:00:39 INFO     Val loss decrease from 6.8521 to 6.5455, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-24 15:00:45 INFO     epoch complete!
2024-04-24 15:00:45 INFO     evaluating now!
2024-04-24 15:00:46 INFO     Epoch [9/200] train_loss: 6.4220, val_loss: 6.2820, lr: 0.003000, 6.18s
2024-04-24 15:00:46 INFO     Saved model at 9
2024-04-24 15:00:46 INFO     Val loss decrease from 6.5455 to 6.2820, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-24 15:00:52 INFO     epoch complete!
2024-04-24 15:00:52 INFO     evaluating now!
2024-04-24 15:00:52 INFO     Epoch [10/200] train_loss: 6.1172, val_loss: 6.3233, lr: 0.003000, 6.45s
2024-04-24 15:00:57 INFO     epoch complete!
2024-04-24 15:00:57 INFO     evaluating now!
2024-04-24 15:00:58 INFO     Epoch [11/200] train_loss: 5.9915, val_loss: 6.2990, lr: 0.003000, 5.79s
2024-04-24 15:01:03 INFO     epoch complete!
2024-04-24 15:01:03 INFO     evaluating now!
2024-04-24 15:01:03 INFO     Epoch [12/200] train_loss: 5.7902, val_loss: 5.8689, lr: 0.003000, 5.53s
2024-04-24 15:01:03 INFO     Saved model at 12
2024-04-24 15:01:03 INFO     Val loss decrease from 6.2820 to 5.8689, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-24 15:01:09 INFO     epoch complete!
2024-04-24 15:01:09 INFO     evaluating now!
2024-04-24 15:01:09 INFO     Epoch [13/200] train_loss: 5.6378, val_loss: 5.7740, lr: 0.003000, 5.65s
2024-04-24 15:01:09 INFO     Saved model at 13
2024-04-24 15:01:09 INFO     Val loss decrease from 5.8689 to 5.7740, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-24 15:01:14 INFO     epoch complete!
2024-04-24 15:01:14 INFO     evaluating now!
2024-04-24 15:01:15 INFO     Epoch [14/200] train_loss: 5.6252, val_loss: 5.7836, lr: 0.003000, 5.55s
2024-04-24 15:01:20 INFO     epoch complete!
2024-04-24 15:01:20 INFO     evaluating now!
2024-04-24 15:01:20 INFO     Epoch [15/200] train_loss: 5.3950, val_loss: 5.7816, lr: 0.003000, 5.57s
2024-04-24 15:01:26 INFO     epoch complete!
2024-04-24 15:01:26 INFO     evaluating now!
2024-04-24 15:01:26 INFO     Epoch [16/200] train_loss: 5.2765, val_loss: 5.6556, lr: 0.003000, 5.73s
2024-04-24 15:01:26 INFO     Saved model at 16
2024-04-24 15:01:26 INFO     Val loss decrease from 5.7740 to 5.6556, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-24 15:01:31 INFO     epoch complete!
2024-04-24 15:01:31 INFO     evaluating now!
2024-04-24 15:01:32 INFO     Epoch [17/200] train_loss: 5.3231, val_loss: 5.5919, lr: 0.003000, 5.75s
2024-04-24 15:01:32 INFO     Saved model at 17
2024-04-24 15:01:32 INFO     Val loss decrease from 5.6556 to 5.5919, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-24 15:01:37 INFO     epoch complete!
2024-04-24 15:01:37 INFO     evaluating now!
2024-04-24 15:01:37 INFO     Epoch [18/200] train_loss: 5.1867, val_loss: 5.6343, lr: 0.003000, 5.40s
2024-04-24 15:01:42 INFO     epoch complete!
2024-04-24 15:01:42 INFO     evaluating now!
2024-04-24 15:01:43 INFO     Epoch [19/200] train_loss: 5.1242, val_loss: 5.5377, lr: 0.003000, 5.48s
2024-04-24 15:01:43 INFO     Saved model at 19
2024-04-24 15:01:43 INFO     Val loss decrease from 5.5919 to 5.5377, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-24 15:01:48 INFO     epoch complete!
2024-04-24 15:01:48 INFO     evaluating now!
2024-04-24 15:01:48 INFO     Epoch [20/200] train_loss: 4.9626, val_loss: 5.7134, lr: 0.003000, 5.65s
2024-04-24 15:01:53 INFO     epoch complete!
2024-04-24 15:01:53 INFO     evaluating now!
2024-04-24 15:01:54 INFO     Epoch [21/200] train_loss: 4.9489, val_loss: 5.6084, lr: 0.003000, 5.50s
2024-04-24 15:01:59 INFO     epoch complete!
2024-04-24 15:01:59 INFO     evaluating now!
2024-04-24 15:01:59 INFO     Epoch [22/200] train_loss: 4.9714, val_loss: 5.7614, lr: 0.003000, 5.33s
2024-04-24 15:02:04 INFO     epoch complete!
2024-04-24 15:02:04 INFO     evaluating now!
2024-04-24 15:02:05 INFO     Epoch [23/200] train_loss: 4.8004, val_loss: 5.3263, lr: 0.003000, 5.44s
2024-04-24 15:02:05 INFO     Saved model at 23
2024-04-24 15:02:05 INFO     Val loss decrease from 5.5377 to 5.3263, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-24 15:02:10 INFO     epoch complete!
2024-04-24 15:02:10 INFO     evaluating now!
2024-04-24 15:02:10 INFO     Epoch [24/200] train_loss: 4.7188, val_loss: 5.4863, lr: 0.003000, 5.47s
2024-04-24 15:02:15 INFO     epoch complete!
2024-04-24 15:02:15 INFO     evaluating now!
2024-04-24 15:02:15 INFO     Epoch [25/200] train_loss: 4.7486, val_loss: 5.2233, lr: 0.003000, 5.47s
2024-04-24 15:02:15 INFO     Saved model at 25
2024-04-24 15:02:15 INFO     Val loss decrease from 5.3263 to 5.2233, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-24 15:02:21 INFO     epoch complete!
2024-04-24 15:02:21 INFO     evaluating now!
2024-04-24 15:02:21 INFO     Epoch [26/200] train_loss: 4.7178, val_loss: 5.3266, lr: 0.003000, 5.36s
2024-04-24 15:02:26 INFO     epoch complete!
2024-04-24 15:02:26 INFO     evaluating now!
2024-04-24 15:02:26 INFO     Epoch [27/200] train_loss: 4.6918, val_loss: 5.3896, lr: 0.003000, 5.25s
2024-04-24 15:02:31 INFO     epoch complete!
2024-04-24 15:02:31 INFO     evaluating now!
2024-04-24 15:02:31 INFO     Epoch [28/200] train_loss: 4.5690, val_loss: 5.1185, lr: 0.003000, 5.27s
2024-04-24 15:02:31 INFO     Saved model at 28
2024-04-24 15:02:31 INFO     Val loss decrease from 5.2233 to 5.1185, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-04-24 15:02:37 INFO     epoch complete!
2024-04-24 15:02:37 INFO     evaluating now!
2024-04-24 15:02:37 INFO     Epoch [29/200] train_loss: 4.5092, val_loss: 5.1730, lr: 0.003000, 5.76s
2024-04-24 15:02:42 INFO     epoch complete!
2024-04-24 15:02:42 INFO     evaluating now!
2024-04-24 15:02:43 INFO     Epoch [30/200] train_loss: 4.5653, val_loss: 5.2494, lr: 0.003000, 5.67s
2024-04-24 15:02:48 INFO     epoch complete!
2024-04-24 15:02:48 INFO     evaluating now!
2024-04-24 15:02:48 INFO     Epoch [31/200] train_loss: 4.4278, val_loss: 5.1643, lr: 0.003000, 5.35s
2024-04-24 15:02:53 INFO     epoch complete!
2024-04-24 15:02:53 INFO     evaluating now!
2024-04-24 15:02:54 INFO     Epoch [32/200] train_loss: 4.4285, val_loss: 5.2781, lr: 0.003000, 5.38s
2024-04-24 15:02:59 INFO     epoch complete!
2024-04-24 15:02:59 INFO     evaluating now!
2024-04-24 15:02:59 INFO     Epoch [33/200] train_loss: 4.3458, val_loss: 5.2010, lr: 0.003000, 5.48s
2024-04-24 15:03:04 INFO     epoch complete!
2024-04-24 15:03:04 INFO     evaluating now!
2024-04-24 15:03:04 INFO     Epoch [34/200] train_loss: 4.3272, val_loss: 5.1684, lr: 0.003000, 5.38s
2024-04-24 15:03:09 INFO     epoch complete!
2024-04-24 15:03:09 INFO     evaluating now!
2024-04-24 15:03:10 INFO     Epoch [35/200] train_loss: 4.2854, val_loss: 5.0942, lr: 0.003000, 5.39s
2024-04-24 15:03:10 INFO     Saved model at 35
2024-04-24 15:03:10 INFO     Val loss decrease from 5.1185 to 5.0942, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-04-24 15:03:15 INFO     epoch complete!
2024-04-24 15:03:15 INFO     evaluating now!
2024-04-24 15:03:15 INFO     Epoch [36/200] train_loss: 4.2501, val_loss: 5.3014, lr: 0.003000, 5.23s
2024-04-24 15:03:20 INFO     epoch complete!
2024-04-24 15:03:20 INFO     evaluating now!
2024-04-24 15:03:20 INFO     Epoch [37/200] train_loss: 4.2445, val_loss: 5.2307, lr: 0.003000, 5.39s
2024-04-24 15:03:26 INFO     epoch complete!
2024-04-24 15:03:26 INFO     evaluating now!
2024-04-24 15:03:26 INFO     Epoch [38/200] train_loss: 4.1663, val_loss: 5.1635, lr: 0.003000, 5.45s
2024-04-24 15:03:31 INFO     epoch complete!
2024-04-24 15:03:31 INFO     evaluating now!
2024-04-24 15:03:31 INFO     Epoch [39/200] train_loss: 4.1738, val_loss: 5.0333, lr: 0.003000, 5.57s
2024-04-24 15:03:31 INFO     Saved model at 39
2024-04-24 15:03:31 INFO     Val loss decrease from 5.0942 to 5.0333, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-04-24 15:03:37 INFO     epoch complete!
2024-04-24 15:03:37 INFO     evaluating now!
2024-04-24 15:03:37 INFO     Epoch [40/200] train_loss: 4.1414, val_loss: 5.0298, lr: 0.003000, 5.43s
2024-04-24 15:03:37 INFO     Saved model at 40
2024-04-24 15:03:37 INFO     Val loss decrease from 5.0333 to 5.0298, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-04-24 15:03:42 INFO     epoch complete!
2024-04-24 15:03:42 INFO     evaluating now!
2024-04-24 15:03:43 INFO     Epoch [41/200] train_loss: 4.1115, val_loss: 5.0625, lr: 0.003000, 5.72s
2024-04-24 15:03:48 INFO     epoch complete!
2024-04-24 15:03:48 INFO     evaluating now!
2024-04-24 15:03:49 INFO     Epoch [42/200] train_loss: 4.1686, val_loss: 4.9599, lr: 0.003000, 5.93s
2024-04-24 15:03:49 INFO     Saved model at 42
2024-04-24 15:03:49 INFO     Val loss decrease from 5.0298 to 4.9599, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-04-24 15:03:54 INFO     epoch complete!
2024-04-24 15:03:54 INFO     evaluating now!
2024-04-24 15:03:54 INFO     Epoch [43/200] train_loss: 4.0696, val_loss: 5.0979, lr: 0.003000, 5.77s
2024-04-24 15:04:00 INFO     epoch complete!
2024-04-24 15:04:00 INFO     evaluating now!
2024-04-24 15:04:00 INFO     Epoch [44/200] train_loss: 4.0034, val_loss: 5.0823, lr: 0.003000, 5.69s
2024-04-24 15:04:05 INFO     epoch complete!
2024-04-24 15:04:05 INFO     evaluating now!
2024-04-24 15:04:06 INFO     Epoch [45/200] train_loss: 3.9621, val_loss: 5.0572, lr: 0.003000, 5.64s
2024-04-24 15:04:11 INFO     epoch complete!
2024-04-24 15:04:11 INFO     evaluating now!
2024-04-24 15:04:11 INFO     Epoch [46/200] train_loss: 4.0378, val_loss: 5.1354, lr: 0.003000, 5.70s
2024-04-24 15:04:17 INFO     epoch complete!
2024-04-24 15:04:17 INFO     evaluating now!
2024-04-24 15:04:17 INFO     Epoch [47/200] train_loss: 3.9432, val_loss: 5.0578, lr: 0.003000, 5.57s
2024-04-24 15:04:22 INFO     epoch complete!
2024-04-24 15:04:22 INFO     evaluating now!
2024-04-24 15:04:22 INFO     Epoch [48/200] train_loss: 3.8974, val_loss: 5.1581, lr: 0.003000, 5.42s
2024-04-24 15:04:27 INFO     epoch complete!
2024-04-24 15:04:27 INFO     evaluating now!
2024-04-24 15:04:28 INFO     Epoch [49/200] train_loss: 3.9509, val_loss: 5.1264, lr: 0.003000, 5.32s
2024-04-24 15:04:33 INFO     epoch complete!
2024-04-24 15:04:33 INFO     evaluating now!
2024-04-24 15:04:33 INFO     Epoch [50/200] train_loss: 3.9523, val_loss: 5.1350, lr: 0.003000, 5.38s
2024-04-24 15:04:38 INFO     epoch complete!
2024-04-24 15:04:38 INFO     evaluating now!
2024-04-24 15:04:39 INFO     Epoch [51/200] train_loss: 3.9309, val_loss: 4.9351, lr: 0.003000, 5.71s
2024-04-24 15:04:39 INFO     Saved model at 51
2024-04-24 15:04:39 INFO     Val loss decrease from 4.9599 to 4.9351, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-04-24 15:04:44 INFO     epoch complete!
2024-04-24 15:04:44 INFO     evaluating now!
2024-04-24 15:04:44 INFO     Epoch [52/200] train_loss: 3.8466, val_loss: 5.0130, lr: 0.003000, 5.38s
2024-04-24 15:04:49 INFO     epoch complete!
2024-04-24 15:04:49 INFO     evaluating now!
2024-04-24 15:04:49 INFO     Epoch [53/200] train_loss: 3.8164, val_loss: 5.1330, lr: 0.003000, 5.30s
2024-04-24 15:04:54 INFO     epoch complete!
2024-04-24 15:04:54 INFO     evaluating now!
2024-04-24 15:04:55 INFO     Epoch [54/200] train_loss: 3.7722, val_loss: 4.9692, lr: 0.003000, 5.34s
2024-04-24 15:05:00 INFO     epoch complete!
2024-04-24 15:05:00 INFO     evaluating now!
2024-04-24 15:05:00 INFO     Epoch [55/200] train_loss: 3.7799, val_loss: 4.9793, lr: 0.003000, 5.35s
2024-04-24 15:05:05 INFO     epoch complete!
2024-04-24 15:05:05 INFO     evaluating now!
2024-04-24 15:05:06 INFO     Epoch [56/200] train_loss: 3.7500, val_loss: 4.9635, lr: 0.003000, 5.38s
2024-04-24 15:05:11 INFO     epoch complete!
2024-04-24 15:05:11 INFO     evaluating now!
2024-04-24 15:05:11 INFO     Epoch [57/200] train_loss: 3.7288, val_loss: 4.9816, lr: 0.003000, 5.49s
2024-04-24 15:05:16 INFO     epoch complete!
2024-04-24 15:05:16 INFO     evaluating now!
2024-04-24 15:05:16 INFO     Epoch [58/200] train_loss: 3.7817, val_loss: 5.0216, lr: 0.003000, 5.36s
2024-04-24 15:05:22 INFO     epoch complete!
2024-04-24 15:05:22 INFO     evaluating now!
2024-04-24 15:05:22 INFO     Epoch [59/200] train_loss: 3.7259, val_loss: 4.8821, lr: 0.003000, 5.44s
2024-04-24 15:05:22 INFO     Saved model at 59
2024-04-24 15:05:22 INFO     Val loss decrease from 4.9351 to 4.8821, saving to ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406_epoch59.tar
2024-04-24 15:05:27 INFO     epoch complete!
2024-04-24 15:05:27 INFO     evaluating now!
2024-04-24 15:05:27 INFO     Epoch [60/200] train_loss: 3.7044, val_loss: 5.1373, lr: 0.003000, 5.35s
2024-04-24 15:05:32 INFO     epoch complete!
2024-04-24 15:05:32 INFO     evaluating now!
2024-04-24 15:05:33 INFO     Epoch [61/200] train_loss: 3.7014, val_loss: 5.0211, lr: 0.003000, 5.37s
2024-04-24 15:05:38 INFO     epoch complete!
2024-04-24 15:05:38 INFO     evaluating now!
2024-04-24 15:05:38 INFO     Epoch [62/200] train_loss: 3.6653, val_loss: 5.2157, lr: 0.003000, 5.31s
2024-04-24 15:05:43 INFO     epoch complete!
2024-04-24 15:05:43 INFO     evaluating now!
2024-04-24 15:05:43 INFO     Epoch [63/200] train_loss: 3.6929, val_loss: 5.0708, lr: 0.003000, 5.41s
2024-04-24 15:05:48 INFO     epoch complete!
2024-04-24 15:05:48 INFO     evaluating now!
2024-04-24 15:05:49 INFO     Epoch [64/200] train_loss: 3.7039, val_loss: 5.0312, lr: 0.003000, 5.38s
2024-04-24 15:05:54 INFO     epoch complete!
2024-04-24 15:05:54 INFO     evaluating now!
2024-04-24 15:05:54 INFO     Epoch [65/200] train_loss: 3.6140, val_loss: 5.0480, lr: 0.003000, 5.34s
2024-04-24 15:05:59 INFO     epoch complete!
2024-04-24 15:05:59 INFO     evaluating now!
2024-04-24 15:05:59 INFO     Epoch [66/200] train_loss: 3.6562, val_loss: 4.9533, lr: 0.003000, 5.27s
2024-04-24 15:06:04 INFO     epoch complete!
2024-04-24 15:06:04 INFO     evaluating now!
2024-04-24 15:06:05 INFO     Epoch [67/200] train_loss: 3.5932, val_loss: 5.1767, lr: 0.003000, 5.52s
2024-04-24 15:06:10 INFO     epoch complete!
2024-04-24 15:06:10 INFO     evaluating now!
2024-04-24 15:06:10 INFO     Epoch [68/200] train_loss: 3.6377, val_loss: 5.1416, lr: 0.003000, 5.49s
2024-04-24 15:06:15 INFO     epoch complete!
2024-04-24 15:06:15 INFO     evaluating now!
2024-04-24 15:06:16 INFO     Epoch [69/200] train_loss: 3.6479, val_loss: 5.1022, lr: 0.003000, 5.38s
2024-04-24 15:06:21 INFO     epoch complete!
2024-04-24 15:06:21 INFO     evaluating now!
2024-04-24 15:06:21 INFO     Epoch [70/200] train_loss: 3.6082, val_loss: 5.0141, lr: 0.003000, 5.19s
2024-04-24 15:06:26 INFO     epoch complete!
2024-04-24 15:06:26 INFO     evaluating now!
2024-04-24 15:06:26 INFO     Epoch [71/200] train_loss: 3.5476, val_loss: 5.0423, lr: 0.003000, 5.24s
2024-04-24 15:06:31 INFO     epoch complete!
2024-04-24 15:06:31 INFO     evaluating now!
2024-04-24 15:06:31 INFO     Epoch [72/200] train_loss: 3.5202, val_loss: 4.9973, lr: 0.003000, 5.37s
2024-04-24 15:06:37 INFO     epoch complete!
2024-04-24 15:06:37 INFO     evaluating now!
2024-04-24 15:06:37 INFO     Epoch [73/200] train_loss: 3.4944, val_loss: 5.0393, lr: 0.003000, 5.52s
2024-04-24 15:06:42 INFO     epoch complete!
2024-04-24 15:06:42 INFO     evaluating now!
2024-04-24 15:06:42 INFO     Epoch [74/200] train_loss: 3.5007, val_loss: 5.0422, lr: 0.003000, 5.37s
2024-04-24 15:06:42 WARNING  Early stopping at epoch: 74
2024-04-24 15:06:42 INFO     Trained totally 75 epochs, average train time is 5.152s, average eval time is 0.342s
2024-04-24 15:06:42 INFO     Loaded model at 59
2024-04-24 15:06:42 INFO     Saved model at ./libcity/cache/7/model_cache/AGCRN_CHITaxi20190406.m
2024-04-24 15:06:42 INFO     Start evaluating ...
2024-04-24 15:06:43 INFO     Note that you select the single mode to evaluate!
2024-04-24 15:06:43 INFO     Evaluate result is saved at ./libcity/cache/7/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-24 15:06:43 INFO     
         MAE       RMSE
1   2.564602   7.092932
2   2.627521   7.760072
3   2.784872   8.676744
4   2.892684   9.306130
5   2.995881   9.934743
6   3.059822  10.493694
7   3.161344  11.107627
8   3.181549  11.632455
9   3.294138  12.172544
10  3.359680  12.626396
11  3.468339  12.912018
12  3.492805  13.301882
2024-04-24 15:06:43 INFO     ----------------------------------------------------------------------------
2024-04-24 15:06:43 INFO     # 3, Kownledge Graph Embedding: TransE, Experiment ids: 8
2024-04-24 15:06:43 INFO     ----------------------------------------------------------------------------
2024-04-24 15:06:43 INFO     Log directory: ./libcity/log
2024-04-24 15:06:43 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=8
2024-04-24 15:06:43 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'embedding_model': 'TransE', 'seed': 16294481, 'exp_id': 8, 'max_epoch': 200, 'patience': 15, 'output_window': 12, 'load_external': True, 'metrics': ['MAE', 'RMSE'], 'cache_dataset': False, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-24 15:06:43 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-24 15:06:43 INFO     set_weight_link_or_dist: dist
2024-04-24 15:06:44 INFO     init_weight_inf_or_zero: inf
2024-04-24 15:06:44 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-24 15:06:44 INFO     Start Calculate the weight by Gauss kernel!
2024-04-24 15:06:44 INFO     Loading file CHITaxi20190406.dyna
2024-04-24 15:06:44 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-24 15:06:47 INFO     Dataset created
2024-04-24 15:06:47 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-24 15:06:47 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-24 15:06:47 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-24 15:06:47 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-24 15:06:47 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-24 15:06:47 INFO     NoneScaler
2024-04-24 15:06:48 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-24 15:06:48 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-24 15:06:48 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-24 15:06:48 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 15:06:48 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-24 15:06:48 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 15:06:48 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-24 15:06:48 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 15:06:48 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-24 15:06:48 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 15:06:48 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-24 15:06:48 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-24 15:06:48 INFO     Total parameter numbers: 874010
2024-04-24 15:06:48 INFO     You select `adam` optimizer.
2024-04-24 15:06:48 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-24 15:06:48 INFO     Start training ...
2024-04-24 15:06:48 INFO     num_batches:48
2024-04-24 15:06:53 INFO     epoch complete!
2024-04-24 15:06:53 INFO     evaluating now!
2024-04-24 15:06:53 INFO     Epoch [0/200] train_loss: 23.9916, val_loss: 18.6401, lr: 0.003000, 5.48s
2024-04-24 15:06:53 INFO     Saved model at 0
2024-04-24 15:06:53 INFO     Val loss decrease from inf to 18.6401, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-24 15:06:58 INFO     epoch complete!
2024-04-24 15:06:58 INFO     evaluating now!
2024-04-24 15:06:59 INFO     Epoch [1/200] train_loss: 15.2330, val_loss: 14.7861, lr: 0.003000, 5.18s
2024-04-24 15:06:59 INFO     Saved model at 1
2024-04-24 15:06:59 INFO     Val loss decrease from 18.6401 to 14.7861, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-24 15:07:04 INFO     epoch complete!
2024-04-24 15:07:04 INFO     evaluating now!
2024-04-24 15:07:04 INFO     Epoch [2/200] train_loss: 12.8129, val_loss: 12.8116, lr: 0.003000, 5.50s
2024-04-24 15:07:04 INFO     Saved model at 2
2024-04-24 15:07:04 INFO     Val loss decrease from 14.7861 to 12.8116, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-24 15:07:09 INFO     epoch complete!
2024-04-24 15:07:09 INFO     evaluating now!
2024-04-24 15:07:10 INFO     Epoch [3/200] train_loss: 11.0159, val_loss: 10.2918, lr: 0.003000, 5.40s
2024-04-24 15:07:10 INFO     Saved model at 3
2024-04-24 15:07:10 INFO     Val loss decrease from 12.8116 to 10.2918, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-24 15:07:15 INFO     epoch complete!
2024-04-24 15:07:15 INFO     evaluating now!
2024-04-24 15:07:15 INFO     Epoch [4/200] train_loss: 9.0754, val_loss: 8.7024, lr: 0.003000, 5.37s
2024-04-24 15:07:15 INFO     Saved model at 4
2024-04-24 15:07:15 INFO     Val loss decrease from 10.2918 to 8.7024, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-24 15:07:20 INFO     epoch complete!
2024-04-24 15:07:20 INFO     evaluating now!
2024-04-24 15:07:20 INFO     Epoch [5/200] train_loss: 8.1294, val_loss: 7.7864, lr: 0.003000, 5.27s
2024-04-24 15:07:20 INFO     Saved model at 5
2024-04-24 15:07:20 INFO     Val loss decrease from 8.7024 to 7.7864, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-24 15:07:25 INFO     epoch complete!
2024-04-24 15:07:25 INFO     evaluating now!
2024-04-24 15:07:25 INFO     Epoch [6/200] train_loss: 7.4992, val_loss: 7.3037, lr: 0.003000, 5.20s
2024-04-24 15:07:25 INFO     Saved model at 6
2024-04-24 15:07:25 INFO     Val loss decrease from 7.7864 to 7.3037, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-24 15:07:30 INFO     epoch complete!
2024-04-24 15:07:30 INFO     evaluating now!
2024-04-24 15:07:31 INFO     Epoch [7/200] train_loss: 6.8997, val_loss: 6.8926, lr: 0.003000, 5.25s
2024-04-24 15:07:31 INFO     Saved model at 7
2024-04-24 15:07:31 INFO     Val loss decrease from 7.3037 to 6.8926, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-24 15:07:36 INFO     epoch complete!
2024-04-24 15:07:36 INFO     evaluating now!
2024-04-24 15:07:36 INFO     Epoch [8/200] train_loss: 6.5972, val_loss: 6.8655, lr: 0.003000, 5.31s
2024-04-24 15:07:36 INFO     Saved model at 8
2024-04-24 15:07:36 INFO     Val loss decrease from 6.8926 to 6.8655, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-24 15:07:41 INFO     epoch complete!
2024-04-24 15:07:41 INFO     evaluating now!
2024-04-24 15:07:41 INFO     Epoch [9/200] train_loss: 6.4775, val_loss: 6.5447, lr: 0.003000, 5.43s
2024-04-24 15:07:41 INFO     Saved model at 9
2024-04-24 15:07:41 INFO     Val loss decrease from 6.8655 to 6.5447, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-24 15:07:46 INFO     epoch complete!
2024-04-24 15:07:46 INFO     evaluating now!
2024-04-24 15:07:47 INFO     Epoch [10/200] train_loss: 6.1281, val_loss: 6.2869, lr: 0.003000, 5.19s
2024-04-24 15:07:47 INFO     Saved model at 10
2024-04-24 15:07:47 INFO     Val loss decrease from 6.5447 to 6.2869, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-24 15:07:52 INFO     epoch complete!
2024-04-24 15:07:52 INFO     evaluating now!
2024-04-24 15:07:52 INFO     Epoch [11/200] train_loss: 5.9613, val_loss: 6.0733, lr: 0.003000, 5.20s
2024-04-24 15:07:52 INFO     Saved model at 11
2024-04-24 15:07:52 INFO     Val loss decrease from 6.2869 to 6.0733, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-24 15:07:57 INFO     epoch complete!
2024-04-24 15:07:57 INFO     evaluating now!
2024-04-24 15:07:57 INFO     Epoch [12/200] train_loss: 5.7137, val_loss: 5.7632, lr: 0.003000, 5.18s
2024-04-24 15:07:57 INFO     Saved model at 12
2024-04-24 15:07:57 INFO     Val loss decrease from 6.0733 to 5.7632, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-24 15:08:02 INFO     epoch complete!
2024-04-24 15:08:02 INFO     evaluating now!
2024-04-24 15:08:02 INFO     Epoch [13/200] train_loss: 5.6189, val_loss: 5.7690, lr: 0.003000, 5.29s
2024-04-24 15:08:07 INFO     epoch complete!
2024-04-24 15:08:07 INFO     evaluating now!
2024-04-24 15:08:08 INFO     Epoch [14/200] train_loss: 5.5629, val_loss: 5.6928, lr: 0.003000, 5.20s
2024-04-24 15:08:08 INFO     Saved model at 14
2024-04-24 15:08:08 INFO     Val loss decrease from 5.7632 to 5.6928, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-24 15:08:12 INFO     epoch complete!
2024-04-24 15:08:12 INFO     evaluating now!
2024-04-24 15:08:13 INFO     Epoch [15/200] train_loss: 5.3210, val_loss: 5.6099, lr: 0.003000, 5.18s
2024-04-24 15:08:13 INFO     Saved model at 15
2024-04-24 15:08:13 INFO     Val loss decrease from 5.6928 to 5.6099, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-24 15:08:18 INFO     epoch complete!
2024-04-24 15:08:18 INFO     evaluating now!
2024-04-24 15:08:18 INFO     Epoch [16/200] train_loss: 5.3344, val_loss: 5.7047, lr: 0.003000, 5.26s
2024-04-24 15:08:23 INFO     epoch complete!
2024-04-24 15:08:23 INFO     evaluating now!
2024-04-24 15:08:23 INFO     Epoch [17/200] train_loss: 5.1637, val_loss: 5.5809, lr: 0.003000, 5.36s
2024-04-24 15:08:23 INFO     Saved model at 17
2024-04-24 15:08:23 INFO     Val loss decrease from 5.6099 to 5.5809, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-24 15:08:28 INFO     epoch complete!
2024-04-24 15:08:28 INFO     evaluating now!
2024-04-24 15:08:29 INFO     Epoch [18/200] train_loss: 5.1681, val_loss: 5.7272, lr: 0.003000, 5.28s
2024-04-24 15:08:34 INFO     epoch complete!
2024-04-24 15:08:34 INFO     evaluating now!
2024-04-24 15:08:34 INFO     Epoch [19/200] train_loss: 5.0671, val_loss: 5.4144, lr: 0.003000, 5.31s
2024-04-24 15:08:34 INFO     Saved model at 19
2024-04-24 15:08:34 INFO     Val loss decrease from 5.5809 to 5.4144, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-24 15:08:39 INFO     epoch complete!
2024-04-24 15:08:39 INFO     evaluating now!
2024-04-24 15:08:39 INFO     Epoch [20/200] train_loss: 4.9972, val_loss: 5.6683, lr: 0.003000, 5.25s
2024-04-24 15:08:44 INFO     epoch complete!
2024-04-24 15:08:44 INFO     evaluating now!
2024-04-24 15:08:45 INFO     Epoch [21/200] train_loss: 5.0417, val_loss: 5.5013, lr: 0.003000, 5.40s
2024-04-24 15:08:50 INFO     epoch complete!
2024-04-24 15:08:50 INFO     evaluating now!
2024-04-24 15:08:51 INFO     Epoch [22/200] train_loss: 4.8142, val_loss: 5.3534, lr: 0.003000, 5.96s
2024-04-24 15:08:51 INFO     Saved model at 22
2024-04-24 15:08:51 INFO     Val loss decrease from 5.4144 to 5.3534, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-24 15:08:58 INFO     epoch complete!
2024-04-24 15:08:58 INFO     evaluating now!
2024-04-24 15:08:58 INFO     Epoch [23/200] train_loss: 4.7793, val_loss: 5.4144, lr: 0.003000, 7.21s
2024-04-24 15:09:03 INFO     epoch complete!
2024-04-24 15:09:03 INFO     evaluating now!
2024-04-24 15:09:04 INFO     Epoch [24/200] train_loss: 4.7733, val_loss: 5.2809, lr: 0.003000, 5.83s
2024-04-24 15:09:04 INFO     Saved model at 24
2024-04-24 15:09:04 INFO     Val loss decrease from 5.3534 to 5.2809, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-04-24 15:09:09 INFO     epoch complete!
2024-04-24 15:09:09 INFO     evaluating now!
2024-04-24 15:09:09 INFO     Epoch [25/200] train_loss: 4.7485, val_loss: 5.1982, lr: 0.003000, 5.49s
2024-04-24 15:09:09 INFO     Saved model at 25
2024-04-24 15:09:09 INFO     Val loss decrease from 5.2809 to 5.1982, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-24 15:09:14 INFO     epoch complete!
2024-04-24 15:09:14 INFO     evaluating now!
2024-04-24 15:09:15 INFO     Epoch [26/200] train_loss: 4.6770, val_loss: 5.2249, lr: 0.003000, 5.45s
2024-04-24 15:09:20 INFO     epoch complete!
2024-04-24 15:09:20 INFO     evaluating now!
2024-04-24 15:09:20 INFO     Epoch [27/200] train_loss: 4.5796, val_loss: 5.1248, lr: 0.003000, 5.47s
2024-04-24 15:09:20 INFO     Saved model at 27
2024-04-24 15:09:20 INFO     Val loss decrease from 5.1982 to 5.1248, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-24 15:09:25 INFO     epoch complete!
2024-04-24 15:09:25 INFO     evaluating now!
2024-04-24 15:09:26 INFO     Epoch [28/200] train_loss: 4.5164, val_loss: 5.3059, lr: 0.003000, 5.40s
2024-04-24 15:09:31 INFO     epoch complete!
2024-04-24 15:09:31 INFO     evaluating now!
2024-04-24 15:09:31 INFO     Epoch [29/200] train_loss: 4.4967, val_loss: 5.1943, lr: 0.003000, 5.50s
2024-04-24 15:09:36 INFO     epoch complete!
2024-04-24 15:09:36 INFO     evaluating now!
2024-04-24 15:09:37 INFO     Epoch [30/200] train_loss: 4.4930, val_loss: 5.2646, lr: 0.003000, 5.47s
2024-04-24 15:09:42 INFO     epoch complete!
2024-04-24 15:09:42 INFO     evaluating now!
2024-04-24 15:09:42 INFO     Epoch [31/200] train_loss: 4.4049, val_loss: 5.1277, lr: 0.003000, 5.48s
2024-04-24 15:09:47 INFO     epoch complete!
2024-04-24 15:09:47 INFO     evaluating now!
2024-04-24 15:09:48 INFO     Epoch [32/200] train_loss: 4.3707, val_loss: 5.3161, lr: 0.003000, 5.62s
2024-04-24 15:09:53 INFO     epoch complete!
2024-04-24 15:09:53 INFO     evaluating now!
2024-04-24 15:09:53 INFO     Epoch [33/200] train_loss: 4.3519, val_loss: 5.1401, lr: 0.003000, 5.59s
2024-04-24 15:09:58 INFO     epoch complete!
2024-04-24 15:09:58 INFO     evaluating now!
2024-04-24 15:09:59 INFO     Epoch [34/200] train_loss: 4.3693, val_loss: 5.1846, lr: 0.003000, 5.30s
2024-04-24 15:10:04 INFO     epoch complete!
2024-04-24 15:10:04 INFO     evaluating now!
2024-04-24 15:10:04 INFO     Epoch [35/200] train_loss: 4.3449, val_loss: 5.1789, lr: 0.003000, 5.74s
2024-04-24 15:10:10 INFO     epoch complete!
2024-04-24 15:10:10 INFO     evaluating now!
2024-04-24 15:10:10 INFO     Epoch [36/200] train_loss: 4.3285, val_loss: 5.0813, lr: 0.003000, 5.92s
2024-04-24 15:10:10 INFO     Saved model at 36
2024-04-24 15:10:10 INFO     Val loss decrease from 5.1248 to 5.0813, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-04-24 15:10:15 INFO     epoch complete!
2024-04-24 15:10:15 INFO     evaluating now!
2024-04-24 15:10:16 INFO     Epoch [37/200] train_loss: 4.2067, val_loss: 5.2459, lr: 0.003000, 5.54s
2024-04-24 15:10:21 INFO     epoch complete!
2024-04-24 15:10:21 INFO     evaluating now!
2024-04-24 15:10:22 INFO     Epoch [38/200] train_loss: 4.2192, val_loss: 5.1547, lr: 0.003000, 5.89s
2024-04-24 15:10:27 INFO     epoch complete!
2024-04-24 15:10:27 INFO     evaluating now!
2024-04-24 15:10:27 INFO     Epoch [39/200] train_loss: 4.1870, val_loss: 5.1068, lr: 0.003000, 5.73s
2024-04-24 15:10:33 INFO     epoch complete!
2024-04-24 15:10:33 INFO     evaluating now!
2024-04-24 15:10:34 INFO     Epoch [40/200] train_loss: 4.1040, val_loss: 5.0565, lr: 0.003000, 6.40s
2024-04-24 15:10:34 INFO     Saved model at 40
2024-04-24 15:10:34 INFO     Val loss decrease from 5.0813 to 5.0565, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-04-24 15:10:40 INFO     epoch complete!
2024-04-24 15:10:40 INFO     evaluating now!
2024-04-24 15:10:40 INFO     Epoch [41/200] train_loss: 4.0416, val_loss: 5.1554, lr: 0.003000, 6.25s
2024-04-24 15:10:46 INFO     epoch complete!
2024-04-24 15:10:46 INFO     evaluating now!
2024-04-24 15:10:46 INFO     Epoch [42/200] train_loss: 4.0635, val_loss: 5.0680, lr: 0.003000, 5.87s
2024-04-24 15:10:51 INFO     epoch complete!
2024-04-24 15:10:51 INFO     evaluating now!
2024-04-24 15:10:52 INFO     Epoch [43/200] train_loss: 4.0102, val_loss: 5.1313, lr: 0.003000, 5.76s
2024-04-24 15:10:57 INFO     epoch complete!
2024-04-24 15:10:57 INFO     evaluating now!
2024-04-24 15:10:57 INFO     Epoch [44/200] train_loss: 3.9932, val_loss: 5.2050, lr: 0.003000, 5.42s
2024-04-24 15:11:02 INFO     epoch complete!
2024-04-24 15:11:02 INFO     evaluating now!
2024-04-24 15:11:02 INFO     Epoch [45/200] train_loss: 3.9849, val_loss: 5.1267, lr: 0.003000, 5.39s
2024-04-24 15:11:08 INFO     epoch complete!
2024-04-24 15:11:08 INFO     evaluating now!
2024-04-24 15:11:08 INFO     Epoch [46/200] train_loss: 3.9446, val_loss: 4.9280, lr: 0.003000, 5.41s
2024-04-24 15:11:08 INFO     Saved model at 46
2024-04-24 15:11:08 INFO     Val loss decrease from 5.0565 to 4.9280, saving to ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-04-24 15:11:13 INFO     epoch complete!
2024-04-24 15:11:13 INFO     evaluating now!
2024-04-24 15:11:14 INFO     Epoch [47/200] train_loss: 3.9545, val_loss: 4.9711, lr: 0.003000, 5.68s
2024-04-24 15:11:19 INFO     epoch complete!
2024-04-24 15:11:19 INFO     evaluating now!
2024-04-24 15:11:19 INFO     Epoch [48/200] train_loss: 3.9237, val_loss: 5.1811, lr: 0.003000, 5.65s
2024-04-24 15:11:25 INFO     epoch complete!
2024-04-24 15:11:25 INFO     evaluating now!
2024-04-24 15:11:25 INFO     Epoch [49/200] train_loss: 3.8882, val_loss: 5.1891, lr: 0.003000, 5.91s
2024-04-24 15:11:30 INFO     epoch complete!
2024-04-24 15:11:30 INFO     evaluating now!
2024-04-24 15:11:31 INFO     Epoch [50/200] train_loss: 3.9081, val_loss: 5.1424, lr: 0.003000, 5.44s
2024-04-24 15:11:36 INFO     epoch complete!
2024-04-24 15:11:36 INFO     evaluating now!
2024-04-24 15:11:36 INFO     Epoch [51/200] train_loss: 3.9216, val_loss: 5.1225, lr: 0.003000, 5.24s
2024-04-24 15:11:41 INFO     epoch complete!
2024-04-24 15:11:41 INFO     evaluating now!
2024-04-24 15:11:41 INFO     Epoch [52/200] train_loss: 3.8330, val_loss: 4.9961, lr: 0.003000, 5.28s
2024-04-24 15:11:46 INFO     epoch complete!
2024-04-24 15:11:46 INFO     evaluating now!
2024-04-24 15:11:46 INFO     Epoch [53/200] train_loss: 3.8433, val_loss: 5.0249, lr: 0.003000, 5.25s
2024-04-24 15:11:51 INFO     epoch complete!
2024-04-24 15:11:51 INFO     evaluating now!
2024-04-24 15:11:52 INFO     Epoch [54/200] train_loss: 3.7836, val_loss: 5.0704, lr: 0.003000, 5.36s
2024-04-24 15:11:57 INFO     epoch complete!
2024-04-24 15:11:57 INFO     evaluating now!
2024-04-24 15:11:57 INFO     Epoch [55/200] train_loss: 3.7747, val_loss: 5.2846, lr: 0.003000, 5.36s
2024-04-24 15:12:02 INFO     epoch complete!
2024-04-24 15:12:02 INFO     evaluating now!
2024-04-24 15:12:03 INFO     Epoch [56/200] train_loss: 3.7138, val_loss: 5.1051, lr: 0.003000, 5.46s
2024-04-24 15:12:08 INFO     epoch complete!
2024-04-24 15:12:08 INFO     evaluating now!
2024-04-24 15:12:08 INFO     Epoch [57/200] train_loss: 3.7224, val_loss: 5.0057, lr: 0.003000, 5.44s
2024-04-24 15:12:13 INFO     epoch complete!
2024-04-24 15:12:13 INFO     evaluating now!
2024-04-24 15:12:13 INFO     Epoch [58/200] train_loss: 3.7393, val_loss: 5.1495, lr: 0.003000, 5.33s
2024-04-24 15:12:18 INFO     epoch complete!
2024-04-24 15:12:18 INFO     evaluating now!
2024-04-24 15:12:19 INFO     Epoch [59/200] train_loss: 3.6851, val_loss: 5.1639, lr: 0.003000, 5.27s
2024-04-24 15:12:24 INFO     epoch complete!
2024-04-24 15:12:24 INFO     evaluating now!
2024-04-24 15:12:24 INFO     Epoch [60/200] train_loss: 3.7007, val_loss: 5.1242, lr: 0.003000, 5.49s
2024-04-24 15:12:29 INFO     epoch complete!
2024-04-24 15:12:29 INFO     evaluating now!
2024-04-24 15:12:29 INFO     Epoch [61/200] train_loss: 3.7026, val_loss: 5.0299, lr: 0.003000, 5.33s
2024-04-24 15:12:29 WARNING  Early stopping at epoch: 61
2024-04-24 15:12:29 INFO     Trained totally 62 epochs, average train time is 5.151s, average eval time is 0.349s
2024-04-24 15:12:29 INFO     Loaded model at 46
2024-04-24 15:12:29 INFO     Saved model at ./libcity/cache/8/model_cache/AGCRN_CHITaxi20190406.m
2024-04-24 15:12:29 INFO     Start evaluating ...
2024-04-24 15:12:30 INFO     Note that you select the single mode to evaluate!
2024-04-24 15:12:30 INFO     Evaluate result is saved at ./libcity/cache/8/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-24 15:12:31 INFO     
         MAE       RMSE
1   2.362098   7.181606
2   2.418838   7.813941
3   2.632657   8.727929
4   2.745310   9.390656
5   2.882153   9.940593
6   3.057303  10.574887
7   3.095530  11.116147
8   3.201628  11.577088
9   3.244949  11.831866
10  3.307585  12.088893
11  3.214162  12.357812
12  3.389692  13.073077
2024-04-24 15:12:31 INFO     ----------------------------------------------------------------------------
2024-04-24 15:12:31 INFO     # 4, Kownledge Graph Embedding: TransE, Experiment ids: 9
2024-04-24 15:12:31 INFO     ----------------------------------------------------------------------------
2024-04-24 15:12:31 INFO     Log directory: ./libcity/log
2024-04-24 15:12:31 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=9
2024-04-24 15:12:31 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'embedding_model': 'TransE', 'seed': 429296137, 'exp_id': 9, 'max_epoch': 200, 'patience': 15, 'output_window': 12, 'load_external': True, 'metrics': ['MAE', 'RMSE'], 'cache_dataset': False, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-24 15:12:31 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-24 15:12:31 INFO     set_weight_link_or_dist: dist
2024-04-24 15:12:31 INFO     init_weight_inf_or_zero: inf
2024-04-24 15:12:31 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-24 15:12:31 INFO     Start Calculate the weight by Gauss kernel!
2024-04-24 15:12:31 INFO     Loading file CHITaxi20190406.dyna
2024-04-24 15:12:31 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-24 15:12:34 INFO     Dataset created
2024-04-24 15:12:34 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-24 15:12:34 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-24 15:12:34 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-24 15:12:34 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-24 15:12:34 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-24 15:12:34 INFO     NoneScaler
2024-04-24 15:12:35 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-24 15:12:35 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-24 15:12:35 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-24 15:12:35 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 15:12:35 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-24 15:12:35 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 15:12:35 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-24 15:12:35 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-24 15:12:35 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-24 15:12:35 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-24 15:12:35 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-24 15:12:35 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-24 15:12:35 INFO     Total parameter numbers: 874010
2024-04-24 15:12:35 INFO     You select `adam` optimizer.
2024-04-24 15:12:35 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-24 15:12:35 INFO     Start training ...
2024-04-24 15:12:35 INFO     num_batches:48
2024-04-24 15:12:40 INFO     epoch complete!
2024-04-24 15:12:40 INFO     evaluating now!
2024-04-24 15:12:41 INFO     Epoch [0/200] train_loss: 24.2208, val_loss: 18.6136, lr: 0.003000, 5.39s
2024-04-24 15:12:41 INFO     Saved model at 0
2024-04-24 15:12:41 INFO     Val loss decrease from inf to 18.6136, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-24 15:12:45 INFO     epoch complete!
2024-04-24 15:12:45 INFO     evaluating now!
2024-04-24 15:12:46 INFO     Epoch [1/200] train_loss: 15.6336, val_loss: 15.3062, lr: 0.003000, 5.22s
2024-04-24 15:12:46 INFO     Saved model at 1
2024-04-24 15:12:46 INFO     Val loss decrease from 18.6136 to 15.3062, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-24 15:12:51 INFO     epoch complete!
2024-04-24 15:12:51 INFO     evaluating now!
2024-04-24 15:12:51 INFO     Epoch [2/200] train_loss: 12.5758, val_loss: 12.1413, lr: 0.003000, 5.45s
2024-04-24 15:12:51 INFO     Saved model at 2
2024-04-24 15:12:51 INFO     Val loss decrease from 15.3062 to 12.1413, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-24 15:12:56 INFO     epoch complete!
2024-04-24 15:12:56 INFO     evaluating now!
2024-04-24 15:12:56 INFO     Epoch [3/200] train_loss: 10.2669, val_loss: 9.6533, lr: 0.003000, 5.23s
2024-04-24 15:12:57 INFO     Saved model at 3
2024-04-24 15:12:57 INFO     Val loss decrease from 12.1413 to 9.6533, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-24 15:13:01 INFO     epoch complete!
2024-04-24 15:13:01 INFO     evaluating now!
2024-04-24 15:13:02 INFO     Epoch [4/200] train_loss: 8.9126, val_loss: 8.6231, lr: 0.003000, 5.25s
2024-04-24 15:13:02 INFO     Saved model at 4
2024-04-24 15:13:02 INFO     Val loss decrease from 9.6533 to 8.6231, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-24 15:13:07 INFO     epoch complete!
2024-04-24 15:13:07 INFO     evaluating now!
2024-04-24 15:13:07 INFO     Epoch [5/200] train_loss: 7.9097, val_loss: 7.6509, lr: 0.003000, 5.22s
2024-04-24 15:13:07 INFO     Saved model at 5
2024-04-24 15:13:07 INFO     Val loss decrease from 8.6231 to 7.6509, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-24 15:13:12 INFO     epoch complete!
2024-04-24 15:13:12 INFO     evaluating now!
2024-04-24 15:13:12 INFO     Epoch [6/200] train_loss: 7.0862, val_loss: 7.0865, lr: 0.003000, 5.31s
2024-04-24 15:13:12 INFO     Saved model at 6
2024-04-24 15:13:12 INFO     Val loss decrease from 7.6509 to 7.0865, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-24 15:13:17 INFO     epoch complete!
2024-04-24 15:13:17 INFO     evaluating now!
2024-04-24 15:13:18 INFO     Epoch [7/200] train_loss: 6.8601, val_loss: 6.7411, lr: 0.003000, 5.19s
2024-04-24 15:13:18 INFO     Saved model at 7
2024-04-24 15:13:18 INFO     Val loss decrease from 7.0865 to 6.7411, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-24 15:13:23 INFO     epoch complete!
2024-04-24 15:13:23 INFO     evaluating now!
2024-04-24 15:13:23 INFO     Epoch [8/200] train_loss: 6.3036, val_loss: 6.4191, lr: 0.003000, 5.34s
2024-04-24 15:13:23 INFO     Saved model at 8
2024-04-24 15:13:23 INFO     Val loss decrease from 6.7411 to 6.4191, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-24 15:13:28 INFO     epoch complete!
2024-04-24 15:13:28 INFO     evaluating now!
2024-04-24 15:13:28 INFO     Epoch [9/200] train_loss: 6.2100, val_loss: 6.7101, lr: 0.003000, 5.48s
2024-04-24 15:13:33 INFO     epoch complete!
2024-04-24 15:13:33 INFO     evaluating now!
2024-04-24 15:13:34 INFO     Epoch [10/200] train_loss: 6.1023, val_loss: 6.2298, lr: 0.003000, 5.28s
2024-04-24 15:13:34 INFO     Saved model at 10
2024-04-24 15:13:34 INFO     Val loss decrease from 6.4191 to 6.2298, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-24 15:13:39 INFO     epoch complete!
2024-04-24 15:13:39 INFO     evaluating now!
2024-04-24 15:13:39 INFO     Epoch [11/200] train_loss: 5.8832, val_loss: 6.0699, lr: 0.003000, 5.25s
2024-04-24 15:13:39 INFO     Saved model at 11
2024-04-24 15:13:39 INFO     Val loss decrease from 6.2298 to 6.0699, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-24 15:13:44 INFO     epoch complete!
2024-04-24 15:13:44 INFO     evaluating now!
2024-04-24 15:13:44 INFO     Epoch [12/200] train_loss: 5.7550, val_loss: 6.2323, lr: 0.003000, 5.19s
2024-04-24 15:13:49 INFO     epoch complete!
2024-04-24 15:13:49 INFO     evaluating now!
2024-04-24 15:13:49 INFO     Epoch [13/200] train_loss: 5.5412, val_loss: 5.8682, lr: 0.003000, 5.22s
2024-04-24 15:13:49 INFO     Saved model at 13
2024-04-24 15:13:49 INFO     Val loss decrease from 6.0699 to 5.8682, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-24 15:13:54 INFO     epoch complete!
2024-04-24 15:13:54 INFO     evaluating now!
2024-04-24 15:13:55 INFO     Epoch [14/200] train_loss: 5.3977, val_loss: 5.8144, lr: 0.003000, 5.20s
2024-04-24 15:13:55 INFO     Saved model at 14
2024-04-24 15:13:55 INFO     Val loss decrease from 5.8682 to 5.8144, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-24 15:13:59 INFO     epoch complete!
2024-04-24 15:13:59 INFO     evaluating now!
2024-04-24 15:14:00 INFO     Epoch [15/200] train_loss: 5.2806, val_loss: 5.6447, lr: 0.003000, 5.21s
2024-04-24 15:14:00 INFO     Saved model at 15
2024-04-24 15:14:00 INFO     Val loss decrease from 5.8144 to 5.6447, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-24 15:14:05 INFO     epoch complete!
2024-04-24 15:14:05 INFO     evaluating now!
2024-04-24 15:14:05 INFO     Epoch [16/200] train_loss: 5.1864, val_loss: 5.7898, lr: 0.003000, 5.23s
2024-04-24 15:14:10 INFO     epoch complete!
2024-04-24 15:14:10 INFO     evaluating now!
2024-04-24 15:14:10 INFO     Epoch [17/200] train_loss: 5.1323, val_loss: 5.5435, lr: 0.003000, 5.22s
2024-04-24 15:14:10 INFO     Saved model at 17
2024-04-24 15:14:10 INFO     Val loss decrease from 5.6447 to 5.5435, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-24 15:14:15 INFO     epoch complete!
2024-04-24 15:14:15 INFO     evaluating now!
2024-04-24 15:14:16 INFO     Epoch [18/200] train_loss: 5.0952, val_loss: 5.7013, lr: 0.003000, 5.29s
2024-04-24 15:14:21 INFO     epoch complete!
2024-04-24 15:14:21 INFO     evaluating now!
2024-04-24 15:14:21 INFO     Epoch [19/200] train_loss: 5.0183, val_loss: 5.4143, lr: 0.003000, 5.31s
2024-04-24 15:14:21 INFO     Saved model at 19
2024-04-24 15:14:21 INFO     Val loss decrease from 5.5435 to 5.4143, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-24 15:14:26 INFO     epoch complete!
2024-04-24 15:14:26 INFO     evaluating now!
2024-04-24 15:14:26 INFO     Epoch [20/200] train_loss: 5.0581, val_loss: 5.5099, lr: 0.003000, 5.21s
2024-04-24 15:14:31 INFO     epoch complete!
2024-04-24 15:14:31 INFO     evaluating now!
2024-04-24 15:14:31 INFO     Epoch [21/200] train_loss: 4.9004, val_loss: 5.3757, lr: 0.003000, 5.33s
2024-04-24 15:14:31 INFO     Saved model at 21
2024-04-24 15:14:31 INFO     Val loss decrease from 5.4143 to 5.3757, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-24 15:14:37 INFO     epoch complete!
2024-04-24 15:14:37 INFO     evaluating now!
2024-04-24 15:14:38 INFO     Epoch [22/200] train_loss: 4.7619, val_loss: 5.4691, lr: 0.003000, 6.20s
2024-04-24 15:14:43 INFO     epoch complete!
2024-04-24 15:14:43 INFO     evaluating now!
2024-04-24 15:14:44 INFO     Epoch [23/200] train_loss: 4.7459, val_loss: 5.2097, lr: 0.003000, 6.07s
2024-04-24 15:14:44 INFO     Saved model at 23
2024-04-24 15:14:44 INFO     Val loss decrease from 5.3757 to 5.2097, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-24 15:14:49 INFO     epoch complete!
2024-04-24 15:14:49 INFO     evaluating now!
2024-04-24 15:14:49 INFO     Epoch [24/200] train_loss: 4.6521, val_loss: 5.2684, lr: 0.003000, 5.31s
2024-04-24 15:14:54 INFO     epoch complete!
2024-04-24 15:14:54 INFO     evaluating now!
2024-04-24 15:14:54 INFO     Epoch [25/200] train_loss: 4.7367, val_loss: 5.2419, lr: 0.003000, 5.32s
2024-04-24 15:14:59 INFO     epoch complete!
2024-04-24 15:14:59 INFO     evaluating now!
2024-04-24 15:15:00 INFO     Epoch [26/200] train_loss: 4.6537, val_loss: 5.3476, lr: 0.003000, 5.37s
2024-04-24 15:15:05 INFO     epoch complete!
2024-04-24 15:15:05 INFO     evaluating now!
2024-04-24 15:15:05 INFO     Epoch [27/200] train_loss: 4.5800, val_loss: 5.6782, lr: 0.003000, 5.25s
2024-04-24 15:15:10 INFO     epoch complete!
2024-04-24 15:15:10 INFO     evaluating now!
2024-04-24 15:15:10 INFO     Epoch [28/200] train_loss: 4.6174, val_loss: 5.3260, lr: 0.003000, 5.29s
2024-04-24 15:15:15 INFO     epoch complete!
2024-04-24 15:15:15 INFO     evaluating now!
2024-04-24 15:15:16 INFO     Epoch [29/200] train_loss: 4.5033, val_loss: 5.1874, lr: 0.003000, 5.29s
2024-04-24 15:15:16 INFO     Saved model at 29
2024-04-24 15:15:16 INFO     Val loss decrease from 5.2097 to 5.1874, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-04-24 15:15:21 INFO     epoch complete!
2024-04-24 15:15:21 INFO     evaluating now!
2024-04-24 15:15:21 INFO     Epoch [30/200] train_loss: 4.4983, val_loss: 5.3161, lr: 0.003000, 5.34s
2024-04-24 15:15:26 INFO     epoch complete!
2024-04-24 15:15:26 INFO     evaluating now!
2024-04-24 15:15:26 INFO     Epoch [31/200] train_loss: 4.4282, val_loss: 5.2086, lr: 0.003000, 5.26s
2024-04-24 15:15:31 INFO     epoch complete!
2024-04-24 15:15:31 INFO     evaluating now!
2024-04-24 15:15:32 INFO     Epoch [32/200] train_loss: 4.3466, val_loss: 5.2374, lr: 0.003000, 5.31s
2024-04-24 15:15:37 INFO     epoch complete!
2024-04-24 15:15:37 INFO     evaluating now!
2024-04-24 15:15:37 INFO     Epoch [33/200] train_loss: 4.3264, val_loss: 5.2696, lr: 0.003000, 5.41s
2024-04-24 15:15:42 INFO     epoch complete!
2024-04-24 15:15:42 INFO     evaluating now!
2024-04-24 15:15:42 INFO     Epoch [34/200] train_loss: 4.3139, val_loss: 5.2957, lr: 0.003000, 5.28s
2024-04-24 15:15:47 INFO     epoch complete!
2024-04-24 15:15:47 INFO     evaluating now!
2024-04-24 15:15:47 INFO     Epoch [35/200] train_loss: 4.2711, val_loss: 5.2533, lr: 0.003000, 5.25s
2024-04-24 15:15:52 INFO     epoch complete!
2024-04-24 15:15:52 INFO     evaluating now!
2024-04-24 15:15:53 INFO     Epoch [36/200] train_loss: 4.2973, val_loss: 5.1978, lr: 0.003000, 5.29s
2024-04-24 15:15:58 INFO     epoch complete!
2024-04-24 15:15:58 INFO     evaluating now!
2024-04-24 15:15:58 INFO     Epoch [37/200] train_loss: 4.3085, val_loss: 5.3578, lr: 0.003000, 5.32s
2024-04-24 15:16:03 INFO     epoch complete!
2024-04-24 15:16:03 INFO     evaluating now!
2024-04-24 15:16:03 INFO     Epoch [38/200] train_loss: 4.2250, val_loss: 5.2476, lr: 0.003000, 5.38s
2024-04-24 15:16:08 INFO     epoch complete!
2024-04-24 15:16:08 INFO     evaluating now!
2024-04-24 15:16:09 INFO     Epoch [39/200] train_loss: 4.1567, val_loss: 5.1443, lr: 0.003000, 5.26s
2024-04-24 15:16:09 INFO     Saved model at 39
2024-04-24 15:16:09 INFO     Val loss decrease from 5.1874 to 5.1443, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-04-24 15:16:14 INFO     epoch complete!
2024-04-24 15:16:14 INFO     evaluating now!
2024-04-24 15:16:14 INFO     Epoch [40/200] train_loss: 4.1596, val_loss: 5.2311, lr: 0.003000, 5.28s
2024-04-24 15:16:19 INFO     epoch complete!
2024-04-24 15:16:19 INFO     evaluating now!
2024-04-24 15:16:19 INFO     Epoch [41/200] train_loss: 4.2020, val_loss: 5.3831, lr: 0.003000, 5.45s
2024-04-24 15:16:24 INFO     epoch complete!
2024-04-24 15:16:24 INFO     evaluating now!
2024-04-24 15:16:25 INFO     Epoch [42/200] train_loss: 4.1336, val_loss: 5.2583, lr: 0.003000, 5.34s
2024-04-24 15:16:30 INFO     epoch complete!
2024-04-24 15:16:30 INFO     evaluating now!
2024-04-24 15:16:30 INFO     Epoch [43/200] train_loss: 4.0864, val_loss: 5.3430, lr: 0.003000, 5.29s
2024-04-24 15:16:35 INFO     epoch complete!
2024-04-24 15:16:35 INFO     evaluating now!
2024-04-24 15:16:35 INFO     Epoch [44/200] train_loss: 4.0581, val_loss: 5.1059, lr: 0.003000, 5.27s
2024-04-24 15:16:35 INFO     Saved model at 44
2024-04-24 15:16:35 INFO     Val loss decrease from 5.1443 to 5.1059, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-04-24 15:16:40 INFO     epoch complete!
2024-04-24 15:16:40 INFO     evaluating now!
2024-04-24 15:16:41 INFO     Epoch [45/200] train_loss: 3.9931, val_loss: 5.1307, lr: 0.003000, 5.30s
2024-04-24 15:16:46 INFO     epoch complete!
2024-04-24 15:16:46 INFO     evaluating now!
2024-04-24 15:16:46 INFO     Epoch [46/200] train_loss: 3.9219, val_loss: 5.1306, lr: 0.003000, 5.30s
2024-04-24 15:16:51 INFO     epoch complete!
2024-04-24 15:16:51 INFO     evaluating now!
2024-04-24 15:16:51 INFO     Epoch [47/200] train_loss: 3.9262, val_loss: 5.2722, lr: 0.003000, 5.28s
2024-04-24 15:16:56 INFO     epoch complete!
2024-04-24 15:16:56 INFO     evaluating now!
2024-04-24 15:16:57 INFO     Epoch [48/200] train_loss: 4.0840, val_loss: 5.2037, lr: 0.003000, 5.26s
2024-04-24 15:17:02 INFO     epoch complete!
2024-04-24 15:17:02 INFO     evaluating now!
2024-04-24 15:17:02 INFO     Epoch [49/200] train_loss: 3.9626, val_loss: 5.1984, lr: 0.003000, 5.41s
2024-04-24 15:17:07 INFO     epoch complete!
2024-04-24 15:17:07 INFO     evaluating now!
2024-04-24 15:17:07 INFO     Epoch [50/200] train_loss: 3.8511, val_loss: 5.1756, lr: 0.003000, 5.27s
2024-04-24 15:17:12 INFO     epoch complete!
2024-04-24 15:17:12 INFO     evaluating now!
2024-04-24 15:17:13 INFO     Epoch [51/200] train_loss: 3.8594, val_loss: 5.3219, lr: 0.003000, 5.34s
2024-04-24 15:17:18 INFO     epoch complete!
2024-04-24 15:17:18 INFO     evaluating now!
2024-04-24 15:17:18 INFO     Epoch [52/200] train_loss: 3.9470, val_loss: 5.2403, lr: 0.003000, 5.37s
2024-04-24 15:17:23 INFO     epoch complete!
2024-04-24 15:17:23 INFO     evaluating now!
2024-04-24 15:17:23 INFO     Epoch [53/200] train_loss: 3.8809, val_loss: 5.0604, lr: 0.003000, 5.47s
2024-04-24 15:17:23 INFO     Saved model at 53
2024-04-24 15:17:23 INFO     Val loss decrease from 5.1059 to 5.0604, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch53.tar
2024-04-24 15:17:29 INFO     epoch complete!
2024-04-24 15:17:29 INFO     evaluating now!
2024-04-24 15:17:29 INFO     Epoch [54/200] train_loss: 3.8113, val_loss: 5.1351, lr: 0.003000, 5.44s
2024-04-24 15:17:34 INFO     epoch complete!
2024-04-24 15:17:34 INFO     evaluating now!
2024-04-24 15:17:34 INFO     Epoch [55/200] train_loss: 3.7557, val_loss: 5.2657, lr: 0.003000, 5.32s
2024-04-24 15:17:39 INFO     epoch complete!
2024-04-24 15:17:39 INFO     evaluating now!
2024-04-24 15:17:39 INFO     Epoch [56/200] train_loss: 3.7840, val_loss: 5.3760, lr: 0.003000, 5.22s
2024-04-24 15:17:44 INFO     epoch complete!
2024-04-24 15:17:44 INFO     evaluating now!
2024-04-24 15:17:45 INFO     Epoch [57/200] train_loss: 3.8144, val_loss: 5.1531, lr: 0.003000, 5.18s
2024-04-24 15:17:49 INFO     epoch complete!
2024-04-24 15:17:49 INFO     evaluating now!
2024-04-24 15:17:50 INFO     Epoch [58/200] train_loss: 3.7694, val_loss: 5.1472, lr: 0.003000, 5.16s
2024-04-24 15:17:55 INFO     epoch complete!
2024-04-24 15:17:55 INFO     evaluating now!
2024-04-24 15:17:55 INFO     Epoch [59/200] train_loss: 3.7203, val_loss: 5.1699, lr: 0.003000, 5.14s
2024-04-24 15:18:00 INFO     epoch complete!
2024-04-24 15:18:00 INFO     evaluating now!
2024-04-24 15:18:00 INFO     Epoch [60/200] train_loss: 3.6841, val_loss: 5.0551, lr: 0.003000, 5.14s
2024-04-24 15:18:00 INFO     Saved model at 60
2024-04-24 15:18:00 INFO     Val loss decrease from 5.0604 to 5.0551, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch60.tar
2024-04-24 15:18:05 INFO     epoch complete!
2024-04-24 15:18:05 INFO     evaluating now!
2024-04-24 15:18:05 INFO     Epoch [61/200] train_loss: 3.7443, val_loss: 5.2486, lr: 0.003000, 5.14s
2024-04-24 15:18:10 INFO     epoch complete!
2024-04-24 15:18:10 INFO     evaluating now!
2024-04-24 15:18:10 INFO     Epoch [62/200] train_loss: 3.8092, val_loss: 5.2369, lr: 0.003000, 5.16s
2024-04-24 15:18:15 INFO     epoch complete!
2024-04-24 15:18:15 INFO     evaluating now!
2024-04-24 15:18:16 INFO     Epoch [63/200] train_loss: 3.7883, val_loss: 5.1306, lr: 0.003000, 5.20s
2024-04-24 15:18:20 INFO     epoch complete!
2024-04-24 15:18:20 INFO     evaluating now!
2024-04-24 15:18:21 INFO     Epoch [64/200] train_loss: 3.6691, val_loss: 5.1327, lr: 0.003000, 5.22s
2024-04-24 15:18:26 INFO     epoch complete!
2024-04-24 15:18:26 INFO     evaluating now!
2024-04-24 15:18:26 INFO     Epoch [65/200] train_loss: 3.6443, val_loss: 5.0441, lr: 0.003000, 5.18s
2024-04-24 15:18:26 INFO     Saved model at 65
2024-04-24 15:18:26 INFO     Val loss decrease from 5.0551 to 5.0441, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch65.tar
2024-04-24 15:18:31 INFO     epoch complete!
2024-04-24 15:18:31 INFO     evaluating now!
2024-04-24 15:18:31 INFO     Epoch [66/200] train_loss: 3.6397, val_loss: 5.1353, lr: 0.003000, 5.15s
2024-04-24 15:18:36 INFO     epoch complete!
2024-04-24 15:18:36 INFO     evaluating now!
2024-04-24 15:18:36 INFO     Epoch [67/200] train_loss: 3.6038, val_loss: 5.1440, lr: 0.003000, 5.30s
2024-04-24 15:18:41 INFO     epoch complete!
2024-04-24 15:18:41 INFO     evaluating now!
2024-04-24 15:18:42 INFO     Epoch [68/200] train_loss: 3.6407, val_loss: 5.2578, lr: 0.003000, 5.22s
2024-04-24 15:18:46 INFO     epoch complete!
2024-04-24 15:18:46 INFO     evaluating now!
2024-04-24 15:18:47 INFO     Epoch [69/200] train_loss: 3.6710, val_loss: 5.1786, lr: 0.003000, 5.16s
2024-04-24 15:18:52 INFO     epoch complete!
2024-04-24 15:18:52 INFO     evaluating now!
2024-04-24 15:18:52 INFO     Epoch [70/200] train_loss: 3.5760, val_loss: 5.1363, lr: 0.003000, 5.24s
2024-04-24 15:18:57 INFO     epoch complete!
2024-04-24 15:18:57 INFO     evaluating now!
2024-04-24 15:18:57 INFO     Epoch [71/200] train_loss: 3.5813, val_loss: 5.1383, lr: 0.003000, 5.18s
2024-04-24 15:19:02 INFO     epoch complete!
2024-04-24 15:19:02 INFO     evaluating now!
2024-04-24 15:19:02 INFO     Epoch [72/200] train_loss: 3.6642, val_loss: 5.1286, lr: 0.003000, 5.25s
2024-04-24 15:19:07 INFO     epoch complete!
2024-04-24 15:19:07 INFO     evaluating now!
2024-04-24 15:19:08 INFO     Epoch [73/200] train_loss: 3.6552, val_loss: 5.0787, lr: 0.003000, 5.31s
2024-04-24 15:19:13 INFO     epoch complete!
2024-04-24 15:19:13 INFO     evaluating now!
2024-04-24 15:19:13 INFO     Epoch [74/200] train_loss: 3.5525, val_loss: 5.1705, lr: 0.003000, 5.20s
2024-04-24 15:19:18 INFO     epoch complete!
2024-04-24 15:19:18 INFO     evaluating now!
2024-04-24 15:19:18 INFO     Epoch [75/200] train_loss: 3.5097, val_loss: 5.0514, lr: 0.003000, 5.35s
2024-04-24 15:19:23 INFO     epoch complete!
2024-04-24 15:19:23 INFO     evaluating now!
2024-04-24 15:19:24 INFO     Epoch [76/200] train_loss: 3.5186, val_loss: 5.2216, lr: 0.003000, 5.22s
2024-04-24 15:19:28 INFO     epoch complete!
2024-04-24 15:19:28 INFO     evaluating now!
2024-04-24 15:19:29 INFO     Epoch [77/200] train_loss: 3.5643, val_loss: 5.1476, lr: 0.003000, 5.18s
2024-04-24 15:19:34 INFO     epoch complete!
2024-04-24 15:19:34 INFO     evaluating now!
2024-04-24 15:19:34 INFO     Epoch [78/200] train_loss: 3.5448, val_loss: 5.1664, lr: 0.003000, 5.21s
2024-04-24 15:19:39 INFO     epoch complete!
2024-04-24 15:19:39 INFO     evaluating now!
2024-04-24 15:19:39 INFO     Epoch [79/200] train_loss: 3.5688, val_loss: 5.0365, lr: 0.003000, 5.30s
2024-04-24 15:19:39 INFO     Saved model at 79
2024-04-24 15:19:39 INFO     Val loss decrease from 5.0441 to 5.0365, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch79.tar
2024-04-24 15:19:44 INFO     epoch complete!
2024-04-24 15:19:44 INFO     evaluating now!
2024-04-24 15:19:45 INFO     Epoch [80/200] train_loss: 3.4740, val_loss: 5.1408, lr: 0.003000, 5.33s
2024-04-24 15:19:49 INFO     epoch complete!
2024-04-24 15:19:49 INFO     evaluating now!
2024-04-24 15:19:50 INFO     Epoch [81/200] train_loss: 3.4637, val_loss: 5.1806, lr: 0.003000, 5.21s
2024-04-24 15:19:55 INFO     epoch complete!
2024-04-24 15:19:55 INFO     evaluating now!
2024-04-24 15:19:55 INFO     Epoch [82/200] train_loss: 3.4574, val_loss: 4.9969, lr: 0.003000, 5.22s
2024-04-24 15:19:55 INFO     Saved model at 82
2024-04-24 15:19:55 INFO     Val loss decrease from 5.0365 to 4.9969, saving to ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406_epoch82.tar
2024-04-24 15:20:00 INFO     epoch complete!
2024-04-24 15:20:00 INFO     evaluating now!
2024-04-24 15:20:00 INFO     Epoch [83/200] train_loss: 3.4789, val_loss: 5.2393, lr: 0.003000, 5.16s
2024-04-24 15:20:05 INFO     epoch complete!
2024-04-24 15:20:05 INFO     evaluating now!
2024-04-24 15:20:05 INFO     Epoch [84/200] train_loss: 3.4278, val_loss: 5.0822, lr: 0.003000, 5.19s
2024-04-24 15:20:10 INFO     epoch complete!
2024-04-24 15:20:10 INFO     evaluating now!
2024-04-24 15:20:11 INFO     Epoch [85/200] train_loss: 3.4428, val_loss: 5.0884, lr: 0.003000, 5.15s
2024-04-24 15:20:15 INFO     epoch complete!
2024-04-24 15:20:15 INFO     evaluating now!
2024-04-24 15:20:16 INFO     Epoch [86/200] train_loss: 3.4007, val_loss: 5.0492, lr: 0.003000, 5.15s
2024-04-24 15:20:20 INFO     epoch complete!
2024-04-24 15:20:20 INFO     evaluating now!
2024-04-24 15:20:21 INFO     Epoch [87/200] train_loss: 3.3914, val_loss: 5.0992, lr: 0.003000, 5.14s
2024-04-24 15:20:26 INFO     epoch complete!
2024-04-24 15:20:26 INFO     evaluating now!
2024-04-24 15:20:26 INFO     Epoch [88/200] train_loss: 3.3726, val_loss: 5.1564, lr: 0.003000, 5.27s
2024-04-24 15:20:31 INFO     epoch complete!
2024-04-24 15:20:31 INFO     evaluating now!
2024-04-24 15:20:31 INFO     Epoch [89/200] train_loss: 3.3713, val_loss: 5.0917, lr: 0.003000, 5.43s
2024-04-24 15:20:36 INFO     epoch complete!
2024-04-24 15:20:36 INFO     evaluating now!
2024-04-24 15:20:37 INFO     Epoch [90/200] train_loss: 3.3725, val_loss: 5.1347, lr: 0.003000, 5.26s
2024-04-24 15:20:42 INFO     epoch complete!
2024-04-24 15:20:42 INFO     evaluating now!
2024-04-24 15:20:42 INFO     Epoch [91/200] train_loss: 3.3482, val_loss: 5.1579, lr: 0.003000, 5.18s
2024-04-24 15:20:47 INFO     epoch complete!
2024-04-24 15:20:47 INFO     evaluating now!
2024-04-24 15:20:47 INFO     Epoch [92/200] train_loss: 3.3591, val_loss: 5.1480, lr: 0.003000, 5.21s
2024-04-24 15:20:52 INFO     epoch complete!
2024-04-24 15:20:52 INFO     evaluating now!
2024-04-24 15:20:52 INFO     Epoch [93/200] train_loss: 3.3632, val_loss: 5.1276, lr: 0.003000, 5.22s
2024-04-24 15:20:57 INFO     epoch complete!
2024-04-24 15:20:57 INFO     evaluating now!
2024-04-24 15:20:58 INFO     Epoch [94/200] train_loss: 3.3895, val_loss: 5.1719, lr: 0.003000, 5.25s
2024-04-24 15:21:02 INFO     epoch complete!
2024-04-24 15:21:02 INFO     evaluating now!
2024-04-24 15:21:03 INFO     Epoch [95/200] train_loss: 3.3731, val_loss: 5.1803, lr: 0.003000, 5.11s
2024-04-24 15:21:08 INFO     epoch complete!
2024-04-24 15:21:08 INFO     evaluating now!
2024-04-24 15:21:08 INFO     Epoch [96/200] train_loss: 3.4972, val_loss: 5.1414, lr: 0.003000, 5.11s
2024-04-24 15:21:13 INFO     epoch complete!
2024-04-24 15:21:13 INFO     evaluating now!
2024-04-24 15:21:13 INFO     Epoch [97/200] train_loss: 3.4012, val_loss: 5.1399, lr: 0.003000, 5.14s
2024-04-24 15:21:13 WARNING  Early stopping at epoch: 97
2024-04-24 15:21:13 INFO     Trained totally 98 epochs, average train time is 4.956s, average eval time is 0.322s
2024-04-24 15:21:13 INFO     Loaded model at 82
2024-04-24 15:21:13 INFO     Saved model at ./libcity/cache/9/model_cache/AGCRN_CHITaxi20190406.m
2024-04-24 15:21:13 INFO     Start evaluating ...
2024-04-24 15:21:14 INFO     Note that you select the single mode to evaluate!
2024-04-24 15:21:14 INFO     Evaluate result is saved at ./libcity/cache/9/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-24 15:21:14 INFO     
         MAE       RMSE
1   2.391185   6.859993
2   2.443256   7.653529
3   2.659058   8.718288
4   2.835227   9.617441
5   2.964370  10.708393
6   3.125168  12.001645
7   3.239353  13.093000
8   3.306148  13.800850
9   3.326673  13.923235
10  3.327157  13.802596
11  3.327606  13.713902
12  3.397913  13.863517
2024-04-24 15:21:14 INFO     ----------------------------------------------------------------------------
2024-04-24 15:21:14 INFO     Kownledge Graph Embedding: True, Experiment ids: [5, 6, 7, 8, 9]
2024-04-24 15:21:14 INFO     ----------------------------------------------------------------------------
2024-04-24 15:21:14 INFO     Average: 
         MAE       RMSE
0   2.379641   7.103011
1   2.468801   7.764760
2   2.654561   8.768877
3   2.802158   9.504019
4   2.922731  10.227367
5   3.031240  11.017959
6   3.114030  11.692876
7   3.206168  12.262926
8   3.248974  12.587805
9   3.308590  12.853420
10  3.347177  13.143820
11  3.468738  13.675714 
2024-04-24 15:21:14 INFO     Standard deviation: 
         MAE      RMSE
0   0.101246  0.133000
1   0.080431  0.085783
2   0.082122  0.083514
3   0.079026  0.141653
4   0.113410  0.307857
5   0.090079  0.575575
6   0.097717  0.770627
7   0.052353  0.833559
8   0.065796  0.743950
9   0.046231  0.605053
10  0.089469  0.510491
11  0.081326  0.422674
2024-04-24 15:21:14 INFO     ----------------------------------------------------------------------------
2024-04-24 15:21:14 INFO     12 steps Average: 
        MAE       RMSE
0  2.996067  10.883546
2024-04-24 15:21:14 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.081601  0.434478
