2024-09-28 15:02:20 INFO     Saving logs in: ./logs/CHITaxi20190406/AGCRN/Test
2024-09-28 15:02:21 INFO     ----------------------------------------------------------------------------
2024-09-28 15:02:21 INFO     # 0, Kownledge Graph Embedding: TransE, Experiment ids: 1005
2024-09-28 15:02:21 INFO     ----------------------------------------------------------------------------
2024-09-28 15:02:21 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=1005
2024-09-28 15:02:21 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 1005, 'ke_model': 'TransE', 'ke_dim': 32, 'ke_method': 'MultiHop', 'max_hop': 1, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 15:02:21 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 15:02:21 INFO     set_weight_link_or_dist: dist
2024-09-28 15:02:21 INFO     init_weight_inf_or_zero: inf
2024-09-28 15:02:21 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 15:02:21 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 15:02:21 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 15:02:21 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 15:02:22 INFO     Dataset created
2024-09-28 15:02:22 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-28 15:02:22 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-28 15:02:22 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-28 15:02:22 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-28 15:02:22 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 15:02:22 INFO     NoneScaler
2024-09-28 15:02:30 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 15:02:30 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 15:02:30 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 15:02:30 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 15:02:30 INFO     encoder.dcrnn_cells.0.gate.weights_pool2	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 15:02:30 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 15:02:30 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 15:02:30 INFO     encoder.dcrnn_cells.0.update.weights_pool2	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 15:02:30 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 15:02:30 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 15:02:30 INFO     encoder.dcrnn_cells.1.gate.weights_pool2	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 15:02:30 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 15:02:30 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 15:02:30 INFO     encoder.dcrnn_cells.1.update.weights_pool2	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 15:02:30 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 15:02:30 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 15:02:30 INFO     Total parameter numbers: 1496090
2024-09-28 15:02:30 INFO     You select `adam` optimizer.
2024-09-28 15:02:30 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 15:02:30 INFO     Start training ...
2024-09-28 15:02:30 INFO     num_batches:48
2024-09-28 15:02:54 INFO     epoch complete!
2024-09-28 15:02:54 INFO     evaluating now!
2024-09-28 15:02:57 INFO     Epoch [0/200] train_loss: 23.1786, val_loss: 17.0133, lr: 0.003000, 27.10s
2024-09-28 15:02:57 INFO     Saved model at 0
2024-09-28 15:02:57 INFO     Val loss decrease from inf to 17.0133, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 15:03:22 INFO     epoch complete!
2024-09-28 15:03:22 INFO     evaluating now!
2024-09-28 15:03:25 INFO     Epoch [1/200] train_loss: 13.3437, val_loss: 12.7734, lr: 0.003000, 28.60s
2024-09-28 15:03:26 INFO     Saved model at 1
2024-09-28 15:03:26 INFO     Val loss decrease from 17.0133 to 12.7734, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 15:03:50 INFO     epoch complete!
2024-09-28 15:03:50 INFO     evaluating now!
2024-09-28 15:03:53 INFO     Epoch [2/200] train_loss: 10.4083, val_loss: 10.2327, lr: 0.003000, 26.95s
2024-09-28 15:03:53 INFO     Saved model at 2
2024-09-28 15:03:53 INFO     Val loss decrease from 12.7734 to 10.2327, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 15:04:23 INFO     epoch complete!
2024-09-28 15:04:23 INFO     evaluating now!
2024-09-28 15:04:28 INFO     Epoch [3/200] train_loss: 8.5472, val_loss: 8.3580, lr: 0.003000, 34.80s
2024-09-28 15:04:28 INFO     Saved model at 3
2024-09-28 15:04:28 INFO     Val loss decrease from 10.2327 to 8.3580, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 15:04:54 INFO     epoch complete!
2024-09-28 15:04:54 INFO     evaluating now!
2024-09-28 15:04:56 INFO     Epoch [4/200] train_loss: 7.4357, val_loss: 7.1935, lr: 0.003000, 28.54s
2024-09-28 15:04:57 INFO     Saved model at 4
2024-09-28 15:04:57 INFO     Val loss decrease from 8.3580 to 7.1935, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 15:05:20 INFO     epoch complete!
2024-09-28 15:05:20 INFO     evaluating now!
2024-09-28 15:05:23 INFO     Epoch [5/200] train_loss: 6.6193, val_loss: 6.6114, lr: 0.003000, 26.40s
2024-09-28 15:05:23 INFO     Saved model at 5
2024-09-28 15:05:23 INFO     Val loss decrease from 7.1935 to 6.6114, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 15:05:46 INFO     epoch complete!
2024-09-28 15:05:46 INFO     evaluating now!
2024-09-28 15:05:49 INFO     Epoch [6/200] train_loss: 6.1962, val_loss: 6.2334, lr: 0.003000, 26.04s
2024-09-28 15:05:50 INFO     Saved model at 6
2024-09-28 15:05:50 INFO     Val loss decrease from 6.6114 to 6.2334, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-28 15:06:14 INFO     epoch complete!
2024-09-28 15:06:14 INFO     evaluating now!
2024-09-28 15:06:16 INFO     Epoch [7/200] train_loss: 5.8496, val_loss: 6.2523, lr: 0.003000, 26.60s
2024-09-28 15:06:40 INFO     epoch complete!
2024-09-28 15:06:40 INFO     evaluating now!
2024-09-28 15:06:43 INFO     Epoch [8/200] train_loss: 5.7362, val_loss: 5.9874, lr: 0.003000, 26.64s
2024-09-28 15:06:43 INFO     Saved model at 8
2024-09-28 15:06:43 INFO     Val loss decrease from 6.2334 to 5.9874, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-28 15:07:07 INFO     epoch complete!
2024-09-28 15:07:07 INFO     evaluating now!
2024-09-28 15:07:11 INFO     Epoch [9/200] train_loss: 5.4347, val_loss: 5.6589, lr: 0.003000, 27.74s
2024-09-28 15:07:11 INFO     Saved model at 9
2024-09-28 15:07:11 INFO     Val loss decrease from 5.9874 to 5.6589, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-28 15:07:35 INFO     epoch complete!
2024-09-28 15:07:35 INFO     evaluating now!
2024-09-28 15:07:38 INFO     Epoch [10/200] train_loss: 5.3426, val_loss: 5.8164, lr: 0.003000, 26.75s
2024-09-28 15:08:01 INFO     epoch complete!
2024-09-28 15:08:01 INFO     evaluating now!
2024-09-28 15:08:04 INFO     Epoch [11/200] train_loss: 5.1841, val_loss: 5.7587, lr: 0.003000, 25.86s
2024-09-28 15:08:27 INFO     epoch complete!
2024-09-28 15:08:27 INFO     evaluating now!
2024-09-28 15:08:30 INFO     Epoch [12/200] train_loss: 5.1152, val_loss: 6.0713, lr: 0.003000, 26.17s
2024-09-28 15:08:53 INFO     epoch complete!
2024-09-28 15:08:53 INFO     evaluating now!
2024-09-28 15:08:57 INFO     Epoch [13/200] train_loss: 5.0535, val_loss: 5.4409, lr: 0.003000, 26.90s
2024-09-28 15:08:57 INFO     Saved model at 13
2024-09-28 15:08:57 INFO     Val loss decrease from 5.6589 to 5.4409, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-28 15:09:21 INFO     epoch complete!
2024-09-28 15:09:21 INFO     evaluating now!
2024-09-28 15:09:23 INFO     Epoch [14/200] train_loss: 4.9306, val_loss: 5.6600, lr: 0.003000, 26.52s
2024-09-28 15:09:48 INFO     epoch complete!
2024-09-28 15:09:48 INFO     evaluating now!
2024-09-28 15:09:51 INFO     Epoch [15/200] train_loss: 4.8944, val_loss: 5.5849, lr: 0.003000, 27.32s
2024-09-28 15:10:16 INFO     epoch complete!
2024-09-28 15:10:16 INFO     evaluating now!
2024-09-28 15:10:19 INFO     Epoch [16/200] train_loss: 4.7648, val_loss: 5.6679, lr: 0.003000, 27.78s
2024-09-28 15:10:43 INFO     epoch complete!
2024-09-28 15:10:43 INFO     evaluating now!
2024-09-28 15:10:45 INFO     Epoch [17/200] train_loss: 4.6428, val_loss: 5.4326, lr: 0.003000, 26.58s
2024-09-28 15:10:45 INFO     Saved model at 17
2024-09-28 15:10:45 INFO     Val loss decrease from 5.4409 to 5.4326, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-28 15:11:09 INFO     epoch complete!
2024-09-28 15:11:09 INFO     evaluating now!
2024-09-28 15:11:12 INFO     Epoch [18/200] train_loss: 4.5661, val_loss: 5.4190, lr: 0.003000, 26.33s
2024-09-28 15:11:12 INFO     Saved model at 18
2024-09-28 15:11:12 INFO     Val loss decrease from 5.4326 to 5.4190, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-28 15:11:36 INFO     epoch complete!
2024-09-28 15:11:36 INFO     evaluating now!
2024-09-28 15:11:39 INFO     Epoch [19/200] train_loss: 4.5913, val_loss: 5.4036, lr: 0.003000, 26.98s
2024-09-28 15:11:39 INFO     Saved model at 19
2024-09-28 15:11:39 INFO     Val loss decrease from 5.4190 to 5.4036, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-28 15:12:02 INFO     epoch complete!
2024-09-28 15:12:02 INFO     evaluating now!
2024-09-28 15:12:06 INFO     Epoch [20/200] train_loss: 4.5476, val_loss: 5.5186, lr: 0.003000, 26.77s
2024-09-28 15:12:28 INFO     epoch complete!
2024-09-28 15:12:28 INFO     evaluating now!
2024-09-28 15:12:30 INFO     Epoch [21/200] train_loss: 4.4446, val_loss: 5.5026, lr: 0.003000, 24.37s
2024-09-28 15:12:53 INFO     epoch complete!
2024-09-28 15:12:53 INFO     evaluating now!
2024-09-28 15:12:56 INFO     Epoch [22/200] train_loss: 4.3523, val_loss: 5.3521, lr: 0.003000, 25.85s
2024-09-28 15:12:56 INFO     Saved model at 22
2024-09-28 15:12:56 INFO     Val loss decrease from 5.4036 to 5.3521, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-28 15:13:19 INFO     epoch complete!
2024-09-28 15:13:19 INFO     evaluating now!
2024-09-28 15:13:21 INFO     Epoch [23/200] train_loss: 4.3350, val_loss: 5.3868, lr: 0.003000, 25.31s
2024-09-28 15:13:43 INFO     epoch complete!
2024-09-28 15:13:43 INFO     evaluating now!
2024-09-28 15:13:46 INFO     Epoch [24/200] train_loss: 4.2294, val_loss: 5.2154, lr: 0.003000, 24.56s
2024-09-28 15:13:46 INFO     Saved model at 24
2024-09-28 15:13:46 INFO     Val loss decrease from 5.3521 to 5.2154, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-28 15:14:09 INFO     epoch complete!
2024-09-28 15:14:09 INFO     evaluating now!
2024-09-28 15:14:11 INFO     Epoch [25/200] train_loss: 4.1877, val_loss: 5.2131, lr: 0.003000, 25.21s
2024-09-28 15:14:12 INFO     Saved model at 25
2024-09-28 15:14:12 INFO     Val loss decrease from 5.2154 to 5.2131, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-28 15:14:35 INFO     epoch complete!
2024-09-28 15:14:35 INFO     evaluating now!
2024-09-28 15:14:37 INFO     Epoch [26/200] train_loss: 4.1575, val_loss: 5.2079, lr: 0.003000, 25.83s
2024-09-28 15:14:38 INFO     Saved model at 26
2024-09-28 15:14:38 INFO     Val loss decrease from 5.2131 to 5.2079, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-28 15:15:00 INFO     epoch complete!
2024-09-28 15:15:00 INFO     evaluating now!
2024-09-28 15:15:03 INFO     Epoch [27/200] train_loss: 4.0794, val_loss: 5.1575, lr: 0.003000, 25.27s
2024-09-28 15:15:03 INFO     Saved model at 27
2024-09-28 15:15:03 INFO     Val loss decrease from 5.2079 to 5.1575, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-28 15:15:27 INFO     epoch complete!
2024-09-28 15:15:27 INFO     evaluating now!
2024-09-28 15:15:30 INFO     Epoch [28/200] train_loss: 4.1454, val_loss: 5.2610, lr: 0.003000, 26.77s
2024-09-28 15:15:52 INFO     epoch complete!
2024-09-28 15:15:52 INFO     evaluating now!
2024-09-28 15:15:54 INFO     Epoch [29/200] train_loss: 4.0964, val_loss: 5.1236, lr: 0.003000, 24.50s
2024-09-28 15:15:54 INFO     Saved model at 29
2024-09-28 15:15:54 INFO     Val loss decrease from 5.1575 to 5.1236, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-28 15:16:17 INFO     epoch complete!
2024-09-28 15:16:17 INFO     evaluating now!
2024-09-28 15:16:20 INFO     Epoch [30/200] train_loss: 4.0044, val_loss: 5.1765, lr: 0.003000, 25.33s
2024-09-28 15:16:43 INFO     epoch complete!
2024-09-28 15:16:43 INFO     evaluating now!
2024-09-28 15:16:46 INFO     Epoch [31/200] train_loss: 3.9467, val_loss: 5.0964, lr: 0.003000, 25.89s
2024-09-28 15:16:46 INFO     Saved model at 31
2024-09-28 15:16:46 INFO     Val loss decrease from 5.1236 to 5.0964, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-09-28 15:17:10 INFO     epoch complete!
2024-09-28 15:17:10 INFO     evaluating now!
2024-09-28 15:17:12 INFO     Epoch [32/200] train_loss: 3.9421, val_loss: 5.1954, lr: 0.003000, 26.47s
2024-09-28 15:17:35 INFO     epoch complete!
2024-09-28 15:17:35 INFO     evaluating now!
2024-09-28 15:17:38 INFO     Epoch [33/200] train_loss: 3.9101, val_loss: 5.1019, lr: 0.003000, 25.45s
2024-09-28 15:18:03 INFO     epoch complete!
2024-09-28 15:18:03 INFO     evaluating now!
2024-09-28 15:18:06 INFO     Epoch [34/200] train_loss: 3.8607, val_loss: 5.1129, lr: 0.003000, 27.97s
2024-09-28 15:18:29 INFO     epoch complete!
2024-09-28 15:18:29 INFO     evaluating now!
2024-09-28 15:18:32 INFO     Epoch [35/200] train_loss: 3.8578, val_loss: 5.0136, lr: 0.003000, 26.42s
2024-09-28 15:18:32 INFO     Saved model at 35
2024-09-28 15:18:32 INFO     Val loss decrease from 5.0964 to 5.0136, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-28 15:18:56 INFO     epoch complete!
2024-09-28 15:18:56 INFO     evaluating now!
2024-09-28 15:18:59 INFO     Epoch [36/200] train_loss: 3.7741, val_loss: 5.0970, lr: 0.003000, 26.56s
2024-09-28 15:19:21 INFO     epoch complete!
2024-09-28 15:19:21 INFO     evaluating now!
2024-09-28 15:19:24 INFO     Epoch [37/200] train_loss: 3.7801, val_loss: 5.1375, lr: 0.003000, 24.65s
2024-09-28 15:19:46 INFO     epoch complete!
2024-09-28 15:19:46 INFO     evaluating now!
2024-09-28 15:19:49 INFO     Epoch [38/200] train_loss: 3.7920, val_loss: 5.1435, lr: 0.003000, 25.69s
2024-09-28 15:20:12 INFO     epoch complete!
2024-09-28 15:20:12 INFO     evaluating now!
2024-09-28 15:20:14 INFO     Epoch [39/200] train_loss: 3.7559, val_loss: 5.1169, lr: 0.003000, 24.84s
2024-09-28 15:20:36 INFO     epoch complete!
2024-09-28 15:20:36 INFO     evaluating now!
2024-09-28 15:20:39 INFO     Epoch [40/200] train_loss: 3.6884, val_loss: 4.9516, lr: 0.003000, 24.54s
2024-09-28 15:20:39 INFO     Saved model at 40
2024-09-28 15:20:39 INFO     Val loss decrease from 5.0136 to 4.9516, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-09-28 15:21:03 INFO     epoch complete!
2024-09-28 15:21:03 INFO     evaluating now!
2024-09-28 15:21:06 INFO     Epoch [41/200] train_loss: 3.6659, val_loss: 5.0823, lr: 0.003000, 27.54s
2024-09-28 15:21:29 INFO     epoch complete!
2024-09-28 15:21:29 INFO     evaluating now!
2024-09-28 15:21:32 INFO     Epoch [42/200] train_loss: 3.6926, val_loss: 5.0884, lr: 0.003000, 25.79s
2024-09-28 15:21:56 INFO     epoch complete!
2024-09-28 15:21:56 INFO     evaluating now!
2024-09-28 15:21:58 INFO     Epoch [43/200] train_loss: 3.5942, val_loss: 4.9260, lr: 0.003000, 26.28s
2024-09-28 15:21:59 INFO     Saved model at 43
2024-09-28 15:21:59 INFO     Val loss decrease from 4.9516 to 4.9260, saving to ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-09-28 15:22:22 INFO     epoch complete!
2024-09-28 15:22:22 INFO     evaluating now!
2024-09-28 15:22:25 INFO     Epoch [44/200] train_loss: 3.6244, val_loss: 5.1761, lr: 0.003000, 26.86s
2024-09-28 15:22:48 INFO     epoch complete!
2024-09-28 15:22:48 INFO     evaluating now!
2024-09-28 15:22:51 INFO     Epoch [45/200] train_loss: 3.6256, val_loss: 4.9861, lr: 0.003000, 25.35s
2024-09-28 15:23:13 INFO     epoch complete!
2024-09-28 15:23:13 INFO     evaluating now!
2024-09-28 15:23:17 INFO     Epoch [46/200] train_loss: 3.5363, val_loss: 5.0381, lr: 0.003000, 25.82s
2024-09-28 15:23:42 INFO     epoch complete!
2024-09-28 15:23:42 INFO     evaluating now!
2024-09-28 15:23:45 INFO     Epoch [47/200] train_loss: 3.5268, val_loss: 5.0667, lr: 0.003000, 28.00s
2024-09-28 15:24:10 INFO     epoch complete!
2024-09-28 15:24:10 INFO     evaluating now!
2024-09-28 15:24:12 INFO     Epoch [48/200] train_loss: 3.5197, val_loss: 5.1452, lr: 0.003000, 27.85s
2024-09-28 15:24:35 INFO     epoch complete!
2024-09-28 15:24:35 INFO     evaluating now!
2024-09-28 15:24:38 INFO     Epoch [49/200] train_loss: 3.4967, val_loss: 5.1040, lr: 0.003000, 25.10s
2024-09-28 15:24:59 INFO     epoch complete!
2024-09-28 15:24:59 INFO     evaluating now!
2024-09-28 15:25:02 INFO     Epoch [50/200] train_loss: 3.5195, val_loss: 5.1370, lr: 0.003000, 24.07s
2024-09-28 15:25:25 INFO     epoch complete!
2024-09-28 15:25:25 INFO     evaluating now!
2024-09-28 15:25:29 INFO     Epoch [51/200] train_loss: 3.4670, val_loss: 5.0804, lr: 0.003000, 27.14s
2024-09-28 15:25:52 INFO     epoch complete!
2024-09-28 15:25:52 INFO     evaluating now!
2024-09-28 15:25:55 INFO     Epoch [52/200] train_loss: 3.4701, val_loss: 5.1446, lr: 0.003000, 26.02s
2024-09-28 15:26:20 INFO     epoch complete!
2024-09-28 15:26:20 INFO     evaluating now!
2024-09-28 15:26:22 INFO     Epoch [53/200] train_loss: 3.4129, val_loss: 5.0405, lr: 0.003000, 27.56s
2024-09-28 15:26:45 INFO     epoch complete!
2024-09-28 15:26:45 INFO     evaluating now!
2024-09-28 15:26:48 INFO     Epoch [54/200] train_loss: 3.3952, val_loss: 5.0841, lr: 0.003000, 25.64s
2024-09-28 15:27:11 INFO     epoch complete!
2024-09-28 15:27:11 INFO     evaluating now!
2024-09-28 15:27:13 INFO     Epoch [55/200] train_loss: 3.3890, val_loss: 5.0079, lr: 0.003000, 25.46s
2024-09-28 15:27:37 INFO     epoch complete!
2024-09-28 15:27:37 INFO     evaluating now!
2024-09-28 15:27:39 INFO     Epoch [56/200] train_loss: 3.3553, val_loss: 5.0576, lr: 0.003000, 25.64s
2024-09-28 15:28:02 INFO     epoch complete!
2024-09-28 15:28:02 INFO     evaluating now!
2024-09-28 15:28:05 INFO     Epoch [57/200] train_loss: 3.3427, val_loss: 5.0738, lr: 0.003000, 25.57s
2024-09-28 15:28:30 INFO     epoch complete!
2024-09-28 15:28:30 INFO     evaluating now!
2024-09-28 15:28:33 INFO     Epoch [58/200] train_loss: 3.3517, val_loss: 5.1786, lr: 0.003000, 27.90s
2024-09-28 15:28:33 WARNING  Early stopping at epoch: 58
2024-09-28 15:28:33 INFO     Trained totally 59 epochs, average train time is 23.470s, average eval time is 2.943s
2024-09-28 15:28:33 INFO     Loaded model at 43
2024-09-28 15:28:33 INFO     Saved model at ./libcity/cache/1005/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 15:28:33 INFO     Start evaluating ...
2024-09-28 15:28:40 INFO     Note that you select the single mode to evaluate!
2024-09-28 15:28:40 INFO     Evaluate result is saved at ./libcity/cache/1005/evaluate_cache/2024_09_28_15_28_40_AGCRN_CHITaxi20190406.csv
2024-09-28 15:28:40 INFO     
         MAE       RMSE  masked_MAPE
1   2.381153   7.009459     0.417926
2   2.428560   7.547546     0.416810
3   2.685796   8.927633     0.422930
4   2.942893  10.467072     0.430121
5   3.165422  12.078432     0.446475
6   3.273250  13.403720     0.440401
7   3.427010  14.144401     0.463206
8   3.390867  14.287446     0.434459
9   3.389213  13.940132     0.440274
10  3.395781  13.682128     0.441293
11  3.421191  13.753716     0.443800
12  3.556119  14.312592     0.464210
2024-09-28 15:28:41 INFO     ----------------------------------------------------------------------------
2024-09-28 15:28:41 INFO     # 1, Kownledge Graph Embedding: TransE, Experiment ids: 1006
2024-09-28 15:28:41 INFO     ----------------------------------------------------------------------------
2024-09-28 15:28:41 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=1006
2024-09-28 15:28:41 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 1006, 'ke_model': 'TransE', 'ke_dim': 32, 'ke_method': 'MultiHop', 'max_hop': 1, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 15:28:41 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 15:28:41 INFO     set_weight_link_or_dist: dist
2024-09-28 15:28:41 INFO     init_weight_inf_or_zero: inf
2024-09-28 15:28:41 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 15:28:41 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 15:28:41 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 15:28:41 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 15:28:41 INFO     Dataset created
2024-09-28 15:28:41 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-28 15:28:41 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-28 15:28:41 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-28 15:28:41 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-28 15:28:41 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 15:28:41 INFO     NoneScaler
2024-09-28 15:28:42 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 15:28:42 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 15:28:42 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 15:28:42 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 15:28:42 INFO     encoder.dcrnn_cells.0.gate.weights_pool2	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 15:28:42 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 15:28:42 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 15:28:42 INFO     encoder.dcrnn_cells.0.update.weights_pool2	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 15:28:42 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 15:28:42 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 15:28:42 INFO     encoder.dcrnn_cells.1.gate.weights_pool2	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 15:28:42 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 15:28:42 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 15:28:42 INFO     encoder.dcrnn_cells.1.update.weights_pool2	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 15:28:42 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 15:28:42 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 15:28:42 INFO     Total parameter numbers: 1496090
2024-09-28 15:28:42 INFO     You select `adam` optimizer.
2024-09-28 15:28:42 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 15:28:42 INFO     Start training ...
2024-09-28 15:28:42 INFO     num_batches:48
2024-09-28 15:29:05 INFO     epoch complete!
2024-09-28 15:29:05 INFO     evaluating now!
2024-09-28 15:29:08 INFO     Epoch [0/200] train_loss: 22.3935, val_loss: 16.5053, lr: 0.003000, 26.02s
2024-09-28 15:29:08 INFO     Saved model at 0
2024-09-28 15:29:08 INFO     Val loss decrease from inf to 16.5053, saving to ./libcity/cache/1006/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 15:29:30 INFO     epoch complete!
2024-09-28 15:29:30 INFO     evaluating now!
2024-09-28 15:29:32 INFO     Epoch [1/200] train_loss: 12.8837, val_loss: 12.3441, lr: 0.003000, 24.29s
2024-09-28 15:29:32 INFO     Saved model at 1
2024-09-28 15:29:32 INFO     Val loss decrease from 16.5053 to 12.3441, saving to ./libcity/cache/1006/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 15:29:54 INFO     epoch complete!
2024-09-28 15:29:54 INFO     evaluating now!
2024-09-28 15:29:57 INFO     Epoch [2/200] train_loss: 9.9479, val_loss: 9.7563, lr: 0.003000, 24.49s
2024-09-28 15:29:57 INFO     Saved model at 2
2024-09-28 15:29:57 INFO     Val loss decrease from 12.3441 to 9.7563, saving to ./libcity/cache/1006/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 15:30:20 INFO     epoch complete!
2024-09-28 15:30:20 INFO     evaluating now!
2024-09-28 15:30:23 INFO     Epoch [3/200] train_loss: 8.0904, val_loss: 7.9416, lr: 0.003000, 26.10s
2024-09-28 15:30:23 INFO     Saved model at 3
2024-09-28 15:30:23 INFO     Val loss decrease from 9.7563 to 7.9416, saving to ./libcity/cache/1006/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 15:30:45 INFO     epoch complete!
2024-09-28 15:30:45 INFO     evaluating now!
2024-09-28 15:30:48 INFO     Epoch [4/200] train_loss: 7.0132, val_loss: 6.9223, lr: 0.003000, 25.03s
2024-09-28 15:30:48 INFO     Saved model at 4
2024-09-28 15:30:48 INFO     Val loss decrease from 7.9416 to 6.9223, saving to ./libcity/cache/1006/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 15:31:12 INFO     epoch complete!
2024-09-28 15:31:12 INFO     evaluating now!
2024-09-28 15:31:15 INFO     Epoch [5/200] train_loss: 6.3943, val_loss: 6.5203, lr: 0.003000, 26.73s
2024-09-28 15:31:15 INFO     Saved model at 5
2024-09-28 15:31:15 INFO     Val loss decrease from 6.9223 to 6.5203, saving to ./libcity/cache/1006/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 15:31:38 INFO     epoch complete!
2024-09-28 15:31:38 INFO     evaluating now!
2024-09-28 15:31:40 INFO     Epoch [6/200] train_loss: 6.0756, val_loss: 6.2758, lr: 0.003000, 25.54s
2024-09-28 15:31:41 INFO     Saved model at 6
2024-09-28 15:31:41 INFO     Val loss decrease from 6.5203 to 6.2758, saving to ./libcity/cache/1006/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-28 15:32:03 INFO     epoch complete!
2024-09-28 15:32:03 INFO     evaluating now!
2024-09-28 15:32:06 INFO     Epoch [7/200] train_loss: 5.7884, val_loss: 6.1748, lr: 0.003000, 25.35s
2024-09-28 15:32:06 INFO     Saved model at 7
2024-09-28 15:32:06 INFO     Val loss decrease from 6.2758 to 6.1748, saving to ./libcity/cache/1006/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-28 15:32:30 INFO     epoch complete!
2024-09-28 15:32:30 INFO     evaluating now!
2024-09-28 15:32:33 INFO     Epoch [8/200] train_loss: 5.6060, val_loss: 5.9449, lr: 0.003000, 27.01s
2024-09-28 15:32:33 INFO     Saved model at 8
2024-09-28 15:32:33 INFO     Val loss decrease from 6.1748 to 5.9449, saving to ./libcity/cache/1006/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-28 15:32:56 INFO     epoch complete!
2024-09-28 15:32:56 INFO     evaluating now!
2024-09-28 15:32:59 INFO     Epoch [9/200] train_loss: 5.4948, val_loss: 6.0958, lr: 0.003000, 25.52s
2024-09-28 15:33:22 INFO     epoch complete!
2024-09-28 15:33:22 INFO     evaluating now!
2024-09-28 15:33:24 INFO     Epoch [10/200] train_loss: 5.2548, val_loss: 5.8433, lr: 0.003000, 25.45s
2024-09-28 15:33:24 INFO     Saved model at 10
2024-09-28 15:33:24 INFO     Val loss decrease from 5.9449 to 5.8433, saving to ./libcity/cache/1006/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-28 15:33:48 INFO     epoch complete!
2024-09-28 15:33:48 INFO     evaluating now!
2024-09-28 15:33:51 INFO     Epoch [11/200] train_loss: 5.1327, val_loss: 5.6142, lr: 0.003000, 26.43s
2024-09-28 15:33:51 INFO     Saved model at 11
2024-09-28 15:33:51 INFO     Val loss decrease from 5.8433 to 5.6142, saving to ./libcity/cache/1006/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-28 15:34:13 INFO     epoch complete!
2024-09-28 15:34:13 INFO     evaluating now!
2024-09-28 15:34:16 INFO     Epoch [12/200] train_loss: 5.0183, val_loss: 5.8064, lr: 0.003000, 25.14s
2024-09-28 15:34:38 INFO     epoch complete!
2024-09-28 15:34:38 INFO     evaluating now!
2024-09-28 15:34:41 INFO     Epoch [13/200] train_loss: 4.9749, val_loss: 5.4330, lr: 0.003000, 25.30s
2024-09-28 15:34:42 INFO     Saved model at 13
2024-09-28 15:34:42 INFO     Val loss decrease from 5.6142 to 5.4330, saving to ./libcity/cache/1006/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-28 15:35:05 INFO     epoch complete!
2024-09-28 15:35:05 INFO     evaluating now!
2024-09-28 15:35:08 INFO     Epoch [14/200] train_loss: 4.8355, val_loss: 5.4889, lr: 0.003000, 26.10s
2024-09-28 15:35:32 INFO     epoch complete!
2024-09-28 15:35:32 INFO     evaluating now!
2024-09-28 15:35:35 INFO     Epoch [15/200] train_loss: 4.7605, val_loss: 5.6697, lr: 0.003000, 27.69s
2024-09-28 15:35:59 INFO     epoch complete!
2024-09-28 15:35:59 INFO     evaluating now!
2024-09-28 15:36:02 INFO     Epoch [16/200] train_loss: 4.7096, val_loss: 5.4580, lr: 0.003000, 26.46s
2024-09-28 15:36:24 INFO     epoch complete!
2024-09-28 15:36:24 INFO     evaluating now!
2024-09-28 15:36:27 INFO     Epoch [17/200] train_loss: 4.5947, val_loss: 5.2096, lr: 0.003000, 25.02s
2024-09-28 15:36:27 INFO     Saved model at 17
2024-09-28 15:36:27 INFO     Val loss decrease from 5.4330 to 5.2096, saving to ./libcity/cache/1006/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-28 15:36:49 INFO     epoch complete!
2024-09-28 15:36:49 INFO     evaluating now!
2024-09-28 15:36:52 INFO     Epoch [18/200] train_loss: 4.6178, val_loss: 5.3247, lr: 0.003000, 24.61s
2024-09-28 15:37:14 INFO     epoch complete!
2024-09-28 15:37:14 INFO     evaluating now!
2024-09-28 15:37:16 INFO     Epoch [19/200] train_loss: 4.5748, val_loss: 5.4537, lr: 0.003000, 24.55s
2024-09-28 15:37:39 INFO     epoch complete!
2024-09-28 15:37:39 INFO     evaluating now!
2024-09-28 15:37:41 INFO     Epoch [20/200] train_loss: 4.4665, val_loss: 5.3532, lr: 0.003000, 25.33s
2024-09-28 15:38:04 INFO     epoch complete!
2024-09-28 15:38:04 INFO     evaluating now!
2024-09-28 15:38:06 INFO     Epoch [21/200] train_loss: 4.3809, val_loss: 5.1774, lr: 0.003000, 24.69s
2024-09-28 15:38:06 INFO     Saved model at 21
2024-09-28 15:38:06 INFO     Val loss decrease from 5.2096 to 5.1774, saving to ./libcity/cache/1006/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-28 15:38:29 INFO     epoch complete!
2024-09-28 15:38:29 INFO     evaluating now!
2024-09-28 15:38:32 INFO     Epoch [22/200] train_loss: 4.3199, val_loss: 5.1227, lr: 0.003000, 25.72s
2024-09-28 15:38:32 INFO     Saved model at 22
2024-09-28 15:38:32 INFO     Val loss decrease from 5.1774 to 5.1227, saving to ./libcity/cache/1006/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-28 15:38:55 INFO     epoch complete!
2024-09-28 15:38:55 INFO     evaluating now!
2024-09-28 15:38:58 INFO     Epoch [23/200] train_loss: 4.2581, val_loss: 5.2109, lr: 0.003000, 25.65s
2024-09-28 15:39:21 INFO     epoch complete!
2024-09-28 15:39:21 INFO     evaluating now!
2024-09-28 15:39:23 INFO     Epoch [24/200] train_loss: 4.2114, val_loss: 5.2723, lr: 0.003000, 25.55s
2024-09-28 15:39:45 INFO     epoch complete!
2024-09-28 15:39:45 INFO     evaluating now!
2024-09-28 15:39:48 INFO     Epoch [25/200] train_loss: 4.1744, val_loss: 5.1829, lr: 0.003000, 24.40s
2024-09-28 15:40:11 INFO     epoch complete!
2024-09-28 15:40:11 INFO     evaluating now!
2024-09-28 15:40:14 INFO     Epoch [26/200] train_loss: 4.1297, val_loss: 5.3434, lr: 0.003000, 26.11s
2024-09-28 15:40:39 INFO     epoch complete!
2024-09-28 15:40:39 INFO     evaluating now!
2024-09-28 15:40:42 INFO     Epoch [27/200] train_loss: 4.1634, val_loss: 5.3072, lr: 0.003000, 27.65s
2024-09-28 15:41:07 INFO     epoch complete!
2024-09-28 15:41:07 INFO     evaluating now!
2024-09-28 15:41:10 INFO     Epoch [28/200] train_loss: 4.0809, val_loss: 5.1552, lr: 0.003000, 28.43s
2024-09-28 15:41:32 INFO     epoch complete!
2024-09-28 15:41:32 INFO     evaluating now!
2024-09-28 15:41:34 INFO     Epoch [29/200] train_loss: 3.9977, val_loss: 5.2537, lr: 0.003000, 24.38s
2024-09-28 15:41:56 INFO     epoch complete!
2024-09-28 15:41:56 INFO     evaluating now!
2024-09-28 15:41:58 INFO     Epoch [30/200] train_loss: 4.0070, val_loss: 5.3519, lr: 0.003000, 23.62s
2024-09-28 15:42:19 INFO     epoch complete!
2024-09-28 15:42:19 INFO     evaluating now!
2024-09-28 15:42:22 INFO     Epoch [31/200] train_loss: 3.9085, val_loss: 5.2478, lr: 0.003000, 24.13s
2024-09-28 15:42:45 INFO     epoch complete!
2024-09-28 15:42:45 INFO     evaluating now!
2024-09-28 15:42:48 INFO     Epoch [32/200] train_loss: 3.8999, val_loss: 5.1353, lr: 0.003000, 25.92s
2024-09-28 15:43:13 INFO     epoch complete!
2024-09-28 15:43:13 INFO     evaluating now!
2024-09-28 15:43:16 INFO     Epoch [33/200] train_loss: 3.8854, val_loss: 5.1495, lr: 0.003000, 27.76s
2024-09-28 15:43:40 INFO     epoch complete!
2024-09-28 15:43:40 INFO     evaluating now!
2024-09-28 15:43:42 INFO     Epoch [34/200] train_loss: 3.8650, val_loss: 5.1802, lr: 0.003000, 26.58s
2024-09-28 15:44:05 INFO     epoch complete!
2024-09-28 15:44:05 INFO     evaluating now!
2024-09-28 15:44:07 INFO     Epoch [35/200] train_loss: 3.8305, val_loss: 5.1852, lr: 0.003000, 24.82s
2024-09-28 15:44:30 INFO     epoch complete!
2024-09-28 15:44:30 INFO     evaluating now!
2024-09-28 15:44:33 INFO     Epoch [36/200] train_loss: 3.8119, val_loss: 5.2143, lr: 0.003000, 26.21s
2024-09-28 15:44:56 INFO     epoch complete!
2024-09-28 15:44:56 INFO     evaluating now!
2024-09-28 15:44:59 INFO     Epoch [37/200] train_loss: 3.7908, val_loss: 5.1448, lr: 0.003000, 25.70s
2024-09-28 15:44:59 WARNING  Early stopping at epoch: 37
2024-09-28 15:44:59 INFO     Trained totally 38 epochs, average train time is 22.919s, average eval time is 2.749s
2024-09-28 15:44:59 INFO     Loaded model at 22
2024-09-28 15:44:59 INFO     Saved model at ./libcity/cache/1006/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 15:44:59 INFO     Start evaluating ...
2024-09-28 15:45:06 INFO     Note that you select the single mode to evaluate!
2024-09-28 15:45:06 INFO     Evaluate result is saved at ./libcity/cache/1006/evaluate_cache/2024_09_28_15_45_06_AGCRN_CHITaxi20190406.csv
2024-09-28 15:45:06 INFO     
         MAE       RMSE  masked_MAPE
1   2.258542   7.538289     0.433420
2   2.335007   7.767681     0.427878
3   2.521975   8.878841     0.432438
4   2.703121   9.789916     0.430292
5   2.849700  10.655189     0.429623
6   2.975097  11.072017     0.442155
7   3.017563  11.452518     0.448385
8   3.048985  11.817551     0.449076
9   3.102919  12.215472     0.447016
10  3.166597  12.687076     0.454418
11  3.229883  13.137458     0.463520
12  3.441345  14.014577     0.475972
2024-09-28 15:45:07 INFO     ----------------------------------------------------------------------------
2024-09-28 15:45:07 INFO     # 2, Kownledge Graph Embedding: TransE, Experiment ids: 1007
2024-09-28 15:45:07 INFO     ----------------------------------------------------------------------------
2024-09-28 15:45:07 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=1007
2024-09-28 15:45:07 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 1007, 'ke_model': 'TransE', 'ke_dim': 32, 'ke_method': 'MultiHop', 'max_hop': 1, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 15:45:07 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 15:45:07 INFO     set_weight_link_or_dist: dist
2024-09-28 15:45:07 INFO     init_weight_inf_or_zero: inf
2024-09-28 15:45:07 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 15:45:07 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 15:45:07 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 15:45:07 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 15:45:08 INFO     Dataset created
2024-09-28 15:45:08 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-28 15:45:08 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-28 15:45:08 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-28 15:45:08 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-28 15:45:08 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 15:45:08 INFO     NoneScaler
2024-09-28 15:45:08 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 15:45:08 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 15:45:08 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 15:45:08 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 15:45:08 INFO     encoder.dcrnn_cells.0.gate.weights_pool2	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 15:45:08 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 15:45:08 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 15:45:08 INFO     encoder.dcrnn_cells.0.update.weights_pool2	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 15:45:08 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 15:45:08 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 15:45:08 INFO     encoder.dcrnn_cells.1.gate.weights_pool2	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 15:45:08 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 15:45:08 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 15:45:08 INFO     encoder.dcrnn_cells.1.update.weights_pool2	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 15:45:08 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 15:45:08 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 15:45:08 INFO     Total parameter numbers: 1496090
2024-09-28 15:45:08 INFO     You select `adam` optimizer.
2024-09-28 15:45:08 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 15:45:08 INFO     Start training ...
2024-09-28 15:45:08 INFO     num_batches:48
2024-09-28 15:45:32 INFO     epoch complete!
2024-09-28 15:45:32 INFO     evaluating now!
2024-09-28 15:45:34 INFO     Epoch [0/200] train_loss: 23.9236, val_loss: 17.7525, lr: 0.003000, 26.42s
2024-09-28 15:45:35 INFO     Saved model at 0
2024-09-28 15:45:35 INFO     Val loss decrease from inf to 17.7525, saving to ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 15:45:57 INFO     epoch complete!
2024-09-28 15:45:57 INFO     evaluating now!
2024-09-28 15:46:00 INFO     Epoch [1/200] train_loss: 14.2052, val_loss: 14.0215, lr: 0.003000, 25.18s
2024-09-28 15:46:00 INFO     Saved model at 1
2024-09-28 15:46:00 INFO     Val loss decrease from 17.7525 to 14.0215, saving to ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 15:46:23 INFO     epoch complete!
2024-09-28 15:46:23 INFO     evaluating now!
2024-09-28 15:46:25 INFO     Epoch [2/200] train_loss: 11.1079, val_loss: 10.9057, lr: 0.003000, 25.41s
2024-09-28 15:46:25 INFO     Saved model at 2
2024-09-28 15:46:25 INFO     Val loss decrease from 14.0215 to 10.9057, saving to ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 15:46:48 INFO     epoch complete!
2024-09-28 15:46:48 INFO     evaluating now!
2024-09-28 15:46:51 INFO     Epoch [3/200] train_loss: 9.2005, val_loss: 9.0827, lr: 0.003000, 26.00s
2024-09-28 15:46:52 INFO     Saved model at 3
2024-09-28 15:46:52 INFO     Val loss decrease from 10.9057 to 9.0827, saving to ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 15:47:19 INFO     epoch complete!
2024-09-28 15:47:19 INFO     evaluating now!
2024-09-28 15:47:21 INFO     Epoch [4/200] train_loss: 7.8245, val_loss: 7.8031, lr: 0.003000, 29.73s
2024-09-28 15:47:22 INFO     Saved model at 4
2024-09-28 15:47:22 INFO     Val loss decrease from 9.0827 to 7.8031, saving to ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 15:47:46 INFO     epoch complete!
2024-09-28 15:47:46 INFO     evaluating now!
2024-09-28 15:47:49 INFO     Epoch [5/200] train_loss: 7.0597, val_loss: 6.9949, lr: 0.003000, 27.76s
2024-09-28 15:47:50 INFO     Saved model at 5
2024-09-28 15:47:50 INFO     Val loss decrease from 7.8031 to 6.9949, saving to ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 15:48:14 INFO     epoch complete!
2024-09-28 15:48:14 INFO     evaluating now!
2024-09-28 15:48:17 INFO     Epoch [6/200] train_loss: 6.3874, val_loss: 6.4653, lr: 0.003000, 27.54s
2024-09-28 15:48:17 INFO     Saved model at 6
2024-09-28 15:48:17 INFO     Val loss decrease from 6.9949 to 6.4653, saving to ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-28 15:48:41 INFO     epoch complete!
2024-09-28 15:48:41 INFO     evaluating now!
2024-09-28 15:48:44 INFO     Epoch [7/200] train_loss: 6.1884, val_loss: 6.5975, lr: 0.003000, 26.58s
2024-09-28 15:49:10 INFO     epoch complete!
2024-09-28 15:49:10 INFO     evaluating now!
2024-09-28 15:49:13 INFO     Epoch [8/200] train_loss: 5.9871, val_loss: 6.3503, lr: 0.003000, 28.90s
2024-09-28 15:49:13 INFO     Saved model at 8
2024-09-28 15:49:13 INFO     Val loss decrease from 6.4653 to 6.3503, saving to ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-28 15:49:37 INFO     epoch complete!
2024-09-28 15:49:37 INFO     evaluating now!
2024-09-28 15:49:40 INFO     Epoch [9/200] train_loss: 5.6594, val_loss: 6.1725, lr: 0.003000, 26.85s
2024-09-28 15:49:40 INFO     Saved model at 9
2024-09-28 15:49:40 INFO     Val loss decrease from 6.3503 to 6.1725, saving to ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-28 15:50:05 INFO     epoch complete!
2024-09-28 15:50:05 INFO     evaluating now!
2024-09-28 15:50:08 INFO     Epoch [10/200] train_loss: 5.4445, val_loss: 5.9284, lr: 0.003000, 28.43s
2024-09-28 15:50:09 INFO     Saved model at 10
2024-09-28 15:50:09 INFO     Val loss decrease from 6.1725 to 5.9284, saving to ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-28 15:50:37 INFO     epoch complete!
2024-09-28 15:50:37 INFO     evaluating now!
2024-09-28 15:50:40 INFO     Epoch [11/200] train_loss: 5.3188, val_loss: 5.9593, lr: 0.003000, 31.22s
2024-09-28 15:51:07 INFO     epoch complete!
2024-09-28 15:51:07 INFO     evaluating now!
2024-09-28 15:51:11 INFO     Epoch [12/200] train_loss: 5.3239, val_loss: 6.0128, lr: 0.003000, 30.70s
2024-09-28 15:51:35 INFO     epoch complete!
2024-09-28 15:51:35 INFO     evaluating now!
2024-09-28 15:51:38 INFO     Epoch [13/200] train_loss: 5.1366, val_loss: 5.8148, lr: 0.003000, 27.51s
2024-09-28 15:51:38 INFO     Saved model at 13
2024-09-28 15:51:38 INFO     Val loss decrease from 5.9284 to 5.8148, saving to ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-28 15:52:04 INFO     epoch complete!
2024-09-28 15:52:04 INFO     evaluating now!
2024-09-28 15:52:07 INFO     Epoch [14/200] train_loss: 5.0400, val_loss: 5.6554, lr: 0.003000, 28.70s
2024-09-28 15:52:07 INFO     Saved model at 14
2024-09-28 15:52:07 INFO     Val loss decrease from 5.8148 to 5.6554, saving to ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-28 15:52:32 INFO     epoch complete!
2024-09-28 15:52:32 INFO     evaluating now!
2024-09-28 15:52:34 INFO     Epoch [15/200] train_loss: 4.8767, val_loss: 5.6772, lr: 0.003000, 27.04s
2024-09-28 15:53:00 INFO     epoch complete!
2024-09-28 15:53:00 INFO     evaluating now!
2024-09-28 15:53:03 INFO     Epoch [16/200] train_loss: 4.7886, val_loss: 5.6786, lr: 0.003000, 28.42s
2024-09-28 15:53:27 INFO     epoch complete!
2024-09-28 15:53:27 INFO     evaluating now!
2024-09-28 15:53:30 INFO     Epoch [17/200] train_loss: 4.7456, val_loss: 5.5729, lr: 0.003000, 27.56s
2024-09-28 15:53:31 INFO     Saved model at 17
2024-09-28 15:53:31 INFO     Val loss decrease from 5.6554 to 5.5729, saving to ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-28 15:53:55 INFO     epoch complete!
2024-09-28 15:53:55 INFO     evaluating now!
2024-09-28 15:53:58 INFO     Epoch [18/200] train_loss: 4.6730, val_loss: 5.3803, lr: 0.003000, 27.50s
2024-09-28 15:53:58 INFO     Saved model at 18
2024-09-28 15:53:58 INFO     Val loss decrease from 5.5729 to 5.3803, saving to ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-28 15:54:22 INFO     epoch complete!
2024-09-28 15:54:22 INFO     evaluating now!
2024-09-28 15:54:25 INFO     Epoch [19/200] train_loss: 4.5687, val_loss: 5.3999, lr: 0.003000, 27.18s
2024-09-28 15:54:50 INFO     epoch complete!
2024-09-28 15:54:50 INFO     evaluating now!
2024-09-28 15:54:53 INFO     Epoch [20/200] train_loss: 4.4939, val_loss: 5.4661, lr: 0.003000, 27.39s
2024-09-28 15:55:18 INFO     epoch complete!
2024-09-28 15:55:18 INFO     evaluating now!
2024-09-28 15:55:20 INFO     Epoch [21/200] train_loss: 4.5221, val_loss: 5.4232, lr: 0.003000, 27.60s
2024-09-28 15:55:46 INFO     epoch complete!
2024-09-28 15:55:46 INFO     evaluating now!
2024-09-28 15:55:49 INFO     Epoch [22/200] train_loss: 4.4148, val_loss: 5.3053, lr: 0.003000, 28.99s
2024-09-28 15:55:49 INFO     Saved model at 22
2024-09-28 15:55:49 INFO     Val loss decrease from 5.3803 to 5.3053, saving to ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-28 15:56:13 INFO     epoch complete!
2024-09-28 15:56:13 INFO     evaluating now!
2024-09-28 15:56:17 INFO     Epoch [23/200] train_loss: 4.3984, val_loss: 5.2414, lr: 0.003000, 27.23s
2024-09-28 15:56:17 INFO     Saved model at 23
2024-09-28 15:56:17 INFO     Val loss decrease from 5.3053 to 5.2414, saving to ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-28 15:56:45 INFO     epoch complete!
2024-09-28 15:56:45 INFO     evaluating now!
2024-09-28 15:56:50 INFO     Epoch [24/200] train_loss: 4.3149, val_loss: 5.4054, lr: 0.003000, 32.94s
2024-09-28 15:57:15 INFO     epoch complete!
2024-09-28 15:57:15 INFO     evaluating now!
2024-09-28 15:57:18 INFO     Epoch [25/200] train_loss: 4.3177, val_loss: 5.3007, lr: 0.003000, 28.54s
2024-09-28 15:57:46 INFO     epoch complete!
2024-09-28 15:57:46 INFO     evaluating now!
2024-09-28 15:57:49 INFO     Epoch [26/200] train_loss: 4.1831, val_loss: 5.3898, lr: 0.003000, 30.53s
2024-09-28 15:58:14 INFO     epoch complete!
2024-09-28 15:58:14 INFO     evaluating now!
2024-09-28 15:58:17 INFO     Epoch [27/200] train_loss: 4.1766, val_loss: 5.2849, lr: 0.003000, 28.58s
2024-09-28 15:58:44 INFO     epoch complete!
2024-09-28 15:58:44 INFO     evaluating now!
2024-09-28 15:58:48 INFO     Epoch [28/200] train_loss: 4.1533, val_loss: 5.3769, lr: 0.003000, 30.06s
2024-09-28 15:59:12 INFO     epoch complete!
2024-09-28 15:59:12 INFO     evaluating now!
2024-09-28 15:59:16 INFO     Epoch [29/200] train_loss: 4.1279, val_loss: 5.2002, lr: 0.003000, 28.05s
2024-09-28 15:59:16 INFO     Saved model at 29
2024-09-28 15:59:16 INFO     Val loss decrease from 5.2414 to 5.2002, saving to ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-28 15:59:42 INFO     epoch complete!
2024-09-28 15:59:42 INFO     evaluating now!
2024-09-28 15:59:47 INFO     Epoch [30/200] train_loss: 4.1001, val_loss: 5.1796, lr: 0.003000, 30.83s
2024-09-28 15:59:47 INFO     Saved model at 30
2024-09-28 15:59:47 INFO     Val loss decrease from 5.2002 to 5.1796, saving to ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-09-28 16:00:15 INFO     epoch complete!
2024-09-28 16:00:15 INFO     evaluating now!
2024-09-28 16:00:18 INFO     Epoch [31/200] train_loss: 3.9863, val_loss: 5.3841, lr: 0.003000, 31.43s
2024-09-28 16:00:45 INFO     epoch complete!
2024-09-28 16:00:45 INFO     evaluating now!
2024-09-28 16:00:48 INFO     Epoch [32/200] train_loss: 4.0461, val_loss: 5.0791, lr: 0.003000, 30.00s
2024-09-28 16:00:48 INFO     Saved model at 32
2024-09-28 16:00:48 INFO     Val loss decrease from 5.1796 to 5.0791, saving to ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-09-28 16:01:16 INFO     epoch complete!
2024-09-28 16:01:16 INFO     evaluating now!
2024-09-28 16:01:19 INFO     Epoch [33/200] train_loss: 3.9950, val_loss: 5.3897, lr: 0.003000, 31.07s
2024-09-28 16:01:49 INFO     epoch complete!
2024-09-28 16:01:49 INFO     evaluating now!
2024-09-28 16:01:53 INFO     Epoch [34/200] train_loss: 3.9364, val_loss: 5.0919, lr: 0.003000, 33.45s
2024-09-28 16:02:22 INFO     epoch complete!
2024-09-28 16:02:22 INFO     evaluating now!
2024-09-28 16:02:24 INFO     Epoch [35/200] train_loss: 3.8474, val_loss: 5.3137, lr: 0.003000, 31.57s
2024-09-28 16:02:50 INFO     epoch complete!
2024-09-28 16:02:50 INFO     evaluating now!
2024-09-28 16:02:54 INFO     Epoch [36/200] train_loss: 3.8869, val_loss: 5.2428, lr: 0.003000, 29.72s
2024-09-28 16:03:23 INFO     epoch complete!
2024-09-28 16:03:23 INFO     evaluating now!
2024-09-28 16:03:27 INFO     Epoch [37/200] train_loss: 3.8379, val_loss: 5.4462, lr: 0.003000, 32.88s
2024-09-28 16:03:57 INFO     epoch complete!
2024-09-28 16:03:57 INFO     evaluating now!
2024-09-28 16:04:01 INFO     Epoch [38/200] train_loss: 3.8007, val_loss: 5.1908, lr: 0.003000, 34.31s
2024-09-28 16:04:38 INFO     epoch complete!
2024-09-28 16:04:38 INFO     evaluating now!
2024-09-28 16:04:42 INFO     Epoch [39/200] train_loss: 3.7701, val_loss: 5.2074, lr: 0.003000, 40.91s
2024-09-28 16:05:18 INFO     epoch complete!
2024-09-28 16:05:18 INFO     evaluating now!
2024-09-28 16:05:22 INFO     Epoch [40/200] train_loss: 3.7284, val_loss: 5.0964, lr: 0.003000, 39.67s
2024-09-28 16:05:53 INFO     epoch complete!
2024-09-28 16:05:53 INFO     evaluating now!
2024-09-28 16:05:57 INFO     Epoch [41/200] train_loss: 3.6531, val_loss: 5.2149, lr: 0.003000, 35.39s
2024-09-28 16:06:29 INFO     epoch complete!
2024-09-28 16:06:29 INFO     evaluating now!
2024-09-28 16:06:33 INFO     Epoch [42/200] train_loss: 3.7191, val_loss: 5.2356, lr: 0.003000, 35.50s
2024-09-28 16:07:05 INFO     epoch complete!
2024-09-28 16:07:05 INFO     evaluating now!
2024-09-28 16:07:09 INFO     Epoch [43/200] train_loss: 3.6613, val_loss: 5.1740, lr: 0.003000, 35.95s
2024-09-28 16:07:39 INFO     epoch complete!
2024-09-28 16:07:39 INFO     evaluating now!
2024-09-28 16:07:43 INFO     Epoch [44/200] train_loss: 3.6150, val_loss: 5.1206, lr: 0.003000, 34.69s
2024-09-28 16:08:11 INFO     epoch complete!
2024-09-28 16:08:11 INFO     evaluating now!
2024-09-28 16:08:14 INFO     Epoch [45/200] train_loss: 3.6113, val_loss: 5.2672, lr: 0.003000, 30.79s
2024-09-28 16:08:43 INFO     epoch complete!
2024-09-28 16:08:43 INFO     evaluating now!
2024-09-28 16:08:46 INFO     Epoch [46/200] train_loss: 3.5736, val_loss: 5.1451, lr: 0.003000, 31.97s
2024-09-28 16:09:14 INFO     epoch complete!
2024-09-28 16:09:14 INFO     evaluating now!
2024-09-28 16:09:17 INFO     Epoch [47/200] train_loss: 3.5770, val_loss: 5.1236, lr: 0.003000, 31.11s
2024-09-28 16:09:17 WARNING  Early stopping at epoch: 47
2024-09-28 16:09:17 INFO     Trained totally 48 epochs, average train time is 26.785s, average eval time is 3.334s
2024-09-28 16:09:18 INFO     Loaded model at 32
2024-09-28 16:09:18 INFO     Saved model at ./libcity/cache/1007/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 16:09:18 INFO     Start evaluating ...
2024-09-28 16:09:25 INFO     Note that you select the single mode to evaluate!
2024-09-28 16:09:25 INFO     Evaluate result is saved at ./libcity/cache/1007/evaluate_cache/2024_09_28_16_09_25_AGCRN_CHITaxi20190406.csv
2024-09-28 16:09:25 INFO     
         MAE       RMSE  masked_MAPE
1   2.474047   7.702262     0.439033
2   2.509031   7.703306     0.442825
3   2.704066   8.704380     0.444040
4   2.866759   9.678712     0.438741
5   3.048630  10.694873     0.441950
6   3.156364  11.447886     0.444302
7   3.198127  12.272101     0.429801
8   3.295259  12.845877     0.450468
9   3.365101  13.313421     0.462823
10  3.402942  13.839768     0.457560
11  3.454214  14.466056     0.460948
12  3.600450  15.352172     0.465804
2024-09-28 16:09:25 INFO     ----------------------------------------------------------------------------
2024-09-28 16:09:25 INFO     # 3, Kownledge Graph Embedding: TransE, Experiment ids: 1008
2024-09-28 16:09:25 INFO     ----------------------------------------------------------------------------
2024-09-28 16:09:25 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=1008
2024-09-28 16:09:25 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 1008, 'ke_model': 'TransE', 'ke_dim': 32, 'ke_method': 'MultiHop', 'max_hop': 1, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 16:09:25 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 16:09:25 INFO     set_weight_link_or_dist: dist
2024-09-28 16:09:25 INFO     init_weight_inf_or_zero: inf
2024-09-28 16:09:25 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 16:09:25 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 16:09:25 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 16:09:26 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 16:09:26 INFO     Dataset created
2024-09-28 16:09:26 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-28 16:09:26 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-28 16:09:26 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-28 16:09:26 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-28 16:09:26 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 16:09:26 INFO     NoneScaler
2024-09-28 16:09:26 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 16:09:26 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 16:09:26 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 16:09:26 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 16:09:26 INFO     encoder.dcrnn_cells.0.gate.weights_pool2	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 16:09:26 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 16:09:26 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 16:09:26 INFO     encoder.dcrnn_cells.0.update.weights_pool2	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 16:09:26 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 16:09:26 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 16:09:26 INFO     encoder.dcrnn_cells.1.gate.weights_pool2	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 16:09:26 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 16:09:26 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 16:09:26 INFO     encoder.dcrnn_cells.1.update.weights_pool2	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 16:09:26 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 16:09:26 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 16:09:26 INFO     Total parameter numbers: 1496090
2024-09-28 16:09:26 INFO     You select `adam` optimizer.
2024-09-28 16:09:26 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 16:09:26 INFO     Start training ...
2024-09-28 16:09:26 INFO     num_batches:48
2024-09-28 16:09:55 INFO     epoch complete!
2024-09-28 16:09:55 INFO     evaluating now!
2024-09-28 16:09:59 INFO     Epoch [0/200] train_loss: 21.4141, val_loss: 15.2575, lr: 0.003000, 32.73s
2024-09-28 16:09:59 INFO     Saved model at 0
2024-09-28 16:09:59 INFO     Val loss decrease from inf to 15.2575, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 16:10:30 INFO     epoch complete!
2024-09-28 16:10:30 INFO     evaluating now!
2024-09-28 16:10:35 INFO     Epoch [1/200] train_loss: 12.2258, val_loss: 11.2953, lr: 0.003000, 36.21s
2024-09-28 16:10:36 INFO     Saved model at 1
2024-09-28 16:10:36 INFO     Val loss decrease from 15.2575 to 11.2953, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 16:11:09 INFO     epoch complete!
2024-09-28 16:11:09 INFO     evaluating now!
2024-09-28 16:11:13 INFO     Epoch [2/200] train_loss: 8.9958, val_loss: 8.4640, lr: 0.003000, 36.80s
2024-09-28 16:11:14 INFO     Saved model at 2
2024-09-28 16:11:14 INFO     Val loss decrease from 11.2953 to 8.4640, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 16:11:45 INFO     epoch complete!
2024-09-28 16:11:45 INFO     evaluating now!
2024-09-28 16:11:49 INFO     Epoch [3/200] train_loss: 7.3446, val_loss: 7.0295, lr: 0.003000, 35.55s
2024-09-28 16:11:49 INFO     Saved model at 3
2024-09-28 16:11:49 INFO     Val loss decrease from 8.4640 to 7.0295, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 16:12:19 INFO     epoch complete!
2024-09-28 16:12:19 INFO     evaluating now!
2024-09-28 16:12:23 INFO     Epoch [4/200] train_loss: 6.5476, val_loss: 6.7023, lr: 0.003000, 33.52s
2024-09-28 16:12:23 INFO     Saved model at 4
2024-09-28 16:12:23 INFO     Val loss decrease from 7.0295 to 6.7023, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 16:12:55 INFO     epoch complete!
2024-09-28 16:12:55 INFO     evaluating now!
2024-09-28 16:12:59 INFO     Epoch [5/200] train_loss: 6.0777, val_loss: 6.2396, lr: 0.003000, 35.57s
2024-09-28 16:12:59 INFO     Saved model at 5
2024-09-28 16:12:59 INFO     Val loss decrease from 6.7023 to 6.2396, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 16:13:29 INFO     epoch complete!
2024-09-28 16:13:29 INFO     evaluating now!
2024-09-28 16:13:33 INFO     Epoch [6/200] train_loss: 5.7803, val_loss: 6.1011, lr: 0.003000, 33.45s
2024-09-28 16:13:33 INFO     Saved model at 6
2024-09-28 16:13:33 INFO     Val loss decrease from 6.2396 to 6.1011, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-28 16:14:06 INFO     epoch complete!
2024-09-28 16:14:06 INFO     evaluating now!
2024-09-28 16:14:10 INFO     Epoch [7/200] train_loss: 5.5548, val_loss: 5.8201, lr: 0.003000, 37.58s
2024-09-28 16:14:11 INFO     Saved model at 7
2024-09-28 16:14:11 INFO     Val loss decrease from 6.1011 to 5.8201, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-28 16:14:40 INFO     epoch complete!
2024-09-28 16:14:40 INFO     evaluating now!
2024-09-28 16:14:44 INFO     Epoch [8/200] train_loss: 5.3429, val_loss: 5.7402, lr: 0.003000, 33.13s
2024-09-28 16:14:44 INFO     Saved model at 8
2024-09-28 16:14:44 INFO     Val loss decrease from 5.8201 to 5.7402, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-28 16:15:10 INFO     epoch complete!
2024-09-28 16:15:10 INFO     evaluating now!
2024-09-28 16:15:12 INFO     Epoch [9/200] train_loss: 5.2678, val_loss: 5.5554, lr: 0.003000, 28.54s
2024-09-28 16:15:13 INFO     Saved model at 9
2024-09-28 16:15:13 INFO     Val loss decrease from 5.7402 to 5.5554, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-28 16:15:36 INFO     epoch complete!
2024-09-28 16:15:36 INFO     evaluating now!
2024-09-28 16:15:39 INFO     Epoch [10/200] train_loss: 5.0799, val_loss: 5.4450, lr: 0.003000, 26.33s
2024-09-28 16:15:39 INFO     Saved model at 10
2024-09-28 16:15:39 INFO     Val loss decrease from 5.5554 to 5.4450, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-28 16:16:02 INFO     epoch complete!
2024-09-28 16:16:02 INFO     evaluating now!
2024-09-28 16:16:06 INFO     Epoch [11/200] train_loss: 4.9536, val_loss: 5.3129, lr: 0.003000, 26.57s
2024-09-28 16:16:06 INFO     Saved model at 11
2024-09-28 16:16:06 INFO     Val loss decrease from 5.4450 to 5.3129, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-28 16:16:29 INFO     epoch complete!
2024-09-28 16:16:29 INFO     evaluating now!
2024-09-28 16:16:32 INFO     Epoch [12/200] train_loss: 4.8514, val_loss: 5.5041, lr: 0.003000, 26.31s
2024-09-28 16:16:56 INFO     epoch complete!
2024-09-28 16:16:56 INFO     evaluating now!
2024-09-28 16:16:59 INFO     Epoch [13/200] train_loss: 4.7082, val_loss: 5.4327, lr: 0.003000, 26.31s
2024-09-28 16:17:26 INFO     epoch complete!
2024-09-28 16:17:26 INFO     evaluating now!
2024-09-28 16:17:29 INFO     Epoch [14/200] train_loss: 4.7552, val_loss: 5.2655, lr: 0.003000, 30.72s
2024-09-28 16:17:30 INFO     Saved model at 14
2024-09-28 16:17:30 INFO     Val loss decrease from 5.3129 to 5.2655, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-28 16:17:54 INFO     epoch complete!
2024-09-28 16:17:54 INFO     evaluating now!
2024-09-28 16:17:57 INFO     Epoch [15/200] train_loss: 4.6250, val_loss: 5.1952, lr: 0.003000, 27.47s
2024-09-28 16:17:57 INFO     Saved model at 15
2024-09-28 16:17:57 INFO     Val loss decrease from 5.2655 to 5.1952, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-28 16:18:21 INFO     epoch complete!
2024-09-28 16:18:21 INFO     evaluating now!
2024-09-28 16:18:24 INFO     Epoch [16/200] train_loss: 4.4750, val_loss: 5.1614, lr: 0.003000, 26.88s
2024-09-28 16:18:24 INFO     Saved model at 16
2024-09-28 16:18:24 INFO     Val loss decrease from 5.1952 to 5.1614, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-28 16:18:48 INFO     epoch complete!
2024-09-28 16:18:48 INFO     evaluating now!
2024-09-28 16:18:51 INFO     Epoch [17/200] train_loss: 4.4222, val_loss: 5.0905, lr: 0.003000, 27.08s
2024-09-28 16:18:52 INFO     Saved model at 17
2024-09-28 16:18:52 INFO     Val loss decrease from 5.1614 to 5.0905, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-28 16:19:18 INFO     epoch complete!
2024-09-28 16:19:18 INFO     evaluating now!
2024-09-28 16:19:20 INFO     Epoch [18/200] train_loss: 4.4390, val_loss: 5.1992, lr: 0.003000, 28.85s
2024-09-28 16:19:45 INFO     epoch complete!
2024-09-28 16:19:45 INFO     evaluating now!
2024-09-28 16:19:49 INFO     Epoch [19/200] train_loss: 4.3620, val_loss: 5.0836, lr: 0.003000, 28.44s
2024-09-28 16:19:49 INFO     Saved model at 19
2024-09-28 16:19:49 INFO     Val loss decrease from 5.0905 to 5.0836, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-28 16:20:16 INFO     epoch complete!
2024-09-28 16:20:16 INFO     evaluating now!
2024-09-28 16:20:19 INFO     Epoch [20/200] train_loss: 4.2442, val_loss: 5.1250, lr: 0.003000, 29.74s
2024-09-28 16:20:42 INFO     epoch complete!
2024-09-28 16:20:42 INFO     evaluating now!
2024-09-28 16:20:45 INFO     Epoch [21/200] train_loss: 4.2506, val_loss: 5.3221, lr: 0.003000, 26.11s
2024-09-28 16:21:08 INFO     epoch complete!
2024-09-28 16:21:08 INFO     evaluating now!
2024-09-28 16:21:11 INFO     Epoch [22/200] train_loss: 4.2246, val_loss: 5.2103, lr: 0.003000, 25.53s
2024-09-28 16:21:40 INFO     epoch complete!
2024-09-28 16:21:40 INFO     evaluating now!
2024-09-28 16:21:44 INFO     Epoch [23/200] train_loss: 4.2028, val_loss: 5.1907, lr: 0.003000, 32.92s
2024-09-28 16:22:13 INFO     epoch complete!
2024-09-28 16:22:13 INFO     evaluating now!
2024-09-28 16:22:17 INFO     Epoch [24/200] train_loss: 4.0863, val_loss: 5.0533, lr: 0.003000, 33.42s
2024-09-28 16:22:17 INFO     Saved model at 24
2024-09-28 16:22:17 INFO     Val loss decrease from 5.0836 to 5.0533, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-28 16:22:46 INFO     epoch complete!
2024-09-28 16:22:46 INFO     evaluating now!
2024-09-28 16:22:50 INFO     Epoch [25/200] train_loss: 4.0870, val_loss: 5.0578, lr: 0.003000, 32.47s
2024-09-28 16:23:21 INFO     epoch complete!
2024-09-28 16:23:21 INFO     evaluating now!
2024-09-28 16:23:24 INFO     Epoch [26/200] train_loss: 4.0216, val_loss: 5.2459, lr: 0.003000, 34.42s
2024-09-28 16:23:51 INFO     epoch complete!
2024-09-28 16:23:51 INFO     evaluating now!
2024-09-28 16:23:54 INFO     Epoch [27/200] train_loss: 4.0017, val_loss: 5.2754, lr: 0.003000, 29.82s
2024-09-28 16:24:22 INFO     epoch complete!
2024-09-28 16:24:22 INFO     evaluating now!
2024-09-28 16:24:25 INFO     Epoch [28/200] train_loss: 3.9557, val_loss: 5.1912, lr: 0.003000, 30.64s
2024-09-28 16:24:58 INFO     epoch complete!
2024-09-28 16:24:58 INFO     evaluating now!
2024-09-28 16:25:04 INFO     Epoch [29/200] train_loss: 3.9116, val_loss: 5.0683, lr: 0.003000, 39.25s
2024-09-28 16:25:35 INFO     epoch complete!
2024-09-28 16:25:35 INFO     evaluating now!
2024-09-28 16:25:39 INFO     Epoch [30/200] train_loss: 3.8793, val_loss: 5.1479, lr: 0.003000, 34.63s
2024-09-28 16:26:09 INFO     epoch complete!
2024-09-28 16:26:09 INFO     evaluating now!
2024-09-28 16:26:14 INFO     Epoch [31/200] train_loss: 3.8753, val_loss: 5.2982, lr: 0.003000, 34.95s
2024-09-28 16:26:43 INFO     epoch complete!
2024-09-28 16:26:43 INFO     evaluating now!
2024-09-28 16:26:47 INFO     Epoch [32/200] train_loss: 3.8082, val_loss: 5.2760, lr: 0.003000, 33.93s
2024-09-28 16:27:17 INFO     epoch complete!
2024-09-28 16:27:17 INFO     evaluating now!
2024-09-28 16:27:21 INFO     Epoch [33/200] train_loss: 3.7837, val_loss: 5.0587, lr: 0.003000, 33.18s
2024-09-28 16:27:49 INFO     epoch complete!
2024-09-28 16:27:49 INFO     evaluating now!
2024-09-28 16:27:52 INFO     Epoch [34/200] train_loss: 3.7486, val_loss: 5.1715, lr: 0.003000, 31.37s
2024-09-28 16:28:24 INFO     epoch complete!
2024-09-28 16:28:24 INFO     evaluating now!
2024-09-28 16:28:28 INFO     Epoch [35/200] train_loss: 3.7121, val_loss: 5.1171, lr: 0.003000, 36.16s
2024-09-28 16:29:00 INFO     epoch complete!
2024-09-28 16:29:00 INFO     evaluating now!
2024-09-28 16:29:03 INFO     Epoch [36/200] train_loss: 3.6689, val_loss: 4.9600, lr: 0.003000, 34.75s
2024-09-28 16:29:03 INFO     Saved model at 36
2024-09-28 16:29:03 INFO     Val loss decrease from 5.0533 to 4.9600, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-09-28 16:29:37 INFO     epoch complete!
2024-09-28 16:29:37 INFO     evaluating now!
2024-09-28 16:29:42 INFO     Epoch [37/200] train_loss: 3.6703, val_loss: 5.2583, lr: 0.003000, 38.41s
2024-09-28 16:30:16 INFO     epoch complete!
2024-09-28 16:30:16 INFO     evaluating now!
2024-09-28 16:30:28 INFO     Epoch [38/200] train_loss: 3.6366, val_loss: 5.0990, lr: 0.003000, 46.76s
2024-09-28 16:30:58 INFO     epoch complete!
2024-09-28 16:30:58 INFO     evaluating now!
2024-09-28 16:31:01 INFO     Epoch [39/200] train_loss: 3.6137, val_loss: 5.1884, lr: 0.003000, 32.54s
2024-09-28 16:31:29 INFO     epoch complete!
2024-09-28 16:31:29 INFO     evaluating now!
2024-09-28 16:31:33 INFO     Epoch [40/200] train_loss: 3.6336, val_loss: 5.2633, lr: 0.003000, 31.68s
2024-09-28 16:32:03 INFO     epoch complete!
2024-09-28 16:32:03 INFO     evaluating now!
2024-09-28 16:32:07 INFO     Epoch [41/200] train_loss: 3.6116, val_loss: 5.4019, lr: 0.003000, 34.19s
2024-09-28 16:32:39 INFO     epoch complete!
2024-09-28 16:32:39 INFO     evaluating now!
2024-09-28 16:32:43 INFO     Epoch [42/200] train_loss: 3.5909, val_loss: 5.1435, lr: 0.003000, 35.83s
2024-09-28 16:33:11 INFO     epoch complete!
2024-09-28 16:33:11 INFO     evaluating now!
2024-09-28 16:33:14 INFO     Epoch [43/200] train_loss: 3.5332, val_loss: 5.1301, lr: 0.003000, 31.68s
2024-09-28 16:33:41 INFO     epoch complete!
2024-09-28 16:33:41 INFO     evaluating now!
2024-09-28 16:33:44 INFO     Epoch [44/200] train_loss: 3.4855, val_loss: 4.9525, lr: 0.003000, 29.90s
2024-09-28 16:33:44 INFO     Saved model at 44
2024-09-28 16:33:44 INFO     Val loss decrease from 4.9600 to 4.9525, saving to ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-09-28 16:34:11 INFO     epoch complete!
2024-09-28 16:34:11 INFO     evaluating now!
2024-09-28 16:34:15 INFO     Epoch [45/200] train_loss: 3.5097, val_loss: 5.2729, lr: 0.003000, 30.70s
2024-09-28 16:34:39 INFO     epoch complete!
2024-09-28 16:34:39 INFO     evaluating now!
2024-09-28 16:34:42 INFO     Epoch [46/200] train_loss: 3.4780, val_loss: 5.0565, lr: 0.003000, 27.26s
2024-09-28 16:35:10 INFO     epoch complete!
2024-09-28 16:35:10 INFO     evaluating now!
2024-09-28 16:35:12 INFO     Epoch [47/200] train_loss: 3.4342, val_loss: 5.1513, lr: 0.003000, 30.20s
2024-09-28 16:35:37 INFO     epoch complete!
2024-09-28 16:35:37 INFO     evaluating now!
2024-09-28 16:35:40 INFO     Epoch [48/200] train_loss: 3.4283, val_loss: 5.1126, lr: 0.003000, 27.22s
2024-09-28 16:36:03 INFO     epoch complete!
2024-09-28 16:36:03 INFO     evaluating now!
2024-09-28 16:36:06 INFO     Epoch [49/200] train_loss: 3.4289, val_loss: 5.1174, lr: 0.003000, 26.74s
2024-09-28 16:36:29 INFO     epoch complete!
2024-09-28 16:36:29 INFO     evaluating now!
2024-09-28 16:36:32 INFO     Epoch [50/200] train_loss: 3.4132, val_loss: 5.2556, lr: 0.003000, 25.83s
2024-09-28 16:36:57 INFO     epoch complete!
2024-09-28 16:36:57 INFO     evaluating now!
2024-09-28 16:37:00 INFO     Epoch [51/200] train_loss: 3.3739, val_loss: 5.2171, lr: 0.003000, 28.03s
2024-09-28 16:37:27 INFO     epoch complete!
2024-09-28 16:37:27 INFO     evaluating now!
2024-09-28 16:37:30 INFO     Epoch [52/200] train_loss: 3.3718, val_loss: 5.1001, lr: 0.003000, 29.93s
2024-09-28 16:37:58 INFO     epoch complete!
2024-09-28 16:37:58 INFO     evaluating now!
2024-09-28 16:38:00 INFO     Epoch [53/200] train_loss: 3.3241, val_loss: 4.9851, lr: 0.003000, 30.29s
2024-09-28 16:38:26 INFO     epoch complete!
2024-09-28 16:38:26 INFO     evaluating now!
2024-09-28 16:38:29 INFO     Epoch [54/200] train_loss: 3.2855, val_loss: 5.1682, lr: 0.003000, 28.91s
2024-09-28 16:38:58 INFO     epoch complete!
2024-09-28 16:38:58 INFO     evaluating now!
2024-09-28 16:39:02 INFO     Epoch [55/200] train_loss: 3.3095, val_loss: 5.0774, lr: 0.003000, 32.40s
2024-09-28 16:39:29 INFO     epoch complete!
2024-09-28 16:39:29 INFO     evaluating now!
2024-09-28 16:39:33 INFO     Epoch [56/200] train_loss: 3.3521, val_loss: 5.2628, lr: 0.003000, 31.09s
2024-09-28 16:40:01 INFO     epoch complete!
2024-09-28 16:40:01 INFO     evaluating now!
2024-09-28 16:40:05 INFO     Epoch [57/200] train_loss: 3.3049, val_loss: 5.1678, lr: 0.003000, 31.67s
2024-09-28 16:40:31 INFO     epoch complete!
2024-09-28 16:40:31 INFO     evaluating now!
2024-09-28 16:40:35 INFO     Epoch [58/200] train_loss: 3.2909, val_loss: 5.2035, lr: 0.003000, 30.18s
2024-09-28 16:40:59 INFO     epoch complete!
2024-09-28 16:40:59 INFO     evaluating now!
2024-09-28 16:41:03 INFO     Epoch [59/200] train_loss: 3.2922, val_loss: 5.2190, lr: 0.003000, 27.91s
2024-09-28 16:41:03 WARNING  Early stopping at epoch: 59
2024-09-28 16:41:03 INFO     Trained totally 60 epochs, average train time is 27.918s, average eval time is 3.592s
2024-09-28 16:41:03 INFO     Loaded model at 44
2024-09-28 16:41:03 INFO     Saved model at ./libcity/cache/1008/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 16:41:03 INFO     Start evaluating ...
2024-09-28 16:41:10 INFO     Note that you select the single mode to evaluate!
2024-09-28 16:41:10 INFO     Evaluate result is saved at ./libcity/cache/1008/evaluate_cache/2024_09_28_16_41_10_AGCRN_CHITaxi20190406.csv
2024-09-28 16:41:10 INFO     
         MAE       RMSE  masked_MAPE
1   2.305676   6.675505     0.402664
2   2.430361   7.438091     0.412653
3   2.681406   8.665806     0.415715
4   2.827987   9.760630     0.405172
5   2.988068  10.769381     0.413951
6   3.066211  11.572231     0.414430
7   3.146092  12.258709     0.421150
8   3.231882  12.820854     0.439928
9   3.316236  13.299189     0.458845
10  3.275975  13.508373     0.440039
11  3.392187  13.881759     0.463417
12  3.480920  14.246081     0.461014
2024-09-28 16:41:11 INFO     ----------------------------------------------------------------------------
2024-09-28 16:41:11 INFO     # 4, Kownledge Graph Embedding: TransE, Experiment ids: 1009
2024-09-28 16:41:11 INFO     ----------------------------------------------------------------------------
2024-09-28 16:41:11 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=1009
2024-09-28 16:41:11 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 1009, 'ke_model': 'TransE', 'ke_dim': 32, 'ke_method': 'MultiHop', 'max_hop': 1, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 16:41:11 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 16:41:11 INFO     set_weight_link_or_dist: dist
2024-09-28 16:41:11 INFO     init_weight_inf_or_zero: inf
2024-09-28 16:41:11 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 16:41:11 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 16:41:11 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 16:41:11 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 16:41:11 INFO     Dataset created
2024-09-28 16:41:11 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-28 16:41:11 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-28 16:41:11 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-28 16:41:11 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-28 16:41:11 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 16:41:11 INFO     NoneScaler
2024-09-28 16:41:11 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 16:41:11 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 16:41:11 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 16:41:11 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 16:41:11 INFO     encoder.dcrnn_cells.0.gate.weights_pool2	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 16:41:11 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 16:41:11 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 16:41:11 INFO     encoder.dcrnn_cells.0.update.weights_pool2	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 16:41:11 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 16:41:11 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 16:41:11 INFO     encoder.dcrnn_cells.1.gate.weights_pool2	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 16:41:11 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 16:41:11 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 16:41:11 INFO     encoder.dcrnn_cells.1.update.weights_pool2	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 16:41:11 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 16:41:11 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 16:41:11 INFO     Total parameter numbers: 1496090
2024-09-28 16:41:11 INFO     You select `adam` optimizer.
2024-09-28 16:41:11 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 16:41:11 INFO     Start training ...
2024-09-28 16:41:11 INFO     num_batches:48
2024-09-28 16:41:37 INFO     epoch complete!
2024-09-28 16:41:37 INFO     evaluating now!
2024-09-28 16:41:40 INFO     Epoch [0/200] train_loss: 21.7156, val_loss: 16.4865, lr: 0.003000, 28.73s
2024-09-28 16:41:40 INFO     Saved model at 0
2024-09-28 16:41:40 INFO     Val loss decrease from inf to 16.4865, saving to ./libcity/cache/1009/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 16:42:10 INFO     epoch complete!
2024-09-28 16:42:10 INFO     evaluating now!
2024-09-28 16:42:15 INFO     Epoch [1/200] train_loss: 12.6777, val_loss: 11.8882, lr: 0.003000, 34.20s
2024-09-28 16:42:15 INFO     Saved model at 1
2024-09-28 16:42:15 INFO     Val loss decrease from 16.4865 to 11.8882, saving to ./libcity/cache/1009/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 16:42:42 INFO     epoch complete!
2024-09-28 16:42:42 INFO     evaluating now!
2024-09-28 16:42:47 INFO     Epoch [2/200] train_loss: 9.5500, val_loss: 8.9281, lr: 0.003000, 32.44s
2024-09-28 16:42:47 INFO     Saved model at 2
2024-09-28 16:42:47 INFO     Val loss decrease from 11.8882 to 8.9281, saving to ./libcity/cache/1009/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 16:43:23 INFO     epoch complete!
2024-09-28 16:43:23 INFO     evaluating now!
2024-09-28 16:43:27 INFO     Epoch [3/200] train_loss: 7.7644, val_loss: 7.2674, lr: 0.003000, 40.23s
2024-09-28 16:43:28 INFO     Saved model at 3
2024-09-28 16:43:28 INFO     Val loss decrease from 8.9281 to 7.2674, saving to ./libcity/cache/1009/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 16:44:03 INFO     epoch complete!
2024-09-28 16:44:03 INFO     evaluating now!
2024-09-28 16:44:08 INFO     Epoch [4/200] train_loss: 6.7965, val_loss: 6.8399, lr: 0.003000, 40.10s
2024-09-28 16:44:08 INFO     Saved model at 4
2024-09-28 16:44:08 INFO     Val loss decrease from 7.2674 to 6.8399, saving to ./libcity/cache/1009/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 16:44:39 INFO     epoch complete!
2024-09-28 16:44:39 INFO     evaluating now!
2024-09-28 16:44:43 INFO     Epoch [5/200] train_loss: 6.3731, val_loss: 6.4533, lr: 0.003000, 34.98s
2024-09-28 16:44:43 INFO     Saved model at 5
2024-09-28 16:44:43 INFO     Val loss decrease from 6.8399 to 6.4533, saving to ./libcity/cache/1009/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 16:45:15 INFO     epoch complete!
2024-09-28 16:45:15 INFO     evaluating now!
2024-09-28 16:45:19 INFO     Epoch [6/200] train_loss: 5.9694, val_loss: 6.1912, lr: 0.003000, 35.45s
2024-09-28 16:45:19 INFO     Saved model at 6
2024-09-28 16:45:19 INFO     Val loss decrease from 6.4533 to 6.1912, saving to ./libcity/cache/1009/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-28 16:45:52 INFO     epoch complete!
2024-09-28 16:45:52 INFO     evaluating now!
2024-09-28 16:45:57 INFO     Epoch [7/200] train_loss: 5.7930, val_loss: 6.1096, lr: 0.003000, 37.91s
2024-09-28 16:45:57 INFO     Saved model at 7
2024-09-28 16:45:57 INFO     Val loss decrease from 6.1912 to 6.1096, saving to ./libcity/cache/1009/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-28 16:46:31 INFO     epoch complete!
2024-09-28 16:46:31 INFO     evaluating now!
2024-09-28 16:46:36 INFO     Epoch [8/200] train_loss: 5.5962, val_loss: 5.8826, lr: 0.003000, 38.72s
2024-09-28 16:46:36 INFO     Saved model at 8
2024-09-28 16:46:36 INFO     Val loss decrease from 6.1096 to 5.8826, saving to ./libcity/cache/1009/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-28 16:47:09 INFO     epoch complete!
2024-09-28 16:47:09 INFO     evaluating now!
2024-09-28 16:47:14 INFO     Epoch [9/200] train_loss: 5.3582, val_loss: 5.6294, lr: 0.003000, 37.50s
2024-09-28 16:47:14 INFO     Saved model at 9
2024-09-28 16:47:14 INFO     Val loss decrease from 5.8826 to 5.6294, saving to ./libcity/cache/1009/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-28 16:47:45 INFO     epoch complete!
2024-09-28 16:47:45 INFO     evaluating now!
2024-09-28 16:47:48 INFO     Epoch [10/200] train_loss: 5.2536, val_loss: 5.6326, lr: 0.003000, 34.46s
2024-09-28 16:48:21 INFO     epoch complete!
2024-09-28 16:48:21 INFO     evaluating now!
2024-09-28 16:48:25 INFO     Epoch [11/200] train_loss: 5.1148, val_loss: 5.6410, lr: 0.003000, 36.76s
2024-09-28 16:48:56 INFO     epoch complete!
2024-09-28 16:48:56 INFO     evaluating now!
2024-09-28 16:48:59 INFO     Epoch [12/200] train_loss: 5.0187, val_loss: 5.5221, lr: 0.003000, 34.10s
2024-09-28 16:49:00 INFO     Saved model at 12
2024-09-28 16:49:00 INFO     Val loss decrease from 5.6294 to 5.5221, saving to ./libcity/cache/1009/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-28 16:49:31 INFO     epoch complete!
2024-09-28 16:49:31 INFO     evaluating now!
2024-09-28 16:49:35 INFO     Epoch [13/200] train_loss: 4.8927, val_loss: 5.4438, lr: 0.003000, 35.58s
2024-09-28 16:49:35 INFO     Saved model at 13
2024-09-28 16:49:35 INFO     Val loss decrease from 5.5221 to 5.4438, saving to ./libcity/cache/1009/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-28 16:50:03 INFO     epoch complete!
2024-09-28 16:50:03 INFO     evaluating now!
2024-09-28 16:50:06 INFO     Epoch [14/200] train_loss: 4.7476, val_loss: 5.5049, lr: 0.003000, 30.91s
2024-09-28 16:50:34 INFO     epoch complete!
2024-09-28 16:50:34 INFO     evaluating now!
2024-09-28 16:50:38 INFO     Epoch [15/200] train_loss: 4.7084, val_loss: 5.2740, lr: 0.003000, 31.59s
2024-09-28 16:50:38 INFO     Saved model at 15
2024-09-28 16:50:38 INFO     Val loss decrease from 5.4438 to 5.2740, saving to ./libcity/cache/1009/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-28 16:51:09 INFO     epoch complete!
2024-09-28 16:51:09 INFO     evaluating now!
2024-09-28 16:51:13 INFO     Epoch [16/200] train_loss: 4.6918, val_loss: 5.3364, lr: 0.003000, 35.39s
2024-09-28 16:51:43 INFO     epoch complete!
2024-09-28 16:51:43 INFO     evaluating now!
2024-09-28 16:51:47 INFO     Epoch [17/200] train_loss: 4.5804, val_loss: 5.1883, lr: 0.003000, 33.52s
2024-09-28 16:51:47 INFO     Saved model at 17
2024-09-28 16:51:47 INFO     Val loss decrease from 5.2740 to 5.1883, saving to ./libcity/cache/1009/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-28 16:52:21 INFO     epoch complete!
2024-09-28 16:52:21 INFO     evaluating now!
2024-09-28 16:52:27 INFO     Epoch [18/200] train_loss: 4.4760, val_loss: 5.3881, lr: 0.003000, 39.60s
2024-09-28 16:53:00 INFO     epoch complete!
2024-09-28 16:53:00 INFO     evaluating now!
2024-09-28 16:53:04 INFO     Epoch [19/200] train_loss: 4.4157, val_loss: 5.2168, lr: 0.003000, 36.88s
2024-09-28 16:53:36 INFO     epoch complete!
2024-09-28 16:53:36 INFO     evaluating now!
2024-09-28 16:53:40 INFO     Epoch [20/200] train_loss: 4.3601, val_loss: 5.3103, lr: 0.003000, 36.39s
2024-09-28 16:54:10 INFO     epoch complete!
2024-09-28 16:54:10 INFO     evaluating now!
2024-09-28 16:54:14 INFO     Epoch [21/200] train_loss: 4.3547, val_loss: 5.1086, lr: 0.003000, 33.69s
2024-09-28 16:54:14 INFO     Saved model at 21
2024-09-28 16:54:14 INFO     Val loss decrease from 5.1883 to 5.1086, saving to ./libcity/cache/1009/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-28 16:54:43 INFO     epoch complete!
2024-09-28 16:54:43 INFO     evaluating now!
2024-09-28 16:54:46 INFO     Epoch [22/200] train_loss: 4.2864, val_loss: 5.4314, lr: 0.003000, 32.50s
2024-09-28 16:55:12 INFO     epoch complete!
2024-09-28 16:55:12 INFO     evaluating now!
2024-09-28 16:55:15 INFO     Epoch [23/200] train_loss: 4.2199, val_loss: 5.1357, lr: 0.003000, 28.68s
2024-09-28 16:55:41 INFO     epoch complete!
2024-09-28 16:55:41 INFO     evaluating now!
2024-09-28 16:55:45 INFO     Epoch [24/200] train_loss: 4.1679, val_loss: 5.1753, lr: 0.003000, 29.96s
2024-09-28 16:56:12 INFO     epoch complete!
2024-09-28 16:56:12 INFO     evaluating now!
2024-09-28 16:56:16 INFO     Epoch [25/200] train_loss: 4.1428, val_loss: 5.2261, lr: 0.003000, 30.98s
2024-09-28 16:56:43 INFO     epoch complete!
2024-09-28 16:56:43 INFO     evaluating now!
2024-09-28 16:56:46 INFO     Epoch [26/200] train_loss: 4.1051, val_loss: 5.3267, lr: 0.003000, 30.04s
2024-09-28 16:57:12 INFO     epoch complete!
2024-09-28 16:57:12 INFO     evaluating now!
2024-09-28 16:57:17 INFO     Epoch [27/200] train_loss: 4.0896, val_loss: 5.0915, lr: 0.003000, 31.09s
2024-09-28 16:57:17 INFO     Saved model at 27
2024-09-28 16:57:17 INFO     Val loss decrease from 5.1086 to 5.0915, saving to ./libcity/cache/1009/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-28 16:57:47 INFO     epoch complete!
2024-09-28 16:57:47 INFO     evaluating now!
2024-09-28 16:57:50 INFO     Epoch [28/200] train_loss: 4.0353, val_loss: 5.2072, lr: 0.003000, 33.08s
2024-09-28 16:58:19 INFO     epoch complete!
2024-09-28 16:58:19 INFO     evaluating now!
2024-09-28 16:58:23 INFO     Epoch [29/200] train_loss: 3.9780, val_loss: 5.1916, lr: 0.003000, 32.20s
2024-09-28 16:58:49 INFO     epoch complete!
2024-09-28 16:58:49 INFO     evaluating now!
2024-09-28 16:58:52 INFO     Epoch [30/200] train_loss: 3.9064, val_loss: 5.1493, lr: 0.003000, 28.82s
2024-09-28 16:59:19 INFO     epoch complete!
2024-09-28 16:59:19 INFO     evaluating now!
2024-09-28 16:59:23 INFO     Epoch [31/200] train_loss: 3.8930, val_loss: 5.1966, lr: 0.003000, 31.49s
2024-09-28 16:59:54 INFO     epoch complete!
2024-09-28 16:59:54 INFO     evaluating now!
2024-09-28 16:59:58 INFO     Epoch [32/200] train_loss: 3.8452, val_loss: 5.1503, lr: 0.003000, 35.05s
2024-09-28 17:00:27 INFO     epoch complete!
2024-09-28 17:00:27 INFO     evaluating now!
2024-09-28 17:00:30 INFO     Epoch [33/200] train_loss: 3.8435, val_loss: 5.1670, lr: 0.003000, 32.28s
2024-09-28 17:00:55 INFO     epoch complete!
2024-09-28 17:00:55 INFO     evaluating now!
2024-09-28 17:00:59 INFO     Epoch [34/200] train_loss: 3.7816, val_loss: 5.0096, lr: 0.003000, 28.51s
2024-09-28 17:00:59 INFO     Saved model at 34
2024-09-28 17:00:59 INFO     Val loss decrease from 5.0915 to 5.0096, saving to ./libcity/cache/1009/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-09-28 17:01:25 INFO     epoch complete!
2024-09-28 17:01:25 INFO     evaluating now!
2024-09-28 17:01:28 INFO     Epoch [35/200] train_loss: 3.7461, val_loss: 5.2194, lr: 0.003000, 28.65s
2024-09-28 17:01:54 INFO     epoch complete!
2024-09-28 17:01:54 INFO     evaluating now!
2024-09-28 17:01:57 INFO     Epoch [36/200] train_loss: 3.7551, val_loss: 5.1810, lr: 0.003000, 29.45s
2024-09-28 17:02:24 INFO     epoch complete!
2024-09-28 17:02:24 INFO     evaluating now!
2024-09-28 17:02:28 INFO     Epoch [37/200] train_loss: 3.7026, val_loss: 5.1991, lr: 0.003000, 31.12s
2024-09-28 17:03:02 INFO     epoch complete!
2024-09-28 17:03:02 INFO     evaluating now!
2024-09-28 17:03:05 INFO     Epoch [38/200] train_loss: 3.6724, val_loss: 5.1076, lr: 0.003000, 37.18s
2024-09-28 17:03:32 INFO     epoch complete!
2024-09-28 17:03:32 INFO     evaluating now!
2024-09-28 17:03:37 INFO     Epoch [39/200] train_loss: 3.6845, val_loss: 5.1442, lr: 0.003000, 31.15s
2024-09-28 17:04:08 INFO     epoch complete!
2024-09-28 17:04:08 INFO     evaluating now!
2024-09-28 17:04:11 INFO     Epoch [40/200] train_loss: 3.6395, val_loss: 5.0734, lr: 0.003000, 34.83s
2024-09-28 17:04:45 INFO     epoch complete!
2024-09-28 17:04:45 INFO     evaluating now!
2024-09-28 17:04:49 INFO     Epoch [41/200] train_loss: 3.6293, val_loss: 5.1095, lr: 0.003000, 37.62s
2024-09-28 17:05:21 INFO     epoch complete!
2024-09-28 17:05:21 INFO     evaluating now!
2024-09-28 17:05:24 INFO     Epoch [42/200] train_loss: 3.6050, val_loss: 5.1593, lr: 0.003000, 34.62s
2024-09-28 17:05:53 INFO     epoch complete!
2024-09-28 17:05:53 INFO     evaluating now!
2024-09-28 17:05:57 INFO     Epoch [43/200] train_loss: 3.6467, val_loss: 5.2525, lr: 0.003000, 32.90s
2024-09-28 17:06:30 INFO     epoch complete!
2024-09-28 17:06:30 INFO     evaluating now!
2024-09-28 17:06:33 INFO     Epoch [44/200] train_loss: 3.5613, val_loss: 5.1491, lr: 0.003000, 36.89s
2024-09-28 17:07:04 INFO     epoch complete!
2024-09-28 17:07:04 INFO     evaluating now!
2024-09-28 17:07:08 INFO     Epoch [45/200] train_loss: 3.6251, val_loss: 5.1003, lr: 0.003000, 34.58s
2024-09-28 17:07:43 INFO     epoch complete!
2024-09-28 17:07:43 INFO     evaluating now!
2024-09-28 17:07:47 INFO     Epoch [46/200] train_loss: 3.5602, val_loss: 5.1510, lr: 0.003000, 38.91s
2024-09-28 17:08:19 INFO     epoch complete!
2024-09-28 17:08:19 INFO     evaluating now!
2024-09-28 17:08:23 INFO     Epoch [47/200] train_loss: 3.5365, val_loss: 5.1461, lr: 0.003000, 36.08s
2024-09-28 17:08:51 INFO     epoch complete!
2024-09-28 17:08:51 INFO     evaluating now!
2024-09-28 17:08:55 INFO     Epoch [48/200] train_loss: 3.5076, val_loss: 5.1163, lr: 0.003000, 31.54s
2024-09-28 17:09:24 INFO     epoch complete!
2024-09-28 17:09:24 INFO     evaluating now!
2024-09-28 17:09:27 INFO     Epoch [49/200] train_loss: 3.4652, val_loss: 5.0924, lr: 0.003000, 32.76s
2024-09-28 17:09:27 WARNING  Early stopping at epoch: 49
2024-09-28 17:09:27 INFO     Trained totally 50 epochs, average train time is 29.946s, average eval time is 3.894s
2024-09-28 17:09:28 INFO     Loaded model at 34
2024-09-28 17:09:28 INFO     Saved model at ./libcity/cache/1009/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 17:09:28 INFO     Start evaluating ...
2024-09-28 17:09:36 INFO     Note that you select the single mode to evaluate!
2024-09-28 17:09:36 INFO     Evaluate result is saved at ./libcity/cache/1009/evaluate_cache/2024_09_28_17_09_36_AGCRN_CHITaxi20190406.csv
2024-09-28 17:09:36 INFO     
         MAE       RMSE  masked_MAPE
1   2.328605   7.196918     0.423425
2   2.387945   7.517574     0.414751
3   2.615193   8.481995     0.429647
4   2.754029   9.491249     0.425842
5   2.964720  10.709935     0.434954
6   3.106758  11.711675     0.434753
7   3.183249  12.476568     0.446910
8   3.240690  12.931012     0.458034
9   3.241438  13.127873     0.452706
10  3.307658  13.267429     0.470769
11  3.390303  13.408244     0.478596
12  3.424751  13.756507     0.479972
2024-09-28 17:09:36 INFO     ----------------------------------------------------------------------------
2024-09-28 17:09:36 INFO     Kownledge Graph Embedding: TransE, Experiment ids: [1005, 1006, 1007, 1008, 1009]
2024-09-28 17:09:36 INFO     ----------------------------------------------------------------------------
2024-09-28 17:09:36 INFO     Average: 
         MAE       RMSE  masked_MAPE
0   2.349605   7.224487     0.423293
1   2.418181   7.594840     0.422983
2   2.641687   8.731731     0.428954
3   2.818958   9.837516     0.426034
4   3.003308  10.981562     0.433391
5   3.115536  11.841506     0.435208
6   3.194408  12.520860     0.441890
7   3.241537  12.940548     0.446393
8   3.282981  13.179218     0.452333
9   3.309791  13.396955     0.452816
10  3.377555  13.729446     0.462056
11  3.500717  14.336386     0.469394 
2024-09-28 17:09:36 INFO     Standard deviation: 
         MAE      RMSE  masked_MAPE
0   0.073681  0.367456     0.012686
1   0.057170  0.121997     0.011227
2   0.067003  0.159676     0.009505
3   0.084096  0.331553     0.011239
4   0.103587  0.549661     0.011305
5   0.098766  0.809559     0.010861
6   0.132552  0.884285     0.014819
7   0.111674  0.787228     0.008289
8   0.103231  0.555488     0.008078
9   0.086861  0.402623     0.011344
10  0.077414  0.451664     0.011064
11  0.067385  0.544126     0.007282
2024-09-28 17:09:36 INFO     ----------------------------------------------------------------------------
2024-09-28 17:09:36 INFO     12 steps Average: 
        MAE       RMSE  masked_MAPE
0  3.021189  11.359588     0.441229
2024-09-28 17:09:36 INFO     12 steps Standard deviation: 
        MAE     RMSE  masked_MAPE
0  0.088618  0.49711     0.010642
