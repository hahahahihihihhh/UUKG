2024-09-28 15:45:02 INFO     Saving logs in: ./logs/CHITaxi20190406/AGCRN/MultiHop/GIE
2024-09-28 15:45:03 INFO     ----------------------------------------------------------------------------
2024-09-28 15:45:03 INFO     # 0, Kownledge Graph Embedding: GIE, Experiment ids: 1000
2024-09-28 15:45:03 INFO     ----------------------------------------------------------------------------
2024-09-28 15:45:03 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=1000
2024-09-28 15:45:03 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 1000, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'MultiHop', 'max_hop': 1, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 15:45:03 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 15:45:03 INFO     set_weight_link_or_dist: dist
2024-09-28 15:45:03 INFO     init_weight_inf_or_zero: inf
2024-09-28 15:45:03 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 15:45:03 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 15:45:03 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 15:45:03 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 15:45:03 INFO     Dataset created
2024-09-28 15:45:03 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-28 15:45:03 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-28 15:45:03 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-28 15:45:03 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-28 15:45:03 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 15:45:03 INFO     NoneScaler
2024-09-28 15:45:12 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 15:45:12 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 15:45:12 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 15:45:12 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 15:45:12 INFO     encoder.dcrnn_cells.0.gate.weights_pool2	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 15:45:12 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 15:45:12 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 15:45:12 INFO     encoder.dcrnn_cells.0.update.weights_pool2	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 15:45:12 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 15:45:12 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 15:45:12 INFO     encoder.dcrnn_cells.1.gate.weights_pool2	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 15:45:12 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 15:45:12 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 15:45:12 INFO     encoder.dcrnn_cells.1.update.weights_pool2	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 15:45:12 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 15:45:12 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 15:45:12 INFO     Total parameter numbers: 1496090
2024-09-28 15:45:12 INFO     You select `adam` optimizer.
2024-09-28 15:45:12 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 15:45:12 INFO     Start training ...
2024-09-28 15:45:12 INFO     num_batches:48
2024-09-28 15:45:36 INFO     epoch complete!
2024-09-28 15:45:36 INFO     evaluating now!
2024-09-28 15:45:38 INFO     Epoch [0/200] train_loss: 22.1386, val_loss: 16.5486, lr: 0.003000, 26.35s
2024-09-28 15:45:39 INFO     Saved model at 0
2024-09-28 15:45:39 INFO     Val loss decrease from inf to 16.5486, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 15:46:00 INFO     epoch complete!
2024-09-28 15:46:00 INFO     evaluating now!
2024-09-28 15:46:03 INFO     Epoch [1/200] train_loss: 13.3928, val_loss: 12.8826, lr: 0.003000, 24.57s
2024-09-28 15:46:03 INFO     Saved model at 1
2024-09-28 15:46:03 INFO     Val loss decrease from 16.5486 to 12.8826, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 15:46:25 INFO     epoch complete!
2024-09-28 15:46:25 INFO     evaluating now!
2024-09-28 15:46:28 INFO     Epoch [2/200] train_loss: 10.6436, val_loss: 10.0836, lr: 0.003000, 24.70s
2024-09-28 15:46:28 INFO     Saved model at 2
2024-09-28 15:46:28 INFO     Val loss decrease from 12.8826 to 10.0836, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 15:46:51 INFO     epoch complete!
2024-09-28 15:46:51 INFO     evaluating now!
2024-09-28 15:46:54 INFO     Epoch [3/200] train_loss: 8.5476, val_loss: 8.1703, lr: 0.003000, 26.27s
2024-09-28 15:46:55 INFO     Saved model at 3
2024-09-28 15:46:55 INFO     Val loss decrease from 10.0836 to 8.1703, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 15:47:19 INFO     epoch complete!
2024-09-28 15:47:19 INFO     evaluating now!
2024-09-28 15:47:22 INFO     Epoch [4/200] train_loss: 7.2806, val_loss: 7.1231, lr: 0.003000, 27.72s
2024-09-28 15:47:22 INFO     Saved model at 4
2024-09-28 15:47:22 INFO     Val loss decrease from 8.1703 to 7.1231, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 15:47:47 INFO     epoch complete!
2024-09-28 15:47:47 INFO     evaluating now!
2024-09-28 15:47:50 INFO     Epoch [5/200] train_loss: 6.5833, val_loss: 6.7853, lr: 0.003000, 27.18s
2024-09-28 15:47:50 INFO     Saved model at 5
2024-09-28 15:47:50 INFO     Val loss decrease from 7.1231 to 6.7853, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 15:48:14 INFO     epoch complete!
2024-09-28 15:48:14 INFO     evaluating now!
2024-09-28 15:48:17 INFO     Epoch [6/200] train_loss: 6.2415, val_loss: 6.3488, lr: 0.003000, 26.92s
2024-09-28 15:48:17 INFO     Saved model at 6
2024-09-28 15:48:17 INFO     Val loss decrease from 6.7853 to 6.3488, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-28 15:48:40 INFO     epoch complete!
2024-09-28 15:48:40 INFO     evaluating now!
2024-09-28 15:48:42 INFO     Epoch [7/200] train_loss: 5.8782, val_loss: 6.2171, lr: 0.003000, 25.32s
2024-09-28 15:48:42 INFO     Saved model at 7
2024-09-28 15:48:42 INFO     Val loss decrease from 6.3488 to 6.2171, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-28 15:49:07 INFO     epoch complete!
2024-09-28 15:49:07 INFO     evaluating now!
2024-09-28 15:49:09 INFO     Epoch [8/200] train_loss: 5.7505, val_loss: 6.0141, lr: 0.003000, 26.97s
2024-09-28 15:49:10 INFO     Saved model at 8
2024-09-28 15:49:10 INFO     Val loss decrease from 6.2171 to 6.0141, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-28 15:49:32 INFO     epoch complete!
2024-09-28 15:49:32 INFO     evaluating now!
2024-09-28 15:49:35 INFO     Epoch [9/200] train_loss: 5.5090, val_loss: 5.7985, lr: 0.003000, 25.36s
2024-09-28 15:49:35 INFO     Saved model at 9
2024-09-28 15:49:35 INFO     Val loss decrease from 6.0141 to 5.7985, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-28 15:49:59 INFO     epoch complete!
2024-09-28 15:49:59 INFO     evaluating now!
2024-09-28 15:50:03 INFO     Epoch [10/200] train_loss: 5.3019, val_loss: 5.7890, lr: 0.003000, 27.85s
2024-09-28 15:50:03 INFO     Saved model at 10
2024-09-28 15:50:03 INFO     Val loss decrease from 5.7985 to 5.7890, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-28 15:50:32 INFO     epoch complete!
2024-09-28 15:50:32 INFO     evaluating now!
2024-09-28 15:50:36 INFO     Epoch [11/200] train_loss: 5.3180, val_loss: 5.9328, lr: 0.003000, 32.31s
2024-09-28 15:51:00 INFO     epoch complete!
2024-09-28 15:51:00 INFO     evaluating now!
2024-09-28 15:51:03 INFO     Epoch [12/200] train_loss: 5.1642, val_loss: 5.6680, lr: 0.003000, 27.91s
2024-09-28 15:51:04 INFO     Saved model at 12
2024-09-28 15:51:04 INFO     Val loss decrease from 5.7890 to 5.6680, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-28 15:51:29 INFO     epoch complete!
2024-09-28 15:51:29 INFO     evaluating now!
2024-09-28 15:51:32 INFO     Epoch [13/200] train_loss: 5.0246, val_loss: 5.8821, lr: 0.003000, 28.65s
2024-09-28 15:51:56 INFO     epoch complete!
2024-09-28 15:51:56 INFO     evaluating now!
2024-09-28 15:51:59 INFO     Epoch [14/200] train_loss: 4.9240, val_loss: 5.5889, lr: 0.003000, 27.09s
2024-09-28 15:52:00 INFO     Saved model at 14
2024-09-28 15:52:00 INFO     Val loss decrease from 5.6680 to 5.5889, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-28 15:52:24 INFO     epoch complete!
2024-09-28 15:52:24 INFO     evaluating now!
2024-09-28 15:52:27 INFO     Epoch [15/200] train_loss: 4.8547, val_loss: 5.5194, lr: 0.003000, 27.58s
2024-09-28 15:52:27 INFO     Saved model at 15
2024-09-28 15:52:27 INFO     Val loss decrease from 5.5889 to 5.5194, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-28 15:52:52 INFO     epoch complete!
2024-09-28 15:52:52 INFO     evaluating now!
2024-09-28 15:52:55 INFO     Epoch [16/200] train_loss: 4.7438, val_loss: 5.5895, lr: 0.003000, 27.53s
2024-09-28 15:53:18 INFO     epoch complete!
2024-09-28 15:53:18 INFO     evaluating now!
2024-09-28 15:53:21 INFO     Epoch [17/200] train_loss: 4.6331, val_loss: 5.4530, lr: 0.003000, 26.40s
2024-09-28 15:53:22 INFO     Saved model at 17
2024-09-28 15:53:22 INFO     Val loss decrease from 5.5194 to 5.4530, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-28 15:53:47 INFO     epoch complete!
2024-09-28 15:53:47 INFO     evaluating now!
2024-09-28 15:53:49 INFO     Epoch [18/200] train_loss: 4.5501, val_loss: 5.3369, lr: 0.003000, 27.50s
2024-09-28 15:53:49 INFO     Saved model at 18
2024-09-28 15:53:49 INFO     Val loss decrease from 5.4530 to 5.3369, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-28 15:54:13 INFO     epoch complete!
2024-09-28 15:54:13 INFO     evaluating now!
2024-09-28 15:54:16 INFO     Epoch [19/200] train_loss: 4.5297, val_loss: 5.4041, lr: 0.003000, 27.07s
2024-09-28 15:54:41 INFO     epoch complete!
2024-09-28 15:54:41 INFO     evaluating now!
2024-09-28 15:54:44 INFO     Epoch [20/200] train_loss: 4.4127, val_loss: 5.2150, lr: 0.003000, 27.21s
2024-09-28 15:54:44 INFO     Saved model at 20
2024-09-28 15:54:44 INFO     Val loss decrease from 5.3369 to 5.2150, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-28 15:55:08 INFO     epoch complete!
2024-09-28 15:55:08 INFO     evaluating now!
2024-09-28 15:55:11 INFO     Epoch [21/200] train_loss: 4.3999, val_loss: 5.4448, lr: 0.003000, 27.46s
2024-09-28 15:55:35 INFO     epoch complete!
2024-09-28 15:55:35 INFO     evaluating now!
2024-09-28 15:55:37 INFO     Epoch [22/200] train_loss: 4.3118, val_loss: 5.2964, lr: 0.003000, 26.11s
2024-09-28 15:56:01 INFO     epoch complete!
2024-09-28 15:56:01 INFO     evaluating now!
2024-09-28 15:56:04 INFO     Epoch [23/200] train_loss: 4.2997, val_loss: 5.4328, lr: 0.003000, 26.53s
2024-09-28 15:56:29 INFO     epoch complete!
2024-09-28 15:56:29 INFO     evaluating now!
2024-09-28 15:56:32 INFO     Epoch [24/200] train_loss: 4.2289, val_loss: 5.3344, lr: 0.003000, 28.08s
2024-09-28 15:56:58 INFO     epoch complete!
2024-09-28 15:56:58 INFO     evaluating now!
2024-09-28 15:57:02 INFO     Epoch [25/200] train_loss: 4.1529, val_loss: 5.4678, lr: 0.003000, 29.74s
2024-09-28 15:57:25 INFO     epoch complete!
2024-09-28 15:57:25 INFO     evaluating now!
2024-09-28 15:57:28 INFO     Epoch [26/200] train_loss: 4.1130, val_loss: 5.2184, lr: 0.003000, 26.51s
2024-09-28 15:57:54 INFO     epoch complete!
2024-09-28 15:57:54 INFO     evaluating now!
2024-09-28 15:57:57 INFO     Epoch [27/200] train_loss: 4.0855, val_loss: 5.4515, lr: 0.003000, 28.26s
2024-09-28 15:58:22 INFO     epoch complete!
2024-09-28 15:58:22 INFO     evaluating now!
2024-09-28 15:58:25 INFO     Epoch [28/200] train_loss: 4.0631, val_loss: 5.2494, lr: 0.003000, 28.56s
2024-09-28 15:58:50 INFO     epoch complete!
2024-09-28 15:58:50 INFO     evaluating now!
2024-09-28 15:58:53 INFO     Epoch [29/200] train_loss: 4.0347, val_loss: 5.2261, lr: 0.003000, 27.72s
2024-09-28 15:59:16 INFO     epoch complete!
2024-09-28 15:59:16 INFO     evaluating now!
2024-09-28 15:59:19 INFO     Epoch [30/200] train_loss: 4.0151, val_loss: 5.2347, lr: 0.003000, 26.60s
2024-09-28 15:59:46 INFO     epoch complete!
2024-09-28 15:59:46 INFO     evaluating now!
2024-09-28 15:59:49 INFO     Epoch [31/200] train_loss: 3.9120, val_loss: 5.2925, lr: 0.003000, 29.56s
2024-09-28 16:00:16 INFO     epoch complete!
2024-09-28 16:00:16 INFO     evaluating now!
2024-09-28 16:00:20 INFO     Epoch [32/200] train_loss: 3.9160, val_loss: 5.3788, lr: 0.003000, 31.08s
2024-09-28 16:00:44 INFO     epoch complete!
2024-09-28 16:00:44 INFO     evaluating now!
2024-09-28 16:00:48 INFO     Epoch [33/200] train_loss: 3.8555, val_loss: 5.3730, lr: 0.003000, 27.44s
2024-09-28 16:01:14 INFO     epoch complete!
2024-09-28 16:01:14 INFO     evaluating now!
2024-09-28 16:01:17 INFO     Epoch [34/200] train_loss: 3.8249, val_loss: 5.2258, lr: 0.003000, 29.30s
2024-09-28 16:01:45 INFO     epoch complete!
2024-09-28 16:01:45 INFO     evaluating now!
2024-09-28 16:01:49 INFO     Epoch [35/200] train_loss: 3.7540, val_loss: 5.1248, lr: 0.003000, 31.75s
2024-09-28 16:01:49 INFO     Saved model at 35
2024-09-28 16:01:49 INFO     Val loss decrease from 5.2150 to 5.1248, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-28 16:02:17 INFO     epoch complete!
2024-09-28 16:02:17 INFO     evaluating now!
2024-09-28 16:02:20 INFO     Epoch [36/200] train_loss: 3.7373, val_loss: 5.2692, lr: 0.003000, 31.64s
2024-09-28 16:02:46 INFO     epoch complete!
2024-09-28 16:02:46 INFO     evaluating now!
2024-09-28 16:02:49 INFO     Epoch [37/200] train_loss: 3.7365, val_loss: 5.1489, lr: 0.003000, 28.58s
2024-09-28 16:03:18 INFO     epoch complete!
2024-09-28 16:03:18 INFO     evaluating now!
2024-09-28 16:03:21 INFO     Epoch [38/200] train_loss: 3.7132, val_loss: 5.3066, lr: 0.003000, 32.39s
2024-09-28 16:03:51 INFO     epoch complete!
2024-09-28 16:03:51 INFO     evaluating now!
2024-09-28 16:03:56 INFO     Epoch [39/200] train_loss: 3.6910, val_loss: 5.2976, lr: 0.003000, 34.19s
2024-09-28 16:04:30 INFO     epoch complete!
2024-09-28 16:04:30 INFO     evaluating now!
2024-09-28 16:04:34 INFO     Epoch [40/200] train_loss: 3.6652, val_loss: 5.2079, lr: 0.003000, 38.16s
2024-09-28 16:05:09 INFO     epoch complete!
2024-09-28 16:05:09 INFO     evaluating now!
2024-09-28 16:05:14 INFO     Epoch [41/200] train_loss: 3.6152, val_loss: 5.1197, lr: 0.003000, 40.42s
2024-09-28 16:05:14 INFO     Saved model at 41
2024-09-28 16:05:14 INFO     Val loss decrease from 5.1248 to 5.1197, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-09-28 16:05:44 INFO     epoch complete!
2024-09-28 16:05:44 INFO     evaluating now!
2024-09-28 16:05:49 INFO     Epoch [42/200] train_loss: 3.5820, val_loss: 5.1018, lr: 0.003000, 35.01s
2024-09-28 16:05:50 INFO     Saved model at 42
2024-09-28 16:05:50 INFO     Val loss decrease from 5.1197 to 5.1018, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-09-28 16:06:19 INFO     epoch complete!
2024-09-28 16:06:19 INFO     evaluating now!
2024-09-28 16:06:23 INFO     Epoch [43/200] train_loss: 3.6636, val_loss: 5.0452, lr: 0.003000, 33.04s
2024-09-28 16:06:23 INFO     Saved model at 43
2024-09-28 16:06:23 INFO     Val loss decrease from 5.1018 to 5.0452, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-09-28 16:06:53 INFO     epoch complete!
2024-09-28 16:06:53 INFO     evaluating now!
2024-09-28 16:06:57 INFO     Epoch [44/200] train_loss: 3.5505, val_loss: 5.1645, lr: 0.003000, 34.53s
2024-09-28 16:07:28 INFO     epoch complete!
2024-09-28 16:07:28 INFO     evaluating now!
2024-09-28 16:07:31 INFO     Epoch [45/200] train_loss: 3.5128, val_loss: 4.9951, lr: 0.003000, 33.59s
2024-09-28 16:07:31 INFO     Saved model at 45
2024-09-28 16:07:31 INFO     Val loss decrease from 5.0452 to 4.9951, saving to ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-09-28 16:08:00 INFO     epoch complete!
2024-09-28 16:08:00 INFO     evaluating now!
2024-09-28 16:08:03 INFO     Epoch [46/200] train_loss: 3.4960, val_loss: 5.1527, lr: 0.003000, 31.61s
2024-09-28 16:08:29 INFO     epoch complete!
2024-09-28 16:08:29 INFO     evaluating now!
2024-09-28 16:08:33 INFO     Epoch [47/200] train_loss: 3.5048, val_loss: 5.1487, lr: 0.003000, 29.96s
2024-09-28 16:09:00 INFO     epoch complete!
2024-09-28 16:09:00 INFO     evaluating now!
2024-09-28 16:09:03 INFO     Epoch [48/200] train_loss: 3.4398, val_loss: 5.1878, lr: 0.003000, 30.19s
2024-09-28 16:09:31 INFO     epoch complete!
2024-09-28 16:09:31 INFO     evaluating now!
2024-09-28 16:09:34 INFO     Epoch [49/200] train_loss: 3.4199, val_loss: 5.1998, lr: 0.003000, 30.68s
2024-09-28 16:10:03 INFO     epoch complete!
2024-09-28 16:10:03 INFO     evaluating now!
2024-09-28 16:10:06 INFO     Epoch [50/200] train_loss: 3.4337, val_loss: 5.2389, lr: 0.003000, 32.53s
2024-09-28 16:10:39 INFO     epoch complete!
2024-09-28 16:10:39 INFO     evaluating now!
2024-09-28 16:10:44 INFO     Epoch [51/200] train_loss: 3.4177, val_loss: 5.2625, lr: 0.003000, 37.92s
2024-09-28 16:11:16 INFO     epoch complete!
2024-09-28 16:11:16 INFO     evaluating now!
2024-09-28 16:11:20 INFO     Epoch [52/200] train_loss: 3.3687, val_loss: 5.0636, lr: 0.003000, 35.62s
2024-09-28 16:11:48 INFO     epoch complete!
2024-09-28 16:11:48 INFO     evaluating now!
2024-09-28 16:11:52 INFO     Epoch [53/200] train_loss: 3.3892, val_loss: 5.2055, lr: 0.003000, 31.99s
2024-09-28 16:12:20 INFO     epoch complete!
2024-09-28 16:12:20 INFO     evaluating now!
2024-09-28 16:12:24 INFO     Epoch [54/200] train_loss: 3.3607, val_loss: 5.2118, lr: 0.003000, 31.87s
2024-09-28 16:12:55 INFO     epoch complete!
2024-09-28 16:12:55 INFO     evaluating now!
2024-09-28 16:12:58 INFO     Epoch [55/200] train_loss: 3.3401, val_loss: 5.1601, lr: 0.003000, 34.43s
2024-09-28 16:13:26 INFO     epoch complete!
2024-09-28 16:13:26 INFO     evaluating now!
2024-09-28 16:13:30 INFO     Epoch [56/200] train_loss: 3.3269, val_loss: 5.1514, lr: 0.003000, 32.20s
2024-09-28 16:14:01 INFO     epoch complete!
2024-09-28 16:14:01 INFO     evaluating now!
2024-09-28 16:14:06 INFO     Epoch [57/200] train_loss: 3.3050, val_loss: 5.1777, lr: 0.003000, 36.22s
2024-09-28 16:14:34 INFO     epoch complete!
2024-09-28 16:14:34 INFO     evaluating now!
2024-09-28 16:14:38 INFO     Epoch [58/200] train_loss: 3.3166, val_loss: 5.2640, lr: 0.003000, 31.45s
2024-09-28 16:15:04 INFO     epoch complete!
2024-09-28 16:15:04 INFO     evaluating now!
2024-09-28 16:15:07 INFO     Epoch [59/200] train_loss: 3.2683, val_loss: 5.2737, lr: 0.003000, 28.66s
2024-09-28 16:15:30 INFO     epoch complete!
2024-09-28 16:15:30 INFO     evaluating now!
2024-09-28 16:15:33 INFO     Epoch [60/200] train_loss: 3.3000, val_loss: 5.2021, lr: 0.003000, 26.50s
2024-09-28 16:15:33 WARNING  Early stopping at epoch: 60
2024-09-28 16:15:33 INFO     Trained totally 61 epochs, average train time is 26.416s, average eval time is 3.363s
2024-09-28 16:15:33 INFO     Loaded model at 45
2024-09-28 16:15:33 INFO     Saved model at ./libcity/cache/1000/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 16:15:33 INFO     Start evaluating ...
2024-09-28 16:15:40 INFO     Note that you select the single mode to evaluate!
2024-09-28 16:15:40 INFO     Evaluate result is saved at ./libcity/cache/1000/evaluate_cache/2024_09_28_16_15_40_AGCRN_CHITaxi20190406.csv
2024-09-28 16:15:40 INFO     
         MAE       RMSE  masked_MAPE
1   2.443075   7.900915     0.408833
2   2.543473   8.343087     0.405222
3   2.693019   9.049295     0.420717
4   2.757043   9.715169     0.414069
5   2.921429  10.750360     0.412060
6   3.074569  11.918052     0.416982
7   3.193377  12.871794     0.421892
8   3.234186  13.359978     0.426654
9   3.243920  13.292755     0.432772
10  3.270840  13.147706     0.449527
11  3.236360  13.020489     0.445051
12  3.322155  13.291494     0.454897
2024-09-28 16:15:40 INFO     ----------------------------------------------------------------------------
2024-09-28 16:15:40 INFO     # 1, Kownledge Graph Embedding: GIE, Experiment ids: 1001
2024-09-28 16:15:40 INFO     ----------------------------------------------------------------------------
2024-09-28 16:15:40 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=1001
2024-09-28 16:15:40 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 1001, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'MultiHop', 'max_hop': 1, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 16:15:40 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 16:15:40 INFO     set_weight_link_or_dist: dist
2024-09-28 16:15:40 INFO     init_weight_inf_or_zero: inf
2024-09-28 16:15:40 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 16:15:40 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 16:15:40 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 16:15:40 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 16:15:40 INFO     Dataset created
2024-09-28 16:15:40 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-28 16:15:40 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-28 16:15:40 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-28 16:15:40 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-28 16:15:40 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 16:15:40 INFO     NoneScaler
2024-09-28 16:15:41 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 16:15:41 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 16:15:41 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 16:15:41 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 16:15:41 INFO     encoder.dcrnn_cells.0.gate.weights_pool2	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 16:15:41 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 16:15:41 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 16:15:41 INFO     encoder.dcrnn_cells.0.update.weights_pool2	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 16:15:41 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 16:15:41 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 16:15:41 INFO     encoder.dcrnn_cells.1.gate.weights_pool2	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 16:15:41 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 16:15:41 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 16:15:41 INFO     encoder.dcrnn_cells.1.update.weights_pool2	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 16:15:41 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 16:15:41 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 16:15:41 INFO     Total parameter numbers: 1496090
2024-09-28 16:15:41 INFO     You select `adam` optimizer.
2024-09-28 16:15:41 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 16:15:41 INFO     Start training ...
2024-09-28 16:15:41 INFO     num_batches:48
2024-09-28 16:16:04 INFO     epoch complete!
2024-09-28 16:16:04 INFO     evaluating now!
2024-09-28 16:16:07 INFO     Epoch [0/200] train_loss: 23.5874, val_loss: 17.7984, lr: 0.003000, 26.74s
2024-09-28 16:16:08 INFO     Saved model at 0
2024-09-28 16:16:08 INFO     Val loss decrease from inf to 17.7984, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 16:16:32 INFO     epoch complete!
2024-09-28 16:16:32 INFO     evaluating now!
2024-09-28 16:16:34 INFO     Epoch [1/200] train_loss: 14.3675, val_loss: 14.2611, lr: 0.003000, 26.78s
2024-09-28 16:16:35 INFO     Saved model at 1
2024-09-28 16:16:35 INFO     Val loss decrease from 17.7984 to 14.2611, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 16:16:58 INFO     epoch complete!
2024-09-28 16:16:58 INFO     evaluating now!
2024-09-28 16:17:01 INFO     Epoch [2/200] train_loss: 11.6478, val_loss: 11.8516, lr: 0.003000, 26.11s
2024-09-28 16:17:01 INFO     Saved model at 2
2024-09-28 16:17:01 INFO     Val loss decrease from 14.2611 to 11.8516, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 16:17:28 INFO     epoch complete!
2024-09-28 16:17:28 INFO     evaluating now!
2024-09-28 16:17:31 INFO     Epoch [3/200] train_loss: 9.8607, val_loss: 10.2038, lr: 0.003000, 29.58s
2024-09-28 16:17:31 INFO     Saved model at 3
2024-09-28 16:17:31 INFO     Val loss decrease from 11.8516 to 10.2038, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 16:17:54 INFO     epoch complete!
2024-09-28 16:17:54 INFO     evaluating now!
2024-09-28 16:17:57 INFO     Epoch [4/200] train_loss: 8.6367, val_loss: 8.7663, lr: 0.003000, 26.26s
2024-09-28 16:17:57 INFO     Saved model at 4
2024-09-28 16:17:57 INFO     Val loss decrease from 10.2038 to 8.7663, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 16:18:20 INFO     epoch complete!
2024-09-28 16:18:20 INFO     evaluating now!
2024-09-28 16:18:23 INFO     Epoch [5/200] train_loss: 7.6740, val_loss: 8.0176, lr: 0.003000, 25.57s
2024-09-28 16:18:23 INFO     Saved model at 5
2024-09-28 16:18:23 INFO     Val loss decrease from 8.7663 to 8.0176, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 16:18:45 INFO     epoch complete!
2024-09-28 16:18:45 INFO     evaluating now!
2024-09-28 16:18:47 INFO     Epoch [6/200] train_loss: 6.9547, val_loss: 7.2067, lr: 0.003000, 24.70s
2024-09-28 16:18:48 INFO     Saved model at 6
2024-09-28 16:18:48 INFO     Val loss decrease from 8.0176 to 7.2067, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-28 16:19:13 INFO     epoch complete!
2024-09-28 16:19:13 INFO     evaluating now!
2024-09-28 16:19:16 INFO     Epoch [7/200] train_loss: 6.4489, val_loss: 6.8168, lr: 0.003000, 28.49s
2024-09-28 16:19:17 INFO     Saved model at 7
2024-09-28 16:19:17 INFO     Val loss decrease from 7.2067 to 6.8168, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-28 16:19:41 INFO     epoch complete!
2024-09-28 16:19:41 INFO     evaluating now!
2024-09-28 16:19:44 INFO     Epoch [8/200] train_loss: 6.1318, val_loss: 6.4871, lr: 0.003000, 27.13s
2024-09-28 16:19:44 INFO     Saved model at 8
2024-09-28 16:19:44 INFO     Val loss decrease from 6.8168 to 6.4871, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-28 16:20:12 INFO     epoch complete!
2024-09-28 16:20:12 INFO     evaluating now!
2024-09-28 16:20:15 INFO     Epoch [9/200] train_loss: 5.9329, val_loss: 6.2984, lr: 0.003000, 31.40s
2024-09-28 16:20:16 INFO     Saved model at 9
2024-09-28 16:20:16 INFO     Val loss decrease from 6.4871 to 6.2984, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-28 16:20:39 INFO     epoch complete!
2024-09-28 16:20:39 INFO     evaluating now!
2024-09-28 16:20:42 INFO     Epoch [10/200] train_loss: 5.7407, val_loss: 6.1382, lr: 0.003000, 26.13s
2024-09-28 16:20:42 INFO     Saved model at 10
2024-09-28 16:20:42 INFO     Val loss decrease from 6.2984 to 6.1382, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-28 16:21:05 INFO     epoch complete!
2024-09-28 16:21:05 INFO     evaluating now!
2024-09-28 16:21:08 INFO     Epoch [11/200] train_loss: 5.4430, val_loss: 5.9332, lr: 0.003000, 25.99s
2024-09-28 16:21:08 INFO     Saved model at 11
2024-09-28 16:21:08 INFO     Val loss decrease from 6.1382 to 5.9332, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-28 16:21:35 INFO     epoch complete!
2024-09-28 16:21:35 INFO     evaluating now!
2024-09-28 16:21:39 INFO     Epoch [12/200] train_loss: 5.3973, val_loss: 6.1671, lr: 0.003000, 31.43s
2024-09-28 16:22:09 INFO     epoch complete!
2024-09-28 16:22:09 INFO     evaluating now!
2024-09-28 16:22:13 INFO     Epoch [13/200] train_loss: 5.2375, val_loss: 5.9865, lr: 0.003000, 33.64s
2024-09-28 16:22:44 INFO     epoch complete!
2024-09-28 16:22:44 INFO     evaluating now!
2024-09-28 16:22:47 INFO     Epoch [14/200] train_loss: 5.1684, val_loss: 6.2689, lr: 0.003000, 33.89s
2024-09-28 16:23:17 INFO     epoch complete!
2024-09-28 16:23:17 INFO     evaluating now!
2024-09-28 16:23:21 INFO     Epoch [15/200] train_loss: 5.2296, val_loss: 6.0470, lr: 0.003000, 34.12s
2024-09-28 16:23:48 INFO     epoch complete!
2024-09-28 16:23:48 INFO     evaluating now!
2024-09-28 16:23:51 INFO     Epoch [16/200] train_loss: 4.9186, val_loss: 5.5799, lr: 0.003000, 29.79s
2024-09-28 16:23:51 INFO     Saved model at 16
2024-09-28 16:23:51 INFO     Val loss decrease from 5.9332 to 5.5799, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-28 16:24:18 INFO     epoch complete!
2024-09-28 16:24:18 INFO     evaluating now!
2024-09-28 16:24:22 INFO     Epoch [17/200] train_loss: 4.7875, val_loss: 5.6974, lr: 0.003000, 30.63s
2024-09-28 16:24:53 INFO     epoch complete!
2024-09-28 16:24:53 INFO     evaluating now!
2024-09-28 16:24:58 INFO     Epoch [18/200] train_loss: 4.7247, val_loss: 5.6588, lr: 0.003000, 36.46s
2024-09-28 16:25:32 INFO     epoch complete!
2024-09-28 16:25:32 INFO     evaluating now!
2024-09-28 16:25:36 INFO     Epoch [19/200] train_loss: 4.6923, val_loss: 5.8072, lr: 0.003000, 38.05s
2024-09-28 16:26:07 INFO     epoch complete!
2024-09-28 16:26:07 INFO     evaluating now!
2024-09-28 16:26:12 INFO     Epoch [20/200] train_loss: 4.6259, val_loss: 5.5420, lr: 0.003000, 35.65s
2024-09-28 16:26:12 INFO     Saved model at 20
2024-09-28 16:26:12 INFO     Val loss decrease from 5.5799 to 5.5420, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-28 16:26:42 INFO     epoch complete!
2024-09-28 16:26:42 INFO     evaluating now!
2024-09-28 16:26:46 INFO     Epoch [21/200] train_loss: 4.6707, val_loss: 5.5572, lr: 0.003000, 33.83s
2024-09-28 16:27:15 INFO     epoch complete!
2024-09-28 16:27:15 INFO     evaluating now!
2024-09-28 16:27:18 INFO     Epoch [22/200] train_loss: 4.5130, val_loss: 5.3000, lr: 0.003000, 31.83s
2024-09-28 16:27:18 INFO     Saved model at 22
2024-09-28 16:27:18 INFO     Val loss decrease from 5.5420 to 5.3000, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-28 16:27:45 INFO     epoch complete!
2024-09-28 16:27:45 INFO     evaluating now!
2024-09-28 16:27:49 INFO     Epoch [23/200] train_loss: 4.4200, val_loss: 5.3307, lr: 0.003000, 31.26s
2024-09-28 16:28:20 INFO     epoch complete!
2024-09-28 16:28:20 INFO     evaluating now!
2024-09-28 16:28:24 INFO     Epoch [24/200] train_loss: 4.3469, val_loss: 5.2860, lr: 0.003000, 35.02s
2024-09-28 16:28:25 INFO     Saved model at 24
2024-09-28 16:28:25 INFO     Val loss decrease from 5.3000 to 5.2860, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-28 16:28:54 INFO     epoch complete!
2024-09-28 16:28:54 INFO     evaluating now!
2024-09-28 16:28:58 INFO     Epoch [25/200] train_loss: 4.3671, val_loss: 5.4765, lr: 0.003000, 33.11s
2024-09-28 16:29:32 INFO     epoch complete!
2024-09-28 16:29:32 INFO     evaluating now!
2024-09-28 16:29:36 INFO     Epoch [26/200] train_loss: 4.3108, val_loss: 5.3137, lr: 0.003000, 38.21s
2024-09-28 16:30:10 INFO     epoch complete!
2024-09-28 16:30:10 INFO     evaluating now!
2024-09-28 16:30:15 INFO     Epoch [27/200] train_loss: 4.2406, val_loss: 5.2068, lr: 0.003000, 39.37s
2024-09-28 16:30:15 INFO     Saved model at 27
2024-09-28 16:30:15 INFO     Val loss decrease from 5.2860 to 5.2068, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-28 16:30:54 INFO     epoch complete!
2024-09-28 16:30:54 INFO     evaluating now!
2024-09-28 16:30:57 INFO     Epoch [28/200] train_loss: 4.1882, val_loss: 5.2145, lr: 0.003000, 41.79s
2024-09-28 16:31:25 INFO     epoch complete!
2024-09-28 16:31:25 INFO     evaluating now!
2024-09-28 16:31:29 INFO     Epoch [29/200] train_loss: 4.1831, val_loss: 5.3189, lr: 0.003000, 31.54s
2024-09-28 16:31:58 INFO     epoch complete!
2024-09-28 16:31:58 INFO     evaluating now!
2024-09-28 16:32:02 INFO     Epoch [30/200] train_loss: 4.0791, val_loss: 5.2983, lr: 0.003000, 32.95s
2024-09-28 16:32:32 INFO     epoch complete!
2024-09-28 16:32:32 INFO     evaluating now!
2024-09-28 16:32:36 INFO     Epoch [31/200] train_loss: 4.1890, val_loss: 5.2664, lr: 0.003000, 34.11s
2024-09-28 16:33:03 INFO     epoch complete!
2024-09-28 16:33:03 INFO     evaluating now!
2024-09-28 16:33:06 INFO     Epoch [32/200] train_loss: 4.0624, val_loss: 5.1766, lr: 0.003000, 30.17s
2024-09-28 16:33:06 INFO     Saved model at 32
2024-09-28 16:33:06 INFO     Val loss decrease from 5.2068 to 5.1766, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-09-28 16:33:35 INFO     epoch complete!
2024-09-28 16:33:35 INFO     evaluating now!
2024-09-28 16:33:39 INFO     Epoch [33/200] train_loss: 3.9683, val_loss: 5.3247, lr: 0.003000, 32.20s
2024-09-28 16:34:06 INFO     epoch complete!
2024-09-28 16:34:06 INFO     evaluating now!
2024-09-28 16:34:09 INFO     Epoch [34/200] train_loss: 3.9650, val_loss: 5.1196, lr: 0.003000, 30.78s
2024-09-28 16:34:09 INFO     Saved model at 34
2024-09-28 16:34:09 INFO     Val loss decrease from 5.1766 to 5.1196, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-09-28 16:34:36 INFO     epoch complete!
2024-09-28 16:34:36 INFO     evaluating now!
2024-09-28 16:34:38 INFO     Epoch [35/200] train_loss: 3.9409, val_loss: 5.3399, lr: 0.003000, 28.90s
2024-09-28 16:35:05 INFO     epoch complete!
2024-09-28 16:35:05 INFO     evaluating now!
2024-09-28 16:35:09 INFO     Epoch [36/200] train_loss: 3.9151, val_loss: 5.3367, lr: 0.003000, 30.60s
2024-09-28 16:35:33 INFO     epoch complete!
2024-09-28 16:35:33 INFO     evaluating now!
2024-09-28 16:35:36 INFO     Epoch [37/200] train_loss: 3.8184, val_loss: 5.2082, lr: 0.003000, 26.70s
2024-09-28 16:35:59 INFO     epoch complete!
2024-09-28 16:35:59 INFO     evaluating now!
2024-09-28 16:36:02 INFO     Epoch [38/200] train_loss: 3.8152, val_loss: 5.2239, lr: 0.003000, 26.13s
2024-09-28 16:36:25 INFO     epoch complete!
2024-09-28 16:36:25 INFO     evaluating now!
2024-09-28 16:36:28 INFO     Epoch [39/200] train_loss: 3.8549, val_loss: 5.1840, lr: 0.003000, 26.26s
2024-09-28 16:36:53 INFO     epoch complete!
2024-09-28 16:36:53 INFO     evaluating now!
2024-09-28 16:36:55 INFO     Epoch [40/200] train_loss: 3.7756, val_loss: 5.2474, lr: 0.003000, 27.30s
2024-09-28 16:37:23 INFO     epoch complete!
2024-09-28 16:37:23 INFO     evaluating now!
2024-09-28 16:37:26 INFO     Epoch [41/200] train_loss: 3.7745, val_loss: 5.2873, lr: 0.003000, 30.61s
2024-09-28 16:37:53 INFO     epoch complete!
2024-09-28 16:37:53 INFO     evaluating now!
2024-09-28 16:37:57 INFO     Epoch [42/200] train_loss: 3.7145, val_loss: 5.0988, lr: 0.003000, 30.59s
2024-09-28 16:37:57 INFO     Saved model at 42
2024-09-28 16:37:57 INFO     Val loss decrease from 5.1196 to 5.0988, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-09-28 16:38:22 INFO     epoch complete!
2024-09-28 16:38:22 INFO     evaluating now!
2024-09-28 16:38:25 INFO     Epoch [43/200] train_loss: 3.6862, val_loss: 5.1173, lr: 0.003000, 28.68s
2024-09-28 16:38:54 INFO     epoch complete!
2024-09-28 16:38:54 INFO     evaluating now!
2024-09-28 16:38:57 INFO     Epoch [44/200] train_loss: 3.6603, val_loss: 5.1534, lr: 0.003000, 32.02s
2024-09-28 16:39:26 INFO     epoch complete!
2024-09-28 16:39:26 INFO     evaluating now!
2024-09-28 16:39:28 INFO     Epoch [45/200] train_loss: 3.6308, val_loss: 5.1402, lr: 0.003000, 30.99s
2024-09-28 16:39:56 INFO     epoch complete!
2024-09-28 16:39:56 INFO     evaluating now!
2024-09-28 16:40:00 INFO     Epoch [46/200] train_loss: 3.5812, val_loss: 5.0852, lr: 0.003000, 31.75s
2024-09-28 16:40:00 INFO     Saved model at 46
2024-09-28 16:40:00 INFO     Val loss decrease from 5.0988 to 5.0852, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-09-28 16:40:28 INFO     epoch complete!
2024-09-28 16:40:28 INFO     evaluating now!
2024-09-28 16:40:30 INFO     Epoch [47/200] train_loss: 3.5644, val_loss: 4.9912, lr: 0.003000, 29.99s
2024-09-28 16:40:31 INFO     Saved model at 47
2024-09-28 16:40:31 INFO     Val loss decrease from 5.0852 to 4.9912, saving to ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406_epoch47.tar
2024-09-28 16:40:56 INFO     epoch complete!
2024-09-28 16:40:56 INFO     evaluating now!
2024-09-28 16:40:59 INFO     Epoch [48/200] train_loss: 3.5494, val_loss: 5.0085, lr: 0.003000, 28.27s
2024-09-28 16:41:24 INFO     epoch complete!
2024-09-28 16:41:24 INFO     evaluating now!
2024-09-28 16:41:27 INFO     Epoch [49/200] train_loss: 3.5191, val_loss: 5.1826, lr: 0.003000, 27.98s
2024-09-28 16:41:55 INFO     epoch complete!
2024-09-28 16:41:55 INFO     evaluating now!
2024-09-28 16:41:59 INFO     Epoch [50/200] train_loss: 3.5167, val_loss: 5.2042, lr: 0.003000, 32.13s
2024-09-28 16:42:27 INFO     epoch complete!
2024-09-28 16:42:27 INFO     evaluating now!
2024-09-28 16:42:30 INFO     Epoch [51/200] train_loss: 3.6070, val_loss: 5.1630, lr: 0.003000, 31.49s
2024-09-28 16:43:03 INFO     epoch complete!
2024-09-28 16:43:03 INFO     evaluating now!
2024-09-28 16:43:07 INFO     Epoch [52/200] train_loss: 3.5081, val_loss: 5.1766, lr: 0.003000, 36.89s
2024-09-28 16:43:43 INFO     epoch complete!
2024-09-28 16:43:43 INFO     evaluating now!
2024-09-28 16:43:47 INFO     Epoch [53/200] train_loss: 3.4495, val_loss: 5.2256, lr: 0.003000, 40.04s
2024-09-28 16:44:21 INFO     epoch complete!
2024-09-28 16:44:21 INFO     evaluating now!
2024-09-28 16:44:24 INFO     Epoch [54/200] train_loss: 3.4425, val_loss: 5.0831, lr: 0.003000, 36.76s
2024-09-28 16:44:56 INFO     epoch complete!
2024-09-28 16:44:56 INFO     evaluating now!
2024-09-28 16:45:00 INFO     Epoch [55/200] train_loss: 3.4245, val_loss: 5.0939, lr: 0.003000, 35.99s
2024-09-28 16:45:30 INFO     epoch complete!
2024-09-28 16:45:30 INFO     evaluating now!
2024-09-28 16:45:33 INFO     Epoch [56/200] train_loss: 3.3927, val_loss: 5.0746, lr: 0.003000, 33.33s
2024-09-28 16:46:07 INFO     epoch complete!
2024-09-28 16:46:07 INFO     evaluating now!
2024-09-28 16:46:11 INFO     Epoch [57/200] train_loss: 3.3859, val_loss: 5.1758, lr: 0.003000, 37.79s
2024-09-28 16:46:44 INFO     epoch complete!
2024-09-28 16:46:44 INFO     evaluating now!
2024-09-28 16:46:49 INFO     Epoch [58/200] train_loss: 3.3886, val_loss: 5.1579, lr: 0.003000, 37.26s
2024-09-28 16:47:21 INFO     epoch complete!
2024-09-28 16:47:21 INFO     evaluating now!
2024-09-28 16:47:24 INFO     Epoch [59/200] train_loss: 3.3446, val_loss: 5.0408, lr: 0.003000, 35.98s
2024-09-28 16:47:54 INFO     epoch complete!
2024-09-28 16:47:54 INFO     evaluating now!
2024-09-28 16:47:57 INFO     Epoch [60/200] train_loss: 3.3528, val_loss: 5.1019, lr: 0.003000, 32.95s
2024-09-28 16:48:29 INFO     epoch complete!
2024-09-28 16:48:29 INFO     evaluating now!
2024-09-28 16:48:32 INFO     Epoch [61/200] train_loss: 3.3687, val_loss: 5.2478, lr: 0.003000, 34.82s
2024-09-28 16:49:01 INFO     epoch complete!
2024-09-28 16:49:01 INFO     evaluating now!
2024-09-28 16:49:07 INFO     Epoch [62/200] train_loss: 3.3199, val_loss: 5.1175, lr: 0.003000, 34.73s
2024-09-28 16:49:07 WARNING  Early stopping at epoch: 62
2024-09-28 16:49:07 INFO     Trained totally 63 epochs, average train time is 28.273s, average eval time is 3.497s
2024-09-28 16:49:07 INFO     Loaded model at 47
2024-09-28 16:49:07 INFO     Saved model at ./libcity/cache/1001/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 16:49:07 INFO     Start evaluating ...
2024-09-28 16:49:16 INFO     Note that you select the single mode to evaluate!
2024-09-28 16:49:16 INFO     Evaluate result is saved at ./libcity/cache/1001/evaluate_cache/2024_09_28_16_49_16_AGCRN_CHITaxi20190406.csv
2024-09-28 16:49:16 INFO     
         MAE       RMSE  masked_MAPE
1   2.253460   6.974645     0.402576
2   2.427197   7.657390     0.406943
3   2.508922   8.920558     0.420292
4   2.734288  10.006126     0.408986
5   2.949063  11.069205     0.418281
6   2.995207  11.891967     0.416700
7   3.213542  12.558492     0.439191
8   3.148601  12.899859     0.433429
9   3.183347  13.139930     0.438701
10  3.277224  13.433634     0.451521
11  3.264843  13.743670     0.458029
12  3.542094  14.527166     0.485237
2024-09-28 16:49:17 INFO     ----------------------------------------------------------------------------
2024-09-28 16:49:17 INFO     # 2, Kownledge Graph Embedding: GIE, Experiment ids: 1002
2024-09-28 16:49:17 INFO     ----------------------------------------------------------------------------
2024-09-28 16:49:17 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=1002
2024-09-28 16:49:17 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 1002, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'MultiHop', 'max_hop': 1, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 16:49:17 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 16:49:17 INFO     set_weight_link_or_dist: dist
2024-09-28 16:49:17 INFO     init_weight_inf_or_zero: inf
2024-09-28 16:49:17 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 16:49:17 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 16:49:17 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 16:49:17 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 16:49:18 INFO     Dataset created
2024-09-28 16:49:18 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-28 16:49:18 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-28 16:49:18 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-28 16:49:18 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-28 16:49:18 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 16:49:18 INFO     NoneScaler
2024-09-28 16:49:18 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 16:49:18 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 16:49:18 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 16:49:18 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 16:49:18 INFO     encoder.dcrnn_cells.0.gate.weights_pool2	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 16:49:18 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 16:49:18 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 16:49:18 INFO     encoder.dcrnn_cells.0.update.weights_pool2	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 16:49:18 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 16:49:18 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 16:49:18 INFO     encoder.dcrnn_cells.1.gate.weights_pool2	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 16:49:18 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 16:49:18 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 16:49:18 INFO     encoder.dcrnn_cells.1.update.weights_pool2	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 16:49:18 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 16:49:18 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 16:49:18 INFO     Total parameter numbers: 1496090
2024-09-28 16:49:18 INFO     You select `adam` optimizer.
2024-09-28 16:49:18 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 16:49:18 INFO     Start training ...
2024-09-28 16:49:18 INFO     num_batches:48
2024-09-28 16:49:46 INFO     epoch complete!
2024-09-28 16:49:46 INFO     evaluating now!
2024-09-28 16:49:50 INFO     Epoch [0/200] train_loss: 23.1514, val_loss: 17.3776, lr: 0.003000, 31.74s
2024-09-28 16:49:50 INFO     Saved model at 0
2024-09-28 16:49:50 INFO     Val loss decrease from inf to 17.3776, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 16:50:20 INFO     epoch complete!
2024-09-28 16:50:20 INFO     evaluating now!
2024-09-28 16:50:23 INFO     Epoch [1/200] train_loss: 14.0556, val_loss: 14.0018, lr: 0.003000, 33.30s
2024-09-28 16:50:23 INFO     Saved model at 1
2024-09-28 16:50:23 INFO     Val loss decrease from 17.3776 to 14.0018, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 16:50:52 INFO     epoch complete!
2024-09-28 16:50:52 INFO     evaluating now!
2024-09-28 16:50:56 INFO     Epoch [2/200] train_loss: 11.7787, val_loss: 11.8019, lr: 0.003000, 32.46s
2024-09-28 16:50:56 INFO     Saved model at 2
2024-09-28 16:50:56 INFO     Val loss decrease from 14.0018 to 11.8019, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 16:51:26 INFO     epoch complete!
2024-09-28 16:51:26 INFO     evaluating now!
2024-09-28 16:51:30 INFO     Epoch [3/200] train_loss: 9.7021, val_loss: 9.6684, lr: 0.003000, 33.90s
2024-09-28 16:51:30 INFO     Saved model at 3
2024-09-28 16:51:30 INFO     Val loss decrease from 11.8019 to 9.6684, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 16:51:59 INFO     epoch complete!
2024-09-28 16:51:59 INFO     evaluating now!
2024-09-28 16:52:03 INFO     Epoch [4/200] train_loss: 8.1381, val_loss: 8.5800, lr: 0.003000, 33.24s
2024-09-28 16:52:04 INFO     Saved model at 4
2024-09-28 16:52:04 INFO     Val loss decrease from 9.6684 to 8.5800, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 16:52:37 INFO     epoch complete!
2024-09-28 16:52:37 INFO     evaluating now!
2024-09-28 16:52:41 INFO     Epoch [5/200] train_loss: 7.2901, val_loss: 7.4142, lr: 0.003000, 37.27s
2024-09-28 16:52:41 INFO     Saved model at 5
2024-09-28 16:52:41 INFO     Val loss decrease from 8.5800 to 7.4142, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 16:53:12 INFO     epoch complete!
2024-09-28 16:53:12 INFO     evaluating now!
2024-09-28 16:53:15 INFO     Epoch [6/200] train_loss: 6.6735, val_loss: 7.1339, lr: 0.003000, 34.11s
2024-09-28 16:53:15 INFO     Saved model at 6
2024-09-28 16:53:15 INFO     Val loss decrease from 7.4142 to 7.1339, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-28 16:53:49 INFO     epoch complete!
2024-09-28 16:53:49 INFO     evaluating now!
2024-09-28 16:53:53 INFO     Epoch [7/200] train_loss: 6.3136, val_loss: 6.5886, lr: 0.003000, 37.36s
2024-09-28 16:53:53 INFO     Saved model at 7
2024-09-28 16:53:53 INFO     Val loss decrease from 7.1339 to 6.5886, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-28 16:54:22 INFO     epoch complete!
2024-09-28 16:54:22 INFO     evaluating now!
2024-09-28 16:54:26 INFO     Epoch [8/200] train_loss: 6.0522, val_loss: 6.2184, lr: 0.003000, 33.00s
2024-09-28 16:54:27 INFO     Saved model at 8
2024-09-28 16:54:27 INFO     Val loss decrease from 6.5886 to 6.2184, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-28 16:54:54 INFO     epoch complete!
2024-09-28 16:54:54 INFO     evaluating now!
2024-09-28 16:54:57 INFO     Epoch [9/200] train_loss: 5.6851, val_loss: 6.1202, lr: 0.003000, 29.98s
2024-09-28 16:54:57 INFO     Saved model at 9
2024-09-28 16:54:57 INFO     Val loss decrease from 6.2184 to 6.1202, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-28 16:55:22 INFO     epoch complete!
2024-09-28 16:55:22 INFO     evaluating now!
2024-09-28 16:55:25 INFO     Epoch [10/200] train_loss: 5.5479, val_loss: 5.8146, lr: 0.003000, 28.39s
2024-09-28 16:55:25 INFO     Saved model at 10
2024-09-28 16:55:25 INFO     Val loss decrease from 6.1202 to 5.8146, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-28 16:55:52 INFO     epoch complete!
2024-09-28 16:55:52 INFO     evaluating now!
2024-09-28 16:55:55 INFO     Epoch [11/200] train_loss: 5.3420, val_loss: 6.0637, lr: 0.003000, 29.97s
2024-09-28 16:56:23 INFO     epoch complete!
2024-09-28 16:56:23 INFO     evaluating now!
2024-09-28 16:56:26 INFO     Epoch [12/200] train_loss: 5.2498, val_loss: 5.7588, lr: 0.003000, 30.39s
2024-09-28 16:56:26 INFO     Saved model at 12
2024-09-28 16:56:26 INFO     Val loss decrease from 5.8146 to 5.7588, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-28 16:56:53 INFO     epoch complete!
2024-09-28 16:56:53 INFO     evaluating now!
2024-09-28 16:56:56 INFO     Epoch [13/200] train_loss: 5.1264, val_loss: 5.6772, lr: 0.003000, 30.20s
2024-09-28 16:56:56 INFO     Saved model at 13
2024-09-28 16:56:56 INFO     Val loss decrease from 5.7588 to 5.6772, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-28 16:57:23 INFO     epoch complete!
2024-09-28 16:57:23 INFO     evaluating now!
2024-09-28 16:57:27 INFO     Epoch [14/200] train_loss: 4.9776, val_loss: 5.5629, lr: 0.003000, 31.05s
2024-09-28 16:57:27 INFO     Saved model at 14
2024-09-28 16:57:27 INFO     Val loss decrease from 5.6772 to 5.5629, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-28 16:57:56 INFO     epoch complete!
2024-09-28 16:57:56 INFO     evaluating now!
2024-09-28 16:57:59 INFO     Epoch [15/200] train_loss: 4.9347, val_loss: 5.7268, lr: 0.003000, 31.74s
2024-09-28 16:58:29 INFO     epoch complete!
2024-09-28 16:58:29 INFO     evaluating now!
2024-09-28 16:58:32 INFO     Epoch [16/200] train_loss: 4.9110, val_loss: 5.8402, lr: 0.003000, 33.22s
2024-09-28 16:58:57 INFO     epoch complete!
2024-09-28 16:58:57 INFO     evaluating now!
2024-09-28 16:59:00 INFO     Epoch [17/200] train_loss: 4.7106, val_loss: 5.5053, lr: 0.003000, 27.98s
2024-09-28 16:59:01 INFO     Saved model at 17
2024-09-28 16:59:01 INFO     Val loss decrease from 5.5629 to 5.5053, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-28 16:59:30 INFO     epoch complete!
2024-09-28 16:59:30 INFO     evaluating now!
2024-09-28 16:59:33 INFO     Epoch [18/200] train_loss: 4.7127, val_loss: 5.5237, lr: 0.003000, 32.60s
2024-09-28 17:00:03 INFO     epoch complete!
2024-09-28 17:00:03 INFO     evaluating now!
2024-09-28 17:00:06 INFO     Epoch [19/200] train_loss: 4.6539, val_loss: 5.5401, lr: 0.003000, 32.79s
2024-09-28 17:00:35 INFO     epoch complete!
2024-09-28 17:00:35 INFO     evaluating now!
2024-09-28 17:00:37 INFO     Epoch [20/200] train_loss: 4.4935, val_loss: 5.4233, lr: 0.003000, 31.33s
2024-09-28 17:00:38 INFO     Saved model at 20
2024-09-28 17:00:38 INFO     Val loss decrease from 5.5053 to 5.4233, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-28 17:01:04 INFO     epoch complete!
2024-09-28 17:01:04 INFO     evaluating now!
2024-09-28 17:01:07 INFO     Epoch [21/200] train_loss: 4.5463, val_loss: 5.4683, lr: 0.003000, 29.76s
2024-09-28 17:01:32 INFO     epoch complete!
2024-09-28 17:01:32 INFO     evaluating now!
2024-09-28 17:01:36 INFO     Epoch [22/200] train_loss: 4.4376, val_loss: 5.4863, lr: 0.003000, 28.54s
2024-09-28 17:02:02 INFO     epoch complete!
2024-09-28 17:02:02 INFO     evaluating now!
2024-09-28 17:02:05 INFO     Epoch [23/200] train_loss: 4.3516, val_loss: 5.4167, lr: 0.003000, 29.43s
2024-09-28 17:02:05 INFO     Saved model at 23
2024-09-28 17:02:05 INFO     Val loss decrease from 5.4233 to 5.4167, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-28 17:02:33 INFO     epoch complete!
2024-09-28 17:02:33 INFO     evaluating now!
2024-09-28 17:02:37 INFO     Epoch [24/200] train_loss: 4.3472, val_loss: 5.3047, lr: 0.003000, 31.18s
2024-09-28 17:02:37 INFO     Saved model at 24
2024-09-28 17:02:37 INFO     Val loss decrease from 5.4167 to 5.3047, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-28 17:03:09 INFO     epoch complete!
2024-09-28 17:03:09 INFO     evaluating now!
2024-09-28 17:03:12 INFO     Epoch [25/200] train_loss: 4.2394, val_loss: 5.5907, lr: 0.003000, 35.47s
2024-09-28 17:03:41 INFO     epoch complete!
2024-09-28 17:03:41 INFO     evaluating now!
2024-09-28 17:03:45 INFO     Epoch [26/200] train_loss: 4.2219, val_loss: 5.2926, lr: 0.003000, 32.89s
2024-09-28 17:03:45 INFO     Saved model at 26
2024-09-28 17:03:45 INFO     Val loss decrease from 5.3047 to 5.2926, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-28 17:04:16 INFO     epoch complete!
2024-09-28 17:04:16 INFO     evaluating now!
2024-09-28 17:04:20 INFO     Epoch [27/200] train_loss: 4.1725, val_loss: 5.2337, lr: 0.003000, 34.86s
2024-09-28 17:04:20 INFO     Saved model at 27
2024-09-28 17:04:20 INFO     Val loss decrease from 5.2926 to 5.2337, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-28 17:04:52 INFO     epoch complete!
2024-09-28 17:04:52 INFO     evaluating now!
2024-09-28 17:04:56 INFO     Epoch [28/200] train_loss: 4.1767, val_loss: 5.3382, lr: 0.003000, 35.36s
2024-09-28 17:05:25 INFO     epoch complete!
2024-09-28 17:05:25 INFO     evaluating now!
2024-09-28 17:05:28 INFO     Epoch [29/200] train_loss: 4.0933, val_loss: 5.2915, lr: 0.003000, 32.23s
2024-09-28 17:05:57 INFO     epoch complete!
2024-09-28 17:05:57 INFO     evaluating now!
2024-09-28 17:06:02 INFO     Epoch [30/200] train_loss: 4.0143, val_loss: 5.2038, lr: 0.003000, 34.39s
2024-09-28 17:06:03 INFO     Saved model at 30
2024-09-28 17:06:03 INFO     Val loss decrease from 5.2337 to 5.2038, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-09-28 17:06:33 INFO     epoch complete!
2024-09-28 17:06:33 INFO     evaluating now!
2024-09-28 17:06:38 INFO     Epoch [31/200] train_loss: 4.0112, val_loss: 5.3002, lr: 0.003000, 35.00s
2024-09-28 17:07:08 INFO     epoch complete!
2024-09-28 17:07:08 INFO     evaluating now!
2024-09-28 17:07:13 INFO     Epoch [32/200] train_loss: 3.9623, val_loss: 5.2832, lr: 0.003000, 35.17s
2024-09-28 17:07:47 INFO     epoch complete!
2024-09-28 17:07:47 INFO     evaluating now!
2024-09-28 17:07:52 INFO     Epoch [33/200] train_loss: 3.9015, val_loss: 5.1812, lr: 0.003000, 38.91s
2024-09-28 17:07:52 INFO     Saved model at 33
2024-09-28 17:07:52 INFO     Val loss decrease from 5.2038 to 5.1812, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-09-28 17:08:22 INFO     epoch complete!
2024-09-28 17:08:22 INFO     evaluating now!
2024-09-28 17:08:25 INFO     Epoch [34/200] train_loss: 3.8657, val_loss: 5.2655, lr: 0.003000, 33.53s
2024-09-28 17:08:53 INFO     epoch complete!
2024-09-28 17:08:53 INFO     evaluating now!
2024-09-28 17:08:57 INFO     Epoch [35/200] train_loss: 3.8628, val_loss: 5.1559, lr: 0.003000, 31.59s
2024-09-28 17:08:57 INFO     Saved model at 35
2024-09-28 17:08:57 INFO     Val loss decrease from 5.1812 to 5.1559, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-28 17:09:25 INFO     epoch complete!
2024-09-28 17:09:25 INFO     evaluating now!
2024-09-28 17:09:29 INFO     Epoch [36/200] train_loss: 3.7975, val_loss: 5.2336, lr: 0.003000, 31.79s
2024-09-28 17:09:56 INFO     epoch complete!
2024-09-28 17:09:56 INFO     evaluating now!
2024-09-28 17:09:59 INFO     Epoch [37/200] train_loss: 3.7850, val_loss: 5.2438, lr: 0.003000, 30.14s
2024-09-28 17:10:26 INFO     epoch complete!
2024-09-28 17:10:26 INFO     evaluating now!
2024-09-28 17:10:29 INFO     Epoch [38/200] train_loss: 3.7659, val_loss: 5.2666, lr: 0.003000, 30.32s
2024-09-28 17:10:57 INFO     epoch complete!
2024-09-28 17:10:57 INFO     evaluating now!
2024-09-28 17:11:00 INFO     Epoch [39/200] train_loss: 3.7472, val_loss: 5.2201, lr: 0.003000, 30.30s
2024-09-28 17:11:27 INFO     epoch complete!
2024-09-28 17:11:27 INFO     evaluating now!
2024-09-28 17:11:30 INFO     Epoch [40/200] train_loss: 3.6828, val_loss: 5.2148, lr: 0.003000, 29.88s
2024-09-28 17:11:56 INFO     epoch complete!
2024-09-28 17:11:56 INFO     evaluating now!
2024-09-28 17:11:59 INFO     Epoch [41/200] train_loss: 3.7204, val_loss: 5.1312, lr: 0.003000, 28.92s
2024-09-28 17:11:59 INFO     Saved model at 41
2024-09-28 17:11:59 INFO     Val loss decrease from 5.1559 to 5.1312, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-09-28 17:12:23 INFO     epoch complete!
2024-09-28 17:12:23 INFO     evaluating now!
2024-09-28 17:12:26 INFO     Epoch [42/200] train_loss: 3.6401, val_loss: 5.2464, lr: 0.003000, 27.19s
2024-09-28 17:12:49 INFO     epoch complete!
2024-09-28 17:12:49 INFO     evaluating now!
2024-09-28 17:12:52 INFO     Epoch [43/200] train_loss: 3.5941, val_loss: 5.1447, lr: 0.003000, 25.99s
2024-09-28 17:13:18 INFO     epoch complete!
2024-09-28 17:13:18 INFO     evaluating now!
2024-09-28 17:13:22 INFO     Epoch [44/200] train_loss: 3.5750, val_loss: 5.1183, lr: 0.003000, 29.60s
2024-09-28 17:13:22 INFO     Saved model at 44
2024-09-28 17:13:22 INFO     Val loss decrease from 5.1312 to 5.1183, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-09-28 17:13:48 INFO     epoch complete!
2024-09-28 17:13:48 INFO     evaluating now!
2024-09-28 17:13:51 INFO     Epoch [45/200] train_loss: 3.5459, val_loss: 5.2442, lr: 0.003000, 29.29s
2024-09-28 17:14:16 INFO     epoch complete!
2024-09-28 17:14:16 INFO     evaluating now!
2024-09-28 17:14:19 INFO     Epoch [46/200] train_loss: 3.5803, val_loss: 5.3092, lr: 0.003000, 27.99s
2024-09-28 17:14:45 INFO     epoch complete!
2024-09-28 17:14:45 INFO     evaluating now!
2024-09-28 17:14:47 INFO     Epoch [47/200] train_loss: 3.5667, val_loss: 5.2757, lr: 0.003000, 28.44s
2024-09-28 17:15:11 INFO     epoch complete!
2024-09-28 17:15:11 INFO     evaluating now!
2024-09-28 17:15:14 INFO     Epoch [48/200] train_loss: 3.5229, val_loss: 5.1101, lr: 0.003000, 26.60s
2024-09-28 17:15:14 INFO     Saved model at 48
2024-09-28 17:15:14 INFO     Val loss decrease from 5.1183 to 5.1101, saving to ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-09-28 17:15:39 INFO     epoch complete!
2024-09-28 17:15:39 INFO     evaluating now!
2024-09-28 17:15:41 INFO     Epoch [49/200] train_loss: 3.4813, val_loss: 5.1523, lr: 0.003000, 27.03s
2024-09-28 17:16:05 INFO     epoch complete!
2024-09-28 17:16:05 INFO     evaluating now!
2024-09-28 17:16:08 INFO     Epoch [50/200] train_loss: 3.4878, val_loss: 5.1257, lr: 0.003000, 26.28s
2024-09-28 17:16:32 INFO     epoch complete!
2024-09-28 17:16:32 INFO     evaluating now!
2024-09-28 17:16:36 INFO     Epoch [51/200] train_loss: 3.4353, val_loss: 5.1438, lr: 0.003000, 28.14s
2024-09-28 17:16:59 INFO     epoch complete!
2024-09-28 17:16:59 INFO     evaluating now!
2024-09-28 17:17:02 INFO     Epoch [52/200] train_loss: 3.4117, val_loss: 5.2894, lr: 0.003000, 26.21s
2024-09-28 17:17:25 INFO     epoch complete!
2024-09-28 17:17:25 INFO     evaluating now!
2024-09-28 17:17:28 INFO     Epoch [53/200] train_loss: 3.4237, val_loss: 5.1754, lr: 0.003000, 25.74s
2024-09-28 17:17:52 INFO     epoch complete!
2024-09-28 17:17:52 INFO     evaluating now!
2024-09-28 17:17:54 INFO     Epoch [54/200] train_loss: 3.3484, val_loss: 5.2173, lr: 0.003000, 26.73s
2024-09-28 17:18:18 INFO     epoch complete!
2024-09-28 17:18:18 INFO     evaluating now!
2024-09-28 17:18:22 INFO     Epoch [55/200] train_loss: 3.3398, val_loss: 5.1426, lr: 0.003000, 27.21s
2024-09-28 17:18:44 INFO     epoch complete!
2024-09-28 17:18:44 INFO     evaluating now!
2024-09-28 17:18:47 INFO     Epoch [56/200] train_loss: 3.3788, val_loss: 5.2416, lr: 0.003000, 25.59s
2024-09-28 17:19:12 INFO     epoch complete!
2024-09-28 17:19:12 INFO     evaluating now!
2024-09-28 17:19:15 INFO     Epoch [57/200] train_loss: 3.4555, val_loss: 5.2735, lr: 0.003000, 27.69s
2024-09-28 17:19:42 INFO     epoch complete!
2024-09-28 17:19:42 INFO     evaluating now!
2024-09-28 17:19:45 INFO     Epoch [58/200] train_loss: 3.3443, val_loss: 5.2431, lr: 0.003000, 30.28s
2024-09-28 17:20:10 INFO     epoch complete!
2024-09-28 17:20:10 INFO     evaluating now!
2024-09-28 17:20:13 INFO     Epoch [59/200] train_loss: 3.2866, val_loss: 5.2599, lr: 0.003000, 27.51s
2024-09-28 17:20:42 INFO     epoch complete!
2024-09-28 17:20:42 INFO     evaluating now!
2024-09-28 17:20:46 INFO     Epoch [60/200] train_loss: 3.2699, val_loss: 5.1751, lr: 0.003000, 33.70s
2024-09-28 17:21:16 INFO     epoch complete!
2024-09-28 17:21:16 INFO     evaluating now!
2024-09-28 17:21:19 INFO     Epoch [61/200] train_loss: 3.2866, val_loss: 5.1848, lr: 0.003000, 33.13s
2024-09-28 17:21:48 INFO     epoch complete!
2024-09-28 17:21:48 INFO     evaluating now!
2024-09-28 17:21:51 INFO     Epoch [62/200] train_loss: 3.2646, val_loss: 5.2132, lr: 0.003000, 31.87s
2024-09-28 17:22:20 INFO     epoch complete!
2024-09-28 17:22:20 INFO     evaluating now!
2024-09-28 17:22:24 INFO     Epoch [63/200] train_loss: 3.2442, val_loss: 5.2483, lr: 0.003000, 32.22s
2024-09-28 17:22:24 WARNING  Early stopping at epoch: 63
2024-09-28 17:22:24 INFO     Trained totally 64 epochs, average train time is 27.565s, average eval time is 3.372s
2024-09-28 17:22:24 INFO     Loaded model at 48
2024-09-28 17:22:24 INFO     Saved model at ./libcity/cache/1002/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 17:22:24 INFO     Start evaluating ...
2024-09-28 17:22:31 INFO     Note that you select the single mode to evaluate!
2024-09-28 17:22:31 INFO     Evaluate result is saved at ./libcity/cache/1002/evaluate_cache/2024_09_28_17_22_31_AGCRN_CHITaxi20190406.csv
2024-09-28 17:22:31 INFO     
         MAE       RMSE  masked_MAPE
1   2.361860   7.112942     0.419997
2   2.424098   7.571631     0.421587
3   2.613194   8.741804     0.415770
4   2.770627   9.766959     0.413464
5   2.903090  10.464138     0.418442
6   3.040000  11.128301     0.441305
7   3.042622  11.566854     0.437494
8   3.128487  12.015643     0.445700
9   3.078028  12.332536     0.441262
10  3.161108  12.615267     0.440524
11  3.222926  13.057800     0.446816
12  3.376072  13.956817     0.456296
2024-09-28 17:22:32 INFO     ----------------------------------------------------------------------------
2024-09-28 17:22:32 INFO     # 3, Kownledge Graph Embedding: GIE, Experiment ids: 1003
2024-09-28 17:22:32 INFO     ----------------------------------------------------------------------------
2024-09-28 17:22:32 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=1003
2024-09-28 17:22:32 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 1003, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'MultiHop', 'max_hop': 1, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 17:22:32 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 17:22:32 INFO     set_weight_link_or_dist: dist
2024-09-28 17:22:32 INFO     init_weight_inf_or_zero: inf
2024-09-28 17:22:32 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 17:22:32 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 17:22:32 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 17:22:32 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 17:22:32 INFO     Dataset created
2024-09-28 17:22:32 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-28 17:22:32 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-28 17:22:32 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-28 17:22:32 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-28 17:22:32 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 17:22:32 INFO     NoneScaler
2024-09-28 17:22:33 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 17:22:33 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 17:22:33 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 17:22:33 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 17:22:33 INFO     encoder.dcrnn_cells.0.gate.weights_pool2	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 17:22:33 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 17:22:33 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 17:22:33 INFO     encoder.dcrnn_cells.0.update.weights_pool2	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 17:22:33 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 17:22:33 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 17:22:33 INFO     encoder.dcrnn_cells.1.gate.weights_pool2	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 17:22:33 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 17:22:33 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 17:22:33 INFO     encoder.dcrnn_cells.1.update.weights_pool2	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 17:22:33 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 17:22:33 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 17:22:33 INFO     Total parameter numbers: 1496090
2024-09-28 17:22:33 INFO     You select `adam` optimizer.
2024-09-28 17:22:33 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 17:22:33 INFO     Start training ...
2024-09-28 17:22:33 INFO     num_batches:48
2024-09-28 17:23:01 INFO     epoch complete!
2024-09-28 17:23:01 INFO     evaluating now!
2024-09-28 17:23:04 INFO     Epoch [0/200] train_loss: 23.1957, val_loss: 17.2411, lr: 0.003000, 31.05s
2024-09-28 17:23:04 INFO     Saved model at 0
2024-09-28 17:23:04 INFO     Val loss decrease from inf to 17.2411, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 17:23:30 INFO     epoch complete!
2024-09-28 17:23:30 INFO     evaluating now!
2024-09-28 17:23:33 INFO     Epoch [1/200] train_loss: 14.0067, val_loss: 13.6116, lr: 0.003000, 29.42s
2024-09-28 17:23:34 INFO     Saved model at 1
2024-09-28 17:23:34 INFO     Val loss decrease from 17.2411 to 13.6116, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 17:23:57 INFO     epoch complete!
2024-09-28 17:23:57 INFO     evaluating now!
2024-09-28 17:24:00 INFO     Epoch [2/200] train_loss: 11.1977, val_loss: 11.3537, lr: 0.003000, 26.44s
2024-09-28 17:24:00 INFO     Saved model at 2
2024-09-28 17:24:00 INFO     Val loss decrease from 13.6116 to 11.3537, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 17:24:23 INFO     epoch complete!
2024-09-28 17:24:23 INFO     evaluating now!
2024-09-28 17:24:26 INFO     Epoch [3/200] train_loss: 9.3916, val_loss: 9.5528, lr: 0.003000, 25.95s
2024-09-28 17:24:26 INFO     Saved model at 3
2024-09-28 17:24:26 INFO     Val loss decrease from 11.3537 to 9.5528, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 17:24:51 INFO     epoch complete!
2024-09-28 17:24:51 INFO     evaluating now!
2024-09-28 17:24:54 INFO     Epoch [4/200] train_loss: 7.9801, val_loss: 8.1179, lr: 0.003000, 27.41s
2024-09-28 17:24:54 INFO     Saved model at 4
2024-09-28 17:24:54 INFO     Val loss decrease from 9.5528 to 8.1179, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 17:25:20 INFO     epoch complete!
2024-09-28 17:25:20 INFO     evaluating now!
2024-09-28 17:25:23 INFO     Epoch [5/200] train_loss: 7.1563, val_loss: 7.3580, lr: 0.003000, 29.22s
2024-09-28 17:25:23 INFO     Saved model at 5
2024-09-28 17:25:23 INFO     Val loss decrease from 8.1179 to 7.3580, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 17:25:50 INFO     epoch complete!
2024-09-28 17:25:50 INFO     evaluating now!
2024-09-28 17:25:54 INFO     Epoch [6/200] train_loss: 6.4613, val_loss: 7.0585, lr: 0.003000, 30.67s
2024-09-28 17:25:54 INFO     Saved model at 6
2024-09-28 17:25:54 INFO     Val loss decrease from 7.3580 to 7.0585, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-28 17:26:21 INFO     epoch complete!
2024-09-28 17:26:21 INFO     evaluating now!
2024-09-28 17:26:23 INFO     Epoch [7/200] train_loss: 6.2110, val_loss: 6.7409, lr: 0.003000, 29.29s
2024-09-28 17:26:24 INFO     Saved model at 7
2024-09-28 17:26:24 INFO     Val loss decrease from 7.0585 to 6.7409, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-28 17:26:50 INFO     epoch complete!
2024-09-28 17:26:50 INFO     evaluating now!
2024-09-28 17:26:53 INFO     Epoch [8/200] train_loss: 5.8882, val_loss: 6.5275, lr: 0.003000, 29.01s
2024-09-28 17:26:53 INFO     Saved model at 8
2024-09-28 17:26:53 INFO     Val loss decrease from 6.7409 to 6.5275, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-28 17:27:15 INFO     epoch complete!
2024-09-28 17:27:15 INFO     evaluating now!
2024-09-28 17:27:18 INFO     Epoch [9/200] train_loss: 5.6911, val_loss: 6.0552, lr: 0.003000, 25.02s
2024-09-28 17:27:18 INFO     Saved model at 9
2024-09-28 17:27:18 INFO     Val loss decrease from 6.5275 to 6.0552, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-28 17:27:42 INFO     epoch complete!
2024-09-28 17:27:42 INFO     evaluating now!
2024-09-28 17:27:45 INFO     Epoch [10/200] train_loss: 5.4671, val_loss: 5.9976, lr: 0.003000, 27.10s
2024-09-28 17:27:45 INFO     Saved model at 10
2024-09-28 17:27:45 INFO     Val loss decrease from 6.0552 to 5.9976, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-28 17:28:09 INFO     epoch complete!
2024-09-28 17:28:09 INFO     evaluating now!
2024-09-28 17:28:12 INFO     Epoch [11/200] train_loss: 5.4026, val_loss: 5.9607, lr: 0.003000, 27.08s
2024-09-28 17:28:13 INFO     Saved model at 11
2024-09-28 17:28:13 INFO     Val loss decrease from 5.9976 to 5.9607, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-28 17:28:40 INFO     epoch complete!
2024-09-28 17:28:40 INFO     evaluating now!
2024-09-28 17:28:43 INFO     Epoch [12/200] train_loss: 5.2328, val_loss: 5.9346, lr: 0.003000, 30.50s
2024-09-28 17:28:44 INFO     Saved model at 12
2024-09-28 17:28:44 INFO     Val loss decrease from 5.9607 to 5.9346, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-28 17:29:17 INFO     epoch complete!
2024-09-28 17:29:17 INFO     evaluating now!
2024-09-28 17:29:21 INFO     Epoch [13/200] train_loss: 5.0852, val_loss: 5.7405, lr: 0.003000, 36.98s
2024-09-28 17:29:21 INFO     Saved model at 13
2024-09-28 17:29:21 INFO     Val loss decrease from 5.9346 to 5.7405, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-28 17:29:46 INFO     epoch complete!
2024-09-28 17:29:46 INFO     evaluating now!
2024-09-28 17:29:49 INFO     Epoch [14/200] train_loss: 4.9891, val_loss: 5.8846, lr: 0.003000, 27.86s
2024-09-28 17:30:14 INFO     epoch complete!
2024-09-28 17:30:14 INFO     evaluating now!
2024-09-28 17:30:17 INFO     Epoch [15/200] train_loss: 4.9395, val_loss: 5.6908, lr: 0.003000, 28.22s
2024-09-28 17:30:17 INFO     Saved model at 15
2024-09-28 17:30:17 INFO     Val loss decrease from 5.7405 to 5.6908, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-28 17:30:43 INFO     epoch complete!
2024-09-28 17:30:43 INFO     evaluating now!
2024-09-28 17:30:45 INFO     Epoch [16/200] train_loss: 4.8215, val_loss: 5.7070, lr: 0.003000, 28.15s
2024-09-28 17:31:10 INFO     epoch complete!
2024-09-28 17:31:10 INFO     evaluating now!
2024-09-28 17:31:13 INFO     Epoch [17/200] train_loss: 4.7064, val_loss: 5.6231, lr: 0.003000, 27.36s
2024-09-28 17:31:13 INFO     Saved model at 17
2024-09-28 17:31:13 INFO     Val loss decrease from 5.6908 to 5.6231, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-28 17:31:38 INFO     epoch complete!
2024-09-28 17:31:38 INFO     evaluating now!
2024-09-28 17:31:41 INFO     Epoch [18/200] train_loss: 4.6932, val_loss: 5.5112, lr: 0.003000, 28.18s
2024-09-28 17:31:41 INFO     Saved model at 18
2024-09-28 17:31:41 INFO     Val loss decrease from 5.6231 to 5.5112, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-28 17:32:05 INFO     epoch complete!
2024-09-28 17:32:05 INFO     evaluating now!
2024-09-28 17:32:08 INFO     Epoch [19/200] train_loss: 4.5335, val_loss: 5.5140, lr: 0.003000, 26.44s
2024-09-28 17:32:30 INFO     epoch complete!
2024-09-28 17:32:30 INFO     evaluating now!
2024-09-28 17:32:33 INFO     Epoch [20/200] train_loss: 4.4758, val_loss: 5.4395, lr: 0.003000, 25.10s
2024-09-28 17:32:33 INFO     Saved model at 20
2024-09-28 17:32:33 INFO     Val loss decrease from 5.5112 to 5.4395, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-28 17:32:55 INFO     epoch complete!
2024-09-28 17:32:55 INFO     evaluating now!
2024-09-28 17:32:57 INFO     Epoch [21/200] train_loss: 4.4039, val_loss: 5.5280, lr: 0.003000, 24.27s
2024-09-28 17:33:20 INFO     epoch complete!
2024-09-28 17:33:20 INFO     evaluating now!
2024-09-28 17:33:23 INFO     Epoch [22/200] train_loss: 4.3384, val_loss: 5.4884, lr: 0.003000, 25.20s
2024-09-28 17:33:45 INFO     epoch complete!
2024-09-28 17:33:45 INFO     evaluating now!
2024-09-28 17:33:48 INFO     Epoch [23/200] train_loss: 4.3544, val_loss: 5.6851, lr: 0.003000, 25.46s
2024-09-28 17:34:10 INFO     epoch complete!
2024-09-28 17:34:10 INFO     evaluating now!
2024-09-28 17:34:13 INFO     Epoch [24/200] train_loss: 4.2498, val_loss: 5.4057, lr: 0.003000, 24.79s
2024-09-28 17:34:13 INFO     Saved model at 24
2024-09-28 17:34:13 INFO     Val loss decrease from 5.4395 to 5.4057, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-28 17:34:37 INFO     epoch complete!
2024-09-28 17:34:37 INFO     evaluating now!
2024-09-28 17:34:40 INFO     Epoch [25/200] train_loss: 4.2029, val_loss: 5.3521, lr: 0.003000, 26.94s
2024-09-28 17:34:40 INFO     Saved model at 25
2024-09-28 17:34:40 INFO     Val loss decrease from 5.4057 to 5.3521, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-28 17:35:06 INFO     epoch complete!
2024-09-28 17:35:06 INFO     evaluating now!
2024-09-28 17:35:10 INFO     Epoch [26/200] train_loss: 4.1689, val_loss: 5.4622, lr: 0.003000, 29.52s
2024-09-28 17:35:35 INFO     epoch complete!
2024-09-28 17:35:35 INFO     evaluating now!
2024-09-28 17:35:38 INFO     Epoch [27/200] train_loss: 4.1982, val_loss: 5.7319, lr: 0.003000, 28.96s
2024-09-28 17:36:03 INFO     epoch complete!
2024-09-28 17:36:03 INFO     evaluating now!
2024-09-28 17:36:06 INFO     Epoch [28/200] train_loss: 4.0935, val_loss: 5.6181, lr: 0.003000, 27.45s
2024-09-28 17:36:31 INFO     epoch complete!
2024-09-28 17:36:31 INFO     evaluating now!
2024-09-28 17:36:34 INFO     Epoch [29/200] train_loss: 4.0289, val_loss: 5.3075, lr: 0.003000, 27.90s
2024-09-28 17:36:34 INFO     Saved model at 29
2024-09-28 17:36:34 INFO     Val loss decrease from 5.3521 to 5.3075, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-28 17:36:58 INFO     epoch complete!
2024-09-28 17:36:58 INFO     evaluating now!
2024-09-28 17:37:00 INFO     Epoch [30/200] train_loss: 3.9498, val_loss: 5.3153, lr: 0.003000, 26.52s
2024-09-28 17:37:25 INFO     epoch complete!
2024-09-28 17:37:25 INFO     evaluating now!
2024-09-28 17:37:28 INFO     Epoch [31/200] train_loss: 3.9579, val_loss: 5.2648, lr: 0.003000, 27.73s
2024-09-28 17:37:28 INFO     Saved model at 31
2024-09-28 17:37:28 INFO     Val loss decrease from 5.3075 to 5.2648, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-09-28 17:37:51 INFO     epoch complete!
2024-09-28 17:37:51 INFO     evaluating now!
2024-09-28 17:37:54 INFO     Epoch [32/200] train_loss: 4.0148, val_loss: 5.5695, lr: 0.003000, 25.51s
2024-09-28 17:38:18 INFO     epoch complete!
2024-09-28 17:38:18 INFO     evaluating now!
2024-09-28 17:38:21 INFO     Epoch [33/200] train_loss: 3.8966, val_loss: 5.5218, lr: 0.003000, 26.69s
2024-09-28 17:38:47 INFO     epoch complete!
2024-09-28 17:38:47 INFO     evaluating now!
2024-09-28 17:38:50 INFO     Epoch [34/200] train_loss: 3.8269, val_loss: 5.3876, lr: 0.003000, 29.33s
2024-09-28 17:39:16 INFO     epoch complete!
2024-09-28 17:39:16 INFO     evaluating now!
2024-09-28 17:39:18 INFO     Epoch [35/200] train_loss: 3.7997, val_loss: 5.2361, lr: 0.003000, 28.61s
2024-09-28 17:39:19 INFO     Saved model at 35
2024-09-28 17:39:19 INFO     Val loss decrease from 5.2648 to 5.2361, saving to ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-28 17:39:43 INFO     epoch complete!
2024-09-28 17:39:43 INFO     evaluating now!
2024-09-28 17:39:46 INFO     Epoch [36/200] train_loss: 3.7485, val_loss: 5.3407, lr: 0.003000, 27.12s
2024-09-28 17:40:07 INFO     epoch complete!
2024-09-28 17:40:07 INFO     evaluating now!
2024-09-28 17:40:10 INFO     Epoch [37/200] train_loss: 3.7633, val_loss: 5.6470, lr: 0.003000, 24.00s
2024-09-28 17:40:32 INFO     epoch complete!
2024-09-28 17:40:32 INFO     evaluating now!
2024-09-28 17:40:35 INFO     Epoch [38/200] train_loss: 3.7546, val_loss: 5.2995, lr: 0.003000, 25.26s
2024-09-28 17:40:59 INFO     epoch complete!
2024-09-28 17:40:59 INFO     evaluating now!
2024-09-28 17:41:02 INFO     Epoch [39/200] train_loss: 3.7201, val_loss: 5.3652, lr: 0.003000, 27.03s
2024-09-28 17:41:27 INFO     epoch complete!
2024-09-28 17:41:27 INFO     evaluating now!
2024-09-28 17:41:29 INFO     Epoch [40/200] train_loss: 3.6280, val_loss: 5.2465, lr: 0.003000, 27.23s
2024-09-28 17:41:53 INFO     epoch complete!
2024-09-28 17:41:53 INFO     evaluating now!
2024-09-28 17:41:56 INFO     Epoch [41/200] train_loss: 3.6027, val_loss: 5.2928, lr: 0.003000, 26.39s
2024-09-28 17:42:19 INFO     epoch complete!
2024-09-28 17:42:19 INFO     evaluating now!
2024-09-28 17:42:21 INFO     Epoch [42/200] train_loss: 3.5955, val_loss: 5.3484, lr: 0.003000, 25.30s
2024-09-28 17:42:44 INFO     epoch complete!
2024-09-28 17:42:44 INFO     evaluating now!
2024-09-28 17:42:46 INFO     Epoch [43/200] train_loss: 3.5736, val_loss: 5.3235, lr: 0.003000, 25.20s
2024-09-28 17:43:10 INFO     epoch complete!
2024-09-28 17:43:10 INFO     evaluating now!
2024-09-28 17:43:12 INFO     Epoch [44/200] train_loss: 3.5495, val_loss: 5.3716, lr: 0.003000, 26.22s
2024-09-28 17:43:34 INFO     epoch complete!
2024-09-28 17:43:34 INFO     evaluating now!
2024-09-28 17:43:37 INFO     Epoch [45/200] train_loss: 3.5126, val_loss: 5.3338, lr: 0.003000, 24.57s
2024-09-28 17:44:00 INFO     epoch complete!
2024-09-28 17:44:00 INFO     evaluating now!
2024-09-28 17:44:03 INFO     Epoch [46/200] train_loss: 3.5393, val_loss: 5.4778, lr: 0.003000, 26.50s
2024-09-28 17:44:27 INFO     epoch complete!
2024-09-28 17:44:27 INFO     evaluating now!
2024-09-28 17:44:30 INFO     Epoch [47/200] train_loss: 3.4485, val_loss: 5.5247, lr: 0.003000, 26.48s
2024-09-28 17:44:54 INFO     epoch complete!
2024-09-28 17:44:54 INFO     evaluating now!
2024-09-28 17:44:57 INFO     Epoch [48/200] train_loss: 3.4716, val_loss: 5.3478, lr: 0.003000, 26.84s
2024-09-28 17:45:21 INFO     epoch complete!
2024-09-28 17:45:21 INFO     evaluating now!
2024-09-28 17:45:23 INFO     Epoch [49/200] train_loss: 3.4398, val_loss: 5.4807, lr: 0.003000, 26.58s
2024-09-28 17:45:47 INFO     epoch complete!
2024-09-28 17:45:47 INFO     evaluating now!
2024-09-28 17:45:51 INFO     Epoch [50/200] train_loss: 3.4708, val_loss: 5.4517, lr: 0.003000, 27.18s
2024-09-28 17:45:51 WARNING  Early stopping at epoch: 50
2024-09-28 17:45:51 INFO     Trained totally 51 epochs, average train time is 24.423s, average eval time is 2.894s
2024-09-28 17:45:51 INFO     Loaded model at 35
2024-09-28 17:45:51 INFO     Saved model at ./libcity/cache/1003/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 17:45:51 INFO     Start evaluating ...
2024-09-28 17:45:57 INFO     Note that you select the single mode to evaluate!
2024-09-28 17:45:57 INFO     Evaluate result is saved at ./libcity/cache/1003/evaluate_cache/2024_09_28_17_45_57_AGCRN_CHITaxi20190406.csv
2024-09-28 17:45:57 INFO     
         MAE       RMSE  masked_MAPE
1   2.507262   7.320526     0.479235
2   2.538728   7.689807     0.450963
3   2.727946   8.717703     0.454986
4   3.000219   9.995117     0.477158
5   3.167389  11.137159     0.474500
6   3.327844  11.929044     0.504653
7   3.475328  12.290463     0.544003
8   3.475207  12.309959     0.540003
9   3.454514  12.331916     0.530151
10  3.499175  12.505388     0.539577
11  3.552448  12.722521     0.536805
12  3.618550  13.438745     0.520623
2024-09-28 17:45:58 INFO     ----------------------------------------------------------------------------
2024-09-28 17:45:58 INFO     # 4, Kownledge Graph Embedding: GIE, Experiment ids: 1004
2024-09-28 17:45:58 INFO     ----------------------------------------------------------------------------
2024-09-28 17:45:58 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=1004
2024-09-28 17:45:58 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 1004, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'MultiHop', 'max_hop': 1, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 17:45:58 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 17:45:58 INFO     set_weight_link_or_dist: dist
2024-09-28 17:45:58 INFO     init_weight_inf_or_zero: inf
2024-09-28 17:45:58 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 17:45:58 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 17:45:58 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 17:45:58 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 17:45:58 INFO     Dataset created
2024-09-28 17:45:58 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-28 17:45:58 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-28 17:45:58 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-28 17:45:58 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-28 17:45:58 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 17:45:58 INFO     NoneScaler
2024-09-28 17:45:58 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 17:45:58 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 17:45:58 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 17:45:58 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 17:45:58 INFO     encoder.dcrnn_cells.0.gate.weights_pool2	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-09-28 17:45:58 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 17:45:58 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 17:45:58 INFO     encoder.dcrnn_cells.0.update.weights_pool2	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-09-28 17:45:58 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 17:45:58 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 17:45:58 INFO     encoder.dcrnn_cells.1.gate.weights_pool2	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 17:45:58 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 17:45:58 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 17:45:58 INFO     encoder.dcrnn_cells.1.update.weights_pool2	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 17:45:58 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 17:45:58 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 17:45:58 INFO     Total parameter numbers: 1496090
2024-09-28 17:45:58 INFO     You select `adam` optimizer.
2024-09-28 17:45:58 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 17:45:58 INFO     Start training ...
2024-09-28 17:45:58 INFO     num_batches:48
2024-09-28 17:46:24 INFO     epoch complete!
2024-09-28 17:46:24 INFO     evaluating now!
2024-09-28 17:46:27 INFO     Epoch [0/200] train_loss: 22.2971, val_loss: 16.7101, lr: 0.003000, 28.97s
2024-09-28 17:46:27 INFO     Saved model at 0
2024-09-28 17:46:27 INFO     Val loss decrease from inf to 16.7101, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 17:46:52 INFO     epoch complete!
2024-09-28 17:46:52 INFO     evaluating now!
2024-09-28 17:46:55 INFO     Epoch [1/200] train_loss: 13.2918, val_loss: 12.8907, lr: 0.003000, 27.16s
2024-09-28 17:46:55 INFO     Saved model at 1
2024-09-28 17:46:55 INFO     Val loss decrease from 16.7101 to 12.8907, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 17:47:20 INFO     epoch complete!
2024-09-28 17:47:20 INFO     evaluating now!
2024-09-28 17:47:22 INFO     Epoch [2/200] train_loss: 10.2388, val_loss: 9.9816, lr: 0.003000, 27.72s
2024-09-28 17:47:23 INFO     Saved model at 2
2024-09-28 17:47:23 INFO     Val loss decrease from 12.8907 to 9.9816, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 17:47:46 INFO     epoch complete!
2024-09-28 17:47:46 INFO     evaluating now!
2024-09-28 17:47:49 INFO     Epoch [3/200] train_loss: 8.2558, val_loss: 8.1115, lr: 0.003000, 26.03s
2024-09-28 17:47:49 INFO     Saved model at 3
2024-09-28 17:47:49 INFO     Val loss decrease from 9.9816 to 8.1115, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 17:48:15 INFO     epoch complete!
2024-09-28 17:48:15 INFO     evaluating now!
2024-09-28 17:48:18 INFO     Epoch [4/200] train_loss: 7.1309, val_loss: 7.2239, lr: 0.003000, 29.55s
2024-09-28 17:48:19 INFO     Saved model at 4
2024-09-28 17:48:19 INFO     Val loss decrease from 8.1115 to 7.2239, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 17:48:44 INFO     epoch complete!
2024-09-28 17:48:44 INFO     evaluating now!
2024-09-28 17:48:47 INFO     Epoch [5/200] train_loss: 6.5873, val_loss: 6.7596, lr: 0.003000, 28.42s
2024-09-28 17:48:47 INFO     Saved model at 5
2024-09-28 17:48:47 INFO     Val loss decrease from 7.2239 to 6.7596, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 17:49:12 INFO     epoch complete!
2024-09-28 17:49:12 INFO     evaluating now!
2024-09-28 17:49:15 INFO     Epoch [6/200] train_loss: 6.0034, val_loss: 6.2583, lr: 0.003000, 27.68s
2024-09-28 17:49:15 INFO     Saved model at 6
2024-09-28 17:49:15 INFO     Val loss decrease from 6.7596 to 6.2583, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-28 17:49:41 INFO     epoch complete!
2024-09-28 17:49:41 INFO     evaluating now!
2024-09-28 17:49:44 INFO     Epoch [7/200] train_loss: 5.7162, val_loss: 6.2045, lr: 0.003000, 28.54s
2024-09-28 17:49:44 INFO     Saved model at 7
2024-09-28 17:49:44 INFO     Val loss decrease from 6.2583 to 6.2045, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-28 17:50:08 INFO     epoch complete!
2024-09-28 17:50:08 INFO     evaluating now!
2024-09-28 17:50:11 INFO     Epoch [8/200] train_loss: 5.5396, val_loss: 5.9201, lr: 0.003000, 27.23s
2024-09-28 17:50:11 INFO     Saved model at 8
2024-09-28 17:50:11 INFO     Val loss decrease from 6.2045 to 5.9201, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-28 17:50:38 INFO     epoch complete!
2024-09-28 17:50:38 INFO     evaluating now!
2024-09-28 17:50:41 INFO     Epoch [9/200] train_loss: 5.3016, val_loss: 5.8387, lr: 0.003000, 29.85s
2024-09-28 17:50:41 INFO     Saved model at 9
2024-09-28 17:50:41 INFO     Val loss decrease from 5.9201 to 5.8387, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-28 17:51:04 INFO     epoch complete!
2024-09-28 17:51:04 INFO     evaluating now!
2024-09-28 17:51:07 INFO     Epoch [10/200] train_loss: 5.1554, val_loss: 5.8103, lr: 0.003000, 25.89s
2024-09-28 17:51:07 INFO     Saved model at 10
2024-09-28 17:51:07 INFO     Val loss decrease from 5.8387 to 5.8103, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-28 17:51:31 INFO     epoch complete!
2024-09-28 17:51:31 INFO     evaluating now!
2024-09-28 17:51:34 INFO     Epoch [11/200] train_loss: 5.0072, val_loss: 5.4865, lr: 0.003000, 26.90s
2024-09-28 17:51:34 INFO     Saved model at 11
2024-09-28 17:51:34 INFO     Val loss decrease from 5.8103 to 5.4865, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-28 17:51:57 INFO     epoch complete!
2024-09-28 17:51:57 INFO     evaluating now!
2024-09-28 17:51:59 INFO     Epoch [12/200] train_loss: 4.9207, val_loss: 5.9485, lr: 0.003000, 24.77s
2024-09-28 17:52:23 INFO     epoch complete!
2024-09-28 17:52:23 INFO     evaluating now!
2024-09-28 17:52:25 INFO     Epoch [13/200] train_loss: 4.8993, val_loss: 5.4700, lr: 0.003000, 26.05s
2024-09-28 17:52:25 INFO     Saved model at 13
2024-09-28 17:52:25 INFO     Val loss decrease from 5.4865 to 5.4700, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-28 17:52:49 INFO     epoch complete!
2024-09-28 17:52:49 INFO     evaluating now!
2024-09-28 17:52:51 INFO     Epoch [14/200] train_loss: 4.7414, val_loss: 5.5542, lr: 0.003000, 25.88s
2024-09-28 17:53:13 INFO     epoch complete!
2024-09-28 17:53:13 INFO     evaluating now!
2024-09-28 17:53:15 INFO     Epoch [15/200] train_loss: 4.6497, val_loss: 5.4952, lr: 0.003000, 24.36s
2024-09-28 17:53:38 INFO     epoch complete!
2024-09-28 17:53:38 INFO     evaluating now!
2024-09-28 17:53:40 INFO     Epoch [16/200] train_loss: 4.5789, val_loss: 5.5631, lr: 0.003000, 24.82s
2024-09-28 17:54:02 INFO     epoch complete!
2024-09-28 17:54:02 INFO     evaluating now!
2024-09-28 17:54:04 INFO     Epoch [17/200] train_loss: 4.5057, val_loss: 5.3083, lr: 0.003000, 24.12s
2024-09-28 17:54:05 INFO     Saved model at 17
2024-09-28 17:54:05 INFO     Val loss decrease from 5.4700 to 5.3083, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-28 17:54:26 INFO     epoch complete!
2024-09-28 17:54:26 INFO     evaluating now!
2024-09-28 17:54:28 INFO     Epoch [18/200] train_loss: 4.4749, val_loss: 5.5667, lr: 0.003000, 23.84s
2024-09-28 17:54:52 INFO     epoch complete!
2024-09-28 17:54:52 INFO     evaluating now!
2024-09-28 17:54:55 INFO     Epoch [19/200] train_loss: 4.3845, val_loss: 5.3791, lr: 0.003000, 26.39s
2024-09-28 17:55:17 INFO     epoch complete!
2024-09-28 17:55:17 INFO     evaluating now!
2024-09-28 17:55:20 INFO     Epoch [20/200] train_loss: 4.3174, val_loss: 5.3528, lr: 0.003000, 24.93s
2024-09-28 17:55:42 INFO     epoch complete!
2024-09-28 17:55:42 INFO     evaluating now!
2024-09-28 17:55:44 INFO     Epoch [21/200] train_loss: 4.2324, val_loss: 5.1708, lr: 0.003000, 24.12s
2024-09-28 17:55:44 INFO     Saved model at 21
2024-09-28 17:55:44 INFO     Val loss decrease from 5.3083 to 5.1708, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-28 17:56:06 INFO     epoch complete!
2024-09-28 17:56:06 INFO     evaluating now!
2024-09-28 17:56:09 INFO     Epoch [22/200] train_loss: 4.1903, val_loss: 5.3680, lr: 0.003000, 24.89s
2024-09-28 17:56:31 INFO     epoch complete!
2024-09-28 17:56:31 INFO     evaluating now!
2024-09-28 17:56:33 INFO     Epoch [23/200] train_loss: 4.1428, val_loss: 5.1934, lr: 0.003000, 24.22s
2024-09-28 17:56:56 INFO     epoch complete!
2024-09-28 17:56:56 INFO     evaluating now!
2024-09-28 17:56:58 INFO     Epoch [24/200] train_loss: 4.1208, val_loss: 5.3090, lr: 0.003000, 25.10s
2024-09-28 17:57:19 INFO     epoch complete!
2024-09-28 17:57:19 INFO     evaluating now!
2024-09-28 17:57:21 INFO     Epoch [25/200] train_loss: 4.1163, val_loss: 5.1379, lr: 0.003000, 22.79s
2024-09-28 17:57:21 INFO     Saved model at 25
2024-09-28 17:57:21 INFO     Val loss decrease from 5.1708 to 5.1379, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-28 17:57:43 INFO     epoch complete!
2024-09-28 17:57:43 INFO     evaluating now!
2024-09-28 17:57:45 INFO     Epoch [26/200] train_loss: 4.0158, val_loss: 5.1342, lr: 0.003000, 24.14s
2024-09-28 17:57:45 INFO     Saved model at 26
2024-09-28 17:57:45 INFO     Val loss decrease from 5.1379 to 5.1342, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-28 17:58:07 INFO     epoch complete!
2024-09-28 17:58:07 INFO     evaluating now!
2024-09-28 17:58:10 INFO     Epoch [27/200] train_loss: 3.9748, val_loss: 5.1151, lr: 0.003000, 24.33s
2024-09-28 17:58:10 INFO     Saved model at 27
2024-09-28 17:58:10 INFO     Val loss decrease from 5.1342 to 5.1151, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-28 17:58:32 INFO     epoch complete!
2024-09-28 17:58:32 INFO     evaluating now!
2024-09-28 17:58:34 INFO     Epoch [28/200] train_loss: 3.8901, val_loss: 5.1275, lr: 0.003000, 24.35s
2024-09-28 17:58:56 INFO     epoch complete!
2024-09-28 17:58:56 INFO     evaluating now!
2024-09-28 17:58:58 INFO     Epoch [29/200] train_loss: 3.8454, val_loss: 5.1632, lr: 0.003000, 23.79s
2024-09-28 17:59:19 INFO     epoch complete!
2024-09-28 17:59:19 INFO     evaluating now!
2024-09-28 17:59:22 INFO     Epoch [30/200] train_loss: 3.8396, val_loss: 5.2197, lr: 0.003000, 23.93s
2024-09-28 17:59:44 INFO     epoch complete!
2024-09-28 17:59:44 INFO     evaluating now!
2024-09-28 17:59:47 INFO     Epoch [31/200] train_loss: 3.8106, val_loss: 5.1986, lr: 0.003000, 24.63s
2024-09-28 18:00:09 INFO     epoch complete!
2024-09-28 18:00:09 INFO     evaluating now!
2024-09-28 18:00:11 INFO     Epoch [32/200] train_loss: 3.7886, val_loss: 5.0089, lr: 0.003000, 24.64s
2024-09-28 18:00:11 INFO     Saved model at 32
2024-09-28 18:00:11 INFO     Val loss decrease from 5.1151 to 5.0089, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-09-28 18:00:34 INFO     epoch complete!
2024-09-28 18:00:34 INFO     evaluating now!
2024-09-28 18:00:36 INFO     Epoch [33/200] train_loss: 3.7820, val_loss: 5.1385, lr: 0.003000, 24.57s
2024-09-28 18:00:59 INFO     epoch complete!
2024-09-28 18:00:59 INFO     evaluating now!
2024-09-28 18:01:02 INFO     Epoch [34/200] train_loss: 3.7492, val_loss: 5.0912, lr: 0.003000, 25.77s
2024-09-28 18:01:23 INFO     epoch complete!
2024-09-28 18:01:23 INFO     evaluating now!
2024-09-28 18:01:26 INFO     Epoch [35/200] train_loss: 3.6654, val_loss: 5.0827, lr: 0.003000, 24.37s
2024-09-28 18:01:48 INFO     epoch complete!
2024-09-28 18:01:48 INFO     evaluating now!
2024-09-28 18:01:50 INFO     Epoch [36/200] train_loss: 3.6765, val_loss: 5.0406, lr: 0.003000, 24.25s
2024-09-28 18:02:12 INFO     epoch complete!
2024-09-28 18:02:12 INFO     evaluating now!
2024-09-28 18:02:15 INFO     Epoch [37/200] train_loss: 3.6464, val_loss: 5.2156, lr: 0.003000, 24.59s
2024-09-28 18:02:38 INFO     epoch complete!
2024-09-28 18:02:38 INFO     evaluating now!
2024-09-28 18:02:40 INFO     Epoch [38/200] train_loss: 3.6510, val_loss: 5.2424, lr: 0.003000, 25.43s
2024-09-28 18:03:05 INFO     epoch complete!
2024-09-28 18:03:05 INFO     evaluating now!
2024-09-28 18:03:08 INFO     Epoch [39/200] train_loss: 3.6106, val_loss: 5.0632, lr: 0.003000, 27.77s
2024-09-28 18:03:31 INFO     epoch complete!
2024-09-28 18:03:31 INFO     evaluating now!
2024-09-28 18:03:34 INFO     Epoch [40/200] train_loss: 3.5416, val_loss: 4.9528, lr: 0.003000, 25.77s
2024-09-28 18:03:34 INFO     Saved model at 40
2024-09-28 18:03:34 INFO     Val loss decrease from 5.0089 to 4.9528, saving to ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-09-28 18:03:56 INFO     epoch complete!
2024-09-28 18:03:56 INFO     evaluating now!
2024-09-28 18:03:59 INFO     Epoch [41/200] train_loss: 3.4854, val_loss: 5.0214, lr: 0.003000, 24.58s
2024-09-28 18:04:21 INFO     epoch complete!
2024-09-28 18:04:21 INFO     evaluating now!
2024-09-28 18:04:24 INFO     Epoch [42/200] train_loss: 3.4914, val_loss: 5.0235, lr: 0.003000, 24.83s
2024-09-28 18:04:45 INFO     epoch complete!
2024-09-28 18:04:45 INFO     evaluating now!
2024-09-28 18:04:48 INFO     Epoch [43/200] train_loss: 3.4710, val_loss: 5.0788, lr: 0.003000, 24.20s
2024-09-28 18:05:08 INFO     epoch complete!
2024-09-28 18:05:08 INFO     evaluating now!
2024-09-28 18:05:10 INFO     Epoch [44/200] train_loss: 3.4827, val_loss: 5.1284, lr: 0.003000, 22.67s
2024-09-28 18:05:31 INFO     epoch complete!
2024-09-28 18:05:31 INFO     evaluating now!
2024-09-28 18:05:33 INFO     Epoch [45/200] train_loss: 3.4112, val_loss: 5.1813, lr: 0.003000, 22.82s
2024-09-28 18:05:53 INFO     epoch complete!
2024-09-28 18:05:53 INFO     evaluating now!
2024-09-28 18:05:56 INFO     Epoch [46/200] train_loss: 3.4599, val_loss: 5.2446, lr: 0.003000, 22.79s
2024-09-28 18:06:19 INFO     epoch complete!
2024-09-28 18:06:19 INFO     evaluating now!
2024-09-28 18:06:22 INFO     Epoch [47/200] train_loss: 3.3989, val_loss: 5.1356, lr: 0.003000, 25.64s
2024-09-28 18:06:43 INFO     epoch complete!
2024-09-28 18:06:43 INFO     evaluating now!
2024-09-28 18:06:46 INFO     Epoch [48/200] train_loss: 3.3873, val_loss: 5.1107, lr: 0.003000, 24.30s
2024-09-28 18:07:09 INFO     epoch complete!
2024-09-28 18:07:09 INFO     evaluating now!
2024-09-28 18:07:12 INFO     Epoch [49/200] train_loss: 3.3529, val_loss: 5.1640, lr: 0.003000, 25.57s
2024-09-28 18:07:34 INFO     epoch complete!
2024-09-28 18:07:34 INFO     evaluating now!
2024-09-28 18:07:36 INFO     Epoch [50/200] train_loss: 3.3333, val_loss: 5.1295, lr: 0.003000, 24.74s
2024-09-28 18:07:59 INFO     epoch complete!
2024-09-28 18:07:59 INFO     evaluating now!
2024-09-28 18:08:01 INFO     Epoch [51/200] train_loss: 3.3012, val_loss: 5.1896, lr: 0.003000, 25.05s
2024-09-28 18:08:24 INFO     epoch complete!
2024-09-28 18:08:24 INFO     evaluating now!
2024-09-28 18:08:28 INFO     Epoch [52/200] train_loss: 3.3116, val_loss: 5.1817, lr: 0.003000, 26.29s
2024-09-28 18:08:50 INFO     epoch complete!
2024-09-28 18:08:50 INFO     evaluating now!
2024-09-28 18:08:52 INFO     Epoch [53/200] train_loss: 3.2729, val_loss: 5.1346, lr: 0.003000, 24.38s
2024-09-28 18:09:14 INFO     epoch complete!
2024-09-28 18:09:14 INFO     evaluating now!
2024-09-28 18:09:16 INFO     Epoch [54/200] train_loss: 3.2790, val_loss: 5.0102, lr: 0.003000, 24.49s
2024-09-28 18:09:39 INFO     epoch complete!
2024-09-28 18:09:39 INFO     evaluating now!
2024-09-28 18:09:41 INFO     Epoch [55/200] train_loss: 3.2814, val_loss: 5.1604, lr: 0.003000, 24.34s
2024-09-28 18:09:41 WARNING  Early stopping at epoch: 55
2024-09-28 18:09:41 INFO     Trained totally 56 epochs, average train time is 22.760s, average eval time is 2.583s
2024-09-28 18:09:41 INFO     Loaded model at 40
2024-09-28 18:09:41 INFO     Saved model at ./libcity/cache/1004/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 18:09:41 INFO     Start evaluating ...
2024-09-28 18:09:47 INFO     Note that you select the single mode to evaluate!
2024-09-28 18:09:47 INFO     Evaluate result is saved at ./libcity/cache/1004/evaluate_cache/2024_09_28_18_09_47_AGCRN_CHITaxi20190406.csv
2024-09-28 18:09:47 INFO     
         MAE       RMSE  masked_MAPE
1   2.416102   6.831607     0.431964
2   2.533963   7.434817     0.434755
3   2.763752   8.736289     0.447289
4   2.921452  10.103739     0.435837
5   3.091008  11.499771     0.435975
6   3.156303  12.601155     0.429429
7   3.265359  13.237938     0.437838
8   3.335487  13.431123     0.445555
9   3.411026  13.449224     0.460680
10  3.464262  13.531375     0.472120
11  3.578332  13.868890     0.498238
12  3.658695  14.563396     0.495238
2024-09-28 18:09:47 INFO     ----------------------------------------------------------------------------
2024-09-28 18:09:47 INFO     Kownledge Graph Embedding: GIE, Experiment ids: [1000, 1001, 1002, 1003, 1004]
2024-09-28 18:09:47 INFO     ----------------------------------------------------------------------------
2024-09-28 18:09:47 INFO     Average: 
         MAE       RMSE  masked_MAPE
0   2.396352   7.228127     0.428521
1   2.493492   7.739346     0.423894
2   2.661367   8.833130     0.431811
3   2.836726   9.917422     0.429903
4   3.006396  10.984127     0.431852
5   3.118785  11.893704     0.441814
6   3.238045  12.505108     0.456084
7   3.264394  12.803312     0.458268
8   3.274167  12.909272     0.460713
9   3.334522  13.046674     0.470654
10  3.370982  13.282674     0.476988
11  3.503513  13.955524     0.482459 
2024-09-28 18:09:47 INFO     Standard deviation: 
         MAE      RMSE  masked_MAPE
0   0.085419  0.373077     0.027266
1   0.055485  0.314497     0.017274
2   0.091080  0.130701     0.016061
3   0.104996  0.149776     0.025404
4   0.104170  0.352585     0.022767
5   0.117087  0.466514     0.032710
6   0.139882  0.565817     0.044413
7   0.128287  0.561634     0.041513
8   0.140634  0.481202     0.035959
9   0.127557  0.418087     0.035980
10  0.159520  0.444803     0.035551
11  0.132616  0.529958     0.024786
2024-09-28 18:09:47 INFO     ----------------------------------------------------------------------------
2024-09-28 18:09:47 INFO     12 steps Average: 
        MAE       RMSE  masked_MAPE
0  3.041562  11.258202     0.449413
2024-09-28 18:09:47 INFO     12 steps Standard deviation: 
        MAE      RMSE  masked_MAPE
0  0.115561  0.399054     0.029974
