2024-04-30 19:40:03 INFO     ----------------------------------------------------------------------------
2024-04-30 19:40:03 INFO     # 0, Kownledge Graph Embedding: RotE, Experiment ids: 25
2024-04-30 19:40:03 INFO     ----------------------------------------------------------------------------
2024-04-30 19:40:03 INFO     Log directory: ./libcity/log
2024-04-30 19:40:03 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=25
2024-04-30 19:40:03 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 615424522, 'exp_id': 25, 'load_external': True, 'embedding_model': 'RotE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 19:40:03 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 19:40:03 INFO     set_weight_link_or_dist: dist
2024-04-30 19:40:03 INFO     init_weight_inf_or_zero: inf
2024-04-30 19:40:03 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 19:40:03 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 19:40:03 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 19:40:04 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 19:40:06 INFO     Dataset created
2024-04-30 19:40:06 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 19:40:06 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 19:40:06 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 19:40:06 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 19:40:07 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 19:40:07 INFO     NoneScaler
2024-04-30 19:40:12 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 19:40:12 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 19:40:12 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 19:40:12 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 19:40:12 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 19:40:12 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 19:40:12 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 19:40:12 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 19:40:12 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 19:40:12 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 19:40:12 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 19:40:12 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 19:40:12 INFO     Total parameter numbers: 874010
2024-04-30 19:40:12 INFO     You select `adam` optimizer.
2024-04-30 19:40:12 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 19:40:12 INFO     Start training ...
2024-04-30 19:40:12 INFO     num_batches:48
2024-04-30 19:40:19 INFO     epoch complete!
2024-04-30 19:40:19 INFO     evaluating now!
2024-04-30 19:40:19 INFO     Epoch [0/200] train_loss: 24.5249, val_loss: 18.7054, lr: 0.003000, 7.34s
2024-04-30 19:40:19 INFO     Saved model at 0
2024-04-30 19:40:19 INFO     Val loss decrease from inf to 18.7054, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 19:40:26 INFO     epoch complete!
2024-04-30 19:40:26 INFO     evaluating now!
2024-04-30 19:40:26 INFO     Epoch [1/200] train_loss: 15.3575, val_loss: 14.7821, lr: 0.003000, 6.85s
2024-04-30 19:40:26 INFO     Saved model at 1
2024-04-30 19:40:26 INFO     Val loss decrease from 18.7054 to 14.7821, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 19:40:33 INFO     epoch complete!
2024-04-30 19:40:33 INFO     evaluating now!
2024-04-30 19:40:33 INFO     Epoch [2/200] train_loss: 12.3275, val_loss: 12.0213, lr: 0.003000, 6.90s
2024-04-30 19:40:33 INFO     Saved model at 2
2024-04-30 19:40:33 INFO     Val loss decrease from 14.7821 to 12.0213, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 19:40:40 INFO     epoch complete!
2024-04-30 19:40:40 INFO     evaluating now!
2024-04-30 19:40:40 INFO     Epoch [3/200] train_loss: 10.3692, val_loss: 10.5737, lr: 0.003000, 6.97s
2024-04-30 19:40:40 INFO     Saved model at 3
2024-04-30 19:40:40 INFO     Val loss decrease from 12.0213 to 10.5737, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 19:40:47 INFO     epoch complete!
2024-04-30 19:40:47 INFO     evaluating now!
2024-04-30 19:40:47 INFO     Epoch [4/200] train_loss: 8.9543, val_loss: 8.9319, lr: 0.003000, 6.86s
2024-04-30 19:40:47 INFO     Saved model at 4
2024-04-30 19:40:47 INFO     Val loss decrease from 10.5737 to 8.9319, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 19:40:54 INFO     epoch complete!
2024-04-30 19:40:54 INFO     evaluating now!
2024-04-30 19:40:54 INFO     Epoch [5/200] train_loss: 8.0612, val_loss: 8.3623, lr: 0.003000, 6.89s
2024-04-30 19:40:54 INFO     Saved model at 5
2024-04-30 19:40:54 INFO     Val loss decrease from 8.9319 to 8.3623, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 19:41:00 INFO     epoch complete!
2024-04-30 19:41:00 INFO     evaluating now!
2024-04-30 19:41:01 INFO     Epoch [6/200] train_loss: 7.4249, val_loss: 7.2423, lr: 0.003000, 6.88s
2024-04-30 19:41:01 INFO     Saved model at 6
2024-04-30 19:41:01 INFO     Val loss decrease from 8.3623 to 7.2423, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 19:41:07 INFO     epoch complete!
2024-04-30 19:41:07 INFO     evaluating now!
2024-04-30 19:41:08 INFO     Epoch [7/200] train_loss: 6.9424, val_loss: 6.9710, lr: 0.003000, 6.78s
2024-04-30 19:41:08 INFO     Saved model at 7
2024-04-30 19:41:08 INFO     Val loss decrease from 7.2423 to 6.9710, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 19:41:14 INFO     epoch complete!
2024-04-30 19:41:14 INFO     evaluating now!
2024-04-30 19:41:14 INFO     Epoch [8/200] train_loss: 6.5354, val_loss: 6.3627, lr: 0.003000, 6.68s
2024-04-30 19:41:15 INFO     Saved model at 8
2024-04-30 19:41:15 INFO     Val loss decrease from 6.9710 to 6.3627, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 19:41:21 INFO     epoch complete!
2024-04-30 19:41:21 INFO     evaluating now!
2024-04-30 19:41:21 INFO     Epoch [9/200] train_loss: 6.1892, val_loss: 6.3516, lr: 0.003000, 6.72s
2024-04-30 19:41:21 INFO     Saved model at 9
2024-04-30 19:41:21 INFO     Val loss decrease from 6.3627 to 6.3516, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 19:41:28 INFO     epoch complete!
2024-04-30 19:41:28 INFO     evaluating now!
2024-04-30 19:41:28 INFO     Epoch [10/200] train_loss: 6.0372, val_loss: 6.6105, lr: 0.003000, 6.77s
2024-04-30 19:41:34 INFO     epoch complete!
2024-04-30 19:41:34 INFO     evaluating now!
2024-04-30 19:41:35 INFO     Epoch [11/200] train_loss: 5.8621, val_loss: 6.2132, lr: 0.003000, 6.78s
2024-04-30 19:41:35 INFO     Saved model at 11
2024-04-30 19:41:35 INFO     Val loss decrease from 6.3516 to 6.2132, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 19:41:41 INFO     epoch complete!
2024-04-30 19:41:41 INFO     evaluating now!
2024-04-30 19:41:42 INFO     Epoch [12/200] train_loss: 5.7279, val_loss: 6.1455, lr: 0.003000, 7.07s
2024-04-30 19:41:42 INFO     Saved model at 12
2024-04-30 19:41:42 INFO     Val loss decrease from 6.2132 to 6.1455, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 19:41:49 INFO     epoch complete!
2024-04-30 19:41:49 INFO     evaluating now!
2024-04-30 19:41:49 INFO     Epoch [13/200] train_loss: 5.7056, val_loss: 6.1084, lr: 0.003000, 7.20s
2024-04-30 19:41:49 INFO     Saved model at 13
2024-04-30 19:41:49 INFO     Val loss decrease from 6.1455 to 6.1084, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 19:41:56 INFO     epoch complete!
2024-04-30 19:41:56 INFO     evaluating now!
2024-04-30 19:41:56 INFO     Epoch [14/200] train_loss: 5.5972, val_loss: 6.0461, lr: 0.003000, 6.87s
2024-04-30 19:41:56 INFO     Saved model at 14
2024-04-30 19:41:56 INFO     Val loss decrease from 6.1084 to 6.0461, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 19:42:03 INFO     epoch complete!
2024-04-30 19:42:03 INFO     evaluating now!
2024-04-30 19:42:03 INFO     Epoch [15/200] train_loss: 5.4642, val_loss: 5.7483, lr: 0.003000, 6.94s
2024-04-30 19:42:03 INFO     Saved model at 15
2024-04-30 19:42:03 INFO     Val loss decrease from 6.0461 to 5.7483, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 19:42:10 INFO     epoch complete!
2024-04-30 19:42:10 INFO     evaluating now!
2024-04-30 19:42:10 INFO     Epoch [16/200] train_loss: 5.3768, val_loss: 5.7012, lr: 0.003000, 6.90s
2024-04-30 19:42:10 INFO     Saved model at 16
2024-04-30 19:42:10 INFO     Val loss decrease from 5.7483 to 5.7012, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 19:42:16 INFO     epoch complete!
2024-04-30 19:42:16 INFO     evaluating now!
2024-04-30 19:42:17 INFO     Epoch [17/200] train_loss: 5.2851, val_loss: 5.8029, lr: 0.003000, 6.67s
2024-04-30 19:42:23 INFO     epoch complete!
2024-04-30 19:42:23 INFO     evaluating now!
2024-04-30 19:42:23 INFO     Epoch [18/200] train_loss: 5.2150, val_loss: 5.4475, lr: 0.003000, 6.66s
2024-04-30 19:42:23 INFO     Saved model at 18
2024-04-30 19:42:23 INFO     Val loss decrease from 5.7012 to 5.4475, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 19:42:30 INFO     epoch complete!
2024-04-30 19:42:30 INFO     evaluating now!
2024-04-30 19:42:30 INFO     Epoch [19/200] train_loss: 5.1057, val_loss: 5.8188, lr: 0.003000, 6.90s
2024-04-30 19:42:36 INFO     epoch complete!
2024-04-30 19:42:36 INFO     evaluating now!
2024-04-30 19:42:37 INFO     Epoch [20/200] train_loss: 5.0152, val_loss: 5.5031, lr: 0.003000, 6.29s
2024-04-30 19:42:42 INFO     epoch complete!
2024-04-30 19:42:42 INFO     evaluating now!
2024-04-30 19:42:43 INFO     Epoch [21/200] train_loss: 4.9280, val_loss: 5.8151, lr: 0.003000, 6.21s
2024-04-30 19:42:49 INFO     epoch complete!
2024-04-30 19:42:49 INFO     evaluating now!
2024-04-30 19:42:49 INFO     Epoch [22/200] train_loss: 4.9576, val_loss: 5.4249, lr: 0.003000, 6.14s
2024-04-30 19:42:49 INFO     Saved model at 22
2024-04-30 19:42:49 INFO     Val loss decrease from 5.4475 to 5.4249, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-30 19:42:55 INFO     epoch complete!
2024-04-30 19:42:55 INFO     evaluating now!
2024-04-30 19:42:55 INFO     Epoch [23/200] train_loss: 4.8302, val_loss: 5.5118, lr: 0.003000, 6.29s
2024-04-30 19:43:01 INFO     epoch complete!
2024-04-30 19:43:01 INFO     evaluating now!
2024-04-30 19:43:02 INFO     Epoch [24/200] train_loss: 4.9408, val_loss: 5.4916, lr: 0.003000, 6.29s
2024-04-30 19:43:07 INFO     epoch complete!
2024-04-30 19:43:07 INFO     evaluating now!
2024-04-30 19:43:08 INFO     Epoch [25/200] train_loss: 4.7248, val_loss: 5.5286, lr: 0.003000, 6.25s
2024-04-30 19:43:14 INFO     epoch complete!
2024-04-30 19:43:14 INFO     evaluating now!
2024-04-30 19:43:14 INFO     Epoch [26/200] train_loss: 4.6817, val_loss: 5.4494, lr: 0.003000, 6.27s
2024-04-30 19:43:21 INFO     epoch complete!
2024-04-30 19:43:21 INFO     evaluating now!
2024-04-30 19:43:21 INFO     Epoch [27/200] train_loss: 4.6289, val_loss: 5.2770, lr: 0.003000, 6.85s
2024-04-30 19:43:21 INFO     Saved model at 27
2024-04-30 19:43:21 INFO     Val loss decrease from 5.4249 to 5.2770, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-30 19:43:27 INFO     epoch complete!
2024-04-30 19:43:27 INFO     evaluating now!
2024-04-30 19:43:28 INFO     Epoch [28/200] train_loss: 4.5764, val_loss: 5.1816, lr: 0.003000, 6.84s
2024-04-30 19:43:28 INFO     Saved model at 28
2024-04-30 19:43:28 INFO     Val loss decrease from 5.2770 to 5.1816, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-04-30 19:43:34 INFO     epoch complete!
2024-04-30 19:43:34 INFO     evaluating now!
2024-04-30 19:43:35 INFO     Epoch [29/200] train_loss: 4.5121, val_loss: 5.1198, lr: 0.003000, 6.82s
2024-04-30 19:43:35 INFO     Saved model at 29
2024-04-30 19:43:35 INFO     Val loss decrease from 5.1816 to 5.1198, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-04-30 19:43:41 INFO     epoch complete!
2024-04-30 19:43:41 INFO     evaluating now!
2024-04-30 19:43:42 INFO     Epoch [30/200] train_loss: 4.5320, val_loss: 5.2229, lr: 0.003000, 6.74s
2024-04-30 19:43:48 INFO     epoch complete!
2024-04-30 19:43:48 INFO     evaluating now!
2024-04-30 19:43:48 INFO     Epoch [31/200] train_loss: 4.4618, val_loss: 5.2165, lr: 0.003000, 6.77s
2024-04-30 19:43:55 INFO     epoch complete!
2024-04-30 19:43:55 INFO     evaluating now!
2024-04-30 19:43:55 INFO     Epoch [32/200] train_loss: 4.3479, val_loss: 5.2103, lr: 0.003000, 6.82s
2024-04-30 19:44:01 INFO     epoch complete!
2024-04-30 19:44:01 INFO     evaluating now!
2024-04-30 19:44:02 INFO     Epoch [33/200] train_loss: 4.3554, val_loss: 5.1300, lr: 0.003000, 6.82s
2024-04-30 19:44:08 INFO     epoch complete!
2024-04-30 19:44:08 INFO     evaluating now!
2024-04-30 19:44:09 INFO     Epoch [34/200] train_loss: 4.3922, val_loss: 5.1087, lr: 0.003000, 6.76s
2024-04-30 19:44:09 INFO     Saved model at 34
2024-04-30 19:44:09 INFO     Val loss decrease from 5.1198 to 5.1087, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-04-30 19:44:15 INFO     epoch complete!
2024-04-30 19:44:15 INFO     evaluating now!
2024-04-30 19:44:16 INFO     Epoch [35/200] train_loss: 4.2474, val_loss: 5.3828, lr: 0.003000, 6.82s
2024-04-30 19:44:22 INFO     epoch complete!
2024-04-30 19:44:22 INFO     evaluating now!
2024-04-30 19:44:22 INFO     Epoch [36/200] train_loss: 4.2431, val_loss: 5.0368, lr: 0.003000, 6.66s
2024-04-30 19:44:22 INFO     Saved model at 36
2024-04-30 19:44:22 INFO     Val loss decrease from 5.1087 to 5.0368, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-04-30 19:44:29 INFO     epoch complete!
2024-04-30 19:44:29 INFO     evaluating now!
2024-04-30 19:44:29 INFO     Epoch [37/200] train_loss: 4.2702, val_loss: 5.0529, lr: 0.003000, 6.94s
2024-04-30 19:44:36 INFO     epoch complete!
2024-04-30 19:44:36 INFO     evaluating now!
2024-04-30 19:44:36 INFO     Epoch [38/200] train_loss: 4.3455, val_loss: 5.1938, lr: 0.003000, 6.88s
2024-04-30 19:44:42 INFO     epoch complete!
2024-04-30 19:44:42 INFO     evaluating now!
2024-04-30 19:44:43 INFO     Epoch [39/200] train_loss: 4.2761, val_loss: 5.1856, lr: 0.003000, 6.84s
2024-04-30 19:44:49 INFO     epoch complete!
2024-04-30 19:44:49 INFO     evaluating now!
2024-04-30 19:44:50 INFO     Epoch [40/200] train_loss: 4.1703, val_loss: 5.0877, lr: 0.003000, 6.83s
2024-04-30 19:44:56 INFO     epoch complete!
2024-04-30 19:44:56 INFO     evaluating now!
2024-04-30 19:44:57 INFO     Epoch [41/200] train_loss: 4.0995, val_loss: 5.0133, lr: 0.003000, 6.78s
2024-04-30 19:44:57 INFO     Saved model at 41
2024-04-30 19:44:57 INFO     Val loss decrease from 5.0368 to 5.0133, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-04-30 19:45:03 INFO     epoch complete!
2024-04-30 19:45:03 INFO     evaluating now!
2024-04-30 19:45:03 INFO     Epoch [42/200] train_loss: 4.0528, val_loss: 5.2151, lr: 0.003000, 6.82s
2024-04-30 19:45:10 INFO     epoch complete!
2024-04-30 19:45:10 INFO     evaluating now!
2024-04-30 19:45:10 INFO     Epoch [43/200] train_loss: 4.0762, val_loss: 5.1093, lr: 0.003000, 6.82s
2024-04-30 19:45:17 INFO     epoch complete!
2024-04-30 19:45:17 INFO     evaluating now!
2024-04-30 19:45:17 INFO     Epoch [44/200] train_loss: 3.9797, val_loss: 5.0517, lr: 0.003000, 6.76s
2024-04-30 19:45:23 INFO     epoch complete!
2024-04-30 19:45:23 INFO     evaluating now!
2024-04-30 19:45:24 INFO     Epoch [45/200] train_loss: 4.0244, val_loss: 5.0535, lr: 0.003000, 6.72s
2024-04-30 19:45:30 INFO     epoch complete!
2024-04-30 19:45:30 INFO     evaluating now!
2024-04-30 19:45:31 INFO     Epoch [46/200] train_loss: 4.1029, val_loss: 5.1556, lr: 0.003000, 7.22s
2024-04-30 19:45:38 INFO     epoch complete!
2024-04-30 19:45:38 INFO     evaluating now!
2024-04-30 19:45:38 INFO     Epoch [47/200] train_loss: 4.0258, val_loss: 5.0155, lr: 0.003000, 7.12s
2024-04-30 19:45:45 INFO     epoch complete!
2024-04-30 19:45:45 INFO     evaluating now!
2024-04-30 19:45:45 INFO     Epoch [48/200] train_loss: 3.9090, val_loss: 5.0049, lr: 0.003000, 7.01s
2024-04-30 19:45:45 INFO     Saved model at 48
2024-04-30 19:45:45 INFO     Val loss decrease from 5.0133 to 5.0049, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-04-30 19:45:52 INFO     epoch complete!
2024-04-30 19:45:52 INFO     evaluating now!
2024-04-30 19:45:52 INFO     Epoch [49/200] train_loss: 3.8814, val_loss: 5.0281, lr: 0.003000, 7.11s
2024-04-30 19:45:59 INFO     epoch complete!
2024-04-30 19:45:59 INFO     evaluating now!
2024-04-30 19:45:59 INFO     Epoch [50/200] train_loss: 3.8366, val_loss: 5.0152, lr: 0.003000, 6.89s
2024-04-30 19:46:05 INFO     epoch complete!
2024-04-30 19:46:05 INFO     evaluating now!
2024-04-30 19:46:06 INFO     Epoch [51/200] train_loss: 3.8607, val_loss: 5.2337, lr: 0.003000, 6.67s
2024-04-30 19:46:12 INFO     epoch complete!
2024-04-30 19:46:12 INFO     evaluating now!
2024-04-30 19:46:13 INFO     Epoch [52/200] train_loss: 3.8575, val_loss: 4.9276, lr: 0.003000, 6.96s
2024-04-30 19:46:13 INFO     Saved model at 52
2024-04-30 19:46:13 INFO     Val loss decrease from 5.0049 to 4.9276, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch52.tar
2024-04-30 19:46:19 INFO     epoch complete!
2024-04-30 19:46:19 INFO     evaluating now!
2024-04-30 19:46:20 INFO     Epoch [53/200] train_loss: 3.8078, val_loss: 5.1128, lr: 0.003000, 6.88s
2024-04-30 19:46:26 INFO     epoch complete!
2024-04-30 19:46:26 INFO     evaluating now!
2024-04-30 19:46:27 INFO     Epoch [54/200] train_loss: 3.9484, val_loss: 5.0632, lr: 0.003000, 6.99s
2024-04-30 19:46:33 INFO     epoch complete!
2024-04-30 19:46:33 INFO     evaluating now!
2024-04-30 19:46:34 INFO     Epoch [55/200] train_loss: 3.8771, val_loss: 5.1323, lr: 0.003000, 6.96s
2024-04-30 19:46:40 INFO     epoch complete!
2024-04-30 19:46:40 INFO     evaluating now!
2024-04-30 19:46:41 INFO     Epoch [56/200] train_loss: 3.8078, val_loss: 5.2777, lr: 0.003000, 6.93s
2024-04-30 19:46:47 INFO     epoch complete!
2024-04-30 19:46:47 INFO     evaluating now!
2024-04-30 19:46:47 INFO     Epoch [57/200] train_loss: 3.7109, val_loss: 5.1561, lr: 0.003000, 6.88s
2024-04-30 19:46:54 INFO     epoch complete!
2024-04-30 19:46:54 INFO     evaluating now!
2024-04-30 19:46:54 INFO     Epoch [58/200] train_loss: 3.7675, val_loss: 5.0392, lr: 0.003000, 6.91s
2024-04-30 19:47:01 INFO     epoch complete!
2024-04-30 19:47:01 INFO     evaluating now!
2024-04-30 19:47:01 INFO     Epoch [59/200] train_loss: 3.7266, val_loss: 5.0308, lr: 0.003000, 7.02s
2024-04-30 19:47:08 INFO     epoch complete!
2024-04-30 19:47:08 INFO     evaluating now!
2024-04-30 19:47:08 INFO     Epoch [60/200] train_loss: 3.6789, val_loss: 5.0194, lr: 0.003000, 7.03s
2024-04-30 19:47:15 INFO     epoch complete!
2024-04-30 19:47:15 INFO     evaluating now!
2024-04-30 19:47:15 INFO     Epoch [61/200] train_loss: 3.6799, val_loss: 5.1503, lr: 0.003000, 7.10s
2024-04-30 19:47:22 INFO     epoch complete!
2024-04-30 19:47:22 INFO     evaluating now!
2024-04-30 19:47:23 INFO     Epoch [62/200] train_loss: 3.6745, val_loss: 5.2492, lr: 0.003000, 7.14s
2024-04-30 19:47:29 INFO     epoch complete!
2024-04-30 19:47:29 INFO     evaluating now!
2024-04-30 19:47:30 INFO     Epoch [63/200] train_loss: 3.7037, val_loss: 5.1799, lr: 0.003000, 7.15s
2024-04-30 19:47:36 INFO     epoch complete!
2024-04-30 19:47:36 INFO     evaluating now!
2024-04-30 19:47:37 INFO     Epoch [64/200] train_loss: 3.6568, val_loss: 5.1160, lr: 0.003000, 7.19s
2024-04-30 19:47:44 INFO     epoch complete!
2024-04-30 19:47:44 INFO     evaluating now!
2024-04-30 19:47:44 INFO     Epoch [65/200] train_loss: 3.5718, val_loss: 4.9063, lr: 0.003000, 7.07s
2024-04-30 19:47:44 INFO     Saved model at 65
2024-04-30 19:47:44 INFO     Val loss decrease from 4.9276 to 4.9063, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch65.tar
2024-04-30 19:47:51 INFO     epoch complete!
2024-04-30 19:47:51 INFO     evaluating now!
2024-04-30 19:47:51 INFO     Epoch [66/200] train_loss: 3.5620, val_loss: 5.0565, lr: 0.003000, 7.05s
2024-04-30 19:47:58 INFO     epoch complete!
2024-04-30 19:47:58 INFO     evaluating now!
2024-04-30 19:47:58 INFO     Epoch [67/200] train_loss: 3.5746, val_loss: 5.0298, lr: 0.003000, 7.11s
2024-04-30 19:48:05 INFO     epoch complete!
2024-04-30 19:48:05 INFO     evaluating now!
2024-04-30 19:48:06 INFO     Epoch [68/200] train_loss: 3.6089, val_loss: 4.9743, lr: 0.003000, 7.63s
2024-04-30 19:48:12 INFO     epoch complete!
2024-04-30 19:48:12 INFO     evaluating now!
2024-04-30 19:48:13 INFO     Epoch [69/200] train_loss: 3.5997, val_loss: 5.0820, lr: 0.003000, 7.04s
2024-04-30 19:48:19 INFO     epoch complete!
2024-04-30 19:48:19 INFO     evaluating now!
2024-04-30 19:48:20 INFO     Epoch [70/200] train_loss: 3.5402, val_loss: 5.0781, lr: 0.003000, 6.98s
2024-04-30 19:48:26 INFO     epoch complete!
2024-04-30 19:48:26 INFO     evaluating now!
2024-04-30 19:48:27 INFO     Epoch [71/200] train_loss: 3.5568, val_loss: 5.1265, lr: 0.003000, 6.88s
2024-04-30 19:48:33 INFO     epoch complete!
2024-04-30 19:48:33 INFO     evaluating now!
2024-04-30 19:48:34 INFO     Epoch [72/200] train_loss: 3.5229, val_loss: 4.9967, lr: 0.003000, 6.88s
2024-04-30 19:48:40 INFO     epoch complete!
2024-04-30 19:48:40 INFO     evaluating now!
2024-04-30 19:48:41 INFO     Epoch [73/200] train_loss: 3.5457, val_loss: 5.1461, lr: 0.003000, 6.91s
2024-04-30 19:48:47 INFO     epoch complete!
2024-04-30 19:48:47 INFO     evaluating now!
2024-04-30 19:48:48 INFO     Epoch [74/200] train_loss: 3.5075, val_loss: 5.1981, lr: 0.003000, 7.08s
2024-04-30 19:48:54 INFO     epoch complete!
2024-04-30 19:48:54 INFO     evaluating now!
2024-04-30 19:48:55 INFO     Epoch [75/200] train_loss: 3.5428, val_loss: 5.0937, lr: 0.003000, 7.26s
2024-04-30 19:49:01 INFO     epoch complete!
2024-04-30 19:49:01 INFO     evaluating now!
2024-04-30 19:49:02 INFO     Epoch [76/200] train_loss: 3.5104, val_loss: 4.9795, lr: 0.003000, 6.82s
2024-04-30 19:49:08 INFO     epoch complete!
2024-04-30 19:49:08 INFO     evaluating now!
2024-04-30 19:49:08 INFO     Epoch [77/200] train_loss: 3.4890, val_loss: 5.0369, lr: 0.003000, 6.58s
2024-04-30 19:49:15 INFO     epoch complete!
2024-04-30 19:49:15 INFO     evaluating now!
2024-04-30 19:49:15 INFO     Epoch [78/200] train_loss: 3.5202, val_loss: 4.9891, lr: 0.003000, 6.68s
2024-04-30 19:49:21 INFO     epoch complete!
2024-04-30 19:49:21 INFO     evaluating now!
2024-04-30 19:49:22 INFO     Epoch [79/200] train_loss: 3.4540, val_loss: 5.0404, lr: 0.003000, 6.57s
2024-04-30 19:49:28 INFO     epoch complete!
2024-04-30 19:49:28 INFO     evaluating now!
2024-04-30 19:49:28 INFO     Epoch [80/200] train_loss: 3.4392, val_loss: 5.0342, lr: 0.003000, 6.61s
2024-04-30 19:49:28 WARNING  Early stopping at epoch: 80
2024-04-30 19:49:28 INFO     Trained totally 81 epochs, average train time is 6.385s, average eval time is 0.464s
2024-04-30 19:49:28 INFO     Loaded model at 65
2024-04-30 19:49:28 INFO     Saved model at ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 19:49:28 INFO     Start evaluating ...
2024-04-30 19:49:30 INFO     Note that you select the single mode to evaluate!
2024-04-30 19:49:30 INFO     Evaluate result is saved at ./libcity/cache/25/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 19:49:30 INFO     
         MAE       RMSE
1   2.497526   6.836989
2   2.670880   7.635474
3   2.743994   8.607996
4   2.955873   9.371466
5   3.211905  10.374909
6   3.265357  11.411680
7   3.404207  12.536229
8   3.443068  13.449353
9   3.442670  13.690207
10  3.442970  13.638916
11  3.501175  13.648995
12  3.568700  13.871531
2024-04-30 19:49:30 INFO     ----------------------------------------------------------------------------
2024-04-30 19:49:30 INFO     # 1, Kownledge Graph Embedding: RotE, Experiment ids: 26
2024-04-30 19:49:30 INFO     ----------------------------------------------------------------------------
2024-04-30 19:49:30 INFO     Log directory: ./libcity/log
2024-04-30 19:49:30 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=26
2024-04-30 19:49:30 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 731635864, 'exp_id': 26, 'load_external': True, 'embedding_model': 'RotE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 19:49:30 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 19:49:30 INFO     set_weight_link_or_dist: dist
2024-04-30 19:49:30 INFO     init_weight_inf_or_zero: inf
2024-04-30 19:49:30 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 19:49:30 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 19:49:30 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 19:49:30 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 19:49:33 INFO     Dataset created
2024-04-30 19:49:33 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 19:49:33 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 19:49:33 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 19:49:33 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 19:49:33 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 19:49:33 INFO     NoneScaler
2024-04-30 19:49:36 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 19:49:36 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 19:49:36 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 19:49:36 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 19:49:36 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 19:49:36 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 19:49:36 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 19:49:36 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 19:49:36 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 19:49:36 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 19:49:36 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 19:49:36 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 19:49:36 INFO     Total parameter numbers: 874010
2024-04-30 19:49:36 INFO     You select `adam` optimizer.
2024-04-30 19:49:36 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 19:49:36 INFO     Start training ...
2024-04-30 19:49:36 INFO     num_batches:48
2024-04-30 19:49:42 INFO     epoch complete!
2024-04-30 19:49:42 INFO     evaluating now!
2024-04-30 19:49:43 INFO     Epoch [0/200] train_loss: 24.2771, val_loss: 19.3364, lr: 0.003000, 7.12s
2024-04-30 19:49:43 INFO     Saved model at 0
2024-04-30 19:49:43 INFO     Val loss decrease from inf to 19.3364, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 19:49:49 INFO     epoch complete!
2024-04-30 19:49:49 INFO     evaluating now!
2024-04-30 19:49:50 INFO     Epoch [1/200] train_loss: 16.3431, val_loss: 16.2570, lr: 0.003000, 7.22s
2024-04-30 19:49:50 INFO     Saved model at 1
2024-04-30 19:49:50 INFO     Val loss decrease from 19.3364 to 16.2570, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 19:49:57 INFO     epoch complete!
2024-04-30 19:49:57 INFO     evaluating now!
2024-04-30 19:49:57 INFO     Epoch [2/200] train_loss: 13.3570, val_loss: 13.1771, lr: 0.003000, 7.15s
2024-04-30 19:49:57 INFO     Saved model at 2
2024-04-30 19:49:57 INFO     Val loss decrease from 16.2570 to 13.1771, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 19:50:04 INFO     epoch complete!
2024-04-30 19:50:04 INFO     evaluating now!
2024-04-30 19:50:05 INFO     Epoch [3/200] train_loss: 11.1241, val_loss: 11.1237, lr: 0.003000, 7.69s
2024-04-30 19:50:05 INFO     Saved model at 3
2024-04-30 19:50:05 INFO     Val loss decrease from 13.1771 to 11.1237, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 19:50:12 INFO     epoch complete!
2024-04-30 19:50:12 INFO     evaluating now!
2024-04-30 19:50:13 INFO     Epoch [4/200] train_loss: 9.7217, val_loss: 9.6631, lr: 0.003000, 7.64s
2024-04-30 19:50:13 INFO     Saved model at 4
2024-04-30 19:50:13 INFO     Val loss decrease from 11.1237 to 9.6631, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 19:50:19 INFO     epoch complete!
2024-04-30 19:50:19 INFO     evaluating now!
2024-04-30 19:50:20 INFO     Epoch [5/200] train_loss: 8.4907, val_loss: 8.6732, lr: 0.003000, 7.08s
2024-04-30 19:50:20 INFO     Saved model at 5
2024-04-30 19:50:20 INFO     Val loss decrease from 9.6631 to 8.6732, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 19:50:26 INFO     epoch complete!
2024-04-30 19:50:26 INFO     evaluating now!
2024-04-30 19:50:27 INFO     Epoch [6/200] train_loss: 7.8548, val_loss: 7.6931, lr: 0.003000, 7.12s
2024-04-30 19:50:27 INFO     Saved model at 6
2024-04-30 19:50:27 INFO     Val loss decrease from 8.6732 to 7.6931, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 19:50:33 INFO     epoch complete!
2024-04-30 19:50:33 INFO     evaluating now!
2024-04-30 19:50:34 INFO     Epoch [7/200] train_loss: 7.4047, val_loss: 7.0767, lr: 0.003000, 7.07s
2024-04-30 19:50:34 INFO     Saved model at 7
2024-04-30 19:50:34 INFO     Val loss decrease from 7.6931 to 7.0767, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 19:50:41 INFO     epoch complete!
2024-04-30 19:50:41 INFO     evaluating now!
2024-04-30 19:50:41 INFO     Epoch [8/200] train_loss: 6.8416, val_loss: 6.7750, lr: 0.003000, 7.10s
2024-04-30 19:50:41 INFO     Saved model at 8
2024-04-30 19:50:41 INFO     Val loss decrease from 7.0767 to 6.7750, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 19:50:48 INFO     epoch complete!
2024-04-30 19:50:48 INFO     evaluating now!
2024-04-30 19:50:48 INFO     Epoch [9/200] train_loss: 6.5982, val_loss: 6.6551, lr: 0.003000, 7.10s
2024-04-30 19:50:48 INFO     Saved model at 9
2024-04-30 19:50:48 INFO     Val loss decrease from 6.7750 to 6.6551, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 19:50:55 INFO     epoch complete!
2024-04-30 19:50:55 INFO     evaluating now!
2024-04-30 19:50:55 INFO     Epoch [10/200] train_loss: 6.3088, val_loss: 6.5141, lr: 0.003000, 7.02s
2024-04-30 19:50:55 INFO     Saved model at 10
2024-04-30 19:50:55 INFO     Val loss decrease from 6.6551 to 6.5141, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 19:51:02 INFO     epoch complete!
2024-04-30 19:51:02 INFO     evaluating now!
2024-04-30 19:51:02 INFO     Epoch [11/200] train_loss: 5.9644, val_loss: 6.2641, lr: 0.003000, 7.08s
2024-04-30 19:51:02 INFO     Saved model at 11
2024-04-30 19:51:02 INFO     Val loss decrease from 6.5141 to 6.2641, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 19:51:09 INFO     epoch complete!
2024-04-30 19:51:09 INFO     evaluating now!
2024-04-30 19:51:09 INFO     Epoch [12/200] train_loss: 5.9960, val_loss: 6.2230, lr: 0.003000, 6.85s
2024-04-30 19:51:09 INFO     Saved model at 12
2024-04-30 19:51:09 INFO     Val loss decrease from 6.2641 to 6.2230, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 19:51:15 INFO     epoch complete!
2024-04-30 19:51:15 INFO     evaluating now!
2024-04-30 19:51:15 INFO     Epoch [13/200] train_loss: 5.7194, val_loss: 5.7264, lr: 0.003000, 5.96s
2024-04-30 19:51:15 INFO     Saved model at 13
2024-04-30 19:51:15 INFO     Val loss decrease from 6.2230 to 5.7264, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 19:51:22 INFO     epoch complete!
2024-04-30 19:51:22 INFO     evaluating now!
2024-04-30 19:51:22 INFO     Epoch [14/200] train_loss: 5.5477, val_loss: 6.0519, lr: 0.003000, 6.95s
2024-04-30 19:51:29 INFO     epoch complete!
2024-04-30 19:51:29 INFO     evaluating now!
2024-04-30 19:51:29 INFO     Epoch [15/200] train_loss: 5.4700, val_loss: 5.7765, lr: 0.003000, 7.20s
2024-04-30 19:51:36 INFO     epoch complete!
2024-04-30 19:51:36 INFO     evaluating now!
2024-04-30 19:51:37 INFO     Epoch [16/200] train_loss: 5.3810, val_loss: 5.8581, lr: 0.003000, 7.14s
2024-04-30 19:51:43 INFO     epoch complete!
2024-04-30 19:51:43 INFO     evaluating now!
2024-04-30 19:51:44 INFO     Epoch [17/200] train_loss: 5.2406, val_loss: 5.5243, lr: 0.003000, 7.16s
2024-04-30 19:51:44 INFO     Saved model at 17
2024-04-30 19:51:44 INFO     Val loss decrease from 5.7264 to 5.5243, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 19:51:50 INFO     epoch complete!
2024-04-30 19:51:50 INFO     evaluating now!
2024-04-30 19:51:51 INFO     Epoch [18/200] train_loss: 5.1799, val_loss: 5.4185, lr: 0.003000, 7.12s
2024-04-30 19:51:51 INFO     Saved model at 18
2024-04-30 19:51:51 INFO     Val loss decrease from 5.5243 to 5.4185, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 19:51:58 INFO     epoch complete!
2024-04-30 19:51:58 INFO     evaluating now!
2024-04-30 19:51:58 INFO     Epoch [19/200] train_loss: 5.1019, val_loss: 5.5046, lr: 0.003000, 7.09s
2024-04-30 19:52:05 INFO     epoch complete!
2024-04-30 19:52:05 INFO     evaluating now!
2024-04-30 19:52:05 INFO     Epoch [20/200] train_loss: 5.1311, val_loss: 5.4001, lr: 0.003000, 7.14s
2024-04-30 19:52:05 INFO     Saved model at 20
2024-04-30 19:52:05 INFO     Val loss decrease from 5.4185 to 5.4001, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-30 19:52:12 INFO     epoch complete!
2024-04-30 19:52:12 INFO     evaluating now!
2024-04-30 19:52:12 INFO     Epoch [21/200] train_loss: 4.9647, val_loss: 5.3366, lr: 0.003000, 7.04s
2024-04-30 19:52:12 INFO     Saved model at 21
2024-04-30 19:52:12 INFO     Val loss decrease from 5.4001 to 5.3366, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-30 19:52:19 INFO     epoch complete!
2024-04-30 19:52:19 INFO     evaluating now!
2024-04-30 19:52:19 INFO     Epoch [22/200] train_loss: 4.8689, val_loss: 5.3490, lr: 0.003000, 7.12s
2024-04-30 19:52:26 INFO     epoch complete!
2024-04-30 19:52:26 INFO     evaluating now!
2024-04-30 19:52:27 INFO     Epoch [23/200] train_loss: 4.8199, val_loss: 5.2204, lr: 0.003000, 7.17s
2024-04-30 19:52:27 INFO     Saved model at 23
2024-04-30 19:52:27 INFO     Val loss decrease from 5.3366 to 5.2204, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-30 19:52:33 INFO     epoch complete!
2024-04-30 19:52:33 INFO     evaluating now!
2024-04-30 19:52:34 INFO     Epoch [24/200] train_loss: 4.7159, val_loss: 5.2769, lr: 0.003000, 7.20s
2024-04-30 19:52:41 INFO     epoch complete!
2024-04-30 19:52:41 INFO     evaluating now!
2024-04-30 19:52:41 INFO     Epoch [25/200] train_loss: 4.7605, val_loss: 5.2584, lr: 0.003000, 7.15s
2024-04-30 19:52:48 INFO     epoch complete!
2024-04-30 19:52:48 INFO     evaluating now!
2024-04-30 19:52:48 INFO     Epoch [26/200] train_loss: 4.6911, val_loss: 5.2249, lr: 0.003000, 7.15s
2024-04-30 19:52:55 INFO     epoch complete!
2024-04-30 19:52:55 INFO     evaluating now!
2024-04-30 19:52:55 INFO     Epoch [27/200] train_loss: 4.7059, val_loss: 5.3192, lr: 0.003000, 7.12s
2024-04-30 19:53:02 INFO     epoch complete!
2024-04-30 19:53:02 INFO     evaluating now!
2024-04-30 19:53:02 INFO     Epoch [28/200] train_loss: 4.6232, val_loss: 5.2789, lr: 0.003000, 7.20s
2024-04-30 19:53:09 INFO     epoch complete!
2024-04-30 19:53:09 INFO     evaluating now!
2024-04-30 19:53:10 INFO     Epoch [29/200] train_loss: 4.5112, val_loss: 5.1578, lr: 0.003000, 7.06s
2024-04-30 19:53:10 INFO     Saved model at 29
2024-04-30 19:53:10 INFO     Val loss decrease from 5.2204 to 5.1578, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-04-30 19:53:16 INFO     epoch complete!
2024-04-30 19:53:16 INFO     evaluating now!
2024-04-30 19:53:17 INFO     Epoch [30/200] train_loss: 4.4462, val_loss: 5.2527, lr: 0.003000, 7.01s
2024-04-30 19:53:23 INFO     epoch complete!
2024-04-30 19:53:23 INFO     evaluating now!
2024-04-30 19:53:24 INFO     Epoch [31/200] train_loss: 4.4610, val_loss: 5.0875, lr: 0.003000, 7.05s
2024-04-30 19:53:24 INFO     Saved model at 31
2024-04-30 19:53:24 INFO     Val loss decrease from 5.1578 to 5.0875, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-04-30 19:53:30 INFO     epoch complete!
2024-04-30 19:53:30 INFO     evaluating now!
2024-04-30 19:53:31 INFO     Epoch [32/200] train_loss: 4.3301, val_loss: 4.9971, lr: 0.003000, 7.23s
2024-04-30 19:53:31 INFO     Saved model at 32
2024-04-30 19:53:31 INFO     Val loss decrease from 5.0875 to 4.9971, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-04-30 19:53:38 INFO     epoch complete!
2024-04-30 19:53:38 INFO     evaluating now!
2024-04-30 19:53:38 INFO     Epoch [33/200] train_loss: 4.3734, val_loss: 5.0489, lr: 0.003000, 7.05s
2024-04-30 19:53:45 INFO     epoch complete!
2024-04-30 19:53:45 INFO     evaluating now!
2024-04-30 19:53:45 INFO     Epoch [34/200] train_loss: 4.2484, val_loss: 5.1034, lr: 0.003000, 7.09s
2024-04-30 19:53:52 INFO     epoch complete!
2024-04-30 19:53:52 INFO     evaluating now!
2024-04-30 19:53:52 INFO     Epoch [35/200] train_loss: 4.2096, val_loss: 5.0759, lr: 0.003000, 7.04s
2024-04-30 19:53:59 INFO     epoch complete!
2024-04-30 19:53:59 INFO     evaluating now!
2024-04-30 19:53:59 INFO     Epoch [36/200] train_loss: 4.2526, val_loss: 5.0412, lr: 0.003000, 7.09s
2024-04-30 19:54:06 INFO     epoch complete!
2024-04-30 19:54:06 INFO     evaluating now!
2024-04-30 19:54:06 INFO     Epoch [37/200] train_loss: 4.2597, val_loss: 5.0976, lr: 0.003000, 7.08s
2024-04-30 19:54:13 INFO     epoch complete!
2024-04-30 19:54:13 INFO     evaluating now!
2024-04-30 19:54:13 INFO     Epoch [38/200] train_loss: 4.2198, val_loss: 5.2667, lr: 0.003000, 6.97s
2024-04-30 19:54:20 INFO     epoch complete!
2024-04-30 19:54:20 INFO     evaluating now!
2024-04-30 19:54:20 INFO     Epoch [39/200] train_loss: 4.1360, val_loss: 4.9587, lr: 0.003000, 6.97s
2024-04-30 19:54:21 INFO     Saved model at 39
2024-04-30 19:54:21 INFO     Val loss decrease from 4.9971 to 4.9587, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-04-30 19:54:27 INFO     epoch complete!
2024-04-30 19:54:27 INFO     evaluating now!
2024-04-30 19:54:28 INFO     Epoch [40/200] train_loss: 4.0243, val_loss: 5.0875, lr: 0.003000, 6.93s
2024-04-30 19:54:34 INFO     epoch complete!
2024-04-30 19:54:34 INFO     evaluating now!
2024-04-30 19:54:35 INFO     Epoch [41/200] train_loss: 4.0835, val_loss: 5.0335, lr: 0.003000, 6.90s
2024-04-30 19:54:41 INFO     epoch complete!
2024-04-30 19:54:41 INFO     evaluating now!
2024-04-30 19:54:42 INFO     Epoch [42/200] train_loss: 4.0539, val_loss: 4.9688, lr: 0.003000, 6.96s
2024-04-30 19:54:48 INFO     epoch complete!
2024-04-30 19:54:48 INFO     evaluating now!
2024-04-30 19:54:48 INFO     Epoch [43/200] train_loss: 3.9982, val_loss: 4.9841, lr: 0.003000, 6.79s
2024-04-30 19:54:55 INFO     epoch complete!
2024-04-30 19:54:55 INFO     evaluating now!
2024-04-30 19:54:55 INFO     Epoch [44/200] train_loss: 4.0207, val_loss: 4.8536, lr: 0.003000, 6.90s
2024-04-30 19:54:55 INFO     Saved model at 44
2024-04-30 19:54:55 INFO     Val loss decrease from 4.9587 to 4.8536, saving to ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-04-30 19:55:02 INFO     epoch complete!
2024-04-30 19:55:02 INFO     evaluating now!
2024-04-30 19:55:02 INFO     Epoch [45/200] train_loss: 4.0374, val_loss: 5.0304, lr: 0.003000, 7.05s
2024-04-30 19:55:09 INFO     epoch complete!
2024-04-30 19:55:09 INFO     evaluating now!
2024-04-30 19:55:09 INFO     Epoch [46/200] train_loss: 3.9854, val_loss: 5.0381, lr: 0.003000, 6.95s
2024-04-30 19:55:16 INFO     epoch complete!
2024-04-30 19:55:16 INFO     evaluating now!
2024-04-30 19:55:17 INFO     Epoch [47/200] train_loss: 3.8944, val_loss: 4.9259, lr: 0.003000, 7.18s
2024-04-30 19:55:23 INFO     epoch complete!
2024-04-30 19:55:23 INFO     evaluating now!
2024-04-30 19:55:23 INFO     Epoch [48/200] train_loss: 3.9035, val_loss: 5.0280, lr: 0.003000, 6.64s
2024-04-30 19:55:29 INFO     epoch complete!
2024-04-30 19:55:29 INFO     evaluating now!
2024-04-30 19:55:30 INFO     Epoch [49/200] train_loss: 3.8747, val_loss: 4.9227, lr: 0.003000, 6.55s
2024-04-30 19:55:36 INFO     epoch complete!
2024-04-30 19:55:36 INFO     evaluating now!
2024-04-30 19:55:36 INFO     Epoch [50/200] train_loss: 3.8842, val_loss: 4.9788, lr: 0.003000, 6.49s
2024-04-30 19:55:43 INFO     epoch complete!
2024-04-30 19:55:43 INFO     evaluating now!
2024-04-30 19:55:43 INFO     Epoch [51/200] train_loss: 3.8195, val_loss: 5.1639, lr: 0.003000, 6.67s
2024-04-30 19:55:49 INFO     epoch complete!
2024-04-30 19:55:49 INFO     evaluating now!
2024-04-30 19:55:50 INFO     Epoch [52/200] train_loss: 3.8827, val_loss: 5.0670, lr: 0.003000, 6.53s
2024-04-30 19:55:56 INFO     epoch complete!
2024-04-30 19:55:56 INFO     evaluating now!
2024-04-30 19:55:56 INFO     Epoch [53/200] train_loss: 3.8850, val_loss: 5.2121, lr: 0.003000, 6.53s
2024-04-30 19:56:03 INFO     epoch complete!
2024-04-30 19:56:03 INFO     evaluating now!
2024-04-30 19:56:03 INFO     Epoch [54/200] train_loss: 3.8048, val_loss: 5.0335, lr: 0.003000, 6.98s
2024-04-30 19:56:10 INFO     epoch complete!
2024-04-30 19:56:10 INFO     evaluating now!
2024-04-30 19:56:10 INFO     Epoch [55/200] train_loss: 3.7634, val_loss: 4.9793, lr: 0.003000, 7.24s
2024-04-30 19:56:17 INFO     epoch complete!
2024-04-30 19:56:17 INFO     evaluating now!
2024-04-30 19:56:17 INFO     Epoch [56/200] train_loss: 3.7372, val_loss: 4.9997, lr: 0.003000, 6.93s
2024-04-30 19:56:24 INFO     epoch complete!
2024-04-30 19:56:24 INFO     evaluating now!
2024-04-30 19:56:24 INFO     Epoch [57/200] train_loss: 3.7749, val_loss: 5.1270, lr: 0.003000, 7.00s
2024-04-30 19:56:31 INFO     epoch complete!
2024-04-30 19:56:31 INFO     evaluating now!
2024-04-30 19:56:31 INFO     Epoch [58/200] train_loss: 3.7028, val_loss: 5.0933, lr: 0.003000, 6.97s
2024-04-30 19:56:38 INFO     epoch complete!
2024-04-30 19:56:38 INFO     evaluating now!
2024-04-30 19:56:38 INFO     Epoch [59/200] train_loss: 3.7223, val_loss: 4.9908, lr: 0.003000, 6.94s
2024-04-30 19:56:38 WARNING  Early stopping at epoch: 59
2024-04-30 19:56:38 INFO     Trained totally 60 epochs, average train time is 6.545s, average eval time is 0.468s
2024-04-30 19:56:38 INFO     Loaded model at 44
2024-04-30 19:56:38 INFO     Saved model at ./libcity/cache/26/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 19:56:38 INFO     Start evaluating ...
2024-04-30 19:56:40 INFO     Note that you select the single mode to evaluate!
2024-04-30 19:56:40 INFO     Evaluate result is saved at ./libcity/cache/26/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 19:56:40 INFO     
         MAE       RMSE
1   2.456868   6.970811
2   2.493809   7.575019
3   2.639729   8.526044
4   2.865504   9.441670
5   3.060320  10.263636
6   3.051143  11.002050
7   3.147630  11.674964
8   3.229599  12.208386
9   3.349495  12.667890
10  3.359932  13.061997
11  3.507282  13.645199
12  3.808421  14.554343
2024-04-30 19:56:40 INFO     ----------------------------------------------------------------------------
2024-04-30 19:56:40 INFO     # 2, Kownledge Graph Embedding: RotE, Experiment ids: 27
2024-04-30 19:56:40 INFO     ----------------------------------------------------------------------------
2024-04-30 19:56:40 INFO     Log directory: ./libcity/log
2024-04-30 19:56:40 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=27
2024-04-30 19:56:40 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 659790293, 'exp_id': 27, 'load_external': True, 'embedding_model': 'RotE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 19:56:40 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 19:56:40 INFO     set_weight_link_or_dist: dist
2024-04-30 19:56:40 INFO     init_weight_inf_or_zero: inf
2024-04-30 19:56:40 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 19:56:40 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 19:56:40 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 19:56:40 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 19:56:43 INFO     Dataset created
2024-04-30 19:56:43 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 19:56:43 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 19:56:43 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 19:56:43 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 19:56:43 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 19:56:43 INFO     NoneScaler
2024-04-30 19:56:45 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 19:56:45 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 19:56:45 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 19:56:45 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 19:56:45 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 19:56:45 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 19:56:45 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 19:56:45 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 19:56:45 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 19:56:45 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 19:56:45 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 19:56:45 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 19:56:45 INFO     Total parameter numbers: 874010
2024-04-30 19:56:45 INFO     You select `adam` optimizer.
2024-04-30 19:56:45 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 19:56:45 INFO     Start training ...
2024-04-30 19:56:45 INFO     num_batches:48
2024-04-30 19:56:52 INFO     epoch complete!
2024-04-30 19:56:52 INFO     evaluating now!
2024-04-30 19:56:52 INFO     Epoch [0/200] train_loss: 23.4317, val_loss: 18.7927, lr: 0.003000, 6.89s
2024-04-30 19:56:52 INFO     Saved model at 0
2024-04-30 19:56:52 INFO     Val loss decrease from inf to 18.7927, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 19:56:59 INFO     epoch complete!
2024-04-30 19:56:59 INFO     evaluating now!
2024-04-30 19:56:59 INFO     Epoch [1/200] train_loss: 15.4569, val_loss: 15.0714, lr: 0.003000, 6.96s
2024-04-30 19:56:59 INFO     Saved model at 1
2024-04-30 19:56:59 INFO     Val loss decrease from 18.7927 to 15.0714, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 19:57:06 INFO     epoch complete!
2024-04-30 19:57:06 INFO     evaluating now!
2024-04-30 19:57:06 INFO     Epoch [2/200] train_loss: 12.2568, val_loss: 11.8384, lr: 0.003000, 6.92s
2024-04-30 19:57:06 INFO     Saved model at 2
2024-04-30 19:57:06 INFO     Val loss decrease from 15.0714 to 11.8384, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 19:57:13 INFO     epoch complete!
2024-04-30 19:57:13 INFO     evaluating now!
2024-04-30 19:57:14 INFO     Epoch [3/200] train_loss: 10.0224, val_loss: 10.0105, lr: 0.003000, 7.16s
2024-04-30 19:57:14 INFO     Saved model at 3
2024-04-30 19:57:14 INFO     Val loss decrease from 11.8384 to 10.0105, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 19:57:20 INFO     epoch complete!
2024-04-30 19:57:20 INFO     evaluating now!
2024-04-30 19:57:21 INFO     Epoch [4/200] train_loss: 8.6012, val_loss: 8.3615, lr: 0.003000, 7.13s
2024-04-30 19:57:21 INFO     Saved model at 4
2024-04-30 19:57:21 INFO     Val loss decrease from 10.0105 to 8.3615, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 19:57:28 INFO     epoch complete!
2024-04-30 19:57:28 INFO     evaluating now!
2024-04-30 19:57:28 INFO     Epoch [5/200] train_loss: 7.6875, val_loss: 7.4971, lr: 0.003000, 7.38s
2024-04-30 19:57:28 INFO     Saved model at 5
2024-04-30 19:57:28 INFO     Val loss decrease from 8.3615 to 7.4971, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 19:57:35 INFO     epoch complete!
2024-04-30 19:57:35 INFO     evaluating now!
2024-04-30 19:57:35 INFO     Epoch [6/200] train_loss: 7.2217, val_loss: 7.1928, lr: 0.003000, 7.21s
2024-04-30 19:57:35 INFO     Saved model at 6
2024-04-30 19:57:35 INFO     Val loss decrease from 7.4971 to 7.1928, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 19:57:42 INFO     epoch complete!
2024-04-30 19:57:42 INFO     evaluating now!
2024-04-30 19:57:43 INFO     Epoch [7/200] train_loss: 6.6637, val_loss: 6.9608, lr: 0.003000, 7.23s
2024-04-30 19:57:43 INFO     Saved model at 7
2024-04-30 19:57:43 INFO     Val loss decrease from 7.1928 to 6.9608, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 19:57:49 INFO     epoch complete!
2024-04-30 19:57:49 INFO     evaluating now!
2024-04-30 19:57:50 INFO     Epoch [8/200] train_loss: 6.3511, val_loss: 6.3688, lr: 0.003000, 7.20s
2024-04-30 19:57:50 INFO     Saved model at 8
2024-04-30 19:57:50 INFO     Val loss decrease from 6.9608 to 6.3688, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 19:57:57 INFO     epoch complete!
2024-04-30 19:57:57 INFO     evaluating now!
2024-04-30 19:57:57 INFO     Epoch [9/200] train_loss: 6.1036, val_loss: 6.3870, lr: 0.003000, 7.16s
2024-04-30 19:58:04 INFO     epoch complete!
2024-04-30 19:58:04 INFO     evaluating now!
2024-04-30 19:58:04 INFO     Epoch [10/200] train_loss: 5.8836, val_loss: 6.1863, lr: 0.003000, 7.32s
2024-04-30 19:58:04 INFO     Saved model at 10
2024-04-30 19:58:04 INFO     Val loss decrease from 6.3688 to 6.1863, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 19:58:11 INFO     epoch complete!
2024-04-30 19:58:11 INFO     evaluating now!
2024-04-30 19:58:12 INFO     Epoch [11/200] train_loss: 5.6856, val_loss: 6.0520, lr: 0.003000, 7.27s
2024-04-30 19:58:12 INFO     Saved model at 11
2024-04-30 19:58:12 INFO     Val loss decrease from 6.1863 to 6.0520, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 19:58:19 INFO     epoch complete!
2024-04-30 19:58:19 INFO     evaluating now!
2024-04-30 19:58:19 INFO     Epoch [12/200] train_loss: 5.6375, val_loss: 5.8465, lr: 0.003000, 7.22s
2024-04-30 19:58:19 INFO     Saved model at 12
2024-04-30 19:58:19 INFO     Val loss decrease from 6.0520 to 5.8465, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 19:58:26 INFO     epoch complete!
2024-04-30 19:58:26 INFO     evaluating now!
2024-04-30 19:58:26 INFO     Epoch [13/200] train_loss: 5.5007, val_loss: 5.6564, lr: 0.003000, 7.10s
2024-04-30 19:58:26 INFO     Saved model at 13
2024-04-30 19:58:26 INFO     Val loss decrease from 5.8465 to 5.6564, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 19:58:33 INFO     epoch complete!
2024-04-30 19:58:33 INFO     evaluating now!
2024-04-30 19:58:33 INFO     Epoch [14/200] train_loss: 5.4081, val_loss: 5.7354, lr: 0.003000, 7.11s
2024-04-30 19:58:40 INFO     epoch complete!
2024-04-30 19:58:40 INFO     evaluating now!
2024-04-30 19:58:40 INFO     Epoch [15/200] train_loss: 5.4241, val_loss: 5.6225, lr: 0.003000, 7.13s
2024-04-30 19:58:40 INFO     Saved model at 15
2024-04-30 19:58:40 INFO     Val loss decrease from 5.6564 to 5.6225, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 19:58:47 INFO     epoch complete!
2024-04-30 19:58:47 INFO     evaluating now!
2024-04-30 19:58:48 INFO     Epoch [16/200] train_loss: 5.2101, val_loss: 5.6526, lr: 0.003000, 7.15s
2024-04-30 19:58:54 INFO     epoch complete!
2024-04-30 19:58:54 INFO     evaluating now!
2024-04-30 19:58:55 INFO     Epoch [17/200] train_loss: 5.1178, val_loss: 5.4363, lr: 0.003000, 7.13s
2024-04-30 19:58:55 INFO     Saved model at 17
2024-04-30 19:58:55 INFO     Val loss decrease from 5.6225 to 5.4363, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 19:59:02 INFO     epoch complete!
2024-04-30 19:59:02 INFO     evaluating now!
2024-04-30 19:59:02 INFO     Epoch [18/200] train_loss: 5.0426, val_loss: 5.7103, lr: 0.003000, 7.23s
2024-04-30 19:59:09 INFO     epoch complete!
2024-04-30 19:59:09 INFO     evaluating now!
2024-04-30 19:59:09 INFO     Epoch [19/200] train_loss: 5.0138, val_loss: 5.4021, lr: 0.003000, 7.17s
2024-04-30 19:59:09 INFO     Saved model at 19
2024-04-30 19:59:09 INFO     Val loss decrease from 5.4363 to 5.4021, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 19:59:16 INFO     epoch complete!
2024-04-30 19:59:16 INFO     evaluating now!
2024-04-30 19:59:16 INFO     Epoch [20/200] train_loss: 4.8475, val_loss: 5.6300, lr: 0.003000, 7.13s
2024-04-30 19:59:23 INFO     epoch complete!
2024-04-30 19:59:23 INFO     evaluating now!
2024-04-30 19:59:24 INFO     Epoch [21/200] train_loss: 4.9256, val_loss: 5.6149, lr: 0.003000, 7.30s
2024-04-30 19:59:30 INFO     epoch complete!
2024-04-30 19:59:30 INFO     evaluating now!
2024-04-30 19:59:31 INFO     Epoch [22/200] train_loss: 4.8199, val_loss: 5.5057, lr: 0.003000, 7.29s
2024-04-30 19:59:38 INFO     epoch complete!
2024-04-30 19:59:38 INFO     evaluating now!
2024-04-30 19:59:38 INFO     Epoch [23/200] train_loss: 4.7399, val_loss: 5.4256, lr: 0.003000, 7.11s
2024-04-30 19:59:45 INFO     epoch complete!
2024-04-30 19:59:45 INFO     evaluating now!
2024-04-30 19:59:45 INFO     Epoch [24/200] train_loss: 4.6632, val_loss: 5.5378, lr: 0.003000, 7.01s
2024-04-30 19:59:52 INFO     epoch complete!
2024-04-30 19:59:52 INFO     evaluating now!
2024-04-30 19:59:52 INFO     Epoch [25/200] train_loss: 4.7114, val_loss: 5.3922, lr: 0.003000, 7.01s
2024-04-30 19:59:52 INFO     Saved model at 25
2024-04-30 19:59:52 INFO     Val loss decrease from 5.4021 to 5.3922, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-30 19:59:59 INFO     epoch complete!
2024-04-30 19:59:59 INFO     evaluating now!
2024-04-30 19:59:59 INFO     Epoch [26/200] train_loss: 4.6577, val_loss: 5.3643, lr: 0.003000, 7.04s
2024-04-30 19:59:59 INFO     Saved model at 26
2024-04-30 19:59:59 INFO     Val loss decrease from 5.3922 to 5.3643, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-04-30 20:00:06 INFO     epoch complete!
2024-04-30 20:00:06 INFO     evaluating now!
2024-04-30 20:00:06 INFO     Epoch [27/200] train_loss: 4.5176, val_loss: 5.2681, lr: 0.003000, 7.07s
2024-04-30 20:00:06 INFO     Saved model at 27
2024-04-30 20:00:06 INFO     Val loss decrease from 5.3643 to 5.2681, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-30 20:00:13 INFO     epoch complete!
2024-04-30 20:00:13 INFO     evaluating now!
2024-04-30 20:00:13 INFO     Epoch [28/200] train_loss: 4.4712, val_loss: 5.4498, lr: 0.003000, 7.03s
2024-04-30 20:00:20 INFO     epoch complete!
2024-04-30 20:00:20 INFO     evaluating now!
2024-04-30 20:00:21 INFO     Epoch [29/200] train_loss: 4.4438, val_loss: 5.2045, lr: 0.003000, 7.14s
2024-04-30 20:00:21 INFO     Saved model at 29
2024-04-30 20:00:21 INFO     Val loss decrease from 5.2681 to 5.2045, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-04-30 20:00:27 INFO     epoch complete!
2024-04-30 20:00:27 INFO     evaluating now!
2024-04-30 20:00:28 INFO     Epoch [30/200] train_loss: 4.4318, val_loss: 5.2761, lr: 0.003000, 7.01s
2024-04-30 20:00:34 INFO     epoch complete!
2024-04-30 20:00:34 INFO     evaluating now!
2024-04-30 20:00:35 INFO     Epoch [31/200] train_loss: 4.3025, val_loss: 5.3646, lr: 0.003000, 7.01s
2024-04-30 20:00:41 INFO     epoch complete!
2024-04-30 20:00:41 INFO     evaluating now!
2024-04-30 20:00:42 INFO     Epoch [32/200] train_loss: 4.3007, val_loss: 5.2773, lr: 0.003000, 6.93s
2024-04-30 20:00:48 INFO     epoch complete!
2024-04-30 20:00:48 INFO     evaluating now!
2024-04-30 20:00:49 INFO     Epoch [33/200] train_loss: 4.2452, val_loss: 5.4512, lr: 0.003000, 7.16s
2024-04-30 20:00:55 INFO     epoch complete!
2024-04-30 20:00:55 INFO     evaluating now!
2024-04-30 20:00:56 INFO     Epoch [34/200] train_loss: 4.2282, val_loss: 5.4022, lr: 0.003000, 7.14s
2024-04-30 20:01:02 INFO     epoch complete!
2024-04-30 20:01:02 INFO     evaluating now!
2024-04-30 20:01:03 INFO     Epoch [35/200] train_loss: 4.1815, val_loss: 5.1472, lr: 0.003000, 7.12s
2024-04-30 20:01:03 INFO     Saved model at 35
2024-04-30 20:01:03 INFO     Val loss decrease from 5.2045 to 5.1472, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-04-30 20:01:10 INFO     epoch complete!
2024-04-30 20:01:10 INFO     evaluating now!
2024-04-30 20:01:10 INFO     Epoch [36/200] train_loss: 4.1696, val_loss: 5.3130, lr: 0.003000, 7.02s
2024-04-30 20:01:17 INFO     epoch complete!
2024-04-30 20:01:17 INFO     evaluating now!
2024-04-30 20:01:17 INFO     Epoch [37/200] train_loss: 4.1717, val_loss: 5.2492, lr: 0.003000, 6.96s
2024-04-30 20:01:23 INFO     epoch complete!
2024-04-30 20:01:23 INFO     evaluating now!
2024-04-30 20:01:24 INFO     Epoch [38/200] train_loss: 4.1672, val_loss: 5.3447, lr: 0.003000, 6.90s
2024-04-30 20:01:30 INFO     epoch complete!
2024-04-30 20:01:30 INFO     evaluating now!
2024-04-30 20:01:31 INFO     Epoch [39/200] train_loss: 4.0900, val_loss: 5.2703, lr: 0.003000, 7.00s
2024-04-30 20:01:38 INFO     epoch complete!
2024-04-30 20:01:38 INFO     evaluating now!
2024-04-30 20:01:38 INFO     Epoch [40/200] train_loss: 4.0422, val_loss: 5.2239, lr: 0.003000, 7.08s
2024-04-30 20:01:44 INFO     epoch complete!
2024-04-30 20:01:44 INFO     evaluating now!
2024-04-30 20:01:44 INFO     Epoch [41/200] train_loss: 4.0448, val_loss: 5.2417, lr: 0.003000, 6.45s
2024-04-30 20:01:51 INFO     epoch complete!
2024-04-30 20:01:51 INFO     evaluating now!
2024-04-30 20:01:51 INFO     Epoch [42/200] train_loss: 4.0849, val_loss: 5.2611, lr: 0.003000, 6.64s
2024-04-30 20:01:57 INFO     epoch complete!
2024-04-30 20:01:57 INFO     evaluating now!
2024-04-30 20:01:57 INFO     Epoch [43/200] train_loss: 4.0439, val_loss: 5.3233, lr: 0.003000, 6.33s
2024-04-30 20:02:03 INFO     epoch complete!
2024-04-30 20:02:03 INFO     evaluating now!
2024-04-30 20:02:04 INFO     Epoch [44/200] train_loss: 4.0141, val_loss: 5.2062, lr: 0.003000, 6.38s
2024-04-30 20:02:10 INFO     epoch complete!
2024-04-30 20:02:10 INFO     evaluating now!
2024-04-30 20:02:10 INFO     Epoch [45/200] train_loss: 3.9101, val_loss: 5.1847, lr: 0.003000, 6.32s
2024-04-30 20:02:16 INFO     epoch complete!
2024-04-30 20:02:16 INFO     evaluating now!
2024-04-30 20:02:17 INFO     Epoch [46/200] train_loss: 4.0499, val_loss: 5.2887, lr: 0.003000, 6.44s
2024-04-30 20:02:23 INFO     epoch complete!
2024-04-30 20:02:23 INFO     evaluating now!
2024-04-30 20:02:24 INFO     Epoch [47/200] train_loss: 3.9896, val_loss: 5.3816, lr: 0.003000, 7.06s
2024-04-30 20:02:30 INFO     epoch complete!
2024-04-30 20:02:30 INFO     evaluating now!
2024-04-30 20:02:31 INFO     Epoch [48/200] train_loss: 3.9405, val_loss: 5.3181, lr: 0.003000, 6.93s
2024-04-30 20:02:37 INFO     epoch complete!
2024-04-30 20:02:37 INFO     evaluating now!
2024-04-30 20:02:37 INFO     Epoch [49/200] train_loss: 3.8395, val_loss: 5.0978, lr: 0.003000, 6.88s
2024-04-30 20:02:37 INFO     Saved model at 49
2024-04-30 20:02:37 INFO     Val loss decrease from 5.1472 to 5.0978, saving to ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-04-30 20:02:44 INFO     epoch complete!
2024-04-30 20:02:44 INFO     evaluating now!
2024-04-30 20:02:44 INFO     Epoch [50/200] train_loss: 3.7841, val_loss: 5.2539, lr: 0.003000, 6.79s
2024-04-30 20:02:51 INFO     epoch complete!
2024-04-30 20:02:51 INFO     evaluating now!
2024-04-30 20:02:51 INFO     Epoch [51/200] train_loss: 3.7800, val_loss: 5.3033, lr: 0.003000, 6.88s
2024-04-30 20:02:57 INFO     epoch complete!
2024-04-30 20:02:57 INFO     evaluating now!
2024-04-30 20:02:58 INFO     Epoch [52/200] train_loss: 3.7737, val_loss: 5.3044, lr: 0.003000, 6.71s
2024-04-30 20:03:04 INFO     epoch complete!
2024-04-30 20:03:04 INFO     evaluating now!
2024-04-30 20:03:05 INFO     Epoch [53/200] train_loss: 3.7360, val_loss: 5.2582, lr: 0.003000, 6.82s
2024-04-30 20:03:11 INFO     epoch complete!
2024-04-30 20:03:11 INFO     evaluating now!
2024-04-30 20:03:12 INFO     Epoch [54/200] train_loss: 3.7707, val_loss: 5.2327, lr: 0.003000, 6.84s
2024-04-30 20:03:18 INFO     epoch complete!
2024-04-30 20:03:18 INFO     evaluating now!
2024-04-30 20:03:18 INFO     Epoch [55/200] train_loss: 3.7553, val_loss: 5.3422, lr: 0.003000, 6.82s
2024-04-30 20:03:25 INFO     epoch complete!
2024-04-30 20:03:25 INFO     evaluating now!
2024-04-30 20:03:25 INFO     Epoch [56/200] train_loss: 3.7604, val_loss: 5.1826, lr: 0.003000, 6.72s
2024-04-30 20:03:31 INFO     epoch complete!
2024-04-30 20:03:31 INFO     evaluating now!
2024-04-30 20:03:32 INFO     Epoch [57/200] train_loss: 3.8174, val_loss: 5.3261, lr: 0.003000, 6.70s
2024-04-30 20:03:38 INFO     epoch complete!
2024-04-30 20:03:38 INFO     evaluating now!
2024-04-30 20:03:38 INFO     Epoch [58/200] train_loss: 3.8612, val_loss: 5.2863, lr: 0.003000, 6.73s
2024-04-30 20:03:45 INFO     epoch complete!
2024-04-30 20:03:45 INFO     evaluating now!
2024-04-30 20:03:45 INFO     Epoch [59/200] train_loss: 3.7020, val_loss: 5.1627, lr: 0.003000, 6.77s
2024-04-30 20:03:52 INFO     epoch complete!
2024-04-30 20:03:52 INFO     evaluating now!
2024-04-30 20:03:52 INFO     Epoch [60/200] train_loss: 3.6784, val_loss: 5.2825, lr: 0.003000, 6.91s
2024-04-30 20:03:59 INFO     epoch complete!
2024-04-30 20:03:59 INFO     evaluating now!
2024-04-30 20:03:59 INFO     Epoch [61/200] train_loss: 3.6324, val_loss: 5.2084, lr: 0.003000, 6.95s
2024-04-30 20:04:06 INFO     epoch complete!
2024-04-30 20:04:06 INFO     evaluating now!
2024-04-30 20:04:06 INFO     Epoch [62/200] train_loss: 3.6544, val_loss: 5.3085, lr: 0.003000, 6.99s
2024-04-30 20:04:13 INFO     epoch complete!
2024-04-30 20:04:13 INFO     evaluating now!
2024-04-30 20:04:13 INFO     Epoch [63/200] train_loss: 3.6469, val_loss: 5.3083, lr: 0.003000, 6.93s
2024-04-30 20:04:19 INFO     epoch complete!
2024-04-30 20:04:19 INFO     evaluating now!
2024-04-30 20:04:20 INFO     Epoch [64/200] train_loss: 3.5832, val_loss: 5.2165, lr: 0.003000, 6.90s
2024-04-30 20:04:20 WARNING  Early stopping at epoch: 64
2024-04-30 20:04:20 INFO     Trained totally 65 epochs, average train time is 6.514s, average eval time is 0.460s
2024-04-30 20:04:20 INFO     Loaded model at 49
2024-04-30 20:04:20 INFO     Saved model at ./libcity/cache/27/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 20:04:20 INFO     Start evaluating ...
2024-04-30 20:04:22 INFO     Note that you select the single mode to evaluate!
2024-04-30 20:04:22 INFO     Evaluate result is saved at ./libcity/cache/27/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 20:04:22 INFO     
         MAE       RMSE
1   2.233379   6.768450
2   2.345924   7.443206
3   2.533666   8.415664
4   2.650390   9.341744
5   2.831598  10.103168
6   2.952668  10.787691
7   3.056780  11.339342
8   3.137637  11.743055
9   3.172460  12.085305
10  3.229707  12.356050
11  3.256202  12.718070
12  3.395733  13.144115
2024-04-30 20:04:22 INFO     ----------------------------------------------------------------------------
2024-04-30 20:04:22 INFO     # 3, Kownledge Graph Embedding: RotE, Experiment ids: 28
2024-04-30 20:04:22 INFO     ----------------------------------------------------------------------------
2024-04-30 20:04:22 INFO     Log directory: ./libcity/log
2024-04-30 20:04:22 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=28
2024-04-30 20:04:22 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 120878850, 'exp_id': 28, 'load_external': True, 'embedding_model': 'RotE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 20:04:22 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 20:04:22 INFO     set_weight_link_or_dist: dist
2024-04-30 20:04:22 INFO     init_weight_inf_or_zero: inf
2024-04-30 20:04:22 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 20:04:22 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 20:04:22 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 20:04:22 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 20:04:25 INFO     Dataset created
2024-04-30 20:04:25 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 20:04:25 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 20:04:25 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 20:04:25 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 20:04:25 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 20:04:25 INFO     NoneScaler
2024-04-30 20:04:27 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 20:04:27 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 20:04:27 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 20:04:27 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 20:04:27 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 20:04:27 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 20:04:27 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 20:04:27 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 20:04:27 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 20:04:27 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 20:04:27 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 20:04:27 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 20:04:27 INFO     Total parameter numbers: 874010
2024-04-30 20:04:27 INFO     You select `adam` optimizer.
2024-04-30 20:04:27 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 20:04:27 INFO     Start training ...
2024-04-30 20:04:27 INFO     num_batches:48
2024-04-30 20:04:34 INFO     epoch complete!
2024-04-30 20:04:34 INFO     evaluating now!
2024-04-30 20:04:34 INFO     Epoch [0/200] train_loss: 22.9731, val_loss: 18.7995, lr: 0.003000, 6.73s
2024-04-30 20:04:34 INFO     Saved model at 0
2024-04-30 20:04:34 INFO     Val loss decrease from inf to 18.7995, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 20:04:40 INFO     epoch complete!
2024-04-30 20:04:40 INFO     evaluating now!
2024-04-30 20:04:41 INFO     Epoch [1/200] train_loss: 15.3808, val_loss: 14.7562, lr: 0.003000, 6.75s
2024-04-30 20:04:41 INFO     Saved model at 1
2024-04-30 20:04:41 INFO     Val loss decrease from 18.7995 to 14.7562, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 20:04:47 INFO     epoch complete!
2024-04-30 20:04:47 INFO     evaluating now!
2024-04-30 20:04:48 INFO     Epoch [2/200] train_loss: 12.6366, val_loss: 12.4214, lr: 0.003000, 7.02s
2024-04-30 20:04:48 INFO     Saved model at 2
2024-04-30 20:04:48 INFO     Val loss decrease from 14.7562 to 12.4214, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 20:04:55 INFO     epoch complete!
2024-04-30 20:04:55 INFO     evaluating now!
2024-04-30 20:04:55 INFO     Epoch [3/200] train_loss: 10.3155, val_loss: 9.6736, lr: 0.003000, 7.08s
2024-04-30 20:04:55 INFO     Saved model at 3
2024-04-30 20:04:55 INFO     Val loss decrease from 12.4214 to 9.6736, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 20:05:02 INFO     epoch complete!
2024-04-30 20:05:02 INFO     evaluating now!
2024-04-30 20:05:02 INFO     Epoch [4/200] train_loss: 8.7263, val_loss: 8.4913, lr: 0.003000, 7.28s
2024-04-30 20:05:02 INFO     Saved model at 4
2024-04-30 20:05:02 INFO     Val loss decrease from 9.6736 to 8.4913, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 20:05:09 INFO     epoch complete!
2024-04-30 20:05:09 INFO     evaluating now!
2024-04-30 20:05:10 INFO     Epoch [5/200] train_loss: 7.9384, val_loss: 7.7609, lr: 0.003000, 7.11s
2024-04-30 20:05:10 INFO     Saved model at 5
2024-04-30 20:05:10 INFO     Val loss decrease from 8.4913 to 7.7609, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 20:05:16 INFO     epoch complete!
2024-04-30 20:05:16 INFO     evaluating now!
2024-04-30 20:05:17 INFO     Epoch [6/200] train_loss: 7.1443, val_loss: 7.0299, lr: 0.003000, 7.09s
2024-04-30 20:05:17 INFO     Saved model at 6
2024-04-30 20:05:17 INFO     Val loss decrease from 7.7609 to 7.0299, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 20:05:23 INFO     epoch complete!
2024-04-30 20:05:23 INFO     evaluating now!
2024-04-30 20:05:24 INFO     Epoch [7/200] train_loss: 6.7100, val_loss: 6.7952, lr: 0.003000, 7.15s
2024-04-30 20:05:24 INFO     Saved model at 7
2024-04-30 20:05:24 INFO     Val loss decrease from 7.0299 to 6.7952, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 20:05:31 INFO     epoch complete!
2024-04-30 20:05:31 INFO     evaluating now!
2024-04-30 20:05:31 INFO     Epoch [8/200] train_loss: 6.3672, val_loss: 6.1694, lr: 0.003000, 7.13s
2024-04-30 20:05:31 INFO     Saved model at 8
2024-04-30 20:05:31 INFO     Val loss decrease from 6.7952 to 6.1694, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 20:05:38 INFO     epoch complete!
2024-04-30 20:05:38 INFO     evaluating now!
2024-04-30 20:05:38 INFO     Epoch [9/200] train_loss: 6.1371, val_loss: 6.2561, lr: 0.003000, 7.31s
2024-04-30 20:05:45 INFO     epoch complete!
2024-04-30 20:05:45 INFO     evaluating now!
2024-04-30 20:05:46 INFO     Epoch [10/200] train_loss: 5.9755, val_loss: 6.0639, lr: 0.003000, 7.27s
2024-04-30 20:05:46 INFO     Saved model at 10
2024-04-30 20:05:46 INFO     Val loss decrease from 6.1694 to 6.0639, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 20:05:52 INFO     epoch complete!
2024-04-30 20:05:52 INFO     evaluating now!
2024-04-30 20:05:53 INFO     Epoch [11/200] train_loss: 5.7713, val_loss: 6.1099, lr: 0.003000, 7.06s
2024-04-30 20:06:00 INFO     epoch complete!
2024-04-30 20:06:00 INFO     evaluating now!
2024-04-30 20:06:00 INFO     Epoch [12/200] train_loss: 5.7176, val_loss: 5.8003, lr: 0.003000, 7.23s
2024-04-30 20:06:00 INFO     Saved model at 12
2024-04-30 20:06:00 INFO     Val loss decrease from 6.0639 to 5.8003, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 20:06:07 INFO     epoch complete!
2024-04-30 20:06:07 INFO     evaluating now!
2024-04-30 20:06:08 INFO     Epoch [13/200] train_loss: 5.5091, val_loss: 5.6324, lr: 0.003000, 7.51s
2024-04-30 20:06:08 INFO     Saved model at 13
2024-04-30 20:06:08 INFO     Val loss decrease from 5.8003 to 5.6324, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 20:06:15 INFO     epoch complete!
2024-04-30 20:06:15 INFO     evaluating now!
2024-04-30 20:06:15 INFO     Epoch [14/200] train_loss: 5.4977, val_loss: 5.8509, lr: 0.003000, 7.36s
2024-04-30 20:06:22 INFO     epoch complete!
2024-04-30 20:06:22 INFO     evaluating now!
2024-04-30 20:06:22 INFO     Epoch [15/200] train_loss: 5.4626, val_loss: 5.9511, lr: 0.003000, 7.20s
2024-04-30 20:06:29 INFO     epoch complete!
2024-04-30 20:06:29 INFO     evaluating now!
2024-04-30 20:06:29 INFO     Epoch [16/200] train_loss: 5.3657, val_loss: 5.7242, lr: 0.003000, 7.20s
2024-04-30 20:06:36 INFO     epoch complete!
2024-04-30 20:06:36 INFO     evaluating now!
2024-04-30 20:06:37 INFO     Epoch [17/200] train_loss: 5.1228, val_loss: 5.6264, lr: 0.003000, 7.11s
2024-04-30 20:06:37 INFO     Saved model at 17
2024-04-30 20:06:37 INFO     Val loss decrease from 5.6324 to 5.6264, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 20:06:43 INFO     epoch complete!
2024-04-30 20:06:43 INFO     evaluating now!
2024-04-30 20:06:44 INFO     Epoch [18/200] train_loss: 5.0439, val_loss: 5.4977, lr: 0.003000, 7.25s
2024-04-30 20:06:44 INFO     Saved model at 18
2024-04-30 20:06:44 INFO     Val loss decrease from 5.6264 to 5.4977, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 20:06:51 INFO     epoch complete!
2024-04-30 20:06:51 INFO     evaluating now!
2024-04-30 20:06:51 INFO     Epoch [19/200] train_loss: 4.9477, val_loss: 5.3037, lr: 0.003000, 7.15s
2024-04-30 20:06:51 INFO     Saved model at 19
2024-04-30 20:06:51 INFO     Val loss decrease from 5.4977 to 5.3037, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 20:06:58 INFO     epoch complete!
2024-04-30 20:06:58 INFO     evaluating now!
2024-04-30 20:06:58 INFO     Epoch [20/200] train_loss: 4.9346, val_loss: 5.6680, lr: 0.003000, 7.24s
2024-04-30 20:07:05 INFO     epoch complete!
2024-04-30 20:07:05 INFO     evaluating now!
2024-04-30 20:07:05 INFO     Epoch [21/200] train_loss: 4.8626, val_loss: 5.4736, lr: 0.003000, 6.97s
2024-04-30 20:07:12 INFO     epoch complete!
2024-04-30 20:07:12 INFO     evaluating now!
2024-04-30 20:07:12 INFO     Epoch [22/200] train_loss: 4.7769, val_loss: 5.3511, lr: 0.003000, 6.97s
2024-04-30 20:07:19 INFO     epoch complete!
2024-04-30 20:07:19 INFO     evaluating now!
2024-04-30 20:07:19 INFO     Epoch [23/200] train_loss: 4.8216, val_loss: 5.5459, lr: 0.003000, 6.96s
2024-04-30 20:07:26 INFO     epoch complete!
2024-04-30 20:07:26 INFO     evaluating now!
2024-04-30 20:07:26 INFO     Epoch [24/200] train_loss: 4.6880, val_loss: 5.4392, lr: 0.003000, 6.91s
2024-04-30 20:07:33 INFO     epoch complete!
2024-04-30 20:07:33 INFO     evaluating now!
2024-04-30 20:07:33 INFO     Epoch [25/200] train_loss: 4.6206, val_loss: 5.5208, lr: 0.003000, 7.22s
2024-04-30 20:07:40 INFO     epoch complete!
2024-04-30 20:07:40 INFO     evaluating now!
2024-04-30 20:07:41 INFO     Epoch [26/200] train_loss: 4.6712, val_loss: 5.3116, lr: 0.003000, 7.28s
2024-04-30 20:07:47 INFO     epoch complete!
2024-04-30 20:07:47 INFO     evaluating now!
2024-04-30 20:07:48 INFO     Epoch [27/200] train_loss: 4.6001, val_loss: 5.2656, lr: 0.003000, 7.36s
2024-04-30 20:07:48 INFO     Saved model at 27
2024-04-30 20:07:48 INFO     Val loss decrease from 5.3037 to 5.2656, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-30 20:07:55 INFO     epoch complete!
2024-04-30 20:07:55 INFO     evaluating now!
2024-04-30 20:07:55 INFO     Epoch [28/200] train_loss: 4.4622, val_loss: 5.4433, lr: 0.003000, 7.13s
2024-04-30 20:08:01 INFO     epoch complete!
2024-04-30 20:08:01 INFO     evaluating now!
2024-04-30 20:08:02 INFO     Epoch [29/200] train_loss: 4.4676, val_loss: 5.1803, lr: 0.003000, 6.56s
2024-04-30 20:08:02 INFO     Saved model at 29
2024-04-30 20:08:02 INFO     Val loss decrease from 5.2656 to 5.1803, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-04-30 20:08:08 INFO     epoch complete!
2024-04-30 20:08:08 INFO     evaluating now!
2024-04-30 20:08:08 INFO     Epoch [30/200] train_loss: 4.3927, val_loss: 5.2506, lr: 0.003000, 6.32s
2024-04-30 20:08:14 INFO     epoch complete!
2024-04-30 20:08:14 INFO     evaluating now!
2024-04-30 20:08:14 INFO     Epoch [31/200] train_loss: 4.3419, val_loss: 5.3857, lr: 0.003000, 6.26s
2024-04-30 20:08:20 INFO     epoch complete!
2024-04-30 20:08:20 INFO     evaluating now!
2024-04-30 20:08:21 INFO     Epoch [32/200] train_loss: 4.2878, val_loss: 5.2388, lr: 0.003000, 6.37s
2024-04-30 20:08:27 INFO     epoch complete!
2024-04-30 20:08:27 INFO     evaluating now!
2024-04-30 20:08:27 INFO     Epoch [33/200] train_loss: 4.2815, val_loss: 5.2431, lr: 0.003000, 6.42s
2024-04-30 20:08:33 INFO     epoch complete!
2024-04-30 20:08:33 INFO     evaluating now!
2024-04-30 20:08:34 INFO     Epoch [34/200] train_loss: 4.2917, val_loss: 5.2961, lr: 0.003000, 6.50s
2024-04-30 20:08:40 INFO     epoch complete!
2024-04-30 20:08:40 INFO     evaluating now!
2024-04-30 20:08:40 INFO     Epoch [35/200] train_loss: 4.2220, val_loss: 5.2392, lr: 0.003000, 6.75s
2024-04-30 20:08:47 INFO     epoch complete!
2024-04-30 20:08:47 INFO     evaluating now!
2024-04-30 20:08:48 INFO     Epoch [36/200] train_loss: 4.2097, val_loss: 5.3286, lr: 0.003000, 7.32s
2024-04-30 20:08:54 INFO     epoch complete!
2024-04-30 20:08:54 INFO     evaluating now!
2024-04-30 20:08:54 INFO     Epoch [37/200] train_loss: 4.1013, val_loss: 5.3234, lr: 0.003000, 6.72s
2024-04-30 20:09:01 INFO     epoch complete!
2024-04-30 20:09:01 INFO     evaluating now!
2024-04-30 20:09:01 INFO     Epoch [38/200] train_loss: 4.1843, val_loss: 5.3438, lr: 0.003000, 6.84s
2024-04-30 20:09:08 INFO     epoch complete!
2024-04-30 20:09:08 INFO     evaluating now!
2024-04-30 20:09:08 INFO     Epoch [39/200] train_loss: 4.1281, val_loss: 5.1285, lr: 0.003000, 6.90s
2024-04-30 20:09:08 INFO     Saved model at 39
2024-04-30 20:09:08 INFO     Val loss decrease from 5.1803 to 5.1285, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-04-30 20:09:14 INFO     epoch complete!
2024-04-30 20:09:14 INFO     evaluating now!
2024-04-30 20:09:15 INFO     Epoch [40/200] train_loss: 4.0334, val_loss: 5.2758, lr: 0.003000, 6.65s
2024-04-30 20:09:21 INFO     epoch complete!
2024-04-30 20:09:21 INFO     evaluating now!
2024-04-30 20:09:22 INFO     Epoch [41/200] train_loss: 3.9942, val_loss: 5.0917, lr: 0.003000, 6.86s
2024-04-30 20:09:22 INFO     Saved model at 41
2024-04-30 20:09:22 INFO     Val loss decrease from 5.1285 to 5.0917, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-04-30 20:09:28 INFO     epoch complete!
2024-04-30 20:09:28 INFO     evaluating now!
2024-04-30 20:09:29 INFO     Epoch [42/200] train_loss: 3.9889, val_loss: 5.2025, lr: 0.003000, 6.87s
2024-04-30 20:09:35 INFO     epoch complete!
2024-04-30 20:09:35 INFO     evaluating now!
2024-04-30 20:09:36 INFO     Epoch [43/200] train_loss: 4.0081, val_loss: 5.1502, lr: 0.003000, 6.94s
2024-04-30 20:09:42 INFO     epoch complete!
2024-04-30 20:09:42 INFO     evaluating now!
2024-04-30 20:09:43 INFO     Epoch [44/200] train_loss: 3.9542, val_loss: 5.1070, lr: 0.003000, 7.02s
2024-04-30 20:09:49 INFO     epoch complete!
2024-04-30 20:09:49 INFO     evaluating now!
2024-04-30 20:09:50 INFO     Epoch [45/200] train_loss: 3.9019, val_loss: 5.0065, lr: 0.003000, 7.01s
2024-04-30 20:09:50 INFO     Saved model at 45
2024-04-30 20:09:50 INFO     Val loss decrease from 5.0917 to 5.0065, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-04-30 20:09:56 INFO     epoch complete!
2024-04-30 20:09:56 INFO     evaluating now!
2024-04-30 20:09:56 INFO     Epoch [46/200] train_loss: 3.9148, val_loss: 4.9868, lr: 0.003000, 6.85s
2024-04-30 20:09:57 INFO     Saved model at 46
2024-04-30 20:09:57 INFO     Val loss decrease from 5.0065 to 4.9868, saving to ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-04-30 20:10:03 INFO     epoch complete!
2024-04-30 20:10:03 INFO     evaluating now!
2024-04-30 20:10:04 INFO     Epoch [47/200] train_loss: 3.8306, val_loss: 5.0737, lr: 0.003000, 7.10s
2024-04-30 20:10:10 INFO     epoch complete!
2024-04-30 20:10:10 INFO     evaluating now!
2024-04-30 20:10:10 INFO     Epoch [48/200] train_loss: 3.8851, val_loss: 5.0749, lr: 0.003000, 6.76s
2024-04-30 20:10:17 INFO     epoch complete!
2024-04-30 20:10:17 INFO     evaluating now!
2024-04-30 20:10:17 INFO     Epoch [49/200] train_loss: 3.8335, val_loss: 5.1501, lr: 0.003000, 6.87s
2024-04-30 20:10:24 INFO     epoch complete!
2024-04-30 20:10:24 INFO     evaluating now!
2024-04-30 20:10:25 INFO     Epoch [50/200] train_loss: 3.7765, val_loss: 5.1106, lr: 0.003000, 7.35s
2024-04-30 20:10:32 INFO     epoch complete!
2024-04-30 20:10:32 INFO     evaluating now!
2024-04-30 20:10:32 INFO     Epoch [51/200] train_loss: 3.9439, val_loss: 5.1821, lr: 0.003000, 7.64s
2024-04-30 20:10:39 INFO     epoch complete!
2024-04-30 20:10:39 INFO     evaluating now!
2024-04-30 20:10:40 INFO     Epoch [52/200] train_loss: 3.8493, val_loss: 5.0779, lr: 0.003000, 7.27s
2024-04-30 20:10:46 INFO     epoch complete!
2024-04-30 20:10:46 INFO     evaluating now!
2024-04-30 20:10:47 INFO     Epoch [53/200] train_loss: 3.7732, val_loss: 5.1838, lr: 0.003000, 7.01s
2024-04-30 20:10:53 INFO     epoch complete!
2024-04-30 20:10:53 INFO     evaluating now!
2024-04-30 20:10:54 INFO     Epoch [54/200] train_loss: 3.8018, val_loss: 5.1167, lr: 0.003000, 6.98s
2024-04-30 20:11:00 INFO     epoch complete!
2024-04-30 20:11:00 INFO     evaluating now!
2024-04-30 20:11:01 INFO     Epoch [55/200] train_loss: 3.7525, val_loss: 5.0429, lr: 0.003000, 7.01s
2024-04-30 20:11:07 INFO     epoch complete!
2024-04-30 20:11:07 INFO     evaluating now!
2024-04-30 20:11:08 INFO     Epoch [56/200] train_loss: 3.7149, val_loss: 5.2518, lr: 0.003000, 7.05s
2024-04-30 20:11:14 INFO     epoch complete!
2024-04-30 20:11:14 INFO     evaluating now!
2024-04-30 20:11:15 INFO     Epoch [57/200] train_loss: 3.7746, val_loss: 5.2190, lr: 0.003000, 7.33s
2024-04-30 20:11:22 INFO     epoch complete!
2024-04-30 20:11:22 INFO     evaluating now!
2024-04-30 20:11:22 INFO     Epoch [58/200] train_loss: 3.7151, val_loss: 5.0239, lr: 0.003000, 7.10s
2024-04-30 20:11:29 INFO     epoch complete!
2024-04-30 20:11:29 INFO     evaluating now!
2024-04-30 20:11:29 INFO     Epoch [59/200] train_loss: 3.6994, val_loss: 5.1598, lr: 0.003000, 7.05s
2024-04-30 20:11:36 INFO     epoch complete!
2024-04-30 20:11:36 INFO     evaluating now!
2024-04-30 20:11:36 INFO     Epoch [60/200] train_loss: 3.6300, val_loss: 5.0979, lr: 0.003000, 6.97s
2024-04-30 20:11:43 INFO     epoch complete!
2024-04-30 20:11:43 INFO     evaluating now!
2024-04-30 20:11:43 INFO     Epoch [61/200] train_loss: 3.6302, val_loss: 5.0632, lr: 0.003000, 6.93s
2024-04-30 20:11:43 WARNING  Early stopping at epoch: 61
2024-04-30 20:11:43 INFO     Trained totally 62 epochs, average train time is 6.538s, average eval time is 0.470s
2024-04-30 20:11:43 INFO     Loaded model at 46
2024-04-30 20:11:43 INFO     Saved model at ./libcity/cache/28/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 20:11:43 INFO     Start evaluating ...
2024-04-30 20:11:45 INFO     Note that you select the single mode to evaluate!
2024-04-30 20:11:45 INFO     Evaluate result is saved at ./libcity/cache/28/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 20:11:45 INFO     
         MAE       RMSE
1   2.453538   6.881251
2   2.449713   7.473615
3   2.656905   8.510532
4   2.818208   9.398926
5   2.992363  10.462806
6   3.112857  11.662575
7   3.256081  12.473343
8   3.280107  13.259818
9   3.347399  13.405787
10  3.383054  13.398008
11  3.421301  13.549018
12  3.446364  14.003191
2024-04-30 20:11:45 INFO     ----------------------------------------------------------------------------
2024-04-30 20:11:45 INFO     # 4, Kownledge Graph Embedding: RotE, Experiment ids: 29
2024-04-30 20:11:45 INFO     ----------------------------------------------------------------------------
2024-04-30 20:11:45 INFO     Log directory: ./libcity/log
2024-04-30 20:11:45 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=29
2024-04-30 20:11:45 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 705769436, 'exp_id': 29, 'load_external': True, 'embedding_model': 'RotE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 20:11:45 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 20:11:45 INFO     set_weight_link_or_dist: dist
2024-04-30 20:11:45 INFO     init_weight_inf_or_zero: inf
2024-04-30 20:11:45 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 20:11:45 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 20:11:45 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 20:11:45 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 20:11:48 INFO     Dataset created
2024-04-30 20:11:48 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 20:11:48 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 20:11:48 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 20:11:48 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 20:11:48 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 20:11:48 INFO     NoneScaler
2024-04-30 20:11:50 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 20:11:50 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 20:11:50 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 20:11:50 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 20:11:50 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 20:11:50 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 20:11:50 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 20:11:50 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 20:11:50 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 20:11:50 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 20:11:50 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 20:11:50 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 20:11:50 INFO     Total parameter numbers: 874010
2024-04-30 20:11:50 INFO     You select `adam` optimizer.
2024-04-30 20:11:50 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 20:11:50 INFO     Start training ...
2024-04-30 20:11:50 INFO     num_batches:48
2024-04-30 20:11:57 INFO     epoch complete!
2024-04-30 20:11:57 INFO     evaluating now!
2024-04-30 20:11:57 INFO     Epoch [0/200] train_loss: 25.4420, val_loss: 18.9171, lr: 0.003000, 7.00s
2024-04-30 20:11:57 INFO     Saved model at 0
2024-04-30 20:11:57 INFO     Val loss decrease from inf to 18.9171, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 20:12:04 INFO     epoch complete!
2024-04-30 20:12:04 INFO     evaluating now!
2024-04-30 20:12:04 INFO     Epoch [1/200] train_loss: 16.2935, val_loss: 16.5473, lr: 0.003000, 7.10s
2024-04-30 20:12:04 INFO     Saved model at 1
2024-04-30 20:12:04 INFO     Val loss decrease from 18.9171 to 16.5473, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 20:12:11 INFO     epoch complete!
2024-04-30 20:12:11 INFO     evaluating now!
2024-04-30 20:12:11 INFO     Epoch [2/200] train_loss: 13.9928, val_loss: 13.7252, lr: 0.003000, 6.97s
2024-04-30 20:12:12 INFO     Saved model at 2
2024-04-30 20:12:12 INFO     Val loss decrease from 16.5473 to 13.7252, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 20:12:18 INFO     epoch complete!
2024-04-30 20:12:18 INFO     evaluating now!
2024-04-30 20:12:19 INFO     Epoch [3/200] train_loss: 11.6494, val_loss: 11.9777, lr: 0.003000, 7.02s
2024-04-30 20:12:19 INFO     Saved model at 3
2024-04-30 20:12:19 INFO     Val loss decrease from 13.7252 to 11.9777, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 20:12:25 INFO     epoch complete!
2024-04-30 20:12:25 INFO     evaluating now!
2024-04-30 20:12:26 INFO     Epoch [4/200] train_loss: 10.2918, val_loss: 9.9178, lr: 0.003000, 7.00s
2024-04-30 20:12:26 INFO     Saved model at 4
2024-04-30 20:12:26 INFO     Val loss decrease from 11.9777 to 9.9178, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 20:12:32 INFO     epoch complete!
2024-04-30 20:12:32 INFO     evaluating now!
2024-04-30 20:12:33 INFO     Epoch [5/200] train_loss: 9.1876, val_loss: 9.5509, lr: 0.003000, 6.97s
2024-04-30 20:12:33 INFO     Saved model at 5
2024-04-30 20:12:33 INFO     Val loss decrease from 9.9178 to 9.5509, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 20:12:39 INFO     epoch complete!
2024-04-30 20:12:39 INFO     evaluating now!
2024-04-30 20:12:40 INFO     Epoch [6/200] train_loss: 8.3464, val_loss: 8.1176, lr: 0.003000, 7.04s
2024-04-30 20:12:40 INFO     Saved model at 6
2024-04-30 20:12:40 INFO     Val loss decrease from 9.5509 to 8.1176, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 20:12:46 INFO     epoch complete!
2024-04-30 20:12:46 INFO     evaluating now!
2024-04-30 20:12:47 INFO     Epoch [7/200] train_loss: 7.6161, val_loss: 7.4361, lr: 0.003000, 7.01s
2024-04-30 20:12:47 INFO     Saved model at 7
2024-04-30 20:12:47 INFO     Val loss decrease from 8.1176 to 7.4361, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 20:12:53 INFO     epoch complete!
2024-04-30 20:12:53 INFO     evaluating now!
2024-04-30 20:12:54 INFO     Epoch [8/200] train_loss: 7.1479, val_loss: 7.2478, lr: 0.003000, 7.01s
2024-04-30 20:12:54 INFO     Saved model at 8
2024-04-30 20:12:54 INFO     Val loss decrease from 7.4361 to 7.2478, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 20:13:01 INFO     epoch complete!
2024-04-30 20:13:01 INFO     evaluating now!
2024-04-30 20:13:02 INFO     Epoch [9/200] train_loss: 6.7623, val_loss: 6.6756, lr: 0.003000, 7.74s
2024-04-30 20:13:02 INFO     Saved model at 9
2024-04-30 20:13:02 INFO     Val loss decrease from 7.2478 to 6.6756, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 20:13:08 INFO     epoch complete!
2024-04-30 20:13:08 INFO     evaluating now!
2024-04-30 20:13:09 INFO     Epoch [10/200] train_loss: 6.6542, val_loss: 6.7189, lr: 0.003000, 7.29s
2024-04-30 20:13:15 INFO     epoch complete!
2024-04-30 20:13:15 INFO     evaluating now!
2024-04-30 20:13:16 INFO     Epoch [11/200] train_loss: 6.3879, val_loss: 6.6891, lr: 0.003000, 6.98s
2024-04-30 20:13:22 INFO     epoch complete!
2024-04-30 20:13:22 INFO     evaluating now!
2024-04-30 20:13:23 INFO     Epoch [12/200] train_loss: 6.1628, val_loss: 6.4839, lr: 0.003000, 6.94s
2024-04-30 20:13:23 INFO     Saved model at 12
2024-04-30 20:13:23 INFO     Val loss decrease from 6.6756 to 6.4839, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 20:13:29 INFO     epoch complete!
2024-04-30 20:13:29 INFO     evaluating now!
2024-04-30 20:13:30 INFO     Epoch [13/200] train_loss: 5.8706, val_loss: 6.0852, lr: 0.003000, 6.90s
2024-04-30 20:13:30 INFO     Saved model at 13
2024-04-30 20:13:30 INFO     Val loss decrease from 6.4839 to 6.0852, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 20:13:36 INFO     epoch complete!
2024-04-30 20:13:36 INFO     evaluating now!
2024-04-30 20:13:37 INFO     Epoch [14/200] train_loss: 5.7574, val_loss: 6.2790, lr: 0.003000, 6.83s
2024-04-30 20:13:43 INFO     epoch complete!
2024-04-30 20:13:43 INFO     evaluating now!
2024-04-30 20:13:44 INFO     Epoch [15/200] train_loss: 5.7767, val_loss: 5.9516, lr: 0.003000, 7.02s
2024-04-30 20:13:44 INFO     Saved model at 15
2024-04-30 20:13:44 INFO     Val loss decrease from 6.0852 to 5.9516, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 20:13:50 INFO     epoch complete!
2024-04-30 20:13:50 INFO     evaluating now!
2024-04-30 20:13:51 INFO     Epoch [16/200] train_loss: 5.5388, val_loss: 6.1044, lr: 0.003000, 6.92s
2024-04-30 20:13:57 INFO     epoch complete!
2024-04-30 20:13:57 INFO     evaluating now!
2024-04-30 20:13:57 INFO     Epoch [17/200] train_loss: 5.4770, val_loss: 5.5941, lr: 0.003000, 6.83s
2024-04-30 20:13:58 INFO     Saved model at 17
2024-04-30 20:13:58 INFO     Val loss decrease from 5.9516 to 5.5941, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 20:14:04 INFO     epoch complete!
2024-04-30 20:14:04 INFO     evaluating now!
2024-04-30 20:14:04 INFO     Epoch [18/200] train_loss: 5.4691, val_loss: 5.7002, lr: 0.003000, 6.96s
2024-04-30 20:14:11 INFO     epoch complete!
2024-04-30 20:14:11 INFO     evaluating now!
2024-04-30 20:14:12 INFO     Epoch [19/200] train_loss: 5.2875, val_loss: 5.5375, lr: 0.003000, 7.11s
2024-04-30 20:14:12 INFO     Saved model at 19
2024-04-30 20:14:12 INFO     Val loss decrease from 5.5941 to 5.5375, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 20:14:18 INFO     epoch complete!
2024-04-30 20:14:18 INFO     evaluating now!
2024-04-30 20:14:18 INFO     Epoch [20/200] train_loss: 5.2724, val_loss: 5.6565, lr: 0.003000, 6.79s
2024-04-30 20:14:25 INFO     epoch complete!
2024-04-30 20:14:25 INFO     evaluating now!
2024-04-30 20:14:26 INFO     Epoch [21/200] train_loss: 5.0643, val_loss: 5.4644, lr: 0.003000, 7.38s
2024-04-30 20:14:26 INFO     Saved model at 21
2024-04-30 20:14:26 INFO     Val loss decrease from 5.5375 to 5.4644, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-30 20:14:33 INFO     epoch complete!
2024-04-30 20:14:33 INFO     evaluating now!
2024-04-30 20:14:33 INFO     Epoch [22/200] train_loss: 5.0332, val_loss: 5.4680, lr: 0.003000, 7.33s
2024-04-30 20:14:39 INFO     epoch complete!
2024-04-30 20:14:39 INFO     evaluating now!
2024-04-30 20:14:40 INFO     Epoch [23/200] train_loss: 5.0780, val_loss: 5.4226, lr: 0.003000, 6.57s
2024-04-30 20:14:40 INFO     Saved model at 23
2024-04-30 20:14:40 INFO     Val loss decrease from 5.4644 to 5.4226, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-30 20:14:46 INFO     epoch complete!
2024-04-30 20:14:46 INFO     evaluating now!
2024-04-30 20:14:46 INFO     Epoch [24/200] train_loss: 4.8771, val_loss: 5.2611, lr: 0.003000, 6.56s
2024-04-30 20:14:46 INFO     Saved model at 24
2024-04-30 20:14:46 INFO     Val loss decrease from 5.4226 to 5.2611, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-04-30 20:14:52 INFO     epoch complete!
2024-04-30 20:14:52 INFO     evaluating now!
2024-04-30 20:14:53 INFO     Epoch [25/200] train_loss: 4.8553, val_loss: 5.4456, lr: 0.003000, 6.34s
2024-04-30 20:14:59 INFO     epoch complete!
2024-04-30 20:14:59 INFO     evaluating now!
2024-04-30 20:15:00 INFO     Epoch [26/200] train_loss: 4.7717, val_loss: 5.3766, lr: 0.003000, 7.00s
2024-04-30 20:15:07 INFO     epoch complete!
2024-04-30 20:15:07 INFO     evaluating now!
2024-04-30 20:15:07 INFO     Epoch [27/200] train_loss: 4.7187, val_loss: 5.5372, lr: 0.003000, 7.24s
2024-04-30 20:15:14 INFO     epoch complete!
2024-04-30 20:15:14 INFO     evaluating now!
2024-04-30 20:15:14 INFO     Epoch [28/200] train_loss: 4.7532, val_loss: 5.2740, lr: 0.003000, 7.18s
2024-04-30 20:15:21 INFO     epoch complete!
2024-04-30 20:15:21 INFO     evaluating now!
2024-04-30 20:15:21 INFO     Epoch [29/200] train_loss: 4.6780, val_loss: 5.6047, lr: 0.003000, 7.08s
2024-04-30 20:15:28 INFO     epoch complete!
2024-04-30 20:15:28 INFO     evaluating now!
2024-04-30 20:15:28 INFO     Epoch [30/200] train_loss: 4.6054, val_loss: 5.2921, lr: 0.003000, 6.91s
2024-04-30 20:15:35 INFO     epoch complete!
2024-04-30 20:15:35 INFO     evaluating now!
2024-04-30 20:15:35 INFO     Epoch [31/200] train_loss: 4.5550, val_loss: 5.4282, lr: 0.003000, 7.05s
2024-04-30 20:15:42 INFO     epoch complete!
2024-04-30 20:15:42 INFO     evaluating now!
2024-04-30 20:15:42 INFO     Epoch [32/200] train_loss: 4.5867, val_loss: 5.2044, lr: 0.003000, 7.07s
2024-04-30 20:15:42 INFO     Saved model at 32
2024-04-30 20:15:42 INFO     Val loss decrease from 5.2611 to 5.2044, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-04-30 20:15:49 INFO     epoch complete!
2024-04-30 20:15:49 INFO     evaluating now!
2024-04-30 20:15:49 INFO     Epoch [33/200] train_loss: 4.4910, val_loss: 5.5112, lr: 0.003000, 6.77s
2024-04-30 20:15:55 INFO     epoch complete!
2024-04-30 20:15:55 INFO     evaluating now!
2024-04-30 20:15:56 INFO     Epoch [34/200] train_loss: 4.4314, val_loss: 5.3726, lr: 0.003000, 6.79s
2024-04-30 20:16:02 INFO     epoch complete!
2024-04-30 20:16:02 INFO     evaluating now!
2024-04-30 20:16:03 INFO     Epoch [35/200] train_loss: 4.3200, val_loss: 5.2881, lr: 0.003000, 6.83s
2024-04-30 20:16:09 INFO     epoch complete!
2024-04-30 20:16:09 INFO     evaluating now!
2024-04-30 20:16:10 INFO     Epoch [36/200] train_loss: 4.3759, val_loss: 5.2734, lr: 0.003000, 6.87s
2024-04-30 20:16:16 INFO     epoch complete!
2024-04-30 20:16:16 INFO     evaluating now!
2024-04-30 20:16:17 INFO     Epoch [37/200] train_loss: 4.3298, val_loss: 5.3199, lr: 0.003000, 6.94s
2024-04-30 20:16:23 INFO     epoch complete!
2024-04-30 20:16:23 INFO     evaluating now!
2024-04-30 20:16:23 INFO     Epoch [38/200] train_loss: 4.3451, val_loss: 5.0388, lr: 0.003000, 6.88s
2024-04-30 20:16:23 INFO     Saved model at 38
2024-04-30 20:16:23 INFO     Val loss decrease from 5.2044 to 5.0388, saving to ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-04-30 20:16:30 INFO     epoch complete!
2024-04-30 20:16:30 INFO     evaluating now!
2024-04-30 20:16:30 INFO     Epoch [39/200] train_loss: 4.2569, val_loss: 5.4727, lr: 0.003000, 6.87s
2024-04-30 20:16:37 INFO     epoch complete!
2024-04-30 20:16:37 INFO     evaluating now!
2024-04-30 20:16:37 INFO     Epoch [40/200] train_loss: 4.2831, val_loss: 5.2643, lr: 0.003000, 6.84s
2024-04-30 20:16:44 INFO     epoch complete!
2024-04-30 20:16:44 INFO     evaluating now!
2024-04-30 20:16:44 INFO     Epoch [41/200] train_loss: 4.1767, val_loss: 5.1408, lr: 0.003000, 6.94s
2024-04-30 20:16:51 INFO     epoch complete!
2024-04-30 20:16:51 INFO     evaluating now!
2024-04-30 20:16:51 INFO     Epoch [42/200] train_loss: 4.1726, val_loss: 5.0747, lr: 0.003000, 7.32s
2024-04-30 20:16:58 INFO     epoch complete!
2024-04-30 20:16:58 INFO     evaluating now!
2024-04-30 20:16:59 INFO     Epoch [43/200] train_loss: 4.1971, val_loss: 5.1863, lr: 0.003000, 7.40s
2024-04-30 20:17:05 INFO     epoch complete!
2024-04-30 20:17:05 INFO     evaluating now!
2024-04-30 20:17:06 INFO     Epoch [44/200] train_loss: 4.1156, val_loss: 5.1520, lr: 0.003000, 6.93s
2024-04-30 20:17:12 INFO     epoch complete!
2024-04-30 20:17:12 INFO     evaluating now!
2024-04-30 20:17:13 INFO     Epoch [45/200] train_loss: 4.1872, val_loss: 5.0782, lr: 0.003000, 7.00s
2024-04-30 20:17:19 INFO     epoch complete!
2024-04-30 20:17:19 INFO     evaluating now!
2024-04-30 20:17:20 INFO     Epoch [46/200] train_loss: 4.1053, val_loss: 5.2002, lr: 0.003000, 7.00s
2024-04-30 20:17:26 INFO     epoch complete!
2024-04-30 20:17:26 INFO     evaluating now!
2024-04-30 20:17:27 INFO     Epoch [47/200] train_loss: 4.0949, val_loss: 5.0572, lr: 0.003000, 7.12s
2024-04-30 20:17:34 INFO     epoch complete!
2024-04-30 20:17:34 INFO     evaluating now!
2024-04-30 20:17:34 INFO     Epoch [48/200] train_loss: 4.0126, val_loss: 5.1353, lr: 0.003000, 7.13s
2024-04-30 20:17:41 INFO     epoch complete!
2024-04-30 20:17:41 INFO     evaluating now!
2024-04-30 20:17:41 INFO     Epoch [49/200] train_loss: 3.9765, val_loss: 5.0653, lr: 0.003000, 6.97s
2024-04-30 20:17:47 INFO     epoch complete!
2024-04-30 20:17:47 INFO     evaluating now!
2024-04-30 20:17:48 INFO     Epoch [50/200] train_loss: 3.9275, val_loss: 5.1587, lr: 0.003000, 6.95s
2024-04-30 20:17:54 INFO     epoch complete!
2024-04-30 20:17:54 INFO     evaluating now!
2024-04-30 20:17:55 INFO     Epoch [51/200] train_loss: 3.9652, val_loss: 5.1550, lr: 0.003000, 7.00s
2024-04-30 20:18:02 INFO     epoch complete!
2024-04-30 20:18:02 INFO     evaluating now!
2024-04-30 20:18:02 INFO     Epoch [52/200] train_loss: 4.1280, val_loss: 5.1177, lr: 0.003000, 7.23s
2024-04-30 20:18:09 INFO     epoch complete!
2024-04-30 20:18:09 INFO     evaluating now!
2024-04-30 20:18:09 INFO     Epoch [53/200] train_loss: 3.8892, val_loss: 5.0872, lr: 0.003000, 7.30s
2024-04-30 20:18:09 WARNING  Early stopping at epoch: 53
2024-04-30 20:18:09 INFO     Trained totally 54 epochs, average train time is 6.532s, average eval time is 0.469s
2024-04-30 20:18:10 INFO     Loaded model at 38
2024-04-30 20:18:10 INFO     Saved model at ./libcity/cache/29/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 20:18:10 INFO     Start evaluating ...
2024-04-30 20:18:11 INFO     Note that you select the single mode to evaluate!
2024-04-30 20:18:11 INFO     Evaluate result is saved at ./libcity/cache/29/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 20:18:11 INFO     
         MAE       RMSE
1   2.565501   7.789000
2   2.597681   8.020242
3   2.704696   8.928748
4   2.873299   9.845291
5   3.018502  10.744886
6   3.084883  11.536769
7   3.152565  12.204242
8   3.198063  12.648445
9   3.296654  13.079165
10  3.411288  13.284879
11  3.440789  13.804001
12  3.628880  14.580317
2024-04-30 20:18:11 INFO     ----------------------------------------------------------------------------
2024-04-30 20:18:11 INFO     Kownledge Graph Embedding: RotE, Experiment ids: [25, 26, 27, 28, 29]
2024-04-30 20:18:11 INFO     ----------------------------------------------------------------------------
2024-04-30 20:18:11 INFO     Average: 
         MAE       RMSE
0   2.441362   7.049300
1   2.511601   7.629511
2   2.655798   8.597797
3   2.832655   9.479819
4   3.022938  10.389881
5   3.093382  11.280153
6   3.203453  12.045624
7   3.257695  12.661812
8   3.321736  12.985671
9   3.365390  13.147970
10  3.425350  13.473057
11  3.569620  14.030699 
2024-04-30 20:18:11 INFO     Standard deviation: 
         MAE      RMSE
0   0.111544  0.375635
1   0.113468  0.207214
2   0.071197  0.176391
3   0.101334  0.185674
4   0.122206  0.214342
5   0.101599  0.331438
6   0.118567  0.465837
7   0.103561  0.636823
8   0.088280  0.564492
9   0.073317  0.437451
10  0.090915  0.386235
11  0.145580  0.526954
2024-04-30 20:18:11 INFO     ----------------------------------------------------------------------------
2024-04-30 20:18:11 INFO     12 steps Average: 
        MAE       RMSE
0  3.058415  11.064275
2024-04-30 20:18:11 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.103464  0.375707
