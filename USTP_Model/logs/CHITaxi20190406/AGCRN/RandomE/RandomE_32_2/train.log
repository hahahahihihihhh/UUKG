2024-04-30 15:19:58 INFO     ----------------------------------------------------------------------------
2024-04-30 15:19:58 INFO     # 0, Kownledge Graph Embedding: RandomE, Experiment ids: 60
2024-04-30 15:19:58 INFO     ----------------------------------------------------------------------------
2024-04-30 15:19:59 INFO     Log directory: ./libcity/log
2024-04-30 15:19:59 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=60
2024-04-30 15:19:59 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 166543718, 'exp_id': 60, 'load_external': True, 'embedding_model': 'RandomE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 15:19:59 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 15:20:00 INFO     set_weight_link_or_dist: dist
2024-04-30 15:20:00 INFO     init_weight_inf_or_zero: inf
2024-04-30 15:20:00 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 15:20:00 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 15:20:00 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 15:20:00 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 15:20:03 INFO     Dataset created
2024-04-30 15:20:03 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 15:20:03 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 15:20:03 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 15:20:03 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 15:20:04 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 15:20:04 INFO     NoneScaler
2024-04-30 15:20:10 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 15:20:10 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 15:20:10 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 15:20:10 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 15:20:10 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 15:20:10 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 15:20:10 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 15:20:10 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 15:20:10 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 15:20:10 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 15:20:10 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 15:20:10 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 15:20:10 INFO     Total parameter numbers: 874010
2024-04-30 15:20:10 INFO     You select `adam` optimizer.
2024-04-30 15:20:10 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 15:20:10 INFO     Start training ...
2024-04-30 15:20:10 INFO     num_batches:48
2024-04-30 15:20:18 INFO     epoch complete!
2024-04-30 15:20:18 INFO     evaluating now!
2024-04-30 15:20:19 INFO     Epoch [0/200] train_loss: 23.1206, val_loss: 16.8491, lr: 0.003000, 8.12s
2024-04-30 15:20:19 INFO     Saved model at 0
2024-04-30 15:20:19 INFO     Val loss decrease from inf to 16.8491, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 15:20:25 INFO     epoch complete!
2024-04-30 15:20:25 INFO     evaluating now!
2024-04-30 15:20:26 INFO     Epoch [1/200] train_loss: 12.9900, val_loss: 11.6874, lr: 0.003000, 7.09s
2024-04-30 15:20:26 INFO     Saved model at 1
2024-04-30 15:20:26 INFO     Val loss decrease from 16.8491 to 11.6874, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 15:20:32 INFO     epoch complete!
2024-04-30 15:20:32 INFO     evaluating now!
2024-04-30 15:20:33 INFO     Epoch [2/200] train_loss: 9.8461, val_loss: 9.2467, lr: 0.003000, 7.01s
2024-04-30 15:20:33 INFO     Saved model at 2
2024-04-30 15:20:33 INFO     Val loss decrease from 11.6874 to 9.2467, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 15:20:39 INFO     epoch complete!
2024-04-30 15:20:39 INFO     evaluating now!
2024-04-30 15:20:40 INFO     Epoch [3/200] train_loss: 8.2551, val_loss: 7.8900, lr: 0.003000, 7.20s
2024-04-30 15:20:40 INFO     Saved model at 3
2024-04-30 15:20:40 INFO     Val loss decrease from 9.2467 to 7.8900, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 15:20:46 INFO     epoch complete!
2024-04-30 15:20:46 INFO     evaluating now!
2024-04-30 15:20:47 INFO     Epoch [4/200] train_loss: 7.3818, val_loss: 7.2344, lr: 0.003000, 7.07s
2024-04-30 15:20:47 INFO     Saved model at 4
2024-04-30 15:20:47 INFO     Val loss decrease from 7.8900 to 7.2344, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 15:20:54 INFO     epoch complete!
2024-04-30 15:20:54 INFO     evaluating now!
2024-04-30 15:20:54 INFO     Epoch [5/200] train_loss: 6.8153, val_loss: 6.7830, lr: 0.003000, 7.16s
2024-04-30 15:20:54 INFO     Saved model at 5
2024-04-30 15:20:54 INFO     Val loss decrease from 7.2344 to 6.7830, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 15:21:01 INFO     epoch complete!
2024-04-30 15:21:01 INFO     evaluating now!
2024-04-30 15:21:01 INFO     Epoch [6/200] train_loss: 6.3683, val_loss: 6.4904, lr: 0.003000, 7.10s
2024-04-30 15:21:01 INFO     Saved model at 6
2024-04-30 15:21:01 INFO     Val loss decrease from 6.7830 to 6.4904, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 15:21:08 INFO     epoch complete!
2024-04-30 15:21:08 INFO     evaluating now!
2024-04-30 15:21:08 INFO     Epoch [7/200] train_loss: 6.1516, val_loss: 6.1484, lr: 0.003000, 6.99s
2024-04-30 15:21:08 INFO     Saved model at 7
2024-04-30 15:21:08 INFO     Val loss decrease from 6.4904 to 6.1484, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 15:21:15 INFO     epoch complete!
2024-04-30 15:21:15 INFO     evaluating now!
2024-04-30 15:21:15 INFO     Epoch [8/200] train_loss: 5.8607, val_loss: 5.9031, lr: 0.003000, 7.02s
2024-04-30 15:21:16 INFO     Saved model at 8
2024-04-30 15:21:16 INFO     Val loss decrease from 6.1484 to 5.9031, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 15:21:22 INFO     epoch complete!
2024-04-30 15:21:22 INFO     evaluating now!
2024-04-30 15:21:23 INFO     Epoch [9/200] train_loss: 5.6462, val_loss: 5.7878, lr: 0.003000, 7.10s
2024-04-30 15:21:23 INFO     Saved model at 9
2024-04-30 15:21:23 INFO     Val loss decrease from 5.9031 to 5.7878, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 15:21:29 INFO     epoch complete!
2024-04-30 15:21:29 INFO     evaluating now!
2024-04-30 15:21:30 INFO     Epoch [10/200] train_loss: 5.4914, val_loss: 5.6311, lr: 0.003000, 7.04s
2024-04-30 15:21:30 INFO     Saved model at 10
2024-04-30 15:21:30 INFO     Val loss decrease from 5.7878 to 5.6311, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 15:21:36 INFO     epoch complete!
2024-04-30 15:21:36 INFO     evaluating now!
2024-04-30 15:21:37 INFO     Epoch [11/200] train_loss: 5.4154, val_loss: 5.5410, lr: 0.003000, 7.19s
2024-04-30 15:21:37 INFO     Saved model at 11
2024-04-30 15:21:37 INFO     Val loss decrease from 5.6311 to 5.5410, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 15:21:44 INFO     epoch complete!
2024-04-30 15:21:44 INFO     evaluating now!
2024-04-30 15:21:44 INFO     Epoch [12/200] train_loss: 5.2777, val_loss: 5.4287, lr: 0.003000, 7.52s
2024-04-30 15:21:45 INFO     Saved model at 12
2024-04-30 15:21:45 INFO     Val loss decrease from 5.5410 to 5.4287, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 15:21:51 INFO     epoch complete!
2024-04-30 15:21:51 INFO     evaluating now!
2024-04-30 15:21:51 INFO     Epoch [13/200] train_loss: 5.1335, val_loss: 5.4667, lr: 0.003000, 6.81s
2024-04-30 15:21:58 INFO     epoch complete!
2024-04-30 15:21:58 INFO     evaluating now!
2024-04-30 15:21:58 INFO     Epoch [14/200] train_loss: 5.0564, val_loss: 5.4717, lr: 0.003000, 6.82s
2024-04-30 15:22:04 INFO     epoch complete!
2024-04-30 15:22:04 INFO     evaluating now!
2024-04-30 15:22:05 INFO     Epoch [15/200] train_loss: 4.9895, val_loss: 5.4050, lr: 0.003000, 6.81s
2024-04-30 15:22:05 INFO     Saved model at 15
2024-04-30 15:22:05 INFO     Val loss decrease from 5.4287 to 5.4050, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 15:22:12 INFO     epoch complete!
2024-04-30 15:22:12 INFO     evaluating now!
2024-04-30 15:22:12 INFO     Epoch [16/200] train_loss: 4.9068, val_loss: 5.4211, lr: 0.003000, 7.21s
2024-04-30 15:22:19 INFO     epoch complete!
2024-04-30 15:22:19 INFO     evaluating now!
2024-04-30 15:22:20 INFO     Epoch [17/200] train_loss: 4.8321, val_loss: 5.3177, lr: 0.003000, 7.38s
2024-04-30 15:22:20 INFO     Saved model at 17
2024-04-30 15:22:20 INFO     Val loss decrease from 5.4050 to 5.3177, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 15:22:27 INFO     epoch complete!
2024-04-30 15:22:27 INFO     evaluating now!
2024-04-30 15:22:28 INFO     Epoch [18/200] train_loss: 4.7366, val_loss: 5.2444, lr: 0.003000, 8.11s
2024-04-30 15:22:28 INFO     Saved model at 18
2024-04-30 15:22:28 INFO     Val loss decrease from 5.3177 to 5.2444, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 15:22:35 INFO     epoch complete!
2024-04-30 15:22:35 INFO     evaluating now!
2024-04-30 15:22:35 INFO     Epoch [19/200] train_loss: 4.6430, val_loss: 5.2154, lr: 0.003000, 7.43s
2024-04-30 15:22:35 INFO     Saved model at 19
2024-04-30 15:22:35 INFO     Val loss decrease from 5.2444 to 5.2154, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 15:22:42 INFO     epoch complete!
2024-04-30 15:22:42 INFO     evaluating now!
2024-04-30 15:22:43 INFO     Epoch [20/200] train_loss: 4.5701, val_loss: 5.1718, lr: 0.003000, 7.36s
2024-04-30 15:22:43 INFO     Saved model at 20
2024-04-30 15:22:43 INFO     Val loss decrease from 5.2154 to 5.1718, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-30 15:22:50 INFO     epoch complete!
2024-04-30 15:22:50 INFO     evaluating now!
2024-04-30 15:22:50 INFO     Epoch [21/200] train_loss: 4.5476, val_loss: 5.1632, lr: 0.003000, 7.57s
2024-04-30 15:22:50 INFO     Saved model at 21
2024-04-30 15:22:50 INFO     Val loss decrease from 5.1718 to 5.1632, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-30 15:22:57 INFO     epoch complete!
2024-04-30 15:22:57 INFO     evaluating now!
2024-04-30 15:22:58 INFO     Epoch [22/200] train_loss: 4.5495, val_loss: 5.2676, lr: 0.003000, 7.68s
2024-04-30 15:23:05 INFO     epoch complete!
2024-04-30 15:23:05 INFO     evaluating now!
2024-04-30 15:23:06 INFO     Epoch [23/200] train_loss: 4.4834, val_loss: 5.2462, lr: 0.003000, 7.90s
2024-04-30 15:23:13 INFO     epoch complete!
2024-04-30 15:23:13 INFO     evaluating now!
2024-04-30 15:23:14 INFO     Epoch [24/200] train_loss: 4.4268, val_loss: 5.1447, lr: 0.003000, 7.78s
2024-04-30 15:23:14 INFO     Saved model at 24
2024-04-30 15:23:14 INFO     Val loss decrease from 5.1632 to 5.1447, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-04-30 15:23:20 INFO     epoch complete!
2024-04-30 15:23:20 INFO     evaluating now!
2024-04-30 15:23:21 INFO     Epoch [25/200] train_loss: 4.3683, val_loss: 5.0976, lr: 0.003000, 7.20s
2024-04-30 15:23:21 INFO     Saved model at 25
2024-04-30 15:23:21 INFO     Val loss decrease from 5.1447 to 5.0976, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-30 15:23:28 INFO     epoch complete!
2024-04-30 15:23:28 INFO     evaluating now!
2024-04-30 15:23:28 INFO     Epoch [26/200] train_loss: 4.2966, val_loss: 5.1321, lr: 0.003000, 7.52s
2024-04-30 15:23:35 INFO     epoch complete!
2024-04-30 15:23:35 INFO     evaluating now!
2024-04-30 15:23:36 INFO     Epoch [27/200] train_loss: 4.3166, val_loss: 5.2477, lr: 0.003000, 7.38s
2024-04-30 15:23:43 INFO     epoch complete!
2024-04-30 15:23:43 INFO     evaluating now!
2024-04-30 15:23:43 INFO     Epoch [28/200] train_loss: 4.2635, val_loss: 5.3711, lr: 0.003000, 7.33s
2024-04-30 15:23:50 INFO     epoch complete!
2024-04-30 15:23:50 INFO     evaluating now!
2024-04-30 15:23:51 INFO     Epoch [29/200] train_loss: 4.2112, val_loss: 5.1419, lr: 0.003000, 7.82s
2024-04-30 15:23:58 INFO     epoch complete!
2024-04-30 15:23:58 INFO     evaluating now!
2024-04-30 15:23:59 INFO     Epoch [30/200] train_loss: 4.1590, val_loss: 5.1015, lr: 0.003000, 7.67s
2024-04-30 15:24:06 INFO     epoch complete!
2024-04-30 15:24:06 INFO     evaluating now!
2024-04-30 15:24:06 INFO     Epoch [31/200] train_loss: 4.2023, val_loss: 5.0158, lr: 0.003000, 7.71s
2024-04-30 15:24:06 INFO     Saved model at 31
2024-04-30 15:24:06 INFO     Val loss decrease from 5.0976 to 5.0158, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-04-30 15:24:14 INFO     epoch complete!
2024-04-30 15:24:14 INFO     evaluating now!
2024-04-30 15:24:14 INFO     Epoch [32/200] train_loss: 4.1178, val_loss: 5.1737, lr: 0.003000, 7.74s
2024-04-30 15:24:21 INFO     epoch complete!
2024-04-30 15:24:21 INFO     evaluating now!
2024-04-30 15:24:22 INFO     Epoch [33/200] train_loss: 4.0509, val_loss: 5.2071, lr: 0.003000, 7.82s
2024-04-30 15:24:29 INFO     epoch complete!
2024-04-30 15:24:29 INFO     evaluating now!
2024-04-30 15:24:30 INFO     Epoch [34/200] train_loss: 4.0219, val_loss: 5.0839, lr: 0.003000, 7.83s
2024-04-30 15:24:37 INFO     epoch complete!
2024-04-30 15:24:37 INFO     evaluating now!
2024-04-30 15:24:38 INFO     Epoch [35/200] train_loss: 3.9850, val_loss: 5.1014, lr: 0.003000, 7.73s
2024-04-30 15:24:45 INFO     epoch complete!
2024-04-30 15:24:45 INFO     evaluating now!
2024-04-30 15:24:45 INFO     Epoch [36/200] train_loss: 3.9869, val_loss: 5.0938, lr: 0.003000, 7.65s
2024-04-30 15:24:52 INFO     epoch complete!
2024-04-30 15:24:52 INFO     evaluating now!
2024-04-30 15:24:53 INFO     Epoch [37/200] train_loss: 4.0024, val_loss: 5.0910, lr: 0.003000, 7.68s
2024-04-30 15:25:00 INFO     epoch complete!
2024-04-30 15:25:00 INFO     evaluating now!
2024-04-30 15:25:01 INFO     Epoch [38/200] train_loss: 3.9419, val_loss: 4.9782, lr: 0.003000, 7.73s
2024-04-30 15:25:01 INFO     Saved model at 38
2024-04-30 15:25:01 INFO     Val loss decrease from 5.0158 to 4.9782, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-04-30 15:25:08 INFO     epoch complete!
2024-04-30 15:25:08 INFO     evaluating now!
2024-04-30 15:25:08 INFO     Epoch [39/200] train_loss: 3.9349, val_loss: 5.0725, lr: 0.003000, 7.67s
2024-04-30 15:25:15 INFO     epoch complete!
2024-04-30 15:25:15 INFO     evaluating now!
2024-04-30 15:25:16 INFO     Epoch [40/200] train_loss: 3.8817, val_loss: 5.0063, lr: 0.003000, 7.68s
2024-04-30 15:25:23 INFO     epoch complete!
2024-04-30 15:25:23 INFO     evaluating now!
2024-04-30 15:25:24 INFO     Epoch [41/200] train_loss: 3.8482, val_loss: 5.1654, lr: 0.003000, 7.67s
2024-04-30 15:25:31 INFO     epoch complete!
2024-04-30 15:25:31 INFO     evaluating now!
2024-04-30 15:25:31 INFO     Epoch [42/200] train_loss: 3.8337, val_loss: 4.9204, lr: 0.003000, 7.68s
2024-04-30 15:25:31 INFO     Saved model at 42
2024-04-30 15:25:31 INFO     Val loss decrease from 4.9782 to 4.9204, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-04-30 15:25:39 INFO     epoch complete!
2024-04-30 15:25:39 INFO     evaluating now!
2024-04-30 15:25:39 INFO     Epoch [43/200] train_loss: 3.8070, val_loss: 5.0417, lr: 0.003000, 7.69s
2024-04-30 15:25:46 INFO     epoch complete!
2024-04-30 15:25:46 INFO     evaluating now!
2024-04-30 15:25:47 INFO     Epoch [44/200] train_loss: 3.7962, val_loss: 4.9002, lr: 0.003000, 7.80s
2024-04-30 15:25:47 INFO     Saved model at 44
2024-04-30 15:25:47 INFO     Val loss decrease from 4.9204 to 4.9002, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-04-30 15:25:54 INFO     epoch complete!
2024-04-30 15:25:54 INFO     evaluating now!
2024-04-30 15:25:55 INFO     Epoch [45/200] train_loss: 3.7527, val_loss: 5.1385, lr: 0.003000, 7.96s
2024-04-30 15:26:02 INFO     epoch complete!
2024-04-30 15:26:02 INFO     evaluating now!
2024-04-30 15:26:03 INFO     Epoch [46/200] train_loss: 3.7344, val_loss: 5.1039, lr: 0.003000, 7.78s
2024-04-30 15:26:10 INFO     epoch complete!
2024-04-30 15:26:10 INFO     evaluating now!
2024-04-30 15:26:10 INFO     Epoch [47/200] train_loss: 3.7333, val_loss: 5.0420, lr: 0.003000, 7.64s
2024-04-30 15:26:18 INFO     epoch complete!
2024-04-30 15:26:18 INFO     evaluating now!
2024-04-30 15:26:18 INFO     Epoch [48/200] train_loss: 3.6928, val_loss: 5.0406, lr: 0.003000, 7.75s
2024-04-30 15:26:25 INFO     epoch complete!
2024-04-30 15:26:25 INFO     evaluating now!
2024-04-30 15:26:26 INFO     Epoch [49/200] train_loss: 3.7489, val_loss: 5.0044, lr: 0.003000, 7.77s
2024-04-30 15:26:33 INFO     epoch complete!
2024-04-30 15:26:33 INFO     evaluating now!
2024-04-30 15:26:33 INFO     Epoch [50/200] train_loss: 3.6759, val_loss: 4.9428, lr: 0.003000, 7.65s
2024-04-30 15:26:41 INFO     epoch complete!
2024-04-30 15:26:41 INFO     evaluating now!
2024-04-30 15:26:41 INFO     Epoch [51/200] train_loss: 3.6244, val_loss: 5.0634, lr: 0.003000, 7.80s
2024-04-30 15:26:48 INFO     epoch complete!
2024-04-30 15:26:48 INFO     evaluating now!
2024-04-30 15:26:49 INFO     Epoch [52/200] train_loss: 3.6155, val_loss: 5.1304, lr: 0.003000, 7.72s
2024-04-30 15:26:56 INFO     epoch complete!
2024-04-30 15:26:56 INFO     evaluating now!
2024-04-30 15:26:57 INFO     Epoch [53/200] train_loss: 3.6038, val_loss: 5.0354, lr: 0.003000, 7.76s
2024-04-30 15:27:04 INFO     epoch complete!
2024-04-30 15:27:04 INFO     evaluating now!
2024-04-30 15:27:04 INFO     Epoch [54/200] train_loss: 3.6049, val_loss: 5.0196, lr: 0.003000, 7.65s
2024-04-30 15:27:11 INFO     epoch complete!
2024-04-30 15:27:11 INFO     evaluating now!
2024-04-30 15:27:12 INFO     Epoch [55/200] train_loss: 3.5976, val_loss: 5.0551, lr: 0.003000, 7.58s
2024-04-30 15:27:19 INFO     epoch complete!
2024-04-30 15:27:19 INFO     evaluating now!
2024-04-30 15:27:20 INFO     Epoch [56/200] train_loss: 3.5718, val_loss: 5.0723, lr: 0.003000, 7.72s
2024-04-30 15:27:27 INFO     epoch complete!
2024-04-30 15:27:27 INFO     evaluating now!
2024-04-30 15:27:27 INFO     Epoch [57/200] train_loss: 3.5269, val_loss: 4.9821, lr: 0.003000, 7.54s
2024-04-30 15:27:34 INFO     epoch complete!
2024-04-30 15:27:34 INFO     evaluating now!
2024-04-30 15:27:35 INFO     Epoch [58/200] train_loss: 3.5290, val_loss: 4.9839, lr: 0.003000, 7.41s
2024-04-30 15:27:42 INFO     epoch complete!
2024-04-30 15:27:42 INFO     evaluating now!
2024-04-30 15:27:42 INFO     Epoch [59/200] train_loss: 3.5454, val_loss: 5.0497, lr: 0.003000, 7.46s
2024-04-30 15:27:42 WARNING  Early stopping at epoch: 59
2024-04-30 15:27:42 INFO     Trained totally 60 epochs, average train time is 6.962s, average eval time is 0.547s
2024-04-30 15:27:42 INFO     Loaded model at 44
2024-04-30 15:27:42 INFO     Saved model at ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 15:27:42 INFO     Start evaluating ...
2024-04-30 15:27:44 INFO     Note that you select the single mode to evaluate!
2024-04-30 15:27:44 INFO     Evaluate result is saved at ./libcity/cache/60/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 15:27:44 INFO     
         MAE       RMSE
1   2.273754   6.779260
2   2.406174   7.610762
3   2.620397   9.079812
4   2.830827  10.290055
5   2.995617  11.585780
6   3.056162  12.236085
7   3.113877  12.648018
8   3.159247  13.192172
9   3.188609  13.436820
10  3.222877  13.719270
11  3.295116  13.739906
12  3.451370  14.434478
2024-04-30 15:27:44 INFO     ----------------------------------------------------------------------------
2024-04-30 15:27:44 INFO     # 1, Kownledge Graph Embedding: RandomE, Experiment ids: 61
2024-04-30 15:27:44 INFO     ----------------------------------------------------------------------------
2024-04-30 15:27:44 INFO     Log directory: ./libcity/log
2024-04-30 15:27:44 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=61
2024-04-30 15:27:44 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 615731357, 'exp_id': 61, 'load_external': True, 'embedding_model': 'RandomE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 15:27:44 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 15:27:44 INFO     set_weight_link_or_dist: dist
2024-04-30 15:27:44 INFO     init_weight_inf_or_zero: inf
2024-04-30 15:27:44 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 15:27:44 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 15:27:44 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 15:27:44 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 15:27:47 INFO     Dataset created
2024-04-30 15:27:47 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 15:27:47 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 15:27:47 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 15:27:47 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 15:27:48 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 15:27:48 INFO     NoneScaler
2024-04-30 15:27:50 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 15:27:50 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 15:27:50 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 15:27:50 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 15:27:50 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 15:27:50 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 15:27:50 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 15:27:50 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 15:27:50 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 15:27:50 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 15:27:50 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 15:27:50 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 15:27:50 INFO     Total parameter numbers: 874010
2024-04-30 15:27:50 INFO     You select `adam` optimizer.
2024-04-30 15:27:50 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 15:27:50 INFO     Start training ...
2024-04-30 15:27:50 INFO     num_batches:48
2024-04-30 15:27:57 INFO     epoch complete!
2024-04-30 15:27:57 INFO     evaluating now!
2024-04-30 15:27:57 INFO     Epoch [0/200] train_loss: 24.0501, val_loss: 17.1185, lr: 0.003000, 7.51s
2024-04-30 15:27:57 INFO     Saved model at 0
2024-04-30 15:27:57 INFO     Val loss decrease from inf to 17.1185, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 15:28:04 INFO     epoch complete!
2024-04-30 15:28:04 INFO     evaluating now!
2024-04-30 15:28:05 INFO     Epoch [1/200] train_loss: 13.5405, val_loss: 12.3782, lr: 0.003000, 7.53s
2024-04-30 15:28:05 INFO     Saved model at 1
2024-04-30 15:28:05 INFO     Val loss decrease from 17.1185 to 12.3782, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 15:28:12 INFO     epoch complete!
2024-04-30 15:28:12 INFO     evaluating now!
2024-04-30 15:28:12 INFO     Epoch [2/200] train_loss: 10.3908, val_loss: 9.5627, lr: 0.003000, 7.36s
2024-04-30 15:28:12 INFO     Saved model at 2
2024-04-30 15:28:12 INFO     Val loss decrease from 12.3782 to 9.5627, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 15:28:19 INFO     epoch complete!
2024-04-30 15:28:19 INFO     evaluating now!
2024-04-30 15:28:20 INFO     Epoch [3/200] train_loss: 8.6280, val_loss: 8.1281, lr: 0.003000, 7.43s
2024-04-30 15:28:20 INFO     Saved model at 3
2024-04-30 15:28:20 INFO     Val loss decrease from 9.5627 to 8.1281, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 15:28:27 INFO     epoch complete!
2024-04-30 15:28:27 INFO     evaluating now!
2024-04-30 15:28:27 INFO     Epoch [4/200] train_loss: 7.4830, val_loss: 7.3371, lr: 0.003000, 7.39s
2024-04-30 15:28:27 INFO     Saved model at 4
2024-04-30 15:28:27 INFO     Val loss decrease from 8.1281 to 7.3371, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 15:28:34 INFO     epoch complete!
2024-04-30 15:28:34 INFO     evaluating now!
2024-04-30 15:28:34 INFO     Epoch [5/200] train_loss: 6.9077, val_loss: 6.8334, lr: 0.003000, 7.31s
2024-04-30 15:28:34 INFO     Saved model at 5
2024-04-30 15:28:34 INFO     Val loss decrease from 7.3371 to 6.8334, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 15:28:41 INFO     epoch complete!
2024-04-30 15:28:41 INFO     evaluating now!
2024-04-30 15:28:42 INFO     Epoch [6/200] train_loss: 6.4359, val_loss: 6.4774, lr: 0.003000, 7.26s
2024-04-30 15:28:42 INFO     Saved model at 6
2024-04-30 15:28:42 INFO     Val loss decrease from 6.8334 to 6.4774, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 15:28:49 INFO     epoch complete!
2024-04-30 15:28:49 INFO     evaluating now!
2024-04-30 15:28:49 INFO     Epoch [7/200] train_loss: 6.1012, val_loss: 6.2172, lr: 0.003000, 7.45s
2024-04-30 15:28:49 INFO     Saved model at 7
2024-04-30 15:28:49 INFO     Val loss decrease from 6.4774 to 6.2172, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 15:28:56 INFO     epoch complete!
2024-04-30 15:28:56 INFO     evaluating now!
2024-04-30 15:28:57 INFO     Epoch [8/200] train_loss: 5.8836, val_loss: 6.1025, lr: 0.003000, 7.26s
2024-04-30 15:28:57 INFO     Saved model at 8
2024-04-30 15:28:57 INFO     Val loss decrease from 6.2172 to 6.1025, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 15:29:04 INFO     epoch complete!
2024-04-30 15:29:04 INFO     evaluating now!
2024-04-30 15:29:04 INFO     Epoch [9/200] train_loss: 5.6705, val_loss: 5.7946, lr: 0.003000, 7.52s
2024-04-30 15:29:04 INFO     Saved model at 9
2024-04-30 15:29:04 INFO     Val loss decrease from 6.1025 to 5.7946, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 15:29:11 INFO     epoch complete!
2024-04-30 15:29:11 INFO     evaluating now!
2024-04-30 15:29:12 INFO     Epoch [10/200] train_loss: 5.5657, val_loss: 5.8259, lr: 0.003000, 7.51s
2024-04-30 15:29:19 INFO     epoch complete!
2024-04-30 15:29:19 INFO     evaluating now!
2024-04-30 15:29:19 INFO     Epoch [11/200] train_loss: 5.3724, val_loss: 5.7257, lr: 0.003000, 7.44s
2024-04-30 15:29:19 INFO     Saved model at 11
2024-04-30 15:29:19 INFO     Val loss decrease from 5.7946 to 5.7257, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 15:29:26 INFO     epoch complete!
2024-04-30 15:29:26 INFO     evaluating now!
2024-04-30 15:29:27 INFO     Epoch [12/200] train_loss: 5.3426, val_loss: 5.5443, lr: 0.003000, 7.36s
2024-04-30 15:29:27 INFO     Saved model at 12
2024-04-30 15:29:27 INFO     Val loss decrease from 5.7257 to 5.5443, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 15:29:33 INFO     epoch complete!
2024-04-30 15:29:33 INFO     evaluating now!
2024-04-30 15:29:34 INFO     Epoch [13/200] train_loss: 5.1361, val_loss: 5.6390, lr: 0.003000, 7.09s
2024-04-30 15:29:40 INFO     epoch complete!
2024-04-30 15:29:40 INFO     evaluating now!
2024-04-30 15:29:41 INFO     Epoch [14/200] train_loss: 5.0559, val_loss: 5.4872, lr: 0.003000, 6.97s
2024-04-30 15:29:41 INFO     Saved model at 14
2024-04-30 15:29:41 INFO     Val loss decrease from 5.5443 to 5.4872, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 15:29:47 INFO     epoch complete!
2024-04-30 15:29:47 INFO     evaluating now!
2024-04-30 15:29:48 INFO     Epoch [15/200] train_loss: 5.0099, val_loss: 5.3893, lr: 0.003000, 7.04s
2024-04-30 15:29:48 INFO     Saved model at 15
2024-04-30 15:29:48 INFO     Val loss decrease from 5.4872 to 5.3893, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 15:29:54 INFO     epoch complete!
2024-04-30 15:29:54 INFO     evaluating now!
2024-04-30 15:29:55 INFO     Epoch [16/200] train_loss: 4.8753, val_loss: 5.2848, lr: 0.003000, 6.94s
2024-04-30 15:29:55 INFO     Saved model at 16
2024-04-30 15:29:55 INFO     Val loss decrease from 5.3893 to 5.2848, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 15:30:01 INFO     epoch complete!
2024-04-30 15:30:01 INFO     evaluating now!
2024-04-30 15:30:02 INFO     Epoch [17/200] train_loss: 4.7855, val_loss: 5.3830, lr: 0.003000, 7.19s
2024-04-30 15:30:09 INFO     epoch complete!
2024-04-30 15:30:09 INFO     evaluating now!
2024-04-30 15:30:09 INFO     Epoch [18/200] train_loss: 4.7444, val_loss: 5.3440, lr: 0.003000, 7.31s
2024-04-30 15:30:16 INFO     epoch complete!
2024-04-30 15:30:16 INFO     evaluating now!
2024-04-30 15:30:17 INFO     Epoch [19/200] train_loss: 4.7266, val_loss: 5.2988, lr: 0.003000, 7.56s
2024-04-30 15:30:24 INFO     epoch complete!
2024-04-30 15:30:24 INFO     evaluating now!
2024-04-30 15:30:24 INFO     Epoch [20/200] train_loss: 4.6275, val_loss: 5.2695, lr: 0.003000, 7.49s
2024-04-30 15:30:24 INFO     Saved model at 20
2024-04-30 15:30:24 INFO     Val loss decrease from 5.2848 to 5.2695, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-30 15:30:31 INFO     epoch complete!
2024-04-30 15:30:31 INFO     evaluating now!
2024-04-30 15:30:32 INFO     Epoch [21/200] train_loss: 4.5724, val_loss: 5.2111, lr: 0.003000, 7.53s
2024-04-30 15:30:32 INFO     Saved model at 21
2024-04-30 15:30:32 INFO     Val loss decrease from 5.2695 to 5.2111, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-30 15:30:39 INFO     epoch complete!
2024-04-30 15:30:39 INFO     evaluating now!
2024-04-30 15:30:39 INFO     Epoch [22/200] train_loss: 4.5055, val_loss: 5.1798, lr: 0.003000, 7.58s
2024-04-30 15:30:40 INFO     Saved model at 22
2024-04-30 15:30:40 INFO     Val loss decrease from 5.2111 to 5.1798, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-30 15:30:47 INFO     epoch complete!
2024-04-30 15:30:47 INFO     evaluating now!
2024-04-30 15:30:47 INFO     Epoch [23/200] train_loss: 4.4270, val_loss: 5.2924, lr: 0.003000, 7.61s
2024-04-30 15:30:54 INFO     epoch complete!
2024-04-30 15:30:54 INFO     evaluating now!
2024-04-30 15:30:55 INFO     Epoch [24/200] train_loss: 4.4068, val_loss: 5.0846, lr: 0.003000, 7.40s
2024-04-30 15:30:55 INFO     Saved model at 24
2024-04-30 15:30:55 INFO     Val loss decrease from 5.1798 to 5.0846, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-04-30 15:31:01 INFO     epoch complete!
2024-04-30 15:31:01 INFO     evaluating now!
2024-04-30 15:31:02 INFO     Epoch [25/200] train_loss: 4.3480, val_loss: 5.2493, lr: 0.003000, 7.43s
2024-04-30 15:31:09 INFO     epoch complete!
2024-04-30 15:31:09 INFO     evaluating now!
2024-04-30 15:31:09 INFO     Epoch [26/200] train_loss: 4.3478, val_loss: 5.0948, lr: 0.003000, 7.35s
2024-04-30 15:31:16 INFO     epoch complete!
2024-04-30 15:31:16 INFO     evaluating now!
2024-04-30 15:31:17 INFO     Epoch [27/200] train_loss: 4.2939, val_loss: 5.0196, lr: 0.003000, 7.39s
2024-04-30 15:31:17 INFO     Saved model at 27
2024-04-30 15:31:17 INFO     Val loss decrease from 5.0846 to 5.0196, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-30 15:31:24 INFO     epoch complete!
2024-04-30 15:31:24 INFO     evaluating now!
2024-04-30 15:31:24 INFO     Epoch [28/200] train_loss: 4.2499, val_loss: 5.2714, lr: 0.003000, 7.36s
2024-04-30 15:31:31 INFO     epoch complete!
2024-04-30 15:31:31 INFO     evaluating now!
2024-04-30 15:31:32 INFO     Epoch [29/200] train_loss: 4.1970, val_loss: 5.0676, lr: 0.003000, 7.46s
2024-04-30 15:31:39 INFO     epoch complete!
2024-04-30 15:31:39 INFO     evaluating now!
2024-04-30 15:31:39 INFO     Epoch [30/200] train_loss: 4.1761, val_loss: 4.9922, lr: 0.003000, 7.48s
2024-04-30 15:31:39 INFO     Saved model at 30
2024-04-30 15:31:39 INFO     Val loss decrease from 5.0196 to 4.9922, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-04-30 15:31:46 INFO     epoch complete!
2024-04-30 15:31:46 INFO     evaluating now!
2024-04-30 15:31:47 INFO     Epoch [31/200] train_loss: 4.0978, val_loss: 5.1222, lr: 0.003000, 7.27s
2024-04-30 15:31:54 INFO     epoch complete!
2024-04-30 15:31:54 INFO     evaluating now!
2024-04-30 15:31:54 INFO     Epoch [32/200] train_loss: 4.1213, val_loss: 5.0500, lr: 0.003000, 7.40s
2024-04-30 15:32:01 INFO     epoch complete!
2024-04-30 15:32:01 INFO     evaluating now!
2024-04-30 15:32:01 INFO     Epoch [33/200] train_loss: 4.0351, val_loss: 5.0515, lr: 0.003000, 7.34s
2024-04-30 15:32:08 INFO     epoch complete!
2024-04-30 15:32:08 INFO     evaluating now!
2024-04-30 15:32:09 INFO     Epoch [34/200] train_loss: 4.0402, val_loss: 5.0467, lr: 0.003000, 7.51s
2024-04-30 15:32:16 INFO     epoch complete!
2024-04-30 15:32:16 INFO     evaluating now!
2024-04-30 15:32:16 INFO     Epoch [35/200] train_loss: 4.0305, val_loss: 5.1651, lr: 0.003000, 7.41s
2024-04-30 15:32:23 INFO     epoch complete!
2024-04-30 15:32:23 INFO     evaluating now!
2024-04-30 15:32:24 INFO     Epoch [36/200] train_loss: 3.9614, val_loss: 5.0771, lr: 0.003000, 7.37s
2024-04-30 15:32:30 INFO     epoch complete!
2024-04-30 15:32:30 INFO     evaluating now!
2024-04-30 15:32:31 INFO     Epoch [37/200] train_loss: 3.9461, val_loss: 5.0800, lr: 0.003000, 7.32s
2024-04-30 15:32:38 INFO     epoch complete!
2024-04-30 15:32:38 INFO     evaluating now!
2024-04-30 15:32:38 INFO     Epoch [38/200] train_loss: 3.9472, val_loss: 5.1743, lr: 0.003000, 7.27s
2024-04-30 15:32:45 INFO     epoch complete!
2024-04-30 15:32:45 INFO     evaluating now!
2024-04-30 15:32:46 INFO     Epoch [39/200] train_loss: 3.8829, val_loss: 5.0702, lr: 0.003000, 7.32s
2024-04-30 15:32:52 INFO     epoch complete!
2024-04-30 15:32:52 INFO     evaluating now!
2024-04-30 15:32:53 INFO     Epoch [40/200] train_loss: 3.8509, val_loss: 5.0462, lr: 0.003000, 7.24s
2024-04-30 15:32:59 INFO     epoch complete!
2024-04-30 15:32:59 INFO     evaluating now!
2024-04-30 15:33:00 INFO     Epoch [41/200] train_loss: 3.8155, val_loss: 5.1071, lr: 0.003000, 7.11s
2024-04-30 15:33:07 INFO     epoch complete!
2024-04-30 15:33:07 INFO     evaluating now!
2024-04-30 15:33:07 INFO     Epoch [42/200] train_loss: 3.7942, val_loss: 5.0537, lr: 0.003000, 7.31s
2024-04-30 15:33:14 INFO     epoch complete!
2024-04-30 15:33:14 INFO     evaluating now!
2024-04-30 15:33:14 INFO     Epoch [43/200] train_loss: 3.7529, val_loss: 5.1215, lr: 0.003000, 7.18s
2024-04-30 15:33:21 INFO     epoch complete!
2024-04-30 15:33:21 INFO     evaluating now!
2024-04-30 15:33:22 INFO     Epoch [44/200] train_loss: 3.7619, val_loss: 5.0252, lr: 0.003000, 7.23s
2024-04-30 15:33:29 INFO     epoch complete!
2024-04-30 15:33:29 INFO     evaluating now!
2024-04-30 15:33:29 INFO     Epoch [45/200] train_loss: 3.7679, val_loss: 4.9616, lr: 0.003000, 7.38s
2024-04-30 15:33:29 INFO     Saved model at 45
2024-04-30 15:33:29 INFO     Val loss decrease from 4.9922 to 4.9616, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-04-30 15:33:36 INFO     epoch complete!
2024-04-30 15:33:36 INFO     evaluating now!
2024-04-30 15:33:37 INFO     Epoch [46/200] train_loss: 3.6760, val_loss: 5.1232, lr: 0.003000, 7.44s
2024-04-30 15:33:43 INFO     epoch complete!
2024-04-30 15:33:43 INFO     evaluating now!
2024-04-30 15:33:44 INFO     Epoch [47/200] train_loss: 3.7016, val_loss: 4.9758, lr: 0.003000, 7.36s
2024-04-30 15:33:51 INFO     epoch complete!
2024-04-30 15:33:51 INFO     evaluating now!
2024-04-30 15:33:51 INFO     Epoch [48/200] train_loss: 3.6695, val_loss: 5.1255, lr: 0.003000, 7.43s
2024-04-30 15:33:58 INFO     epoch complete!
2024-04-30 15:33:58 INFO     evaluating now!
2024-04-30 15:33:59 INFO     Epoch [49/200] train_loss: 3.6520, val_loss: 5.0254, lr: 0.003000, 7.43s
2024-04-30 15:34:06 INFO     epoch complete!
2024-04-30 15:34:06 INFO     evaluating now!
2024-04-30 15:34:06 INFO     Epoch [50/200] train_loss: 3.6604, val_loss: 5.0538, lr: 0.003000, 7.55s
2024-04-30 15:34:13 INFO     epoch complete!
2024-04-30 15:34:13 INFO     evaluating now!
2024-04-30 15:34:14 INFO     Epoch [51/200] train_loss: 3.6424, val_loss: 5.1378, lr: 0.003000, 7.31s
2024-04-30 15:34:21 INFO     epoch complete!
2024-04-30 15:34:21 INFO     evaluating now!
2024-04-30 15:34:21 INFO     Epoch [52/200] train_loss: 3.6622, val_loss: 5.1365, lr: 0.003000, 7.40s
2024-04-30 15:34:28 INFO     epoch complete!
2024-04-30 15:34:28 INFO     evaluating now!
2024-04-30 15:34:28 INFO     Epoch [53/200] train_loss: 3.6484, val_loss: 4.9186, lr: 0.003000, 7.28s
2024-04-30 15:34:28 INFO     Saved model at 53
2024-04-30 15:34:28 INFO     Val loss decrease from 4.9616 to 4.9186, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch53.tar
2024-04-30 15:34:35 INFO     epoch complete!
2024-04-30 15:34:35 INFO     evaluating now!
2024-04-30 15:34:36 INFO     Epoch [54/200] train_loss: 3.5661, val_loss: 4.9749, lr: 0.003000, 7.26s
2024-04-30 15:34:43 INFO     epoch complete!
2024-04-30 15:34:43 INFO     evaluating now!
2024-04-30 15:34:43 INFO     Epoch [55/200] train_loss: 3.5250, val_loss: 5.0679, lr: 0.003000, 7.61s
2024-04-30 15:34:50 INFO     epoch complete!
2024-04-30 15:34:50 INFO     evaluating now!
2024-04-30 15:34:51 INFO     Epoch [56/200] train_loss: 3.5296, val_loss: 5.0879, lr: 0.003000, 7.40s
2024-04-30 15:34:57 INFO     epoch complete!
2024-04-30 15:34:57 INFO     evaluating now!
2024-04-30 15:34:58 INFO     Epoch [57/200] train_loss: 3.5284, val_loss: 4.9484, lr: 0.003000, 7.38s
2024-04-30 15:35:05 INFO     epoch complete!
2024-04-30 15:35:05 INFO     evaluating now!
2024-04-30 15:35:06 INFO     Epoch [58/200] train_loss: 3.5358, val_loss: 5.1091, lr: 0.003000, 7.72s
2024-04-30 15:35:13 INFO     epoch complete!
2024-04-30 15:35:13 INFO     evaluating now!
2024-04-30 15:35:13 INFO     Epoch [59/200] train_loss: 3.5164, val_loss: 5.0408, lr: 0.003000, 7.56s
2024-04-30 15:35:20 INFO     epoch complete!
2024-04-30 15:35:20 INFO     evaluating now!
2024-04-30 15:35:21 INFO     Epoch [60/200] train_loss: 3.4839, val_loss: 5.0208, lr: 0.003000, 7.48s
2024-04-30 15:35:28 INFO     epoch complete!
2024-04-30 15:35:28 INFO     evaluating now!
2024-04-30 15:35:28 INFO     Epoch [61/200] train_loss: 3.4732, val_loss: 5.0902, lr: 0.003000, 7.59s
2024-04-30 15:35:35 INFO     epoch complete!
2024-04-30 15:35:35 INFO     evaluating now!
2024-04-30 15:35:36 INFO     Epoch [62/200] train_loss: 3.4558, val_loss: 5.0872, lr: 0.003000, 7.46s
2024-04-30 15:35:43 INFO     epoch complete!
2024-04-30 15:35:43 INFO     evaluating now!
2024-04-30 15:35:43 INFO     Epoch [63/200] train_loss: 3.4636, val_loss: 5.1247, lr: 0.003000, 7.39s
2024-04-30 15:35:50 INFO     epoch complete!
2024-04-30 15:35:50 INFO     evaluating now!
2024-04-30 15:35:50 INFO     Epoch [64/200] train_loss: 3.4393, val_loss: 5.0816, lr: 0.003000, 6.86s
2024-04-30 15:35:56 INFO     epoch complete!
2024-04-30 15:35:56 INFO     evaluating now!
2024-04-30 15:35:57 INFO     Epoch [65/200] train_loss: 3.4334, val_loss: 5.1179, lr: 0.003000, 6.89s
2024-04-30 15:36:03 INFO     epoch complete!
2024-04-30 15:36:03 INFO     evaluating now!
2024-04-30 15:36:04 INFO     Epoch [66/200] train_loss: 3.4124, val_loss: 5.0491, lr: 0.003000, 6.90s
2024-04-30 15:36:10 INFO     epoch complete!
2024-04-30 15:36:10 INFO     evaluating now!
2024-04-30 15:36:11 INFO     Epoch [67/200] train_loss: 3.3767, val_loss: 5.0839, lr: 0.003000, 7.12s
2024-04-30 15:36:18 INFO     epoch complete!
2024-04-30 15:36:18 INFO     evaluating now!
2024-04-30 15:36:18 INFO     Epoch [68/200] train_loss: 3.3559, val_loss: 5.0123, lr: 0.003000, 7.21s
2024-04-30 15:36:18 WARNING  Early stopping at epoch: 68
2024-04-30 15:36:18 INFO     Trained totally 69 epochs, average train time is 6.847s, average eval time is 0.502s
2024-04-30 15:36:18 INFO     Loaded model at 53
2024-04-30 15:36:18 INFO     Saved model at ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 15:36:18 INFO     Start evaluating ...
2024-04-30 15:36:20 INFO     Note that you select the single mode to evaluate!
2024-04-30 15:36:20 INFO     Evaluate result is saved at ./libcity/cache/61/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 15:36:20 INFO     
         MAE       RMSE
1   2.395737   7.219688
2   2.502329   7.666847
3   2.669034   8.537915
4   2.791746   9.278098
5   2.909903  10.053175
6   3.022043  10.866662
7   3.118486  11.550813
8   3.174441  12.090245
9   3.267786  12.456295
10  3.325415  12.646735
11  3.357963  12.777651
12  3.426249  12.988505
2024-04-30 15:36:20 INFO     ----------------------------------------------------------------------------
2024-04-30 15:36:20 INFO     # 2, Kownledge Graph Embedding: RandomE, Experiment ids: 62
2024-04-30 15:36:20 INFO     ----------------------------------------------------------------------------
2024-04-30 15:36:20 INFO     Log directory: ./libcity/log
2024-04-30 15:36:20 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=62
2024-04-30 15:36:20 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 1047583253, 'exp_id': 62, 'load_external': True, 'embedding_model': 'RandomE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 15:36:20 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 15:36:20 INFO     set_weight_link_or_dist: dist
2024-04-30 15:36:20 INFO     init_weight_inf_or_zero: inf
2024-04-30 15:36:20 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 15:36:20 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 15:36:20 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 15:36:20 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 15:36:23 INFO     Dataset created
2024-04-30 15:36:23 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 15:36:23 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 15:36:23 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 15:36:23 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 15:36:24 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 15:36:24 INFO     NoneScaler
2024-04-30 15:36:26 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 15:36:26 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 15:36:26 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 15:36:26 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 15:36:26 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 15:36:26 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 15:36:26 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 15:36:26 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 15:36:26 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 15:36:26 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 15:36:26 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 15:36:26 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 15:36:26 INFO     Total parameter numbers: 874010
2024-04-30 15:36:26 INFO     You select `adam` optimizer.
2024-04-30 15:36:26 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 15:36:26 INFO     Start training ...
2024-04-30 15:36:26 INFO     num_batches:48
2024-04-30 15:36:33 INFO     epoch complete!
2024-04-30 15:36:33 INFO     evaluating now!
2024-04-30 15:36:33 INFO     Epoch [0/200] train_loss: 25.1258, val_loss: 17.1675, lr: 0.003000, 7.62s
2024-04-30 15:36:34 INFO     Saved model at 0
2024-04-30 15:36:34 INFO     Val loss decrease from inf to 17.1675, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 15:36:41 INFO     epoch complete!
2024-04-30 15:36:41 INFO     evaluating now!
2024-04-30 15:36:41 INFO     Epoch [1/200] train_loss: 14.0209, val_loss: 13.3377, lr: 0.003000, 7.54s
2024-04-30 15:36:41 INFO     Saved model at 1
2024-04-30 15:36:41 INFO     Val loss decrease from 17.1675 to 13.3377, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 15:36:48 INFO     epoch complete!
2024-04-30 15:36:48 INFO     evaluating now!
2024-04-30 15:36:49 INFO     Epoch [2/200] train_loss: 11.0494, val_loss: 10.5010, lr: 0.003000, 7.46s
2024-04-30 15:36:49 INFO     Saved model at 2
2024-04-30 15:36:49 INFO     Val loss decrease from 13.3377 to 10.5010, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 15:36:56 INFO     epoch complete!
2024-04-30 15:36:56 INFO     evaluating now!
2024-04-30 15:36:56 INFO     Epoch [3/200] train_loss: 9.0948, val_loss: 8.5806, lr: 0.003000, 7.69s
2024-04-30 15:36:56 INFO     Saved model at 3
2024-04-30 15:36:56 INFO     Val loss decrease from 10.5010 to 8.5806, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 15:37:03 INFO     epoch complete!
2024-04-30 15:37:03 INFO     evaluating now!
2024-04-30 15:37:04 INFO     Epoch [4/200] train_loss: 7.8490, val_loss: 7.7617, lr: 0.003000, 7.58s
2024-04-30 15:37:04 INFO     Saved model at 4
2024-04-30 15:37:04 INFO     Val loss decrease from 8.5806 to 7.7617, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 15:37:11 INFO     epoch complete!
2024-04-30 15:37:11 INFO     evaluating now!
2024-04-30 15:37:12 INFO     Epoch [5/200] train_loss: 7.1704, val_loss: 7.1368, lr: 0.003000, 7.45s
2024-04-30 15:37:12 INFO     Saved model at 5
2024-04-30 15:37:12 INFO     Val loss decrease from 7.7617 to 7.1368, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 15:37:18 INFO     epoch complete!
2024-04-30 15:37:18 INFO     evaluating now!
2024-04-30 15:37:19 INFO     Epoch [6/200] train_loss: 6.6071, val_loss: 6.5180, lr: 0.003000, 7.11s
2024-04-30 15:37:19 INFO     Saved model at 6
2024-04-30 15:37:19 INFO     Val loss decrease from 7.1368 to 6.5180, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 15:37:26 INFO     epoch complete!
2024-04-30 15:37:26 INFO     evaluating now!
2024-04-30 15:37:26 INFO     Epoch [7/200] train_loss: 6.2023, val_loss: 6.1648, lr: 0.003000, 7.42s
2024-04-30 15:37:26 INFO     Saved model at 7
2024-04-30 15:37:26 INFO     Val loss decrease from 6.5180 to 6.1648, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 15:37:33 INFO     epoch complete!
2024-04-30 15:37:33 INFO     evaluating now!
2024-04-30 15:37:33 INFO     Epoch [8/200] train_loss: 5.8959, val_loss: 6.0438, lr: 0.003000, 7.27s
2024-04-30 15:37:36 INFO     Saved model at 8
2024-04-30 15:37:36 INFO     Val loss decrease from 6.1648 to 6.0438, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 15:37:43 INFO     epoch complete!
2024-04-30 15:37:43 INFO     evaluating now!
2024-04-30 15:37:43 INFO     Epoch [9/200] train_loss: 5.6934, val_loss: 5.9581, lr: 0.003000, 7.44s
2024-04-30 15:37:43 INFO     Saved model at 9
2024-04-30 15:37:43 INFO     Val loss decrease from 6.0438 to 5.9581, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 15:37:50 INFO     epoch complete!
2024-04-30 15:37:50 INFO     evaluating now!
2024-04-30 15:37:50 INFO     Epoch [10/200] train_loss: 5.4980, val_loss: 5.8255, lr: 0.003000, 6.81s
2024-04-30 15:37:51 INFO     Saved model at 10
2024-04-30 15:37:51 INFO     Val loss decrease from 5.9581 to 5.8255, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 15:37:59 INFO     epoch complete!
2024-04-30 15:37:59 INFO     evaluating now!
2024-04-30 15:37:59 INFO     Epoch [11/200] train_loss: 5.5075, val_loss: 5.7114, lr: 0.003000, 7.64s
2024-04-30 15:37:59 INFO     Saved model at 11
2024-04-30 15:37:59 INFO     Val loss decrease from 5.8255 to 5.7114, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 15:38:06 INFO     epoch complete!
2024-04-30 15:38:06 INFO     evaluating now!
2024-04-30 15:38:07 INFO     Epoch [12/200] train_loss: 5.3127, val_loss: 5.6376, lr: 0.003000, 7.50s
2024-04-30 15:38:07 INFO     Saved model at 12
2024-04-30 15:38:07 INFO     Val loss decrease from 5.7114 to 5.6376, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 15:38:14 INFO     epoch complete!
2024-04-30 15:38:14 INFO     evaluating now!
2024-04-30 15:38:14 INFO     Epoch [13/200] train_loss: 5.1766, val_loss: 5.5951, lr: 0.003000, 7.33s
2024-04-30 15:38:14 INFO     Saved model at 13
2024-04-30 15:38:14 INFO     Val loss decrease from 5.6376 to 5.5951, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 15:38:21 INFO     epoch complete!
2024-04-30 15:38:21 INFO     evaluating now!
2024-04-30 15:38:21 INFO     Epoch [14/200] train_loss: 5.0629, val_loss: 5.4491, lr: 0.003000, 7.26s
2024-04-30 15:38:21 INFO     Saved model at 14
2024-04-30 15:38:21 INFO     Val loss decrease from 5.5951 to 5.4491, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 15:38:28 INFO     epoch complete!
2024-04-30 15:38:28 INFO     evaluating now!
2024-04-30 15:38:29 INFO     Epoch [15/200] train_loss: 5.0468, val_loss: 5.5046, lr: 0.003000, 7.33s
2024-04-30 15:38:35 INFO     epoch complete!
2024-04-30 15:38:35 INFO     evaluating now!
2024-04-30 15:38:36 INFO     Epoch [16/200] train_loss: 4.9914, val_loss: 5.4962, lr: 0.003000, 7.19s
2024-04-30 15:38:43 INFO     epoch complete!
2024-04-30 15:38:43 INFO     evaluating now!
2024-04-30 15:38:43 INFO     Epoch [17/200] train_loss: 4.8376, val_loss: 5.4318, lr: 0.003000, 7.22s
2024-04-30 15:38:43 INFO     Saved model at 17
2024-04-30 15:38:43 INFO     Val loss decrease from 5.4491 to 5.4318, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 15:38:50 INFO     epoch complete!
2024-04-30 15:38:50 INFO     evaluating now!
2024-04-30 15:38:51 INFO     Epoch [18/200] train_loss: 4.7571, val_loss: 5.4801, lr: 0.003000, 7.47s
2024-04-30 15:38:58 INFO     epoch complete!
2024-04-30 15:38:58 INFO     evaluating now!
2024-04-30 15:38:58 INFO     Epoch [19/200] train_loss: 4.7238, val_loss: 5.1986, lr: 0.003000, 7.61s
2024-04-30 15:38:58 INFO     Saved model at 19
2024-04-30 15:38:58 INFO     Val loss decrease from 5.4318 to 5.1986, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 15:39:05 INFO     epoch complete!
2024-04-30 15:39:05 INFO     evaluating now!
2024-04-30 15:39:06 INFO     Epoch [20/200] train_loss: 4.6566, val_loss: 5.3162, lr: 0.003000, 7.65s
2024-04-30 15:39:13 INFO     epoch complete!
2024-04-30 15:39:13 INFO     evaluating now!
2024-04-30 15:39:14 INFO     Epoch [21/200] train_loss: 4.5851, val_loss: 5.2315, lr: 0.003000, 7.73s
2024-04-30 15:39:21 INFO     epoch complete!
2024-04-30 15:39:21 INFO     evaluating now!
2024-04-30 15:39:21 INFO     Epoch [22/200] train_loss: 4.5354, val_loss: 5.1722, lr: 0.003000, 7.45s
2024-04-30 15:39:21 INFO     Saved model at 22
2024-04-30 15:39:21 INFO     Val loss decrease from 5.1986 to 5.1722, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-30 15:39:28 INFO     epoch complete!
2024-04-30 15:39:28 INFO     evaluating now!
2024-04-30 15:39:29 INFO     Epoch [23/200] train_loss: 4.5077, val_loss: 5.3136, lr: 0.003000, 7.40s
2024-04-30 15:39:35 INFO     epoch complete!
2024-04-30 15:39:35 INFO     evaluating now!
2024-04-30 15:39:36 INFO     Epoch [24/200] train_loss: 4.4860, val_loss: 5.1984, lr: 0.003000, 7.31s
2024-04-30 15:39:43 INFO     epoch complete!
2024-04-30 15:39:43 INFO     evaluating now!
2024-04-30 15:39:43 INFO     Epoch [25/200] train_loss: 4.4006, val_loss: 5.1477, lr: 0.003000, 7.41s
2024-04-30 15:39:43 INFO     Saved model at 25
2024-04-30 15:39:43 INFO     Val loss decrease from 5.1722 to 5.1477, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-30 15:39:50 INFO     epoch complete!
2024-04-30 15:39:50 INFO     evaluating now!
2024-04-30 15:39:51 INFO     Epoch [26/200] train_loss: 4.3733, val_loss: 5.1126, lr: 0.003000, 7.39s
2024-04-30 15:39:51 INFO     Saved model at 26
2024-04-30 15:39:51 INFO     Val loss decrease from 5.1477 to 5.1126, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-04-30 15:39:58 INFO     epoch complete!
2024-04-30 15:39:58 INFO     evaluating now!
2024-04-30 15:39:58 INFO     Epoch [27/200] train_loss: 4.3434, val_loss: 5.1712, lr: 0.003000, 7.61s
2024-04-30 15:40:05 INFO     epoch complete!
2024-04-30 15:40:05 INFO     evaluating now!
2024-04-30 15:40:06 INFO     Epoch [28/200] train_loss: 4.2509, val_loss: 5.1584, lr: 0.003000, 7.60s
2024-04-30 15:40:13 INFO     epoch complete!
2024-04-30 15:40:13 INFO     evaluating now!
2024-04-30 15:40:14 INFO     Epoch [29/200] train_loss: 4.2131, val_loss: 5.2031, lr: 0.003000, 7.68s
2024-04-30 15:40:21 INFO     epoch complete!
2024-04-30 15:40:21 INFO     evaluating now!
2024-04-30 15:40:21 INFO     Epoch [30/200] train_loss: 4.1751, val_loss: 5.1208, lr: 0.003000, 7.69s
2024-04-30 15:40:29 INFO     epoch complete!
2024-04-30 15:40:29 INFO     evaluating now!
2024-04-30 15:40:29 INFO     Epoch [31/200] train_loss: 4.1718, val_loss: 5.0284, lr: 0.003000, 8.05s
2024-04-30 15:40:29 INFO     Saved model at 31
2024-04-30 15:40:29 INFO     Val loss decrease from 5.1126 to 5.0284, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-04-30 15:40:37 INFO     epoch complete!
2024-04-30 15:40:37 INFO     evaluating now!
2024-04-30 15:40:37 INFO     Epoch [32/200] train_loss: 4.1140, val_loss: 5.1504, lr: 0.003000, 7.62s
2024-04-30 15:40:44 INFO     epoch complete!
2024-04-30 15:40:44 INFO     evaluating now!
2024-04-30 15:40:44 INFO     Epoch [33/200] train_loss: 4.1109, val_loss: 5.0761, lr: 0.003000, 7.34s
2024-04-30 15:40:51 INFO     epoch complete!
2024-04-30 15:40:51 INFO     evaluating now!
2024-04-30 15:40:52 INFO     Epoch [34/200] train_loss: 4.0281, val_loss: 5.0171, lr: 0.003000, 7.41s
2024-04-30 15:40:52 INFO     Saved model at 34
2024-04-30 15:40:52 INFO     Val loss decrease from 5.0284 to 5.0171, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-04-30 15:40:59 INFO     epoch complete!
2024-04-30 15:40:59 INFO     evaluating now!
2024-04-30 15:40:59 INFO     Epoch [35/200] train_loss: 4.0656, val_loss: 5.1865, lr: 0.003000, 7.47s
2024-04-30 15:41:06 INFO     epoch complete!
2024-04-30 15:41:06 INFO     evaluating now!
2024-04-30 15:41:07 INFO     Epoch [36/200] train_loss: 4.0317, val_loss: 5.0588, lr: 0.003000, 7.55s
2024-04-30 15:41:14 INFO     epoch complete!
2024-04-30 15:41:14 INFO     evaluating now!
2024-04-30 15:41:14 INFO     Epoch [37/200] train_loss: 3.9602, val_loss: 5.0523, lr: 0.003000, 7.39s
2024-04-30 15:41:21 INFO     epoch complete!
2024-04-30 15:41:21 INFO     evaluating now!
2024-04-30 15:41:22 INFO     Epoch [38/200] train_loss: 3.9011, val_loss: 5.0734, lr: 0.003000, 7.54s
2024-04-30 15:41:29 INFO     epoch complete!
2024-04-30 15:41:29 INFO     evaluating now!
2024-04-30 15:41:29 INFO     Epoch [39/200] train_loss: 3.8911, val_loss: 5.0620, lr: 0.003000, 7.41s
2024-04-30 15:41:36 INFO     epoch complete!
2024-04-30 15:41:36 INFO     evaluating now!
2024-04-30 15:41:37 INFO     Epoch [40/200] train_loss: 3.9628, val_loss: 5.0812, lr: 0.003000, 7.37s
2024-04-30 15:41:44 INFO     epoch complete!
2024-04-30 15:41:44 INFO     evaluating now!
2024-04-30 15:41:44 INFO     Epoch [41/200] train_loss: 3.8687, val_loss: 5.0099, lr: 0.003000, 7.41s
2024-04-30 15:41:44 INFO     Saved model at 41
2024-04-30 15:41:44 INFO     Val loss decrease from 5.0171 to 5.0099, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-04-30 15:41:51 INFO     epoch complete!
2024-04-30 15:41:51 INFO     evaluating now!
2024-04-30 15:41:51 INFO     Epoch [42/200] train_loss: 3.8758, val_loss: 5.1434, lr: 0.003000, 7.41s
2024-04-30 15:41:58 INFO     epoch complete!
2024-04-30 15:41:58 INFO     evaluating now!
2024-04-30 15:41:59 INFO     Epoch [43/200] train_loss: 3.8404, val_loss: 5.2394, lr: 0.003000, 7.41s
2024-04-30 15:42:06 INFO     epoch complete!
2024-04-30 15:42:06 INFO     evaluating now!
2024-04-30 15:42:06 INFO     Epoch [44/200] train_loss: 3.8488, val_loss: 5.1440, lr: 0.003000, 7.54s
2024-04-30 15:42:13 INFO     epoch complete!
2024-04-30 15:42:13 INFO     evaluating now!
2024-04-30 15:42:14 INFO     Epoch [45/200] train_loss: 3.7775, val_loss: 5.1284, lr: 0.003000, 7.26s
2024-04-30 15:42:20 INFO     epoch complete!
2024-04-30 15:42:20 INFO     evaluating now!
2024-04-30 15:42:21 INFO     Epoch [46/200] train_loss: 3.8186, val_loss: 5.0385, lr: 0.003000, 6.95s
2024-04-30 15:42:27 INFO     epoch complete!
2024-04-30 15:42:27 INFO     evaluating now!
2024-04-30 15:42:28 INFO     Epoch [47/200] train_loss: 3.7562, val_loss: 5.0778, lr: 0.003000, 7.01s
2024-04-30 15:42:34 INFO     epoch complete!
2024-04-30 15:42:34 INFO     evaluating now!
2024-04-30 15:42:35 INFO     Epoch [48/200] train_loss: 3.7092, val_loss: 5.1782, lr: 0.003000, 7.05s
2024-04-30 15:42:41 INFO     epoch complete!
2024-04-30 15:42:41 INFO     evaluating now!
2024-04-30 15:42:42 INFO     Epoch [49/200] train_loss: 3.7690, val_loss: 5.0259, lr: 0.003000, 7.03s
2024-04-30 15:42:48 INFO     epoch complete!
2024-04-30 15:42:48 INFO     evaluating now!
2024-04-30 15:42:49 INFO     Epoch [50/200] train_loss: 3.7336, val_loss: 5.0107, lr: 0.003000, 7.07s
2024-04-30 15:42:56 INFO     epoch complete!
2024-04-30 15:42:56 INFO     evaluating now!
2024-04-30 15:42:56 INFO     Epoch [51/200] train_loss: 3.6459, val_loss: 4.9403, lr: 0.003000, 7.65s
2024-04-30 15:42:57 INFO     Saved model at 51
2024-04-30 15:42:57 INFO     Val loss decrease from 5.0099 to 4.9403, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-04-30 15:43:04 INFO     epoch complete!
2024-04-30 15:43:04 INFO     evaluating now!
2024-04-30 15:43:04 INFO     Epoch [52/200] train_loss: 3.6402, val_loss: 5.1224, lr: 0.003000, 7.56s
2024-04-30 15:43:11 INFO     epoch complete!
2024-04-30 15:43:11 INFO     evaluating now!
2024-04-30 15:43:12 INFO     Epoch [53/200] train_loss: 3.6446, val_loss: 5.1596, lr: 0.003000, 7.43s
2024-04-30 15:43:19 INFO     epoch complete!
2024-04-30 15:43:19 INFO     evaluating now!
2024-04-30 15:43:19 INFO     Epoch [54/200] train_loss: 3.6261, val_loss: 4.9997, lr: 0.003000, 7.56s
2024-04-30 15:43:26 INFO     epoch complete!
2024-04-30 15:43:26 INFO     evaluating now!
2024-04-30 15:43:27 INFO     Epoch [55/200] train_loss: 3.5824, val_loss: 5.1034, lr: 0.003000, 7.50s
2024-04-30 15:43:34 INFO     epoch complete!
2024-04-30 15:43:34 INFO     evaluating now!
2024-04-30 15:43:34 INFO     Epoch [56/200] train_loss: 3.6029, val_loss: 4.9252, lr: 0.003000, 7.53s
2024-04-30 15:43:34 INFO     Saved model at 56
2024-04-30 15:43:34 INFO     Val loss decrease from 4.9403 to 4.9252, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch56.tar
2024-04-30 15:43:41 INFO     epoch complete!
2024-04-30 15:43:41 INFO     evaluating now!
2024-04-30 15:43:42 INFO     Epoch [57/200] train_loss: 3.5941, val_loss: 4.9638, lr: 0.003000, 7.52s
2024-04-30 15:43:49 INFO     epoch complete!
2024-04-30 15:43:49 INFO     evaluating now!
2024-04-30 15:43:49 INFO     Epoch [58/200] train_loss: 3.5732, val_loss: 4.9503, lr: 0.003000, 7.46s
2024-04-30 15:43:56 INFO     epoch complete!
2024-04-30 15:43:56 INFO     evaluating now!
2024-04-30 15:43:57 INFO     Epoch [59/200] train_loss: 3.5312, val_loss: 5.1729, lr: 0.003000, 7.51s
2024-04-30 15:44:04 INFO     epoch complete!
2024-04-30 15:44:04 INFO     evaluating now!
2024-04-30 15:44:04 INFO     Epoch [60/200] train_loss: 3.5037, val_loss: 5.2635, lr: 0.003000, 7.46s
2024-04-30 15:44:11 INFO     epoch complete!
2024-04-30 15:44:11 INFO     evaluating now!
2024-04-30 15:44:11 INFO     Epoch [61/200] train_loss: 3.5107, val_loss: 5.0324, lr: 0.003000, 7.17s
2024-04-30 15:44:18 INFO     epoch complete!
2024-04-30 15:44:18 INFO     evaluating now!
2024-04-30 15:44:18 INFO     Epoch [62/200] train_loss: 3.5056, val_loss: 5.0793, lr: 0.003000, 7.06s
2024-04-30 15:44:25 INFO     epoch complete!
2024-04-30 15:44:25 INFO     evaluating now!
2024-04-30 15:44:25 INFO     Epoch [63/200] train_loss: 3.4772, val_loss: 5.0514, lr: 0.003000, 7.10s
2024-04-30 15:44:32 INFO     epoch complete!
2024-04-30 15:44:32 INFO     evaluating now!
2024-04-30 15:44:32 INFO     Epoch [64/200] train_loss: 3.4391, val_loss: 5.0106, lr: 0.003000, 7.06s
2024-04-30 15:44:39 INFO     epoch complete!
2024-04-30 15:44:39 INFO     evaluating now!
2024-04-30 15:44:39 INFO     Epoch [65/200] train_loss: 3.4589, val_loss: 5.0588, lr: 0.003000, 6.50s
2024-04-30 15:44:45 INFO     epoch complete!
2024-04-30 15:44:45 INFO     evaluating now!
2024-04-30 15:44:45 INFO     Epoch [66/200] train_loss: 3.4581, val_loss: 5.0215, lr: 0.003000, 6.42s
2024-04-30 15:44:51 INFO     epoch complete!
2024-04-30 15:44:51 INFO     evaluating now!
2024-04-30 15:44:52 INFO     Epoch [67/200] train_loss: 3.4398, val_loss: 5.0236, lr: 0.003000, 6.39s
2024-04-30 15:44:58 INFO     epoch complete!
2024-04-30 15:44:58 INFO     evaluating now!
2024-04-30 15:44:58 INFO     Epoch [68/200] train_loss: 3.4638, val_loss: 5.0297, lr: 0.003000, 6.48s
2024-04-30 15:45:04 INFO     epoch complete!
2024-04-30 15:45:04 INFO     evaluating now!
2024-04-30 15:45:05 INFO     Epoch [69/200] train_loss: 3.3861, val_loss: 4.9256, lr: 0.003000, 6.46s
2024-04-30 15:45:11 INFO     epoch complete!
2024-04-30 15:45:11 INFO     evaluating now!
2024-04-30 15:45:11 INFO     Epoch [70/200] train_loss: 3.3582, val_loss: 5.0777, lr: 0.003000, 6.39s
2024-04-30 15:45:17 INFO     epoch complete!
2024-04-30 15:45:17 INFO     evaluating now!
2024-04-30 15:45:18 INFO     Epoch [71/200] train_loss: 3.3992, val_loss: 5.1378, lr: 0.003000, 6.52s
2024-04-30 15:45:18 WARNING  Early stopping at epoch: 71
2024-04-30 15:45:18 INFO     Trained totally 72 epochs, average train time is 6.819s, average eval time is 0.496s
2024-04-30 15:45:18 INFO     Loaded model at 56
2024-04-30 15:45:18 INFO     Saved model at ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 15:45:18 INFO     Start evaluating ...
2024-04-30 15:45:19 INFO     Note that you select the single mode to evaluate!
2024-04-30 15:45:19 INFO     Evaluate result is saved at ./libcity/cache/62/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 15:45:19 INFO     
         MAE       RMSE
1   2.381715   7.305035
2   2.413948   7.890522
3   2.525382   8.804238
4   2.688243   9.516974
5   2.780414  10.176503
6   2.891253  10.945489
7   3.083923  11.641357
8   3.169103  12.261929
9   3.245224  12.758983
10  3.235409  13.041772
11  3.281435  13.268846
12  3.385231  13.626692
2024-04-30 15:45:19 INFO     ----------------------------------------------------------------------------
2024-04-30 15:45:19 INFO     # 3, Kownledge Graph Embedding: RandomE, Experiment ids: 63
2024-04-30 15:45:19 INFO     ----------------------------------------------------------------------------
2024-04-30 15:45:19 INFO     Log directory: ./libcity/log
2024-04-30 15:45:19 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=63
2024-04-30 15:45:19 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 341207813, 'exp_id': 63, 'load_external': True, 'embedding_model': 'RandomE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 15:45:19 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 15:45:19 INFO     set_weight_link_or_dist: dist
2024-04-30 15:45:19 INFO     init_weight_inf_or_zero: inf
2024-04-30 15:45:20 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 15:45:20 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 15:45:20 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 15:45:20 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 15:45:24 INFO     Dataset created
2024-04-30 15:45:24 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 15:45:24 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 15:45:24 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 15:45:24 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 15:45:24 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 15:45:24 INFO     NoneScaler
2024-04-30 15:45:27 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 15:45:27 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 15:45:27 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 15:45:27 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 15:45:27 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 15:45:27 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 15:45:27 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 15:45:27 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 15:45:27 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 15:45:27 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 15:45:27 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 15:45:27 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 15:45:27 INFO     Total parameter numbers: 874010
2024-04-30 15:45:27 INFO     You select `adam` optimizer.
2024-04-30 15:45:27 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 15:45:27 INFO     Start training ...
2024-04-30 15:45:27 INFO     num_batches:48
2024-04-30 15:45:34 INFO     epoch complete!
2024-04-30 15:45:34 INFO     evaluating now!
2024-04-30 15:45:34 INFO     Epoch [0/200] train_loss: 24.8600, val_loss: 17.0215, lr: 0.003000, 6.52s
2024-04-30 15:45:34 INFO     Saved model at 0
2024-04-30 15:45:34 INFO     Val loss decrease from inf to 17.0215, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 15:45:40 INFO     epoch complete!
2024-04-30 15:45:40 INFO     evaluating now!
2024-04-30 15:45:41 INFO     Epoch [1/200] train_loss: 13.2809, val_loss: 12.2270, lr: 0.003000, 6.54s
2024-04-30 15:45:41 INFO     Saved model at 1
2024-04-30 15:45:41 INFO     Val loss decrease from 17.0215 to 12.2270, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 15:45:47 INFO     epoch complete!
2024-04-30 15:45:47 INFO     evaluating now!
2024-04-30 15:45:47 INFO     Epoch [2/200] train_loss: 10.1235, val_loss: 9.0982, lr: 0.003000, 6.37s
2024-04-30 15:45:47 INFO     Saved model at 2
2024-04-30 15:45:47 INFO     Val loss decrease from 12.2270 to 9.0982, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 15:45:53 INFO     epoch complete!
2024-04-30 15:45:53 INFO     evaluating now!
2024-04-30 15:45:53 INFO     Epoch [3/200] train_loss: 8.2350, val_loss: 7.9169, lr: 0.003000, 6.43s
2024-04-30 15:45:53 INFO     Saved model at 3
2024-04-30 15:45:53 INFO     Val loss decrease from 9.0982 to 7.9169, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 15:46:00 INFO     epoch complete!
2024-04-30 15:46:00 INFO     evaluating now!
2024-04-30 15:46:00 INFO     Epoch [4/200] train_loss: 7.3362, val_loss: 6.9589, lr: 0.003000, 6.66s
2024-04-30 15:46:00 INFO     Saved model at 4
2024-04-30 15:46:00 INFO     Val loss decrease from 7.9169 to 6.9589, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 15:46:07 INFO     epoch complete!
2024-04-30 15:46:07 INFO     evaluating now!
2024-04-30 15:46:07 INFO     Epoch [5/200] train_loss: 6.6680, val_loss: 6.7240, lr: 0.003000, 7.04s
2024-04-30 15:46:07 INFO     Saved model at 5
2024-04-30 15:46:07 INFO     Val loss decrease from 6.9589 to 6.7240, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 15:46:14 INFO     epoch complete!
2024-04-30 15:46:14 INFO     evaluating now!
2024-04-30 15:46:14 INFO     Epoch [6/200] train_loss: 6.3679, val_loss: 6.2551, lr: 0.003000, 6.98s
2024-04-30 15:46:14 INFO     Saved model at 6
2024-04-30 15:46:14 INFO     Val loss decrease from 6.7240 to 6.2551, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 15:46:21 INFO     epoch complete!
2024-04-30 15:46:21 INFO     evaluating now!
2024-04-30 15:46:21 INFO     Epoch [7/200] train_loss: 6.0467, val_loss: 6.1898, lr: 0.003000, 6.65s
2024-04-30 15:46:21 INFO     Saved model at 7
2024-04-30 15:46:21 INFO     Val loss decrease from 6.2551 to 6.1898, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 15:46:27 INFO     epoch complete!
2024-04-30 15:46:27 INFO     evaluating now!
2024-04-30 15:46:28 INFO     Epoch [8/200] train_loss: 5.7849, val_loss: 5.9248, lr: 0.003000, 6.50s
2024-04-30 15:46:28 INFO     Saved model at 8
2024-04-30 15:46:28 INFO     Val loss decrease from 6.1898 to 5.9248, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 15:46:34 INFO     epoch complete!
2024-04-30 15:46:34 INFO     evaluating now!
2024-04-30 15:46:34 INFO     Epoch [9/200] train_loss: 5.6180, val_loss: 5.7656, lr: 0.003000, 6.47s
2024-04-30 15:46:34 INFO     Saved model at 9
2024-04-30 15:46:34 INFO     Val loss decrease from 5.9248 to 5.7656, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 15:46:40 INFO     epoch complete!
2024-04-30 15:46:40 INFO     evaluating now!
2024-04-30 15:46:41 INFO     Epoch [10/200] train_loss: 5.4561, val_loss: 5.7201, lr: 0.003000, 6.45s
2024-04-30 15:46:41 INFO     Saved model at 10
2024-04-30 15:46:41 INFO     Val loss decrease from 5.7656 to 5.7201, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 15:46:47 INFO     epoch complete!
2024-04-30 15:46:47 INFO     evaluating now!
2024-04-30 15:46:47 INFO     Epoch [11/200] train_loss: 5.4184, val_loss: 5.5708, lr: 0.003000, 6.39s
2024-04-30 15:46:47 INFO     Saved model at 11
2024-04-30 15:46:47 INFO     Val loss decrease from 5.7201 to 5.5708, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 15:46:53 INFO     epoch complete!
2024-04-30 15:46:53 INFO     evaluating now!
2024-04-30 15:46:53 INFO     Epoch [12/200] train_loss: 5.1638, val_loss: 5.6248, lr: 0.003000, 6.46s
2024-04-30 15:47:00 INFO     epoch complete!
2024-04-30 15:47:00 INFO     evaluating now!
2024-04-30 15:47:00 INFO     Epoch [13/200] train_loss: 5.0621, val_loss: 5.5364, lr: 0.003000, 6.61s
2024-04-30 15:47:00 INFO     Saved model at 13
2024-04-30 15:47:00 INFO     Val loss decrease from 5.5708 to 5.5364, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 15:47:06 INFO     epoch complete!
2024-04-30 15:47:06 INFO     evaluating now!
2024-04-30 15:47:07 INFO     Epoch [14/200] train_loss: 4.9694, val_loss: 5.4650, lr: 0.003000, 6.54s
2024-04-30 15:47:07 INFO     Saved model at 14
2024-04-30 15:47:07 INFO     Val loss decrease from 5.5364 to 5.4650, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 15:47:13 INFO     epoch complete!
2024-04-30 15:47:13 INFO     evaluating now!
2024-04-30 15:47:13 INFO     Epoch [15/200] train_loss: 4.8951, val_loss: 5.5119, lr: 0.003000, 6.63s
2024-04-30 15:47:19 INFO     epoch complete!
2024-04-30 15:47:19 INFO     evaluating now!
2024-04-30 15:47:20 INFO     Epoch [16/200] train_loss: 4.8414, val_loss: 5.1546, lr: 0.003000, 6.48s
2024-04-30 15:47:20 INFO     Saved model at 16
2024-04-30 15:47:20 INFO     Val loss decrease from 5.4650 to 5.1546, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 15:47:26 INFO     epoch complete!
2024-04-30 15:47:26 INFO     evaluating now!
2024-04-30 15:47:26 INFO     Epoch [17/200] train_loss: 4.7469, val_loss: 5.3834, lr: 0.003000, 6.50s
2024-04-30 15:47:32 INFO     epoch complete!
2024-04-30 15:47:32 INFO     evaluating now!
2024-04-30 15:47:33 INFO     Epoch [18/200] train_loss: 4.7265, val_loss: 5.2741, lr: 0.003000, 6.44s
2024-04-30 15:47:39 INFO     epoch complete!
2024-04-30 15:47:39 INFO     evaluating now!
2024-04-30 15:47:39 INFO     Epoch [19/200] train_loss: 4.6758, val_loss: 5.1225, lr: 0.003000, 6.52s
2024-04-30 15:47:39 INFO     Saved model at 19
2024-04-30 15:47:39 INFO     Val loss decrease from 5.1546 to 5.1225, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 15:47:45 INFO     epoch complete!
2024-04-30 15:47:45 INFO     evaluating now!
2024-04-30 15:47:46 INFO     Epoch [20/200] train_loss: 4.5875, val_loss: 5.0891, lr: 0.003000, 6.50s
2024-04-30 15:47:46 INFO     Saved model at 20
2024-04-30 15:47:46 INFO     Val loss decrease from 5.1225 to 5.0891, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-30 15:47:52 INFO     epoch complete!
2024-04-30 15:47:52 INFO     evaluating now!
2024-04-30 15:47:52 INFO     Epoch [21/200] train_loss: 4.5419, val_loss: 5.2492, lr: 0.003000, 6.38s
2024-04-30 15:47:58 INFO     epoch complete!
2024-04-30 15:47:58 INFO     evaluating now!
2024-04-30 15:47:59 INFO     Epoch [22/200] train_loss: 4.4860, val_loss: 5.1987, lr: 0.003000, 6.53s
2024-04-30 15:48:05 INFO     epoch complete!
2024-04-30 15:48:05 INFO     evaluating now!
2024-04-30 15:48:05 INFO     Epoch [23/200] train_loss: 4.4193, val_loss: 5.2980, lr: 0.003000, 6.60s
2024-04-30 15:48:11 INFO     epoch complete!
2024-04-30 15:48:11 INFO     evaluating now!
2024-04-30 15:48:12 INFO     Epoch [24/200] train_loss: 4.3467, val_loss: 5.1504, lr: 0.003000, 6.49s
2024-04-30 15:48:18 INFO     epoch complete!
2024-04-30 15:48:18 INFO     evaluating now!
2024-04-30 15:48:18 INFO     Epoch [25/200] train_loss: 4.2750, val_loss: 5.2071, lr: 0.003000, 6.45s
2024-04-30 15:48:25 INFO     epoch complete!
2024-04-30 15:48:25 INFO     evaluating now!
2024-04-30 15:48:25 INFO     Epoch [26/200] train_loss: 4.2759, val_loss: 5.0661, lr: 0.003000, 6.80s
2024-04-30 15:48:25 INFO     Saved model at 26
2024-04-30 15:48:25 INFO     Val loss decrease from 5.0891 to 5.0661, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-04-30 15:48:32 INFO     epoch complete!
2024-04-30 15:48:32 INFO     evaluating now!
2024-04-30 15:48:32 INFO     Epoch [27/200] train_loss: 4.2529, val_loss: 5.1939, lr: 0.003000, 7.05s
2024-04-30 15:48:39 INFO     epoch complete!
2024-04-30 15:48:39 INFO     evaluating now!
2024-04-30 15:48:39 INFO     Epoch [28/200] train_loss: 4.2433, val_loss: 5.0049, lr: 0.003000, 7.03s
2024-04-30 15:48:39 INFO     Saved model at 28
2024-04-30 15:48:39 INFO     Val loss decrease from 5.0661 to 5.0049, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-04-30 15:48:46 INFO     epoch complete!
2024-04-30 15:48:46 INFO     evaluating now!
2024-04-30 15:48:46 INFO     Epoch [29/200] train_loss: 4.2186, val_loss: 5.3208, lr: 0.003000, 6.90s
2024-04-30 15:48:53 INFO     epoch complete!
2024-04-30 15:48:53 INFO     evaluating now!
2024-04-30 15:48:53 INFO     Epoch [30/200] train_loss: 4.1424, val_loss: 5.1661, lr: 0.003000, 6.86s
2024-04-30 15:49:00 INFO     epoch complete!
2024-04-30 15:49:00 INFO     evaluating now!
2024-04-30 15:49:00 INFO     Epoch [31/200] train_loss: 4.1048, val_loss: 5.3438, lr: 0.003000, 7.08s
2024-04-30 15:49:07 INFO     epoch complete!
2024-04-30 15:49:07 INFO     evaluating now!
2024-04-30 15:49:07 INFO     Epoch [32/200] train_loss: 4.1370, val_loss: 5.3730, lr: 0.003000, 7.05s
2024-04-30 15:49:15 INFO     epoch complete!
2024-04-30 15:49:15 INFO     evaluating now!
2024-04-30 15:49:15 INFO     Epoch [33/200] train_loss: 4.0856, val_loss: 5.0926, lr: 0.003000, 7.85s
2024-04-30 15:49:22 INFO     epoch complete!
2024-04-30 15:49:22 INFO     evaluating now!
2024-04-30 15:49:23 INFO     Epoch [34/200] train_loss: 4.0110, val_loss: 5.1887, lr: 0.003000, 7.66s
2024-04-30 15:49:29 INFO     epoch complete!
2024-04-30 15:49:29 INFO     evaluating now!
2024-04-30 15:49:30 INFO     Epoch [35/200] train_loss: 3.9864, val_loss: 5.0698, lr: 0.003000, 6.98s
2024-04-30 15:49:36 INFO     epoch complete!
2024-04-30 15:49:36 INFO     evaluating now!
2024-04-30 15:49:37 INFO     Epoch [36/200] train_loss: 3.9405, val_loss: 5.2370, lr: 0.003000, 7.00s
2024-04-30 15:49:43 INFO     epoch complete!
2024-04-30 15:49:43 INFO     evaluating now!
2024-04-30 15:49:44 INFO     Epoch [37/200] train_loss: 3.9016, val_loss: 5.0507, lr: 0.003000, 7.10s
2024-04-30 15:49:50 INFO     epoch complete!
2024-04-30 15:49:50 INFO     evaluating now!
2024-04-30 15:49:51 INFO     Epoch [38/200] train_loss: 3.8979, val_loss: 5.0517, lr: 0.003000, 7.12s
2024-04-30 15:49:58 INFO     epoch complete!
2024-04-30 15:49:58 INFO     evaluating now!
2024-04-30 15:49:58 INFO     Epoch [39/200] train_loss: 3.8530, val_loss: 5.0388, lr: 0.003000, 7.22s
2024-04-30 15:50:05 INFO     epoch complete!
2024-04-30 15:50:05 INFO     evaluating now!
2024-04-30 15:50:05 INFO     Epoch [40/200] train_loss: 3.8212, val_loss: 5.0588, lr: 0.003000, 7.20s
2024-04-30 15:50:12 INFO     epoch complete!
2024-04-30 15:50:12 INFO     evaluating now!
2024-04-30 15:50:12 INFO     Epoch [41/200] train_loss: 3.8126, val_loss: 5.1425, lr: 0.003000, 7.03s
2024-04-30 15:50:19 INFO     epoch complete!
2024-04-30 15:50:19 INFO     evaluating now!
2024-04-30 15:50:19 INFO     Epoch [42/200] train_loss: 3.8286, val_loss: 5.1003, lr: 0.003000, 7.05s
2024-04-30 15:50:26 INFO     epoch complete!
2024-04-30 15:50:26 INFO     evaluating now!
2024-04-30 15:50:27 INFO     Epoch [43/200] train_loss: 3.8050, val_loss: 5.2272, lr: 0.003000, 7.08s
2024-04-30 15:50:27 WARNING  Early stopping at epoch: 43
2024-04-30 15:50:27 INFO     Trained totally 44 epochs, average train time is 6.325s, average eval time is 0.449s
2024-04-30 15:50:27 INFO     Loaded model at 28
2024-04-30 15:50:27 INFO     Saved model at ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 15:50:27 INFO     Start evaluating ...
2024-04-30 15:50:28 INFO     Note that you select the single mode to evaluate!
2024-04-30 15:50:28 INFO     Evaluate result is saved at ./libcity/cache/63/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 15:50:28 INFO     
         MAE       RMSE
1   2.276980   7.337266
2   2.349023   7.871299
3   2.490891   8.744450
4   2.701995   9.437959
5   2.886241  10.283611
6   3.019423  11.167177
7   3.131820  12.075341
8   3.164522  12.828083
9   3.256268  13.524909
10  3.295707  14.040470
11  3.296380  14.511306
12  3.449978  15.215134
2024-04-30 15:50:28 INFO     ----------------------------------------------------------------------------
2024-04-30 15:50:28 INFO     # 4, Kownledge Graph Embedding: RandomE, Experiment ids: 64
2024-04-30 15:50:28 INFO     ----------------------------------------------------------------------------
2024-04-30 15:50:28 INFO     Log directory: ./libcity/log
2024-04-30 15:50:28 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=64
2024-04-30 15:50:28 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 588189344, 'exp_id': 64, 'load_external': True, 'embedding_model': 'RandomE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 15:50:28 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 15:50:28 INFO     set_weight_link_or_dist: dist
2024-04-30 15:50:28 INFO     init_weight_inf_or_zero: inf
2024-04-30 15:50:28 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 15:50:28 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 15:50:28 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 15:50:29 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 15:50:33 INFO     Dataset created
2024-04-30 15:50:33 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 15:50:33 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 15:50:33 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 15:50:33 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 15:50:33 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 15:50:33 INFO     NoneScaler
2024-04-30 15:50:36 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 15:50:36 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 15:50:36 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 15:50:36 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 15:50:36 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 15:50:36 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 15:50:36 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 15:50:36 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 15:50:36 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 15:50:36 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 15:50:36 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 15:50:36 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 15:50:36 INFO     Total parameter numbers: 874010
2024-04-30 15:50:36 INFO     You select `adam` optimizer.
2024-04-30 15:50:36 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 15:50:36 INFO     Start training ...
2024-04-30 15:50:36 INFO     num_batches:48
2024-04-30 15:50:43 INFO     epoch complete!
2024-04-30 15:50:43 INFO     evaluating now!
2024-04-30 15:50:43 INFO     Epoch [0/200] train_loss: 24.7351, val_loss: 16.9986, lr: 0.003000, 7.05s
2024-04-30 15:50:43 INFO     Saved model at 0
2024-04-30 15:50:43 INFO     Val loss decrease from inf to 16.9986, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 15:50:50 INFO     epoch complete!
2024-04-30 15:50:50 INFO     evaluating now!
2024-04-30 15:50:50 INFO     Epoch [1/200] train_loss: 13.6619, val_loss: 12.4865, lr: 0.003000, 6.99s
2024-04-30 15:50:50 INFO     Saved model at 1
2024-04-30 15:50:50 INFO     Val loss decrease from 16.9986 to 12.4865, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 15:50:57 INFO     epoch complete!
2024-04-30 15:50:57 INFO     evaluating now!
2024-04-30 15:50:57 INFO     Epoch [2/200] train_loss: 10.3719, val_loss: 9.4660, lr: 0.003000, 6.95s
2024-04-30 15:50:57 INFO     Saved model at 2
2024-04-30 15:50:57 INFO     Val loss decrease from 12.4865 to 9.4660, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 15:51:04 INFO     epoch complete!
2024-04-30 15:51:04 INFO     evaluating now!
2024-04-30 15:51:04 INFO     Epoch [3/200] train_loss: 8.4250, val_loss: 7.9936, lr: 0.003000, 7.18s
2024-04-30 15:51:05 INFO     Saved model at 3
2024-04-30 15:51:05 INFO     Val loss decrease from 9.4660 to 7.9936, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 15:51:11 INFO     epoch complete!
2024-04-30 15:51:11 INFO     evaluating now!
2024-04-30 15:51:12 INFO     Epoch [4/200] train_loss: 7.4957, val_loss: 7.2970, lr: 0.003000, 7.01s
2024-04-30 15:51:12 INFO     Saved model at 4
2024-04-30 15:51:12 INFO     Val loss decrease from 7.9936 to 7.2970, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 15:51:18 INFO     epoch complete!
2024-04-30 15:51:18 INFO     evaluating now!
2024-04-30 15:51:19 INFO     Epoch [5/200] train_loss: 6.8418, val_loss: 6.9804, lr: 0.003000, 7.06s
2024-04-30 15:51:19 INFO     Saved model at 5
2024-04-30 15:51:19 INFO     Val loss decrease from 7.2970 to 6.9804, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 15:51:25 INFO     epoch complete!
2024-04-30 15:51:25 INFO     evaluating now!
2024-04-30 15:51:26 INFO     Epoch [6/200] train_loss: 6.4309, val_loss: 6.2608, lr: 0.003000, 7.13s
2024-04-30 15:51:26 INFO     Saved model at 6
2024-04-30 15:51:26 INFO     Val loss decrease from 6.9804 to 6.2608, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 15:51:33 INFO     epoch complete!
2024-04-30 15:51:33 INFO     evaluating now!
2024-04-30 15:51:33 INFO     Epoch [7/200] train_loss: 6.0177, val_loss: 6.0495, lr: 0.003000, 7.62s
2024-04-30 15:51:34 INFO     Saved model at 7
2024-04-30 15:51:34 INFO     Val loss decrease from 6.2608 to 6.0495, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 15:51:41 INFO     epoch complete!
2024-04-30 15:51:41 INFO     evaluating now!
2024-04-30 15:51:41 INFO     Epoch [8/200] train_loss: 5.8214, val_loss: 6.0158, lr: 0.003000, 7.79s
2024-04-30 15:51:41 INFO     Saved model at 8
2024-04-30 15:51:41 INFO     Val loss decrease from 6.0495 to 6.0158, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 15:51:48 INFO     epoch complete!
2024-04-30 15:51:48 INFO     evaluating now!
2024-04-30 15:51:49 INFO     Epoch [9/200] train_loss: 5.6361, val_loss: 5.8421, lr: 0.003000, 7.13s
2024-04-30 15:51:49 INFO     Saved model at 9
2024-04-30 15:51:49 INFO     Val loss decrease from 6.0158 to 5.8421, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 15:51:55 INFO     epoch complete!
2024-04-30 15:51:55 INFO     evaluating now!
2024-04-30 15:51:56 INFO     Epoch [10/200] train_loss: 5.4903, val_loss: 5.7464, lr: 0.003000, 7.06s
2024-04-30 15:51:56 INFO     Saved model at 10
2024-04-30 15:51:56 INFO     Val loss decrease from 5.8421 to 5.7464, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 15:52:02 INFO     epoch complete!
2024-04-30 15:52:02 INFO     evaluating now!
2024-04-30 15:52:03 INFO     Epoch [11/200] train_loss: 5.3160, val_loss: 5.4649, lr: 0.003000, 7.12s
2024-04-30 15:52:03 INFO     Saved model at 11
2024-04-30 15:52:03 INFO     Val loss decrease from 5.7464 to 5.4649, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 15:52:09 INFO     epoch complete!
2024-04-30 15:52:09 INFO     evaluating now!
2024-04-30 15:52:10 INFO     Epoch [12/200] train_loss: 5.2808, val_loss: 5.4580, lr: 0.003000, 6.98s
2024-04-30 15:52:10 INFO     Saved model at 12
2024-04-30 15:52:10 INFO     Val loss decrease from 5.4649 to 5.4580, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 15:52:16 INFO     epoch complete!
2024-04-30 15:52:16 INFO     evaluating now!
2024-04-30 15:52:17 INFO     Epoch [13/200] train_loss: 5.0829, val_loss: 5.3947, lr: 0.003000, 7.00s
2024-04-30 15:52:17 INFO     Saved model at 13
2024-04-30 15:52:17 INFO     Val loss decrease from 5.4580 to 5.3947, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 15:52:23 INFO     epoch complete!
2024-04-30 15:52:23 INFO     evaluating now!
2024-04-30 15:52:24 INFO     Epoch [14/200] train_loss: 4.9983, val_loss: 5.3443, lr: 0.003000, 6.98s
2024-04-30 15:52:24 INFO     Saved model at 14
2024-04-30 15:52:24 INFO     Val loss decrease from 5.3947 to 5.3443, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 15:52:30 INFO     epoch complete!
2024-04-30 15:52:30 INFO     evaluating now!
2024-04-30 15:52:31 INFO     Epoch [15/200] train_loss: 4.9376, val_loss: 5.3419, lr: 0.003000, 6.96s
2024-04-30 15:52:31 INFO     Saved model at 15
2024-04-30 15:52:31 INFO     Val loss decrease from 5.3443 to 5.3419, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 15:52:37 INFO     epoch complete!
2024-04-30 15:52:37 INFO     evaluating now!
2024-04-30 15:52:38 INFO     Epoch [16/200] train_loss: 4.9001, val_loss: 5.4307, lr: 0.003000, 6.99s
2024-04-30 15:52:44 INFO     epoch complete!
2024-04-30 15:52:44 INFO     evaluating now!
2024-04-30 15:52:45 INFO     Epoch [17/200] train_loss: 4.7734, val_loss: 5.3192, lr: 0.003000, 6.99s
2024-04-30 15:52:45 INFO     Saved model at 17
2024-04-30 15:52:45 INFO     Val loss decrease from 5.3419 to 5.3192, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 15:52:51 INFO     epoch complete!
2024-04-30 15:52:52 INFO     evaluating now!
2024-04-30 15:52:52 INFO     Epoch [18/200] train_loss: 4.6998, val_loss: 5.3640, lr: 0.003000, 7.00s
2024-04-30 15:52:59 INFO     epoch complete!
2024-04-30 15:52:59 INFO     evaluating now!
2024-04-30 15:52:59 INFO     Epoch [19/200] train_loss: 4.6600, val_loss: 5.0991, lr: 0.003000, 6.98s
2024-04-30 15:52:59 INFO     Saved model at 19
2024-04-30 15:52:59 INFO     Val loss decrease from 5.3192 to 5.0991, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 15:53:06 INFO     epoch complete!
2024-04-30 15:53:06 INFO     evaluating now!
2024-04-30 15:53:07 INFO     Epoch [20/200] train_loss: 4.6399, val_loss: 5.3068, lr: 0.003000, 7.74s
2024-04-30 15:53:13 INFO     epoch complete!
2024-04-30 15:53:13 INFO     evaluating now!
2024-04-30 15:53:14 INFO     Epoch [21/200] train_loss: 4.5296, val_loss: 5.3110, lr: 0.003000, 7.02s
2024-04-30 15:53:20 INFO     epoch complete!
2024-04-30 15:53:20 INFO     evaluating now!
2024-04-30 15:53:21 INFO     Epoch [22/200] train_loss: 4.5895, val_loss: 5.4192, lr: 0.003000, 7.04s
2024-04-30 15:53:27 INFO     epoch complete!
2024-04-30 15:53:27 INFO     evaluating now!
2024-04-30 15:53:28 INFO     Epoch [23/200] train_loss: 4.4419, val_loss: 4.9905, lr: 0.003000, 7.07s
2024-04-30 15:53:28 INFO     Saved model at 23
2024-04-30 15:53:28 INFO     Val loss decrease from 5.0991 to 4.9905, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-30 15:53:35 INFO     epoch complete!
2024-04-30 15:53:35 INFO     evaluating now!
2024-04-30 15:53:35 INFO     Epoch [24/200] train_loss: 4.3712, val_loss: 5.1373, lr: 0.003000, 7.07s
2024-04-30 15:53:42 INFO     epoch complete!
2024-04-30 15:53:42 INFO     evaluating now!
2024-04-30 15:53:42 INFO     Epoch [25/200] train_loss: 4.3257, val_loss: 5.0761, lr: 0.003000, 7.06s
2024-04-30 15:53:49 INFO     epoch complete!
2024-04-30 15:53:49 INFO     evaluating now!
2024-04-30 15:53:49 INFO     Epoch [26/200] train_loss: 4.2637, val_loss: 5.0362, lr: 0.003000, 7.02s
2024-04-30 15:53:56 INFO     epoch complete!
2024-04-30 15:53:56 INFO     evaluating now!
2024-04-30 15:53:56 INFO     Epoch [27/200] train_loss: 4.2808, val_loss: 5.1343, lr: 0.003000, 6.94s
2024-04-30 15:54:03 INFO     epoch complete!
2024-04-30 15:54:03 INFO     evaluating now!
2024-04-30 15:54:03 INFO     Epoch [28/200] train_loss: 4.2311, val_loss: 5.1130, lr: 0.003000, 7.21s
2024-04-30 15:54:10 INFO     epoch complete!
2024-04-30 15:54:10 INFO     evaluating now!
2024-04-30 15:54:10 INFO     Epoch [29/200] train_loss: 4.1613, val_loss: 5.1693, lr: 0.003000, 7.02s
2024-04-30 15:54:17 INFO     epoch complete!
2024-04-30 15:54:17 INFO     evaluating now!
2024-04-30 15:54:17 INFO     Epoch [30/200] train_loss: 4.1421, val_loss: 4.9441, lr: 0.003000, 6.95s
2024-04-30 15:54:17 INFO     Saved model at 30
2024-04-30 15:54:17 INFO     Val loss decrease from 4.9905 to 4.9441, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-04-30 15:54:24 INFO     epoch complete!
2024-04-30 15:54:24 INFO     evaluating now!
2024-04-30 15:54:24 INFO     Epoch [31/200] train_loss: 4.1166, val_loss: 5.1113, lr: 0.003000, 7.01s
2024-04-30 15:54:31 INFO     epoch complete!
2024-04-30 15:54:31 INFO     evaluating now!
2024-04-30 15:54:31 INFO     Epoch [32/200] train_loss: 4.0883, val_loss: 4.9815, lr: 0.003000, 7.04s
2024-04-30 15:54:38 INFO     epoch complete!
2024-04-30 15:54:38 INFO     evaluating now!
2024-04-30 15:54:38 INFO     Epoch [33/200] train_loss: 4.0366, val_loss: 5.1051, lr: 0.003000, 7.01s
2024-04-30 15:54:45 INFO     epoch complete!
2024-04-30 15:54:45 INFO     evaluating now!
2024-04-30 15:54:45 INFO     Epoch [34/200] train_loss: 4.0433, val_loss: 5.0915, lr: 0.003000, 7.04s
2024-04-30 15:54:52 INFO     epoch complete!
2024-04-30 15:54:52 INFO     evaluating now!
2024-04-30 15:54:52 INFO     Epoch [35/200] train_loss: 3.9980, val_loss: 5.1092, lr: 0.003000, 6.71s
2024-04-30 15:54:58 INFO     epoch complete!
2024-04-30 15:54:58 INFO     evaluating now!
2024-04-30 15:54:59 INFO     Epoch [36/200] train_loss: 4.0027, val_loss: 4.9580, lr: 0.003000, 6.76s
2024-04-30 15:55:05 INFO     epoch complete!
2024-04-30 15:55:05 INFO     evaluating now!
2024-04-30 15:55:05 INFO     Epoch [37/200] train_loss: 3.9652, val_loss: 5.0769, lr: 0.003000, 6.54s
2024-04-30 15:55:11 INFO     epoch complete!
2024-04-30 15:55:11 INFO     evaluating now!
2024-04-30 15:55:12 INFO     Epoch [38/200] train_loss: 3.8939, val_loss: 5.1040, lr: 0.003000, 6.15s
2024-04-30 15:55:17 INFO     epoch complete!
2024-04-30 15:55:17 INFO     evaluating now!
2024-04-30 15:55:18 INFO     Epoch [39/200] train_loss: 3.8683, val_loss: 5.0678, lr: 0.003000, 6.27s
2024-04-30 15:55:24 INFO     epoch complete!
2024-04-30 15:55:24 INFO     evaluating now!
2024-04-30 15:55:24 INFO     Epoch [40/200] train_loss: 3.8490, val_loss: 5.1435, lr: 0.003000, 6.20s
2024-04-30 15:55:30 INFO     epoch complete!
2024-04-30 15:55:30 INFO     evaluating now!
2024-04-30 15:55:30 INFO     Epoch [41/200] train_loss: 3.8189, val_loss: 5.0948, lr: 0.003000, 6.49s
2024-04-30 15:55:37 INFO     epoch complete!
2024-04-30 15:55:37 INFO     evaluating now!
2024-04-30 15:55:37 INFO     Epoch [42/200] train_loss: 3.8117, val_loss: 5.1799, lr: 0.003000, 6.81s
2024-04-30 15:55:43 INFO     epoch complete!
2024-04-30 15:55:43 INFO     evaluating now!
2024-04-30 15:55:44 INFO     Epoch [43/200] train_loss: 3.7984, val_loss: 5.0558, lr: 0.003000, 6.30s
2024-04-30 15:55:50 INFO     epoch complete!
2024-04-30 15:55:50 INFO     evaluating now!
2024-04-30 15:55:50 INFO     Epoch [44/200] train_loss: 3.7875, val_loss: 5.1432, lr: 0.003000, 6.60s
2024-04-30 15:55:56 INFO     epoch complete!
2024-04-30 15:55:56 INFO     evaluating now!
2024-04-30 15:55:57 INFO     Epoch [45/200] train_loss: 3.7417, val_loss: 4.9906, lr: 0.003000, 6.69s
2024-04-30 15:55:57 WARNING  Early stopping at epoch: 45
2024-04-30 15:55:57 INFO     Trained totally 46 epochs, average train time is 6.497s, average eval time is 0.451s
2024-04-30 15:55:57 INFO     Loaded model at 30
2024-04-30 15:55:57 INFO     Saved model at ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 15:55:57 INFO     Start evaluating ...
2024-04-30 15:55:59 INFO     Note that you select the single mode to evaluate!
2024-04-30 15:55:59 INFO     Evaluate result is saved at ./libcity/cache/64/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 15:55:59 INFO     
         MAE       RMSE
1   2.288175   7.594116
2   2.419240   8.062617
3   2.562317   9.161091
4   2.801376  10.192779
5   2.964775  10.936605
6   3.040732  11.440825
7   3.087113  11.741173
8   3.101504  11.918466
9   3.120782  11.990006
10  3.140441  12.145937
11  3.249171  12.417368
12  3.402401  13.110586
2024-04-30 15:55:59 INFO     ----------------------------------------------------------------------------
2024-04-30 15:55:59 INFO     Kownledge Graph Embedding: RandomE, Experiment ids: [60, 61, 62, 63, 64]
2024-04-30 15:55:59 INFO     ----------------------------------------------------------------------------
2024-04-30 15:55:59 INFO     Average: 
         MAE       RMSE
0   2.323272   7.247073
1   2.418143   7.820409
2   2.573604   8.865501
3   2.762838   9.743173
4   2.907390  10.607135
5   3.005923  11.331248
6   3.107044  11.931340
7   3.153763  12.458179
8   3.215734  12.833403
9   3.243970  13.118837
10  3.296013  13.343015
11  3.423046  13.875079 
2024-04-30 15:55:59 INFO     Standard deviation: 
         MAE      RMSE
0   0.053840  0.265153
1   0.049045  0.163526
2   0.064173  0.227606
3   0.056938  0.415173
4   0.074369  0.576763
5   0.058868  0.494430
6   0.018565  0.399854
7   0.026607  0.477652
8   0.054724  0.583328
9   0.064104  0.690693
10  0.035342  0.735444
11  0.026054  0.841526
2024-04-30 15:55:59 INFO     ----------------------------------------------------------------------------
2024-04-30 15:55:59 INFO     12 steps Average: 
        MAE       RMSE
0  2.952562  11.097866
2024-04-30 15:55:59 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.048552  0.489262
