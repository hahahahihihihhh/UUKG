2024-09-25 22:55:35 INFO     Saving logs in: ./logs/CHITaxi20190406/AGCRN/Concat/GIE
2024-09-25 22:55:35 INFO     ----------------------------------------------------------------------------
2024-09-25 22:55:35 INFO     # 0, Kownledge Graph Embedding: GIE, Experiment ids: 15
2024-09-25 22:55:35 INFO     ----------------------------------------------------------------------------
2024-09-25 22:55:35 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=15
2024-09-25 22:55:35 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 15, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-25 22:55:36 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-25 22:55:37 INFO     set_weight_link_or_dist: dist
2024-09-25 22:55:37 INFO     init_weight_inf_or_zero: inf
2024-09-25 22:55:37 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-25 22:55:37 INFO     Start Calculate the weight by Gauss kernel!
2024-09-25 22:55:37 INFO     Loading file CHITaxi20190406.dyna
2024-09-25 22:55:37 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-25 22:55:40 INFO     Dataset created
2024-09-25 22:55:40 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-25 22:55:40 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-25 22:55:40 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-25 22:55:40 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-25 22:55:40 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-25 22:55:40 INFO     NoneScaler
2024-09-25 22:55:49 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-25 22:55:49 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-25 22:55:49 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-25 22:55:49 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-25 22:55:49 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-25 22:55:49 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-25 22:55:49 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-25 22:55:49 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-25 22:55:49 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-25 22:55:49 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-25 22:55:49 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-25 22:55:49 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-25 22:55:49 INFO     Total parameter numbers: 874010
2024-09-25 22:55:49 INFO     You select `adam` optimizer.
2024-09-25 22:55:49 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-25 22:55:49 INFO     Start training ...
2024-09-25 22:55:49 INFO     num_batches:48
2024-09-25 22:55:55 INFO     epoch complete!
2024-09-25 22:55:55 INFO     evaluating now!
2024-09-25 22:55:56 INFO     Epoch [0/200] train_loss: 25.6379, val_loss: 18.6165, lr: 0.003000, 6.94s
2024-09-25 22:55:56 INFO     Saved model at 0
2024-09-25 22:55:56 INFO     Val loss decrease from inf to 18.6165, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-25 22:56:01 INFO     epoch complete!
2024-09-25 22:56:01 INFO     evaluating now!
2024-09-25 22:56:02 INFO     Epoch [1/200] train_loss: 15.3417, val_loss: 14.3954, lr: 0.003000, 6.24s
2024-09-25 22:56:02 INFO     Saved model at 1
2024-09-25 22:56:02 INFO     Val loss decrease from 18.6165 to 14.3954, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-25 22:56:08 INFO     epoch complete!
2024-09-25 22:56:08 INFO     evaluating now!
2024-09-25 22:56:08 INFO     Epoch [2/200] train_loss: 12.0046, val_loss: 11.5961, lr: 0.003000, 6.23s
2024-09-25 22:56:08 INFO     Saved model at 2
2024-09-25 22:56:08 INFO     Val loss decrease from 14.3954 to 11.5961, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-25 22:56:14 INFO     epoch complete!
2024-09-25 22:56:14 INFO     evaluating now!
2024-09-25 22:56:15 INFO     Epoch [3/200] train_loss: 9.8661, val_loss: 9.4384, lr: 0.003000, 6.42s
2024-09-25 22:56:15 INFO     Saved model at 3
2024-09-25 22:56:15 INFO     Val loss decrease from 11.5961 to 9.4384, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-25 22:56:21 INFO     epoch complete!
2024-09-25 22:56:21 INFO     evaluating now!
2024-09-25 22:56:21 INFO     Epoch [4/200] train_loss: 8.5632, val_loss: 8.3264, lr: 0.003000, 6.41s
2024-09-25 22:56:21 INFO     Saved model at 4
2024-09-25 22:56:21 INFO     Val loss decrease from 9.4384 to 8.3264, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-25 22:56:27 INFO     epoch complete!
2024-09-25 22:56:27 INFO     evaluating now!
2024-09-25 22:56:28 INFO     Epoch [5/200] train_loss: 7.8731, val_loss: 7.6260, lr: 0.003000, 6.42s
2024-09-25 22:56:28 INFO     Saved model at 5
2024-09-25 22:56:28 INFO     Val loss decrease from 8.3264 to 7.6260, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-25 22:56:34 INFO     epoch complete!
2024-09-25 22:56:34 INFO     evaluating now!
2024-09-25 22:56:34 INFO     Epoch [6/200] train_loss: 7.1634, val_loss: 6.9675, lr: 0.003000, 6.22s
2024-09-25 22:56:34 INFO     Saved model at 6
2024-09-25 22:56:34 INFO     Val loss decrease from 7.6260 to 6.9675, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-25 22:56:40 INFO     epoch complete!
2024-09-25 22:56:40 INFO     evaluating now!
2024-09-25 22:56:40 INFO     Epoch [7/200] train_loss: 6.5465, val_loss: 6.4129, lr: 0.003000, 6.16s
2024-09-25 22:56:40 INFO     Saved model at 7
2024-09-25 22:56:40 INFO     Val loss decrease from 6.9675 to 6.4129, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-25 22:56:46 INFO     epoch complete!
2024-09-25 22:56:46 INFO     evaluating now!
2024-09-25 22:56:47 INFO     Epoch [8/200] train_loss: 6.2654, val_loss: 6.3579, lr: 0.003000, 6.10s
2024-09-25 22:56:47 INFO     Saved model at 8
2024-09-25 22:56:47 INFO     Val loss decrease from 6.4129 to 6.3579, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-25 22:56:52 INFO     epoch complete!
2024-09-25 22:56:52 INFO     evaluating now!
2024-09-25 22:56:53 INFO     Epoch [9/200] train_loss: 6.0591, val_loss: 6.1386, lr: 0.003000, 6.21s
2024-09-25 22:56:53 INFO     Saved model at 9
2024-09-25 22:56:53 INFO     Val loss decrease from 6.3579 to 6.1386, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-25 22:56:59 INFO     epoch complete!
2024-09-25 22:56:59 INFO     evaluating now!
2024-09-25 22:56:59 INFO     Epoch [10/200] train_loss: 5.8171, val_loss: 6.1109, lr: 0.003000, 6.16s
2024-09-25 22:56:59 INFO     Saved model at 10
2024-09-25 22:56:59 INFO     Val loss decrease from 6.1386 to 6.1109, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-25 22:57:05 INFO     epoch complete!
2024-09-25 22:57:05 INFO     evaluating now!
2024-09-25 22:57:06 INFO     Epoch [11/200] train_loss: 5.8380, val_loss: 6.0665, lr: 0.003000, 6.21s
2024-09-25 22:57:06 INFO     Saved model at 11
2024-09-25 22:57:06 INFO     Val loss decrease from 6.1109 to 6.0665, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-25 22:57:11 INFO     epoch complete!
2024-09-25 22:57:11 INFO     evaluating now!
2024-09-25 22:57:12 INFO     Epoch [12/200] train_loss: 5.5719, val_loss: 5.8419, lr: 0.003000, 6.13s
2024-09-25 22:57:12 INFO     Saved model at 12
2024-09-25 22:57:12 INFO     Val loss decrease from 6.0665 to 5.8419, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-25 22:57:18 INFO     epoch complete!
2024-09-25 22:57:18 INFO     evaluating now!
2024-09-25 22:57:18 INFO     Epoch [13/200] train_loss: 5.4039, val_loss: 5.6656, lr: 0.003000, 6.17s
2024-09-25 22:57:18 INFO     Saved model at 13
2024-09-25 22:57:18 INFO     Val loss decrease from 5.8419 to 5.6656, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-25 22:57:24 INFO     epoch complete!
2024-09-25 22:57:24 INFO     evaluating now!
2024-09-25 22:57:24 INFO     Epoch [14/200] train_loss: 5.3616, val_loss: 5.8041, lr: 0.003000, 6.32s
2024-09-25 22:57:30 INFO     epoch complete!
2024-09-25 22:57:30 INFO     evaluating now!
2024-09-25 22:57:31 INFO     Epoch [15/200] train_loss: 5.2906, val_loss: 5.4871, lr: 0.003000, 6.15s
2024-09-25 22:57:31 INFO     Saved model at 15
2024-09-25 22:57:31 INFO     Val loss decrease from 5.6656 to 5.4871, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-25 22:57:36 INFO     epoch complete!
2024-09-25 22:57:36 INFO     evaluating now!
2024-09-25 22:57:37 INFO     Epoch [16/200] train_loss: 5.1107, val_loss: 5.5481, lr: 0.003000, 6.13s
2024-09-25 22:57:43 INFO     epoch complete!
2024-09-25 22:57:43 INFO     evaluating now!
2024-09-25 22:57:43 INFO     Epoch [17/200] train_loss: 5.0638, val_loss: 5.6115, lr: 0.003000, 6.15s
2024-09-25 22:57:49 INFO     epoch complete!
2024-09-25 22:57:49 INFO     evaluating now!
2024-09-25 22:57:49 INFO     Epoch [18/200] train_loss: 5.0129, val_loss: 5.5262, lr: 0.003000, 6.13s
2024-09-25 22:57:55 INFO     epoch complete!
2024-09-25 22:57:55 INFO     evaluating now!
2024-09-25 22:57:55 INFO     Epoch [19/200] train_loss: 4.9494, val_loss: 5.4175, lr: 0.003000, 6.11s
2024-09-25 22:57:55 INFO     Saved model at 19
2024-09-25 22:57:55 INFO     Val loss decrease from 5.4871 to 5.4175, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-25 22:58:01 INFO     epoch complete!
2024-09-25 22:58:01 INFO     evaluating now!
2024-09-25 22:58:02 INFO     Epoch [20/200] train_loss: 4.8641, val_loss: 5.3007, lr: 0.003000, 6.28s
2024-09-25 22:58:02 INFO     Saved model at 20
2024-09-25 22:58:02 INFO     Val loss decrease from 5.4175 to 5.3007, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-25 22:58:07 INFO     epoch complete!
2024-09-25 22:58:07 INFO     evaluating now!
2024-09-25 22:58:08 INFO     Epoch [21/200] train_loss: 4.7689, val_loss: 5.3158, lr: 0.003000, 6.23s
2024-09-25 22:58:14 INFO     epoch complete!
2024-09-25 22:58:14 INFO     evaluating now!
2024-09-25 22:58:14 INFO     Epoch [22/200] train_loss: 4.7336, val_loss: 5.2694, lr: 0.003000, 6.35s
2024-09-25 22:58:14 INFO     Saved model at 22
2024-09-25 22:58:14 INFO     Val loss decrease from 5.3007 to 5.2694, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-25 22:58:20 INFO     epoch complete!
2024-09-25 22:58:20 INFO     evaluating now!
2024-09-25 22:58:21 INFO     Epoch [23/200] train_loss: 4.6524, val_loss: 5.3612, lr: 0.003000, 6.33s
2024-09-25 22:58:26 INFO     epoch complete!
2024-09-25 22:58:26 INFO     evaluating now!
2024-09-25 22:58:27 INFO     Epoch [24/200] train_loss: 4.5352, val_loss: 5.3590, lr: 0.003000, 6.15s
2024-09-25 22:58:33 INFO     epoch complete!
2024-09-25 22:58:33 INFO     evaluating now!
2024-09-25 22:58:33 INFO     Epoch [25/200] train_loss: 4.5721, val_loss: 5.2677, lr: 0.003000, 6.29s
2024-09-25 22:58:33 INFO     Saved model at 25
2024-09-25 22:58:33 INFO     Val loss decrease from 5.2694 to 5.2677, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-25 22:58:39 INFO     epoch complete!
2024-09-25 22:58:39 INFO     evaluating now!
2024-09-25 22:58:40 INFO     Epoch [26/200] train_loss: 4.4685, val_loss: 5.3521, lr: 0.003000, 6.45s
2024-09-25 22:58:46 INFO     epoch complete!
2024-09-25 22:58:46 INFO     evaluating now!
2024-09-25 22:58:46 INFO     Epoch [27/200] train_loss: 4.4284, val_loss: 5.1378, lr: 0.003000, 6.60s
2024-09-25 22:58:46 INFO     Saved model at 27
2024-09-25 22:58:46 INFO     Val loss decrease from 5.2677 to 5.1378, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-25 22:58:52 INFO     epoch complete!
2024-09-25 22:58:52 INFO     evaluating now!
2024-09-25 22:58:52 INFO     Epoch [28/200] train_loss: 4.4156, val_loss: 5.1484, lr: 0.003000, 6.14s
2024-09-25 22:58:58 INFO     epoch complete!
2024-09-25 22:58:58 INFO     evaluating now!
2024-09-25 22:58:59 INFO     Epoch [29/200] train_loss: 4.4484, val_loss: 5.3976, lr: 0.003000, 6.23s
2024-09-25 22:59:05 INFO     epoch complete!
2024-09-25 22:59:05 INFO     evaluating now!
2024-09-25 22:59:05 INFO     Epoch [30/200] train_loss: 4.3554, val_loss: 5.2621, lr: 0.003000, 6.23s
2024-09-25 22:59:11 INFO     epoch complete!
2024-09-25 22:59:11 INFO     evaluating now!
2024-09-25 22:59:11 INFO     Epoch [31/200] train_loss: 4.2913, val_loss: 5.2789, lr: 0.003000, 6.31s
2024-09-25 22:59:17 INFO     epoch complete!
2024-09-25 22:59:17 INFO     evaluating now!
2024-09-25 22:59:17 INFO     Epoch [32/200] train_loss: 4.2835, val_loss: 5.1783, lr: 0.003000, 6.26s
2024-09-25 22:59:23 INFO     epoch complete!
2024-09-25 22:59:23 INFO     evaluating now!
2024-09-25 22:59:24 INFO     Epoch [33/200] train_loss: 4.1925, val_loss: 5.0908, lr: 0.003000, 6.30s
2024-09-25 22:59:24 INFO     Saved model at 33
2024-09-25 22:59:24 INFO     Val loss decrease from 5.1378 to 5.0908, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-09-25 22:59:30 INFO     epoch complete!
2024-09-25 22:59:30 INFO     evaluating now!
2024-09-25 22:59:30 INFO     Epoch [34/200] train_loss: 4.1751, val_loss: 5.2790, lr: 0.003000, 6.50s
2024-09-25 22:59:36 INFO     epoch complete!
2024-09-25 22:59:36 INFO     evaluating now!
2024-09-25 22:59:37 INFO     Epoch [35/200] train_loss: 4.1135, val_loss: 5.1917, lr: 0.003000, 6.45s
2024-09-25 22:59:43 INFO     epoch complete!
2024-09-25 22:59:43 INFO     evaluating now!
2024-09-25 22:59:43 INFO     Epoch [36/200] train_loss: 4.1171, val_loss: 5.1911, lr: 0.003000, 6.24s
2024-09-25 22:59:49 INFO     epoch complete!
2024-09-25 22:59:49 INFO     evaluating now!
2024-09-25 22:59:49 INFO     Epoch [37/200] train_loss: 4.0739, val_loss: 5.2802, lr: 0.003000, 6.27s
2024-09-25 22:59:55 INFO     epoch complete!
2024-09-25 22:59:55 INFO     evaluating now!
2024-09-25 22:59:56 INFO     Epoch [38/200] train_loss: 4.0914, val_loss: 5.3770, lr: 0.003000, 6.48s
2024-09-25 23:00:02 INFO     epoch complete!
2024-09-25 23:00:02 INFO     evaluating now!
2024-09-25 23:00:02 INFO     Epoch [39/200] train_loss: 4.0382, val_loss: 5.2176, lr: 0.003000, 6.35s
2024-09-25 23:00:08 INFO     epoch complete!
2024-09-25 23:00:08 INFO     evaluating now!
2024-09-25 23:00:08 INFO     Epoch [40/200] train_loss: 4.0566, val_loss: 5.2279, lr: 0.003000, 6.32s
2024-09-25 23:00:15 INFO     epoch complete!
2024-09-25 23:00:15 INFO     evaluating now!
2024-09-25 23:00:15 INFO     Epoch [41/200] train_loss: 3.9481, val_loss: 5.1636, lr: 0.003000, 6.53s
2024-09-25 23:00:21 INFO     epoch complete!
2024-09-25 23:00:21 INFO     evaluating now!
2024-09-25 23:00:22 INFO     Epoch [42/200] train_loss: 3.9310, val_loss: 5.2454, lr: 0.003000, 6.64s
2024-09-25 23:00:28 INFO     epoch complete!
2024-09-25 23:00:28 INFO     evaluating now!
2024-09-25 23:00:28 INFO     Epoch [43/200] train_loss: 3.9131, val_loss: 5.1236, lr: 0.003000, 6.38s
2024-09-25 23:00:34 INFO     epoch complete!
2024-09-25 23:00:34 INFO     evaluating now!
2024-09-25 23:00:35 INFO     Epoch [44/200] train_loss: 3.9081, val_loss: 5.1259, lr: 0.003000, 6.78s
2024-09-25 23:00:42 INFO     epoch complete!
2024-09-25 23:00:42 INFO     evaluating now!
2024-09-25 23:00:42 INFO     Epoch [45/200] train_loss: 3.8917, val_loss: 5.1654, lr: 0.003000, 7.21s
2024-09-25 23:00:48 INFO     epoch complete!
2024-09-25 23:00:48 INFO     evaluating now!
2024-09-25 23:00:48 INFO     Epoch [46/200] train_loss: 3.8234, val_loss: 5.3861, lr: 0.003000, 6.49s
2024-09-25 23:00:55 INFO     epoch complete!
2024-09-25 23:00:55 INFO     evaluating now!
2024-09-25 23:00:55 INFO     Epoch [47/200] train_loss: 3.8060, val_loss: 5.1197, lr: 0.003000, 6.49s
2024-09-25 23:01:01 INFO     epoch complete!
2024-09-25 23:01:01 INFO     evaluating now!
2024-09-25 23:01:02 INFO     Epoch [48/200] train_loss: 3.7663, val_loss: 5.2330, lr: 0.003000, 6.55s
2024-09-25 23:01:02 WARNING  Early stopping at epoch: 48
2024-09-25 23:01:02 INFO     Trained totally 49 epochs, average train time is 5.913s, average eval time is 0.429s
2024-09-25 23:01:02 INFO     Loaded model at 33
2024-09-25 23:01:02 INFO     Saved model at ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406.m
2024-09-25 23:01:02 INFO     Start evaluating ...
2024-09-25 23:01:03 INFO     Note that you select the single mode to evaluate!
2024-09-25 23:01:03 INFO     Evaluate result is saved at ./libcity/cache/15/evaluate_cache/2024_09_25_23_01_03_AGCRN_CHITaxi20190406.csv
2024-09-25 23:01:03 INFO     
         MAE       RMSE
1   2.288933   7.187314
2   2.349060   7.705859
3   2.561719   8.847346
4   2.712245   9.674942
5   2.829760  10.253216
6   2.938980  10.740190
7   3.010339  11.309249
8   3.134324  11.873840
9   3.177507  12.272825
10  3.136998  12.521640
11  3.228856  12.874489
12  3.406726  13.537964
2024-09-25 23:01:04 INFO     ----------------------------------------------------------------------------
2024-09-25 23:01:04 INFO     # 1, Kownledge Graph Embedding: GIE, Experiment ids: 16
2024-09-25 23:01:04 INFO     ----------------------------------------------------------------------------
2024-09-25 23:01:04 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=16
2024-09-25 23:01:04 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 16, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-25 23:01:04 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-25 23:01:04 INFO     set_weight_link_or_dist: dist
2024-09-25 23:01:04 INFO     init_weight_inf_or_zero: inf
2024-09-25 23:01:04 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-25 23:01:04 INFO     Start Calculate the weight by Gauss kernel!
2024-09-25 23:01:04 INFO     Loading file CHITaxi20190406.dyna
2024-09-25 23:01:04 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-25 23:01:07 INFO     Dataset created
2024-09-25 23:01:07 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-25 23:01:07 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-25 23:01:07 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-25 23:01:07 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-25 23:01:08 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-25 23:01:08 INFO     NoneScaler
2024-09-25 23:01:11 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-25 23:01:11 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-25 23:01:11 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-25 23:01:11 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-25 23:01:11 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-25 23:01:11 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-25 23:01:11 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-25 23:01:11 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-25 23:01:11 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-25 23:01:11 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-25 23:01:11 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-25 23:01:11 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-25 23:01:11 INFO     Total parameter numbers: 874010
2024-09-25 23:01:11 INFO     You select `adam` optimizer.
2024-09-25 23:01:11 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-25 23:01:11 INFO     Start training ...
2024-09-25 23:01:11 INFO     num_batches:48
2024-09-25 23:01:17 INFO     epoch complete!
2024-09-25 23:01:17 INFO     evaluating now!
2024-09-25 23:01:17 INFO     Epoch [0/200] train_loss: 23.7506, val_loss: 17.6260, lr: 0.003000, 6.94s
2024-09-25 23:01:18 INFO     Saved model at 0
2024-09-25 23:01:18 INFO     Val loss decrease from inf to 17.6260, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-25 23:01:24 INFO     epoch complete!
2024-09-25 23:01:24 INFO     evaluating now!
2024-09-25 23:01:24 INFO     Epoch [1/200] train_loss: 14.0613, val_loss: 13.2198, lr: 0.003000, 6.66s
2024-09-25 23:01:24 INFO     Saved model at 1
2024-09-25 23:01:24 INFO     Val loss decrease from 17.6260 to 13.2198, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-25 23:01:31 INFO     epoch complete!
2024-09-25 23:01:31 INFO     evaluating now!
2024-09-25 23:01:31 INFO     Epoch [2/200] train_loss: 10.8777, val_loss: 10.4265, lr: 0.003000, 6.78s
2024-09-25 23:01:31 INFO     Saved model at 2
2024-09-25 23:01:31 INFO     Val loss decrease from 13.2198 to 10.4265, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-25 23:01:37 INFO     epoch complete!
2024-09-25 23:01:37 INFO     evaluating now!
2024-09-25 23:01:38 INFO     Epoch [3/200] train_loss: 9.2649, val_loss: 9.0647, lr: 0.003000, 6.56s
2024-09-25 23:01:38 INFO     Saved model at 3
2024-09-25 23:01:38 INFO     Val loss decrease from 10.4265 to 9.0647, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-25 23:01:44 INFO     epoch complete!
2024-09-25 23:01:44 INFO     evaluating now!
2024-09-25 23:01:44 INFO     Epoch [4/200] train_loss: 8.1036, val_loss: 7.6405, lr: 0.003000, 6.65s
2024-09-25 23:01:44 INFO     Saved model at 4
2024-09-25 23:01:44 INFO     Val loss decrease from 9.0647 to 7.6405, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-25 23:01:51 INFO     epoch complete!
2024-09-25 23:01:51 INFO     evaluating now!
2024-09-25 23:01:51 INFO     Epoch [5/200] train_loss: 7.3417, val_loss: 7.1431, lr: 0.003000, 6.61s
2024-09-25 23:01:51 INFO     Saved model at 5
2024-09-25 23:01:51 INFO     Val loss decrease from 7.6405 to 7.1431, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-25 23:01:57 INFO     epoch complete!
2024-09-25 23:01:57 INFO     evaluating now!
2024-09-25 23:01:58 INFO     Epoch [6/200] train_loss: 6.8905, val_loss: 6.8767, lr: 0.003000, 6.75s
2024-09-25 23:01:58 INFO     Saved model at 6
2024-09-25 23:01:58 INFO     Val loss decrease from 7.1431 to 6.8767, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-25 23:02:04 INFO     epoch complete!
2024-09-25 23:02:04 INFO     evaluating now!
2024-09-25 23:02:05 INFO     Epoch [7/200] train_loss: 6.5603, val_loss: 6.5909, lr: 0.003000, 6.94s
2024-09-25 23:02:05 INFO     Saved model at 7
2024-09-25 23:02:05 INFO     Val loss decrease from 6.8767 to 6.5909, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-25 23:02:11 INFO     epoch complete!
2024-09-25 23:02:11 INFO     evaluating now!
2024-09-25 23:02:12 INFO     Epoch [8/200] train_loss: 6.2869, val_loss: 6.3302, lr: 0.003000, 6.72s
2024-09-25 23:02:12 INFO     Saved model at 8
2024-09-25 23:02:12 INFO     Val loss decrease from 6.5909 to 6.3302, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-25 23:02:18 INFO     epoch complete!
2024-09-25 23:02:18 INFO     evaluating now!
2024-09-25 23:02:18 INFO     Epoch [9/200] train_loss: 6.1472, val_loss: 5.9925, lr: 0.003000, 6.64s
2024-09-25 23:02:19 INFO     Saved model at 9
2024-09-25 23:02:19 INFO     Val loss decrease from 6.3302 to 5.9925, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-25 23:02:25 INFO     epoch complete!
2024-09-25 23:02:25 INFO     evaluating now!
2024-09-25 23:02:25 INFO     Epoch [10/200] train_loss: 5.8036, val_loss: 6.2886, lr: 0.003000, 6.46s
2024-09-25 23:02:31 INFO     epoch complete!
2024-09-25 23:02:31 INFO     evaluating now!
2024-09-25 23:02:32 INFO     Epoch [11/200] train_loss: 5.6645, val_loss: 5.8644, lr: 0.003000, 6.56s
2024-09-25 23:02:32 INFO     Saved model at 11
2024-09-25 23:02:32 INFO     Val loss decrease from 5.9925 to 5.8644, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-25 23:02:38 INFO     epoch complete!
2024-09-25 23:02:38 INFO     evaluating now!
2024-09-25 23:02:38 INFO     Epoch [12/200] train_loss: 5.5419, val_loss: 5.7579, lr: 0.003000, 6.55s
2024-09-25 23:02:38 INFO     Saved model at 12
2024-09-25 23:02:38 INFO     Val loss decrease from 5.8644 to 5.7579, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-25 23:02:45 INFO     epoch complete!
2024-09-25 23:02:45 INFO     evaluating now!
2024-09-25 23:02:45 INFO     Epoch [13/200] train_loss: 5.3293, val_loss: 5.7978, lr: 0.003000, 6.63s
2024-09-25 23:02:51 INFO     epoch complete!
2024-09-25 23:02:51 INFO     evaluating now!
2024-09-25 23:02:51 INFO     Epoch [14/200] train_loss: 5.3025, val_loss: 5.6151, lr: 0.003000, 6.49s
2024-09-25 23:02:52 INFO     Saved model at 14
2024-09-25 23:02:52 INFO     Val loss decrease from 5.7579 to 5.6151, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-25 23:02:58 INFO     epoch complete!
2024-09-25 23:02:58 INFO     evaluating now!
2024-09-25 23:02:58 INFO     Epoch [15/200] train_loss: 5.1736, val_loss: 5.3634, lr: 0.003000, 6.39s
2024-09-25 23:02:58 INFO     Saved model at 15
2024-09-25 23:02:58 INFO     Val loss decrease from 5.6151 to 5.3634, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-25 23:03:04 INFO     epoch complete!
2024-09-25 23:03:04 INFO     evaluating now!
2024-09-25 23:03:05 INFO     Epoch [16/200] train_loss: 5.0894, val_loss: 5.5459, lr: 0.003000, 6.54s
2024-09-25 23:03:11 INFO     epoch complete!
2024-09-25 23:03:11 INFO     evaluating now!
2024-09-25 23:03:11 INFO     Epoch [17/200] train_loss: 4.9918, val_loss: 5.5808, lr: 0.003000, 6.35s
2024-09-25 23:03:17 INFO     epoch complete!
2024-09-25 23:03:17 INFO     evaluating now!
2024-09-25 23:03:17 INFO     Epoch [18/200] train_loss: 4.9687, val_loss: 5.5168, lr: 0.003000, 6.54s
2024-09-25 23:03:24 INFO     epoch complete!
2024-09-25 23:03:24 INFO     evaluating now!
2024-09-25 23:03:24 INFO     Epoch [19/200] train_loss: 4.9125, val_loss: 5.3590, lr: 0.003000, 6.66s
2024-09-25 23:03:24 INFO     Saved model at 19
2024-09-25 23:03:24 INFO     Val loss decrease from 5.3634 to 5.3590, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-25 23:03:30 INFO     epoch complete!
2024-09-25 23:03:30 INFO     evaluating now!
2024-09-25 23:03:31 INFO     Epoch [20/200] train_loss: 4.7855, val_loss: 5.3535, lr: 0.003000, 6.54s
2024-09-25 23:03:31 INFO     Saved model at 20
2024-09-25 23:03:31 INFO     Val loss decrease from 5.3590 to 5.3535, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-25 23:03:37 INFO     epoch complete!
2024-09-25 23:03:37 INFO     evaluating now!
2024-09-25 23:03:37 INFO     Epoch [21/200] train_loss: 4.7290, val_loss: 5.3010, lr: 0.003000, 6.53s
2024-09-25 23:03:38 INFO     Saved model at 21
2024-09-25 23:03:38 INFO     Val loss decrease from 5.3535 to 5.3010, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-25 23:03:44 INFO     epoch complete!
2024-09-25 23:03:44 INFO     evaluating now!
2024-09-25 23:03:44 INFO     Epoch [22/200] train_loss: 4.6559, val_loss: 5.2161, lr: 0.003000, 6.40s
2024-09-25 23:03:44 INFO     Saved model at 22
2024-09-25 23:03:44 INFO     Val loss decrease from 5.3010 to 5.2161, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-25 23:03:50 INFO     epoch complete!
2024-09-25 23:03:50 INFO     evaluating now!
2024-09-25 23:03:50 INFO     Epoch [23/200] train_loss: 4.6111, val_loss: 5.2476, lr: 0.003000, 6.30s
2024-09-25 23:03:57 INFO     epoch complete!
2024-09-25 23:03:57 INFO     evaluating now!
2024-09-25 23:03:57 INFO     Epoch [24/200] train_loss: 4.5537, val_loss: 5.0627, lr: 0.003000, 6.66s
2024-09-25 23:03:57 INFO     Saved model at 24
2024-09-25 23:03:57 INFO     Val loss decrease from 5.2161 to 5.0627, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-25 23:04:03 INFO     epoch complete!
2024-09-25 23:04:03 INFO     evaluating now!
2024-09-25 23:04:04 INFO     Epoch [25/200] train_loss: 4.4865, val_loss: 5.0663, lr: 0.003000, 6.48s
2024-09-25 23:04:10 INFO     epoch complete!
2024-09-25 23:04:10 INFO     evaluating now!
2024-09-25 23:04:10 INFO     Epoch [26/200] train_loss: 4.5073, val_loss: 5.2513, lr: 0.003000, 6.54s
2024-09-25 23:04:16 INFO     epoch complete!
2024-09-25 23:04:16 INFO     evaluating now!
2024-09-25 23:04:17 INFO     Epoch [27/200] train_loss: 4.4250, val_loss: 5.2569, lr: 0.003000, 6.42s
2024-09-25 23:04:23 INFO     epoch complete!
2024-09-25 23:04:23 INFO     evaluating now!
2024-09-25 23:04:23 INFO     Epoch [28/200] train_loss: 4.4257, val_loss: 5.1847, lr: 0.003000, 6.55s
2024-09-25 23:04:29 INFO     epoch complete!
2024-09-25 23:04:29 INFO     evaluating now!
2024-09-25 23:04:29 INFO     Epoch [29/200] train_loss: 4.3813, val_loss: 5.1910, lr: 0.003000, 6.42s
2024-09-25 23:04:36 INFO     epoch complete!
2024-09-25 23:04:36 INFO     evaluating now!
2024-09-25 23:04:36 INFO     Epoch [30/200] train_loss: 4.3275, val_loss: 5.2864, lr: 0.003000, 6.60s
2024-09-25 23:04:43 INFO     epoch complete!
2024-09-25 23:04:43 INFO     evaluating now!
2024-09-25 23:04:43 INFO     Epoch [31/200] train_loss: 4.2958, val_loss: 5.2690, lr: 0.003000, 7.32s
2024-09-25 23:04:50 INFO     epoch complete!
2024-09-25 23:04:50 INFO     evaluating now!
2024-09-25 23:04:51 INFO     Epoch [32/200] train_loss: 4.2432, val_loss: 5.1813, lr: 0.003000, 7.19s
2024-09-25 23:04:57 INFO     epoch complete!
2024-09-25 23:04:57 INFO     evaluating now!
2024-09-25 23:04:57 INFO     Epoch [33/200] train_loss: 4.2477, val_loss: 5.2915, lr: 0.003000, 6.72s
2024-09-25 23:05:04 INFO     epoch complete!
2024-09-25 23:05:04 INFO     evaluating now!
2024-09-25 23:05:04 INFO     Epoch [34/200] train_loss: 4.1753, val_loss: 5.1777, lr: 0.003000, 6.69s
2024-09-25 23:05:10 INFO     epoch complete!
2024-09-25 23:05:10 INFO     evaluating now!
2024-09-25 23:05:10 INFO     Epoch [35/200] train_loss: 4.1842, val_loss: 5.0685, lr: 0.003000, 6.48s
2024-09-25 23:05:17 INFO     epoch complete!
2024-09-25 23:05:17 INFO     evaluating now!
2024-09-25 23:05:17 INFO     Epoch [36/200] train_loss: 4.1701, val_loss: 5.3310, lr: 0.003000, 6.53s
2024-09-25 23:05:23 INFO     epoch complete!
2024-09-25 23:05:23 INFO     evaluating now!
2024-09-25 23:05:23 INFO     Epoch [37/200] train_loss: 4.1017, val_loss: 5.0123, lr: 0.003000, 6.41s
2024-09-25 23:05:24 INFO     Saved model at 37
2024-09-25 23:05:24 INFO     Val loss decrease from 5.0627 to 5.0123, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-09-25 23:05:29 INFO     epoch complete!
2024-09-25 23:05:29 INFO     evaluating now!
2024-09-25 23:05:30 INFO     Epoch [38/200] train_loss: 4.0893, val_loss: 5.4202, lr: 0.003000, 6.40s
2024-09-25 23:05:36 INFO     epoch complete!
2024-09-25 23:05:36 INFO     evaluating now!
2024-09-25 23:05:36 INFO     Epoch [39/200] train_loss: 4.0377, val_loss: 5.0690, lr: 0.003000, 6.52s
2024-09-25 23:05:43 INFO     epoch complete!
2024-09-25 23:05:43 INFO     evaluating now!
2024-09-25 23:05:43 INFO     Epoch [40/200] train_loss: 3.9832, val_loss: 5.2144, lr: 0.003000, 6.55s
2024-09-25 23:05:49 INFO     epoch complete!
2024-09-25 23:05:49 INFO     evaluating now!
2024-09-25 23:05:49 INFO     Epoch [41/200] train_loss: 3.9874, val_loss: 5.1041, lr: 0.003000, 6.48s
2024-09-25 23:05:56 INFO     epoch complete!
2024-09-25 23:05:56 INFO     evaluating now!
2024-09-25 23:05:56 INFO     Epoch [42/200] train_loss: 3.9961, val_loss: 5.1210, lr: 0.003000, 6.73s
2024-09-25 23:06:03 INFO     epoch complete!
2024-09-25 23:06:03 INFO     evaluating now!
2024-09-25 23:06:03 INFO     Epoch [43/200] train_loss: 3.9463, val_loss: 5.1646, lr: 0.003000, 6.80s
2024-09-25 23:06:09 INFO     epoch complete!
2024-09-25 23:06:09 INFO     evaluating now!
2024-09-25 23:06:10 INFO     Epoch [44/200] train_loss: 3.9455, val_loss: 4.9512, lr: 0.003000, 6.59s
2024-09-25 23:06:10 INFO     Saved model at 44
2024-09-25 23:06:10 INFO     Val loss decrease from 5.0123 to 4.9512, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-09-25 23:06:16 INFO     epoch complete!
2024-09-25 23:06:16 INFO     evaluating now!
2024-09-25 23:06:16 INFO     Epoch [45/200] train_loss: 3.8753, val_loss: 4.9905, lr: 0.003000, 6.56s
2024-09-25 23:06:22 INFO     epoch complete!
2024-09-25 23:06:22 INFO     evaluating now!
2024-09-25 23:06:23 INFO     Epoch [46/200] train_loss: 3.8329, val_loss: 5.1710, lr: 0.003000, 6.42s
2024-09-25 23:06:29 INFO     epoch complete!
2024-09-25 23:06:29 INFO     evaluating now!
2024-09-25 23:06:29 INFO     Epoch [47/200] train_loss: 3.8283, val_loss: 5.0414, lr: 0.003000, 6.83s
2024-09-25 23:06:36 INFO     epoch complete!
2024-09-25 23:06:36 INFO     evaluating now!
2024-09-25 23:06:37 INFO     Epoch [48/200] train_loss: 3.8268, val_loss: 5.0357, lr: 0.003000, 7.15s
2024-09-25 23:06:43 INFO     epoch complete!
2024-09-25 23:06:43 INFO     evaluating now!
2024-09-25 23:06:44 INFO     Epoch [49/200] train_loss: 3.7848, val_loss: 5.1718, lr: 0.003000, 7.21s
2024-09-25 23:06:51 INFO     epoch complete!
2024-09-25 23:06:51 INFO     evaluating now!
2024-09-25 23:06:51 INFO     Epoch [50/200] train_loss: 3.7714, val_loss: 5.1132, lr: 0.003000, 7.15s
2024-09-25 23:06:58 INFO     epoch complete!
2024-09-25 23:06:58 INFO     evaluating now!
2024-09-25 23:06:58 INFO     Epoch [51/200] train_loss: 3.7712, val_loss: 5.0905, lr: 0.003000, 7.25s
2024-09-25 23:07:05 INFO     epoch complete!
2024-09-25 23:07:05 INFO     evaluating now!
2024-09-25 23:07:05 INFO     Epoch [52/200] train_loss: 3.7696, val_loss: 5.0539, lr: 0.003000, 7.19s
2024-09-25 23:07:12 INFO     epoch complete!
2024-09-25 23:07:12 INFO     evaluating now!
2024-09-25 23:07:13 INFO     Epoch [53/200] train_loss: 3.7065, val_loss: 5.0921, lr: 0.003000, 7.24s
2024-09-25 23:07:19 INFO     epoch complete!
2024-09-25 23:07:19 INFO     evaluating now!
2024-09-25 23:07:19 INFO     Epoch [54/200] train_loss: 3.7057, val_loss: 5.0120, lr: 0.003000, 6.71s
2024-09-25 23:07:26 INFO     epoch complete!
2024-09-25 23:07:26 INFO     evaluating now!
2024-09-25 23:07:26 INFO     Epoch [55/200] train_loss: 3.6742, val_loss: 5.1603, lr: 0.003000, 6.56s
2024-09-25 23:07:32 INFO     epoch complete!
2024-09-25 23:07:32 INFO     evaluating now!
2024-09-25 23:07:32 INFO     Epoch [56/200] train_loss: 3.6903, val_loss: 5.2359, lr: 0.003000, 6.55s
2024-09-25 23:07:38 INFO     epoch complete!
2024-09-25 23:07:38 INFO     evaluating now!
2024-09-25 23:07:39 INFO     Epoch [57/200] train_loss: 3.6417, val_loss: 5.1175, lr: 0.003000, 6.43s
2024-09-25 23:07:45 INFO     epoch complete!
2024-09-25 23:07:45 INFO     evaluating now!
2024-09-25 23:07:45 INFO     Epoch [58/200] train_loss: 3.6370, val_loss: 5.0387, lr: 0.003000, 6.31s
2024-09-25 23:07:51 INFO     epoch complete!
2024-09-25 23:07:51 INFO     evaluating now!
2024-09-25 23:07:52 INFO     Epoch [59/200] train_loss: 3.6282, val_loss: 5.0361, lr: 0.003000, 6.30s
2024-09-25 23:07:52 WARNING  Early stopping at epoch: 59
2024-09-25 23:07:52 INFO     Trained totally 60 epochs, average train time is 6.202s, average eval time is 0.449s
2024-09-25 23:07:52 INFO     Loaded model at 44
2024-09-25 23:07:52 INFO     Saved model at ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406.m
2024-09-25 23:07:52 INFO     Start evaluating ...
2024-09-25 23:07:54 INFO     Note that you select the single mode to evaluate!
2024-09-25 23:07:54 INFO     Evaluate result is saved at ./libcity/cache/16/evaluate_cache/2024_09_25_23_07_54_AGCRN_CHITaxi20190406.csv
2024-09-25 23:07:54 INFO     
         MAE       RMSE
1   2.536596   8.560772
2   2.624149   8.709172
3   2.745919   9.225882
4   2.821366   9.712431
5   2.946148  10.311742
6   3.027572  11.003147
7   3.109092  11.652209
8   3.179107  12.212243
9   3.274436  12.464430
10  3.320521  13.158771
11  3.438914  13.752385
12  3.610340  14.651177
2024-09-25 23:07:54 INFO     ----------------------------------------------------------------------------
2024-09-25 23:07:54 INFO     # 2, Kownledge Graph Embedding: GIE, Experiment ids: 17
2024-09-25 23:07:54 INFO     ----------------------------------------------------------------------------
2024-09-25 23:07:54 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=17
2024-09-25 23:07:54 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 17, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-25 23:07:54 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-25 23:07:54 INFO     set_weight_link_or_dist: dist
2024-09-25 23:07:54 INFO     init_weight_inf_or_zero: inf
2024-09-25 23:07:54 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-25 23:07:54 INFO     Start Calculate the weight by Gauss kernel!
2024-09-25 23:07:54 INFO     Loading file CHITaxi20190406.dyna
2024-09-25 23:07:54 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-25 23:07:58 INFO     Dataset created
2024-09-25 23:07:58 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-25 23:07:58 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-25 23:07:58 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-25 23:07:58 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-25 23:07:58 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-25 23:07:58 INFO     NoneScaler
2024-09-25 23:08:01 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-25 23:08:01 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-25 23:08:01 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-25 23:08:01 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-25 23:08:01 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-25 23:08:01 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-25 23:08:01 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-25 23:08:01 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-25 23:08:01 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-25 23:08:01 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-25 23:08:01 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-25 23:08:01 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-25 23:08:01 INFO     Total parameter numbers: 874010
2024-09-25 23:08:01 INFO     You select `adam` optimizer.
2024-09-25 23:08:01 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-25 23:08:01 INFO     Start training ...
2024-09-25 23:08:01 INFO     num_batches:48
2024-09-25 23:08:07 INFO     epoch complete!
2024-09-25 23:08:07 INFO     evaluating now!
2024-09-25 23:08:08 INFO     Epoch [0/200] train_loss: 24.4921, val_loss: 18.2050, lr: 0.003000, 6.78s
2024-09-25 23:08:08 INFO     Saved model at 0
2024-09-25 23:08:08 INFO     Val loss decrease from inf to 18.2050, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-25 23:08:14 INFO     epoch complete!
2024-09-25 23:08:14 INFO     evaluating now!
2024-09-25 23:08:15 INFO     Epoch [1/200] train_loss: 15.2222, val_loss: 14.8350, lr: 0.003000, 6.72s
2024-09-25 23:08:15 INFO     Saved model at 1
2024-09-25 23:08:15 INFO     Val loss decrease from 18.2050 to 14.8350, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-25 23:08:21 INFO     epoch complete!
2024-09-25 23:08:21 INFO     evaluating now!
2024-09-25 23:08:22 INFO     Epoch [2/200] train_loss: 12.4315, val_loss: 11.6918, lr: 0.003000, 7.05s
2024-09-25 23:08:22 INFO     Saved model at 2
2024-09-25 23:08:22 INFO     Val loss decrease from 14.8350 to 11.6918, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-25 23:08:28 INFO     epoch complete!
2024-09-25 23:08:28 INFO     evaluating now!
2024-09-25 23:08:29 INFO     Epoch [3/200] train_loss: 9.8103, val_loss: 9.2099, lr: 0.003000, 6.83s
2024-09-25 23:08:29 INFO     Saved model at 3
2024-09-25 23:08:29 INFO     Val loss decrease from 11.6918 to 9.2099, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-25 23:08:36 INFO     epoch complete!
2024-09-25 23:08:36 INFO     evaluating now!
2024-09-25 23:08:36 INFO     Epoch [4/200] train_loss: 8.2969, val_loss: 8.1292, lr: 0.003000, 7.05s
2024-09-25 23:08:36 INFO     Saved model at 4
2024-09-25 23:08:36 INFO     Val loss decrease from 9.2099 to 8.1292, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-25 23:08:42 INFO     epoch complete!
2024-09-25 23:08:42 INFO     evaluating now!
2024-09-25 23:08:43 INFO     Epoch [5/200] train_loss: 7.4036, val_loss: 7.2043, lr: 0.003000, 6.76s
2024-09-25 23:08:43 INFO     Saved model at 5
2024-09-25 23:08:43 INFO     Val loss decrease from 8.1292 to 7.2043, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-25 23:08:50 INFO     epoch complete!
2024-09-25 23:08:50 INFO     evaluating now!
2024-09-25 23:08:50 INFO     Epoch [6/200] train_loss: 6.9168, val_loss: 6.6440, lr: 0.003000, 6.92s
2024-09-25 23:08:50 INFO     Saved model at 6
2024-09-25 23:08:50 INFO     Val loss decrease from 7.2043 to 6.6440, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-25 23:08:57 INFO     epoch complete!
2024-09-25 23:08:57 INFO     evaluating now!
2024-09-25 23:08:57 INFO     Epoch [7/200] train_loss: 6.3698, val_loss: 6.8337, lr: 0.003000, 6.93s
2024-09-25 23:09:04 INFO     epoch complete!
2024-09-25 23:09:04 INFO     evaluating now!
2024-09-25 23:09:04 INFO     Epoch [8/200] train_loss: 6.0754, val_loss: 6.5069, lr: 0.003000, 6.88s
2024-09-25 23:09:04 INFO     Saved model at 8
2024-09-25 23:09:04 INFO     Val loss decrease from 6.6440 to 6.5069, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-25 23:09:11 INFO     epoch complete!
2024-09-25 23:09:11 INFO     evaluating now!
2024-09-25 23:09:11 INFO     Epoch [9/200] train_loss: 5.8445, val_loss: 5.9010, lr: 0.003000, 6.90s
2024-09-25 23:09:11 INFO     Saved model at 9
2024-09-25 23:09:11 INFO     Val loss decrease from 6.5069 to 5.9010, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-25 23:09:17 INFO     epoch complete!
2024-09-25 23:09:17 INFO     evaluating now!
2024-09-25 23:09:18 INFO     Epoch [10/200] train_loss: 5.6686, val_loss: 5.7457, lr: 0.003000, 6.74s
2024-09-25 23:09:18 INFO     Saved model at 10
2024-09-25 23:09:18 INFO     Val loss decrease from 5.9010 to 5.7457, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-25 23:09:24 INFO     epoch complete!
2024-09-25 23:09:24 INFO     evaluating now!
2024-09-25 23:09:25 INFO     Epoch [11/200] train_loss: 5.5511, val_loss: 5.7594, lr: 0.003000, 6.93s
2024-09-25 23:09:31 INFO     epoch complete!
2024-09-25 23:09:31 INFO     evaluating now!
2024-09-25 23:09:32 INFO     Epoch [12/200] train_loss: 5.3824, val_loss: 5.5922, lr: 0.003000, 6.94s
2024-09-25 23:09:32 INFO     Saved model at 12
2024-09-25 23:09:32 INFO     Val loss decrease from 5.7457 to 5.5922, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-25 23:09:38 INFO     epoch complete!
2024-09-25 23:09:38 INFO     evaluating now!
2024-09-25 23:09:39 INFO     Epoch [13/200] train_loss: 5.2508, val_loss: 5.7379, lr: 0.003000, 6.80s
2024-09-25 23:09:45 INFO     epoch complete!
2024-09-25 23:09:45 INFO     evaluating now!
2024-09-25 23:09:45 INFO     Epoch [14/200] train_loss: 5.2071, val_loss: 5.6487, lr: 0.003000, 6.56s
2024-09-25 23:09:52 INFO     epoch complete!
2024-09-25 23:09:52 INFO     evaluating now!
2024-09-25 23:09:52 INFO     Epoch [15/200] train_loss: 5.1827, val_loss: 5.5674, lr: 0.003000, 6.89s
2024-09-25 23:09:52 INFO     Saved model at 15
2024-09-25 23:09:52 INFO     Val loss decrease from 5.5922 to 5.5674, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-25 23:09:59 INFO     epoch complete!
2024-09-25 23:09:59 INFO     evaluating now!
2024-09-25 23:09:59 INFO     Epoch [16/200] train_loss: 5.0155, val_loss: 5.4166, lr: 0.003000, 6.86s
2024-09-25 23:09:59 INFO     Saved model at 16
2024-09-25 23:09:59 INFO     Val loss decrease from 5.5674 to 5.4166, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-25 23:10:06 INFO     epoch complete!
2024-09-25 23:10:06 INFO     evaluating now!
2024-09-25 23:10:06 INFO     Epoch [17/200] train_loss: 4.8676, val_loss: 5.4235, lr: 0.003000, 6.81s
2024-09-25 23:10:12 INFO     epoch complete!
2024-09-25 23:10:12 INFO     evaluating now!
2024-09-25 23:10:13 INFO     Epoch [18/200] train_loss: 4.7760, val_loss: 5.6051, lr: 0.003000, 6.62s
2024-09-25 23:10:19 INFO     epoch complete!
2024-09-25 23:10:19 INFO     evaluating now!
2024-09-25 23:10:19 INFO     Epoch [19/200] train_loss: 4.8230, val_loss: 5.3947, lr: 0.003000, 6.62s
2024-09-25 23:10:19 INFO     Saved model at 19
2024-09-25 23:10:19 INFO     Val loss decrease from 5.4166 to 5.3947, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-25 23:10:26 INFO     epoch complete!
2024-09-25 23:10:26 INFO     evaluating now!
2024-09-25 23:10:26 INFO     Epoch [20/200] train_loss: 4.7533, val_loss: 5.4067, lr: 0.003000, 6.78s
2024-09-25 23:10:33 INFO     epoch complete!
2024-09-25 23:10:33 INFO     evaluating now!
2024-09-25 23:10:33 INFO     Epoch [21/200] train_loss: 4.6330, val_loss: 5.3044, lr: 0.003000, 6.96s
2024-09-25 23:10:33 INFO     Saved model at 21
2024-09-25 23:10:33 INFO     Val loss decrease from 5.3947 to 5.3044, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-25 23:10:39 INFO     epoch complete!
2024-09-25 23:10:39 INFO     evaluating now!
2024-09-25 23:10:40 INFO     Epoch [22/200] train_loss: 4.6557, val_loss: 5.3906, lr: 0.003000, 6.66s
2024-09-25 23:10:46 INFO     epoch complete!
2024-09-25 23:10:46 INFO     evaluating now!
2024-09-25 23:10:46 INFO     Epoch [23/200] train_loss: 4.5945, val_loss: 5.3319, lr: 0.003000, 6.69s
2024-09-25 23:10:53 INFO     epoch complete!
2024-09-25 23:10:53 INFO     evaluating now!
2024-09-25 23:10:53 INFO     Epoch [24/200] train_loss: 4.4995, val_loss: 5.3693, lr: 0.003000, 6.82s
2024-09-25 23:11:00 INFO     epoch complete!
2024-09-25 23:11:00 INFO     evaluating now!
2024-09-25 23:11:00 INFO     Epoch [25/200] train_loss: 4.4810, val_loss: 5.3768, lr: 0.003000, 7.03s
2024-09-25 23:11:07 INFO     epoch complete!
2024-09-25 23:11:07 INFO     evaluating now!
2024-09-25 23:11:07 INFO     Epoch [26/200] train_loss: 4.3877, val_loss: 5.2068, lr: 0.003000, 6.99s
2024-09-25 23:11:07 INFO     Saved model at 26
2024-09-25 23:11:07 INFO     Val loss decrease from 5.3044 to 5.2068, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-25 23:11:14 INFO     epoch complete!
2024-09-25 23:11:14 INFO     evaluating now!
2024-09-25 23:11:14 INFO     Epoch [27/200] train_loss: 4.2998, val_loss: 5.1002, lr: 0.003000, 6.99s
2024-09-25 23:11:14 INFO     Saved model at 27
2024-09-25 23:11:14 INFO     Val loss decrease from 5.2068 to 5.1002, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-25 23:11:21 INFO     epoch complete!
2024-09-25 23:11:21 INFO     evaluating now!
2024-09-25 23:11:22 INFO     Epoch [28/200] train_loss: 4.2468, val_loss: 5.3775, lr: 0.003000, 7.15s
2024-09-25 23:11:28 INFO     epoch complete!
2024-09-25 23:11:28 INFO     evaluating now!
2024-09-25 23:11:28 INFO     Epoch [29/200] train_loss: 4.2550, val_loss: 5.2903, lr: 0.003000, 6.94s
2024-09-25 23:11:35 INFO     epoch complete!
2024-09-25 23:11:35 INFO     evaluating now!
2024-09-25 23:11:35 INFO     Epoch [30/200] train_loss: 4.1980, val_loss: 5.2656, lr: 0.003000, 6.71s
2024-09-25 23:11:42 INFO     epoch complete!
2024-09-25 23:11:42 INFO     evaluating now!
2024-09-25 23:11:42 INFO     Epoch [31/200] train_loss: 4.2235, val_loss: 5.3564, lr: 0.003000, 6.80s
2024-09-25 23:11:48 INFO     epoch complete!
2024-09-25 23:11:48 INFO     evaluating now!
2024-09-25 23:11:49 INFO     Epoch [32/200] train_loss: 4.1751, val_loss: 5.4009, lr: 0.003000, 6.64s
2024-09-25 23:11:55 INFO     epoch complete!
2024-09-25 23:11:55 INFO     evaluating now!
2024-09-25 23:11:55 INFO     Epoch [33/200] train_loss: 4.0679, val_loss: 5.1870, lr: 0.003000, 6.67s
2024-09-25 23:12:02 INFO     epoch complete!
2024-09-25 23:12:02 INFO     evaluating now!
2024-09-25 23:12:02 INFO     Epoch [34/200] train_loss: 4.1270, val_loss: 5.1313, lr: 0.003000, 6.74s
2024-09-25 23:12:08 INFO     epoch complete!
2024-09-25 23:12:08 INFO     evaluating now!
2024-09-25 23:12:09 INFO     Epoch [35/200] train_loss: 4.0045, val_loss: 5.1570, lr: 0.003000, 6.82s
2024-09-25 23:12:15 INFO     epoch complete!
2024-09-25 23:12:15 INFO     evaluating now!
2024-09-25 23:12:16 INFO     Epoch [36/200] train_loss: 4.0559, val_loss: 5.2691, lr: 0.003000, 6.84s
2024-09-25 23:12:22 INFO     epoch complete!
2024-09-25 23:12:22 INFO     evaluating now!
2024-09-25 23:12:23 INFO     Epoch [37/200] train_loss: 4.0027, val_loss: 5.2426, lr: 0.003000, 7.02s
2024-09-25 23:12:30 INFO     epoch complete!
2024-09-25 23:12:30 INFO     evaluating now!
2024-09-25 23:12:30 INFO     Epoch [38/200] train_loss: 3.9634, val_loss: 5.1848, lr: 0.003000, 7.54s
2024-09-25 23:12:37 INFO     epoch complete!
2024-09-25 23:12:37 INFO     evaluating now!
2024-09-25 23:12:38 INFO     Epoch [39/200] train_loss: 3.8870, val_loss: 5.1503, lr: 0.003000, 7.69s
2024-09-25 23:12:45 INFO     epoch complete!
2024-09-25 23:12:45 INFO     evaluating now!
2024-09-25 23:12:45 INFO     Epoch [40/200] train_loss: 3.8488, val_loss: 5.0676, lr: 0.003000, 7.14s
2024-09-25 23:12:45 INFO     Saved model at 40
2024-09-25 23:12:45 INFO     Val loss decrease from 5.1002 to 5.0676, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-09-25 23:12:52 INFO     epoch complete!
2024-09-25 23:12:52 INFO     evaluating now!
2024-09-25 23:12:52 INFO     Epoch [41/200] train_loss: 3.8579, val_loss: 5.1538, lr: 0.003000, 6.88s
2024-09-25 23:12:58 INFO     epoch complete!
2024-09-25 23:12:58 INFO     evaluating now!
2024-09-25 23:12:59 INFO     Epoch [42/200] train_loss: 3.7868, val_loss: 5.2904, lr: 0.003000, 6.96s
2024-09-25 23:13:05 INFO     epoch complete!
2024-09-25 23:13:05 INFO     evaluating now!
2024-09-25 23:13:06 INFO     Epoch [43/200] train_loss: 3.8407, val_loss: 5.2211, lr: 0.003000, 6.77s
2024-09-25 23:13:12 INFO     epoch complete!
2024-09-25 23:13:12 INFO     evaluating now!
2024-09-25 23:13:13 INFO     Epoch [44/200] train_loss: 3.8471, val_loss: 5.2021, lr: 0.003000, 6.95s
2024-09-25 23:13:19 INFO     epoch complete!
2024-09-25 23:13:19 INFO     evaluating now!
2024-09-25 23:13:19 INFO     Epoch [45/200] train_loss: 3.8070, val_loss: 5.0773, lr: 0.003000, 6.55s
2024-09-25 23:13:25 INFO     epoch complete!
2024-09-25 23:13:25 INFO     evaluating now!
2024-09-25 23:13:26 INFO     Epoch [46/200] train_loss: 3.7488, val_loss: 5.1613, lr: 0.003000, 6.43s
2024-09-25 23:13:32 INFO     epoch complete!
2024-09-25 23:13:32 INFO     evaluating now!
2024-09-25 23:13:32 INFO     Epoch [47/200] train_loss: 3.7169, val_loss: 5.1958, lr: 0.003000, 6.84s
2024-09-25 23:13:39 INFO     epoch complete!
2024-09-25 23:13:39 INFO     evaluating now!
2024-09-25 23:13:39 INFO     Epoch [48/200] train_loss: 3.6923, val_loss: 5.2182, lr: 0.003000, 6.86s
2024-09-25 23:13:46 INFO     epoch complete!
2024-09-25 23:13:46 INFO     evaluating now!
2024-09-25 23:13:46 INFO     Epoch [49/200] train_loss: 3.6908, val_loss: 5.0158, lr: 0.003000, 6.59s
2024-09-25 23:13:46 INFO     Saved model at 49
2024-09-25 23:13:46 INFO     Val loss decrease from 5.0676 to 5.0158, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-09-25 23:13:52 INFO     epoch complete!
2024-09-25 23:13:52 INFO     evaluating now!
2024-09-25 23:13:53 INFO     Epoch [50/200] train_loss: 3.6577, val_loss: 5.1348, lr: 0.003000, 6.94s
2024-09-25 23:13:59 INFO     epoch complete!
2024-09-25 23:13:59 INFO     evaluating now!
2024-09-25 23:14:00 INFO     Epoch [51/200] train_loss: 3.5981, val_loss: 5.0829, lr: 0.003000, 6.84s
2024-09-25 23:14:06 INFO     epoch complete!
2024-09-25 23:14:06 INFO     evaluating now!
2024-09-25 23:14:06 INFO     Epoch [52/200] train_loss: 3.5768, val_loss: 5.1479, lr: 0.003000, 6.67s
2024-09-25 23:14:13 INFO     epoch complete!
2024-09-25 23:14:13 INFO     evaluating now!
2024-09-25 23:14:13 INFO     Epoch [53/200] train_loss: 3.6648, val_loss: 5.1862, lr: 0.003000, 6.89s
2024-09-25 23:14:20 INFO     epoch complete!
2024-09-25 23:14:20 INFO     evaluating now!
2024-09-25 23:14:20 INFO     Epoch [54/200] train_loss: 3.5544, val_loss: 5.0925, lr: 0.003000, 6.65s
2024-09-25 23:14:26 INFO     epoch complete!
2024-09-25 23:14:26 INFO     evaluating now!
2024-09-25 23:14:27 INFO     Epoch [55/200] train_loss: 3.5635, val_loss: 5.0404, lr: 0.003000, 6.81s
2024-09-25 23:14:33 INFO     epoch complete!
2024-09-25 23:14:33 INFO     evaluating now!
2024-09-25 23:14:34 INFO     Epoch [56/200] train_loss: 3.5486, val_loss: 5.1480, lr: 0.003000, 6.81s
2024-09-25 23:14:40 INFO     epoch complete!
2024-09-25 23:14:40 INFO     evaluating now!
2024-09-25 23:14:40 INFO     Epoch [57/200] train_loss: 3.5770, val_loss: 5.2103, lr: 0.003000, 6.69s
2024-09-25 23:14:47 INFO     epoch complete!
2024-09-25 23:14:47 INFO     evaluating now!
2024-09-25 23:14:47 INFO     Epoch [58/200] train_loss: 3.5560, val_loss: 5.2378, lr: 0.003000, 6.83s
2024-09-25 23:14:53 INFO     epoch complete!
2024-09-25 23:14:53 INFO     evaluating now!
2024-09-25 23:14:54 INFO     Epoch [59/200] train_loss: 3.4882, val_loss: 5.1876, lr: 0.003000, 6.80s
2024-09-25 23:15:00 INFO     epoch complete!
2024-09-25 23:15:00 INFO     evaluating now!
2024-09-25 23:15:01 INFO     Epoch [60/200] train_loss: 3.4840, val_loss: 5.2375, lr: 0.003000, 6.99s
2024-09-25 23:15:08 INFO     epoch complete!
2024-09-25 23:15:08 INFO     evaluating now!
2024-09-25 23:15:08 INFO     Epoch [61/200] train_loss: 3.4907, val_loss: 5.1393, lr: 0.003000, 7.18s
2024-09-25 23:15:15 INFO     epoch complete!
2024-09-25 23:15:15 INFO     evaluating now!
2024-09-25 23:15:15 INFO     Epoch [62/200] train_loss: 3.4684, val_loss: 5.0702, lr: 0.003000, 7.13s
2024-09-25 23:15:22 INFO     epoch complete!
2024-09-25 23:15:22 INFO     evaluating now!
2024-09-25 23:15:22 INFO     Epoch [63/200] train_loss: 3.4594, val_loss: 5.1278, lr: 0.003000, 6.76s
2024-09-25 23:15:28 INFO     epoch complete!
2024-09-25 23:15:28 INFO     evaluating now!
2024-09-25 23:15:29 INFO     Epoch [64/200] train_loss: 3.4770, val_loss: 5.1092, lr: 0.003000, 6.66s
2024-09-25 23:15:29 WARNING  Early stopping at epoch: 64
2024-09-25 23:15:29 INFO     Trained totally 65 epochs, average train time is 6.403s, average eval time is 0.453s
2024-09-25 23:15:29 INFO     Loaded model at 49
2024-09-25 23:15:29 INFO     Saved model at ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406.m
2024-09-25 23:15:29 INFO     Start evaluating ...
2024-09-25 23:15:31 INFO     Note that you select the single mode to evaluate!
2024-09-25 23:15:31 INFO     Evaluate result is saved at ./libcity/cache/17/evaluate_cache/2024_09_25_23_15_31_AGCRN_CHITaxi20190406.csv
2024-09-25 23:15:31 INFO     
         MAE       RMSE
1   2.406432   7.030833
2   2.551431   7.673749
3   2.722737   8.694442
4   2.877226   9.530507
5   3.033173  10.496925
6   3.168328  11.692852
7   3.269607  12.831873
8   3.315913  13.605872
9   3.337778  13.939543
10  3.387140  14.001860
11  3.429983  13.936685
12  3.572662  14.304348
2024-09-25 23:15:31 INFO     ----------------------------------------------------------------------------
2024-09-25 23:15:31 INFO     # 3, Kownledge Graph Embedding: GIE, Experiment ids: 18
2024-09-25 23:15:31 INFO     ----------------------------------------------------------------------------
2024-09-25 23:15:31 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=18
2024-09-25 23:15:31 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 18, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-25 23:15:31 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-25 23:15:31 INFO     set_weight_link_or_dist: dist
2024-09-25 23:15:31 INFO     init_weight_inf_or_zero: inf
2024-09-25 23:15:31 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-25 23:15:31 INFO     Start Calculate the weight by Gauss kernel!
2024-09-25 23:15:31 INFO     Loading file CHITaxi20190406.dyna
2024-09-25 23:15:32 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-25 23:15:36 INFO     Dataset created
2024-09-25 23:15:36 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-25 23:15:36 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-25 23:15:36 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-25 23:15:36 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-25 23:15:36 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-25 23:15:36 INFO     NoneScaler
2024-09-25 23:15:39 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-25 23:15:39 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-25 23:15:39 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-25 23:15:39 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-25 23:15:39 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-25 23:15:39 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-25 23:15:39 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-25 23:15:39 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-25 23:15:39 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-25 23:15:39 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-25 23:15:39 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-25 23:15:39 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-25 23:15:39 INFO     Total parameter numbers: 874010
2024-09-25 23:15:39 INFO     You select `adam` optimizer.
2024-09-25 23:15:39 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-25 23:15:39 INFO     Start training ...
2024-09-25 23:15:39 INFO     num_batches:48
2024-09-25 23:15:45 INFO     epoch complete!
2024-09-25 23:15:45 INFO     evaluating now!
2024-09-25 23:15:45 INFO     Epoch [0/200] train_loss: 24.4425, val_loss: 17.8719, lr: 0.003000, 6.67s
2024-09-25 23:15:45 INFO     Saved model at 0
2024-09-25 23:15:45 INFO     Val loss decrease from inf to 17.8719, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-25 23:15:52 INFO     epoch complete!
2024-09-25 23:15:52 INFO     evaluating now!
2024-09-25 23:15:53 INFO     Epoch [1/200] train_loss: 14.5908, val_loss: 13.9055, lr: 0.003000, 7.18s
2024-09-25 23:15:53 INFO     Saved model at 1
2024-09-25 23:15:53 INFO     Val loss decrease from 17.8719 to 13.9055, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-25 23:16:00 INFO     epoch complete!
2024-09-25 23:16:00 INFO     evaluating now!
2024-09-25 23:16:00 INFO     Epoch [2/200] train_loss: 11.3607, val_loss: 10.6526, lr: 0.003000, 7.28s
2024-09-25 23:16:00 INFO     Saved model at 2
2024-09-25 23:16:00 INFO     Val loss decrease from 13.9055 to 10.6526, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-25 23:16:07 INFO     epoch complete!
2024-09-25 23:16:07 INFO     evaluating now!
2024-09-25 23:16:08 INFO     Epoch [3/200] train_loss: 9.1810, val_loss: 8.7418, lr: 0.003000, 7.40s
2024-09-25 23:16:08 INFO     Saved model at 3
2024-09-25 23:16:08 INFO     Val loss decrease from 10.6526 to 8.7418, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-25 23:16:15 INFO     epoch complete!
2024-09-25 23:16:15 INFO     evaluating now!
2024-09-25 23:16:15 INFO     Epoch [4/200] train_loss: 7.9955, val_loss: 7.8480, lr: 0.003000, 7.48s
2024-09-25 23:16:15 INFO     Saved model at 4
2024-09-25 23:16:15 INFO     Val loss decrease from 8.7418 to 7.8480, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-25 23:16:22 INFO     epoch complete!
2024-09-25 23:16:22 INFO     evaluating now!
2024-09-25 23:16:22 INFO     Epoch [5/200] train_loss: 7.2230, val_loss: 6.9722, lr: 0.003000, 7.18s
2024-09-25 23:16:23 INFO     Saved model at 5
2024-09-25 23:16:23 INFO     Val loss decrease from 7.8480 to 6.9722, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-25 23:16:29 INFO     epoch complete!
2024-09-25 23:16:29 INFO     evaluating now!
2024-09-25 23:16:29 INFO     Epoch [6/200] train_loss: 6.6892, val_loss: 6.9511, lr: 0.003000, 6.65s
2024-09-25 23:16:29 INFO     Saved model at 6
2024-09-25 23:16:29 INFO     Val loss decrease from 6.9722 to 6.9511, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-25 23:16:36 INFO     epoch complete!
2024-09-25 23:16:36 INFO     evaluating now!
2024-09-25 23:16:36 INFO     Epoch [7/200] train_loss: 6.3490, val_loss: 6.5771, lr: 0.003000, 6.67s
2024-09-25 23:16:36 INFO     Saved model at 7
2024-09-25 23:16:36 INFO     Val loss decrease from 6.9511 to 6.5771, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-25 23:16:42 INFO     epoch complete!
2024-09-25 23:16:42 INFO     evaluating now!
2024-09-25 23:16:43 INFO     Epoch [8/200] train_loss: 6.0552, val_loss: 6.1597, lr: 0.003000, 6.76s
2024-09-25 23:16:43 INFO     Saved model at 8
2024-09-25 23:16:43 INFO     Val loss decrease from 6.5771 to 6.1597, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-25 23:16:49 INFO     epoch complete!
2024-09-25 23:16:49 INFO     evaluating now!
2024-09-25 23:16:50 INFO     Epoch [9/200] train_loss: 5.8724, val_loss: 6.2256, lr: 0.003000, 6.63s
2024-09-25 23:16:56 INFO     epoch complete!
2024-09-25 23:16:56 INFO     evaluating now!
2024-09-25 23:16:57 INFO     Epoch [10/200] train_loss: 5.6849, val_loss: 5.8399, lr: 0.003000, 6.97s
2024-09-25 23:16:57 INFO     Saved model at 10
2024-09-25 23:16:57 INFO     Val loss decrease from 6.1597 to 5.8399, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-25 23:17:03 INFO     epoch complete!
2024-09-25 23:17:03 INFO     evaluating now!
2024-09-25 23:17:03 INFO     Epoch [11/200] train_loss: 5.5977, val_loss: 5.7999, lr: 0.003000, 6.65s
2024-09-25 23:17:04 INFO     Saved model at 11
2024-09-25 23:17:04 INFO     Val loss decrease from 5.8399 to 5.7999, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-25 23:17:10 INFO     epoch complete!
2024-09-25 23:17:10 INFO     evaluating now!
2024-09-25 23:17:10 INFO     Epoch [12/200] train_loss: 5.4500, val_loss: 5.6162, lr: 0.003000, 6.67s
2024-09-25 23:17:10 INFO     Saved model at 12
2024-09-25 23:17:10 INFO     Val loss decrease from 5.7999 to 5.6162, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-25 23:17:17 INFO     epoch complete!
2024-09-25 23:17:17 INFO     evaluating now!
2024-09-25 23:17:17 INFO     Epoch [13/200] train_loss: 5.3087, val_loss: 5.6256, lr: 0.003000, 6.57s
2024-09-25 23:17:23 INFO     epoch complete!
2024-09-25 23:17:23 INFO     evaluating now!
2024-09-25 23:17:24 INFO     Epoch [14/200] train_loss: 5.2258, val_loss: 5.5359, lr: 0.003000, 6.76s
2024-09-25 23:17:24 INFO     Saved model at 14
2024-09-25 23:17:24 INFO     Val loss decrease from 5.6162 to 5.5359, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-25 23:17:30 INFO     epoch complete!
2024-09-25 23:17:30 INFO     evaluating now!
2024-09-25 23:17:31 INFO     Epoch [15/200] train_loss: 5.1503, val_loss: 5.4774, lr: 0.003000, 6.73s
2024-09-25 23:17:31 INFO     Saved model at 15
2024-09-25 23:17:31 INFO     Val loss decrease from 5.5359 to 5.4774, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-25 23:17:37 INFO     epoch complete!
2024-09-25 23:17:37 INFO     evaluating now!
2024-09-25 23:17:38 INFO     Epoch [16/200] train_loss: 5.0424, val_loss: 5.5297, lr: 0.003000, 6.84s
2024-09-25 23:17:44 INFO     epoch complete!
2024-09-25 23:17:44 INFO     evaluating now!
2024-09-25 23:17:44 INFO     Epoch [17/200] train_loss: 4.9641, val_loss: 5.5445, lr: 0.003000, 6.68s
2024-09-25 23:17:51 INFO     epoch complete!
2024-09-25 23:17:51 INFO     evaluating now!
2024-09-25 23:17:51 INFO     Epoch [18/200] train_loss: 4.9502, val_loss: 5.6455, lr: 0.003000, 6.68s
2024-09-25 23:17:57 INFO     epoch complete!
2024-09-25 23:17:57 INFO     evaluating now!
2024-09-25 23:17:58 INFO     Epoch [19/200] train_loss: 4.8890, val_loss: 5.3676, lr: 0.003000, 6.58s
2024-09-25 23:17:58 INFO     Saved model at 19
2024-09-25 23:17:58 INFO     Val loss decrease from 5.4774 to 5.3676, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-25 23:18:04 INFO     epoch complete!
2024-09-25 23:18:04 INFO     evaluating now!
2024-09-25 23:18:04 INFO     Epoch [20/200] train_loss: 4.7668, val_loss: 5.3129, lr: 0.003000, 6.46s
2024-09-25 23:18:04 INFO     Saved model at 20
2024-09-25 23:18:04 INFO     Val loss decrease from 5.3676 to 5.3129, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-25 23:18:10 INFO     epoch complete!
2024-09-25 23:18:10 INFO     evaluating now!
2024-09-25 23:18:10 INFO     Epoch [21/200] train_loss: 4.6444, val_loss: 5.3324, lr: 0.003000, 5.82s
2024-09-25 23:18:16 INFO     epoch complete!
2024-09-25 23:18:16 INFO     evaluating now!
2024-09-25 23:18:16 INFO     Epoch [22/200] train_loss: 4.6198, val_loss: 5.3481, lr: 0.003000, 5.96s
2024-09-25 23:18:21 INFO     epoch complete!
2024-09-25 23:18:21 INFO     evaluating now!
2024-09-25 23:18:22 INFO     Epoch [23/200] train_loss: 4.5119, val_loss: 5.4265, lr: 0.003000, 5.80s
2024-09-25 23:18:27 INFO     epoch complete!
2024-09-25 23:18:27 INFO     evaluating now!
2024-09-25 23:18:28 INFO     Epoch [24/200] train_loss: 4.4997, val_loss: 5.3204, lr: 0.003000, 5.90s
2024-09-25 23:18:33 INFO     epoch complete!
2024-09-25 23:18:33 INFO     evaluating now!
2024-09-25 23:18:33 INFO     Epoch [25/200] train_loss: 4.5751, val_loss: 5.1048, lr: 0.003000, 5.78s
2024-09-25 23:18:33 INFO     Saved model at 25
2024-09-25 23:18:33 INFO     Val loss decrease from 5.3129 to 5.1048, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-25 23:18:39 INFO     epoch complete!
2024-09-25 23:18:39 INFO     evaluating now!
2024-09-25 23:18:39 INFO     Epoch [26/200] train_loss: 4.4450, val_loss: 5.0545, lr: 0.003000, 5.96s
2024-09-25 23:18:40 INFO     Saved model at 26
2024-09-25 23:18:40 INFO     Val loss decrease from 5.1048 to 5.0545, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-25 23:18:45 INFO     epoch complete!
2024-09-25 23:18:45 INFO     evaluating now!
2024-09-25 23:18:45 INFO     Epoch [27/200] train_loss: 4.3996, val_loss: 5.0514, lr: 0.003000, 5.80s
2024-09-25 23:18:45 INFO     Saved model at 27
2024-09-25 23:18:45 INFO     Val loss decrease from 5.0545 to 5.0514, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-25 23:18:51 INFO     epoch complete!
2024-09-25 23:18:51 INFO     evaluating now!
2024-09-25 23:18:51 INFO     Epoch [28/200] train_loss: 4.3126, val_loss: 5.2734, lr: 0.003000, 5.75s
2024-09-25 23:18:57 INFO     epoch complete!
2024-09-25 23:18:57 INFO     evaluating now!
2024-09-25 23:18:57 INFO     Epoch [29/200] train_loss: 4.2965, val_loss: 5.1019, lr: 0.003000, 5.77s
2024-09-25 23:19:02 INFO     epoch complete!
2024-09-25 23:19:02 INFO     evaluating now!
2024-09-25 23:19:03 INFO     Epoch [30/200] train_loss: 4.1952, val_loss: 5.0206, lr: 0.003000, 5.86s
2024-09-25 23:19:03 INFO     Saved model at 30
2024-09-25 23:19:03 INFO     Val loss decrease from 5.0514 to 5.0206, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-09-25 23:19:08 INFO     epoch complete!
2024-09-25 23:19:08 INFO     evaluating now!
2024-09-25 23:19:09 INFO     Epoch [31/200] train_loss: 4.1709, val_loss: 5.2486, lr: 0.003000, 5.96s
2024-09-25 23:19:14 INFO     epoch complete!
2024-09-25 23:19:14 INFO     evaluating now!
2024-09-25 23:19:15 INFO     Epoch [32/200] train_loss: 4.1322, val_loss: 5.2526, lr: 0.003000, 5.84s
2024-09-25 23:19:20 INFO     epoch complete!
2024-09-25 23:19:20 INFO     evaluating now!
2024-09-25 23:19:21 INFO     Epoch [33/200] train_loss: 4.0897, val_loss: 5.0801, lr: 0.003000, 6.04s
2024-09-25 23:19:26 INFO     epoch complete!
2024-09-25 23:19:26 INFO     evaluating now!
2024-09-25 23:19:27 INFO     Epoch [34/200] train_loss: 4.0884, val_loss: 5.0650, lr: 0.003000, 6.06s
2024-09-25 23:19:32 INFO     epoch complete!
2024-09-25 23:19:32 INFO     evaluating now!
2024-09-25 23:19:33 INFO     Epoch [35/200] train_loss: 4.0422, val_loss: 5.2356, lr: 0.003000, 5.94s
2024-09-25 23:19:38 INFO     epoch complete!
2024-09-25 23:19:38 INFO     evaluating now!
2024-09-25 23:19:39 INFO     Epoch [36/200] train_loss: 4.0241, val_loss: 5.0720, lr: 0.003000, 5.91s
2024-09-25 23:19:44 INFO     epoch complete!
2024-09-25 23:19:44 INFO     evaluating now!
2024-09-25 23:19:45 INFO     Epoch [37/200] train_loss: 4.0145, val_loss: 5.0306, lr: 0.003000, 5.93s
2024-09-25 23:19:50 INFO     epoch complete!
2024-09-25 23:19:50 INFO     evaluating now!
2024-09-25 23:19:50 INFO     Epoch [38/200] train_loss: 3.9623, val_loss: 5.0888, lr: 0.003000, 5.88s
2024-09-25 23:19:56 INFO     epoch complete!
2024-09-25 23:19:56 INFO     evaluating now!
2024-09-25 23:19:56 INFO     Epoch [39/200] train_loss: 3.9033, val_loss: 5.0356, lr: 0.003000, 5.83s
2024-09-25 23:20:02 INFO     epoch complete!
2024-09-25 23:20:02 INFO     evaluating now!
2024-09-25 23:20:02 INFO     Epoch [40/200] train_loss: 3.9067, val_loss: 5.0429, lr: 0.003000, 5.76s
2024-09-25 23:20:08 INFO     epoch complete!
2024-09-25 23:20:08 INFO     evaluating now!
2024-09-25 23:20:08 INFO     Epoch [41/200] train_loss: 3.8789, val_loss: 5.1426, lr: 0.003000, 5.89s
2024-09-25 23:20:13 INFO     epoch complete!
2024-09-25 23:20:13 INFO     evaluating now!
2024-09-25 23:20:14 INFO     Epoch [42/200] train_loss: 3.9123, val_loss: 5.0477, lr: 0.003000, 5.86s
2024-09-25 23:20:19 INFO     epoch complete!
2024-09-25 23:20:19 INFO     evaluating now!
2024-09-25 23:20:20 INFO     Epoch [43/200] train_loss: 3.7953, val_loss: 4.9896, lr: 0.003000, 5.84s
2024-09-25 23:20:20 INFO     Saved model at 43
2024-09-25 23:20:20 INFO     Val loss decrease from 5.0206 to 4.9896, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-09-25 23:20:25 INFO     epoch complete!
2024-09-25 23:20:25 INFO     evaluating now!
2024-09-25 23:20:26 INFO     Epoch [44/200] train_loss: 3.7918, val_loss: 4.9482, lr: 0.003000, 6.00s
2024-09-25 23:20:26 INFO     Saved model at 44
2024-09-25 23:20:26 INFO     Val loss decrease from 4.9896 to 4.9482, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-09-25 23:20:31 INFO     epoch complete!
2024-09-25 23:20:31 INFO     evaluating now!
2024-09-25 23:20:31 INFO     Epoch [45/200] train_loss: 3.7968, val_loss: 5.0036, lr: 0.003000, 5.77s
2024-09-25 23:20:37 INFO     epoch complete!
2024-09-25 23:20:37 INFO     evaluating now!
2024-09-25 23:20:37 INFO     Epoch [46/200] train_loss: 3.8017, val_loss: 4.9643, lr: 0.003000, 5.95s
2024-09-25 23:20:43 INFO     epoch complete!
2024-09-25 23:20:43 INFO     evaluating now!
2024-09-25 23:20:43 INFO     Epoch [47/200] train_loss: 3.7025, val_loss: 4.9545, lr: 0.003000, 5.68s
2024-09-25 23:20:49 INFO     epoch complete!
2024-09-25 23:20:49 INFO     evaluating now!
2024-09-25 23:20:49 INFO     Epoch [48/200] train_loss: 3.7090, val_loss: 4.9879, lr: 0.003000, 5.76s
2024-09-25 23:20:55 INFO     epoch complete!
2024-09-25 23:20:55 INFO     evaluating now!
2024-09-25 23:20:55 INFO     Epoch [49/200] train_loss: 3.6641, val_loss: 4.9962, lr: 0.003000, 6.05s
2024-09-25 23:21:00 INFO     epoch complete!
2024-09-25 23:21:00 INFO     evaluating now!
2024-09-25 23:21:01 INFO     Epoch [50/200] train_loss: 3.6853, val_loss: 4.9556, lr: 0.003000, 5.75s
2024-09-25 23:21:06 INFO     epoch complete!
2024-09-25 23:21:06 INFO     evaluating now!
2024-09-25 23:21:07 INFO     Epoch [51/200] train_loss: 3.6285, val_loss: 4.9398, lr: 0.003000, 5.96s
2024-09-25 23:21:07 INFO     Saved model at 51
2024-09-25 23:21:07 INFO     Val loss decrease from 4.9482 to 4.9398, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-09-25 23:21:12 INFO     epoch complete!
2024-09-25 23:21:12 INFO     evaluating now!
2024-09-25 23:21:12 INFO     Epoch [52/200] train_loss: 3.6358, val_loss: 4.8738, lr: 0.003000, 5.76s
2024-09-25 23:21:13 INFO     Saved model at 52
2024-09-25 23:21:13 INFO     Val loss decrease from 4.9398 to 4.8738, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch52.tar
2024-09-25 23:21:18 INFO     epoch complete!
2024-09-25 23:21:18 INFO     evaluating now!
2024-09-25 23:21:18 INFO     Epoch [53/200] train_loss: 3.6199, val_loss: 5.0405, lr: 0.003000, 5.83s
2024-09-25 23:21:24 INFO     epoch complete!
2024-09-25 23:21:24 INFO     evaluating now!
2024-09-25 23:21:24 INFO     Epoch [54/200] train_loss: 3.5502, val_loss: 5.0828, lr: 0.003000, 5.78s
2024-09-25 23:21:30 INFO     epoch complete!
2024-09-25 23:21:30 INFO     evaluating now!
2024-09-25 23:21:30 INFO     Epoch [55/200] train_loss: 3.5481, val_loss: 4.9846, lr: 0.003000, 5.94s
2024-09-25 23:21:35 INFO     epoch complete!
2024-09-25 23:21:35 INFO     evaluating now!
2024-09-25 23:21:36 INFO     Epoch [56/200] train_loss: 3.5437, val_loss: 5.1067, lr: 0.003000, 5.79s
2024-09-25 23:21:41 INFO     epoch complete!
2024-09-25 23:21:41 INFO     evaluating now!
2024-09-25 23:21:42 INFO     Epoch [57/200] train_loss: 3.5656, val_loss: 4.9596, lr: 0.003000, 5.89s
2024-09-25 23:21:47 INFO     epoch complete!
2024-09-25 23:21:47 INFO     evaluating now!
2024-09-25 23:21:47 INFO     Epoch [58/200] train_loss: 3.5449, val_loss: 5.0214, lr: 0.003000, 5.72s
2024-09-25 23:21:53 INFO     epoch complete!
2024-09-25 23:21:53 INFO     evaluating now!
2024-09-25 23:21:53 INFO     Epoch [59/200] train_loss: 3.4885, val_loss: 4.9827, lr: 0.003000, 5.82s
2024-09-25 23:21:59 INFO     epoch complete!
2024-09-25 23:21:59 INFO     evaluating now!
2024-09-25 23:21:59 INFO     Epoch [60/200] train_loss: 3.4865, val_loss: 5.0167, lr: 0.003000, 5.81s
2024-09-25 23:22:04 INFO     epoch complete!
2024-09-25 23:22:04 INFO     evaluating now!
2024-09-25 23:22:05 INFO     Epoch [61/200] train_loss: 3.4675, val_loss: 5.0390, lr: 0.003000, 5.65s
2024-09-25 23:22:10 INFO     epoch complete!
2024-09-25 23:22:10 INFO     evaluating now!
2024-09-25 23:22:11 INFO     Epoch [62/200] train_loss: 3.4695, val_loss: 5.0133, lr: 0.003000, 5.84s
2024-09-25 23:22:16 INFO     epoch complete!
2024-09-25 23:22:16 INFO     evaluating now!
2024-09-25 23:22:16 INFO     Epoch [63/200] train_loss: 3.4879, val_loss: 4.9554, lr: 0.003000, 5.79s
2024-09-25 23:22:22 INFO     epoch complete!
2024-09-25 23:22:22 INFO     evaluating now!
2024-09-25 23:22:22 INFO     Epoch [64/200] train_loss: 3.4540, val_loss: 4.9997, lr: 0.003000, 5.85s
2024-09-25 23:22:28 INFO     epoch complete!
2024-09-25 23:22:28 INFO     evaluating now!
2024-09-25 23:22:28 INFO     Epoch [65/200] train_loss: 3.4253, val_loss: 5.0153, lr: 0.003000, 5.69s
2024-09-25 23:22:33 INFO     epoch complete!
2024-09-25 23:22:33 INFO     evaluating now!
2024-09-25 23:22:34 INFO     Epoch [66/200] train_loss: 3.4506, val_loss: 5.0015, lr: 0.003000, 5.66s
2024-09-25 23:22:39 INFO     epoch complete!
2024-09-25 23:22:39 INFO     evaluating now!
2024-09-25 23:22:39 INFO     Epoch [67/200] train_loss: 3.3808, val_loss: 4.8825, lr: 0.003000, 5.79s
2024-09-25 23:22:39 WARNING  Early stopping at epoch: 67
2024-09-25 23:22:39 INFO     Trained totally 68 epochs, average train time is 5.748s, average eval time is 0.399s
2024-09-25 23:22:40 INFO     Loaded model at 52
2024-09-25 23:22:40 INFO     Saved model at ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406.m
2024-09-25 23:22:40 INFO     Start evaluating ...
2024-09-25 23:22:41 INFO     Note that you select the single mode to evaluate!
2024-09-25 23:22:41 INFO     Evaluate result is saved at ./libcity/cache/18/evaluate_cache/2024_09_25_23_22_41_AGCRN_CHITaxi20190406.csv
2024-09-25 23:22:41 INFO     
         MAE       RMSE
1   2.419483   8.110895
2   2.531893   8.435940
3   2.735209   9.041054
4   2.877069   9.575195
5   2.964287  10.371164
6   3.126245  11.244672
7   3.175335  11.987752
8   3.246957  12.343497
9   3.275966  12.524081
10  3.359481  12.753028
11  3.415052  13.292739
12  3.538891  14.226346
2024-09-25 23:22:41 INFO     ----------------------------------------------------------------------------
2024-09-25 23:22:41 INFO     # 4, Kownledge Graph Embedding: GIE, Experiment ids: 19
2024-09-25 23:22:41 INFO     ----------------------------------------------------------------------------
2024-09-25 23:22:41 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=19
2024-09-25 23:22:41 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 19, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-25 23:22:41 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-25 23:22:41 INFO     set_weight_link_or_dist: dist
2024-09-25 23:22:41 INFO     init_weight_inf_or_zero: inf
2024-09-25 23:22:41 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-25 23:22:41 INFO     Start Calculate the weight by Gauss kernel!
2024-09-25 23:22:41 INFO     Loading file CHITaxi20190406.dyna
2024-09-25 23:22:41 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-25 23:22:45 INFO     Dataset created
2024-09-25 23:22:45 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-25 23:22:45 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-25 23:22:45 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-25 23:22:45 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-25 23:22:45 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-25 23:22:45 INFO     NoneScaler
2024-09-25 23:22:48 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-25 23:22:48 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-25 23:22:48 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-25 23:22:48 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-25 23:22:48 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-25 23:22:48 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-25 23:22:48 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-25 23:22:48 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-25 23:22:48 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-25 23:22:48 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-25 23:22:48 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-25 23:22:48 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-25 23:22:48 INFO     Total parameter numbers: 874010
2024-09-25 23:22:48 INFO     You select `adam` optimizer.
2024-09-25 23:22:48 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-25 23:22:48 INFO     Start training ...
2024-09-25 23:22:48 INFO     num_batches:48
2024-09-25 23:22:53 INFO     epoch complete!
2024-09-25 23:22:53 INFO     evaluating now!
2024-09-25 23:22:54 INFO     Epoch [0/200] train_loss: 25.1921, val_loss: 18.0256, lr: 0.003000, 5.86s
2024-09-25 23:22:54 INFO     Saved model at 0
2024-09-25 23:22:54 INFO     Val loss decrease from inf to 18.0256, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-25 23:22:59 INFO     epoch complete!
2024-09-25 23:22:59 INFO     evaluating now!
2024-09-25 23:23:00 INFO     Epoch [1/200] train_loss: 14.4057, val_loss: 14.0400, lr: 0.003000, 5.86s
2024-09-25 23:23:00 INFO     Saved model at 1
2024-09-25 23:23:00 INFO     Val loss decrease from 18.0256 to 14.0400, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-25 23:23:05 INFO     epoch complete!
2024-09-25 23:23:05 INFO     evaluating now!
2024-09-25 23:23:06 INFO     Epoch [2/200] train_loss: 11.3884, val_loss: 10.8872, lr: 0.003000, 5.91s
2024-09-25 23:23:06 INFO     Saved model at 2
2024-09-25 23:23:06 INFO     Val loss decrease from 14.0400 to 10.8872, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-25 23:23:11 INFO     epoch complete!
2024-09-25 23:23:11 INFO     evaluating now!
2024-09-25 23:23:11 INFO     Epoch [3/200] train_loss: 9.3720, val_loss: 9.0887, lr: 0.003000, 5.77s
2024-09-25 23:23:11 INFO     Saved model at 3
2024-09-25 23:23:11 INFO     Val loss decrease from 10.8872 to 9.0887, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-25 23:23:17 INFO     epoch complete!
2024-09-25 23:23:17 INFO     evaluating now!
2024-09-25 23:23:17 INFO     Epoch [4/200] train_loss: 7.9774, val_loss: 7.7245, lr: 0.003000, 5.97s
2024-09-25 23:23:18 INFO     Saved model at 4
2024-09-25 23:23:18 INFO     Val loss decrease from 9.0887 to 7.7245, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-25 23:23:23 INFO     epoch complete!
2024-09-25 23:23:23 INFO     evaluating now!
2024-09-25 23:23:23 INFO     Epoch [5/200] train_loss: 7.2531, val_loss: 6.9875, lr: 0.003000, 5.91s
2024-09-25 23:23:24 INFO     Saved model at 5
2024-09-25 23:23:24 INFO     Val loss decrease from 7.7245 to 6.9875, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-25 23:23:29 INFO     epoch complete!
2024-09-25 23:23:29 INFO     evaluating now!
2024-09-25 23:23:29 INFO     Epoch [6/200] train_loss: 6.7502, val_loss: 6.7264, lr: 0.003000, 5.82s
2024-09-25 23:23:30 INFO     Saved model at 6
2024-09-25 23:23:30 INFO     Val loss decrease from 6.9875 to 6.7264, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-25 23:23:35 INFO     epoch complete!
2024-09-25 23:23:35 INFO     evaluating now!
2024-09-25 23:23:35 INFO     Epoch [7/200] train_loss: 6.3299, val_loss: 6.2724, lr: 0.003000, 5.74s
2024-09-25 23:23:35 INFO     Saved model at 7
2024-09-25 23:23:35 INFO     Val loss decrease from 6.7264 to 6.2724, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-25 23:23:41 INFO     epoch complete!
2024-09-25 23:23:41 INFO     evaluating now!
2024-09-25 23:23:41 INFO     Epoch [8/200] train_loss: 6.0819, val_loss: 6.0890, lr: 0.003000, 5.98s
2024-09-25 23:23:41 INFO     Saved model at 8
2024-09-25 23:23:41 INFO     Val loss decrease from 6.2724 to 6.0890, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-25 23:23:47 INFO     epoch complete!
2024-09-25 23:23:47 INFO     evaluating now!
2024-09-25 23:23:47 INFO     Epoch [9/200] train_loss: 5.8581, val_loss: 5.9410, lr: 0.003000, 5.99s
2024-09-25 23:23:47 INFO     Saved model at 9
2024-09-25 23:23:47 INFO     Val loss decrease from 6.0890 to 5.9410, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-25 23:23:53 INFO     epoch complete!
2024-09-25 23:23:53 INFO     evaluating now!
2024-09-25 23:23:53 INFO     Epoch [10/200] train_loss: 5.7787, val_loss: 5.8343, lr: 0.003000, 5.82s
2024-09-25 23:23:53 INFO     Saved model at 10
2024-09-25 23:23:53 INFO     Val loss decrease from 5.9410 to 5.8343, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-25 23:23:59 INFO     epoch complete!
2024-09-25 23:23:59 INFO     evaluating now!
2024-09-25 23:23:59 INFO     Epoch [11/200] train_loss: 5.5186, val_loss: 5.8791, lr: 0.003000, 5.89s
2024-09-25 23:24:05 INFO     epoch complete!
2024-09-25 23:24:05 INFO     evaluating now!
2024-09-25 23:24:05 INFO     Epoch [12/200] train_loss: 5.4181, val_loss: 5.7839, lr: 0.003000, 5.88s
2024-09-25 23:24:05 INFO     Saved model at 12
2024-09-25 23:24:05 INFO     Val loss decrease from 5.8343 to 5.7839, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-25 23:24:11 INFO     epoch complete!
2024-09-25 23:24:11 INFO     evaluating now!
2024-09-25 23:24:11 INFO     Epoch [13/200] train_loss: 5.3261, val_loss: 5.7676, lr: 0.003000, 5.90s
2024-09-25 23:24:11 INFO     Saved model at 13
2024-09-25 23:24:11 INFO     Val loss decrease from 5.7839 to 5.7676, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-25 23:24:17 INFO     epoch complete!
2024-09-25 23:24:17 INFO     evaluating now!
2024-09-25 23:24:17 INFO     Epoch [14/200] train_loss: 5.1604, val_loss: 5.4386, lr: 0.003000, 5.77s
2024-09-25 23:24:17 INFO     Saved model at 14
2024-09-25 23:24:17 INFO     Val loss decrease from 5.7676 to 5.4386, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-25 23:24:23 INFO     epoch complete!
2024-09-25 23:24:23 INFO     evaluating now!
2024-09-25 23:24:23 INFO     Epoch [15/200] train_loss: 5.1334, val_loss: 5.4483, lr: 0.003000, 5.95s
2024-09-25 23:24:28 INFO     epoch complete!
2024-09-25 23:24:28 INFO     evaluating now!
2024-09-25 23:24:29 INFO     Epoch [16/200] train_loss: 5.0005, val_loss: 5.6836, lr: 0.003000, 5.82s
2024-09-25 23:24:34 INFO     epoch complete!
2024-09-25 23:24:34 INFO     evaluating now!
2024-09-25 23:24:35 INFO     Epoch [17/200] train_loss: 4.9029, val_loss: 5.4322, lr: 0.003000, 5.81s
2024-09-25 23:24:35 INFO     Saved model at 17
2024-09-25 23:24:35 INFO     Val loss decrease from 5.4386 to 5.4322, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-25 23:24:40 INFO     epoch complete!
2024-09-25 23:24:40 INFO     evaluating now!
2024-09-25 23:24:41 INFO     Epoch [18/200] train_loss: 4.8306, val_loss: 5.4168, lr: 0.003000, 5.77s
2024-09-25 23:24:41 INFO     Saved model at 18
2024-09-25 23:24:41 INFO     Val loss decrease from 5.4322 to 5.4168, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-25 23:24:46 INFO     epoch complete!
2024-09-25 23:24:46 INFO     evaluating now!
2024-09-25 23:24:47 INFO     Epoch [19/200] train_loss: 4.8716, val_loss: 5.5766, lr: 0.003000, 5.87s
2024-09-25 23:24:52 INFO     epoch complete!
2024-09-25 23:24:52 INFO     evaluating now!
2024-09-25 23:24:52 INFO     Epoch [20/200] train_loss: 4.7576, val_loss: 5.4044, lr: 0.003000, 5.85s
2024-09-25 23:24:52 INFO     Saved model at 20
2024-09-25 23:24:52 INFO     Val loss decrease from 5.4168 to 5.4044, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-25 23:24:58 INFO     epoch complete!
2024-09-25 23:24:58 INFO     evaluating now!
2024-09-25 23:24:58 INFO     Epoch [21/200] train_loss: 4.6885, val_loss: 5.3181, lr: 0.003000, 5.92s
2024-09-25 23:24:58 INFO     Saved model at 21
2024-09-25 23:24:58 INFO     Val loss decrease from 5.4044 to 5.3181, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-25 23:25:04 INFO     epoch complete!
2024-09-25 23:25:04 INFO     evaluating now!
2024-09-25 23:25:04 INFO     Epoch [22/200] train_loss: 4.6413, val_loss: 5.4162, lr: 0.003000, 5.85s
2024-09-25 23:25:10 INFO     epoch complete!
2024-09-25 23:25:10 INFO     evaluating now!
2024-09-25 23:25:10 INFO     Epoch [23/200] train_loss: 4.5806, val_loss: 5.5004, lr: 0.003000, 5.85s
2024-09-25 23:25:16 INFO     epoch complete!
2024-09-25 23:25:16 INFO     evaluating now!
2024-09-25 23:25:16 INFO     Epoch [24/200] train_loss: 4.5259, val_loss: 5.1921, lr: 0.003000, 6.15s
2024-09-25 23:25:16 INFO     Saved model at 24
2024-09-25 23:25:16 INFO     Val loss decrease from 5.3181 to 5.1921, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-25 23:25:22 INFO     epoch complete!
2024-09-25 23:25:22 INFO     evaluating now!
2024-09-25 23:25:22 INFO     Epoch [25/200] train_loss: 4.5347, val_loss: 5.2118, lr: 0.003000, 6.02s
2024-09-25 23:25:28 INFO     epoch complete!
2024-09-25 23:25:28 INFO     evaluating now!
2024-09-25 23:25:28 INFO     Epoch [26/200] train_loss: 4.4048, val_loss: 5.2435, lr: 0.003000, 6.03s
2024-09-25 23:25:34 INFO     epoch complete!
2024-09-25 23:25:34 INFO     evaluating now!
2024-09-25 23:25:34 INFO     Epoch [27/200] train_loss: 4.4053, val_loss: 5.2644, lr: 0.003000, 5.80s
2024-09-25 23:25:40 INFO     epoch complete!
2024-09-25 23:25:40 INFO     evaluating now!
2024-09-25 23:25:40 INFO     Epoch [28/200] train_loss: 4.3234, val_loss: 5.2580, lr: 0.003000, 6.04s
2024-09-25 23:25:46 INFO     epoch complete!
2024-09-25 23:25:46 INFO     evaluating now!
2024-09-25 23:25:46 INFO     Epoch [29/200] train_loss: 4.3720, val_loss: 5.1566, lr: 0.003000, 5.78s
2024-09-25 23:25:46 INFO     Saved model at 29
2024-09-25 23:25:46 INFO     Val loss decrease from 5.1921 to 5.1566, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-25 23:25:52 INFO     epoch complete!
2024-09-25 23:25:52 INFO     evaluating now!
2024-09-25 23:25:52 INFO     Epoch [30/200] train_loss: 4.2925, val_loss: 5.1263, lr: 0.003000, 5.90s
2024-09-25 23:25:52 INFO     Saved model at 30
2024-09-25 23:25:52 INFO     Val loss decrease from 5.1566 to 5.1263, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-09-25 23:25:58 INFO     epoch complete!
2024-09-25 23:25:58 INFO     evaluating now!
2024-09-25 23:25:58 INFO     Epoch [31/200] train_loss: 4.2172, val_loss: 5.3408, lr: 0.003000, 6.00s
2024-09-25 23:26:04 INFO     epoch complete!
2024-09-25 23:26:04 INFO     evaluating now!
2024-09-25 23:26:04 INFO     Epoch [32/200] train_loss: 4.1729, val_loss: 5.3121, lr: 0.003000, 5.92s
2024-09-25 23:26:09 INFO     epoch complete!
2024-09-25 23:26:09 INFO     evaluating now!
2024-09-25 23:26:10 INFO     Epoch [33/200] train_loss: 4.2000, val_loss: 5.2908, lr: 0.003000, 5.87s
2024-09-25 23:26:15 INFO     epoch complete!
2024-09-25 23:26:15 INFO     evaluating now!
2024-09-25 23:26:16 INFO     Epoch [34/200] train_loss: 4.1337, val_loss: 5.1912, lr: 0.003000, 5.84s
2024-09-25 23:26:21 INFO     epoch complete!
2024-09-25 23:26:21 INFO     evaluating now!
2024-09-25 23:26:22 INFO     Epoch [35/200] train_loss: 4.0960, val_loss: 5.0819, lr: 0.003000, 6.11s
2024-09-25 23:26:22 INFO     Saved model at 35
2024-09-25 23:26:22 INFO     Val loss decrease from 5.1263 to 5.0819, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-25 23:26:27 INFO     epoch complete!
2024-09-25 23:26:27 INFO     evaluating now!
2024-09-25 23:26:28 INFO     Epoch [36/200] train_loss: 4.0212, val_loss: 5.1556, lr: 0.003000, 5.83s
2024-09-25 23:26:33 INFO     epoch complete!
2024-09-25 23:26:33 INFO     evaluating now!
2024-09-25 23:26:33 INFO     Epoch [37/200] train_loss: 4.0525, val_loss: 5.0867, lr: 0.003000, 5.79s
2024-09-25 23:26:39 INFO     epoch complete!
2024-09-25 23:26:39 INFO     evaluating now!
2024-09-25 23:26:39 INFO     Epoch [38/200] train_loss: 4.0160, val_loss: 5.0839, lr: 0.003000, 5.86s
2024-09-25 23:26:45 INFO     epoch complete!
2024-09-25 23:26:45 INFO     evaluating now!
2024-09-25 23:26:45 INFO     Epoch [39/200] train_loss: 4.0057, val_loss: 5.3179, lr: 0.003000, 5.99s
2024-09-25 23:26:51 INFO     epoch complete!
2024-09-25 23:26:51 INFO     evaluating now!
2024-09-25 23:26:51 INFO     Epoch [40/200] train_loss: 4.0468, val_loss: 5.2063, lr: 0.003000, 5.81s
2024-09-25 23:26:56 INFO     epoch complete!
2024-09-25 23:26:56 INFO     evaluating now!
2024-09-25 23:26:57 INFO     Epoch [41/200] train_loss: 3.9110, val_loss: 5.0667, lr: 0.003000, 5.78s
2024-09-25 23:26:57 INFO     Saved model at 41
2024-09-25 23:26:57 INFO     Val loss decrease from 5.0819 to 5.0667, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-09-25 23:27:03 INFO     epoch complete!
2024-09-25 23:27:03 INFO     evaluating now!
2024-09-25 23:27:03 INFO     Epoch [42/200] train_loss: 3.9247, val_loss: 5.0210, lr: 0.003000, 5.86s
2024-09-25 23:27:03 INFO     Saved model at 42
2024-09-25 23:27:03 INFO     Val loss decrease from 5.0667 to 5.0210, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-09-25 23:27:08 INFO     epoch complete!
2024-09-25 23:27:08 INFO     evaluating now!
2024-09-25 23:27:09 INFO     Epoch [43/200] train_loss: 3.8352, val_loss: 4.9639, lr: 0.003000, 5.76s
2024-09-25 23:27:09 INFO     Saved model at 43
2024-09-25 23:27:09 INFO     Val loss decrease from 5.0210 to 4.9639, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-09-25 23:27:14 INFO     epoch complete!
2024-09-25 23:27:14 INFO     evaluating now!
2024-09-25 23:27:15 INFO     Epoch [44/200] train_loss: 3.8668, val_loss: 5.0493, lr: 0.003000, 6.01s
2024-09-25 23:27:20 INFO     epoch complete!
2024-09-25 23:27:20 INFO     evaluating now!
2024-09-25 23:27:21 INFO     Epoch [45/200] train_loss: 3.8097, val_loss: 5.2715, lr: 0.003000, 5.80s
2024-09-25 23:27:26 INFO     epoch complete!
2024-09-25 23:27:26 INFO     evaluating now!
2024-09-25 23:27:27 INFO     Epoch [46/200] train_loss: 3.8721, val_loss: 5.1395, lr: 0.003000, 6.20s
2024-09-25 23:27:32 INFO     epoch complete!
2024-09-25 23:27:32 INFO     evaluating now!
2024-09-25 23:27:33 INFO     Epoch [47/200] train_loss: 3.7839, val_loss: 5.0318, lr: 0.003000, 5.87s
2024-09-25 23:27:38 INFO     epoch complete!
2024-09-25 23:27:38 INFO     evaluating now!
2024-09-25 23:27:39 INFO     Epoch [48/200] train_loss: 3.7291, val_loss: 5.1103, lr: 0.003000, 6.13s
2024-09-25 23:27:44 INFO     epoch complete!
2024-09-25 23:27:44 INFO     evaluating now!
2024-09-25 23:27:45 INFO     Epoch [49/200] train_loss: 3.7201, val_loss: 5.2340, lr: 0.003000, 5.85s
2024-09-25 23:27:50 INFO     epoch complete!
2024-09-25 23:27:50 INFO     evaluating now!
2024-09-25 23:27:51 INFO     Epoch [50/200] train_loss: 3.7146, val_loss: 5.1191, lr: 0.003000, 5.96s
2024-09-25 23:27:56 INFO     epoch complete!
2024-09-25 23:27:56 INFO     evaluating now!
2024-09-25 23:27:56 INFO     Epoch [51/200] train_loss: 3.6805, val_loss: 5.0620, lr: 0.003000, 5.82s
2024-09-25 23:28:02 INFO     epoch complete!
2024-09-25 23:28:02 INFO     evaluating now!
2024-09-25 23:28:02 INFO     Epoch [52/200] train_loss: 3.6905, val_loss: 5.1120, lr: 0.003000, 5.95s
2024-09-25 23:28:08 INFO     epoch complete!
2024-09-25 23:28:08 INFO     evaluating now!
2024-09-25 23:28:08 INFO     Epoch [53/200] train_loss: 3.6645, val_loss: 5.1766, lr: 0.003000, 5.89s
2024-09-25 23:28:14 INFO     epoch complete!
2024-09-25 23:28:14 INFO     evaluating now!
2024-09-25 23:28:14 INFO     Epoch [54/200] train_loss: 3.6619, val_loss: 4.9968, lr: 0.003000, 5.83s
2024-09-25 23:28:20 INFO     epoch complete!
2024-09-25 23:28:20 INFO     evaluating now!
2024-09-25 23:28:20 INFO     Epoch [55/200] train_loss: 3.6349, val_loss: 4.9377, lr: 0.003000, 5.82s
2024-09-25 23:28:20 INFO     Saved model at 55
2024-09-25 23:28:20 INFO     Val loss decrease from 4.9639 to 4.9377, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch55.tar
2024-09-25 23:28:26 INFO     epoch complete!
2024-09-25 23:28:26 INFO     evaluating now!
2024-09-25 23:28:26 INFO     Epoch [56/200] train_loss: 3.5525, val_loss: 5.1182, lr: 0.003000, 5.95s
2024-09-25 23:28:32 INFO     epoch complete!
2024-09-25 23:28:32 INFO     evaluating now!
2024-09-25 23:28:32 INFO     Epoch [57/200] train_loss: 3.5480, val_loss: 5.0867, lr: 0.003000, 5.82s
2024-09-25 23:28:37 INFO     epoch complete!
2024-09-25 23:28:37 INFO     evaluating now!
2024-09-25 23:28:38 INFO     Epoch [58/200] train_loss: 3.5345, val_loss: 5.0789, lr: 0.003000, 5.74s
2024-09-25 23:28:43 INFO     epoch complete!
2024-09-25 23:28:43 INFO     evaluating now!
2024-09-25 23:28:43 INFO     Epoch [59/200] train_loss: 3.5349, val_loss: 5.0734, lr: 0.003000, 5.76s
2024-09-25 23:28:49 INFO     epoch complete!
2024-09-25 23:28:49 INFO     evaluating now!
2024-09-25 23:28:49 INFO     Epoch [60/200] train_loss: 3.5398, val_loss: 5.0820, lr: 0.003000, 5.78s
2024-09-25 23:28:55 INFO     epoch complete!
2024-09-25 23:28:55 INFO     evaluating now!
2024-09-25 23:28:55 INFO     Epoch [61/200] train_loss: 3.5439, val_loss: 4.9605, lr: 0.003000, 6.02s
2024-09-25 23:29:01 INFO     epoch complete!
2024-09-25 23:29:01 INFO     evaluating now!
2024-09-25 23:29:01 INFO     Epoch [62/200] train_loss: 3.5445, val_loss: 5.0960, lr: 0.003000, 5.79s
2024-09-25 23:29:07 INFO     epoch complete!
2024-09-25 23:29:07 INFO     evaluating now!
2024-09-25 23:29:07 INFO     Epoch [63/200] train_loss: 3.5241, val_loss: 5.1308, lr: 0.003000, 5.86s
2024-09-25 23:29:12 INFO     epoch complete!
2024-09-25 23:29:12 INFO     evaluating now!
2024-09-25 23:29:13 INFO     Epoch [64/200] train_loss: 3.4688, val_loss: 5.1194, lr: 0.003000, 5.87s
2024-09-25 23:29:18 INFO     epoch complete!
2024-09-25 23:29:18 INFO     evaluating now!
2024-09-25 23:29:19 INFO     Epoch [65/200] train_loss: 3.4797, val_loss: 5.0482, lr: 0.003000, 5.94s
2024-09-25 23:29:24 INFO     epoch complete!
2024-09-25 23:29:24 INFO     evaluating now!
2024-09-25 23:29:25 INFO     Epoch [66/200] train_loss: 3.4616, val_loss: 5.2098, lr: 0.003000, 5.92s
2024-09-25 23:29:30 INFO     epoch complete!
2024-09-25 23:29:30 INFO     evaluating now!
2024-09-25 23:29:30 INFO     Epoch [67/200] train_loss: 3.4406, val_loss: 5.0260, lr: 0.003000, 5.78s
2024-09-25 23:29:36 INFO     epoch complete!
2024-09-25 23:29:36 INFO     evaluating now!
2024-09-25 23:29:37 INFO     Epoch [68/200] train_loss: 3.4479, val_loss: 5.0894, lr: 0.003000, 6.31s
2024-09-25 23:29:42 INFO     epoch complete!
2024-09-25 23:29:42 INFO     evaluating now!
2024-09-25 23:29:42 INFO     Epoch [69/200] train_loss: 3.5094, val_loss: 5.0793, lr: 0.003000, 5.75s
2024-09-25 23:29:48 INFO     epoch complete!
2024-09-25 23:29:48 INFO     evaluating now!
2024-09-25 23:29:48 INFO     Epoch [70/200] train_loss: 3.4602, val_loss: 5.0905, lr: 0.003000, 5.83s
2024-09-25 23:29:48 WARNING  Early stopping at epoch: 70
2024-09-25 23:29:48 INFO     Trained totally 71 epochs, average train time is 5.509s, average eval time is 0.380s
2024-09-25 23:29:48 INFO     Loaded model at 55
2024-09-25 23:29:48 INFO     Saved model at ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406.m
2024-09-25 23:29:48 INFO     Start evaluating ...
2024-09-25 23:29:50 INFO     Note that you select the single mode to evaluate!
2024-09-25 23:29:50 INFO     Evaluate result is saved at ./libcity/cache/19/evaluate_cache/2024_09_25_23_29_50_AGCRN_CHITaxi20190406.csv
2024-09-25 23:29:50 INFO     
         MAE       RMSE
1   2.328094   7.029504
2   2.413920   7.842492
3   2.606948   8.869827
4   2.790587   9.630231
5   2.866010  10.236049
6   3.051052  10.811226
7   3.112841  11.441094
8   3.149106  12.040757
9   3.236840  12.506481
10  3.345419  12.939078
11  3.463033  13.421957
12  3.627446  14.173992
2024-09-25 23:29:50 INFO     ----------------------------------------------------------------------------
2024-09-25 23:29:50 INFO     Kownledge Graph Embedding: GIE, Experiment ids: [15, 16, 17, 18, 19]
2024-09-25 23:29:50 INFO     ----------------------------------------------------------------------------
2024-09-25 23:29:50 INFO     Average: 
         MAE       RMSE
0   2.395908   7.583864
1   2.494091   8.073442
2   2.674506   8.935710
3   2.815699   9.624661
4   2.927876  10.333819
5   3.062435  11.098417
6   3.135443  11.844436
7   3.205082  12.415242
8   3.260505  12.741472
9   3.309912  13.074875
10  3.395168  13.455651
11  3.551213  14.178765 
2024-09-25 23:29:50 INFO     Standard deviation: 
         MAE      RMSE
0   0.085442  0.632854
1   0.099089  0.420421
2   0.075360  0.182020
3   0.061510  0.065688
4   0.072389  0.094384
5   0.079839  0.344855
6   0.085379  0.544359
7   0.067604  0.616005
8   0.052636  0.605679
9   0.089100  0.508809
10  0.084601  0.370100
11  0.078481  0.361070
2024-09-25 23:29:50 INFO     ----------------------------------------------------------------------------
2024-09-25 23:29:50 INFO     12 steps Average: 
        MAE       RMSE
0  3.018986  11.113363
2024-09-25 23:29:50 INFO     12 steps Standard deviation: 
        MAE     RMSE
0  0.077619  0.39552
