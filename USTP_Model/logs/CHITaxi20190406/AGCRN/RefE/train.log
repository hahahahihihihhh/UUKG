2024-04-30 17:55:21 INFO     ----------------------------------------------------------------------------
2024-04-30 17:55:21 INFO     # 0, Kownledge Graph Embedding: RefE, Experiment ids: 35
2024-04-30 17:55:21 INFO     ----------------------------------------------------------------------------
2024-04-30 17:55:21 INFO     Log directory: ./libcity/log
2024-04-30 17:55:21 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=35
2024-04-30 17:55:21 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 924262647, 'exp_id': 35, 'load_external': True, 'embedding_model': 'RefE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 17:55:22 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 17:55:22 INFO     set_weight_link_or_dist: dist
2024-04-30 17:55:22 INFO     init_weight_inf_or_zero: inf
2024-04-30 17:55:22 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 17:55:22 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 17:55:22 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 17:55:22 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 17:55:25 INFO     Dataset created
2024-04-30 17:55:25 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 17:55:25 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 17:55:25 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 17:55:25 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 17:55:25 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 17:55:25 INFO     NoneScaler
2024-04-30 17:55:30 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 17:55:30 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 17:55:30 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 17:55:30 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 17:55:30 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 17:55:30 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 17:55:30 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 17:55:30 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 17:55:30 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 17:55:30 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 17:55:30 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 17:55:30 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 17:55:30 INFO     Total parameter numbers: 874010
2024-04-30 17:55:30 INFO     You select `adam` optimizer.
2024-04-30 17:55:30 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 17:55:30 INFO     Start training ...
2024-04-30 17:55:30 INFO     num_batches:48
2024-04-30 17:55:37 INFO     epoch complete!
2024-04-30 17:55:37 INFO     evaluating now!
2024-04-30 17:55:37 INFO     Epoch [0/200] train_loss: 23.7082, val_loss: 18.7418, lr: 0.003000, 7.18s
2024-04-30 17:55:37 INFO     Saved model at 0
2024-04-30 17:55:37 INFO     Val loss decrease from inf to 18.7418, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 17:55:43 INFO     epoch complete!
2024-04-30 17:55:43 INFO     evaluating now!
2024-04-30 17:55:44 INFO     Epoch [1/200] train_loss: 15.5000, val_loss: 14.9562, lr: 0.003000, 6.63s
2024-04-30 17:55:44 INFO     Saved model at 1
2024-04-30 17:55:44 INFO     Val loss decrease from 18.7418 to 14.9562, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 17:55:51 INFO     epoch complete!
2024-04-30 17:55:51 INFO     evaluating now!
2024-04-30 17:55:51 INFO     Epoch [2/200] train_loss: 12.1512, val_loss: 11.6400, lr: 0.003000, 7.43s
2024-04-30 17:55:51 INFO     Saved model at 2
2024-04-30 17:55:51 INFO     Val loss decrease from 14.9562 to 11.6400, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 17:55:58 INFO     epoch complete!
2024-04-30 17:55:58 INFO     evaluating now!
2024-04-30 17:55:58 INFO     Epoch [3/200] train_loss: 9.9826, val_loss: 9.4354, lr: 0.003000, 6.77s
2024-04-30 17:55:58 INFO     Saved model at 3
2024-04-30 17:55:58 INFO     Val loss decrease from 11.6400 to 9.4354, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 17:56:05 INFO     epoch complete!
2024-04-30 17:56:05 INFO     evaluating now!
2024-04-30 17:56:05 INFO     Epoch [4/200] train_loss: 8.5624, val_loss: 8.0649, lr: 0.003000, 7.05s
2024-04-30 17:56:05 INFO     Saved model at 4
2024-04-30 17:56:05 INFO     Val loss decrease from 9.4354 to 8.0649, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 17:56:12 INFO     epoch complete!
2024-04-30 17:56:12 INFO     evaluating now!
2024-04-30 17:56:12 INFO     Epoch [5/200] train_loss: 7.6685, val_loss: 8.1356, lr: 0.003000, 6.88s
2024-04-30 17:56:19 INFO     epoch complete!
2024-04-30 17:56:19 INFO     evaluating now!
2024-04-30 17:56:19 INFO     Epoch [6/200] train_loss: 7.1605, val_loss: 6.9159, lr: 0.003000, 6.92s
2024-04-30 17:56:19 INFO     Saved model at 6
2024-04-30 17:56:19 INFO     Val loss decrease from 8.0649 to 6.9159, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 17:56:26 INFO     epoch complete!
2024-04-30 17:56:26 INFO     evaluating now!
2024-04-30 17:56:26 INFO     Epoch [7/200] train_loss: 6.7375, val_loss: 7.0657, lr: 0.003000, 6.90s
2024-04-30 17:56:33 INFO     epoch complete!
2024-04-30 17:56:33 INFO     evaluating now!
2024-04-30 17:56:33 INFO     Epoch [8/200] train_loss: 6.4133, val_loss: 6.3398, lr: 0.003000, 7.04s
2024-04-30 17:56:33 INFO     Saved model at 8
2024-04-30 17:56:33 INFO     Val loss decrease from 6.9159 to 6.3398, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 17:56:40 INFO     epoch complete!
2024-04-30 17:56:40 INFO     evaluating now!
2024-04-30 17:56:41 INFO     Epoch [9/200] train_loss: 6.0948, val_loss: 6.1092, lr: 0.003000, 7.59s
2024-04-30 17:56:41 INFO     Saved model at 9
2024-04-30 17:56:41 INFO     Val loss decrease from 6.3398 to 6.1092, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 17:56:47 INFO     epoch complete!
2024-04-30 17:56:47 INFO     evaluating now!
2024-04-30 17:56:48 INFO     Epoch [10/200] train_loss: 5.9543, val_loss: 6.0796, lr: 0.003000, 7.03s
2024-04-30 17:56:48 INFO     Saved model at 10
2024-04-30 17:56:48 INFO     Val loss decrease from 6.1092 to 6.0796, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 17:56:54 INFO     epoch complete!
2024-04-30 17:56:54 INFO     evaluating now!
2024-04-30 17:56:55 INFO     Epoch [11/200] train_loss: 5.7344, val_loss: 6.2107, lr: 0.003000, 6.77s
2024-04-30 17:57:01 INFO     epoch complete!
2024-04-30 17:57:01 INFO     evaluating now!
2024-04-30 17:57:02 INFO     Epoch [12/200] train_loss: 5.6523, val_loss: 5.9797, lr: 0.003000, 7.12s
2024-04-30 17:57:02 INFO     Saved model at 12
2024-04-30 17:57:02 INFO     Val loss decrease from 6.0796 to 5.9797, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 17:57:08 INFO     epoch complete!
2024-04-30 17:57:08 INFO     evaluating now!
2024-04-30 17:57:09 INFO     Epoch [13/200] train_loss: 5.5398, val_loss: 5.7059, lr: 0.003000, 7.03s
2024-04-30 17:57:09 INFO     Saved model at 13
2024-04-30 17:57:09 INFO     Val loss decrease from 5.9797 to 5.7059, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 17:57:15 INFO     epoch complete!
2024-04-30 17:57:15 INFO     evaluating now!
2024-04-30 17:57:16 INFO     Epoch [14/200] train_loss: 5.4560, val_loss: 5.7807, lr: 0.003000, 7.09s
2024-04-30 17:57:23 INFO     epoch complete!
2024-04-30 17:57:23 INFO     evaluating now!
2024-04-30 17:57:23 INFO     Epoch [15/200] train_loss: 5.4009, val_loss: 5.9175, lr: 0.003000, 7.09s
2024-04-30 17:57:30 INFO     epoch complete!
2024-04-30 17:57:30 INFO     evaluating now!
2024-04-30 17:57:30 INFO     Epoch [16/200] train_loss: 5.2717, val_loss: 5.6830, lr: 0.003000, 7.08s
2024-04-30 17:57:30 INFO     Saved model at 16
2024-04-30 17:57:30 INFO     Val loss decrease from 5.7059 to 5.6830, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 17:57:37 INFO     epoch complete!
2024-04-30 17:57:37 INFO     evaluating now!
2024-04-30 17:57:37 INFO     Epoch [17/200] train_loss: 5.1382, val_loss: 5.5679, lr: 0.003000, 7.02s
2024-04-30 17:57:37 INFO     Saved model at 17
2024-04-30 17:57:37 INFO     Val loss decrease from 5.6830 to 5.5679, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 17:57:44 INFO     epoch complete!
2024-04-30 17:57:44 INFO     evaluating now!
2024-04-30 17:57:44 INFO     Epoch [18/200] train_loss: 5.1057, val_loss: 5.4563, lr: 0.003000, 7.06s
2024-04-30 17:57:44 INFO     Saved model at 18
2024-04-30 17:57:44 INFO     Val loss decrease from 5.5679 to 5.4563, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 17:57:51 INFO     epoch complete!
2024-04-30 17:57:51 INFO     evaluating now!
2024-04-30 17:57:51 INFO     Epoch [19/200] train_loss: 4.9189, val_loss: 5.4565, lr: 0.003000, 7.11s
2024-04-30 17:57:58 INFO     epoch complete!
2024-04-30 17:57:58 INFO     evaluating now!
2024-04-30 17:57:58 INFO     Epoch [20/200] train_loss: 4.9448, val_loss: 5.4049, lr: 0.003000, 6.97s
2024-04-30 17:57:58 INFO     Saved model at 20
2024-04-30 17:57:58 INFO     Val loss decrease from 5.4563 to 5.4049, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-30 17:58:05 INFO     epoch complete!
2024-04-30 17:58:05 INFO     evaluating now!
2024-04-30 17:58:05 INFO     Epoch [21/200] train_loss: 4.7636, val_loss: 5.4039, lr: 0.003000, 7.06s
2024-04-30 17:58:05 INFO     Saved model at 21
2024-04-30 17:58:05 INFO     Val loss decrease from 5.4049 to 5.4039, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-30 17:58:12 INFO     epoch complete!
2024-04-30 17:58:12 INFO     evaluating now!
2024-04-30 17:58:13 INFO     Epoch [22/200] train_loss: 4.8815, val_loss: 5.4403, lr: 0.003000, 7.12s
2024-04-30 17:58:19 INFO     epoch complete!
2024-04-30 17:58:19 INFO     evaluating now!
2024-04-30 17:58:20 INFO     Epoch [23/200] train_loss: 4.7856, val_loss: 5.4455, lr: 0.003000, 7.05s
2024-04-30 17:58:26 INFO     epoch complete!
2024-04-30 17:58:26 INFO     evaluating now!
2024-04-30 17:58:26 INFO     Epoch [24/200] train_loss: 4.6742, val_loss: 5.3419, lr: 0.003000, 6.80s
2024-04-30 17:58:26 INFO     Saved model at 24
2024-04-30 17:58:26 INFO     Val loss decrease from 5.4039 to 5.3419, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-04-30 17:58:33 INFO     epoch complete!
2024-04-30 17:58:33 INFO     evaluating now!
2024-04-30 17:58:34 INFO     Epoch [25/200] train_loss: 4.6106, val_loss: 5.2769, lr: 0.003000, 7.04s
2024-04-30 17:58:34 INFO     Saved model at 25
2024-04-30 17:58:34 INFO     Val loss decrease from 5.3419 to 5.2769, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-30 17:58:40 INFO     epoch complete!
2024-04-30 17:58:40 INFO     evaluating now!
2024-04-30 17:58:41 INFO     Epoch [26/200] train_loss: 4.5749, val_loss: 5.2404, lr: 0.003000, 7.04s
2024-04-30 17:58:41 INFO     Saved model at 26
2024-04-30 17:58:41 INFO     Val loss decrease from 5.2769 to 5.2404, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-04-30 17:58:47 INFO     epoch complete!
2024-04-30 17:58:47 INFO     evaluating now!
2024-04-30 17:58:48 INFO     Epoch [27/200] train_loss: 4.5262, val_loss: 5.3477, lr: 0.003000, 6.92s
2024-04-30 17:58:54 INFO     epoch complete!
2024-04-30 17:58:54 INFO     evaluating now!
2024-04-30 17:58:55 INFO     Epoch [28/200] train_loss: 4.4782, val_loss: 5.2494, lr: 0.003000, 7.03s
2024-04-30 17:59:01 INFO     epoch complete!
2024-04-30 17:59:01 INFO     evaluating now!
2024-04-30 17:59:02 INFO     Epoch [29/200] train_loss: 4.4238, val_loss: 5.2970, lr: 0.003000, 7.01s
2024-04-30 17:59:08 INFO     epoch complete!
2024-04-30 17:59:08 INFO     evaluating now!
2024-04-30 17:59:09 INFO     Epoch [30/200] train_loss: 4.3718, val_loss: 5.2151, lr: 0.003000, 7.07s
2024-04-30 17:59:09 INFO     Saved model at 30
2024-04-30 17:59:09 INFO     Val loss decrease from 5.2404 to 5.2151, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-04-30 17:59:16 INFO     epoch complete!
2024-04-30 17:59:16 INFO     evaluating now!
2024-04-30 17:59:16 INFO     Epoch [31/200] train_loss: 4.4200, val_loss: 5.4274, lr: 0.003000, 7.47s
2024-04-30 17:59:23 INFO     epoch complete!
2024-04-30 17:59:23 INFO     evaluating now!
2024-04-30 17:59:23 INFO     Epoch [32/200] train_loss: 4.3368, val_loss: 5.3035, lr: 0.003000, 6.90s
2024-04-30 17:59:30 INFO     epoch complete!
2024-04-30 17:59:30 INFO     evaluating now!
2024-04-30 17:59:30 INFO     Epoch [33/200] train_loss: 4.2805, val_loss: 5.0779, lr: 0.003000, 7.17s
2024-04-30 17:59:30 INFO     Saved model at 33
2024-04-30 17:59:30 INFO     Val loss decrease from 5.2151 to 5.0779, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-04-30 17:59:37 INFO     epoch complete!
2024-04-30 17:59:37 INFO     evaluating now!
2024-04-30 17:59:37 INFO     Epoch [34/200] train_loss: 4.2334, val_loss: 5.2576, lr: 0.003000, 7.19s
2024-04-30 17:59:44 INFO     epoch complete!
2024-04-30 17:59:44 INFO     evaluating now!
2024-04-30 17:59:45 INFO     Epoch [35/200] train_loss: 4.1886, val_loss: 5.1827, lr: 0.003000, 7.19s
2024-04-30 17:59:52 INFO     epoch complete!
2024-04-30 17:59:52 INFO     evaluating now!
2024-04-30 17:59:52 INFO     Epoch [36/200] train_loss: 4.1111, val_loss: 5.2607, lr: 0.003000, 7.37s
2024-04-30 17:59:59 INFO     epoch complete!
2024-04-30 17:59:59 INFO     evaluating now!
2024-04-30 17:59:59 INFO     Epoch [37/200] train_loss: 4.2155, val_loss: 5.1926, lr: 0.003000, 6.95s
2024-04-30 18:00:06 INFO     epoch complete!
2024-04-30 18:00:06 INFO     evaluating now!
2024-04-30 18:00:06 INFO     Epoch [38/200] train_loss: 4.1018, val_loss: 5.2477, lr: 0.003000, 7.28s
2024-04-30 18:00:13 INFO     epoch complete!
2024-04-30 18:00:13 INFO     evaluating now!
2024-04-30 18:00:13 INFO     Epoch [39/200] train_loss: 4.1552, val_loss: 5.0847, lr: 0.003000, 7.15s
2024-04-30 18:00:20 INFO     epoch complete!
2024-04-30 18:00:20 INFO     evaluating now!
2024-04-30 18:00:21 INFO     Epoch [40/200] train_loss: 4.0762, val_loss: 5.2305, lr: 0.003000, 7.21s
2024-04-30 18:00:27 INFO     epoch complete!
2024-04-30 18:00:27 INFO     evaluating now!
2024-04-30 18:00:28 INFO     Epoch [41/200] train_loss: 4.1168, val_loss: 5.1784, lr: 0.003000, 7.02s
2024-04-30 18:00:34 INFO     epoch complete!
2024-04-30 18:00:34 INFO     evaluating now!
2024-04-30 18:00:35 INFO     Epoch [42/200] train_loss: 4.0149, val_loss: 5.1179, lr: 0.003000, 7.03s
2024-04-30 18:00:41 INFO     epoch complete!
2024-04-30 18:00:41 INFO     evaluating now!
2024-04-30 18:00:42 INFO     Epoch [43/200] train_loss: 4.0004, val_loss: 5.0813, lr: 0.003000, 7.21s
2024-04-30 18:00:48 INFO     epoch complete!
2024-04-30 18:00:48 INFO     evaluating now!
2024-04-30 18:00:49 INFO     Epoch [44/200] train_loss: 3.9598, val_loss: 5.2243, lr: 0.003000, 6.92s
2024-04-30 18:00:55 INFO     epoch complete!
2024-04-30 18:00:55 INFO     evaluating now!
2024-04-30 18:00:56 INFO     Epoch [45/200] train_loss: 4.1411, val_loss: 5.4812, lr: 0.003000, 6.90s
2024-04-30 18:01:02 INFO     epoch complete!
2024-04-30 18:01:02 INFO     evaluating now!
2024-04-30 18:01:02 INFO     Epoch [46/200] train_loss: 4.1066, val_loss: 5.2426, lr: 0.003000, 6.77s
2024-04-30 18:01:09 INFO     epoch complete!
2024-04-30 18:01:09 INFO     evaluating now!
2024-04-30 18:01:09 INFO     Epoch [47/200] train_loss: 3.9602, val_loss: 5.1442, lr: 0.003000, 6.77s
2024-04-30 18:01:15 INFO     epoch complete!
2024-04-30 18:01:15 INFO     evaluating now!
2024-04-30 18:01:16 INFO     Epoch [48/200] train_loss: 3.9352, val_loss: 5.0432, lr: 0.003000, 6.59s
2024-04-30 18:01:16 INFO     Saved model at 48
2024-04-30 18:01:16 INFO     Val loss decrease from 5.0779 to 5.0432, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-04-30 18:01:22 INFO     epoch complete!
2024-04-30 18:01:22 INFO     evaluating now!
2024-04-30 18:01:22 INFO     Epoch [49/200] train_loss: 3.8746, val_loss: 5.2709, lr: 0.003000, 6.33s
2024-04-30 18:01:28 INFO     epoch complete!
2024-04-30 18:01:28 INFO     evaluating now!
2024-04-30 18:01:28 INFO     Epoch [50/200] train_loss: 3.8698, val_loss: 5.0408, lr: 0.003000, 6.25s
2024-04-30 18:01:29 INFO     Saved model at 50
2024-04-30 18:01:29 INFO     Val loss decrease from 5.0432 to 5.0408, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch50.tar
2024-04-30 18:01:34 INFO     epoch complete!
2024-04-30 18:01:34 INFO     evaluating now!
2024-04-30 18:01:35 INFO     Epoch [51/200] train_loss: 3.8346, val_loss: 5.1469, lr: 0.003000, 6.18s
2024-04-30 18:01:40 INFO     epoch complete!
2024-04-30 18:01:40 INFO     evaluating now!
2024-04-30 18:01:41 INFO     Epoch [52/200] train_loss: 3.7875, val_loss: 5.0512, lr: 0.003000, 6.05s
2024-04-30 18:01:46 INFO     epoch complete!
2024-04-30 18:01:46 INFO     evaluating now!
2024-04-30 18:01:47 INFO     Epoch [53/200] train_loss: 3.7136, val_loss: 4.9616, lr: 0.003000, 5.91s
2024-04-30 18:01:47 INFO     Saved model at 53
2024-04-30 18:01:47 INFO     Val loss decrease from 5.0408 to 4.9616, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch53.tar
2024-04-30 18:01:53 INFO     epoch complete!
2024-04-30 18:01:53 INFO     evaluating now!
2024-04-30 18:01:53 INFO     Epoch [54/200] train_loss: 3.7144, val_loss: 5.0172, lr: 0.003000, 6.66s
2024-04-30 18:02:00 INFO     epoch complete!
2024-04-30 18:02:00 INFO     evaluating now!
2024-04-30 18:02:00 INFO     Epoch [55/200] train_loss: 3.7364, val_loss: 5.0715, lr: 0.003000, 6.77s
2024-04-30 18:02:07 INFO     epoch complete!
2024-04-30 18:02:07 INFO     evaluating now!
2024-04-30 18:02:07 INFO     Epoch [56/200] train_loss: 3.7789, val_loss: 4.9725, lr: 0.003000, 7.12s
2024-04-30 18:02:13 INFO     epoch complete!
2024-04-30 18:02:13 INFO     evaluating now!
2024-04-30 18:02:14 INFO     Epoch [57/200] train_loss: 3.7546, val_loss: 5.0843, lr: 0.003000, 6.36s
2024-04-30 18:02:20 INFO     epoch complete!
2024-04-30 18:02:20 INFO     evaluating now!
2024-04-30 18:02:20 INFO     Epoch [58/200] train_loss: 3.7004, val_loss: 5.1958, lr: 0.003000, 6.41s
2024-04-30 18:02:26 INFO     epoch complete!
2024-04-30 18:02:26 INFO     evaluating now!
2024-04-30 18:02:27 INFO     Epoch [59/200] train_loss: 3.7120, val_loss: 5.0638, lr: 0.003000, 6.50s
2024-04-30 18:02:33 INFO     epoch complete!
2024-04-30 18:02:33 INFO     evaluating now!
2024-04-30 18:02:33 INFO     Epoch [60/200] train_loss: 3.6389, val_loss: 5.1403, lr: 0.003000, 6.62s
2024-04-30 18:02:39 INFO     epoch complete!
2024-04-30 18:02:39 INFO     evaluating now!
2024-04-30 18:02:40 INFO     Epoch [61/200] train_loss: 3.5936, val_loss: 5.0664, lr: 0.003000, 6.37s
2024-04-30 18:02:46 INFO     epoch complete!
2024-04-30 18:02:46 INFO     evaluating now!
2024-04-30 18:02:46 INFO     Epoch [62/200] train_loss: 3.6212, val_loss: 5.0263, lr: 0.003000, 6.53s
2024-04-30 18:02:52 INFO     epoch complete!
2024-04-30 18:02:52 INFO     evaluating now!
2024-04-30 18:02:53 INFO     Epoch [63/200] train_loss: 3.6157, val_loss: 5.0698, lr: 0.003000, 6.55s
2024-04-30 18:02:59 INFO     epoch complete!
2024-04-30 18:02:59 INFO     evaluating now!
2024-04-30 18:03:00 INFO     Epoch [64/200] train_loss: 3.6000, val_loss: 5.0743, lr: 0.003000, 6.94s
2024-04-30 18:03:06 INFO     epoch complete!
2024-04-30 18:03:06 INFO     evaluating now!
2024-04-30 18:03:06 INFO     Epoch [65/200] train_loss: 3.6792, val_loss: 5.1785, lr: 0.003000, 6.44s
2024-04-30 18:03:12 INFO     epoch complete!
2024-04-30 18:03:12 INFO     evaluating now!
2024-04-30 18:03:13 INFO     Epoch [66/200] train_loss: 3.6538, val_loss: 5.1273, lr: 0.003000, 6.57s
2024-04-30 18:03:18 INFO     epoch complete!
2024-04-30 18:03:18 INFO     evaluating now!
2024-04-30 18:03:19 INFO     Epoch [67/200] train_loss: 3.5446, val_loss: 5.0562, lr: 0.003000, 6.34s
2024-04-30 18:03:25 INFO     epoch complete!
2024-04-30 18:03:25 INFO     evaluating now!
2024-04-30 18:03:25 INFO     Epoch [68/200] train_loss: 3.5172, val_loss: 4.9847, lr: 0.003000, 6.14s
2024-04-30 18:03:25 WARNING  Early stopping at epoch: 68
2024-04-30 18:03:25 INFO     Trained totally 69 epochs, average train time is 6.424s, average eval time is 0.444s
2024-04-30 18:03:25 INFO     Loaded model at 53
2024-04-30 18:03:25 INFO     Saved model at ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 18:03:25 INFO     Start evaluating ...
2024-04-30 18:03:27 INFO     Note that you select the single mode to evaluate!
2024-04-30 18:03:27 INFO     Evaluate result is saved at ./libcity/cache/35/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 18:03:27 INFO     
         MAE       RMSE
1   2.393711   7.488731
2   2.449599   7.940385
3   2.627035   8.746838
4   2.671927   9.151500
5   2.791726   9.735708
6   2.914926  10.358109
7   3.084403  11.315269
8   3.233918  12.331502
9   3.235630  12.888963
10  3.317362  13.302497
11  3.381680  13.620811
12  3.441056  14.084060
2024-04-30 18:03:27 INFO     ----------------------------------------------------------------------------
2024-04-30 18:03:27 INFO     # 1, Kownledge Graph Embedding: RefE, Experiment ids: 36
2024-04-30 18:03:27 INFO     ----------------------------------------------------------------------------
2024-04-30 18:03:27 INFO     Log directory: ./libcity/log
2024-04-30 18:03:27 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=36
2024-04-30 18:03:27 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 515091077, 'exp_id': 36, 'load_external': True, 'embedding_model': 'RefE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 18:03:27 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 18:03:27 INFO     set_weight_link_or_dist: dist
2024-04-30 18:03:27 INFO     init_weight_inf_or_zero: inf
2024-04-30 18:03:27 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 18:03:27 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 18:03:27 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 18:03:27 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 18:03:30 INFO     Dataset created
2024-04-30 18:03:30 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 18:03:30 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 18:03:30 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 18:03:30 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 18:03:30 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 18:03:30 INFO     NoneScaler
2024-04-30 18:03:32 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 18:03:32 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 18:03:32 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 18:03:32 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 18:03:32 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 18:03:32 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 18:03:32 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 18:03:32 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 18:03:32 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 18:03:32 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 18:03:32 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 18:03:32 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 18:03:32 INFO     Total parameter numbers: 874010
2024-04-30 18:03:32 INFO     You select `adam` optimizer.
2024-04-30 18:03:32 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 18:03:32 INFO     Start training ...
2024-04-30 18:03:32 INFO     num_batches:48
2024-04-30 18:03:38 INFO     epoch complete!
2024-04-30 18:03:38 INFO     evaluating now!
2024-04-30 18:03:38 INFO     Epoch [0/200] train_loss: 25.1063, val_loss: 18.8083, lr: 0.003000, 6.17s
2024-04-30 18:03:38 INFO     Saved model at 0
2024-04-30 18:03:38 INFO     Val loss decrease from inf to 18.8083, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 18:03:44 INFO     epoch complete!
2024-04-30 18:03:44 INFO     evaluating now!
2024-04-30 18:03:45 INFO     Epoch [1/200] train_loss: 15.7249, val_loss: 15.5041, lr: 0.003000, 6.24s
2024-04-30 18:03:45 INFO     Saved model at 1
2024-04-30 18:03:45 INFO     Val loss decrease from 18.8083 to 15.5041, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 18:03:50 INFO     epoch complete!
2024-04-30 18:03:50 INFO     evaluating now!
2024-04-30 18:03:51 INFO     Epoch [2/200] train_loss: 13.2850, val_loss: 13.2986, lr: 0.003000, 6.18s
2024-04-30 18:03:51 INFO     Saved model at 2
2024-04-30 18:03:51 INFO     Val loss decrease from 15.5041 to 13.2986, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 18:03:57 INFO     epoch complete!
2024-04-30 18:03:57 INFO     evaluating now!
2024-04-30 18:03:57 INFO     Epoch [3/200] train_loss: 11.2328, val_loss: 11.1805, lr: 0.003000, 6.17s
2024-04-30 18:03:57 INFO     Saved model at 3
2024-04-30 18:03:57 INFO     Val loss decrease from 13.2986 to 11.1805, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 18:04:03 INFO     epoch complete!
2024-04-30 18:04:03 INFO     evaluating now!
2024-04-30 18:04:03 INFO     Epoch [4/200] train_loss: 9.7543, val_loss: 9.8067, lr: 0.003000, 6.22s
2024-04-30 18:04:03 INFO     Saved model at 4
2024-04-30 18:04:03 INFO     Val loss decrease from 11.1805 to 9.8067, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 18:04:09 INFO     epoch complete!
2024-04-30 18:04:09 INFO     evaluating now!
2024-04-30 18:04:10 INFO     Epoch [5/200] train_loss: 8.5502, val_loss: 8.4246, lr: 0.003000, 6.24s
2024-04-30 18:04:10 INFO     Saved model at 5
2024-04-30 18:04:10 INFO     Val loss decrease from 9.8067 to 8.4246, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 18:04:15 INFO     epoch complete!
2024-04-30 18:04:15 INFO     evaluating now!
2024-04-30 18:04:16 INFO     Epoch [6/200] train_loss: 7.8964, val_loss: 7.6711, lr: 0.003000, 6.14s
2024-04-30 18:04:16 INFO     Saved model at 6
2024-04-30 18:04:16 INFO     Val loss decrease from 8.4246 to 7.6711, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 18:04:22 INFO     epoch complete!
2024-04-30 18:04:22 INFO     evaluating now!
2024-04-30 18:04:22 INFO     Epoch [7/200] train_loss: 7.2306, val_loss: 7.2935, lr: 0.003000, 6.27s
2024-04-30 18:04:22 INFO     Saved model at 7
2024-04-30 18:04:22 INFO     Val loss decrease from 7.6711 to 7.2935, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 18:04:28 INFO     epoch complete!
2024-04-30 18:04:28 INFO     evaluating now!
2024-04-30 18:04:28 INFO     Epoch [8/200] train_loss: 6.8599, val_loss: 6.7645, lr: 0.003000, 6.27s
2024-04-30 18:04:28 INFO     Saved model at 8
2024-04-30 18:04:28 INFO     Val loss decrease from 7.2935 to 6.7645, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 18:04:34 INFO     epoch complete!
2024-04-30 18:04:34 INFO     evaluating now!
2024-04-30 18:04:35 INFO     Epoch [9/200] train_loss: 6.6099, val_loss: 6.6714, lr: 0.003000, 6.23s
2024-04-30 18:04:35 INFO     Saved model at 9
2024-04-30 18:04:35 INFO     Val loss decrease from 6.7645 to 6.6714, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 18:04:41 INFO     epoch complete!
2024-04-30 18:04:41 INFO     evaluating now!
2024-04-30 18:04:41 INFO     Epoch [10/200] train_loss: 6.1816, val_loss: 6.5305, lr: 0.003000, 6.25s
2024-04-30 18:04:41 INFO     Saved model at 10
2024-04-30 18:04:41 INFO     Val loss decrease from 6.6714 to 6.5305, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 18:04:47 INFO     epoch complete!
2024-04-30 18:04:47 INFO     evaluating now!
2024-04-30 18:04:47 INFO     Epoch [11/200] train_loss: 6.0087, val_loss: 6.2598, lr: 0.003000, 6.30s
2024-04-30 18:04:47 INFO     Saved model at 11
2024-04-30 18:04:47 INFO     Val loss decrease from 6.5305 to 6.2598, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 18:04:53 INFO     epoch complete!
2024-04-30 18:04:53 INFO     evaluating now!
2024-04-30 18:04:54 INFO     Epoch [12/200] train_loss: 5.8562, val_loss: 6.3246, lr: 0.003000, 6.13s
2024-04-30 18:05:00 INFO     epoch complete!
2024-04-30 18:05:00 INFO     evaluating now!
2024-04-30 18:05:00 INFO     Epoch [13/200] train_loss: 5.7476, val_loss: 5.9916, lr: 0.003000, 6.48s
2024-04-30 18:05:00 INFO     Saved model at 13
2024-04-30 18:05:00 INFO     Val loss decrease from 6.2598 to 5.9916, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 18:05:06 INFO     epoch complete!
2024-04-30 18:05:06 INFO     evaluating now!
2024-04-30 18:05:07 INFO     Epoch [14/200] train_loss: 5.5710, val_loss: 5.7716, lr: 0.003000, 6.71s
2024-04-30 18:05:07 INFO     Saved model at 14
2024-04-30 18:05:07 INFO     Val loss decrease from 5.9916 to 5.7716, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 18:05:13 INFO     epoch complete!
2024-04-30 18:05:13 INFO     evaluating now!
2024-04-30 18:05:13 INFO     Epoch [15/200] train_loss: 5.4672, val_loss: 5.9033, lr: 0.003000, 6.20s
2024-04-30 18:05:19 INFO     epoch complete!
2024-04-30 18:05:19 INFO     evaluating now!
2024-04-30 18:05:19 INFO     Epoch [16/200] train_loss: 5.4334, val_loss: 5.7251, lr: 0.003000, 6.27s
2024-04-30 18:05:19 INFO     Saved model at 16
2024-04-30 18:05:19 INFO     Val loss decrease from 5.7716 to 5.7251, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 18:05:25 INFO     epoch complete!
2024-04-30 18:05:25 INFO     evaluating now!
2024-04-30 18:05:26 INFO     Epoch [17/200] train_loss: 5.1941, val_loss: 5.6541, lr: 0.003000, 6.37s
2024-04-30 18:05:26 INFO     Saved model at 17
2024-04-30 18:05:26 INFO     Val loss decrease from 5.7251 to 5.6541, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 18:05:32 INFO     epoch complete!
2024-04-30 18:05:32 INFO     evaluating now!
2024-04-30 18:05:32 INFO     Epoch [18/200] train_loss: 5.1681, val_loss: 5.5472, lr: 0.003000, 6.29s
2024-04-30 18:05:32 INFO     Saved model at 18
2024-04-30 18:05:32 INFO     Val loss decrease from 5.6541 to 5.5472, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 18:05:38 INFO     epoch complete!
2024-04-30 18:05:38 INFO     evaluating now!
2024-04-30 18:05:38 INFO     Epoch [19/200] train_loss: 5.1178, val_loss: 5.4916, lr: 0.003000, 6.26s
2024-04-30 18:05:38 INFO     Saved model at 19
2024-04-30 18:05:38 INFO     Val loss decrease from 5.5472 to 5.4916, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 18:05:44 INFO     epoch complete!
2024-04-30 18:05:44 INFO     evaluating now!
2024-04-30 18:05:45 INFO     Epoch [20/200] train_loss: 5.0506, val_loss: 5.4172, lr: 0.003000, 6.25s
2024-04-30 18:05:45 INFO     Saved model at 20
2024-04-30 18:05:45 INFO     Val loss decrease from 5.4916 to 5.4172, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-30 18:05:51 INFO     epoch complete!
2024-04-30 18:05:51 INFO     evaluating now!
2024-04-30 18:05:51 INFO     Epoch [21/200] train_loss: 5.0098, val_loss: 5.5247, lr: 0.003000, 6.29s
2024-04-30 18:05:57 INFO     epoch complete!
2024-04-30 18:05:57 INFO     evaluating now!
2024-04-30 18:05:57 INFO     Epoch [22/200] train_loss: 4.9210, val_loss: 5.4544, lr: 0.003000, 6.43s
2024-04-30 18:06:03 INFO     epoch complete!
2024-04-30 18:06:03 INFO     evaluating now!
2024-04-30 18:06:04 INFO     Epoch [23/200] train_loss: 4.8532, val_loss: 5.4419, lr: 0.003000, 6.31s
2024-04-30 18:06:10 INFO     epoch complete!
2024-04-30 18:06:10 INFO     evaluating now!
2024-04-30 18:06:10 INFO     Epoch [24/200] train_loss: 4.7193, val_loss: 5.2533, lr: 0.003000, 6.36s
2024-04-30 18:06:10 INFO     Saved model at 24
2024-04-30 18:06:10 INFO     Val loss decrease from 5.4172 to 5.2533, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-04-30 18:06:16 INFO     epoch complete!
2024-04-30 18:06:16 INFO     evaluating now!
2024-04-30 18:06:16 INFO     Epoch [25/200] train_loss: 4.7415, val_loss: 5.4127, lr: 0.003000, 6.20s
2024-04-30 18:06:22 INFO     epoch complete!
2024-04-30 18:06:22 INFO     evaluating now!
2024-04-30 18:06:23 INFO     Epoch [26/200] train_loss: 4.6893, val_loss: 5.0695, lr: 0.003000, 6.29s
2024-04-30 18:06:23 INFO     Saved model at 26
2024-04-30 18:06:23 INFO     Val loss decrease from 5.2533 to 5.0695, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-04-30 18:06:29 INFO     epoch complete!
2024-04-30 18:06:29 INFO     evaluating now!
2024-04-30 18:06:29 INFO     Epoch [27/200] train_loss: 4.5821, val_loss: 5.4625, lr: 0.003000, 6.32s
2024-04-30 18:06:35 INFO     epoch complete!
2024-04-30 18:06:35 INFO     evaluating now!
2024-04-30 18:06:35 INFO     Epoch [28/200] train_loss: 4.5873, val_loss: 5.2474, lr: 0.003000, 6.19s
2024-04-30 18:06:41 INFO     epoch complete!
2024-04-30 18:06:41 INFO     evaluating now!
2024-04-30 18:06:41 INFO     Epoch [29/200] train_loss: 4.5522, val_loss: 5.1499, lr: 0.003000, 6.15s
2024-04-30 18:06:47 INFO     epoch complete!
2024-04-30 18:06:47 INFO     evaluating now!
2024-04-30 18:06:47 INFO     Epoch [30/200] train_loss: 4.4412, val_loss: 5.0228, lr: 0.003000, 6.19s
2024-04-30 18:06:47 INFO     Saved model at 30
2024-04-30 18:06:48 INFO     Val loss decrease from 5.0695 to 5.0228, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-04-30 18:06:53 INFO     epoch complete!
2024-04-30 18:06:53 INFO     evaluating now!
2024-04-30 18:06:54 INFO     Epoch [31/200] train_loss: 4.4080, val_loss: 5.2543, lr: 0.003000, 6.08s
2024-04-30 18:07:00 INFO     epoch complete!
2024-04-30 18:07:00 INFO     evaluating now!
2024-04-30 18:07:00 INFO     Epoch [32/200] train_loss: 4.3600, val_loss: 5.1209, lr: 0.003000, 6.56s
2024-04-30 18:07:06 INFO     epoch complete!
2024-04-30 18:07:06 INFO     evaluating now!
2024-04-30 18:07:06 INFO     Epoch [33/200] train_loss: 4.3443, val_loss: 5.1751, lr: 0.003000, 6.32s
2024-04-30 18:07:12 INFO     epoch complete!
2024-04-30 18:07:12 INFO     evaluating now!
2024-04-30 18:07:13 INFO     Epoch [34/200] train_loss: 4.2951, val_loss: 5.2736, lr: 0.003000, 6.26s
2024-04-30 18:07:19 INFO     epoch complete!
2024-04-30 18:07:19 INFO     evaluating now!
2024-04-30 18:07:19 INFO     Epoch [35/200] train_loss: 4.2133, val_loss: 5.0848, lr: 0.003000, 6.26s
2024-04-30 18:07:25 INFO     epoch complete!
2024-04-30 18:07:25 INFO     evaluating now!
2024-04-30 18:07:25 INFO     Epoch [36/200] train_loss: 4.2808, val_loss: 5.2855, lr: 0.003000, 6.38s
2024-04-30 18:07:31 INFO     epoch complete!
2024-04-30 18:07:31 INFO     evaluating now!
2024-04-30 18:07:32 INFO     Epoch [37/200] train_loss: 4.1919, val_loss: 5.1128, lr: 0.003000, 6.30s
2024-04-30 18:07:38 INFO     epoch complete!
2024-04-30 18:07:38 INFO     evaluating now!
2024-04-30 18:07:38 INFO     Epoch [38/200] train_loss: 4.1780, val_loss: 5.3759, lr: 0.003000, 6.58s
2024-04-30 18:07:44 INFO     epoch complete!
2024-04-30 18:07:44 INFO     evaluating now!
2024-04-30 18:07:44 INFO     Epoch [39/200] train_loss: 4.1592, val_loss: 5.2615, lr: 0.003000, 5.84s
2024-04-30 18:07:50 INFO     epoch complete!
2024-04-30 18:07:50 INFO     evaluating now!
2024-04-30 18:07:51 INFO     Epoch [40/200] train_loss: 4.0951, val_loss: 5.1217, lr: 0.003000, 6.43s
2024-04-30 18:07:57 INFO     epoch complete!
2024-04-30 18:07:57 INFO     evaluating now!
2024-04-30 18:07:57 INFO     Epoch [41/200] train_loss: 4.1601, val_loss: 5.2169, lr: 0.003000, 6.52s
2024-04-30 18:08:03 INFO     epoch complete!
2024-04-30 18:08:03 INFO     evaluating now!
2024-04-30 18:08:03 INFO     Epoch [42/200] train_loss: 4.0856, val_loss: 4.9312, lr: 0.003000, 6.35s
2024-04-30 18:08:03 INFO     Saved model at 42
2024-04-30 18:08:03 INFO     Val loss decrease from 5.0228 to 4.9312, saving to ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-04-30 18:08:09 INFO     epoch complete!
2024-04-30 18:08:09 INFO     evaluating now!
2024-04-30 18:08:09 INFO     Epoch [43/200] train_loss: 4.0352, val_loss: 5.0499, lr: 0.003000, 6.05s
2024-04-30 18:08:15 INFO     epoch complete!
2024-04-30 18:08:15 INFO     evaluating now!
2024-04-30 18:08:16 INFO     Epoch [44/200] train_loss: 3.9549, val_loss: 5.0382, lr: 0.003000, 6.19s
2024-04-30 18:08:22 INFO     epoch complete!
2024-04-30 18:08:22 INFO     evaluating now!
2024-04-30 18:08:22 INFO     Epoch [45/200] train_loss: 4.0053, val_loss: 4.9954, lr: 0.003000, 6.60s
2024-04-30 18:08:29 INFO     epoch complete!
2024-04-30 18:08:29 INFO     evaluating now!
2024-04-30 18:08:29 INFO     Epoch [46/200] train_loss: 3.9695, val_loss: 5.1460, lr: 0.003000, 6.96s
2024-04-30 18:08:36 INFO     epoch complete!
2024-04-30 18:08:36 INFO     evaluating now!
2024-04-30 18:08:37 INFO     Epoch [47/200] train_loss: 3.9070, val_loss: 5.0157, lr: 0.003000, 7.27s
2024-04-30 18:08:43 INFO     epoch complete!
2024-04-30 18:08:43 INFO     evaluating now!
2024-04-30 18:08:44 INFO     Epoch [48/200] train_loss: 3.9061, val_loss: 5.0292, lr: 0.003000, 7.43s
2024-04-30 18:08:51 INFO     epoch complete!
2024-04-30 18:08:51 INFO     evaluating now!
2024-04-30 18:08:51 INFO     Epoch [49/200] train_loss: 3.8256, val_loss: 5.2516, lr: 0.003000, 7.45s
2024-04-30 18:08:58 INFO     epoch complete!
2024-04-30 18:08:58 INFO     evaluating now!
2024-04-30 18:08:59 INFO     Epoch [50/200] train_loss: 3.8855, val_loss: 5.1495, lr: 0.003000, 7.41s
2024-04-30 18:09:06 INFO     epoch complete!
2024-04-30 18:09:06 INFO     evaluating now!
2024-04-30 18:09:06 INFO     Epoch [51/200] train_loss: 3.8452, val_loss: 4.9399, lr: 0.003000, 7.41s
2024-04-30 18:09:13 INFO     epoch complete!
2024-04-30 18:09:13 INFO     evaluating now!
2024-04-30 18:09:14 INFO     Epoch [52/200] train_loss: 3.7852, val_loss: 5.0964, lr: 0.003000, 7.37s
2024-04-30 18:09:21 INFO     epoch complete!
2024-04-30 18:09:21 INFO     evaluating now!
2024-04-30 18:09:21 INFO     Epoch [53/200] train_loss: 3.8536, val_loss: 4.9937, lr: 0.003000, 7.51s
2024-04-30 18:09:28 INFO     epoch complete!
2024-04-30 18:09:28 INFO     evaluating now!
2024-04-30 18:09:29 INFO     Epoch [54/200] train_loss: 3.7565, val_loss: 5.0638, lr: 0.003000, 7.42s
2024-04-30 18:09:35 INFO     epoch complete!
2024-04-30 18:09:35 INFO     evaluating now!
2024-04-30 18:09:36 INFO     Epoch [55/200] train_loss: 3.7479, val_loss: 5.1909, lr: 0.003000, 7.29s
2024-04-30 18:09:43 INFO     epoch complete!
2024-04-30 18:09:43 INFO     evaluating now!
2024-04-30 18:09:43 INFO     Epoch [56/200] train_loss: 3.7526, val_loss: 5.0317, lr: 0.003000, 7.32s
2024-04-30 18:09:50 INFO     epoch complete!
2024-04-30 18:09:50 INFO     evaluating now!
2024-04-30 18:09:51 INFO     Epoch [57/200] train_loss: 3.7820, val_loss: 5.0038, lr: 0.003000, 7.47s
2024-04-30 18:09:51 WARNING  Early stopping at epoch: 57
2024-04-30 18:09:51 INFO     Trained totally 58 epochs, average train time is 6.068s, average eval time is 0.436s
2024-04-30 18:09:51 INFO     Loaded model at 42
2024-04-30 18:09:51 INFO     Saved model at ./libcity/cache/36/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 18:09:51 INFO     Start evaluating ...
2024-04-30 18:09:52 INFO     Note that you select the single mode to evaluate!
2024-04-30 18:09:52 INFO     Evaluate result is saved at ./libcity/cache/36/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 18:09:52 INFO     
         MAE       RMSE
1   2.377949   7.237888
2   2.449923   7.699889
3   2.538840   8.538446
4   2.709487   9.239233
5   2.799345  10.063310
6   2.894100  10.872616
7   2.997251  11.630426
8   3.071821  12.248675
9   3.119746  12.564291
10  3.137846  12.807159
11  3.236550  12.924739
12  3.366077  13.443532
2024-04-30 18:09:52 INFO     ----------------------------------------------------------------------------
2024-04-30 18:09:52 INFO     # 2, Kownledge Graph Embedding: RefE, Experiment ids: 37
2024-04-30 18:09:52 INFO     ----------------------------------------------------------------------------
2024-04-30 18:09:53 INFO     Log directory: ./libcity/log
2024-04-30 18:09:53 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=37
2024-04-30 18:09:53 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 546502829, 'exp_id': 37, 'load_external': True, 'embedding_model': 'RefE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 18:09:53 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 18:09:53 INFO     set_weight_link_or_dist: dist
2024-04-30 18:09:53 INFO     init_weight_inf_or_zero: inf
2024-04-30 18:09:53 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 18:09:53 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 18:09:53 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 18:09:53 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 18:09:56 INFO     Dataset created
2024-04-30 18:09:56 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 18:09:56 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 18:09:56 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 18:09:56 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 18:09:56 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 18:09:56 INFO     NoneScaler
2024-04-30 18:09:58 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 18:09:58 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 18:09:58 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 18:09:58 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 18:09:58 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 18:09:58 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 18:09:58 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 18:09:58 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 18:09:58 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 18:09:58 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 18:09:58 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 18:09:58 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 18:09:58 INFO     Total parameter numbers: 874010
2024-04-30 18:09:58 INFO     You select `adam` optimizer.
2024-04-30 18:09:58 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 18:09:58 INFO     Start training ...
2024-04-30 18:09:58 INFO     num_batches:48
2024-04-30 18:10:05 INFO     epoch complete!
2024-04-30 18:10:05 INFO     evaluating now!
2024-04-30 18:10:05 INFO     Epoch [0/200] train_loss: 24.5191, val_loss: 18.6067, lr: 0.003000, 7.30s
2024-04-30 18:10:05 INFO     Saved model at 0
2024-04-30 18:10:05 INFO     Val loss decrease from inf to 18.6067, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 18:10:12 INFO     epoch complete!
2024-04-30 18:10:12 INFO     evaluating now!
2024-04-30 18:10:13 INFO     Epoch [1/200] train_loss: 15.4997, val_loss: 15.1827, lr: 0.003000, 7.29s
2024-04-30 18:10:13 INFO     Saved model at 1
2024-04-30 18:10:13 INFO     Val loss decrease from 18.6067 to 15.1827, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 18:10:20 INFO     epoch complete!
2024-04-30 18:10:20 INFO     evaluating now!
2024-04-30 18:10:20 INFO     Epoch [2/200] train_loss: 12.5707, val_loss: 12.2266, lr: 0.003000, 7.29s
2024-04-30 18:10:20 INFO     Saved model at 2
2024-04-30 18:10:20 INFO     Val loss decrease from 15.1827 to 12.2266, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 18:10:27 INFO     epoch complete!
2024-04-30 18:10:27 INFO     evaluating now!
2024-04-30 18:10:28 INFO     Epoch [3/200] train_loss: 10.1908, val_loss: 10.1644, lr: 0.003000, 7.43s
2024-04-30 18:10:28 INFO     Saved model at 3
2024-04-30 18:10:28 INFO     Val loss decrease from 12.2266 to 10.1644, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 18:10:34 INFO     epoch complete!
2024-04-30 18:10:34 INFO     evaluating now!
2024-04-30 18:10:35 INFO     Epoch [4/200] train_loss: 8.6292, val_loss: 8.1953, lr: 0.003000, 7.34s
2024-04-30 18:10:35 INFO     Saved model at 4
2024-04-30 18:10:35 INFO     Val loss decrease from 10.1644 to 8.1953, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 18:10:42 INFO     epoch complete!
2024-04-30 18:10:42 INFO     evaluating now!
2024-04-30 18:10:42 INFO     Epoch [5/200] train_loss: 7.7324, val_loss: 7.5124, lr: 0.003000, 7.51s
2024-04-30 18:10:43 INFO     Saved model at 5
2024-04-30 18:10:43 INFO     Val loss decrease from 8.1953 to 7.5124, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 18:10:49 INFO     epoch complete!
2024-04-30 18:10:49 INFO     evaluating now!
2024-04-30 18:10:50 INFO     Epoch [6/200] train_loss: 7.0656, val_loss: 7.4950, lr: 0.003000, 7.31s
2024-04-30 18:10:50 INFO     Saved model at 6
2024-04-30 18:10:50 INFO     Val loss decrease from 7.5124 to 7.4950, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 18:10:57 INFO     epoch complete!
2024-04-30 18:10:57 INFO     evaluating now!
2024-04-30 18:10:57 INFO     Epoch [7/200] train_loss: 6.6496, val_loss: 6.6713, lr: 0.003000, 7.08s
2024-04-30 18:10:57 INFO     Saved model at 7
2024-04-30 18:10:57 INFO     Val loss decrease from 7.4950 to 6.6713, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 18:11:03 INFO     epoch complete!
2024-04-30 18:11:03 INFO     evaluating now!
2024-04-30 18:11:04 INFO     Epoch [8/200] train_loss: 6.2666, val_loss: 6.3746, lr: 0.003000, 6.77s
2024-04-30 18:11:04 INFO     Saved model at 8
2024-04-30 18:11:04 INFO     Val loss decrease from 6.6713 to 6.3746, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 18:11:10 INFO     epoch complete!
2024-04-30 18:11:10 INFO     evaluating now!
2024-04-30 18:11:11 INFO     Epoch [9/200] train_loss: 6.0284, val_loss: 6.4598, lr: 0.003000, 6.94s
2024-04-30 18:11:17 INFO     epoch complete!
2024-04-30 18:11:17 INFO     evaluating now!
2024-04-30 18:11:18 INFO     Epoch [10/200] train_loss: 5.9830, val_loss: 5.9660, lr: 0.003000, 6.81s
2024-04-30 18:11:18 INFO     Saved model at 10
2024-04-30 18:11:18 INFO     Val loss decrease from 6.3746 to 5.9660, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 18:11:24 INFO     epoch complete!
2024-04-30 18:11:24 INFO     evaluating now!
2024-04-30 18:11:24 INFO     Epoch [11/200] train_loss: 5.7133, val_loss: 5.9611, lr: 0.003000, 6.79s
2024-04-30 18:11:24 INFO     Saved model at 11
2024-04-30 18:11:24 INFO     Val loss decrease from 5.9660 to 5.9611, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 18:11:31 INFO     epoch complete!
2024-04-30 18:11:31 INFO     evaluating now!
2024-04-30 18:11:31 INFO     Epoch [12/200] train_loss: 5.6539, val_loss: 5.8923, lr: 0.003000, 6.84s
2024-04-30 18:11:31 INFO     Saved model at 12
2024-04-30 18:11:31 INFO     Val loss decrease from 5.9611 to 5.8923, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 18:11:38 INFO     epoch complete!
2024-04-30 18:11:38 INFO     evaluating now!
2024-04-30 18:11:38 INFO     Epoch [13/200] train_loss: 5.5904, val_loss: 5.9577, lr: 0.003000, 6.87s
2024-04-30 18:11:45 INFO     epoch complete!
2024-04-30 18:11:45 INFO     evaluating now!
2024-04-30 18:11:45 INFO     Epoch [14/200] train_loss: 5.3794, val_loss: 5.8376, lr: 0.003000, 6.78s
2024-04-30 18:11:45 INFO     Saved model at 14
2024-04-30 18:11:45 INFO     Val loss decrease from 5.8923 to 5.8376, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 18:11:51 INFO     epoch complete!
2024-04-30 18:11:51 INFO     evaluating now!
2024-04-30 18:11:52 INFO     Epoch [15/200] train_loss: 5.2608, val_loss: 5.6609, lr: 0.003000, 6.75s
2024-04-30 18:11:52 INFO     Saved model at 15
2024-04-30 18:11:52 INFO     Val loss decrease from 5.8376 to 5.6609, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 18:11:58 INFO     epoch complete!
2024-04-30 18:11:58 INFO     evaluating now!
2024-04-30 18:11:59 INFO     Epoch [16/200] train_loss: 5.2350, val_loss: 5.6626, lr: 0.003000, 6.83s
2024-04-30 18:12:05 INFO     epoch complete!
2024-04-30 18:12:05 INFO     evaluating now!
2024-04-30 18:12:06 INFO     Epoch [17/200] train_loss: 5.0863, val_loss: 5.6904, lr: 0.003000, 7.15s
2024-04-30 18:12:12 INFO     epoch complete!
2024-04-30 18:12:12 INFO     evaluating now!
2024-04-30 18:12:13 INFO     Epoch [18/200] train_loss: 5.0875, val_loss: 5.4927, lr: 0.003000, 6.93s
2024-04-30 18:12:13 INFO     Saved model at 18
2024-04-30 18:12:13 INFO     Val loss decrease from 5.6609 to 5.4927, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 18:12:20 INFO     epoch complete!
2024-04-30 18:12:20 INFO     evaluating now!
2024-04-30 18:12:20 INFO     Epoch [19/200] train_loss: 4.9030, val_loss: 5.5109, lr: 0.003000, 7.38s
2024-04-30 18:12:27 INFO     epoch complete!
2024-04-30 18:12:27 INFO     evaluating now!
2024-04-30 18:12:28 INFO     Epoch [20/200] train_loss: 4.9543, val_loss: 5.5469, lr: 0.003000, 7.45s
2024-04-30 18:12:34 INFO     epoch complete!
2024-04-30 18:12:34 INFO     evaluating now!
2024-04-30 18:12:35 INFO     Epoch [21/200] train_loss: 4.8424, val_loss: 5.5267, lr: 0.003000, 7.37s
2024-04-30 18:12:42 INFO     epoch complete!
2024-04-30 18:12:42 INFO     evaluating now!
2024-04-30 18:12:42 INFO     Epoch [22/200] train_loss: 4.9801, val_loss: 5.6669, lr: 0.003000, 7.38s
2024-04-30 18:12:49 INFO     epoch complete!
2024-04-30 18:12:49 INFO     evaluating now!
2024-04-30 18:12:49 INFO     Epoch [23/200] train_loss: 4.7635, val_loss: 5.3495, lr: 0.003000, 6.88s
2024-04-30 18:12:49 INFO     Saved model at 23
2024-04-30 18:12:49 INFO     Val loss decrease from 5.4927 to 5.3495, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-30 18:12:56 INFO     epoch complete!
2024-04-30 18:12:56 INFO     evaluating now!
2024-04-30 18:12:56 INFO     Epoch [24/200] train_loss: 4.7180, val_loss: 5.3826, lr: 0.003000, 6.93s
2024-04-30 18:13:03 INFO     epoch complete!
2024-04-30 18:13:03 INFO     evaluating now!
2024-04-30 18:13:03 INFO     Epoch [25/200] train_loss: 4.5952, val_loss: 5.3104, lr: 0.003000, 6.78s
2024-04-30 18:13:03 INFO     Saved model at 25
2024-04-30 18:13:03 INFO     Val loss decrease from 5.3495 to 5.3104, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-30 18:13:09 INFO     epoch complete!
2024-04-30 18:13:09 INFO     evaluating now!
2024-04-30 18:13:10 INFO     Epoch [26/200] train_loss: 4.6105, val_loss: 5.4234, lr: 0.003000, 6.76s
2024-04-30 18:13:16 INFO     epoch complete!
2024-04-30 18:13:16 INFO     evaluating now!
2024-04-30 18:13:17 INFO     Epoch [27/200] train_loss: 4.5192, val_loss: 5.2331, lr: 0.003000, 6.92s
2024-04-30 18:13:17 INFO     Saved model at 27
2024-04-30 18:13:17 INFO     Val loss decrease from 5.3104 to 5.2331, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-30 18:13:23 INFO     epoch complete!
2024-04-30 18:13:23 INFO     evaluating now!
2024-04-30 18:13:24 INFO     Epoch [28/200] train_loss: 4.5545, val_loss: 5.1629, lr: 0.003000, 6.78s
2024-04-30 18:13:24 INFO     Saved model at 28
2024-04-30 18:13:24 INFO     Val loss decrease from 5.2331 to 5.1629, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-04-30 18:13:30 INFO     epoch complete!
2024-04-30 18:13:30 INFO     evaluating now!
2024-04-30 18:13:30 INFO     Epoch [29/200] train_loss: 4.3791, val_loss: 5.2517, lr: 0.003000, 6.90s
2024-04-30 18:13:37 INFO     epoch complete!
2024-04-30 18:13:37 INFO     evaluating now!
2024-04-30 18:13:38 INFO     Epoch [30/200] train_loss: 4.3821, val_loss: 5.1682, lr: 0.003000, 7.26s
2024-04-30 18:13:44 INFO     epoch complete!
2024-04-30 18:13:44 INFO     evaluating now!
2024-04-30 18:13:45 INFO     Epoch [31/200] train_loss: 4.3278, val_loss: 5.4405, lr: 0.003000, 7.13s
2024-04-30 18:13:52 INFO     epoch complete!
2024-04-30 18:13:52 INFO     evaluating now!
2024-04-30 18:13:52 INFO     Epoch [32/200] train_loss: 4.3036, val_loss: 5.3018, lr: 0.003000, 7.22s
2024-04-30 18:13:59 INFO     epoch complete!
2024-04-30 18:13:59 INFO     evaluating now!
2024-04-30 18:14:00 INFO     Epoch [33/200] train_loss: 4.2495, val_loss: 5.2988, lr: 0.003000, 7.51s
2024-04-30 18:14:06 INFO     epoch complete!
2024-04-30 18:14:06 INFO     evaluating now!
2024-04-30 18:14:06 INFO     Epoch [34/200] train_loss: 4.2411, val_loss: 5.1343, lr: 0.003000, 6.87s
2024-04-30 18:14:06 INFO     Saved model at 34
2024-04-30 18:14:06 INFO     Val loss decrease from 5.1629 to 5.1343, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-04-30 18:14:13 INFO     epoch complete!
2024-04-30 18:14:13 INFO     evaluating now!
2024-04-30 18:14:13 INFO     Epoch [35/200] train_loss: 4.2440, val_loss: 5.2045, lr: 0.003000, 6.57s
2024-04-30 18:14:19 INFO     epoch complete!
2024-04-30 18:14:19 INFO     evaluating now!
2024-04-30 18:14:19 INFO     Epoch [36/200] train_loss: 4.1714, val_loss: 5.2556, lr: 0.003000, 6.36s
2024-04-30 18:14:26 INFO     epoch complete!
2024-04-30 18:14:26 INFO     evaluating now!
2024-04-30 18:14:26 INFO     Epoch [37/200] train_loss: 4.1015, val_loss: 5.3729, lr: 0.003000, 6.48s
2024-04-30 18:14:32 INFO     epoch complete!
2024-04-30 18:14:32 INFO     evaluating now!
2024-04-30 18:14:32 INFO     Epoch [38/200] train_loss: 4.1148, val_loss: 5.3491, lr: 0.003000, 6.46s
2024-04-30 18:14:39 INFO     epoch complete!
2024-04-30 18:14:39 INFO     evaluating now!
2024-04-30 18:14:39 INFO     Epoch [39/200] train_loss: 4.0400, val_loss: 5.2393, lr: 0.003000, 6.56s
2024-04-30 18:14:46 INFO     epoch complete!
2024-04-30 18:14:46 INFO     evaluating now!
2024-04-30 18:14:46 INFO     Epoch [40/200] train_loss: 4.0799, val_loss: 5.2410, lr: 0.003000, 7.15s
2024-04-30 18:14:52 INFO     epoch complete!
2024-04-30 18:14:52 INFO     evaluating now!
2024-04-30 18:14:53 INFO     Epoch [41/200] train_loss: 4.0882, val_loss: 5.1939, lr: 0.003000, 6.83s
2024-04-30 18:14:59 INFO     epoch complete!
2024-04-30 18:14:59 INFO     evaluating now!
2024-04-30 18:15:00 INFO     Epoch [42/200] train_loss: 4.0077, val_loss: 5.2127, lr: 0.003000, 6.91s
2024-04-30 18:15:06 INFO     epoch complete!
2024-04-30 18:15:06 INFO     evaluating now!
2024-04-30 18:15:07 INFO     Epoch [43/200] train_loss: 3.9601, val_loss: 5.3105, lr: 0.003000, 7.02s
2024-04-30 18:15:13 INFO     epoch complete!
2024-04-30 18:15:13 INFO     evaluating now!
2024-04-30 18:15:14 INFO     Epoch [44/200] train_loss: 3.9852, val_loss: 5.1618, lr: 0.003000, 6.95s
2024-04-30 18:15:20 INFO     epoch complete!
2024-04-30 18:15:20 INFO     evaluating now!
2024-04-30 18:15:21 INFO     Epoch [45/200] train_loss: 3.9283, val_loss: 5.3249, lr: 0.003000, 6.88s
2024-04-30 18:15:27 INFO     epoch complete!
2024-04-30 18:15:27 INFO     evaluating now!
2024-04-30 18:15:28 INFO     Epoch [46/200] train_loss: 3.8843, val_loss: 5.3046, lr: 0.003000, 6.99s
2024-04-30 18:15:34 INFO     epoch complete!
2024-04-30 18:15:34 INFO     evaluating now!
2024-04-30 18:15:35 INFO     Epoch [47/200] train_loss: 3.8796, val_loss: 5.4445, lr: 0.003000, 6.90s
2024-04-30 18:15:41 INFO     epoch complete!
2024-04-30 18:15:41 INFO     evaluating now!
2024-04-30 18:15:41 INFO     Epoch [48/200] train_loss: 3.8832, val_loss: 5.0873, lr: 0.003000, 6.91s
2024-04-30 18:15:42 INFO     Saved model at 48
2024-04-30 18:15:42 INFO     Val loss decrease from 5.1343 to 5.0873, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-04-30 18:15:48 INFO     epoch complete!
2024-04-30 18:15:48 INFO     evaluating now!
2024-04-30 18:15:48 INFO     Epoch [49/200] train_loss: 3.8493, val_loss: 5.1232, lr: 0.003000, 6.92s
2024-04-30 18:15:55 INFO     epoch complete!
2024-04-30 18:15:55 INFO     evaluating now!
2024-04-30 18:15:55 INFO     Epoch [50/200] train_loss: 3.7684, val_loss: 5.2239, lr: 0.003000, 6.88s
2024-04-30 18:16:02 INFO     epoch complete!
2024-04-30 18:16:02 INFO     evaluating now!
2024-04-30 18:16:02 INFO     Epoch [51/200] train_loss: 3.7521, val_loss: 5.0629, lr: 0.003000, 6.89s
2024-04-30 18:16:02 INFO     Saved model at 51
2024-04-30 18:16:02 INFO     Val loss decrease from 5.0873 to 5.0629, saving to ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-04-30 18:16:09 INFO     epoch complete!
2024-04-30 18:16:09 INFO     evaluating now!
2024-04-30 18:16:10 INFO     Epoch [52/200] train_loss: 3.8419, val_loss: 5.2360, lr: 0.003000, 7.34s
2024-04-30 18:16:16 INFO     epoch complete!
2024-04-30 18:16:16 INFO     evaluating now!
2024-04-30 18:16:17 INFO     Epoch [53/200] train_loss: 3.8148, val_loss: 5.0699, lr: 0.003000, 7.40s
2024-04-30 18:16:24 INFO     epoch complete!
2024-04-30 18:16:24 INFO     evaluating now!
2024-04-30 18:16:25 INFO     Epoch [54/200] train_loss: 3.7658, val_loss: 5.0733, lr: 0.003000, 7.56s
2024-04-30 18:16:32 INFO     epoch complete!
2024-04-30 18:16:32 INFO     evaluating now!
2024-04-30 18:16:32 INFO     Epoch [55/200] train_loss: 3.7296, val_loss: 5.1970, lr: 0.003000, 7.55s
2024-04-30 18:16:39 INFO     epoch complete!
2024-04-30 18:16:39 INFO     evaluating now!
2024-04-30 18:16:40 INFO     Epoch [56/200] train_loss: 3.6811, val_loss: 5.2632, lr: 0.003000, 7.48s
2024-04-30 18:16:46 INFO     epoch complete!
2024-04-30 18:16:46 INFO     evaluating now!
2024-04-30 18:16:47 INFO     Epoch [57/200] train_loss: 3.6695, val_loss: 5.2382, lr: 0.003000, 7.26s
2024-04-30 18:16:54 INFO     epoch complete!
2024-04-30 18:16:54 INFO     evaluating now!
2024-04-30 18:16:54 INFO     Epoch [58/200] train_loss: 3.6753, val_loss: 5.1076, lr: 0.003000, 7.43s
2024-04-30 18:17:01 INFO     epoch complete!
2024-04-30 18:17:01 INFO     evaluating now!
2024-04-30 18:17:02 INFO     Epoch [59/200] train_loss: 3.6689, val_loss: 5.1544, lr: 0.003000, 7.41s
2024-04-30 18:17:08 INFO     epoch complete!
2024-04-30 18:17:08 INFO     evaluating now!
2024-04-30 18:17:09 INFO     Epoch [60/200] train_loss: 3.6273, val_loss: 5.1302, lr: 0.003000, 7.27s
2024-04-30 18:17:16 INFO     epoch complete!
2024-04-30 18:17:16 INFO     evaluating now!
2024-04-30 18:17:16 INFO     Epoch [61/200] train_loss: 3.5882, val_loss: 5.2147, lr: 0.003000, 7.45s
2024-04-30 18:17:23 INFO     epoch complete!
2024-04-30 18:17:23 INFO     evaluating now!
2024-04-30 18:17:24 INFO     Epoch [62/200] train_loss: 3.5973, val_loss: 5.1621, lr: 0.003000, 7.28s
2024-04-30 18:17:31 INFO     epoch complete!
2024-04-30 18:17:31 INFO     evaluating now!
2024-04-30 18:17:31 INFO     Epoch [63/200] train_loss: 3.5891, val_loss: 5.2098, lr: 0.003000, 7.45s
2024-04-30 18:17:39 INFO     epoch complete!
2024-04-30 18:17:39 INFO     evaluating now!
2024-04-30 18:17:39 INFO     Epoch [64/200] train_loss: 3.6081, val_loss: 5.0651, lr: 0.003000, 8.00s
2024-04-30 18:17:46 INFO     epoch complete!
2024-04-30 18:17:46 INFO     evaluating now!
2024-04-30 18:17:46 INFO     Epoch [65/200] train_loss: 3.5338, val_loss: 5.3010, lr: 0.003000, 7.34s
2024-04-30 18:17:53 INFO     epoch complete!
2024-04-30 18:17:53 INFO     evaluating now!
2024-04-30 18:17:54 INFO     Epoch [66/200] train_loss: 3.5367, val_loss: 5.2120, lr: 0.003000, 7.35s
2024-04-30 18:17:54 WARNING  Early stopping at epoch: 66
2024-04-30 18:17:54 INFO     Trained totally 67 epochs, average train time is 6.619s, average eval time is 0.465s
2024-04-30 18:17:54 INFO     Loaded model at 51
2024-04-30 18:17:54 INFO     Saved model at ./libcity/cache/37/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 18:17:54 INFO     Start evaluating ...
2024-04-30 18:17:56 INFO     Note that you select the single mode to evaluate!
2024-04-30 18:17:56 INFO     Evaluate result is saved at ./libcity/cache/37/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 18:17:56 INFO     
         MAE       RMSE
1   2.336840   7.087006
2   2.481061   7.665810
3   2.608139   8.682808
4   2.757968   9.394000
5   2.888376  10.123013
6   3.001351  10.836315
7   3.113297  11.707199
8   3.207371  12.351141
9   3.266992  12.667365
10  3.390842  13.137628
11  3.494952  13.391850
12  3.632763  13.998077
2024-04-30 18:17:56 INFO     ----------------------------------------------------------------------------
2024-04-30 18:17:56 INFO     # 3, Kownledge Graph Embedding: RefE, Experiment ids: 38
2024-04-30 18:17:56 INFO     ----------------------------------------------------------------------------
2024-04-30 18:17:56 INFO     Log directory: ./libcity/log
2024-04-30 18:17:56 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=38
2024-04-30 18:17:56 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 34355672, 'exp_id': 38, 'load_external': True, 'embedding_model': 'RefE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 18:17:56 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 18:17:56 INFO     set_weight_link_or_dist: dist
2024-04-30 18:17:56 INFO     init_weight_inf_or_zero: inf
2024-04-30 18:17:56 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 18:17:56 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 18:17:56 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 18:17:56 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 18:17:59 INFO     Dataset created
2024-04-30 18:17:59 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 18:17:59 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 18:17:59 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 18:17:59 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 18:17:59 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 18:17:59 INFO     NoneScaler
2024-04-30 18:18:02 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 18:18:02 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 18:18:02 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 18:18:02 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 18:18:02 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 18:18:02 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 18:18:02 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 18:18:02 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 18:18:02 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 18:18:02 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 18:18:02 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 18:18:02 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 18:18:02 INFO     Total parameter numbers: 874010
2024-04-30 18:18:02 INFO     You select `adam` optimizer.
2024-04-30 18:18:02 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 18:18:02 INFO     Start training ...
2024-04-30 18:18:02 INFO     num_batches:48
2024-04-30 18:18:09 INFO     epoch complete!
2024-04-30 18:18:09 INFO     evaluating now!
2024-04-30 18:18:09 INFO     Epoch [0/200] train_loss: 24.3847, val_loss: 18.5726, lr: 0.003000, 7.51s
2024-04-30 18:18:09 INFO     Saved model at 0
2024-04-30 18:18:09 INFO     Val loss decrease from inf to 18.5726, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 18:18:16 INFO     epoch complete!
2024-04-30 18:18:16 INFO     evaluating now!
2024-04-30 18:18:16 INFO     Epoch [1/200] train_loss: 15.2834, val_loss: 14.8551, lr: 0.003000, 7.32s
2024-04-30 18:18:17 INFO     Saved model at 1
2024-04-30 18:18:17 INFO     Val loss decrease from 18.5726 to 14.8551, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 18:18:24 INFO     epoch complete!
2024-04-30 18:18:24 INFO     evaluating now!
2024-04-30 18:18:24 INFO     Epoch [2/200] train_loss: 12.9307, val_loss: 12.8428, lr: 0.003000, 7.55s
2024-04-30 18:18:24 INFO     Saved model at 2
2024-04-30 18:18:24 INFO     Val loss decrease from 14.8551 to 12.8428, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 18:18:31 INFO     epoch complete!
2024-04-30 18:18:31 INFO     evaluating now!
2024-04-30 18:18:32 INFO     Epoch [3/200] train_loss: 10.8660, val_loss: 10.5665, lr: 0.003000, 7.40s
2024-04-30 18:18:32 INFO     Saved model at 3
2024-04-30 18:18:32 INFO     Val loss decrease from 12.8428 to 10.5665, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 18:18:38 INFO     epoch complete!
2024-04-30 18:18:38 INFO     evaluating now!
2024-04-30 18:18:39 INFO     Epoch [4/200] train_loss: 9.2377, val_loss: 8.8407, lr: 0.003000, 7.32s
2024-04-30 18:18:39 INFO     Saved model at 4
2024-04-30 18:18:39 INFO     Val loss decrease from 10.5665 to 8.8407, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 18:18:46 INFO     epoch complete!
2024-04-30 18:18:46 INFO     evaluating now!
2024-04-30 18:18:46 INFO     Epoch [5/200] train_loss: 8.1494, val_loss: 8.0250, lr: 0.003000, 7.48s
2024-04-30 18:18:46 INFO     Saved model at 5
2024-04-30 18:18:46 INFO     Val loss decrease from 8.8407 to 8.0250, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 18:18:53 INFO     epoch complete!
2024-04-30 18:18:53 INFO     evaluating now!
2024-04-30 18:18:54 INFO     Epoch [6/200] train_loss: 7.4891, val_loss: 7.1517, lr: 0.003000, 7.35s
2024-04-30 18:18:54 INFO     Saved model at 6
2024-04-30 18:18:54 INFO     Val loss decrease from 8.0250 to 7.1517, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 18:19:01 INFO     epoch complete!
2024-04-30 18:19:01 INFO     evaluating now!
2024-04-30 18:19:01 INFO     Epoch [7/200] train_loss: 6.9697, val_loss: 6.7437, lr: 0.003000, 7.30s
2024-04-30 18:19:01 INFO     Saved model at 7
2024-04-30 18:19:01 INFO     Val loss decrease from 7.1517 to 6.7437, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 18:19:08 INFO     epoch complete!
2024-04-30 18:19:08 INFO     evaluating now!
2024-04-30 18:19:08 INFO     Epoch [8/200] train_loss: 6.5403, val_loss: 6.4897, lr: 0.003000, 7.24s
2024-04-30 18:19:08 INFO     Saved model at 8
2024-04-30 18:19:08 INFO     Val loss decrease from 6.7437 to 6.4897, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 18:19:15 INFO     epoch complete!
2024-04-30 18:19:15 INFO     evaluating now!
2024-04-30 18:19:16 INFO     Epoch [9/200] train_loss: 6.3784, val_loss: 6.7270, lr: 0.003000, 7.32s
2024-04-30 18:19:23 INFO     epoch complete!
2024-04-30 18:19:23 INFO     evaluating now!
2024-04-30 18:19:23 INFO     Epoch [10/200] train_loss: 6.1252, val_loss: 6.3150, lr: 0.003000, 7.28s
2024-04-30 18:19:23 INFO     Saved model at 10
2024-04-30 18:19:23 INFO     Val loss decrease from 6.4897 to 6.3150, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 18:19:30 INFO     epoch complete!
2024-04-30 18:19:30 INFO     evaluating now!
2024-04-30 18:19:31 INFO     Epoch [11/200] train_loss: 5.8439, val_loss: 6.0029, lr: 0.003000, 7.38s
2024-04-30 18:19:31 INFO     Saved model at 11
2024-04-30 18:19:31 INFO     Val loss decrease from 6.3150 to 6.0029, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 18:19:37 INFO     epoch complete!
2024-04-30 18:19:37 INFO     evaluating now!
2024-04-30 18:19:38 INFO     Epoch [12/200] train_loss: 5.6982, val_loss: 5.8477, lr: 0.003000, 7.12s
2024-04-30 18:19:38 INFO     Saved model at 12
2024-04-30 18:19:38 INFO     Val loss decrease from 6.0029 to 5.8477, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 18:19:44 INFO     epoch complete!
2024-04-30 18:19:44 INFO     evaluating now!
2024-04-30 18:19:45 INFO     Epoch [13/200] train_loss: 5.5622, val_loss: 6.0618, lr: 0.003000, 7.03s
2024-04-30 18:19:51 INFO     epoch complete!
2024-04-30 18:19:51 INFO     evaluating now!
2024-04-30 18:19:52 INFO     Epoch [14/200] train_loss: 5.4861, val_loss: 5.7935, lr: 0.003000, 7.04s
2024-04-30 18:19:52 INFO     Saved model at 14
2024-04-30 18:19:52 INFO     Val loss decrease from 5.8477 to 5.7935, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 18:19:59 INFO     epoch complete!
2024-04-30 18:19:59 INFO     evaluating now!
2024-04-30 18:19:59 INFO     Epoch [15/200] train_loss: 5.4076, val_loss: 5.8933, lr: 0.003000, 7.34s
2024-04-30 18:20:06 INFO     epoch complete!
2024-04-30 18:20:06 INFO     evaluating now!
2024-04-30 18:20:07 INFO     Epoch [16/200] train_loss: 5.2751, val_loss: 5.7901, lr: 0.003000, 7.59s
2024-04-30 18:20:07 INFO     Saved model at 16
2024-04-30 18:20:07 INFO     Val loss decrease from 5.7935 to 5.7901, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 18:20:14 INFO     epoch complete!
2024-04-30 18:20:14 INFO     evaluating now!
2024-04-30 18:20:14 INFO     Epoch [17/200] train_loss: 5.2891, val_loss: 5.5589, lr: 0.003000, 7.38s
2024-04-30 18:20:14 INFO     Saved model at 17
2024-04-30 18:20:14 INFO     Val loss decrease from 5.7901 to 5.5589, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 18:20:20 INFO     epoch complete!
2024-04-30 18:20:20 INFO     evaluating now!
2024-04-30 18:20:21 INFO     Epoch [18/200] train_loss: 5.1480, val_loss: 5.4941, lr: 0.003000, 6.72s
2024-04-30 18:20:21 INFO     Saved model at 18
2024-04-30 18:20:21 INFO     Val loss decrease from 5.5589 to 5.4941, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 18:20:27 INFO     epoch complete!
2024-04-30 18:20:27 INFO     evaluating now!
2024-04-30 18:20:27 INFO     Epoch [19/200] train_loss: 5.0277, val_loss: 5.4913, lr: 0.003000, 6.48s
2024-04-30 18:20:28 INFO     Saved model at 19
2024-04-30 18:20:28 INFO     Val loss decrease from 5.4941 to 5.4913, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 18:20:33 INFO     epoch complete!
2024-04-30 18:20:33 INFO     evaluating now!
2024-04-30 18:20:33 INFO     Epoch [20/200] train_loss: 4.9510, val_loss: 5.3964, lr: 0.003000, 5.91s
2024-04-30 18:20:33 INFO     Saved model at 20
2024-04-30 18:20:33 INFO     Val loss decrease from 5.4913 to 5.3964, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-30 18:20:39 INFO     epoch complete!
2024-04-30 18:20:39 INFO     evaluating now!
2024-04-30 18:20:39 INFO     Epoch [21/200] train_loss: 4.9098, val_loss: 5.3929, lr: 0.003000, 6.00s
2024-04-30 18:20:40 INFO     Saved model at 21
2024-04-30 18:20:40 INFO     Val loss decrease from 5.3964 to 5.3929, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-30 18:20:45 INFO     epoch complete!
2024-04-30 18:20:45 INFO     evaluating now!
2024-04-30 18:20:45 INFO     Epoch [22/200] train_loss: 4.7943, val_loss: 5.4296, lr: 0.003000, 5.98s
2024-04-30 18:20:51 INFO     epoch complete!
2024-04-30 18:20:51 INFO     evaluating now!
2024-04-30 18:20:52 INFO     Epoch [23/200] train_loss: 4.8244, val_loss: 5.5984, lr: 0.003000, 6.11s
2024-04-30 18:20:58 INFO     epoch complete!
2024-04-30 18:20:58 INFO     evaluating now!
2024-04-30 18:20:59 INFO     Epoch [24/200] train_loss: 4.8922, val_loss: 5.4312, lr: 0.003000, 7.16s
2024-04-30 18:21:06 INFO     epoch complete!
2024-04-30 18:21:06 INFO     evaluating now!
2024-04-30 18:21:06 INFO     Epoch [25/200] train_loss: 4.6761, val_loss: 5.4415, lr: 0.003000, 7.27s
2024-04-30 18:21:12 INFO     epoch complete!
2024-04-30 18:21:12 INFO     evaluating now!
2024-04-30 18:21:13 INFO     Epoch [26/200] train_loss: 4.6538, val_loss: 5.4131, lr: 0.003000, 6.63s
2024-04-30 18:21:19 INFO     epoch complete!
2024-04-30 18:21:19 INFO     evaluating now!
2024-04-30 18:21:19 INFO     Epoch [27/200] train_loss: 4.6156, val_loss: 5.1668, lr: 0.003000, 6.76s
2024-04-30 18:21:19 INFO     Saved model at 27
2024-04-30 18:21:19 INFO     Val loss decrease from 5.3929 to 5.1668, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-30 18:21:27 INFO     epoch complete!
2024-04-30 18:21:27 INFO     evaluating now!
2024-04-30 18:21:27 INFO     Epoch [28/200] train_loss: 4.5296, val_loss: 5.2451, lr: 0.003000, 7.55s
2024-04-30 18:21:34 INFO     epoch complete!
2024-04-30 18:21:34 INFO     evaluating now!
2024-04-30 18:21:34 INFO     Epoch [29/200] train_loss: 4.5632, val_loss: 5.2693, lr: 0.003000, 7.39s
2024-04-30 18:21:41 INFO     epoch complete!
2024-04-30 18:21:41 INFO     evaluating now!
2024-04-30 18:21:42 INFO     Epoch [30/200] train_loss: 4.4460, val_loss: 5.3719, lr: 0.003000, 7.50s
2024-04-30 18:21:49 INFO     epoch complete!
2024-04-30 18:21:49 INFO     evaluating now!
2024-04-30 18:21:49 INFO     Epoch [31/200] train_loss: 4.4536, val_loss: 5.2036, lr: 0.003000, 7.56s
2024-04-30 18:21:56 INFO     epoch complete!
2024-04-30 18:21:56 INFO     evaluating now!
2024-04-30 18:21:57 INFO     Epoch [32/200] train_loss: 4.3430, val_loss: 5.2318, lr: 0.003000, 7.43s
2024-04-30 18:22:04 INFO     epoch complete!
2024-04-30 18:22:04 INFO     evaluating now!
2024-04-30 18:22:04 INFO     Epoch [33/200] train_loss: 4.3505, val_loss: 5.1839, lr: 0.003000, 7.40s
2024-04-30 18:22:11 INFO     epoch complete!
2024-04-30 18:22:11 INFO     evaluating now!
2024-04-30 18:22:12 INFO     Epoch [34/200] train_loss: 4.3378, val_loss: 5.1658, lr: 0.003000, 7.38s
2024-04-30 18:22:12 INFO     Saved model at 34
2024-04-30 18:22:12 INFO     Val loss decrease from 5.1668 to 5.1658, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-04-30 18:22:18 INFO     epoch complete!
2024-04-30 18:22:18 INFO     evaluating now!
2024-04-30 18:22:19 INFO     Epoch [35/200] train_loss: 4.2433, val_loss: 5.2274, lr: 0.003000, 6.97s
2024-04-30 18:22:25 INFO     epoch complete!
2024-04-30 18:22:25 INFO     evaluating now!
2024-04-30 18:22:26 INFO     Epoch [36/200] train_loss: 4.2346, val_loss: 5.6448, lr: 0.003000, 7.02s
2024-04-30 18:22:32 INFO     epoch complete!
2024-04-30 18:22:32 INFO     evaluating now!
2024-04-30 18:22:33 INFO     Epoch [37/200] train_loss: 4.2007, val_loss: 5.0829, lr: 0.003000, 7.04s
2024-04-30 18:22:33 INFO     Saved model at 37
2024-04-30 18:22:33 INFO     Val loss decrease from 5.1658 to 5.0829, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-04-30 18:22:40 INFO     epoch complete!
2024-04-30 18:22:40 INFO     evaluating now!
2024-04-30 18:22:40 INFO     Epoch [38/200] train_loss: 4.1776, val_loss: 5.1565, lr: 0.003000, 7.34s
2024-04-30 18:22:47 INFO     epoch complete!
2024-04-30 18:22:47 INFO     evaluating now!
2024-04-30 18:22:48 INFO     Epoch [39/200] train_loss: 4.1403, val_loss: 5.2252, lr: 0.003000, 7.41s
2024-04-30 18:22:55 INFO     epoch complete!
2024-04-30 18:22:55 INFO     evaluating now!
2024-04-30 18:22:55 INFO     Epoch [40/200] train_loss: 4.1191, val_loss: 5.0883, lr: 0.003000, 7.45s
2024-04-30 18:23:02 INFO     epoch complete!
2024-04-30 18:23:02 INFO     evaluating now!
2024-04-30 18:23:02 INFO     Epoch [41/200] train_loss: 4.1331, val_loss: 5.2721, lr: 0.003000, 7.36s
2024-04-30 18:23:09 INFO     epoch complete!
2024-04-30 18:23:09 INFO     evaluating now!
2024-04-30 18:23:10 INFO     Epoch [42/200] train_loss: 4.1188, val_loss: 5.1020, lr: 0.003000, 7.49s
2024-04-30 18:23:17 INFO     epoch complete!
2024-04-30 18:23:17 INFO     evaluating now!
2024-04-30 18:23:17 INFO     Epoch [43/200] train_loss: 4.0312, val_loss: 5.1149, lr: 0.003000, 7.53s
2024-04-30 18:23:24 INFO     epoch complete!
2024-04-30 18:23:24 INFO     evaluating now!
2024-04-30 18:23:25 INFO     Epoch [44/200] train_loss: 4.0369, val_loss: 5.0960, lr: 0.003000, 7.45s
2024-04-30 18:23:32 INFO     epoch complete!
2024-04-30 18:23:32 INFO     evaluating now!
2024-04-30 18:23:32 INFO     Epoch [45/200] train_loss: 3.9835, val_loss: 5.0451, lr: 0.003000, 7.54s
2024-04-30 18:23:32 INFO     Saved model at 45
2024-04-30 18:23:32 INFO     Val loss decrease from 5.0829 to 5.0451, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-04-30 18:23:39 INFO     epoch complete!
2024-04-30 18:23:39 INFO     evaluating now!
2024-04-30 18:23:40 INFO     Epoch [46/200] train_loss: 3.9595, val_loss: 5.2207, lr: 0.003000, 7.34s
2024-04-30 18:23:47 INFO     epoch complete!
2024-04-30 18:23:47 INFO     evaluating now!
2024-04-30 18:23:47 INFO     Epoch [47/200] train_loss: 3.9324, val_loss: 5.1265, lr: 0.003000, 7.30s
2024-04-30 18:23:54 INFO     epoch complete!
2024-04-30 18:23:54 INFO     evaluating now!
2024-04-30 18:23:54 INFO     Epoch [48/200] train_loss: 3.9258, val_loss: 5.2192, lr: 0.003000, 7.32s
2024-04-30 18:24:01 INFO     epoch complete!
2024-04-30 18:24:01 INFO     evaluating now!
2024-04-30 18:24:02 INFO     Epoch [49/200] train_loss: 3.9793, val_loss: 5.0573, lr: 0.003000, 7.54s
2024-04-30 18:24:09 INFO     epoch complete!
2024-04-30 18:24:09 INFO     evaluating now!
2024-04-30 18:24:09 INFO     Epoch [50/200] train_loss: 3.8917, val_loss: 5.0165, lr: 0.003000, 7.26s
2024-04-30 18:24:09 INFO     Saved model at 50
2024-04-30 18:24:09 INFO     Val loss decrease from 5.0451 to 5.0165, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch50.tar
2024-04-30 18:24:16 INFO     epoch complete!
2024-04-30 18:24:16 INFO     evaluating now!
2024-04-30 18:24:16 INFO     Epoch [51/200] train_loss: 3.8446, val_loss: 5.3091, lr: 0.003000, 7.22s
2024-04-30 18:24:23 INFO     epoch complete!
2024-04-30 18:24:23 INFO     evaluating now!
2024-04-30 18:24:24 INFO     Epoch [52/200] train_loss: 3.8448, val_loss: 5.0349, lr: 0.003000, 7.28s
2024-04-30 18:24:31 INFO     epoch complete!
2024-04-30 18:24:31 INFO     evaluating now!
2024-04-30 18:24:31 INFO     Epoch [53/200] train_loss: 3.7975, val_loss: 5.0517, lr: 0.003000, 7.35s
2024-04-30 18:24:38 INFO     epoch complete!
2024-04-30 18:24:38 INFO     evaluating now!
2024-04-30 18:24:38 INFO     Epoch [54/200] train_loss: 3.7762, val_loss: 5.0932, lr: 0.003000, 7.28s
2024-04-30 18:24:45 INFO     epoch complete!
2024-04-30 18:24:45 INFO     evaluating now!
2024-04-30 18:24:46 INFO     Epoch [55/200] train_loss: 3.7495, val_loss: 4.9645, lr: 0.003000, 7.18s
2024-04-30 18:24:46 INFO     Saved model at 55
2024-04-30 18:24:46 INFO     Val loss decrease from 5.0165 to 4.9645, saving to ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406_epoch55.tar
2024-04-30 18:24:52 INFO     epoch complete!
2024-04-30 18:24:52 INFO     evaluating now!
2024-04-30 18:24:53 INFO     Epoch [56/200] train_loss: 3.7688, val_loss: 5.0600, lr: 0.003000, 6.98s
2024-04-30 18:24:59 INFO     epoch complete!
2024-04-30 18:24:59 INFO     evaluating now!
2024-04-30 18:25:00 INFO     Epoch [57/200] train_loss: 3.7451, val_loss: 5.0445, lr: 0.003000, 7.24s
2024-04-30 18:25:07 INFO     epoch complete!
2024-04-30 18:25:07 INFO     evaluating now!
2024-04-30 18:25:07 INFO     Epoch [58/200] train_loss: 3.7354, val_loss: 5.1514, lr: 0.003000, 7.37s
2024-04-30 18:25:14 INFO     epoch complete!
2024-04-30 18:25:14 INFO     evaluating now!
2024-04-30 18:25:14 INFO     Epoch [59/200] train_loss: 3.7250, val_loss: 5.0773, lr: 0.003000, 7.23s
2024-04-30 18:25:21 INFO     epoch complete!
2024-04-30 18:25:21 INFO     evaluating now!
2024-04-30 18:25:22 INFO     Epoch [60/200] train_loss: 3.7262, val_loss: 4.9712, lr: 0.003000, 7.14s
2024-04-30 18:25:28 INFO     epoch complete!
2024-04-30 18:25:28 INFO     evaluating now!
2024-04-30 18:25:29 INFO     Epoch [61/200] train_loss: 3.6867, val_loss: 5.0776, lr: 0.003000, 7.13s
2024-04-30 18:25:35 INFO     epoch complete!
2024-04-30 18:25:35 INFO     evaluating now!
2024-04-30 18:25:36 INFO     Epoch [62/200] train_loss: 3.6120, val_loss: 5.0779, lr: 0.003000, 7.24s
2024-04-30 18:25:42 INFO     epoch complete!
2024-04-30 18:25:42 INFO     evaluating now!
2024-04-30 18:25:43 INFO     Epoch [63/200] train_loss: 3.6213, val_loss: 5.0810, lr: 0.003000, 6.87s
2024-04-30 18:25:50 INFO     epoch complete!
2024-04-30 18:25:50 INFO     evaluating now!
2024-04-30 18:25:50 INFO     Epoch [64/200] train_loss: 3.6385, val_loss: 5.0076, lr: 0.003000, 7.33s
2024-04-30 18:25:57 INFO     epoch complete!
2024-04-30 18:25:57 INFO     evaluating now!
2024-04-30 18:25:57 INFO     Epoch [65/200] train_loss: 3.6234, val_loss: 4.9890, lr: 0.003000, 7.31s
2024-04-30 18:26:04 INFO     epoch complete!
2024-04-30 18:26:04 INFO     evaluating now!
2024-04-30 18:26:04 INFO     Epoch [66/200] train_loss: 3.5813, val_loss: 5.1143, lr: 0.003000, 6.69s
2024-04-30 18:26:11 INFO     epoch complete!
2024-04-30 18:26:11 INFO     evaluating now!
2024-04-30 18:26:11 INFO     Epoch [67/200] train_loss: 3.5787, val_loss: 5.0784, lr: 0.003000, 7.34s
2024-04-30 18:26:18 INFO     epoch complete!
2024-04-30 18:26:18 INFO     evaluating now!
2024-04-30 18:26:19 INFO     Epoch [68/200] train_loss: 3.5852, val_loss: 5.0657, lr: 0.003000, 7.29s
2024-04-30 18:26:26 INFO     epoch complete!
2024-04-30 18:26:26 INFO     evaluating now!
2024-04-30 18:26:26 INFO     Epoch [69/200] train_loss: 3.5634, val_loss: 5.1464, lr: 0.003000, 7.25s
2024-04-30 18:26:33 INFO     epoch complete!
2024-04-30 18:26:33 INFO     evaluating now!
2024-04-30 18:26:33 INFO     Epoch [70/200] train_loss: 3.5293, val_loss: 5.1465, lr: 0.003000, 7.40s
2024-04-30 18:26:33 WARNING  Early stopping at epoch: 70
2024-04-30 18:26:33 INFO     Trained totally 71 epochs, average train time is 6.709s, average eval time is 0.480s
2024-04-30 18:26:34 INFO     Loaded model at 55
2024-04-30 18:26:34 INFO     Saved model at ./libcity/cache/38/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 18:26:34 INFO     Start evaluating ...
2024-04-30 18:26:35 INFO     Note that you select the single mode to evaluate!
2024-04-30 18:26:35 INFO     Evaluate result is saved at ./libcity/cache/38/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 18:26:35 INFO     
         MAE       RMSE
1   2.579907   7.333882
2   2.648872   7.732327
3   2.756037   8.519191
4   2.924669   9.406558
5   3.062052  10.400508
6   3.185191  11.392951
7   3.218668  12.068854
8   3.256402  12.329984
9   3.251586  12.435778
10  3.262695  12.679989
11  3.335588  12.961830
12  3.472403  13.578069
2024-04-30 18:26:35 INFO     ----------------------------------------------------------------------------
2024-04-30 18:26:35 INFO     # 4, Kownledge Graph Embedding: RefE, Experiment ids: 39
2024-04-30 18:26:35 INFO     ----------------------------------------------------------------------------
2024-04-30 18:26:35 INFO     Log directory: ./libcity/log
2024-04-30 18:26:35 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=39
2024-04-30 18:26:35 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 712391064, 'exp_id': 39, 'load_external': True, 'embedding_model': 'RefE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 18:26:36 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 18:26:36 INFO     set_weight_link_or_dist: dist
2024-04-30 18:26:36 INFO     init_weight_inf_or_zero: inf
2024-04-30 18:26:36 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 18:26:36 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 18:26:36 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 18:26:36 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 18:26:39 INFO     Dataset created
2024-04-30 18:26:39 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 18:26:39 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 18:26:39 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 18:26:39 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 18:26:39 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 18:26:39 INFO     NoneScaler
2024-04-30 18:26:41 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 18:26:41 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 18:26:41 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 18:26:41 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 18:26:41 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 18:26:41 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 18:26:41 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 18:26:41 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 18:26:41 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 18:26:41 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 18:26:41 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 18:26:41 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 18:26:41 INFO     Total parameter numbers: 874010
2024-04-30 18:26:41 INFO     You select `adam` optimizer.
2024-04-30 18:26:41 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 18:26:41 INFO     Start training ...
2024-04-30 18:26:41 INFO     num_batches:48
2024-04-30 18:26:48 INFO     epoch complete!
2024-04-30 18:26:48 INFO     evaluating now!
2024-04-30 18:26:48 INFO     Epoch [0/200] train_loss: 24.7664, val_loss: 18.7569, lr: 0.003000, 7.16s
2024-04-30 18:26:48 INFO     Saved model at 0
2024-04-30 18:26:48 INFO     Val loss decrease from inf to 18.7569, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 18:26:55 INFO     epoch complete!
2024-04-30 18:26:55 INFO     evaluating now!
2024-04-30 18:26:55 INFO     Epoch [1/200] train_loss: 15.2131, val_loss: 14.9227, lr: 0.003000, 6.99s
2024-04-30 18:26:55 INFO     Saved model at 1
2024-04-30 18:26:55 INFO     Val loss decrease from 18.7569 to 14.9227, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 18:27:02 INFO     epoch complete!
2024-04-30 18:27:02 INFO     evaluating now!
2024-04-30 18:27:02 INFO     Epoch [2/200] train_loss: 12.2078, val_loss: 11.8279, lr: 0.003000, 6.99s
2024-04-30 18:27:02 INFO     Saved model at 2
2024-04-30 18:27:02 INFO     Val loss decrease from 14.9227 to 11.8279, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 18:27:08 INFO     epoch complete!
2024-04-30 18:27:08 INFO     evaluating now!
2024-04-30 18:27:09 INFO     Epoch [3/200] train_loss: 10.2422, val_loss: 9.8724, lr: 0.003000, 6.74s
2024-04-30 18:27:09 INFO     Saved model at 3
2024-04-30 18:27:09 INFO     Val loss decrease from 11.8279 to 9.8724, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 18:27:15 INFO     epoch complete!
2024-04-30 18:27:15 INFO     evaluating now!
2024-04-30 18:27:16 INFO     Epoch [4/200] train_loss: 8.7671, val_loss: 8.6399, lr: 0.003000, 6.68s
2024-04-30 18:27:16 INFO     Saved model at 4
2024-04-30 18:27:16 INFO     Val loss decrease from 9.8724 to 8.6399, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 18:27:22 INFO     epoch complete!
2024-04-30 18:27:22 INFO     evaluating now!
2024-04-30 18:27:23 INFO     Epoch [5/200] train_loss: 7.8745, val_loss: 7.4986, lr: 0.003000, 7.09s
2024-04-30 18:27:23 INFO     Saved model at 5
2024-04-30 18:27:23 INFO     Val loss decrease from 8.6399 to 7.4986, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 18:27:30 INFO     epoch complete!
2024-04-30 18:27:30 INFO     evaluating now!
2024-04-30 18:27:30 INFO     Epoch [6/200] train_loss: 7.2439, val_loss: 7.1902, lr: 0.003000, 7.59s
2024-04-30 18:27:30 INFO     Saved model at 6
2024-04-30 18:27:30 INFO     Val loss decrease from 7.4986 to 7.1902, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 18:27:37 INFO     epoch complete!
2024-04-30 18:27:37 INFO     evaluating now!
2024-04-30 18:27:38 INFO     Epoch [7/200] train_loss: 7.0656, val_loss: 6.9075, lr: 0.003000, 7.28s
2024-04-30 18:27:38 INFO     Saved model at 7
2024-04-30 18:27:38 INFO     Val loss decrease from 7.1902 to 6.9075, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 18:27:45 INFO     epoch complete!
2024-04-30 18:27:45 INFO     evaluating now!
2024-04-30 18:27:45 INFO     Epoch [8/200] train_loss: 6.5798, val_loss: 6.5553, lr: 0.003000, 7.40s
2024-04-30 18:27:45 INFO     Saved model at 8
2024-04-30 18:27:45 INFO     Val loss decrease from 6.9075 to 6.5553, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 18:27:52 INFO     epoch complete!
2024-04-30 18:27:52 INFO     evaluating now!
2024-04-30 18:27:53 INFO     Epoch [9/200] train_loss: 6.4305, val_loss: 6.3274, lr: 0.003000, 7.43s
2024-04-30 18:27:53 INFO     Saved model at 9
2024-04-30 18:27:53 INFO     Val loss decrease from 6.5553 to 6.3274, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 18:28:00 INFO     epoch complete!
2024-04-30 18:28:00 INFO     evaluating now!
2024-04-30 18:28:00 INFO     Epoch [10/200] train_loss: 6.2028, val_loss: 6.1415, lr: 0.003000, 7.24s
2024-04-30 18:28:00 INFO     Saved model at 10
2024-04-30 18:28:00 INFO     Val loss decrease from 6.3274 to 6.1415, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 18:28:07 INFO     epoch complete!
2024-04-30 18:28:07 INFO     evaluating now!
2024-04-30 18:28:07 INFO     Epoch [11/200] train_loss: 5.9229, val_loss: 6.0748, lr: 0.003000, 7.39s
2024-04-30 18:28:07 INFO     Saved model at 11
2024-04-30 18:28:07 INFO     Val loss decrease from 6.1415 to 6.0748, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 18:28:14 INFO     epoch complete!
2024-04-30 18:28:14 INFO     evaluating now!
2024-04-30 18:28:15 INFO     Epoch [12/200] train_loss: 5.7661, val_loss: 5.8367, lr: 0.003000, 7.25s
2024-04-30 18:28:15 INFO     Saved model at 12
2024-04-30 18:28:15 INFO     Val loss decrease from 6.0748 to 5.8367, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 18:28:22 INFO     epoch complete!
2024-04-30 18:28:22 INFO     evaluating now!
2024-04-30 18:28:22 INFO     Epoch [13/200] train_loss: 5.5436, val_loss: 5.7234, lr: 0.003000, 7.49s
2024-04-30 18:28:22 INFO     Saved model at 13
2024-04-30 18:28:22 INFO     Val loss decrease from 5.8367 to 5.7234, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 18:28:29 INFO     epoch complete!
2024-04-30 18:28:29 INFO     evaluating now!
2024-04-30 18:28:30 INFO     Epoch [14/200] train_loss: 5.5955, val_loss: 5.8382, lr: 0.003000, 7.49s
2024-04-30 18:28:37 INFO     epoch complete!
2024-04-30 18:28:37 INFO     evaluating now!
2024-04-30 18:28:37 INFO     Epoch [15/200] train_loss: 5.3782, val_loss: 5.5837, lr: 0.003000, 7.38s
2024-04-30 18:28:37 INFO     Saved model at 15
2024-04-30 18:28:37 INFO     Val loss decrease from 5.7234 to 5.5837, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 18:28:44 INFO     epoch complete!
2024-04-30 18:28:44 INFO     evaluating now!
2024-04-30 18:28:44 INFO     Epoch [16/200] train_loss: 5.2943, val_loss: 5.6965, lr: 0.003000, 7.26s
2024-04-30 18:28:51 INFO     epoch complete!
2024-04-30 18:28:51 INFO     evaluating now!
2024-04-30 18:28:52 INFO     Epoch [17/200] train_loss: 5.2585, val_loss: 5.5286, lr: 0.003000, 7.26s
2024-04-30 18:28:52 INFO     Saved model at 17
2024-04-30 18:28:52 INFO     Val loss decrease from 5.5837 to 5.5286, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 18:28:59 INFO     epoch complete!
2024-04-30 18:28:59 INFO     evaluating now!
2024-04-30 18:28:59 INFO     Epoch [18/200] train_loss: 5.0847, val_loss: 5.4451, lr: 0.003000, 7.33s
2024-04-30 18:28:59 INFO     Saved model at 18
2024-04-30 18:28:59 INFO     Val loss decrease from 5.5286 to 5.4451, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 18:29:06 INFO     epoch complete!
2024-04-30 18:29:06 INFO     evaluating now!
2024-04-30 18:29:06 INFO     Epoch [19/200] train_loss: 5.0325, val_loss: 5.5888, lr: 0.003000, 7.21s
2024-04-30 18:29:13 INFO     epoch complete!
2024-04-30 18:29:13 INFO     evaluating now!
2024-04-30 18:29:14 INFO     Epoch [20/200] train_loss: 5.0336, val_loss: 5.4356, lr: 0.003000, 7.35s
2024-04-30 18:29:14 INFO     Saved model at 20
2024-04-30 18:29:14 INFO     Val loss decrease from 5.4451 to 5.4356, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-30 18:29:21 INFO     epoch complete!
2024-04-30 18:29:21 INFO     evaluating now!
2024-04-30 18:29:21 INFO     Epoch [21/200] train_loss: 4.9417, val_loss: 5.3870, lr: 0.003000, 7.36s
2024-04-30 18:29:21 INFO     Saved model at 21
2024-04-30 18:29:21 INFO     Val loss decrease from 5.4356 to 5.3870, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-30 18:29:28 INFO     epoch complete!
2024-04-30 18:29:28 INFO     evaluating now!
2024-04-30 18:29:28 INFO     Epoch [22/200] train_loss: 4.7871, val_loss: 5.4034, lr: 0.003000, 7.32s
2024-04-30 18:29:35 INFO     epoch complete!
2024-04-30 18:29:35 INFO     evaluating now!
2024-04-30 18:29:36 INFO     Epoch [23/200] train_loss: 4.7984, val_loss: 5.4482, lr: 0.003000, 7.35s
2024-04-30 18:29:43 INFO     epoch complete!
2024-04-30 18:29:43 INFO     evaluating now!
2024-04-30 18:29:43 INFO     Epoch [24/200] train_loss: 4.6845, val_loss: 5.3420, lr: 0.003000, 7.41s
2024-04-30 18:29:43 INFO     Saved model at 24
2024-04-30 18:29:43 INFO     Val loss decrease from 5.3870 to 5.3420, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-04-30 18:29:50 INFO     epoch complete!
2024-04-30 18:29:50 INFO     evaluating now!
2024-04-30 18:29:51 INFO     Epoch [25/200] train_loss: 4.6793, val_loss: 5.2855, lr: 0.003000, 7.49s
2024-04-30 18:29:51 INFO     Saved model at 25
2024-04-30 18:29:51 INFO     Val loss decrease from 5.3420 to 5.2855, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-30 18:29:58 INFO     epoch complete!
2024-04-30 18:29:58 INFO     evaluating now!
2024-04-30 18:29:58 INFO     Epoch [26/200] train_loss: 4.6208, val_loss: 5.2366, lr: 0.003000, 7.57s
2024-04-30 18:29:58 INFO     Saved model at 26
2024-04-30 18:29:58 INFO     Val loss decrease from 5.2855 to 5.2366, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-04-30 18:30:05 INFO     epoch complete!
2024-04-30 18:30:05 INFO     evaluating now!
2024-04-30 18:30:05 INFO     Epoch [27/200] train_loss: 4.5455, val_loss: 5.4052, lr: 0.003000, 6.98s
2024-04-30 18:30:12 INFO     epoch complete!
2024-04-30 18:30:12 INFO     evaluating now!
2024-04-30 18:30:13 INFO     Epoch [28/200] train_loss: 4.5562, val_loss: 5.2703, lr: 0.003000, 7.10s
2024-04-30 18:30:19 INFO     epoch complete!
2024-04-30 18:30:19 INFO     evaluating now!
2024-04-30 18:30:19 INFO     Epoch [29/200] train_loss: 4.5051, val_loss: 5.2279, lr: 0.003000, 6.86s
2024-04-30 18:30:19 INFO     Saved model at 29
2024-04-30 18:30:19 INFO     Val loss decrease from 5.2366 to 5.2279, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-04-30 18:30:26 INFO     epoch complete!
2024-04-30 18:30:26 INFO     evaluating now!
2024-04-30 18:30:26 INFO     Epoch [30/200] train_loss: 4.4395, val_loss: 5.3902, lr: 0.003000, 6.91s
2024-04-30 18:30:33 INFO     epoch complete!
2024-04-30 18:30:33 INFO     evaluating now!
2024-04-30 18:30:33 INFO     Epoch [31/200] train_loss: 4.4075, val_loss: 5.2062, lr: 0.003000, 6.89s
2024-04-30 18:30:33 INFO     Saved model at 31
2024-04-30 18:30:33 INFO     Val loss decrease from 5.2279 to 5.2062, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-04-30 18:30:40 INFO     epoch complete!
2024-04-30 18:30:40 INFO     evaluating now!
2024-04-30 18:30:40 INFO     Epoch [32/200] train_loss: 4.3859, val_loss: 5.4658, lr: 0.003000, 6.93s
2024-04-30 18:30:47 INFO     epoch complete!
2024-04-30 18:30:47 INFO     evaluating now!
2024-04-30 18:30:47 INFO     Epoch [33/200] train_loss: 4.3822, val_loss: 5.1319, lr: 0.003000, 6.89s
2024-04-30 18:30:47 INFO     Saved model at 33
2024-04-30 18:30:47 INFO     Val loss decrease from 5.2062 to 5.1319, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-04-30 18:30:54 INFO     epoch complete!
2024-04-30 18:30:54 INFO     evaluating now!
2024-04-30 18:30:54 INFO     Epoch [34/200] train_loss: 4.4190, val_loss: 5.3335, lr: 0.003000, 6.92s
2024-04-30 18:31:01 INFO     epoch complete!
2024-04-30 18:31:01 INFO     evaluating now!
2024-04-30 18:31:01 INFO     Epoch [35/200] train_loss: 4.2900, val_loss: 5.2632, lr: 0.003000, 6.91s
2024-04-30 18:31:07 INFO     epoch complete!
2024-04-30 18:31:07 INFO     evaluating now!
2024-04-30 18:31:08 INFO     Epoch [36/200] train_loss: 4.2737, val_loss: 5.1748, lr: 0.003000, 6.87s
2024-04-30 18:31:14 INFO     epoch complete!
2024-04-30 18:31:14 INFO     evaluating now!
2024-04-30 18:31:15 INFO     Epoch [37/200] train_loss: 4.2034, val_loss: 5.1942, lr: 0.003000, 6.92s
2024-04-30 18:31:21 INFO     epoch complete!
2024-04-30 18:31:21 INFO     evaluating now!
2024-04-30 18:31:22 INFO     Epoch [38/200] train_loss: 4.1613, val_loss: 5.1425, lr: 0.003000, 6.82s
2024-04-30 18:31:28 INFO     epoch complete!
2024-04-30 18:31:28 INFO     evaluating now!
2024-04-30 18:31:28 INFO     Epoch [39/200] train_loss: 4.2194, val_loss: 5.2143, lr: 0.003000, 6.87s
2024-04-30 18:31:35 INFO     epoch complete!
2024-04-30 18:31:35 INFO     evaluating now!
2024-04-30 18:31:35 INFO     Epoch [40/200] train_loss: 4.2113, val_loss: 5.1945, lr: 0.003000, 6.83s
2024-04-30 18:31:42 INFO     epoch complete!
2024-04-30 18:31:42 INFO     evaluating now!
2024-04-30 18:31:42 INFO     Epoch [41/200] train_loss: 4.1159, val_loss: 5.3108, lr: 0.003000, 6.90s
2024-04-30 18:31:49 INFO     epoch complete!
2024-04-30 18:31:49 INFO     evaluating now!
2024-04-30 18:31:49 INFO     Epoch [42/200] train_loss: 4.1985, val_loss: 5.2116, lr: 0.003000, 6.93s
2024-04-30 18:31:56 INFO     epoch complete!
2024-04-30 18:31:56 INFO     evaluating now!
2024-04-30 18:31:56 INFO     Epoch [43/200] train_loss: 4.0610, val_loss: 5.1412, lr: 0.003000, 6.88s
2024-04-30 18:32:02 INFO     epoch complete!
2024-04-30 18:32:02 INFO     evaluating now!
2024-04-30 18:32:03 INFO     Epoch [44/200] train_loss: 4.0105, val_loss: 5.1238, lr: 0.003000, 6.89s
2024-04-30 18:32:03 INFO     Saved model at 44
2024-04-30 18:32:03 INFO     Val loss decrease from 5.1319 to 5.1238, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-04-30 18:32:09 INFO     epoch complete!
2024-04-30 18:32:09 INFO     evaluating now!
2024-04-30 18:32:10 INFO     Epoch [45/200] train_loss: 3.9509, val_loss: 5.0955, lr: 0.003000, 6.78s
2024-04-30 18:32:10 INFO     Saved model at 45
2024-04-30 18:32:10 INFO     Val loss decrease from 5.1238 to 5.0955, saving to ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-04-30 18:32:16 INFO     epoch complete!
2024-04-30 18:32:16 INFO     evaluating now!
2024-04-30 18:32:17 INFO     Epoch [46/200] train_loss: 3.9330, val_loss: 5.2917, lr: 0.003000, 6.95s
2024-04-30 18:32:24 INFO     epoch complete!
2024-04-30 18:32:24 INFO     evaluating now!
2024-04-30 18:32:24 INFO     Epoch [47/200] train_loss: 3.9475, val_loss: 5.1407, lr: 0.003000, 7.64s
2024-04-30 18:32:31 INFO     epoch complete!
2024-04-30 18:32:31 INFO     evaluating now!
2024-04-30 18:32:32 INFO     Epoch [48/200] train_loss: 3.9472, val_loss: 5.1607, lr: 0.003000, 7.55s
2024-04-30 18:32:39 INFO     epoch complete!
2024-04-30 18:32:39 INFO     evaluating now!
2024-04-30 18:32:40 INFO     Epoch [49/200] train_loss: 3.9619, val_loss: 5.3134, lr: 0.003000, 7.65s
2024-04-30 18:32:47 INFO     epoch complete!
2024-04-30 18:32:47 INFO     evaluating now!
2024-04-30 18:32:47 INFO     Epoch [50/200] train_loss: 3.9323, val_loss: 5.2300, lr: 0.003000, 7.77s
2024-04-30 18:32:54 INFO     epoch complete!
2024-04-30 18:32:54 INFO     evaluating now!
2024-04-30 18:32:55 INFO     Epoch [51/200] train_loss: 3.8606, val_loss: 5.2379, lr: 0.003000, 7.58s
2024-04-30 18:33:01 INFO     epoch complete!
2024-04-30 18:33:01 INFO     evaluating now!
2024-04-30 18:33:02 INFO     Epoch [52/200] train_loss: 3.8253, val_loss: 5.1274, lr: 0.003000, 6.94s
2024-04-30 18:33:08 INFO     epoch complete!
2024-04-30 18:33:08 INFO     evaluating now!
2024-04-30 18:33:09 INFO     Epoch [53/200] train_loss: 3.8097, val_loss: 5.2845, lr: 0.003000, 6.80s
2024-04-30 18:33:15 INFO     epoch complete!
2024-04-30 18:33:15 INFO     evaluating now!
2024-04-30 18:33:16 INFO     Epoch [54/200] train_loss: 3.8161, val_loss: 5.2045, lr: 0.003000, 6.91s
2024-04-30 18:33:22 INFO     epoch complete!
2024-04-30 18:33:22 INFO     evaluating now!
2024-04-30 18:33:22 INFO     Epoch [55/200] train_loss: 3.7618, val_loss: 5.1172, lr: 0.003000, 6.64s
2024-04-30 18:33:29 INFO     epoch complete!
2024-04-30 18:33:29 INFO     evaluating now!
2024-04-30 18:33:29 INFO     Epoch [56/200] train_loss: 3.7322, val_loss: 5.2517, lr: 0.003000, 6.82s
2024-04-30 18:33:35 INFO     epoch complete!
2024-04-30 18:33:35 INFO     evaluating now!
2024-04-30 18:33:36 INFO     Epoch [57/200] train_loss: 3.7089, val_loss: 5.1091, lr: 0.003000, 6.88s
2024-04-30 18:33:43 INFO     epoch complete!
2024-04-30 18:33:43 INFO     evaluating now!
2024-04-30 18:33:43 INFO     Epoch [58/200] train_loss: 3.7438, val_loss: 5.2023, lr: 0.003000, 7.61s
2024-04-30 18:33:50 INFO     epoch complete!
2024-04-30 18:33:50 INFO     evaluating now!
2024-04-30 18:33:51 INFO     Epoch [59/200] train_loss: 3.7332, val_loss: 5.2152, lr: 0.003000, 7.50s
2024-04-30 18:33:58 INFO     epoch complete!
2024-04-30 18:33:58 INFO     evaluating now!
2024-04-30 18:33:58 INFO     Epoch [60/200] train_loss: 3.7193, val_loss: 5.2083, lr: 0.003000, 7.46s
2024-04-30 18:33:58 WARNING  Early stopping at epoch: 60
2024-04-30 18:33:58 INFO     Trained totally 61 epochs, average train time is 6.672s, average eval time is 0.477s
2024-04-30 18:33:59 INFO     Loaded model at 45
2024-04-30 18:33:59 INFO     Saved model at ./libcity/cache/39/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 18:33:59 INFO     Start evaluating ...
2024-04-30 18:34:00 INFO     Note that you select the single mode to evaluate!
2024-04-30 18:34:00 INFO     Evaluate result is saved at ./libcity/cache/39/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 18:34:00 INFO     
         MAE       RMSE
1   2.405461   7.078394
2   2.397129   7.563167
3   2.618280   8.527636
4   2.782721   9.457790
5   2.935786  10.540060
6   3.101379  11.627881
7   3.201044  12.615564
8   3.225638  13.077587
9   3.228046  13.170798
10  3.277416  13.282420
11  3.326060  13.275548
12  3.457168  13.682691
2024-04-30 18:34:00 INFO     ----------------------------------------------------------------------------
2024-04-30 18:34:00 INFO     Kownledge Graph Embedding: RefE, Experiment ids: [35, 36, 37, 38, 39]
2024-04-30 18:34:00 INFO     ----------------------------------------------------------------------------
2024-04-30 18:34:00 INFO     Average: 
         MAE       RMSE
0   2.418773   7.245180
1   2.485317   7.720316
2   2.629666   8.602984
3   2.769354   9.329816
4   2.895457  10.172520
5   3.019390  11.017574
6   3.122933  11.867463
7   3.199030  12.467778
8   3.220400  12.745439
9   3.277232  13.041939
10  3.354966  13.234956
11  3.473893  13.757286 
2024-04-30 18:34:00 INFO     Standard deviation: 
         MAE      RMSE
0   0.083844  0.154968
1   0.086109  0.123822
2   0.070454  0.093733
3   0.086611  0.115229
4   0.099426  0.280088
5   0.110588  0.447693
6   0.080796  0.444298
7   0.065526  0.306932
8   0.052087  0.259357
9   0.082653  0.253380
10  0.084313  0.263051
11  0.087435  0.245311
2024-04-30 18:34:00 INFO     ----------------------------------------------------------------------------
2024-04-30 18:34:00 INFO     12 steps Average: 
        MAE       RMSE
0  2.988868  10.933604
2024-04-30 18:34:00 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.082487  0.248988
