2024-09-03 14:32:49 INFO     Saving logs in: ./logs/CHITaxi20190406\AGCRN\ExtTime&Space\RandomE
2024-09-03 14:32:49 INFO     ----------------------------------------------------------------------------
2024-09-03 14:32:49 INFO     # 0, Kownledge Graph Embedding: RandomE, Experiment ids: 160
2024-09-03 14:32:49 INFO     ----------------------------------------------------------------------------
2024-09-03 14:32:49 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=160
2024-09-03 14:32:49 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 160, 'embedding_model': 'RandomE', 'add_time_in_day': True, 'add_day_in_week': True, 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-03 14:32:49 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-03 14:32:49 INFO     set_weight_link_or_dist: dist
2024-09-03 14:32:49 INFO     init_weight_inf_or_zero: inf
2024-09-03 14:32:49 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-03 14:32:49 INFO     Start Calculate the weight by Gauss kernel!
2024-09-03 14:32:49 INFO     Loading file CHITaxi20190406.dyna
2024-09-03 14:32:49 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-03 14:32:51 INFO     Dataset created
2024-09-03 14:32:51 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-09-03 14:32:51 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-09-03 14:32:51 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-09-03 14:32:51 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-09-03 14:32:52 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-03 14:32:52 INFO     NormalScaler max: 0.0028067830852947636
2024-09-03 14:32:56 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-03 14:32:56 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-03 14:32:56 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-09-03 14:32:56 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 14:32:56 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-09-03 14:32:56 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 14:32:56 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-03 14:32:56 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 14:32:56 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-03 14:32:56 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 14:32:56 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-03 14:32:56 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-03 14:32:56 INFO     Total parameter numbers: 904730
2024-09-03 14:32:56 INFO     You select `adam` optimizer.
2024-09-03 14:32:56 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-03 14:32:56 INFO     Start training ...
2024-09-03 14:32:56 INFO     num_batches:48
2024-09-03 14:33:03 INFO     epoch complete!
2024-09-03 14:33:03 INFO     evaluating now!
2024-09-03 14:33:04 INFO     Epoch [0/200] train_loss: 23.8461, val_loss: 17.6537, lr: 0.003000, 7.64s
2024-09-03 14:33:04 INFO     Saved model at 0
2024-09-03 14:33:04 INFO     Val loss decrease from inf to 17.6537, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-03 14:33:09 INFO     epoch complete!
2024-09-03 14:33:09 INFO     evaluating now!
2024-09-03 14:33:09 INFO     Epoch [1/200] train_loss: 13.9173, val_loss: 13.0260, lr: 0.003000, 5.45s
2024-09-03 14:33:09 INFO     Saved model at 1
2024-09-03 14:33:09 INFO     Val loss decrease from 17.6537 to 13.0260, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-03 14:33:14 INFO     epoch complete!
2024-09-03 14:33:14 INFO     evaluating now!
2024-09-03 14:33:15 INFO     Epoch [2/200] train_loss: 10.6559, val_loss: 10.3472, lr: 0.003000, 5.40s
2024-09-03 14:33:15 INFO     Saved model at 2
2024-09-03 14:33:15 INFO     Val loss decrease from 13.0260 to 10.3472, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-03 14:33:20 INFO     epoch complete!
2024-09-03 14:33:20 INFO     evaluating now!
2024-09-03 14:33:20 INFO     Epoch [3/200] train_loss: 8.4506, val_loss: 7.9331, lr: 0.003000, 5.55s
2024-09-03 14:33:20 INFO     Saved model at 3
2024-09-03 14:33:20 INFO     Val loss decrease from 10.3472 to 7.9331, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-03 14:33:25 INFO     epoch complete!
2024-09-03 14:33:25 INFO     evaluating now!
2024-09-03 14:33:25 INFO     Epoch [4/200] train_loss: 7.1983, val_loss: 6.9262, lr: 0.003000, 5.37s
2024-09-03 14:33:26 INFO     Saved model at 4
2024-09-03 14:33:26 INFO     Val loss decrease from 7.9331 to 6.9262, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-03 14:33:31 INFO     epoch complete!
2024-09-03 14:33:31 INFO     evaluating now!
2024-09-03 14:33:31 INFO     Epoch [5/200] train_loss: 6.5529, val_loss: 6.4892, lr: 0.003000, 5.47s
2024-09-03 14:33:31 INFO     Saved model at 5
2024-09-03 14:33:31 INFO     Val loss decrease from 6.9262 to 6.4892, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-03 14:33:36 INFO     epoch complete!
2024-09-03 14:33:36 INFO     evaluating now!
2024-09-03 14:33:37 INFO     Epoch [6/200] train_loss: 6.0674, val_loss: 5.9768, lr: 0.003000, 5.55s
2024-09-03 14:33:37 INFO     Saved model at 6
2024-09-03 14:33:37 INFO     Val loss decrease from 6.4892 to 5.9768, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-03 14:33:42 INFO     epoch complete!
2024-09-03 14:33:42 INFO     evaluating now!
2024-09-03 14:33:42 INFO     Epoch [7/200] train_loss: 5.7201, val_loss: 5.7541, lr: 0.003000, 5.32s
2024-09-03 14:33:42 INFO     Saved model at 7
2024-09-03 14:33:42 INFO     Val loss decrease from 5.9768 to 5.7541, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-03 14:33:47 INFO     epoch complete!
2024-09-03 14:33:47 INFO     evaluating now!
2024-09-03 14:33:47 INFO     Epoch [8/200] train_loss: 5.5588, val_loss: 6.0856, lr: 0.003000, 5.46s
2024-09-03 14:33:52 INFO     epoch complete!
2024-09-03 14:33:52 INFO     evaluating now!
2024-09-03 14:33:53 INFO     Epoch [9/200] train_loss: 5.3259, val_loss: 5.4612, lr: 0.003000, 5.35s
2024-09-03 14:33:53 INFO     Saved model at 9
2024-09-03 14:33:53 INFO     Val loss decrease from 5.7541 to 5.4612, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-03 14:33:58 INFO     epoch complete!
2024-09-03 14:33:58 INFO     evaluating now!
2024-09-03 14:33:58 INFO     Epoch [10/200] train_loss: 5.1081, val_loss: 5.3353, lr: 0.003000, 5.35s
2024-09-03 14:33:58 INFO     Saved model at 10
2024-09-03 14:33:58 INFO     Val loss decrease from 5.4612 to 5.3353, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-03 14:34:03 INFO     epoch complete!
2024-09-03 14:34:03 INFO     evaluating now!
2024-09-03 14:34:04 INFO     Epoch [11/200] train_loss: 4.9739, val_loss: 5.2322, lr: 0.003000, 5.50s
2024-09-03 14:34:04 INFO     Saved model at 11
2024-09-03 14:34:04 INFO     Val loss decrease from 5.3353 to 5.2322, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-03 14:34:09 INFO     epoch complete!
2024-09-03 14:34:09 INFO     evaluating now!
2024-09-03 14:34:09 INFO     Epoch [12/200] train_loss: 4.8795, val_loss: 5.2517, lr: 0.003000, 5.37s
2024-09-03 14:34:14 INFO     epoch complete!
2024-09-03 14:34:14 INFO     evaluating now!
2024-09-03 14:34:14 INFO     Epoch [13/200] train_loss: 4.9015, val_loss: 5.1448, lr: 0.003000, 5.35s
2024-09-03 14:34:14 INFO     Saved model at 13
2024-09-03 14:34:14 INFO     Val loss decrease from 5.2322 to 5.1448, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-03 14:34:19 INFO     epoch complete!
2024-09-03 14:34:19 INFO     evaluating now!
2024-09-03 14:34:20 INFO     Epoch [14/200] train_loss: 4.6723, val_loss: 5.2274, lr: 0.003000, 5.49s
2024-09-03 14:34:25 INFO     epoch complete!
2024-09-03 14:34:25 INFO     evaluating now!
2024-09-03 14:34:25 INFO     Epoch [15/200] train_loss: 4.6082, val_loss: 5.0181, lr: 0.003000, 5.33s
2024-09-03 14:34:25 INFO     Saved model at 15
2024-09-03 14:34:25 INFO     Val loss decrease from 5.1448 to 5.0181, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-03 14:34:30 INFO     epoch complete!
2024-09-03 14:34:30 INFO     evaluating now!
2024-09-03 14:34:31 INFO     Epoch [16/200] train_loss: 4.5419, val_loss: 5.1029, lr: 0.003000, 5.34s
2024-09-03 14:34:36 INFO     epoch complete!
2024-09-03 14:34:36 INFO     evaluating now!
2024-09-03 14:34:36 INFO     Epoch [17/200] train_loss: 4.5564, val_loss: 5.1091, lr: 0.003000, 5.40s
2024-09-03 14:34:41 INFO     epoch complete!
2024-09-03 14:34:41 INFO     evaluating now!
2024-09-03 14:34:41 INFO     Epoch [18/200] train_loss: 4.4645, val_loss: 5.3802, lr: 0.003000, 5.34s
2024-09-03 14:34:46 INFO     epoch complete!
2024-09-03 14:34:46 INFO     evaluating now!
2024-09-03 14:34:47 INFO     Epoch [19/200] train_loss: 4.4513, val_loss: 5.0123, lr: 0.003000, 5.31s
2024-09-03 14:34:47 INFO     Saved model at 19
2024-09-03 14:34:47 INFO     Val loss decrease from 5.0181 to 5.0123, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-03 14:34:52 INFO     epoch complete!
2024-09-03 14:34:52 INFO     evaluating now!
2024-09-03 14:34:52 INFO     Epoch [20/200] train_loss: 4.3270, val_loss: 4.9561, lr: 0.003000, 5.41s
2024-09-03 14:34:52 INFO     Saved model at 20
2024-09-03 14:34:52 INFO     Val loss decrease from 5.0123 to 4.9561, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-03 14:34:57 INFO     epoch complete!
2024-09-03 14:34:57 INFO     evaluating now!
2024-09-03 14:34:57 INFO     Epoch [21/200] train_loss: 4.3214, val_loss: 4.7527, lr: 0.003000, 5.33s
2024-09-03 14:34:57 INFO     Saved model at 21
2024-09-03 14:34:57 INFO     Val loss decrease from 4.9561 to 4.7527, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-03 14:35:02 INFO     epoch complete!
2024-09-03 14:35:02 INFO     evaluating now!
2024-09-03 14:35:03 INFO     Epoch [22/200] train_loss: 4.2193, val_loss: 5.0231, lr: 0.003000, 5.39s
2024-09-03 14:35:08 INFO     epoch complete!
2024-09-03 14:35:08 INFO     evaluating now!
2024-09-03 14:35:08 INFO     Epoch [23/200] train_loss: 4.1757, val_loss: 4.9616, lr: 0.003000, 5.32s
2024-09-03 14:35:13 INFO     epoch complete!
2024-09-03 14:35:13 INFO     evaluating now!
2024-09-03 14:35:13 INFO     Epoch [24/200] train_loss: 4.1304, val_loss: 4.9154, lr: 0.003000, 5.31s
2024-09-03 14:35:18 INFO     epoch complete!
2024-09-03 14:35:18 INFO     evaluating now!
2024-09-03 14:35:19 INFO     Epoch [25/200] train_loss: 4.0880, val_loss: 4.7798, lr: 0.003000, 5.41s
2024-09-03 14:35:24 INFO     epoch complete!
2024-09-03 14:35:24 INFO     evaluating now!
2024-09-03 14:35:24 INFO     Epoch [26/200] train_loss: 4.0689, val_loss: 4.7143, lr: 0.003000, 5.32s
2024-09-03 14:35:24 INFO     Saved model at 26
2024-09-03 14:35:24 INFO     Val loss decrease from 4.7527 to 4.7143, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-03 14:35:29 INFO     epoch complete!
2024-09-03 14:35:29 INFO     evaluating now!
2024-09-03 14:35:29 INFO     Epoch [27/200] train_loss: 3.9929, val_loss: 4.6911, lr: 0.003000, 5.32s
2024-09-03 14:35:29 INFO     Saved model at 27
2024-09-03 14:35:29 INFO     Val loss decrease from 4.7143 to 4.6911, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-03 14:35:35 INFO     epoch complete!
2024-09-03 14:35:35 INFO     evaluating now!
2024-09-03 14:35:35 INFO     Epoch [28/200] train_loss: 4.0388, val_loss: 4.8960, lr: 0.003000, 5.41s
2024-09-03 14:35:40 INFO     epoch complete!
2024-09-03 14:35:40 INFO     evaluating now!
2024-09-03 14:35:40 INFO     Epoch [29/200] train_loss: 3.9055, val_loss: 4.8234, lr: 0.003000, 5.31s
2024-09-03 14:35:45 INFO     epoch complete!
2024-09-03 14:35:45 INFO     evaluating now!
2024-09-03 14:35:45 INFO     Epoch [30/200] train_loss: 3.8922, val_loss: 4.7085, lr: 0.003000, 5.31s
2024-09-03 14:35:51 INFO     epoch complete!
2024-09-03 14:35:51 INFO     evaluating now!
2024-09-03 14:35:51 INFO     Epoch [31/200] train_loss: 3.8787, val_loss: 4.6693, lr: 0.003000, 5.37s
2024-09-03 14:35:51 INFO     Saved model at 31
2024-09-03 14:35:51 INFO     Val loss decrease from 4.6911 to 4.6693, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-09-03 14:35:56 INFO     epoch complete!
2024-09-03 14:35:56 INFO     evaluating now!
2024-09-03 14:35:56 INFO     Epoch [32/200] train_loss: 3.8061, val_loss: 4.7522, lr: 0.003000, 5.33s
2024-09-03 14:36:01 INFO     epoch complete!
2024-09-03 14:36:01 INFO     evaluating now!
2024-09-03 14:36:02 INFO     Epoch [33/200] train_loss: 3.8206, val_loss: 4.6706, lr: 0.003000, 5.32s
2024-09-03 14:36:07 INFO     epoch complete!
2024-09-03 14:36:07 INFO     evaluating now!
2024-09-03 14:36:07 INFO     Epoch [34/200] train_loss: 3.8130, val_loss: 5.0962, lr: 0.003000, 5.42s
2024-09-03 14:36:12 INFO     epoch complete!
2024-09-03 14:36:12 INFO     evaluating now!
2024-09-03 14:36:12 INFO     Epoch [35/200] train_loss: 3.8378, val_loss: 4.8893, lr: 0.003000, 5.31s
2024-09-03 14:36:17 INFO     epoch complete!
2024-09-03 14:36:17 INFO     evaluating now!
2024-09-03 14:36:18 INFO     Epoch [36/200] train_loss: 3.7499, val_loss: 4.7256, lr: 0.003000, 5.39s
2024-09-03 14:36:23 INFO     epoch complete!
2024-09-03 14:36:23 INFO     evaluating now!
2024-09-03 14:36:23 INFO     Epoch [37/200] train_loss: 3.6841, val_loss: 4.7615, lr: 0.003000, 5.30s
2024-09-03 14:36:28 INFO     epoch complete!
2024-09-03 14:36:28 INFO     evaluating now!
2024-09-03 14:36:28 INFO     Epoch [38/200] train_loss: 3.7176, val_loss: 4.6708, lr: 0.003000, 5.31s
2024-09-03 14:36:33 INFO     epoch complete!
2024-09-03 14:36:33 INFO     evaluating now!
2024-09-03 14:36:34 INFO     Epoch [39/200] train_loss: 3.6614, val_loss: 4.7337, lr: 0.003000, 5.38s
2024-09-03 14:36:39 INFO     epoch complete!
2024-09-03 14:36:39 INFO     evaluating now!
2024-09-03 14:36:39 INFO     Epoch [40/200] train_loss: 3.6627, val_loss: 4.8162, lr: 0.003000, 5.31s
2024-09-03 14:36:44 INFO     epoch complete!
2024-09-03 14:36:44 INFO     evaluating now!
2024-09-03 14:36:44 INFO     Epoch [41/200] train_loss: 3.6326, val_loss: 4.7988, lr: 0.003000, 5.31s
2024-09-03 14:36:49 INFO     epoch complete!
2024-09-03 14:36:49 INFO     evaluating now!
2024-09-03 14:36:50 INFO     Epoch [42/200] train_loss: 3.5939, val_loss: 4.7436, lr: 0.003000, 5.36s
2024-09-03 14:36:55 INFO     epoch complete!
2024-09-03 14:36:55 INFO     evaluating now!
2024-09-03 14:36:55 INFO     Epoch [43/200] train_loss: 3.6505, val_loss: 4.7333, lr: 0.003000, 5.31s
2024-09-03 14:37:00 INFO     epoch complete!
2024-09-03 14:37:00 INFO     evaluating now!
2024-09-03 14:37:00 INFO     Epoch [44/200] train_loss: 3.5856, val_loss: 4.7273, lr: 0.003000, 5.33s
2024-09-03 14:37:05 INFO     epoch complete!
2024-09-03 14:37:05 INFO     evaluating now!
2024-09-03 14:37:06 INFO     Epoch [45/200] train_loss: 3.5539, val_loss: 4.6888, lr: 0.003000, 5.40s
2024-09-03 14:37:11 INFO     epoch complete!
2024-09-03 14:37:11 INFO     evaluating now!
2024-09-03 14:37:11 INFO     Epoch [46/200] train_loss: 3.5370, val_loss: 4.8307, lr: 0.003000, 5.31s
2024-09-03 14:37:11 WARNING  Early stopping at epoch: 46
2024-09-03 14:37:11 INFO     Trained totally 47 epochs, average train time is 5.082s, average eval time is 0.335s
2024-09-03 14:37:11 INFO     Loaded model at 31
2024-09-03 14:37:11 INFO     Saved model at ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406.m
2024-09-03 14:37:11 INFO     Start evaluating ...
2024-09-03 14:37:12 INFO     Note that you select the single mode to evaluate!
2024-09-03 14:37:12 INFO     Evaluate result is saved at ./libcity/cache/160/evaluate_cache\2024_09_03_14_37_12_AGCRN_CHITaxi20190406.csv
2024-09-03 14:37:12 INFO     
         MAE       RMSE
1   2.203552   7.098391
2   2.256728   7.532046
3   2.387658   8.119126
4   2.488846   8.394085
5   2.529327   8.685639
6   2.567080   8.834202
7   2.607854   9.075458
8   2.605222   9.296018
9   2.653863   9.494626
10  2.682369   9.627329
11  2.687442   9.864440
12  2.797596  10.295789
2024-09-03 14:37:12 INFO     ----------------------------------------------------------------------------
2024-09-03 14:37:12 INFO     # 1, Kownledge Graph Embedding: RandomE, Experiment ids: 161
2024-09-03 14:37:12 INFO     ----------------------------------------------------------------------------
2024-09-03 14:37:12 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=160
2024-09-03 14:37:12 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 160, 'embedding_model': 'RandomE', 'add_time_in_day': True, 'add_day_in_week': True, 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-03 14:37:12 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-03 14:37:12 INFO     set_weight_link_or_dist: dist
2024-09-03 14:37:12 INFO     init_weight_inf_or_zero: inf
2024-09-03 14:37:12 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-03 14:37:12 INFO     Start Calculate the weight by Gauss kernel!
2024-09-03 14:37:12 INFO     Loading file CHITaxi20190406.dyna
2024-09-03 14:37:12 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-03 14:37:16 INFO     Dataset created
2024-09-03 14:37:16 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-09-03 14:37:16 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-09-03 14:37:16 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-09-03 14:37:16 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-09-03 14:37:16 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-03 14:37:16 INFO     NormalScaler max: 0.0028067830852947636
2024-09-03 14:37:19 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-03 14:37:19 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-03 14:37:19 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-09-03 14:37:19 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 14:37:19 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-09-03 14:37:19 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 14:37:19 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-03 14:37:19 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 14:37:19 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-03 14:37:19 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 14:37:19 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-03 14:37:19 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-03 14:37:19 INFO     Total parameter numbers: 904730
2024-09-03 14:37:19 INFO     You select `adam` optimizer.
2024-09-03 14:37:19 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-03 14:37:19 INFO     Start training ...
2024-09-03 14:37:19 INFO     num_batches:48
2024-09-03 14:37:24 INFO     epoch complete!
2024-09-03 14:37:24 INFO     evaluating now!
2024-09-03 14:37:24 INFO     Epoch [0/200] train_loss: 24.1491, val_loss: 17.5106, lr: 0.003000, 5.52s
2024-09-03 14:37:24 INFO     Saved model at 0
2024-09-03 14:37:24 INFO     Val loss decrease from inf to 17.5106, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-03 14:37:29 INFO     epoch complete!
2024-09-03 14:37:29 INFO     evaluating now!
2024-09-03 14:37:29 INFO     Epoch [1/200] train_loss: 13.7178, val_loss: 12.6919, lr: 0.003000, 5.33s
2024-09-03 14:37:30 INFO     Saved model at 1
2024-09-03 14:37:30 INFO     Val loss decrease from 17.5106 to 12.6919, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-03 14:37:35 INFO     epoch complete!
2024-09-03 14:37:35 INFO     evaluating now!
2024-09-03 14:37:35 INFO     Epoch [2/200] train_loss: 10.0325, val_loss: 9.3692, lr: 0.003000, 5.44s
2024-09-03 14:37:35 INFO     Saved model at 2
2024-09-03 14:37:35 INFO     Val loss decrease from 12.6919 to 9.3692, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-03 14:37:40 INFO     epoch complete!
2024-09-03 14:37:40 INFO     evaluating now!
2024-09-03 14:37:40 INFO     Epoch [3/200] train_loss: 7.9466, val_loss: 7.3440, lr: 0.003000, 5.33s
2024-09-03 14:37:40 INFO     Saved model at 3
2024-09-03 14:37:40 INFO     Val loss decrease from 9.3692 to 7.3440, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-03 14:37:45 INFO     epoch complete!
2024-09-03 14:37:45 INFO     evaluating now!
2024-09-03 14:37:46 INFO     Epoch [4/200] train_loss: 6.9270, val_loss: 7.0098, lr: 0.003000, 5.30s
2024-09-03 14:37:46 INFO     Saved model at 4
2024-09-03 14:37:46 INFO     Val loss decrease from 7.3440 to 7.0098, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-03 14:37:51 INFO     epoch complete!
2024-09-03 14:37:51 INFO     evaluating now!
2024-09-03 14:37:51 INFO     Epoch [5/200] train_loss: 6.2813, val_loss: 6.2292, lr: 0.003000, 5.39s
2024-09-03 14:37:51 INFO     Saved model at 5
2024-09-03 14:37:51 INFO     Val loss decrease from 7.0098 to 6.2292, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-03 14:37:56 INFO     epoch complete!
2024-09-03 14:37:56 INFO     evaluating now!
2024-09-03 14:37:56 INFO     Epoch [6/200] train_loss: 5.8634, val_loss: 5.7572, lr: 0.003000, 5.35s
2024-09-03 14:37:56 INFO     Saved model at 6
2024-09-03 14:37:56 INFO     Val loss decrease from 6.2292 to 5.7572, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-03 14:38:01 INFO     epoch complete!
2024-09-03 14:38:01 INFO     evaluating now!
2024-09-03 14:38:02 INFO     Epoch [7/200] train_loss: 5.7212, val_loss: 5.6108, lr: 0.003000, 5.32s
2024-09-03 14:38:02 INFO     Saved model at 7
2024-09-03 14:38:02 INFO     Val loss decrease from 5.7572 to 5.6108, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-03 14:38:07 INFO     epoch complete!
2024-09-03 14:38:07 INFO     evaluating now!
2024-09-03 14:38:07 INFO     Epoch [8/200] train_loss: 5.4290, val_loss: 5.5114, lr: 0.003000, 5.36s
2024-09-03 14:38:07 INFO     Saved model at 8
2024-09-03 14:38:07 INFO     Val loss decrease from 5.6108 to 5.5114, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-03 14:38:12 INFO     epoch complete!
2024-09-03 14:38:12 INFO     evaluating now!
2024-09-03 14:38:12 INFO     Epoch [9/200] train_loss: 5.1950, val_loss: 5.4620, lr: 0.003000, 5.32s
2024-09-03 14:38:12 INFO     Saved model at 9
2024-09-03 14:38:12 INFO     Val loss decrease from 5.5114 to 5.4620, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-03 14:38:17 INFO     epoch complete!
2024-09-03 14:38:17 INFO     evaluating now!
2024-09-03 14:38:18 INFO     Epoch [10/200] train_loss: 5.0552, val_loss: 5.1873, lr: 0.003000, 5.37s
2024-09-03 14:38:18 INFO     Saved model at 10
2024-09-03 14:38:18 INFO     Val loss decrease from 5.4620 to 5.1873, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-03 14:38:23 INFO     epoch complete!
2024-09-03 14:38:23 INFO     evaluating now!
2024-09-03 14:38:23 INFO     Epoch [11/200] train_loss: 4.8775, val_loss: 5.2363, lr: 0.003000, 5.29s
2024-09-03 14:38:28 INFO     epoch complete!
2024-09-03 14:38:28 INFO     evaluating now!
2024-09-03 14:38:28 INFO     Epoch [12/200] train_loss: 4.7971, val_loss: 5.0281, lr: 0.003000, 5.31s
2024-09-03 14:38:28 INFO     Saved model at 12
2024-09-03 14:38:28 INFO     Val loss decrease from 5.1873 to 5.0281, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-03 14:38:33 INFO     epoch complete!
2024-09-03 14:38:34 INFO     evaluating now!
2024-09-03 14:38:34 INFO     Epoch [13/200] train_loss: 4.7192, val_loss: 5.2754, lr: 0.003000, 5.37s
2024-09-03 14:38:39 INFO     epoch complete!
2024-09-03 14:38:39 INFO     evaluating now!
2024-09-03 14:38:39 INFO     Epoch [14/200] train_loss: 4.5776, val_loss: 4.8869, lr: 0.003000, 5.30s
2024-09-03 14:38:39 INFO     Saved model at 14
2024-09-03 14:38:39 INFO     Val loss decrease from 5.0281 to 4.8869, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-03 14:38:44 INFO     epoch complete!
2024-09-03 14:38:44 INFO     evaluating now!
2024-09-03 14:38:44 INFO     Epoch [15/200] train_loss: 4.5076, val_loss: 4.9114, lr: 0.003000, 5.30s
2024-09-03 14:38:50 INFO     epoch complete!
2024-09-03 14:38:50 INFO     evaluating now!
2024-09-03 14:38:50 INFO     Epoch [16/200] train_loss: 4.4819, val_loss: 5.0288, lr: 0.003000, 5.40s
2024-09-03 14:38:55 INFO     epoch complete!
2024-09-03 14:38:55 INFO     evaluating now!
2024-09-03 14:38:55 INFO     Epoch [17/200] train_loss: 4.3816, val_loss: 4.8928, lr: 0.003000, 5.32s
2024-09-03 14:39:00 INFO     epoch complete!
2024-09-03 14:39:00 INFO     evaluating now!
2024-09-03 14:39:00 INFO     Epoch [18/200] train_loss: 4.2914, val_loss: 4.7407, lr: 0.003000, 5.31s
2024-09-03 14:39:00 INFO     Saved model at 18
2024-09-03 14:39:00 INFO     Val loss decrease from 4.8869 to 4.7407, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-03 14:39:05 INFO     epoch complete!
2024-09-03 14:39:05 INFO     evaluating now!
2024-09-03 14:39:06 INFO     Epoch [19/200] train_loss: 4.2443, val_loss: 4.8631, lr: 0.003000, 5.34s
2024-09-03 14:39:11 INFO     epoch complete!
2024-09-03 14:39:11 INFO     evaluating now!
2024-09-03 14:39:11 INFO     Epoch [20/200] train_loss: 4.2393, val_loss: 4.8411, lr: 0.003000, 5.30s
2024-09-03 14:39:16 INFO     epoch complete!
2024-09-03 14:39:16 INFO     evaluating now!
2024-09-03 14:39:16 INFO     Epoch [21/200] train_loss: 4.1853, val_loss: 4.7427, lr: 0.003000, 5.31s
2024-09-03 14:39:21 INFO     epoch complete!
2024-09-03 14:39:21 INFO     evaluating now!
2024-09-03 14:39:22 INFO     Epoch [22/200] train_loss: 4.1839, val_loss: 4.9532, lr: 0.003000, 5.36s
2024-09-03 14:39:27 INFO     epoch complete!
2024-09-03 14:39:27 INFO     evaluating now!
2024-09-03 14:39:27 INFO     Epoch [23/200] train_loss: 4.1009, val_loss: 4.8072, lr: 0.003000, 5.31s
2024-09-03 14:39:32 INFO     epoch complete!
2024-09-03 14:39:32 INFO     evaluating now!
2024-09-03 14:39:32 INFO     Epoch [24/200] train_loss: 4.0678, val_loss: 5.0139, lr: 0.003000, 5.31s
2024-09-03 14:39:37 INFO     epoch complete!
2024-09-03 14:39:37 INFO     evaluating now!
2024-09-03 14:39:38 INFO     Epoch [25/200] train_loss: 3.9831, val_loss: 4.7603, lr: 0.003000, 5.37s
2024-09-03 14:39:43 INFO     epoch complete!
2024-09-03 14:39:43 INFO     evaluating now!
2024-09-03 14:39:43 INFO     Epoch [26/200] train_loss: 4.0065, val_loss: 4.8699, lr: 0.003000, 5.30s
2024-09-03 14:39:48 INFO     epoch complete!
2024-09-03 14:39:48 INFO     evaluating now!
2024-09-03 14:39:48 INFO     Epoch [27/200] train_loss: 3.9388, val_loss: 4.7024, lr: 0.003000, 5.36s
2024-09-03 14:39:48 INFO     Saved model at 27
2024-09-03 14:39:48 INFO     Val loss decrease from 4.7407 to 4.7024, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-03 14:39:53 INFO     epoch complete!
2024-09-03 14:39:53 INFO     evaluating now!
2024-09-03 14:39:54 INFO     Epoch [28/200] train_loss: 3.8828, val_loss: 4.8220, lr: 0.003000, 5.32s
2024-09-03 14:39:59 INFO     epoch complete!
2024-09-03 14:39:59 INFO     evaluating now!
2024-09-03 14:39:59 INFO     Epoch [29/200] train_loss: 3.7950, val_loss: 4.6896, lr: 0.003000, 5.31s
2024-09-03 14:39:59 INFO     Saved model at 29
2024-09-03 14:39:59 INFO     Val loss decrease from 4.7024 to 4.6896, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-03 14:40:04 INFO     epoch complete!
2024-09-03 14:40:04 INFO     evaluating now!
2024-09-03 14:40:05 INFO     Epoch [30/200] train_loss: 3.8392, val_loss: 4.8455, lr: 0.003000, 5.45s
2024-09-03 14:40:10 INFO     epoch complete!
2024-09-03 14:40:10 INFO     evaluating now!
2024-09-03 14:40:10 INFO     Epoch [31/200] train_loss: 3.7940, val_loss: 4.7315, lr: 0.003000, 5.35s
2024-09-03 14:40:15 INFO     epoch complete!
2024-09-03 14:40:15 INFO     evaluating now!
2024-09-03 14:40:15 INFO     Epoch [32/200] train_loss: 3.7711, val_loss: 4.6188, lr: 0.003000, 5.34s
2024-09-03 14:40:15 INFO     Saved model at 32
2024-09-03 14:40:15 INFO     Val loss decrease from 4.6896 to 4.6188, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-09-03 14:40:20 INFO     epoch complete!
2024-09-03 14:40:20 INFO     evaluating now!
2024-09-03 14:40:21 INFO     Epoch [33/200] train_loss: 3.7487, val_loss: 4.6964, lr: 0.003000, 5.40s
2024-09-03 14:40:26 INFO     epoch complete!
2024-09-03 14:40:26 INFO     evaluating now!
2024-09-03 14:40:26 INFO     Epoch [34/200] train_loss: 3.7030, val_loss: 4.9495, lr: 0.003000, 5.33s
2024-09-03 14:40:31 INFO     epoch complete!
2024-09-03 14:40:31 INFO     evaluating now!
2024-09-03 14:40:31 INFO     Epoch [35/200] train_loss: 3.6825, val_loss: 4.7332, lr: 0.003000, 5.33s
2024-09-03 14:40:36 INFO     epoch complete!
2024-09-03 14:40:36 INFO     evaluating now!
2024-09-03 14:40:37 INFO     Epoch [36/200] train_loss: 3.6906, val_loss: 4.7856, lr: 0.003000, 5.37s
2024-09-03 14:40:42 INFO     epoch complete!
2024-09-03 14:40:42 INFO     evaluating now!
2024-09-03 14:40:42 INFO     Epoch [37/200] train_loss: 3.6402, val_loss: 4.6295, lr: 0.003000, 5.30s
2024-09-03 14:40:47 INFO     epoch complete!
2024-09-03 14:40:47 INFO     evaluating now!
2024-09-03 14:40:47 INFO     Epoch [38/200] train_loss: 3.5997, val_loss: 4.7212, lr: 0.003000, 5.32s
2024-09-03 14:40:52 INFO     epoch complete!
2024-09-03 14:40:52 INFO     evaluating now!
2024-09-03 14:40:53 INFO     Epoch [39/200] train_loss: 3.5988, val_loss: 4.6101, lr: 0.003000, 5.34s
2024-09-03 14:40:53 INFO     Saved model at 39
2024-09-03 14:40:53 INFO     Val loss decrease from 4.6188 to 4.6101, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-09-03 14:40:58 INFO     epoch complete!
2024-09-03 14:40:58 INFO     evaluating now!
2024-09-03 14:40:58 INFO     Epoch [40/200] train_loss: 3.5818, val_loss: 4.8025, lr: 0.003000, 5.32s
2024-09-03 14:41:03 INFO     epoch complete!
2024-09-03 14:41:03 INFO     evaluating now!
2024-09-03 14:41:03 INFO     Epoch [41/200] train_loss: 3.5754, val_loss: 4.6951, lr: 0.003000, 5.37s
2024-09-03 14:41:08 INFO     epoch complete!
2024-09-03 14:41:08 INFO     evaluating now!
2024-09-03 14:41:09 INFO     Epoch [42/200] train_loss: 3.5602, val_loss: 4.6907, lr: 0.003000, 5.30s
2024-09-03 14:41:14 INFO     epoch complete!
2024-09-03 14:41:14 INFO     evaluating now!
2024-09-03 14:41:14 INFO     Epoch [43/200] train_loss: 3.5385, val_loss: 4.6840, lr: 0.003000, 5.31s
2024-09-03 14:41:19 INFO     epoch complete!
2024-09-03 14:41:19 INFO     evaluating now!
2024-09-03 14:41:19 INFO     Epoch [44/200] train_loss: 3.4952, val_loss: 4.8138, lr: 0.003000, 5.35s
2024-09-03 14:41:24 INFO     epoch complete!
2024-09-03 14:41:24 INFO     evaluating now!
2024-09-03 14:41:25 INFO     Epoch [45/200] train_loss: 3.4771, val_loss: 4.7073, lr: 0.003000, 5.31s
2024-09-03 14:41:30 INFO     epoch complete!
2024-09-03 14:41:30 INFO     evaluating now!
2024-09-03 14:41:30 INFO     Epoch [46/200] train_loss: 3.4713, val_loss: 4.6503, lr: 0.003000, 5.30s
2024-09-03 14:41:35 INFO     epoch complete!
2024-09-03 14:41:35 INFO     evaluating now!
2024-09-03 14:41:35 INFO     Epoch [47/200] train_loss: 3.4679, val_loss: 4.7289, lr: 0.003000, 5.36s
2024-09-03 14:41:40 INFO     epoch complete!
2024-09-03 14:41:40 INFO     evaluating now!
2024-09-03 14:41:41 INFO     Epoch [48/200] train_loss: 3.4404, val_loss: 4.7313, lr: 0.003000, 5.31s
2024-09-03 14:41:46 INFO     epoch complete!
2024-09-03 14:41:46 INFO     evaluating now!
2024-09-03 14:41:46 INFO     Epoch [49/200] train_loss: 3.4172, val_loss: 4.7640, lr: 0.003000, 5.35s
2024-09-03 14:41:51 INFO     epoch complete!
2024-09-03 14:41:51 INFO     evaluating now!
2024-09-03 14:41:51 INFO     Epoch [50/200] train_loss: 3.4460, val_loss: 4.7305, lr: 0.003000, 5.36s
2024-09-03 14:41:56 INFO     epoch complete!
2024-09-03 14:41:56 INFO     evaluating now!
2024-09-03 14:41:57 INFO     Epoch [51/200] train_loss: 3.3843, val_loss: 4.8566, lr: 0.003000, 5.35s
2024-09-03 14:42:02 INFO     epoch complete!
2024-09-03 14:42:02 INFO     evaluating now!
2024-09-03 14:42:02 INFO     Epoch [52/200] train_loss: 3.4122, val_loss: 4.7748, lr: 0.003000, 5.38s
2024-09-03 14:42:07 INFO     epoch complete!
2024-09-03 14:42:07 INFO     evaluating now!
2024-09-03 14:42:07 INFO     Epoch [53/200] train_loss: 3.3950, val_loss: 4.8255, lr: 0.003000, 5.43s
2024-09-03 14:42:13 INFO     epoch complete!
2024-09-03 14:42:13 INFO     evaluating now!
2024-09-03 14:42:13 INFO     Epoch [54/200] train_loss: 3.4312, val_loss: 4.7515, lr: 0.003000, 5.37s
2024-09-03 14:42:13 WARNING  Early stopping at epoch: 54
2024-09-03 14:42:13 INFO     Trained totally 55 epochs, average train time is 5.011s, average eval time is 0.333s
2024-09-03 14:42:13 INFO     Loaded model at 39
2024-09-03 14:42:13 INFO     Saved model at ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406.m
2024-09-03 14:42:13 INFO     Start evaluating ...
2024-09-03 14:42:14 INFO     Note that you select the single mode to evaluate!
2024-09-03 14:42:14 INFO     Evaluate result is saved at ./libcity/cache/160/evaluate_cache\2024_09_03_14_42_14_AGCRN_CHITaxi20190406.csv
2024-09-03 14:42:14 INFO     
         MAE       RMSE
1   2.269953   6.605849
2   2.317056   7.242176
3   2.452626   8.114237
4   2.536655   8.584298
5   2.610743   8.921112
6   2.626950   9.237369
7   2.708086   9.504769
8   2.759479   9.742045
9   2.788814   9.954001
10  2.856832  10.131991
11  2.884289  10.385468
12  2.999681  10.627172
2024-09-03 14:42:14 INFO     ----------------------------------------------------------------------------
2024-09-03 14:42:14 INFO     # 2, Kownledge Graph Embedding: RandomE, Experiment ids: 162
2024-09-03 14:42:14 INFO     ----------------------------------------------------------------------------
2024-09-03 14:42:14 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=160
2024-09-03 14:42:14 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 160, 'embedding_model': 'RandomE', 'add_time_in_day': True, 'add_day_in_week': True, 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-03 14:42:14 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-03 14:42:14 INFO     set_weight_link_or_dist: dist
2024-09-03 14:42:14 INFO     init_weight_inf_or_zero: inf
2024-09-03 14:42:14 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-03 14:42:14 INFO     Start Calculate the weight by Gauss kernel!
2024-09-03 14:42:14 INFO     Loading file CHITaxi20190406.dyna
2024-09-03 14:42:14 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-03 14:42:16 INFO     Dataset created
2024-09-03 14:42:16 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-09-03 14:42:16 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-09-03 14:42:16 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-09-03 14:42:16 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-09-03 14:42:16 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-03 14:42:17 INFO     NormalScaler max: 0.0028067830852947636
2024-09-03 14:42:19 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-03 14:42:19 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-03 14:42:19 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-09-03 14:42:19 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 14:42:19 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-09-03 14:42:19 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 14:42:19 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-03 14:42:19 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 14:42:19 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-03 14:42:19 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 14:42:19 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-03 14:42:19 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-03 14:42:19 INFO     Total parameter numbers: 904730
2024-09-03 14:42:19 INFO     You select `adam` optimizer.
2024-09-03 14:42:19 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-03 14:42:19 INFO     Start training ...
2024-09-03 14:42:19 INFO     num_batches:48
2024-09-03 14:42:24 INFO     epoch complete!
2024-09-03 14:42:24 INFO     evaluating now!
2024-09-03 14:42:24 INFO     Epoch [0/200] train_loss: 23.1651, val_loss: 17.2623, lr: 0.003000, 5.68s
2024-09-03 14:42:24 INFO     Saved model at 0
2024-09-03 14:42:24 INFO     Val loss decrease from inf to 17.2623, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-03 14:42:29 INFO     epoch complete!
2024-09-03 14:42:29 INFO     evaluating now!
2024-09-03 14:42:30 INFO     Epoch [1/200] train_loss: 14.0370, val_loss: 13.2658, lr: 0.003000, 5.34s
2024-09-03 14:42:30 INFO     Saved model at 1
2024-09-03 14:42:30 INFO     Val loss decrease from 17.2623 to 13.2658, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-03 14:42:35 INFO     epoch complete!
2024-09-03 14:42:35 INFO     evaluating now!
2024-09-03 14:42:35 INFO     Epoch [2/200] train_loss: 11.2855, val_loss: 10.3535, lr: 0.003000, 5.44s
2024-09-03 14:42:35 INFO     Saved model at 2
2024-09-03 14:42:35 INFO     Val loss decrease from 13.2658 to 10.3535, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-03 14:42:40 INFO     epoch complete!
2024-09-03 14:42:40 INFO     evaluating now!
2024-09-03 14:42:41 INFO     Epoch [3/200] train_loss: 8.8903, val_loss: 8.2815, lr: 0.003000, 5.34s
2024-09-03 14:42:41 INFO     Saved model at 3
2024-09-03 14:42:41 INFO     Val loss decrease from 10.3535 to 8.2815, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-03 14:42:46 INFO     epoch complete!
2024-09-03 14:42:46 INFO     evaluating now!
2024-09-03 14:42:46 INFO     Epoch [4/200] train_loss: 7.4733, val_loss: 7.2000, lr: 0.003000, 5.33s
2024-09-03 14:42:46 INFO     Saved model at 4
2024-09-03 14:42:46 INFO     Val loss decrease from 8.2815 to 7.2000, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-03 14:42:51 INFO     epoch complete!
2024-09-03 14:42:51 INFO     evaluating now!
2024-09-03 14:42:51 INFO     Epoch [5/200] train_loss: 6.7278, val_loss: 6.5188, lr: 0.003000, 5.40s
2024-09-03 14:42:51 INFO     Saved model at 5
2024-09-03 14:42:51 INFO     Val loss decrease from 7.2000 to 6.5188, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-03 14:42:56 INFO     epoch complete!
2024-09-03 14:42:56 INFO     evaluating now!
2024-09-03 14:42:57 INFO     Epoch [6/200] train_loss: 6.1788, val_loss: 6.3072, lr: 0.003000, 5.33s
2024-09-03 14:42:57 INFO     Saved model at 6
2024-09-03 14:42:57 INFO     Val loss decrease from 6.5188 to 6.3072, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-03 14:43:02 INFO     epoch complete!
2024-09-03 14:43:02 INFO     evaluating now!
2024-09-03 14:43:02 INFO     Epoch [7/200] train_loss: 5.7898, val_loss: 5.6620, lr: 0.003000, 5.32s
2024-09-03 14:43:02 INFO     Saved model at 7
2024-09-03 14:43:02 INFO     Val loss decrease from 6.3072 to 5.6620, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-03 14:43:07 INFO     epoch complete!
2024-09-03 14:43:07 INFO     evaluating now!
2024-09-03 14:43:07 INFO     Epoch [8/200] train_loss: 5.5613, val_loss: 5.6057, lr: 0.003000, 5.39s
2024-09-03 14:43:07 INFO     Saved model at 8
2024-09-03 14:43:07 INFO     Val loss decrease from 5.6620 to 5.6057, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-03 14:43:12 INFO     epoch complete!
2024-09-03 14:43:12 INFO     evaluating now!
2024-09-03 14:43:13 INFO     Epoch [9/200] train_loss: 5.3886, val_loss: 5.6550, lr: 0.003000, 5.32s
2024-09-03 14:43:18 INFO     epoch complete!
2024-09-03 14:43:18 INFO     evaluating now!
2024-09-03 14:43:18 INFO     Epoch [10/200] train_loss: 5.2273, val_loss: 5.5128, lr: 0.003000, 5.40s
2024-09-03 14:43:18 INFO     Saved model at 10
2024-09-03 14:43:18 INFO     Val loss decrease from 5.6057 to 5.5128, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-03 14:43:23 INFO     epoch complete!
2024-09-03 14:43:23 INFO     evaluating now!
2024-09-03 14:43:24 INFO     Epoch [11/200] train_loss: 5.0500, val_loss: 5.3821, lr: 0.003000, 5.34s
2024-09-03 14:43:24 INFO     Saved model at 11
2024-09-03 14:43:24 INFO     Val loss decrease from 5.5128 to 5.3821, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-03 14:43:29 INFO     epoch complete!
2024-09-03 14:43:29 INFO     evaluating now!
2024-09-03 14:43:29 INFO     Epoch [12/200] train_loss: 4.9086, val_loss: 5.0678, lr: 0.003000, 5.39s
2024-09-03 14:43:29 INFO     Saved model at 12
2024-09-03 14:43:29 INFO     Val loss decrease from 5.3821 to 5.0678, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-03 14:43:34 INFO     epoch complete!
2024-09-03 14:43:34 INFO     evaluating now!
2024-09-03 14:43:34 INFO     Epoch [13/200] train_loss: 4.8022, val_loss: 5.1744, lr: 0.003000, 5.40s
2024-09-03 14:43:39 INFO     epoch complete!
2024-09-03 14:43:39 INFO     evaluating now!
2024-09-03 14:43:40 INFO     Epoch [14/200] train_loss: 4.6760, val_loss: 5.2047, lr: 0.003000, 5.38s
2024-09-03 14:43:45 INFO     epoch complete!
2024-09-03 14:43:45 INFO     evaluating now!
2024-09-03 14:43:45 INFO     Epoch [15/200] train_loss: 4.6004, val_loss: 5.0054, lr: 0.003000, 5.35s
2024-09-03 14:43:45 INFO     Saved model at 15
2024-09-03 14:43:45 INFO     Val loss decrease from 5.0678 to 5.0054, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-03 14:43:50 INFO     epoch complete!
2024-09-03 14:43:50 INFO     evaluating now!
2024-09-03 14:43:51 INFO     Epoch [16/200] train_loss: 4.5227, val_loss: 4.8882, lr: 0.003000, 5.47s
2024-09-03 14:43:51 INFO     Saved model at 16
2024-09-03 14:43:51 INFO     Val loss decrease from 5.0054 to 4.8882, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-03 14:43:56 INFO     epoch complete!
2024-09-03 14:43:56 INFO     evaluating now!
2024-09-03 14:43:56 INFO     Epoch [17/200] train_loss: 4.4968, val_loss: 5.0724, lr: 0.003000, 5.36s
2024-09-03 14:44:01 INFO     epoch complete!
2024-09-03 14:44:01 INFO     evaluating now!
2024-09-03 14:44:01 INFO     Epoch [18/200] train_loss: 4.4226, val_loss: 4.9026, lr: 0.003000, 5.36s
2024-09-03 14:44:06 INFO     epoch complete!
2024-09-03 14:44:06 INFO     evaluating now!
2024-09-03 14:44:07 INFO     Epoch [19/200] train_loss: 4.3523, val_loss: 4.8894, lr: 0.003000, 5.45s
2024-09-03 14:44:12 INFO     epoch complete!
2024-09-03 14:44:12 INFO     evaluating now!
2024-09-03 14:44:12 INFO     Epoch [20/200] train_loss: 4.3383, val_loss: 4.8408, lr: 0.003000, 5.33s
2024-09-03 14:44:12 INFO     Saved model at 20
2024-09-03 14:44:12 INFO     Val loss decrease from 4.8882 to 4.8408, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-03 14:44:17 INFO     epoch complete!
2024-09-03 14:44:17 INFO     evaluating now!
2024-09-03 14:44:17 INFO     Epoch [21/200] train_loss: 4.2617, val_loss: 4.7851, lr: 0.003000, 5.32s
2024-09-03 14:44:17 INFO     Saved model at 21
2024-09-03 14:44:17 INFO     Val loss decrease from 4.8408 to 4.7851, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-03 14:44:22 INFO     epoch complete!
2024-09-03 14:44:22 INFO     evaluating now!
2024-09-03 14:44:23 INFO     Epoch [22/200] train_loss: 4.1736, val_loss: 4.8186, lr: 0.003000, 5.36s
2024-09-03 14:44:28 INFO     epoch complete!
2024-09-03 14:44:28 INFO     evaluating now!
2024-09-03 14:44:28 INFO     Epoch [23/200] train_loss: 4.1466, val_loss: 4.7336, lr: 0.003000, 5.34s
2024-09-03 14:44:28 INFO     Saved model at 23
2024-09-03 14:44:28 INFO     Val loss decrease from 4.7851 to 4.7336, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-03 14:44:33 INFO     epoch complete!
2024-09-03 14:44:33 INFO     evaluating now!
2024-09-03 14:44:34 INFO     Epoch [24/200] train_loss: 4.1502, val_loss: 4.7916, lr: 0.003000, 5.39s
2024-09-03 14:44:39 INFO     epoch complete!
2024-09-03 14:44:39 INFO     evaluating now!
2024-09-03 14:44:39 INFO     Epoch [25/200] train_loss: 4.0052, val_loss: 4.7766, lr: 0.003000, 5.34s
2024-09-03 14:44:44 INFO     epoch complete!
2024-09-03 14:44:44 INFO     evaluating now!
2024-09-03 14:44:44 INFO     Epoch [26/200] train_loss: 4.0138, val_loss: 4.8588, lr: 0.003000, 5.33s
2024-09-03 14:44:49 INFO     epoch complete!
2024-09-03 14:44:49 INFO     evaluating now!
2024-09-03 14:44:50 INFO     Epoch [27/200] train_loss: 3.9741, val_loss: 4.7080, lr: 0.003000, 5.40s
2024-09-03 14:44:50 INFO     Saved model at 27
2024-09-03 14:44:50 INFO     Val loss decrease from 4.7336 to 4.7080, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-03 14:44:55 INFO     epoch complete!
2024-09-03 14:44:55 INFO     evaluating now!
2024-09-03 14:44:55 INFO     Epoch [28/200] train_loss: 3.9628, val_loss: 4.6786, lr: 0.003000, 5.34s
2024-09-03 14:44:55 INFO     Saved model at 28
2024-09-03 14:44:55 INFO     Val loss decrease from 4.7080 to 4.6786, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-03 14:45:00 INFO     epoch complete!
2024-09-03 14:45:00 INFO     evaluating now!
2024-09-03 14:45:00 INFO     Epoch [29/200] train_loss: 3.9095, val_loss: 4.7637, lr: 0.003000, 5.33s
2024-09-03 14:45:05 INFO     epoch complete!
2024-09-03 14:45:05 INFO     evaluating now!
2024-09-03 14:45:06 INFO     Epoch [30/200] train_loss: 3.8670, val_loss: 4.9667, lr: 0.003000, 5.40s
2024-09-03 14:45:11 INFO     epoch complete!
2024-09-03 14:45:11 INFO     evaluating now!
2024-09-03 14:45:11 INFO     Epoch [31/200] train_loss: 3.8981, val_loss: 4.7970, lr: 0.003000, 5.34s
2024-09-03 14:45:16 INFO     epoch complete!
2024-09-03 14:45:16 INFO     evaluating now!
2024-09-03 14:45:16 INFO     Epoch [32/200] train_loss: 3.8457, val_loss: 4.8030, lr: 0.003000, 5.33s
2024-09-03 14:45:21 INFO     epoch complete!
2024-09-03 14:45:21 INFO     evaluating now!
2024-09-03 14:45:22 INFO     Epoch [33/200] train_loss: 3.7999, val_loss: 4.6607, lr: 0.003000, 5.38s
2024-09-03 14:45:22 INFO     Saved model at 33
2024-09-03 14:45:22 INFO     Val loss decrease from 4.6786 to 4.6607, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-09-03 14:45:27 INFO     epoch complete!
2024-09-03 14:45:27 INFO     evaluating now!
2024-09-03 14:45:27 INFO     Epoch [34/200] train_loss: 3.7290, val_loss: 4.6899, lr: 0.003000, 5.36s
2024-09-03 14:45:32 INFO     epoch complete!
2024-09-03 14:45:32 INFO     evaluating now!
2024-09-03 14:45:32 INFO     Epoch [35/200] train_loss: 3.6830, val_loss: 4.7063, lr: 0.003000, 5.34s
2024-09-03 14:45:38 INFO     epoch complete!
2024-09-03 14:45:38 INFO     evaluating now!
2024-09-03 14:45:38 INFO     Epoch [36/200] train_loss: 3.7343, val_loss: 4.7700, lr: 0.003000, 5.38s
2024-09-03 14:45:43 INFO     epoch complete!
2024-09-03 14:45:43 INFO     evaluating now!
2024-09-03 14:45:43 INFO     Epoch [37/200] train_loss: 3.6843, val_loss: 4.6523, lr: 0.003000, 5.34s
2024-09-03 14:45:43 INFO     Saved model at 37
2024-09-03 14:45:43 INFO     Val loss decrease from 4.6607 to 4.6523, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-09-03 14:45:48 INFO     epoch complete!
2024-09-03 14:45:48 INFO     evaluating now!
2024-09-03 14:45:49 INFO     Epoch [38/200] train_loss: 3.7391, val_loss: 4.7408, lr: 0.003000, 5.38s
2024-09-03 14:45:54 INFO     epoch complete!
2024-09-03 14:45:54 INFO     evaluating now!
2024-09-03 14:45:54 INFO     Epoch [39/200] train_loss: 3.6542, val_loss: 4.6512, lr: 0.003000, 5.34s
2024-09-03 14:45:54 INFO     Saved model at 39
2024-09-03 14:45:54 INFO     Val loss decrease from 4.6523 to 4.6512, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-09-03 14:45:59 INFO     epoch complete!
2024-09-03 14:45:59 INFO     evaluating now!
2024-09-03 14:45:59 INFO     Epoch [40/200] train_loss: 3.6274, val_loss: 4.6035, lr: 0.003000, 5.34s
2024-09-03 14:45:59 INFO     Saved model at 40
2024-09-03 14:45:59 INFO     Val loss decrease from 4.6512 to 4.6035, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-09-03 14:46:04 INFO     epoch complete!
2024-09-03 14:46:04 INFO     evaluating now!
2024-09-03 14:46:05 INFO     Epoch [41/200] train_loss: 3.5704, val_loss: 4.7558, lr: 0.003000, 5.40s
2024-09-03 14:46:10 INFO     epoch complete!
2024-09-03 14:46:10 INFO     evaluating now!
2024-09-03 14:46:10 INFO     Epoch [42/200] train_loss: 3.5735, val_loss: 4.6826, lr: 0.003000, 5.33s
2024-09-03 14:46:15 INFO     epoch complete!
2024-09-03 14:46:15 INFO     evaluating now!
2024-09-03 14:46:15 INFO     Epoch [43/200] train_loss: 3.5675, val_loss: 4.7327, lr: 0.003000, 5.34s
2024-09-03 14:46:20 INFO     epoch complete!
2024-09-03 14:46:20 INFO     evaluating now!
2024-09-03 14:46:21 INFO     Epoch [44/200] train_loss: 3.5564, val_loss: 4.6407, lr: 0.003000, 5.38s
2024-09-03 14:46:26 INFO     epoch complete!
2024-09-03 14:46:26 INFO     evaluating now!
2024-09-03 14:46:26 INFO     Epoch [45/200] train_loss: 3.5526, val_loss: 4.6601, lr: 0.003000, 5.34s
2024-09-03 14:46:31 INFO     epoch complete!
2024-09-03 14:46:31 INFO     evaluating now!
2024-09-03 14:46:31 INFO     Epoch [46/200] train_loss: 3.5257, val_loss: 4.6012, lr: 0.003000, 5.36s
2024-09-03 14:46:31 INFO     Saved model at 46
2024-09-03 14:46:31 INFO     Val loss decrease from 4.6035 to 4.6012, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-09-03 14:46:37 INFO     epoch complete!
2024-09-03 14:46:37 INFO     evaluating now!
2024-09-03 14:46:37 INFO     Epoch [47/200] train_loss: 3.4960, val_loss: 4.7075, lr: 0.003000, 5.39s
2024-09-03 14:46:42 INFO     epoch complete!
2024-09-03 14:46:42 INFO     evaluating now!
2024-09-03 14:46:42 INFO     Epoch [48/200] train_loss: 3.5019, val_loss: 4.6905, lr: 0.003000, 5.34s
2024-09-03 14:46:47 INFO     epoch complete!
2024-09-03 14:46:47 INFO     evaluating now!
2024-09-03 14:46:48 INFO     Epoch [49/200] train_loss: 3.4661, val_loss: 4.6928, lr: 0.003000, 5.33s
2024-09-03 14:46:53 INFO     epoch complete!
2024-09-03 14:46:53 INFO     evaluating now!
2024-09-03 14:46:53 INFO     Epoch [50/200] train_loss: 3.4219, val_loss: 4.7419, lr: 0.003000, 5.41s
2024-09-03 14:46:58 INFO     epoch complete!
2024-09-03 14:46:58 INFO     evaluating now!
2024-09-03 14:46:58 INFO     Epoch [51/200] train_loss: 3.4325, val_loss: 4.7405, lr: 0.003000, 5.34s
2024-09-03 14:47:03 INFO     epoch complete!
2024-09-03 14:47:03 INFO     evaluating now!
2024-09-03 14:47:04 INFO     Epoch [52/200] train_loss: 3.4200, val_loss: 4.6226, lr: 0.003000, 5.38s
2024-09-03 14:47:09 INFO     epoch complete!
2024-09-03 14:47:09 INFO     evaluating now!
2024-09-03 14:47:09 INFO     Epoch [53/200] train_loss: 3.4303, val_loss: 4.6213, lr: 0.003000, 5.34s
2024-09-03 14:47:14 INFO     epoch complete!
2024-09-03 14:47:14 INFO     evaluating now!
2024-09-03 14:47:14 INFO     Epoch [54/200] train_loss: 3.3816, val_loss: 4.6258, lr: 0.003000, 5.35s
2024-09-03 14:47:19 INFO     epoch complete!
2024-09-03 14:47:19 INFO     evaluating now!
2024-09-03 14:47:20 INFO     Epoch [55/200] train_loss: 3.3998, val_loss: 4.6870, lr: 0.003000, 5.41s
2024-09-03 14:47:25 INFO     epoch complete!
2024-09-03 14:47:25 INFO     evaluating now!
2024-09-03 14:47:25 INFO     Epoch [56/200] train_loss: 3.3962, val_loss: 4.6035, lr: 0.003000, 5.36s
2024-09-03 14:47:30 INFO     epoch complete!
2024-09-03 14:47:30 INFO     evaluating now!
2024-09-03 14:47:30 INFO     Epoch [57/200] train_loss: 3.3543, val_loss: 4.7247, lr: 0.003000, 5.35s
2024-09-03 14:47:36 INFO     epoch complete!
2024-09-03 14:47:36 INFO     evaluating now!
2024-09-03 14:47:36 INFO     Epoch [58/200] train_loss: 3.4153, val_loss: 4.6836, lr: 0.003000, 5.40s
2024-09-03 14:47:41 INFO     epoch complete!
2024-09-03 14:47:41 INFO     evaluating now!
2024-09-03 14:47:41 INFO     Epoch [59/200] train_loss: 3.3337, val_loss: 4.6988, lr: 0.003000, 5.34s
2024-09-03 14:47:46 INFO     epoch complete!
2024-09-03 14:47:46 INFO     evaluating now!
2024-09-03 14:47:47 INFO     Epoch [60/200] train_loss: 3.3183, val_loss: 4.6880, lr: 0.003000, 5.35s
2024-09-03 14:47:52 INFO     epoch complete!
2024-09-03 14:47:52 INFO     evaluating now!
2024-09-03 14:47:52 INFO     Epoch [61/200] train_loss: 3.3082, val_loss: 4.6414, lr: 0.003000, 5.39s
2024-09-03 14:47:52 WARNING  Early stopping at epoch: 61
2024-09-03 14:47:52 INFO     Trained totally 62 epochs, average train time is 5.035s, average eval time is 0.333s
2024-09-03 14:47:52 INFO     Loaded model at 46
2024-09-03 14:47:52 INFO     Saved model at ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406.m
2024-09-03 14:47:52 INFO     Start evaluating ...
2024-09-03 14:47:53 INFO     Note that you select the single mode to evaluate!
2024-09-03 14:47:53 INFO     Evaluate result is saved at ./libcity/cache/160/evaluate_cache\2024_09_03_14_47_53_AGCRN_CHITaxi20190406.csv
2024-09-03 14:47:53 INFO     
         MAE       RMSE
1   2.346311   7.627937
2   2.346851   8.023705
3   2.535594   8.821103
4   2.599100   9.211143
5   2.640701   9.480934
6   2.670068   9.613939
7   2.643174   9.614683
8   2.683812   9.651402
9   2.694795   9.766059
10  2.709440   9.830655
11  2.761663  10.007054
12  2.808098  10.289131
2024-09-03 14:47:53 INFO     ----------------------------------------------------------------------------
2024-09-03 14:47:53 INFO     # 3, Kownledge Graph Embedding: RandomE, Experiment ids: 163
2024-09-03 14:47:53 INFO     ----------------------------------------------------------------------------
2024-09-03 14:47:53 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=160
2024-09-03 14:47:53 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 160, 'embedding_model': 'RandomE', 'add_time_in_day': True, 'add_day_in_week': True, 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-03 14:47:53 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-03 14:47:53 INFO     set_weight_link_or_dist: dist
2024-09-03 14:47:53 INFO     init_weight_inf_or_zero: inf
2024-09-03 14:47:53 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-03 14:47:53 INFO     Start Calculate the weight by Gauss kernel!
2024-09-03 14:47:53 INFO     Loading file CHITaxi20190406.dyna
2024-09-03 14:47:53 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-03 14:47:55 INFO     Dataset created
2024-09-03 14:47:55 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-09-03 14:47:55 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-09-03 14:47:55 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-09-03 14:47:55 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-09-03 14:47:55 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-03 14:47:56 INFO     NormalScaler max: 0.0028067830852947636
2024-09-03 14:47:58 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-03 14:47:58 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-03 14:47:58 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-09-03 14:47:58 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 14:47:58 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-09-03 14:47:58 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 14:47:58 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-03 14:47:58 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 14:47:58 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-03 14:47:58 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 14:47:58 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-03 14:47:58 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-03 14:47:58 INFO     Total parameter numbers: 904730
2024-09-03 14:47:58 INFO     You select `adam` optimizer.
2024-09-03 14:47:58 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-03 14:47:58 INFO     Start training ...
2024-09-03 14:47:58 INFO     num_batches:48
2024-09-03 14:48:03 INFO     epoch complete!
2024-09-03 14:48:03 INFO     evaluating now!
2024-09-03 14:48:03 INFO     Epoch [0/200] train_loss: 24.7547, val_loss: 18.2101, lr: 0.003000, 5.53s
2024-09-03 14:48:03 INFO     Saved model at 0
2024-09-03 14:48:03 INFO     Val loss decrease from inf to 18.2101, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-03 14:48:08 INFO     epoch complete!
2024-09-03 14:48:08 INFO     evaluating now!
2024-09-03 14:48:09 INFO     Epoch [1/200] train_loss: 14.5897, val_loss: 13.7822, lr: 0.003000, 5.42s
2024-09-03 14:48:09 INFO     Saved model at 1
2024-09-03 14:48:09 INFO     Val loss decrease from 18.2101 to 13.7822, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-03 14:48:14 INFO     epoch complete!
2024-09-03 14:48:14 INFO     evaluating now!
2024-09-03 14:48:14 INFO     Epoch [2/200] train_loss: 11.0544, val_loss: 10.5532, lr: 0.003000, 5.35s
2024-09-03 14:48:14 INFO     Saved model at 2
2024-09-03 14:48:14 INFO     Val loss decrease from 13.7822 to 10.5532, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-03 14:48:19 INFO     epoch complete!
2024-09-03 14:48:19 INFO     evaluating now!
2024-09-03 14:48:19 INFO     Epoch [3/200] train_loss: 8.9613, val_loss: 8.4772, lr: 0.003000, 5.37s
2024-09-03 14:48:19 INFO     Saved model at 3
2024-09-03 14:48:19 INFO     Val loss decrease from 10.5532 to 8.4772, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-03 14:48:24 INFO     epoch complete!
2024-09-03 14:48:24 INFO     evaluating now!
2024-09-03 14:48:25 INFO     Epoch [4/200] train_loss: 7.5020, val_loss: 7.3995, lr: 0.003000, 5.34s
2024-09-03 14:48:25 INFO     Saved model at 4
2024-09-03 14:48:25 INFO     Val loss decrease from 8.4772 to 7.3995, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-03 14:48:30 INFO     epoch complete!
2024-09-03 14:48:30 INFO     evaluating now!
2024-09-03 14:48:30 INFO     Epoch [5/200] train_loss: 6.9068, val_loss: 6.6642, lr: 0.003000, 5.34s
2024-09-03 14:48:30 INFO     Saved model at 5
2024-09-03 14:48:30 INFO     Val loss decrease from 7.3995 to 6.6642, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-03 14:48:35 INFO     epoch complete!
2024-09-03 14:48:35 INFO     evaluating now!
2024-09-03 14:48:35 INFO     Epoch [6/200] train_loss: 6.3345, val_loss: 6.2170, lr: 0.003000, 5.37s
2024-09-03 14:48:35 INFO     Saved model at 6
2024-09-03 14:48:35 INFO     Val loss decrease from 6.6642 to 6.2170, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-03 14:48:40 INFO     epoch complete!
2024-09-03 14:48:40 INFO     evaluating now!
2024-09-03 14:48:41 INFO     Epoch [7/200] train_loss: 5.9541, val_loss: 5.9268, lr: 0.003000, 5.35s
2024-09-03 14:48:41 INFO     Saved model at 7
2024-09-03 14:48:41 INFO     Val loss decrease from 6.2170 to 5.9268, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-03 14:48:46 INFO     epoch complete!
2024-09-03 14:48:46 INFO     evaluating now!
2024-09-03 14:48:46 INFO     Epoch [8/200] train_loss: 5.6791, val_loss: 5.7742, lr: 0.003000, 5.35s
2024-09-03 14:48:46 INFO     Saved model at 8
2024-09-03 14:48:46 INFO     Val loss decrease from 5.9268 to 5.7742, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-03 14:48:51 INFO     epoch complete!
2024-09-03 14:48:51 INFO     evaluating now!
2024-09-03 14:48:52 INFO     Epoch [9/200] train_loss: 5.4750, val_loss: 5.5535, lr: 0.003000, 5.40s
2024-09-03 14:48:52 INFO     Saved model at 9
2024-09-03 14:48:52 INFO     Val loss decrease from 5.7742 to 5.5535, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-03 14:48:57 INFO     epoch complete!
2024-09-03 14:48:57 INFO     evaluating now!
2024-09-03 14:48:57 INFO     Epoch [10/200] train_loss: 5.3728, val_loss: 5.3882, lr: 0.003000, 5.34s
2024-09-03 14:48:57 INFO     Saved model at 10
2024-09-03 14:48:57 INFO     Val loss decrease from 5.5535 to 5.3882, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-03 14:49:02 INFO     epoch complete!
2024-09-03 14:49:02 INFO     evaluating now!
2024-09-03 14:49:02 INFO     Epoch [11/200] train_loss: 5.1480, val_loss: 5.3750, lr: 0.003000, 5.42s
2024-09-03 14:49:02 INFO     Saved model at 11
2024-09-03 14:49:02 INFO     Val loss decrease from 5.3882 to 5.3750, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-03 14:49:07 INFO     epoch complete!
2024-09-03 14:49:07 INFO     evaluating now!
2024-09-03 14:49:08 INFO     Epoch [12/200] train_loss: 5.0726, val_loss: 5.1948, lr: 0.003000, 5.41s
2024-09-03 14:49:08 INFO     Saved model at 12
2024-09-03 14:49:08 INFO     Val loss decrease from 5.3750 to 5.1948, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-03 14:49:13 INFO     epoch complete!
2024-09-03 14:49:13 INFO     evaluating now!
2024-09-03 14:49:13 INFO     Epoch [13/200] train_loss: 4.9308, val_loss: 5.2326, lr: 0.003000, 5.32s
2024-09-03 14:49:18 INFO     epoch complete!
2024-09-03 14:49:18 INFO     evaluating now!
2024-09-03 14:49:18 INFO     Epoch [14/200] train_loss: 4.8597, val_loss: 5.3331, lr: 0.003000, 5.34s
2024-09-03 14:49:23 INFO     epoch complete!
2024-09-03 14:49:23 INFO     evaluating now!
2024-09-03 14:49:24 INFO     Epoch [15/200] train_loss: 4.8111, val_loss: 5.0938, lr: 0.003000, 5.37s
2024-09-03 14:49:24 INFO     Saved model at 15
2024-09-03 14:49:24 INFO     Val loss decrease from 5.1948 to 5.0938, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-03 14:49:29 INFO     epoch complete!
2024-09-03 14:49:29 INFO     evaluating now!
2024-09-03 14:49:29 INFO     Epoch [16/200] train_loss: 4.6765, val_loss: 5.1803, lr: 0.003000, 5.52s
2024-09-03 14:49:34 INFO     epoch complete!
2024-09-03 14:49:34 INFO     evaluating now!
2024-09-03 14:49:35 INFO     Epoch [17/200] train_loss: 4.6135, val_loss: 4.9471, lr: 0.003000, 5.41s
2024-09-03 14:49:35 INFO     Saved model at 17
2024-09-03 14:49:35 INFO     Val loss decrease from 5.0938 to 4.9471, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-03 14:49:40 INFO     epoch complete!
2024-09-03 14:49:40 INFO     evaluating now!
2024-09-03 14:49:40 INFO     Epoch [18/200] train_loss: 4.5524, val_loss: 4.9067, lr: 0.003000, 5.35s
2024-09-03 14:49:40 INFO     Saved model at 18
2024-09-03 14:49:40 INFO     Val loss decrease from 4.9471 to 4.9067, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-03 14:49:45 INFO     epoch complete!
2024-09-03 14:49:45 INFO     evaluating now!
2024-09-03 14:49:45 INFO     Epoch [19/200] train_loss: 4.5228, val_loss: 4.9284, lr: 0.003000, 5.35s
2024-09-03 14:49:51 INFO     epoch complete!
2024-09-03 14:49:51 INFO     evaluating now!
2024-09-03 14:49:51 INFO     Epoch [20/200] train_loss: 4.4263, val_loss: 4.7532, lr: 0.003000, 5.41s
2024-09-03 14:49:51 INFO     Saved model at 20
2024-09-03 14:49:51 INFO     Val loss decrease from 4.9067 to 4.7532, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-03 14:49:56 INFO     epoch complete!
2024-09-03 14:49:56 INFO     evaluating now!
2024-09-03 14:49:56 INFO     Epoch [21/200] train_loss: 4.3325, val_loss: 4.7786, lr: 0.003000, 5.37s
2024-09-03 14:50:01 INFO     epoch complete!
2024-09-03 14:50:01 INFO     evaluating now!
2024-09-03 14:50:02 INFO     Epoch [22/200] train_loss: 4.2761, val_loss: 4.8514, lr: 0.003000, 5.38s
2024-09-03 14:50:07 INFO     epoch complete!
2024-09-03 14:50:07 INFO     evaluating now!
2024-09-03 14:50:07 INFO     Epoch [23/200] train_loss: 4.2742, val_loss: 4.9093, lr: 0.003000, 5.42s
2024-09-03 14:50:12 INFO     epoch complete!
2024-09-03 14:50:12 INFO     evaluating now!
2024-09-03 14:50:12 INFO     Epoch [24/200] train_loss: 4.2247, val_loss: 4.8689, lr: 0.003000, 5.36s
2024-09-03 14:50:17 INFO     epoch complete!
2024-09-03 14:50:17 INFO     evaluating now!
2024-09-03 14:50:18 INFO     Epoch [25/200] train_loss: 4.1620, val_loss: 4.6798, lr: 0.003000, 5.39s
2024-09-03 14:50:18 INFO     Saved model at 25
2024-09-03 14:50:18 INFO     Val loss decrease from 4.7532 to 4.6798, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-03 14:50:23 INFO     epoch complete!
2024-09-03 14:50:23 INFO     evaluating now!
2024-09-03 14:50:23 INFO     Epoch [26/200] train_loss: 4.1737, val_loss: 4.8095, lr: 0.003000, 5.45s
2024-09-03 14:50:28 INFO     epoch complete!
2024-09-03 14:50:28 INFO     evaluating now!
2024-09-03 14:50:29 INFO     Epoch [27/200] train_loss: 4.0961, val_loss: 4.8667, lr: 0.003000, 5.34s
2024-09-03 14:50:34 INFO     epoch complete!
2024-09-03 14:50:34 INFO     evaluating now!
2024-09-03 14:50:34 INFO     Epoch [28/200] train_loss: 4.0947, val_loss: 4.6889, lr: 0.003000, 5.46s
2024-09-03 14:50:39 INFO     epoch complete!
2024-09-03 14:50:39 INFO     evaluating now!
2024-09-03 14:50:39 INFO     Epoch [29/200] train_loss: 4.0407, val_loss: 4.7493, lr: 0.003000, 5.40s
2024-09-03 14:50:45 INFO     epoch complete!
2024-09-03 14:50:45 INFO     evaluating now!
2024-09-03 14:50:45 INFO     Epoch [30/200] train_loss: 4.0774, val_loss: 4.7141, lr: 0.003000, 5.37s
2024-09-03 14:50:50 INFO     epoch complete!
2024-09-03 14:50:50 INFO     evaluating now!
2024-09-03 14:50:50 INFO     Epoch [31/200] train_loss: 3.9655, val_loss: 4.6687, lr: 0.003000, 5.44s
2024-09-03 14:50:50 INFO     Saved model at 31
2024-09-03 14:50:50 INFO     Val loss decrease from 4.6798 to 4.6687, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-09-03 14:50:55 INFO     epoch complete!
2024-09-03 14:50:55 INFO     evaluating now!
2024-09-03 14:50:56 INFO     Epoch [32/200] train_loss: 3.9420, val_loss: 4.6934, lr: 0.003000, 5.38s
2024-09-03 14:51:01 INFO     epoch complete!
2024-09-03 14:51:01 INFO     evaluating now!
2024-09-03 14:51:01 INFO     Epoch [33/200] train_loss: 3.8630, val_loss: 4.6900, lr: 0.003000, 5.38s
2024-09-03 14:51:06 INFO     epoch complete!
2024-09-03 14:51:06 INFO     evaluating now!
2024-09-03 14:51:06 INFO     Epoch [34/200] train_loss: 3.8588, val_loss: 4.8065, lr: 0.003000, 5.38s
2024-09-03 14:51:11 INFO     epoch complete!
2024-09-03 14:51:11 INFO     evaluating now!
2024-09-03 14:51:12 INFO     Epoch [35/200] train_loss: 3.8263, val_loss: 4.6652, lr: 0.003000, 5.33s
2024-09-03 14:51:12 INFO     Saved model at 35
2024-09-03 14:51:12 INFO     Val loss decrease from 4.6687 to 4.6652, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-03 14:51:17 INFO     epoch complete!
2024-09-03 14:51:17 INFO     evaluating now!
2024-09-03 14:51:17 INFO     Epoch [36/200] train_loss: 3.8626, val_loss: 4.6600, lr: 0.003000, 5.37s
2024-09-03 14:51:17 INFO     Saved model at 36
2024-09-03 14:51:17 INFO     Val loss decrease from 4.6652 to 4.6600, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-09-03 14:51:22 INFO     epoch complete!
2024-09-03 14:51:22 INFO     evaluating now!
2024-09-03 14:51:23 INFO     Epoch [37/200] train_loss: 3.7920, val_loss: 4.7450, lr: 0.003000, 5.49s
2024-09-03 14:51:28 INFO     epoch complete!
2024-09-03 14:51:28 INFO     evaluating now!
2024-09-03 14:51:28 INFO     Epoch [38/200] train_loss: 3.8075, val_loss: 4.6256, lr: 0.003000, 5.41s
2024-09-03 14:51:28 INFO     Saved model at 38
2024-09-03 14:51:28 INFO     Val loss decrease from 4.6600 to 4.6256, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-09-03 14:51:33 INFO     epoch complete!
2024-09-03 14:51:33 INFO     evaluating now!
2024-09-03 14:51:34 INFO     Epoch [39/200] train_loss: 3.6938, val_loss: 4.7993, lr: 0.003000, 5.41s
2024-09-03 14:51:39 INFO     epoch complete!
2024-09-03 14:51:39 INFO     evaluating now!
2024-09-03 14:51:39 INFO     Epoch [40/200] train_loss: 3.6855, val_loss: 4.6253, lr: 0.003000, 5.43s
2024-09-03 14:51:39 INFO     Saved model at 40
2024-09-03 14:51:39 INFO     Val loss decrease from 4.6256 to 4.6253, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-09-03 14:51:44 INFO     epoch complete!
2024-09-03 14:51:44 INFO     evaluating now!
2024-09-03 14:51:44 INFO     Epoch [41/200] train_loss: 3.7065, val_loss: 4.7760, lr: 0.003000, 5.36s
2024-09-03 14:51:49 INFO     epoch complete!
2024-09-03 14:51:49 INFO     evaluating now!
2024-09-03 14:51:50 INFO     Epoch [42/200] train_loss: 3.6825, val_loss: 4.6528, lr: 0.003000, 5.46s
2024-09-03 14:51:55 INFO     epoch complete!
2024-09-03 14:51:55 INFO     evaluating now!
2024-09-03 14:51:55 INFO     Epoch [43/200] train_loss: 3.6637, val_loss: 4.6854, lr: 0.003000, 5.38s
2024-09-03 14:52:00 INFO     epoch complete!
2024-09-03 14:52:00 INFO     evaluating now!
2024-09-03 14:52:01 INFO     Epoch [44/200] train_loss: 3.7058, val_loss: 4.6537, lr: 0.003000, 5.37s
2024-09-03 14:52:06 INFO     epoch complete!
2024-09-03 14:52:06 INFO     evaluating now!
2024-09-03 14:52:06 INFO     Epoch [45/200] train_loss: 3.6228, val_loss: 4.7400, lr: 0.003000, 5.46s
2024-09-03 14:52:11 INFO     epoch complete!
2024-09-03 14:52:11 INFO     evaluating now!
2024-09-03 14:52:11 INFO     Epoch [46/200] train_loss: 3.5754, val_loss: 4.7309, lr: 0.003000, 5.46s
2024-09-03 14:52:16 INFO     epoch complete!
2024-09-03 14:52:16 INFO     evaluating now!
2024-09-03 14:52:17 INFO     Epoch [47/200] train_loss: 3.5718, val_loss: 4.7634, lr: 0.003000, 5.39s
2024-09-03 14:52:22 INFO     epoch complete!
2024-09-03 14:52:22 INFO     evaluating now!
2024-09-03 14:52:22 INFO     Epoch [48/200] train_loss: 3.5231, val_loss: 4.7055, lr: 0.003000, 5.41s
2024-09-03 14:52:27 INFO     epoch complete!
2024-09-03 14:52:27 INFO     evaluating now!
2024-09-03 14:52:28 INFO     Epoch [49/200] train_loss: 3.4777, val_loss: 4.6568, lr: 0.003000, 5.38s
2024-09-03 14:52:33 INFO     epoch complete!
2024-09-03 14:52:33 INFO     evaluating now!
2024-09-03 14:52:33 INFO     Epoch [50/200] train_loss: 3.5266, val_loss: 4.7598, lr: 0.003000, 5.38s
2024-09-03 14:52:38 INFO     epoch complete!
2024-09-03 14:52:38 INFO     evaluating now!
2024-09-03 14:52:38 INFO     Epoch [51/200] train_loss: 3.5168, val_loss: 4.6150, lr: 0.003000, 5.45s
2024-09-03 14:52:38 INFO     Saved model at 51
2024-09-03 14:52:38 INFO     Val loss decrease from 4.6253 to 4.6150, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-09-03 14:52:44 INFO     epoch complete!
2024-09-03 14:52:44 INFO     evaluating now!
2024-09-03 14:52:44 INFO     Epoch [52/200] train_loss: 3.4554, val_loss: 4.7373, lr: 0.003000, 5.40s
2024-09-03 14:52:49 INFO     epoch complete!
2024-09-03 14:52:49 INFO     evaluating now!
2024-09-03 14:52:49 INFO     Epoch [53/200] train_loss: 3.4275, val_loss: 4.6301, lr: 0.003000, 5.49s
2024-09-03 14:52:54 INFO     epoch complete!
2024-09-03 14:52:54 INFO     evaluating now!
2024-09-03 14:52:55 INFO     Epoch [54/200] train_loss: 3.4551, val_loss: 4.6949, lr: 0.003000, 5.39s
2024-09-03 14:53:00 INFO     epoch complete!
2024-09-03 14:53:00 INFO     evaluating now!
2024-09-03 14:53:00 INFO     Epoch [55/200] train_loss: 3.4238, val_loss: 4.7189, lr: 0.003000, 5.41s
2024-09-03 14:53:05 INFO     epoch complete!
2024-09-03 14:53:05 INFO     evaluating now!
2024-09-03 14:53:06 INFO     Epoch [56/200] train_loss: 3.4548, val_loss: 4.7561, lr: 0.003000, 5.44s
2024-09-03 14:53:11 INFO     epoch complete!
2024-09-03 14:53:11 INFO     evaluating now!
2024-09-03 14:53:11 INFO     Epoch [57/200] train_loss: 3.3968, val_loss: 4.6906, lr: 0.003000, 5.38s
2024-09-03 14:53:16 INFO     epoch complete!
2024-09-03 14:53:16 INFO     evaluating now!
2024-09-03 14:53:16 INFO     Epoch [58/200] train_loss: 3.3916, val_loss: 4.6806, lr: 0.003000, 5.37s
2024-09-03 14:53:21 INFO     epoch complete!
2024-09-03 14:53:21 INFO     evaluating now!
2024-09-03 14:53:22 INFO     Epoch [59/200] train_loss: 3.3742, val_loss: 4.6379, lr: 0.003000, 5.40s
2024-09-03 14:53:27 INFO     epoch complete!
2024-09-03 14:53:27 INFO     evaluating now!
2024-09-03 14:53:27 INFO     Epoch [60/200] train_loss: 3.3525, val_loss: 4.6437, lr: 0.003000, 5.42s
2024-09-03 14:53:32 INFO     epoch complete!
2024-09-03 14:53:32 INFO     evaluating now!
2024-09-03 14:53:33 INFO     Epoch [61/200] train_loss: 3.3487, val_loss: 4.6156, lr: 0.003000, 5.39s
2024-09-03 14:53:38 INFO     epoch complete!
2024-09-03 14:53:38 INFO     evaluating now!
2024-09-03 14:53:38 INFO     Epoch [62/200] train_loss: 3.3164, val_loss: 4.6699, lr: 0.003000, 5.44s
2024-09-03 14:53:43 INFO     epoch complete!
2024-09-03 14:53:43 INFO     evaluating now!
2024-09-03 14:53:43 INFO     Epoch [63/200] train_loss: 3.2878, val_loss: 4.6776, lr: 0.003000, 5.40s
2024-09-03 14:53:48 INFO     epoch complete!
2024-09-03 14:53:48 INFO     evaluating now!
2024-09-03 14:53:49 INFO     Epoch [64/200] train_loss: 3.3056, val_loss: 4.7573, lr: 0.003000, 5.40s
2024-09-03 14:53:54 INFO     epoch complete!
2024-09-03 14:53:54 INFO     evaluating now!
2024-09-03 14:53:54 INFO     Epoch [65/200] train_loss: 3.2643, val_loss: 4.7700, lr: 0.003000, 5.42s
2024-09-03 14:53:59 INFO     epoch complete!
2024-09-03 14:53:59 INFO     evaluating now!
2024-09-03 14:54:00 INFO     Epoch [66/200] train_loss: 3.2581, val_loss: 4.7028, lr: 0.003000, 5.37s
2024-09-03 14:54:00 WARNING  Early stopping at epoch: 66
2024-09-03 14:54:00 INFO     Trained totally 67 epochs, average train time is 5.063s, average eval time is 0.334s
2024-09-03 14:54:00 INFO     Loaded model at 51
2024-09-03 14:54:00 INFO     Saved model at ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406.m
2024-09-03 14:54:00 INFO     Start evaluating ...
2024-09-03 14:54:01 INFO     Note that you select the single mode to evaluate!
2024-09-03 14:54:01 INFO     Evaluate result is saved at ./libcity/cache/160/evaluate_cache\2024_09_03_14_54_01_AGCRN_CHITaxi20190406.csv
2024-09-03 14:54:01 INFO     
         MAE       RMSE
1   2.203016   6.784322
2   2.233307   7.156520
3   2.328129   7.912576
4   2.454700   8.340500
5   2.549579   8.647666
6   2.655125   8.926264
7   2.634556   9.220085
8   2.656726   9.433430
9   2.673409   9.565637
10  2.725182   9.729012
11  2.756458   9.931950
12  2.845563  10.212875
2024-09-03 14:54:01 INFO     ----------------------------------------------------------------------------
2024-09-03 14:54:01 INFO     # 4, Kownledge Graph Embedding: RandomE, Experiment ids: 164
2024-09-03 14:54:01 INFO     ----------------------------------------------------------------------------
2024-09-03 14:54:01 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=160
2024-09-03 14:54:01 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 160, 'embedding_model': 'RandomE', 'add_time_in_day': True, 'add_day_in_week': True, 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-03 14:54:01 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-03 14:54:01 INFO     set_weight_link_or_dist: dist
2024-09-03 14:54:01 INFO     init_weight_inf_or_zero: inf
2024-09-03 14:54:01 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-03 14:54:01 INFO     Start Calculate the weight by Gauss kernel!
2024-09-03 14:54:01 INFO     Loading file CHITaxi20190406.dyna
2024-09-03 14:54:01 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-03 14:54:03 INFO     Dataset created
2024-09-03 14:54:03 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-09-03 14:54:03 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-09-03 14:54:03 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-09-03 14:54:03 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-09-03 14:54:03 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-03 14:54:03 INFO     NormalScaler max: 0.0028067830852947636
2024-09-03 14:54:05 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-03 14:54:05 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-03 14:54:05 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-09-03 14:54:05 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 14:54:05 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-09-03 14:54:05 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 14:54:05 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-03 14:54:05 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 14:54:05 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-03 14:54:05 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 14:54:05 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-03 14:54:05 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-03 14:54:05 INFO     Total parameter numbers: 904730
2024-09-03 14:54:05 INFO     You select `adam` optimizer.
2024-09-03 14:54:05 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-03 14:54:05 INFO     Start training ...
2024-09-03 14:54:05 INFO     num_batches:48
2024-09-03 14:54:11 INFO     epoch complete!
2024-09-03 14:54:11 INFO     evaluating now!
2024-09-03 14:54:11 INFO     Epoch [0/200] train_loss: 25.3169, val_loss: 18.2838, lr: 0.003000, 5.56s
2024-09-03 14:54:11 INFO     Saved model at 0
2024-09-03 14:54:11 INFO     Val loss decrease from inf to 18.2838, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-03 14:54:16 INFO     epoch complete!
2024-09-03 14:54:16 INFO     evaluating now!
2024-09-03 14:54:16 INFO     Epoch [1/200] train_loss: 15.0617, val_loss: 14.4433, lr: 0.003000, 5.42s
2024-09-03 14:54:16 INFO     Saved model at 1
2024-09-03 14:54:16 INFO     Val loss decrease from 18.2838 to 14.4433, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-03 14:54:22 INFO     epoch complete!
2024-09-03 14:54:22 INFO     evaluating now!
2024-09-03 14:54:22 INFO     Epoch [2/200] train_loss: 12.3043, val_loss: 11.6831, lr: 0.003000, 5.46s
2024-09-03 14:54:22 INFO     Saved model at 2
2024-09-03 14:54:22 INFO     Val loss decrease from 14.4433 to 11.6831, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-03 14:54:27 INFO     epoch complete!
2024-09-03 14:54:27 INFO     evaluating now!
2024-09-03 14:54:27 INFO     Epoch [3/200] train_loss: 9.7434, val_loss: 9.1508, lr: 0.003000, 5.37s
2024-09-03 14:54:27 INFO     Saved model at 3
2024-09-03 14:54:27 INFO     Val loss decrease from 11.6831 to 9.1508, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-03 14:54:32 INFO     epoch complete!
2024-09-03 14:54:32 INFO     evaluating now!
2024-09-03 14:54:33 INFO     Epoch [4/200] train_loss: 8.1254, val_loss: 7.8876, lr: 0.003000, 5.33s
2024-09-03 14:54:33 INFO     Saved model at 4
2024-09-03 14:54:33 INFO     Val loss decrease from 9.1508 to 7.8876, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-03 14:54:38 INFO     epoch complete!
2024-09-03 14:54:38 INFO     evaluating now!
2024-09-03 14:54:38 INFO     Epoch [5/200] train_loss: 7.0972, val_loss: 7.0366, lr: 0.003000, 5.38s
2024-09-03 14:54:38 INFO     Saved model at 5
2024-09-03 14:54:38 INFO     Val loss decrease from 7.8876 to 7.0366, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-03 14:54:43 INFO     epoch complete!
2024-09-03 14:54:43 INFO     evaluating now!
2024-09-03 14:54:44 INFO     Epoch [6/200] train_loss: 6.4722, val_loss: 6.6214, lr: 0.003000, 5.42s
2024-09-03 14:54:44 INFO     Saved model at 6
2024-09-03 14:54:44 INFO     Val loss decrease from 7.0366 to 6.6214, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-03 14:54:49 INFO     epoch complete!
2024-09-03 14:54:49 INFO     evaluating now!
2024-09-03 14:54:49 INFO     Epoch [7/200] train_loss: 6.0033, val_loss: 5.9813, lr: 0.003000, 5.40s
2024-09-03 14:54:49 INFO     Saved model at 7
2024-09-03 14:54:49 INFO     Val loss decrease from 6.6214 to 5.9813, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-03 14:54:54 INFO     epoch complete!
2024-09-03 14:54:54 INFO     evaluating now!
2024-09-03 14:54:54 INFO     Epoch [8/200] train_loss: 5.7085, val_loss: 5.7337, lr: 0.003000, 5.42s
2024-09-03 14:54:54 INFO     Saved model at 8
2024-09-03 14:54:54 INFO     Val loss decrease from 5.9813 to 5.7337, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-03 14:54:59 INFO     epoch complete!
2024-09-03 14:54:59 INFO     evaluating now!
2024-09-03 14:55:00 INFO     Epoch [9/200] train_loss: 5.5105, val_loss: 5.6810, lr: 0.003000, 5.37s
2024-09-03 14:55:00 INFO     Saved model at 9
2024-09-03 14:55:00 INFO     Val loss decrease from 5.7337 to 5.6810, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-03 14:55:05 INFO     epoch complete!
2024-09-03 14:55:05 INFO     evaluating now!
2024-09-03 14:55:05 INFO     Epoch [10/200] train_loss: 5.3439, val_loss: 5.4741, lr: 0.003000, 5.45s
2024-09-03 14:55:05 INFO     Saved model at 10
2024-09-03 14:55:05 INFO     Val loss decrease from 5.6810 to 5.4741, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-03 14:55:10 INFO     epoch complete!
2024-09-03 14:55:10 INFO     evaluating now!
2024-09-03 14:55:11 INFO     Epoch [11/200] train_loss: 5.1772, val_loss: 5.3945, lr: 0.003000, 5.41s
2024-09-03 14:55:11 INFO     Saved model at 11
2024-09-03 14:55:11 INFO     Val loss decrease from 5.4741 to 5.3945, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-03 14:55:16 INFO     epoch complete!
2024-09-03 14:55:16 INFO     evaluating now!
2024-09-03 14:55:16 INFO     Epoch [12/200] train_loss: 5.0516, val_loss: 5.7827, lr: 0.003000, 5.38s
2024-09-03 14:55:21 INFO     epoch complete!
2024-09-03 14:55:21 INFO     evaluating now!
2024-09-03 14:55:22 INFO     Epoch [13/200] train_loss: 4.9772, val_loss: 5.3146, lr: 0.003000, 5.48s
2024-09-03 14:55:22 INFO     Saved model at 13
2024-09-03 14:55:22 INFO     Val loss decrease from 5.3945 to 5.3146, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-03 14:55:27 INFO     epoch complete!
2024-09-03 14:55:27 INFO     evaluating now!
2024-09-03 14:55:27 INFO     Epoch [14/200] train_loss: 4.7937, val_loss: 5.1132, lr: 0.003000, 5.38s
2024-09-03 14:55:27 INFO     Saved model at 14
2024-09-03 14:55:27 INFO     Val loss decrease from 5.3146 to 5.1132, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-03 14:55:32 INFO     epoch complete!
2024-09-03 14:55:32 INFO     evaluating now!
2024-09-03 14:55:32 INFO     Epoch [15/200] train_loss: 4.7456, val_loss: 5.1113, lr: 0.003000, 5.37s
2024-09-03 14:55:32 INFO     Saved model at 15
2024-09-03 14:55:32 INFO     Val loss decrease from 5.1132 to 5.1113, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-03 14:55:37 INFO     epoch complete!
2024-09-03 14:55:37 INFO     evaluating now!
2024-09-03 14:55:38 INFO     Epoch [16/200] train_loss: 4.6710, val_loss: 5.2829, lr: 0.003000, 5.43s
2024-09-03 14:55:43 INFO     epoch complete!
2024-09-03 14:55:43 INFO     evaluating now!
2024-09-03 14:55:43 INFO     Epoch [17/200] train_loss: 4.6421, val_loss: 4.9944, lr: 0.003000, 5.40s
2024-09-03 14:55:43 INFO     Saved model at 17
2024-09-03 14:55:43 INFO     Val loss decrease from 5.1113 to 4.9944, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-03 14:55:48 INFO     epoch complete!
2024-09-03 14:55:48 INFO     evaluating now!
2024-09-03 14:55:49 INFO     Epoch [18/200] train_loss: 4.4850, val_loss: 4.8358, lr: 0.003000, 5.40s
2024-09-03 14:55:49 INFO     Saved model at 18
2024-09-03 14:55:49 INFO     Val loss decrease from 4.9944 to 4.8358, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-03 14:55:54 INFO     epoch complete!
2024-09-03 14:55:54 INFO     evaluating now!
2024-09-03 14:55:54 INFO     Epoch [19/200] train_loss: 4.4200, val_loss: 5.0299, lr: 0.003000, 5.45s
2024-09-03 14:55:59 INFO     epoch complete!
2024-09-03 14:55:59 INFO     evaluating now!
2024-09-03 14:55:59 INFO     Epoch [20/200] train_loss: 4.3712, val_loss: 4.7652, lr: 0.003000, 5.38s
2024-09-03 14:55:59 INFO     Saved model at 20
2024-09-03 14:55:59 INFO     Val loss decrease from 4.8358 to 4.7652, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-03 14:56:05 INFO     epoch complete!
2024-09-03 14:56:05 INFO     evaluating now!
2024-09-03 14:56:05 INFO     Epoch [21/200] train_loss: 4.3274, val_loss: 5.0025, lr: 0.003000, 5.44s
2024-09-03 14:56:10 INFO     epoch complete!
2024-09-03 14:56:10 INFO     evaluating now!
2024-09-03 14:56:10 INFO     Epoch [22/200] train_loss: 4.2626, val_loss: 4.9171, lr: 0.003000, 5.39s
2024-09-03 14:56:15 INFO     epoch complete!
2024-09-03 14:56:15 INFO     evaluating now!
2024-09-03 14:56:16 INFO     Epoch [23/200] train_loss: 4.2733, val_loss: 4.9446, lr: 0.003000, 5.36s
2024-09-03 14:56:21 INFO     epoch complete!
2024-09-03 14:56:21 INFO     evaluating now!
2024-09-03 14:56:21 INFO     Epoch [24/200] train_loss: 4.2276, val_loss: 4.7671, lr: 0.003000, 5.46s
2024-09-03 14:56:26 INFO     epoch complete!
2024-09-03 14:56:26 INFO     evaluating now!
2024-09-03 14:56:27 INFO     Epoch [25/200] train_loss: 4.1445, val_loss: 4.8219, lr: 0.003000, 5.44s
2024-09-03 14:56:32 INFO     epoch complete!
2024-09-03 14:56:32 INFO     evaluating now!
2024-09-03 14:56:32 INFO     Epoch [26/200] train_loss: 4.0862, val_loss: 4.8643, lr: 0.003000, 5.43s
2024-09-03 14:56:37 INFO     epoch complete!
2024-09-03 14:56:37 INFO     evaluating now!
2024-09-03 14:56:37 INFO     Epoch [27/200] train_loss: 4.0199, val_loss: 4.8286, lr: 0.003000, 5.47s
2024-09-03 14:56:42 INFO     epoch complete!
2024-09-03 14:56:42 INFO     evaluating now!
2024-09-03 14:56:43 INFO     Epoch [28/200] train_loss: 4.0003, val_loss: 4.7065, lr: 0.003000, 5.37s
2024-09-03 14:56:43 INFO     Saved model at 28
2024-09-03 14:56:43 INFO     Val loss decrease from 4.7652 to 4.7065, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-03 14:56:48 INFO     epoch complete!
2024-09-03 14:56:48 INFO     evaluating now!
2024-09-03 14:56:48 INFO     Epoch [29/200] train_loss: 4.0033, val_loss: 4.7996, lr: 0.003000, 5.35s
2024-09-03 14:56:53 INFO     epoch complete!
2024-09-03 14:56:53 INFO     evaluating now!
2024-09-03 14:56:54 INFO     Epoch [30/200] train_loss: 3.9815, val_loss: 4.9408, lr: 0.003000, 5.41s
2024-09-03 14:56:59 INFO     epoch complete!
2024-09-03 14:56:59 INFO     evaluating now!
2024-09-03 14:56:59 INFO     Epoch [31/200] train_loss: 3.9154, val_loss: 4.7750, lr: 0.003000, 5.40s
2024-09-03 14:57:04 INFO     epoch complete!
2024-09-03 14:57:04 INFO     evaluating now!
2024-09-03 14:57:04 INFO     Epoch [32/200] train_loss: 3.8766, val_loss: 4.7509, lr: 0.003000, 5.40s
2024-09-03 14:57:09 INFO     epoch complete!
2024-09-03 14:57:09 INFO     evaluating now!
2024-09-03 14:57:10 INFO     Epoch [33/200] train_loss: 3.8346, val_loss: 4.6766, lr: 0.003000, 5.42s
2024-09-03 14:57:10 INFO     Saved model at 33
2024-09-03 14:57:10 INFO     Val loss decrease from 4.7065 to 4.6766, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-09-03 14:57:15 INFO     epoch complete!
2024-09-03 14:57:15 INFO     evaluating now!
2024-09-03 14:57:15 INFO     Epoch [34/200] train_loss: 3.7987, val_loss: 4.6966, lr: 0.003000, 5.39s
2024-09-03 14:57:20 INFO     epoch complete!
2024-09-03 14:57:20 INFO     evaluating now!
2024-09-03 14:57:21 INFO     Epoch [35/200] train_loss: 3.7926, val_loss: 4.7618, lr: 0.003000, 5.42s
2024-09-03 14:57:26 INFO     epoch complete!
2024-09-03 14:57:26 INFO     evaluating now!
2024-09-03 14:57:26 INFO     Epoch [36/200] train_loss: 3.8057, val_loss: 4.7846, lr: 0.003000, 5.39s
2024-09-03 14:57:31 INFO     epoch complete!
2024-09-03 14:57:31 INFO     evaluating now!
2024-09-03 14:57:31 INFO     Epoch [37/200] train_loss: 3.7850, val_loss: 4.7649, lr: 0.003000, 5.36s
2024-09-03 14:57:36 INFO     epoch complete!
2024-09-03 14:57:36 INFO     evaluating now!
2024-09-03 14:57:37 INFO     Epoch [38/200] train_loss: 3.6975, val_loss: 4.8666, lr: 0.003000, 5.42s
2024-09-03 14:57:42 INFO     epoch complete!
2024-09-03 14:57:42 INFO     evaluating now!
2024-09-03 14:57:42 INFO     Epoch [39/200] train_loss: 3.7443, val_loss: 4.6358, lr: 0.003000, 5.35s
2024-09-03 14:57:42 INFO     Saved model at 39
2024-09-03 14:57:42 INFO     Val loss decrease from 4.6766 to 4.6358, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-09-03 14:57:47 INFO     epoch complete!
2024-09-03 14:57:47 INFO     evaluating now!
2024-09-03 14:57:47 INFO     Epoch [40/200] train_loss: 3.6967, val_loss: 4.5763, lr: 0.003000, 5.33s
2024-09-03 14:57:47 INFO     Saved model at 40
2024-09-03 14:57:47 INFO     Val loss decrease from 4.6358 to 4.5763, saving to ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-09-03 14:57:53 INFO     epoch complete!
2024-09-03 14:57:53 INFO     evaluating now!
2024-09-03 14:57:53 INFO     Epoch [41/200] train_loss: 3.6691, val_loss: 4.6959, lr: 0.003000, 5.50s
2024-09-03 14:57:58 INFO     epoch complete!
2024-09-03 14:57:58 INFO     evaluating now!
2024-09-03 14:57:58 INFO     Epoch [42/200] train_loss: 3.6419, val_loss: 4.7424, lr: 0.003000, 5.39s
2024-09-03 14:58:03 INFO     epoch complete!
2024-09-03 14:58:03 INFO     evaluating now!
2024-09-03 14:58:04 INFO     Epoch [43/200] train_loss: 3.6321, val_loss: 4.6952, lr: 0.003000, 5.42s
2024-09-03 14:58:09 INFO     epoch complete!
2024-09-03 14:58:09 INFO     evaluating now!
2024-09-03 14:58:09 INFO     Epoch [44/200] train_loss: 3.5756, val_loss: 4.7317, lr: 0.003000, 5.45s
2024-09-03 14:58:14 INFO     epoch complete!
2024-09-03 14:58:14 INFO     evaluating now!
2024-09-03 14:58:15 INFO     Epoch [45/200] train_loss: 3.6132, val_loss: 4.8045, lr: 0.003000, 5.33s
2024-09-03 14:58:20 INFO     epoch complete!
2024-09-03 14:58:20 INFO     evaluating now!
2024-09-03 14:58:20 INFO     Epoch [46/200] train_loss: 3.6299, val_loss: 4.7419, lr: 0.003000, 5.43s
2024-09-03 14:58:25 INFO     epoch complete!
2024-09-03 14:58:25 INFO     evaluating now!
2024-09-03 14:58:25 INFO     Epoch [47/200] train_loss: 3.5400, val_loss: 4.7281, lr: 0.003000, 5.37s
2024-09-03 14:58:30 INFO     epoch complete!
2024-09-03 14:58:30 INFO     evaluating now!
2024-09-03 14:58:31 INFO     Epoch [48/200] train_loss: 3.5133, val_loss: 4.7965, lr: 0.003000, 5.37s
2024-09-03 14:58:36 INFO     epoch complete!
2024-09-03 14:58:36 INFO     evaluating now!
2024-09-03 14:58:36 INFO     Epoch [49/200] train_loss: 3.4754, val_loss: 4.8005, lr: 0.003000, 5.42s
2024-09-03 14:58:41 INFO     epoch complete!
2024-09-03 14:58:41 INFO     evaluating now!
2024-09-03 14:58:42 INFO     Epoch [50/200] train_loss: 3.4802, val_loss: 4.6296, lr: 0.003000, 5.40s
2024-09-03 14:58:47 INFO     epoch complete!
2024-09-03 14:58:47 INFO     evaluating now!
2024-09-03 14:58:47 INFO     Epoch [51/200] train_loss: 3.4442, val_loss: 4.7549, lr: 0.003000, 5.37s
2024-09-03 14:58:52 INFO     epoch complete!
2024-09-03 14:58:52 INFO     evaluating now!
2024-09-03 14:58:52 INFO     Epoch [52/200] train_loss: 3.4503, val_loss: 4.7707, lr: 0.003000, 5.42s
2024-09-03 14:58:57 INFO     epoch complete!
2024-09-03 14:58:57 INFO     evaluating now!
2024-09-03 14:58:58 INFO     Epoch [53/200] train_loss: 3.5053, val_loss: 4.7699, lr: 0.003000, 5.38s
2024-09-03 14:59:03 INFO     epoch complete!
2024-09-03 14:59:03 INFO     evaluating now!
2024-09-03 14:59:03 INFO     Epoch [54/200] train_loss: 3.4603, val_loss: 4.6924, lr: 0.003000, 5.40s
2024-09-03 14:59:08 INFO     epoch complete!
2024-09-03 14:59:08 INFO     evaluating now!
2024-09-03 14:59:09 INFO     Epoch [55/200] train_loss: 3.3895, val_loss: 4.6559, lr: 0.003000, 5.46s
2024-09-03 14:59:09 WARNING  Early stopping at epoch: 55
2024-09-03 14:59:09 INFO     Trained totally 56 epochs, average train time is 5.070s, average eval time is 0.336s
2024-09-03 14:59:09 INFO     Loaded model at 40
2024-09-03 14:59:09 INFO     Saved model at ./libcity/cache/160/model_cache/AGCRN_CHITaxi20190406.m
2024-09-03 14:59:09 INFO     Start evaluating ...
2024-09-03 14:59:10 INFO     Note that you select the single mode to evaluate!
2024-09-03 14:59:10 INFO     Evaluate result is saved at ./libcity/cache/160/evaluate_cache\2024_09_03_14_59_10_AGCRN_CHITaxi20190406.csv
2024-09-03 14:59:10 INFO     
         MAE       RMSE
1   2.337620   7.002724
2   2.452077   7.659595
3   2.568348   8.236493
4   2.647867   8.557541
5   2.703180   8.780825
6   2.696399   8.966297
7   2.741456   9.240429
8   2.689395   9.426214
9   2.739578   9.675137
10  2.825470   9.989491
11  2.794324  10.064635
12  2.888972  10.548982
2024-09-03 14:59:10 INFO     ----------------------------------------------------------------------------
2024-09-03 14:59:10 INFO     Kownledge Graph Embedding: RandomE, Experiment ids: [160, 161, 162, 163, 164]
2024-09-03 14:59:10 INFO     ----------------------------------------------------------------------------
2024-09-03 14:59:10 INFO     Average: 
         MAE       RMSE
0   2.272090   7.023845
1   2.321204   7.522808
2   2.454471   8.240707
3   2.545434   8.617513
4   2.606706   8.903235
5   2.643124   9.115614
6   2.667025   9.331085
7   2.678927   9.509822
8   2.710092   9.691092
9   2.759859   9.861696
10  2.776835  10.050709
11  2.867982  10.394790 
2024-09-03 14:59:10 INFO     Standard deviation: 
         MAE      RMSE
0   0.062091  0.347281
1   0.077053  0.310681
2   0.089419  0.308326
3   0.070547  0.311048
4   0.062817  0.303876
5   0.044164  0.283017
6   0.049700  0.198232
7   0.050094  0.162795
8   0.048596  0.160832
9   0.068495  0.180492
10  0.064014  0.180534
11  0.073250  0.162379
2024-09-03 14:59:10 INFO     ----------------------------------------------------------------------------
2024-09-03 14:59:10 INFO     12 steps Average: 
        MAE     RMSE
0  2.608646  9.02191
2024-09-03 14:59:10 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.063353  0.242458
