2024-09-02 14:53:58 INFO     Saving logs in: ./logs/CHITaxi20190406\AGCRN\ExtSpace\RotatE
2024-09-02 14:53:58 INFO     ----------------------------------------------------------------------------
2024-09-02 14:53:58 INFO     # 0, Kownledge Graph Embedding: RotatE, Experiment ids: 65
2024-09-02 14:53:58 INFO     ----------------------------------------------------------------------------
2024-09-02 14:53:58 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=65
2024-09-02 14:53:58 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 65, 'embedding_model': 'RotatE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 14:53:58 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 14:53:58 INFO     set_weight_link_or_dist: dist
2024-09-02 14:53:58 INFO     init_weight_inf_or_zero: inf
2024-09-02 14:53:58 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 14:53:58 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 14:53:58 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 14:53:58 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 14:53:59 INFO     Dataset created
2024-09-02 14:53:59 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 14:54:00 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 14:54:00 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 14:54:00 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 14:54:00 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 14:54:00 INFO     NormalScaler max: 3.5962860584259033
2024-09-02 14:54:03 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 14:54:03 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 14:54:03 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 14:54:03 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 14:54:03 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 14:54:03 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 14:54:03 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 14:54:03 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 14:54:03 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 14:54:03 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 14:54:03 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 14:54:03 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 14:54:03 INFO     Total parameter numbers: 874010
2024-09-02 14:54:03 INFO     You select `adam` optimizer.
2024-09-02 14:54:03 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 14:54:03 INFO     Start training ...
2024-09-02 14:54:03 INFO     num_batches:48
2024-09-02 14:54:10 INFO     epoch complete!
2024-09-02 14:54:10 INFO     evaluating now!
2024-09-02 14:54:10 INFO     Epoch [0/200] train_loss: 24.1658, val_loss: 17.8887, lr: 0.003000, 6.85s
2024-09-02 14:54:10 INFO     Saved model at 0
2024-09-02 14:54:10 INFO     Val loss decrease from inf to 17.8887, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 14:54:15 INFO     epoch complete!
2024-09-02 14:54:15 INFO     evaluating now!
2024-09-02 14:54:15 INFO     Epoch [1/200] train_loss: 14.5909, val_loss: 13.6612, lr: 0.003000, 5.14s
2024-09-02 14:54:15 INFO     Saved model at 1
2024-09-02 14:54:15 INFO     Val loss decrease from 17.8887 to 13.6612, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 14:54:20 INFO     epoch complete!
2024-09-02 14:54:20 INFO     evaluating now!
2024-09-02 14:54:20 INFO     Epoch [2/200] train_loss: 11.2862, val_loss: 10.6300, lr: 0.003000, 5.10s
2024-09-02 14:54:20 INFO     Saved model at 2
2024-09-02 14:54:20 INFO     Val loss decrease from 13.6612 to 10.6300, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 14:54:25 INFO     epoch complete!
2024-09-02 14:54:25 INFO     evaluating now!
2024-09-02 14:54:25 INFO     Epoch [3/200] train_loss: 9.1227, val_loss: 8.5245, lr: 0.003000, 5.10s
2024-09-02 14:54:25 INFO     Saved model at 3
2024-09-02 14:54:25 INFO     Val loss decrease from 10.6300 to 8.5245, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 14:54:30 INFO     epoch complete!
2024-09-02 14:54:30 INFO     evaluating now!
2024-09-02 14:54:30 INFO     Epoch [4/200] train_loss: 7.9571, val_loss: 7.6684, lr: 0.003000, 5.16s
2024-09-02 14:54:30 INFO     Saved model at 4
2024-09-02 14:54:30 INFO     Val loss decrease from 8.5245 to 7.6684, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 14:54:35 INFO     epoch complete!
2024-09-02 14:54:35 INFO     evaluating now!
2024-09-02 14:54:36 INFO     Epoch [5/200] train_loss: 7.2393, val_loss: 7.0777, lr: 0.003000, 5.10s
2024-09-02 14:54:36 INFO     Saved model at 5
2024-09-02 14:54:36 INFO     Val loss decrease from 7.6684 to 7.0777, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 14:54:40 INFO     epoch complete!
2024-09-02 14:54:40 INFO     evaluating now!
2024-09-02 14:54:41 INFO     Epoch [6/200] train_loss: 6.8074, val_loss: 6.5200, lr: 0.003000, 5.16s
2024-09-02 14:54:41 INFO     Saved model at 6
2024-09-02 14:54:41 INFO     Val loss decrease from 7.0777 to 6.5200, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 14:54:46 INFO     epoch complete!
2024-09-02 14:54:46 INFO     evaluating now!
2024-09-02 14:54:46 INFO     Epoch [7/200] train_loss: 6.3113, val_loss: 6.4129, lr: 0.003000, 5.10s
2024-09-02 14:54:46 INFO     Saved model at 7
2024-09-02 14:54:46 INFO     Val loss decrease from 6.5200 to 6.4129, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 14:54:51 INFO     epoch complete!
2024-09-02 14:54:51 INFO     evaluating now!
2024-09-02 14:54:51 INFO     Epoch [8/200] train_loss: 5.9811, val_loss: 6.2749, lr: 0.003000, 5.22s
2024-09-02 14:54:51 INFO     Saved model at 8
2024-09-02 14:54:51 INFO     Val loss decrease from 6.4129 to 6.2749, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 14:54:56 INFO     epoch complete!
2024-09-02 14:54:56 INFO     evaluating now!
2024-09-02 14:54:56 INFO     Epoch [9/200] train_loss: 5.7694, val_loss: 5.9130, lr: 0.003000, 5.08s
2024-09-02 14:54:56 INFO     Saved model at 9
2024-09-02 14:54:56 INFO     Val loss decrease from 6.2749 to 5.9130, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 14:55:01 INFO     epoch complete!
2024-09-02 14:55:01 INFO     evaluating now!
2024-09-02 14:55:01 INFO     Epoch [10/200] train_loss: 5.6056, val_loss: 6.1156, lr: 0.003000, 5.28s
2024-09-02 14:55:06 INFO     epoch complete!
2024-09-02 14:55:06 INFO     evaluating now!
2024-09-02 14:55:07 INFO     Epoch [11/200] train_loss: 5.4698, val_loss: 5.7415, lr: 0.003000, 5.17s
2024-09-02 14:55:07 INFO     Saved model at 11
2024-09-02 14:55:07 INFO     Val loss decrease from 5.9130 to 5.7415, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 14:55:12 INFO     epoch complete!
2024-09-02 14:55:12 INFO     evaluating now!
2024-09-02 14:55:12 INFO     Epoch [12/200] train_loss: 5.3933, val_loss: 5.6271, lr: 0.003000, 5.13s
2024-09-02 14:55:12 INFO     Saved model at 12
2024-09-02 14:55:12 INFO     Val loss decrease from 5.7415 to 5.6271, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 14:55:17 INFO     epoch complete!
2024-09-02 14:55:17 INFO     evaluating now!
2024-09-02 14:55:17 INFO     Epoch [13/200] train_loss: 5.2025, val_loss: 5.5402, lr: 0.003000, 5.14s
2024-09-02 14:55:17 INFO     Saved model at 13
2024-09-02 14:55:17 INFO     Val loss decrease from 5.6271 to 5.5402, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 14:55:22 INFO     epoch complete!
2024-09-02 14:55:22 INFO     evaluating now!
2024-09-02 14:55:22 INFO     Epoch [14/200] train_loss: 5.0737, val_loss: 5.5952, lr: 0.003000, 5.25s
2024-09-02 14:55:27 INFO     epoch complete!
2024-09-02 14:55:27 INFO     evaluating now!
2024-09-02 14:55:28 INFO     Epoch [15/200] train_loss: 4.9911, val_loss: 5.4440, lr: 0.003000, 5.42s
2024-09-02 14:55:28 INFO     Saved model at 15
2024-09-02 14:55:28 INFO     Val loss decrease from 5.5402 to 5.4440, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 14:55:33 INFO     epoch complete!
2024-09-02 14:55:33 INFO     evaluating now!
2024-09-02 14:55:33 INFO     Epoch [16/200] train_loss: 4.8413, val_loss: 5.2599, lr: 0.003000, 5.20s
2024-09-02 14:55:33 INFO     Saved model at 16
2024-09-02 14:55:33 INFO     Val loss decrease from 5.4440 to 5.2599, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 14:55:38 INFO     epoch complete!
2024-09-02 14:55:38 INFO     evaluating now!
2024-09-02 14:55:38 INFO     Epoch [17/200] train_loss: 4.8256, val_loss: 5.3875, lr: 0.003000, 5.20s
2024-09-02 14:55:43 INFO     epoch complete!
2024-09-02 14:55:43 INFO     evaluating now!
2024-09-02 14:55:43 INFO     Epoch [18/200] train_loss: 4.7599, val_loss: 5.3288, lr: 0.003000, 5.17s
2024-09-02 14:55:48 INFO     epoch complete!
2024-09-02 14:55:48 INFO     evaluating now!
2024-09-02 14:55:48 INFO     Epoch [19/200] train_loss: 4.7267, val_loss: 5.2282, lr: 0.003000, 5.13s
2024-09-02 14:55:48 INFO     Saved model at 19
2024-09-02 14:55:48 INFO     Val loss decrease from 5.2599 to 5.2282, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-02 14:55:53 INFO     epoch complete!
2024-09-02 14:55:53 INFO     evaluating now!
2024-09-02 14:55:54 INFO     Epoch [20/200] train_loss: 4.6292, val_loss: 5.5222, lr: 0.003000, 5.15s
2024-09-02 14:55:58 INFO     epoch complete!
2024-09-02 14:55:58 INFO     evaluating now!
2024-09-02 14:55:59 INFO     Epoch [21/200] train_loss: 4.5799, val_loss: 5.2603, lr: 0.003000, 5.24s
2024-09-02 14:56:04 INFO     epoch complete!
2024-09-02 14:56:04 INFO     evaluating now!
2024-09-02 14:56:04 INFO     Epoch [22/200] train_loss: 4.4696, val_loss: 5.1232, lr: 0.003000, 5.15s
2024-09-02 14:56:04 INFO     Saved model at 22
2024-09-02 14:56:04 INFO     Val loss decrease from 5.2282 to 5.1232, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-02 14:56:09 INFO     epoch complete!
2024-09-02 14:56:09 INFO     evaluating now!
2024-09-02 14:56:09 INFO     Epoch [23/200] train_loss: 4.4699, val_loss: 5.1846, lr: 0.003000, 5.19s
2024-09-02 14:56:14 INFO     epoch complete!
2024-09-02 14:56:14 INFO     evaluating now!
2024-09-02 14:56:14 INFO     Epoch [24/200] train_loss: 4.4085, val_loss: 5.0480, lr: 0.003000, 5.23s
2024-09-02 14:56:14 INFO     Saved model at 24
2024-09-02 14:56:14 INFO     Val loss decrease from 5.1232 to 5.0480, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-02 14:56:19 INFO     epoch complete!
2024-09-02 14:56:19 INFO     evaluating now!
2024-09-02 14:56:20 INFO     Epoch [25/200] train_loss: 4.4078, val_loss: 5.0918, lr: 0.003000, 5.24s
2024-09-02 14:56:25 INFO     epoch complete!
2024-09-02 14:56:25 INFO     evaluating now!
2024-09-02 14:56:25 INFO     Epoch [26/200] train_loss: 4.3445, val_loss: 5.2056, lr: 0.003000, 5.25s
2024-09-02 14:56:30 INFO     epoch complete!
2024-09-02 14:56:30 INFO     evaluating now!
2024-09-02 14:56:30 INFO     Epoch [27/200] train_loss: 4.2304, val_loss: 4.9897, lr: 0.003000, 5.25s
2024-09-02 14:56:30 INFO     Saved model at 27
2024-09-02 14:56:30 INFO     Val loss decrease from 5.0480 to 4.9897, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-02 14:56:35 INFO     epoch complete!
2024-09-02 14:56:35 INFO     evaluating now!
2024-09-02 14:56:35 INFO     Epoch [28/200] train_loss: 4.1859, val_loss: 5.1732, lr: 0.003000, 5.22s
2024-09-02 14:56:40 INFO     epoch complete!
2024-09-02 14:56:40 INFO     evaluating now!
2024-09-02 14:56:41 INFO     Epoch [29/200] train_loss: 4.2278, val_loss: 5.0798, lr: 0.003000, 5.32s
2024-09-02 14:56:46 INFO     epoch complete!
2024-09-02 14:56:46 INFO     evaluating now!
2024-09-02 14:56:46 INFO     Epoch [30/200] train_loss: 4.1769, val_loss: 5.1018, lr: 0.003000, 5.18s
2024-09-02 14:56:51 INFO     epoch complete!
2024-09-02 14:56:51 INFO     evaluating now!
2024-09-02 14:56:51 INFO     Epoch [31/200] train_loss: 4.1495, val_loss: 5.0148, lr: 0.003000, 5.17s
2024-09-02 14:56:56 INFO     epoch complete!
2024-09-02 14:56:56 INFO     evaluating now!
2024-09-02 14:56:56 INFO     Epoch [32/200] train_loss: 4.0844, val_loss: 5.0626, lr: 0.003000, 5.19s
2024-09-02 14:57:01 INFO     epoch complete!
2024-09-02 14:57:01 INFO     evaluating now!
2024-09-02 14:57:01 INFO     Epoch [33/200] train_loss: 4.0169, val_loss: 5.1224, lr: 0.003000, 5.18s
2024-09-02 14:57:06 INFO     epoch complete!
2024-09-02 14:57:06 INFO     evaluating now!
2024-09-02 14:57:07 INFO     Epoch [34/200] train_loss: 4.0205, val_loss: 5.0686, lr: 0.003000, 5.17s
2024-09-02 14:57:11 INFO     epoch complete!
2024-09-02 14:57:11 INFO     evaluating now!
2024-09-02 14:57:12 INFO     Epoch [35/200] train_loss: 3.9592, val_loss: 4.9824, lr: 0.003000, 5.18s
2024-09-02 14:57:12 INFO     Saved model at 35
2024-09-02 14:57:12 INFO     Val loss decrease from 4.9897 to 4.9824, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-02 14:57:17 INFO     epoch complete!
2024-09-02 14:57:17 INFO     evaluating now!
2024-09-02 14:57:17 INFO     Epoch [36/200] train_loss: 3.9351, val_loss: 5.0894, lr: 0.003000, 5.17s
2024-09-02 14:57:22 INFO     epoch complete!
2024-09-02 14:57:22 INFO     evaluating now!
2024-09-02 14:57:22 INFO     Epoch [37/200] train_loss: 3.9371, val_loss: 4.9929, lr: 0.003000, 5.18s
2024-09-02 14:57:27 INFO     epoch complete!
2024-09-02 14:57:27 INFO     evaluating now!
2024-09-02 14:57:27 INFO     Epoch [38/200] train_loss: 3.9124, val_loss: 5.0712, lr: 0.003000, 5.28s
2024-09-02 14:57:32 INFO     epoch complete!
2024-09-02 14:57:32 INFO     evaluating now!
2024-09-02 14:57:33 INFO     Epoch [39/200] train_loss: 3.8922, val_loss: 5.0873, lr: 0.003000, 5.25s
2024-09-02 14:57:37 INFO     epoch complete!
2024-09-02 14:57:37 INFO     evaluating now!
2024-09-02 14:57:38 INFO     Epoch [40/200] train_loss: 3.8423, val_loss: 5.0657, lr: 0.003000, 5.13s
2024-09-02 14:57:43 INFO     epoch complete!
2024-09-02 14:57:43 INFO     evaluating now!
2024-09-02 14:57:43 INFO     Epoch [41/200] train_loss: 3.8277, val_loss: 4.9713, lr: 0.003000, 5.16s
2024-09-02 14:57:43 INFO     Saved model at 41
2024-09-02 14:57:43 INFO     Val loss decrease from 4.9824 to 4.9713, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-09-02 14:57:48 INFO     epoch complete!
2024-09-02 14:57:48 INFO     evaluating now!
2024-09-02 14:57:48 INFO     Epoch [42/200] train_loss: 3.7492, val_loss: 5.0075, lr: 0.003000, 5.15s
2024-09-02 14:57:53 INFO     epoch complete!
2024-09-02 14:57:53 INFO     evaluating now!
2024-09-02 14:57:53 INFO     Epoch [43/200] train_loss: 3.7376, val_loss: 4.9851, lr: 0.003000, 5.18s
2024-09-02 14:57:58 INFO     epoch complete!
2024-09-02 14:57:58 INFO     evaluating now!
2024-09-02 14:57:58 INFO     Epoch [44/200] train_loss: 3.7237, val_loss: 5.0446, lr: 0.003000, 5.23s
2024-09-02 14:58:03 INFO     epoch complete!
2024-09-02 14:58:03 INFO     evaluating now!
2024-09-02 14:58:04 INFO     Epoch [45/200] train_loss: 3.7937, val_loss: 5.0747, lr: 0.003000, 5.13s
2024-09-02 14:58:08 INFO     epoch complete!
2024-09-02 14:58:08 INFO     evaluating now!
2024-09-02 14:58:09 INFO     Epoch [46/200] train_loss: 3.7176, val_loss: 4.9939, lr: 0.003000, 5.21s
2024-09-02 14:58:14 INFO     epoch complete!
2024-09-02 14:58:14 INFO     evaluating now!
2024-09-02 14:58:14 INFO     Epoch [47/200] train_loss: 3.6391, val_loss: 5.0742, lr: 0.003000, 5.15s
2024-09-02 14:58:19 INFO     epoch complete!
2024-09-02 14:58:19 INFO     evaluating now!
2024-09-02 14:58:19 INFO     Epoch [48/200] train_loss: 3.6715, val_loss: 5.0271, lr: 0.003000, 5.12s
2024-09-02 14:58:24 INFO     epoch complete!
2024-09-02 14:58:24 INFO     evaluating now!
2024-09-02 14:58:24 INFO     Epoch [49/200] train_loss: 3.6395, val_loss: 5.0996, lr: 0.003000, 5.11s
2024-09-02 14:58:29 INFO     epoch complete!
2024-09-02 14:58:29 INFO     evaluating now!
2024-09-02 14:58:29 INFO     Epoch [50/200] train_loss: 3.5879, val_loss: 4.9913, lr: 0.003000, 5.07s
2024-09-02 14:58:34 INFO     epoch complete!
2024-09-02 14:58:34 INFO     evaluating now!
2024-09-02 14:58:34 INFO     Epoch [51/200] train_loss: 3.6316, val_loss: 5.0517, lr: 0.003000, 5.13s
2024-09-02 14:58:39 INFO     epoch complete!
2024-09-02 14:58:39 INFO     evaluating now!
2024-09-02 14:58:40 INFO     Epoch [52/200] train_loss: 3.6572, val_loss: 4.9887, lr: 0.003000, 5.15s
2024-09-02 14:58:44 INFO     epoch complete!
2024-09-02 14:58:44 INFO     evaluating now!
2024-09-02 14:58:45 INFO     Epoch [53/200] train_loss: 3.5840, val_loss: 4.9151, lr: 0.003000, 5.16s
2024-09-02 14:58:45 INFO     Saved model at 53
2024-09-02 14:58:45 INFO     Val loss decrease from 4.9713 to 4.9151, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch53.tar
2024-09-02 14:58:50 INFO     epoch complete!
2024-09-02 14:58:50 INFO     evaluating now!
2024-09-02 14:58:50 INFO     Epoch [54/200] train_loss: 3.5271, val_loss: 4.9704, lr: 0.003000, 5.18s
2024-09-02 14:58:55 INFO     epoch complete!
2024-09-02 14:58:55 INFO     evaluating now!
2024-09-02 14:58:55 INFO     Epoch [55/200] train_loss: 3.5391, val_loss: 5.1205, lr: 0.003000, 5.22s
2024-09-02 14:59:00 INFO     epoch complete!
2024-09-02 14:59:00 INFO     evaluating now!
2024-09-02 14:59:00 INFO     Epoch [56/200] train_loss: 3.5455, val_loss: 4.9775, lr: 0.003000, 5.11s
2024-09-02 14:59:05 INFO     epoch complete!
2024-09-02 14:59:05 INFO     evaluating now!
2024-09-02 14:59:05 INFO     Epoch [57/200] train_loss: 3.5292, val_loss: 5.0008, lr: 0.003000, 5.14s
2024-09-02 14:59:10 INFO     epoch complete!
2024-09-02 14:59:10 INFO     evaluating now!
2024-09-02 14:59:10 INFO     Epoch [58/200] train_loss: 3.5231, val_loss: 4.9248, lr: 0.003000, 5.11s
2024-09-02 14:59:15 INFO     epoch complete!
2024-09-02 14:59:15 INFO     evaluating now!
2024-09-02 14:59:16 INFO     Epoch [59/200] train_loss: 3.4966, val_loss: 5.0053, lr: 0.003000, 5.10s
2024-09-02 14:59:20 INFO     epoch complete!
2024-09-02 14:59:20 INFO     evaluating now!
2024-09-02 14:59:21 INFO     Epoch [60/200] train_loss: 3.4652, val_loss: 5.1294, lr: 0.003000, 5.11s
2024-09-02 14:59:26 INFO     epoch complete!
2024-09-02 14:59:26 INFO     evaluating now!
2024-09-02 14:59:26 INFO     Epoch [61/200] train_loss: 3.4291, val_loss: 5.1446, lr: 0.003000, 5.14s
2024-09-02 14:59:31 INFO     epoch complete!
2024-09-02 14:59:31 INFO     evaluating now!
2024-09-02 14:59:31 INFO     Epoch [62/200] train_loss: 3.4828, val_loss: 5.1232, lr: 0.003000, 5.16s
2024-09-02 14:59:36 INFO     epoch complete!
2024-09-02 14:59:36 INFO     evaluating now!
2024-09-02 14:59:36 INFO     Epoch [63/200] train_loss: 3.4430, val_loss: 5.0256, lr: 0.003000, 5.13s
2024-09-02 14:59:41 INFO     epoch complete!
2024-09-02 14:59:41 INFO     evaluating now!
2024-09-02 14:59:41 INFO     Epoch [64/200] train_loss: 3.4068, val_loss: 5.0244, lr: 0.003000, 5.11s
2024-09-02 14:59:46 INFO     epoch complete!
2024-09-02 14:59:46 INFO     evaluating now!
2024-09-02 14:59:46 INFO     Epoch [65/200] train_loss: 3.4456, val_loss: 5.1104, lr: 0.003000, 5.14s
2024-09-02 14:59:51 INFO     epoch complete!
2024-09-02 14:59:51 INFO     evaluating now!
2024-09-02 14:59:52 INFO     Epoch [66/200] train_loss: 3.4099, val_loss: 5.0411, lr: 0.003000, 5.14s
2024-09-02 14:59:56 INFO     epoch complete!
2024-09-02 14:59:56 INFO     evaluating now!
2024-09-02 14:59:57 INFO     Epoch [67/200] train_loss: 3.3560, val_loss: 5.0332, lr: 0.003000, 5.08s
2024-09-02 15:00:01 INFO     epoch complete!
2024-09-02 15:00:01 INFO     evaluating now!
2024-09-02 15:00:02 INFO     Epoch [68/200] train_loss: 3.3552, val_loss: 4.9233, lr: 0.003000, 5.15s
2024-09-02 15:00:02 WARNING  Early stopping at epoch: 68
2024-09-02 15:00:02 INFO     Trained totally 69 epochs, average train time is 4.881s, average eval time is 0.313s
2024-09-02 15:00:02 INFO     Loaded model at 53
2024-09-02 15:00:02 INFO     Saved model at ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 15:00:02 INFO     Start evaluating ...
2024-09-02 15:00:03 INFO     Note that you select the single mode to evaluate!
2024-09-02 15:00:03 INFO     Evaluate result is saved at ./libcity/cache/65/evaluate_cache\2024_09_02_15_00_03_AGCRN_CHITaxi20190406.csv
2024-09-02 15:00:03 INFO     
         MAE       RMSE
1   2.361348   7.052809
2   2.486865   7.639233
3   2.648041   8.686191
4   2.786804   9.624325
5   2.967962  10.806146
6   3.162896  12.059792
7   3.260765  13.248402
8   3.333760  14.044861
9   3.335492  14.307754
10  3.385348  14.347733
11  3.452821  14.469255
12  3.528098  14.751696
2024-09-02 15:00:03 INFO     ----------------------------------------------------------------------------
2024-09-02 15:00:03 INFO     # 1, Kownledge Graph Embedding: RotatE, Experiment ids: 66
2024-09-02 15:00:03 INFO     ----------------------------------------------------------------------------
2024-09-02 15:00:03 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=65
2024-09-02 15:00:03 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 65, 'embedding_model': 'RotatE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 15:00:03 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 15:00:03 INFO     set_weight_link_or_dist: dist
2024-09-02 15:00:03 INFO     init_weight_inf_or_zero: inf
2024-09-02 15:00:03 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 15:00:03 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 15:00:03 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 15:00:03 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 15:00:04 INFO     Dataset created
2024-09-02 15:00:04 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 15:00:05 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 15:00:05 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 15:00:05 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 15:00:05 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 15:00:05 INFO     NormalScaler max: 3.5962860584259033
2024-09-02 15:00:07 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 15:00:07 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 15:00:07 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 15:00:07 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:00:07 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 15:00:07 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:00:07 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 15:00:07 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:00:07 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 15:00:07 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:00:07 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 15:00:07 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 15:00:07 INFO     Total parameter numbers: 874010
2024-09-02 15:00:07 INFO     You select `adam` optimizer.
2024-09-02 15:00:07 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 15:00:07 INFO     Start training ...
2024-09-02 15:00:07 INFO     num_batches:48
2024-09-02 15:00:12 INFO     epoch complete!
2024-09-02 15:00:12 INFO     evaluating now!
2024-09-02 15:00:12 INFO     Epoch [0/200] train_loss: 24.5846, val_loss: 17.4972, lr: 0.003000, 5.45s
2024-09-02 15:00:12 INFO     Saved model at 0
2024-09-02 15:00:12 INFO     Val loss decrease from inf to 17.4972, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 15:00:17 INFO     epoch complete!
2024-09-02 15:00:17 INFO     evaluating now!
2024-09-02 15:00:17 INFO     Epoch [1/200] train_loss: 14.0730, val_loss: 12.9854, lr: 0.003000, 5.14s
2024-09-02 15:00:17 INFO     Saved model at 1
2024-09-02 15:00:17 INFO     Val loss decrease from 17.4972 to 12.9854, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 15:00:22 INFO     epoch complete!
2024-09-02 15:00:22 INFO     evaluating now!
2024-09-02 15:00:22 INFO     Epoch [2/200] train_loss: 10.8704, val_loss: 10.2352, lr: 0.003000, 5.17s
2024-09-02 15:00:23 INFO     Saved model at 2
2024-09-02 15:00:23 INFO     Val loss decrease from 12.9854 to 10.2352, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 15:00:27 INFO     epoch complete!
2024-09-02 15:00:27 INFO     evaluating now!
2024-09-02 15:00:28 INFO     Epoch [3/200] train_loss: 9.1201, val_loss: 8.5888, lr: 0.003000, 5.13s
2024-09-02 15:00:28 INFO     Saved model at 3
2024-09-02 15:00:28 INFO     Val loss decrease from 10.2352 to 8.5888, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 15:00:32 INFO     epoch complete!
2024-09-02 15:00:32 INFO     evaluating now!
2024-09-02 15:00:33 INFO     Epoch [4/200] train_loss: 8.0085, val_loss: 7.6197, lr: 0.003000, 5.13s
2024-09-02 15:00:33 INFO     Saved model at 4
2024-09-02 15:00:33 INFO     Val loss decrease from 8.5888 to 7.6197, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 15:00:38 INFO     epoch complete!
2024-09-02 15:00:38 INFO     evaluating now!
2024-09-02 15:00:38 INFO     Epoch [5/200] train_loss: 7.2732, val_loss: 6.9647, lr: 0.003000, 5.12s
2024-09-02 15:00:38 INFO     Saved model at 5
2024-09-02 15:00:38 INFO     Val loss decrease from 7.6197 to 6.9647, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 15:00:43 INFO     epoch complete!
2024-09-02 15:00:43 INFO     evaluating now!
2024-09-02 15:00:43 INFO     Epoch [6/200] train_loss: 6.7406, val_loss: 6.5157, lr: 0.003000, 5.12s
2024-09-02 15:00:43 INFO     Saved model at 6
2024-09-02 15:00:43 INFO     Val loss decrease from 6.9647 to 6.5157, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 15:00:48 INFO     epoch complete!
2024-09-02 15:00:48 INFO     evaluating now!
2024-09-02 15:00:48 INFO     Epoch [7/200] train_loss: 6.2864, val_loss: 6.2834, lr: 0.003000, 5.13s
2024-09-02 15:00:48 INFO     Saved model at 7
2024-09-02 15:00:48 INFO     Val loss decrease from 6.5157 to 6.2834, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 15:00:53 INFO     epoch complete!
2024-09-02 15:00:53 INFO     evaluating now!
2024-09-02 15:00:53 INFO     Epoch [8/200] train_loss: 5.9718, val_loss: 6.3043, lr: 0.003000, 5.14s
2024-09-02 15:00:58 INFO     epoch complete!
2024-09-02 15:00:58 INFO     evaluating now!
2024-09-02 15:00:58 INFO     Epoch [9/200] train_loss: 5.8437, val_loss: 5.9769, lr: 0.003000, 5.13s
2024-09-02 15:00:58 INFO     Saved model at 9
2024-09-02 15:00:58 INFO     Val loss decrease from 6.2834 to 5.9769, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 15:01:03 INFO     epoch complete!
2024-09-02 15:01:03 INFO     evaluating now!
2024-09-02 15:01:04 INFO     Epoch [10/200] train_loss: 5.7156, val_loss: 6.0594, lr: 0.003000, 5.14s
2024-09-02 15:01:08 INFO     epoch complete!
2024-09-02 15:01:08 INFO     evaluating now!
2024-09-02 15:01:09 INFO     Epoch [11/200] train_loss: 5.5094, val_loss: 5.8283, lr: 0.003000, 5.14s
2024-09-02 15:01:09 INFO     Saved model at 11
2024-09-02 15:01:09 INFO     Val loss decrease from 5.9769 to 5.8283, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 15:01:14 INFO     epoch complete!
2024-09-02 15:01:14 INFO     evaluating now!
2024-09-02 15:01:14 INFO     Epoch [12/200] train_loss: 5.3850, val_loss: 5.7544, lr: 0.003000, 5.13s
2024-09-02 15:01:14 INFO     Saved model at 12
2024-09-02 15:01:14 INFO     Val loss decrease from 5.8283 to 5.7544, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 15:01:19 INFO     epoch complete!
2024-09-02 15:01:19 INFO     evaluating now!
2024-09-02 15:01:19 INFO     Epoch [13/200] train_loss: 5.2944, val_loss: 5.7234, lr: 0.003000, 5.11s
2024-09-02 15:01:19 INFO     Saved model at 13
2024-09-02 15:01:19 INFO     Val loss decrease from 5.7544 to 5.7234, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 15:01:24 INFO     epoch complete!
2024-09-02 15:01:24 INFO     evaluating now!
2024-09-02 15:01:24 INFO     Epoch [14/200] train_loss: 5.2445, val_loss: 5.5586, lr: 0.003000, 5.10s
2024-09-02 15:01:24 INFO     Saved model at 14
2024-09-02 15:01:24 INFO     Val loss decrease from 5.7234 to 5.5586, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-02 15:01:29 INFO     epoch complete!
2024-09-02 15:01:29 INFO     evaluating now!
2024-09-02 15:01:29 INFO     Epoch [15/200] train_loss: 5.0945, val_loss: 5.4647, lr: 0.003000, 5.14s
2024-09-02 15:01:29 INFO     Saved model at 15
2024-09-02 15:01:29 INFO     Val loss decrease from 5.5586 to 5.4647, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 15:01:34 INFO     epoch complete!
2024-09-02 15:01:34 INFO     evaluating now!
2024-09-02 15:01:34 INFO     Epoch [16/200] train_loss: 5.0366, val_loss: 5.4143, lr: 0.003000, 5.14s
2024-09-02 15:01:34 INFO     Saved model at 16
2024-09-02 15:01:34 INFO     Val loss decrease from 5.4647 to 5.4143, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 15:01:39 INFO     epoch complete!
2024-09-02 15:01:39 INFO     evaluating now!
2024-09-02 15:01:40 INFO     Epoch [17/200] train_loss: 4.9073, val_loss: 5.2677, lr: 0.003000, 5.17s
2024-09-02 15:01:40 INFO     Saved model at 17
2024-09-02 15:01:40 INFO     Val loss decrease from 5.4143 to 5.2677, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-02 15:01:44 INFO     epoch complete!
2024-09-02 15:01:44 INFO     evaluating now!
2024-09-02 15:01:45 INFO     Epoch [18/200] train_loss: 4.8457, val_loss: 5.4937, lr: 0.003000, 5.12s
2024-09-02 15:01:50 INFO     epoch complete!
2024-09-02 15:01:50 INFO     evaluating now!
2024-09-02 15:01:50 INFO     Epoch [19/200] train_loss: 4.8687, val_loss: 5.2677, lr: 0.003000, 5.14s
2024-09-02 15:01:50 INFO     Saved model at 19
2024-09-02 15:01:50 INFO     Val loss decrease from 5.2677 to 5.2677, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-02 15:01:55 INFO     epoch complete!
2024-09-02 15:01:55 INFO     evaluating now!
2024-09-02 15:01:55 INFO     Epoch [20/200] train_loss: 4.7062, val_loss: 5.3207, lr: 0.003000, 5.21s
2024-09-02 15:02:00 INFO     epoch complete!
2024-09-02 15:02:00 INFO     evaluating now!
2024-09-02 15:02:00 INFO     Epoch [21/200] train_loss: 4.6375, val_loss: 5.1333, lr: 0.003000, 5.11s
2024-09-02 15:02:00 INFO     Saved model at 21
2024-09-02 15:02:00 INFO     Val loss decrease from 5.2677 to 5.1333, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-02 15:02:05 INFO     epoch complete!
2024-09-02 15:02:05 INFO     evaluating now!
2024-09-02 15:02:05 INFO     Epoch [22/200] train_loss: 4.6243, val_loss: 5.2583, lr: 0.003000, 5.17s
2024-09-02 15:02:10 INFO     epoch complete!
2024-09-02 15:02:10 INFO     evaluating now!
2024-09-02 15:02:11 INFO     Epoch [23/200] train_loss: 4.5867, val_loss: 5.1501, lr: 0.003000, 5.24s
2024-09-02 15:02:16 INFO     epoch complete!
2024-09-02 15:02:16 INFO     evaluating now!
2024-09-02 15:02:16 INFO     Epoch [24/200] train_loss: 4.4803, val_loss: 5.1867, lr: 0.003000, 5.33s
2024-09-02 15:02:21 INFO     epoch complete!
2024-09-02 15:02:21 INFO     evaluating now!
2024-09-02 15:02:21 INFO     Epoch [25/200] train_loss: 4.4263, val_loss: 5.1806, lr: 0.003000, 5.14s
2024-09-02 15:02:26 INFO     epoch complete!
2024-09-02 15:02:26 INFO     evaluating now!
2024-09-02 15:02:26 INFO     Epoch [26/200] train_loss: 4.3886, val_loss: 5.1751, lr: 0.003000, 5.08s
2024-09-02 15:02:31 INFO     epoch complete!
2024-09-02 15:02:31 INFO     evaluating now!
2024-09-02 15:02:31 INFO     Epoch [27/200] train_loss: 4.3223, val_loss: 5.0320, lr: 0.003000, 5.08s
2024-09-02 15:02:31 INFO     Saved model at 27
2024-09-02 15:02:31 INFO     Val loss decrease from 5.1333 to 5.0320, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-02 15:02:36 INFO     epoch complete!
2024-09-02 15:02:36 INFO     evaluating now!
2024-09-02 15:02:36 INFO     Epoch [28/200] train_loss: 4.2906, val_loss: 5.1227, lr: 0.003000, 5.09s
2024-09-02 15:02:41 INFO     epoch complete!
2024-09-02 15:02:41 INFO     evaluating now!
2024-09-02 15:02:42 INFO     Epoch [29/200] train_loss: 4.2683, val_loss: 5.2710, lr: 0.003000, 5.09s
2024-09-02 15:02:46 INFO     epoch complete!
2024-09-02 15:02:46 INFO     evaluating now!
2024-09-02 15:02:47 INFO     Epoch [30/200] train_loss: 4.2040, val_loss: 5.1504, lr: 0.003000, 5.08s
2024-09-02 15:02:51 INFO     epoch complete!
2024-09-02 15:02:51 INFO     evaluating now!
2024-09-02 15:02:52 INFO     Epoch [31/200] train_loss: 4.2102, val_loss: 5.1042, lr: 0.003000, 5.08s
2024-09-02 15:02:56 INFO     epoch complete!
2024-09-02 15:02:56 INFO     evaluating now!
2024-09-02 15:02:57 INFO     Epoch [32/200] train_loss: 4.1501, val_loss: 5.1487, lr: 0.003000, 5.08s
2024-09-02 15:03:02 INFO     epoch complete!
2024-09-02 15:03:02 INFO     evaluating now!
2024-09-02 15:03:02 INFO     Epoch [33/200] train_loss: 4.1031, val_loss: 5.0902, lr: 0.003000, 5.07s
2024-09-02 15:03:07 INFO     epoch complete!
2024-09-02 15:03:07 INFO     evaluating now!
2024-09-02 15:03:07 INFO     Epoch [34/200] train_loss: 4.0550, val_loss: 5.0537, lr: 0.003000, 5.10s
2024-09-02 15:03:12 INFO     epoch complete!
2024-09-02 15:03:12 INFO     evaluating now!
2024-09-02 15:03:12 INFO     Epoch [35/200] train_loss: 4.1021, val_loss: 5.0851, lr: 0.003000, 5.09s
2024-09-02 15:03:17 INFO     epoch complete!
2024-09-02 15:03:17 INFO     evaluating now!
2024-09-02 15:03:17 INFO     Epoch [36/200] train_loss: 4.0088, val_loss: 5.1811, lr: 0.003000, 5.09s
2024-09-02 15:03:22 INFO     epoch complete!
2024-09-02 15:03:22 INFO     evaluating now!
2024-09-02 15:03:22 INFO     Epoch [37/200] train_loss: 3.9808, val_loss: 5.0943, lr: 0.003000, 5.08s
2024-09-02 15:03:27 INFO     epoch complete!
2024-09-02 15:03:27 INFO     evaluating now!
2024-09-02 15:03:27 INFO     Epoch [38/200] train_loss: 3.9750, val_loss: 5.0053, lr: 0.003000, 5.07s
2024-09-02 15:03:27 INFO     Saved model at 38
2024-09-02 15:03:27 INFO     Val loss decrease from 5.0320 to 5.0053, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-09-02 15:03:32 INFO     epoch complete!
2024-09-02 15:03:32 INFO     evaluating now!
2024-09-02 15:03:32 INFO     Epoch [39/200] train_loss: 3.9312, val_loss: 5.0481, lr: 0.003000, 5.07s
2024-09-02 15:03:37 INFO     epoch complete!
2024-09-02 15:03:37 INFO     evaluating now!
2024-09-02 15:03:37 INFO     Epoch [40/200] train_loss: 3.9387, val_loss: 5.0963, lr: 0.003000, 5.08s
2024-09-02 15:03:42 INFO     epoch complete!
2024-09-02 15:03:42 INFO     evaluating now!
2024-09-02 15:03:43 INFO     Epoch [41/200] train_loss: 3.8660, val_loss: 5.0530, lr: 0.003000, 5.09s
2024-09-02 15:03:47 INFO     epoch complete!
2024-09-02 15:03:47 INFO     evaluating now!
2024-09-02 15:03:48 INFO     Epoch [42/200] train_loss: 3.8341, val_loss: 5.0368, lr: 0.003000, 5.08s
2024-09-02 15:03:52 INFO     epoch complete!
2024-09-02 15:03:52 INFO     evaluating now!
2024-09-02 15:03:53 INFO     Epoch [43/200] train_loss: 3.8272, val_loss: 5.1552, lr: 0.003000, 5.08s
2024-09-02 15:03:57 INFO     epoch complete!
2024-09-02 15:03:57 INFO     evaluating now!
2024-09-02 15:03:58 INFO     Epoch [44/200] train_loss: 3.8419, val_loss: 5.0934, lr: 0.003000, 5.07s
2024-09-02 15:04:03 INFO     epoch complete!
2024-09-02 15:04:03 INFO     evaluating now!
2024-09-02 15:04:03 INFO     Epoch [45/200] train_loss: 3.7956, val_loss: 5.1673, lr: 0.003000, 5.08s
2024-09-02 15:04:08 INFO     epoch complete!
2024-09-02 15:04:08 INFO     evaluating now!
2024-09-02 15:04:08 INFO     Epoch [46/200] train_loss: 3.7316, val_loss: 5.0396, lr: 0.003000, 5.09s
2024-09-02 15:04:13 INFO     epoch complete!
2024-09-02 15:04:13 INFO     evaluating now!
2024-09-02 15:04:13 INFO     Epoch [47/200] train_loss: 3.7447, val_loss: 5.0186, lr: 0.003000, 5.07s
2024-09-02 15:04:18 INFO     epoch complete!
2024-09-02 15:04:18 INFO     evaluating now!
2024-09-02 15:04:18 INFO     Epoch [48/200] train_loss: 3.7275, val_loss: 5.1069, lr: 0.003000, 5.07s
2024-09-02 15:04:23 INFO     epoch complete!
2024-09-02 15:04:23 INFO     evaluating now!
2024-09-02 15:04:23 INFO     Epoch [49/200] train_loss: 3.6811, val_loss: 4.9210, lr: 0.003000, 5.07s
2024-09-02 15:04:23 INFO     Saved model at 49
2024-09-02 15:04:23 INFO     Val loss decrease from 5.0053 to 4.9210, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-09-02 15:04:28 INFO     epoch complete!
2024-09-02 15:04:28 INFO     evaluating now!
2024-09-02 15:04:28 INFO     Epoch [50/200] train_loss: 3.6383, val_loss: 4.9695, lr: 0.003000, 5.08s
2024-09-02 15:04:33 INFO     epoch complete!
2024-09-02 15:04:33 INFO     evaluating now!
2024-09-02 15:04:33 INFO     Epoch [51/200] train_loss: 3.6360, val_loss: 4.8626, lr: 0.003000, 5.07s
2024-09-02 15:04:33 INFO     Saved model at 51
2024-09-02 15:04:33 INFO     Val loss decrease from 4.9210 to 4.8626, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-09-02 15:04:38 INFO     epoch complete!
2024-09-02 15:04:38 INFO     evaluating now!
2024-09-02 15:04:38 INFO     Epoch [52/200] train_loss: 3.6097, val_loss: 4.9453, lr: 0.003000, 5.07s
2024-09-02 15:04:43 INFO     epoch complete!
2024-09-02 15:04:43 INFO     evaluating now!
2024-09-02 15:04:43 INFO     Epoch [53/200] train_loss: 3.5891, val_loss: 4.9241, lr: 0.003000, 5.09s
2024-09-02 15:04:48 INFO     epoch complete!
2024-09-02 15:04:48 INFO     evaluating now!
2024-09-02 15:04:49 INFO     Epoch [54/200] train_loss: 3.5993, val_loss: 4.9520, lr: 0.003000, 5.08s
2024-09-02 15:04:53 INFO     epoch complete!
2024-09-02 15:04:53 INFO     evaluating now!
2024-09-02 15:04:54 INFO     Epoch [55/200] train_loss: 3.5897, val_loss: 5.0727, lr: 0.003000, 5.07s
2024-09-02 15:04:58 INFO     epoch complete!
2024-09-02 15:04:58 INFO     evaluating now!
2024-09-02 15:04:59 INFO     Epoch [56/200] train_loss: 3.5977, val_loss: 4.8242, lr: 0.003000, 5.06s
2024-09-02 15:04:59 INFO     Saved model at 56
2024-09-02 15:04:59 INFO     Val loss decrease from 4.8626 to 4.8242, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch56.tar
2024-09-02 15:05:03 INFO     epoch complete!
2024-09-02 15:05:03 INFO     evaluating now!
2024-09-02 15:05:04 INFO     Epoch [57/200] train_loss: 3.5144, val_loss: 5.0129, lr: 0.003000, 5.07s
2024-09-02 15:05:09 INFO     epoch complete!
2024-09-02 15:05:09 INFO     evaluating now!
2024-09-02 15:05:09 INFO     Epoch [58/200] train_loss: 3.5311, val_loss: 4.9140, lr: 0.003000, 5.06s
2024-09-02 15:05:14 INFO     epoch complete!
2024-09-02 15:05:14 INFO     evaluating now!
2024-09-02 15:05:14 INFO     Epoch [59/200] train_loss: 3.5138, val_loss: 4.9735, lr: 0.003000, 5.07s
2024-09-02 15:05:19 INFO     epoch complete!
2024-09-02 15:05:19 INFO     evaluating now!
2024-09-02 15:05:19 INFO     Epoch [60/200] train_loss: 3.4967, val_loss: 4.9093, lr: 0.003000, 5.07s
2024-09-02 15:05:24 INFO     epoch complete!
2024-09-02 15:05:24 INFO     evaluating now!
2024-09-02 15:05:24 INFO     Epoch [61/200] train_loss: 3.4847, val_loss: 4.9846, lr: 0.003000, 5.07s
2024-09-02 15:05:29 INFO     epoch complete!
2024-09-02 15:05:29 INFO     evaluating now!
2024-09-02 15:05:29 INFO     Epoch [62/200] train_loss: 3.4552, val_loss: 4.8928, lr: 0.003000, 5.09s
2024-09-02 15:05:34 INFO     epoch complete!
2024-09-02 15:05:34 INFO     evaluating now!
2024-09-02 15:05:34 INFO     Epoch [63/200] train_loss: 3.4530, val_loss: 4.9960, lr: 0.003000, 5.07s
2024-09-02 15:05:39 INFO     epoch complete!
2024-09-02 15:05:39 INFO     evaluating now!
2024-09-02 15:05:39 INFO     Epoch [64/200] train_loss: 3.4495, val_loss: 4.9779, lr: 0.003000, 5.07s
2024-09-02 15:05:44 INFO     epoch complete!
2024-09-02 15:05:44 INFO     evaluating now!
2024-09-02 15:05:44 INFO     Epoch [65/200] train_loss: 3.4753, val_loss: 5.0040, lr: 0.003000, 5.07s
2024-09-02 15:05:49 INFO     epoch complete!
2024-09-02 15:05:49 INFO     evaluating now!
2024-09-02 15:05:49 INFO     Epoch [66/200] train_loss: 3.4113, val_loss: 4.9075, lr: 0.003000, 5.07s
2024-09-02 15:05:54 INFO     epoch complete!
2024-09-02 15:05:54 INFO     evaluating now!
2024-09-02 15:05:54 INFO     Epoch [67/200] train_loss: 3.3652, val_loss: 4.9023, lr: 0.003000, 5.06s
2024-09-02 15:05:59 INFO     epoch complete!
2024-09-02 15:05:59 INFO     evaluating now!
2024-09-02 15:06:00 INFO     Epoch [68/200] train_loss: 3.3745, val_loss: 4.8823, lr: 0.003000, 5.06s
2024-09-02 15:06:04 INFO     epoch complete!
2024-09-02 15:06:04 INFO     evaluating now!
2024-09-02 15:06:05 INFO     Epoch [69/200] train_loss: 3.4109, val_loss: 4.9789, lr: 0.003000, 5.07s
2024-09-02 15:06:09 INFO     epoch complete!
2024-09-02 15:06:09 INFO     evaluating now!
2024-09-02 15:06:10 INFO     Epoch [70/200] train_loss: 3.3444, val_loss: 4.9820, lr: 0.003000, 5.07s
2024-09-02 15:06:14 INFO     epoch complete!
2024-09-02 15:06:14 INFO     evaluating now!
2024-09-02 15:06:15 INFO     Epoch [71/200] train_loss: 3.3289, val_loss: 4.9256, lr: 0.003000, 5.07s
2024-09-02 15:06:15 WARNING  Early stopping at epoch: 71
2024-09-02 15:06:15 INFO     Trained totally 72 epochs, average train time is 4.802s, average eval time is 0.305s
2024-09-02 15:06:15 INFO     Loaded model at 56
2024-09-02 15:06:15 INFO     Saved model at ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 15:06:15 INFO     Start evaluating ...
2024-09-02 15:06:16 INFO     Note that you select the single mode to evaluate!
2024-09-02 15:06:16 INFO     Evaluate result is saved at ./libcity/cache/65/evaluate_cache\2024_09_02_15_06_16_AGCRN_CHITaxi20190406.csv
2024-09-02 15:06:16 INFO     
         MAE       RMSE
1   2.339701   7.020583
2   2.474586   7.790486
3   2.681416   9.014671
4   2.915900  10.221211
5   3.065138  11.583988
6   3.166909  12.677064
7   3.182451  13.363779
8   3.212990  13.791857
9   3.286592  13.976854
10  3.400838  14.128351
11  3.502047  14.278564
12  3.603391  14.565165
2024-09-02 15:06:16 INFO     ----------------------------------------------------------------------------
2024-09-02 15:06:16 INFO     # 2, Kownledge Graph Embedding: RotatE, Experiment ids: 67
2024-09-02 15:06:16 INFO     ----------------------------------------------------------------------------
2024-09-02 15:06:16 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=65
2024-09-02 15:06:16 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 65, 'embedding_model': 'RotatE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 15:06:16 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 15:06:16 INFO     set_weight_link_or_dist: dist
2024-09-02 15:06:16 INFO     init_weight_inf_or_zero: inf
2024-09-02 15:06:16 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 15:06:16 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 15:06:16 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 15:06:16 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 15:06:17 INFO     Dataset created
2024-09-02 15:06:17 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 15:06:18 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 15:06:18 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 15:06:18 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 15:06:18 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 15:06:18 INFO     NormalScaler max: 3.5962860584259033
2024-09-02 15:06:20 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 15:06:20 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 15:06:20 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 15:06:20 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:06:20 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 15:06:20 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:06:20 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 15:06:20 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:06:20 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 15:06:20 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:06:20 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 15:06:20 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 15:06:20 INFO     Total parameter numbers: 874010
2024-09-02 15:06:20 INFO     You select `adam` optimizer.
2024-09-02 15:06:20 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 15:06:20 INFO     Start training ...
2024-09-02 15:06:20 INFO     num_batches:48
2024-09-02 15:06:25 INFO     epoch complete!
2024-09-02 15:06:25 INFO     evaluating now!
2024-09-02 15:06:25 INFO     Epoch [0/200] train_loss: 25.0288, val_loss: 17.8033, lr: 0.003000, 5.35s
2024-09-02 15:06:25 INFO     Saved model at 0
2024-09-02 15:06:25 INFO     Val loss decrease from inf to 17.8033, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 15:06:30 INFO     epoch complete!
2024-09-02 15:06:30 INFO     evaluating now!
2024-09-02 15:06:30 INFO     Epoch [1/200] train_loss: 14.5396, val_loss: 13.5911, lr: 0.003000, 5.08s
2024-09-02 15:06:30 INFO     Saved model at 1
2024-09-02 15:06:30 INFO     Val loss decrease from 17.8033 to 13.5911, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 15:06:35 INFO     epoch complete!
2024-09-02 15:06:35 INFO     evaluating now!
2024-09-02 15:06:35 INFO     Epoch [2/200] train_loss: 11.3524, val_loss: 10.6303, lr: 0.003000, 5.07s
2024-09-02 15:06:35 INFO     Saved model at 2
2024-09-02 15:06:35 INFO     Val loss decrease from 13.5911 to 10.6303, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 15:06:40 INFO     epoch complete!
2024-09-02 15:06:40 INFO     evaluating now!
2024-09-02 15:06:40 INFO     Epoch [3/200] train_loss: 9.0329, val_loss: 8.5059, lr: 0.003000, 5.07s
2024-09-02 15:06:40 INFO     Saved model at 3
2024-09-02 15:06:40 INFO     Val loss decrease from 10.6303 to 8.5059, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 15:06:45 INFO     epoch complete!
2024-09-02 15:06:45 INFO     evaluating now!
2024-09-02 15:06:45 INFO     Epoch [4/200] train_loss: 7.6702, val_loss: 7.4031, lr: 0.003000, 5.07s
2024-09-02 15:06:45 INFO     Saved model at 4
2024-09-02 15:06:45 INFO     Val loss decrease from 8.5059 to 7.4031, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 15:06:50 INFO     epoch complete!
2024-09-02 15:06:50 INFO     evaluating now!
2024-09-02 15:06:50 INFO     Epoch [5/200] train_loss: 7.0389, val_loss: 6.7566, lr: 0.003000, 5.08s
2024-09-02 15:06:50 INFO     Saved model at 5
2024-09-02 15:06:50 INFO     Val loss decrease from 7.4031 to 6.7566, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 15:06:55 INFO     epoch complete!
2024-09-02 15:06:55 INFO     evaluating now!
2024-09-02 15:06:56 INFO     Epoch [6/200] train_loss: 6.5026, val_loss: 6.3616, lr: 0.003000, 5.09s
2024-09-02 15:06:56 INFO     Saved model at 6
2024-09-02 15:06:56 INFO     Val loss decrease from 6.7566 to 6.3616, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 15:07:00 INFO     epoch complete!
2024-09-02 15:07:00 INFO     evaluating now!
2024-09-02 15:07:01 INFO     Epoch [7/200] train_loss: 6.1761, val_loss: 6.0260, lr: 0.003000, 5.08s
2024-09-02 15:07:01 INFO     Saved model at 7
2024-09-02 15:07:01 INFO     Val loss decrease from 6.3616 to 6.0260, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 15:07:05 INFO     epoch complete!
2024-09-02 15:07:05 INFO     evaluating now!
2024-09-02 15:07:06 INFO     Epoch [8/200] train_loss: 5.9562, val_loss: 6.2584, lr: 0.003000, 5.09s
2024-09-02 15:07:10 INFO     epoch complete!
2024-09-02 15:07:10 INFO     evaluating now!
2024-09-02 15:07:11 INFO     Epoch [9/200] train_loss: 5.7550, val_loss: 5.8645, lr: 0.003000, 5.07s
2024-09-02 15:07:11 INFO     Saved model at 9
2024-09-02 15:07:11 INFO     Val loss decrease from 6.0260 to 5.8645, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 15:07:16 INFO     epoch complete!
2024-09-02 15:07:16 INFO     evaluating now!
2024-09-02 15:07:16 INFO     Epoch [10/200] train_loss: 5.6036, val_loss: 5.7070, lr: 0.003000, 5.08s
2024-09-02 15:07:16 INFO     Saved model at 10
2024-09-02 15:07:16 INFO     Val loss decrease from 5.8645 to 5.7070, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 15:07:21 INFO     epoch complete!
2024-09-02 15:07:21 INFO     evaluating now!
2024-09-02 15:07:21 INFO     Epoch [11/200] train_loss: 5.4475, val_loss: 5.7295, lr: 0.003000, 5.08s
2024-09-02 15:07:26 INFO     epoch complete!
2024-09-02 15:07:26 INFO     evaluating now!
2024-09-02 15:07:26 INFO     Epoch [12/200] train_loss: 5.2825, val_loss: 5.5780, lr: 0.003000, 5.07s
2024-09-02 15:07:26 INFO     Saved model at 12
2024-09-02 15:07:26 INFO     Val loss decrease from 5.7070 to 5.5780, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 15:07:31 INFO     epoch complete!
2024-09-02 15:07:31 INFO     evaluating now!
2024-09-02 15:07:31 INFO     Epoch [13/200] train_loss: 5.2502, val_loss: 5.4767, lr: 0.003000, 5.07s
2024-09-02 15:07:31 INFO     Saved model at 13
2024-09-02 15:07:31 INFO     Val loss decrease from 5.5780 to 5.4767, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 15:07:36 INFO     epoch complete!
2024-09-02 15:07:36 INFO     evaluating now!
2024-09-02 15:07:36 INFO     Epoch [14/200] train_loss: 5.2029, val_loss: 5.5878, lr: 0.003000, 5.07s
2024-09-02 15:07:41 INFO     epoch complete!
2024-09-02 15:07:41 INFO     evaluating now!
2024-09-02 15:07:41 INFO     Epoch [15/200] train_loss: 5.0897, val_loss: 5.5491, lr: 0.003000, 5.07s
2024-09-02 15:07:46 INFO     epoch complete!
2024-09-02 15:07:46 INFO     evaluating now!
2024-09-02 15:07:46 INFO     Epoch [16/200] train_loss: 4.9840, val_loss: 5.7380, lr: 0.003000, 5.12s
2024-09-02 15:07:51 INFO     epoch complete!
2024-09-02 15:07:51 INFO     evaluating now!
2024-09-02 15:07:52 INFO     Epoch [17/200] train_loss: 4.9233, val_loss: 5.2318, lr: 0.003000, 5.22s
2024-09-02 15:07:52 INFO     Saved model at 17
2024-09-02 15:07:52 INFO     Val loss decrease from 5.4767 to 5.2318, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-02 15:07:57 INFO     epoch complete!
2024-09-02 15:07:57 INFO     evaluating now!
2024-09-02 15:07:57 INFO     Epoch [18/200] train_loss: 4.7716, val_loss: 5.2977, lr: 0.003000, 5.19s
2024-09-02 15:08:02 INFO     epoch complete!
2024-09-02 15:08:02 INFO     evaluating now!
2024-09-02 15:08:02 INFO     Epoch [19/200] train_loss: 4.7296, val_loss: 5.4387, lr: 0.003000, 5.23s
2024-09-02 15:08:07 INFO     epoch complete!
2024-09-02 15:08:07 INFO     evaluating now!
2024-09-02 15:08:07 INFO     Epoch [20/200] train_loss: 4.7109, val_loss: 5.3703, lr: 0.003000, 5.18s
2024-09-02 15:08:12 INFO     epoch complete!
2024-09-02 15:08:12 INFO     evaluating now!
2024-09-02 15:08:12 INFO     Epoch [21/200] train_loss: 4.6091, val_loss: 5.2963, lr: 0.003000, 5.25s
2024-09-02 15:08:17 INFO     epoch complete!
2024-09-02 15:08:17 INFO     evaluating now!
2024-09-02 15:08:18 INFO     Epoch [22/200] train_loss: 4.5230, val_loss: 5.1919, lr: 0.003000, 5.16s
2024-09-02 15:08:18 INFO     Saved model at 22
2024-09-02 15:08:18 INFO     Val loss decrease from 5.2318 to 5.1919, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-02 15:08:23 INFO     epoch complete!
2024-09-02 15:08:23 INFO     evaluating now!
2024-09-02 15:08:23 INFO     Epoch [23/200] train_loss: 4.5712, val_loss: 5.3615, lr: 0.003000, 5.16s
2024-09-02 15:08:28 INFO     epoch complete!
2024-09-02 15:08:28 INFO     evaluating now!
2024-09-02 15:08:28 INFO     Epoch [24/200] train_loss: 4.4854, val_loss: 5.3291, lr: 0.003000, 5.17s
2024-09-02 15:08:33 INFO     epoch complete!
2024-09-02 15:08:33 INFO     evaluating now!
2024-09-02 15:08:33 INFO     Epoch [25/200] train_loss: 4.4487, val_loss: 5.4628, lr: 0.003000, 5.16s
2024-09-02 15:08:38 INFO     epoch complete!
2024-09-02 15:08:38 INFO     evaluating now!
2024-09-02 15:08:38 INFO     Epoch [26/200] train_loss: 4.3844, val_loss: 5.1754, lr: 0.003000, 5.17s
2024-09-02 15:08:38 INFO     Saved model at 26
2024-09-02 15:08:38 INFO     Val loss decrease from 5.1919 to 5.1754, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-02 15:08:43 INFO     epoch complete!
2024-09-02 15:08:43 INFO     evaluating now!
2024-09-02 15:08:43 INFO     Epoch [27/200] train_loss: 4.3725, val_loss: 5.0711, lr: 0.003000, 5.14s
2024-09-02 15:08:43 INFO     Saved model at 27
2024-09-02 15:08:43 INFO     Val loss decrease from 5.1754 to 5.0711, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-02 15:08:48 INFO     epoch complete!
2024-09-02 15:08:48 INFO     evaluating now!
2024-09-02 15:08:49 INFO     Epoch [28/200] train_loss: 4.2752, val_loss: 5.3101, lr: 0.003000, 5.16s
2024-09-02 15:08:54 INFO     epoch complete!
2024-09-02 15:08:54 INFO     evaluating now!
2024-09-02 15:08:54 INFO     Epoch [29/200] train_loss: 4.2250, val_loss: 5.0282, lr: 0.003000, 5.18s
2024-09-02 15:08:54 INFO     Saved model at 29
2024-09-02 15:08:54 INFO     Val loss decrease from 5.0711 to 5.0282, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-02 15:08:59 INFO     epoch complete!
2024-09-02 15:08:59 INFO     evaluating now!
2024-09-02 15:08:59 INFO     Epoch [30/200] train_loss: 4.2459, val_loss: 5.0873, lr: 0.003000, 5.23s
2024-09-02 15:09:04 INFO     epoch complete!
2024-09-02 15:09:04 INFO     evaluating now!
2024-09-02 15:09:04 INFO     Epoch [31/200] train_loss: 4.1716, val_loss: 5.0949, lr: 0.003000, 5.35s
2024-09-02 15:09:09 INFO     epoch complete!
2024-09-02 15:09:09 INFO     evaluating now!
2024-09-02 15:09:10 INFO     Epoch [32/200] train_loss: 4.1338, val_loss: 5.1813, lr: 0.003000, 5.16s
2024-09-02 15:09:14 INFO     epoch complete!
2024-09-02 15:09:14 INFO     evaluating now!
2024-09-02 15:09:15 INFO     Epoch [33/200] train_loss: 4.1556, val_loss: 5.1035, lr: 0.003000, 5.12s
2024-09-02 15:09:20 INFO     epoch complete!
2024-09-02 15:09:20 INFO     evaluating now!
2024-09-02 15:09:20 INFO     Epoch [34/200] train_loss: 4.0640, val_loss: 5.1587, lr: 0.003000, 5.14s
2024-09-02 15:09:25 INFO     epoch complete!
2024-09-02 15:09:25 INFO     evaluating now!
2024-09-02 15:09:25 INFO     Epoch [35/200] train_loss: 4.0479, val_loss: 5.1430, lr: 0.003000, 5.13s
2024-09-02 15:09:30 INFO     epoch complete!
2024-09-02 15:09:30 INFO     evaluating now!
2024-09-02 15:09:30 INFO     Epoch [36/200] train_loss: 4.0167, val_loss: 5.1669, lr: 0.003000, 5.13s
2024-09-02 15:09:35 INFO     epoch complete!
2024-09-02 15:09:35 INFO     evaluating now!
2024-09-02 15:09:35 INFO     Epoch [37/200] train_loss: 3.9656, val_loss: 5.3469, lr: 0.003000, 5.17s
2024-09-02 15:09:40 INFO     epoch complete!
2024-09-02 15:09:40 INFO     evaluating now!
2024-09-02 15:09:40 INFO     Epoch [38/200] train_loss: 3.9687, val_loss: 5.1217, lr: 0.003000, 5.17s
2024-09-02 15:09:45 INFO     epoch complete!
2024-09-02 15:09:45 INFO     evaluating now!
2024-09-02 15:09:46 INFO     Epoch [39/200] train_loss: 3.9143, val_loss: 5.1472, lr: 0.003000, 5.16s
2024-09-02 15:09:50 INFO     epoch complete!
2024-09-02 15:09:50 INFO     evaluating now!
2024-09-02 15:09:51 INFO     Epoch [40/200] train_loss: 3.9067, val_loss: 5.1474, lr: 0.003000, 5.14s
2024-09-02 15:09:56 INFO     epoch complete!
2024-09-02 15:09:56 INFO     evaluating now!
2024-09-02 15:09:56 INFO     Epoch [41/200] train_loss: 3.9297, val_loss: 5.0641, lr: 0.003000, 5.17s
2024-09-02 15:10:01 INFO     epoch complete!
2024-09-02 15:10:01 INFO     evaluating now!
2024-09-02 15:10:01 INFO     Epoch [42/200] train_loss: 3.8305, val_loss: 5.0974, lr: 0.003000, 5.35s
2024-09-02 15:10:06 INFO     epoch complete!
2024-09-02 15:10:06 INFO     evaluating now!
2024-09-02 15:10:06 INFO     Epoch [43/200] train_loss: 3.8321, val_loss: 5.1642, lr: 0.003000, 5.22s
2024-09-02 15:10:11 INFO     epoch complete!
2024-09-02 15:10:11 INFO     evaluating now!
2024-09-02 15:10:12 INFO     Epoch [44/200] train_loss: 3.7869, val_loss: 5.1019, lr: 0.003000, 5.15s
2024-09-02 15:10:12 WARNING  Early stopping at epoch: 44
2024-09-02 15:10:12 INFO     Trained totally 45 epochs, average train time is 4.842s, average eval time is 0.308s
2024-09-02 15:10:12 INFO     Loaded model at 29
2024-09-02 15:10:12 INFO     Saved model at ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 15:10:12 INFO     Start evaluating ...
2024-09-02 15:10:13 INFO     Note that you select the single mode to evaluate!
2024-09-02 15:10:13 INFO     Evaluate result is saved at ./libcity/cache/65/evaluate_cache\2024_09_02_15_10_13_AGCRN_CHITaxi20190406.csv
2024-09-02 15:10:13 INFO     
         MAE       RMSE
1   2.583718   7.957664
2   2.641421   8.263863
3   2.790904   9.097749
4   2.892715   9.799798
5   3.003523  10.516284
6   3.041772  11.153554
7   3.154668  11.888911
8   3.214629  12.370789
9   3.320113  12.701231
10  3.384083  13.104537
11  3.534896  13.816423
12  3.681351  14.768489
2024-09-02 15:10:13 INFO     ----------------------------------------------------------------------------
2024-09-02 15:10:13 INFO     # 3, Kownledge Graph Embedding: RotatE, Experiment ids: 68
2024-09-02 15:10:13 INFO     ----------------------------------------------------------------------------
2024-09-02 15:10:13 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=65
2024-09-02 15:10:13 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 65, 'embedding_model': 'RotatE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 15:10:13 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 15:10:13 INFO     set_weight_link_or_dist: dist
2024-09-02 15:10:13 INFO     init_weight_inf_or_zero: inf
2024-09-02 15:10:13 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 15:10:13 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 15:10:13 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 15:10:13 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 15:10:14 INFO     Dataset created
2024-09-02 15:10:14 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 15:10:14 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 15:10:14 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 15:10:14 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 15:10:15 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 15:10:15 INFO     NormalScaler max: 3.5962860584259033
2024-09-02 15:10:17 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 15:10:17 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 15:10:17 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 15:10:17 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:10:17 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 15:10:17 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:10:17 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 15:10:17 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:10:17 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 15:10:17 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:10:17 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 15:10:17 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 15:10:17 INFO     Total parameter numbers: 874010
2024-09-02 15:10:17 INFO     You select `adam` optimizer.
2024-09-02 15:10:17 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 15:10:17 INFO     Start training ...
2024-09-02 15:10:17 INFO     num_batches:48
2024-09-02 15:10:22 INFO     epoch complete!
2024-09-02 15:10:22 INFO     evaluating now!
2024-09-02 15:10:22 INFO     Epoch [0/200] train_loss: 25.2936, val_loss: 17.4733, lr: 0.003000, 5.54s
2024-09-02 15:10:22 INFO     Saved model at 0
2024-09-02 15:10:22 INFO     Val loss decrease from inf to 17.4733, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 15:10:27 INFO     epoch complete!
2024-09-02 15:10:27 INFO     evaluating now!
2024-09-02 15:10:27 INFO     Epoch [1/200] train_loss: 14.2315, val_loss: 13.3265, lr: 0.003000, 5.14s
2024-09-02 15:10:27 INFO     Saved model at 1
2024-09-02 15:10:27 INFO     Val loss decrease from 17.4733 to 13.3265, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 15:10:32 INFO     epoch complete!
2024-09-02 15:10:32 INFO     evaluating now!
2024-09-02 15:10:32 INFO     Epoch [2/200] train_loss: 10.8602, val_loss: 10.0065, lr: 0.003000, 5.20s
2024-09-02 15:10:32 INFO     Saved model at 2
2024-09-02 15:10:32 INFO     Val loss decrease from 13.3265 to 10.0065, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 15:10:37 INFO     epoch complete!
2024-09-02 15:10:37 INFO     evaluating now!
2024-09-02 15:10:38 INFO     Epoch [3/200] train_loss: 8.8902, val_loss: 8.2341, lr: 0.003000, 5.15s
2024-09-02 15:10:38 INFO     Saved model at 3
2024-09-02 15:10:38 INFO     Val loss decrease from 10.0065 to 8.2341, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 15:10:42 INFO     epoch complete!
2024-09-02 15:10:42 INFO     evaluating now!
2024-09-02 15:10:43 INFO     Epoch [4/200] train_loss: 7.7250, val_loss: 7.6178, lr: 0.003000, 5.14s
2024-09-02 15:10:43 INFO     Saved model at 4
2024-09-02 15:10:43 INFO     Val loss decrease from 8.2341 to 7.6178, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 15:10:48 INFO     epoch complete!
2024-09-02 15:10:48 INFO     evaluating now!
2024-09-02 15:10:48 INFO     Epoch [5/200] train_loss: 7.0225, val_loss: 7.0226, lr: 0.003000, 5.16s
2024-09-02 15:10:48 INFO     Saved model at 5
2024-09-02 15:10:48 INFO     Val loss decrease from 7.6178 to 7.0226, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 15:10:53 INFO     epoch complete!
2024-09-02 15:10:53 INFO     evaluating now!
2024-09-02 15:10:53 INFO     Epoch [6/200] train_loss: 6.5334, val_loss: 6.3996, lr: 0.003000, 5.22s
2024-09-02 15:10:53 INFO     Saved model at 6
2024-09-02 15:10:53 INFO     Val loss decrease from 7.0226 to 6.3996, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 15:10:58 INFO     epoch complete!
2024-09-02 15:10:58 INFO     evaluating now!
2024-09-02 15:10:58 INFO     Epoch [7/200] train_loss: 6.2253, val_loss: 6.3954, lr: 0.003000, 5.16s
2024-09-02 15:10:58 INFO     Saved model at 7
2024-09-02 15:10:58 INFO     Val loss decrease from 6.3996 to 6.3954, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 15:11:03 INFO     epoch complete!
2024-09-02 15:11:03 INFO     evaluating now!
2024-09-02 15:11:04 INFO     Epoch [8/200] train_loss: 5.9342, val_loss: 6.1482, lr: 0.003000, 5.20s
2024-09-02 15:11:04 INFO     Saved model at 8
2024-09-02 15:11:04 INFO     Val loss decrease from 6.3954 to 6.1482, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 15:11:09 INFO     epoch complete!
2024-09-02 15:11:09 INFO     evaluating now!
2024-09-02 15:11:09 INFO     Epoch [9/200] train_loss: 5.6856, val_loss: 5.9634, lr: 0.003000, 5.27s
2024-09-02 15:11:09 INFO     Saved model at 9
2024-09-02 15:11:09 INFO     Val loss decrease from 6.1482 to 5.9634, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 15:11:14 INFO     epoch complete!
2024-09-02 15:11:14 INFO     evaluating now!
2024-09-02 15:11:14 INFO     Epoch [10/200] train_loss: 5.5905, val_loss: 5.9555, lr: 0.003000, 5.16s
2024-09-02 15:11:14 INFO     Saved model at 10
2024-09-02 15:11:14 INFO     Val loss decrease from 5.9634 to 5.9555, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 15:11:19 INFO     epoch complete!
2024-09-02 15:11:19 INFO     evaluating now!
2024-09-02 15:11:19 INFO     Epoch [11/200] train_loss: 5.4133, val_loss: 5.7864, lr: 0.003000, 5.15s
2024-09-02 15:11:19 INFO     Saved model at 11
2024-09-02 15:11:19 INFO     Val loss decrease from 5.9555 to 5.7864, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 15:11:24 INFO     epoch complete!
2024-09-02 15:11:24 INFO     evaluating now!
2024-09-02 15:11:24 INFO     Epoch [12/200] train_loss: 5.2137, val_loss: 5.5867, lr: 0.003000, 5.14s
2024-09-02 15:11:24 INFO     Saved model at 12
2024-09-02 15:11:24 INFO     Val loss decrease from 5.7864 to 5.5867, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 15:11:29 INFO     epoch complete!
2024-09-02 15:11:29 INFO     evaluating now!
2024-09-02 15:11:30 INFO     Epoch [13/200] train_loss: 5.1694, val_loss: 5.5274, lr: 0.003000, 5.13s
2024-09-02 15:11:30 INFO     Saved model at 13
2024-09-02 15:11:30 INFO     Val loss decrease from 5.5867 to 5.5274, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 15:11:34 INFO     epoch complete!
2024-09-02 15:11:34 INFO     evaluating now!
2024-09-02 15:11:35 INFO     Epoch [14/200] train_loss: 5.0688, val_loss: 5.6364, lr: 0.003000, 5.12s
2024-09-02 15:11:39 INFO     epoch complete!
2024-09-02 15:11:39 INFO     evaluating now!
2024-09-02 15:11:40 INFO     Epoch [15/200] train_loss: 4.9618, val_loss: 5.4359, lr: 0.003000, 5.15s
2024-09-02 15:11:40 INFO     Saved model at 15
2024-09-02 15:11:40 INFO     Val loss decrease from 5.5274 to 5.4359, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 15:11:45 INFO     epoch complete!
2024-09-02 15:11:45 INFO     evaluating now!
2024-09-02 15:11:45 INFO     Epoch [16/200] train_loss: 4.8861, val_loss: 5.3564, lr: 0.003000, 5.17s
2024-09-02 15:11:45 INFO     Saved model at 16
2024-09-02 15:11:45 INFO     Val loss decrease from 5.4359 to 5.3564, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 15:11:50 INFO     epoch complete!
2024-09-02 15:11:50 INFO     evaluating now!
2024-09-02 15:11:50 INFO     Epoch [17/200] train_loss: 4.7430, val_loss: 5.4131, lr: 0.003000, 5.16s
2024-09-02 15:11:55 INFO     epoch complete!
2024-09-02 15:11:55 INFO     evaluating now!
2024-09-02 15:11:55 INFO     Epoch [18/200] train_loss: 4.7078, val_loss: 5.4631, lr: 0.003000, 5.14s
2024-09-02 15:12:00 INFO     epoch complete!
2024-09-02 15:12:00 INFO     evaluating now!
2024-09-02 15:12:00 INFO     Epoch [19/200] train_loss: 4.6635, val_loss: 5.2171, lr: 0.003000, 5.16s
2024-09-02 15:12:00 INFO     Saved model at 19
2024-09-02 15:12:00 INFO     Val loss decrease from 5.3564 to 5.2171, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-02 15:12:05 INFO     epoch complete!
2024-09-02 15:12:05 INFO     evaluating now!
2024-09-02 15:12:06 INFO     Epoch [20/200] train_loss: 4.5630, val_loss: 5.2705, lr: 0.003000, 5.14s
2024-09-02 15:12:10 INFO     epoch complete!
2024-09-02 15:12:10 INFO     evaluating now!
2024-09-02 15:12:11 INFO     Epoch [21/200] train_loss: 4.5629, val_loss: 5.2679, lr: 0.003000, 5.13s
2024-09-02 15:12:16 INFO     epoch complete!
2024-09-02 15:12:16 INFO     evaluating now!
2024-09-02 15:12:16 INFO     Epoch [22/200] train_loss: 4.5736, val_loss: 5.1040, lr: 0.003000, 5.14s
2024-09-02 15:12:16 INFO     Saved model at 22
2024-09-02 15:12:16 INFO     Val loss decrease from 5.2171 to 5.1040, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-02 15:12:21 INFO     epoch complete!
2024-09-02 15:12:21 INFO     evaluating now!
2024-09-02 15:12:21 INFO     Epoch [23/200] train_loss: 4.4462, val_loss: 5.2733, lr: 0.003000, 5.15s
2024-09-02 15:12:26 INFO     epoch complete!
2024-09-02 15:12:26 INFO     evaluating now!
2024-09-02 15:12:26 INFO     Epoch [24/200] train_loss: 4.4130, val_loss: 5.1617, lr: 0.003000, 5.16s
2024-09-02 15:12:31 INFO     epoch complete!
2024-09-02 15:12:31 INFO     evaluating now!
2024-09-02 15:12:31 INFO     Epoch [25/200] train_loss: 4.3294, val_loss: 5.2432, lr: 0.003000, 5.14s
2024-09-02 15:12:36 INFO     epoch complete!
2024-09-02 15:12:36 INFO     evaluating now!
2024-09-02 15:12:36 INFO     Epoch [26/200] train_loss: 4.3048, val_loss: 5.1546, lr: 0.003000, 5.13s
2024-09-02 15:12:41 INFO     epoch complete!
2024-09-02 15:12:41 INFO     evaluating now!
2024-09-02 15:12:42 INFO     Epoch [27/200] train_loss: 4.2220, val_loss: 5.1873, lr: 0.003000, 5.17s
2024-09-02 15:12:47 INFO     epoch complete!
2024-09-02 15:12:47 INFO     evaluating now!
2024-09-02 15:12:47 INFO     Epoch [28/200] train_loss: 4.2241, val_loss: 5.3405, lr: 0.003000, 5.14s
2024-09-02 15:12:52 INFO     epoch complete!
2024-09-02 15:12:52 INFO     evaluating now!
2024-09-02 15:12:52 INFO     Epoch [29/200] train_loss: 4.1790, val_loss: 4.9896, lr: 0.003000, 5.20s
2024-09-02 15:12:52 INFO     Saved model at 29
2024-09-02 15:12:52 INFO     Val loss decrease from 5.1040 to 4.9896, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-02 15:12:57 INFO     epoch complete!
2024-09-02 15:12:57 INFO     evaluating now!
2024-09-02 15:12:57 INFO     Epoch [30/200] train_loss: 4.1171, val_loss: 5.1335, lr: 0.003000, 5.21s
2024-09-02 15:13:02 INFO     epoch complete!
2024-09-02 15:13:02 INFO     evaluating now!
2024-09-02 15:13:02 INFO     Epoch [31/200] train_loss: 4.0821, val_loss: 5.0795, lr: 0.003000, 5.13s
2024-09-02 15:13:07 INFO     epoch complete!
2024-09-02 15:13:07 INFO     evaluating now!
2024-09-02 15:13:07 INFO     Epoch [32/200] train_loss: 4.0185, val_loss: 5.0643, lr: 0.003000, 5.13s
2024-09-02 15:13:12 INFO     epoch complete!
2024-09-02 15:13:12 INFO     evaluating now!
2024-09-02 15:13:13 INFO     Epoch [33/200] train_loss: 3.9965, val_loss: 5.2664, lr: 0.003000, 5.13s
2024-09-02 15:13:17 INFO     epoch complete!
2024-09-02 15:13:17 INFO     evaluating now!
2024-09-02 15:13:18 INFO     Epoch [34/200] train_loss: 3.9649, val_loss: 5.0045, lr: 0.003000, 5.16s
2024-09-02 15:13:23 INFO     epoch complete!
2024-09-02 15:13:23 INFO     evaluating now!
2024-09-02 15:13:23 INFO     Epoch [35/200] train_loss: 3.9593, val_loss: 5.0404, lr: 0.003000, 5.13s
2024-09-02 15:13:28 INFO     epoch complete!
2024-09-02 15:13:28 INFO     evaluating now!
2024-09-02 15:13:28 INFO     Epoch [36/200] train_loss: 3.9233, val_loss: 5.0767, lr: 0.003000, 5.14s
2024-09-02 15:13:33 INFO     epoch complete!
2024-09-02 15:13:33 INFO     evaluating now!
2024-09-02 15:13:33 INFO     Epoch [37/200] train_loss: 3.8716, val_loss: 5.1971, lr: 0.003000, 5.13s
2024-09-02 15:13:38 INFO     epoch complete!
2024-09-02 15:13:38 INFO     evaluating now!
2024-09-02 15:13:38 INFO     Epoch [38/200] train_loss: 3.8633, val_loss: 5.0781, lr: 0.003000, 5.14s
2024-09-02 15:13:43 INFO     epoch complete!
2024-09-02 15:13:43 INFO     evaluating now!
2024-09-02 15:13:43 INFO     Epoch [39/200] train_loss: 3.8374, val_loss: 5.1025, lr: 0.003000, 5.14s
2024-09-02 15:13:48 INFO     epoch complete!
2024-09-02 15:13:48 INFO     evaluating now!
2024-09-02 15:13:49 INFO     Epoch [40/200] train_loss: 3.8638, val_loss: 5.1159, lr: 0.003000, 5.10s
2024-09-02 15:13:53 INFO     epoch complete!
2024-09-02 15:13:53 INFO     evaluating now!
2024-09-02 15:13:54 INFO     Epoch [41/200] train_loss: 3.7821, val_loss: 5.0829, lr: 0.003000, 5.10s
2024-09-02 15:13:58 INFO     epoch complete!
2024-09-02 15:13:58 INFO     evaluating now!
2024-09-02 15:13:59 INFO     Epoch [42/200] train_loss: 3.7485, val_loss: 5.0995, lr: 0.003000, 5.12s
2024-09-02 15:14:04 INFO     epoch complete!
2024-09-02 15:14:04 INFO     evaluating now!
2024-09-02 15:14:04 INFO     Epoch [43/200] train_loss: 3.7271, val_loss: 5.0511, lr: 0.003000, 5.12s
2024-09-02 15:14:09 INFO     epoch complete!
2024-09-02 15:14:09 INFO     evaluating now!
2024-09-02 15:14:09 INFO     Epoch [44/200] train_loss: 3.6861, val_loss: 5.1717, lr: 0.003000, 5.18s
2024-09-02 15:14:09 WARNING  Early stopping at epoch: 44
2024-09-02 15:14:09 INFO     Trained totally 45 epochs, average train time is 4.849s, average eval time is 0.311s
2024-09-02 15:14:09 INFO     Loaded model at 29
2024-09-02 15:14:09 INFO     Saved model at ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 15:14:09 INFO     Start evaluating ...
2024-09-02 15:14:10 INFO     Note that you select the single mode to evaluate!
2024-09-02 15:14:10 INFO     Evaluate result is saved at ./libcity/cache/65/evaluate_cache\2024_09_02_15_14_10_AGCRN_CHITaxi20190406.csv
2024-09-02 15:14:10 INFO     
         MAE       RMSE
1   2.452862   8.553998
2   2.556679   8.579106
3   2.712765   9.242162
4   2.806763   9.725574
5   2.871085  10.225566
6   2.977042  10.860773
7   3.067791  11.387675
8   3.118032  11.787598
9   3.129952  12.071781
10  3.172884  12.306334
11  3.321942  12.667963
12  3.422282  13.436012
2024-09-02 15:14:10 INFO     ----------------------------------------------------------------------------
2024-09-02 15:14:10 INFO     # 4, Kownledge Graph Embedding: RotatE, Experiment ids: 69
2024-09-02 15:14:10 INFO     ----------------------------------------------------------------------------
2024-09-02 15:14:10 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=65
2024-09-02 15:14:10 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 65, 'embedding_model': 'RotatE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 15:14:10 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 15:14:10 INFO     set_weight_link_or_dist: dist
2024-09-02 15:14:10 INFO     init_weight_inf_or_zero: inf
2024-09-02 15:14:10 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 15:14:10 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 15:14:10 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 15:14:10 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 15:14:12 INFO     Dataset created
2024-09-02 15:14:12 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 15:14:12 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 15:14:12 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 15:14:12 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 15:14:12 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 15:14:12 INFO     NormalScaler max: 3.5962860584259033
2024-09-02 15:14:14 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 15:14:14 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 15:14:14 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 15:14:14 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:14:14 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 15:14:14 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:14:14 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 15:14:14 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:14:14 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 15:14:14 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:14:14 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 15:14:14 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 15:14:14 INFO     Total parameter numbers: 874010
2024-09-02 15:14:14 INFO     You select `adam` optimizer.
2024-09-02 15:14:14 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 15:14:14 INFO     Start training ...
2024-09-02 15:14:14 INFO     num_batches:48
2024-09-02 15:14:19 INFO     epoch complete!
2024-09-02 15:14:19 INFO     evaluating now!
2024-09-02 15:14:19 INFO     Epoch [0/200] train_loss: 24.8496, val_loss: 17.6831, lr: 0.003000, 5.31s
2024-09-02 15:14:19 INFO     Saved model at 0
2024-09-02 15:14:19 INFO     Val loss decrease from inf to 17.6831, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 15:14:24 INFO     epoch complete!
2024-09-02 15:14:24 INFO     evaluating now!
2024-09-02 15:14:24 INFO     Epoch [1/200] train_loss: 14.0710, val_loss: 13.3717, lr: 0.003000, 5.18s
2024-09-02 15:14:24 INFO     Saved model at 1
2024-09-02 15:14:24 INFO     Val loss decrease from 17.6831 to 13.3717, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 15:14:29 INFO     epoch complete!
2024-09-02 15:14:29 INFO     evaluating now!
2024-09-02 15:14:30 INFO     Epoch [2/200] train_loss: 10.7645, val_loss: 10.1220, lr: 0.003000, 5.13s
2024-09-02 15:14:30 INFO     Saved model at 2
2024-09-02 15:14:30 INFO     Val loss decrease from 13.3717 to 10.1220, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 15:14:34 INFO     epoch complete!
2024-09-02 15:14:34 INFO     evaluating now!
2024-09-02 15:14:35 INFO     Epoch [3/200] train_loss: 8.6910, val_loss: 8.1091, lr: 0.003000, 5.14s
2024-09-02 15:14:35 INFO     Saved model at 3
2024-09-02 15:14:35 INFO     Val loss decrease from 10.1220 to 8.1091, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 15:14:40 INFO     epoch complete!
2024-09-02 15:14:40 INFO     evaluating now!
2024-09-02 15:14:40 INFO     Epoch [4/200] train_loss: 7.5399, val_loss: 7.3326, lr: 0.003000, 5.18s
2024-09-02 15:14:40 INFO     Saved model at 4
2024-09-02 15:14:40 INFO     Val loss decrease from 8.1091 to 7.3326, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 15:14:45 INFO     epoch complete!
2024-09-02 15:14:45 INFO     evaluating now!
2024-09-02 15:14:45 INFO     Epoch [5/200] train_loss: 6.8349, val_loss: 6.5978, lr: 0.003000, 5.20s
2024-09-02 15:14:45 INFO     Saved model at 5
2024-09-02 15:14:45 INFO     Val loss decrease from 7.3326 to 6.5978, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 15:14:50 INFO     epoch complete!
2024-09-02 15:14:50 INFO     evaluating now!
2024-09-02 15:14:50 INFO     Epoch [6/200] train_loss: 6.5296, val_loss: 6.3429, lr: 0.003000, 5.11s
2024-09-02 15:14:50 INFO     Saved model at 6
2024-09-02 15:14:50 INFO     Val loss decrease from 6.5978 to 6.3429, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 15:14:55 INFO     epoch complete!
2024-09-02 15:14:55 INFO     evaluating now!
2024-09-02 15:14:55 INFO     Epoch [7/200] train_loss: 6.0727, val_loss: 6.3661, lr: 0.003000, 5.13s
2024-09-02 15:15:00 INFO     epoch complete!
2024-09-02 15:15:00 INFO     evaluating now!
2024-09-02 15:15:01 INFO     Epoch [8/200] train_loss: 5.8414, val_loss: 6.0375, lr: 0.003000, 5.22s
2024-09-02 15:15:01 INFO     Saved model at 8
2024-09-02 15:15:01 INFO     Val loss decrease from 6.3429 to 6.0375, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 15:15:06 INFO     epoch complete!
2024-09-02 15:15:06 INFO     evaluating now!
2024-09-02 15:15:06 INFO     Epoch [9/200] train_loss: 5.6748, val_loss: 6.1696, lr: 0.003000, 5.17s
2024-09-02 15:15:11 INFO     epoch complete!
2024-09-02 15:15:11 INFO     evaluating now!
2024-09-02 15:15:11 INFO     Epoch [10/200] train_loss: 5.4836, val_loss: 5.5997, lr: 0.003000, 5.18s
2024-09-02 15:15:11 INFO     Saved model at 10
2024-09-02 15:15:11 INFO     Val loss decrease from 6.0375 to 5.5997, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 15:15:16 INFO     epoch complete!
2024-09-02 15:15:16 INFO     evaluating now!
2024-09-02 15:15:16 INFO     Epoch [11/200] train_loss: 5.3311, val_loss: 5.8399, lr: 0.003000, 5.15s
2024-09-02 15:15:21 INFO     epoch complete!
2024-09-02 15:15:21 INFO     evaluating now!
2024-09-02 15:15:21 INFO     Epoch [12/200] train_loss: 5.2823, val_loss: 5.7038, lr: 0.003000, 5.13s
2024-09-02 15:15:26 INFO     epoch complete!
2024-09-02 15:15:26 INFO     evaluating now!
2024-09-02 15:15:26 INFO     Epoch [13/200] train_loss: 5.1714, val_loss: 5.8140, lr: 0.003000, 5.15s
2024-09-02 15:15:31 INFO     epoch complete!
2024-09-02 15:15:31 INFO     evaluating now!
2024-09-02 15:15:32 INFO     Epoch [14/200] train_loss: 5.0441, val_loss: 5.6198, lr: 0.003000, 5.18s
2024-09-02 15:15:36 INFO     epoch complete!
2024-09-02 15:15:36 INFO     evaluating now!
2024-09-02 15:15:37 INFO     Epoch [15/200] train_loss: 5.0188, val_loss: 5.5173, lr: 0.003000, 5.14s
2024-09-02 15:15:37 INFO     Saved model at 15
2024-09-02 15:15:37 INFO     Val loss decrease from 5.5997 to 5.5173, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 15:15:42 INFO     epoch complete!
2024-09-02 15:15:42 INFO     evaluating now!
2024-09-02 15:15:42 INFO     Epoch [16/200] train_loss: 4.8520, val_loss: 5.5375, lr: 0.003000, 5.15s
2024-09-02 15:15:47 INFO     epoch complete!
2024-09-02 15:15:47 INFO     evaluating now!
2024-09-02 15:15:47 INFO     Epoch [17/200] train_loss: 4.8218, val_loss: 5.2796, lr: 0.003000, 5.18s
2024-09-02 15:15:47 INFO     Saved model at 17
2024-09-02 15:15:47 INFO     Val loss decrease from 5.5173 to 5.2796, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-02 15:15:52 INFO     epoch complete!
2024-09-02 15:15:52 INFO     evaluating now!
2024-09-02 15:15:52 INFO     Epoch [18/200] train_loss: 4.7562, val_loss: 5.1844, lr: 0.003000, 5.14s
2024-09-02 15:15:52 INFO     Saved model at 18
2024-09-02 15:15:52 INFO     Val loss decrease from 5.2796 to 5.1844, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-02 15:15:57 INFO     epoch complete!
2024-09-02 15:15:57 INFO     evaluating now!
2024-09-02 15:15:58 INFO     Epoch [19/200] train_loss: 4.6148, val_loss: 5.1749, lr: 0.003000, 5.20s
2024-09-02 15:15:58 INFO     Saved model at 19
2024-09-02 15:15:58 INFO     Val loss decrease from 5.1844 to 5.1749, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-02 15:16:02 INFO     epoch complete!
2024-09-02 15:16:02 INFO     evaluating now!
2024-09-02 15:16:03 INFO     Epoch [20/200] train_loss: 4.5775, val_loss: 5.3314, lr: 0.003000, 5.24s
2024-09-02 15:16:08 INFO     epoch complete!
2024-09-02 15:16:08 INFO     evaluating now!
2024-09-02 15:16:08 INFO     Epoch [21/200] train_loss: 4.5724, val_loss: 5.2461, lr: 0.003000, 5.21s
2024-09-02 15:16:13 INFO     epoch complete!
2024-09-02 15:16:13 INFO     evaluating now!
2024-09-02 15:16:13 INFO     Epoch [22/200] train_loss: 4.5849, val_loss: 5.1857, lr: 0.003000, 5.17s
2024-09-02 15:16:18 INFO     epoch complete!
2024-09-02 15:16:18 INFO     evaluating now!
2024-09-02 15:16:18 INFO     Epoch [23/200] train_loss: 4.4817, val_loss: 5.1994, lr: 0.003000, 5.14s
2024-09-02 15:16:23 INFO     epoch complete!
2024-09-02 15:16:23 INFO     evaluating now!
2024-09-02 15:16:23 INFO     Epoch [24/200] train_loss: 4.3873, val_loss: 5.3394, lr: 0.003000, 5.14s
2024-09-02 15:16:28 INFO     epoch complete!
2024-09-02 15:16:28 INFO     evaluating now!
2024-09-02 15:16:29 INFO     Epoch [25/200] train_loss: 4.3107, val_loss: 5.1605, lr: 0.003000, 5.18s
2024-09-02 15:16:29 INFO     Saved model at 25
2024-09-02 15:16:29 INFO     Val loss decrease from 5.1749 to 5.1605, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-02 15:16:34 INFO     epoch complete!
2024-09-02 15:16:34 INFO     evaluating now!
2024-09-02 15:16:34 INFO     Epoch [26/200] train_loss: 4.3736, val_loss: 5.1667, lr: 0.003000, 5.20s
2024-09-02 15:16:39 INFO     epoch complete!
2024-09-02 15:16:39 INFO     evaluating now!
2024-09-02 15:16:39 INFO     Epoch [27/200] train_loss: 4.3074, val_loss: 5.2186, lr: 0.003000, 5.15s
2024-09-02 15:16:44 INFO     epoch complete!
2024-09-02 15:16:44 INFO     evaluating now!
2024-09-02 15:16:44 INFO     Epoch [28/200] train_loss: 4.2082, val_loss: 4.9501, lr: 0.003000, 5.19s
2024-09-02 15:16:44 INFO     Saved model at 28
2024-09-02 15:16:44 INFO     Val loss decrease from 5.1605 to 4.9501, saving to ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-02 15:16:49 INFO     epoch complete!
2024-09-02 15:16:49 INFO     evaluating now!
2024-09-02 15:16:49 INFO     Epoch [29/200] train_loss: 4.1725, val_loss: 5.0964, lr: 0.003000, 5.16s
2024-09-02 15:16:54 INFO     epoch complete!
2024-09-02 15:16:54 INFO     evaluating now!
2024-09-02 15:16:55 INFO     Epoch [30/200] train_loss: 4.1847, val_loss: 5.1107, lr: 0.003000, 5.18s
2024-09-02 15:16:59 INFO     epoch complete!
2024-09-02 15:16:59 INFO     evaluating now!
2024-09-02 15:17:00 INFO     Epoch [31/200] train_loss: 4.1351, val_loss: 5.1078, lr: 0.003000, 5.15s
2024-09-02 15:17:05 INFO     epoch complete!
2024-09-02 15:17:05 INFO     evaluating now!
2024-09-02 15:17:05 INFO     Epoch [32/200] train_loss: 4.0867, val_loss: 5.0536, lr: 0.003000, 5.15s
2024-09-02 15:17:10 INFO     epoch complete!
2024-09-02 15:17:10 INFO     evaluating now!
2024-09-02 15:17:10 INFO     Epoch [33/200] train_loss: 4.0321, val_loss: 5.0254, lr: 0.003000, 5.15s
2024-09-02 15:17:15 INFO     epoch complete!
2024-09-02 15:17:15 INFO     evaluating now!
2024-09-02 15:17:15 INFO     Epoch [34/200] train_loss: 4.0258, val_loss: 4.9967, lr: 0.003000, 5.14s
2024-09-02 15:17:20 INFO     epoch complete!
2024-09-02 15:17:20 INFO     evaluating now!
2024-09-02 15:17:20 INFO     Epoch [35/200] train_loss: 3.9679, val_loss: 5.1929, lr: 0.003000, 5.17s
2024-09-02 15:17:25 INFO     epoch complete!
2024-09-02 15:17:25 INFO     evaluating now!
2024-09-02 15:17:25 INFO     Epoch [36/200] train_loss: 3.9498, val_loss: 5.2472, lr: 0.003000, 5.16s
2024-09-02 15:17:30 INFO     epoch complete!
2024-09-02 15:17:30 INFO     evaluating now!
2024-09-02 15:17:31 INFO     Epoch [37/200] train_loss: 3.9252, val_loss: 5.0053, lr: 0.003000, 5.15s
2024-09-02 15:17:35 INFO     epoch complete!
2024-09-02 15:17:35 INFO     evaluating now!
2024-09-02 15:17:36 INFO     Epoch [38/200] train_loss: 3.9513, val_loss: 5.1814, lr: 0.003000, 5.16s
2024-09-02 15:17:41 INFO     epoch complete!
2024-09-02 15:17:41 INFO     evaluating now!
2024-09-02 15:17:41 INFO     Epoch [39/200] train_loss: 3.8316, val_loss: 5.1620, lr: 0.003000, 5.18s
2024-09-02 15:17:46 INFO     epoch complete!
2024-09-02 15:17:46 INFO     evaluating now!
2024-09-02 15:17:46 INFO     Epoch [40/200] train_loss: 3.8672, val_loss: 5.0267, lr: 0.003000, 5.14s
2024-09-02 15:17:51 INFO     epoch complete!
2024-09-02 15:17:51 INFO     evaluating now!
2024-09-02 15:17:51 INFO     Epoch [41/200] train_loss: 3.8081, val_loss: 5.0019, lr: 0.003000, 5.15s
2024-09-02 15:17:56 INFO     epoch complete!
2024-09-02 15:17:56 INFO     evaluating now!
2024-09-02 15:17:56 INFO     Epoch [42/200] train_loss: 3.8103, val_loss: 5.0540, lr: 0.003000, 5.23s
2024-09-02 15:18:02 INFO     epoch complete!
2024-09-02 15:18:02 INFO     evaluating now!
2024-09-02 15:18:02 INFO     Epoch [43/200] train_loss: 3.7640, val_loss: 5.0281, lr: 0.003000, 5.44s
2024-09-02 15:18:02 WARNING  Early stopping at epoch: 43
2024-09-02 15:18:02 INFO     Trained totally 44 epochs, average train time is 4.861s, average eval time is 0.313s
2024-09-02 15:18:02 INFO     Loaded model at 28
2024-09-02 15:18:02 INFO     Saved model at ./libcity/cache/65/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 15:18:02 INFO     Start evaluating ...
2024-09-02 15:18:03 INFO     Note that you select the single mode to evaluate!
2024-09-02 15:18:03 INFO     Evaluate result is saved at ./libcity/cache/65/evaluate_cache\2024_09_02_15_18_03_AGCRN_CHITaxi20190406.csv
2024-09-02 15:18:03 INFO     
         MAE       RMSE
1   2.356634   7.336233
2   2.454255   7.755605
3   2.643848   8.635291
4   2.836551   9.469309
5   2.946431  10.158749
6   3.045412  10.780643
7   3.064528  11.455812
8   3.185092  11.995761
9   3.203249  12.423936
10  3.307638  12.700661
11  3.311718  13.130051
12  3.528314  13.591293
2024-09-02 15:18:03 INFO     ----------------------------------------------------------------------------
2024-09-02 15:18:03 INFO     Kownledge Graph Embedding: RotatE, Experiment ids: [65, 66, 67, 68, 69]
2024-09-02 15:18:03 INFO     ----------------------------------------------------------------------------
2024-09-02 15:18:03 INFO     Average: 
         MAE       RMSE
0   2.418853   7.584257
1   2.522761   8.005659
2   2.695395   8.935213
3   2.847747   9.768044
4   2.970828  10.658146
5   3.078806  11.506365
6   3.146041  12.268916
7   3.212901  12.798173
8   3.255080  13.096311
9   3.330158  13.317523
10  3.424685  13.672451
11  3.552687  14.222531 
2024-09-02 15:18:03 INFO     Standard deviation: 
         MAE      RMSE
0   0.091412  0.590171
1   0.068605  0.357381
2   0.053886  0.236184
3   0.049368  0.252218
4   0.064055  0.516863
5   0.074399  0.740912
6   0.073931  0.864898
7   0.069833  0.936955
8   0.077501  0.883265
9   0.085078  0.795884
10  0.091913  0.682084
11  0.086405  0.585245
2024-09-02 15:18:03 INFO     ----------------------------------------------------------------------------
2024-09-02 15:18:03 INFO     12 steps Average: 
        MAE       RMSE
0  3.037995  11.319466
2024-09-02 15:18:03 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.073866  0.620172
