2024-04-26 12:17:47 INFO     ----------------------------------------------------------------------------
2024-04-26 12:17:47 INFO     # 0, Kownledge Graph Embedding: MuRE, Experiment ids: 10
2024-04-26 12:17:47 INFO     ----------------------------------------------------------------------------
2024-04-26 12:17:48 INFO     Log directory: ./libcity/log
2024-04-26 12:17:48 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=10
2024-04-26 12:17:48 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 350831312, 'exp_id': 10, 'load_external': True, 'embedding_model': 'MuRE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-26 12:17:51 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-26 12:17:51 INFO     set_weight_link_or_dist: dist
2024-04-26 12:17:51 INFO     init_weight_inf_or_zero: inf
2024-04-26 12:17:51 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-26 12:17:51 INFO     Start Calculate the weight by Gauss kernel!
2024-04-26 12:17:51 INFO     Loading file CHITaxi20190406.dyna
2024-04-26 12:17:51 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-26 12:17:55 INFO     Dataset created
2024-04-26 12:17:55 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-26 12:17:55 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-26 12:17:55 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-26 12:17:55 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-26 12:17:55 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-26 12:17:55 INFO     NoneScaler
2024-04-26 12:18:07 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-26 12:18:07 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-26 12:18:07 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-26 12:18:07 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-26 12:18:07 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-26 12:18:07 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-26 12:18:07 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-26 12:18:07 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-26 12:18:07 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-26 12:18:07 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-26 12:18:07 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-26 12:18:07 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-26 12:18:07 INFO     Total parameter numbers: 874010
2024-04-26 12:18:07 INFO     You select `adam` optimizer.
2024-04-26 12:18:07 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-26 12:18:07 INFO     Start training ...
2024-04-26 12:18:07 INFO     num_batches:48
2024-04-26 12:18:14 INFO     epoch complete!
2024-04-26 12:18:14 INFO     evaluating now!
2024-04-26 12:18:14 INFO     Epoch [0/200] train_loss: 23.3021, val_loss: 18.5473, lr: 0.003000, 7.05s
2024-04-26 12:18:15 INFO     Saved model at 0
2024-04-26 12:18:15 INFO     Val loss decrease from inf to 18.5473, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-26 12:18:21 INFO     epoch complete!
2024-04-26 12:18:21 INFO     evaluating now!
2024-04-26 12:18:22 INFO     Epoch [1/200] train_loss: 14.7839, val_loss: 14.3697, lr: 0.003000, 7.09s
2024-04-26 12:18:22 INFO     Saved model at 1
2024-04-26 12:18:22 INFO     Val loss decrease from 18.5473 to 14.3697, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-26 12:18:28 INFO     epoch complete!
2024-04-26 12:18:28 INFO     evaluating now!
2024-04-26 12:18:28 INFO     Epoch [2/200] train_loss: 12.2386, val_loss: 11.5995, lr: 0.003000, 6.61s
2024-04-26 12:18:29 INFO     Saved model at 2
2024-04-26 12:18:29 INFO     Val loss decrease from 14.3697 to 11.5995, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-26 12:18:35 INFO     epoch complete!
2024-04-26 12:18:35 INFO     evaluating now!
2024-04-26 12:18:35 INFO     Epoch [3/200] train_loss: 9.8817, val_loss: 9.2689, lr: 0.003000, 6.55s
2024-04-26 12:18:36 INFO     Saved model at 3
2024-04-26 12:18:36 INFO     Val loss decrease from 11.5995 to 9.2689, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-26 12:18:42 INFO     epoch complete!
2024-04-26 12:18:42 INFO     evaluating now!
2024-04-26 12:18:42 INFO     Epoch [4/200] train_loss: 8.4501, val_loss: 8.1252, lr: 0.003000, 6.40s
2024-04-26 12:18:42 INFO     Saved model at 4
2024-04-26 12:18:42 INFO     Val loss decrease from 9.2689 to 8.1252, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-26 12:18:48 INFO     epoch complete!
2024-04-26 12:18:48 INFO     evaluating now!
2024-04-26 12:18:49 INFO     Epoch [5/200] train_loss: 7.6194, val_loss: 7.4880, lr: 0.003000, 6.53s
2024-04-26 12:18:49 INFO     Saved model at 5
2024-04-26 12:18:49 INFO     Val loss decrease from 8.1252 to 7.4880, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-26 12:18:55 INFO     epoch complete!
2024-04-26 12:18:55 INFO     evaluating now!
2024-04-26 12:18:55 INFO     Epoch [6/200] train_loss: 7.1147, val_loss: 7.0648, lr: 0.003000, 6.45s
2024-04-26 12:18:55 INFO     Saved model at 6
2024-04-26 12:18:55 INFO     Val loss decrease from 7.4880 to 7.0648, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-26 12:19:02 INFO     epoch complete!
2024-04-26 12:19:02 INFO     evaluating now!
2024-04-26 12:19:02 INFO     Epoch [7/200] train_loss: 6.7078, val_loss: 6.6299, lr: 0.003000, 6.60s
2024-04-26 12:19:02 INFO     Saved model at 7
2024-04-26 12:19:02 INFO     Val loss decrease from 7.0648 to 6.6299, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-26 12:19:08 INFO     epoch complete!
2024-04-26 12:19:08 INFO     evaluating now!
2024-04-26 12:19:09 INFO     Epoch [8/200] train_loss: 6.3787, val_loss: 6.7489, lr: 0.003000, 6.67s
2024-04-26 12:19:15 INFO     epoch complete!
2024-04-26 12:19:15 INFO     evaluating now!
2024-04-26 12:19:16 INFO     Epoch [9/200] train_loss: 6.1535, val_loss: 6.1899, lr: 0.003000, 7.01s
2024-04-26 12:19:16 INFO     Saved model at 9
2024-04-26 12:19:16 INFO     Val loss decrease from 6.6299 to 6.1899, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-26 12:19:23 INFO     epoch complete!
2024-04-26 12:19:23 INFO     evaluating now!
2024-04-26 12:19:23 INFO     Epoch [10/200] train_loss: 5.8367, val_loss: 5.9955, lr: 0.003000, 7.15s
2024-04-26 12:19:23 INFO     Saved model at 10
2024-04-26 12:19:23 INFO     Val loss decrease from 6.1899 to 5.9955, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-26 12:19:30 INFO     epoch complete!
2024-04-26 12:19:30 INFO     evaluating now!
2024-04-26 12:19:31 INFO     Epoch [11/200] train_loss: 5.7071, val_loss: 5.8971, lr: 0.003000, 7.04s
2024-04-26 12:19:31 INFO     Saved model at 11
2024-04-26 12:19:31 INFO     Val loss decrease from 5.9955 to 5.8971, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-26 12:19:37 INFO     epoch complete!
2024-04-26 12:19:37 INFO     evaluating now!
2024-04-26 12:19:38 INFO     Epoch [12/200] train_loss: 5.5998, val_loss: 5.9247, lr: 0.003000, 7.24s
2024-04-26 12:19:45 INFO     epoch complete!
2024-04-26 12:19:45 INFO     evaluating now!
2024-04-26 12:19:45 INFO     Epoch [13/200] train_loss: 5.3783, val_loss: 5.8286, lr: 0.003000, 7.16s
2024-04-26 12:19:45 INFO     Saved model at 13
2024-04-26 12:19:45 INFO     Val loss decrease from 5.8971 to 5.8286, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-26 12:19:52 INFO     epoch complete!
2024-04-26 12:19:52 INFO     evaluating now!
2024-04-26 12:19:52 INFO     Epoch [14/200] train_loss: 5.3423, val_loss: 5.6329, lr: 0.003000, 7.19s
2024-04-26 12:19:53 INFO     Saved model at 14
2024-04-26 12:19:53 INFO     Val loss decrease from 5.8286 to 5.6329, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-26 12:19:59 INFO     epoch complete!
2024-04-26 12:19:59 INFO     evaluating now!
2024-04-26 12:20:00 INFO     Epoch [15/200] train_loss: 5.1325, val_loss: 5.6035, lr: 0.003000, 7.17s
2024-04-26 12:20:00 INFO     Saved model at 15
2024-04-26 12:20:00 INFO     Val loss decrease from 5.6329 to 5.6035, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-26 12:20:06 INFO     epoch complete!
2024-04-26 12:20:06 INFO     evaluating now!
2024-04-26 12:20:07 INFO     Epoch [16/200] train_loss: 5.1613, val_loss: 5.6481, lr: 0.003000, 6.88s
2024-04-26 12:20:13 INFO     epoch complete!
2024-04-26 12:20:13 INFO     evaluating now!
2024-04-26 12:20:14 INFO     Epoch [17/200] train_loss: 5.0665, val_loss: 5.3969, lr: 0.003000, 6.70s
2024-04-26 12:20:14 INFO     Saved model at 17
2024-04-26 12:20:14 INFO     Val loss decrease from 5.6035 to 5.3969, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-26 12:20:20 INFO     epoch complete!
2024-04-26 12:20:20 INFO     evaluating now!
2024-04-26 12:20:21 INFO     Epoch [18/200] train_loss: 4.9274, val_loss: 5.3326, lr: 0.003000, 6.79s
2024-04-26 12:20:21 INFO     Saved model at 18
2024-04-26 12:20:21 INFO     Val loss decrease from 5.3969 to 5.3326, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-26 12:20:27 INFO     epoch complete!
2024-04-26 12:20:27 INFO     evaluating now!
2024-04-26 12:20:28 INFO     Epoch [19/200] train_loss: 4.8503, val_loss: 5.4666, lr: 0.003000, 7.06s
2024-04-26 12:20:34 INFO     epoch complete!
2024-04-26 12:20:34 INFO     evaluating now!
2024-04-26 12:20:35 INFO     Epoch [20/200] train_loss: 4.7653, val_loss: 5.3030, lr: 0.003000, 6.95s
2024-04-26 12:20:35 INFO     Saved model at 20
2024-04-26 12:20:35 INFO     Val loss decrease from 5.3326 to 5.3030, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-26 12:20:42 INFO     epoch complete!
2024-04-26 12:20:42 INFO     evaluating now!
2024-04-26 12:20:42 INFO     Epoch [21/200] train_loss: 4.7374, val_loss: 5.2404, lr: 0.003000, 7.04s
2024-04-26 12:20:42 INFO     Saved model at 21
2024-04-26 12:20:42 INFO     Val loss decrease from 5.3030 to 5.2404, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-26 12:20:49 INFO     epoch complete!
2024-04-26 12:20:49 INFO     evaluating now!
2024-04-26 12:20:49 INFO     Epoch [22/200] train_loss: 4.6585, val_loss: 5.2272, lr: 0.003000, 6.74s
2024-04-26 12:20:49 INFO     Saved model at 22
2024-04-26 12:20:49 INFO     Val loss decrease from 5.2404 to 5.2272, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-26 12:20:56 INFO     epoch complete!
2024-04-26 12:20:56 INFO     evaluating now!
2024-04-26 12:20:56 INFO     Epoch [23/200] train_loss: 4.5722, val_loss: 5.2265, lr: 0.003000, 7.16s
2024-04-26 12:20:57 INFO     Saved model at 23
2024-04-26 12:20:57 INFO     Val loss decrease from 5.2272 to 5.2265, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-26 12:21:03 INFO     epoch complete!
2024-04-26 12:21:03 INFO     evaluating now!
2024-04-26 12:21:03 INFO     Epoch [24/200] train_loss: 4.5580, val_loss: 5.2537, lr: 0.003000, 6.82s
2024-04-26 12:21:10 INFO     epoch complete!
2024-04-26 12:21:10 INFO     evaluating now!
2024-04-26 12:21:10 INFO     Epoch [25/200] train_loss: 4.6581, val_loss: 5.2195, lr: 0.003000, 6.63s
2024-04-26 12:21:10 INFO     Saved model at 25
2024-04-26 12:21:10 INFO     Val loss decrease from 5.2265 to 5.2195, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-26 12:21:17 INFO     epoch complete!
2024-04-26 12:21:17 INFO     evaluating now!
2024-04-26 12:21:17 INFO     Epoch [26/200] train_loss: 4.5035, val_loss: 5.3371, lr: 0.003000, 6.82s
2024-04-26 12:21:24 INFO     epoch complete!
2024-04-26 12:21:24 INFO     evaluating now!
2024-04-26 12:21:24 INFO     Epoch [27/200] train_loss: 4.4384, val_loss: 5.3009, lr: 0.003000, 7.36s
2024-04-26 12:21:31 INFO     epoch complete!
2024-04-26 12:21:31 INFO     evaluating now!
2024-04-26 12:21:31 INFO     Epoch [28/200] train_loss: 4.4520, val_loss: 5.3114, lr: 0.003000, 6.86s
2024-04-26 12:21:38 INFO     epoch complete!
2024-04-26 12:21:38 INFO     evaluating now!
2024-04-26 12:21:38 INFO     Epoch [29/200] train_loss: 4.3786, val_loss: 5.2380, lr: 0.003000, 6.82s
2024-04-26 12:21:45 INFO     epoch complete!
2024-04-26 12:21:45 INFO     evaluating now!
2024-04-26 12:21:45 INFO     Epoch [30/200] train_loss: 4.3304, val_loss: 5.1699, lr: 0.003000, 6.91s
2024-04-26 12:21:45 INFO     Saved model at 30
2024-04-26 12:21:45 INFO     Val loss decrease from 5.2195 to 5.1699, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-04-26 12:21:52 INFO     epoch complete!
2024-04-26 12:21:52 INFO     evaluating now!
2024-04-26 12:21:52 INFO     Epoch [31/200] train_loss: 4.2996, val_loss: 5.1682, lr: 0.003000, 6.90s
2024-04-26 12:21:52 INFO     Saved model at 31
2024-04-26 12:21:52 INFO     Val loss decrease from 5.1699 to 5.1682, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-04-26 12:21:59 INFO     epoch complete!
2024-04-26 12:21:59 INFO     evaluating now!
2024-04-26 12:21:59 INFO     Epoch [32/200] train_loss: 4.2315, val_loss: 5.1555, lr: 0.003000, 6.74s
2024-04-26 12:21:59 INFO     Saved model at 32
2024-04-26 12:21:59 INFO     Val loss decrease from 5.1682 to 5.1555, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-04-26 12:22:06 INFO     epoch complete!
2024-04-26 12:22:06 INFO     evaluating now!
2024-04-26 12:22:06 INFO     Epoch [33/200] train_loss: 4.2348, val_loss: 5.1430, lr: 0.003000, 7.06s
2024-04-26 12:22:06 INFO     Saved model at 33
2024-04-26 12:22:06 INFO     Val loss decrease from 5.1555 to 5.1430, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-04-26 12:22:13 INFO     epoch complete!
2024-04-26 12:22:13 INFO     evaluating now!
2024-04-26 12:22:14 INFO     Epoch [34/200] train_loss: 4.2349, val_loss: 5.2002, lr: 0.003000, 7.07s
2024-04-26 12:22:20 INFO     epoch complete!
2024-04-26 12:22:20 INFO     evaluating now!
2024-04-26 12:22:20 INFO     Epoch [35/200] train_loss: 4.1476, val_loss: 5.3227, lr: 0.003000, 6.78s
2024-04-26 12:22:27 INFO     epoch complete!
2024-04-26 12:22:27 INFO     evaluating now!
2024-04-26 12:22:27 INFO     Epoch [36/200] train_loss: 4.1290, val_loss: 5.1351, lr: 0.003000, 7.00s
2024-04-26 12:22:28 INFO     Saved model at 36
2024-04-26 12:22:28 INFO     Val loss decrease from 5.1430 to 5.1351, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-04-26 12:22:34 INFO     epoch complete!
2024-04-26 12:22:34 INFO     evaluating now!
2024-04-26 12:22:35 INFO     Epoch [37/200] train_loss: 4.0678, val_loss: 5.1320, lr: 0.003000, 7.09s
2024-04-26 12:22:35 INFO     Saved model at 37
2024-04-26 12:22:35 INFO     Val loss decrease from 5.1351 to 5.1320, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-04-26 12:22:41 INFO     epoch complete!
2024-04-26 12:22:41 INFO     evaluating now!
2024-04-26 12:22:41 INFO     Epoch [38/200] train_loss: 4.0674, val_loss: 5.1323, lr: 0.003000, 6.68s
2024-04-26 12:22:48 INFO     epoch complete!
2024-04-26 12:22:48 INFO     evaluating now!
2024-04-26 12:22:48 INFO     Epoch [39/200] train_loss: 4.1417, val_loss: 5.1441, lr: 0.003000, 6.80s
2024-04-26 12:22:55 INFO     epoch complete!
2024-04-26 12:22:55 INFO     evaluating now!
2024-04-26 12:22:55 INFO     Epoch [40/200] train_loss: 4.0387, val_loss: 5.1443, lr: 0.003000, 6.85s
2024-04-26 12:23:02 INFO     epoch complete!
2024-04-26 12:23:02 INFO     evaluating now!
2024-04-26 12:23:02 INFO     Epoch [41/200] train_loss: 4.0201, val_loss: 5.1468, lr: 0.003000, 6.91s
2024-04-26 12:23:08 INFO     epoch complete!
2024-04-26 12:23:08 INFO     evaluating now!
2024-04-26 12:23:09 INFO     Epoch [42/200] train_loss: 3.9924, val_loss: 5.2175, lr: 0.003000, 6.70s
2024-04-26 12:23:15 INFO     epoch complete!
2024-04-26 12:23:15 INFO     evaluating now!
2024-04-26 12:23:15 INFO     Epoch [43/200] train_loss: 3.9674, val_loss: 5.2507, lr: 0.003000, 6.68s
2024-04-26 12:23:22 INFO     epoch complete!
2024-04-26 12:23:22 INFO     evaluating now!
2024-04-26 12:23:22 INFO     Epoch [44/200] train_loss: 3.9586, val_loss: 5.2551, lr: 0.003000, 6.69s
2024-04-26 12:23:28 INFO     epoch complete!
2024-04-26 12:23:28 INFO     evaluating now!
2024-04-26 12:23:29 INFO     Epoch [45/200] train_loss: 3.9101, val_loss: 5.1388, lr: 0.003000, 6.85s
2024-04-26 12:23:35 INFO     epoch complete!
2024-04-26 12:23:35 INFO     evaluating now!
2024-04-26 12:23:36 INFO     Epoch [46/200] train_loss: 3.9042, val_loss: 5.3865, lr: 0.003000, 6.88s
2024-04-26 12:23:42 INFO     epoch complete!
2024-04-26 12:23:42 INFO     evaluating now!
2024-04-26 12:23:43 INFO     Epoch [47/200] train_loss: 3.8495, val_loss: 5.1127, lr: 0.003000, 6.82s
2024-04-26 12:23:43 INFO     Saved model at 47
2024-04-26 12:23:43 INFO     Val loss decrease from 5.1320 to 5.1127, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch47.tar
2024-04-26 12:23:49 INFO     epoch complete!
2024-04-26 12:23:49 INFO     evaluating now!
2024-04-26 12:23:49 INFO     Epoch [48/200] train_loss: 3.8186, val_loss: 5.0287, lr: 0.003000, 6.61s
2024-04-26 12:23:50 INFO     Saved model at 48
2024-04-26 12:23:50 INFO     Val loss decrease from 5.1127 to 5.0287, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-04-26 12:23:56 INFO     epoch complete!
2024-04-26 12:23:56 INFO     evaluating now!
2024-04-26 12:23:56 INFO     Epoch [49/200] train_loss: 3.8330, val_loss: 5.1212, lr: 0.003000, 6.91s
2024-04-26 12:24:03 INFO     epoch complete!
2024-04-26 12:24:03 INFO     evaluating now!
2024-04-26 12:24:03 INFO     Epoch [50/200] train_loss: 3.7679, val_loss: 5.0883, lr: 0.003000, 6.86s
2024-04-26 12:24:09 INFO     epoch complete!
2024-04-26 12:24:09 INFO     evaluating now!
2024-04-26 12:24:10 INFO     Epoch [51/200] train_loss: 3.7611, val_loss: 5.2586, lr: 0.003000, 6.50s
2024-04-26 12:24:16 INFO     epoch complete!
2024-04-26 12:24:16 INFO     evaluating now!
2024-04-26 12:24:16 INFO     Epoch [52/200] train_loss: 3.7846, val_loss: 5.2543, lr: 0.003000, 6.59s
2024-04-26 12:24:23 INFO     epoch complete!
2024-04-26 12:24:23 INFO     evaluating now!
2024-04-26 12:24:23 INFO     Epoch [53/200] train_loss: 3.7689, val_loss: 5.1747, lr: 0.003000, 6.72s
2024-04-26 12:24:29 INFO     epoch complete!
2024-04-26 12:24:29 INFO     evaluating now!
2024-04-26 12:24:30 INFO     Epoch [54/200] train_loss: 3.7257, val_loss: 5.3315, lr: 0.003000, 6.66s
2024-04-26 12:24:36 INFO     epoch complete!
2024-04-26 12:24:36 INFO     evaluating now!
2024-04-26 12:24:37 INFO     Epoch [55/200] train_loss: 3.7049, val_loss: 5.1854, lr: 0.003000, 6.90s
2024-04-26 12:24:43 INFO     epoch complete!
2024-04-26 12:24:43 INFO     evaluating now!
2024-04-26 12:24:43 INFO     Epoch [56/200] train_loss: 3.7311, val_loss: 5.2396, lr: 0.003000, 6.63s
2024-04-26 12:24:50 INFO     epoch complete!
2024-04-26 12:24:50 INFO     evaluating now!
2024-04-26 12:24:50 INFO     Epoch [57/200] train_loss: 3.6775, val_loss: 5.1742, lr: 0.003000, 6.86s
2024-04-26 12:24:56 INFO     epoch complete!
2024-04-26 12:24:56 INFO     evaluating now!
2024-04-26 12:24:57 INFO     Epoch [58/200] train_loss: 3.6892, val_loss: 5.1961, lr: 0.003000, 6.65s
2024-04-26 12:25:03 INFO     epoch complete!
2024-04-26 12:25:03 INFO     evaluating now!
2024-04-26 12:25:04 INFO     Epoch [59/200] train_loss: 3.6651, val_loss: 5.1079, lr: 0.003000, 6.98s
2024-04-26 12:25:10 INFO     epoch complete!
2024-04-26 12:25:10 INFO     evaluating now!
2024-04-26 12:25:11 INFO     Epoch [60/200] train_loss: 3.6057, val_loss: 5.2016, lr: 0.003000, 6.93s
2024-04-26 12:25:17 INFO     epoch complete!
2024-04-26 12:25:17 INFO     evaluating now!
2024-04-26 12:25:17 INFO     Epoch [61/200] train_loss: 3.6066, val_loss: 5.2547, lr: 0.003000, 6.66s
2024-04-26 12:25:24 INFO     epoch complete!
2024-04-26 12:25:24 INFO     evaluating now!
2024-04-26 12:25:24 INFO     Epoch [62/200] train_loss: 3.5751, val_loss: 5.1825, lr: 0.003000, 6.74s
2024-04-26 12:25:30 INFO     epoch complete!
2024-04-26 12:25:30 INFO     evaluating now!
2024-04-26 12:25:31 INFO     Epoch [63/200] train_loss: 3.6075, val_loss: 5.2978, lr: 0.003000, 6.66s
2024-04-26 12:25:31 WARNING  Early stopping at epoch: 63
2024-04-26 12:25:31 INFO     Trained totally 64 epochs, average train time is 6.375s, average eval time is 0.463s
2024-04-26 12:25:31 INFO     Loaded model at 48
2024-04-26 12:25:31 INFO     Saved model at ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406.m
2024-04-26 12:25:31 INFO     Start evaluating ...
2024-04-26 12:25:33 INFO     Note that you select the single mode to evaluate!
2024-04-26 12:25:34 INFO     Evaluate result is saved at ./libcity/cache/10/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-26 12:25:34 INFO     
         MAE       RMSE
1   2.331880   7.088035
2   2.411798   7.558222
3   2.625699   8.501297
4   2.682781   9.267799
5   2.828618  10.288681
6   3.001575  11.478879
7   3.133884  12.394968
8   3.219270  13.240546
9   3.264429  13.888906
10  3.345211  14.271297
11  3.402610  14.346916
12  3.501848  14.984091
2024-04-26 12:25:34 INFO     ----------------------------------------------------------------------------
2024-04-26 12:25:34 INFO     # 1, Kownledge Graph Embedding: MuRE, Experiment ids: 11
2024-04-26 12:25:34 INFO     ----------------------------------------------------------------------------
2024-04-26 12:25:35 INFO     Log directory: ./libcity/log
2024-04-26 12:25:35 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=11
2024-04-26 12:25:35 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 822606280, 'exp_id': 11, 'load_external': True, 'embedding_model': 'MuRE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-26 12:25:35 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-26 12:25:35 INFO     set_weight_link_or_dist: dist
2024-04-26 12:25:35 INFO     init_weight_inf_or_zero: inf
2024-04-26 12:25:35 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-26 12:25:35 INFO     Start Calculate the weight by Gauss kernel!
2024-04-26 12:25:36 INFO     Loading file CHITaxi20190406.dyna
2024-04-26 12:25:36 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-26 12:25:39 INFO     Dataset created
2024-04-26 12:25:39 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-26 12:25:39 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-26 12:25:39 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-26 12:25:39 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-26 12:25:39 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-26 12:25:39 INFO     NoneScaler
2024-04-26 12:25:42 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-26 12:25:42 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-26 12:25:42 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-26 12:25:42 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-26 12:25:42 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-26 12:25:42 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-26 12:25:42 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-26 12:25:42 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-26 12:25:42 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-26 12:25:42 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-26 12:25:42 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-26 12:25:42 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-26 12:25:42 INFO     Total parameter numbers: 874010
2024-04-26 12:25:42 INFO     You select `adam` optimizer.
2024-04-26 12:25:42 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-26 12:25:42 INFO     Start training ...
2024-04-26 12:25:42 INFO     num_batches:48
2024-04-26 12:25:48 INFO     epoch complete!
2024-04-26 12:25:48 INFO     evaluating now!
2024-04-26 12:25:49 INFO     Epoch [0/200] train_loss: 24.1755, val_loss: 18.1911, lr: 0.003000, 6.77s
2024-04-26 12:25:49 INFO     Saved model at 0
2024-04-26 12:25:49 INFO     Val loss decrease from inf to 18.1911, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-26 12:25:55 INFO     epoch complete!
2024-04-26 12:25:55 INFO     evaluating now!
2024-04-26 12:25:56 INFO     Epoch [1/200] train_loss: 14.9239, val_loss: 14.3061, lr: 0.003000, 6.74s
2024-04-26 12:25:56 INFO     Saved model at 1
2024-04-26 12:25:56 INFO     Val loss decrease from 18.1911 to 14.3061, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-26 12:26:03 INFO     epoch complete!
2024-04-26 12:26:03 INFO     evaluating now!
2024-04-26 12:26:03 INFO     Epoch [2/200] train_loss: 11.9539, val_loss: 11.5505, lr: 0.003000, 6.87s
2024-04-26 12:26:03 INFO     Saved model at 2
2024-04-26 12:26:03 INFO     Val loss decrease from 14.3061 to 11.5505, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-26 12:26:10 INFO     epoch complete!
2024-04-26 12:26:10 INFO     evaluating now!
2024-04-26 12:26:10 INFO     Epoch [3/200] train_loss: 9.8843, val_loss: 10.0401, lr: 0.003000, 6.86s
2024-04-26 12:26:10 INFO     Saved model at 3
2024-04-26 12:26:10 INFO     Val loss decrease from 11.5505 to 10.0401, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-26 12:26:17 INFO     epoch complete!
2024-04-26 12:26:17 INFO     evaluating now!
2024-04-26 12:26:17 INFO     Epoch [4/200] train_loss: 8.6294, val_loss: 8.2840, lr: 0.003000, 6.68s
2024-04-26 12:26:17 INFO     Saved model at 4
2024-04-26 12:26:17 INFO     Val loss decrease from 10.0401 to 8.2840, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-26 12:26:24 INFO     epoch complete!
2024-04-26 12:26:24 INFO     evaluating now!
2024-04-26 12:26:24 INFO     Epoch [5/200] train_loss: 7.7554, val_loss: 7.3160, lr: 0.003000, 6.80s
2024-04-26 12:26:24 INFO     Saved model at 5
2024-04-26 12:26:24 INFO     Val loss decrease from 8.2840 to 7.3160, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-26 12:26:31 INFO     epoch complete!
2024-04-26 12:26:31 INFO     evaluating now!
2024-04-26 12:26:31 INFO     Epoch [6/200] train_loss: 7.1558, val_loss: 6.9956, lr: 0.003000, 7.11s
2024-04-26 12:26:32 INFO     Saved model at 6
2024-04-26 12:26:32 INFO     Val loss decrease from 7.3160 to 6.9956, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-26 12:26:38 INFO     epoch complete!
2024-04-26 12:26:38 INFO     evaluating now!
2024-04-26 12:26:39 INFO     Epoch [7/200] train_loss: 6.7773, val_loss: 6.6955, lr: 0.003000, 6.87s
2024-04-26 12:26:39 INFO     Saved model at 7
2024-04-26 12:26:39 INFO     Val loss decrease from 6.9956 to 6.6955, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-26 12:26:45 INFO     epoch complete!
2024-04-26 12:26:45 INFO     evaluating now!
2024-04-26 12:26:46 INFO     Epoch [8/200] train_loss: 6.4700, val_loss: 6.4119, lr: 0.003000, 6.94s
2024-04-26 12:26:46 INFO     Saved model at 8
2024-04-26 12:26:46 INFO     Val loss decrease from 6.6955 to 6.4119, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-26 12:26:52 INFO     epoch complete!
2024-04-26 12:26:52 INFO     evaluating now!
2024-04-26 12:26:53 INFO     Epoch [9/200] train_loss: 6.3963, val_loss: 6.2920, lr: 0.003000, 6.93s
2024-04-26 12:26:53 INFO     Saved model at 9
2024-04-26 12:26:53 INFO     Val loss decrease from 6.4119 to 6.2920, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-26 12:26:59 INFO     epoch complete!
2024-04-26 12:26:59 INFO     evaluating now!
2024-04-26 12:27:00 INFO     Epoch [10/200] train_loss: 6.0204, val_loss: 6.1911, lr: 0.003000, 6.80s
2024-04-26 12:27:00 INFO     Saved model at 10
2024-04-26 12:27:00 INFO     Val loss decrease from 6.2920 to 6.1911, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-26 12:27:06 INFO     epoch complete!
2024-04-26 12:27:06 INFO     evaluating now!
2024-04-26 12:27:07 INFO     Epoch [11/200] train_loss: 5.9374, val_loss: 6.0505, lr: 0.003000, 6.77s
2024-04-26 12:27:07 INFO     Saved model at 11
2024-04-26 12:27:07 INFO     Val loss decrease from 6.1911 to 6.0505, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-26 12:27:13 INFO     epoch complete!
2024-04-26 12:27:13 INFO     evaluating now!
2024-04-26 12:27:14 INFO     Epoch [12/200] train_loss: 5.7546, val_loss: 6.0114, lr: 0.003000, 6.75s
2024-04-26 12:27:14 INFO     Saved model at 12
2024-04-26 12:27:14 INFO     Val loss decrease from 6.0505 to 6.0114, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-26 12:27:20 INFO     epoch complete!
2024-04-26 12:27:20 INFO     evaluating now!
2024-04-26 12:27:21 INFO     Epoch [13/200] train_loss: 5.5590, val_loss: 5.9462, lr: 0.003000, 6.62s
2024-04-26 12:27:21 INFO     Saved model at 13
2024-04-26 12:27:21 INFO     Val loss decrease from 6.0114 to 5.9462, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-26 12:27:27 INFO     epoch complete!
2024-04-26 12:27:27 INFO     evaluating now!
2024-04-26 12:27:28 INFO     Epoch [14/200] train_loss: 5.4683, val_loss: 5.8058, lr: 0.003000, 6.72s
2024-04-26 12:27:28 INFO     Saved model at 14
2024-04-26 12:27:28 INFO     Val loss decrease from 5.9462 to 5.8058, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-26 12:27:34 INFO     epoch complete!
2024-04-26 12:27:34 INFO     evaluating now!
2024-04-26 12:27:35 INFO     Epoch [15/200] train_loss: 5.3241, val_loss: 5.7118, lr: 0.003000, 6.94s
2024-04-26 12:27:35 INFO     Saved model at 15
2024-04-26 12:27:35 INFO     Val loss decrease from 5.8058 to 5.7118, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-26 12:27:41 INFO     epoch complete!
2024-04-26 12:27:41 INFO     evaluating now!
2024-04-26 12:27:42 INFO     Epoch [16/200] train_loss: 5.2795, val_loss: 6.0396, lr: 0.003000, 6.87s
2024-04-26 12:27:48 INFO     epoch complete!
2024-04-26 12:27:48 INFO     evaluating now!
2024-04-26 12:27:49 INFO     Epoch [17/200] train_loss: 5.2358, val_loss: 5.6280, lr: 0.003000, 6.85s
2024-04-26 12:27:49 INFO     Saved model at 17
2024-04-26 12:27:49 INFO     Val loss decrease from 5.7118 to 5.6280, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-26 12:27:55 INFO     epoch complete!
2024-04-26 12:27:55 INFO     evaluating now!
2024-04-26 12:27:56 INFO     Epoch [18/200] train_loss: 5.0649, val_loss: 5.6398, lr: 0.003000, 6.91s
2024-04-26 12:28:02 INFO     epoch complete!
2024-04-26 12:28:02 INFO     evaluating now!
2024-04-26 12:28:03 INFO     Epoch [19/200] train_loss: 5.0716, val_loss: 5.5139, lr: 0.003000, 6.94s
2024-04-26 12:28:03 INFO     Saved model at 19
2024-04-26 12:28:03 INFO     Val loss decrease from 5.6280 to 5.5139, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-26 12:28:09 INFO     epoch complete!
2024-04-26 12:28:09 INFO     evaluating now!
2024-04-26 12:28:10 INFO     Epoch [20/200] train_loss: 4.9408, val_loss: 5.3375, lr: 0.003000, 6.77s
2024-04-26 12:28:10 INFO     Saved model at 20
2024-04-26 12:28:10 INFO     Val loss decrease from 5.5139 to 5.3375, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-26 12:28:17 INFO     epoch complete!
2024-04-26 12:28:17 INFO     evaluating now!
2024-04-26 12:28:17 INFO     Epoch [21/200] train_loss: 4.8731, val_loss: 5.4708, lr: 0.003000, 6.85s
2024-04-26 12:28:23 INFO     epoch complete!
2024-04-26 12:28:23 INFO     evaluating now!
2024-04-26 12:28:24 INFO     Epoch [22/200] train_loss: 4.8433, val_loss: 5.2880, lr: 0.003000, 6.61s
2024-04-26 12:28:24 INFO     Saved model at 22
2024-04-26 12:28:24 INFO     Val loss decrease from 5.3375 to 5.2880, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-26 12:28:30 INFO     epoch complete!
2024-04-26 12:28:30 INFO     evaluating now!
2024-04-26 12:28:30 INFO     Epoch [23/200] train_loss: 4.8009, val_loss: 5.4073, lr: 0.003000, 6.65s
2024-04-26 12:28:37 INFO     epoch complete!
2024-04-26 12:28:37 INFO     evaluating now!
2024-04-26 12:28:37 INFO     Epoch [24/200] train_loss: 4.7214, val_loss: 5.3282, lr: 0.003000, 6.93s
2024-04-26 12:28:44 INFO     epoch complete!
2024-04-26 12:28:44 INFO     evaluating now!
2024-04-26 12:28:44 INFO     Epoch [25/200] train_loss: 4.6276, val_loss: 5.2680, lr: 0.003000, 6.84s
2024-04-26 12:28:44 INFO     Saved model at 25
2024-04-26 12:28:44 INFO     Val loss decrease from 5.2880 to 5.2680, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-26 12:28:51 INFO     epoch complete!
2024-04-26 12:28:51 INFO     evaluating now!
2024-04-26 12:28:51 INFO     Epoch [26/200] train_loss: 4.6198, val_loss: 5.0990, lr: 0.003000, 6.64s
2024-04-26 12:28:51 INFO     Saved model at 26
2024-04-26 12:28:51 INFO     Val loss decrease from 5.2680 to 5.0990, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-04-26 12:28:58 INFO     epoch complete!
2024-04-26 12:28:58 INFO     evaluating now!
2024-04-26 12:28:58 INFO     Epoch [27/200] train_loss: 4.5695, val_loss: 5.3938, lr: 0.003000, 6.73s
2024-04-26 12:29:04 INFO     epoch complete!
2024-04-26 12:29:04 INFO     evaluating now!
2024-04-26 12:29:05 INFO     Epoch [28/200] train_loss: 4.5462, val_loss: 5.2827, lr: 0.003000, 6.57s
2024-04-26 12:29:11 INFO     epoch complete!
2024-04-26 12:29:11 INFO     evaluating now!
2024-04-26 12:29:11 INFO     Epoch [29/200] train_loss: 4.4088, val_loss: 5.2219, lr: 0.003000, 6.43s
2024-04-26 12:29:17 INFO     epoch complete!
2024-04-26 12:29:17 INFO     evaluating now!
2024-04-26 12:29:17 INFO     Epoch [30/200] train_loss: 4.4634, val_loss: 5.2160, lr: 0.003000, 6.28s
2024-04-26 12:29:23 INFO     epoch complete!
2024-04-26 12:29:23 INFO     evaluating now!
2024-04-26 12:29:24 INFO     Epoch [31/200] train_loss: 4.4574, val_loss: 5.2306, lr: 0.003000, 6.49s
2024-04-26 12:29:30 INFO     epoch complete!
2024-04-26 12:29:30 INFO     evaluating now!
2024-04-26 12:29:30 INFO     Epoch [32/200] train_loss: 4.3701, val_loss: 5.2673, lr: 0.003000, 6.43s
2024-04-26 12:29:36 INFO     epoch complete!
2024-04-26 12:29:36 INFO     evaluating now!
2024-04-26 12:29:37 INFO     Epoch [33/200] train_loss: 4.3963, val_loss: 5.3537, lr: 0.003000, 6.36s
2024-04-26 12:29:43 INFO     epoch complete!
2024-04-26 12:29:43 INFO     evaluating now!
2024-04-26 12:29:43 INFO     Epoch [34/200] train_loss: 4.3245, val_loss: 5.2676, lr: 0.003000, 6.49s
2024-04-26 12:29:49 INFO     epoch complete!
2024-04-26 12:29:49 INFO     evaluating now!
2024-04-26 12:29:50 INFO     Epoch [35/200] train_loss: 4.3723, val_loss: 5.2507, lr: 0.003000, 6.37s
2024-04-26 12:29:56 INFO     epoch complete!
2024-04-26 12:29:56 INFO     evaluating now!
2024-04-26 12:29:56 INFO     Epoch [36/200] train_loss: 4.2427, val_loss: 5.0678, lr: 0.003000, 6.41s
2024-04-26 12:29:56 INFO     Saved model at 36
2024-04-26 12:29:56 INFO     Val loss decrease from 5.0990 to 5.0678, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-04-26 12:30:02 INFO     epoch complete!
2024-04-26 12:30:02 INFO     evaluating now!
2024-04-26 12:30:03 INFO     Epoch [37/200] train_loss: 4.1803, val_loss: 5.1647, lr: 0.003000, 6.69s
2024-04-26 12:30:09 INFO     epoch complete!
2024-04-26 12:30:09 INFO     evaluating now!
2024-04-26 12:30:09 INFO     Epoch [38/200] train_loss: 4.1286, val_loss: 5.3134, lr: 0.003000, 6.45s
2024-04-26 12:30:15 INFO     epoch complete!
2024-04-26 12:30:15 INFO     evaluating now!
2024-04-26 12:30:16 INFO     Epoch [39/200] train_loss: 4.1506, val_loss: 5.2942, lr: 0.003000, 6.37s
2024-04-26 12:30:22 INFO     epoch complete!
2024-04-26 12:30:22 INFO     evaluating now!
2024-04-26 12:30:22 INFO     Epoch [40/200] train_loss: 4.1421, val_loss: 5.0456, lr: 0.003000, 6.38s
2024-04-26 12:30:22 INFO     Saved model at 40
2024-04-26 12:30:22 INFO     Val loss decrease from 5.0678 to 5.0456, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-04-26 12:30:28 INFO     epoch complete!
2024-04-26 12:30:28 INFO     evaluating now!
2024-04-26 12:30:29 INFO     Epoch [41/200] train_loss: 4.0922, val_loss: 5.2271, lr: 0.003000, 6.33s
2024-04-26 12:30:35 INFO     epoch complete!
2024-04-26 12:30:35 INFO     evaluating now!
2024-04-26 12:30:35 INFO     Epoch [42/200] train_loss: 4.0628, val_loss: 5.3008, lr: 0.003000, 6.40s
2024-04-26 12:30:41 INFO     epoch complete!
2024-04-26 12:30:41 INFO     evaluating now!
2024-04-26 12:30:42 INFO     Epoch [43/200] train_loss: 4.0250, val_loss: 5.1897, lr: 0.003000, 6.50s
2024-04-26 12:30:48 INFO     epoch complete!
2024-04-26 12:30:48 INFO     evaluating now!
2024-04-26 12:30:48 INFO     Epoch [44/200] train_loss: 4.0140, val_loss: 5.0030, lr: 0.003000, 6.56s
2024-04-26 12:30:48 INFO     Saved model at 44
2024-04-26 12:30:48 INFO     Val loss decrease from 5.0456 to 5.0030, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-04-26 12:30:55 INFO     epoch complete!
2024-04-26 12:30:55 INFO     evaluating now!
2024-04-26 12:30:55 INFO     Epoch [45/200] train_loss: 3.9644, val_loss: 5.0186, lr: 0.003000, 6.80s
2024-04-26 12:31:01 INFO     epoch complete!
2024-04-26 12:31:01 INFO     evaluating now!
2024-04-26 12:31:02 INFO     Epoch [46/200] train_loss: 3.9653, val_loss: 5.1346, lr: 0.003000, 6.66s
2024-04-26 12:31:08 INFO     epoch complete!
2024-04-26 12:31:08 INFO     evaluating now!
2024-04-26 12:31:08 INFO     Epoch [47/200] train_loss: 3.9430, val_loss: 5.1844, lr: 0.003000, 6.58s
2024-04-26 12:31:15 INFO     epoch complete!
2024-04-26 12:31:15 INFO     evaluating now!
2024-04-26 12:31:15 INFO     Epoch [48/200] train_loss: 3.8588, val_loss: 5.1099, lr: 0.003000, 6.63s
2024-04-26 12:31:21 INFO     epoch complete!
2024-04-26 12:31:21 INFO     evaluating now!
2024-04-26 12:31:22 INFO     Epoch [49/200] train_loss: 3.8513, val_loss: 5.2949, lr: 0.003000, 6.50s
2024-04-26 12:31:28 INFO     epoch complete!
2024-04-26 12:31:28 INFO     evaluating now!
2024-04-26 12:31:28 INFO     Epoch [50/200] train_loss: 3.8902, val_loss: 5.1073, lr: 0.003000, 6.83s
2024-04-26 12:31:35 INFO     epoch complete!
2024-04-26 12:31:35 INFO     evaluating now!
2024-04-26 12:31:35 INFO     Epoch [51/200] train_loss: 3.8914, val_loss: 5.2847, lr: 0.003000, 7.07s
2024-04-26 12:31:42 INFO     epoch complete!
2024-04-26 12:31:42 INFO     evaluating now!
2024-04-26 12:31:42 INFO     Epoch [52/200] train_loss: 3.8388, val_loss: 5.0601, lr: 0.003000, 6.72s
2024-04-26 12:31:48 INFO     epoch complete!
2024-04-26 12:31:48 INFO     evaluating now!
2024-04-26 12:31:49 INFO     Epoch [53/200] train_loss: 3.8258, val_loss: 5.1129, lr: 0.003000, 6.64s
2024-04-26 12:31:55 INFO     epoch complete!
2024-04-26 12:31:55 INFO     evaluating now!
2024-04-26 12:31:56 INFO     Epoch [54/200] train_loss: 3.8429, val_loss: 4.9935, lr: 0.003000, 6.73s
2024-04-26 12:31:56 INFO     Saved model at 54
2024-04-26 12:31:56 INFO     Val loss decrease from 5.0030 to 4.9935, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch54.tar
2024-04-26 12:32:02 INFO     epoch complete!
2024-04-26 12:32:02 INFO     evaluating now!
2024-04-26 12:32:02 INFO     Epoch [55/200] train_loss: 3.7469, val_loss: 5.0872, lr: 0.003000, 6.69s
2024-04-26 12:32:09 INFO     epoch complete!
2024-04-26 12:32:09 INFO     evaluating now!
2024-04-26 12:32:09 INFO     Epoch [56/200] train_loss: 3.7448, val_loss: 4.9911, lr: 0.003000, 6.59s
2024-04-26 12:32:09 INFO     Saved model at 56
2024-04-26 12:32:09 INFO     Val loss decrease from 4.9935 to 4.9911, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch56.tar
2024-04-26 12:32:15 INFO     epoch complete!
2024-04-26 12:32:15 INFO     evaluating now!
2024-04-26 12:32:16 INFO     Epoch [57/200] train_loss: 3.7168, val_loss: 5.2128, lr: 0.003000, 6.59s
2024-04-26 12:32:22 INFO     epoch complete!
2024-04-26 12:32:22 INFO     evaluating now!
2024-04-26 12:32:23 INFO     Epoch [58/200] train_loss: 3.7530, val_loss: 5.1427, lr: 0.003000, 6.66s
2024-04-26 12:32:29 INFO     epoch complete!
2024-04-26 12:32:29 INFO     evaluating now!
2024-04-26 12:32:29 INFO     Epoch [59/200] train_loss: 3.7559, val_loss: 5.0422, lr: 0.003000, 6.45s
2024-04-26 12:32:35 INFO     epoch complete!
2024-04-26 12:32:35 INFO     evaluating now!
2024-04-26 12:32:36 INFO     Epoch [60/200] train_loss: 3.7066, val_loss: 5.0924, lr: 0.003000, 6.59s
2024-04-26 12:32:42 INFO     epoch complete!
2024-04-26 12:32:42 INFO     evaluating now!
2024-04-26 12:32:42 INFO     Epoch [61/200] train_loss: 3.6785, val_loss: 4.9965, lr: 0.003000, 6.63s
2024-04-26 12:32:49 INFO     epoch complete!
2024-04-26 12:32:49 INFO     evaluating now!
2024-04-26 12:32:49 INFO     Epoch [62/200] train_loss: 3.6701, val_loss: 5.0606, lr: 0.003000, 7.04s
2024-04-26 12:32:56 INFO     epoch complete!
2024-04-26 12:32:56 INFO     evaluating now!
2024-04-26 12:32:56 INFO     Epoch [63/200] train_loss: 3.7035, val_loss: 5.1232, lr: 0.003000, 6.88s
2024-04-26 12:33:03 INFO     epoch complete!
2024-04-26 12:33:03 INFO     evaluating now!
2024-04-26 12:33:03 INFO     Epoch [64/200] train_loss: 3.5833, val_loss: 5.0241, lr: 0.003000, 7.04s
2024-04-26 12:33:10 INFO     epoch complete!
2024-04-26 12:33:10 INFO     evaluating now!
2024-04-26 12:33:10 INFO     Epoch [65/200] train_loss: 3.5781, val_loss: 5.0892, lr: 0.003000, 6.93s
2024-04-26 12:33:16 INFO     epoch complete!
2024-04-26 12:33:16 INFO     evaluating now!
2024-04-26 12:33:17 INFO     Epoch [66/200] train_loss: 3.5369, val_loss: 5.1269, lr: 0.003000, 6.86s
2024-04-26 12:33:24 INFO     epoch complete!
2024-04-26 12:33:24 INFO     evaluating now!
2024-04-26 12:33:24 INFO     Epoch [67/200] train_loss: 3.5598, val_loss: 5.0431, lr: 0.003000, 7.31s
2024-04-26 12:33:31 INFO     epoch complete!
2024-04-26 12:33:31 INFO     evaluating now!
2024-04-26 12:33:32 INFO     Epoch [68/200] train_loss: 3.5984, val_loss: 5.1232, lr: 0.003000, 7.51s
2024-04-26 12:33:39 INFO     epoch complete!
2024-04-26 12:33:39 INFO     evaluating now!
2024-04-26 12:33:39 INFO     Epoch [69/200] train_loss: 3.6905, val_loss: 4.9389, lr: 0.003000, 7.61s
2024-04-26 12:33:40 INFO     Saved model at 69
2024-04-26 12:33:40 INFO     Val loss decrease from 4.9911 to 4.9389, saving to ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406_epoch69.tar
2024-04-26 12:33:46 INFO     epoch complete!
2024-04-26 12:33:46 INFO     evaluating now!
2024-04-26 12:33:47 INFO     Epoch [70/200] train_loss: 3.5111, val_loss: 5.2622, lr: 0.003000, 7.03s
2024-04-26 12:33:53 INFO     epoch complete!
2024-04-26 12:33:53 INFO     evaluating now!
2024-04-26 12:33:54 INFO     Epoch [71/200] train_loss: 3.4791, val_loss: 5.0512, lr: 0.003000, 6.95s
2024-04-26 12:34:00 INFO     epoch complete!
2024-04-26 12:34:00 INFO     evaluating now!
2024-04-26 12:34:01 INFO     Epoch [72/200] train_loss: 3.4687, val_loss: 5.1855, lr: 0.003000, 7.07s
2024-04-26 12:34:07 INFO     epoch complete!
2024-04-26 12:34:07 INFO     evaluating now!
2024-04-26 12:34:08 INFO     Epoch [73/200] train_loss: 3.5666, val_loss: 5.2480, lr: 0.003000, 7.02s
2024-04-26 12:34:14 INFO     epoch complete!
2024-04-26 12:34:14 INFO     evaluating now!
2024-04-26 12:34:15 INFO     Epoch [74/200] train_loss: 3.5394, val_loss: 5.0933, lr: 0.003000, 7.04s
2024-04-26 12:34:21 INFO     epoch complete!
2024-04-26 12:34:21 INFO     evaluating now!
2024-04-26 12:34:22 INFO     Epoch [75/200] train_loss: 3.4648, val_loss: 5.0678, lr: 0.003000, 6.93s
2024-04-26 12:34:28 INFO     epoch complete!
2024-04-26 12:34:28 INFO     evaluating now!
2024-04-26 12:34:29 INFO     Epoch [76/200] train_loss: 3.4625, val_loss: 5.1363, lr: 0.003000, 6.82s
2024-04-26 12:34:35 INFO     epoch complete!
2024-04-26 12:34:35 INFO     evaluating now!
2024-04-26 12:34:36 INFO     Epoch [77/200] train_loss: 3.4300, val_loss: 5.1138, lr: 0.003000, 7.09s
2024-04-26 12:34:42 INFO     epoch complete!
2024-04-26 12:34:42 INFO     evaluating now!
2024-04-26 12:34:42 INFO     Epoch [78/200] train_loss: 3.4295, val_loss: 5.0091, lr: 0.003000, 6.84s
2024-04-26 12:34:49 INFO     epoch complete!
2024-04-26 12:34:49 INFO     evaluating now!
2024-04-26 12:34:49 INFO     Epoch [79/200] train_loss: 3.4329, val_loss: 5.1257, lr: 0.003000, 6.80s
2024-04-26 12:34:56 INFO     epoch complete!
2024-04-26 12:34:56 INFO     evaluating now!
2024-04-26 12:34:56 INFO     Epoch [80/200] train_loss: 3.4437, val_loss: 5.0213, lr: 0.003000, 6.89s
2024-04-26 12:35:03 INFO     epoch complete!
2024-04-26 12:35:03 INFO     evaluating now!
2024-04-26 12:35:03 INFO     Epoch [81/200] train_loss: 3.4215, val_loss: 4.9682, lr: 0.003000, 7.07s
2024-04-26 12:35:10 INFO     epoch complete!
2024-04-26 12:35:10 INFO     evaluating now!
2024-04-26 12:35:10 INFO     Epoch [82/200] train_loss: 3.3858, val_loss: 4.9552, lr: 0.003000, 6.90s
2024-04-26 12:35:17 INFO     epoch complete!
2024-04-26 12:35:17 INFO     evaluating now!
2024-04-26 12:35:17 INFO     Epoch [83/200] train_loss: 3.4574, val_loss: 5.0095, lr: 0.003000, 6.89s
2024-04-26 12:35:23 INFO     epoch complete!
2024-04-26 12:35:23 INFO     evaluating now!
2024-04-26 12:35:24 INFO     Epoch [84/200] train_loss: 3.3556, val_loss: 5.0182, lr: 0.003000, 6.92s
2024-04-26 12:35:24 WARNING  Early stopping at epoch: 84
2024-04-26 12:35:24 INFO     Trained totally 85 epochs, average train time is 6.312s, average eval time is 0.452s
2024-04-26 12:35:24 INFO     Loaded model at 69
2024-04-26 12:35:24 INFO     Saved model at ./libcity/cache/11/model_cache/AGCRN_CHITaxi20190406.m
2024-04-26 12:35:24 INFO     Start evaluating ...
2024-04-26 12:35:26 INFO     Note that you select the single mode to evaluate!
2024-04-26 12:35:27 INFO     Evaluate result is saved at ./libcity/cache/11/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-26 12:35:27 INFO     
         MAE       RMSE
1   2.479188   7.540559
2   2.500957   7.924741
3   2.645752   8.743649
4   2.784892   9.414160
5   2.933753  10.149881
6   3.033220  11.006586
7   3.193172  11.928638
8   3.221488  12.554868
9   3.283035  12.936850
10  3.327905  12.978678
11  3.358499  13.176523
12  3.444367  13.550358
2024-04-26 12:35:27 INFO     ----------------------------------------------------------------------------
2024-04-26 12:35:27 INFO     # 2, Kownledge Graph Embedding: MuRE, Experiment ids: 12
2024-04-26 12:35:27 INFO     ----------------------------------------------------------------------------
2024-04-26 12:35:28 INFO     Log directory: ./libcity/log
2024-04-26 12:35:28 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=12
2024-04-26 12:35:28 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 829750919, 'exp_id': 12, 'load_external': True, 'embedding_model': 'MuRE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-26 12:35:28 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-26 12:35:28 INFO     set_weight_link_or_dist: dist
2024-04-26 12:35:28 INFO     init_weight_inf_or_zero: inf
2024-04-26 12:35:28 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-26 12:35:28 INFO     Start Calculate the weight by Gauss kernel!
2024-04-26 12:35:29 INFO     Loading file CHITaxi20190406.dyna
2024-04-26 12:35:29 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-26 12:35:32 INFO     Dataset created
2024-04-26 12:35:32 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-26 12:35:32 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-26 12:35:32 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-26 12:35:32 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-26 12:35:32 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-26 12:35:32 INFO     NoneScaler
2024-04-26 12:35:35 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-26 12:35:35 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-26 12:35:35 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-26 12:35:35 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-26 12:35:35 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-26 12:35:35 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-26 12:35:35 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-26 12:35:35 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-26 12:35:35 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-26 12:35:35 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-26 12:35:35 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-26 12:35:35 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-26 12:35:35 INFO     Total parameter numbers: 874010
2024-04-26 12:35:35 INFO     You select `adam` optimizer.
2024-04-26 12:35:35 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-26 12:35:35 INFO     Start training ...
2024-04-26 12:35:35 INFO     num_batches:48
2024-04-26 12:35:41 INFO     epoch complete!
2024-04-26 12:35:41 INFO     evaluating now!
2024-04-26 12:35:42 INFO     Epoch [0/200] train_loss: 24.0031, val_loss: 18.4342, lr: 0.003000, 6.84s
2024-04-26 12:35:42 INFO     Saved model at 0
2024-04-26 12:35:42 INFO     Val loss decrease from inf to 18.4342, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-26 12:35:48 INFO     epoch complete!
2024-04-26 12:35:48 INFO     evaluating now!
2024-04-26 12:35:49 INFO     Epoch [1/200] train_loss: 15.1573, val_loss: 14.3652, lr: 0.003000, 6.69s
2024-04-26 12:35:49 INFO     Saved model at 1
2024-04-26 12:35:49 INFO     Val loss decrease from 18.4342 to 14.3652, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-26 12:35:55 INFO     epoch complete!
2024-04-26 12:35:55 INFO     evaluating now!
2024-04-26 12:35:56 INFO     Epoch [2/200] train_loss: 11.5317, val_loss: 10.9007, lr: 0.003000, 6.73s
2024-04-26 12:35:56 INFO     Saved model at 2
2024-04-26 12:35:56 INFO     Val loss decrease from 14.3652 to 10.9007, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-26 12:36:03 INFO     epoch complete!
2024-04-26 12:36:03 INFO     evaluating now!
2024-04-26 12:36:03 INFO     Epoch [3/200] train_loss: 9.5213, val_loss: 9.1161, lr: 0.003000, 6.91s
2024-04-26 12:36:03 INFO     Saved model at 3
2024-04-26 12:36:03 INFO     Val loss decrease from 10.9007 to 9.1161, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-26 12:36:10 INFO     epoch complete!
2024-04-26 12:36:10 INFO     evaluating now!
2024-04-26 12:36:10 INFO     Epoch [4/200] train_loss: 8.3150, val_loss: 8.1210, lr: 0.003000, 6.93s
2024-04-26 12:36:10 INFO     Saved model at 4
2024-04-26 12:36:10 INFO     Val loss decrease from 9.1161 to 8.1210, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-26 12:36:17 INFO     epoch complete!
2024-04-26 12:36:17 INFO     evaluating now!
2024-04-26 12:36:17 INFO     Epoch [5/200] train_loss: 7.5360, val_loss: 7.1965, lr: 0.003000, 6.64s
2024-04-26 12:36:17 INFO     Saved model at 5
2024-04-26 12:36:17 INFO     Val loss decrease from 8.1210 to 7.1965, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-26 12:36:24 INFO     epoch complete!
2024-04-26 12:36:24 INFO     evaluating now!
2024-04-26 12:36:24 INFO     Epoch [6/200] train_loss: 6.9949, val_loss: 6.7561, lr: 0.003000, 6.84s
2024-04-26 12:36:24 INFO     Saved model at 6
2024-04-26 12:36:24 INFO     Val loss decrease from 7.1965 to 6.7561, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-26 12:36:31 INFO     epoch complete!
2024-04-26 12:36:31 INFO     evaluating now!
2024-04-26 12:36:31 INFO     Epoch [7/200] train_loss: 6.5242, val_loss: 6.7258, lr: 0.003000, 6.91s
2024-04-26 12:36:32 INFO     Saved model at 7
2024-04-26 12:36:32 INFO     Val loss decrease from 6.7561 to 6.7258, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-26 12:36:38 INFO     epoch complete!
2024-04-26 12:36:38 INFO     evaluating now!
2024-04-26 12:36:38 INFO     Epoch [8/200] train_loss: 6.1915, val_loss: 6.3049, lr: 0.003000, 6.81s
2024-04-26 12:36:39 INFO     Saved model at 8
2024-04-26 12:36:39 INFO     Val loss decrease from 6.7258 to 6.3049, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-26 12:36:45 INFO     epoch complete!
2024-04-26 12:36:45 INFO     evaluating now!
2024-04-26 12:36:46 INFO     Epoch [9/200] train_loss: 5.9557, val_loss: 6.1728, lr: 0.003000, 6.89s
2024-04-26 12:36:46 INFO     Saved model at 9
2024-04-26 12:36:46 INFO     Val loss decrease from 6.3049 to 6.1728, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-26 12:36:52 INFO     epoch complete!
2024-04-26 12:36:52 INFO     evaluating now!
2024-04-26 12:36:53 INFO     Epoch [10/200] train_loss: 5.7961, val_loss: 5.9845, lr: 0.003000, 6.87s
2024-04-26 12:36:53 INFO     Saved model at 10
2024-04-26 12:36:53 INFO     Val loss decrease from 6.1728 to 5.9845, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-26 12:36:59 INFO     epoch complete!
2024-04-26 12:36:59 INFO     evaluating now!
2024-04-26 12:37:00 INFO     Epoch [11/200] train_loss: 5.6077, val_loss: 6.0216, lr: 0.003000, 6.74s
2024-04-26 12:37:06 INFO     epoch complete!
2024-04-26 12:37:06 INFO     evaluating now!
2024-04-26 12:37:06 INFO     Epoch [12/200] train_loss: 5.5346, val_loss: 5.7856, lr: 0.003000, 6.70s
2024-04-26 12:37:07 INFO     Saved model at 12
2024-04-26 12:37:07 INFO     Val loss decrease from 5.9845 to 5.7856, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-26 12:37:13 INFO     epoch complete!
2024-04-26 12:37:13 INFO     evaluating now!
2024-04-26 12:37:13 INFO     Epoch [13/200] train_loss: 5.3609, val_loss: 5.7319, lr: 0.003000, 6.67s
2024-04-26 12:37:13 INFO     Saved model at 13
2024-04-26 12:37:13 INFO     Val loss decrease from 5.7856 to 5.7319, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-26 12:37:20 INFO     epoch complete!
2024-04-26 12:37:20 INFO     evaluating now!
2024-04-26 12:37:20 INFO     Epoch [14/200] train_loss: 5.4412, val_loss: 6.1462, lr: 0.003000, 6.70s
2024-04-26 12:37:26 INFO     epoch complete!
2024-04-26 12:37:26 INFO     evaluating now!
2024-04-26 12:37:27 INFO     Epoch [15/200] train_loss: 5.3224, val_loss: 5.8189, lr: 0.003000, 6.59s
2024-04-26 12:37:33 INFO     epoch complete!
2024-04-26 12:37:33 INFO     evaluating now!
2024-04-26 12:37:33 INFO     Epoch [16/200] train_loss: 5.1508, val_loss: 5.5177, lr: 0.003000, 6.62s
2024-04-26 12:37:34 INFO     Saved model at 16
2024-04-26 12:37:34 INFO     Val loss decrease from 5.7319 to 5.5177, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-26 12:37:40 INFO     epoch complete!
2024-04-26 12:37:40 INFO     evaluating now!
2024-04-26 12:37:40 INFO     Epoch [17/200] train_loss: 5.1484, val_loss: 5.6406, lr: 0.003000, 6.51s
2024-04-26 12:37:46 INFO     epoch complete!
2024-04-26 12:37:46 INFO     evaluating now!
2024-04-26 12:37:47 INFO     Epoch [18/200] train_loss: 4.9719, val_loss: 5.5768, lr: 0.003000, 6.46s
2024-04-26 12:37:53 INFO     epoch complete!
2024-04-26 12:37:53 INFO     evaluating now!
2024-04-26 12:37:53 INFO     Epoch [19/200] train_loss: 4.9253, val_loss: 5.3694, lr: 0.003000, 6.55s
2024-04-26 12:37:53 INFO     Saved model at 19
2024-04-26 12:37:53 INFO     Val loss decrease from 5.5177 to 5.3694, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-26 12:38:00 INFO     epoch complete!
2024-04-26 12:38:00 INFO     evaluating now!
2024-04-26 12:38:00 INFO     Epoch [20/200] train_loss: 4.8327, val_loss: 5.3644, lr: 0.003000, 6.68s
2024-04-26 12:38:00 INFO     Saved model at 20
2024-04-26 12:38:00 INFO     Val loss decrease from 5.3694 to 5.3644, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-26 12:38:07 INFO     epoch complete!
2024-04-26 12:38:07 INFO     evaluating now!
2024-04-26 12:38:07 INFO     Epoch [21/200] train_loss: 4.7723, val_loss: 5.3118, lr: 0.003000, 6.67s
2024-04-26 12:38:07 INFO     Saved model at 21
2024-04-26 12:38:07 INFO     Val loss decrease from 5.3644 to 5.3118, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-26 12:38:14 INFO     epoch complete!
2024-04-26 12:38:14 INFO     evaluating now!
2024-04-26 12:38:14 INFO     Epoch [22/200] train_loss: 4.8610, val_loss: 5.5173, lr: 0.003000, 6.76s
2024-04-26 12:38:20 INFO     epoch complete!
2024-04-26 12:38:20 INFO     evaluating now!
2024-04-26 12:38:21 INFO     Epoch [23/200] train_loss: 4.8868, val_loss: 5.3623, lr: 0.003000, 6.70s
2024-04-26 12:38:27 INFO     epoch complete!
2024-04-26 12:38:27 INFO     evaluating now!
2024-04-26 12:38:28 INFO     Epoch [24/200] train_loss: 4.6294, val_loss: 5.3801, lr: 0.003000, 6.79s
2024-04-26 12:38:34 INFO     epoch complete!
2024-04-26 12:38:34 INFO     evaluating now!
2024-04-26 12:38:34 INFO     Epoch [25/200] train_loss: 4.6388, val_loss: 5.3123, lr: 0.003000, 6.79s
2024-04-26 12:38:41 INFO     epoch complete!
2024-04-26 12:38:41 INFO     evaluating now!
2024-04-26 12:38:41 INFO     Epoch [26/200] train_loss: 4.5264, val_loss: 5.3871, lr: 0.003000, 6.74s
2024-04-26 12:38:47 INFO     epoch complete!
2024-04-26 12:38:47 INFO     evaluating now!
2024-04-26 12:38:48 INFO     Epoch [27/200] train_loss: 4.4513, val_loss: 5.3025, lr: 0.003000, 6.60s
2024-04-26 12:38:48 INFO     Saved model at 27
2024-04-26 12:38:48 INFO     Val loss decrease from 5.3118 to 5.3025, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-26 12:38:54 INFO     epoch complete!
2024-04-26 12:38:54 INFO     evaluating now!
2024-04-26 12:38:55 INFO     Epoch [28/200] train_loss: 4.4131, val_loss: 5.2865, lr: 0.003000, 6.66s
2024-04-26 12:38:55 INFO     Saved model at 28
2024-04-26 12:38:55 INFO     Val loss decrease from 5.3025 to 5.2865, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-04-26 12:39:01 INFO     epoch complete!
2024-04-26 12:39:01 INFO     evaluating now!
2024-04-26 12:39:01 INFO     Epoch [29/200] train_loss: 4.3899, val_loss: 5.2445, lr: 0.003000, 6.66s
2024-04-26 12:39:02 INFO     Saved model at 29
2024-04-26 12:39:02 INFO     Val loss decrease from 5.2865 to 5.2445, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-04-26 12:39:08 INFO     epoch complete!
2024-04-26 12:39:08 INFO     evaluating now!
2024-04-26 12:39:09 INFO     Epoch [30/200] train_loss: 4.3901, val_loss: 5.3905, lr: 0.003000, 6.90s
2024-04-26 12:39:15 INFO     epoch complete!
2024-04-26 12:39:15 INFO     evaluating now!
2024-04-26 12:39:15 INFO     Epoch [31/200] train_loss: 4.3759, val_loss: 5.3492, lr: 0.003000, 6.91s
2024-04-26 12:39:22 INFO     epoch complete!
2024-04-26 12:39:22 INFO     evaluating now!
2024-04-26 12:39:22 INFO     Epoch [32/200] train_loss: 4.3145, val_loss: 5.3394, lr: 0.003000, 6.85s
2024-04-26 12:39:29 INFO     epoch complete!
2024-04-26 12:39:29 INFO     evaluating now!
2024-04-26 12:39:29 INFO     Epoch [33/200] train_loss: 4.2409, val_loss: 5.2757, lr: 0.003000, 6.81s
2024-04-26 12:39:35 INFO     epoch complete!
2024-04-26 12:39:35 INFO     evaluating now!
2024-04-26 12:39:36 INFO     Epoch [34/200] train_loss: 4.2321, val_loss: 5.1672, lr: 0.003000, 6.75s
2024-04-26 12:39:36 INFO     Saved model at 34
2024-04-26 12:39:36 INFO     Val loss decrease from 5.2445 to 5.1672, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-04-26 12:39:43 INFO     epoch complete!
2024-04-26 12:39:43 INFO     evaluating now!
2024-04-26 12:39:43 INFO     Epoch [35/200] train_loss: 4.1748, val_loss: 5.2573, lr: 0.003000, 6.90s
2024-04-26 12:39:49 INFO     epoch complete!
2024-04-26 12:39:49 INFO     evaluating now!
2024-04-26 12:39:50 INFO     Epoch [36/200] train_loss: 4.1513, val_loss: 5.4024, lr: 0.003000, 6.72s
2024-04-26 12:39:56 INFO     epoch complete!
2024-04-26 12:39:56 INFO     evaluating now!
2024-04-26 12:39:57 INFO     Epoch [37/200] train_loss: 4.2172, val_loss: 5.1762, lr: 0.003000, 6.89s
2024-04-26 12:40:03 INFO     epoch complete!
2024-04-26 12:40:03 INFO     evaluating now!
2024-04-26 12:40:03 INFO     Epoch [38/200] train_loss: 4.0790, val_loss: 5.3595, lr: 0.003000, 6.82s
2024-04-26 12:40:10 INFO     epoch complete!
2024-04-26 12:40:10 INFO     evaluating now!
2024-04-26 12:40:10 INFO     Epoch [39/200] train_loss: 4.0730, val_loss: 5.4778, lr: 0.003000, 6.66s
2024-04-26 12:40:16 INFO     epoch complete!
2024-04-26 12:40:16 INFO     evaluating now!
2024-04-26 12:40:17 INFO     Epoch [40/200] train_loss: 4.0942, val_loss: 5.2277, lr: 0.003000, 6.78s
2024-04-26 12:40:23 INFO     epoch complete!
2024-04-26 12:40:23 INFO     evaluating now!
2024-04-26 12:40:24 INFO     Epoch [41/200] train_loss: 4.0528, val_loss: 5.4961, lr: 0.003000, 6.82s
2024-04-26 12:40:30 INFO     epoch complete!
2024-04-26 12:40:30 INFO     evaluating now!
2024-04-26 12:40:31 INFO     Epoch [42/200] train_loss: 4.0330, val_loss: 5.2574, lr: 0.003000, 7.03s
2024-04-26 12:40:37 INFO     epoch complete!
2024-04-26 12:40:37 INFO     evaluating now!
2024-04-26 12:40:37 INFO     Epoch [43/200] train_loss: 3.9593, val_loss: 5.1582, lr: 0.003000, 6.64s
2024-04-26 12:40:37 INFO     Saved model at 43
2024-04-26 12:40:37 INFO     Val loss decrease from 5.1672 to 5.1582, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-04-26 12:40:44 INFO     epoch complete!
2024-04-26 12:40:44 INFO     evaluating now!
2024-04-26 12:40:44 INFO     Epoch [44/200] train_loss: 3.9546, val_loss: 5.2444, lr: 0.003000, 6.56s
2024-04-26 12:40:50 INFO     epoch complete!
2024-04-26 12:40:50 INFO     evaluating now!
2024-04-26 12:40:51 INFO     Epoch [45/200] train_loss: 3.9552, val_loss: 5.2665, lr: 0.003000, 6.71s
2024-04-26 12:40:57 INFO     epoch complete!
2024-04-26 12:40:57 INFO     evaluating now!
2024-04-26 12:40:57 INFO     Epoch [46/200] train_loss: 3.8759, val_loss: 5.1091, lr: 0.003000, 6.42s
2024-04-26 12:40:58 INFO     Saved model at 46
2024-04-26 12:40:58 INFO     Val loss decrease from 5.1582 to 5.1091, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-04-26 12:41:04 INFO     epoch complete!
2024-04-26 12:41:04 INFO     evaluating now!
2024-04-26 12:41:04 INFO     Epoch [47/200] train_loss: 3.8856, val_loss: 5.1687, lr: 0.003000, 6.52s
2024-04-26 12:41:10 INFO     epoch complete!
2024-04-26 12:41:10 INFO     evaluating now!
2024-04-26 12:41:11 INFO     Epoch [48/200] train_loss: 3.8637, val_loss: 5.2661, lr: 0.003000, 6.59s
2024-04-26 12:41:17 INFO     epoch complete!
2024-04-26 12:41:17 INFO     evaluating now!
2024-04-26 12:41:17 INFO     Epoch [49/200] train_loss: 3.8562, val_loss: 5.2163, lr: 0.003000, 6.52s
2024-04-26 12:41:23 INFO     epoch complete!
2024-04-26 12:41:24 INFO     evaluating now!
2024-04-26 12:41:24 INFO     Epoch [50/200] train_loss: 3.8619, val_loss: 5.3442, lr: 0.003000, 6.72s
2024-04-26 12:41:30 INFO     epoch complete!
2024-04-26 12:41:30 INFO     evaluating now!
2024-04-26 12:41:31 INFO     Epoch [51/200] train_loss: 3.8869, val_loss: 5.2646, lr: 0.003000, 6.59s
2024-04-26 12:41:37 INFO     epoch complete!
2024-04-26 12:41:37 INFO     evaluating now!
2024-04-26 12:41:37 INFO     Epoch [52/200] train_loss: 3.7840, val_loss: 5.2803, lr: 0.003000, 6.69s
2024-04-26 12:41:43 INFO     epoch complete!
2024-04-26 12:41:43 INFO     evaluating now!
2024-04-26 12:41:44 INFO     Epoch [53/200] train_loss: 3.7315, val_loss: 5.1115, lr: 0.003000, 6.63s
2024-04-26 12:41:50 INFO     epoch complete!
2024-04-26 12:41:50 INFO     evaluating now!
2024-04-26 12:41:51 INFO     Epoch [54/200] train_loss: 3.7617, val_loss: 5.2158, lr: 0.003000, 6.68s
2024-04-26 12:41:57 INFO     epoch complete!
2024-04-26 12:41:57 INFO     evaluating now!
2024-04-26 12:41:57 INFO     Epoch [55/200] train_loss: 3.7947, val_loss: 5.1704, lr: 0.003000, 6.83s
2024-04-26 12:42:04 INFO     epoch complete!
2024-04-26 12:42:04 INFO     evaluating now!
2024-04-26 12:42:04 INFO     Epoch [56/200] train_loss: 3.7039, val_loss: 5.1389, lr: 0.003000, 6.65s
2024-04-26 12:42:10 INFO     epoch complete!
2024-04-26 12:42:10 INFO     evaluating now!
2024-04-26 12:42:11 INFO     Epoch [57/200] train_loss: 3.7707, val_loss: 5.2946, lr: 0.003000, 6.68s
2024-04-26 12:42:17 INFO     epoch complete!
2024-04-26 12:42:17 INFO     evaluating now!
2024-04-26 12:42:17 INFO     Epoch [58/200] train_loss: 3.7093, val_loss: 5.1702, lr: 0.003000, 6.78s
2024-04-26 12:42:24 INFO     epoch complete!
2024-04-26 12:42:24 INFO     evaluating now!
2024-04-26 12:42:24 INFO     Epoch [59/200] train_loss: 3.6563, val_loss: 5.1452, lr: 0.003000, 6.68s
2024-04-26 12:42:30 INFO     epoch complete!
2024-04-26 12:42:30 INFO     evaluating now!
2024-04-26 12:42:31 INFO     Epoch [60/200] train_loss: 3.6290, val_loss: 5.2026, lr: 0.003000, 6.79s
2024-04-26 12:42:38 INFO     epoch complete!
2024-04-26 12:42:38 INFO     evaluating now!
2024-04-26 12:42:38 INFO     Epoch [61/200] train_loss: 3.6192, val_loss: 5.1081, lr: 0.003000, 6.99s
2024-04-26 12:42:38 INFO     Saved model at 61
2024-04-26 12:42:38 INFO     Val loss decrease from 5.1091 to 5.1081, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch61.tar
2024-04-26 12:42:44 INFO     epoch complete!
2024-04-26 12:42:44 INFO     evaluating now!
2024-04-26 12:42:45 INFO     Epoch [62/200] train_loss: 3.6342, val_loss: 5.1142, lr: 0.003000, 6.61s
2024-04-26 12:42:51 INFO     epoch complete!
2024-04-26 12:42:51 INFO     evaluating now!
2024-04-26 12:42:51 INFO     Epoch [63/200] train_loss: 3.6312, val_loss: 5.1694, lr: 0.003000, 6.61s
2024-04-26 12:42:58 INFO     epoch complete!
2024-04-26 12:42:58 INFO     evaluating now!
2024-04-26 12:42:58 INFO     Epoch [64/200] train_loss: 3.6329, val_loss: 5.0841, lr: 0.003000, 6.76s
2024-04-26 12:42:58 INFO     Saved model at 64
2024-04-26 12:42:58 INFO     Val loss decrease from 5.1081 to 5.0841, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch64.tar
2024-04-26 12:43:05 INFO     epoch complete!
2024-04-26 12:43:05 INFO     evaluating now!
2024-04-26 12:43:05 INFO     Epoch [65/200] train_loss: 3.6419, val_loss: 5.0868, lr: 0.003000, 6.65s
2024-04-26 12:43:11 INFO     epoch complete!
2024-04-26 12:43:11 INFO     evaluating now!
2024-04-26 12:43:12 INFO     Epoch [66/200] train_loss: 3.5513, val_loss: 5.0926, lr: 0.003000, 6.56s
2024-04-26 12:43:18 INFO     epoch complete!
2024-04-26 12:43:18 INFO     evaluating now!
2024-04-26 12:43:18 INFO     Epoch [67/200] train_loss: 3.4799, val_loss: 5.1128, lr: 0.003000, 6.62s
2024-04-26 12:43:24 INFO     epoch complete!
2024-04-26 12:43:24 INFO     evaluating now!
2024-04-26 12:43:25 INFO     Epoch [68/200] train_loss: 3.5242, val_loss: 5.1588, lr: 0.003000, 6.66s
2024-04-26 12:43:31 INFO     epoch complete!
2024-04-26 12:43:31 INFO     evaluating now!
2024-04-26 12:43:32 INFO     Epoch [69/200] train_loss: 3.4924, val_loss: 5.2331, lr: 0.003000, 6.97s
2024-04-26 12:43:38 INFO     epoch complete!
2024-04-26 12:43:38 INFO     evaluating now!
2024-04-26 12:43:38 INFO     Epoch [70/200] train_loss: 3.4890, val_loss: 5.2559, lr: 0.003000, 6.65s
2024-04-26 12:43:45 INFO     epoch complete!
2024-04-26 12:43:45 INFO     evaluating now!
2024-04-26 12:43:45 INFO     Epoch [71/200] train_loss: 3.4726, val_loss: 5.1723, lr: 0.003000, 6.61s
2024-04-26 12:43:51 INFO     epoch complete!
2024-04-26 12:43:51 INFO     evaluating now!
2024-04-26 12:43:52 INFO     Epoch [72/200] train_loss: 3.4862, val_loss: 5.2229, lr: 0.003000, 6.56s
2024-04-26 12:43:58 INFO     epoch complete!
2024-04-26 12:43:58 INFO     evaluating now!
2024-04-26 12:43:58 INFO     Epoch [73/200] train_loss: 3.5043, val_loss: 5.2767, lr: 0.003000, 6.69s
2024-04-26 12:44:05 INFO     epoch complete!
2024-04-26 12:44:05 INFO     evaluating now!
2024-04-26 12:44:05 INFO     Epoch [74/200] train_loss: 3.4914, val_loss: 5.2060, lr: 0.003000, 6.79s
2024-04-26 12:44:11 INFO     epoch complete!
2024-04-26 12:44:11 INFO     evaluating now!
2024-04-26 12:44:12 INFO     Epoch [75/200] train_loss: 3.4664, val_loss: 5.1216, lr: 0.003000, 6.72s
2024-04-26 12:44:18 INFO     epoch complete!
2024-04-26 12:44:18 INFO     evaluating now!
2024-04-26 12:44:19 INFO     Epoch [76/200] train_loss: 3.4397, val_loss: 5.0196, lr: 0.003000, 6.78s
2024-04-26 12:44:19 INFO     Saved model at 76
2024-04-26 12:44:19 INFO     Val loss decrease from 5.0841 to 5.0196, saving to ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406_epoch76.tar
2024-04-26 12:44:25 INFO     epoch complete!
2024-04-26 12:44:25 INFO     evaluating now!
2024-04-26 12:44:25 INFO     Epoch [77/200] train_loss: 3.4269, val_loss: 5.0706, lr: 0.003000, 6.71s
2024-04-26 12:44:32 INFO     epoch complete!
2024-04-26 12:44:32 INFO     evaluating now!
2024-04-26 12:44:32 INFO     Epoch [78/200] train_loss: 3.4260, val_loss: 5.1376, lr: 0.003000, 6.69s
2024-04-26 12:44:38 INFO     epoch complete!
2024-04-26 12:44:38 INFO     evaluating now!
2024-04-26 12:44:39 INFO     Epoch [79/200] train_loss: 3.3792, val_loss: 5.0733, lr: 0.003000, 6.74s
2024-04-26 12:44:46 INFO     epoch complete!
2024-04-26 12:44:46 INFO     evaluating now!
2024-04-26 12:44:46 INFO     Epoch [80/200] train_loss: 3.4151, val_loss: 5.1276, lr: 0.003000, 7.11s
2024-04-26 12:44:52 INFO     epoch complete!
2024-04-26 12:44:52 INFO     evaluating now!
2024-04-26 12:44:53 INFO     Epoch [81/200] train_loss: 3.3916, val_loss: 5.1364, lr: 0.003000, 6.77s
2024-04-26 12:44:59 INFO     epoch complete!
2024-04-26 12:44:59 INFO     evaluating now!
2024-04-26 12:44:59 INFO     Epoch [82/200] train_loss: 3.3692, val_loss: 5.0703, lr: 0.003000, 6.29s
2024-04-26 12:45:05 INFO     epoch complete!
2024-04-26 12:45:05 INFO     evaluating now!
2024-04-26 12:45:05 INFO     Epoch [83/200] train_loss: 3.3463, val_loss: 5.2982, lr: 0.003000, 6.25s
2024-04-26 12:45:11 INFO     epoch complete!
2024-04-26 12:45:11 INFO     evaluating now!
2024-04-26 12:45:11 INFO     Epoch [84/200] train_loss: 3.4096, val_loss: 5.1546, lr: 0.003000, 5.79s
2024-04-26 12:45:17 INFO     epoch complete!
2024-04-26 12:45:17 INFO     evaluating now!
2024-04-26 12:45:17 INFO     Epoch [85/200] train_loss: 3.3622, val_loss: 5.1719, lr: 0.003000, 5.94s
2024-04-26 12:45:23 INFO     epoch complete!
2024-04-26 12:45:23 INFO     evaluating now!
2024-04-26 12:45:23 INFO     Epoch [86/200] train_loss: 3.3432, val_loss: 5.1947, lr: 0.003000, 5.95s
2024-04-26 12:45:28 INFO     epoch complete!
2024-04-26 12:45:28 INFO     evaluating now!
2024-04-26 12:45:29 INFO     Epoch [87/200] train_loss: 3.3380, val_loss: 5.1058, lr: 0.003000, 5.80s
2024-04-26 12:45:34 INFO     epoch complete!
2024-04-26 12:45:34 INFO     evaluating now!
2024-04-26 12:45:35 INFO     Epoch [88/200] train_loss: 3.3634, val_loss: 5.1397, lr: 0.003000, 5.85s
2024-04-26 12:45:40 INFO     epoch complete!
2024-04-26 12:45:40 INFO     evaluating now!
2024-04-26 12:45:40 INFO     Epoch [89/200] train_loss: 3.3258, val_loss: 5.1058, lr: 0.003000, 5.87s
2024-04-26 12:45:46 INFO     epoch complete!
2024-04-26 12:45:46 INFO     evaluating now!
2024-04-26 12:45:46 INFO     Epoch [90/200] train_loss: 3.3219, val_loss: 5.1863, lr: 0.003000, 5.88s
2024-04-26 12:45:52 INFO     epoch complete!
2024-04-26 12:45:52 INFO     evaluating now!
2024-04-26 12:45:52 INFO     Epoch [91/200] train_loss: 3.3229, val_loss: 5.1387, lr: 0.003000, 5.88s
2024-04-26 12:45:52 WARNING  Early stopping at epoch: 91
2024-04-26 12:45:52 INFO     Trained totally 92 epochs, average train time is 6.194s, average eval time is 0.445s
2024-04-26 12:45:52 INFO     Loaded model at 76
2024-04-26 12:45:52 INFO     Saved model at ./libcity/cache/12/model_cache/AGCRN_CHITaxi20190406.m
2024-04-26 12:45:52 INFO     Start evaluating ...
2024-04-26 12:45:54 INFO     Note that you select the single mode to evaluate!
2024-04-26 12:45:54 INFO     Evaluate result is saved at ./libcity/cache/12/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-26 12:45:54 INFO     
         MAE       RMSE
1   2.393207   6.826896
2   2.612019   7.696541
3   2.730435   8.721643
4   2.849722   9.471184
5   3.016913  10.449749
6   3.176040  11.624049
7   3.329721  12.711570
8   3.408052  13.645763
9   3.452003  13.971224
10  3.469887  14.093445
11  3.475897  14.205639
12  3.546649  14.555312
2024-04-26 12:45:54 INFO     ----------------------------------------------------------------------------
2024-04-26 12:45:54 INFO     # 3, Kownledge Graph Embedding: MuRE, Experiment ids: 13
2024-04-26 12:45:54 INFO     ----------------------------------------------------------------------------
2024-04-26 12:45:55 INFO     Log directory: ./libcity/log
2024-04-26 12:45:55 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=13
2024-04-26 12:45:55 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 360977369, 'exp_id': 13, 'load_external': True, 'embedding_model': 'MuRE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-26 12:45:55 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-26 12:45:55 INFO     set_weight_link_or_dist: dist
2024-04-26 12:45:55 INFO     init_weight_inf_or_zero: inf
2024-04-26 12:45:55 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-26 12:45:55 INFO     Start Calculate the weight by Gauss kernel!
2024-04-26 12:45:55 INFO     Loading file CHITaxi20190406.dyna
2024-04-26 12:45:56 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-26 12:45:59 INFO     Dataset created
2024-04-26 12:45:59 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-26 12:45:59 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-26 12:45:59 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-26 12:45:59 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-26 12:45:59 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-26 12:45:59 INFO     NoneScaler
2024-04-26 12:46:01 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-26 12:46:01 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-26 12:46:01 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-26 12:46:01 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-26 12:46:01 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-26 12:46:01 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-26 12:46:01 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-26 12:46:01 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-26 12:46:01 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-26 12:46:01 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-26 12:46:01 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-26 12:46:01 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-26 12:46:01 INFO     Total parameter numbers: 874010
2024-04-26 12:46:01 INFO     You select `adam` optimizer.
2024-04-26 12:46:01 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-26 12:46:01 INFO     Start training ...
2024-04-26 12:46:01 INFO     num_batches:48
2024-04-26 12:46:07 INFO     epoch complete!
2024-04-26 12:46:07 INFO     evaluating now!
2024-04-26 12:46:07 INFO     Epoch [0/200] train_loss: 25.0046, val_loss: 18.6385, lr: 0.003000, 5.83s
2024-04-26 12:46:07 INFO     Saved model at 0
2024-04-26 12:46:07 INFO     Val loss decrease from inf to 18.6385, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-26 12:46:12 INFO     epoch complete!
2024-04-26 12:46:12 INFO     evaluating now!
2024-04-26 12:46:13 INFO     Epoch [1/200] train_loss: 15.3497, val_loss: 14.9592, lr: 0.003000, 5.56s
2024-04-26 12:46:13 INFO     Saved model at 1
2024-04-26 12:46:13 INFO     Val loss decrease from 18.6385 to 14.9592, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-26 12:46:18 INFO     epoch complete!
2024-04-26 12:46:18 INFO     evaluating now!
2024-04-26 12:46:18 INFO     Epoch [2/200] train_loss: 12.2972, val_loss: 12.0811, lr: 0.003000, 5.51s
2024-04-26 12:46:18 INFO     Saved model at 2
2024-04-26 12:46:18 INFO     Val loss decrease from 14.9592 to 12.0811, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-26 12:46:24 INFO     epoch complete!
2024-04-26 12:46:24 INFO     evaluating now!
2024-04-26 12:46:24 INFO     Epoch [3/200] train_loss: 10.1215, val_loss: 9.7345, lr: 0.003000, 5.63s
2024-04-26 12:46:24 INFO     Saved model at 3
2024-04-26 12:46:24 INFO     Val loss decrease from 12.0811 to 9.7345, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-26 12:46:29 INFO     epoch complete!
2024-04-26 12:46:29 INFO     evaluating now!
2024-04-26 12:46:30 INFO     Epoch [4/200] train_loss: 8.7296, val_loss: 8.4812, lr: 0.003000, 5.50s
2024-04-26 12:46:30 INFO     Saved model at 4
2024-04-26 12:46:30 INFO     Val loss decrease from 9.7345 to 8.4812, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-26 12:46:35 INFO     epoch complete!
2024-04-26 12:46:35 INFO     evaluating now!
2024-04-26 12:46:35 INFO     Epoch [5/200] train_loss: 7.8012, val_loss: 7.5145, lr: 0.003000, 5.63s
2024-04-26 12:46:36 INFO     Saved model at 5
2024-04-26 12:46:36 INFO     Val loss decrease from 8.4812 to 7.5145, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-26 12:46:41 INFO     epoch complete!
2024-04-26 12:46:41 INFO     evaluating now!
2024-04-26 12:46:41 INFO     Epoch [6/200] train_loss: 7.1466, val_loss: 6.9515, lr: 0.003000, 5.50s
2024-04-26 12:46:41 INFO     Saved model at 6
2024-04-26 12:46:41 INFO     Val loss decrease from 7.5145 to 6.9515, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-26 12:46:46 INFO     epoch complete!
2024-04-26 12:46:46 INFO     evaluating now!
2024-04-26 12:46:47 INFO     Epoch [7/200] train_loss: 6.7958, val_loss: 6.8830, lr: 0.003000, 5.14s
2024-04-26 12:46:47 INFO     Saved model at 7
2024-04-26 12:46:47 INFO     Val loss decrease from 6.9515 to 6.8830, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-26 12:46:52 INFO     epoch complete!
2024-04-26 12:46:52 INFO     evaluating now!
2024-04-26 12:46:52 INFO     Epoch [8/200] train_loss: 6.4487, val_loss: 6.3153, lr: 0.003000, 5.41s
2024-04-26 12:46:52 INFO     Saved model at 8
2024-04-26 12:46:52 INFO     Val loss decrease from 6.8830 to 6.3153, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-26 12:46:57 INFO     epoch complete!
2024-04-26 12:46:57 INFO     evaluating now!
2024-04-26 12:46:58 INFO     Epoch [9/200] train_loss: 6.2087, val_loss: 6.3006, lr: 0.003000, 5.55s
2024-04-26 12:46:58 INFO     Saved model at 9
2024-04-26 12:46:58 INFO     Val loss decrease from 6.3153 to 6.3006, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-26 12:47:03 INFO     epoch complete!
2024-04-26 12:47:03 INFO     evaluating now!
2024-04-26 12:47:03 INFO     Epoch [10/200] train_loss: 5.9176, val_loss: 5.9565, lr: 0.003000, 5.58s
2024-04-26 12:47:04 INFO     Saved model at 10
2024-04-26 12:47:04 INFO     Val loss decrease from 6.3006 to 5.9565, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-26 12:47:09 INFO     epoch complete!
2024-04-26 12:47:09 INFO     evaluating now!
2024-04-26 12:47:09 INFO     Epoch [11/200] train_loss: 5.7748, val_loss: 5.8703, lr: 0.003000, 5.79s
2024-04-26 12:47:09 INFO     Saved model at 11
2024-04-26 12:47:09 INFO     Val loss decrease from 5.9565 to 5.8703, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-26 12:47:16 INFO     epoch complete!
2024-04-26 12:47:16 INFO     evaluating now!
2024-04-26 12:47:16 INFO     Epoch [12/200] train_loss: 5.6487, val_loss: 5.8941, lr: 0.003000, 6.54s
2024-04-26 12:47:22 INFO     epoch complete!
2024-04-26 12:47:22 INFO     evaluating now!
2024-04-26 12:47:23 INFO     Epoch [13/200] train_loss: 5.5075, val_loss: 5.9623, lr: 0.003000, 6.60s
2024-04-26 12:47:29 INFO     epoch complete!
2024-04-26 12:47:29 INFO     evaluating now!
2024-04-26 12:47:29 INFO     Epoch [14/200] train_loss: 5.3266, val_loss: 5.6995, lr: 0.003000, 6.62s
2024-04-26 12:47:29 INFO     Saved model at 14
2024-04-26 12:47:29 INFO     Val loss decrease from 5.8703 to 5.6995, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-26 12:47:36 INFO     epoch complete!
2024-04-26 12:47:36 INFO     evaluating now!
2024-04-26 12:47:36 INFO     Epoch [15/200] train_loss: 5.2683, val_loss: 5.8611, lr: 0.003000, 6.58s
2024-04-26 12:47:42 INFO     epoch complete!
2024-04-26 12:47:42 INFO     evaluating now!
2024-04-26 12:47:42 INFO     Epoch [16/200] train_loss: 5.1387, val_loss: 5.8402, lr: 0.003000, 6.03s
2024-04-26 12:47:47 INFO     epoch complete!
2024-04-26 12:47:47 INFO     evaluating now!
2024-04-26 12:47:48 INFO     Epoch [17/200] train_loss: 5.0990, val_loss: 5.6854, lr: 0.003000, 5.91s
2024-04-26 12:47:48 INFO     Saved model at 17
2024-04-26 12:47:48 INFO     Val loss decrease from 5.6995 to 5.6854, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-26 12:47:54 INFO     epoch complete!
2024-04-26 12:47:54 INFO     evaluating now!
2024-04-26 12:47:54 INFO     Epoch [18/200] train_loss: 5.1487, val_loss: 5.5112, lr: 0.003000, 5.98s
2024-04-26 12:47:54 INFO     Saved model at 18
2024-04-26 12:47:54 INFO     Val loss decrease from 5.6854 to 5.5112, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-26 12:48:00 INFO     epoch complete!
2024-04-26 12:48:00 INFO     evaluating now!
2024-04-26 12:48:00 INFO     Epoch [19/200] train_loss: 4.9528, val_loss: 5.3698, lr: 0.003000, 5.94s
2024-04-26 12:48:00 INFO     Saved model at 19
2024-04-26 12:48:00 INFO     Val loss decrease from 5.5112 to 5.3698, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-26 12:48:06 INFO     epoch complete!
2024-04-26 12:48:06 INFO     evaluating now!
2024-04-26 12:48:06 INFO     Epoch [20/200] train_loss: 4.8530, val_loss: 5.7868, lr: 0.003000, 5.92s
2024-04-26 12:48:11 INFO     epoch complete!
2024-04-26 12:48:11 INFO     evaluating now!
2024-04-26 12:48:12 INFO     Epoch [21/200] train_loss: 4.8398, val_loss: 5.4828, lr: 0.003000, 5.84s
2024-04-26 12:48:17 INFO     epoch complete!
2024-04-26 12:48:17 INFO     evaluating now!
2024-04-26 12:48:18 INFO     Epoch [22/200] train_loss: 4.7668, val_loss: 5.2300, lr: 0.003000, 6.00s
2024-04-26 12:48:18 INFO     Saved model at 22
2024-04-26 12:48:18 INFO     Val loss decrease from 5.3698 to 5.2300, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-26 12:48:23 INFO     epoch complete!
2024-04-26 12:48:23 INFO     evaluating now!
2024-04-26 12:48:24 INFO     Epoch [23/200] train_loss: 4.7861, val_loss: 5.4243, lr: 0.003000, 5.83s
2024-04-26 12:48:29 INFO     epoch complete!
2024-04-26 12:48:29 INFO     evaluating now!
2024-04-26 12:48:30 INFO     Epoch [24/200] train_loss: 4.6372, val_loss: 5.4623, lr: 0.003000, 5.83s
2024-04-26 12:48:35 INFO     epoch complete!
2024-04-26 12:48:35 INFO     evaluating now!
2024-04-26 12:48:36 INFO     Epoch [25/200] train_loss: 4.6242, val_loss: 5.2718, lr: 0.003000, 5.91s
2024-04-26 12:48:41 INFO     epoch complete!
2024-04-26 12:48:41 INFO     evaluating now!
2024-04-26 12:48:42 INFO     Epoch [26/200] train_loss: 4.5343, val_loss: 5.3056, lr: 0.003000, 6.04s
2024-04-26 12:48:47 INFO     epoch complete!
2024-04-26 12:48:47 INFO     evaluating now!
2024-04-26 12:48:48 INFO     Epoch [27/200] train_loss: 4.4384, val_loss: 5.1774, lr: 0.003000, 5.95s
2024-04-26 12:48:48 INFO     Saved model at 27
2024-04-26 12:48:48 INFO     Val loss decrease from 5.2300 to 5.1774, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-26 12:48:53 INFO     epoch complete!
2024-04-26 12:48:53 INFO     evaluating now!
2024-04-26 12:48:54 INFO     Epoch [28/200] train_loss: 4.4430, val_loss: 5.1999, lr: 0.003000, 5.83s
2024-04-26 12:48:59 INFO     epoch complete!
2024-04-26 12:48:59 INFO     evaluating now!
2024-04-26 12:49:00 INFO     Epoch [29/200] train_loss: 4.3898, val_loss: 5.2659, lr: 0.003000, 5.98s
2024-04-26 12:49:05 INFO     epoch complete!
2024-04-26 12:49:05 INFO     evaluating now!
2024-04-26 12:49:06 INFO     Epoch [30/200] train_loss: 4.4050, val_loss: 5.1183, lr: 0.003000, 5.92s
2024-04-26 12:49:06 INFO     Saved model at 30
2024-04-26 12:49:06 INFO     Val loss decrease from 5.1774 to 5.1183, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-04-26 12:49:11 INFO     epoch complete!
2024-04-26 12:49:11 INFO     evaluating now!
2024-04-26 12:49:12 INFO     Epoch [31/200] train_loss: 4.4680, val_loss: 5.3206, lr: 0.003000, 6.03s
2024-04-26 12:49:17 INFO     epoch complete!
2024-04-26 12:49:17 INFO     evaluating now!
2024-04-26 12:49:18 INFO     Epoch [32/200] train_loss: 4.3928, val_loss: 5.3299, lr: 0.003000, 5.96s
2024-04-26 12:49:23 INFO     epoch complete!
2024-04-26 12:49:23 INFO     evaluating now!
2024-04-26 12:49:24 INFO     Epoch [33/200] train_loss: 4.2804, val_loss: 5.3001, lr: 0.003000, 5.95s
2024-04-26 12:49:29 INFO     epoch complete!
2024-04-26 12:49:29 INFO     evaluating now!
2024-04-26 12:49:30 INFO     Epoch [34/200] train_loss: 4.1995, val_loss: 5.2404, lr: 0.003000, 5.88s
2024-04-26 12:49:35 INFO     epoch complete!
2024-04-26 12:49:35 INFO     evaluating now!
2024-04-26 12:49:36 INFO     Epoch [35/200] train_loss: 4.1703, val_loss: 5.2772, lr: 0.003000, 6.10s
2024-04-26 12:49:41 INFO     epoch complete!
2024-04-26 12:49:41 INFO     evaluating now!
2024-04-26 12:49:42 INFO     Epoch [36/200] train_loss: 4.1661, val_loss: 5.2535, lr: 0.003000, 6.02s
2024-04-26 12:49:47 INFO     epoch complete!
2024-04-26 12:49:47 INFO     evaluating now!
2024-04-26 12:49:48 INFO     Epoch [37/200] train_loss: 4.1790, val_loss: 5.1992, lr: 0.003000, 6.08s
2024-04-26 12:49:53 INFO     epoch complete!
2024-04-26 12:49:53 INFO     evaluating now!
2024-04-26 12:49:54 INFO     Epoch [38/200] train_loss: 4.1460, val_loss: 4.9694, lr: 0.003000, 5.94s
2024-04-26 12:49:54 INFO     Saved model at 38
2024-04-26 12:49:54 INFO     Val loss decrease from 5.1183 to 4.9694, saving to ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-04-26 12:50:00 INFO     epoch complete!
2024-04-26 12:50:00 INFO     evaluating now!
2024-04-26 12:50:00 INFO     Epoch [39/200] train_loss: 4.0936, val_loss: 5.4199, lr: 0.003000, 6.17s
2024-04-26 12:50:05 INFO     epoch complete!
2024-04-26 12:50:05 INFO     evaluating now!
2024-04-26 12:50:06 INFO     Epoch [40/200] train_loss: 4.0878, val_loss: 5.1530, lr: 0.003000, 5.65s
2024-04-26 12:50:11 INFO     epoch complete!
2024-04-26 12:50:11 INFO     evaluating now!
2024-04-26 12:50:11 INFO     Epoch [41/200] train_loss: 4.0364, val_loss: 5.1959, lr: 0.003000, 5.59s
2024-04-26 12:50:16 INFO     epoch complete!
2024-04-26 12:50:16 INFO     evaluating now!
2024-04-26 12:50:17 INFO     Epoch [42/200] train_loss: 3.9681, val_loss: 5.1501, lr: 0.003000, 5.64s
2024-04-26 12:50:22 INFO     epoch complete!
2024-04-26 12:50:22 INFO     evaluating now!
2024-04-26 12:50:23 INFO     Epoch [43/200] train_loss: 3.9510, val_loss: 5.1101, lr: 0.003000, 5.86s
2024-04-26 12:50:28 INFO     epoch complete!
2024-04-26 12:50:28 INFO     evaluating now!
2024-04-26 12:50:28 INFO     Epoch [44/200] train_loss: 3.9732, val_loss: 5.3093, lr: 0.003000, 5.64s
2024-04-26 12:50:34 INFO     epoch complete!
2024-04-26 12:50:34 INFO     evaluating now!
2024-04-26 12:50:34 INFO     Epoch [45/200] train_loss: 3.9848, val_loss: 5.1294, lr: 0.003000, 5.96s
2024-04-26 12:50:40 INFO     epoch complete!
2024-04-26 12:50:40 INFO     evaluating now!
2024-04-26 12:50:40 INFO     Epoch [46/200] train_loss: 3.9922, val_loss: 5.1327, lr: 0.003000, 5.81s
2024-04-26 12:50:45 INFO     epoch complete!
2024-04-26 12:50:45 INFO     evaluating now!
2024-04-26 12:50:46 INFO     Epoch [47/200] train_loss: 3.8849, val_loss: 5.1889, lr: 0.003000, 5.75s
2024-04-26 12:50:51 INFO     epoch complete!
2024-04-26 12:50:51 INFO     evaluating now!
2024-04-26 12:50:52 INFO     Epoch [48/200] train_loss: 3.8897, val_loss: 5.1349, lr: 0.003000, 5.82s
2024-04-26 12:50:57 INFO     epoch complete!
2024-04-26 12:50:57 INFO     evaluating now!
2024-04-26 12:50:58 INFO     Epoch [49/200] train_loss: 3.8801, val_loss: 5.1474, lr: 0.003000, 5.94s
2024-04-26 12:51:03 INFO     epoch complete!
2024-04-26 12:51:03 INFO     evaluating now!
2024-04-26 12:51:04 INFO     Epoch [50/200] train_loss: 3.8268, val_loss: 5.1127, lr: 0.003000, 6.19s
2024-04-26 12:51:09 INFO     epoch complete!
2024-04-26 12:51:09 INFO     evaluating now!
2024-04-26 12:51:10 INFO     Epoch [51/200] train_loss: 3.9039, val_loss: 5.3063, lr: 0.003000, 5.72s
2024-04-26 12:51:15 INFO     epoch complete!
2024-04-26 12:51:15 INFO     evaluating now!
2024-04-26 12:51:16 INFO     Epoch [52/200] train_loss: 3.8132, val_loss: 5.0627, lr: 0.003000, 6.02s
2024-04-26 12:51:21 INFO     epoch complete!
2024-04-26 12:51:21 INFO     evaluating now!
2024-04-26 12:51:21 INFO     Epoch [53/200] train_loss: 3.7411, val_loss: 5.0737, lr: 0.003000, 5.90s
2024-04-26 12:51:21 WARNING  Early stopping at epoch: 53
2024-04-26 12:51:21 INFO     Trained totally 54 epochs, average train time is 5.458s, average eval time is 0.419s
2024-04-26 12:51:22 INFO     Loaded model at 38
2024-04-26 12:51:22 INFO     Saved model at ./libcity/cache/13/model_cache/AGCRN_CHITaxi20190406.m
2024-04-26 12:51:22 INFO     Start evaluating ...
2024-04-26 12:51:24 INFO     Note that you select the single mode to evaluate!
2024-04-26 12:51:24 INFO     Evaluate result is saved at ./libcity/cache/13/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-26 12:51:24 INFO     
         MAE       RMSE
1   2.647213   8.345059
2   2.603348   8.360299
3   2.768956   8.818604
4   2.880949   9.839973
5   3.163227  11.220977
6   3.332445  12.426015
7   3.378551  13.232183
8   3.348900  13.468387
9   3.400949  13.667685
10  3.397990  13.814937
11  3.544928  14.242742
12  3.667808  14.794596
2024-04-26 12:51:24 INFO     ----------------------------------------------------------------------------
2024-04-26 12:51:24 INFO     # 4, Kownledge Graph Embedding: MuRE, Experiment ids: 14
2024-04-26 12:51:24 INFO     ----------------------------------------------------------------------------
2024-04-26 12:51:25 INFO     Log directory: ./libcity/log
2024-04-26 12:51:25 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=14
2024-04-26 12:51:25 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 488874703, 'exp_id': 14, 'load_external': True, 'embedding_model': 'MuRE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-26 12:51:25 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-26 12:51:25 INFO     set_weight_link_or_dist: dist
2024-04-26 12:51:25 INFO     init_weight_inf_or_zero: inf
2024-04-26 12:51:25 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-26 12:51:25 INFO     Start Calculate the weight by Gauss kernel!
2024-04-26 12:51:25 INFO     Loading file CHITaxi20190406.dyna
2024-04-26 12:51:26 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-26 12:51:29 INFO     Dataset created
2024-04-26 12:51:29 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-26 12:51:29 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-26 12:51:29 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-26 12:51:29 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-26 12:51:29 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-26 12:51:29 INFO     NoneScaler
2024-04-26 12:51:31 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-26 12:51:31 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-26 12:51:31 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-26 12:51:31 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-26 12:51:31 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-26 12:51:31 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-26 12:51:31 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-26 12:51:31 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-26 12:51:31 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-26 12:51:31 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-26 12:51:31 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-26 12:51:31 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-26 12:51:31 INFO     Total parameter numbers: 874010
2024-04-26 12:51:31 INFO     You select `adam` optimizer.
2024-04-26 12:51:31 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-26 12:51:31 INFO     Start training ...
2024-04-26 12:51:31 INFO     num_batches:48
2024-04-26 12:51:37 INFO     epoch complete!
2024-04-26 12:51:37 INFO     evaluating now!
2024-04-26 12:51:38 INFO     Epoch [0/200] train_loss: 23.6183, val_loss: 18.2772, lr: 0.003000, 6.09s
2024-04-26 12:51:38 INFO     Saved model at 0
2024-04-26 12:51:38 INFO     Val loss decrease from inf to 18.2772, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-26 12:51:43 INFO     epoch complete!
2024-04-26 12:51:43 INFO     evaluating now!
2024-04-26 12:51:44 INFO     Epoch [1/200] train_loss: 14.8236, val_loss: 14.4518, lr: 0.003000, 6.02s
2024-04-26 12:51:44 INFO     Saved model at 1
2024-04-26 12:51:44 INFO     Val loss decrease from 18.2772 to 14.4518, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-26 12:51:50 INFO     epoch complete!
2024-04-26 12:51:50 INFO     evaluating now!
2024-04-26 12:51:50 INFO     Epoch [2/200] train_loss: 12.4394, val_loss: 11.9983, lr: 0.003000, 6.14s
2024-04-26 12:51:50 INFO     Saved model at 2
2024-04-26 12:51:50 INFO     Val loss decrease from 14.4518 to 11.9983, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-26 12:51:56 INFO     epoch complete!
2024-04-26 12:51:56 INFO     evaluating now!
2024-04-26 12:51:56 INFO     Epoch [3/200] train_loss: 10.0888, val_loss: 9.5820, lr: 0.003000, 6.07s
2024-04-26 12:51:56 INFO     Saved model at 3
2024-04-26 12:51:56 INFO     Val loss decrease from 11.9983 to 9.5820, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-26 12:52:02 INFO     epoch complete!
2024-04-26 12:52:02 INFO     evaluating now!
2024-04-26 12:52:03 INFO     Epoch [4/200] train_loss: 8.3903, val_loss: 7.7784, lr: 0.003000, 6.22s
2024-04-26 12:52:03 INFO     Saved model at 4
2024-04-26 12:52:03 INFO     Val loss decrease from 9.5820 to 7.7784, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-26 12:52:09 INFO     epoch complete!
2024-04-26 12:52:09 INFO     evaluating now!
2024-04-26 12:52:09 INFO     Epoch [5/200] train_loss: 7.4886, val_loss: 7.1683, lr: 0.003000, 6.13s
2024-04-26 12:52:09 INFO     Saved model at 5
2024-04-26 12:52:09 INFO     Val loss decrease from 7.7784 to 7.1683, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-26 12:52:15 INFO     epoch complete!
2024-04-26 12:52:15 INFO     evaluating now!
2024-04-26 12:52:15 INFO     Epoch [6/200] train_loss: 6.9418, val_loss: 6.6567, lr: 0.003000, 6.24s
2024-04-26 12:52:16 INFO     Saved model at 6
2024-04-26 12:52:16 INFO     Val loss decrease from 7.1683 to 6.6567, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-26 12:52:21 INFO     epoch complete!
2024-04-26 12:52:21 INFO     evaluating now!
2024-04-26 12:52:22 INFO     Epoch [7/200] train_loss: 6.5475, val_loss: 6.5316, lr: 0.003000, 6.15s
2024-04-26 12:52:22 INFO     Saved model at 7
2024-04-26 12:52:22 INFO     Val loss decrease from 6.6567 to 6.5316, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-26 12:52:28 INFO     epoch complete!
2024-04-26 12:52:28 INFO     evaluating now!
2024-04-26 12:52:28 INFO     Epoch [8/200] train_loss: 6.3333, val_loss: 6.6300, lr: 0.003000, 6.13s
2024-04-26 12:52:34 INFO     epoch complete!
2024-04-26 12:52:34 INFO     evaluating now!
2024-04-26 12:52:34 INFO     Epoch [9/200] train_loss: 6.0016, val_loss: 6.0569, lr: 0.003000, 6.09s
2024-04-26 12:52:34 INFO     Saved model at 9
2024-04-26 12:52:34 INFO     Val loss decrease from 6.5316 to 6.0569, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-26 12:52:40 INFO     epoch complete!
2024-04-26 12:52:40 INFO     evaluating now!
2024-04-26 12:52:41 INFO     Epoch [10/200] train_loss: 5.8239, val_loss: 6.2410, lr: 0.003000, 6.25s
2024-04-26 12:52:46 INFO     epoch complete!
2024-04-26 12:52:46 INFO     evaluating now!
2024-04-26 12:52:47 INFO     Epoch [11/200] train_loss: 5.6141, val_loss: 5.7274, lr: 0.003000, 6.23s
2024-04-26 12:52:47 INFO     Saved model at 11
2024-04-26 12:52:47 INFO     Val loss decrease from 6.0569 to 5.7274, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-26 12:52:53 INFO     epoch complete!
2024-04-26 12:52:53 INFO     evaluating now!
2024-04-26 12:52:53 INFO     Epoch [12/200] train_loss: 5.5428, val_loss: 5.8194, lr: 0.003000, 6.13s
2024-04-26 12:52:59 INFO     epoch complete!
2024-04-26 12:52:59 INFO     evaluating now!
2024-04-26 12:52:59 INFO     Epoch [13/200] train_loss: 5.4098, val_loss: 5.6468, lr: 0.003000, 6.19s
2024-04-26 12:52:59 INFO     Saved model at 13
2024-04-26 12:52:59 INFO     Val loss decrease from 5.7274 to 5.6468, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-26 12:53:05 INFO     epoch complete!
2024-04-26 12:53:05 INFO     evaluating now!
2024-04-26 12:53:06 INFO     Epoch [14/200] train_loss: 5.1874, val_loss: 5.4105, lr: 0.003000, 6.21s
2024-04-26 12:53:06 INFO     Saved model at 14
2024-04-26 12:53:06 INFO     Val loss decrease from 5.6468 to 5.4105, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-26 12:53:11 INFO     epoch complete!
2024-04-26 12:53:11 INFO     evaluating now!
2024-04-26 12:53:12 INFO     Epoch [15/200] train_loss: 5.1851, val_loss: 5.6673, lr: 0.003000, 6.04s
2024-04-26 12:53:17 INFO     epoch complete!
2024-04-26 12:53:17 INFO     evaluating now!
2024-04-26 12:53:18 INFO     Epoch [16/200] train_loss: 5.0983, val_loss: 5.6949, lr: 0.003000, 6.09s
2024-04-26 12:53:23 INFO     epoch complete!
2024-04-26 12:53:23 INFO     evaluating now!
2024-04-26 12:53:24 INFO     Epoch [17/200] train_loss: 5.0194, val_loss: 5.4125, lr: 0.003000, 6.16s
2024-04-26 12:53:30 INFO     epoch complete!
2024-04-26 12:53:30 INFO     evaluating now!
2024-04-26 12:53:30 INFO     Epoch [18/200] train_loss: 4.9146, val_loss: 5.4298, lr: 0.003000, 6.07s
2024-04-26 12:53:36 INFO     epoch complete!
2024-04-26 12:53:36 INFO     evaluating now!
2024-04-26 12:53:36 INFO     Epoch [19/200] train_loss: 4.8759, val_loss: 5.4034, lr: 0.003000, 6.15s
2024-04-26 12:53:36 INFO     Saved model at 19
2024-04-26 12:53:36 INFO     Val loss decrease from 5.4105 to 5.4034, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-26 12:53:42 INFO     epoch complete!
2024-04-26 12:53:42 INFO     evaluating now!
2024-04-26 12:53:43 INFO     Epoch [20/200] train_loss: 4.7806, val_loss: 5.5569, lr: 0.003000, 6.07s
2024-04-26 12:53:48 INFO     epoch complete!
2024-04-26 12:53:48 INFO     evaluating now!
2024-04-26 12:53:49 INFO     Epoch [21/200] train_loss: 4.7312, val_loss: 5.2941, lr: 0.003000, 6.06s
2024-04-26 12:53:49 INFO     Saved model at 21
2024-04-26 12:53:49 INFO     Val loss decrease from 5.4034 to 5.2941, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-26 12:53:54 INFO     epoch complete!
2024-04-26 12:53:54 INFO     evaluating now!
2024-04-26 12:53:55 INFO     Epoch [22/200] train_loss: 4.6865, val_loss: 5.3493, lr: 0.003000, 6.13s
2024-04-26 12:54:01 INFO     epoch complete!
2024-04-26 12:54:01 INFO     evaluating now!
2024-04-26 12:54:01 INFO     Epoch [23/200] train_loss: 4.7343, val_loss: 5.2370, lr: 0.003000, 6.11s
2024-04-26 12:54:01 INFO     Saved model at 23
2024-04-26 12:54:01 INFO     Val loss decrease from 5.2941 to 5.2370, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-26 12:54:07 INFO     epoch complete!
2024-04-26 12:54:07 INFO     evaluating now!
2024-04-26 12:54:07 INFO     Epoch [24/200] train_loss: 4.5502, val_loss: 5.3350, lr: 0.003000, 6.19s
2024-04-26 12:54:14 INFO     epoch complete!
2024-04-26 12:54:14 INFO     evaluating now!
2024-04-26 12:54:14 INFO     Epoch [25/200] train_loss: 4.4750, val_loss: 5.2933, lr: 0.003000, 6.64s
2024-04-26 12:54:20 INFO     epoch complete!
2024-04-26 12:54:20 INFO     evaluating now!
2024-04-26 12:54:21 INFO     Epoch [26/200] train_loss: 4.4484, val_loss: 5.1035, lr: 0.003000, 6.75s
2024-04-26 12:54:21 INFO     Saved model at 26
2024-04-26 12:54:21 INFO     Val loss decrease from 5.2370 to 5.1035, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-04-26 12:54:27 INFO     epoch complete!
2024-04-26 12:54:27 INFO     evaluating now!
2024-04-26 12:54:28 INFO     Epoch [27/200] train_loss: 4.4699, val_loss: 5.4402, lr: 0.003000, 6.71s
2024-04-26 12:54:33 INFO     epoch complete!
2024-04-26 12:54:33 INFO     evaluating now!
2024-04-26 12:54:34 INFO     Epoch [28/200] train_loss: 4.3655, val_loss: 5.2406, lr: 0.003000, 6.19s
2024-04-26 12:54:39 INFO     epoch complete!
2024-04-26 12:54:39 INFO     evaluating now!
2024-04-26 12:54:40 INFO     Epoch [29/200] train_loss: 4.3707, val_loss: 5.1495, lr: 0.003000, 6.07s
2024-04-26 12:54:45 INFO     epoch complete!
2024-04-26 12:54:45 INFO     evaluating now!
2024-04-26 12:54:46 INFO     Epoch [30/200] train_loss: 4.7268, val_loss: 5.1974, lr: 0.003000, 5.96s
2024-04-26 12:54:52 INFO     epoch complete!
2024-04-26 12:54:52 INFO     evaluating now!
2024-04-26 12:54:52 INFO     Epoch [31/200] train_loss: 4.4150, val_loss: 5.1429, lr: 0.003000, 6.16s
2024-04-26 12:54:58 INFO     epoch complete!
2024-04-26 12:54:58 INFO     evaluating now!
2024-04-26 12:54:58 INFO     Epoch [32/200] train_loss: 4.2824, val_loss: 5.1465, lr: 0.003000, 6.20s
2024-04-26 12:55:04 INFO     epoch complete!
2024-04-26 12:55:04 INFO     evaluating now!
2024-04-26 12:55:05 INFO     Epoch [33/200] train_loss: 4.2959, val_loss: 5.0877, lr: 0.003000, 6.41s
2024-04-26 12:55:05 INFO     Saved model at 33
2024-04-26 12:55:05 INFO     Val loss decrease from 5.1035 to 5.0877, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-04-26 12:55:10 INFO     epoch complete!
2024-04-26 12:55:10 INFO     evaluating now!
2024-04-26 12:55:11 INFO     Epoch [34/200] train_loss: 4.1920, val_loss: 5.0630, lr: 0.003000, 5.81s
2024-04-26 12:55:11 INFO     Saved model at 34
2024-04-26 12:55:11 INFO     Val loss decrease from 5.0877 to 5.0630, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-04-26 12:55:16 INFO     epoch complete!
2024-04-26 12:55:16 INFO     evaluating now!
2024-04-26 12:55:17 INFO     Epoch [35/200] train_loss: 4.1532, val_loss: 5.2205, lr: 0.003000, 6.13s
2024-04-26 12:55:22 INFO     epoch complete!
2024-04-26 12:55:22 INFO     evaluating now!
2024-04-26 12:55:23 INFO     Epoch [36/200] train_loss: 4.1488, val_loss: 5.1460, lr: 0.003000, 5.88s
2024-04-26 12:55:28 INFO     epoch complete!
2024-04-26 12:55:28 INFO     evaluating now!
2024-04-26 12:55:29 INFO     Epoch [37/200] train_loss: 4.1061, val_loss: 5.2018, lr: 0.003000, 6.04s
2024-04-26 12:55:34 INFO     epoch complete!
2024-04-26 12:55:34 INFO     evaluating now!
2024-04-26 12:55:35 INFO     Epoch [38/200] train_loss: 4.0817, val_loss: 5.1383, lr: 0.003000, 5.89s
2024-04-26 12:55:40 INFO     epoch complete!
2024-04-26 12:55:40 INFO     evaluating now!
2024-04-26 12:55:40 INFO     Epoch [39/200] train_loss: 4.0708, val_loss: 5.0377, lr: 0.003000, 5.52s
2024-04-26 12:55:40 INFO     Saved model at 39
2024-04-26 12:55:40 INFO     Val loss decrease from 5.0630 to 5.0377, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-04-26 12:55:46 INFO     epoch complete!
2024-04-26 12:55:46 INFO     evaluating now!
2024-04-26 12:55:46 INFO     Epoch [40/200] train_loss: 4.0992, val_loss: 5.0860, lr: 0.003000, 5.51s
2024-04-26 12:55:51 INFO     epoch complete!
2024-04-26 12:55:51 INFO     evaluating now!
2024-04-26 12:55:52 INFO     Epoch [41/200] train_loss: 4.0169, val_loss: 5.2555, lr: 0.003000, 5.63s
2024-04-26 12:55:57 INFO     epoch complete!
2024-04-26 12:55:57 INFO     evaluating now!
2024-04-26 12:55:57 INFO     Epoch [42/200] train_loss: 3.9608, val_loss: 5.2391, lr: 0.003000, 5.64s
2024-04-26 12:56:02 INFO     epoch complete!
2024-04-26 12:56:02 INFO     evaluating now!
2024-04-26 12:56:03 INFO     Epoch [43/200] train_loss: 3.9915, val_loss: 5.2227, lr: 0.003000, 5.53s
2024-04-26 12:56:08 INFO     epoch complete!
2024-04-26 12:56:08 INFO     evaluating now!
2024-04-26 12:56:08 INFO     Epoch [44/200] train_loss: 3.9052, val_loss: 5.1084, lr: 0.003000, 5.47s
2024-04-26 12:56:13 INFO     epoch complete!
2024-04-26 12:56:13 INFO     evaluating now!
2024-04-26 12:56:14 INFO     Epoch [45/200] train_loss: 3.8619, val_loss: 5.0503, lr: 0.003000, 5.59s
2024-04-26 12:56:19 INFO     epoch complete!
2024-04-26 12:56:19 INFO     evaluating now!
2024-04-26 12:56:19 INFO     Epoch [46/200] train_loss: 3.8796, val_loss: 5.0814, lr: 0.003000, 5.67s
2024-04-26 12:56:25 INFO     epoch complete!
2024-04-26 12:56:25 INFO     evaluating now!
2024-04-26 12:56:25 INFO     Epoch [47/200] train_loss: 3.8965, val_loss: 5.1215, lr: 0.003000, 5.88s
2024-04-26 12:56:31 INFO     epoch complete!
2024-04-26 12:56:31 INFO     evaluating now!
2024-04-26 12:56:31 INFO     Epoch [48/200] train_loss: 3.8539, val_loss: 5.0829, lr: 0.003000, 6.01s
2024-04-26 12:56:37 INFO     epoch complete!
2024-04-26 12:56:37 INFO     evaluating now!
2024-04-26 12:56:37 INFO     Epoch [49/200] train_loss: 3.8207, val_loss: 5.0183, lr: 0.003000, 5.85s
2024-04-26 12:56:37 INFO     Saved model at 49
2024-04-26 12:56:37 INFO     Val loss decrease from 5.0377 to 5.0183, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-04-26 12:56:43 INFO     epoch complete!
2024-04-26 12:56:43 INFO     evaluating now!
2024-04-26 12:56:43 INFO     Epoch [50/200] train_loss: 3.7787, val_loss: 4.9874, lr: 0.003000, 5.73s
2024-04-26 12:56:43 INFO     Saved model at 50
2024-04-26 12:56:43 INFO     Val loss decrease from 5.0183 to 4.9874, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch50.tar
2024-04-26 12:56:48 INFO     epoch complete!
2024-04-26 12:56:48 INFO     evaluating now!
2024-04-26 12:56:49 INFO     Epoch [51/200] train_loss: 3.7147, val_loss: 4.9038, lr: 0.003000, 5.67s
2024-04-26 12:56:49 INFO     Saved model at 51
2024-04-26 12:56:49 INFO     Val loss decrease from 4.9874 to 4.9038, saving to ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-04-26 12:56:54 INFO     epoch complete!
2024-04-26 12:56:54 INFO     evaluating now!
2024-04-26 12:56:55 INFO     Epoch [52/200] train_loss: 3.7089, val_loss: 5.0926, lr: 0.003000, 5.98s
2024-04-26 12:57:00 INFO     epoch complete!
2024-04-26 12:57:00 INFO     evaluating now!
2024-04-26 12:57:01 INFO     Epoch [53/200] train_loss: 3.7812, val_loss: 5.1323, lr: 0.003000, 5.90s
2024-04-26 12:57:06 INFO     epoch complete!
2024-04-26 12:57:06 INFO     evaluating now!
2024-04-26 12:57:07 INFO     Epoch [54/200] train_loss: 3.6945, val_loss: 5.1083, lr: 0.003000, 5.73s
2024-04-26 12:57:12 INFO     epoch complete!
2024-04-26 12:57:12 INFO     evaluating now!
2024-04-26 12:57:13 INFO     Epoch [55/200] train_loss: 3.6778, val_loss: 5.0746, lr: 0.003000, 5.99s
2024-04-26 12:57:18 INFO     epoch complete!
2024-04-26 12:57:18 INFO     evaluating now!
2024-04-26 12:57:18 INFO     Epoch [56/200] train_loss: 3.6541, val_loss: 5.0134, lr: 0.003000, 5.53s
2024-04-26 12:57:23 INFO     epoch complete!
2024-04-26 12:57:23 INFO     evaluating now!
2024-04-26 12:57:24 INFO     Epoch [57/200] train_loss: 3.6592, val_loss: 5.1555, lr: 0.003000, 5.58s
2024-04-26 12:57:29 INFO     epoch complete!
2024-04-26 12:57:29 INFO     evaluating now!
2024-04-26 12:57:29 INFO     Epoch [58/200] train_loss: 3.6073, val_loss: 5.1586, lr: 0.003000, 5.47s
2024-04-26 12:57:34 INFO     epoch complete!
2024-04-26 12:57:34 INFO     evaluating now!
2024-04-26 12:57:35 INFO     Epoch [59/200] train_loss: 3.6132, val_loss: 5.1463, lr: 0.003000, 5.58s
2024-04-26 12:57:40 INFO     epoch complete!
2024-04-26 12:57:40 INFO     evaluating now!
2024-04-26 12:57:40 INFO     Epoch [60/200] train_loss: 3.6147, val_loss: 5.1024, lr: 0.003000, 5.43s
2024-04-26 12:57:45 INFO     epoch complete!
2024-04-26 12:57:45 INFO     evaluating now!
2024-04-26 12:57:45 INFO     Epoch [61/200] train_loss: 3.5878, val_loss: 5.1076, lr: 0.003000, 5.37s
2024-04-26 12:57:51 INFO     epoch complete!
2024-04-26 12:57:51 INFO     evaluating now!
2024-04-26 12:57:51 INFO     Epoch [62/200] train_loss: 3.5772, val_loss: 5.1346, lr: 0.003000, 5.54s
2024-04-26 12:57:56 INFO     epoch complete!
2024-04-26 12:57:56 INFO     evaluating now!
2024-04-26 12:57:57 INFO     Epoch [63/200] train_loss: 3.5910, val_loss: 5.0397, lr: 0.003000, 5.52s
2024-04-26 12:58:02 INFO     epoch complete!
2024-04-26 12:58:02 INFO     evaluating now!
2024-04-26 12:58:02 INFO     Epoch [64/200] train_loss: 3.5450, val_loss: 4.9540, lr: 0.003000, 5.81s
2024-04-26 12:58:08 INFO     epoch complete!
2024-04-26 12:58:08 INFO     evaluating now!
2024-04-26 12:58:08 INFO     Epoch [65/200] train_loss: 3.4942, val_loss: 4.9970, lr: 0.003000, 5.68s
2024-04-26 12:58:13 INFO     epoch complete!
2024-04-26 12:58:13 INFO     evaluating now!
2024-04-26 12:58:13 INFO     Epoch [66/200] train_loss: 3.5397, val_loss: 5.0510, lr: 0.003000, 5.39s
2024-04-26 12:58:13 WARNING  Early stopping at epoch: 66
2024-04-26 12:58:13 INFO     Trained totally 67 epochs, average train time is 5.535s, average eval time is 0.410s
2024-04-26 12:58:19 INFO     Loaded model at 51
2024-04-26 12:58:19 INFO     Saved model at ./libcity/cache/14/model_cache/AGCRN_CHITaxi20190406.m
2024-04-26 12:58:19 INFO     Start evaluating ...
2024-04-26 12:58:21 INFO     Note that you select the single mode to evaluate!
2024-04-26 12:58:22 INFO     Evaluate result is saved at ./libcity/cache/14/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-26 12:58:22 INFO     
         MAE       RMSE
1   2.426388   7.142201
2   2.515215   7.736360
3   2.671655   8.623883
4   2.769768   9.271158
5   2.834926  10.152767
6   3.058069  11.398689
7   3.096595  12.477037
8   3.224463  13.250583
9   3.243930  13.549980
10  3.322789  13.597201
11  3.376673  13.740112
12  3.574739  14.178926
2024-04-26 12:58:22 INFO     ----------------------------------------------------------------------------
2024-04-26 12:58:22 INFO     Kownledge Graph Embedding: MuRE, Experiment ids: [10, 11, 12, 13, 14]
2024-04-26 12:58:22 INFO     ----------------------------------------------------------------------------
2024-04-26 12:58:22 INFO     Average: 
         MAE       RMSE
0   2.455575   7.388550
1   2.528667   7.855233
2   2.688499   8.681815
3   2.793622   9.452855
4   2.955487  10.452411
5   3.120270  11.586844
6   3.226385  12.548879
7   3.284435  13.232029
8   3.328869  13.602929
9   3.372756  13.751111
10  3.431721  13.942386
11  3.547082  14.412657 
2024-04-26 12:58:22 INFO     Standard deviation: 
         MAE      RMSE
0   0.107075  0.529994
1   0.073664  0.278371
2   0.053454  0.109603
3   0.068854  0.209262
4   0.124926  0.399705
5   0.121379  0.466765
6   0.109852  0.425893
7   0.079047  0.370407
8   0.082250  0.365536
9   0.055386  0.449933
10  0.069291  0.436032
11  0.074748  0.508125
2024-04-26 12:58:22 INFO     ----------------------------------------------------------------------------
2024-04-26 12:58:22 INFO     12 steps Average: 
        MAE       RMSE
0  3.061114  11.408975
2024-04-26 12:58:22 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.084994  0.379135
