2024-05-01 13:35:33 INFO     ----------------------------------------------------------------------------
2024-05-01 13:35:33 INFO     # 0, Kownledge Graph Embedding: GIE, Experiment ids: 15
2024-05-01 13:35:33 INFO     ----------------------------------------------------------------------------
2024-05-01 13:35:33 INFO     Log directory: ./libcity/log
2024-05-01 13:35:33 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=15
2024-05-01 13:35:33 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 285264460, 'exp_id': 15, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 13:35:33 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 13:35:33 INFO     set_weight_link_or_dist: dist
2024-05-01 13:35:33 INFO     init_weight_inf_or_zero: inf
2024-05-01 13:35:33 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 13:35:33 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 13:35:33 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 13:35:34 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 13:35:36 INFO     Dataset created
2024-05-01 13:35:36 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 13:35:36 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 13:35:36 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 13:35:36 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 13:35:36 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 13:35:37 INFO     NormalScaler max: 0.3243229993054587
2024-05-01 13:35:42 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 13:35:42 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 13:35:42 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 13:35:42 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 13:35:42 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 13:35:42 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 13:35:42 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 13:35:42 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 13:35:42 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 13:35:42 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 13:35:42 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 13:35:42 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 13:35:42 INFO     Total parameter numbers: 874010
2024-05-01 13:35:42 INFO     You select `adam` optimizer.
2024-05-01 13:35:42 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 13:35:42 INFO     Start training ...
2024-05-01 13:35:42 INFO     num_batches:48
2024-05-01 13:35:48 INFO     epoch complete!
2024-05-01 13:35:48 INFO     evaluating now!
2024-05-01 13:35:48 INFO     Epoch [0/200] train_loss: 25.2170, val_loss: 19.0269, lr: 0.003000, 6.50s
2024-05-01 13:35:48 INFO     Saved model at 0
2024-05-01 13:35:48 INFO     Val loss decrease from inf to 19.0269, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 13:35:54 INFO     epoch complete!
2024-05-01 13:35:54 INFO     evaluating now!
2024-05-01 13:35:54 INFO     Epoch [1/200] train_loss: 16.1520, val_loss: 15.8885, lr: 0.003000, 6.10s
2024-05-01 13:35:55 INFO     Saved model at 1
2024-05-01 13:35:55 INFO     Val loss decrease from 19.0269 to 15.8885, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 13:36:00 INFO     epoch complete!
2024-05-01 13:36:00 INFO     evaluating now!
2024-05-01 13:36:00 INFO     Epoch [2/200] train_loss: 13.5588, val_loss: 13.6502, lr: 0.003000, 5.95s
2024-05-01 13:36:01 INFO     Saved model at 2
2024-05-01 13:36:01 INFO     Val loss decrease from 15.8885 to 13.6502, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 13:36:06 INFO     epoch complete!
2024-05-01 13:36:06 INFO     evaluating now!
2024-05-01 13:36:07 INFO     Epoch [3/200] train_loss: 11.5418, val_loss: 11.5127, lr: 0.003000, 6.04s
2024-05-01 13:36:07 INFO     Saved model at 3
2024-05-01 13:36:07 INFO     Val loss decrease from 13.6502 to 11.5127, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 13:36:12 INFO     epoch complete!
2024-05-01 13:36:12 INFO     evaluating now!
2024-05-01 13:36:13 INFO     Epoch [4/200] train_loss: 10.0902, val_loss: 10.0336, lr: 0.003000, 6.00s
2024-05-01 13:36:13 INFO     Saved model at 4
2024-05-01 13:36:13 INFO     Val loss decrease from 11.5127 to 10.0336, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 13:36:18 INFO     epoch complete!
2024-05-01 13:36:18 INFO     evaluating now!
2024-05-01 13:36:19 INFO     Epoch [5/200] train_loss: 8.8774, val_loss: 8.9373, lr: 0.003000, 5.89s
2024-05-01 13:36:19 INFO     Saved model at 5
2024-05-01 13:36:19 INFO     Val loss decrease from 10.0336 to 8.9373, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 13:36:24 INFO     epoch complete!
2024-05-01 13:36:24 INFO     evaluating now!
2024-05-01 13:36:24 INFO     Epoch [6/200] train_loss: 8.0645, val_loss: 7.8200, lr: 0.003000, 5.46s
2024-05-01 13:36:24 INFO     Saved model at 6
2024-05-01 13:36:24 INFO     Val loss decrease from 8.9373 to 7.8200, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 13:36:29 INFO     epoch complete!
2024-05-01 13:36:29 INFO     evaluating now!
2024-05-01 13:36:30 INFO     Epoch [7/200] train_loss: 7.5286, val_loss: 7.3695, lr: 0.003000, 5.60s
2024-05-01 13:36:30 INFO     Saved model at 7
2024-05-01 13:36:30 INFO     Val loss decrease from 7.8200 to 7.3695, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 13:36:35 INFO     epoch complete!
2024-05-01 13:36:35 INFO     evaluating now!
2024-05-01 13:36:35 INFO     Epoch [8/200] train_loss: 7.0969, val_loss: 7.2113, lr: 0.003000, 5.52s
2024-05-01 13:36:35 INFO     Saved model at 8
2024-05-01 13:36:35 INFO     Val loss decrease from 7.3695 to 7.2113, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-01 13:36:40 INFO     epoch complete!
2024-05-01 13:36:40 INFO     evaluating now!
2024-05-01 13:36:41 INFO     Epoch [9/200] train_loss: 6.8419, val_loss: 6.6852, lr: 0.003000, 5.51s
2024-05-01 13:36:41 INFO     Saved model at 9
2024-05-01 13:36:41 INFO     Val loss decrease from 7.2113 to 6.6852, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-01 13:36:46 INFO     epoch complete!
2024-05-01 13:36:46 INFO     evaluating now!
2024-05-01 13:36:46 INFO     Epoch [10/200] train_loss: 6.4106, val_loss: 6.8738, lr: 0.003000, 5.36s
2024-05-01 13:36:51 INFO     epoch complete!
2024-05-01 13:36:51 INFO     evaluating now!
2024-05-01 13:36:52 INFO     Epoch [11/200] train_loss: 6.2200, val_loss: 6.3545, lr: 0.003000, 5.61s
2024-05-01 13:36:52 INFO     Saved model at 11
2024-05-01 13:36:52 INFO     Val loss decrease from 6.6852 to 6.3545, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-01 13:36:57 INFO     epoch complete!
2024-05-01 13:36:57 INFO     evaluating now!
2024-05-01 13:36:57 INFO     Epoch [12/200] train_loss: 6.0721, val_loss: 6.4450, lr: 0.003000, 5.54s
2024-05-01 13:37:03 INFO     epoch complete!
2024-05-01 13:37:03 INFO     evaluating now!
2024-05-01 13:37:03 INFO     Epoch [13/200] train_loss: 5.9782, val_loss: 6.1334, lr: 0.003000, 5.49s
2024-05-01 13:37:03 INFO     Saved model at 13
2024-05-01 13:37:03 INFO     Val loss decrease from 6.3545 to 6.1334, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-01 13:37:08 INFO     epoch complete!
2024-05-01 13:37:08 INFO     evaluating now!
2024-05-01 13:37:08 INFO     Epoch [14/200] train_loss: 5.7709, val_loss: 6.0927, lr: 0.003000, 5.46s
2024-05-01 13:37:16 INFO     Saved model at 14
2024-05-01 13:37:16 INFO     Val loss decrease from 6.1334 to 6.0927, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-01 13:37:21 INFO     epoch complete!
2024-05-01 13:37:21 INFO     evaluating now!
2024-05-01 13:37:22 INFO     Epoch [15/200] train_loss: 5.7227, val_loss: 6.1452, lr: 0.003000, 5.51s
2024-05-01 13:37:27 INFO     epoch complete!
2024-05-01 13:37:27 INFO     evaluating now!
2024-05-01 13:37:27 INFO     Epoch [16/200] train_loss: 5.6245, val_loss: 5.9197, lr: 0.003000, 5.54s
2024-05-01 13:37:27 INFO     Saved model at 16
2024-05-01 13:37:27 INFO     Val loss decrease from 6.0927 to 5.9197, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-01 13:37:32 INFO     epoch complete!
2024-05-01 13:37:32 INFO     evaluating now!
2024-05-01 13:37:33 INFO     Epoch [17/200] train_loss: 5.5642, val_loss: 5.7547, lr: 0.003000, 5.50s
2024-05-01 13:37:33 INFO     Saved model at 17
2024-05-01 13:37:33 INFO     Val loss decrease from 5.9197 to 5.7547, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-01 13:37:38 INFO     epoch complete!
2024-05-01 13:37:38 INFO     evaluating now!
2024-05-01 13:37:38 INFO     Epoch [18/200] train_loss: 5.4226, val_loss: 5.7898, lr: 0.003000, 5.55s
2024-05-01 13:37:44 INFO     epoch complete!
2024-05-01 13:37:44 INFO     evaluating now!
2024-05-01 13:37:44 INFO     Epoch [19/200] train_loss: 5.2815, val_loss: 5.8458, lr: 0.003000, 5.53s
2024-05-01 13:37:49 INFO     epoch complete!
2024-05-01 13:37:49 INFO     evaluating now!
2024-05-01 13:37:49 INFO     Epoch [20/200] train_loss: 5.1988, val_loss: 5.4500, lr: 0.003000, 5.50s
2024-05-01 13:37:50 INFO     Saved model at 20
2024-05-01 13:37:50 INFO     Val loss decrease from 5.7547 to 5.4500, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-01 13:37:55 INFO     epoch complete!
2024-05-01 13:37:55 INFO     evaluating now!
2024-05-01 13:37:55 INFO     Epoch [21/200] train_loss: 5.2740, val_loss: 5.7060, lr: 0.003000, 5.42s
2024-05-01 13:38:00 INFO     epoch complete!
2024-05-01 13:38:00 INFO     evaluating now!
2024-05-01 13:38:00 INFO     Epoch [22/200] train_loss: 5.2233, val_loss: 5.5441, lr: 0.003000, 5.51s
2024-05-01 13:38:05 INFO     epoch complete!
2024-05-01 13:38:05 INFO     evaluating now!
2024-05-01 13:38:06 INFO     Epoch [23/200] train_loss: 5.0418, val_loss: 5.5992, lr: 0.003000, 5.39s
2024-05-01 13:38:11 INFO     epoch complete!
2024-05-01 13:38:11 INFO     evaluating now!
2024-05-01 13:38:11 INFO     Epoch [24/200] train_loss: 5.0026, val_loss: 5.4698, lr: 0.003000, 5.41s
2024-05-01 13:38:16 INFO     epoch complete!
2024-05-01 13:38:16 INFO     evaluating now!
2024-05-01 13:38:17 INFO     Epoch [25/200] train_loss: 4.9415, val_loss: 5.3887, lr: 0.003000, 5.55s
2024-05-01 13:38:17 INFO     Saved model at 25
2024-05-01 13:38:17 INFO     Val loss decrease from 5.4500 to 5.3887, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-01 13:38:22 INFO     epoch complete!
2024-05-01 13:38:22 INFO     evaluating now!
2024-05-01 13:38:22 INFO     Epoch [26/200] train_loss: 4.8880, val_loss: 5.4184, lr: 0.003000, 5.47s
2024-05-01 13:38:28 INFO     epoch complete!
2024-05-01 13:38:28 INFO     evaluating now!
2024-05-01 13:38:28 INFO     Epoch [27/200] train_loss: 4.9288, val_loss: 5.4114, lr: 0.003000, 5.66s
2024-05-01 13:38:33 INFO     epoch complete!
2024-05-01 13:38:33 INFO     evaluating now!
2024-05-01 13:38:33 INFO     Epoch [28/200] train_loss: 4.7809, val_loss: 5.4122, lr: 0.003000, 5.49s
2024-05-01 13:38:39 INFO     epoch complete!
2024-05-01 13:38:39 INFO     evaluating now!
2024-05-01 13:38:39 INFO     Epoch [29/200] train_loss: 4.7430, val_loss: 5.4766, lr: 0.003000, 5.46s
2024-05-01 13:38:44 INFO     epoch complete!
2024-05-01 13:38:44 INFO     evaluating now!
2024-05-01 13:38:44 INFO     Epoch [30/200] train_loss: 4.7335, val_loss: 5.4645, lr: 0.003000, 5.41s
2024-05-01 13:38:49 INFO     epoch complete!
2024-05-01 13:38:49 INFO     evaluating now!
2024-05-01 13:38:50 INFO     Epoch [31/200] train_loss: 4.6659, val_loss: 5.2466, lr: 0.003000, 5.51s
2024-05-01 13:38:50 INFO     Saved model at 31
2024-05-01 13:38:50 INFO     Val loss decrease from 5.3887 to 5.2466, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-05-01 13:38:55 INFO     epoch complete!
2024-05-01 13:38:55 INFO     evaluating now!
2024-05-01 13:38:55 INFO     Epoch [32/200] train_loss: 4.6804, val_loss: 5.2237, lr: 0.003000, 5.53s
2024-05-01 13:38:55 INFO     Saved model at 32
2024-05-01 13:38:55 INFO     Val loss decrease from 5.2466 to 5.2237, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-05-01 13:39:01 INFO     epoch complete!
2024-05-01 13:39:01 INFO     evaluating now!
2024-05-01 13:39:01 INFO     Epoch [33/200] train_loss: 4.5576, val_loss: 5.2167, lr: 0.003000, 5.59s
2024-05-01 13:39:01 INFO     Saved model at 33
2024-05-01 13:39:01 INFO     Val loss decrease from 5.2237 to 5.2167, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-05-01 13:39:06 INFO     epoch complete!
2024-05-01 13:39:06 INFO     evaluating now!
2024-05-01 13:39:06 INFO     Epoch [34/200] train_loss: 4.5162, val_loss: 5.2016, lr: 0.003000, 5.40s
2024-05-01 13:39:07 INFO     Saved model at 34
2024-05-01 13:39:07 INFO     Val loss decrease from 5.2167 to 5.2016, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-05-01 13:39:12 INFO     epoch complete!
2024-05-01 13:39:12 INFO     evaluating now!
2024-05-01 13:39:12 INFO     Epoch [35/200] train_loss: 4.4628, val_loss: 5.3673, lr: 0.003000, 5.44s
2024-05-01 13:39:17 INFO     epoch complete!
2024-05-01 13:39:17 INFO     evaluating now!
2024-05-01 13:39:17 INFO     Epoch [36/200] train_loss: 4.5099, val_loss: 5.2496, lr: 0.003000, 5.44s
2024-05-01 13:39:23 INFO     epoch complete!
2024-05-01 13:39:23 INFO     evaluating now!
2024-05-01 13:39:23 INFO     Epoch [37/200] train_loss: 4.3487, val_loss: 5.2604, lr: 0.003000, 5.53s
2024-05-01 13:39:28 INFO     epoch complete!
2024-05-01 13:39:28 INFO     evaluating now!
2024-05-01 13:39:28 INFO     Epoch [38/200] train_loss: 4.3629, val_loss: 5.1149, lr: 0.003000, 5.54s
2024-05-01 13:39:28 INFO     Saved model at 38
2024-05-01 13:39:28 INFO     Val loss decrease from 5.2016 to 5.1149, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-05-01 13:39:34 INFO     epoch complete!
2024-05-01 13:39:34 INFO     evaluating now!
2024-05-01 13:39:34 INFO     Epoch [39/200] train_loss: 4.3105, val_loss: 5.2069, lr: 0.003000, 5.57s
2024-05-01 13:39:39 INFO     epoch complete!
2024-05-01 13:39:39 INFO     evaluating now!
2024-05-01 13:39:40 INFO     Epoch [40/200] train_loss: 4.3344, val_loss: 5.2191, lr: 0.003000, 5.47s
2024-05-01 13:39:45 INFO     epoch complete!
2024-05-01 13:39:45 INFO     evaluating now!
2024-05-01 13:39:45 INFO     Epoch [41/200] train_loss: 4.3000, val_loss: 5.0429, lr: 0.003000, 5.48s
2024-05-01 13:39:45 INFO     Saved model at 41
2024-05-01 13:39:45 INFO     Val loss decrease from 5.1149 to 5.0429, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-05-01 13:39:50 INFO     epoch complete!
2024-05-01 13:39:50 INFO     evaluating now!
2024-05-01 13:39:50 INFO     Epoch [42/200] train_loss: 4.1962, val_loss: 5.1830, lr: 0.003000, 5.40s
2024-05-01 13:39:56 INFO     epoch complete!
2024-05-01 13:39:56 INFO     evaluating now!
2024-05-01 13:39:56 INFO     Epoch [43/200] train_loss: 4.2144, val_loss: 5.1646, lr: 0.003000, 5.48s
2024-05-01 13:40:01 INFO     epoch complete!
2024-05-01 13:40:01 INFO     evaluating now!
2024-05-01 13:40:02 INFO     Epoch [44/200] train_loss: 4.2413, val_loss: 5.1721, lr: 0.003000, 5.86s
2024-05-01 13:40:07 INFO     epoch complete!
2024-05-01 13:40:07 INFO     evaluating now!
2024-05-01 13:40:08 INFO     Epoch [45/200] train_loss: 4.1383, val_loss: 5.1383, lr: 0.003000, 5.93s
2024-05-01 13:40:13 INFO     epoch complete!
2024-05-01 13:40:13 INFO     evaluating now!
2024-05-01 13:40:14 INFO     Epoch [46/200] train_loss: 4.1103, val_loss: 5.1741, lr: 0.003000, 5.86s
2024-05-01 13:40:19 INFO     epoch complete!
2024-05-01 13:40:19 INFO     evaluating now!
2024-05-01 13:40:19 INFO     Epoch [47/200] train_loss: 4.1084, val_loss: 5.2272, lr: 0.003000, 5.76s
2024-05-01 13:40:25 INFO     epoch complete!
2024-05-01 13:40:25 INFO     evaluating now!
2024-05-01 13:40:26 INFO     Epoch [48/200] train_loss: 4.1181, val_loss: 5.1805, lr: 0.003000, 6.23s
2024-05-01 13:40:31 INFO     epoch complete!
2024-05-01 13:40:31 INFO     evaluating now!
2024-05-01 13:40:31 INFO     Epoch [49/200] train_loss: 4.0710, val_loss: 5.0657, lr: 0.003000, 5.77s
2024-05-01 13:40:37 INFO     epoch complete!
2024-05-01 13:40:37 INFO     evaluating now!
2024-05-01 13:40:37 INFO     Epoch [50/200] train_loss: 4.0810, val_loss: 5.1472, lr: 0.003000, 5.88s
2024-05-01 13:40:43 INFO     epoch complete!
2024-05-01 13:40:43 INFO     evaluating now!
2024-05-01 13:40:43 INFO     Epoch [51/200] train_loss: 4.0531, val_loss: 4.9559, lr: 0.003000, 6.02s
2024-05-01 13:40:43 INFO     Saved model at 51
2024-05-01 13:40:43 INFO     Val loss decrease from 5.0429 to 4.9559, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-05-01 13:40:49 INFO     epoch complete!
2024-05-01 13:40:49 INFO     evaluating now!
2024-05-01 13:40:49 INFO     Epoch [52/200] train_loss: 3.9562, val_loss: 5.0558, lr: 0.003000, 5.69s
2024-05-01 13:40:54 INFO     epoch complete!
2024-05-01 13:40:54 INFO     evaluating now!
2024-05-01 13:40:55 INFO     Epoch [53/200] train_loss: 3.9238, val_loss: 5.2155, lr: 0.003000, 5.76s
2024-05-01 13:41:00 INFO     epoch complete!
2024-05-01 13:41:00 INFO     evaluating now!
2024-05-01 13:41:01 INFO     Epoch [54/200] train_loss: 4.0064, val_loss: 5.1662, lr: 0.003000, 5.80s
2024-05-01 13:41:06 INFO     epoch complete!
2024-05-01 13:41:06 INFO     evaluating now!
2024-05-01 13:41:06 INFO     Epoch [55/200] train_loss: 3.9338, val_loss: 5.0748, lr: 0.003000, 5.67s
2024-05-01 13:41:11 INFO     epoch complete!
2024-05-01 13:41:11 INFO     evaluating now!
2024-05-01 13:41:12 INFO     Epoch [56/200] train_loss: 3.9301, val_loss: 4.9331, lr: 0.003000, 5.50s
2024-05-01 13:41:12 INFO     Saved model at 56
2024-05-01 13:41:12 INFO     Val loss decrease from 4.9559 to 4.9331, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch56.tar
2024-05-01 13:41:17 INFO     epoch complete!
2024-05-01 13:41:17 INFO     evaluating now!
2024-05-01 13:41:17 INFO     Epoch [57/200] train_loss: 3.8931, val_loss: 5.1035, lr: 0.003000, 5.68s
2024-05-01 13:41:23 INFO     epoch complete!
2024-05-01 13:41:23 INFO     evaluating now!
2024-05-01 13:41:23 INFO     Epoch [58/200] train_loss: 3.9536, val_loss: 5.4478, lr: 0.003000, 5.78s
2024-05-01 13:41:29 INFO     epoch complete!
2024-05-01 13:41:29 INFO     evaluating now!
2024-05-01 13:41:29 INFO     Epoch [59/200] train_loss: 4.1104, val_loss: 5.1074, lr: 0.003000, 5.71s
2024-05-01 13:41:34 INFO     epoch complete!
2024-05-01 13:41:34 INFO     evaluating now!
2024-05-01 13:41:34 INFO     Epoch [60/200] train_loss: 3.9083, val_loss: 5.0613, lr: 0.003000, 5.54s
2024-05-01 13:41:40 INFO     epoch complete!
2024-05-01 13:41:40 INFO     evaluating now!
2024-05-01 13:41:40 INFO     Epoch [61/200] train_loss: 3.8443, val_loss: 5.0969, lr: 0.003000, 5.78s
2024-05-01 13:41:46 INFO     epoch complete!
2024-05-01 13:41:46 INFO     evaluating now!
2024-05-01 13:41:46 INFO     Epoch [62/200] train_loss: 3.7995, val_loss: 4.9319, lr: 0.003000, 5.75s
2024-05-01 13:41:46 INFO     Saved model at 62
2024-05-01 13:41:46 INFO     Val loss decrease from 4.9331 to 4.9319, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch62.tar
2024-05-01 13:41:51 INFO     epoch complete!
2024-05-01 13:41:51 INFO     evaluating now!
2024-05-01 13:41:52 INFO     Epoch [63/200] train_loss: 3.7620, val_loss: 5.1226, lr: 0.003000, 5.46s
2024-05-01 13:41:57 INFO     epoch complete!
2024-05-01 13:41:57 INFO     evaluating now!
2024-05-01 13:41:57 INFO     Epoch [64/200] train_loss: 3.8035, val_loss: 5.0356, lr: 0.003000, 5.52s
2024-05-01 13:42:02 INFO     epoch complete!
2024-05-01 13:42:02 INFO     evaluating now!
2024-05-01 13:42:03 INFO     Epoch [65/200] train_loss: 3.7399, val_loss: 5.1344, lr: 0.003000, 5.51s
2024-05-01 13:42:08 INFO     epoch complete!
2024-05-01 13:42:08 INFO     evaluating now!
2024-05-01 13:42:08 INFO     Epoch [66/200] train_loss: 3.7220, val_loss: 4.9341, lr: 0.003000, 5.52s
2024-05-01 13:42:13 INFO     epoch complete!
2024-05-01 13:42:13 INFO     evaluating now!
2024-05-01 13:42:14 INFO     Epoch [67/200] train_loss: 3.7155, val_loss: 4.9210, lr: 0.003000, 5.66s
2024-05-01 13:42:14 INFO     Saved model at 67
2024-05-01 13:42:14 INFO     Val loss decrease from 4.9319 to 4.9210, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch67.tar
2024-05-01 13:42:19 INFO     epoch complete!
2024-05-01 13:42:19 INFO     evaluating now!
2024-05-01 13:42:19 INFO     Epoch [68/200] train_loss: 3.7125, val_loss: 5.1396, lr: 0.003000, 5.69s
2024-05-01 13:42:25 INFO     epoch complete!
2024-05-01 13:42:25 INFO     evaluating now!
2024-05-01 13:42:25 INFO     Epoch [69/200] train_loss: 3.6989, val_loss: 5.0485, lr: 0.003000, 5.86s
2024-05-01 13:42:31 INFO     epoch complete!
2024-05-01 13:42:31 INFO     evaluating now!
2024-05-01 13:42:31 INFO     Epoch [70/200] train_loss: 3.6496, val_loss: 5.0111, lr: 0.003000, 5.74s
2024-05-01 13:42:37 INFO     epoch complete!
2024-05-01 13:42:37 INFO     evaluating now!
2024-05-01 13:42:37 INFO     Epoch [71/200] train_loss: 3.6516, val_loss: 5.0660, lr: 0.003000, 5.96s
2024-05-01 13:42:42 INFO     epoch complete!
2024-05-01 13:42:42 INFO     evaluating now!
2024-05-01 13:42:43 INFO     Epoch [72/200] train_loss: 3.6144, val_loss: 4.9878, lr: 0.003000, 5.86s
2024-05-01 13:42:48 INFO     epoch complete!
2024-05-01 13:42:48 INFO     evaluating now!
2024-05-01 13:42:48 INFO     Epoch [73/200] train_loss: 3.5964, val_loss: 4.9598, lr: 0.003000, 5.61s
2024-05-01 13:42:54 INFO     epoch complete!
2024-05-01 13:42:54 INFO     evaluating now!
2024-05-01 13:42:54 INFO     Epoch [74/200] train_loss: 3.6295, val_loss: 5.0388, lr: 0.003000, 5.54s
2024-05-01 13:42:59 INFO     epoch complete!
2024-05-01 13:42:59 INFO     evaluating now!
2024-05-01 13:43:00 INFO     Epoch [75/200] train_loss: 3.5703, val_loss: 5.0455, lr: 0.003000, 5.72s
2024-05-01 13:43:05 INFO     epoch complete!
2024-05-01 13:43:05 INFO     evaluating now!
2024-05-01 13:43:06 INFO     Epoch [76/200] train_loss: 3.5777, val_loss: 5.0407, lr: 0.003000, 5.91s
2024-05-01 13:43:11 INFO     epoch complete!
2024-05-01 13:43:11 INFO     evaluating now!
2024-05-01 13:43:12 INFO     Epoch [77/200] train_loss: 3.5385, val_loss: 4.9576, lr: 0.003000, 5.95s
2024-05-01 13:43:17 INFO     epoch complete!
2024-05-01 13:43:17 INFO     evaluating now!
2024-05-01 13:43:17 INFO     Epoch [78/200] train_loss: 3.5297, val_loss: 5.0263, lr: 0.003000, 5.58s
2024-05-01 13:43:23 INFO     epoch complete!
2024-05-01 13:43:23 INFO     evaluating now!
2024-05-01 13:43:23 INFO     Epoch [79/200] train_loss: 3.5196, val_loss: 5.1006, lr: 0.003000, 5.77s
2024-05-01 13:43:28 INFO     epoch complete!
2024-05-01 13:43:28 INFO     evaluating now!
2024-05-01 13:43:29 INFO     Epoch [80/200] train_loss: 3.5247, val_loss: 4.9708, lr: 0.003000, 5.81s
2024-05-01 13:43:34 INFO     epoch complete!
2024-05-01 13:43:34 INFO     evaluating now!
2024-05-01 13:43:35 INFO     Epoch [81/200] train_loss: 3.5442, val_loss: 5.0213, lr: 0.003000, 5.74s
2024-05-01 13:43:40 INFO     epoch complete!
2024-05-01 13:43:40 INFO     evaluating now!
2024-05-01 13:43:40 INFO     Epoch [82/200] train_loss: 3.5408, val_loss: 5.0405, lr: 0.003000, 5.87s
2024-05-01 13:43:40 WARNING  Early stopping at epoch: 82
2024-05-01 13:43:40 INFO     Trained totally 83 epochs, average train time is 5.257s, average eval time is 0.398s
2024-05-01 13:43:40 INFO     Loaded model at 67
2024-05-01 13:43:40 INFO     Saved model at ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 13:43:41 INFO     Start evaluating ...
2024-05-01 13:43:42 INFO     Note that you select the single mode to evaluate!
2024-05-01 13:43:42 INFO     Evaluate result is saved at ./libcity/cache/15/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 13:43:42 INFO     
         MAE       RMSE
1   2.165362   6.865432
2   2.258213   7.477826
3   2.383531   8.464869
4   2.594033   9.288820
5   2.709838  10.110556
6   2.884417  11.130911
7   2.977174  12.040006
8   3.077477  12.848338
9   3.113254  13.311930
10  3.203765  13.590851
11  3.277445  13.825434
12  3.334106  14.251995
2024-05-01 13:43:42 INFO     ----------------------------------------------------------------------------
2024-05-01 13:43:42 INFO     # 1, Kownledge Graph Embedding: GIE, Experiment ids: 16
2024-05-01 13:43:42 INFO     ----------------------------------------------------------------------------
2024-05-01 13:43:42 INFO     Log directory: ./libcity/log
2024-05-01 13:43:42 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=16
2024-05-01 13:43:42 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 105799097, 'exp_id': 16, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 13:43:42 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 13:43:42 INFO     set_weight_link_or_dist: dist
2024-05-01 13:43:42 INFO     init_weight_inf_or_zero: inf
2024-05-01 13:43:42 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 13:43:42 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 13:43:42 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 13:43:42 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 13:43:45 INFO     Dataset created
2024-05-01 13:43:45 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 13:43:45 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 13:43:45 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 13:43:45 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 13:43:46 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 13:43:46 INFO     NormalScaler max: 0.3243229993054587
2024-05-01 13:43:49 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 13:43:49 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 13:43:49 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 13:43:49 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 13:43:49 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 13:43:49 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 13:43:49 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 13:43:49 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 13:43:49 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 13:43:49 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 13:43:49 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 13:43:49 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 13:43:49 INFO     Total parameter numbers: 874010
2024-05-01 13:43:49 INFO     You select `adam` optimizer.
2024-05-01 13:43:49 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 13:43:49 INFO     Start training ...
2024-05-01 13:43:49 INFO     num_batches:48
2024-05-01 13:43:54 INFO     epoch complete!
2024-05-01 13:43:54 INFO     evaluating now!
2024-05-01 13:43:55 INFO     Epoch [0/200] train_loss: 24.0609, val_loss: 18.5852, lr: 0.003000, 5.75s
2024-05-01 13:43:55 INFO     Saved model at 0
2024-05-01 13:43:55 INFO     Val loss decrease from inf to 18.5852, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 13:44:00 INFO     epoch complete!
2024-05-01 13:44:00 INFO     evaluating now!
2024-05-01 13:44:01 INFO     Epoch [1/200] train_loss: 15.5587, val_loss: 15.3429, lr: 0.003000, 5.83s
2024-05-01 13:44:01 INFO     Saved model at 1
2024-05-01 13:44:01 INFO     Val loss decrease from 18.5852 to 15.3429, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 13:44:06 INFO     epoch complete!
2024-05-01 13:44:06 INFO     evaluating now!
2024-05-01 13:44:06 INFO     Epoch [2/200] train_loss: 12.6490, val_loss: 12.3362, lr: 0.003000, 5.82s
2024-05-01 13:44:06 INFO     Saved model at 2
2024-05-01 13:44:06 INFO     Val loss decrease from 15.3429 to 12.3362, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 13:44:12 INFO     epoch complete!
2024-05-01 13:44:12 INFO     evaluating now!
2024-05-01 13:44:13 INFO     Epoch [3/200] train_loss: 10.3472, val_loss: 9.8957, lr: 0.003000, 6.16s
2024-05-01 13:44:13 INFO     Saved model at 3
2024-05-01 13:44:13 INFO     Val loss decrease from 12.3362 to 9.8957, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 13:44:18 INFO     epoch complete!
2024-05-01 13:44:18 INFO     evaluating now!
2024-05-01 13:44:18 INFO     Epoch [4/200] train_loss: 8.8628, val_loss: 8.4837, lr: 0.003000, 5.80s
2024-05-01 13:44:18 INFO     Saved model at 4
2024-05-01 13:44:18 INFO     Val loss decrease from 9.8957 to 8.4837, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 13:44:24 INFO     epoch complete!
2024-05-01 13:44:24 INFO     evaluating now!
2024-05-01 13:44:24 INFO     Epoch [5/200] train_loss: 7.8705, val_loss: 7.9886, lr: 0.003000, 5.81s
2024-05-01 13:44:24 INFO     Saved model at 5
2024-05-01 13:44:24 INFO     Val loss decrease from 8.4837 to 7.9886, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 13:44:30 INFO     epoch complete!
2024-05-01 13:44:30 INFO     evaluating now!
2024-05-01 13:44:30 INFO     Epoch [6/200] train_loss: 7.2973, val_loss: 7.0254, lr: 0.003000, 5.85s
2024-05-01 13:44:30 INFO     Saved model at 6
2024-05-01 13:44:30 INFO     Val loss decrease from 7.9886 to 7.0254, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 13:44:36 INFO     epoch complete!
2024-05-01 13:44:36 INFO     evaluating now!
2024-05-01 13:44:36 INFO     Epoch [7/200] train_loss: 6.8391, val_loss: 6.4974, lr: 0.003000, 5.88s
2024-05-01 13:44:36 INFO     Saved model at 7
2024-05-01 13:44:36 INFO     Val loss decrease from 7.0254 to 6.4974, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 13:44:41 INFO     epoch complete!
2024-05-01 13:44:41 INFO     evaluating now!
2024-05-01 13:44:42 INFO     Epoch [8/200] train_loss: 6.4544, val_loss: 6.5812, lr: 0.003000, 5.68s
2024-05-01 13:44:47 INFO     epoch complete!
2024-05-01 13:44:47 INFO     evaluating now!
2024-05-01 13:44:47 INFO     Epoch [9/200] train_loss: 6.2481, val_loss: 6.5167, lr: 0.003000, 5.65s
2024-05-01 13:44:53 INFO     epoch complete!
2024-05-01 13:44:53 INFO     evaluating now!
2024-05-01 13:44:53 INFO     Epoch [10/200] train_loss: 6.1127, val_loss: 6.1769, lr: 0.003000, 5.62s
2024-05-01 13:44:53 INFO     Saved model at 10
2024-05-01 13:44:53 INFO     Val loss decrease from 6.4974 to 6.1769, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-01 13:44:58 INFO     epoch complete!
2024-05-01 13:44:58 INFO     evaluating now!
2024-05-01 13:44:59 INFO     Epoch [11/200] train_loss: 5.8680, val_loss: 5.8155, lr: 0.003000, 5.78s
2024-05-01 13:44:59 INFO     Saved model at 11
2024-05-01 13:44:59 INFO     Val loss decrease from 6.1769 to 5.8155, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-01 13:45:05 INFO     epoch complete!
2024-05-01 13:45:05 INFO     evaluating now!
2024-05-01 13:45:05 INFO     Epoch [12/200] train_loss: 5.7670, val_loss: 5.8905, lr: 0.003000, 6.42s
2024-05-01 13:45:11 INFO     epoch complete!
2024-05-01 13:45:11 INFO     evaluating now!
2024-05-01 13:45:11 INFO     Epoch [13/200] train_loss: 5.5839, val_loss: 5.6867, lr: 0.003000, 5.93s
2024-05-01 13:45:11 INFO     Saved model at 13
2024-05-01 13:45:11 INFO     Val loss decrease from 5.8155 to 5.6867, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-01 13:45:17 INFO     epoch complete!
2024-05-01 13:45:17 INFO     evaluating now!
2024-05-01 13:45:17 INFO     Epoch [14/200] train_loss: 5.4421, val_loss: 5.7107, lr: 0.003000, 5.79s
2024-05-01 13:45:23 INFO     epoch complete!
2024-05-01 13:45:23 INFO     evaluating now!
2024-05-01 13:45:23 INFO     Epoch [15/200] train_loss: 5.3813, val_loss: 5.4851, lr: 0.003000, 5.99s
2024-05-01 13:45:23 INFO     Saved model at 15
2024-05-01 13:45:23 INFO     Val loss decrease from 5.6867 to 5.4851, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-01 13:45:29 INFO     epoch complete!
2024-05-01 13:45:29 INFO     evaluating now!
2024-05-01 13:45:29 INFO     Epoch [16/200] train_loss: 5.2545, val_loss: 5.9319, lr: 0.003000, 6.02s
2024-05-01 13:45:35 INFO     epoch complete!
2024-05-01 13:45:35 INFO     evaluating now!
2024-05-01 13:45:35 INFO     Epoch [17/200] train_loss: 5.2244, val_loss: 5.5874, lr: 0.003000, 5.75s
2024-05-01 13:45:40 INFO     epoch complete!
2024-05-01 13:45:40 INFO     evaluating now!
2024-05-01 13:45:41 INFO     Epoch [18/200] train_loss: 5.1435, val_loss: 5.5656, lr: 0.003000, 5.71s
2024-05-01 13:45:46 INFO     epoch complete!
2024-05-01 13:45:46 INFO     evaluating now!
2024-05-01 13:45:46 INFO     Epoch [19/200] train_loss: 4.9846, val_loss: 5.5776, lr: 0.003000, 5.69s
2024-05-01 13:45:52 INFO     epoch complete!
2024-05-01 13:45:52 INFO     evaluating now!
2024-05-01 13:45:52 INFO     Epoch [20/200] train_loss: 4.9578, val_loss: 5.4112, lr: 0.003000, 5.78s
2024-05-01 13:45:52 INFO     Saved model at 20
2024-05-01 13:45:52 INFO     Val loss decrease from 5.4851 to 5.4112, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-01 13:45:57 INFO     epoch complete!
2024-05-01 13:45:57 INFO     evaluating now!
2024-05-01 13:45:58 INFO     Epoch [21/200] train_loss: 4.9478, val_loss: 5.3491, lr: 0.003000, 5.67s
2024-05-01 13:45:58 INFO     Saved model at 21
2024-05-01 13:45:58 INFO     Val loss decrease from 5.4112 to 5.3491, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-01 13:46:03 INFO     epoch complete!
2024-05-01 13:46:03 INFO     evaluating now!
2024-05-01 13:46:03 INFO     Epoch [22/200] train_loss: 4.8488, val_loss: 5.3168, lr: 0.003000, 5.61s
2024-05-01 13:46:04 INFO     Saved model at 22
2024-05-01 13:46:04 INFO     Val loss decrease from 5.3491 to 5.3168, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-01 13:46:09 INFO     epoch complete!
2024-05-01 13:46:09 INFO     evaluating now!
2024-05-01 13:46:10 INFO     Epoch [23/200] train_loss: 4.7661, val_loss: 5.3525, lr: 0.003000, 5.71s
2024-05-01 13:46:15 INFO     epoch complete!
2024-05-01 13:46:15 INFO     evaluating now!
2024-05-01 13:46:15 INFO     Epoch [24/200] train_loss: 4.6808, val_loss: 5.5446, lr: 0.003000, 5.65s
2024-05-01 13:46:21 INFO     epoch complete!
2024-05-01 13:46:21 INFO     evaluating now!
2024-05-01 13:46:21 INFO     Epoch [25/200] train_loss: 4.6936, val_loss: 5.3300, lr: 0.003000, 5.71s
2024-05-01 13:46:27 INFO     epoch complete!
2024-05-01 13:46:27 INFO     evaluating now!
2024-05-01 13:46:27 INFO     Epoch [26/200] train_loss: 4.6244, val_loss: 5.2293, lr: 0.003000, 5.74s
2024-05-01 13:46:27 INFO     Saved model at 26
2024-05-01 13:46:27 INFO     Val loss decrease from 5.3168 to 5.2293, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-05-01 13:46:32 INFO     epoch complete!
2024-05-01 13:46:32 INFO     evaluating now!
2024-05-01 13:46:32 INFO     Epoch [27/200] train_loss: 4.6005, val_loss: 5.2256, lr: 0.003000, 5.52s
2024-05-01 13:46:33 INFO     Saved model at 27
2024-05-01 13:46:33 INFO     Val loss decrease from 5.2293 to 5.2256, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-05-01 13:46:38 INFO     epoch complete!
2024-05-01 13:46:38 INFO     evaluating now!
2024-05-01 13:46:38 INFO     Epoch [28/200] train_loss: 4.4637, val_loss: 5.3509, lr: 0.003000, 5.76s
2024-05-01 13:46:44 INFO     epoch complete!
2024-05-01 13:46:44 INFO     evaluating now!
2024-05-01 13:46:44 INFO     Epoch [29/200] train_loss: 4.4578, val_loss: 5.3116, lr: 0.003000, 5.66s
2024-05-01 13:46:49 INFO     epoch complete!
2024-05-01 13:46:49 INFO     evaluating now!
2024-05-01 13:46:50 INFO     Epoch [30/200] train_loss: 4.4147, val_loss: 5.2599, lr: 0.003000, 5.75s
2024-05-01 13:46:55 INFO     epoch complete!
2024-05-01 13:46:55 INFO     evaluating now!
2024-05-01 13:46:55 INFO     Epoch [31/200] train_loss: 4.3929, val_loss: 5.2161, lr: 0.003000, 5.64s
2024-05-01 13:46:55 INFO     Saved model at 31
2024-05-01 13:46:55 INFO     Val loss decrease from 5.2256 to 5.2161, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-05-01 13:47:01 INFO     epoch complete!
2024-05-01 13:47:01 INFO     evaluating now!
2024-05-01 13:47:01 INFO     Epoch [32/200] train_loss: 4.4402, val_loss: 5.1807, lr: 0.003000, 5.84s
2024-05-01 13:47:01 INFO     Saved model at 32
2024-05-01 13:47:01 INFO     Val loss decrease from 5.2161 to 5.1807, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-05-01 13:47:07 INFO     epoch complete!
2024-05-01 13:47:07 INFO     evaluating now!
2024-05-01 13:47:07 INFO     Epoch [33/200] train_loss: 4.3718, val_loss: 5.1960, lr: 0.003000, 6.10s
2024-05-01 13:47:13 INFO     epoch complete!
2024-05-01 13:47:13 INFO     evaluating now!
2024-05-01 13:47:13 INFO     Epoch [34/200] train_loss: 4.3592, val_loss: 5.2554, lr: 0.003000, 6.05s
2024-05-01 13:47:19 INFO     epoch complete!
2024-05-01 13:47:19 INFO     evaluating now!
2024-05-01 13:47:19 INFO     Epoch [35/200] train_loss: 4.2505, val_loss: 5.1634, lr: 0.003000, 6.00s
2024-05-01 13:47:19 INFO     Saved model at 35
2024-05-01 13:47:19 INFO     Val loss decrease from 5.1807 to 5.1634, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-05-01 13:47:25 INFO     epoch complete!
2024-05-01 13:47:25 INFO     evaluating now!
2024-05-01 13:47:25 INFO     Epoch [36/200] train_loss: 4.2531, val_loss: 5.0901, lr: 0.003000, 6.00s
2024-05-01 13:47:25 INFO     Saved model at 36
2024-05-01 13:47:25 INFO     Val loss decrease from 5.1634 to 5.0901, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-05-01 13:47:31 INFO     epoch complete!
2024-05-01 13:47:31 INFO     evaluating now!
2024-05-01 13:47:31 INFO     Epoch [37/200] train_loss: 4.2180, val_loss: 5.2541, lr: 0.003000, 5.59s
2024-05-01 13:47:36 INFO     epoch complete!
2024-05-01 13:47:36 INFO     evaluating now!
2024-05-01 13:47:37 INFO     Epoch [38/200] train_loss: 4.1875, val_loss: 5.3315, lr: 0.003000, 5.72s
2024-05-01 13:47:43 INFO     epoch complete!
2024-05-01 13:47:43 INFO     evaluating now!
2024-05-01 13:47:43 INFO     Epoch [39/200] train_loss: 4.1747, val_loss: 5.1557, lr: 0.003000, 6.14s
2024-05-01 13:47:49 INFO     epoch complete!
2024-05-01 13:47:49 INFO     evaluating now!
2024-05-01 13:47:49 INFO     Epoch [40/200] train_loss: 4.1545, val_loss: 5.1492, lr: 0.003000, 6.11s
2024-05-01 13:47:55 INFO     epoch complete!
2024-05-01 13:47:55 INFO     evaluating now!
2024-05-01 13:47:55 INFO     Epoch [41/200] train_loss: 4.0678, val_loss: 5.1689, lr: 0.003000, 5.94s
2024-05-01 13:48:01 INFO     epoch complete!
2024-05-01 13:48:01 INFO     evaluating now!
2024-05-01 13:48:01 INFO     Epoch [42/200] train_loss: 4.1310, val_loss: 5.1902, lr: 0.003000, 5.96s
2024-05-01 13:48:07 INFO     epoch complete!
2024-05-01 13:48:07 INFO     evaluating now!
2024-05-01 13:48:07 INFO     Epoch [43/200] train_loss: 4.0462, val_loss: 5.0013, lr: 0.003000, 6.00s
2024-05-01 13:48:07 INFO     Saved model at 43
2024-05-01 13:48:07 INFO     Val loss decrease from 5.0901 to 5.0013, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-05-01 13:48:13 INFO     epoch complete!
2024-05-01 13:48:13 INFO     evaluating now!
2024-05-01 13:48:13 INFO     Epoch [44/200] train_loss: 3.9792, val_loss: 5.0467, lr: 0.003000, 6.03s
2024-05-01 13:48:19 INFO     epoch complete!
2024-05-01 13:48:19 INFO     evaluating now!
2024-05-01 13:48:19 INFO     Epoch [45/200] train_loss: 3.9751, val_loss: 5.1004, lr: 0.003000, 5.91s
2024-05-01 13:48:25 INFO     epoch complete!
2024-05-01 13:48:25 INFO     evaluating now!
2024-05-01 13:48:25 INFO     Epoch [46/200] train_loss: 3.9857, val_loss: 5.1660, lr: 0.003000, 6.02s
2024-05-01 13:48:31 INFO     epoch complete!
2024-05-01 13:48:31 INFO     evaluating now!
2024-05-01 13:48:31 INFO     Epoch [47/200] train_loss: 3.9562, val_loss: 5.2111, lr: 0.003000, 6.09s
2024-05-01 13:48:37 INFO     epoch complete!
2024-05-01 13:48:37 INFO     evaluating now!
2024-05-01 13:48:37 INFO     Epoch [48/200] train_loss: 3.9373, val_loss: 5.0399, lr: 0.003000, 5.99s
2024-05-01 13:48:43 INFO     epoch complete!
2024-05-01 13:48:43 INFO     evaluating now!
2024-05-01 13:48:43 INFO     Epoch [49/200] train_loss: 3.9076, val_loss: 5.1471, lr: 0.003000, 6.13s
2024-05-01 13:48:49 INFO     epoch complete!
2024-05-01 13:48:49 INFO     evaluating now!
2024-05-01 13:48:49 INFO     Epoch [50/200] train_loss: 3.8968, val_loss: 5.2495, lr: 0.003000, 5.96s
2024-05-01 13:48:55 INFO     epoch complete!
2024-05-01 13:48:55 INFO     evaluating now!
2024-05-01 13:48:55 INFO     Epoch [51/200] train_loss: 3.9394, val_loss: 5.1422, lr: 0.003000, 5.97s
2024-05-01 13:49:01 INFO     epoch complete!
2024-05-01 13:49:01 INFO     evaluating now!
2024-05-01 13:49:01 INFO     Epoch [52/200] train_loss: 3.9442, val_loss: 5.1573, lr: 0.003000, 6.19s
2024-05-01 13:49:07 INFO     epoch complete!
2024-05-01 13:49:07 INFO     evaluating now!
2024-05-01 13:49:07 INFO     Epoch [53/200] train_loss: 3.8317, val_loss: 5.1835, lr: 0.003000, 6.19s
2024-05-01 13:49:13 INFO     epoch complete!
2024-05-01 13:49:13 INFO     evaluating now!
2024-05-01 13:49:14 INFO     Epoch [54/200] train_loss: 3.7850, val_loss: 4.9629, lr: 0.003000, 6.05s
2024-05-01 13:49:14 INFO     Saved model at 54
2024-05-01 13:49:14 INFO     Val loss decrease from 5.0013 to 4.9629, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch54.tar
2024-05-01 13:49:19 INFO     epoch complete!
2024-05-01 13:49:19 INFO     evaluating now!
2024-05-01 13:49:20 INFO     Epoch [55/200] train_loss: 3.7839, val_loss: 5.1367, lr: 0.003000, 6.17s
2024-05-01 13:49:26 INFO     epoch complete!
2024-05-01 13:49:26 INFO     evaluating now!
2024-05-01 13:49:26 INFO     Epoch [56/200] train_loss: 3.7789, val_loss: 5.0549, lr: 0.003000, 6.25s
2024-05-01 13:49:32 INFO     epoch complete!
2024-05-01 13:49:32 INFO     evaluating now!
2024-05-01 13:49:32 INFO     Epoch [57/200] train_loss: 3.7342, val_loss: 5.1823, lr: 0.003000, 6.15s
2024-05-01 13:49:38 INFO     epoch complete!
2024-05-01 13:49:38 INFO     evaluating now!
2024-05-01 13:49:38 INFO     Epoch [58/200] train_loss: 3.7343, val_loss: 5.1503, lr: 0.003000, 6.23s
2024-05-01 13:49:44 INFO     epoch complete!
2024-05-01 13:49:44 INFO     evaluating now!
2024-05-01 13:49:45 INFO     Epoch [59/200] train_loss: 3.7744, val_loss: 4.9349, lr: 0.003000, 6.25s
2024-05-01 13:49:45 INFO     Saved model at 59
2024-05-01 13:49:45 INFO     Val loss decrease from 4.9629 to 4.9349, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch59.tar
2024-05-01 13:49:50 INFO     epoch complete!
2024-05-01 13:49:50 INFO     evaluating now!
2024-05-01 13:49:51 INFO     Epoch [60/200] train_loss: 3.7115, val_loss: 5.0311, lr: 0.003000, 6.10s
2024-05-01 13:49:57 INFO     epoch complete!
2024-05-01 13:49:57 INFO     evaluating now!
2024-05-01 13:49:57 INFO     Epoch [61/200] train_loss: 3.6568, val_loss: 4.9822, lr: 0.003000, 6.22s
2024-05-01 13:50:03 INFO     epoch complete!
2024-05-01 13:50:03 INFO     evaluating now!
2024-05-01 13:50:03 INFO     Epoch [62/200] train_loss: 3.6480, val_loss: 5.2932, lr: 0.003000, 6.32s
2024-05-01 13:50:09 INFO     epoch complete!
2024-05-01 13:50:09 INFO     evaluating now!
2024-05-01 13:50:10 INFO     Epoch [63/200] train_loss: 3.6376, val_loss: 5.0874, lr: 0.003000, 6.22s
2024-05-01 13:50:15 INFO     epoch complete!
2024-05-01 13:50:15 INFO     evaluating now!
2024-05-01 13:50:15 INFO     Epoch [64/200] train_loss: 3.6385, val_loss: 5.1217, lr: 0.003000, 5.93s
2024-05-01 13:50:21 INFO     epoch complete!
2024-05-01 13:50:21 INFO     evaluating now!
2024-05-01 13:50:21 INFO     Epoch [65/200] train_loss: 3.6457, val_loss: 5.0123, lr: 0.003000, 5.96s
2024-05-01 13:50:27 INFO     epoch complete!
2024-05-01 13:50:27 INFO     evaluating now!
2024-05-01 13:50:27 INFO     Epoch [66/200] train_loss: 3.6086, val_loss: 4.9805, lr: 0.003000, 6.04s
2024-05-01 13:50:33 INFO     epoch complete!
2024-05-01 13:50:33 INFO     evaluating now!
2024-05-01 13:50:34 INFO     Epoch [67/200] train_loss: 3.5940, val_loss: 5.0980, lr: 0.003000, 6.13s
2024-05-01 13:50:39 INFO     epoch complete!
2024-05-01 13:50:39 INFO     evaluating now!
2024-05-01 13:50:40 INFO     Epoch [68/200] train_loss: 3.5826, val_loss: 5.1368, lr: 0.003000, 6.05s
2024-05-01 13:50:45 INFO     epoch complete!
2024-05-01 13:50:45 INFO     evaluating now!
2024-05-01 13:50:46 INFO     Epoch [69/200] train_loss: 3.5833, val_loss: 5.0831, lr: 0.003000, 6.12s
2024-05-01 13:50:52 INFO     epoch complete!
2024-05-01 13:50:52 INFO     evaluating now!
2024-05-01 13:50:52 INFO     Epoch [70/200] train_loss: 3.5789, val_loss: 4.9714, lr: 0.003000, 6.17s
2024-05-01 13:50:58 INFO     epoch complete!
2024-05-01 13:50:58 INFO     evaluating now!
2024-05-01 13:50:58 INFO     Epoch [71/200] train_loss: 3.5537, val_loss: 5.1153, lr: 0.003000, 6.06s
2024-05-01 13:51:04 INFO     epoch complete!
2024-05-01 13:51:04 INFO     evaluating now!
2024-05-01 13:51:04 INFO     Epoch [72/200] train_loss: 3.5767, val_loss: 4.9995, lr: 0.003000, 6.24s
2024-05-01 13:51:10 INFO     epoch complete!
2024-05-01 13:51:10 INFO     evaluating now!
2024-05-01 13:51:10 INFO     Epoch [73/200] train_loss: 3.5192, val_loss: 4.9925, lr: 0.003000, 6.00s
2024-05-01 13:51:16 INFO     epoch complete!
2024-05-01 13:51:16 INFO     evaluating now!
2024-05-01 13:51:16 INFO     Epoch [74/200] train_loss: 3.6157, val_loss: 5.1685, lr: 0.003000, 6.13s
2024-05-01 13:51:16 WARNING  Early stopping at epoch: 74
2024-05-01 13:51:16 INFO     Trained totally 75 epochs, average train time is 5.539s, average eval time is 0.404s
2024-05-01 13:51:16 INFO     Loaded model at 59
2024-05-01 13:51:16 INFO     Saved model at ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 13:51:17 INFO     Start evaluating ...
2024-05-01 13:51:18 INFO     Note that you select the single mode to evaluate!
2024-05-01 13:51:18 INFO     Evaluate result is saved at ./libcity/cache/16/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 13:51:18 INFO     
         MAE       RMSE
1   2.284281   6.735682
2   2.372797   7.434146
3   2.558182   8.442430
4   2.741262   9.163680
5   2.842131   9.885081
6   3.114762  10.808647
7   3.233584  11.635617
8   3.214792  12.188045
9   3.267072  12.639605
10  3.258773  12.905376
11  3.350547  13.168568
12  3.318970  13.385272
2024-05-01 13:51:18 INFO     ----------------------------------------------------------------------------
2024-05-01 13:51:18 INFO     # 2, Kownledge Graph Embedding: GIE, Experiment ids: 17
2024-05-01 13:51:18 INFO     ----------------------------------------------------------------------------
2024-05-01 13:51:18 INFO     Log directory: ./libcity/log
2024-05-01 13:51:18 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=17
2024-05-01 13:51:18 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 185807053, 'exp_id': 17, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 13:51:18 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 13:51:18 INFO     set_weight_link_or_dist: dist
2024-05-01 13:51:18 INFO     init_weight_inf_or_zero: inf
2024-05-01 13:51:18 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 13:51:18 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 13:51:18 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 13:51:18 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 13:51:21 INFO     Dataset created
2024-05-01 13:51:21 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 13:51:21 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 13:51:21 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 13:51:21 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 13:51:22 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 13:51:22 INFO     NormalScaler max: 0.3243229993054587
2024-05-01 13:51:25 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 13:51:25 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 13:51:25 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 13:51:25 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 13:51:25 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 13:51:25 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 13:51:25 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 13:51:25 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 13:51:25 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 13:51:25 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 13:51:25 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 13:51:25 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 13:51:25 INFO     Total parameter numbers: 874010
2024-05-01 13:51:25 INFO     You select `adam` optimizer.
2024-05-01 13:51:25 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 13:51:25 INFO     Start training ...
2024-05-01 13:51:25 INFO     num_batches:48
2024-05-01 13:51:31 INFO     epoch complete!
2024-05-01 13:51:31 INFO     evaluating now!
2024-05-01 13:51:31 INFO     Epoch [0/200] train_loss: 24.0635, val_loss: 18.8103, lr: 0.003000, 6.00s
2024-05-01 13:51:31 INFO     Saved model at 0
2024-05-01 13:51:31 INFO     Val loss decrease from inf to 18.8103, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 13:51:37 INFO     epoch complete!
2024-05-01 13:51:37 INFO     evaluating now!
2024-05-01 13:51:37 INFO     Epoch [1/200] train_loss: 15.6268, val_loss: 15.0856, lr: 0.003000, 6.23s
2024-05-01 13:51:37 INFO     Saved model at 1
2024-05-01 13:51:37 INFO     Val loss decrease from 18.8103 to 15.0856, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 13:51:43 INFO     epoch complete!
2024-05-01 13:51:43 INFO     evaluating now!
2024-05-01 13:51:44 INFO     Epoch [2/200] train_loss: 13.0975, val_loss: 13.0821, lr: 0.003000, 6.24s
2024-05-01 13:51:44 INFO     Saved model at 2
2024-05-01 13:51:44 INFO     Val loss decrease from 15.0856 to 13.0821, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 13:51:49 INFO     epoch complete!
2024-05-01 13:51:49 INFO     evaluating now!
2024-05-01 13:51:50 INFO     Epoch [3/200] train_loss: 11.0221, val_loss: 10.4467, lr: 0.003000, 6.02s
2024-05-01 13:51:50 INFO     Saved model at 3
2024-05-01 13:51:50 INFO     Val loss decrease from 13.0821 to 10.4467, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 13:51:55 INFO     epoch complete!
2024-05-01 13:51:55 INFO     evaluating now!
2024-05-01 13:51:56 INFO     Epoch [4/200] train_loss: 9.3662, val_loss: 9.0152, lr: 0.003000, 6.24s
2024-05-01 13:51:56 INFO     Saved model at 4
2024-05-01 13:51:56 INFO     Val loss decrease from 10.4467 to 9.0152, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 13:52:01 INFO     epoch complete!
2024-05-01 13:52:01 INFO     evaluating now!
2024-05-01 13:52:02 INFO     Epoch [5/200] train_loss: 8.3574, val_loss: 8.4042, lr: 0.003000, 5.99s
2024-05-01 13:52:02 INFO     Saved model at 5
2024-05-01 13:52:02 INFO     Val loss decrease from 9.0152 to 8.4042, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 13:52:08 INFO     epoch complete!
2024-05-01 13:52:08 INFO     evaluating now!
2024-05-01 13:52:08 INFO     Epoch [6/200] train_loss: 7.5975, val_loss: 7.3802, lr: 0.003000, 6.10s
2024-05-01 13:52:08 INFO     Saved model at 6
2024-05-01 13:52:08 INFO     Val loss decrease from 8.4042 to 7.3802, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 13:52:14 INFO     epoch complete!
2024-05-01 13:52:14 INFO     evaluating now!
2024-05-01 13:52:14 INFO     Epoch [7/200] train_loss: 6.9911, val_loss: 6.8398, lr: 0.003000, 6.02s
2024-05-01 13:52:14 INFO     Saved model at 7
2024-05-01 13:52:14 INFO     Val loss decrease from 7.3802 to 6.8398, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 13:52:20 INFO     epoch complete!
2024-05-01 13:52:20 INFO     evaluating now!
2024-05-01 13:52:20 INFO     Epoch [8/200] train_loss: 6.7757, val_loss: 6.6935, lr: 0.003000, 5.86s
2024-05-01 13:52:20 INFO     Saved model at 8
2024-05-01 13:52:20 INFO     Val loss decrease from 6.8398 to 6.6935, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-01 13:52:26 INFO     epoch complete!
2024-05-01 13:52:26 INFO     evaluating now!
2024-05-01 13:52:26 INFO     Epoch [9/200] train_loss: 6.4483, val_loss: 6.2647, lr: 0.003000, 6.18s
2024-05-01 13:52:26 INFO     Saved model at 9
2024-05-01 13:52:26 INFO     Val loss decrease from 6.6935 to 6.2647, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-01 13:52:32 INFO     epoch complete!
2024-05-01 13:52:32 INFO     evaluating now!
2024-05-01 13:52:32 INFO     Epoch [10/200] train_loss: 6.0621, val_loss: 6.1864, lr: 0.003000, 6.06s
2024-05-01 13:52:32 INFO     Saved model at 10
2024-05-01 13:52:32 INFO     Val loss decrease from 6.2647 to 6.1864, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-01 13:52:38 INFO     epoch complete!
2024-05-01 13:52:38 INFO     evaluating now!
2024-05-01 13:52:39 INFO     Epoch [11/200] train_loss: 5.9720, val_loss: 6.0461, lr: 0.003000, 6.11s
2024-05-01 13:52:39 INFO     Saved model at 11
2024-05-01 13:52:39 INFO     Val loss decrease from 6.1864 to 6.0461, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-01 13:52:44 INFO     epoch complete!
2024-05-01 13:52:44 INFO     evaluating now!
2024-05-01 13:52:45 INFO     Epoch [12/200] train_loss: 5.8331, val_loss: 6.0032, lr: 0.003000, 6.05s
2024-05-01 13:52:45 INFO     Saved model at 12
2024-05-01 13:52:45 INFO     Val loss decrease from 6.0461 to 6.0032, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-01 13:52:50 INFO     epoch complete!
2024-05-01 13:52:50 INFO     evaluating now!
2024-05-01 13:52:51 INFO     Epoch [13/200] train_loss: 5.7248, val_loss: 6.2636, lr: 0.003000, 6.09s
2024-05-01 13:52:56 INFO     epoch complete!
2024-05-01 13:52:56 INFO     evaluating now!
2024-05-01 13:52:57 INFO     Epoch [14/200] train_loss: 5.6191, val_loss: 5.8730, lr: 0.003000, 6.11s
2024-05-01 13:52:57 INFO     Saved model at 14
2024-05-01 13:52:57 INFO     Val loss decrease from 6.0032 to 5.8730, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-01 13:53:03 INFO     epoch complete!
2024-05-01 13:53:03 INFO     evaluating now!
2024-05-01 13:53:03 INFO     Epoch [15/200] train_loss: 5.3689, val_loss: 5.6497, lr: 0.003000, 6.10s
2024-05-01 13:53:03 INFO     Saved model at 15
2024-05-01 13:53:03 INFO     Val loss decrease from 5.8730 to 5.6497, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-01 13:53:09 INFO     epoch complete!
2024-05-01 13:53:09 INFO     evaluating now!
2024-05-01 13:53:09 INFO     Epoch [16/200] train_loss: 5.3389, val_loss: 5.7530, lr: 0.003000, 6.01s
2024-05-01 13:53:15 INFO     epoch complete!
2024-05-01 13:53:15 INFO     evaluating now!
2024-05-01 13:53:15 INFO     Epoch [17/200] train_loss: 5.2486, val_loss: 5.7920, lr: 0.003000, 6.17s
2024-05-01 13:53:21 INFO     epoch complete!
2024-05-01 13:53:21 INFO     evaluating now!
2024-05-01 13:53:21 INFO     Epoch [18/200] train_loss: 5.1626, val_loss: 5.8223, lr: 0.003000, 6.03s
2024-05-01 13:53:27 INFO     epoch complete!
2024-05-01 13:53:27 INFO     evaluating now!
2024-05-01 13:53:27 INFO     Epoch [19/200] train_loss: 5.0568, val_loss: 5.4847, lr: 0.003000, 6.09s
2024-05-01 13:53:27 INFO     Saved model at 19
2024-05-01 13:53:27 INFO     Val loss decrease from 5.6497 to 5.4847, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-01 13:53:33 INFO     epoch complete!
2024-05-01 13:53:33 INFO     evaluating now!
2024-05-01 13:53:34 INFO     Epoch [20/200] train_loss: 4.9782, val_loss: 5.4467, lr: 0.003000, 6.14s
2024-05-01 13:53:34 INFO     Saved model at 20
2024-05-01 13:53:34 INFO     Val loss decrease from 5.4847 to 5.4467, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-01 13:53:39 INFO     epoch complete!
2024-05-01 13:53:39 INFO     evaluating now!
2024-05-01 13:53:40 INFO     Epoch [21/200] train_loss: 4.8707, val_loss: 5.3589, lr: 0.003000, 6.14s
2024-05-01 13:53:40 INFO     Saved model at 21
2024-05-01 13:53:40 INFO     Val loss decrease from 5.4467 to 5.3589, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-01 13:53:45 INFO     epoch complete!
2024-05-01 13:53:45 INFO     evaluating now!
2024-05-01 13:53:46 INFO     Epoch [22/200] train_loss: 4.7667, val_loss: 5.5026, lr: 0.003000, 6.09s
2024-05-01 13:53:52 INFO     epoch complete!
2024-05-01 13:53:52 INFO     evaluating now!
2024-05-01 13:53:52 INFO     Epoch [23/200] train_loss: 4.7597, val_loss: 5.1906, lr: 0.003000, 6.10s
2024-05-01 13:53:59 INFO     Saved model at 23
2024-05-01 13:53:59 INFO     Val loss decrease from 5.3589 to 5.1906, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-05-01 13:54:04 INFO     epoch complete!
2024-05-01 13:54:04 INFO     evaluating now!
2024-05-01 13:54:05 INFO     Epoch [24/200] train_loss: 4.7023, val_loss: 5.2756, lr: 0.003000, 5.75s
2024-05-01 13:54:10 INFO     epoch complete!
2024-05-01 13:54:10 INFO     evaluating now!
2024-05-01 13:54:11 INFO     Epoch [25/200] train_loss: 4.6221, val_loss: 5.3920, lr: 0.003000, 5.77s
2024-05-01 13:54:16 INFO     epoch complete!
2024-05-01 13:54:16 INFO     evaluating now!
2024-05-01 13:54:16 INFO     Epoch [26/200] train_loss: 4.6298, val_loss: 5.2840, lr: 0.003000, 5.86s
2024-05-01 13:54:22 INFO     epoch complete!
2024-05-01 13:54:22 INFO     evaluating now!
2024-05-01 13:54:22 INFO     Epoch [27/200] train_loss: 4.6713, val_loss: 5.3231, lr: 0.003000, 5.76s
2024-05-01 13:54:27 INFO     epoch complete!
2024-05-01 13:54:27 INFO     evaluating now!
2024-05-01 13:54:28 INFO     Epoch [28/200] train_loss: 4.5086, val_loss: 5.1943, lr: 0.003000, 5.58s
2024-05-01 13:54:33 INFO     epoch complete!
2024-05-01 13:54:33 INFO     evaluating now!
2024-05-01 13:54:34 INFO     Epoch [29/200] train_loss: 4.4518, val_loss: 5.3522, lr: 0.003000, 5.86s
2024-05-01 13:54:39 INFO     epoch complete!
2024-05-01 13:54:39 INFO     evaluating now!
2024-05-01 13:54:39 INFO     Epoch [30/200] train_loss: 4.4236, val_loss: 5.2266, lr: 0.003000, 5.85s
2024-05-01 13:54:45 INFO     epoch complete!
2024-05-01 13:54:45 INFO     evaluating now!
2024-05-01 13:54:46 INFO     Epoch [31/200] train_loss: 4.3792, val_loss: 5.0961, lr: 0.003000, 6.29s
2024-05-01 13:54:46 INFO     Saved model at 31
2024-05-01 13:54:46 INFO     Val loss decrease from 5.1906 to 5.0961, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-05-01 13:54:52 INFO     epoch complete!
2024-05-01 13:54:52 INFO     evaluating now!
2024-05-01 13:54:52 INFO     Epoch [32/200] train_loss: 4.2920, val_loss: 5.2280, lr: 0.003000, 6.19s
2024-05-01 13:54:58 INFO     epoch complete!
2024-05-01 13:54:58 INFO     evaluating now!
2024-05-01 13:54:58 INFO     Epoch [33/200] train_loss: 4.3151, val_loss: 5.3880, lr: 0.003000, 6.34s
2024-05-01 13:55:04 INFO     epoch complete!
2024-05-01 13:55:04 INFO     evaluating now!
2024-05-01 13:55:05 INFO     Epoch [34/200] train_loss: 4.3114, val_loss: 5.3668, lr: 0.003000, 6.31s
2024-05-01 13:55:10 INFO     epoch complete!
2024-05-01 13:55:10 INFO     evaluating now!
2024-05-01 13:55:11 INFO     Epoch [35/200] train_loss: 4.2658, val_loss: 5.2981, lr: 0.003000, 6.20s
2024-05-01 13:55:17 INFO     epoch complete!
2024-05-01 13:55:17 INFO     evaluating now!
2024-05-01 13:55:17 INFO     Epoch [36/200] train_loss: 4.2605, val_loss: 5.2335, lr: 0.003000, 6.12s
2024-05-01 13:55:23 INFO     epoch complete!
2024-05-01 13:55:23 INFO     evaluating now!
2024-05-01 13:55:23 INFO     Epoch [37/200] train_loss: 4.2192, val_loss: 5.2862, lr: 0.003000, 6.26s
2024-05-01 13:55:29 INFO     epoch complete!
2024-05-01 13:55:29 INFO     evaluating now!
2024-05-01 13:55:29 INFO     Epoch [38/200] train_loss: 4.1750, val_loss: 5.2254, lr: 0.003000, 6.23s
2024-05-01 13:55:35 INFO     epoch complete!
2024-05-01 13:55:35 INFO     evaluating now!
2024-05-01 13:55:35 INFO     Epoch [39/200] train_loss: 4.1322, val_loss: 5.1422, lr: 0.003000, 6.01s
2024-05-01 13:55:41 INFO     epoch complete!
2024-05-01 13:55:41 INFO     evaluating now!
2024-05-01 13:55:41 INFO     Epoch [40/200] train_loss: 4.0752, val_loss: 5.0945, lr: 0.003000, 5.94s
2024-05-01 13:55:41 INFO     Saved model at 40
2024-05-01 13:55:41 INFO     Val loss decrease from 5.0961 to 5.0945, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-05-01 13:55:47 INFO     epoch complete!
2024-05-01 13:55:47 INFO     evaluating now!
2024-05-01 13:55:47 INFO     Epoch [41/200] train_loss: 4.1235, val_loss: 5.1700, lr: 0.003000, 6.00s
2024-05-01 13:55:53 INFO     epoch complete!
2024-05-01 13:55:53 INFO     evaluating now!
2024-05-01 13:55:54 INFO     Epoch [42/200] train_loss: 4.0668, val_loss: 5.0799, lr: 0.003000, 6.10s
2024-05-01 13:55:54 INFO     Saved model at 42
2024-05-01 13:55:54 INFO     Val loss decrease from 5.0945 to 5.0799, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-05-01 13:55:59 INFO     epoch complete!
2024-05-01 13:55:59 INFO     evaluating now!
2024-05-01 13:56:00 INFO     Epoch [43/200] train_loss: 4.0154, val_loss: 5.0762, lr: 0.003000, 6.07s
2024-05-01 13:56:00 INFO     Saved model at 43
2024-05-01 13:56:00 INFO     Val loss decrease from 5.0799 to 5.0762, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-05-01 13:56:05 INFO     epoch complete!
2024-05-01 13:56:05 INFO     evaluating now!
2024-05-01 13:56:06 INFO     Epoch [44/200] train_loss: 3.9956, val_loss: 5.2429, lr: 0.003000, 6.15s
2024-05-01 13:56:12 INFO     epoch complete!
2024-05-01 13:56:12 INFO     evaluating now!
2024-05-01 13:56:12 INFO     Epoch [45/200] train_loss: 4.0050, val_loss: 5.0885, lr: 0.003000, 6.15s
2024-05-01 13:56:18 INFO     epoch complete!
2024-05-01 13:56:18 INFO     evaluating now!
2024-05-01 13:56:18 INFO     Epoch [46/200] train_loss: 3.9547, val_loss: 5.0539, lr: 0.003000, 6.17s
2024-05-01 13:56:18 INFO     Saved model at 46
2024-05-01 13:56:18 INFO     Val loss decrease from 5.0762 to 5.0539, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-05-01 13:56:24 INFO     epoch complete!
2024-05-01 13:56:24 INFO     evaluating now!
2024-05-01 13:56:24 INFO     Epoch [47/200] train_loss: 3.9518, val_loss: 5.3717, lr: 0.003000, 5.91s
2024-05-01 13:56:30 INFO     epoch complete!
2024-05-01 13:56:30 INFO     evaluating now!
2024-05-01 13:56:30 INFO     Epoch [48/200] train_loss: 3.9998, val_loss: 5.1042, lr: 0.003000, 6.29s
2024-05-01 13:56:36 INFO     epoch complete!
2024-05-01 13:56:36 INFO     evaluating now!
2024-05-01 13:56:36 INFO     Epoch [49/200] train_loss: 3.8982, val_loss: 5.1249, lr: 0.003000, 6.03s
2024-05-01 13:56:42 INFO     epoch complete!
2024-05-01 13:56:42 INFO     evaluating now!
2024-05-01 13:56:43 INFO     Epoch [50/200] train_loss: 3.8746, val_loss: 5.1249, lr: 0.003000, 6.18s
2024-05-01 13:56:48 INFO     epoch complete!
2024-05-01 13:56:48 INFO     evaluating now!
2024-05-01 13:56:49 INFO     Epoch [51/200] train_loss: 3.9710, val_loss: 5.2225, lr: 0.003000, 5.98s
2024-05-01 13:56:54 INFO     epoch complete!
2024-05-01 13:56:54 INFO     evaluating now!
2024-05-01 13:56:55 INFO     Epoch [52/200] train_loss: 3.9017, val_loss: 5.0014, lr: 0.003000, 6.14s
2024-05-01 13:56:55 INFO     Saved model at 52
2024-05-01 13:56:55 INFO     Val loss decrease from 5.0539 to 5.0014, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch52.tar
2024-05-01 13:57:00 INFO     epoch complete!
2024-05-01 13:57:00 INFO     evaluating now!
2024-05-01 13:57:01 INFO     Epoch [53/200] train_loss: 3.8243, val_loss: 5.1008, lr: 0.003000, 6.03s
2024-05-01 13:57:06 INFO     epoch complete!
2024-05-01 13:57:06 INFO     evaluating now!
2024-05-01 13:57:07 INFO     Epoch [54/200] train_loss: 3.8227, val_loss: 5.2655, lr: 0.003000, 5.93s
2024-05-01 13:57:12 INFO     epoch complete!
2024-05-01 13:57:12 INFO     evaluating now!
2024-05-01 13:57:13 INFO     Epoch [55/200] train_loss: 3.7869, val_loss: 5.2061, lr: 0.003000, 6.06s
2024-05-01 13:57:19 INFO     epoch complete!
2024-05-01 13:57:19 INFO     evaluating now!
2024-05-01 13:57:19 INFO     Epoch [56/200] train_loss: 3.7982, val_loss: 5.0142, lr: 0.003000, 6.30s
2024-05-01 13:57:25 INFO     epoch complete!
2024-05-01 13:57:25 INFO     evaluating now!
2024-05-01 13:57:25 INFO     Epoch [57/200] train_loss: 3.7882, val_loss: 5.1001, lr: 0.003000, 6.05s
2024-05-01 13:57:31 INFO     epoch complete!
2024-05-01 13:57:31 INFO     evaluating now!
2024-05-01 13:57:31 INFO     Epoch [58/200] train_loss: 3.7737, val_loss: 5.0973, lr: 0.003000, 5.98s
2024-05-01 13:57:37 INFO     epoch complete!
2024-05-01 13:57:37 INFO     evaluating now!
2024-05-01 13:57:37 INFO     Epoch [59/200] train_loss: 3.7407, val_loss: 5.1235, lr: 0.003000, 6.02s
2024-05-01 13:57:43 INFO     epoch complete!
2024-05-01 13:57:43 INFO     evaluating now!
2024-05-01 13:57:43 INFO     Epoch [60/200] train_loss: 3.7798, val_loss: 5.1520, lr: 0.003000, 6.14s
2024-05-01 13:57:49 INFO     epoch complete!
2024-05-01 13:57:49 INFO     evaluating now!
2024-05-01 13:57:49 INFO     Epoch [61/200] train_loss: 3.7325, val_loss: 5.0414, lr: 0.003000, 6.07s
2024-05-01 13:57:55 INFO     epoch complete!
2024-05-01 13:57:55 INFO     evaluating now!
2024-05-01 13:57:55 INFO     Epoch [62/200] train_loss: 3.6629, val_loss: 5.0945, lr: 0.003000, 6.03s
2024-05-01 13:58:01 INFO     epoch complete!
2024-05-01 13:58:01 INFO     evaluating now!
2024-05-01 13:58:02 INFO     Epoch [63/200] train_loss: 3.7566, val_loss: 5.2103, lr: 0.003000, 6.12s
2024-05-01 13:58:07 INFO     epoch complete!
2024-05-01 13:58:07 INFO     evaluating now!
2024-05-01 13:58:08 INFO     Epoch [64/200] train_loss: 3.6925, val_loss: 5.0433, lr: 0.003000, 6.00s
2024-05-01 13:58:13 INFO     epoch complete!
2024-05-01 13:58:13 INFO     evaluating now!
2024-05-01 13:58:14 INFO     Epoch [65/200] train_loss: 3.6632, val_loss: 5.2446, lr: 0.003000, 6.08s
2024-05-01 13:58:19 INFO     epoch complete!
2024-05-01 13:58:19 INFO     evaluating now!
2024-05-01 13:58:20 INFO     Epoch [66/200] train_loss: 3.6359, val_loss: 5.0046, lr: 0.003000, 5.97s
2024-05-01 13:58:25 INFO     epoch complete!
2024-05-01 13:58:25 INFO     evaluating now!
2024-05-01 13:58:26 INFO     Epoch [67/200] train_loss: 3.6068, val_loss: 5.1644, lr: 0.003000, 6.13s
2024-05-01 13:58:26 WARNING  Early stopping at epoch: 67
2024-05-01 13:58:26 INFO     Trained totally 68 epochs, average train time is 5.657s, average eval time is 0.407s
2024-05-01 13:58:26 INFO     Loaded model at 52
2024-05-01 13:58:26 INFO     Saved model at ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 13:58:26 INFO     Start evaluating ...
2024-05-01 13:58:27 INFO     Note that you select the single mode to evaluate!
2024-05-01 13:58:27 INFO     Evaluate result is saved at ./libcity/cache/17/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 13:58:27 INFO     
         MAE       RMSE
1   2.295173   6.938480
2   2.527941   7.774482
3   2.738792   8.962762
4   2.908565   9.628344
5   3.014601  10.092928
6   2.997937  10.486003
7   3.101409  10.993554
8   3.141900  11.517540
9   3.248766  12.072599
10  3.369824  12.556682
11  3.375694  12.946819
12  3.528101  13.470001
2024-05-01 13:58:27 INFO     ----------------------------------------------------------------------------
2024-05-01 13:58:27 INFO     # 3, Kownledge Graph Embedding: GIE, Experiment ids: 18
2024-05-01 13:58:27 INFO     ----------------------------------------------------------------------------
2024-05-01 13:58:27 INFO     Log directory: ./libcity/log
2024-05-01 13:58:27 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=18
2024-05-01 13:58:27 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 184946928, 'exp_id': 18, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 13:58:27 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 13:58:27 INFO     set_weight_link_or_dist: dist
2024-05-01 13:58:27 INFO     init_weight_inf_or_zero: inf
2024-05-01 13:58:28 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 13:58:28 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 13:58:28 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 13:58:28 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 13:58:31 INFO     Dataset created
2024-05-01 13:58:31 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 13:58:31 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 13:58:31 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 13:58:31 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 13:58:31 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 13:58:31 INFO     NormalScaler max: 0.3243229993054587
2024-05-01 13:58:34 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 13:58:34 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 13:58:34 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 13:58:34 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 13:58:34 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 13:58:34 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 13:58:34 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 13:58:34 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 13:58:34 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 13:58:34 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 13:58:34 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 13:58:34 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 13:58:34 INFO     Total parameter numbers: 874010
2024-05-01 13:58:34 INFO     You select `adam` optimizer.
2024-05-01 13:58:34 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 13:58:34 INFO     Start training ...
2024-05-01 13:58:34 INFO     num_batches:48
2024-05-01 13:58:40 INFO     epoch complete!
2024-05-01 13:58:40 INFO     evaluating now!
2024-05-01 13:58:40 INFO     Epoch [0/200] train_loss: 23.2046, val_loss: 18.7135, lr: 0.003000, 6.10s
2024-05-01 13:58:40 INFO     Saved model at 0
2024-05-01 13:58:40 INFO     Val loss decrease from inf to 18.7135, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 13:58:46 INFO     epoch complete!
2024-05-01 13:58:46 INFO     evaluating now!
2024-05-01 13:58:46 INFO     Epoch [1/200] train_loss: 15.9615, val_loss: 16.0932, lr: 0.003000, 6.05s
2024-05-01 13:58:46 INFO     Saved model at 1
2024-05-01 13:58:46 INFO     Val loss decrease from 18.7135 to 16.0932, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 13:58:52 INFO     epoch complete!
2024-05-01 13:58:52 INFO     evaluating now!
2024-05-01 13:58:53 INFO     Epoch [2/200] train_loss: 13.3965, val_loss: 12.7056, lr: 0.003000, 6.10s
2024-05-01 13:58:53 INFO     Saved model at 2
2024-05-01 13:58:53 INFO     Val loss decrease from 16.0932 to 12.7056, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 13:58:58 INFO     epoch complete!
2024-05-01 13:58:58 INFO     evaluating now!
2024-05-01 13:58:59 INFO     Epoch [3/200] train_loss: 10.7703, val_loss: 10.3143, lr: 0.003000, 6.18s
2024-05-01 13:58:59 INFO     Saved model at 3
2024-05-01 13:58:59 INFO     Val loss decrease from 12.7056 to 10.3143, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 13:59:04 INFO     epoch complete!
2024-05-01 13:59:04 INFO     evaluating now!
2024-05-01 13:59:05 INFO     Epoch [4/200] train_loss: 9.1994, val_loss: 8.7501, lr: 0.003000, 6.00s
2024-05-01 13:59:05 INFO     Saved model at 4
2024-05-01 13:59:05 INFO     Val loss decrease from 10.3143 to 8.7501, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 13:59:11 INFO     epoch complete!
2024-05-01 13:59:11 INFO     evaluating now!
2024-05-01 13:59:11 INFO     Epoch [5/200] train_loss: 8.1642, val_loss: 8.0742, lr: 0.003000, 6.13s
2024-05-01 13:59:11 INFO     Saved model at 5
2024-05-01 13:59:11 INFO     Val loss decrease from 8.7501 to 8.0742, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 13:59:17 INFO     epoch complete!
2024-05-01 13:59:17 INFO     evaluating now!
2024-05-01 13:59:17 INFO     Epoch [6/200] train_loss: 7.6034, val_loss: 7.7523, lr: 0.003000, 6.00s
2024-05-01 13:59:17 INFO     Saved model at 6
2024-05-01 13:59:17 INFO     Val loss decrease from 8.0742 to 7.7523, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 13:59:23 INFO     epoch complete!
2024-05-01 13:59:23 INFO     evaluating now!
2024-05-01 13:59:23 INFO     Epoch [7/200] train_loss: 7.1859, val_loss: 7.0450, lr: 0.003000, 6.08s
2024-05-01 13:59:23 INFO     Saved model at 7
2024-05-01 13:59:23 INFO     Val loss decrease from 7.7523 to 7.0450, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 13:59:29 INFO     epoch complete!
2024-05-01 13:59:29 INFO     evaluating now!
2024-05-01 13:59:29 INFO     Epoch [8/200] train_loss: 6.7598, val_loss: 6.6354, lr: 0.003000, 6.13s
2024-05-01 13:59:29 INFO     Saved model at 8
2024-05-01 13:59:29 INFO     Val loss decrease from 7.0450 to 6.6354, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-01 13:59:35 INFO     epoch complete!
2024-05-01 13:59:35 INFO     evaluating now!
2024-05-01 13:59:35 INFO     Epoch [9/200] train_loss: 6.4260, val_loss: 6.3870, lr: 0.003000, 6.04s
2024-05-01 13:59:35 INFO     Saved model at 9
2024-05-01 13:59:35 INFO     Val loss decrease from 6.6354 to 6.3870, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-01 13:59:41 INFO     epoch complete!
2024-05-01 13:59:41 INFO     evaluating now!
2024-05-01 13:59:42 INFO     Epoch [10/200] train_loss: 6.1677, val_loss: 6.2857, lr: 0.003000, 6.11s
2024-05-01 13:59:42 INFO     Saved model at 10
2024-05-01 13:59:42 INFO     Val loss decrease from 6.3870 to 6.2857, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-01 13:59:47 INFO     epoch complete!
2024-05-01 13:59:47 INFO     evaluating now!
2024-05-01 13:59:48 INFO     Epoch [11/200] train_loss: 5.9583, val_loss: 6.0602, lr: 0.003000, 6.10s
2024-05-01 13:59:48 INFO     Saved model at 11
2024-05-01 13:59:48 INFO     Val loss decrease from 6.2857 to 6.0602, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-01 13:59:53 INFO     epoch complete!
2024-05-01 13:59:53 INFO     evaluating now!
2024-05-01 13:59:54 INFO     Epoch [12/200] train_loss: 5.8878, val_loss: 5.9571, lr: 0.003000, 6.11s
2024-05-01 13:59:54 INFO     Saved model at 12
2024-05-01 13:59:54 INFO     Val loss decrease from 6.0602 to 5.9571, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-01 13:59:59 INFO     epoch complete!
2024-05-01 13:59:59 INFO     evaluating now!
2024-05-01 14:00:00 INFO     Epoch [13/200] train_loss: 5.6738, val_loss: 5.8579, lr: 0.003000, 5.95s
2024-05-01 14:00:00 INFO     Saved model at 13
2024-05-01 14:00:00 INFO     Val loss decrease from 5.9571 to 5.8579, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-01 14:00:06 INFO     epoch complete!
2024-05-01 14:00:06 INFO     evaluating now!
2024-05-01 14:00:06 INFO     Epoch [14/200] train_loss: 5.5472, val_loss: 5.9182, lr: 0.003000, 5.98s
2024-05-01 14:00:11 INFO     epoch complete!
2024-05-01 14:00:11 INFO     evaluating now!
2024-05-01 14:00:12 INFO     Epoch [15/200] train_loss: 5.5508, val_loss: 5.8301, lr: 0.003000, 5.87s
2024-05-01 14:00:12 INFO     Saved model at 15
2024-05-01 14:00:12 INFO     Val loss decrease from 5.8579 to 5.8301, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-01 14:00:17 INFO     epoch complete!
2024-05-01 14:00:17 INFO     evaluating now!
2024-05-01 14:00:18 INFO     Epoch [16/200] train_loss: 5.3699, val_loss: 5.7358, lr: 0.003000, 5.86s
2024-05-01 14:00:18 INFO     Saved model at 16
2024-05-01 14:00:18 INFO     Val loss decrease from 5.8301 to 5.7358, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-01 14:00:23 INFO     epoch complete!
2024-05-01 14:00:23 INFO     evaluating now!
2024-05-01 14:00:23 INFO     Epoch [17/200] train_loss: 5.2039, val_loss: 5.6067, lr: 0.003000, 5.45s
2024-05-01 14:00:23 INFO     Saved model at 17
2024-05-01 14:00:23 INFO     Val loss decrease from 5.7358 to 5.6067, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-01 14:00:29 INFO     epoch complete!
2024-05-01 14:00:29 INFO     evaluating now!
2024-05-01 14:00:29 INFO     Epoch [18/200] train_loss: 5.1584, val_loss: 5.5323, lr: 0.003000, 5.81s
2024-05-01 14:00:29 INFO     Saved model at 18
2024-05-01 14:00:29 INFO     Val loss decrease from 5.6067 to 5.5323, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-01 14:00:35 INFO     epoch complete!
2024-05-01 14:00:35 INFO     evaluating now!
2024-05-01 14:00:35 INFO     Epoch [19/200] train_loss: 5.1783, val_loss: 5.5447, lr: 0.003000, 5.86s
2024-05-01 14:00:40 INFO     epoch complete!
2024-05-01 14:00:40 INFO     evaluating now!
2024-05-01 14:00:41 INFO     Epoch [20/200] train_loss: 4.9919, val_loss: 5.3765, lr: 0.003000, 5.86s
2024-05-01 14:00:41 INFO     Saved model at 20
2024-05-01 14:00:41 INFO     Val loss decrease from 5.5323 to 5.3765, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-01 14:00:46 INFO     epoch complete!
2024-05-01 14:00:46 INFO     evaluating now!
2024-05-01 14:00:47 INFO     Epoch [21/200] train_loss: 4.9268, val_loss: 5.3784, lr: 0.003000, 5.71s
2024-05-01 14:00:52 INFO     epoch complete!
2024-05-01 14:00:52 INFO     evaluating now!
2024-05-01 14:00:53 INFO     Epoch [22/200] train_loss: 4.8804, val_loss: 5.4128, lr: 0.003000, 5.97s
2024-05-01 14:00:58 INFO     epoch complete!
2024-05-01 14:00:58 INFO     evaluating now!
2024-05-01 14:00:59 INFO     Epoch [23/200] train_loss: 4.8650, val_loss: 5.4812, lr: 0.003000, 5.99s
2024-05-01 14:01:04 INFO     epoch complete!
2024-05-01 14:01:04 INFO     evaluating now!
2024-05-01 14:01:05 INFO     Epoch [24/200] train_loss: 4.8271, val_loss: 5.1886, lr: 0.003000, 5.98s
2024-05-01 14:01:05 INFO     Saved model at 24
2024-05-01 14:01:05 INFO     Val loss decrease from 5.3765 to 5.1886, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-01 14:01:10 INFO     epoch complete!
2024-05-01 14:01:10 INFO     evaluating now!
2024-05-01 14:01:10 INFO     Epoch [25/200] train_loss: 4.7757, val_loss: 5.3974, lr: 0.003000, 5.73s
2024-05-01 14:01:16 INFO     epoch complete!
2024-05-01 14:01:16 INFO     evaluating now!
2024-05-01 14:01:16 INFO     Epoch [26/200] train_loss: 4.7095, val_loss: 5.5038, lr: 0.003000, 5.73s
2024-05-01 14:01:21 INFO     epoch complete!
2024-05-01 14:01:21 INFO     evaluating now!
2024-05-01 14:01:22 INFO     Epoch [27/200] train_loss: 4.5968, val_loss: 5.3158, lr: 0.003000, 5.77s
2024-05-01 14:01:27 INFO     epoch complete!
2024-05-01 14:01:27 INFO     evaluating now!
2024-05-01 14:01:28 INFO     Epoch [28/200] train_loss: 4.6053, val_loss: 5.2148, lr: 0.003000, 5.82s
2024-05-01 14:01:33 INFO     epoch complete!
2024-05-01 14:01:33 INFO     evaluating now!
2024-05-01 14:01:33 INFO     Epoch [29/200] train_loss: 4.5044, val_loss: 5.1588, lr: 0.003000, 5.47s
2024-05-01 14:01:33 INFO     Saved model at 29
2024-05-01 14:01:33 INFO     Val loss decrease from 5.1886 to 5.1588, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-05-01 14:01:38 INFO     epoch complete!
2024-05-01 14:01:38 INFO     evaluating now!
2024-05-01 14:01:39 INFO     Epoch [30/200] train_loss: 4.4949, val_loss: 5.2975, lr: 0.003000, 5.70s
2024-05-01 14:01:44 INFO     epoch complete!
2024-05-01 14:01:44 INFO     evaluating now!
2024-05-01 14:01:45 INFO     Epoch [31/200] train_loss: 4.4503, val_loss: 5.1874, lr: 0.003000, 5.75s
2024-05-01 14:01:50 INFO     epoch complete!
2024-05-01 14:01:50 INFO     evaluating now!
2024-05-01 14:01:50 INFO     Epoch [32/200] train_loss: 4.3867, val_loss: 5.1319, lr: 0.003000, 5.80s
2024-05-01 14:01:50 INFO     Saved model at 32
2024-05-01 14:01:50 INFO     Val loss decrease from 5.1588 to 5.1319, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-05-01 14:01:56 INFO     epoch complete!
2024-05-01 14:01:56 INFO     evaluating now!
2024-05-01 14:01:56 INFO     Epoch [33/200] train_loss: 4.4498, val_loss: 5.0883, lr: 0.003000, 5.80s
2024-05-01 14:01:56 INFO     Saved model at 33
2024-05-01 14:01:56 INFO     Val loss decrease from 5.1319 to 5.0883, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-05-01 14:02:02 INFO     epoch complete!
2024-05-01 14:02:02 INFO     evaluating now!
2024-05-01 14:02:02 INFO     Epoch [34/200] train_loss: 4.3167, val_loss: 5.2101, lr: 0.003000, 5.76s
2024-05-01 14:02:07 INFO     epoch complete!
2024-05-01 14:02:07 INFO     evaluating now!
2024-05-01 14:02:08 INFO     Epoch [35/200] train_loss: 4.3079, val_loss: 5.3207, lr: 0.003000, 5.72s
2024-05-01 14:02:13 INFO     epoch complete!
2024-05-01 14:02:13 INFO     evaluating now!
2024-05-01 14:02:13 INFO     Epoch [36/200] train_loss: 4.2979, val_loss: 5.1702, lr: 0.003000, 5.64s
2024-05-01 14:02:19 INFO     epoch complete!
2024-05-01 14:02:19 INFO     evaluating now!
2024-05-01 14:02:19 INFO     Epoch [37/200] train_loss: 4.2355, val_loss: 5.2017, lr: 0.003000, 5.98s
2024-05-01 14:02:25 INFO     epoch complete!
2024-05-01 14:02:25 INFO     evaluating now!
2024-05-01 14:02:25 INFO     Epoch [38/200] train_loss: 4.2328, val_loss: 5.1748, lr: 0.003000, 5.76s
2024-05-01 14:02:31 INFO     epoch complete!
2024-05-01 14:02:31 INFO     evaluating now!
2024-05-01 14:02:31 INFO     Epoch [39/200] train_loss: 4.2491, val_loss: 5.1868, lr: 0.003000, 5.97s
2024-05-01 14:02:37 INFO     epoch complete!
2024-05-01 14:02:37 INFO     evaluating now!
2024-05-01 14:02:37 INFO     Epoch [40/200] train_loss: 4.1805, val_loss: 5.0213, lr: 0.003000, 6.03s
2024-05-01 14:02:37 INFO     Saved model at 40
2024-05-01 14:02:37 INFO     Val loss decrease from 5.0883 to 5.0213, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-05-01 14:02:42 INFO     epoch complete!
2024-05-01 14:02:42 INFO     evaluating now!
2024-05-01 14:02:43 INFO     Epoch [41/200] train_loss: 4.1586, val_loss: 5.0798, lr: 0.003000, 5.63s
2024-05-01 14:02:48 INFO     epoch complete!
2024-05-01 14:02:48 INFO     evaluating now!
2024-05-01 14:02:48 INFO     Epoch [42/200] train_loss: 4.0536, val_loss: 5.2035, lr: 0.003000, 5.54s
2024-05-01 14:02:54 INFO     epoch complete!
2024-05-01 14:02:54 INFO     evaluating now!
2024-05-01 14:02:54 INFO     Epoch [43/200] train_loss: 4.0216, val_loss: 5.1478, lr: 0.003000, 5.82s
2024-05-01 14:03:00 INFO     epoch complete!
2024-05-01 14:03:00 INFO     evaluating now!
2024-05-01 14:03:00 INFO     Epoch [44/200] train_loss: 4.0094, val_loss: 5.2232, lr: 0.003000, 5.88s
2024-05-01 14:03:06 INFO     epoch complete!
2024-05-01 14:03:06 INFO     evaluating now!
2024-05-01 14:03:06 INFO     Epoch [45/200] train_loss: 4.0441, val_loss: 4.9966, lr: 0.003000, 6.28s
2024-05-01 14:03:06 INFO     Saved model at 45
2024-05-01 14:03:06 INFO     Val loss decrease from 5.0213 to 4.9966, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-05-01 14:03:12 INFO     epoch complete!
2024-05-01 14:03:12 INFO     evaluating now!
2024-05-01 14:03:13 INFO     Epoch [46/200] train_loss: 3.9732, val_loss: 4.9896, lr: 0.003000, 6.44s
2024-05-01 14:03:13 INFO     Saved model at 46
2024-05-01 14:03:13 INFO     Val loss decrease from 4.9966 to 4.9896, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-05-01 14:03:19 INFO     epoch complete!
2024-05-01 14:03:19 INFO     evaluating now!
2024-05-01 14:03:19 INFO     Epoch [47/200] train_loss: 3.9619, val_loss: 5.0885, lr: 0.003000, 6.33s
2024-05-01 14:03:25 INFO     epoch complete!
2024-05-01 14:03:25 INFO     evaluating now!
2024-05-01 14:03:26 INFO     Epoch [48/200] train_loss: 3.9276, val_loss: 5.0062, lr: 0.003000, 6.52s
2024-05-01 14:03:32 INFO     epoch complete!
2024-05-01 14:03:32 INFO     evaluating now!
2024-05-01 14:03:32 INFO     Epoch [49/200] train_loss: 3.9054, val_loss: 5.1220, lr: 0.003000, 6.33s
2024-05-01 14:03:38 INFO     epoch complete!
2024-05-01 14:03:38 INFO     evaluating now!
2024-05-01 14:03:38 INFO     Epoch [50/200] train_loss: 3.8619, val_loss: 5.0033, lr: 0.003000, 6.40s
2024-05-01 14:03:45 INFO     epoch complete!
2024-05-01 14:03:45 INFO     evaluating now!
2024-05-01 14:03:45 INFO     Epoch [51/200] train_loss: 3.9087, val_loss: 5.2772, lr: 0.003000, 6.50s
2024-05-01 14:03:51 INFO     epoch complete!
2024-05-01 14:03:51 INFO     evaluating now!
2024-05-01 14:03:51 INFO     Epoch [52/200] train_loss: 3.8769, val_loss: 5.1207, lr: 0.003000, 6.34s
2024-05-01 14:03:57 INFO     epoch complete!
2024-05-01 14:03:57 INFO     evaluating now!
2024-05-01 14:03:57 INFO     Epoch [53/200] train_loss: 3.8931, val_loss: 5.1073, lr: 0.003000, 6.09s
2024-05-01 14:04:03 INFO     epoch complete!
2024-05-01 14:04:03 INFO     evaluating now!
2024-05-01 14:04:04 INFO     Epoch [54/200] train_loss: 3.8102, val_loss: 5.0566, lr: 0.003000, 6.15s
2024-05-01 14:04:09 INFO     epoch complete!
2024-05-01 14:04:09 INFO     evaluating now!
2024-05-01 14:04:10 INFO     Epoch [55/200] train_loss: 3.8841, val_loss: 5.1585, lr: 0.003000, 6.12s
2024-05-01 14:04:16 INFO     epoch complete!
2024-05-01 14:04:16 INFO     evaluating now!
2024-05-01 14:04:16 INFO     Epoch [56/200] train_loss: 3.8559, val_loss: 5.0904, lr: 0.003000, 6.34s
2024-05-01 14:04:22 INFO     epoch complete!
2024-05-01 14:04:22 INFO     evaluating now!
2024-05-01 14:04:22 INFO     Epoch [57/200] train_loss: 3.8069, val_loss: 4.9444, lr: 0.003000, 6.11s
2024-05-01 14:04:22 INFO     Saved model at 57
2024-05-01 14:04:22 INFO     Val loss decrease from 4.9896 to 4.9444, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch57.tar
2024-05-01 14:04:28 INFO     epoch complete!
2024-05-01 14:04:28 INFO     evaluating now!
2024-05-01 14:04:28 INFO     Epoch [58/200] train_loss: 3.7537, val_loss: 4.9247, lr: 0.003000, 6.30s
2024-05-01 14:04:28 INFO     Saved model at 58
2024-05-01 14:04:28 INFO     Val loss decrease from 4.9444 to 4.9247, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch58.tar
2024-05-01 14:04:34 INFO     epoch complete!
2024-05-01 14:04:34 INFO     evaluating now!
2024-05-01 14:04:35 INFO     Epoch [59/200] train_loss: 3.6689, val_loss: 4.9462, lr: 0.003000, 6.31s
2024-05-01 14:04:40 INFO     epoch complete!
2024-05-01 14:04:40 INFO     evaluating now!
2024-05-01 14:04:41 INFO     Epoch [60/200] train_loss: 3.6974, val_loss: 5.0336, lr: 0.003000, 6.10s
2024-05-01 14:04:46 INFO     epoch complete!
2024-05-01 14:04:46 INFO     evaluating now!
2024-05-01 14:04:47 INFO     Epoch [61/200] train_loss: 3.6892, val_loss: 5.0582, lr: 0.003000, 5.97s
2024-05-01 14:04:52 INFO     epoch complete!
2024-05-01 14:04:52 INFO     evaluating now!
2024-05-01 14:04:53 INFO     Epoch [62/200] train_loss: 3.6253, val_loss: 5.1559, lr: 0.003000, 6.03s
2024-05-01 14:04:59 INFO     epoch complete!
2024-05-01 14:04:59 INFO     evaluating now!
2024-05-01 14:04:59 INFO     Epoch [63/200] train_loss: 3.6436, val_loss: 5.0217, lr: 0.003000, 6.32s
2024-05-01 14:05:05 INFO     epoch complete!
2024-05-01 14:05:05 INFO     evaluating now!
2024-05-01 14:05:05 INFO     Epoch [64/200] train_loss: 3.6480, val_loss: 4.9153, lr: 0.003000, 6.21s
2024-05-01 14:05:05 INFO     Saved model at 64
2024-05-01 14:05:05 INFO     Val loss decrease from 4.9247 to 4.9153, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch64.tar
2024-05-01 14:05:11 INFO     epoch complete!
2024-05-01 14:05:11 INFO     evaluating now!
2024-05-01 14:05:12 INFO     Epoch [65/200] train_loss: 3.6661, val_loss: 5.1065, lr: 0.003000, 6.12s
2024-05-01 14:05:17 INFO     epoch complete!
2024-05-01 14:05:17 INFO     evaluating now!
2024-05-01 14:05:18 INFO     Epoch [66/200] train_loss: 3.5890, val_loss: 5.0816, lr: 0.003000, 6.18s
2024-05-01 14:05:24 INFO     epoch complete!
2024-05-01 14:05:24 INFO     evaluating now!
2024-05-01 14:05:24 INFO     Epoch [67/200] train_loss: 3.5933, val_loss: 5.0298, lr: 0.003000, 6.23s
2024-05-01 14:05:30 INFO     epoch complete!
2024-05-01 14:05:30 INFO     evaluating now!
2024-05-01 14:05:30 INFO     Epoch [68/200] train_loss: 3.5749, val_loss: 5.0895, lr: 0.003000, 6.30s
2024-05-01 14:05:36 INFO     epoch complete!
2024-05-01 14:05:36 INFO     evaluating now!
2024-05-01 14:05:36 INFO     Epoch [69/200] train_loss: 3.5161, val_loss: 5.0174, lr: 0.003000, 6.08s
2024-05-01 14:05:42 INFO     epoch complete!
2024-05-01 14:05:42 INFO     evaluating now!
2024-05-01 14:05:43 INFO     Epoch [70/200] train_loss: 3.5560, val_loss: 4.9976, lr: 0.003000, 6.14s
2024-05-01 14:05:48 INFO     epoch complete!
2024-05-01 14:05:48 INFO     evaluating now!
2024-05-01 14:05:49 INFO     Epoch [71/200] train_loss: 3.5620, val_loss: 5.0141, lr: 0.003000, 6.24s
2024-05-01 14:05:55 INFO     epoch complete!
2024-05-01 14:05:55 INFO     evaluating now!
2024-05-01 14:05:55 INFO     Epoch [72/200] train_loss: 3.4996, val_loss: 4.9883, lr: 0.003000, 6.21s
2024-05-01 14:06:01 INFO     epoch complete!
2024-05-01 14:06:01 INFO     evaluating now!
2024-05-01 14:06:01 INFO     Epoch [73/200] train_loss: 3.4753, val_loss: 4.9076, lr: 0.003000, 6.37s
2024-05-01 14:06:01 INFO     Saved model at 73
2024-05-01 14:06:01 INFO     Val loss decrease from 4.9153 to 4.9076, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch73.tar
2024-05-01 14:06:07 INFO     epoch complete!
2024-05-01 14:06:07 INFO     evaluating now!
2024-05-01 14:06:08 INFO     Epoch [74/200] train_loss: 3.5599, val_loss: 5.0098, lr: 0.003000, 6.37s
2024-05-01 14:06:14 INFO     epoch complete!
2024-05-01 14:06:14 INFO     evaluating now!
2024-05-01 14:06:14 INFO     Epoch [75/200] train_loss: 3.5584, val_loss: 5.0284, lr: 0.003000, 6.31s
2024-05-01 14:06:20 INFO     epoch complete!
2024-05-01 14:06:20 INFO     evaluating now!
2024-05-01 14:06:20 INFO     Epoch [76/200] train_loss: 3.4855, val_loss: 4.9991, lr: 0.003000, 6.11s
2024-05-01 14:06:26 INFO     epoch complete!
2024-05-01 14:06:26 INFO     evaluating now!
2024-05-01 14:06:26 INFO     Epoch [77/200] train_loss: 3.4752, val_loss: 5.1247, lr: 0.003000, 6.12s
2024-05-01 14:06:32 INFO     epoch complete!
2024-05-01 14:06:32 INFO     evaluating now!
2024-05-01 14:06:32 INFO     Epoch [78/200] train_loss: 3.5463, val_loss: 5.0819, lr: 0.003000, 6.19s
2024-05-01 14:06:38 INFO     epoch complete!
2024-05-01 14:06:38 INFO     evaluating now!
2024-05-01 14:06:39 INFO     Epoch [79/200] train_loss: 3.4580, val_loss: 5.0985, lr: 0.003000, 6.26s
2024-05-01 14:06:45 INFO     epoch complete!
2024-05-01 14:06:45 INFO     evaluating now!
2024-05-01 14:06:45 INFO     Epoch [80/200] train_loss: 3.5113, val_loss: 5.0127, lr: 0.003000, 6.21s
2024-05-01 14:06:51 INFO     epoch complete!
2024-05-01 14:06:51 INFO     evaluating now!
2024-05-01 14:06:51 INFO     Epoch [81/200] train_loss: 3.4408, val_loss: 4.9628, lr: 0.003000, 6.35s
2024-05-01 14:06:57 INFO     epoch complete!
2024-05-01 14:06:57 INFO     evaluating now!
2024-05-01 14:06:58 INFO     Epoch [82/200] train_loss: 3.4089, val_loss: 5.0098, lr: 0.003000, 6.26s
2024-05-01 14:07:04 INFO     epoch complete!
2024-05-01 14:07:04 INFO     evaluating now!
2024-05-01 14:07:04 INFO     Epoch [83/200] train_loss: 3.4251, val_loss: 4.9182, lr: 0.003000, 6.41s
2024-05-01 14:07:10 INFO     epoch complete!
2024-05-01 14:07:10 INFO     evaluating now!
2024-05-01 14:07:10 INFO     Epoch [84/200] train_loss: 3.4212, val_loss: 5.1299, lr: 0.003000, 6.36s
2024-05-01 14:07:16 INFO     epoch complete!
2024-05-01 14:07:16 INFO     evaluating now!
2024-05-01 14:07:17 INFO     Epoch [85/200] train_loss: 3.4081, val_loss: 5.0718, lr: 0.003000, 6.38s
2024-05-01 14:07:23 INFO     epoch complete!
2024-05-01 14:07:23 INFO     evaluating now!
2024-05-01 14:07:23 INFO     Epoch [86/200] train_loss: 3.3875, val_loss: 4.9335, lr: 0.003000, 6.26s
2024-05-01 14:07:29 INFO     epoch complete!
2024-05-01 14:07:29 INFO     evaluating now!
2024-05-01 14:07:29 INFO     Epoch [87/200] train_loss: 3.3567, val_loss: 5.1071, lr: 0.003000, 6.45s
2024-05-01 14:07:35 INFO     epoch complete!
2024-05-01 14:07:35 INFO     evaluating now!
2024-05-01 14:07:36 INFO     Epoch [88/200] train_loss: 3.3520, val_loss: 4.9799, lr: 0.003000, 6.29s
2024-05-01 14:07:36 WARNING  Early stopping at epoch: 88
2024-05-01 14:07:36 INFO     Trained totally 89 epochs, average train time is 5.649s, average eval time is 0.417s
2024-05-01 14:07:36 INFO     Loaded model at 73
2024-05-01 14:07:36 INFO     Saved model at ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 14:07:36 INFO     Start evaluating ...
2024-05-01 14:07:37 INFO     Note that you select the single mode to evaluate!
2024-05-01 14:07:37 INFO     Evaluate result is saved at ./libcity/cache/18/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 14:07:37 INFO     
         MAE       RMSE
1   2.373247   7.333576
2   2.470515   7.910336
3   2.651320   8.819502
4   2.861364   9.799046
5   3.044161  10.795444
6   3.163558  11.850840
7   3.256679  12.543723
8   3.268247  12.976844
9   3.333765  13.102620
10  3.320322  13.167533
11  3.420972  13.529376
12  3.496127  14.066715
2024-05-01 14:07:37 INFO     ----------------------------------------------------------------------------
2024-05-01 14:07:37 INFO     # 4, Kownledge Graph Embedding: GIE, Experiment ids: 19
2024-05-01 14:07:37 INFO     ----------------------------------------------------------------------------
2024-05-01 14:07:37 INFO     Log directory: ./libcity/log
2024-05-01 14:07:37 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=19
2024-05-01 14:07:37 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 77164483, 'exp_id': 19, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 14:07:38 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 14:07:38 INFO     set_weight_link_or_dist: dist
2024-05-01 14:07:38 INFO     init_weight_inf_or_zero: inf
2024-05-01 14:07:38 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 14:07:38 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 14:07:38 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 14:07:38 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 14:07:41 INFO     Dataset created
2024-05-01 14:07:41 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 14:07:41 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 14:07:41 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 14:07:41 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 14:07:41 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 14:07:41 INFO     NormalScaler max: 0.3243229993054587
2024-05-01 14:07:44 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 14:07:44 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 14:07:44 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 14:07:44 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 14:07:44 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 14:07:44 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 14:07:44 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 14:07:44 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 14:07:44 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 14:07:44 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 14:07:44 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 14:07:44 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 14:07:44 INFO     Total parameter numbers: 874010
2024-05-01 14:07:44 INFO     You select `adam` optimizer.
2024-05-01 14:07:44 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 14:07:44 INFO     Start training ...
2024-05-01 14:07:44 INFO     num_batches:48
2024-05-01 14:07:50 INFO     epoch complete!
2024-05-01 14:07:50 INFO     evaluating now!
2024-05-01 14:07:50 INFO     Epoch [0/200] train_loss: 24.1586, val_loss: 18.7772, lr: 0.003000, 6.22s
2024-05-01 14:07:50 INFO     Saved model at 0
2024-05-01 14:07:50 INFO     Val loss decrease from inf to 18.7772, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 14:07:56 INFO     epoch complete!
2024-05-01 14:07:56 INFO     evaluating now!
2024-05-01 14:07:57 INFO     Epoch [1/200] train_loss: 15.4095, val_loss: 14.8431, lr: 0.003000, 6.16s
2024-05-01 14:07:57 INFO     Saved model at 1
2024-05-01 14:07:57 INFO     Val loss decrease from 18.7772 to 14.8431, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 14:08:02 INFO     epoch complete!
2024-05-01 14:08:02 INFO     evaluating now!
2024-05-01 14:08:03 INFO     Epoch [2/200] train_loss: 13.0392, val_loss: 13.0838, lr: 0.003000, 6.18s
2024-05-01 14:08:03 INFO     Saved model at 2
2024-05-01 14:08:03 INFO     Val loss decrease from 14.8431 to 13.0838, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 14:08:09 INFO     epoch complete!
2024-05-01 14:08:09 INFO     evaluating now!
2024-05-01 14:08:09 INFO     Epoch [3/200] train_loss: 11.8786, val_loss: 11.7902, lr: 0.003000, 6.38s
2024-05-01 14:08:09 INFO     Saved model at 3
2024-05-01 14:08:09 INFO     Val loss decrease from 13.0838 to 11.7902, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 14:08:15 INFO     epoch complete!
2024-05-01 14:08:15 INFO     evaluating now!
2024-05-01 14:08:16 INFO     Epoch [4/200] train_loss: 9.8690, val_loss: 9.7887, lr: 0.003000, 6.45s
2024-05-01 14:08:16 INFO     Saved model at 4
2024-05-01 14:08:16 INFO     Val loss decrease from 11.7902 to 9.7887, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 14:08:22 INFO     epoch complete!
2024-05-01 14:08:22 INFO     evaluating now!
2024-05-01 14:08:22 INFO     Epoch [5/200] train_loss: 8.6214, val_loss: 8.4078, lr: 0.003000, 6.29s
2024-05-01 14:08:22 INFO     Saved model at 5
2024-05-01 14:08:22 INFO     Val loss decrease from 9.7887 to 8.4078, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 14:08:28 INFO     epoch complete!
2024-05-01 14:08:28 INFO     evaluating now!
2024-05-01 14:08:28 INFO     Epoch [6/200] train_loss: 7.6073, val_loss: 7.4065, lr: 0.003000, 6.26s
2024-05-01 14:08:28 INFO     Saved model at 6
2024-05-01 14:08:28 INFO     Val loss decrease from 8.4078 to 7.4065, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 14:08:35 INFO     epoch complete!
2024-05-01 14:08:35 INFO     evaluating now!
2024-05-01 14:08:35 INFO     Epoch [7/200] train_loss: 7.2305, val_loss: 6.8326, lr: 0.003000, 6.63s
2024-05-01 14:08:35 INFO     Saved model at 7
2024-05-01 14:08:35 INFO     Val loss decrease from 7.4065 to 6.8326, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 14:08:41 INFO     epoch complete!
2024-05-01 14:08:41 INFO     evaluating now!
2024-05-01 14:08:42 INFO     Epoch [8/200] train_loss: 6.5782, val_loss: 6.5494, lr: 0.003000, 6.45s
2024-05-01 14:08:42 INFO     Saved model at 8
2024-05-01 14:08:42 INFO     Val loss decrease from 6.8326 to 6.5494, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-01 14:08:47 INFO     epoch complete!
2024-05-01 14:08:47 INFO     evaluating now!
2024-05-01 14:08:48 INFO     Epoch [9/200] train_loss: 6.3269, val_loss: 6.4036, lr: 0.003000, 6.25s
2024-05-01 14:08:48 INFO     Saved model at 9
2024-05-01 14:08:48 INFO     Val loss decrease from 6.5494 to 6.4036, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-01 14:08:54 INFO     epoch complete!
2024-05-01 14:08:54 INFO     evaluating now!
2024-05-01 14:08:54 INFO     Epoch [10/200] train_loss: 6.2314, val_loss: 6.3634, lr: 0.003000, 6.38s
2024-05-01 14:08:54 INFO     Saved model at 10
2024-05-01 14:08:54 INFO     Val loss decrease from 6.4036 to 6.3634, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-01 14:09:00 INFO     epoch complete!
2024-05-01 14:09:00 INFO     evaluating now!
2024-05-01 14:09:01 INFO     Epoch [11/200] train_loss: 6.0419, val_loss: 6.2296, lr: 0.003000, 6.27s
2024-05-01 14:09:01 INFO     Saved model at 11
2024-05-01 14:09:01 INFO     Val loss decrease from 6.3634 to 6.2296, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-01 14:09:07 INFO     epoch complete!
2024-05-01 14:09:07 INFO     evaluating now!
2024-05-01 14:09:07 INFO     Epoch [12/200] train_loss: 5.7475, val_loss: 5.9509, lr: 0.003000, 6.36s
2024-05-01 14:09:07 INFO     Saved model at 12
2024-05-01 14:09:07 INFO     Val loss decrease from 6.2296 to 5.9509, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-01 14:09:13 INFO     epoch complete!
2024-05-01 14:09:13 INFO     evaluating now!
2024-05-01 14:09:13 INFO     Epoch [13/200] train_loss: 5.6876, val_loss: 6.0986, lr: 0.003000, 6.29s
2024-05-01 14:09:19 INFO     epoch complete!
2024-05-01 14:09:19 INFO     evaluating now!
2024-05-01 14:09:20 INFO     Epoch [14/200] train_loss: 5.5341, val_loss: 6.1899, lr: 0.003000, 6.15s
2024-05-01 14:09:25 INFO     epoch complete!
2024-05-01 14:09:25 INFO     evaluating now!
2024-05-01 14:09:26 INFO     Epoch [15/200] train_loss: 5.5273, val_loss: 5.8010, lr: 0.003000, 6.03s
2024-05-01 14:09:26 INFO     Saved model at 15
2024-05-01 14:09:26 INFO     Val loss decrease from 5.9509 to 5.8010, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-01 14:09:31 INFO     epoch complete!
2024-05-01 14:09:31 INFO     evaluating now!
2024-05-01 14:09:32 INFO     Epoch [16/200] train_loss: 5.3709, val_loss: 5.6660, lr: 0.003000, 5.96s
2024-05-01 14:09:32 INFO     Saved model at 16
2024-05-01 14:09:32 INFO     Val loss decrease from 5.8010 to 5.6660, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-01 14:09:37 INFO     epoch complete!
2024-05-01 14:09:37 INFO     evaluating now!
2024-05-01 14:09:38 INFO     Epoch [17/200] train_loss: 5.3419, val_loss: 5.7542, lr: 0.003000, 6.07s
2024-05-01 14:09:43 INFO     epoch complete!
2024-05-01 14:09:43 INFO     evaluating now!
2024-05-01 14:09:44 INFO     Epoch [18/200] train_loss: 5.2450, val_loss: 5.6192, lr: 0.003000, 6.01s
2024-05-01 14:09:44 INFO     Saved model at 18
2024-05-01 14:09:44 INFO     Val loss decrease from 5.6660 to 5.6192, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-01 14:09:49 INFO     epoch complete!
2024-05-01 14:09:49 INFO     evaluating now!
2024-05-01 14:09:50 INFO     Epoch [19/200] train_loss: 5.1900, val_loss: 5.5598, lr: 0.003000, 6.15s
2024-05-01 14:09:50 INFO     Saved model at 19
2024-05-01 14:09:50 INFO     Val loss decrease from 5.6192 to 5.5598, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-01 14:09:56 INFO     epoch complete!
2024-05-01 14:09:56 INFO     evaluating now!
2024-05-01 14:09:56 INFO     Epoch [20/200] train_loss: 5.1262, val_loss: 5.6676, lr: 0.003000, 6.13s
2024-05-01 14:10:02 INFO     epoch complete!
2024-05-01 14:10:02 INFO     evaluating now!
2024-05-01 14:10:02 INFO     Epoch [21/200] train_loss: 4.9684, val_loss: 5.4122, lr: 0.003000, 6.27s
2024-05-01 14:10:02 INFO     Saved model at 21
2024-05-01 14:10:02 INFO     Val loss decrease from 5.5598 to 5.4122, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-01 14:10:08 INFO     epoch complete!
2024-05-01 14:10:08 INFO     evaluating now!
2024-05-01 14:10:08 INFO     Epoch [22/200] train_loss: 4.8593, val_loss: 5.3836, lr: 0.003000, 6.03s
2024-05-01 14:10:08 INFO     Saved model at 22
2024-05-01 14:10:08 INFO     Val loss decrease from 5.4122 to 5.3836, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-01 14:10:14 INFO     epoch complete!
2024-05-01 14:10:14 INFO     evaluating now!
2024-05-01 14:10:15 INFO     Epoch [23/200] train_loss: 4.9970, val_loss: 5.3593, lr: 0.003000, 6.18s
2024-05-01 14:10:15 INFO     Saved model at 23
2024-05-01 14:10:15 INFO     Val loss decrease from 5.3836 to 5.3593, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-05-01 14:10:20 INFO     epoch complete!
2024-05-01 14:10:20 INFO     evaluating now!
2024-05-01 14:10:21 INFO     Epoch [24/200] train_loss: 4.8435, val_loss: 5.3857, lr: 0.003000, 5.95s
2024-05-01 14:10:26 INFO     epoch complete!
2024-05-01 14:10:26 INFO     evaluating now!
2024-05-01 14:10:27 INFO     Epoch [25/200] train_loss: 4.7603, val_loss: 5.3554, lr: 0.003000, 6.09s
2024-05-01 14:10:27 INFO     Saved model at 25
2024-05-01 14:10:27 INFO     Val loss decrease from 5.3593 to 5.3554, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-01 14:10:33 INFO     epoch complete!
2024-05-01 14:10:33 INFO     evaluating now!
2024-05-01 14:10:33 INFO     Epoch [26/200] train_loss: 4.7971, val_loss: 5.0314, lr: 0.003000, 6.19s
2024-05-01 14:10:33 INFO     Saved model at 26
2024-05-01 14:10:33 INFO     Val loss decrease from 5.3554 to 5.0314, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-05-01 14:10:39 INFO     epoch complete!
2024-05-01 14:10:39 INFO     evaluating now!
2024-05-01 14:10:39 INFO     Epoch [27/200] train_loss: 4.6031, val_loss: 5.3432, lr: 0.003000, 6.03s
2024-05-01 14:10:45 INFO     epoch complete!
2024-05-01 14:10:45 INFO     evaluating now!
2024-05-01 14:10:45 INFO     Epoch [28/200] train_loss: 4.5907, val_loss: 5.3362, lr: 0.003000, 6.11s
2024-05-01 14:10:51 INFO     epoch complete!
2024-05-01 14:10:51 INFO     evaluating now!
2024-05-01 14:10:51 INFO     Epoch [29/200] train_loss: 4.6385, val_loss: 5.2159, lr: 0.003000, 6.12s
2024-05-01 14:10:57 INFO     epoch complete!
2024-05-01 14:10:57 INFO     evaluating now!
2024-05-01 14:10:57 INFO     Epoch [30/200] train_loss: 4.5510, val_loss: 5.2846, lr: 0.003000, 6.07s
2024-05-01 14:11:03 INFO     epoch complete!
2024-05-01 14:11:03 INFO     evaluating now!
2024-05-01 14:11:03 INFO     Epoch [31/200] train_loss: 4.5185, val_loss: 5.2663, lr: 0.003000, 6.11s
2024-05-01 14:11:09 INFO     epoch complete!
2024-05-01 14:11:09 INFO     evaluating now!
2024-05-01 14:11:09 INFO     Epoch [32/200] train_loss: 4.4271, val_loss: 5.1570, lr: 0.003000, 5.96s
2024-05-01 14:11:15 INFO     epoch complete!
2024-05-01 14:11:15 INFO     evaluating now!
2024-05-01 14:11:15 INFO     Epoch [33/200] train_loss: 4.4168, val_loss: 5.1844, lr: 0.003000, 5.95s
2024-05-01 14:11:21 INFO     epoch complete!
2024-05-01 14:11:21 INFO     evaluating now!
2024-05-01 14:11:21 INFO     Epoch [34/200] train_loss: 4.3569, val_loss: 4.9629, lr: 0.003000, 5.99s
2024-05-01 14:11:21 INFO     Saved model at 34
2024-05-01 14:11:21 INFO     Val loss decrease from 5.0314 to 4.9629, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-05-01 14:11:27 INFO     epoch complete!
2024-05-01 14:11:27 INFO     evaluating now!
2024-05-01 14:11:27 INFO     Epoch [35/200] train_loss: 4.3035, val_loss: 5.2808, lr: 0.003000, 6.07s
2024-05-01 14:11:33 INFO     epoch complete!
2024-05-01 14:11:33 INFO     evaluating now!
2024-05-01 14:11:34 INFO     Epoch [36/200] train_loss: 4.3008, val_loss: 5.3420, lr: 0.003000, 6.08s
2024-05-01 14:11:39 INFO     epoch complete!
2024-05-01 14:11:39 INFO     evaluating now!
2024-05-01 14:11:40 INFO     Epoch [37/200] train_loss: 4.2818, val_loss: 4.9978, lr: 0.003000, 6.04s
2024-05-01 14:11:45 INFO     epoch complete!
2024-05-01 14:11:45 INFO     evaluating now!
2024-05-01 14:11:46 INFO     Epoch [38/200] train_loss: 4.2405, val_loss: 5.0016, lr: 0.003000, 5.97s
2024-05-01 14:11:51 INFO     epoch complete!
2024-05-01 14:11:51 INFO     evaluating now!
2024-05-01 14:11:52 INFO     Epoch [39/200] train_loss: 4.1671, val_loss: 5.1286, lr: 0.003000, 6.05s
2024-05-01 14:11:57 INFO     epoch complete!
2024-05-01 14:11:57 INFO     evaluating now!
2024-05-01 14:11:58 INFO     Epoch [40/200] train_loss: 4.2378, val_loss: 5.1255, lr: 0.003000, 6.08s
2024-05-01 14:12:03 INFO     epoch complete!
2024-05-01 14:12:03 INFO     evaluating now!
2024-05-01 14:12:04 INFO     Epoch [41/200] train_loss: 4.1516, val_loss: 5.0475, lr: 0.003000, 6.08s
2024-05-01 14:12:09 INFO     epoch complete!
2024-05-01 14:12:09 INFO     evaluating now!
2024-05-01 14:12:10 INFO     Epoch [42/200] train_loss: 4.1256, val_loss: 5.1329, lr: 0.003000, 5.99s
2024-05-01 14:12:15 INFO     epoch complete!
2024-05-01 14:12:15 INFO     evaluating now!
2024-05-01 14:12:16 INFO     Epoch [43/200] train_loss: 4.0687, val_loss: 5.0932, lr: 0.003000, 6.11s
2024-05-01 14:12:22 INFO     epoch complete!
2024-05-01 14:12:22 INFO     evaluating now!
2024-05-01 14:12:22 INFO     Epoch [44/200] train_loss: 4.0388, val_loss: 5.0958, lr: 0.003000, 6.14s
2024-05-01 14:12:28 INFO     epoch complete!
2024-05-01 14:12:28 INFO     evaluating now!
2024-05-01 14:12:28 INFO     Epoch [45/200] train_loss: 3.9942, val_loss: 5.0080, lr: 0.003000, 6.09s
2024-05-01 14:12:34 INFO     epoch complete!
2024-05-01 14:12:34 INFO     evaluating now!
2024-05-01 14:12:34 INFO     Epoch [46/200] train_loss: 3.9750, val_loss: 5.2555, lr: 0.003000, 6.18s
2024-05-01 14:12:40 INFO     epoch complete!
2024-05-01 14:12:40 INFO     evaluating now!
2024-05-01 14:12:41 INFO     Epoch [47/200] train_loss: 3.9328, val_loss: 4.9743, lr: 0.003000, 6.20s
2024-05-01 14:12:46 INFO     epoch complete!
2024-05-01 14:12:46 INFO     evaluating now!
2024-05-01 14:12:47 INFO     Epoch [48/200] train_loss: 3.9272, val_loss: 5.1561, lr: 0.003000, 6.01s
2024-05-01 14:12:52 INFO     epoch complete!
2024-05-01 14:12:52 INFO     evaluating now!
2024-05-01 14:12:53 INFO     Epoch [49/200] train_loss: 3.9068, val_loss: 4.9588, lr: 0.003000, 5.98s
2024-05-01 14:12:53 INFO     Saved model at 49
2024-05-01 14:12:53 INFO     Val loss decrease from 4.9629 to 4.9588, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-05-01 14:12:58 INFO     epoch complete!
2024-05-01 14:12:58 INFO     evaluating now!
2024-05-01 14:12:59 INFO     Epoch [50/200] train_loss: 4.0418, val_loss: 5.1321, lr: 0.003000, 6.15s
2024-05-01 14:13:04 INFO     epoch complete!
2024-05-01 14:13:04 INFO     evaluating now!
2024-05-01 14:13:05 INFO     Epoch [51/200] train_loss: 3.9244, val_loss: 4.8864, lr: 0.003000, 6.05s
2024-05-01 14:13:05 INFO     Saved model at 51
2024-05-01 14:13:05 INFO     Val loss decrease from 4.9588 to 4.8864, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-05-01 14:13:10 INFO     epoch complete!
2024-05-01 14:13:10 INFO     evaluating now!
2024-05-01 14:13:11 INFO     Epoch [52/200] train_loss: 3.8388, val_loss: 4.8333, lr: 0.003000, 6.05s
2024-05-01 14:13:11 INFO     Saved model at 52
2024-05-01 14:13:11 INFO     Val loss decrease from 4.8864 to 4.8333, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch52.tar
2024-05-01 14:13:17 INFO     epoch complete!
2024-05-01 14:13:17 INFO     evaluating now!
2024-05-01 14:13:17 INFO     Epoch [53/200] train_loss: 3.8116, val_loss: 4.8068, lr: 0.003000, 6.11s
2024-05-01 14:13:17 INFO     Saved model at 53
2024-05-01 14:13:17 INFO     Val loss decrease from 4.8333 to 4.8068, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch53.tar
2024-05-01 14:13:23 INFO     epoch complete!
2024-05-01 14:13:23 INFO     evaluating now!
2024-05-01 14:13:23 INFO     Epoch [54/200] train_loss: 3.7791, val_loss: 4.9155, lr: 0.003000, 6.03s
2024-05-01 14:13:29 INFO     epoch complete!
2024-05-01 14:13:29 INFO     evaluating now!
2024-05-01 14:13:29 INFO     Epoch [55/200] train_loss: 3.8436, val_loss: 4.9519, lr: 0.003000, 6.12s
2024-05-01 14:13:35 INFO     epoch complete!
2024-05-01 14:13:35 INFO     evaluating now!
2024-05-01 14:13:35 INFO     Epoch [56/200] train_loss: 3.8271, val_loss: 4.9895, lr: 0.003000, 5.98s
2024-05-01 14:13:41 INFO     epoch complete!
2024-05-01 14:13:41 INFO     evaluating now!
2024-05-01 14:13:41 INFO     Epoch [57/200] train_loss: 3.7707, val_loss: 4.8981, lr: 0.003000, 6.06s
2024-05-01 14:13:47 INFO     epoch complete!
2024-05-01 14:13:47 INFO     evaluating now!
2024-05-01 14:13:47 INFO     Epoch [58/200] train_loss: 3.7844, val_loss: 5.0417, lr: 0.003000, 6.00s
2024-05-01 14:13:53 INFO     epoch complete!
2024-05-01 14:13:53 INFO     evaluating now!
2024-05-01 14:13:53 INFO     Epoch [59/200] train_loss: 3.7736, val_loss: 4.8326, lr: 0.003000, 6.19s
2024-05-01 14:13:59 INFO     epoch complete!
2024-05-01 14:13:59 INFO     evaluating now!
2024-05-01 14:14:00 INFO     Epoch [60/200] train_loss: 3.7155, val_loss: 4.9117, lr: 0.003000, 6.08s
2024-05-01 14:14:05 INFO     epoch complete!
2024-05-01 14:14:05 INFO     evaluating now!
2024-05-01 14:14:06 INFO     Epoch [61/200] train_loss: 3.6969, val_loss: 4.8804, lr: 0.003000, 6.08s
2024-05-01 14:14:11 INFO     epoch complete!
2024-05-01 14:14:11 INFO     evaluating now!
2024-05-01 14:14:11 INFO     Epoch [62/200] train_loss: 3.7322, val_loss: 4.9060, lr: 0.003000, 5.90s
2024-05-01 14:14:17 INFO     epoch complete!
2024-05-01 14:14:17 INFO     evaluating now!
2024-05-01 14:14:18 INFO     Epoch [63/200] train_loss: 3.6784, val_loss: 4.8068, lr: 0.003000, 6.07s
2024-05-01 14:14:18 INFO     Saved model at 63
2024-05-01 14:14:18 INFO     Val loss decrease from 4.8068 to 4.8068, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch63.tar
2024-05-01 14:14:23 INFO     epoch complete!
2024-05-01 14:14:23 INFO     evaluating now!
2024-05-01 14:14:24 INFO     Epoch [64/200] train_loss: 3.6425, val_loss: 5.0041, lr: 0.003000, 6.04s
2024-05-01 14:14:29 INFO     epoch complete!
2024-05-01 14:14:29 INFO     evaluating now!
2024-05-01 14:14:30 INFO     Epoch [65/200] train_loss: 3.6107, val_loss: 4.8733, lr: 0.003000, 6.02s
2024-05-01 14:14:35 INFO     epoch complete!
2024-05-01 14:14:35 INFO     evaluating now!
2024-05-01 14:14:36 INFO     Epoch [66/200] train_loss: 3.5971, val_loss: 4.9967, lr: 0.003000, 5.98s
2024-05-01 14:14:41 INFO     epoch complete!
2024-05-01 14:14:41 INFO     evaluating now!
2024-05-01 14:14:42 INFO     Epoch [67/200] train_loss: 3.5769, val_loss: 4.7816, lr: 0.003000, 5.99s
2024-05-01 14:14:42 INFO     Saved model at 67
2024-05-01 14:14:42 INFO     Val loss decrease from 4.8068 to 4.7816, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch67.tar
2024-05-01 14:14:47 INFO     epoch complete!
2024-05-01 14:14:47 INFO     evaluating now!
2024-05-01 14:14:48 INFO     Epoch [68/200] train_loss: 3.5661, val_loss: 4.8526, lr: 0.003000, 6.07s
2024-05-01 14:14:53 INFO     epoch complete!
2024-05-01 14:14:53 INFO     evaluating now!
2024-05-01 14:14:54 INFO     Epoch [69/200] train_loss: 3.6115, val_loss: 4.8241, lr: 0.003000, 6.09s
2024-05-01 14:15:00 INFO     epoch complete!
2024-05-01 14:15:00 INFO     evaluating now!
2024-05-01 14:15:00 INFO     Epoch [70/200] train_loss: 3.5561, val_loss: 4.9536, lr: 0.003000, 6.30s
2024-05-01 14:15:06 INFO     epoch complete!
2024-05-01 14:15:06 INFO     evaluating now!
2024-05-01 14:15:06 INFO     Epoch [71/200] train_loss: 3.5438, val_loss: 4.8677, lr: 0.003000, 5.94s
2024-05-01 14:15:12 INFO     epoch complete!
2024-05-01 14:15:12 INFO     evaluating now!
2024-05-01 14:15:12 INFO     Epoch [72/200] train_loss: 3.5616, val_loss: 4.8920, lr: 0.003000, 6.00s
2024-05-01 14:15:18 INFO     epoch complete!
2024-05-01 14:15:18 INFO     evaluating now!
2024-05-01 14:15:18 INFO     Epoch [73/200] train_loss: 3.5526, val_loss: 4.9556, lr: 0.003000, 5.99s
2024-05-01 14:15:24 INFO     epoch complete!
2024-05-01 14:15:24 INFO     evaluating now!
2024-05-01 14:15:24 INFO     Epoch [74/200] train_loss: 3.5360, val_loss: 4.8984, lr: 0.003000, 6.01s
2024-05-01 14:15:30 INFO     epoch complete!
2024-05-01 14:15:30 INFO     evaluating now!
2024-05-01 14:15:30 INFO     Epoch [75/200] train_loss: 3.4894, val_loss: 4.9045, lr: 0.003000, 6.06s
2024-05-01 14:15:36 INFO     epoch complete!
2024-05-01 14:15:36 INFO     evaluating now!
2024-05-01 14:15:36 INFO     Epoch [76/200] train_loss: 3.4853, val_loss: 5.0168, lr: 0.003000, 6.12s
2024-05-01 14:15:42 INFO     epoch complete!
2024-05-01 14:15:42 INFO     evaluating now!
2024-05-01 14:15:42 INFO     Epoch [77/200] train_loss: 3.4813, val_loss: 4.9272, lr: 0.003000, 6.00s
2024-05-01 14:15:48 INFO     epoch complete!
2024-05-01 14:15:48 INFO     evaluating now!
2024-05-01 14:15:48 INFO     Epoch [78/200] train_loss: 3.5207, val_loss: 4.9300, lr: 0.003000, 6.04s
2024-05-01 14:15:54 INFO     epoch complete!
2024-05-01 14:15:54 INFO     evaluating now!
2024-05-01 14:15:54 INFO     Epoch [79/200] train_loss: 3.5144, val_loss: 4.8739, lr: 0.003000, 6.04s
2024-05-01 14:16:00 INFO     epoch complete!
2024-05-01 14:16:00 INFO     evaluating now!
2024-05-01 14:16:01 INFO     Epoch [80/200] train_loss: 3.4561, val_loss: 4.8172, lr: 0.003000, 6.31s
2024-05-01 14:16:06 INFO     epoch complete!
2024-05-01 14:16:06 INFO     evaluating now!
2024-05-01 14:16:07 INFO     Epoch [81/200] train_loss: 3.4651, val_loss: 5.0787, lr: 0.003000, 6.06s
2024-05-01 14:16:12 INFO     epoch complete!
2024-05-01 14:16:12 INFO     evaluating now!
2024-05-01 14:16:13 INFO     Epoch [82/200] train_loss: 3.4536, val_loss: 5.0465, lr: 0.003000, 5.95s
2024-05-01 14:16:13 WARNING  Early stopping at epoch: 82
2024-05-01 14:16:13 INFO     Trained totally 83 epochs, average train time is 5.677s, average eval time is 0.430s
2024-05-01 14:16:13 INFO     Loaded model at 67
2024-05-01 14:16:13 INFO     Saved model at ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 14:16:13 INFO     Start evaluating ...
2024-05-01 14:16:14 INFO     Note that you select the single mode to evaluate!
2024-05-01 14:16:14 INFO     Evaluate result is saved at ./libcity/cache/19/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 14:16:14 INFO     
         MAE       RMSE
1   2.403120   7.432402
2   2.509602   7.758486
3   2.689992   8.517585
4   2.820254   9.303374
5   2.971731  10.193669
6   3.097997  11.140116
7   3.204120  11.933340
8   3.303641  12.415228
9   3.327910  12.647851
10  3.430712  12.761626
11  3.454272  12.976606
12  3.481984  13.287331
2024-05-01 14:16:14 INFO     ----------------------------------------------------------------------------
2024-05-01 14:16:14 INFO     Kownledge Graph Embedding: GIE, Experiment ids: [15, 16, 17, 18, 19]
2024-05-01 14:16:14 INFO     ----------------------------------------------------------------------------
2024-05-01 14:16:14 INFO     Average: 
         MAE       RMSE
0   2.304237   7.061114
1   2.427814   7.671055
2   2.604364   8.641429
3   2.785096   9.436653
4   2.916492  10.215536
5   3.051734  11.083303
6   3.154593  11.829248
7   3.201211  12.389199
8   3.258153  12.754921
9   3.316679  12.996414
10  3.375786  13.289361
11  3.431858  13.692263 
2024-05-01 14:16:14 INFO     Standard deviation: 
         MAE      RMSE
0   0.082833  0.272517
1   0.100329  0.183880
2   0.125306  0.210274
3   0.110203  0.237573
4   0.124267  0.307254
5   0.099505  0.453169
6   0.103364  0.510217
7   0.082460  0.520973
8   0.079683  0.429297
9   0.079930  0.357607
10  0.060844  0.339035
11  0.087413  0.390161
2024-05-01 14:16:14 INFO     ----------------------------------------------------------------------------
2024-05-01 14:16:14 INFO     12 steps Average: 
        MAE       RMSE
0  2.985668  10.921708
2024-05-01 14:16:15 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.094678  0.350996
