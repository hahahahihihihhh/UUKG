2024-09-01 21:45:59 INFO     Saving logs in: ./logs/CHITaxi20190406\AGCRN\ExtSpace\RotE
2024-09-01 21:45:59 INFO     ----------------------------------------------------------------------------
2024-09-01 21:45:59 INFO     # 0, Kownledge Graph Embedding: RotE, Experiment ids: 25
2024-09-01 21:45:59 INFO     ----------------------------------------------------------------------------
2024-09-01 21:45:59 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=25
2024-09-01 21:45:59 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 25, 'embedding_model': 'RotE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-01 21:45:59 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-01 21:45:59 INFO     set_weight_link_or_dist: dist
2024-09-01 21:45:59 INFO     init_weight_inf_or_zero: inf
2024-09-01 21:45:59 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-01 21:45:59 INFO     Start Calculate the weight by Gauss kernel!
2024-09-01 21:45:59 INFO     Loading file CHITaxi20190406.dyna
2024-09-01 21:45:59 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-01 21:46:01 INFO     Dataset created
2024-09-01 21:46:01 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-01 21:46:01 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-01 21:46:01 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-01 21:46:01 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-01 21:46:01 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-01 21:46:01 INFO     NormalScaler max: 1.4623669798075165
2024-09-01 21:46:05 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-01 21:46:05 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-01 21:46:05 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-01 21:46:05 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 21:46:05 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-01 21:46:05 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 21:46:05 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-01 21:46:05 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 21:46:05 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-01 21:46:05 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 21:46:05 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-01 21:46:05 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-01 21:46:05 INFO     Total parameter numbers: 874010
2024-09-01 21:46:05 INFO     You select `adam` optimizer.
2024-09-01 21:46:05 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-01 21:46:05 INFO     Start training ...
2024-09-01 21:46:05 INFO     num_batches:48
2024-09-01 21:46:12 INFO     epoch complete!
2024-09-01 21:46:12 INFO     evaluating now!
2024-09-01 21:46:12 INFO     Epoch [0/200] train_loss: 25.2759, val_loss: 18.8386, lr: 0.003000, 7.32s
2024-09-01 21:46:12 INFO     Saved model at 0
2024-09-01 21:46:12 INFO     Val loss decrease from inf to 18.8386, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-01 21:46:17 INFO     epoch complete!
2024-09-01 21:46:17 INFO     evaluating now!
2024-09-01 21:46:17 INFO     Epoch [1/200] train_loss: 15.6788, val_loss: 15.2710, lr: 0.003000, 5.26s
2024-09-01 21:46:17 INFO     Saved model at 1
2024-09-01 21:46:17 INFO     Val loss decrease from 18.8386 to 15.2710, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-01 21:46:22 INFO     epoch complete!
2024-09-01 21:46:22 INFO     evaluating now!
2024-09-01 21:46:23 INFO     Epoch [2/200] train_loss: 12.5821, val_loss: 12.4602, lr: 0.003000, 5.33s
2024-09-01 21:46:23 INFO     Saved model at 2
2024-09-01 21:46:23 INFO     Val loss decrease from 15.2710 to 12.4602, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-01 21:46:28 INFO     epoch complete!
2024-09-01 21:46:28 INFO     evaluating now!
2024-09-01 21:46:28 INFO     Epoch [3/200] train_loss: 10.6611, val_loss: 10.6049, lr: 0.003000, 5.30s
2024-09-01 21:46:28 INFO     Saved model at 3
2024-09-01 21:46:28 INFO     Val loss decrease from 12.4602 to 10.6049, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-01 21:46:33 INFO     epoch complete!
2024-09-01 21:46:33 INFO     evaluating now!
2024-09-01 21:46:33 INFO     Epoch [4/200] train_loss: 9.2704, val_loss: 9.6302, lr: 0.003000, 5.18s
2024-09-01 21:46:33 INFO     Saved model at 4
2024-09-01 21:46:33 INFO     Val loss decrease from 10.6049 to 9.6302, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-01 21:46:38 INFO     epoch complete!
2024-09-01 21:46:38 INFO     evaluating now!
2024-09-01 21:46:38 INFO     Epoch [5/200] train_loss: 8.4771, val_loss: 8.3377, lr: 0.003000, 5.21s
2024-09-01 21:46:39 INFO     Saved model at 5
2024-09-01 21:46:39 INFO     Val loss decrease from 9.6302 to 8.3377, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-01 21:46:43 INFO     epoch complete!
2024-09-01 21:46:43 INFO     evaluating now!
2024-09-01 21:46:44 INFO     Epoch [6/200] train_loss: 8.0579, val_loss: 7.8863, lr: 0.003000, 5.12s
2024-09-01 21:46:44 INFO     Saved model at 6
2024-09-01 21:46:44 INFO     Val loss decrease from 8.3377 to 7.8863, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-01 21:46:48 INFO     epoch complete!
2024-09-01 21:46:48 INFO     evaluating now!
2024-09-01 21:46:49 INFO     Epoch [7/200] train_loss: 7.3729, val_loss: 7.6938, lr: 0.003000, 5.11s
2024-09-01 21:46:49 INFO     Saved model at 7
2024-09-01 21:46:49 INFO     Val loss decrease from 7.8863 to 7.6938, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-01 21:46:54 INFO     epoch complete!
2024-09-01 21:46:54 INFO     evaluating now!
2024-09-01 21:46:54 INFO     Epoch [8/200] train_loss: 6.9702, val_loss: 6.7984, lr: 0.003000, 5.22s
2024-09-01 21:46:54 INFO     Saved model at 8
2024-09-01 21:46:54 INFO     Val loss decrease from 7.6938 to 6.7984, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-01 21:46:59 INFO     epoch complete!
2024-09-01 21:46:59 INFO     evaluating now!
2024-09-01 21:46:59 INFO     Epoch [9/200] train_loss: 6.7406, val_loss: 6.4962, lr: 0.003000, 5.17s
2024-09-01 21:46:59 INFO     Saved model at 9
2024-09-01 21:46:59 INFO     Val loss decrease from 6.7984 to 6.4962, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-01 21:47:04 INFO     epoch complete!
2024-09-01 21:47:04 INFO     evaluating now!
2024-09-01 21:47:05 INFO     Epoch [10/200] train_loss: 6.3740, val_loss: 6.8331, lr: 0.003000, 5.38s
2024-09-01 21:47:09 INFO     epoch complete!
2024-09-01 21:47:09 INFO     evaluating now!
2024-09-01 21:47:10 INFO     Epoch [11/200] train_loss: 6.3644, val_loss: 6.6728, lr: 0.003000, 5.11s
2024-09-01 21:47:15 INFO     epoch complete!
2024-09-01 21:47:15 INFO     evaluating now!
2024-09-01 21:47:15 INFO     Epoch [12/200] train_loss: 6.1538, val_loss: 6.3256, lr: 0.003000, 5.19s
2024-09-01 21:47:15 INFO     Saved model at 12
2024-09-01 21:47:15 INFO     Val loss decrease from 6.4962 to 6.3256, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-01 21:47:20 INFO     epoch complete!
2024-09-01 21:47:20 INFO     evaluating now!
2024-09-01 21:47:20 INFO     Epoch [13/200] train_loss: 6.0474, val_loss: 6.0774, lr: 0.003000, 5.23s
2024-09-01 21:47:20 INFO     Saved model at 13
2024-09-01 21:47:20 INFO     Val loss decrease from 6.3256 to 6.0774, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-01 21:47:25 INFO     epoch complete!
2024-09-01 21:47:25 INFO     evaluating now!
2024-09-01 21:47:25 INFO     Epoch [14/200] train_loss: 5.7807, val_loss: 5.9506, lr: 0.003000, 5.15s
2024-09-01 21:47:25 INFO     Saved model at 14
2024-09-01 21:47:25 INFO     Val loss decrease from 6.0774 to 5.9506, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-01 21:47:30 INFO     epoch complete!
2024-09-01 21:47:30 INFO     evaluating now!
2024-09-01 21:47:30 INFO     Epoch [15/200] train_loss: 5.6673, val_loss: 6.0910, lr: 0.003000, 5.16s
2024-09-01 21:47:35 INFO     epoch complete!
2024-09-01 21:47:35 INFO     evaluating now!
2024-09-01 21:47:36 INFO     Epoch [16/200] train_loss: 5.6542, val_loss: 5.7600, lr: 0.003000, 5.21s
2024-09-01 21:47:36 INFO     Saved model at 16
2024-09-01 21:47:36 INFO     Val loss decrease from 5.9506 to 5.7600, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-01 21:47:40 INFO     epoch complete!
2024-09-01 21:47:40 INFO     evaluating now!
2024-09-01 21:47:41 INFO     Epoch [17/200] train_loss: 5.4456, val_loss: 5.7524, lr: 0.003000, 5.11s
2024-09-01 21:47:41 INFO     Saved model at 17
2024-09-01 21:47:41 INFO     Val loss decrease from 5.7600 to 5.7524, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-01 21:47:46 INFO     epoch complete!
2024-09-01 21:47:46 INFO     evaluating now!
2024-09-01 21:47:46 INFO     Epoch [18/200] train_loss: 5.3372, val_loss: 5.7832, lr: 0.003000, 5.07s
2024-09-01 21:47:51 INFO     epoch complete!
2024-09-01 21:47:51 INFO     evaluating now!
2024-09-01 21:47:51 INFO     Epoch [19/200] train_loss: 5.3664, val_loss: 5.5671, lr: 0.003000, 5.20s
2024-09-01 21:47:51 INFO     Saved model at 19
2024-09-01 21:47:51 INFO     Val loss decrease from 5.7524 to 5.5671, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-01 21:47:56 INFO     epoch complete!
2024-09-01 21:47:56 INFO     evaluating now!
2024-09-01 21:47:56 INFO     Epoch [20/200] train_loss: 5.3388, val_loss: 5.7789, lr: 0.003000, 5.10s
2024-09-01 21:48:01 INFO     epoch complete!
2024-09-01 21:48:01 INFO     evaluating now!
2024-09-01 21:48:01 INFO     Epoch [21/200] train_loss: 5.1697, val_loss: 5.5265, lr: 0.003000, 5.10s
2024-09-01 21:48:01 INFO     Saved model at 21
2024-09-01 21:48:01 INFO     Val loss decrease from 5.5671 to 5.5265, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-01 21:48:06 INFO     epoch complete!
2024-09-01 21:48:06 INFO     evaluating now!
2024-09-01 21:48:06 INFO     Epoch [22/200] train_loss: 5.0905, val_loss: 5.5002, lr: 0.003000, 5.18s
2024-09-01 21:48:07 INFO     Saved model at 22
2024-09-01 21:48:07 INFO     Val loss decrease from 5.5265 to 5.5002, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-01 21:48:11 INFO     epoch complete!
2024-09-01 21:48:11 INFO     evaluating now!
2024-09-01 21:48:12 INFO     Epoch [23/200] train_loss: 5.0514, val_loss: 5.6572, lr: 0.003000, 5.13s
2024-09-01 21:48:16 INFO     epoch complete!
2024-09-01 21:48:16 INFO     evaluating now!
2024-09-01 21:48:17 INFO     Epoch [24/200] train_loss: 4.9002, val_loss: 5.5239, lr: 0.003000, 5.16s
2024-09-01 21:48:22 INFO     epoch complete!
2024-09-01 21:48:22 INFO     evaluating now!
2024-09-01 21:48:22 INFO     Epoch [25/200] train_loss: 4.8786, val_loss: 5.4374, lr: 0.003000, 5.25s
2024-09-01 21:48:22 INFO     Saved model at 25
2024-09-01 21:48:22 INFO     Val loss decrease from 5.5002 to 5.4374, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-01 21:48:27 INFO     epoch complete!
2024-09-01 21:48:27 INFO     evaluating now!
2024-09-01 21:48:27 INFO     Epoch [26/200] train_loss: 4.8028, val_loss: 5.5970, lr: 0.003000, 5.15s
2024-09-01 21:48:32 INFO     epoch complete!
2024-09-01 21:48:32 INFO     evaluating now!
2024-09-01 21:48:33 INFO     Epoch [27/200] train_loss: 4.8563, val_loss: 5.6738, lr: 0.003000, 5.39s
2024-09-01 21:48:38 INFO     epoch complete!
2024-09-01 21:48:38 INFO     evaluating now!
2024-09-01 21:48:38 INFO     Epoch [28/200] train_loss: 4.7541, val_loss: 5.3880, lr: 0.003000, 5.29s
2024-09-01 21:48:38 INFO     Saved model at 28
2024-09-01 21:48:38 INFO     Val loss decrease from 5.4374 to 5.3880, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-01 21:48:43 INFO     epoch complete!
2024-09-01 21:48:43 INFO     evaluating now!
2024-09-01 21:48:43 INFO     Epoch [29/200] train_loss: 4.7978, val_loss: 5.2923, lr: 0.003000, 5.13s
2024-09-01 21:48:43 INFO     Saved model at 29
2024-09-01 21:48:43 INFO     Val loss decrease from 5.3880 to 5.2923, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-01 21:48:48 INFO     epoch complete!
2024-09-01 21:48:48 INFO     evaluating now!
2024-09-01 21:48:48 INFO     Epoch [30/200] train_loss: 4.7155, val_loss: 5.4421, lr: 0.003000, 5.13s
2024-09-01 21:48:53 INFO     epoch complete!
2024-09-01 21:48:53 INFO     evaluating now!
2024-09-01 21:48:53 INFO     Epoch [31/200] train_loss: 4.6749, val_loss: 5.3008, lr: 0.003000, 5.23s
2024-09-01 21:48:58 INFO     epoch complete!
2024-09-01 21:48:58 INFO     evaluating now!
2024-09-01 21:48:59 INFO     Epoch [32/200] train_loss: 4.5795, val_loss: 5.3608, lr: 0.003000, 5.21s
2024-09-01 21:49:04 INFO     epoch complete!
2024-09-01 21:49:04 INFO     evaluating now!
2024-09-01 21:49:04 INFO     Epoch [33/200] train_loss: 4.5456, val_loss: 5.3097, lr: 0.003000, 5.20s
2024-09-01 21:49:09 INFO     epoch complete!
2024-09-01 21:49:09 INFO     evaluating now!
2024-09-01 21:49:09 INFO     Epoch [34/200] train_loss: 4.5044, val_loss: 5.4328, lr: 0.003000, 5.24s
2024-09-01 21:49:14 INFO     epoch complete!
2024-09-01 21:49:14 INFO     evaluating now!
2024-09-01 21:49:14 INFO     Epoch [35/200] train_loss: 4.4983, val_loss: 5.1827, lr: 0.003000, 5.08s
2024-09-01 21:49:14 INFO     Saved model at 35
2024-09-01 21:49:14 INFO     Val loss decrease from 5.2923 to 5.1827, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-01 21:49:19 INFO     epoch complete!
2024-09-01 21:49:19 INFO     evaluating now!
2024-09-01 21:49:19 INFO     Epoch [36/200] train_loss: 4.3674, val_loss: 5.2848, lr: 0.003000, 5.08s
2024-09-01 21:49:24 INFO     epoch complete!
2024-09-01 21:49:24 INFO     evaluating now!
2024-09-01 21:49:24 INFO     Epoch [37/200] train_loss: 4.3349, val_loss: 5.3162, lr: 0.003000, 5.18s
2024-09-01 21:49:29 INFO     epoch complete!
2024-09-01 21:49:29 INFO     evaluating now!
2024-09-01 21:49:30 INFO     Epoch [38/200] train_loss: 4.3238, val_loss: 5.1352, lr: 0.003000, 5.19s
2024-09-01 21:49:30 INFO     Saved model at 38
2024-09-01 21:49:30 INFO     Val loss decrease from 5.1827 to 5.1352, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-09-01 21:49:34 INFO     epoch complete!
2024-09-01 21:49:34 INFO     evaluating now!
2024-09-01 21:49:35 INFO     Epoch [39/200] train_loss: 4.2414, val_loss: 5.3417, lr: 0.003000, 5.10s
2024-09-01 21:49:40 INFO     epoch complete!
2024-09-01 21:49:40 INFO     evaluating now!
2024-09-01 21:49:40 INFO     Epoch [40/200] train_loss: 4.3260, val_loss: 5.2618, lr: 0.003000, 5.28s
2024-09-01 21:49:45 INFO     epoch complete!
2024-09-01 21:49:45 INFO     evaluating now!
2024-09-01 21:49:45 INFO     Epoch [41/200] train_loss: 4.1898, val_loss: 5.1661, lr: 0.003000, 5.12s
2024-09-01 21:49:50 INFO     epoch complete!
2024-09-01 21:49:50 INFO     evaluating now!
2024-09-01 21:49:50 INFO     Epoch [42/200] train_loss: 4.2186, val_loss: 5.1874, lr: 0.003000, 5.10s
2024-09-01 21:49:55 INFO     epoch complete!
2024-09-01 21:49:55 INFO     evaluating now!
2024-09-01 21:49:55 INFO     Epoch [43/200] train_loss: 4.1626, val_loss: 5.2895, lr: 0.003000, 5.13s
2024-09-01 21:50:00 INFO     epoch complete!
2024-09-01 21:50:00 INFO     evaluating now!
2024-09-01 21:50:01 INFO     Epoch [44/200] train_loss: 4.1503, val_loss: 5.1968, lr: 0.003000, 5.15s
2024-09-01 21:50:05 INFO     epoch complete!
2024-09-01 21:50:05 INFO     evaluating now!
2024-09-01 21:50:06 INFO     Epoch [45/200] train_loss: 4.0685, val_loss: 5.3327, lr: 0.003000, 5.12s
2024-09-01 21:50:10 INFO     epoch complete!
2024-09-01 21:50:10 INFO     evaluating now!
2024-09-01 21:50:11 INFO     Epoch [46/200] train_loss: 4.1184, val_loss: 5.2163, lr: 0.003000, 5.15s
2024-09-01 21:50:16 INFO     epoch complete!
2024-09-01 21:50:16 INFO     evaluating now!
2024-09-01 21:50:16 INFO     Epoch [47/200] train_loss: 4.0475, val_loss: 5.1231, lr: 0.003000, 5.10s
2024-09-01 21:50:16 INFO     Saved model at 47
2024-09-01 21:50:16 INFO     Val loss decrease from 5.1352 to 5.1231, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch47.tar
2024-09-01 21:50:21 INFO     epoch complete!
2024-09-01 21:50:21 INFO     evaluating now!
2024-09-01 21:50:21 INFO     Epoch [48/200] train_loss: 4.0292, val_loss: 5.2632, lr: 0.003000, 5.10s
2024-09-01 21:50:26 INFO     epoch complete!
2024-09-01 21:50:26 INFO     evaluating now!
2024-09-01 21:50:26 INFO     Epoch [49/200] train_loss: 4.0579, val_loss: 5.0676, lr: 0.003000, 5.40s
2024-09-01 21:50:26 INFO     Saved model at 49
2024-09-01 21:50:26 INFO     Val loss decrease from 5.1231 to 5.0676, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-09-01 21:50:31 INFO     epoch complete!
2024-09-01 21:50:31 INFO     evaluating now!
2024-09-01 21:50:32 INFO     Epoch [50/200] train_loss: 3.9776, val_loss: 5.1136, lr: 0.003000, 5.19s
2024-09-01 21:50:36 INFO     epoch complete!
2024-09-01 21:50:36 INFO     evaluating now!
2024-09-01 21:50:37 INFO     Epoch [51/200] train_loss: 3.9981, val_loss: 5.1526, lr: 0.003000, 5.21s
2024-09-01 21:50:42 INFO     epoch complete!
2024-09-01 21:50:42 INFO     evaluating now!
2024-09-01 21:50:42 INFO     Epoch [52/200] train_loss: 4.0091, val_loss: 5.4383, lr: 0.003000, 5.11s
2024-09-01 21:50:47 INFO     epoch complete!
2024-09-01 21:50:47 INFO     evaluating now!
2024-09-01 21:50:47 INFO     Epoch [53/200] train_loss: 3.9524, val_loss: 5.1775, lr: 0.003000, 5.09s
2024-09-01 21:50:52 INFO     epoch complete!
2024-09-01 21:50:52 INFO     evaluating now!
2024-09-01 21:50:52 INFO     Epoch [54/200] train_loss: 3.9160, val_loss: 5.1413, lr: 0.003000, 5.10s
2024-09-01 21:50:57 INFO     epoch complete!
2024-09-01 21:50:57 INFO     evaluating now!
2024-09-01 21:50:57 INFO     Epoch [55/200] train_loss: 3.8856, val_loss: 5.0796, lr: 0.003000, 5.06s
2024-09-01 21:51:02 INFO     epoch complete!
2024-09-01 21:51:02 INFO     evaluating now!
2024-09-01 21:51:02 INFO     Epoch [56/200] train_loss: 3.8614, val_loss: 5.3346, lr: 0.003000, 5.21s
2024-09-01 21:51:07 INFO     epoch complete!
2024-09-01 21:51:07 INFO     evaluating now!
2024-09-01 21:51:08 INFO     Epoch [57/200] train_loss: 3.8557, val_loss: 5.1604, lr: 0.003000, 5.15s
2024-09-01 21:51:12 INFO     epoch complete!
2024-09-01 21:51:12 INFO     evaluating now!
2024-09-01 21:51:13 INFO     Epoch [58/200] train_loss: 3.7778, val_loss: 5.0946, lr: 0.003000, 5.10s
2024-09-01 21:51:18 INFO     epoch complete!
2024-09-01 21:51:18 INFO     evaluating now!
2024-09-01 21:51:18 INFO     Epoch [59/200] train_loss: 3.7728, val_loss: 5.1902, lr: 0.003000, 5.23s
2024-09-01 21:51:23 INFO     epoch complete!
2024-09-01 21:51:23 INFO     evaluating now!
2024-09-01 21:51:23 INFO     Epoch [60/200] train_loss: 3.7214, val_loss: 5.1028, lr: 0.003000, 5.16s
2024-09-01 21:51:28 INFO     epoch complete!
2024-09-01 21:51:28 INFO     evaluating now!
2024-09-01 21:51:28 INFO     Epoch [61/200] train_loss: 3.7301, val_loss: 5.2613, lr: 0.003000, 5.18s
2024-09-01 21:51:33 INFO     epoch complete!
2024-09-01 21:51:33 INFO     evaluating now!
2024-09-01 21:51:33 INFO     Epoch [62/200] train_loss: 3.7350, val_loss: 5.1255, lr: 0.003000, 5.13s
2024-09-01 21:51:38 INFO     epoch complete!
2024-09-01 21:51:38 INFO     evaluating now!
2024-09-01 21:51:38 INFO     Epoch [63/200] train_loss: 3.6824, val_loss: 5.0507, lr: 0.003000, 5.12s
2024-09-01 21:51:38 INFO     Saved model at 63
2024-09-01 21:51:38 INFO     Val loss decrease from 5.0676 to 5.0507, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch63.tar
2024-09-01 21:51:43 INFO     epoch complete!
2024-09-01 21:51:43 INFO     evaluating now!
2024-09-01 21:51:44 INFO     Epoch [64/200] train_loss: 3.6937, val_loss: 4.9947, lr: 0.003000, 5.22s
2024-09-01 21:51:44 INFO     Saved model at 64
2024-09-01 21:51:44 INFO     Val loss decrease from 5.0507 to 4.9947, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch64.tar
2024-09-01 21:51:49 INFO     epoch complete!
2024-09-01 21:51:49 INFO     evaluating now!
2024-09-01 21:51:49 INFO     Epoch [65/200] train_loss: 3.6980, val_loss: 5.0730, lr: 0.003000, 5.20s
2024-09-01 21:51:54 INFO     epoch complete!
2024-09-01 21:51:54 INFO     evaluating now!
2024-09-01 21:51:54 INFO     Epoch [66/200] train_loss: 3.6145, val_loss: 5.1109, lr: 0.003000, 5.18s
2024-09-01 21:51:59 INFO     epoch complete!
2024-09-01 21:51:59 INFO     evaluating now!
2024-09-01 21:51:59 INFO     Epoch [67/200] train_loss: 3.6339, val_loss: 5.1320, lr: 0.003000, 5.19s
2024-09-01 21:52:04 INFO     epoch complete!
2024-09-01 21:52:04 INFO     evaluating now!
2024-09-01 21:52:04 INFO     Epoch [68/200] train_loss: 3.6668, val_loss: 5.1372, lr: 0.003000, 5.10s
2024-09-01 21:52:09 INFO     epoch complete!
2024-09-01 21:52:09 INFO     evaluating now!
2024-09-01 21:52:09 INFO     Epoch [69/200] train_loss: 3.5855, val_loss: 5.0792, lr: 0.003000, 5.10s
2024-09-01 21:52:14 INFO     epoch complete!
2024-09-01 21:52:14 INFO     evaluating now!
2024-09-01 21:52:15 INFO     Epoch [70/200] train_loss: 3.5721, val_loss: 5.0788, lr: 0.003000, 5.11s
2024-09-01 21:52:19 INFO     epoch complete!
2024-09-01 21:52:19 INFO     evaluating now!
2024-09-01 21:52:20 INFO     Epoch [71/200] train_loss: 3.5988, val_loss: 5.1064, lr: 0.003000, 5.21s
2024-09-01 21:52:25 INFO     epoch complete!
2024-09-01 21:52:25 INFO     evaluating now!
2024-09-01 21:52:25 INFO     Epoch [72/200] train_loss: 3.6220, val_loss: 5.0743, lr: 0.003000, 5.13s
2024-09-01 21:52:30 INFO     epoch complete!
2024-09-01 21:52:30 INFO     evaluating now!
2024-09-01 21:52:30 INFO     Epoch [73/200] train_loss: 3.5671, val_loss: 5.1392, lr: 0.003000, 5.15s
2024-09-01 21:52:35 INFO     epoch complete!
2024-09-01 21:52:35 INFO     evaluating now!
2024-09-01 21:52:35 INFO     Epoch [74/200] train_loss: 3.5245, val_loss: 5.1626, lr: 0.003000, 5.13s
2024-09-01 21:52:40 INFO     epoch complete!
2024-09-01 21:52:40 INFO     evaluating now!
2024-09-01 21:52:40 INFO     Epoch [75/200] train_loss: 3.5249, val_loss: 5.3044, lr: 0.003000, 5.18s
2024-09-01 21:52:45 INFO     epoch complete!
2024-09-01 21:52:45 INFO     evaluating now!
2024-09-01 21:52:46 INFO     Epoch [76/200] train_loss: 3.5624, val_loss: 5.2049, lr: 0.003000, 5.16s
2024-09-01 21:52:50 INFO     epoch complete!
2024-09-01 21:52:50 INFO     evaluating now!
2024-09-01 21:52:51 INFO     Epoch [77/200] train_loss: 3.5150, val_loss: 5.1404, lr: 0.003000, 5.11s
2024-09-01 21:52:55 INFO     epoch complete!
2024-09-01 21:52:55 INFO     evaluating now!
2024-09-01 21:52:56 INFO     Epoch [78/200] train_loss: 3.4770, val_loss: 5.1789, lr: 0.003000, 5.10s
2024-09-01 21:53:01 INFO     epoch complete!
2024-09-01 21:53:01 INFO     evaluating now!
2024-09-01 21:53:01 INFO     Epoch [79/200] train_loss: 3.4972, val_loss: 5.1753, lr: 0.003000, 5.22s
2024-09-01 21:53:01 WARNING  Early stopping at epoch: 79
2024-09-01 21:53:01 INFO     Trained totally 80 epochs, average train time is 4.887s, average eval time is 0.310s
2024-09-01 21:53:01 INFO     Loaded model at 64
2024-09-01 21:53:01 INFO     Saved model at ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406.m
2024-09-01 21:53:01 INFO     Start evaluating ...
2024-09-01 21:53:02 INFO     Note that you select the single mode to evaluate!
2024-09-01 21:53:02 INFO     Evaluate result is saved at ./libcity/cache/25/evaluate_cache\2024_09_01_21_53_02_AGCRN_CHITaxi20190406.csv
2024-09-01 21:53:02 INFO     
         MAE       RMSE
1   2.333385   7.707570
2   2.371330   7.940355
3   2.522842   8.646101
4   2.702888   9.258104
5   2.776159   9.857587
6   2.889854  10.480834
7   2.986586  11.199738
8   3.111395  12.066394
9   3.157701  12.736524
10  3.242511  13.457360
11  3.326255  14.400706
12  3.502627  15.380386
2024-09-01 21:53:02 INFO     ----------------------------------------------------------------------------
2024-09-01 21:53:02 INFO     # 1, Kownledge Graph Embedding: RotE, Experiment ids: 26
2024-09-01 21:53:02 INFO     ----------------------------------------------------------------------------
2024-09-01 21:53:02 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=25
2024-09-01 21:53:02 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 25, 'embedding_model': 'RotE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-01 21:53:02 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-01 21:53:02 INFO     set_weight_link_or_dist: dist
2024-09-01 21:53:02 INFO     init_weight_inf_or_zero: inf
2024-09-01 21:53:02 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-01 21:53:02 INFO     Start Calculate the weight by Gauss kernel!
2024-09-01 21:53:02 INFO     Loading file CHITaxi20190406.dyna
2024-09-01 21:53:02 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-01 21:53:05 INFO     Dataset created
2024-09-01 21:53:05 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-01 21:53:05 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-01 21:53:05 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-01 21:53:05 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-01 21:53:05 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-01 21:53:05 INFO     NormalScaler max: 1.4623669798075165
2024-09-01 21:53:07 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-01 21:53:07 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-01 21:53:07 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-01 21:53:07 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 21:53:07 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-01 21:53:07 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 21:53:07 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-01 21:53:07 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 21:53:07 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-01 21:53:07 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 21:53:07 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-01 21:53:07 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-01 21:53:07 INFO     Total parameter numbers: 874010
2024-09-01 21:53:07 INFO     You select `adam` optimizer.
2024-09-01 21:53:07 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-01 21:53:07 INFO     Start training ...
2024-09-01 21:53:07 INFO     num_batches:48
2024-09-01 21:53:12 INFO     epoch complete!
2024-09-01 21:53:12 INFO     evaluating now!
2024-09-01 21:53:13 INFO     Epoch [0/200] train_loss: 24.5122, val_loss: 18.9197, lr: 0.003000, 5.44s
2024-09-01 21:53:13 INFO     Saved model at 0
2024-09-01 21:53:13 INFO     Val loss decrease from inf to 18.9197, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-01 21:53:18 INFO     epoch complete!
2024-09-01 21:53:18 INFO     evaluating now!
2024-09-01 21:53:18 INFO     Epoch [1/200] train_loss: 15.6655, val_loss: 15.4016, lr: 0.003000, 5.11s
2024-09-01 21:53:18 INFO     Saved model at 1
2024-09-01 21:53:18 INFO     Val loss decrease from 18.9197 to 15.4016, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-01 21:53:23 INFO     epoch complete!
2024-09-01 21:53:23 INFO     evaluating now!
2024-09-01 21:53:23 INFO     Epoch [2/200] train_loss: 12.7601, val_loss: 12.2472, lr: 0.003000, 5.11s
2024-09-01 21:53:23 INFO     Saved model at 2
2024-09-01 21:53:23 INFO     Val loss decrease from 15.4016 to 12.2472, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-01 21:53:28 INFO     epoch complete!
2024-09-01 21:53:28 INFO     evaluating now!
2024-09-01 21:53:28 INFO     Epoch [3/200] train_loss: 10.4375, val_loss: 9.9311, lr: 0.003000, 5.18s
2024-09-01 21:53:28 INFO     Saved model at 3
2024-09-01 21:53:28 INFO     Val loss decrease from 12.2472 to 9.9311, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-01 21:53:33 INFO     epoch complete!
2024-09-01 21:53:33 INFO     evaluating now!
2024-09-01 21:53:33 INFO     Epoch [4/200] train_loss: 8.8938, val_loss: 8.5188, lr: 0.003000, 5.17s
2024-09-01 21:53:33 INFO     Saved model at 4
2024-09-01 21:53:33 INFO     Val loss decrease from 9.9311 to 8.5188, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-01 21:53:38 INFO     epoch complete!
2024-09-01 21:53:38 INFO     evaluating now!
2024-09-01 21:53:39 INFO     Epoch [5/200] train_loss: 7.9541, val_loss: 7.4496, lr: 0.003000, 5.13s
2024-09-01 21:53:39 INFO     Saved model at 5
2024-09-01 21:53:39 INFO     Val loss decrease from 8.5188 to 7.4496, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-01 21:53:43 INFO     epoch complete!
2024-09-01 21:53:43 INFO     evaluating now!
2024-09-01 21:53:44 INFO     Epoch [6/200] train_loss: 7.2296, val_loss: 7.2552, lr: 0.003000, 5.12s
2024-09-01 21:53:44 INFO     Saved model at 6
2024-09-01 21:53:44 INFO     Val loss decrease from 7.4496 to 7.2552, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-01 21:53:48 INFO     epoch complete!
2024-09-01 21:53:48 INFO     evaluating now!
2024-09-01 21:53:49 INFO     Epoch [7/200] train_loss: 6.8010, val_loss: 6.8662, lr: 0.003000, 5.10s
2024-09-01 21:53:49 INFO     Saved model at 7
2024-09-01 21:53:49 INFO     Val loss decrease from 7.2552 to 6.8662, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-01 21:53:54 INFO     epoch complete!
2024-09-01 21:53:54 INFO     evaluating now!
2024-09-01 21:53:54 INFO     Epoch [8/200] train_loss: 6.4744, val_loss: 6.7303, lr: 0.003000, 5.12s
2024-09-01 21:53:54 INFO     Saved model at 8
2024-09-01 21:53:54 INFO     Val loss decrease from 6.8662 to 6.7303, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-01 21:53:59 INFO     epoch complete!
2024-09-01 21:53:59 INFO     evaluating now!
2024-09-01 21:53:59 INFO     Epoch [9/200] train_loss: 6.3014, val_loss: 6.5963, lr: 0.003000, 5.11s
2024-09-01 21:53:59 INFO     Saved model at 9
2024-09-01 21:53:59 INFO     Val loss decrease from 6.7303 to 6.5963, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-01 21:54:04 INFO     epoch complete!
2024-09-01 21:54:04 INFO     evaluating now!
2024-09-01 21:54:04 INFO     Epoch [10/200] train_loss: 6.0208, val_loss: 6.1753, lr: 0.003000, 5.10s
2024-09-01 21:54:04 INFO     Saved model at 10
2024-09-01 21:54:04 INFO     Val loss decrease from 6.5963 to 6.1753, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-01 21:54:09 INFO     epoch complete!
2024-09-01 21:54:09 INFO     evaluating now!
2024-09-01 21:54:09 INFO     Epoch [11/200] train_loss: 5.8181, val_loss: 5.9518, lr: 0.003000, 5.12s
2024-09-01 21:54:09 INFO     Saved model at 11
2024-09-01 21:54:09 INFO     Val loss decrease from 6.1753 to 5.9518, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-01 21:54:14 INFO     epoch complete!
2024-09-01 21:54:14 INFO     evaluating now!
2024-09-01 21:54:14 INFO     Epoch [12/200] train_loss: 5.7057, val_loss: 6.0484, lr: 0.003000, 5.10s
2024-09-01 21:54:19 INFO     epoch complete!
2024-09-01 21:54:19 INFO     evaluating now!
2024-09-01 21:54:20 INFO     Epoch [13/200] train_loss: 5.7226, val_loss: 5.9183, lr: 0.003000, 5.16s
2024-09-01 21:54:20 INFO     Saved model at 13
2024-09-01 21:54:20 INFO     Val loss decrease from 5.9518 to 5.9183, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-01 21:54:24 INFO     epoch complete!
2024-09-01 21:54:24 INFO     evaluating now!
2024-09-01 21:54:25 INFO     Epoch [14/200] train_loss: 5.4835, val_loss: 5.8484, lr: 0.003000, 5.11s
2024-09-01 21:54:25 INFO     Saved model at 14
2024-09-01 21:54:25 INFO     Val loss decrease from 5.9183 to 5.8484, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-01 21:54:30 INFO     epoch complete!
2024-09-01 21:54:30 INFO     evaluating now!
2024-09-01 21:54:30 INFO     Epoch [15/200] train_loss: 5.3915, val_loss: 5.9131, lr: 0.003000, 5.16s
2024-09-01 21:54:35 INFO     epoch complete!
2024-09-01 21:54:35 INFO     evaluating now!
2024-09-01 21:54:35 INFO     Epoch [16/200] train_loss: 5.2650, val_loss: 5.6670, lr: 0.003000, 5.10s
2024-09-01 21:54:35 INFO     Saved model at 16
2024-09-01 21:54:35 INFO     Val loss decrease from 5.8484 to 5.6670, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-01 21:54:40 INFO     epoch complete!
2024-09-01 21:54:40 INFO     evaluating now!
2024-09-01 21:54:40 INFO     Epoch [17/200] train_loss: 5.2386, val_loss: 5.6887, lr: 0.003000, 5.12s
2024-09-01 21:54:45 INFO     epoch complete!
2024-09-01 21:54:45 INFO     evaluating now!
2024-09-01 21:54:45 INFO     Epoch [18/200] train_loss: 5.1516, val_loss: 5.6197, lr: 0.003000, 5.16s
2024-09-01 21:54:45 INFO     Saved model at 18
2024-09-01 21:54:45 INFO     Val loss decrease from 5.6670 to 5.6197, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-01 21:54:50 INFO     epoch complete!
2024-09-01 21:54:50 INFO     evaluating now!
2024-09-01 21:54:50 INFO     Epoch [19/200] train_loss: 5.0733, val_loss: 5.4949, lr: 0.003000, 5.17s
2024-09-01 21:54:50 INFO     Saved model at 19
2024-09-01 21:54:50 INFO     Val loss decrease from 5.6197 to 5.4949, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-01 21:54:55 INFO     epoch complete!
2024-09-01 21:54:55 INFO     evaluating now!
2024-09-01 21:54:56 INFO     Epoch [20/200] train_loss: 4.9689, val_loss: 5.3822, lr: 0.003000, 5.29s
2024-09-01 21:54:56 INFO     Saved model at 20
2024-09-01 21:54:56 INFO     Val loss decrease from 5.4949 to 5.3822, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-01 21:55:01 INFO     epoch complete!
2024-09-01 21:55:01 INFO     evaluating now!
2024-09-01 21:55:01 INFO     Epoch [21/200] train_loss: 4.9166, val_loss: 5.3335, lr: 0.003000, 5.33s
2024-09-01 21:55:01 INFO     Saved model at 21
2024-09-01 21:55:01 INFO     Val loss decrease from 5.3822 to 5.3335, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-01 21:55:06 INFO     epoch complete!
2024-09-01 21:55:06 INFO     evaluating now!
2024-09-01 21:55:06 INFO     Epoch [22/200] train_loss: 4.9663, val_loss: 5.3179, lr: 0.003000, 5.18s
2024-09-01 21:55:06 INFO     Saved model at 22
2024-09-01 21:55:06 INFO     Val loss decrease from 5.3335 to 5.3179, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-01 21:55:11 INFO     epoch complete!
2024-09-01 21:55:11 INFO     evaluating now!
2024-09-01 21:55:11 INFO     Epoch [23/200] train_loss: 4.7629, val_loss: 5.4274, lr: 0.003000, 5.11s
2024-09-01 21:55:16 INFO     epoch complete!
2024-09-01 21:55:16 INFO     evaluating now!
2024-09-01 21:55:17 INFO     Epoch [24/200] train_loss: 4.7324, val_loss: 5.4535, lr: 0.003000, 5.11s
2024-09-01 21:55:21 INFO     epoch complete!
2024-09-01 21:55:21 INFO     evaluating now!
2024-09-01 21:55:22 INFO     Epoch [25/200] train_loss: 4.7024, val_loss: 5.3739, lr: 0.003000, 5.12s
2024-09-01 21:55:26 INFO     epoch complete!
2024-09-01 21:55:26 INFO     evaluating now!
2024-09-01 21:55:27 INFO     Epoch [26/200] train_loss: 4.6311, val_loss: 5.2434, lr: 0.003000, 5.10s
2024-09-01 21:55:27 INFO     Saved model at 26
2024-09-01 21:55:27 INFO     Val loss decrease from 5.3179 to 5.2434, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-01 21:55:32 INFO     epoch complete!
2024-09-01 21:55:32 INFO     evaluating now!
2024-09-01 21:55:32 INFO     Epoch [27/200] train_loss: 4.5785, val_loss: 5.2506, lr: 0.003000, 5.25s
2024-09-01 21:55:37 INFO     epoch complete!
2024-09-01 21:55:37 INFO     evaluating now!
2024-09-01 21:55:37 INFO     Epoch [28/200] train_loss: 4.5336, val_loss: 5.1465, lr: 0.003000, 5.14s
2024-09-01 21:55:37 INFO     Saved model at 28
2024-09-01 21:55:37 INFO     Val loss decrease from 5.2434 to 5.1465, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-01 21:55:42 INFO     epoch complete!
2024-09-01 21:55:42 INFO     evaluating now!
2024-09-01 21:55:42 INFO     Epoch [29/200] train_loss: 4.5122, val_loss: 5.1304, lr: 0.003000, 5.19s
2024-09-01 21:55:42 INFO     Saved model at 29
2024-09-01 21:55:42 INFO     Val loss decrease from 5.1465 to 5.1304, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-01 21:55:47 INFO     epoch complete!
2024-09-01 21:55:47 INFO     evaluating now!
2024-09-01 21:55:48 INFO     Epoch [30/200] train_loss: 4.4789, val_loss: 5.3076, lr: 0.003000, 5.16s
2024-09-01 21:55:52 INFO     epoch complete!
2024-09-01 21:55:52 INFO     evaluating now!
2024-09-01 21:55:53 INFO     Epoch [31/200] train_loss: 4.4999, val_loss: 5.3327, lr: 0.003000, 5.12s
2024-09-01 21:55:57 INFO     epoch complete!
2024-09-01 21:55:57 INFO     evaluating now!
2024-09-01 21:55:58 INFO     Epoch [32/200] train_loss: 4.3591, val_loss: 5.1772, lr: 0.003000, 5.11s
2024-09-01 21:56:03 INFO     epoch complete!
2024-09-01 21:56:03 INFO     evaluating now!
2024-09-01 21:56:03 INFO     Epoch [33/200] train_loss: 4.3579, val_loss: 5.3852, lr: 0.003000, 5.14s
2024-09-01 21:56:08 INFO     epoch complete!
2024-09-01 21:56:08 INFO     evaluating now!
2024-09-01 21:56:08 INFO     Epoch [34/200] train_loss: 4.2833, val_loss: 5.3984, lr: 0.003000, 5.12s
2024-09-01 21:56:13 INFO     epoch complete!
2024-09-01 21:56:13 INFO     evaluating now!
2024-09-01 21:56:13 INFO     Epoch [35/200] train_loss: 4.2866, val_loss: 5.3949, lr: 0.003000, 5.11s
2024-09-01 21:56:18 INFO     epoch complete!
2024-09-01 21:56:18 INFO     evaluating now!
2024-09-01 21:56:18 INFO     Epoch [36/200] train_loss: 4.2385, val_loss: 5.1729, lr: 0.003000, 5.11s
2024-09-01 21:56:23 INFO     epoch complete!
2024-09-01 21:56:23 INFO     evaluating now!
2024-09-01 21:56:23 INFO     Epoch [37/200] train_loss: 4.1716, val_loss: 5.3128, lr: 0.003000, 5.08s
2024-09-01 21:56:28 INFO     epoch complete!
2024-09-01 21:56:28 INFO     evaluating now!
2024-09-01 21:56:28 INFO     Epoch [38/200] train_loss: 4.2075, val_loss: 5.2366, lr: 0.003000, 5.04s
2024-09-01 21:56:33 INFO     epoch complete!
2024-09-01 21:56:33 INFO     evaluating now!
2024-09-01 21:56:33 INFO     Epoch [39/200] train_loss: 4.1793, val_loss: 5.1759, lr: 0.003000, 5.04s
2024-09-01 21:56:38 INFO     epoch complete!
2024-09-01 21:56:38 INFO     evaluating now!
2024-09-01 21:56:38 INFO     Epoch [40/200] train_loss: 4.1154, val_loss: 5.2747, lr: 0.003000, 5.03s
2024-09-01 21:56:43 INFO     epoch complete!
2024-09-01 21:56:43 INFO     evaluating now!
2024-09-01 21:56:43 INFO     Epoch [41/200] train_loss: 4.0552, val_loss: 5.0419, lr: 0.003000, 5.04s
2024-09-01 21:56:43 INFO     Saved model at 41
2024-09-01 21:56:43 INFO     Val loss decrease from 5.1304 to 5.0419, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-09-01 21:56:48 INFO     epoch complete!
2024-09-01 21:56:48 INFO     evaluating now!
2024-09-01 21:56:49 INFO     Epoch [42/200] train_loss: 4.0610, val_loss: 5.3292, lr: 0.003000, 5.10s
2024-09-01 21:56:53 INFO     epoch complete!
2024-09-01 21:56:53 INFO     evaluating now!
2024-09-01 21:56:54 INFO     Epoch [43/200] train_loss: 4.0436, val_loss: 5.1371, lr: 0.003000, 5.03s
2024-09-01 21:56:58 INFO     epoch complete!
2024-09-01 21:56:58 INFO     evaluating now!
2024-09-01 21:56:59 INFO     Epoch [44/200] train_loss: 4.0095, val_loss: 5.0384, lr: 0.003000, 5.03s
2024-09-01 21:56:59 INFO     Saved model at 44
2024-09-01 21:56:59 INFO     Val loss decrease from 5.0419 to 5.0384, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-09-01 21:57:03 INFO     epoch complete!
2024-09-01 21:57:03 INFO     evaluating now!
2024-09-01 21:57:04 INFO     Epoch [45/200] train_loss: 3.9701, val_loss: 5.0769, lr: 0.003000, 5.12s
2024-09-01 21:57:09 INFO     epoch complete!
2024-09-01 21:57:09 INFO     evaluating now!
2024-09-01 21:57:09 INFO     Epoch [46/200] train_loss: 3.9314, val_loss: 5.1365, lr: 0.003000, 5.03s
2024-09-01 21:57:14 INFO     epoch complete!
2024-09-01 21:57:14 INFO     evaluating now!
2024-09-01 21:57:14 INFO     Epoch [47/200] train_loss: 3.8629, val_loss: 5.1197, lr: 0.003000, 5.07s
2024-09-01 21:57:19 INFO     epoch complete!
2024-09-01 21:57:19 INFO     evaluating now!
2024-09-01 21:57:19 INFO     Epoch [48/200] train_loss: 3.9210, val_loss: 5.1299, lr: 0.003000, 5.04s
2024-09-01 21:57:24 INFO     epoch complete!
2024-09-01 21:57:24 INFO     evaluating now!
2024-09-01 21:57:24 INFO     Epoch [49/200] train_loss: 3.8531, val_loss: 5.1977, lr: 0.003000, 5.07s
2024-09-01 21:57:29 INFO     epoch complete!
2024-09-01 21:57:29 INFO     evaluating now!
2024-09-01 21:57:29 INFO     Epoch [50/200] train_loss: 3.9528, val_loss: 5.1119, lr: 0.003000, 5.12s
2024-09-01 21:57:34 INFO     epoch complete!
2024-09-01 21:57:34 INFO     evaluating now!
2024-09-01 21:57:34 INFO     Epoch [51/200] train_loss: 3.8852, val_loss: 5.0075, lr: 0.003000, 5.18s
2024-09-01 21:57:34 INFO     Saved model at 51
2024-09-01 21:57:34 INFO     Val loss decrease from 5.0384 to 5.0075, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-09-01 21:57:39 INFO     epoch complete!
2024-09-01 21:57:39 INFO     evaluating now!
2024-09-01 21:57:39 INFO     Epoch [52/200] train_loss: 3.7805, val_loss: 5.2257, lr: 0.003000, 5.13s
2024-09-01 21:57:44 INFO     epoch complete!
2024-09-01 21:57:44 INFO     evaluating now!
2024-09-01 21:57:45 INFO     Epoch [53/200] train_loss: 3.7974, val_loss: 5.2460, lr: 0.003000, 5.09s
2024-09-01 21:57:49 INFO     epoch complete!
2024-09-01 21:57:49 INFO     evaluating now!
2024-09-01 21:57:50 INFO     Epoch [54/200] train_loss: 3.7645, val_loss: 5.1431, lr: 0.003000, 5.18s
2024-09-01 21:57:55 INFO     epoch complete!
2024-09-01 21:57:55 INFO     evaluating now!
2024-09-01 21:57:55 INFO     Epoch [55/200] train_loss: 3.7354, val_loss: 4.8867, lr: 0.003000, 5.13s
2024-09-01 21:57:55 INFO     Saved model at 55
2024-09-01 21:57:55 INFO     Val loss decrease from 5.0075 to 4.8867, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch55.tar
2024-09-01 21:58:00 INFO     epoch complete!
2024-09-01 21:58:00 INFO     evaluating now!
2024-09-01 21:58:00 INFO     Epoch [56/200] train_loss: 3.7560, val_loss: 5.1276, lr: 0.003000, 5.10s
2024-09-01 21:58:05 INFO     epoch complete!
2024-09-01 21:58:05 INFO     evaluating now!
2024-09-01 21:58:05 INFO     Epoch [57/200] train_loss: 3.7193, val_loss: 5.1434, lr: 0.003000, 5.24s
2024-09-01 21:58:10 INFO     epoch complete!
2024-09-01 21:58:10 INFO     evaluating now!
2024-09-01 21:58:10 INFO     Epoch [58/200] train_loss: 3.7164, val_loss: 5.0489, lr: 0.003000, 5.17s
2024-09-01 21:58:15 INFO     epoch complete!
2024-09-01 21:58:15 INFO     evaluating now!
2024-09-01 21:58:15 INFO     Epoch [59/200] train_loss: 3.7576, val_loss: 5.0474, lr: 0.003000, 5.12s
2024-09-01 21:58:20 INFO     epoch complete!
2024-09-01 21:58:20 INFO     evaluating now!
2024-09-01 21:58:21 INFO     Epoch [60/200] train_loss: 3.6897, val_loss: 5.1294, lr: 0.003000, 5.14s
2024-09-01 21:58:26 INFO     epoch complete!
2024-09-01 21:58:26 INFO     evaluating now!
2024-09-01 21:58:26 INFO     Epoch [61/200] train_loss: 3.6666, val_loss: 5.0629, lr: 0.003000, 5.32s
2024-09-01 21:58:31 INFO     epoch complete!
2024-09-01 21:58:31 INFO     evaluating now!
2024-09-01 21:58:31 INFO     Epoch [62/200] train_loss: 3.6328, val_loss: 4.9673, lr: 0.003000, 5.18s
2024-09-01 21:58:36 INFO     epoch complete!
2024-09-01 21:58:36 INFO     evaluating now!
2024-09-01 21:58:36 INFO     Epoch [63/200] train_loss: 3.7044, val_loss: 5.1280, lr: 0.003000, 5.21s
2024-09-01 21:58:41 INFO     epoch complete!
2024-09-01 21:58:41 INFO     evaluating now!
2024-09-01 21:58:42 INFO     Epoch [64/200] train_loss: 3.5915, val_loss: 4.9782, lr: 0.003000, 5.22s
2024-09-01 21:58:46 INFO     epoch complete!
2024-09-01 21:58:46 INFO     evaluating now!
2024-09-01 21:58:47 INFO     Epoch [65/200] train_loss: 3.5714, val_loss: 5.0003, lr: 0.003000, 5.22s
2024-09-01 21:58:52 INFO     epoch complete!
2024-09-01 21:58:52 INFO     evaluating now!
2024-09-01 21:58:52 INFO     Epoch [66/200] train_loss: 3.5733, val_loss: 5.0371, lr: 0.003000, 5.23s
2024-09-01 21:58:57 INFO     epoch complete!
2024-09-01 21:58:57 INFO     evaluating now!
2024-09-01 21:58:57 INFO     Epoch [67/200] train_loss: 3.5865, val_loss: 4.9781, lr: 0.003000, 5.17s
2024-09-01 21:59:02 INFO     epoch complete!
2024-09-01 21:59:02 INFO     evaluating now!
2024-09-01 21:59:02 INFO     Epoch [68/200] train_loss: 3.5225, val_loss: 4.9612, lr: 0.003000, 5.20s
2024-09-01 21:59:07 INFO     epoch complete!
2024-09-01 21:59:07 INFO     evaluating now!
2024-09-01 21:59:08 INFO     Epoch [69/200] train_loss: 3.5015, val_loss: 5.0137, lr: 0.003000, 5.17s
2024-09-01 21:59:12 INFO     epoch complete!
2024-09-01 21:59:12 INFO     evaluating now!
2024-09-01 21:59:13 INFO     Epoch [70/200] train_loss: 3.5659, val_loss: 4.9637, lr: 0.003000, 5.14s
2024-09-01 21:59:13 WARNING  Early stopping at epoch: 70
2024-09-01 21:59:13 INFO     Trained totally 71 epochs, average train time is 4.833s, average eval time is 0.307s
2024-09-01 21:59:13 INFO     Loaded model at 55
2024-09-01 21:59:13 INFO     Saved model at ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406.m
2024-09-01 21:59:13 INFO     Start evaluating ...
2024-09-01 21:59:14 INFO     Note that you select the single mode to evaluate!
2024-09-01 21:59:14 INFO     Evaluate result is saved at ./libcity/cache/25/evaluate_cache\2024_09_01_21_59_14_AGCRN_CHITaxi20190406.csv
2024-09-01 21:59:14 INFO     
         MAE       RMSE
1   2.519028   7.552461
2   2.607875   7.981368
3   2.749326   8.753347
4   2.854995   9.395398
5   3.005772  10.271055
6   3.122193  11.264958
7   3.166127  12.139404
8   3.301622  12.537122
9   3.266281  12.930467
10  3.298176  13.177696
11  3.373916  13.704211
12  3.532587  14.490498
2024-09-01 21:59:14 INFO     ----------------------------------------------------------------------------
2024-09-01 21:59:14 INFO     # 2, Kownledge Graph Embedding: RotE, Experiment ids: 27
2024-09-01 21:59:14 INFO     ----------------------------------------------------------------------------
2024-09-01 21:59:14 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=25
2024-09-01 21:59:14 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 25, 'embedding_model': 'RotE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-01 21:59:14 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-01 21:59:14 INFO     set_weight_link_or_dist: dist
2024-09-01 21:59:14 INFO     init_weight_inf_or_zero: inf
2024-09-01 21:59:14 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-01 21:59:14 INFO     Start Calculate the weight by Gauss kernel!
2024-09-01 21:59:14 INFO     Loading file CHITaxi20190406.dyna
2024-09-01 21:59:14 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-01 21:59:16 INFO     Dataset created
2024-09-01 21:59:16 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-01 21:59:16 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-01 21:59:16 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-01 21:59:16 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-01 21:59:16 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-01 21:59:16 INFO     NormalScaler max: 1.4623669798075165
2024-09-01 21:59:18 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-01 21:59:18 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-01 21:59:18 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-01 21:59:18 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 21:59:18 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-01 21:59:18 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 21:59:18 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-01 21:59:18 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 21:59:18 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-01 21:59:18 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 21:59:18 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-01 21:59:18 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-01 21:59:18 INFO     Total parameter numbers: 874010
2024-09-01 21:59:18 INFO     You select `adam` optimizer.
2024-09-01 21:59:18 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-01 21:59:18 INFO     Start training ...
2024-09-01 21:59:18 INFO     num_batches:48
2024-09-01 21:59:23 INFO     epoch complete!
2024-09-01 21:59:23 INFO     evaluating now!
2024-09-01 21:59:23 INFO     Epoch [0/200] train_loss: 24.5276, val_loss: 18.6237, lr: 0.003000, 5.47s
2024-09-01 21:59:23 INFO     Saved model at 0
2024-09-01 21:59:23 INFO     Val loss decrease from inf to 18.6237, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-01 21:59:28 INFO     epoch complete!
2024-09-01 21:59:28 INFO     evaluating now!
2024-09-01 21:59:28 INFO     Epoch [1/200] train_loss: 15.4194, val_loss: 15.0682, lr: 0.003000, 5.11s
2024-09-01 21:59:28 INFO     Saved model at 1
2024-09-01 21:59:28 INFO     Val loss decrease from 18.6237 to 15.0682, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-01 21:59:34 INFO     epoch complete!
2024-09-01 21:59:34 INFO     evaluating now!
2024-09-01 21:59:34 INFO     Epoch [2/200] train_loss: 12.8475, val_loss: 12.6053, lr: 0.003000, 5.34s
2024-09-01 21:59:34 INFO     Saved model at 2
2024-09-01 21:59:34 INFO     Val loss decrease from 15.0682 to 12.6053, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-01 21:59:39 INFO     epoch complete!
2024-09-01 21:59:39 INFO     evaluating now!
2024-09-01 21:59:39 INFO     Epoch [3/200] train_loss: 10.4846, val_loss: 9.8771, lr: 0.003000, 5.13s
2024-09-01 21:59:39 INFO     Saved model at 3
2024-09-01 21:59:39 INFO     Val loss decrease from 12.6053 to 9.8771, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-01 21:59:44 INFO     epoch complete!
2024-09-01 21:59:44 INFO     evaluating now!
2024-09-01 21:59:44 INFO     Epoch [4/200] train_loss: 8.8953, val_loss: 9.3683, lr: 0.003000, 5.14s
2024-09-01 21:59:44 INFO     Saved model at 4
2024-09-01 21:59:44 INFO     Val loss decrease from 9.8771 to 9.3683, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-01 21:59:49 INFO     epoch complete!
2024-09-01 21:59:49 INFO     evaluating now!
2024-09-01 21:59:49 INFO     Epoch [5/200] train_loss: 7.9807, val_loss: 7.6941, lr: 0.003000, 5.10s
2024-09-01 21:59:49 INFO     Saved model at 5
2024-09-01 21:59:49 INFO     Val loss decrease from 9.3683 to 7.6941, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-01 21:59:54 INFO     epoch complete!
2024-09-01 21:59:54 INFO     evaluating now!
2024-09-01 21:59:54 INFO     Epoch [6/200] train_loss: 7.3291, val_loss: 7.0916, lr: 0.003000, 5.10s
2024-09-01 21:59:54 INFO     Saved model at 6
2024-09-01 21:59:54 INFO     Val loss decrease from 7.6941 to 7.0916, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-01 21:59:59 INFO     epoch complete!
2024-09-01 21:59:59 INFO     evaluating now!
2024-09-01 21:59:59 INFO     Epoch [7/200] train_loss: 6.8117, val_loss: 6.9816, lr: 0.003000, 5.09s
2024-09-01 21:59:59 INFO     Saved model at 7
2024-09-01 21:59:59 INFO     Val loss decrease from 7.0916 to 6.9816, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-01 22:00:04 INFO     epoch complete!
2024-09-01 22:00:04 INFO     evaluating now!
2024-09-01 22:00:05 INFO     Epoch [8/200] train_loss: 6.5785, val_loss: 6.6373, lr: 0.003000, 5.18s
2024-09-01 22:00:05 INFO     Saved model at 8
2024-09-01 22:00:05 INFO     Val loss decrease from 6.9816 to 6.6373, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-01 22:00:10 INFO     epoch complete!
2024-09-01 22:00:10 INFO     evaluating now!
2024-09-01 22:00:10 INFO     Epoch [9/200] train_loss: 6.2705, val_loss: 6.3204, lr: 0.003000, 5.21s
2024-09-01 22:00:10 INFO     Saved model at 9
2024-09-01 22:00:10 INFO     Val loss decrease from 6.6373 to 6.3204, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-01 22:00:15 INFO     epoch complete!
2024-09-01 22:00:15 INFO     evaluating now!
2024-09-01 22:00:15 INFO     Epoch [10/200] train_loss: 6.0667, val_loss: 6.2488, lr: 0.003000, 5.19s
2024-09-01 22:00:15 INFO     Saved model at 10
2024-09-01 22:00:15 INFO     Val loss decrease from 6.3204 to 6.2488, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-01 22:00:20 INFO     epoch complete!
2024-09-01 22:00:20 INFO     evaluating now!
2024-09-01 22:00:20 INFO     Epoch [11/200] train_loss: 5.8852, val_loss: 6.2427, lr: 0.003000, 5.17s
2024-09-01 22:00:20 INFO     Saved model at 11
2024-09-01 22:00:20 INFO     Val loss decrease from 6.2488 to 6.2427, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-01 22:00:25 INFO     epoch complete!
2024-09-01 22:00:25 INFO     evaluating now!
2024-09-01 22:00:26 INFO     Epoch [12/200] train_loss: 5.6229, val_loss: 6.0453, lr: 0.003000, 5.38s
2024-09-01 22:00:26 INFO     Saved model at 12
2024-09-01 22:00:26 INFO     Val loss decrease from 6.2427 to 6.0453, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-01 22:00:31 INFO     epoch complete!
2024-09-01 22:00:31 INFO     evaluating now!
2024-09-01 22:00:31 INFO     Epoch [13/200] train_loss: 5.5370, val_loss: 5.7197, lr: 0.003000, 5.44s
2024-09-01 22:00:31 INFO     Saved model at 13
2024-09-01 22:00:31 INFO     Val loss decrease from 6.0453 to 5.7197, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-01 22:00:36 INFO     epoch complete!
2024-09-01 22:00:36 INFO     evaluating now!
2024-09-01 22:00:36 INFO     Epoch [14/200] train_loss: 5.4792, val_loss: 5.7108, lr: 0.003000, 5.18s
2024-09-01 22:00:36 INFO     Saved model at 14
2024-09-01 22:00:36 INFO     Val loss decrease from 5.7197 to 5.7108, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-01 22:00:41 INFO     epoch complete!
2024-09-01 22:00:41 INFO     evaluating now!
2024-09-01 22:00:41 INFO     Epoch [15/200] train_loss: 5.4362, val_loss: 5.7474, lr: 0.003000, 5.14s
2024-09-01 22:00:46 INFO     epoch complete!
2024-09-01 22:00:46 INFO     evaluating now!
2024-09-01 22:00:47 INFO     Epoch [16/200] train_loss: 5.3076, val_loss: 5.6433, lr: 0.003000, 5.17s
2024-09-01 22:00:47 INFO     Saved model at 16
2024-09-01 22:00:47 INFO     Val loss decrease from 5.7108 to 5.6433, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-01 22:00:51 INFO     epoch complete!
2024-09-01 22:00:51 INFO     evaluating now!
2024-09-01 22:00:52 INFO     Epoch [17/200] train_loss: 5.2911, val_loss: 5.4307, lr: 0.003000, 5.19s
2024-09-01 22:00:52 INFO     Saved model at 17
2024-09-01 22:00:52 INFO     Val loss decrease from 5.6433 to 5.4307, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-01 22:00:57 INFO     epoch complete!
2024-09-01 22:00:57 INFO     evaluating now!
2024-09-01 22:00:57 INFO     Epoch [18/200] train_loss: 5.1701, val_loss: 5.4397, lr: 0.003000, 5.18s
2024-09-01 22:01:02 INFO     epoch complete!
2024-09-01 22:01:02 INFO     evaluating now!
2024-09-01 22:01:02 INFO     Epoch [19/200] train_loss: 5.0563, val_loss: 5.4304, lr: 0.003000, 5.21s
2024-09-01 22:01:02 INFO     Saved model at 19
2024-09-01 22:01:02 INFO     Val loss decrease from 5.4307 to 5.4304, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-01 22:01:07 INFO     epoch complete!
2024-09-01 22:01:07 INFO     evaluating now!
2024-09-01 22:01:07 INFO     Epoch [20/200] train_loss: 5.0836, val_loss: 5.6904, lr: 0.003000, 5.21s
2024-09-01 22:01:12 INFO     epoch complete!
2024-09-01 22:01:12 INFO     evaluating now!
2024-09-01 22:01:13 INFO     Epoch [21/200] train_loss: 5.0685, val_loss: 5.5876, lr: 0.003000, 5.19s
2024-09-01 22:01:17 INFO     epoch complete!
2024-09-01 22:01:17 INFO     evaluating now!
2024-09-01 22:01:18 INFO     Epoch [22/200] train_loss: 4.8618, val_loss: 5.5355, lr: 0.003000, 5.15s
2024-09-01 22:01:23 INFO     epoch complete!
2024-09-01 22:01:23 INFO     evaluating now!
2024-09-01 22:01:23 INFO     Epoch [23/200] train_loss: 4.8686, val_loss: 5.4318, lr: 0.003000, 5.21s
2024-09-01 22:01:28 INFO     epoch complete!
2024-09-01 22:01:28 INFO     evaluating now!
2024-09-01 22:01:28 INFO     Epoch [24/200] train_loss: 4.7827, val_loss: 5.0891, lr: 0.003000, 5.23s
2024-09-01 22:01:28 INFO     Saved model at 24
2024-09-01 22:01:28 INFO     Val loss decrease from 5.4304 to 5.0891, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-01 22:01:33 INFO     epoch complete!
2024-09-01 22:01:33 INFO     evaluating now!
2024-09-01 22:01:33 INFO     Epoch [25/200] train_loss: 4.8133, val_loss: 5.3449, lr: 0.003000, 5.15s
2024-09-01 22:01:38 INFO     epoch complete!
2024-09-01 22:01:38 INFO     evaluating now!
2024-09-01 22:01:39 INFO     Epoch [26/200] train_loss: 4.7295, val_loss: 5.2531, lr: 0.003000, 5.20s
2024-09-01 22:01:43 INFO     epoch complete!
2024-09-01 22:01:43 INFO     evaluating now!
2024-09-01 22:01:44 INFO     Epoch [27/200] train_loss: 4.6149, val_loss: 5.2498, lr: 0.003000, 5.16s
2024-09-01 22:01:49 INFO     epoch complete!
2024-09-01 22:01:49 INFO     evaluating now!
2024-09-01 22:01:49 INFO     Epoch [28/200] train_loss: 4.5918, val_loss: 5.2681, lr: 0.003000, 5.10s
2024-09-01 22:01:54 INFO     epoch complete!
2024-09-01 22:01:54 INFO     evaluating now!
2024-09-01 22:01:54 INFO     Epoch [29/200] train_loss: 4.5610, val_loss: 5.6268, lr: 0.003000, 5.09s
2024-09-01 22:01:59 INFO     epoch complete!
2024-09-01 22:01:59 INFO     evaluating now!
2024-09-01 22:01:59 INFO     Epoch [30/200] train_loss: 4.5586, val_loss: 5.2628, lr: 0.003000, 5.13s
2024-09-01 22:02:04 INFO     epoch complete!
2024-09-01 22:02:04 INFO     evaluating now!
2024-09-01 22:02:04 INFO     Epoch [31/200] train_loss: 4.4615, val_loss: 5.3921, lr: 0.003000, 5.28s
2024-09-01 22:02:09 INFO     epoch complete!
2024-09-01 22:02:09 INFO     evaluating now!
2024-09-01 22:02:10 INFO     Epoch [32/200] train_loss: 4.4454, val_loss: 5.4410, lr: 0.003000, 5.20s
2024-09-01 22:02:14 INFO     epoch complete!
2024-09-01 22:02:14 INFO     evaluating now!
2024-09-01 22:02:15 INFO     Epoch [33/200] train_loss: 4.3874, val_loss: 5.0697, lr: 0.003000, 5.14s
2024-09-01 22:02:15 INFO     Saved model at 33
2024-09-01 22:02:15 INFO     Val loss decrease from 5.0891 to 5.0697, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-09-01 22:02:20 INFO     epoch complete!
2024-09-01 22:02:20 INFO     evaluating now!
2024-09-01 22:02:20 INFO     Epoch [34/200] train_loss: 4.3386, val_loss: 5.0976, lr: 0.003000, 5.16s
2024-09-01 22:02:25 INFO     epoch complete!
2024-09-01 22:02:25 INFO     evaluating now!
2024-09-01 22:02:25 INFO     Epoch [35/200] train_loss: 4.2836, val_loss: 5.1894, lr: 0.003000, 5.10s
2024-09-01 22:02:30 INFO     epoch complete!
2024-09-01 22:02:30 INFO     evaluating now!
2024-09-01 22:02:30 INFO     Epoch [36/200] train_loss: 4.2905, val_loss: 5.1537, lr: 0.003000, 5.06s
2024-09-01 22:02:35 INFO     epoch complete!
2024-09-01 22:02:35 INFO     evaluating now!
2024-09-01 22:02:35 INFO     Epoch [37/200] train_loss: 4.2042, val_loss: 5.2420, lr: 0.003000, 5.16s
2024-09-01 22:02:40 INFO     epoch complete!
2024-09-01 22:02:40 INFO     evaluating now!
2024-09-01 22:02:40 INFO     Epoch [38/200] train_loss: 4.3629, val_loss: 5.3431, lr: 0.003000, 5.10s
2024-09-01 22:02:45 INFO     epoch complete!
2024-09-01 22:02:45 INFO     evaluating now!
2024-09-01 22:02:45 INFO     Epoch [39/200] train_loss: 4.2864, val_loss: 5.2411, lr: 0.003000, 5.11s
2024-09-01 22:02:50 INFO     epoch complete!
2024-09-01 22:02:50 INFO     evaluating now!
2024-09-01 22:02:51 INFO     Epoch [40/200] train_loss: 4.1750, val_loss: 5.2811, lr: 0.003000, 5.20s
2024-09-01 22:02:55 INFO     epoch complete!
2024-09-01 22:02:55 INFO     evaluating now!
2024-09-01 22:02:56 INFO     Epoch [41/200] train_loss: 4.1703, val_loss: 5.1962, lr: 0.003000, 5.13s
2024-09-01 22:03:00 INFO     epoch complete!
2024-09-01 22:03:00 INFO     evaluating now!
2024-09-01 22:03:01 INFO     Epoch [42/200] train_loss: 4.1064, val_loss: 5.2638, lr: 0.003000, 5.11s
2024-09-01 22:03:06 INFO     epoch complete!
2024-09-01 22:03:06 INFO     evaluating now!
2024-09-01 22:03:06 INFO     Epoch [43/200] train_loss: 4.0722, val_loss: 5.2049, lr: 0.003000, 5.07s
2024-09-01 22:03:11 INFO     epoch complete!
2024-09-01 22:03:11 INFO     evaluating now!
2024-09-01 22:03:11 INFO     Epoch [44/200] train_loss: 4.0191, val_loss: 5.2750, lr: 0.003000, 5.06s
2024-09-01 22:03:16 INFO     epoch complete!
2024-09-01 22:03:16 INFO     evaluating now!
2024-09-01 22:03:16 INFO     Epoch [45/200] train_loss: 4.0171, val_loss: 5.1448, lr: 0.003000, 5.07s
2024-09-01 22:03:21 INFO     epoch complete!
2024-09-01 22:03:21 INFO     evaluating now!
2024-09-01 22:03:21 INFO     Epoch [46/200] train_loss: 4.0380, val_loss: 5.3302, lr: 0.003000, 5.06s
2024-09-01 22:03:26 INFO     epoch complete!
2024-09-01 22:03:26 INFO     evaluating now!
2024-09-01 22:03:26 INFO     Epoch [47/200] train_loss: 3.9662, val_loss: 5.0981, lr: 0.003000, 5.06s
2024-09-01 22:03:31 INFO     epoch complete!
2024-09-01 22:03:31 INFO     evaluating now!
2024-09-01 22:03:31 INFO     Epoch [48/200] train_loss: 3.8996, val_loss: 5.2289, lr: 0.003000, 5.06s
2024-09-01 22:03:31 WARNING  Early stopping at epoch: 48
2024-09-01 22:03:31 INFO     Trained totally 49 epochs, average train time is 4.855s, average eval time is 0.309s
2024-09-01 22:03:31 INFO     Loaded model at 33
2024-09-01 22:03:31 INFO     Saved model at ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406.m
2024-09-01 22:03:31 INFO     Start evaluating ...
2024-09-01 22:03:32 INFO     Note that you select the single mode to evaluate!
2024-09-01 22:03:32 INFO     Evaluate result is saved at ./libcity/cache/25/evaluate_cache\2024_09_01_22_03_32_AGCRN_CHITaxi20190406.csv
2024-09-01 22:03:32 INFO     
         MAE       RMSE
1   2.505917   7.485848
2   2.512757   7.895661
3   2.694533   8.978929
4   2.926422   9.983250
5   3.103740  11.276725
6   3.299470  12.388849
7   3.454885  13.285760
8   3.573066  13.830456
9   3.612919  14.111437
10  3.664128  14.199233
11  3.791558  14.445919
12  3.868714  15.312279
2024-09-01 22:03:32 INFO     ----------------------------------------------------------------------------
2024-09-01 22:03:32 INFO     # 3, Kownledge Graph Embedding: RotE, Experiment ids: 28
2024-09-01 22:03:32 INFO     ----------------------------------------------------------------------------
2024-09-01 22:03:32 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=25
2024-09-01 22:03:32 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 25, 'embedding_model': 'RotE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-01 22:03:32 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-01 22:03:32 INFO     set_weight_link_or_dist: dist
2024-09-01 22:03:32 INFO     init_weight_inf_or_zero: inf
2024-09-01 22:03:32 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-01 22:03:32 INFO     Start Calculate the weight by Gauss kernel!
2024-09-01 22:03:32 INFO     Loading file CHITaxi20190406.dyna
2024-09-01 22:03:32 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-01 22:03:34 INFO     Dataset created
2024-09-01 22:03:34 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-01 22:03:34 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-01 22:03:34 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-01 22:03:34 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-01 22:03:34 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-01 22:03:34 INFO     NormalScaler max: 1.4623669798075165
2024-09-01 22:03:36 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-01 22:03:36 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-01 22:03:36 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-01 22:03:36 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 22:03:36 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-01 22:03:36 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 22:03:36 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-01 22:03:36 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 22:03:36 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-01 22:03:36 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 22:03:36 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-01 22:03:36 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-01 22:03:36 INFO     Total parameter numbers: 874010
2024-09-01 22:03:36 INFO     You select `adam` optimizer.
2024-09-01 22:03:36 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-01 22:03:36 INFO     Start training ...
2024-09-01 22:03:36 INFO     num_batches:48
2024-09-01 22:03:41 INFO     epoch complete!
2024-09-01 22:03:41 INFO     evaluating now!
2024-09-01 22:03:42 INFO     Epoch [0/200] train_loss: 24.4763, val_loss: 18.2820, lr: 0.003000, 5.37s
2024-09-01 22:03:42 INFO     Saved model at 0
2024-09-01 22:03:42 INFO     Val loss decrease from inf to 18.2820, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-01 22:03:46 INFO     epoch complete!
2024-09-01 22:03:46 INFO     evaluating now!
2024-09-01 22:03:47 INFO     Epoch [1/200] train_loss: 14.9390, val_loss: 14.3068, lr: 0.003000, 5.08s
2024-09-01 22:03:47 INFO     Saved model at 1
2024-09-01 22:03:47 INFO     Val loss decrease from 18.2820 to 14.3068, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-01 22:03:51 INFO     epoch complete!
2024-09-01 22:03:51 INFO     evaluating now!
2024-09-01 22:03:52 INFO     Epoch [2/200] train_loss: 11.6914, val_loss: 11.0833, lr: 0.003000, 5.07s
2024-09-01 22:03:52 INFO     Saved model at 2
2024-09-01 22:03:52 INFO     Val loss decrease from 14.3068 to 11.0833, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-01 22:03:57 INFO     epoch complete!
2024-09-01 22:03:57 INFO     evaluating now!
2024-09-01 22:03:57 INFO     Epoch [3/200] train_loss: 9.6155, val_loss: 9.3671, lr: 0.003000, 5.07s
2024-09-01 22:03:57 INFO     Saved model at 3
2024-09-01 22:03:57 INFO     Val loss decrease from 11.0833 to 9.3671, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-01 22:04:02 INFO     epoch complete!
2024-09-01 22:04:02 INFO     evaluating now!
2024-09-01 22:04:02 INFO     Epoch [4/200] train_loss: 8.4136, val_loss: 8.0697, lr: 0.003000, 5.08s
2024-09-01 22:04:02 INFO     Saved model at 4
2024-09-01 22:04:02 INFO     Val loss decrease from 9.3671 to 8.0697, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-01 22:04:07 INFO     epoch complete!
2024-09-01 22:04:07 INFO     evaluating now!
2024-09-01 22:04:07 INFO     Epoch [5/200] train_loss: 7.7308, val_loss: 7.3947, lr: 0.003000, 5.07s
2024-09-01 22:04:07 INFO     Saved model at 5
2024-09-01 22:04:07 INFO     Val loss decrease from 8.0697 to 7.3947, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-01 22:04:12 INFO     epoch complete!
2024-09-01 22:04:12 INFO     evaluating now!
2024-09-01 22:04:12 INFO     Epoch [6/200] train_loss: 7.2150, val_loss: 7.1603, lr: 0.003000, 5.07s
2024-09-01 22:04:12 INFO     Saved model at 6
2024-09-01 22:04:12 INFO     Val loss decrease from 7.3947 to 7.1603, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-01 22:04:17 INFO     epoch complete!
2024-09-01 22:04:17 INFO     evaluating now!
2024-09-01 22:04:17 INFO     Epoch [7/200] train_loss: 6.8114, val_loss: 6.9683, lr: 0.003000, 5.13s
2024-09-01 22:04:17 INFO     Saved model at 7
2024-09-01 22:04:17 INFO     Val loss decrease from 7.1603 to 6.9683, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-01 22:04:22 INFO     epoch complete!
2024-09-01 22:04:22 INFO     evaluating now!
2024-09-01 22:04:22 INFO     Epoch [8/200] train_loss: 6.5068, val_loss: 6.2269, lr: 0.003000, 5.13s
2024-09-01 22:04:22 INFO     Saved model at 8
2024-09-01 22:04:22 INFO     Val loss decrease from 6.9683 to 6.2269, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-01 22:04:27 INFO     epoch complete!
2024-09-01 22:04:27 INFO     evaluating now!
2024-09-01 22:04:27 INFO     Epoch [9/200] train_loss: 6.1150, val_loss: 6.3029, lr: 0.003000, 5.07s
2024-09-01 22:04:32 INFO     epoch complete!
2024-09-01 22:04:32 INFO     evaluating now!
2024-09-01 22:04:33 INFO     Epoch [10/200] train_loss: 5.9895, val_loss: 5.9708, lr: 0.003000, 5.07s
2024-09-01 22:04:33 INFO     Saved model at 10
2024-09-01 22:04:33 INFO     Val loss decrease from 6.2269 to 5.9708, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-01 22:04:37 INFO     epoch complete!
2024-09-01 22:04:37 INFO     evaluating now!
2024-09-01 22:04:38 INFO     Epoch [11/200] train_loss: 5.8658, val_loss: 6.0920, lr: 0.003000, 5.14s
2024-09-01 22:04:43 INFO     epoch complete!
2024-09-01 22:04:43 INFO     evaluating now!
2024-09-01 22:04:43 INFO     Epoch [12/200] train_loss: 5.7004, val_loss: 6.0176, lr: 0.003000, 5.25s
2024-09-01 22:04:48 INFO     epoch complete!
2024-09-01 22:04:48 INFO     evaluating now!
2024-09-01 22:04:48 INFO     Epoch [13/200] train_loss: 5.5718, val_loss: 5.8758, lr: 0.003000, 5.20s
2024-09-01 22:04:48 INFO     Saved model at 13
2024-09-01 22:04:48 INFO     Val loss decrease from 5.9708 to 5.8758, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-01 22:04:53 INFO     epoch complete!
2024-09-01 22:04:53 INFO     evaluating now!
2024-09-01 22:04:53 INFO     Epoch [14/200] train_loss: 5.4148, val_loss: 5.6281, lr: 0.003000, 5.07s
2024-09-01 22:04:53 INFO     Saved model at 14
2024-09-01 22:04:53 INFO     Val loss decrease from 5.8758 to 5.6281, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-01 22:04:58 INFO     epoch complete!
2024-09-01 22:04:58 INFO     evaluating now!
2024-09-01 22:04:58 INFO     Epoch [15/200] train_loss: 5.3843, val_loss: 5.6553, lr: 0.003000, 5.06s
2024-09-01 22:05:03 INFO     epoch complete!
2024-09-01 22:05:03 INFO     evaluating now!
2024-09-01 22:05:03 INFO     Epoch [16/200] train_loss: 5.2447, val_loss: 5.8434, lr: 0.003000, 5.08s
2024-09-01 22:05:08 INFO     epoch complete!
2024-09-01 22:05:08 INFO     evaluating now!
2024-09-01 22:05:09 INFO     Epoch [17/200] train_loss: 5.1217, val_loss: 5.4783, lr: 0.003000, 5.17s
2024-09-01 22:05:09 INFO     Saved model at 17
2024-09-01 22:05:09 INFO     Val loss decrease from 5.6281 to 5.4783, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-01 22:05:13 INFO     epoch complete!
2024-09-01 22:05:13 INFO     evaluating now!
2024-09-01 22:05:14 INFO     Epoch [18/200] train_loss: 5.0910, val_loss: 5.6992, lr: 0.003000, 5.15s
2024-09-01 22:05:19 INFO     epoch complete!
2024-09-01 22:05:19 INFO     evaluating now!
2024-09-01 22:05:19 INFO     Epoch [19/200] train_loss: 5.1950, val_loss: 5.6764, lr: 0.003000, 5.30s
2024-09-01 22:05:24 INFO     epoch complete!
2024-09-01 22:05:24 INFO     evaluating now!
2024-09-01 22:05:24 INFO     Epoch [20/200] train_loss: 4.9459, val_loss: 5.5635, lr: 0.003000, 5.25s
2024-09-01 22:05:29 INFO     epoch complete!
2024-09-01 22:05:29 INFO     evaluating now!
2024-09-01 22:05:29 INFO     Epoch [21/200] train_loss: 4.8157, val_loss: 5.5404, lr: 0.003000, 5.19s
2024-09-01 22:05:34 INFO     epoch complete!
2024-09-01 22:05:34 INFO     evaluating now!
2024-09-01 22:05:35 INFO     Epoch [22/200] train_loss: 4.7644, val_loss: 5.4172, lr: 0.003000, 5.23s
2024-09-01 22:05:35 INFO     Saved model at 22
2024-09-01 22:05:35 INFO     Val loss decrease from 5.4783 to 5.4172, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-01 22:05:40 INFO     epoch complete!
2024-09-01 22:05:40 INFO     evaluating now!
2024-09-01 22:05:40 INFO     Epoch [23/200] train_loss: 4.7789, val_loss: 5.4261, lr: 0.003000, 5.18s
2024-09-01 22:05:45 INFO     epoch complete!
2024-09-01 22:05:45 INFO     evaluating now!
2024-09-01 22:05:45 INFO     Epoch [24/200] train_loss: 4.7523, val_loss: 5.4993, lr: 0.003000, 5.43s
2024-09-01 22:05:50 INFO     epoch complete!
2024-09-01 22:05:50 INFO     evaluating now!
2024-09-01 22:05:51 INFO     Epoch [25/200] train_loss: 4.6255, val_loss: 5.4067, lr: 0.003000, 5.26s
2024-09-01 22:05:51 INFO     Saved model at 25
2024-09-01 22:05:51 INFO     Val loss decrease from 5.4172 to 5.4067, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-01 22:05:56 INFO     epoch complete!
2024-09-01 22:05:56 INFO     evaluating now!
2024-09-01 22:05:56 INFO     Epoch [26/200] train_loss: 4.5960, val_loss: 5.4033, lr: 0.003000, 5.50s
2024-09-01 22:05:56 INFO     Saved model at 26
2024-09-01 22:05:56 INFO     Val loss decrease from 5.4067 to 5.4033, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-01 22:06:01 INFO     epoch complete!
2024-09-01 22:06:01 INFO     evaluating now!
2024-09-01 22:06:01 INFO     Epoch [27/200] train_loss: 4.5690, val_loss: 5.4574, lr: 0.003000, 5.17s
2024-09-01 22:06:06 INFO     epoch complete!
2024-09-01 22:06:06 INFO     evaluating now!
2024-09-01 22:06:06 INFO     Epoch [28/200] train_loss: 4.7336, val_loss: 5.6576, lr: 0.003000, 5.10s
2024-09-01 22:06:11 INFO     epoch complete!
2024-09-01 22:06:11 INFO     evaluating now!
2024-09-01 22:06:11 INFO     Epoch [29/200] train_loss: 4.6520, val_loss: 5.3429, lr: 0.003000, 5.11s
2024-09-01 22:06:11 INFO     Saved model at 29
2024-09-01 22:06:11 INFO     Val loss decrease from 5.4033 to 5.3429, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-01 22:06:16 INFO     epoch complete!
2024-09-01 22:06:16 INFO     evaluating now!
2024-09-01 22:06:17 INFO     Epoch [30/200] train_loss: 4.4038, val_loss: 5.2733, lr: 0.003000, 5.09s
2024-09-01 22:06:17 INFO     Saved model at 30
2024-09-01 22:06:17 INFO     Val loss decrease from 5.3429 to 5.2733, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-09-01 22:06:21 INFO     epoch complete!
2024-09-01 22:06:21 INFO     evaluating now!
2024-09-01 22:06:22 INFO     Epoch [31/200] train_loss: 4.4333, val_loss: 5.4651, lr: 0.003000, 5.08s
2024-09-01 22:06:26 INFO     epoch complete!
2024-09-01 22:06:26 INFO     evaluating now!
2024-09-01 22:06:27 INFO     Epoch [32/200] train_loss: 4.4056, val_loss: 5.3015, lr: 0.003000, 5.11s
2024-09-01 22:06:32 INFO     epoch complete!
2024-09-01 22:06:32 INFO     evaluating now!
2024-09-01 22:06:32 INFO     Epoch [33/200] train_loss: 4.2974, val_loss: 5.1910, lr: 0.003000, 5.08s
2024-09-01 22:06:32 INFO     Saved model at 33
2024-09-01 22:06:32 INFO     Val loss decrease from 5.2733 to 5.1910, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-09-01 22:06:37 INFO     epoch complete!
2024-09-01 22:06:37 INFO     evaluating now!
2024-09-01 22:06:37 INFO     Epoch [34/200] train_loss: 4.2743, val_loss: 5.3577, lr: 0.003000, 5.09s
2024-09-01 22:06:42 INFO     epoch complete!
2024-09-01 22:06:42 INFO     evaluating now!
2024-09-01 22:06:42 INFO     Epoch [35/200] train_loss: 4.2149, val_loss: 5.1327, lr: 0.003000, 5.09s
2024-09-01 22:06:42 INFO     Saved model at 35
2024-09-01 22:06:42 INFO     Val loss decrease from 5.1910 to 5.1327, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-01 22:06:47 INFO     epoch complete!
2024-09-01 22:06:47 INFO     evaluating now!
2024-09-01 22:06:47 INFO     Epoch [36/200] train_loss: 4.3025, val_loss: 5.2238, lr: 0.003000, 5.09s
2024-09-01 22:06:52 INFO     epoch complete!
2024-09-01 22:06:52 INFO     evaluating now!
2024-09-01 22:06:52 INFO     Epoch [37/200] train_loss: 4.1964, val_loss: 5.0824, lr: 0.003000, 5.08s
2024-09-01 22:06:52 INFO     Saved model at 37
2024-09-01 22:06:52 INFO     Val loss decrease from 5.1327 to 5.0824, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-09-01 22:06:57 INFO     epoch complete!
2024-09-01 22:06:57 INFO     evaluating now!
2024-09-01 22:06:57 INFO     Epoch [38/200] train_loss: 4.1670, val_loss: 5.1201, lr: 0.003000, 5.10s
2024-09-01 22:07:02 INFO     epoch complete!
2024-09-01 22:07:02 INFO     evaluating now!
2024-09-01 22:07:02 INFO     Epoch [39/200] train_loss: 4.0872, val_loss: 5.2188, lr: 0.003000, 5.09s
2024-09-01 22:07:07 INFO     epoch complete!
2024-09-01 22:07:07 INFO     evaluating now!
2024-09-01 22:07:08 INFO     Epoch [40/200] train_loss: 4.0823, val_loss: 5.0644, lr: 0.003000, 5.09s
2024-09-01 22:07:08 INFO     Saved model at 40
2024-09-01 22:07:08 INFO     Val loss decrease from 5.0824 to 5.0644, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-09-01 22:07:12 INFO     epoch complete!
2024-09-01 22:07:12 INFO     evaluating now!
2024-09-01 22:07:13 INFO     Epoch [41/200] train_loss: 4.0726, val_loss: 5.2699, lr: 0.003000, 5.18s
2024-09-01 22:07:18 INFO     epoch complete!
2024-09-01 22:07:18 INFO     evaluating now!
2024-09-01 22:07:18 INFO     Epoch [42/200] train_loss: 4.0243, val_loss: 5.2297, lr: 0.003000, 5.16s
2024-09-01 22:07:23 INFO     epoch complete!
2024-09-01 22:07:23 INFO     evaluating now!
2024-09-01 22:07:23 INFO     Epoch [43/200] train_loss: 4.0342, val_loss: 5.2304, lr: 0.003000, 5.20s
2024-09-01 22:07:28 INFO     epoch complete!
2024-09-01 22:07:28 INFO     evaluating now!
2024-09-01 22:07:28 INFO     Epoch [44/200] train_loss: 4.0120, val_loss: 5.1825, lr: 0.003000, 5.16s
2024-09-01 22:07:33 INFO     epoch complete!
2024-09-01 22:07:33 INFO     evaluating now!
2024-09-01 22:07:33 INFO     Epoch [45/200] train_loss: 4.0699, val_loss: 5.1296, lr: 0.003000, 5.15s
2024-09-01 22:07:38 INFO     epoch complete!
2024-09-01 22:07:38 INFO     evaluating now!
2024-09-01 22:07:38 INFO     Epoch [46/200] train_loss: 3.9352, val_loss: 5.4340, lr: 0.003000, 5.08s
2024-09-01 22:07:43 INFO     epoch complete!
2024-09-01 22:07:43 INFO     evaluating now!
2024-09-01 22:07:44 INFO     Epoch [47/200] train_loss: 3.9284, val_loss: 5.2045, lr: 0.003000, 5.09s
2024-09-01 22:07:48 INFO     epoch complete!
2024-09-01 22:07:48 INFO     evaluating now!
2024-09-01 22:07:49 INFO     Epoch [48/200] train_loss: 3.9239, val_loss: 5.1935, lr: 0.003000, 5.20s
2024-09-01 22:07:54 INFO     epoch complete!
2024-09-01 22:07:54 INFO     evaluating now!
2024-09-01 22:07:54 INFO     Epoch [49/200] train_loss: 3.8665, val_loss: 5.1739, lr: 0.003000, 5.21s
2024-09-01 22:07:59 INFO     epoch complete!
2024-09-01 22:07:59 INFO     evaluating now!
2024-09-01 22:07:59 INFO     Epoch [50/200] train_loss: 3.8375, val_loss: 5.1561, lr: 0.003000, 5.11s
2024-09-01 22:08:04 INFO     epoch complete!
2024-09-01 22:08:04 INFO     evaluating now!
2024-09-01 22:08:04 INFO     Epoch [51/200] train_loss: 3.8406, val_loss: 5.3579, lr: 0.003000, 5.11s
2024-09-01 22:08:09 INFO     epoch complete!
2024-09-01 22:08:09 INFO     evaluating now!
2024-09-01 22:08:09 INFO     Epoch [52/200] train_loss: 3.7986, val_loss: 5.2445, lr: 0.003000, 5.14s
2024-09-01 22:08:14 INFO     epoch complete!
2024-09-01 22:08:14 INFO     evaluating now!
2024-09-01 22:08:15 INFO     Epoch [53/200] train_loss: 3.7645, val_loss: 5.1394, lr: 0.003000, 5.20s
2024-09-01 22:08:19 INFO     epoch complete!
2024-09-01 22:08:19 INFO     evaluating now!
2024-09-01 22:08:20 INFO     Epoch [54/200] train_loss: 3.8361, val_loss: 5.2680, lr: 0.003000, 5.17s
2024-09-01 22:08:24 INFO     epoch complete!
2024-09-01 22:08:24 INFO     evaluating now!
2024-09-01 22:08:25 INFO     Epoch [55/200] train_loss: 3.8367, val_loss: 5.1814, lr: 0.003000, 5.07s
2024-09-01 22:08:25 WARNING  Early stopping at epoch: 55
2024-09-01 22:08:25 INFO     Trained totally 56 epochs, average train time is 4.841s, average eval time is 0.307s
2024-09-01 22:08:25 INFO     Loaded model at 40
2024-09-01 22:08:25 INFO     Saved model at ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406.m
2024-09-01 22:08:25 INFO     Start evaluating ...
2024-09-01 22:08:26 INFO     Note that you select the single mode to evaluate!
2024-09-01 22:08:26 INFO     Evaluate result is saved at ./libcity/cache/25/evaluate_cache\2024_09_01_22_08_26_AGCRN_CHITaxi20190406.csv
2024-09-01 22:08:26 INFO     
         MAE       RMSE
1   2.436808   7.006683
2   2.454747   7.558019
3   2.609855   8.790053
4   2.851259   9.989300
5   3.009890  10.977151
6   3.100454  11.863024
7   3.241621  12.380005
8   3.313925  12.697148
9   3.358490  12.922129
10  3.371191  13.182412
11  3.432573  13.618939
12  3.596328  14.571195
2024-09-01 22:08:26 INFO     ----------------------------------------------------------------------------
2024-09-01 22:08:26 INFO     # 4, Kownledge Graph Embedding: RotE, Experiment ids: 29
2024-09-01 22:08:26 INFO     ----------------------------------------------------------------------------
2024-09-01 22:08:26 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=25
2024-09-01 22:08:26 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 25, 'embedding_model': 'RotE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-01 22:08:26 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-01 22:08:26 INFO     set_weight_link_or_dist: dist
2024-09-01 22:08:26 INFO     init_weight_inf_or_zero: inf
2024-09-01 22:08:26 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-01 22:08:26 INFO     Start Calculate the weight by Gauss kernel!
2024-09-01 22:08:26 INFO     Loading file CHITaxi20190406.dyna
2024-09-01 22:08:26 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-01 22:08:28 INFO     Dataset created
2024-09-01 22:08:28 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-01 22:08:28 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-01 22:08:28 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-01 22:08:28 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-01 22:08:28 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-01 22:08:28 INFO     NormalScaler max: 1.4623669798075165
2024-09-01 22:08:30 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-01 22:08:30 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-01 22:08:30 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-01 22:08:30 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 22:08:30 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-01 22:08:30 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 22:08:30 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-01 22:08:30 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 22:08:30 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-01 22:08:30 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 22:08:30 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-01 22:08:30 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-01 22:08:30 INFO     Total parameter numbers: 874010
2024-09-01 22:08:30 INFO     You select `adam` optimizer.
2024-09-01 22:08:30 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-01 22:08:30 INFO     Start training ...
2024-09-01 22:08:30 INFO     num_batches:48
2024-09-01 22:08:35 INFO     epoch complete!
2024-09-01 22:08:35 INFO     evaluating now!
2024-09-01 22:08:35 INFO     Epoch [0/200] train_loss: 23.7413, val_loss: 18.2168, lr: 0.003000, 5.36s
2024-09-01 22:08:35 INFO     Saved model at 0
2024-09-01 22:08:35 INFO     Val loss decrease from inf to 18.2168, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-01 22:08:40 INFO     epoch complete!
2024-09-01 22:08:40 INFO     evaluating now!
2024-09-01 22:08:40 INFO     Epoch [1/200] train_loss: 15.2008, val_loss: 14.6941, lr: 0.003000, 5.08s
2024-09-01 22:08:40 INFO     Saved model at 1
2024-09-01 22:08:40 INFO     Val loss decrease from 18.2168 to 14.6941, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-01 22:08:45 INFO     epoch complete!
2024-09-01 22:08:45 INFO     evaluating now!
2024-09-01 22:08:45 INFO     Epoch [2/200] train_loss: 12.2291, val_loss: 11.5313, lr: 0.003000, 5.08s
2024-09-01 22:08:45 INFO     Saved model at 2
2024-09-01 22:08:45 INFO     Val loss decrease from 14.6941 to 11.5313, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-01 22:08:50 INFO     epoch complete!
2024-09-01 22:08:50 INFO     evaluating now!
2024-09-01 22:08:50 INFO     Epoch [3/200] train_loss: 9.8972, val_loss: 9.2665, lr: 0.003000, 5.08s
2024-09-01 22:08:50 INFO     Saved model at 3
2024-09-01 22:08:50 INFO     Val loss decrease from 11.5313 to 9.2665, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-01 22:08:55 INFO     epoch complete!
2024-09-01 22:08:55 INFO     evaluating now!
2024-09-01 22:08:55 INFO     Epoch [4/200] train_loss: 8.4769, val_loss: 8.0756, lr: 0.003000, 5.08s
2024-09-01 22:08:55 INFO     Saved model at 4
2024-09-01 22:08:55 INFO     Val loss decrease from 9.2665 to 8.0756, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-01 22:09:00 INFO     epoch complete!
2024-09-01 22:09:00 INFO     evaluating now!
2024-09-01 22:09:01 INFO     Epoch [5/200] train_loss: 7.5156, val_loss: 7.3868, lr: 0.003000, 5.08s
2024-09-01 22:09:01 INFO     Saved model at 5
2024-09-01 22:09:01 INFO     Val loss decrease from 8.0756 to 7.3868, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-01 22:09:05 INFO     epoch complete!
2024-09-01 22:09:05 INFO     evaluating now!
2024-09-01 22:09:06 INFO     Epoch [6/200] train_loss: 7.1167, val_loss: 6.7870, lr: 0.003000, 5.08s
2024-09-01 22:09:06 INFO     Saved model at 6
2024-09-01 22:09:06 INFO     Val loss decrease from 7.3868 to 6.7870, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-01 22:09:10 INFO     epoch complete!
2024-09-01 22:09:10 INFO     evaluating now!
2024-09-01 22:09:11 INFO     Epoch [7/200] train_loss: 6.6213, val_loss: 6.5796, lr: 0.003000, 5.08s
2024-09-01 22:09:11 INFO     Saved model at 7
2024-09-01 22:09:11 INFO     Val loss decrease from 6.7870 to 6.5796, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-01 22:09:16 INFO     epoch complete!
2024-09-01 22:09:16 INFO     evaluating now!
2024-09-01 22:09:16 INFO     Epoch [8/200] train_loss: 6.3754, val_loss: 6.7508, lr: 0.003000, 5.08s
2024-09-01 22:09:21 INFO     epoch complete!
2024-09-01 22:09:21 INFO     evaluating now!
2024-09-01 22:09:21 INFO     Epoch [9/200] train_loss: 6.1395, val_loss: 6.2198, lr: 0.003000, 5.08s
2024-09-01 22:09:21 INFO     Saved model at 9
2024-09-01 22:09:21 INFO     Val loss decrease from 6.5796 to 6.2198, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-01 22:09:26 INFO     epoch complete!
2024-09-01 22:09:26 INFO     evaluating now!
2024-09-01 22:09:26 INFO     Epoch [10/200] train_loss: 5.8500, val_loss: 5.9450, lr: 0.003000, 5.07s
2024-09-01 22:09:26 INFO     Saved model at 10
2024-09-01 22:09:26 INFO     Val loss decrease from 6.2198 to 5.9450, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-01 22:09:31 INFO     epoch complete!
2024-09-01 22:09:31 INFO     evaluating now!
2024-09-01 22:09:31 INFO     Epoch [11/200] train_loss: 5.7298, val_loss: 5.9630, lr: 0.003000, 5.08s
2024-09-01 22:09:36 INFO     epoch complete!
2024-09-01 22:09:36 INFO     evaluating now!
2024-09-01 22:09:36 INFO     Epoch [12/200] train_loss: 5.6190, val_loss: 6.3209, lr: 0.003000, 5.08s
2024-09-01 22:09:41 INFO     epoch complete!
2024-09-01 22:09:41 INFO     evaluating now!
2024-09-01 22:09:41 INFO     Epoch [13/200] train_loss: 5.5620, val_loss: 5.8061, lr: 0.003000, 5.07s
2024-09-01 22:09:41 INFO     Saved model at 13
2024-09-01 22:09:41 INFO     Val loss decrease from 5.9450 to 5.8061, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-01 22:09:46 INFO     epoch complete!
2024-09-01 22:09:46 INFO     evaluating now!
2024-09-01 22:09:46 INFO     Epoch [14/200] train_loss: 5.4352, val_loss: 5.7799, lr: 0.003000, 5.08s
2024-09-01 22:09:46 INFO     Saved model at 14
2024-09-01 22:09:46 INFO     Val loss decrease from 5.8061 to 5.7799, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-01 22:09:51 INFO     epoch complete!
2024-09-01 22:09:51 INFO     evaluating now!
2024-09-01 22:09:51 INFO     Epoch [15/200] train_loss: 5.3183, val_loss: 5.8117, lr: 0.003000, 5.08s
2024-09-01 22:09:56 INFO     epoch complete!
2024-09-01 22:09:56 INFO     evaluating now!
2024-09-01 22:09:57 INFO     Epoch [16/200] train_loss: 5.2247, val_loss: 5.7719, lr: 0.003000, 5.08s
2024-09-01 22:09:57 INFO     Saved model at 16
2024-09-01 22:09:57 INFO     Val loss decrease from 5.7799 to 5.7719, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-01 22:10:01 INFO     epoch complete!
2024-09-01 22:10:01 INFO     evaluating now!
2024-09-01 22:10:02 INFO     Epoch [17/200] train_loss: 5.1243, val_loss: 5.4932, lr: 0.003000, 5.14s
2024-09-01 22:10:02 INFO     Saved model at 17
2024-09-01 22:10:02 INFO     Val loss decrease from 5.7719 to 5.4932, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-01 22:10:06 INFO     epoch complete!
2024-09-01 22:10:06 INFO     evaluating now!
2024-09-01 22:10:07 INFO     Epoch [18/200] train_loss: 4.9858, val_loss: 5.4463, lr: 0.003000, 5.08s
2024-09-01 22:10:07 INFO     Saved model at 18
2024-09-01 22:10:07 INFO     Val loss decrease from 5.4932 to 5.4463, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-01 22:10:12 INFO     epoch complete!
2024-09-01 22:10:12 INFO     evaluating now!
2024-09-01 22:10:12 INFO     Epoch [19/200] train_loss: 4.9508, val_loss: 5.5455, lr: 0.003000, 5.08s
2024-09-01 22:10:17 INFO     epoch complete!
2024-09-01 22:10:17 INFO     evaluating now!
2024-09-01 22:10:17 INFO     Epoch [20/200] train_loss: 4.9500, val_loss: 5.8376, lr: 0.003000, 5.08s
2024-09-01 22:10:22 INFO     epoch complete!
2024-09-01 22:10:22 INFO     evaluating now!
2024-09-01 22:10:22 INFO     Epoch [21/200] train_loss: 4.9193, val_loss: 5.4676, lr: 0.003000, 5.08s
2024-09-01 22:10:27 INFO     epoch complete!
2024-09-01 22:10:27 INFO     evaluating now!
2024-09-01 22:10:27 INFO     Epoch [22/200] train_loss: 4.8597, val_loss: 5.3753, lr: 0.003000, 5.08s
2024-09-01 22:10:27 INFO     Saved model at 22
2024-09-01 22:10:27 INFO     Val loss decrease from 5.4463 to 5.3753, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-01 22:10:32 INFO     epoch complete!
2024-09-01 22:10:32 INFO     evaluating now!
2024-09-01 22:10:32 INFO     Epoch [23/200] train_loss: 4.7545, val_loss: 5.3631, lr: 0.003000, 5.08s
2024-09-01 22:10:32 INFO     Saved model at 23
2024-09-01 22:10:32 INFO     Val loss decrease from 5.3753 to 5.3631, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-01 22:10:37 INFO     epoch complete!
2024-09-01 22:10:37 INFO     evaluating now!
2024-09-01 22:10:37 INFO     Epoch [24/200] train_loss: 4.6778, val_loss: 5.3848, lr: 0.003000, 5.08s
2024-09-01 22:10:42 INFO     epoch complete!
2024-09-01 22:10:42 INFO     evaluating now!
2024-09-01 22:10:42 INFO     Epoch [25/200] train_loss: 4.6377, val_loss: 5.3285, lr: 0.003000, 5.06s
2024-09-01 22:10:42 INFO     Saved model at 25
2024-09-01 22:10:42 INFO     Val loss decrease from 5.3631 to 5.3285, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-01 22:10:47 INFO     epoch complete!
2024-09-01 22:10:47 INFO     evaluating now!
2024-09-01 22:10:47 INFO     Epoch [26/200] train_loss: 4.5708, val_loss: 5.5305, lr: 0.003000, 5.12s
2024-09-01 22:10:52 INFO     epoch complete!
2024-09-01 22:10:52 INFO     evaluating now!
2024-09-01 22:10:53 INFO     Epoch [27/200] train_loss: 4.5635, val_loss: 5.3152, lr: 0.003000, 5.14s
2024-09-01 22:10:53 INFO     Saved model at 27
2024-09-01 22:10:53 INFO     Val loss decrease from 5.3285 to 5.3152, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-01 22:10:57 INFO     epoch complete!
2024-09-01 22:10:57 INFO     evaluating now!
2024-09-01 22:10:58 INFO     Epoch [28/200] train_loss: 4.4851, val_loss: 5.4670, lr: 0.003000, 5.08s
2024-09-01 22:11:02 INFO     epoch complete!
2024-09-01 22:11:02 INFO     evaluating now!
2024-09-01 22:11:03 INFO     Epoch [29/200] train_loss: 4.4406, val_loss: 5.2888, lr: 0.003000, 5.06s
2024-09-01 22:11:03 INFO     Saved model at 29
2024-09-01 22:11:03 INFO     Val loss decrease from 5.3152 to 5.2888, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-01 22:11:08 INFO     epoch complete!
2024-09-01 22:11:08 INFO     evaluating now!
2024-09-01 22:11:08 INFO     Epoch [30/200] train_loss: 4.4324, val_loss: 5.0959, lr: 0.003000, 5.06s
2024-09-01 22:11:08 INFO     Saved model at 30
2024-09-01 22:11:08 INFO     Val loss decrease from 5.2888 to 5.0959, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-09-01 22:11:13 INFO     epoch complete!
2024-09-01 22:11:13 INFO     evaluating now!
2024-09-01 22:11:13 INFO     Epoch [31/200] train_loss: 4.3512, val_loss: 5.3087, lr: 0.003000, 5.06s
2024-09-01 22:11:18 INFO     epoch complete!
2024-09-01 22:11:18 INFO     evaluating now!
2024-09-01 22:11:18 INFO     Epoch [32/200] train_loss: 4.3152, val_loss: 5.3983, lr: 0.003000, 5.06s
2024-09-01 22:11:23 INFO     epoch complete!
2024-09-01 22:11:23 INFO     evaluating now!
2024-09-01 22:11:23 INFO     Epoch [33/200] train_loss: 4.2837, val_loss: 5.2228, lr: 0.003000, 5.07s
2024-09-01 22:11:28 INFO     epoch complete!
2024-09-01 22:11:28 INFO     evaluating now!
2024-09-01 22:11:28 INFO     Epoch [34/200] train_loss: 4.2679, val_loss: 5.2448, lr: 0.003000, 5.20s
2024-09-01 22:11:33 INFO     epoch complete!
2024-09-01 22:11:33 INFO     evaluating now!
2024-09-01 22:11:34 INFO     Epoch [35/200] train_loss: 4.2069, val_loss: 5.0637, lr: 0.003000, 5.34s
2024-09-01 22:11:34 INFO     Saved model at 35
2024-09-01 22:11:34 INFO     Val loss decrease from 5.0959 to 5.0637, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-01 22:11:39 INFO     epoch complete!
2024-09-01 22:11:39 INFO     evaluating now!
2024-09-01 22:11:39 INFO     Epoch [36/200] train_loss: 4.1748, val_loss: 5.3605, lr: 0.003000, 5.36s
2024-09-01 22:11:44 INFO     epoch complete!
2024-09-01 22:11:44 INFO     evaluating now!
2024-09-01 22:11:44 INFO     Epoch [37/200] train_loss: 4.1308, val_loss: 5.2812, lr: 0.003000, 5.24s
2024-09-01 22:11:49 INFO     epoch complete!
2024-09-01 22:11:49 INFO     evaluating now!
2024-09-01 22:11:49 INFO     Epoch [38/200] train_loss: 4.1514, val_loss: 5.1415, lr: 0.003000, 5.20s
2024-09-01 22:11:54 INFO     epoch complete!
2024-09-01 22:11:54 INFO     evaluating now!
2024-09-01 22:11:55 INFO     Epoch [39/200] train_loss: 4.0991, val_loss: 5.3815, lr: 0.003000, 5.12s
2024-09-01 22:11:59 INFO     epoch complete!
2024-09-01 22:11:59 INFO     evaluating now!
2024-09-01 22:12:00 INFO     Epoch [40/200] train_loss: 4.0746, val_loss: 5.2955, lr: 0.003000, 5.04s
2024-09-01 22:12:04 INFO     epoch complete!
2024-09-01 22:12:04 INFO     evaluating now!
2024-09-01 22:12:05 INFO     Epoch [41/200] train_loss: 4.0353, val_loss: 5.2747, lr: 0.003000, 5.04s
2024-09-01 22:12:09 INFO     epoch complete!
2024-09-01 22:12:09 INFO     evaluating now!
2024-09-01 22:12:10 INFO     Epoch [42/200] train_loss: 4.0640, val_loss: 5.2415, lr: 0.003000, 5.04s
2024-09-01 22:12:14 INFO     epoch complete!
2024-09-01 22:12:14 INFO     evaluating now!
2024-09-01 22:12:15 INFO     Epoch [43/200] train_loss: 4.0426, val_loss: 5.3279, lr: 0.003000, 5.04s
2024-09-01 22:12:19 INFO     epoch complete!
2024-09-01 22:12:19 INFO     evaluating now!
2024-09-01 22:12:20 INFO     Epoch [44/200] train_loss: 4.0038, val_loss: 5.2152, lr: 0.003000, 5.05s
2024-09-01 22:12:24 INFO     epoch complete!
2024-09-01 22:12:24 INFO     evaluating now!
2024-09-01 22:12:25 INFO     Epoch [45/200] train_loss: 3.9048, val_loss: 5.3042, lr: 0.003000, 5.04s
2024-09-01 22:12:29 INFO     epoch complete!
2024-09-01 22:12:29 INFO     evaluating now!
2024-09-01 22:12:30 INFO     Epoch [46/200] train_loss: 3.9306, val_loss: 5.2666, lr: 0.003000, 5.04s
2024-09-01 22:12:35 INFO     epoch complete!
2024-09-01 22:12:35 INFO     evaluating now!
2024-09-01 22:12:35 INFO     Epoch [47/200] train_loss: 3.8657, val_loss: 5.1836, lr: 0.003000, 5.04s
2024-09-01 22:12:40 INFO     epoch complete!
2024-09-01 22:12:40 INFO     evaluating now!
2024-09-01 22:12:40 INFO     Epoch [48/200] train_loss: 3.8991, val_loss: 5.2261, lr: 0.003000, 5.04s
2024-09-01 22:12:45 INFO     epoch complete!
2024-09-01 22:12:45 INFO     evaluating now!
2024-09-01 22:12:45 INFO     Epoch [49/200] train_loss: 3.8907, val_loss: 5.0303, lr: 0.003000, 5.04s
2024-09-01 22:12:45 INFO     Saved model at 49
2024-09-01 22:12:45 INFO     Val loss decrease from 5.0637 to 5.0303, saving to ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-09-01 22:12:50 INFO     epoch complete!
2024-09-01 22:12:50 INFO     evaluating now!
2024-09-01 22:12:50 INFO     Epoch [50/200] train_loss: 3.9454, val_loss: 5.1229, lr: 0.003000, 5.04s
2024-09-01 22:12:55 INFO     epoch complete!
2024-09-01 22:12:55 INFO     evaluating now!
2024-09-01 22:12:55 INFO     Epoch [51/200] train_loss: 3.8683, val_loss: 5.1111, lr: 0.003000, 5.04s
2024-09-01 22:13:00 INFO     epoch complete!
2024-09-01 22:13:00 INFO     evaluating now!
2024-09-01 22:13:00 INFO     Epoch [52/200] train_loss: 3.7851, val_loss: 5.3369, lr: 0.003000, 5.04s
2024-09-01 22:13:05 INFO     epoch complete!
2024-09-01 22:13:05 INFO     evaluating now!
2024-09-01 22:13:05 INFO     Epoch [53/200] train_loss: 3.7266, val_loss: 5.1667, lr: 0.003000, 5.04s
2024-09-01 22:13:10 INFO     epoch complete!
2024-09-01 22:13:10 INFO     evaluating now!
2024-09-01 22:13:10 INFO     Epoch [54/200] train_loss: 3.7625, val_loss: 5.3606, lr: 0.003000, 5.04s
2024-09-01 22:13:15 INFO     epoch complete!
2024-09-01 22:13:15 INFO     evaluating now!
2024-09-01 22:13:15 INFO     Epoch [55/200] train_loss: 3.7288, val_loss: 5.1388, lr: 0.003000, 5.04s
2024-09-01 22:13:20 INFO     epoch complete!
2024-09-01 22:13:20 INFO     evaluating now!
2024-09-01 22:13:20 INFO     Epoch [56/200] train_loss: 3.7192, val_loss: 5.1660, lr: 0.003000, 5.03s
2024-09-01 22:13:25 INFO     epoch complete!
2024-09-01 22:13:25 INFO     evaluating now!
2024-09-01 22:13:25 INFO     Epoch [57/200] train_loss: 3.6971, val_loss: 5.1321, lr: 0.003000, 5.03s
2024-09-01 22:13:30 INFO     epoch complete!
2024-09-01 22:13:30 INFO     evaluating now!
2024-09-01 22:13:30 INFO     Epoch [58/200] train_loss: 3.7005, val_loss: 5.3490, lr: 0.003000, 5.03s
2024-09-01 22:13:35 INFO     epoch complete!
2024-09-01 22:13:35 INFO     evaluating now!
2024-09-01 22:13:35 INFO     Epoch [59/200] train_loss: 3.6755, val_loss: 5.0672, lr: 0.003000, 5.03s
2024-09-01 22:13:40 INFO     epoch complete!
2024-09-01 22:13:40 INFO     evaluating now!
2024-09-01 22:13:40 INFO     Epoch [60/200] train_loss: 3.6345, val_loss: 5.1259, lr: 0.003000, 5.03s
2024-09-01 22:13:45 INFO     epoch complete!
2024-09-01 22:13:45 INFO     evaluating now!
2024-09-01 22:13:45 INFO     Epoch [61/200] train_loss: 3.6370, val_loss: 5.2960, lr: 0.003000, 5.08s
2024-09-01 22:13:50 INFO     epoch complete!
2024-09-01 22:13:50 INFO     evaluating now!
2024-09-01 22:13:51 INFO     Epoch [62/200] train_loss: 3.6152, val_loss: 5.0405, lr: 0.003000, 5.23s
2024-09-01 22:13:55 INFO     epoch complete!
2024-09-01 22:13:55 INFO     evaluating now!
2024-09-01 22:13:56 INFO     Epoch [63/200] train_loss: 3.6312, val_loss: 5.2098, lr: 0.003000, 5.15s
2024-09-01 22:14:01 INFO     epoch complete!
2024-09-01 22:14:01 INFO     evaluating now!
2024-09-01 22:14:01 INFO     Epoch [64/200] train_loss: 3.6221, val_loss: 5.1470, lr: 0.003000, 5.16s
2024-09-01 22:14:01 WARNING  Early stopping at epoch: 64
2024-09-01 22:14:01 INFO     Trained totally 65 epochs, average train time is 4.785s, average eval time is 0.305s
2024-09-01 22:14:01 INFO     Loaded model at 49
2024-09-01 22:14:01 INFO     Saved model at ./libcity/cache/25/model_cache/AGCRN_CHITaxi20190406.m
2024-09-01 22:14:01 INFO     Start evaluating ...
2024-09-01 22:14:02 INFO     Note that you select the single mode to evaluate!
2024-09-01 22:14:02 INFO     Evaluate result is saved at ./libcity/cache/25/evaluate_cache\2024_09_01_22_14_02_AGCRN_CHITaxi20190406.csv
2024-09-01 22:14:02 INFO     
         MAE       RMSE
1   2.370921   7.606756
2   2.453839   8.043470
3   2.646333   8.787028
4   2.736738   9.375538
5   2.797786  10.028641
6   3.064707  10.838927
7   3.167978  11.666952
8   3.198321  12.363548
9   3.307063  12.912666
10  3.311852  13.216637
11  3.381185  13.513662
12  3.476960  13.980081
2024-09-01 22:14:02 INFO     ----------------------------------------------------------------------------
2024-09-01 22:14:02 INFO     Kownledge Graph Embedding: RotE, Experiment ids: [25, 26, 27, 28, 29]
2024-09-01 22:14:02 INFO     ----------------------------------------------------------------------------
2024-09-01 22:14:02 INFO     Average: 
         MAE       RMSE
0   2.433212   7.471864
1   2.480109   7.883775
2   2.644578   8.791092
3   2.814460   9.600318
4   2.938669  10.482232
5   3.095336  11.367319
6   3.203440  12.134372
7   3.299666  12.698934
8   3.340491  13.122644
9   3.377572  13.446668
10  3.461097  13.936688
11  3.595443  14.746888 
2024-09-01 22:14:02 INFO     Standard deviation: 
         MAE      RMSE
0   0.072813  0.243654
1   0.078174  0.169992
2   0.076806  0.107468
3   0.082489  0.318613
4   0.128904  0.550761
5   0.130828  0.687718
6   0.151234  0.704000
7   0.155352  0.603178
8   0.151379  0.499606
9   0.149010  0.390272
10  0.168634  0.402142
11  0.142325  0.530205
2024-09-01 22:14:02 INFO     ----------------------------------------------------------------------------
2024-09-01 22:14:02 INFO     12 steps Average: 
        MAE       RMSE
0  3.057006  11.306899
2024-09-01 22:14:02 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.123996  0.433967
