2024-09-01 22:17:58 INFO     Saving logs in: ./logs/CHITaxi20190406\AGCRN\ExtSpace\RotH
2024-09-01 22:17:58 INFO     ----------------------------------------------------------------------------
2024-09-01 22:17:58 INFO     # 0, Kownledge Graph Embedding: RotH, Experiment ids: 30
2024-09-01 22:17:58 INFO     ----------------------------------------------------------------------------
2024-09-01 22:17:58 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=30
2024-09-01 22:17:58 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 30, 'embedding_model': 'RotH', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-01 22:17:58 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-01 22:17:58 INFO     set_weight_link_or_dist: dist
2024-09-01 22:17:58 INFO     init_weight_inf_or_zero: inf
2024-09-01 22:17:58 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-01 22:17:58 INFO     Start Calculate the weight by Gauss kernel!
2024-09-01 22:17:58 INFO     Loading file CHITaxi20190406.dyna
2024-09-01 22:17:58 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-01 22:18:00 INFO     Dataset created
2024-09-01 22:18:00 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-01 22:18:00 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-01 22:18:00 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-01 22:18:00 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-01 22:18:00 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-01 22:18:00 INFO     NormalScaler max: 0.44321246163773476
2024-09-01 22:18:03 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-01 22:18:03 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-01 22:18:03 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-01 22:18:03 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 22:18:03 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-01 22:18:03 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 22:18:03 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-01 22:18:03 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 22:18:03 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-01 22:18:03 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 22:18:03 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-01 22:18:03 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-01 22:18:03 INFO     Total parameter numbers: 874010
2024-09-01 22:18:03 INFO     You select `adam` optimizer.
2024-09-01 22:18:03 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-01 22:18:03 INFO     Start training ...
2024-09-01 22:18:03 INFO     num_batches:48
2024-09-01 22:18:10 INFO     epoch complete!
2024-09-01 22:18:10 INFO     evaluating now!
2024-09-01 22:18:10 INFO     Epoch [0/200] train_loss: 24.2337, val_loss: 18.7019, lr: 0.003000, 6.62s
2024-09-01 22:18:10 INFO     Saved model at 0
2024-09-01 22:18:10 INFO     Val loss decrease from inf to 18.7019, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-01 22:18:15 INFO     epoch complete!
2024-09-01 22:18:15 INFO     evaluating now!
2024-09-01 22:18:15 INFO     Epoch [1/200] train_loss: 15.3165, val_loss: 14.8244, lr: 0.003000, 5.04s
2024-09-01 22:18:15 INFO     Saved model at 1
2024-09-01 22:18:15 INFO     Val loss decrease from 18.7019 to 14.8244, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-01 22:18:20 INFO     epoch complete!
2024-09-01 22:18:20 INFO     evaluating now!
2024-09-01 22:18:20 INFO     Epoch [2/200] train_loss: 12.5759, val_loss: 12.1277, lr: 0.003000, 5.03s
2024-09-01 22:18:20 INFO     Saved model at 2
2024-09-01 22:18:20 INFO     Val loss decrease from 14.8244 to 12.1277, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-01 22:18:25 INFO     epoch complete!
2024-09-01 22:18:25 INFO     evaluating now!
2024-09-01 22:18:25 INFO     Epoch [3/200] train_loss: 10.5118, val_loss: 10.1891, lr: 0.003000, 5.06s
2024-09-01 22:18:25 INFO     Saved model at 3
2024-09-01 22:18:25 INFO     Val loss decrease from 12.1277 to 10.1891, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-01 22:18:30 INFO     epoch complete!
2024-09-01 22:18:30 INFO     evaluating now!
2024-09-01 22:18:30 INFO     Epoch [4/200] train_loss: 8.9987, val_loss: 8.5841, lr: 0.003000, 5.13s
2024-09-01 22:18:30 INFO     Saved model at 4
2024-09-01 22:18:30 INFO     Val loss decrease from 10.1891 to 8.5841, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-01 22:18:35 INFO     epoch complete!
2024-09-01 22:18:35 INFO     evaluating now!
2024-09-01 22:18:35 INFO     Epoch [5/200] train_loss: 8.1582, val_loss: 7.6862, lr: 0.003000, 5.17s
2024-09-01 22:18:36 INFO     Saved model at 5
2024-09-01 22:18:36 INFO     Val loss decrease from 8.5841 to 7.6862, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-01 22:18:40 INFO     epoch complete!
2024-09-01 22:18:40 INFO     evaluating now!
2024-09-01 22:18:41 INFO     Epoch [6/200] train_loss: 7.3990, val_loss: 7.4302, lr: 0.003000, 5.14s
2024-09-01 22:18:41 INFO     Saved model at 6
2024-09-01 22:18:41 INFO     Val loss decrease from 7.6862 to 7.4302, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-01 22:18:46 INFO     epoch complete!
2024-09-01 22:18:46 INFO     evaluating now!
2024-09-01 22:18:46 INFO     Epoch [7/200] train_loss: 6.9225, val_loss: 6.8903, lr: 0.003000, 5.17s
2024-09-01 22:18:46 INFO     Saved model at 7
2024-09-01 22:18:46 INFO     Val loss decrease from 7.4302 to 6.8903, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-01 22:18:51 INFO     epoch complete!
2024-09-01 22:18:51 INFO     evaluating now!
2024-09-01 22:18:51 INFO     Epoch [8/200] train_loss: 6.5744, val_loss: 6.7703, lr: 0.003000, 5.15s
2024-09-01 22:18:51 INFO     Saved model at 8
2024-09-01 22:18:51 INFO     Val loss decrease from 6.8903 to 6.7703, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-01 22:18:56 INFO     epoch complete!
2024-09-01 22:18:56 INFO     evaluating now!
2024-09-01 22:18:56 INFO     Epoch [9/200] train_loss: 6.3504, val_loss: 6.4434, lr: 0.003000, 5.18s
2024-09-01 22:18:56 INFO     Saved model at 9
2024-09-01 22:18:56 INFO     Val loss decrease from 6.7703 to 6.4434, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-01 22:19:01 INFO     epoch complete!
2024-09-01 22:19:01 INFO     evaluating now!
2024-09-01 22:19:01 INFO     Epoch [10/200] train_loss: 6.0476, val_loss: 6.1770, lr: 0.003000, 5.16s
2024-09-01 22:19:01 INFO     Saved model at 10
2024-09-01 22:19:01 INFO     Val loss decrease from 6.4434 to 6.1770, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-01 22:19:06 INFO     epoch complete!
2024-09-01 22:19:06 INFO     evaluating now!
2024-09-01 22:19:07 INFO     Epoch [11/200] train_loss: 5.8886, val_loss: 6.1752, lr: 0.003000, 5.15s
2024-09-01 22:19:07 INFO     Saved model at 11
2024-09-01 22:19:07 INFO     Val loss decrease from 6.1770 to 6.1752, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-01 22:19:11 INFO     epoch complete!
2024-09-01 22:19:11 INFO     evaluating now!
2024-09-01 22:19:12 INFO     Epoch [12/200] train_loss: 5.7836, val_loss: 6.1195, lr: 0.003000, 5.17s
2024-09-01 22:19:12 INFO     Saved model at 12
2024-09-01 22:19:12 INFO     Val loss decrease from 6.1752 to 6.1195, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-01 22:19:17 INFO     epoch complete!
2024-09-01 22:19:17 INFO     evaluating now!
2024-09-01 22:19:17 INFO     Epoch [13/200] train_loss: 5.5722, val_loss: 5.9153, lr: 0.003000, 5.16s
2024-09-01 22:19:17 INFO     Saved model at 13
2024-09-01 22:19:17 INFO     Val loss decrease from 6.1195 to 5.9153, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-01 22:19:22 INFO     epoch complete!
2024-09-01 22:19:22 INFO     evaluating now!
2024-09-01 22:19:22 INFO     Epoch [14/200] train_loss: 5.5664, val_loss: 5.9035, lr: 0.003000, 5.15s
2024-09-01 22:19:22 INFO     Saved model at 14
2024-09-01 22:19:22 INFO     Val loss decrease from 5.9153 to 5.9035, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-01 22:19:27 INFO     epoch complete!
2024-09-01 22:19:27 INFO     evaluating now!
2024-09-01 22:19:27 INFO     Epoch [15/200] train_loss: 5.4086, val_loss: 5.7161, lr: 0.003000, 5.17s
2024-09-01 22:19:27 INFO     Saved model at 15
2024-09-01 22:19:27 INFO     Val loss decrease from 5.9035 to 5.7161, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-01 22:19:32 INFO     epoch complete!
2024-09-01 22:19:32 INFO     evaluating now!
2024-09-01 22:19:32 INFO     Epoch [16/200] train_loss: 5.3302, val_loss: 5.7437, lr: 0.003000, 5.17s
2024-09-01 22:19:37 INFO     epoch complete!
2024-09-01 22:19:37 INFO     evaluating now!
2024-09-01 22:19:38 INFO     Epoch [17/200] train_loss: 5.2966, val_loss: 5.8895, lr: 0.003000, 5.18s
2024-09-01 22:19:42 INFO     epoch complete!
2024-09-01 22:19:42 INFO     evaluating now!
2024-09-01 22:19:43 INFO     Epoch [18/200] train_loss: 5.2919, val_loss: 5.8746, lr: 0.003000, 5.17s
2024-09-01 22:19:48 INFO     epoch complete!
2024-09-01 22:19:48 INFO     evaluating now!
2024-09-01 22:19:48 INFO     Epoch [19/200] train_loss: 5.1492, val_loss: 5.6492, lr: 0.003000, 5.12s
2024-09-01 22:19:48 INFO     Saved model at 19
2024-09-01 22:19:48 INFO     Val loss decrease from 5.7161 to 5.6492, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-01 22:19:53 INFO     epoch complete!
2024-09-01 22:19:53 INFO     evaluating now!
2024-09-01 22:19:53 INFO     Epoch [20/200] train_loss: 5.0584, val_loss: 5.3965, lr: 0.003000, 5.13s
2024-09-01 22:19:53 INFO     Saved model at 20
2024-09-01 22:19:53 INFO     Val loss decrease from 5.6492 to 5.3965, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-01 22:19:58 INFO     epoch complete!
2024-09-01 22:19:58 INFO     evaluating now!
2024-09-01 22:19:58 INFO     Epoch [21/200] train_loss: 5.0121, val_loss: 5.4549, lr: 0.003000, 5.19s
2024-09-01 22:20:03 INFO     epoch complete!
2024-09-01 22:20:03 INFO     evaluating now!
2024-09-01 22:20:03 INFO     Epoch [22/200] train_loss: 4.9409, val_loss: 5.6505, lr: 0.003000, 5.18s
2024-09-01 22:20:08 INFO     epoch complete!
2024-09-01 22:20:08 INFO     evaluating now!
2024-09-01 22:20:09 INFO     Epoch [23/200] train_loss: 4.9531, val_loss: 5.4176, lr: 0.003000, 5.10s
2024-09-01 22:20:13 INFO     epoch complete!
2024-09-01 22:20:13 INFO     evaluating now!
2024-09-01 22:20:14 INFO     Epoch [24/200] train_loss: 4.8372, val_loss: 5.7446, lr: 0.003000, 5.10s
2024-09-01 22:20:18 INFO     epoch complete!
2024-09-01 22:20:18 INFO     evaluating now!
2024-09-01 22:20:19 INFO     Epoch [25/200] train_loss: 4.7752, val_loss: 5.7053, lr: 0.003000, 5.10s
2024-09-01 22:20:24 INFO     epoch complete!
2024-09-01 22:20:24 INFO     evaluating now!
2024-09-01 22:20:24 INFO     Epoch [26/200] train_loss: 4.7695, val_loss: 5.6220, lr: 0.003000, 5.11s
2024-09-01 22:20:29 INFO     epoch complete!
2024-09-01 22:20:29 INFO     evaluating now!
2024-09-01 22:20:29 INFO     Epoch [27/200] train_loss: 4.7018, val_loss: 5.5170, lr: 0.003000, 5.11s
2024-09-01 22:20:34 INFO     epoch complete!
2024-09-01 22:20:34 INFO     evaluating now!
2024-09-01 22:20:34 INFO     Epoch [28/200] train_loss: 4.5915, val_loss: 5.3270, lr: 0.003000, 5.11s
2024-09-01 22:20:34 INFO     Saved model at 28
2024-09-01 22:20:34 INFO     Val loss decrease from 5.3965 to 5.3270, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-01 22:20:39 INFO     epoch complete!
2024-09-01 22:20:39 INFO     evaluating now!
2024-09-01 22:20:39 INFO     Epoch [29/200] train_loss: 4.5504, val_loss: 5.3294, lr: 0.003000, 5.11s
2024-09-01 22:20:44 INFO     epoch complete!
2024-09-01 22:20:44 INFO     evaluating now!
2024-09-01 22:20:44 INFO     Epoch [30/200] train_loss: 4.5169, val_loss: 5.3381, lr: 0.003000, 5.12s
2024-09-01 22:20:49 INFO     epoch complete!
2024-09-01 22:20:49 INFO     evaluating now!
2024-09-01 22:20:49 INFO     Epoch [31/200] train_loss: 4.4773, val_loss: 5.2710, lr: 0.003000, 5.11s
2024-09-01 22:20:49 INFO     Saved model at 31
2024-09-01 22:20:49 INFO     Val loss decrease from 5.3270 to 5.2710, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-09-01 22:20:54 INFO     epoch complete!
2024-09-01 22:20:54 INFO     evaluating now!
2024-09-01 22:20:55 INFO     Epoch [32/200] train_loss: 4.5464, val_loss: 5.3493, lr: 0.003000, 5.10s
2024-09-01 22:20:59 INFO     epoch complete!
2024-09-01 22:20:59 INFO     evaluating now!
2024-09-01 22:21:00 INFO     Epoch [33/200] train_loss: 4.4356, val_loss: 5.2620, lr: 0.003000, 5.11s
2024-09-01 22:21:00 INFO     Saved model at 33
2024-09-01 22:21:00 INFO     Val loss decrease from 5.2710 to 5.2620, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-09-01 22:21:04 INFO     epoch complete!
2024-09-01 22:21:04 INFO     evaluating now!
2024-09-01 22:21:05 INFO     Epoch [34/200] train_loss: 4.3220, val_loss: 5.2675, lr: 0.003000, 5.11s
2024-09-01 22:21:10 INFO     epoch complete!
2024-09-01 22:21:10 INFO     evaluating now!
2024-09-01 22:21:10 INFO     Epoch [35/200] train_loss: 4.3436, val_loss: 5.0240, lr: 0.003000, 5.11s
2024-09-01 22:21:10 INFO     Saved model at 35
2024-09-01 22:21:10 INFO     Val loss decrease from 5.2620 to 5.0240, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-01 22:21:15 INFO     epoch complete!
2024-09-01 22:21:15 INFO     evaluating now!
2024-09-01 22:21:15 INFO     Epoch [36/200] train_loss: 4.3121, val_loss: 5.1428, lr: 0.003000, 5.10s
2024-09-01 22:21:20 INFO     epoch complete!
2024-09-01 22:21:20 INFO     evaluating now!
2024-09-01 22:21:20 INFO     Epoch [37/200] train_loss: 4.2817, val_loss: 5.2315, lr: 0.003000, 5.10s
2024-09-01 22:21:25 INFO     epoch complete!
2024-09-01 22:21:25 INFO     evaluating now!
2024-09-01 22:21:25 INFO     Epoch [38/200] train_loss: 4.2327, val_loss: 5.3542, lr: 0.003000, 5.10s
2024-09-01 22:21:30 INFO     epoch complete!
2024-09-01 22:21:30 INFO     evaluating now!
2024-09-01 22:21:30 INFO     Epoch [39/200] train_loss: 4.2638, val_loss: 5.3563, lr: 0.003000, 5.10s
2024-09-01 22:21:35 INFO     epoch complete!
2024-09-01 22:21:35 INFO     evaluating now!
2024-09-01 22:21:35 INFO     Epoch [40/200] train_loss: 4.1973, val_loss: 5.1326, lr: 0.003000, 5.12s
2024-09-01 22:21:40 INFO     epoch complete!
2024-09-01 22:21:40 INFO     evaluating now!
2024-09-01 22:21:40 INFO     Epoch [41/200] train_loss: 4.1724, val_loss: 5.3058, lr: 0.003000, 5.11s
2024-09-01 22:21:45 INFO     epoch complete!
2024-09-01 22:21:45 INFO     evaluating now!
2024-09-01 22:21:46 INFO     Epoch [42/200] train_loss: 4.1402, val_loss: 5.1080, lr: 0.003000, 5.11s
2024-09-01 22:21:50 INFO     epoch complete!
2024-09-01 22:21:50 INFO     evaluating now!
2024-09-01 22:21:51 INFO     Epoch [43/200] train_loss: 4.0926, val_loss: 5.1526, lr: 0.003000, 5.11s
2024-09-01 22:21:56 INFO     epoch complete!
2024-09-01 22:21:56 INFO     evaluating now!
2024-09-01 22:21:56 INFO     Epoch [44/200] train_loss: 4.0585, val_loss: 5.2617, lr: 0.003000, 5.11s
2024-09-01 22:22:01 INFO     epoch complete!
2024-09-01 22:22:01 INFO     evaluating now!
2024-09-01 22:22:01 INFO     Epoch [45/200] train_loss: 4.0221, val_loss: 5.0902, lr: 0.003000, 5.11s
2024-09-01 22:22:06 INFO     epoch complete!
2024-09-01 22:22:06 INFO     evaluating now!
2024-09-01 22:22:06 INFO     Epoch [46/200] train_loss: 4.0046, val_loss: 5.2787, lr: 0.003000, 5.10s
2024-09-01 22:22:11 INFO     epoch complete!
2024-09-01 22:22:11 INFO     evaluating now!
2024-09-01 22:22:11 INFO     Epoch [47/200] train_loss: 3.9832, val_loss: 5.0593, lr: 0.003000, 5.11s
2024-09-01 22:22:16 INFO     epoch complete!
2024-09-01 22:22:16 INFO     evaluating now!
2024-09-01 22:22:16 INFO     Epoch [48/200] train_loss: 3.9596, val_loss: 5.0331, lr: 0.003000, 5.19s
2024-09-01 22:22:21 INFO     epoch complete!
2024-09-01 22:22:21 INFO     evaluating now!
2024-09-01 22:22:22 INFO     Epoch [49/200] train_loss: 3.9010, val_loss: 4.9552, lr: 0.003000, 5.18s
2024-09-01 22:22:22 INFO     Saved model at 49
2024-09-01 22:22:22 INFO     Val loss decrease from 5.0240 to 4.9552, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-09-01 22:22:26 INFO     epoch complete!
2024-09-01 22:22:26 INFO     evaluating now!
2024-09-01 22:22:27 INFO     Epoch [50/200] train_loss: 3.9173, val_loss: 5.1420, lr: 0.003000, 5.16s
2024-09-01 22:22:32 INFO     epoch complete!
2024-09-01 22:22:32 INFO     evaluating now!
2024-09-01 22:22:32 INFO     Epoch [51/200] train_loss: 3.9420, val_loss: 5.3469, lr: 0.003000, 5.19s
2024-09-01 22:22:37 INFO     epoch complete!
2024-09-01 22:22:37 INFO     evaluating now!
2024-09-01 22:22:37 INFO     Epoch [52/200] train_loss: 3.8844, val_loss: 5.0277, lr: 0.003000, 5.18s
2024-09-01 22:22:42 INFO     epoch complete!
2024-09-01 22:22:42 INFO     evaluating now!
2024-09-01 22:22:42 INFO     Epoch [53/200] train_loss: 3.8743, val_loss: 5.0088, lr: 0.003000, 5.10s
2024-09-01 22:22:47 INFO     epoch complete!
2024-09-01 22:22:47 INFO     evaluating now!
2024-09-01 22:22:47 INFO     Epoch [54/200] train_loss: 3.8123, val_loss: 4.9876, lr: 0.003000, 5.11s
2024-09-01 22:22:52 INFO     epoch complete!
2024-09-01 22:22:52 INFO     evaluating now!
2024-09-01 22:22:52 INFO     Epoch [55/200] train_loss: 3.7959, val_loss: 5.0590, lr: 0.003000, 5.11s
2024-09-01 22:22:57 INFO     epoch complete!
2024-09-01 22:22:57 INFO     evaluating now!
2024-09-01 22:22:57 INFO     Epoch [56/200] train_loss: 3.8096, val_loss: 4.9684, lr: 0.003000, 5.11s
2024-09-01 22:23:02 INFO     epoch complete!
2024-09-01 22:23:02 INFO     evaluating now!
2024-09-01 22:23:03 INFO     Epoch [57/200] train_loss: 3.7996, val_loss: 5.0881, lr: 0.003000, 5.11s
2024-09-01 22:23:07 INFO     epoch complete!
2024-09-01 22:23:07 INFO     evaluating now!
2024-09-01 22:23:08 INFO     Epoch [58/200] train_loss: 3.7728, val_loss: 5.0876, lr: 0.003000, 5.15s
2024-09-01 22:23:13 INFO     epoch complete!
2024-09-01 22:23:13 INFO     evaluating now!
2024-09-01 22:23:13 INFO     Epoch [59/200] train_loss: 3.7653, val_loss: 5.0801, lr: 0.003000, 5.13s
2024-09-01 22:23:18 INFO     epoch complete!
2024-09-01 22:23:18 INFO     evaluating now!
2024-09-01 22:23:18 INFO     Epoch [60/200] train_loss: 3.7283, val_loss: 5.2562, lr: 0.003000, 5.09s
2024-09-01 22:23:23 INFO     epoch complete!
2024-09-01 22:23:23 INFO     evaluating now!
2024-09-01 22:23:23 INFO     Epoch [61/200] train_loss: 3.6941, val_loss: 5.0611, lr: 0.003000, 5.09s
2024-09-01 22:23:28 INFO     epoch complete!
2024-09-01 22:23:28 INFO     evaluating now!
2024-09-01 22:23:28 INFO     Epoch [62/200] train_loss: 3.7388, val_loss: 5.0441, lr: 0.003000, 5.09s
2024-09-01 22:23:33 INFO     epoch complete!
2024-09-01 22:23:33 INFO     evaluating now!
2024-09-01 22:23:33 INFO     Epoch [63/200] train_loss: 3.6831, val_loss: 5.0993, lr: 0.003000, 5.09s
2024-09-01 22:23:38 INFO     epoch complete!
2024-09-01 22:23:38 INFO     evaluating now!
2024-09-01 22:23:38 INFO     Epoch [64/200] train_loss: 3.6420, val_loss: 4.9492, lr: 0.003000, 5.10s
2024-09-01 22:23:38 INFO     Saved model at 64
2024-09-01 22:23:38 INFO     Val loss decrease from 4.9552 to 4.9492, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch64.tar
2024-09-01 22:23:43 INFO     epoch complete!
2024-09-01 22:23:43 INFO     evaluating now!
2024-09-01 22:23:43 INFO     Epoch [65/200] train_loss: 3.6138, val_loss: 5.0149, lr: 0.003000, 5.10s
2024-09-01 22:23:48 INFO     epoch complete!
2024-09-01 22:23:48 INFO     evaluating now!
2024-09-01 22:23:49 INFO     Epoch [66/200] train_loss: 3.5950, val_loss: 5.0189, lr: 0.003000, 5.10s
2024-09-01 22:23:53 INFO     epoch complete!
2024-09-01 22:23:53 INFO     evaluating now!
2024-09-01 22:23:54 INFO     Epoch [67/200] train_loss: 3.6056, val_loss: 4.9535, lr: 0.003000, 5.10s
2024-09-01 22:23:58 INFO     epoch complete!
2024-09-01 22:23:58 INFO     evaluating now!
2024-09-01 22:23:59 INFO     Epoch [68/200] train_loss: 3.6427, val_loss: 4.9712, lr: 0.003000, 5.09s
2024-09-01 22:24:04 INFO     epoch complete!
2024-09-01 22:24:04 INFO     evaluating now!
2024-09-01 22:24:04 INFO     Epoch [69/200] train_loss: 3.6936, val_loss: 5.1625, lr: 0.003000, 5.09s
2024-09-01 22:24:09 INFO     epoch complete!
2024-09-01 22:24:09 INFO     evaluating now!
2024-09-01 22:24:09 INFO     Epoch [70/200] train_loss: 3.6230, val_loss: 4.9568, lr: 0.003000, 5.09s
2024-09-01 22:24:14 INFO     epoch complete!
2024-09-01 22:24:14 INFO     evaluating now!
2024-09-01 22:24:14 INFO     Epoch [71/200] train_loss: 3.5388, val_loss: 4.8777, lr: 0.003000, 5.09s
2024-09-01 22:24:14 INFO     Saved model at 71
2024-09-01 22:24:14 INFO     Val loss decrease from 4.9492 to 4.8777, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch71.tar
2024-09-01 22:24:19 INFO     epoch complete!
2024-09-01 22:24:19 INFO     evaluating now!
2024-09-01 22:24:19 INFO     Epoch [72/200] train_loss: 3.5570, val_loss: 5.1628, lr: 0.003000, 5.10s
2024-09-01 22:24:24 INFO     epoch complete!
2024-09-01 22:24:24 INFO     evaluating now!
2024-09-01 22:24:24 INFO     Epoch [73/200] train_loss: 3.5273, val_loss: 5.0404, lr: 0.003000, 5.10s
2024-09-01 22:24:29 INFO     epoch complete!
2024-09-01 22:24:29 INFO     evaluating now!
2024-09-01 22:24:29 INFO     Epoch [74/200] train_loss: 3.5519, val_loss: 5.0514, lr: 0.003000, 5.11s
2024-09-01 22:24:34 INFO     epoch complete!
2024-09-01 22:24:34 INFO     evaluating now!
2024-09-01 22:24:34 INFO     Epoch [75/200] train_loss: 3.5125, val_loss: 5.0039, lr: 0.003000, 5.10s
2024-09-01 22:24:39 INFO     epoch complete!
2024-09-01 22:24:39 INFO     evaluating now!
2024-09-01 22:24:40 INFO     Epoch [76/200] train_loss: 3.4735, val_loss: 4.9135, lr: 0.003000, 5.10s
2024-09-01 22:24:44 INFO     epoch complete!
2024-09-01 22:24:44 INFO     evaluating now!
2024-09-01 22:24:45 INFO     Epoch [77/200] train_loss: 3.4842, val_loss: 5.0149, lr: 0.003000, 5.09s
2024-09-01 22:24:49 INFO     epoch complete!
2024-09-01 22:24:49 INFO     evaluating now!
2024-09-01 22:24:50 INFO     Epoch [78/200] train_loss: 3.4402, val_loss: 5.0008, lr: 0.003000, 5.10s
2024-09-01 22:24:55 INFO     epoch complete!
2024-09-01 22:24:55 INFO     evaluating now!
2024-09-01 22:24:55 INFO     Epoch [79/200] train_loss: 3.4423, val_loss: 4.9997, lr: 0.003000, 5.11s
2024-09-01 22:25:00 INFO     epoch complete!
2024-09-01 22:25:00 INFO     evaluating now!
2024-09-01 22:25:00 INFO     Epoch [80/200] train_loss: 3.4175, val_loss: 5.0118, lr: 0.003000, 5.10s
2024-09-01 22:25:05 INFO     epoch complete!
2024-09-01 22:25:05 INFO     evaluating now!
2024-09-01 22:25:05 INFO     Epoch [81/200] train_loss: 3.3797, val_loss: 4.9574, lr: 0.003000, 5.10s
2024-09-01 22:25:10 INFO     epoch complete!
2024-09-01 22:25:10 INFO     evaluating now!
2024-09-01 22:25:10 INFO     Epoch [82/200] train_loss: 3.4705, val_loss: 4.9982, lr: 0.003000, 5.10s
2024-09-01 22:25:15 INFO     epoch complete!
2024-09-01 22:25:15 INFO     evaluating now!
2024-09-01 22:25:15 INFO     Epoch [83/200] train_loss: 3.4252, val_loss: 4.9647, lr: 0.003000, 5.11s
2024-09-01 22:25:20 INFO     epoch complete!
2024-09-01 22:25:20 INFO     evaluating now!
2024-09-01 22:25:20 INFO     Epoch [84/200] train_loss: 3.4113, val_loss: 4.9685, lr: 0.003000, 5.10s
2024-09-01 22:25:25 INFO     epoch complete!
2024-09-01 22:25:25 INFO     evaluating now!
2024-09-01 22:25:25 INFO     Epoch [85/200] train_loss: 3.3352, val_loss: 4.9948, lr: 0.003000, 5.10s
2024-09-01 22:25:30 INFO     epoch complete!
2024-09-01 22:25:30 INFO     evaluating now!
2024-09-01 22:25:31 INFO     Epoch [86/200] train_loss: 3.3652, val_loss: 5.0958, lr: 0.003000, 5.10s
2024-09-01 22:25:31 WARNING  Early stopping at epoch: 86
2024-09-01 22:25:31 INFO     Trained totally 87 epochs, average train time is 4.819s, average eval time is 0.316s
2024-09-01 22:25:31 INFO     Loaded model at 71
2024-09-01 22:25:31 INFO     Saved model at ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406.m
2024-09-01 22:25:31 INFO     Start evaluating ...
2024-09-01 22:25:32 INFO     Note that you select the single mode to evaluate!
2024-09-01 22:25:32 INFO     Evaluate result is saved at ./libcity/cache/30/evaluate_cache\2024_09_01_22_25_32_AGCRN_CHITaxi20190406.csv
2024-09-01 22:25:32 INFO     
         MAE       RMSE
1   2.254970   7.389314
2   2.417031   8.022931
3   2.550639   8.986804
4   2.725754   9.772723
5   2.822481  10.638055
6   3.000643  11.475231
7   3.090613  12.280399
8   3.112902  12.712676
9   3.128495  12.890911
10  3.167609  12.981193
11  3.288214  13.505162
12  3.309688  13.903567
2024-09-01 22:25:32 INFO     ----------------------------------------------------------------------------
2024-09-01 22:25:32 INFO     # 1, Kownledge Graph Embedding: RotH, Experiment ids: 31
2024-09-01 22:25:32 INFO     ----------------------------------------------------------------------------
2024-09-01 22:25:32 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=30
2024-09-01 22:25:32 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 30, 'embedding_model': 'RotH', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-01 22:25:32 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-01 22:25:32 INFO     set_weight_link_or_dist: dist
2024-09-01 22:25:32 INFO     init_weight_inf_or_zero: inf
2024-09-01 22:25:32 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-01 22:25:32 INFO     Start Calculate the weight by Gauss kernel!
2024-09-01 22:25:32 INFO     Loading file CHITaxi20190406.dyna
2024-09-01 22:25:32 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-01 22:25:34 INFO     Dataset created
2024-09-01 22:25:34 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-01 22:25:34 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-01 22:25:34 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-01 22:25:34 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-01 22:25:34 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-01 22:25:34 INFO     NormalScaler max: 0.44321246163773476
2024-09-01 22:25:36 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-01 22:25:36 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-01 22:25:36 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-01 22:25:36 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 22:25:36 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-01 22:25:36 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 22:25:36 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-01 22:25:36 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 22:25:36 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-01 22:25:36 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 22:25:36 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-01 22:25:36 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-01 22:25:36 INFO     Total parameter numbers: 874010
2024-09-01 22:25:36 INFO     You select `adam` optimizer.
2024-09-01 22:25:36 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-01 22:25:36 INFO     Start training ...
2024-09-01 22:25:36 INFO     num_batches:48
2024-09-01 22:25:41 INFO     epoch complete!
2024-09-01 22:25:41 INFO     evaluating now!
2024-09-01 22:25:41 INFO     Epoch [0/200] train_loss: 24.8630, val_loss: 19.0141, lr: 0.003000, 5.16s
2024-09-01 22:25:41 INFO     Saved model at 0
2024-09-01 22:25:41 INFO     Val loss decrease from inf to 19.0141, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-01 22:25:46 INFO     epoch complete!
2024-09-01 22:25:46 INFO     evaluating now!
2024-09-01 22:25:46 INFO     Epoch [1/200] train_loss: 15.9109, val_loss: 15.8035, lr: 0.003000, 5.01s
2024-09-01 22:25:46 INFO     Saved model at 1
2024-09-01 22:25:46 INFO     Val loss decrease from 19.0141 to 15.8035, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-01 22:25:51 INFO     epoch complete!
2024-09-01 22:25:51 INFO     evaluating now!
2024-09-01 22:25:51 INFO     Epoch [2/200] train_loss: 13.3080, val_loss: 13.0217, lr: 0.003000, 5.01s
2024-09-01 22:25:51 INFO     Saved model at 2
2024-09-01 22:25:51 INFO     Val loss decrease from 15.8035 to 13.0217, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-01 22:25:56 INFO     epoch complete!
2024-09-01 22:25:56 INFO     evaluating now!
2024-09-01 22:25:56 INFO     Epoch [3/200] train_loss: 10.9578, val_loss: 10.8679, lr: 0.003000, 5.01s
2024-09-01 22:25:56 INFO     Saved model at 3
2024-09-01 22:25:56 INFO     Val loss decrease from 13.0217 to 10.8679, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-01 22:26:01 INFO     epoch complete!
2024-09-01 22:26:01 INFO     evaluating now!
2024-09-01 22:26:01 INFO     Epoch [4/200] train_loss: 9.3777, val_loss: 9.0689, lr: 0.003000, 5.01s
2024-09-01 22:26:01 INFO     Saved model at 4
2024-09-01 22:26:01 INFO     Val loss decrease from 10.8679 to 9.0689, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-01 22:26:06 INFO     epoch complete!
2024-09-01 22:26:06 INFO     evaluating now!
2024-09-01 22:26:06 INFO     Epoch [5/200] train_loss: 8.4713, val_loss: 8.1750, lr: 0.003000, 5.01s
2024-09-01 22:26:06 INFO     Saved model at 5
2024-09-01 22:26:06 INFO     Val loss decrease from 9.0689 to 8.1750, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-01 22:26:11 INFO     epoch complete!
2024-09-01 22:26:11 INFO     evaluating now!
2024-09-01 22:26:11 INFO     Epoch [6/200] train_loss: 7.5637, val_loss: 7.6301, lr: 0.003000, 5.01s
2024-09-01 22:26:11 INFO     Saved model at 6
2024-09-01 22:26:11 INFO     Val loss decrease from 8.1750 to 7.6301, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-01 22:26:16 INFO     epoch complete!
2024-09-01 22:26:16 INFO     evaluating now!
2024-09-01 22:26:16 INFO     Epoch [7/200] train_loss: 7.1425, val_loss: 6.9622, lr: 0.003000, 5.01s
2024-09-01 22:26:16 INFO     Saved model at 7
2024-09-01 22:26:16 INFO     Val loss decrease from 7.6301 to 6.9622, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-01 22:26:21 INFO     epoch complete!
2024-09-01 22:26:21 INFO     evaluating now!
2024-09-01 22:26:21 INFO     Epoch [8/200] train_loss: 6.5930, val_loss: 6.5709, lr: 0.003000, 5.01s
2024-09-01 22:26:21 INFO     Saved model at 8
2024-09-01 22:26:21 INFO     Val loss decrease from 6.9622 to 6.5709, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-01 22:26:26 INFO     epoch complete!
2024-09-01 22:26:26 INFO     evaluating now!
2024-09-01 22:26:27 INFO     Epoch [9/200] train_loss: 6.3254, val_loss: 6.4063, lr: 0.003000, 5.02s
2024-09-01 22:26:27 INFO     Saved model at 9
2024-09-01 22:26:27 INFO     Val loss decrease from 6.5709 to 6.4063, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-01 22:26:31 INFO     epoch complete!
2024-09-01 22:26:31 INFO     evaluating now!
2024-09-01 22:26:32 INFO     Epoch [10/200] train_loss: 6.1481, val_loss: 6.2407, lr: 0.003000, 5.03s
2024-09-01 22:26:32 INFO     Saved model at 10
2024-09-01 22:26:32 INFO     Val loss decrease from 6.4063 to 6.2407, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-01 22:26:36 INFO     epoch complete!
2024-09-01 22:26:36 INFO     evaluating now!
2024-09-01 22:26:37 INFO     Epoch [11/200] train_loss: 5.9458, val_loss: 6.0268, lr: 0.003000, 5.03s
2024-09-01 22:26:37 INFO     Saved model at 11
2024-09-01 22:26:37 INFO     Val loss decrease from 6.2407 to 6.0268, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-01 22:26:41 INFO     epoch complete!
2024-09-01 22:26:41 INFO     evaluating now!
2024-09-01 22:26:42 INFO     Epoch [12/200] train_loss: 5.8198, val_loss: 6.2660, lr: 0.003000, 5.02s
2024-09-01 22:26:46 INFO     epoch complete!
2024-09-01 22:26:46 INFO     evaluating now!
2024-09-01 22:26:47 INFO     Epoch [13/200] train_loss: 5.6539, val_loss: 5.9567, lr: 0.003000, 5.03s
2024-09-01 22:26:47 INFO     Saved model at 13
2024-09-01 22:26:47 INFO     Val loss decrease from 6.0268 to 5.9567, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-01 22:26:51 INFO     epoch complete!
2024-09-01 22:26:51 INFO     evaluating now!
2024-09-01 22:26:52 INFO     Epoch [14/200] train_loss: 5.5470, val_loss: 5.8223, lr: 0.003000, 5.06s
2024-09-01 22:26:52 INFO     Saved model at 14
2024-09-01 22:26:52 INFO     Val loss decrease from 5.9567 to 5.8223, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-01 22:26:56 INFO     epoch complete!
2024-09-01 22:26:56 INFO     evaluating now!
2024-09-01 22:26:57 INFO     Epoch [15/200] train_loss: 5.4075, val_loss: 5.7500, lr: 0.003000, 5.02s
2024-09-01 22:26:57 INFO     Saved model at 15
2024-09-01 22:26:57 INFO     Val loss decrease from 5.8223 to 5.7500, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-01 22:27:02 INFO     epoch complete!
2024-09-01 22:27:02 INFO     evaluating now!
2024-09-01 22:27:02 INFO     Epoch [16/200] train_loss: 5.3877, val_loss: 5.7345, lr: 0.003000, 5.03s
2024-09-01 22:27:02 INFO     Saved model at 16
2024-09-01 22:27:02 INFO     Val loss decrease from 5.7500 to 5.7345, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-01 22:27:07 INFO     epoch complete!
2024-09-01 22:27:07 INFO     evaluating now!
2024-09-01 22:27:07 INFO     Epoch [17/200] train_loss: 5.3467, val_loss: 5.6234, lr: 0.003000, 5.02s
2024-09-01 22:27:07 INFO     Saved model at 17
2024-09-01 22:27:07 INFO     Val loss decrease from 5.7345 to 5.6234, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-01 22:27:12 INFO     epoch complete!
2024-09-01 22:27:12 INFO     evaluating now!
2024-09-01 22:27:12 INFO     Epoch [18/200] train_loss: 5.0543, val_loss: 5.5358, lr: 0.003000, 5.03s
2024-09-01 22:27:12 INFO     Saved model at 18
2024-09-01 22:27:12 INFO     Val loss decrease from 5.6234 to 5.5358, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-01 22:27:17 INFO     epoch complete!
2024-09-01 22:27:17 INFO     evaluating now!
2024-09-01 22:27:17 INFO     Epoch [19/200] train_loss: 5.0393, val_loss: 5.3950, lr: 0.003000, 5.03s
2024-09-01 22:27:17 INFO     Saved model at 19
2024-09-01 22:27:17 INFO     Val loss decrease from 5.5358 to 5.3950, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-01 22:27:22 INFO     epoch complete!
2024-09-01 22:27:22 INFO     evaluating now!
2024-09-01 22:27:22 INFO     Epoch [20/200] train_loss: 5.0084, val_loss: 5.8213, lr: 0.003000, 5.02s
2024-09-01 22:27:27 INFO     epoch complete!
2024-09-01 22:27:27 INFO     evaluating now!
2024-09-01 22:27:27 INFO     Epoch [21/200] train_loss: 4.9170, val_loss: 5.5776, lr: 0.003000, 5.02s
2024-09-01 22:27:32 INFO     epoch complete!
2024-09-01 22:27:32 INFO     evaluating now!
2024-09-01 22:27:32 INFO     Epoch [22/200] train_loss: 4.9238, val_loss: 5.5326, lr: 0.003000, 5.02s
2024-09-01 22:27:37 INFO     epoch complete!
2024-09-01 22:27:37 INFO     evaluating now!
2024-09-01 22:27:37 INFO     Epoch [23/200] train_loss: 4.7714, val_loss: 5.4419, lr: 0.003000, 5.02s
2024-09-01 22:27:42 INFO     epoch complete!
2024-09-01 22:27:42 INFO     evaluating now!
2024-09-01 22:27:42 INFO     Epoch [24/200] train_loss: 4.6983, val_loss: 5.4279, lr: 0.003000, 5.02s
2024-09-01 22:27:47 INFO     epoch complete!
2024-09-01 22:27:47 INFO     evaluating now!
2024-09-01 22:27:47 INFO     Epoch [25/200] train_loss: 4.7146, val_loss: 5.5155, lr: 0.003000, 5.03s
2024-09-01 22:27:52 INFO     epoch complete!
2024-09-01 22:27:52 INFO     evaluating now!
2024-09-01 22:27:52 INFO     Epoch [26/200] train_loss: 4.6593, val_loss: 5.5287, lr: 0.003000, 5.03s
2024-09-01 22:27:57 INFO     epoch complete!
2024-09-01 22:27:57 INFO     evaluating now!
2024-09-01 22:27:57 INFO     Epoch [27/200] train_loss: 4.5837, val_loss: 5.2810, lr: 0.003000, 5.02s
2024-09-01 22:27:57 INFO     Saved model at 27
2024-09-01 22:27:57 INFO     Val loss decrease from 5.3950 to 5.2810, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-01 22:28:02 INFO     epoch complete!
2024-09-01 22:28:02 INFO     evaluating now!
2024-09-01 22:28:02 INFO     Epoch [28/200] train_loss: 4.6507, val_loss: 5.3029, lr: 0.003000, 5.03s
2024-09-01 22:28:07 INFO     epoch complete!
2024-09-01 22:28:07 INFO     evaluating now!
2024-09-01 22:28:07 INFO     Epoch [29/200] train_loss: 4.5112, val_loss: 5.1743, lr: 0.003000, 5.02s
2024-09-01 22:28:07 INFO     Saved model at 29
2024-09-01 22:28:07 INFO     Val loss decrease from 5.2810 to 5.1743, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-01 22:28:12 INFO     epoch complete!
2024-09-01 22:28:12 INFO     evaluating now!
2024-09-01 22:28:12 INFO     Epoch [30/200] train_loss: 4.4357, val_loss: 5.2452, lr: 0.003000, 5.02s
2024-09-01 22:28:17 INFO     epoch complete!
2024-09-01 22:28:17 INFO     evaluating now!
2024-09-01 22:28:17 INFO     Epoch [31/200] train_loss: 4.4165, val_loss: 5.2368, lr: 0.003000, 5.02s
2024-09-01 22:28:22 INFO     epoch complete!
2024-09-01 22:28:22 INFO     evaluating now!
2024-09-01 22:28:22 INFO     Epoch [32/200] train_loss: 4.4093, val_loss: 5.3411, lr: 0.003000, 5.02s
2024-09-01 22:28:27 INFO     epoch complete!
2024-09-01 22:28:27 INFO     evaluating now!
2024-09-01 22:28:27 INFO     Epoch [33/200] train_loss: 4.4080, val_loss: 5.1848, lr: 0.003000, 5.02s
2024-09-01 22:28:32 INFO     epoch complete!
2024-09-01 22:28:32 INFO     evaluating now!
2024-09-01 22:28:32 INFO     Epoch [34/200] train_loss: 4.3439, val_loss: 5.2900, lr: 0.003000, 5.02s
2024-09-01 22:28:37 INFO     epoch complete!
2024-09-01 22:28:37 INFO     evaluating now!
2024-09-01 22:28:37 INFO     Epoch [35/200] train_loss: 4.3090, val_loss: 5.3316, lr: 0.003000, 5.02s
2024-09-01 22:28:42 INFO     epoch complete!
2024-09-01 22:28:42 INFO     evaluating now!
2024-09-01 22:28:42 INFO     Epoch [36/200] train_loss: 4.2258, val_loss: 5.1806, lr: 0.003000, 5.02s
2024-09-01 22:28:47 INFO     epoch complete!
2024-09-01 22:28:47 INFO     evaluating now!
2024-09-01 22:28:47 INFO     Epoch [37/200] train_loss: 4.1578, val_loss: 5.0611, lr: 0.003000, 5.02s
2024-09-01 22:28:47 INFO     Saved model at 37
2024-09-01 22:28:47 INFO     Val loss decrease from 5.1743 to 5.0611, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-09-01 22:28:52 INFO     epoch complete!
2024-09-01 22:28:52 INFO     evaluating now!
2024-09-01 22:28:52 INFO     Epoch [38/200] train_loss: 4.1373, val_loss: 5.1933, lr: 0.003000, 5.02s
2024-09-01 22:28:57 INFO     epoch complete!
2024-09-01 22:28:57 INFO     evaluating now!
2024-09-01 22:28:57 INFO     Epoch [39/200] train_loss: 4.1263, val_loss: 5.2413, lr: 0.003000, 5.02s
2024-09-01 22:29:02 INFO     epoch complete!
2024-09-01 22:29:02 INFO     evaluating now!
2024-09-01 22:29:02 INFO     Epoch [40/200] train_loss: 4.0807, val_loss: 5.1934, lr: 0.003000, 5.02s
2024-09-01 22:29:07 INFO     epoch complete!
2024-09-01 22:29:07 INFO     evaluating now!
2024-09-01 22:29:07 INFO     Epoch [41/200] train_loss: 4.1092, val_loss: 5.1379, lr: 0.003000, 5.02s
2024-09-01 22:29:12 INFO     epoch complete!
2024-09-01 22:29:12 INFO     evaluating now!
2024-09-01 22:29:13 INFO     Epoch [42/200] train_loss: 4.0695, val_loss: 5.0737, lr: 0.003000, 5.03s
2024-09-01 22:29:17 INFO     epoch complete!
2024-09-01 22:29:17 INFO     evaluating now!
2024-09-01 22:29:18 INFO     Epoch [43/200] train_loss: 4.0883, val_loss: 5.1448, lr: 0.003000, 5.02s
2024-09-01 22:29:22 INFO     epoch complete!
2024-09-01 22:29:22 INFO     evaluating now!
2024-09-01 22:29:23 INFO     Epoch [44/200] train_loss: 3.9307, val_loss: 5.1023, lr: 0.003000, 5.02s
2024-09-01 22:29:27 INFO     epoch complete!
2024-09-01 22:29:27 INFO     evaluating now!
2024-09-01 22:29:28 INFO     Epoch [45/200] train_loss: 3.9524, val_loss: 5.3654, lr: 0.003000, 5.02s
2024-09-01 22:29:32 INFO     epoch complete!
2024-09-01 22:29:32 INFO     evaluating now!
2024-09-01 22:29:33 INFO     Epoch [46/200] train_loss: 3.9708, val_loss: 5.1698, lr: 0.003000, 5.03s
2024-09-01 22:29:37 INFO     epoch complete!
2024-09-01 22:29:37 INFO     evaluating now!
2024-09-01 22:29:38 INFO     Epoch [47/200] train_loss: 3.9549, val_loss: 5.1517, lr: 0.003000, 5.02s
2024-09-01 22:29:42 INFO     epoch complete!
2024-09-01 22:29:42 INFO     evaluating now!
2024-09-01 22:29:43 INFO     Epoch [48/200] train_loss: 3.9735, val_loss: 5.0754, lr: 0.003000, 5.02s
2024-09-01 22:29:47 INFO     epoch complete!
2024-09-01 22:29:47 INFO     evaluating now!
2024-09-01 22:29:48 INFO     Epoch [49/200] train_loss: 3.8543, val_loss: 5.0462, lr: 0.003000, 5.02s
2024-09-01 22:29:48 INFO     Saved model at 49
2024-09-01 22:29:48 INFO     Val loss decrease from 5.0611 to 5.0462, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-09-01 22:29:52 INFO     epoch complete!
2024-09-01 22:29:52 INFO     evaluating now!
2024-09-01 22:29:53 INFO     Epoch [50/200] train_loss: 3.8399, val_loss: 4.9491, lr: 0.003000, 5.02s
2024-09-01 22:29:53 INFO     Saved model at 50
2024-09-01 22:29:53 INFO     Val loss decrease from 5.0462 to 4.9491, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch50.tar
2024-09-01 22:29:57 INFO     epoch complete!
2024-09-01 22:29:57 INFO     evaluating now!
2024-09-01 22:29:58 INFO     Epoch [51/200] train_loss: 3.7857, val_loss: 5.0166, lr: 0.003000, 5.02s
2024-09-01 22:30:02 INFO     epoch complete!
2024-09-01 22:30:02 INFO     evaluating now!
2024-09-01 22:30:03 INFO     Epoch [52/200] train_loss: 3.8389, val_loss: 5.1560, lr: 0.003000, 5.02s
2024-09-01 22:30:07 INFO     epoch complete!
2024-09-01 22:30:07 INFO     evaluating now!
2024-09-01 22:30:08 INFO     Epoch [53/200] train_loss: 3.7672, val_loss: 5.0205, lr: 0.003000, 5.02s
2024-09-01 22:30:13 INFO     epoch complete!
2024-09-01 22:30:13 INFO     evaluating now!
2024-09-01 22:30:13 INFO     Epoch [54/200] train_loss: 3.8275, val_loss: 5.1759, lr: 0.003000, 5.03s
2024-09-01 22:30:18 INFO     epoch complete!
2024-09-01 22:30:18 INFO     evaluating now!
2024-09-01 22:30:18 INFO     Epoch [55/200] train_loss: 3.7159, val_loss: 4.9639, lr: 0.003000, 5.02s
2024-09-01 22:30:23 INFO     epoch complete!
2024-09-01 22:30:23 INFO     evaluating now!
2024-09-01 22:30:23 INFO     Epoch [56/200] train_loss: 3.7468, val_loss: 5.0341, lr: 0.003000, 5.02s
2024-09-01 22:30:28 INFO     epoch complete!
2024-09-01 22:30:28 INFO     evaluating now!
2024-09-01 22:30:28 INFO     Epoch [57/200] train_loss: 3.6889, val_loss: 5.1127, lr: 0.003000, 5.02s
2024-09-01 22:30:33 INFO     epoch complete!
2024-09-01 22:30:33 INFO     evaluating now!
2024-09-01 22:30:33 INFO     Epoch [58/200] train_loss: 3.7005, val_loss: 5.0085, lr: 0.003000, 5.02s
2024-09-01 22:30:38 INFO     epoch complete!
2024-09-01 22:30:38 INFO     evaluating now!
2024-09-01 22:30:38 INFO     Epoch [59/200] train_loss: 3.6639, val_loss: 5.0761, lr: 0.003000, 5.03s
2024-09-01 22:30:43 INFO     epoch complete!
2024-09-01 22:30:43 INFO     evaluating now!
2024-09-01 22:30:43 INFO     Epoch [60/200] train_loss: 3.6060, val_loss: 5.0390, lr: 0.003000, 5.02s
2024-09-01 22:30:48 INFO     epoch complete!
2024-09-01 22:30:48 INFO     evaluating now!
2024-09-01 22:30:48 INFO     Epoch [61/200] train_loss: 3.6041, val_loss: 4.9936, lr: 0.003000, 5.03s
2024-09-01 22:30:53 INFO     epoch complete!
2024-09-01 22:30:53 INFO     evaluating now!
2024-09-01 22:30:53 INFO     Epoch [62/200] train_loss: 3.6327, val_loss: 5.0252, lr: 0.003000, 5.02s
2024-09-01 22:30:58 INFO     epoch complete!
2024-09-01 22:30:58 INFO     evaluating now!
2024-09-01 22:30:58 INFO     Epoch [63/200] train_loss: 3.6005, val_loss: 5.0370, lr: 0.003000, 5.02s
2024-09-01 22:31:03 INFO     epoch complete!
2024-09-01 22:31:03 INFO     evaluating now!
2024-09-01 22:31:03 INFO     Epoch [64/200] train_loss: 3.5843, val_loss: 5.0430, lr: 0.003000, 5.03s
2024-09-01 22:31:08 INFO     epoch complete!
2024-09-01 22:31:08 INFO     evaluating now!
2024-09-01 22:31:08 INFO     Epoch [65/200] train_loss: 3.5546, val_loss: 5.0118, lr: 0.003000, 5.02s
2024-09-01 22:31:08 WARNING  Early stopping at epoch: 65
2024-09-01 22:31:08 INFO     Trained totally 66 epochs, average train time is 4.724s, average eval time is 0.300s
2024-09-01 22:31:08 INFO     Loaded model at 50
2024-09-01 22:31:08 INFO     Saved model at ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406.m
2024-09-01 22:31:08 INFO     Start evaluating ...
2024-09-01 22:31:09 INFO     Note that you select the single mode to evaluate!
2024-09-01 22:31:09 INFO     Evaluate result is saved at ./libcity/cache/30/evaluate_cache\2024_09_01_22_31_09_AGCRN_CHITaxi20190406.csv
2024-09-01 22:31:09 INFO     
         MAE       RMSE
1   2.345587   6.756005
2   2.429930   7.472613
3   2.605437   8.582234
4   2.712436   9.535699
5   2.932285  10.262416
6   3.025536  10.996751
7   3.116108  11.567797
8   3.212390  12.044387
9   3.209364  12.570971
10  3.313441  13.054002
11  3.354531  13.589835
12  3.504621  14.115364
2024-09-01 22:31:09 INFO     ----------------------------------------------------------------------------
2024-09-01 22:31:09 INFO     # 2, Kownledge Graph Embedding: RotH, Experiment ids: 32
2024-09-01 22:31:09 INFO     ----------------------------------------------------------------------------
2024-09-01 22:31:09 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=30
2024-09-01 22:31:09 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 30, 'embedding_model': 'RotH', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-01 22:31:09 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-01 22:31:09 INFO     set_weight_link_or_dist: dist
2024-09-01 22:31:09 INFO     init_weight_inf_or_zero: inf
2024-09-01 22:31:09 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-01 22:31:09 INFO     Start Calculate the weight by Gauss kernel!
2024-09-01 22:31:09 INFO     Loading file CHITaxi20190406.dyna
2024-09-01 22:31:09 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-01 22:31:11 INFO     Dataset created
2024-09-01 22:31:11 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-01 22:31:11 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-01 22:31:11 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-01 22:31:11 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-01 22:31:11 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-01 22:31:11 INFO     NormalScaler max: 0.44321246163773476
2024-09-01 22:31:13 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-01 22:31:13 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-01 22:31:13 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-01 22:31:13 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 22:31:13 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-01 22:31:13 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 22:31:13 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-01 22:31:13 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 22:31:13 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-01 22:31:13 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 22:31:13 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-01 22:31:13 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-01 22:31:13 INFO     Total parameter numbers: 874010
2024-09-01 22:31:13 INFO     You select `adam` optimizer.
2024-09-01 22:31:13 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-01 22:31:13 INFO     Start training ...
2024-09-01 22:31:13 INFO     num_batches:48
2024-09-01 22:31:18 INFO     epoch complete!
2024-09-01 22:31:18 INFO     evaluating now!
2024-09-01 22:31:19 INFO     Epoch [0/200] train_loss: 24.1873, val_loss: 18.6007, lr: 0.003000, 5.33s
2024-09-01 22:31:19 INFO     Saved model at 0
2024-09-01 22:31:19 INFO     Val loss decrease from inf to 18.6007, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-01 22:31:23 INFO     epoch complete!
2024-09-01 22:31:23 INFO     evaluating now!
2024-09-01 22:31:24 INFO     Epoch [1/200] train_loss: 15.2658, val_loss: 14.7519, lr: 0.003000, 5.02s
2024-09-01 22:31:24 INFO     Saved model at 1
2024-09-01 22:31:24 INFO     Val loss decrease from 18.6007 to 14.7519, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-01 22:31:28 INFO     epoch complete!
2024-09-01 22:31:28 INFO     evaluating now!
2024-09-01 22:31:29 INFO     Epoch [2/200] train_loss: 12.5302, val_loss: 12.0052, lr: 0.003000, 5.01s
2024-09-01 22:31:29 INFO     Saved model at 2
2024-09-01 22:31:29 INFO     Val loss decrease from 14.7519 to 12.0052, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-01 22:31:33 INFO     epoch complete!
2024-09-01 22:31:33 INFO     evaluating now!
2024-09-01 22:31:34 INFO     Epoch [3/200] train_loss: 10.4483, val_loss: 10.1007, lr: 0.003000, 5.02s
2024-09-01 22:31:34 INFO     Saved model at 3
2024-09-01 22:31:34 INFO     Val loss decrease from 12.0052 to 10.1007, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-01 22:31:38 INFO     epoch complete!
2024-09-01 22:31:38 INFO     evaluating now!
2024-09-01 22:31:39 INFO     Epoch [4/200] train_loss: 8.8590, val_loss: 8.5484, lr: 0.003000, 5.01s
2024-09-01 22:31:39 INFO     Saved model at 4
2024-09-01 22:31:39 INFO     Val loss decrease from 10.1007 to 8.5484, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-01 22:31:43 INFO     epoch complete!
2024-09-01 22:31:43 INFO     evaluating now!
2024-09-01 22:31:44 INFO     Epoch [5/200] train_loss: 8.0068, val_loss: 7.9656, lr: 0.003000, 5.01s
2024-09-01 22:31:44 INFO     Saved model at 5
2024-09-01 22:31:44 INFO     Val loss decrease from 8.5484 to 7.9656, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-01 22:31:48 INFO     epoch complete!
2024-09-01 22:31:48 INFO     evaluating now!
2024-09-01 22:31:49 INFO     Epoch [6/200] train_loss: 7.4616, val_loss: 7.0050, lr: 0.003000, 5.02s
2024-09-01 22:31:49 INFO     Saved model at 6
2024-09-01 22:31:49 INFO     Val loss decrease from 7.9656 to 7.0050, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-01 22:31:53 INFO     epoch complete!
2024-09-01 22:31:53 INFO     evaluating now!
2024-09-01 22:31:54 INFO     Epoch [7/200] train_loss: 6.9020, val_loss: 6.9188, lr: 0.003000, 5.01s
2024-09-01 22:31:54 INFO     Saved model at 7
2024-09-01 22:31:54 INFO     Val loss decrease from 7.0050 to 6.9188, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-01 22:31:58 INFO     epoch complete!
2024-09-01 22:31:58 INFO     evaluating now!
2024-09-01 22:31:59 INFO     Epoch [8/200] train_loss: 6.7738, val_loss: 6.6478, lr: 0.003000, 5.01s
2024-09-01 22:31:59 INFO     Saved model at 8
2024-09-01 22:31:59 INFO     Val loss decrease from 6.9188 to 6.6478, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-01 22:32:04 INFO     epoch complete!
2024-09-01 22:32:04 INFO     evaluating now!
2024-09-01 22:32:04 INFO     Epoch [9/200] train_loss: 6.2340, val_loss: 6.3710, lr: 0.003000, 5.02s
2024-09-01 22:32:04 INFO     Saved model at 9
2024-09-01 22:32:04 INFO     Val loss decrease from 6.6478 to 6.3710, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-01 22:32:09 INFO     epoch complete!
2024-09-01 22:32:09 INFO     evaluating now!
2024-09-01 22:32:09 INFO     Epoch [10/200] train_loss: 6.1451, val_loss: 6.1348, lr: 0.003000, 5.03s
2024-09-01 22:32:09 INFO     Saved model at 10
2024-09-01 22:32:09 INFO     Val loss decrease from 6.3710 to 6.1348, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-01 22:32:14 INFO     epoch complete!
2024-09-01 22:32:14 INFO     evaluating now!
2024-09-01 22:32:14 INFO     Epoch [11/200] train_loss: 5.9264, val_loss: 6.2562, lr: 0.003000, 5.03s
2024-09-01 22:32:19 INFO     epoch complete!
2024-09-01 22:32:19 INFO     evaluating now!
2024-09-01 22:32:19 INFO     Epoch [12/200] train_loss: 5.7551, val_loss: 6.0912, lr: 0.003000, 5.02s
2024-09-01 22:32:19 INFO     Saved model at 12
2024-09-01 22:32:19 INFO     Val loss decrease from 6.1348 to 6.0912, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-01 22:32:24 INFO     epoch complete!
2024-09-01 22:32:24 INFO     evaluating now!
2024-09-01 22:32:24 INFO     Epoch [13/200] train_loss: 5.6276, val_loss: 5.8421, lr: 0.003000, 5.02s
2024-09-01 22:32:24 INFO     Saved model at 13
2024-09-01 22:32:24 INFO     Val loss decrease from 6.0912 to 5.8421, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-01 22:32:29 INFO     epoch complete!
2024-09-01 22:32:29 INFO     evaluating now!
2024-09-01 22:32:29 INFO     Epoch [14/200] train_loss: 5.5432, val_loss: 5.9095, lr: 0.003000, 5.02s
2024-09-01 22:32:34 INFO     epoch complete!
2024-09-01 22:32:34 INFO     evaluating now!
2024-09-01 22:32:34 INFO     Epoch [15/200] train_loss: 5.3675, val_loss: 5.7452, lr: 0.003000, 5.02s
2024-09-01 22:32:34 INFO     Saved model at 15
2024-09-01 22:32:34 INFO     Val loss decrease from 5.8421 to 5.7452, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-01 22:32:39 INFO     epoch complete!
2024-09-01 22:32:39 INFO     evaluating now!
2024-09-01 22:32:39 INFO     Epoch [16/200] train_loss: 5.3560, val_loss: 5.5386, lr: 0.003000, 5.02s
2024-09-01 22:32:39 INFO     Saved model at 16
2024-09-01 22:32:39 INFO     Val loss decrease from 5.7452 to 5.5386, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-01 22:32:44 INFO     epoch complete!
2024-09-01 22:32:44 INFO     evaluating now!
2024-09-01 22:32:44 INFO     Epoch [17/200] train_loss: 5.2109, val_loss: 5.9132, lr: 0.003000, 5.03s
2024-09-01 22:32:49 INFO     epoch complete!
2024-09-01 22:32:49 INFO     evaluating now!
2024-09-01 22:32:49 INFO     Epoch [18/200] train_loss: 5.0956, val_loss: 5.3923, lr: 0.003000, 5.03s
2024-09-01 22:32:49 INFO     Saved model at 18
2024-09-01 22:32:49 INFO     Val loss decrease from 5.5386 to 5.3923, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-01 22:32:54 INFO     epoch complete!
2024-09-01 22:32:54 INFO     evaluating now!
2024-09-01 22:32:54 INFO     Epoch [19/200] train_loss: 5.0884, val_loss: 5.4036, lr: 0.003000, 5.03s
2024-09-01 22:32:59 INFO     epoch complete!
2024-09-01 22:32:59 INFO     evaluating now!
2024-09-01 22:32:59 INFO     Epoch [20/200] train_loss: 5.0282, val_loss: 5.2829, lr: 0.003000, 5.02s
2024-09-01 22:32:59 INFO     Saved model at 20
2024-09-01 22:32:59 INFO     Val loss decrease from 5.3923 to 5.2829, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-01 22:33:04 INFO     epoch complete!
2024-09-01 22:33:04 INFO     evaluating now!
2024-09-01 22:33:04 INFO     Epoch [21/200] train_loss: 4.9425, val_loss: 5.4290, lr: 0.003000, 5.04s
2024-09-01 22:33:09 INFO     epoch complete!
2024-09-01 22:33:09 INFO     evaluating now!
2024-09-01 22:33:09 INFO     Epoch [22/200] train_loss: 4.8445, val_loss: 5.4597, lr: 0.003000, 5.03s
2024-09-01 22:33:14 INFO     epoch complete!
2024-09-01 22:33:14 INFO     evaluating now!
2024-09-01 22:33:14 INFO     Epoch [23/200] train_loss: 4.7957, val_loss: 5.1195, lr: 0.003000, 5.03s
2024-09-01 22:33:14 INFO     Saved model at 23
2024-09-01 22:33:14 INFO     Val loss decrease from 5.2829 to 5.1195, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-01 22:33:19 INFO     epoch complete!
2024-09-01 22:33:19 INFO     evaluating now!
2024-09-01 22:33:19 INFO     Epoch [24/200] train_loss: 4.7233, val_loss: 5.5029, lr: 0.003000, 5.03s
2024-09-01 22:33:24 INFO     epoch complete!
2024-09-01 22:33:24 INFO     evaluating now!
2024-09-01 22:33:24 INFO     Epoch [25/200] train_loss: 4.7254, val_loss: 5.4338, lr: 0.003000, 5.02s
2024-09-01 22:33:29 INFO     epoch complete!
2024-09-01 22:33:29 INFO     evaluating now!
2024-09-01 22:33:29 INFO     Epoch [26/200] train_loss: 4.6439, val_loss: 5.3580, lr: 0.003000, 5.03s
2024-09-01 22:33:34 INFO     epoch complete!
2024-09-01 22:33:34 INFO     evaluating now!
2024-09-01 22:33:34 INFO     Epoch [27/200] train_loss: 4.5437, val_loss: 5.2807, lr: 0.003000, 5.02s
2024-09-01 22:33:39 INFO     epoch complete!
2024-09-01 22:33:39 INFO     evaluating now!
2024-09-01 22:33:39 INFO     Epoch [28/200] train_loss: 4.5359, val_loss: 5.3855, lr: 0.003000, 5.03s
2024-09-01 22:33:44 INFO     epoch complete!
2024-09-01 22:33:44 INFO     evaluating now!
2024-09-01 22:33:44 INFO     Epoch [29/200] train_loss: 4.4889, val_loss: 5.1885, lr: 0.003000, 5.02s
2024-09-01 22:33:49 INFO     epoch complete!
2024-09-01 22:33:49 INFO     evaluating now!
2024-09-01 22:33:50 INFO     Epoch [30/200] train_loss: 4.4699, val_loss: 5.2587, lr: 0.003000, 5.03s
2024-09-01 22:33:54 INFO     epoch complete!
2024-09-01 22:33:54 INFO     evaluating now!
2024-09-01 22:33:55 INFO     Epoch [31/200] train_loss: 4.4046, val_loss: 5.2699, lr: 0.003000, 5.02s
2024-09-01 22:33:59 INFO     epoch complete!
2024-09-01 22:33:59 INFO     evaluating now!
2024-09-01 22:34:00 INFO     Epoch [32/200] train_loss: 4.4121, val_loss: 5.2937, lr: 0.003000, 5.03s
2024-09-01 22:34:04 INFO     epoch complete!
2024-09-01 22:34:04 INFO     evaluating now!
2024-09-01 22:34:05 INFO     Epoch [33/200] train_loss: 4.4149, val_loss: 5.2463, lr: 0.003000, 5.02s
2024-09-01 22:34:09 INFO     epoch complete!
2024-09-01 22:34:09 INFO     evaluating now!
2024-09-01 22:34:10 INFO     Epoch [34/200] train_loss: 4.3869, val_loss: 5.3996, lr: 0.003000, 5.02s
2024-09-01 22:34:14 INFO     epoch complete!
2024-09-01 22:34:14 INFO     evaluating now!
2024-09-01 22:34:15 INFO     Epoch [35/200] train_loss: 4.3525, val_loss: 5.2577, lr: 0.003000, 5.03s
2024-09-01 22:34:19 INFO     epoch complete!
2024-09-01 22:34:19 INFO     evaluating now!
2024-09-01 22:34:20 INFO     Epoch [36/200] train_loss: 4.2330, val_loss: 5.1556, lr: 0.003000, 5.02s
2024-09-01 22:34:24 INFO     epoch complete!
2024-09-01 22:34:24 INFO     evaluating now!
2024-09-01 22:34:25 INFO     Epoch [37/200] train_loss: 4.2513, val_loss: 5.0739, lr: 0.003000, 5.02s
2024-09-01 22:34:25 INFO     Saved model at 37
2024-09-01 22:34:25 INFO     Val loss decrease from 5.1195 to 5.0739, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-09-01 22:34:29 INFO     epoch complete!
2024-09-01 22:34:29 INFO     evaluating now!
2024-09-01 22:34:30 INFO     Epoch [38/200] train_loss: 4.1655, val_loss: 5.1370, lr: 0.003000, 5.03s
2024-09-01 22:34:34 INFO     epoch complete!
2024-09-01 22:34:34 INFO     evaluating now!
2024-09-01 22:34:35 INFO     Epoch [39/200] train_loss: 4.1340, val_loss: 5.1435, lr: 0.003000, 5.03s
2024-09-01 22:34:39 INFO     epoch complete!
2024-09-01 22:34:39 INFO     evaluating now!
2024-09-01 22:34:40 INFO     Epoch [40/200] train_loss: 4.0631, val_loss: 5.0679, lr: 0.003000, 5.02s
2024-09-01 22:34:40 INFO     Saved model at 40
2024-09-01 22:34:40 INFO     Val loss decrease from 5.0739 to 5.0679, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-09-01 22:34:45 INFO     epoch complete!
2024-09-01 22:34:45 INFO     evaluating now!
2024-09-01 22:34:45 INFO     Epoch [41/200] train_loss: 4.0392, val_loss: 5.1033, lr: 0.003000, 5.02s
2024-09-01 22:34:50 INFO     epoch complete!
2024-09-01 22:34:50 INFO     evaluating now!
2024-09-01 22:34:50 INFO     Epoch [42/200] train_loss: 4.0833, val_loss: 5.0291, lr: 0.003000, 5.02s
2024-09-01 22:34:50 INFO     Saved model at 42
2024-09-01 22:34:50 INFO     Val loss decrease from 5.0679 to 5.0291, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-09-01 22:34:55 INFO     epoch complete!
2024-09-01 22:34:55 INFO     evaluating now!
2024-09-01 22:34:55 INFO     Epoch [43/200] train_loss: 4.0940, val_loss: 4.9212, lr: 0.003000, 5.02s
2024-09-01 22:34:55 INFO     Saved model at 43
2024-09-01 22:34:55 INFO     Val loss decrease from 5.0291 to 4.9212, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-09-01 22:35:00 INFO     epoch complete!
2024-09-01 22:35:00 INFO     evaluating now!
2024-09-01 22:35:00 INFO     Epoch [44/200] train_loss: 3.9899, val_loss: 5.1891, lr: 0.003000, 5.02s
2024-09-01 22:35:05 INFO     epoch complete!
2024-09-01 22:35:05 INFO     evaluating now!
2024-09-01 22:35:05 INFO     Epoch [45/200] train_loss: 4.0684, val_loss: 5.3682, lr: 0.003000, 5.02s
2024-09-01 22:35:10 INFO     epoch complete!
2024-09-01 22:35:10 INFO     evaluating now!
2024-09-01 22:35:10 INFO     Epoch [46/200] train_loss: 4.2144, val_loss: 5.0260, lr: 0.003000, 5.02s
2024-09-01 22:35:15 INFO     epoch complete!
2024-09-01 22:35:15 INFO     evaluating now!
2024-09-01 22:35:15 INFO     Epoch [47/200] train_loss: 3.9861, val_loss: 4.9967, lr: 0.003000, 5.02s
2024-09-01 22:35:20 INFO     epoch complete!
2024-09-01 22:35:20 INFO     evaluating now!
2024-09-01 22:35:20 INFO     Epoch [48/200] train_loss: 3.8999, val_loss: 4.9642, lr: 0.003000, 5.02s
2024-09-01 22:35:25 INFO     epoch complete!
2024-09-01 22:35:25 INFO     evaluating now!
2024-09-01 22:35:25 INFO     Epoch [49/200] train_loss: 3.8909, val_loss: 4.9505, lr: 0.003000, 5.02s
2024-09-01 22:35:30 INFO     epoch complete!
2024-09-01 22:35:30 INFO     evaluating now!
2024-09-01 22:35:30 INFO     Epoch [50/200] train_loss: 3.8944, val_loss: 5.0407, lr: 0.003000, 5.02s
2024-09-01 22:35:35 INFO     epoch complete!
2024-09-01 22:35:35 INFO     evaluating now!
2024-09-01 22:35:35 INFO     Epoch [51/200] train_loss: 3.8325, val_loss: 4.9297, lr: 0.003000, 5.02s
2024-09-01 22:35:40 INFO     epoch complete!
2024-09-01 22:35:40 INFO     evaluating now!
2024-09-01 22:35:40 INFO     Epoch [52/200] train_loss: 3.7769, val_loss: 4.9578, lr: 0.003000, 5.02s
2024-09-01 22:35:45 INFO     epoch complete!
2024-09-01 22:35:45 INFO     evaluating now!
2024-09-01 22:35:45 INFO     Epoch [53/200] train_loss: 3.7995, val_loss: 5.0630, lr: 0.003000, 5.01s
2024-09-01 22:35:50 INFO     epoch complete!
2024-09-01 22:35:50 INFO     evaluating now!
2024-09-01 22:35:50 INFO     Epoch [54/200] train_loss: 3.7925, val_loss: 5.0704, lr: 0.003000, 5.02s
2024-09-01 22:35:55 INFO     epoch complete!
2024-09-01 22:35:55 INFO     evaluating now!
2024-09-01 22:35:55 INFO     Epoch [55/200] train_loss: 3.7895, val_loss: 5.1485, lr: 0.003000, 5.02s
2024-09-01 22:36:00 INFO     epoch complete!
2024-09-01 22:36:00 INFO     evaluating now!
2024-09-01 22:36:00 INFO     Epoch [56/200] train_loss: 3.7713, val_loss: 5.0428, lr: 0.003000, 5.02s
2024-09-01 22:36:05 INFO     epoch complete!
2024-09-01 22:36:05 INFO     evaluating now!
2024-09-01 22:36:05 INFO     Epoch [57/200] train_loss: 3.7016, val_loss: 5.0385, lr: 0.003000, 5.02s
2024-09-01 22:36:10 INFO     epoch complete!
2024-09-01 22:36:10 INFO     evaluating now!
2024-09-01 22:36:10 INFO     Epoch [58/200] train_loss: 3.7070, val_loss: 5.0160, lr: 0.003000, 5.02s
2024-09-01 22:36:10 WARNING  Early stopping at epoch: 58
2024-09-01 22:36:10 INFO     Trained totally 59 epochs, average train time is 4.729s, average eval time is 0.299s
2024-09-01 22:36:10 INFO     Loaded model at 43
2024-09-01 22:36:10 INFO     Saved model at ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406.m
2024-09-01 22:36:10 INFO     Start evaluating ...
2024-09-01 22:36:11 INFO     Note that you select the single mode to evaluate!
2024-09-01 22:36:11 INFO     Evaluate result is saved at ./libcity/cache/30/evaluate_cache\2024_09_01_22_36_11_AGCRN_CHITaxi20190406.csv
2024-09-01 22:36:11 INFO     
         MAE       RMSE
1   2.463778   6.960784
2   2.613760   7.734273
3   2.710613   8.641150
4   2.883859   9.282255
5   2.990091   9.963341
6   3.104160  10.716823
7   3.209085  11.396694
8   3.262239  12.026931
9   3.275338  12.531464
10  3.320171  12.969837
11  3.372808  13.516900
12  3.470772  14.266568
2024-09-01 22:36:11 INFO     ----------------------------------------------------------------------------
2024-09-01 22:36:11 INFO     # 3, Kownledge Graph Embedding: RotH, Experiment ids: 33
2024-09-01 22:36:11 INFO     ----------------------------------------------------------------------------
2024-09-01 22:36:11 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=30
2024-09-01 22:36:11 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 30, 'embedding_model': 'RotH', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-01 22:36:11 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-01 22:36:11 INFO     set_weight_link_or_dist: dist
2024-09-01 22:36:11 INFO     init_weight_inf_or_zero: inf
2024-09-01 22:36:11 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-01 22:36:11 INFO     Start Calculate the weight by Gauss kernel!
2024-09-01 22:36:11 INFO     Loading file CHITaxi20190406.dyna
2024-09-01 22:36:11 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-01 22:36:13 INFO     Dataset created
2024-09-01 22:36:13 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-01 22:36:13 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-01 22:36:13 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-01 22:36:13 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-01 22:36:13 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-01 22:36:13 INFO     NormalScaler max: 0.44321246163773476
2024-09-01 22:36:15 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-01 22:36:15 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-01 22:36:15 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-01 22:36:15 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 22:36:15 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-01 22:36:15 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 22:36:15 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-01 22:36:15 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 22:36:15 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-01 22:36:15 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 22:36:15 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-01 22:36:15 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-01 22:36:15 INFO     Total parameter numbers: 874010
2024-09-01 22:36:15 INFO     You select `adam` optimizer.
2024-09-01 22:36:15 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-01 22:36:15 INFO     Start training ...
2024-09-01 22:36:15 INFO     num_batches:48
2024-09-01 22:36:20 INFO     epoch complete!
2024-09-01 22:36:20 INFO     evaluating now!
2024-09-01 22:36:20 INFO     Epoch [0/200] train_loss: 23.7728, val_loss: 18.3811, lr: 0.003000, 5.19s
2024-09-01 22:36:20 INFO     Saved model at 0
2024-09-01 22:36:20 INFO     Val loss decrease from inf to 18.3811, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-01 22:36:25 INFO     epoch complete!
2024-09-01 22:36:25 INFO     evaluating now!
2024-09-01 22:36:25 INFO     Epoch [1/200] train_loss: 14.9785, val_loss: 14.2656, lr: 0.003000, 5.01s
2024-09-01 22:36:25 INFO     Saved model at 1
2024-09-01 22:36:25 INFO     Val loss decrease from 18.3811 to 14.2656, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-01 22:36:30 INFO     epoch complete!
2024-09-01 22:36:30 INFO     evaluating now!
2024-09-01 22:36:30 INFO     Epoch [2/200] train_loss: 11.9462, val_loss: 11.7934, lr: 0.003000, 5.02s
2024-09-01 22:36:30 INFO     Saved model at 2
2024-09-01 22:36:30 INFO     Val loss decrease from 14.2656 to 11.7934, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-01 22:36:35 INFO     epoch complete!
2024-09-01 22:36:35 INFO     evaluating now!
2024-09-01 22:36:35 INFO     Epoch [3/200] train_loss: 9.8846, val_loss: 9.5673, lr: 0.003000, 5.02s
2024-09-01 22:36:35 INFO     Saved model at 3
2024-09-01 22:36:35 INFO     Val loss decrease from 11.7934 to 9.5673, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-01 22:36:40 INFO     epoch complete!
2024-09-01 22:36:40 INFO     evaluating now!
2024-09-01 22:36:40 INFO     Epoch [4/200] train_loss: 8.4981, val_loss: 8.2396, lr: 0.003000, 5.01s
2024-09-01 22:36:40 INFO     Saved model at 4
2024-09-01 22:36:40 INFO     Val loss decrease from 9.5673 to 8.2396, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-01 22:36:45 INFO     epoch complete!
2024-09-01 22:36:45 INFO     evaluating now!
2024-09-01 22:36:45 INFO     Epoch [5/200] train_loss: 7.7234, val_loss: 7.7013, lr: 0.003000, 5.01s
2024-09-01 22:36:45 INFO     Saved model at 5
2024-09-01 22:36:45 INFO     Val loss decrease from 8.2396 to 7.7013, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-01 22:36:50 INFO     epoch complete!
2024-09-01 22:36:50 INFO     evaluating now!
2024-09-01 22:36:50 INFO     Epoch [6/200] train_loss: 7.0133, val_loss: 6.8601, lr: 0.003000, 5.02s
2024-09-01 22:36:51 INFO     Saved model at 6
2024-09-01 22:36:51 INFO     Val loss decrease from 7.7013 to 6.8601, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-01 22:36:55 INFO     epoch complete!
2024-09-01 22:36:55 INFO     evaluating now!
2024-09-01 22:36:56 INFO     Epoch [7/200] train_loss: 6.5718, val_loss: 6.7607, lr: 0.003000, 5.03s
2024-09-01 22:36:56 INFO     Saved model at 7
2024-09-01 22:36:56 INFO     Val loss decrease from 6.8601 to 6.7607, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-01 22:37:00 INFO     epoch complete!
2024-09-01 22:37:00 INFO     evaluating now!
2024-09-01 22:37:01 INFO     Epoch [8/200] train_loss: 6.3341, val_loss: 6.2247, lr: 0.003000, 5.03s
2024-09-01 22:37:01 INFO     Saved model at 8
2024-09-01 22:37:01 INFO     Val loss decrease from 6.7607 to 6.2247, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-01 22:37:05 INFO     epoch complete!
2024-09-01 22:37:05 INFO     evaluating now!
2024-09-01 22:37:06 INFO     Epoch [9/200] train_loss: 6.0516, val_loss: 6.1429, lr: 0.003000, 5.03s
2024-09-01 22:37:06 INFO     Saved model at 9
2024-09-01 22:37:06 INFO     Val loss decrease from 6.2247 to 6.1429, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-01 22:37:10 INFO     epoch complete!
2024-09-01 22:37:10 INFO     evaluating now!
2024-09-01 22:37:11 INFO     Epoch [10/200] train_loss: 5.9157, val_loss: 6.2336, lr: 0.003000, 5.03s
2024-09-01 22:37:15 INFO     epoch complete!
2024-09-01 22:37:15 INFO     evaluating now!
2024-09-01 22:37:16 INFO     Epoch [11/200] train_loss: 5.6519, val_loss: 5.7330, lr: 0.003000, 5.03s
2024-09-01 22:37:16 INFO     Saved model at 11
2024-09-01 22:37:16 INFO     Val loss decrease from 6.1429 to 5.7330, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-01 22:37:20 INFO     epoch complete!
2024-09-01 22:37:20 INFO     evaluating now!
2024-09-01 22:37:21 INFO     Epoch [12/200] train_loss: 5.5233, val_loss: 5.8121, lr: 0.003000, 5.02s
2024-09-01 22:37:25 INFO     epoch complete!
2024-09-01 22:37:25 INFO     evaluating now!
2024-09-01 22:37:26 INFO     Epoch [13/200] train_loss: 5.4027, val_loss: 5.7522, lr: 0.003000, 5.03s
2024-09-01 22:37:30 INFO     epoch complete!
2024-09-01 22:37:30 INFO     evaluating now!
2024-09-01 22:37:31 INFO     Epoch [14/200] train_loss: 5.3376, val_loss: 5.7658, lr: 0.003000, 5.03s
2024-09-01 22:37:36 INFO     epoch complete!
2024-09-01 22:37:36 INFO     evaluating now!
2024-09-01 22:37:36 INFO     Epoch [15/200] train_loss: 5.2078, val_loss: 5.6541, lr: 0.003000, 5.03s
2024-09-01 22:37:36 INFO     Saved model at 15
2024-09-01 22:37:36 INFO     Val loss decrease from 5.7330 to 5.6541, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-01 22:37:41 INFO     epoch complete!
2024-09-01 22:37:41 INFO     evaluating now!
2024-09-01 22:37:41 INFO     Epoch [16/200] train_loss: 5.1627, val_loss: 5.7478, lr: 0.003000, 5.02s
2024-09-01 22:37:46 INFO     epoch complete!
2024-09-01 22:37:46 INFO     evaluating now!
2024-09-01 22:37:46 INFO     Epoch [17/200] train_loss: 5.0847, val_loss: 5.4225, lr: 0.003000, 5.02s
2024-09-01 22:37:46 INFO     Saved model at 17
2024-09-01 22:37:46 INFO     Val loss decrease from 5.6541 to 5.4225, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-01 22:37:51 INFO     epoch complete!
2024-09-01 22:37:51 INFO     evaluating now!
2024-09-01 22:37:51 INFO     Epoch [18/200] train_loss: 5.0049, val_loss: 5.4201, lr: 0.003000, 5.04s
2024-09-01 22:37:51 INFO     Saved model at 18
2024-09-01 22:37:51 INFO     Val loss decrease from 5.4225 to 5.4201, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-01 22:37:56 INFO     epoch complete!
2024-09-01 22:37:56 INFO     evaluating now!
2024-09-01 22:37:56 INFO     Epoch [19/200] train_loss: 5.0761, val_loss: 5.7707, lr: 0.003000, 5.02s
2024-09-01 22:38:01 INFO     epoch complete!
2024-09-01 22:38:01 INFO     evaluating now!
2024-09-01 22:38:01 INFO     Epoch [20/200] train_loss: 4.8939, val_loss: 5.3497, lr: 0.003000, 5.02s
2024-09-01 22:38:01 INFO     Saved model at 20
2024-09-01 22:38:01 INFO     Val loss decrease from 5.4201 to 5.3497, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-01 22:38:06 INFO     epoch complete!
2024-09-01 22:38:06 INFO     evaluating now!
2024-09-01 22:38:06 INFO     Epoch [21/200] train_loss: 4.7458, val_loss: 5.4361, lr: 0.003000, 5.03s
2024-09-01 22:38:11 INFO     epoch complete!
2024-09-01 22:38:11 INFO     evaluating now!
2024-09-01 22:38:11 INFO     Epoch [22/200] train_loss: 4.7041, val_loss: 5.1673, lr: 0.003000, 5.03s
2024-09-01 22:38:11 INFO     Saved model at 22
2024-09-01 22:38:11 INFO     Val loss decrease from 5.3497 to 5.1673, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-01 22:38:16 INFO     epoch complete!
2024-09-01 22:38:16 INFO     evaluating now!
2024-09-01 22:38:16 INFO     Epoch [23/200] train_loss: 4.6296, val_loss: 5.2555, lr: 0.003000, 5.03s
2024-09-01 22:38:21 INFO     epoch complete!
2024-09-01 22:38:21 INFO     evaluating now!
2024-09-01 22:38:21 INFO     Epoch [24/200] train_loss: 4.5910, val_loss: 5.2652, lr: 0.003000, 5.02s
2024-09-01 22:38:26 INFO     epoch complete!
2024-09-01 22:38:26 INFO     evaluating now!
2024-09-01 22:38:26 INFO     Epoch [25/200] train_loss: 4.5813, val_loss: 5.2200, lr: 0.003000, 5.02s
2024-09-01 22:38:31 INFO     epoch complete!
2024-09-01 22:38:31 INFO     evaluating now!
2024-09-01 22:38:31 INFO     Epoch [26/200] train_loss: 4.5026, val_loss: 5.1971, lr: 0.003000, 5.02s
2024-09-01 22:38:36 INFO     epoch complete!
2024-09-01 22:38:36 INFO     evaluating now!
2024-09-01 22:38:36 INFO     Epoch [27/200] train_loss: 4.5057, val_loss: 5.2584, lr: 0.003000, 5.03s
2024-09-01 22:38:41 INFO     epoch complete!
2024-09-01 22:38:41 INFO     evaluating now!
2024-09-01 22:38:41 INFO     Epoch [28/200] train_loss: 4.4149, val_loss: 5.2299, lr: 0.003000, 5.02s
2024-09-01 22:38:46 INFO     epoch complete!
2024-09-01 22:38:46 INFO     evaluating now!
2024-09-01 22:38:46 INFO     Epoch [29/200] train_loss: 4.4206, val_loss: 5.1515, lr: 0.003000, 5.03s
2024-09-01 22:38:46 INFO     Saved model at 29
2024-09-01 22:38:46 INFO     Val loss decrease from 5.1673 to 5.1515, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-01 22:38:51 INFO     epoch complete!
2024-09-01 22:38:51 INFO     evaluating now!
2024-09-01 22:38:51 INFO     Epoch [30/200] train_loss: 4.3785, val_loss: 5.0861, lr: 0.003000, 5.03s
2024-09-01 22:38:51 INFO     Saved model at 30
2024-09-01 22:38:51 INFO     Val loss decrease from 5.1515 to 5.0861, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-09-01 22:38:56 INFO     epoch complete!
2024-09-01 22:38:56 INFO     evaluating now!
2024-09-01 22:38:56 INFO     Epoch [31/200] train_loss: 4.2456, val_loss: 5.1955, lr: 0.003000, 5.02s
2024-09-01 22:39:01 INFO     epoch complete!
2024-09-01 22:39:01 INFO     evaluating now!
2024-09-01 22:39:01 INFO     Epoch [32/200] train_loss: 4.2535, val_loss: 5.1508, lr: 0.003000, 5.03s
2024-09-01 22:39:06 INFO     epoch complete!
2024-09-01 22:39:06 INFO     evaluating now!
2024-09-01 22:39:06 INFO     Epoch [33/200] train_loss: 4.3305, val_loss: 5.3711, lr: 0.003000, 5.02s
2024-09-01 22:39:11 INFO     epoch complete!
2024-09-01 22:39:11 INFO     evaluating now!
2024-09-01 22:39:11 INFO     Epoch [34/200] train_loss: 4.2624, val_loss: 5.2977, lr: 0.003000, 5.03s
2024-09-01 22:39:16 INFO     epoch complete!
2024-09-01 22:39:16 INFO     evaluating now!
2024-09-01 22:39:16 INFO     Epoch [35/200] train_loss: 4.1867, val_loss: 5.0279, lr: 0.003000, 5.03s
2024-09-01 22:39:16 INFO     Saved model at 35
2024-09-01 22:39:16 INFO     Val loss decrease from 5.0861 to 5.0279, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-01 22:39:21 INFO     epoch complete!
2024-09-01 22:39:21 INFO     evaluating now!
2024-09-01 22:39:21 INFO     Epoch [36/200] train_loss: 4.1610, val_loss: 5.3690, lr: 0.003000, 5.03s
2024-09-01 22:39:26 INFO     epoch complete!
2024-09-01 22:39:26 INFO     evaluating now!
2024-09-01 22:39:26 INFO     Epoch [37/200] train_loss: 4.1461, val_loss: 5.2831, lr: 0.003000, 5.02s
2024-09-01 22:39:31 INFO     epoch complete!
2024-09-01 22:39:31 INFO     evaluating now!
2024-09-01 22:39:32 INFO     Epoch [38/200] train_loss: 4.1488, val_loss: 5.0703, lr: 0.003000, 5.03s
2024-09-01 22:39:36 INFO     epoch complete!
2024-09-01 22:39:36 INFO     evaluating now!
2024-09-01 22:39:37 INFO     Epoch [39/200] train_loss: 4.0865, val_loss: 5.0908, lr: 0.003000, 5.02s
2024-09-01 22:39:41 INFO     epoch complete!
2024-09-01 22:39:41 INFO     evaluating now!
2024-09-01 22:39:42 INFO     Epoch [40/200] train_loss: 4.0582, val_loss: 5.1630, lr: 0.003000, 5.03s
2024-09-01 22:39:46 INFO     epoch complete!
2024-09-01 22:39:46 INFO     evaluating now!
2024-09-01 22:39:47 INFO     Epoch [41/200] train_loss: 4.0030, val_loss: 5.1165, lr: 0.003000, 5.02s
2024-09-01 22:39:51 INFO     epoch complete!
2024-09-01 22:39:51 INFO     evaluating now!
2024-09-01 22:39:52 INFO     Epoch [42/200] train_loss: 3.9620, val_loss: 5.1480, lr: 0.003000, 5.02s
2024-09-01 22:39:56 INFO     epoch complete!
2024-09-01 22:39:56 INFO     evaluating now!
2024-09-01 22:39:57 INFO     Epoch [43/200] train_loss: 3.9889, val_loss: 5.0687, lr: 0.003000, 5.03s
2024-09-01 22:40:01 INFO     epoch complete!
2024-09-01 22:40:01 INFO     evaluating now!
2024-09-01 22:40:02 INFO     Epoch [44/200] train_loss: 3.9548, val_loss: 5.2869, lr: 0.003000, 5.03s
2024-09-01 22:40:06 INFO     epoch complete!
2024-09-01 22:40:06 INFO     evaluating now!
2024-09-01 22:40:07 INFO     Epoch [45/200] train_loss: 3.9452, val_loss: 5.0042, lr: 0.003000, 5.02s
2024-09-01 22:40:07 INFO     Saved model at 45
2024-09-01 22:40:07 INFO     Val loss decrease from 5.0279 to 5.0042, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-09-01 22:40:11 INFO     epoch complete!
2024-09-01 22:40:11 INFO     evaluating now!
2024-09-01 22:40:12 INFO     Epoch [46/200] train_loss: 3.9448, val_loss: 5.1797, lr: 0.003000, 5.03s
2024-09-01 22:40:16 INFO     epoch complete!
2024-09-01 22:40:16 INFO     evaluating now!
2024-09-01 22:40:17 INFO     Epoch [47/200] train_loss: 3.8570, val_loss: 5.0304, lr: 0.003000, 5.03s
2024-09-01 22:40:21 INFO     epoch complete!
2024-09-01 22:40:21 INFO     evaluating now!
2024-09-01 22:40:22 INFO     Epoch [48/200] train_loss: 3.8301, val_loss: 5.0652, lr: 0.003000, 5.02s
2024-09-01 22:40:26 INFO     epoch complete!
2024-09-01 22:40:26 INFO     evaluating now!
2024-09-01 22:40:27 INFO     Epoch [49/200] train_loss: 3.8383, val_loss: 5.3691, lr: 0.003000, 5.02s
2024-09-01 22:40:32 INFO     epoch complete!
2024-09-01 22:40:32 INFO     evaluating now!
2024-09-01 22:40:32 INFO     Epoch [50/200] train_loss: 3.8845, val_loss: 5.1609, lr: 0.003000, 5.02s
2024-09-01 22:40:37 INFO     epoch complete!
2024-09-01 22:40:37 INFO     evaluating now!
2024-09-01 22:40:37 INFO     Epoch [51/200] train_loss: 3.9224, val_loss: 5.1127, lr: 0.003000, 5.03s
2024-09-01 22:40:42 INFO     epoch complete!
2024-09-01 22:40:42 INFO     evaluating now!
2024-09-01 22:40:42 INFO     Epoch [52/200] train_loss: 3.8051, val_loss: 5.1041, lr: 0.003000, 5.02s
2024-09-01 22:40:47 INFO     epoch complete!
2024-09-01 22:40:47 INFO     evaluating now!
2024-09-01 22:40:47 INFO     Epoch [53/200] train_loss: 3.7744, val_loss: 5.1955, lr: 0.003000, 5.03s
2024-09-01 22:40:52 INFO     epoch complete!
2024-09-01 22:40:52 INFO     evaluating now!
2024-09-01 22:40:52 INFO     Epoch [54/200] train_loss: 3.7589, val_loss: 5.2113, lr: 0.003000, 5.04s
2024-09-01 22:40:57 INFO     epoch complete!
2024-09-01 22:40:57 INFO     evaluating now!
2024-09-01 22:40:57 INFO     Epoch [55/200] train_loss: 3.7294, val_loss: 5.0451, lr: 0.003000, 5.03s
2024-09-01 22:41:02 INFO     epoch complete!
2024-09-01 22:41:02 INFO     evaluating now!
2024-09-01 22:41:02 INFO     Epoch [56/200] train_loss: 3.7286, val_loss: 5.1085, lr: 0.003000, 5.02s
2024-09-01 22:41:07 INFO     epoch complete!
2024-09-01 22:41:07 INFO     evaluating now!
2024-09-01 22:41:07 INFO     Epoch [57/200] train_loss: 3.6877, val_loss: 5.0946, lr: 0.003000, 5.02s
2024-09-01 22:41:12 INFO     epoch complete!
2024-09-01 22:41:12 INFO     evaluating now!
2024-09-01 22:41:12 INFO     Epoch [58/200] train_loss: 3.7271, val_loss: 5.2379, lr: 0.003000, 5.03s
2024-09-01 22:41:17 INFO     epoch complete!
2024-09-01 22:41:17 INFO     evaluating now!
2024-09-01 22:41:17 INFO     Epoch [59/200] train_loss: 3.7541, val_loss: 5.1806, lr: 0.003000, 5.03s
2024-09-01 22:41:22 INFO     epoch complete!
2024-09-01 22:41:22 INFO     evaluating now!
2024-09-01 22:41:22 INFO     Epoch [60/200] train_loss: 3.7484, val_loss: 5.2209, lr: 0.003000, 5.03s
2024-09-01 22:41:22 WARNING  Early stopping at epoch: 60
2024-09-01 22:41:22 INFO     Trained totally 61 epochs, average train time is 4.728s, average eval time is 0.299s
2024-09-01 22:41:22 INFO     Loaded model at 45
2024-09-01 22:41:22 INFO     Saved model at ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406.m
2024-09-01 22:41:22 INFO     Start evaluating ...
2024-09-01 22:41:23 INFO     Note that you select the single mode to evaluate!
2024-09-01 22:41:23 INFO     Evaluate result is saved at ./libcity/cache/30/evaluate_cache\2024_09_01_22_41_23_AGCRN_CHITaxi20190406.csv
2024-09-01 22:41:23 INFO     
         MAE       RMSE
1   2.437141   7.268138
2   2.556307   7.748664
3   2.672891   8.602498
4   2.799543   9.311506
5   2.977548  10.084558
6   3.044877  10.830599
7   3.189111  11.252478
8   3.224628  11.674345
9   3.308302  12.046095
10  3.284585  12.520361
11  3.367492  12.997897
12  3.513911  13.842280
2024-09-01 22:41:23 INFO     ----------------------------------------------------------------------------
2024-09-01 22:41:23 INFO     # 4, Kownledge Graph Embedding: RotH, Experiment ids: 34
2024-09-01 22:41:23 INFO     ----------------------------------------------------------------------------
2024-09-01 22:41:23 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=30
2024-09-01 22:41:23 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 30, 'embedding_model': 'RotH', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-01 22:41:23 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-01 22:41:23 INFO     set_weight_link_or_dist: dist
2024-09-01 22:41:23 INFO     init_weight_inf_or_zero: inf
2024-09-01 22:41:23 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-01 22:41:23 INFO     Start Calculate the weight by Gauss kernel!
2024-09-01 22:41:23 INFO     Loading file CHITaxi20190406.dyna
2024-09-01 22:41:23 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-01 22:41:25 INFO     Dataset created
2024-09-01 22:41:25 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-01 22:41:25 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-01 22:41:25 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-01 22:41:25 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-01 22:41:25 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-01 22:41:25 INFO     NormalScaler max: 0.44321246163773476
2024-09-01 22:41:27 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-01 22:41:27 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-01 22:41:27 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-01 22:41:27 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 22:41:27 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-01 22:41:27 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 22:41:27 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-01 22:41:27 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 22:41:27 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-01 22:41:27 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 22:41:27 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-01 22:41:27 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-01 22:41:27 INFO     Total parameter numbers: 874010
2024-09-01 22:41:27 INFO     You select `adam` optimizer.
2024-09-01 22:41:27 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-01 22:41:27 INFO     Start training ...
2024-09-01 22:41:27 INFO     num_batches:48
2024-09-01 22:41:32 INFO     epoch complete!
2024-09-01 22:41:32 INFO     evaluating now!
2024-09-01 22:41:32 INFO     Epoch [0/200] train_loss: 24.9449, val_loss: 18.5629, lr: 0.003000, 5.23s
2024-09-01 22:41:32 INFO     Saved model at 0
2024-09-01 22:41:32 INFO     Val loss decrease from inf to 18.5629, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-01 22:41:37 INFO     epoch complete!
2024-09-01 22:41:37 INFO     evaluating now!
2024-09-01 22:41:37 INFO     Epoch [1/200] train_loss: 15.5511, val_loss: 15.1304, lr: 0.003000, 5.02s
2024-09-01 22:41:37 INFO     Saved model at 1
2024-09-01 22:41:37 INFO     Val loss decrease from 18.5629 to 15.1304, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-01 22:41:42 INFO     epoch complete!
2024-09-01 22:41:42 INFO     evaluating now!
2024-09-01 22:41:42 INFO     Epoch [2/200] train_loss: 12.5917, val_loss: 12.3663, lr: 0.003000, 5.02s
2024-09-01 22:41:42 INFO     Saved model at 2
2024-09-01 22:41:42 INFO     Val loss decrease from 15.1304 to 12.3663, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-01 22:41:47 INFO     epoch complete!
2024-09-01 22:41:47 INFO     evaluating now!
2024-09-01 22:41:47 INFO     Epoch [3/200] train_loss: 10.4802, val_loss: 10.1780, lr: 0.003000, 5.02s
2024-09-01 22:41:47 INFO     Saved model at 3
2024-09-01 22:41:47 INFO     Val loss decrease from 12.3663 to 10.1780, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-01 22:41:52 INFO     epoch complete!
2024-09-01 22:41:52 INFO     evaluating now!
2024-09-01 22:41:52 INFO     Epoch [4/200] train_loss: 8.9511, val_loss: 9.1102, lr: 0.003000, 5.02s
2024-09-01 22:41:52 INFO     Saved model at 4
2024-09-01 22:41:52 INFO     Val loss decrease from 10.1780 to 9.1102, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-01 22:41:57 INFO     epoch complete!
2024-09-01 22:41:57 INFO     evaluating now!
2024-09-01 22:41:57 INFO     Epoch [5/200] train_loss: 8.1013, val_loss: 8.1592, lr: 0.003000, 5.01s
2024-09-01 22:41:57 INFO     Saved model at 5
2024-09-01 22:41:57 INFO     Val loss decrease from 9.1102 to 8.1592, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-01 22:42:02 INFO     epoch complete!
2024-09-01 22:42:02 INFO     evaluating now!
2024-09-01 22:42:02 INFO     Epoch [6/200] train_loss: 7.3823, val_loss: 7.2286, lr: 0.003000, 5.02s
2024-09-01 22:42:02 INFO     Saved model at 6
2024-09-01 22:42:02 INFO     Val loss decrease from 8.1592 to 7.2286, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-01 22:42:07 INFO     epoch complete!
2024-09-01 22:42:07 INFO     evaluating now!
2024-09-01 22:42:07 INFO     Epoch [7/200] train_loss: 7.0506, val_loss: 6.8620, lr: 0.003000, 5.02s
2024-09-01 22:42:07 INFO     Saved model at 7
2024-09-01 22:42:07 INFO     Val loss decrease from 7.2286 to 6.8620, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-01 22:42:12 INFO     epoch complete!
2024-09-01 22:42:12 INFO     evaluating now!
2024-09-01 22:42:12 INFO     Epoch [8/200] train_loss: 6.5282, val_loss: 6.8868, lr: 0.003000, 5.03s
2024-09-01 22:42:17 INFO     epoch complete!
2024-09-01 22:42:17 INFO     evaluating now!
2024-09-01 22:42:17 INFO     Epoch [9/200] train_loss: 6.3940, val_loss: 6.3713, lr: 0.003000, 5.03s
2024-09-01 22:42:17 INFO     Saved model at 9
2024-09-01 22:42:17 INFO     Val loss decrease from 6.8620 to 6.3713, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-01 22:42:22 INFO     epoch complete!
2024-09-01 22:42:22 INFO     evaluating now!
2024-09-01 22:42:23 INFO     Epoch [10/200] train_loss: 6.0185, val_loss: 6.2069, lr: 0.003000, 5.03s
2024-09-01 22:42:23 INFO     Saved model at 10
2024-09-01 22:42:23 INFO     Val loss decrease from 6.3713 to 6.2069, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-01 22:42:27 INFO     epoch complete!
2024-09-01 22:42:27 INFO     evaluating now!
2024-09-01 22:42:28 INFO     Epoch [11/200] train_loss: 5.9221, val_loss: 6.2067, lr: 0.003000, 5.03s
2024-09-01 22:42:28 INFO     Saved model at 11
2024-09-01 22:42:28 INFO     Val loss decrease from 6.2069 to 6.2067, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-01 22:42:32 INFO     epoch complete!
2024-09-01 22:42:32 INFO     evaluating now!
2024-09-01 22:42:33 INFO     Epoch [12/200] train_loss: 5.7924, val_loss: 5.9806, lr: 0.003000, 5.03s
2024-09-01 22:42:33 INFO     Saved model at 12
2024-09-01 22:42:33 INFO     Val loss decrease from 6.2067 to 5.9806, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-01 22:42:37 INFO     epoch complete!
2024-09-01 22:42:37 INFO     evaluating now!
2024-09-01 22:42:38 INFO     Epoch [13/200] train_loss: 5.6471, val_loss: 6.0633, lr: 0.003000, 5.03s
2024-09-01 22:42:42 INFO     epoch complete!
2024-09-01 22:42:42 INFO     evaluating now!
2024-09-01 22:42:43 INFO     Epoch [14/200] train_loss: 5.5428, val_loss: 5.7811, lr: 0.003000, 5.03s
2024-09-01 22:42:43 INFO     Saved model at 14
2024-09-01 22:42:43 INFO     Val loss decrease from 5.9806 to 5.7811, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-01 22:42:47 INFO     epoch complete!
2024-09-01 22:42:47 INFO     evaluating now!
2024-09-01 22:42:48 INFO     Epoch [15/200] train_loss: 5.4294, val_loss: 5.7562, lr: 0.003000, 5.03s
2024-09-01 22:42:48 INFO     Saved model at 15
2024-09-01 22:42:48 INFO     Val loss decrease from 5.7811 to 5.7562, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-01 22:42:52 INFO     epoch complete!
2024-09-01 22:42:52 INFO     evaluating now!
2024-09-01 22:42:53 INFO     Epoch [16/200] train_loss: 5.2345, val_loss: 5.7997, lr: 0.003000, 5.03s
2024-09-01 22:42:58 INFO     epoch complete!
2024-09-01 22:42:58 INFO     evaluating now!
2024-09-01 22:42:58 INFO     Epoch [17/200] train_loss: 5.1973, val_loss: 5.6097, lr: 0.003000, 5.03s
2024-09-01 22:42:58 INFO     Saved model at 17
2024-09-01 22:42:58 INFO     Val loss decrease from 5.7562 to 5.6097, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-01 22:43:03 INFO     epoch complete!
2024-09-01 22:43:03 INFO     evaluating now!
2024-09-01 22:43:03 INFO     Epoch [18/200] train_loss: 5.0890, val_loss: 5.5173, lr: 0.003000, 5.03s
2024-09-01 22:43:03 INFO     Saved model at 18
2024-09-01 22:43:03 INFO     Val loss decrease from 5.6097 to 5.5173, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-01 22:43:08 INFO     epoch complete!
2024-09-01 22:43:08 INFO     evaluating now!
2024-09-01 22:43:08 INFO     Epoch [19/200] train_loss: 5.0114, val_loss: 5.5186, lr: 0.003000, 5.03s
2024-09-01 22:43:13 INFO     epoch complete!
2024-09-01 22:43:13 INFO     evaluating now!
2024-09-01 22:43:13 INFO     Epoch [20/200] train_loss: 4.9134, val_loss: 5.5954, lr: 0.003000, 5.03s
2024-09-01 22:43:18 INFO     epoch complete!
2024-09-01 22:43:18 INFO     evaluating now!
2024-09-01 22:43:18 INFO     Epoch [21/200] train_loss: 4.8278, val_loss: 5.3527, lr: 0.003000, 5.03s
2024-09-01 22:43:18 INFO     Saved model at 21
2024-09-01 22:43:18 INFO     Val loss decrease from 5.5173 to 5.3527, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-01 22:43:23 INFO     epoch complete!
2024-09-01 22:43:23 INFO     evaluating now!
2024-09-01 22:43:23 INFO     Epoch [22/200] train_loss: 4.8425, val_loss: 5.2057, lr: 0.003000, 5.03s
2024-09-01 22:43:23 INFO     Saved model at 22
2024-09-01 22:43:23 INFO     Val loss decrease from 5.3527 to 5.2057, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-01 22:43:28 INFO     epoch complete!
2024-09-01 22:43:28 INFO     evaluating now!
2024-09-01 22:43:28 INFO     Epoch [23/200] train_loss: 4.6549, val_loss: 5.1677, lr: 0.003000, 5.02s
2024-09-01 22:43:28 INFO     Saved model at 23
2024-09-01 22:43:28 INFO     Val loss decrease from 5.2057 to 5.1677, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-01 22:43:33 INFO     epoch complete!
2024-09-01 22:43:33 INFO     evaluating now!
2024-09-01 22:43:33 INFO     Epoch [24/200] train_loss: 4.7753, val_loss: 5.5850, lr: 0.003000, 5.03s
2024-09-01 22:43:38 INFO     epoch complete!
2024-09-01 22:43:38 INFO     evaluating now!
2024-09-01 22:43:38 INFO     Epoch [25/200] train_loss: 4.6507, val_loss: 5.3669, lr: 0.003000, 5.03s
2024-09-01 22:43:43 INFO     epoch complete!
2024-09-01 22:43:43 INFO     evaluating now!
2024-09-01 22:43:43 INFO     Epoch [26/200] train_loss: 4.6101, val_loss: 5.2165, lr: 0.003000, 5.03s
2024-09-01 22:43:48 INFO     epoch complete!
2024-09-01 22:43:48 INFO     evaluating now!
2024-09-01 22:43:48 INFO     Epoch [27/200] train_loss: 4.5200, val_loss: 5.2390, lr: 0.003000, 5.03s
2024-09-01 22:43:53 INFO     epoch complete!
2024-09-01 22:43:53 INFO     evaluating now!
2024-09-01 22:43:53 INFO     Epoch [28/200] train_loss: 4.5049, val_loss: 5.2199, lr: 0.003000, 5.03s
2024-09-01 22:43:58 INFO     epoch complete!
2024-09-01 22:43:58 INFO     evaluating now!
2024-09-01 22:43:58 INFO     Epoch [29/200] train_loss: 4.4706, val_loss: 5.2447, lr: 0.003000, 5.04s
2024-09-01 22:44:03 INFO     epoch complete!
2024-09-01 22:44:03 INFO     evaluating now!
2024-09-01 22:44:03 INFO     Epoch [30/200] train_loss: 4.3556, val_loss: 5.2505, lr: 0.003000, 5.03s
2024-09-01 22:44:08 INFO     epoch complete!
2024-09-01 22:44:08 INFO     evaluating now!
2024-09-01 22:44:08 INFO     Epoch [31/200] train_loss: 4.3586, val_loss: 5.3662, lr: 0.003000, 5.02s
2024-09-01 22:44:13 INFO     epoch complete!
2024-09-01 22:44:13 INFO     evaluating now!
2024-09-01 22:44:13 INFO     Epoch [32/200] train_loss: 4.3734, val_loss: 5.2319, lr: 0.003000, 5.02s
2024-09-01 22:44:18 INFO     epoch complete!
2024-09-01 22:44:18 INFO     evaluating now!
2024-09-01 22:44:18 INFO     Epoch [33/200] train_loss: 4.3193, val_loss: 5.3055, lr: 0.003000, 5.02s
2024-09-01 22:44:23 INFO     epoch complete!
2024-09-01 22:44:23 INFO     evaluating now!
2024-09-01 22:44:23 INFO     Epoch [34/200] train_loss: 4.2401, val_loss: 5.1455, lr: 0.003000, 5.02s
2024-09-01 22:44:23 INFO     Saved model at 34
2024-09-01 22:44:23 INFO     Val loss decrease from 5.1677 to 5.1455, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-09-01 22:44:28 INFO     epoch complete!
2024-09-01 22:44:28 INFO     evaluating now!
2024-09-01 22:44:28 INFO     Epoch [35/200] train_loss: 4.2401, val_loss: 5.1347, lr: 0.003000, 5.03s
2024-09-01 22:44:28 INFO     Saved model at 35
2024-09-01 22:44:28 INFO     Val loss decrease from 5.1455 to 5.1347, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-01 22:44:33 INFO     epoch complete!
2024-09-01 22:44:33 INFO     evaluating now!
2024-09-01 22:44:33 INFO     Epoch [36/200] train_loss: 4.1935, val_loss: 5.1329, lr: 0.003000, 5.03s
2024-09-01 22:44:33 INFO     Saved model at 36
2024-09-01 22:44:33 INFO     Val loss decrease from 5.1347 to 5.1329, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-09-01 22:44:38 INFO     epoch complete!
2024-09-01 22:44:38 INFO     evaluating now!
2024-09-01 22:44:39 INFO     Epoch [37/200] train_loss: 4.2382, val_loss: 5.1586, lr: 0.003000, 5.03s
2024-09-01 22:44:43 INFO     epoch complete!
2024-09-01 22:44:43 INFO     evaluating now!
2024-09-01 22:44:44 INFO     Epoch [38/200] train_loss: 4.1983, val_loss: 5.3174, lr: 0.003000, 5.03s
2024-09-01 22:44:48 INFO     epoch complete!
2024-09-01 22:44:48 INFO     evaluating now!
2024-09-01 22:44:49 INFO     Epoch [39/200] train_loss: 4.0736, val_loss: 5.1823, lr: 0.003000, 5.02s
2024-09-01 22:44:53 INFO     epoch complete!
2024-09-01 22:44:53 INFO     evaluating now!
2024-09-01 22:44:54 INFO     Epoch [40/200] train_loss: 4.0635, val_loss: 5.2729, lr: 0.003000, 5.03s
2024-09-01 22:44:58 INFO     epoch complete!
2024-09-01 22:44:58 INFO     evaluating now!
2024-09-01 22:44:59 INFO     Epoch [41/200] train_loss: 4.1963, val_loss: 5.3076, lr: 0.003000, 5.02s
2024-09-01 22:45:03 INFO     epoch complete!
2024-09-01 22:45:03 INFO     evaluating now!
2024-09-01 22:45:04 INFO     Epoch [42/200] train_loss: 4.0698, val_loss: 5.1661, lr: 0.003000, 5.02s
2024-09-01 22:45:08 INFO     epoch complete!
2024-09-01 22:45:08 INFO     evaluating now!
2024-09-01 22:45:09 INFO     Epoch [43/200] train_loss: 3.9899, val_loss: 5.2087, lr: 0.003000, 5.03s
2024-09-01 22:45:13 INFO     epoch complete!
2024-09-01 22:45:13 INFO     evaluating now!
2024-09-01 22:45:14 INFO     Epoch [44/200] train_loss: 3.9911, val_loss: 5.1824, lr: 0.003000, 5.03s
2024-09-01 22:45:18 INFO     epoch complete!
2024-09-01 22:45:18 INFO     evaluating now!
2024-09-01 22:45:19 INFO     Epoch [45/200] train_loss: 4.0164, val_loss: 5.0902, lr: 0.003000, 5.03s
2024-09-01 22:45:19 INFO     Saved model at 45
2024-09-01 22:45:19 INFO     Val loss decrease from 5.1329 to 5.0902, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-09-01 22:45:23 INFO     epoch complete!
2024-09-01 22:45:23 INFO     evaluating now!
2024-09-01 22:45:24 INFO     Epoch [46/200] train_loss: 3.8999, val_loss: 5.1433, lr: 0.003000, 5.02s
2024-09-01 22:45:28 INFO     epoch complete!
2024-09-01 22:45:28 INFO     evaluating now!
2024-09-01 22:45:29 INFO     Epoch [47/200] train_loss: 3.9039, val_loss: 5.0761, lr: 0.003000, 5.02s
2024-09-01 22:45:29 INFO     Saved model at 47
2024-09-01 22:45:29 INFO     Val loss decrease from 5.0902 to 5.0761, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch47.tar
2024-09-01 22:45:34 INFO     epoch complete!
2024-09-01 22:45:34 INFO     evaluating now!
2024-09-01 22:45:34 INFO     Epoch [48/200] train_loss: 3.9329, val_loss: 5.0443, lr: 0.003000, 5.03s
2024-09-01 22:45:34 INFO     Saved model at 48
2024-09-01 22:45:34 INFO     Val loss decrease from 5.0761 to 5.0443, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-09-01 22:45:39 INFO     epoch complete!
2024-09-01 22:45:39 INFO     evaluating now!
2024-09-01 22:45:39 INFO     Epoch [49/200] train_loss: 3.8541, val_loss: 5.1323, lr: 0.003000, 5.02s
2024-09-01 22:45:44 INFO     epoch complete!
2024-09-01 22:45:44 INFO     evaluating now!
2024-09-01 22:45:44 INFO     Epoch [50/200] train_loss: 3.8336, val_loss: 5.0664, lr: 0.003000, 5.02s
2024-09-01 22:45:49 INFO     epoch complete!
2024-09-01 22:45:49 INFO     evaluating now!
2024-09-01 22:45:49 INFO     Epoch [51/200] train_loss: 3.8461, val_loss: 5.1526, lr: 0.003000, 5.03s
2024-09-01 22:45:54 INFO     epoch complete!
2024-09-01 22:45:54 INFO     evaluating now!
2024-09-01 22:45:54 INFO     Epoch [52/200] train_loss: 3.7654, val_loss: 5.0740, lr: 0.003000, 5.02s
2024-09-01 22:45:59 INFO     epoch complete!
2024-09-01 22:45:59 INFO     evaluating now!
2024-09-01 22:45:59 INFO     Epoch [53/200] train_loss: 3.7546, val_loss: 5.0812, lr: 0.003000, 5.02s
2024-09-01 22:46:04 INFO     epoch complete!
2024-09-01 22:46:04 INFO     evaluating now!
2024-09-01 22:46:04 INFO     Epoch [54/200] train_loss: 3.7606, val_loss: 5.0492, lr: 0.003000, 5.02s
2024-09-01 22:46:09 INFO     epoch complete!
2024-09-01 22:46:09 INFO     evaluating now!
2024-09-01 22:46:09 INFO     Epoch [55/200] train_loss: 3.7022, val_loss: 5.1116, lr: 0.003000, 5.02s
2024-09-01 22:46:14 INFO     epoch complete!
2024-09-01 22:46:14 INFO     evaluating now!
2024-09-01 22:46:14 INFO     Epoch [56/200] train_loss: 3.7851, val_loss: 4.9986, lr: 0.003000, 5.02s
2024-09-01 22:46:14 INFO     Saved model at 56
2024-09-01 22:46:14 INFO     Val loss decrease from 5.0443 to 4.9986, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch56.tar
2024-09-01 22:46:19 INFO     epoch complete!
2024-09-01 22:46:19 INFO     evaluating now!
2024-09-01 22:46:19 INFO     Epoch [57/200] train_loss: 3.7835, val_loss: 5.1138, lr: 0.003000, 5.02s
2024-09-01 22:46:24 INFO     epoch complete!
2024-09-01 22:46:24 INFO     evaluating now!
2024-09-01 22:46:24 INFO     Epoch [58/200] train_loss: 3.7213, val_loss: 5.1105, lr: 0.003000, 5.02s
2024-09-01 22:46:29 INFO     epoch complete!
2024-09-01 22:46:29 INFO     evaluating now!
2024-09-01 22:46:29 INFO     Epoch [59/200] train_loss: 3.7386, val_loss: 5.1119, lr: 0.003000, 5.03s
2024-09-01 22:46:34 INFO     epoch complete!
2024-09-01 22:46:34 INFO     evaluating now!
2024-09-01 22:46:34 INFO     Epoch [60/200] train_loss: 3.7178, val_loss: 5.1365, lr: 0.003000, 5.02s
2024-09-01 22:46:39 INFO     epoch complete!
2024-09-01 22:46:39 INFO     evaluating now!
2024-09-01 22:46:39 INFO     Epoch [61/200] train_loss: 3.6483, val_loss: 4.9823, lr: 0.003000, 5.03s
2024-09-01 22:46:39 INFO     Saved model at 61
2024-09-01 22:46:39 INFO     Val loss decrease from 4.9986 to 4.9823, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch61.tar
2024-09-01 22:46:44 INFO     epoch complete!
2024-09-01 22:46:44 INFO     evaluating now!
2024-09-01 22:46:44 INFO     Epoch [62/200] train_loss: 3.6219, val_loss: 5.0506, lr: 0.003000, 5.03s
2024-09-01 22:46:49 INFO     epoch complete!
2024-09-01 22:46:49 INFO     evaluating now!
2024-09-01 22:46:49 INFO     Epoch [63/200] train_loss: 3.5834, val_loss: 5.1526, lr: 0.003000, 5.05s
2024-09-01 22:46:54 INFO     epoch complete!
2024-09-01 22:46:54 INFO     evaluating now!
2024-09-01 22:46:54 INFO     Epoch [64/200] train_loss: 3.5783, val_loss: 5.0647, lr: 0.003000, 5.03s
2024-09-01 22:46:59 INFO     epoch complete!
2024-09-01 22:46:59 INFO     evaluating now!
2024-09-01 22:46:59 INFO     Epoch [65/200] train_loss: 3.6051, val_loss: 5.0258, lr: 0.003000, 5.03s
2024-09-01 22:47:04 INFO     epoch complete!
2024-09-01 22:47:04 INFO     evaluating now!
2024-09-01 22:47:04 INFO     Epoch [66/200] train_loss: 3.6009, val_loss: 4.9998, lr: 0.003000, 5.03s
2024-09-01 22:47:09 INFO     epoch complete!
2024-09-01 22:47:09 INFO     evaluating now!
2024-09-01 22:47:09 INFO     Epoch [67/200] train_loss: 3.5785, val_loss: 4.9702, lr: 0.003000, 5.03s
2024-09-01 22:47:09 INFO     Saved model at 67
2024-09-01 22:47:09 INFO     Val loss decrease from 4.9823 to 4.9702, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch67.tar
2024-09-01 22:47:14 INFO     epoch complete!
2024-09-01 22:47:14 INFO     evaluating now!
2024-09-01 22:47:14 INFO     Epoch [68/200] train_loss: 3.5794, val_loss: 5.2871, lr: 0.003000, 5.03s
2024-09-01 22:47:19 INFO     epoch complete!
2024-09-01 22:47:19 INFO     evaluating now!
2024-09-01 22:47:19 INFO     Epoch [69/200] train_loss: 3.5802, val_loss: 5.0615, lr: 0.003000, 5.03s
2024-09-01 22:47:24 INFO     epoch complete!
2024-09-01 22:47:24 INFO     evaluating now!
2024-09-01 22:47:24 INFO     Epoch [70/200] train_loss: 3.5457, val_loss: 5.0611, lr: 0.003000, 5.03s
2024-09-01 22:47:29 INFO     epoch complete!
2024-09-01 22:47:29 INFO     evaluating now!
2024-09-01 22:47:29 INFO     Epoch [71/200] train_loss: 3.5369, val_loss: 5.0643, lr: 0.003000, 5.04s
2024-09-01 22:47:34 INFO     epoch complete!
2024-09-01 22:47:34 INFO     evaluating now!
2024-09-01 22:47:35 INFO     Epoch [72/200] train_loss: 3.4838, val_loss: 5.1243, lr: 0.003000, 5.06s
2024-09-01 22:47:39 INFO     epoch complete!
2024-09-01 22:47:39 INFO     evaluating now!
2024-09-01 22:47:40 INFO     Epoch [73/200] train_loss: 3.5321, val_loss: 5.1474, lr: 0.003000, 5.05s
2024-09-01 22:47:44 INFO     epoch complete!
2024-09-01 22:47:44 INFO     evaluating now!
2024-09-01 22:47:45 INFO     Epoch [74/200] train_loss: 3.5055, val_loss: 5.0537, lr: 0.003000, 5.05s
2024-09-01 22:47:49 INFO     epoch complete!
2024-09-01 22:47:49 INFO     evaluating now!
2024-09-01 22:47:50 INFO     Epoch [75/200] train_loss: 3.4359, val_loss: 5.0536, lr: 0.003000, 5.05s
2024-09-01 22:47:54 INFO     epoch complete!
2024-09-01 22:47:54 INFO     evaluating now!
2024-09-01 22:47:55 INFO     Epoch [76/200] train_loss: 3.4257, val_loss: 5.1494, lr: 0.003000, 5.06s
2024-09-01 22:48:00 INFO     epoch complete!
2024-09-01 22:48:00 INFO     evaluating now!
2024-09-01 22:48:00 INFO     Epoch [77/200] train_loss: 3.4072, val_loss: 5.0221, lr: 0.003000, 5.05s
2024-09-01 22:48:05 INFO     epoch complete!
2024-09-01 22:48:05 INFO     evaluating now!
2024-09-01 22:48:05 INFO     Epoch [78/200] train_loss: 3.4524, val_loss: 5.0112, lr: 0.003000, 5.05s
2024-09-01 22:48:10 INFO     epoch complete!
2024-09-01 22:48:10 INFO     evaluating now!
2024-09-01 22:48:10 INFO     Epoch [79/200] train_loss: 3.4303, val_loss: 5.1083, lr: 0.003000, 5.05s
2024-09-01 22:48:15 INFO     epoch complete!
2024-09-01 22:48:15 INFO     evaluating now!
2024-09-01 22:48:15 INFO     Epoch [80/200] train_loss: 3.4120, val_loss: 5.0629, lr: 0.003000, 5.06s
2024-09-01 22:48:20 INFO     epoch complete!
2024-09-01 22:48:20 INFO     evaluating now!
2024-09-01 22:48:20 INFO     Epoch [81/200] train_loss: 3.4584, val_loss: 5.0071, lr: 0.003000, 5.05s
2024-09-01 22:48:25 INFO     epoch complete!
2024-09-01 22:48:25 INFO     evaluating now!
2024-09-01 22:48:25 INFO     Epoch [82/200] train_loss: 3.5173, val_loss: 5.1728, lr: 0.003000, 5.06s
2024-09-01 22:48:25 WARNING  Early stopping at epoch: 82
2024-09-01 22:48:25 INFO     Trained totally 83 epochs, average train time is 4.733s, average eval time is 0.299s
2024-09-01 22:48:25 INFO     Loaded model at 67
2024-09-01 22:48:25 INFO     Saved model at ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406.m
2024-09-01 22:48:25 INFO     Start evaluating ...
2024-09-01 22:48:26 INFO     Note that you select the single mode to evaluate!
2024-09-01 22:48:26 INFO     Evaluate result is saved at ./libcity/cache/30/evaluate_cache\2024_09_01_22_48_26_AGCRN_CHITaxi20190406.csv
2024-09-01 22:48:26 INFO     
         MAE       RMSE
1   2.327445   6.779004
2   2.380734   7.449403
3   2.562807   8.632663
4   2.756557   9.720340
5   2.959588  10.877532
6   3.111614  12.101268
7   3.248802  13.191169
8   3.295470  13.829161
9   3.353343  13.963870
10  3.335003  13.893152
11  3.308374  13.808248
12  3.423085  14.099938
2024-09-01 22:48:26 INFO     ----------------------------------------------------------------------------
2024-09-01 22:48:26 INFO     Kownledge Graph Embedding: RotH, Experiment ids: [30, 31, 32, 33, 34]
2024-09-01 22:48:26 INFO     ----------------------------------------------------------------------------
2024-09-01 22:48:26 INFO     Average: 
         MAE       RMSE
0   2.365784   7.030649
1   2.479553   7.685577
2   2.620477   8.689070
3   2.775630   9.524505
4   2.936399  10.365180
5   3.057366  11.224134
6   3.170744  11.937707
7   3.221526  12.457500
8   3.254968  12.800662
9   3.284162  13.083709
10  3.338284  13.483608
11  3.444415  14.045544 
2024-09-01 22:48:26 INFO     Standard deviation: 
         MAE      RMSE
0   0.075963  0.256389
1   0.089487  0.210376
2   0.062131  0.150354
3   0.061855  0.202061
4   0.060180  0.342855
5   0.043633  0.509186
6   0.058833  0.719399
7   0.061673  0.763669
8   0.078756  0.641217
9   0.060537  0.446524
10  0.033795  0.266144
11  0.074505  0.153726
2024-09-01 22:48:26 INFO     ----------------------------------------------------------------------------
2024-09-01 22:48:26 INFO     12 steps Average: 
        MAE      RMSE
0  2.995776  11.02732
2024-09-01 22:48:26 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.063446  0.388492
