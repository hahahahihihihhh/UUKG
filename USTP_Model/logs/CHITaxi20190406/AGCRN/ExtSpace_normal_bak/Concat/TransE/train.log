2024-09-02 16:36:43 INFO     Saving logs in: ./logs/CHITaxi20190406\AGCRN\ExtSpace\TransE
2024-09-02 16:36:43 INFO     ----------------------------------------------------------------------------
2024-09-02 16:36:43 INFO     # 0, Kownledge Graph Embedding: TransE, Experiment ids: 5
2024-09-02 16:36:43 INFO     ----------------------------------------------------------------------------
2024-09-02 16:36:43 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=5
2024-09-02 16:36:43 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 5, 'embedding_model': 'TransE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 16:36:43 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 16:36:43 INFO     set_weight_link_or_dist: dist
2024-09-02 16:36:43 INFO     init_weight_inf_or_zero: inf
2024-09-02 16:36:43 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 16:36:43 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 16:36:43 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 16:36:43 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 16:36:45 INFO     Dataset created
2024-09-02 16:36:45 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 16:36:45 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 16:36:45 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 16:36:45 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 16:36:45 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 16:36:45 INFO     NormalScaler max: 1.6393284718907857
2024-09-02 16:36:48 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 16:36:48 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 16:36:48 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 16:36:48 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 16:36:48 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 16:36:48 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 16:36:48 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 16:36:48 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 16:36:48 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 16:36:48 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 16:36:48 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 16:36:48 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 16:36:48 INFO     Total parameter numbers: 874010
2024-09-02 16:36:48 INFO     You select `adam` optimizer.
2024-09-02 16:36:48 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 16:36:48 INFO     Start training ...
2024-09-02 16:36:48 INFO     num_batches:48
2024-09-02 16:36:55 INFO     epoch complete!
2024-09-02 16:36:55 INFO     evaluating now!
2024-09-02 16:36:56 INFO     Epoch [0/200] train_loss: 23.3505, val_loss: 17.4867, lr: 0.003000, 7.21s
2024-09-02 16:36:56 INFO     Saved model at 0
2024-09-02 16:36:56 INFO     Val loss decrease from inf to 17.4867, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 16:37:00 INFO     epoch complete!
2024-09-02 16:37:00 INFO     evaluating now!
2024-09-02 16:37:01 INFO     Epoch [1/200] train_loss: 13.8512, val_loss: 13.2637, lr: 0.003000, 5.07s
2024-09-02 16:37:01 INFO     Saved model at 1
2024-09-02 16:37:01 INFO     Val loss decrease from 17.4867 to 13.2637, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 16:37:05 INFO     epoch complete!
2024-09-02 16:37:05 INFO     evaluating now!
2024-09-02 16:37:06 INFO     Epoch [2/200] train_loss: 10.7442, val_loss: 10.4069, lr: 0.003000, 5.13s
2024-09-02 16:37:06 INFO     Saved model at 2
2024-09-02 16:37:06 INFO     Val loss decrease from 13.2637 to 10.4069, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 16:37:11 INFO     epoch complete!
2024-09-02 16:37:11 INFO     evaluating now!
2024-09-02 16:37:11 INFO     Epoch [3/200] train_loss: 8.9378, val_loss: 8.3175, lr: 0.003000, 5.35s
2024-09-02 16:37:11 INFO     Saved model at 3
2024-09-02 16:37:11 INFO     Val loss decrease from 10.4069 to 8.3175, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 16:37:16 INFO     epoch complete!
2024-09-02 16:37:16 INFO     evaluating now!
2024-09-02 16:37:16 INFO     Epoch [4/200] train_loss: 7.8067, val_loss: 7.6594, lr: 0.003000, 5.26s
2024-09-02 16:37:16 INFO     Saved model at 4
2024-09-02 16:37:16 INFO     Val loss decrease from 8.3175 to 7.6594, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 16:37:21 INFO     epoch complete!
2024-09-02 16:37:21 INFO     evaluating now!
2024-09-02 16:37:22 INFO     Epoch [5/200] train_loss: 7.2449, val_loss: 6.9811, lr: 0.003000, 5.18s
2024-09-02 16:37:22 INFO     Saved model at 5
2024-09-02 16:37:22 INFO     Val loss decrease from 7.6594 to 6.9811, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 16:37:27 INFO     epoch complete!
2024-09-02 16:37:27 INFO     evaluating now!
2024-09-02 16:37:27 INFO     Epoch [6/200] train_loss: 6.7020, val_loss: 6.8579, lr: 0.003000, 5.27s
2024-09-02 16:37:27 INFO     Saved model at 6
2024-09-02 16:37:27 INFO     Val loss decrease from 6.9811 to 6.8579, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 16:37:32 INFO     epoch complete!
2024-09-02 16:37:32 INFO     evaluating now!
2024-09-02 16:37:32 INFO     Epoch [7/200] train_loss: 6.2983, val_loss: 6.4261, lr: 0.003000, 5.18s
2024-09-02 16:37:32 INFO     Saved model at 7
2024-09-02 16:37:32 INFO     Val loss decrease from 6.8579 to 6.4261, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 16:37:37 INFO     epoch complete!
2024-09-02 16:37:37 INFO     evaluating now!
2024-09-02 16:37:37 INFO     Epoch [8/200] train_loss: 6.0976, val_loss: 6.1290, lr: 0.003000, 5.17s
2024-09-02 16:37:37 INFO     Saved model at 8
2024-09-02 16:37:37 INFO     Val loss decrease from 6.4261 to 6.1290, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 16:37:42 INFO     epoch complete!
2024-09-02 16:37:42 INFO     evaluating now!
2024-09-02 16:37:43 INFO     Epoch [9/200] train_loss: 5.8651, val_loss: 6.1580, lr: 0.003000, 5.21s
2024-09-02 16:37:47 INFO     epoch complete!
2024-09-02 16:37:47 INFO     evaluating now!
2024-09-02 16:37:48 INFO     Epoch [10/200] train_loss: 5.8203, val_loss: 5.9726, lr: 0.003000, 5.17s
2024-09-02 16:37:48 INFO     Saved model at 10
2024-09-02 16:37:48 INFO     Val loss decrease from 6.1290 to 5.9726, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 16:37:53 INFO     epoch complete!
2024-09-02 16:37:53 INFO     evaluating now!
2024-09-02 16:37:53 INFO     Epoch [11/200] train_loss: 5.6054, val_loss: 5.8745, lr: 0.003000, 5.17s
2024-09-02 16:37:53 INFO     Saved model at 11
2024-09-02 16:37:53 INFO     Val loss decrease from 5.9726 to 5.8745, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 16:37:58 INFO     epoch complete!
2024-09-02 16:37:58 INFO     evaluating now!
2024-09-02 16:37:58 INFO     Epoch [12/200] train_loss: 5.4711, val_loss: 5.7392, lr: 0.003000, 5.34s
2024-09-02 16:37:58 INFO     Saved model at 12
2024-09-02 16:37:58 INFO     Val loss decrease from 5.8745 to 5.7392, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 16:38:03 INFO     epoch complete!
2024-09-02 16:38:03 INFO     evaluating now!
2024-09-02 16:38:04 INFO     Epoch [13/200] train_loss: 5.3239, val_loss: 5.7351, lr: 0.003000, 5.28s
2024-09-02 16:38:04 INFO     Saved model at 13
2024-09-02 16:38:04 INFO     Val loss decrease from 5.7392 to 5.7351, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 16:38:09 INFO     epoch complete!
2024-09-02 16:38:09 INFO     evaluating now!
2024-09-02 16:38:09 INFO     Epoch [14/200] train_loss: 5.2612, val_loss: 5.6196, lr: 0.003000, 5.44s
2024-09-02 16:38:09 INFO     Saved model at 14
2024-09-02 16:38:09 INFO     Val loss decrease from 5.7351 to 5.6196, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-02 16:38:14 INFO     epoch complete!
2024-09-02 16:38:14 INFO     evaluating now!
2024-09-02 16:38:14 INFO     Epoch [15/200] train_loss: 5.2207, val_loss: 5.5856, lr: 0.003000, 5.32s
2024-09-02 16:38:14 INFO     Saved model at 15
2024-09-02 16:38:14 INFO     Val loss decrease from 5.6196 to 5.5856, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 16:38:19 INFO     epoch complete!
2024-09-02 16:38:19 INFO     evaluating now!
2024-09-02 16:38:20 INFO     Epoch [16/200] train_loss: 5.0766, val_loss: 5.7057, lr: 0.003000, 5.28s
2024-09-02 16:38:25 INFO     epoch complete!
2024-09-02 16:38:25 INFO     evaluating now!
2024-09-02 16:38:25 INFO     Epoch [17/200] train_loss: 4.9848, val_loss: 5.4661, lr: 0.003000, 5.41s
2024-09-02 16:38:25 INFO     Saved model at 17
2024-09-02 16:38:25 INFO     Val loss decrease from 5.5856 to 5.4661, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-02 16:38:30 INFO     epoch complete!
2024-09-02 16:38:30 INFO     evaluating now!
2024-09-02 16:38:30 INFO     Epoch [18/200] train_loss: 4.9288, val_loss: 5.4065, lr: 0.003000, 5.38s
2024-09-02 16:38:30 INFO     Saved model at 18
2024-09-02 16:38:30 INFO     Val loss decrease from 5.4661 to 5.4065, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-02 16:38:35 INFO     epoch complete!
2024-09-02 16:38:35 INFO     evaluating now!
2024-09-02 16:38:36 INFO     Epoch [19/200] train_loss: 4.9208, val_loss: 5.4757, lr: 0.003000, 5.41s
2024-09-02 16:38:41 INFO     epoch complete!
2024-09-02 16:38:41 INFO     evaluating now!
2024-09-02 16:38:41 INFO     Epoch [20/200] train_loss: 4.8006, val_loss: 5.3956, lr: 0.003000, 5.36s
2024-09-02 16:38:41 INFO     Saved model at 20
2024-09-02 16:38:41 INFO     Val loss decrease from 5.4065 to 5.3956, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-02 16:38:46 INFO     epoch complete!
2024-09-02 16:38:46 INFO     evaluating now!
2024-09-02 16:38:47 INFO     Epoch [21/200] train_loss: 4.7613, val_loss: 5.5135, lr: 0.003000, 5.41s
2024-09-02 16:38:52 INFO     epoch complete!
2024-09-02 16:38:52 INFO     evaluating now!
2024-09-02 16:38:52 INFO     Epoch [22/200] train_loss: 4.7370, val_loss: 5.2931, lr: 0.003000, 5.39s
2024-09-02 16:38:52 INFO     Saved model at 22
2024-09-02 16:38:52 INFO     Val loss decrease from 5.3956 to 5.2931, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-02 16:38:57 INFO     epoch complete!
2024-09-02 16:38:57 INFO     evaluating now!
2024-09-02 16:38:57 INFO     Epoch [23/200] train_loss: 4.6723, val_loss: 5.4035, lr: 0.003000, 5.40s
2024-09-02 16:39:02 INFO     epoch complete!
2024-09-02 16:39:02 INFO     evaluating now!
2024-09-02 16:39:03 INFO     Epoch [24/200] train_loss: 4.6067, val_loss: 5.5192, lr: 0.003000, 5.41s
2024-09-02 16:39:08 INFO     epoch complete!
2024-09-02 16:39:08 INFO     evaluating now!
2024-09-02 16:39:08 INFO     Epoch [25/200] train_loss: 4.5403, val_loss: 5.3550, lr: 0.003000, 5.30s
2024-09-02 16:39:13 INFO     epoch complete!
2024-09-02 16:39:13 INFO     evaluating now!
2024-09-02 16:39:13 INFO     Epoch [26/200] train_loss: 4.4846, val_loss: 5.3280, lr: 0.003000, 5.25s
2024-09-02 16:39:18 INFO     epoch complete!
2024-09-02 16:39:18 INFO     evaluating now!
2024-09-02 16:39:19 INFO     Epoch [27/200] train_loss: 4.4027, val_loss: 5.2945, lr: 0.003000, 5.23s
2024-09-02 16:39:24 INFO     epoch complete!
2024-09-02 16:39:24 INFO     evaluating now!
2024-09-02 16:39:24 INFO     Epoch [28/200] train_loss: 4.3911, val_loss: 5.5237, lr: 0.003000, 5.34s
2024-09-02 16:39:29 INFO     epoch complete!
2024-09-02 16:39:29 INFO     evaluating now!
2024-09-02 16:39:29 INFO     Epoch [29/200] train_loss: 4.4287, val_loss: 5.2449, lr: 0.003000, 5.45s
2024-09-02 16:39:29 INFO     Saved model at 29
2024-09-02 16:39:29 INFO     Val loss decrease from 5.2931 to 5.2449, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-02 16:39:34 INFO     epoch complete!
2024-09-02 16:39:34 INFO     evaluating now!
2024-09-02 16:39:35 INFO     Epoch [30/200] train_loss: 4.3286, val_loss: 5.3001, lr: 0.003000, 5.39s
2024-09-02 16:39:40 INFO     epoch complete!
2024-09-02 16:39:40 INFO     evaluating now!
2024-09-02 16:39:40 INFO     Epoch [31/200] train_loss: 4.3319, val_loss: 5.2401, lr: 0.003000, 5.38s
2024-09-02 16:39:40 INFO     Saved model at 31
2024-09-02 16:39:40 INFO     Val loss decrease from 5.2449 to 5.2401, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-09-02 16:39:45 INFO     epoch complete!
2024-09-02 16:39:45 INFO     evaluating now!
2024-09-02 16:39:45 INFO     Epoch [32/200] train_loss: 4.3317, val_loss: 5.3121, lr: 0.003000, 5.17s
2024-09-02 16:39:50 INFO     epoch complete!
2024-09-02 16:39:50 INFO     evaluating now!
2024-09-02 16:39:51 INFO     Epoch [33/200] train_loss: 4.2301, val_loss: 5.2140, lr: 0.003000, 5.32s
2024-09-02 16:39:51 INFO     Saved model at 33
2024-09-02 16:39:51 INFO     Val loss decrease from 5.2401 to 5.2140, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-09-02 16:39:56 INFO     epoch complete!
2024-09-02 16:39:56 INFO     evaluating now!
2024-09-02 16:39:56 INFO     Epoch [34/200] train_loss: 4.1527, val_loss: 5.4388, lr: 0.003000, 5.28s
2024-09-02 16:40:01 INFO     epoch complete!
2024-09-02 16:40:01 INFO     evaluating now!
2024-09-02 16:40:01 INFO     Epoch [35/200] train_loss: 4.1523, val_loss: 5.2144, lr: 0.003000, 5.36s
2024-09-02 16:40:06 INFO     epoch complete!
2024-09-02 16:40:06 INFO     evaluating now!
2024-09-02 16:40:07 INFO     Epoch [36/200] train_loss: 4.1515, val_loss: 5.2476, lr: 0.003000, 5.41s
2024-09-02 16:40:12 INFO     epoch complete!
2024-09-02 16:40:12 INFO     evaluating now!
2024-09-02 16:40:12 INFO     Epoch [37/200] train_loss: 4.1011, val_loss: 5.3977, lr: 0.003000, 5.44s
2024-09-02 16:40:17 INFO     epoch complete!
2024-09-02 16:40:17 INFO     evaluating now!
2024-09-02 16:40:17 INFO     Epoch [38/200] train_loss: 4.1199, val_loss: 5.3376, lr: 0.003000, 5.29s
2024-09-02 16:40:22 INFO     epoch complete!
2024-09-02 16:40:22 INFO     evaluating now!
2024-09-02 16:40:23 INFO     Epoch [39/200] train_loss: 4.1142, val_loss: 5.3414, lr: 0.003000, 5.22s
2024-09-02 16:40:28 INFO     epoch complete!
2024-09-02 16:40:28 INFO     evaluating now!
2024-09-02 16:40:28 INFO     Epoch [40/200] train_loss: 4.0454, val_loss: 5.0498, lr: 0.003000, 5.32s
2024-09-02 16:40:28 INFO     Saved model at 40
2024-09-02 16:40:28 INFO     Val loss decrease from 5.2140 to 5.0498, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-09-02 16:40:33 INFO     epoch complete!
2024-09-02 16:40:33 INFO     evaluating now!
2024-09-02 16:40:33 INFO     Epoch [41/200] train_loss: 4.0593, val_loss: 5.2430, lr: 0.003000, 5.30s
2024-09-02 16:40:38 INFO     epoch complete!
2024-09-02 16:40:38 INFO     evaluating now!
2024-09-02 16:40:39 INFO     Epoch [42/200] train_loss: 4.0064, val_loss: 5.2164, lr: 0.003000, 5.40s
2024-09-02 16:40:44 INFO     epoch complete!
2024-09-02 16:40:44 INFO     evaluating now!
2024-09-02 16:40:44 INFO     Epoch [43/200] train_loss: 3.9871, val_loss: 5.0844, lr: 0.003000, 5.50s
2024-09-02 16:40:49 INFO     epoch complete!
2024-09-02 16:40:49 INFO     evaluating now!
2024-09-02 16:40:50 INFO     Epoch [44/200] train_loss: 3.9141, val_loss: 5.1297, lr: 0.003000, 5.33s
2024-09-02 16:40:54 INFO     epoch complete!
2024-09-02 16:40:54 INFO     evaluating now!
2024-09-02 16:40:55 INFO     Epoch [45/200] train_loss: 3.9427, val_loss: 5.4295, lr: 0.003000, 5.26s
2024-09-02 16:41:00 INFO     epoch complete!
2024-09-02 16:41:00 INFO     evaluating now!
2024-09-02 16:41:00 INFO     Epoch [46/200] train_loss: 3.9065, val_loss: 5.2515, lr: 0.003000, 5.40s
2024-09-02 16:41:05 INFO     epoch complete!
2024-09-02 16:41:05 INFO     evaluating now!
2024-09-02 16:41:06 INFO     Epoch [47/200] train_loss: 3.9030, val_loss: 5.4270, lr: 0.003000, 5.30s
2024-09-02 16:41:10 INFO     epoch complete!
2024-09-02 16:41:10 INFO     evaluating now!
2024-09-02 16:41:11 INFO     Epoch [48/200] train_loss: 3.8624, val_loss: 5.2656, lr: 0.003000, 5.27s
2024-09-02 16:41:16 INFO     epoch complete!
2024-09-02 16:41:16 INFO     evaluating now!
2024-09-02 16:41:16 INFO     Epoch [49/200] train_loss: 3.8176, val_loss: 5.2441, lr: 0.003000, 5.21s
2024-09-02 16:41:21 INFO     epoch complete!
2024-09-02 16:41:21 INFO     evaluating now!
2024-09-02 16:41:21 INFO     Epoch [50/200] train_loss: 3.7749, val_loss: 5.1672, lr: 0.003000, 5.24s
2024-09-02 16:41:26 INFO     epoch complete!
2024-09-02 16:41:26 INFO     evaluating now!
2024-09-02 16:41:27 INFO     Epoch [51/200] train_loss: 3.7933, val_loss: 5.1944, lr: 0.003000, 5.39s
2024-09-02 16:41:32 INFO     epoch complete!
2024-09-02 16:41:32 INFO     evaluating now!
2024-09-02 16:41:32 INFO     Epoch [52/200] train_loss: 3.7805, val_loss: 5.0497, lr: 0.003000, 5.45s
2024-09-02 16:41:32 INFO     Saved model at 52
2024-09-02 16:41:32 INFO     Val loss decrease from 5.0498 to 5.0497, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch52.tar
2024-09-02 16:41:37 INFO     epoch complete!
2024-09-02 16:41:37 INFO     evaluating now!
2024-09-02 16:41:37 INFO     Epoch [53/200] train_loss: 3.8263, val_loss: 5.1844, lr: 0.003000, 5.27s
2024-09-02 16:41:42 INFO     epoch complete!
2024-09-02 16:41:42 INFO     evaluating now!
2024-09-02 16:41:43 INFO     Epoch [54/200] train_loss: 3.7995, val_loss: 5.1927, lr: 0.003000, 5.32s
2024-09-02 16:41:48 INFO     epoch complete!
2024-09-02 16:41:48 INFO     evaluating now!
2024-09-02 16:41:48 INFO     Epoch [55/200] train_loss: 3.7228, val_loss: 5.1626, lr: 0.003000, 5.30s
2024-09-02 16:41:53 INFO     epoch complete!
2024-09-02 16:41:53 INFO     evaluating now!
2024-09-02 16:41:53 INFO     Epoch [56/200] train_loss: 3.7059, val_loss: 5.1002, lr: 0.003000, 5.49s
2024-09-02 16:41:59 INFO     epoch complete!
2024-09-02 16:41:59 INFO     evaluating now!
2024-09-02 16:41:59 INFO     Epoch [57/200] train_loss: 3.6979, val_loss: 5.3747, lr: 0.003000, 5.48s
2024-09-02 16:42:04 INFO     epoch complete!
2024-09-02 16:42:04 INFO     evaluating now!
2024-09-02 16:42:04 INFO     Epoch [58/200] train_loss: 3.6336, val_loss: 5.1110, lr: 0.003000, 5.25s
2024-09-02 16:42:09 INFO     epoch complete!
2024-09-02 16:42:09 INFO     evaluating now!
2024-09-02 16:42:09 INFO     Epoch [59/200] train_loss: 3.6475, val_loss: 5.1444, lr: 0.003000, 5.16s
2024-09-02 16:42:15 INFO     epoch complete!
2024-09-02 16:42:15 INFO     evaluating now!
2024-09-02 16:42:15 INFO     Epoch [60/200] train_loss: 3.6416, val_loss: 5.1944, lr: 0.003000, 5.71s
2024-09-02 16:42:20 INFO     epoch complete!
2024-09-02 16:42:20 INFO     evaluating now!
2024-09-02 16:42:21 INFO     Epoch [61/200] train_loss: 3.6091, val_loss: 5.1055, lr: 0.003000, 5.50s
2024-09-02 16:42:26 INFO     epoch complete!
2024-09-02 16:42:26 INFO     evaluating now!
2024-09-02 16:42:26 INFO     Epoch [62/200] train_loss: 3.5615, val_loss: 5.1197, lr: 0.003000, 5.79s
2024-09-02 16:42:32 INFO     epoch complete!
2024-09-02 16:42:32 INFO     evaluating now!
2024-09-02 16:42:32 INFO     Epoch [63/200] train_loss: 3.5665, val_loss: 5.0532, lr: 0.003000, 5.48s
2024-09-02 16:42:37 INFO     epoch complete!
2024-09-02 16:42:37 INFO     evaluating now!
2024-09-02 16:42:37 INFO     Epoch [64/200] train_loss: 3.5496, val_loss: 5.0066, lr: 0.003000, 5.45s
2024-09-02 16:42:37 INFO     Saved model at 64
2024-09-02 16:42:37 INFO     Val loss decrease from 5.0497 to 5.0066, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch64.tar
2024-09-02 16:42:42 INFO     epoch complete!
2024-09-02 16:42:42 INFO     evaluating now!
2024-09-02 16:42:43 INFO     Epoch [65/200] train_loss: 3.5675, val_loss: 5.0933, lr: 0.003000, 5.24s
2024-09-02 16:42:47 INFO     epoch complete!
2024-09-02 16:42:47 INFO     evaluating now!
2024-09-02 16:42:48 INFO     Epoch [66/200] train_loss: 3.5738, val_loss: 5.2229, lr: 0.003000, 5.21s
2024-09-02 16:42:53 INFO     epoch complete!
2024-09-02 16:42:53 INFO     evaluating now!
2024-09-02 16:42:53 INFO     Epoch [67/200] train_loss: 3.5906, val_loss: 5.1395, lr: 0.003000, 5.36s
2024-09-02 16:42:58 INFO     epoch complete!
2024-09-02 16:42:58 INFO     evaluating now!
2024-09-02 16:42:58 INFO     Epoch [68/200] train_loss: 3.5140, val_loss: 5.0646, lr: 0.003000, 5.28s
2024-09-02 16:43:03 INFO     epoch complete!
2024-09-02 16:43:03 INFO     evaluating now!
2024-09-02 16:43:04 INFO     Epoch [69/200] train_loss: 3.4859, val_loss: 5.0720, lr: 0.003000, 5.27s
2024-09-02 16:43:09 INFO     epoch complete!
2024-09-02 16:43:09 INFO     evaluating now!
2024-09-02 16:43:09 INFO     Epoch [70/200] train_loss: 3.5262, val_loss: 5.2309, lr: 0.003000, 5.30s
2024-09-02 16:43:14 INFO     epoch complete!
2024-09-02 16:43:14 INFO     evaluating now!
2024-09-02 16:43:14 INFO     Epoch [71/200] train_loss: 3.5365, val_loss: 5.1311, lr: 0.003000, 5.15s
2024-09-02 16:43:19 INFO     epoch complete!
2024-09-02 16:43:19 INFO     evaluating now!
2024-09-02 16:43:19 INFO     Epoch [72/200] train_loss: 3.4622, val_loss: 5.1991, lr: 0.003000, 5.14s
2024-09-02 16:43:24 INFO     epoch complete!
2024-09-02 16:43:24 INFO     evaluating now!
2024-09-02 16:43:24 INFO     Epoch [73/200] train_loss: 3.4662, val_loss: 5.0770, lr: 0.003000, 5.21s
2024-09-02 16:43:29 INFO     epoch complete!
2024-09-02 16:43:29 INFO     evaluating now!
2024-09-02 16:43:30 INFO     Epoch [74/200] train_loss: 3.4430, val_loss: 5.1663, lr: 0.003000, 5.12s
2024-09-02 16:43:35 INFO     epoch complete!
2024-09-02 16:43:35 INFO     evaluating now!
2024-09-02 16:43:35 INFO     Epoch [75/200] train_loss: 3.4358, val_loss: 5.1892, lr: 0.003000, 5.46s
2024-09-02 16:43:40 INFO     epoch complete!
2024-09-02 16:43:40 INFO     evaluating now!
2024-09-02 16:43:40 INFO     Epoch [76/200] train_loss: 3.4285, val_loss: 5.0471, lr: 0.003000, 5.23s
2024-09-02 16:43:45 INFO     epoch complete!
2024-09-02 16:43:45 INFO     evaluating now!
2024-09-02 16:43:45 INFO     Epoch [77/200] train_loss: 3.4322, val_loss: 5.1172, lr: 0.003000, 5.10s
2024-09-02 16:43:50 INFO     epoch complete!
2024-09-02 16:43:50 INFO     evaluating now!
2024-09-02 16:43:50 INFO     Epoch [78/200] train_loss: 3.4455, val_loss: 5.0853, lr: 0.003000, 5.09s
2024-09-02 16:43:55 INFO     epoch complete!
2024-09-02 16:43:55 INFO     evaluating now!
2024-09-02 16:43:56 INFO     Epoch [79/200] train_loss: 3.3753, val_loss: 5.1011, lr: 0.003000, 5.14s
2024-09-02 16:43:56 WARNING  Early stopping at epoch: 79
2024-09-02 16:43:56 INFO     Trained totally 80 epochs, average train time is 5.008s, average eval time is 0.328s
2024-09-02 16:43:56 INFO     Loaded model at 64
2024-09-02 16:43:56 INFO     Saved model at ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 16:43:56 INFO     Start evaluating ...
2024-09-02 16:43:57 INFO     Note that you select the single mode to evaluate!
2024-09-02 16:43:57 INFO     Evaluate result is saved at ./libcity/cache/5/evaluate_cache\2024_09_02_16_43_57_AGCRN_CHITaxi20190406.csv
2024-09-02 16:43:57 INFO     
         MAE       RMSE
1   2.403524   6.880074
2   2.498670   7.572987
3   2.630916   8.601768
4   2.828387   9.625496
5   3.036385  10.830416
6   3.096824  11.910042
7   3.232277  12.851704
8   3.328261  13.570163
9   3.332965  13.916571
10  3.444295  14.188887
11  3.494137  14.163351
12  3.544329  14.389774
2024-09-02 16:43:57 INFO     ----------------------------------------------------------------------------
2024-09-02 16:43:57 INFO     # 1, Kownledge Graph Embedding: TransE, Experiment ids: 6
2024-09-02 16:43:57 INFO     ----------------------------------------------------------------------------
2024-09-02 16:43:57 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=5
2024-09-02 16:43:57 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 5, 'embedding_model': 'TransE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 16:43:57 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 16:43:57 INFO     set_weight_link_or_dist: dist
2024-09-02 16:43:57 INFO     init_weight_inf_or_zero: inf
2024-09-02 16:43:57 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 16:43:57 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 16:43:57 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 16:43:57 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 16:43:59 INFO     Dataset created
2024-09-02 16:43:59 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 16:43:59 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 16:43:59 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 16:43:59 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 16:43:59 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 16:44:00 INFO     NormalScaler max: 1.6393284718907857
2024-09-02 16:44:01 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 16:44:01 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 16:44:01 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 16:44:01 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 16:44:01 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 16:44:01 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 16:44:01 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 16:44:01 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 16:44:01 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 16:44:01 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 16:44:01 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 16:44:01 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 16:44:01 INFO     Total parameter numbers: 874010
2024-09-02 16:44:01 INFO     You select `adam` optimizer.
2024-09-02 16:44:01 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 16:44:01 INFO     Start training ...
2024-09-02 16:44:01 INFO     num_batches:48
2024-09-02 16:44:07 INFO     epoch complete!
2024-09-02 16:44:07 INFO     evaluating now!
2024-09-02 16:44:07 INFO     Epoch [0/200] train_loss: 25.0172, val_loss: 18.8206, lr: 0.003000, 5.41s
2024-09-02 16:44:07 INFO     Saved model at 0
2024-09-02 16:44:07 INFO     Val loss decrease from inf to 18.8206, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 16:44:12 INFO     epoch complete!
2024-09-02 16:44:12 INFO     evaluating now!
2024-09-02 16:44:12 INFO     Epoch [1/200] train_loss: 15.6165, val_loss: 15.0596, lr: 0.003000, 5.18s
2024-09-02 16:44:12 INFO     Saved model at 1
2024-09-02 16:44:12 INFO     Val loss decrease from 18.8206 to 15.0596, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 16:44:17 INFO     epoch complete!
2024-09-02 16:44:17 INFO     evaluating now!
2024-09-02 16:44:17 INFO     Epoch [2/200] train_loss: 12.8414, val_loss: 12.6164, lr: 0.003000, 5.09s
2024-09-02 16:44:17 INFO     Saved model at 2
2024-09-02 16:44:17 INFO     Val loss decrease from 15.0596 to 12.6164, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 16:44:22 INFO     epoch complete!
2024-09-02 16:44:22 INFO     evaluating now!
2024-09-02 16:44:22 INFO     Epoch [3/200] train_loss: 10.4716, val_loss: 10.0440, lr: 0.003000, 5.10s
2024-09-02 16:44:22 INFO     Saved model at 3
2024-09-02 16:44:22 INFO     Val loss decrease from 12.6164 to 10.0440, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 16:44:27 INFO     epoch complete!
2024-09-02 16:44:27 INFO     evaluating now!
2024-09-02 16:44:27 INFO     Epoch [4/200] train_loss: 8.8904, val_loss: 8.3333, lr: 0.003000, 5.13s
2024-09-02 16:44:27 INFO     Saved model at 4
2024-09-02 16:44:27 INFO     Val loss decrease from 10.0440 to 8.3333, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 16:44:32 INFO     epoch complete!
2024-09-02 16:44:32 INFO     evaluating now!
2024-09-02 16:44:33 INFO     Epoch [5/200] train_loss: 7.9758, val_loss: 8.0188, lr: 0.003000, 5.08s
2024-09-02 16:44:33 INFO     Saved model at 5
2024-09-02 16:44:33 INFO     Val loss decrease from 8.3333 to 8.0188, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 16:44:37 INFO     epoch complete!
2024-09-02 16:44:37 INFO     evaluating now!
2024-09-02 16:44:38 INFO     Epoch [6/200] train_loss: 7.2629, val_loss: 7.1001, lr: 0.003000, 5.15s
2024-09-02 16:44:38 INFO     Saved model at 6
2024-09-02 16:44:38 INFO     Val loss decrease from 8.0188 to 7.1001, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 16:44:43 INFO     epoch complete!
2024-09-02 16:44:43 INFO     evaluating now!
2024-09-02 16:44:43 INFO     Epoch [7/200] train_loss: 6.8778, val_loss: 6.6466, lr: 0.003000, 5.10s
2024-09-02 16:44:43 INFO     Saved model at 7
2024-09-02 16:44:43 INFO     Val loss decrease from 7.1001 to 6.6466, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 16:44:48 INFO     epoch complete!
2024-09-02 16:44:48 INFO     evaluating now!
2024-09-02 16:44:48 INFO     Epoch [8/200] train_loss: 6.4609, val_loss: 6.7184, lr: 0.003000, 5.10s
2024-09-02 16:44:53 INFO     epoch complete!
2024-09-02 16:44:53 INFO     evaluating now!
2024-09-02 16:44:53 INFO     Epoch [9/200] train_loss: 6.1795, val_loss: 6.5210, lr: 0.003000, 5.16s
2024-09-02 16:44:53 INFO     Saved model at 9
2024-09-02 16:44:53 INFO     Val loss decrease from 6.6466 to 6.5210, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 16:44:58 INFO     epoch complete!
2024-09-02 16:44:58 INFO     evaluating now!
2024-09-02 16:44:58 INFO     Epoch [10/200] train_loss: 5.9885, val_loss: 6.0179, lr: 0.003000, 5.11s
2024-09-02 16:44:58 INFO     Saved model at 10
2024-09-02 16:44:58 INFO     Val loss decrease from 6.5210 to 6.0179, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 16:45:03 INFO     epoch complete!
2024-09-02 16:45:03 INFO     evaluating now!
2024-09-02 16:45:03 INFO     Epoch [11/200] train_loss: 5.7945, val_loss: 5.8966, lr: 0.003000, 5.14s
2024-09-02 16:45:03 INFO     Saved model at 11
2024-09-02 16:45:03 INFO     Val loss decrease from 6.0179 to 5.8966, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 16:45:09 INFO     epoch complete!
2024-09-02 16:45:09 INFO     evaluating now!
2024-09-02 16:45:09 INFO     Epoch [12/200] train_loss: 5.6647, val_loss: 5.9995, lr: 0.003000, 5.47s
2024-09-02 16:45:14 INFO     epoch complete!
2024-09-02 16:45:14 INFO     evaluating now!
2024-09-02 16:45:14 INFO     Epoch [13/200] train_loss: 5.5554, val_loss: 5.8226, lr: 0.003000, 5.25s
2024-09-02 16:45:14 INFO     Saved model at 13
2024-09-02 16:45:14 INFO     Val loss decrease from 5.8966 to 5.8226, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 16:45:19 INFO     epoch complete!
2024-09-02 16:45:19 INFO     evaluating now!
2024-09-02 16:45:19 INFO     Epoch [14/200] train_loss: 5.3415, val_loss: 5.6101, lr: 0.003000, 5.22s
2024-09-02 16:45:19 INFO     Saved model at 14
2024-09-02 16:45:19 INFO     Val loss decrease from 5.8226 to 5.6101, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-02 16:45:24 INFO     epoch complete!
2024-09-02 16:45:24 INFO     evaluating now!
2024-09-02 16:45:24 INFO     Epoch [15/200] train_loss: 5.3299, val_loss: 5.9285, lr: 0.003000, 5.11s
2024-09-02 16:45:29 INFO     epoch complete!
2024-09-02 16:45:29 INFO     evaluating now!
2024-09-02 16:45:30 INFO     Epoch [16/200] train_loss: 5.3503, val_loss: 5.4495, lr: 0.003000, 5.16s
2024-09-02 16:45:30 INFO     Saved model at 16
2024-09-02 16:45:30 INFO     Val loss decrease from 5.6101 to 5.4495, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 16:45:35 INFO     epoch complete!
2024-09-02 16:45:35 INFO     evaluating now!
2024-09-02 16:45:35 INFO     Epoch [17/200] train_loss: 5.0956, val_loss: 5.6459, lr: 0.003000, 5.19s
2024-09-02 16:45:40 INFO     epoch complete!
2024-09-02 16:45:40 INFO     evaluating now!
2024-09-02 16:45:40 INFO     Epoch [18/200] train_loss: 5.0548, val_loss: 5.5873, lr: 0.003000, 5.12s
2024-09-02 16:45:45 INFO     epoch complete!
2024-09-02 16:45:45 INFO     evaluating now!
2024-09-02 16:45:45 INFO     Epoch [19/200] train_loss: 5.0020, val_loss: 5.5327, lr: 0.003000, 5.12s
2024-09-02 16:45:50 INFO     epoch complete!
2024-09-02 16:45:50 INFO     evaluating now!
2024-09-02 16:45:50 INFO     Epoch [20/200] train_loss: 4.8640, val_loss: 5.5086, lr: 0.003000, 5.11s
2024-09-02 16:45:55 INFO     epoch complete!
2024-09-02 16:45:55 INFO     evaluating now!
2024-09-02 16:45:55 INFO     Epoch [21/200] train_loss: 4.8779, val_loss: 5.4277, lr: 0.003000, 5.11s
2024-09-02 16:45:55 INFO     Saved model at 21
2024-09-02 16:45:55 INFO     Val loss decrease from 5.4495 to 5.4277, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-02 16:46:00 INFO     epoch complete!
2024-09-02 16:46:00 INFO     evaluating now!
2024-09-02 16:46:00 INFO     Epoch [22/200] train_loss: 4.6918, val_loss: 5.4372, lr: 0.003000, 5.18s
2024-09-02 16:46:06 INFO     epoch complete!
2024-09-02 16:46:06 INFO     evaluating now!
2024-09-02 16:46:06 INFO     Epoch [23/200] train_loss: 4.6727, val_loss: 5.4843, lr: 0.003000, 5.32s
2024-09-02 16:46:11 INFO     epoch complete!
2024-09-02 16:46:11 INFO     evaluating now!
2024-09-02 16:46:11 INFO     Epoch [24/200] train_loss: 4.6783, val_loss: 5.3912, lr: 0.003000, 5.30s
2024-09-02 16:46:11 INFO     Saved model at 24
2024-09-02 16:46:11 INFO     Val loss decrease from 5.4277 to 5.3912, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-02 16:46:16 INFO     epoch complete!
2024-09-02 16:46:16 INFO     evaluating now!
2024-09-02 16:46:16 INFO     Epoch [25/200] train_loss: 4.6110, val_loss: 5.1945, lr: 0.003000, 5.29s
2024-09-02 16:46:16 INFO     Saved model at 25
2024-09-02 16:46:16 INFO     Val loss decrease from 5.3912 to 5.1945, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-02 16:46:21 INFO     epoch complete!
2024-09-02 16:46:21 INFO     evaluating now!
2024-09-02 16:46:22 INFO     Epoch [26/200] train_loss: 4.4783, val_loss: 5.4838, lr: 0.003000, 5.17s
2024-09-02 16:46:26 INFO     epoch complete!
2024-09-02 16:46:26 INFO     evaluating now!
2024-09-02 16:46:27 INFO     Epoch [27/200] train_loss: 4.4844, val_loss: 5.0711, lr: 0.003000, 5.17s
2024-09-02 16:46:27 INFO     Saved model at 27
2024-09-02 16:46:27 INFO     Val loss decrease from 5.1945 to 5.0711, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-02 16:46:32 INFO     epoch complete!
2024-09-02 16:46:32 INFO     evaluating now!
2024-09-02 16:46:32 INFO     Epoch [28/200] train_loss: 4.4747, val_loss: 5.2315, lr: 0.003000, 5.33s
2024-09-02 16:46:37 INFO     epoch complete!
2024-09-02 16:46:37 INFO     evaluating now!
2024-09-02 16:46:37 INFO     Epoch [29/200] train_loss: 4.4499, val_loss: 5.3921, lr: 0.003000, 5.21s
2024-09-02 16:46:42 INFO     epoch complete!
2024-09-02 16:46:42 INFO     evaluating now!
2024-09-02 16:46:43 INFO     Epoch [30/200] train_loss: 4.3906, val_loss: 5.3331, lr: 0.003000, 5.22s
2024-09-02 16:46:47 INFO     epoch complete!
2024-09-02 16:46:47 INFO     evaluating now!
2024-09-02 16:46:48 INFO     Epoch [31/200] train_loss: 4.2745, val_loss: 5.1856, lr: 0.003000, 5.23s
2024-09-02 16:46:53 INFO     epoch complete!
2024-09-02 16:46:53 INFO     evaluating now!
2024-09-02 16:46:53 INFO     Epoch [32/200] train_loss: 4.2844, val_loss: 5.2102, lr: 0.003000, 5.22s
2024-09-02 16:46:58 INFO     epoch complete!
2024-09-02 16:46:58 INFO     evaluating now!
2024-09-02 16:46:58 INFO     Epoch [33/200] train_loss: 4.2084, val_loss: 5.2283, lr: 0.003000, 5.27s
2024-09-02 16:47:03 INFO     epoch complete!
2024-09-02 16:47:03 INFO     evaluating now!
2024-09-02 16:47:03 INFO     Epoch [34/200] train_loss: 4.1625, val_loss: 5.2457, lr: 0.003000, 5.21s
2024-09-02 16:47:08 INFO     epoch complete!
2024-09-02 16:47:08 INFO     evaluating now!
2024-09-02 16:47:09 INFO     Epoch [35/200] train_loss: 4.1353, val_loss: 5.1404, lr: 0.003000, 5.24s
2024-09-02 16:47:14 INFO     epoch complete!
2024-09-02 16:47:14 INFO     evaluating now!
2024-09-02 16:47:14 INFO     Epoch [36/200] train_loss: 4.1487, val_loss: 5.1473, lr: 0.003000, 5.15s
2024-09-02 16:47:19 INFO     epoch complete!
2024-09-02 16:47:19 INFO     evaluating now!
2024-09-02 16:47:19 INFO     Epoch [37/200] train_loss: 4.1222, val_loss: 5.2404, lr: 0.003000, 5.21s
2024-09-02 16:47:24 INFO     epoch complete!
2024-09-02 16:47:24 INFO     evaluating now!
2024-09-02 16:47:24 INFO     Epoch [38/200] train_loss: 4.0945, val_loss: 5.0781, lr: 0.003000, 5.16s
2024-09-02 16:47:29 INFO     epoch complete!
2024-09-02 16:47:29 INFO     evaluating now!
2024-09-02 16:47:30 INFO     Epoch [39/200] train_loss: 3.9998, val_loss: 5.1873, lr: 0.003000, 5.25s
2024-09-02 16:47:34 INFO     epoch complete!
2024-09-02 16:47:34 INFO     evaluating now!
2024-09-02 16:47:35 INFO     Epoch [40/200] train_loss: 3.9977, val_loss: 5.1448, lr: 0.003000, 5.16s
2024-09-02 16:47:40 INFO     epoch complete!
2024-09-02 16:47:40 INFO     evaluating now!
2024-09-02 16:47:40 INFO     Epoch [41/200] train_loss: 3.9284, val_loss: 5.2603, lr: 0.003000, 5.17s
2024-09-02 16:47:45 INFO     epoch complete!
2024-09-02 16:47:45 INFO     evaluating now!
2024-09-02 16:47:45 INFO     Epoch [42/200] train_loss: 3.9709, val_loss: 5.2502, lr: 0.003000, 5.10s
2024-09-02 16:47:45 WARNING  Early stopping at epoch: 42
2024-09-02 16:47:45 INFO     Trained totally 43 epochs, average train time is 4.880s, average eval time is 0.310s
2024-09-02 16:47:45 INFO     Loaded model at 27
2024-09-02 16:47:45 INFO     Saved model at ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 16:47:45 INFO     Start evaluating ...
2024-09-02 16:47:46 INFO     Note that you select the single mode to evaluate!
2024-09-02 16:47:46 INFO     Evaluate result is saved at ./libcity/cache/5/evaluate_cache\2024_09_02_16_47_46_AGCRN_CHITaxi20190406.csv
2024-09-02 16:47:46 INFO     
         MAE       RMSE
1   2.463624   8.019960
2   2.502039   8.194597
3   2.628787   9.017737
4   2.732957   9.727782
5   2.856964  10.409753
6   2.971526  10.865598
7   3.014667  11.342719
8   3.062394  11.572249
9   3.134206  12.076571
10  3.172477  12.402689
11  3.308478  13.106554
12  3.451415  13.918082
2024-09-02 16:47:46 INFO     ----------------------------------------------------------------------------
2024-09-02 16:47:46 INFO     # 2, Kownledge Graph Embedding: TransE, Experiment ids: 7
2024-09-02 16:47:46 INFO     ----------------------------------------------------------------------------
2024-09-02 16:47:46 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=5
2024-09-02 16:47:46 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 5, 'embedding_model': 'TransE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 16:47:46 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 16:47:46 INFO     set_weight_link_or_dist: dist
2024-09-02 16:47:46 INFO     init_weight_inf_or_zero: inf
2024-09-02 16:47:46 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 16:47:46 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 16:47:46 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 16:47:46 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 16:47:48 INFO     Dataset created
2024-09-02 16:47:48 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 16:47:48 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 16:47:48 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 16:47:48 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 16:47:48 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 16:47:48 INFO     NormalScaler max: 1.6393284718907857
2024-09-02 16:47:50 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 16:47:50 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 16:47:50 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 16:47:50 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 16:47:50 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 16:47:50 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 16:47:50 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 16:47:50 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 16:47:50 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 16:47:50 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 16:47:50 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 16:47:50 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 16:47:50 INFO     Total parameter numbers: 874010
2024-09-02 16:47:50 INFO     You select `adam` optimizer.
2024-09-02 16:47:50 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 16:47:50 INFO     Start training ...
2024-09-02 16:47:50 INFO     num_batches:48
2024-09-02 16:47:55 INFO     epoch complete!
2024-09-02 16:47:55 INFO     evaluating now!
2024-09-02 16:47:56 INFO     Epoch [0/200] train_loss: 25.4109, val_loss: 19.1815, lr: 0.003000, 5.56s
2024-09-02 16:47:56 INFO     Saved model at 0
2024-09-02 16:47:56 INFO     Val loss decrease from inf to 19.1815, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 16:48:01 INFO     epoch complete!
2024-09-02 16:48:01 INFO     evaluating now!
2024-09-02 16:48:01 INFO     Epoch [1/200] train_loss: 16.3085, val_loss: 16.1005, lr: 0.003000, 5.16s
2024-09-02 16:48:01 INFO     Saved model at 1
2024-09-02 16:48:01 INFO     Val loss decrease from 19.1815 to 16.1005, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 16:48:06 INFO     epoch complete!
2024-09-02 16:48:06 INFO     evaluating now!
2024-09-02 16:48:06 INFO     Epoch [2/200] train_loss: 13.0397, val_loss: 12.7158, lr: 0.003000, 5.06s
2024-09-02 16:48:06 INFO     Saved model at 2
2024-09-02 16:48:06 INFO     Val loss decrease from 16.1005 to 12.7158, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 16:48:11 INFO     epoch complete!
2024-09-02 16:48:11 INFO     evaluating now!
2024-09-02 16:48:11 INFO     Epoch [3/200] train_loss: 10.8849, val_loss: 10.8118, lr: 0.003000, 5.10s
2024-09-02 16:48:11 INFO     Saved model at 3
2024-09-02 16:48:11 INFO     Val loss decrease from 12.7158 to 10.8118, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 16:48:16 INFO     epoch complete!
2024-09-02 16:48:16 INFO     evaluating now!
2024-09-02 16:48:16 INFO     Epoch [4/200] train_loss: 9.4917, val_loss: 9.2331, lr: 0.003000, 5.20s
2024-09-02 16:48:16 INFO     Saved model at 4
2024-09-02 16:48:16 INFO     Val loss decrease from 10.8118 to 9.2331, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 16:48:21 INFO     epoch complete!
2024-09-02 16:48:21 INFO     evaluating now!
2024-09-02 16:48:22 INFO     Epoch [5/200] train_loss: 8.4373, val_loss: 8.4641, lr: 0.003000, 5.17s
2024-09-02 16:48:22 INFO     Saved model at 5
2024-09-02 16:48:22 INFO     Val loss decrease from 9.2331 to 8.4641, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 16:48:26 INFO     epoch complete!
2024-09-02 16:48:26 INFO     evaluating now!
2024-09-02 16:48:27 INFO     Epoch [6/200] train_loss: 7.8154, val_loss: 7.7401, lr: 0.003000, 5.20s
2024-09-02 16:48:27 INFO     Saved model at 6
2024-09-02 16:48:27 INFO     Val loss decrease from 8.4641 to 7.7401, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 16:48:32 INFO     epoch complete!
2024-09-02 16:48:32 INFO     evaluating now!
2024-09-02 16:48:32 INFO     Epoch [7/200] train_loss: 7.2911, val_loss: 7.4153, lr: 0.003000, 5.17s
2024-09-02 16:48:32 INFO     Saved model at 7
2024-09-02 16:48:32 INFO     Val loss decrease from 7.7401 to 7.4153, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 16:48:37 INFO     epoch complete!
2024-09-02 16:48:37 INFO     evaluating now!
2024-09-02 16:48:37 INFO     Epoch [8/200] train_loss: 6.8971, val_loss: 7.0017, lr: 0.003000, 5.23s
2024-09-02 16:48:37 INFO     Saved model at 8
2024-09-02 16:48:37 INFO     Val loss decrease from 7.4153 to 7.0017, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 16:48:42 INFO     epoch complete!
2024-09-02 16:48:42 INFO     evaluating now!
2024-09-02 16:48:42 INFO     Epoch [9/200] train_loss: 6.6393, val_loss: 6.9652, lr: 0.003000, 5.24s
2024-09-02 16:48:42 INFO     Saved model at 9
2024-09-02 16:48:42 INFO     Val loss decrease from 7.0017 to 6.9652, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 16:48:47 INFO     epoch complete!
2024-09-02 16:48:47 INFO     evaluating now!
2024-09-02 16:48:48 INFO     Epoch [10/200] train_loss: 6.3756, val_loss: 6.7395, lr: 0.003000, 5.25s
2024-09-02 16:48:48 INFO     Saved model at 10
2024-09-02 16:48:48 INFO     Val loss decrease from 6.9652 to 6.7395, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 16:48:53 INFO     epoch complete!
2024-09-02 16:48:53 INFO     evaluating now!
2024-09-02 16:48:53 INFO     Epoch [11/200] train_loss: 6.0708, val_loss: 6.2651, lr: 0.003000, 5.24s
2024-09-02 16:48:53 INFO     Saved model at 11
2024-09-02 16:48:53 INFO     Val loss decrease from 6.7395 to 6.2651, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 16:48:58 INFO     epoch complete!
2024-09-02 16:48:58 INFO     evaluating now!
2024-09-02 16:48:58 INFO     Epoch [12/200] train_loss: 5.8285, val_loss: 6.1332, lr: 0.003000, 5.17s
2024-09-02 16:48:58 INFO     Saved model at 12
2024-09-02 16:48:58 INFO     Val loss decrease from 6.2651 to 6.1332, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 16:49:03 INFO     epoch complete!
2024-09-02 16:49:03 INFO     evaluating now!
2024-09-02 16:49:03 INFO     Epoch [13/200] train_loss: 5.7960, val_loss: 6.3358, lr: 0.003000, 5.18s
2024-09-02 16:49:08 INFO     epoch complete!
2024-09-02 16:49:08 INFO     evaluating now!
2024-09-02 16:49:08 INFO     Epoch [14/200] train_loss: 5.7460, val_loss: 6.0285, lr: 0.003000, 5.17s
2024-09-02 16:49:09 INFO     Saved model at 14
2024-09-02 16:49:09 INFO     Val loss decrease from 6.1332 to 6.0285, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-02 16:49:13 INFO     epoch complete!
2024-09-02 16:49:13 INFO     evaluating now!
2024-09-02 16:49:14 INFO     Epoch [15/200] train_loss: 5.5654, val_loss: 5.7257, lr: 0.003000, 5.19s
2024-09-02 16:49:14 INFO     Saved model at 15
2024-09-02 16:49:14 INFO     Val loss decrease from 6.0285 to 5.7257, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 16:49:19 INFO     epoch complete!
2024-09-02 16:49:19 INFO     evaluating now!
2024-09-02 16:49:19 INFO     Epoch [16/200] train_loss: 5.4305, val_loss: 5.6779, lr: 0.003000, 5.20s
2024-09-02 16:49:19 INFO     Saved model at 16
2024-09-02 16:49:19 INFO     Val loss decrease from 5.7257 to 5.6779, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 16:49:24 INFO     epoch complete!
2024-09-02 16:49:24 INFO     evaluating now!
2024-09-02 16:49:24 INFO     Epoch [17/200] train_loss: 5.4234, val_loss: 5.9576, lr: 0.003000, 5.11s
2024-09-02 16:49:29 INFO     epoch complete!
2024-09-02 16:49:29 INFO     evaluating now!
2024-09-02 16:49:29 INFO     Epoch [18/200] train_loss: 5.2786, val_loss: 5.8250, lr: 0.003000, 5.18s
2024-09-02 16:49:34 INFO     epoch complete!
2024-09-02 16:49:34 INFO     evaluating now!
2024-09-02 16:49:34 INFO     Epoch [19/200] train_loss: 5.1489, val_loss: 5.6798, lr: 0.003000, 5.23s
2024-09-02 16:49:39 INFO     epoch complete!
2024-09-02 16:49:39 INFO     evaluating now!
2024-09-02 16:49:40 INFO     Epoch [20/200] train_loss: 5.0990, val_loss: 5.7778, lr: 0.003000, 5.31s
2024-09-02 16:49:45 INFO     epoch complete!
2024-09-02 16:49:45 INFO     evaluating now!
2024-09-02 16:49:45 INFO     Epoch [21/200] train_loss: 5.0294, val_loss: 5.5374, lr: 0.003000, 5.19s
2024-09-02 16:49:45 INFO     Saved model at 21
2024-09-02 16:49:45 INFO     Val loss decrease from 5.6779 to 5.5374, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-02 16:49:50 INFO     epoch complete!
2024-09-02 16:49:50 INFO     evaluating now!
2024-09-02 16:49:50 INFO     Epoch [22/200] train_loss: 5.0178, val_loss: 5.6434, lr: 0.003000, 5.14s
2024-09-02 16:49:55 INFO     epoch complete!
2024-09-02 16:49:55 INFO     evaluating now!
2024-09-02 16:49:55 INFO     Epoch [23/200] train_loss: 5.0600, val_loss: 5.8304, lr: 0.003000, 5.17s
2024-09-02 16:50:00 INFO     epoch complete!
2024-09-02 16:50:00 INFO     evaluating now!
2024-09-02 16:50:00 INFO     Epoch [24/200] train_loss: 4.9634, val_loss: 5.6590, lr: 0.003000, 5.11s
2024-09-02 16:50:05 INFO     epoch complete!
2024-09-02 16:50:05 INFO     evaluating now!
2024-09-02 16:50:06 INFO     Epoch [25/200] train_loss: 4.7699, val_loss: 5.4722, lr: 0.003000, 5.13s
2024-09-02 16:50:06 INFO     Saved model at 25
2024-09-02 16:50:06 INFO     Val loss decrease from 5.5374 to 5.4722, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-02 16:50:10 INFO     epoch complete!
2024-09-02 16:50:10 INFO     evaluating now!
2024-09-02 16:50:11 INFO     Epoch [26/200] train_loss: 4.7080, val_loss: 5.3911, lr: 0.003000, 5.11s
2024-09-02 16:50:11 INFO     Saved model at 26
2024-09-02 16:50:11 INFO     Val loss decrease from 5.4722 to 5.3911, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-02 16:50:15 INFO     epoch complete!
2024-09-02 16:50:15 INFO     evaluating now!
2024-09-02 16:50:16 INFO     Epoch [27/200] train_loss: 4.7684, val_loss: 5.7033, lr: 0.003000, 5.12s
2024-09-02 16:50:21 INFO     epoch complete!
2024-09-02 16:50:21 INFO     evaluating now!
2024-09-02 16:50:21 INFO     Epoch [28/200] train_loss: 4.7264, val_loss: 5.6302, lr: 0.003000, 5.14s
2024-09-02 16:50:26 INFO     epoch complete!
2024-09-02 16:50:26 INFO     evaluating now!
2024-09-02 16:50:26 INFO     Epoch [29/200] train_loss: 4.6245, val_loss: 5.5592, lr: 0.003000, 5.09s
2024-09-02 16:50:31 INFO     epoch complete!
2024-09-02 16:50:31 INFO     evaluating now!
2024-09-02 16:50:31 INFO     Epoch [30/200] train_loss: 4.5768, val_loss: 5.4603, lr: 0.003000, 5.10s
2024-09-02 16:50:36 INFO     epoch complete!
2024-09-02 16:50:36 INFO     evaluating now!
2024-09-02 16:50:36 INFO     Epoch [31/200] train_loss: 4.5672, val_loss: 5.3724, lr: 0.003000, 5.09s
2024-09-02 16:50:36 INFO     Saved model at 31
2024-09-02 16:50:36 INFO     Val loss decrease from 5.3911 to 5.3724, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-09-02 16:50:41 INFO     epoch complete!
2024-09-02 16:50:41 INFO     evaluating now!
2024-09-02 16:50:41 INFO     Epoch [32/200] train_loss: 4.4895, val_loss: 5.5691, lr: 0.003000, 5.10s
2024-09-02 16:50:46 INFO     epoch complete!
2024-09-02 16:50:46 INFO     evaluating now!
2024-09-02 16:50:46 INFO     Epoch [33/200] train_loss: 4.4297, val_loss: 5.4396, lr: 0.003000, 5.09s
2024-09-02 16:50:51 INFO     epoch complete!
2024-09-02 16:50:51 INFO     evaluating now!
2024-09-02 16:50:51 INFO     Epoch [34/200] train_loss: 4.3300, val_loss: 5.2219, lr: 0.003000, 5.09s
2024-09-02 16:50:51 INFO     Saved model at 34
2024-09-02 16:50:51 INFO     Val loss decrease from 5.3724 to 5.2219, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-09-02 16:50:56 INFO     epoch complete!
2024-09-02 16:50:56 INFO     evaluating now!
2024-09-02 16:50:57 INFO     Epoch [35/200] train_loss: 4.2984, val_loss: 5.3493, lr: 0.003000, 5.09s
2024-09-02 16:51:01 INFO     epoch complete!
2024-09-02 16:51:01 INFO     evaluating now!
2024-09-02 16:51:02 INFO     Epoch [36/200] train_loss: 4.3569, val_loss: 5.2274, lr: 0.003000, 5.16s
2024-09-02 16:51:07 INFO     epoch complete!
2024-09-02 16:51:07 INFO     evaluating now!
2024-09-02 16:51:07 INFO     Epoch [37/200] train_loss: 4.2792, val_loss: 5.2550, lr: 0.003000, 5.10s
2024-09-02 16:51:12 INFO     epoch complete!
2024-09-02 16:51:12 INFO     evaluating now!
2024-09-02 16:51:12 INFO     Epoch [38/200] train_loss: 4.1727, val_loss: 5.2305, lr: 0.003000, 5.10s
2024-09-02 16:51:17 INFO     epoch complete!
2024-09-02 16:51:17 INFO     evaluating now!
2024-09-02 16:51:17 INFO     Epoch [39/200] train_loss: 4.2639, val_loss: 5.3205, lr: 0.003000, 5.10s
2024-09-02 16:51:22 INFO     epoch complete!
2024-09-02 16:51:22 INFO     evaluating now!
2024-09-02 16:51:22 INFO     Epoch [40/200] train_loss: 4.1171, val_loss: 5.2288, lr: 0.003000, 5.09s
2024-09-02 16:51:27 INFO     epoch complete!
2024-09-02 16:51:27 INFO     evaluating now!
2024-09-02 16:51:27 INFO     Epoch [41/200] train_loss: 4.2101, val_loss: 5.2762, lr: 0.003000, 5.09s
2024-09-02 16:51:32 INFO     epoch complete!
2024-09-02 16:51:32 INFO     evaluating now!
2024-09-02 16:51:32 INFO     Epoch [42/200] train_loss: 4.1663, val_loss: 5.1957, lr: 0.003000, 5.09s
2024-09-02 16:51:32 INFO     Saved model at 42
2024-09-02 16:51:32 INFO     Val loss decrease from 5.2219 to 5.1957, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-09-02 16:51:37 INFO     epoch complete!
2024-09-02 16:51:37 INFO     evaluating now!
2024-09-02 16:51:37 INFO     Epoch [43/200] train_loss: 4.1209, val_loss: 5.2528, lr: 0.003000, 5.09s
2024-09-02 16:51:42 INFO     epoch complete!
2024-09-02 16:51:42 INFO     evaluating now!
2024-09-02 16:51:42 INFO     Epoch [44/200] train_loss: 4.0046, val_loss: 5.1094, lr: 0.003000, 5.09s
2024-09-02 16:51:42 INFO     Saved model at 44
2024-09-02 16:51:42 INFO     Val loss decrease from 5.1957 to 5.1094, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-09-02 16:51:47 INFO     epoch complete!
2024-09-02 16:51:47 INFO     evaluating now!
2024-09-02 16:51:48 INFO     Epoch [45/200] train_loss: 4.0807, val_loss: 5.3985, lr: 0.003000, 5.14s
2024-09-02 16:51:52 INFO     epoch complete!
2024-09-02 16:51:52 INFO     evaluating now!
2024-09-02 16:51:53 INFO     Epoch [46/200] train_loss: 4.0068, val_loss: 5.2549, lr: 0.003000, 5.08s
2024-09-02 16:51:57 INFO     epoch complete!
2024-09-02 16:51:57 INFO     evaluating now!
2024-09-02 16:51:58 INFO     Epoch [47/200] train_loss: 3.9156, val_loss: 5.2327, lr: 0.003000, 5.08s
2024-09-02 16:52:03 INFO     epoch complete!
2024-09-02 16:52:03 INFO     evaluating now!
2024-09-02 16:52:03 INFO     Epoch [48/200] train_loss: 3.9036, val_loss: 5.0959, lr: 0.003000, 5.09s
2024-09-02 16:52:03 INFO     Saved model at 48
2024-09-02 16:52:03 INFO     Val loss decrease from 5.1094 to 5.0959, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-09-02 16:52:08 INFO     epoch complete!
2024-09-02 16:52:08 INFO     evaluating now!
2024-09-02 16:52:08 INFO     Epoch [49/200] train_loss: 3.9299, val_loss: 5.2391, lr: 0.003000, 5.08s
2024-09-02 16:52:13 INFO     epoch complete!
2024-09-02 16:52:13 INFO     evaluating now!
2024-09-02 16:52:13 INFO     Epoch [50/200] train_loss: 3.9085, val_loss: 5.1029, lr: 0.003000, 5.08s
2024-09-02 16:52:18 INFO     epoch complete!
2024-09-02 16:52:18 INFO     evaluating now!
2024-09-02 16:52:18 INFO     Epoch [51/200] train_loss: 3.8894, val_loss: 5.0435, lr: 0.003000, 5.14s
2024-09-02 16:52:18 INFO     Saved model at 51
2024-09-02 16:52:18 INFO     Val loss decrease from 5.0959 to 5.0435, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-09-02 16:52:23 INFO     epoch complete!
2024-09-02 16:52:23 INFO     evaluating now!
2024-09-02 16:52:23 INFO     Epoch [52/200] train_loss: 3.8398, val_loss: 5.2237, lr: 0.003000, 5.12s
2024-09-02 16:52:28 INFO     epoch complete!
2024-09-02 16:52:28 INFO     evaluating now!
2024-09-02 16:52:28 INFO     Epoch [53/200] train_loss: 3.8690, val_loss: 5.2169, lr: 0.003000, 5.09s
2024-09-02 16:52:33 INFO     epoch complete!
2024-09-02 16:52:33 INFO     evaluating now!
2024-09-02 16:52:34 INFO     Epoch [54/200] train_loss: 3.7949, val_loss: 5.2392, lr: 0.003000, 5.13s
2024-09-02 16:52:38 INFO     epoch complete!
2024-09-02 16:52:38 INFO     evaluating now!
2024-09-02 16:52:39 INFO     Epoch [55/200] train_loss: 3.7593, val_loss: 5.2483, lr: 0.003000, 5.09s
2024-09-02 16:52:43 INFO     epoch complete!
2024-09-02 16:52:43 INFO     evaluating now!
2024-09-02 16:52:44 INFO     Epoch [56/200] train_loss: 3.7811, val_loss: 5.2794, lr: 0.003000, 5.10s
2024-09-02 16:52:49 INFO     epoch complete!
2024-09-02 16:52:49 INFO     evaluating now!
2024-09-02 16:52:49 INFO     Epoch [57/200] train_loss: 3.7931, val_loss: 5.2308, lr: 0.003000, 5.10s
2024-09-02 16:52:54 INFO     epoch complete!
2024-09-02 16:52:54 INFO     evaluating now!
2024-09-02 16:52:54 INFO     Epoch [58/200] train_loss: 3.7914, val_loss: 5.1229, lr: 0.003000, 5.08s
2024-09-02 16:52:59 INFO     epoch complete!
2024-09-02 16:52:59 INFO     evaluating now!
2024-09-02 16:52:59 INFO     Epoch [59/200] train_loss: 3.7646, val_loss: 5.2172, lr: 0.003000, 5.09s
2024-09-02 16:53:04 INFO     epoch complete!
2024-09-02 16:53:04 INFO     evaluating now!
2024-09-02 16:53:04 INFO     Epoch [60/200] train_loss: 3.7042, val_loss: 5.1481, lr: 0.003000, 5.09s
2024-09-02 16:53:09 INFO     epoch complete!
2024-09-02 16:53:09 INFO     evaluating now!
2024-09-02 16:53:09 INFO     Epoch [61/200] train_loss: 3.6615, val_loss: 5.0860, lr: 0.003000, 5.08s
2024-09-02 16:53:14 INFO     epoch complete!
2024-09-02 16:53:14 INFO     evaluating now!
2024-09-02 16:53:14 INFO     Epoch [62/200] train_loss: 3.6331, val_loss: 5.1036, lr: 0.003000, 5.11s
2024-09-02 16:53:19 INFO     epoch complete!
2024-09-02 16:53:19 INFO     evaluating now!
2024-09-02 16:53:19 INFO     Epoch [63/200] train_loss: 3.6478, val_loss: 5.1493, lr: 0.003000, 5.09s
2024-09-02 16:53:24 INFO     epoch complete!
2024-09-02 16:53:24 INFO     evaluating now!
2024-09-02 16:53:24 INFO     Epoch [64/200] train_loss: 3.6573, val_loss: 5.1102, lr: 0.003000, 5.09s
2024-09-02 16:53:29 INFO     epoch complete!
2024-09-02 16:53:29 INFO     evaluating now!
2024-09-02 16:53:30 INFO     Epoch [65/200] train_loss: 3.6603, val_loss: 5.0674, lr: 0.003000, 5.08s
2024-09-02 16:53:34 INFO     epoch complete!
2024-09-02 16:53:34 INFO     evaluating now!
2024-09-02 16:53:35 INFO     Epoch [66/200] train_loss: 3.6575, val_loss: 5.3060, lr: 0.003000, 5.09s
2024-09-02 16:53:35 WARNING  Early stopping at epoch: 66
2024-09-02 16:53:35 INFO     Trained totally 67 epochs, average train time is 4.830s, average eval time is 0.306s
2024-09-02 16:53:35 INFO     Loaded model at 51
2024-09-02 16:53:35 INFO     Saved model at ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 16:53:35 INFO     Start evaluating ...
2024-09-02 16:53:36 INFO     Note that you select the single mode to evaluate!
2024-09-02 16:53:36 INFO     Evaluate result is saved at ./libcity/cache/5/evaluate_cache\2024_09_02_16_53_36_AGCRN_CHITaxi20190406.csv
2024-09-02 16:53:36 INFO     
         MAE       RMSE
1   2.114657   6.950860
2   2.307443   7.619528
3   2.581306   8.938087
4   2.852191   9.851938
5   3.004022  10.619811
6   3.050383  11.055136
7   2.995393  11.411336
8   2.948886  11.672131
9   2.980881  11.935411
10  3.160614  12.291142
11  3.266576  12.695260
12  3.433885  13.439613
2024-09-02 16:53:36 INFO     ----------------------------------------------------------------------------
2024-09-02 16:53:36 INFO     # 3, Kownledge Graph Embedding: TransE, Experiment ids: 8
2024-09-02 16:53:36 INFO     ----------------------------------------------------------------------------
2024-09-02 16:53:36 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=5
2024-09-02 16:53:36 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 5, 'embedding_model': 'TransE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 16:53:36 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 16:53:36 INFO     set_weight_link_or_dist: dist
2024-09-02 16:53:36 INFO     init_weight_inf_or_zero: inf
2024-09-02 16:53:36 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 16:53:36 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 16:53:36 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 16:53:36 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 16:53:38 INFO     Dataset created
2024-09-02 16:53:38 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 16:53:38 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 16:53:38 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 16:53:38 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 16:53:38 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 16:53:38 INFO     NormalScaler max: 1.6393284718907857
2024-09-02 16:53:40 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 16:53:40 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 16:53:40 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 16:53:40 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 16:53:40 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 16:53:40 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 16:53:40 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 16:53:40 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 16:53:40 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 16:53:40 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 16:53:40 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 16:53:40 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 16:53:40 INFO     Total parameter numbers: 874010
2024-09-02 16:53:40 INFO     You select `adam` optimizer.
2024-09-02 16:53:40 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 16:53:40 INFO     Start training ...
2024-09-02 16:53:40 INFO     num_batches:48
2024-09-02 16:53:45 INFO     epoch complete!
2024-09-02 16:53:45 INFO     evaluating now!
2024-09-02 16:53:45 INFO     Epoch [0/200] train_loss: 23.6970, val_loss: 18.3116, lr: 0.003000, 5.30s
2024-09-02 16:53:46 INFO     Saved model at 0
2024-09-02 16:53:46 INFO     Val loss decrease from inf to 18.3116, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 16:53:50 INFO     epoch complete!
2024-09-02 16:53:50 INFO     evaluating now!
2024-09-02 16:53:51 INFO     Epoch [1/200] train_loss: 14.7837, val_loss: 14.2455, lr: 0.003000, 5.14s
2024-09-02 16:53:51 INFO     Saved model at 1
2024-09-02 16:53:51 INFO     Val loss decrease from 18.3116 to 14.2455, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 16:53:55 INFO     epoch complete!
2024-09-02 16:53:55 INFO     evaluating now!
2024-09-02 16:53:56 INFO     Epoch [2/200] train_loss: 11.9634, val_loss: 11.2612, lr: 0.003000, 5.08s
2024-09-02 16:53:56 INFO     Saved model at 2
2024-09-02 16:53:56 INFO     Val loss decrease from 14.2455 to 11.2612, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 16:54:01 INFO     epoch complete!
2024-09-02 16:54:01 INFO     evaluating now!
2024-09-02 16:54:01 INFO     Epoch [3/200] train_loss: 9.5233, val_loss: 9.0827, lr: 0.003000, 5.14s
2024-09-02 16:54:01 INFO     Saved model at 3
2024-09-02 16:54:01 INFO     Val loss decrease from 11.2612 to 9.0827, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 16:54:06 INFO     epoch complete!
2024-09-02 16:54:06 INFO     evaluating now!
2024-09-02 16:54:06 INFO     Epoch [4/200] train_loss: 8.1813, val_loss: 7.7294, lr: 0.003000, 5.21s
2024-09-02 16:54:06 INFO     Saved model at 4
2024-09-02 16:54:06 INFO     Val loss decrease from 9.0827 to 7.7294, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 16:54:11 INFO     epoch complete!
2024-09-02 16:54:11 INFO     evaluating now!
2024-09-02 16:54:11 INFO     Epoch [5/200] train_loss: 7.2270, val_loss: 7.0012, lr: 0.003000, 5.28s
2024-09-02 16:54:11 INFO     Saved model at 5
2024-09-02 16:54:11 INFO     Val loss decrease from 7.7294 to 7.0012, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 16:54:16 INFO     epoch complete!
2024-09-02 16:54:16 INFO     evaluating now!
2024-09-02 16:54:17 INFO     Epoch [6/200] train_loss: 6.6464, val_loss: 6.5831, lr: 0.003000, 5.22s
2024-09-02 16:54:17 INFO     Saved model at 6
2024-09-02 16:54:17 INFO     Val loss decrease from 7.0012 to 6.5831, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 16:54:21 INFO     epoch complete!
2024-09-02 16:54:21 INFO     evaluating now!
2024-09-02 16:54:22 INFO     Epoch [7/200] train_loss: 6.3283, val_loss: 6.3474, lr: 0.003000, 5.14s
2024-09-02 16:54:22 INFO     Saved model at 7
2024-09-02 16:54:22 INFO     Val loss decrease from 6.5831 to 6.3474, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 16:54:27 INFO     epoch complete!
2024-09-02 16:54:27 INFO     evaluating now!
2024-09-02 16:54:27 INFO     Epoch [8/200] train_loss: 5.9818, val_loss: 6.0040, lr: 0.003000, 5.12s
2024-09-02 16:54:27 INFO     Saved model at 8
2024-09-02 16:54:27 INFO     Val loss decrease from 6.3474 to 6.0040, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 16:54:32 INFO     epoch complete!
2024-09-02 16:54:32 INFO     evaluating now!
2024-09-02 16:54:32 INFO     Epoch [9/200] train_loss: 5.8643, val_loss: 5.9799, lr: 0.003000, 5.11s
2024-09-02 16:54:32 INFO     Saved model at 9
2024-09-02 16:54:32 INFO     Val loss decrease from 6.0040 to 5.9799, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 16:54:37 INFO     epoch complete!
2024-09-02 16:54:37 INFO     evaluating now!
2024-09-02 16:54:37 INFO     Epoch [10/200] train_loss: 5.6897, val_loss: 5.7815, lr: 0.003000, 5.11s
2024-09-02 16:54:37 INFO     Saved model at 10
2024-09-02 16:54:37 INFO     Val loss decrease from 5.9799 to 5.7815, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 16:54:42 INFO     epoch complete!
2024-09-02 16:54:42 INFO     evaluating now!
2024-09-02 16:54:42 INFO     Epoch [11/200] train_loss: 5.4732, val_loss: 5.7190, lr: 0.003000, 5.12s
2024-09-02 16:54:42 INFO     Saved model at 11
2024-09-02 16:54:42 INFO     Val loss decrease from 5.7815 to 5.7190, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 16:54:47 INFO     epoch complete!
2024-09-02 16:54:47 INFO     evaluating now!
2024-09-02 16:54:47 INFO     Epoch [12/200] train_loss: 5.4250, val_loss: 5.5168, lr: 0.003000, 5.11s
2024-09-02 16:54:47 INFO     Saved model at 12
2024-09-02 16:54:47 INFO     Val loss decrease from 5.7190 to 5.5168, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 16:54:52 INFO     epoch complete!
2024-09-02 16:54:52 INFO     evaluating now!
2024-09-02 16:54:53 INFO     Epoch [13/200] train_loss: 5.3196, val_loss: 5.6177, lr: 0.003000, 5.10s
2024-09-02 16:54:57 INFO     epoch complete!
2024-09-02 16:54:57 INFO     evaluating now!
2024-09-02 16:54:58 INFO     Epoch [14/200] train_loss: 5.1936, val_loss: 5.6852, lr: 0.003000, 5.10s
2024-09-02 16:55:02 INFO     epoch complete!
2024-09-02 16:55:02 INFO     evaluating now!
2024-09-02 16:55:03 INFO     Epoch [15/200] train_loss: 5.0684, val_loss: 5.4029, lr: 0.003000, 5.12s
2024-09-02 16:55:03 INFO     Saved model at 15
2024-09-02 16:55:03 INFO     Val loss decrease from 5.5168 to 5.4029, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 16:55:08 INFO     epoch complete!
2024-09-02 16:55:08 INFO     evaluating now!
2024-09-02 16:55:08 INFO     Epoch [16/200] train_loss: 4.9523, val_loss: 5.4787, lr: 0.003000, 5.09s
2024-09-02 16:55:13 INFO     epoch complete!
2024-09-02 16:55:13 INFO     evaluating now!
2024-09-02 16:55:13 INFO     Epoch [17/200] train_loss: 4.9235, val_loss: 5.5421, lr: 0.003000, 5.11s
2024-09-02 16:55:18 INFO     epoch complete!
2024-09-02 16:55:18 INFO     evaluating now!
2024-09-02 16:55:18 INFO     Epoch [18/200] train_loss: 4.8953, val_loss: 5.5099, lr: 0.003000, 5.11s
2024-09-02 16:55:23 INFO     epoch complete!
2024-09-02 16:55:23 INFO     evaluating now!
2024-09-02 16:55:23 INFO     Epoch [19/200] train_loss: 4.8338, val_loss: 5.3614, lr: 0.003000, 5.11s
2024-09-02 16:55:23 INFO     Saved model at 19
2024-09-02 16:55:23 INFO     Val loss decrease from 5.4029 to 5.3614, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-02 16:55:28 INFO     epoch complete!
2024-09-02 16:55:28 INFO     evaluating now!
2024-09-02 16:55:28 INFO     Epoch [20/200] train_loss: 4.7118, val_loss: 5.4642, lr: 0.003000, 5.10s
2024-09-02 16:55:33 INFO     epoch complete!
2024-09-02 16:55:33 INFO     evaluating now!
2024-09-02 16:55:33 INFO     Epoch [21/200] train_loss: 4.6546, val_loss: 5.2948, lr: 0.003000, 5.13s
2024-09-02 16:55:33 INFO     Saved model at 21
2024-09-02 16:55:33 INFO     Val loss decrease from 5.3614 to 5.2948, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-02 16:55:38 INFO     epoch complete!
2024-09-02 16:55:38 INFO     evaluating now!
2024-09-02 16:55:39 INFO     Epoch [22/200] train_loss: 4.6371, val_loss: 5.3949, lr: 0.003000, 5.11s
2024-09-02 16:55:43 INFO     epoch complete!
2024-09-02 16:55:43 INFO     evaluating now!
2024-09-02 16:55:44 INFO     Epoch [23/200] train_loss: 4.5083, val_loss: 5.1560, lr: 0.003000, 5.10s
2024-09-02 16:55:44 INFO     Saved model at 23
2024-09-02 16:55:44 INFO     Val loss decrease from 5.2948 to 5.1560, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-02 16:55:49 INFO     epoch complete!
2024-09-02 16:55:49 INFO     evaluating now!
2024-09-02 16:55:49 INFO     Epoch [24/200] train_loss: 4.4950, val_loss: 5.1529, lr: 0.003000, 5.11s
2024-09-02 16:55:49 INFO     Saved model at 24
2024-09-02 16:55:49 INFO     Val loss decrease from 5.1560 to 5.1529, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-02 16:55:54 INFO     epoch complete!
2024-09-02 16:55:54 INFO     evaluating now!
2024-09-02 16:55:54 INFO     Epoch [25/200] train_loss: 4.4812, val_loss: 5.2417, lr: 0.003000, 5.10s
2024-09-02 16:55:59 INFO     epoch complete!
2024-09-02 16:55:59 INFO     evaluating now!
2024-09-02 16:55:59 INFO     Epoch [26/200] train_loss: 4.4030, val_loss: 5.1888, lr: 0.003000, 5.10s
2024-09-02 16:56:04 INFO     epoch complete!
2024-09-02 16:56:04 INFO     evaluating now!
2024-09-02 16:56:04 INFO     Epoch [27/200] train_loss: 4.3200, val_loss: 5.2434, lr: 0.003000, 5.10s
2024-09-02 16:56:09 INFO     epoch complete!
2024-09-02 16:56:09 INFO     evaluating now!
2024-09-02 16:56:09 INFO     Epoch [28/200] train_loss: 4.3497, val_loss: 5.1650, lr: 0.003000, 5.10s
2024-09-02 16:56:14 INFO     epoch complete!
2024-09-02 16:56:14 INFO     evaluating now!
2024-09-02 16:56:14 INFO     Epoch [29/200] train_loss: 4.2218, val_loss: 5.0759, lr: 0.003000, 5.14s
2024-09-02 16:56:14 INFO     Saved model at 29
2024-09-02 16:56:14 INFO     Val loss decrease from 5.1529 to 5.0759, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-02 16:56:19 INFO     epoch complete!
2024-09-02 16:56:19 INFO     evaluating now!
2024-09-02 16:56:20 INFO     Epoch [30/200] train_loss: 4.2354, val_loss: 5.0705, lr: 0.003000, 5.31s
2024-09-02 16:56:20 INFO     Saved model at 30
2024-09-02 16:56:20 INFO     Val loss decrease from 5.0759 to 5.0705, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-09-02 16:56:25 INFO     epoch complete!
2024-09-02 16:56:25 INFO     evaluating now!
2024-09-02 16:56:25 INFO     Epoch [31/200] train_loss: 4.1760, val_loss: 5.1980, lr: 0.003000, 5.13s
2024-09-02 16:56:30 INFO     epoch complete!
2024-09-02 16:56:30 INFO     evaluating now!
2024-09-02 16:56:30 INFO     Epoch [32/200] train_loss: 4.1189, val_loss: 5.2251, lr: 0.003000, 5.22s
2024-09-02 16:56:35 INFO     epoch complete!
2024-09-02 16:56:35 INFO     evaluating now!
2024-09-02 16:56:35 INFO     Epoch [33/200] train_loss: 4.0924, val_loss: 5.1388, lr: 0.003000, 5.16s
2024-09-02 16:56:40 INFO     epoch complete!
2024-09-02 16:56:40 INFO     evaluating now!
2024-09-02 16:56:40 INFO     Epoch [34/200] train_loss: 4.1102, val_loss: 5.0968, lr: 0.003000, 5.15s
2024-09-02 16:56:45 INFO     epoch complete!
2024-09-02 16:56:45 INFO     evaluating now!
2024-09-02 16:56:46 INFO     Epoch [35/200] train_loss: 4.0938, val_loss: 5.2000, lr: 0.003000, 5.29s
2024-09-02 16:56:51 INFO     epoch complete!
2024-09-02 16:56:51 INFO     evaluating now!
2024-09-02 16:56:51 INFO     Epoch [36/200] train_loss: 4.0243, val_loss: 5.0476, lr: 0.003000, 5.33s
2024-09-02 16:56:51 INFO     Saved model at 36
2024-09-02 16:56:51 INFO     Val loss decrease from 5.0705 to 5.0476, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-09-02 16:56:56 INFO     epoch complete!
2024-09-02 16:56:56 INFO     evaluating now!
2024-09-02 16:56:56 INFO     Epoch [37/200] train_loss: 3.9253, val_loss: 5.2091, lr: 0.003000, 5.29s
2024-09-02 16:57:01 INFO     epoch complete!
2024-09-02 16:57:01 INFO     evaluating now!
2024-09-02 16:57:02 INFO     Epoch [38/200] train_loss: 4.0115, val_loss: 5.3657, lr: 0.003000, 5.24s
2024-09-02 16:57:06 INFO     epoch complete!
2024-09-02 16:57:06 INFO     evaluating now!
2024-09-02 16:57:07 INFO     Epoch [39/200] train_loss: 3.9598, val_loss: 5.0563, lr: 0.003000, 5.25s
2024-09-02 16:57:12 INFO     epoch complete!
2024-09-02 16:57:12 INFO     evaluating now!
2024-09-02 16:57:12 INFO     Epoch [40/200] train_loss: 3.8703, val_loss: 5.0597, lr: 0.003000, 5.17s
2024-09-02 16:57:17 INFO     epoch complete!
2024-09-02 16:57:17 INFO     evaluating now!
2024-09-02 16:57:17 INFO     Epoch [41/200] train_loss: 3.8771, val_loss: 5.0255, lr: 0.003000, 5.24s
2024-09-02 16:57:17 INFO     Saved model at 41
2024-09-02 16:57:17 INFO     Val loss decrease from 5.0476 to 5.0255, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-09-02 16:57:22 INFO     epoch complete!
2024-09-02 16:57:22 INFO     evaluating now!
2024-09-02 16:57:22 INFO     Epoch [42/200] train_loss: 3.8370, val_loss: 5.0697, lr: 0.003000, 5.22s
2024-09-02 16:57:27 INFO     epoch complete!
2024-09-02 16:57:27 INFO     evaluating now!
2024-09-02 16:57:28 INFO     Epoch [43/200] train_loss: 3.9096, val_loss: 5.1379, lr: 0.003000, 5.22s
2024-09-02 16:57:33 INFO     epoch complete!
2024-09-02 16:57:33 INFO     evaluating now!
2024-09-02 16:57:33 INFO     Epoch [44/200] train_loss: 3.8804, val_loss: 5.0336, lr: 0.003000, 5.21s
2024-09-02 16:57:38 INFO     epoch complete!
2024-09-02 16:57:38 INFO     evaluating now!
2024-09-02 16:57:38 INFO     Epoch [45/200] train_loss: 3.8083, val_loss: 5.2298, lr: 0.003000, 5.27s
2024-09-02 16:57:43 INFO     epoch complete!
2024-09-02 16:57:43 INFO     evaluating now!
2024-09-02 16:57:43 INFO     Epoch [46/200] train_loss: 3.7584, val_loss: 5.0545, lr: 0.003000, 5.29s
2024-09-02 16:57:48 INFO     epoch complete!
2024-09-02 16:57:48 INFO     evaluating now!
2024-09-02 16:57:49 INFO     Epoch [47/200] train_loss: 3.7277, val_loss: 5.0926, lr: 0.003000, 5.26s
2024-09-02 16:57:54 INFO     epoch complete!
2024-09-02 16:57:54 INFO     evaluating now!
2024-09-02 16:57:54 INFO     Epoch [48/200] train_loss: 3.6702, val_loss: 5.0658, lr: 0.003000, 5.23s
2024-09-02 16:57:59 INFO     epoch complete!
2024-09-02 16:57:59 INFO     evaluating now!
2024-09-02 16:57:59 INFO     Epoch [49/200] train_loss: 3.7223, val_loss: 4.9741, lr: 0.003000, 5.14s
2024-09-02 16:57:59 INFO     Saved model at 49
2024-09-02 16:57:59 INFO     Val loss decrease from 5.0255 to 4.9741, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-09-02 16:58:04 INFO     epoch complete!
2024-09-02 16:58:04 INFO     evaluating now!
2024-09-02 16:58:04 INFO     Epoch [50/200] train_loss: 3.6711, val_loss: 4.9538, lr: 0.003000, 5.30s
2024-09-02 16:58:04 INFO     Saved model at 50
2024-09-02 16:58:04 INFO     Val loss decrease from 4.9741 to 4.9538, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch50.tar
2024-09-02 16:58:09 INFO     epoch complete!
2024-09-02 16:58:09 INFO     evaluating now!
2024-09-02 16:58:10 INFO     Epoch [51/200] train_loss: 3.6373, val_loss: 5.1556, lr: 0.003000, 5.17s
2024-09-02 16:58:14 INFO     epoch complete!
2024-09-02 16:58:14 INFO     evaluating now!
2024-09-02 16:58:15 INFO     Epoch [52/200] train_loss: 3.6517, val_loss: 5.1006, lr: 0.003000, 5.18s
2024-09-02 16:58:20 INFO     epoch complete!
2024-09-02 16:58:20 INFO     evaluating now!
2024-09-02 16:58:20 INFO     Epoch [53/200] train_loss: 3.6006, val_loss: 5.0367, lr: 0.003000, 5.38s
2024-09-02 16:58:25 INFO     epoch complete!
2024-09-02 16:58:25 INFO     evaluating now!
2024-09-02 16:58:25 INFO     Epoch [54/200] train_loss: 3.5914, val_loss: 4.9630, lr: 0.003000, 5.19s
2024-09-02 16:58:30 INFO     epoch complete!
2024-09-02 16:58:30 INFO     evaluating now!
2024-09-02 16:58:31 INFO     Epoch [55/200] train_loss: 3.6327, val_loss: 5.0530, lr: 0.003000, 5.24s
2024-09-02 16:58:35 INFO     epoch complete!
2024-09-02 16:58:35 INFO     evaluating now!
2024-09-02 16:58:36 INFO     Epoch [56/200] train_loss: 3.6231, val_loss: 5.2066, lr: 0.003000, 5.26s
2024-09-02 16:58:41 INFO     epoch complete!
2024-09-02 16:58:41 INFO     evaluating now!
2024-09-02 16:58:41 INFO     Epoch [57/200] train_loss: 3.6098, val_loss: 5.0670, lr: 0.003000, 5.27s
2024-09-02 16:58:46 INFO     epoch complete!
2024-09-02 16:58:46 INFO     evaluating now!
2024-09-02 16:58:46 INFO     Epoch [58/200] train_loss: 3.5509, val_loss: 5.0289, lr: 0.003000, 5.16s
2024-09-02 16:58:51 INFO     epoch complete!
2024-09-02 16:58:51 INFO     evaluating now!
2024-09-02 16:58:51 INFO     Epoch [59/200] train_loss: 3.5350, val_loss: 5.0341, lr: 0.003000, 5.27s
2024-09-02 16:58:56 INFO     epoch complete!
2024-09-02 16:58:56 INFO     evaluating now!
2024-09-02 16:58:57 INFO     Epoch [60/200] train_loss: 3.5150, val_loss: 5.0979, lr: 0.003000, 5.30s
2024-09-02 16:59:02 INFO     epoch complete!
2024-09-02 16:59:02 INFO     evaluating now!
2024-09-02 16:59:02 INFO     Epoch [61/200] train_loss: 3.5191, val_loss: 5.0952, lr: 0.003000, 5.31s
2024-09-02 16:59:07 INFO     epoch complete!
2024-09-02 16:59:07 INFO     evaluating now!
2024-09-02 16:59:07 INFO     Epoch [62/200] train_loss: 3.4823, val_loss: 5.0369, lr: 0.003000, 5.09s
2024-09-02 16:59:12 INFO     epoch complete!
2024-09-02 16:59:12 INFO     evaluating now!
2024-09-02 16:59:12 INFO     Epoch [63/200] train_loss: 3.4654, val_loss: 5.0060, lr: 0.003000, 5.09s
2024-09-02 16:59:17 INFO     epoch complete!
2024-09-02 16:59:17 INFO     evaluating now!
2024-09-02 16:59:17 INFO     Epoch [64/200] train_loss: 3.4608, val_loss: 5.0449, lr: 0.003000, 5.10s
2024-09-02 16:59:22 INFO     epoch complete!
2024-09-02 16:59:22 INFO     evaluating now!
2024-09-02 16:59:22 INFO     Epoch [65/200] train_loss: 3.4785, val_loss: 5.1068, lr: 0.003000, 5.09s
2024-09-02 16:59:22 WARNING  Early stopping at epoch: 65
2024-09-02 16:59:22 INFO     Trained totally 66 epochs, average train time is 4.872s, average eval time is 0.308s
2024-09-02 16:59:22 INFO     Loaded model at 50
2024-09-02 16:59:22 INFO     Saved model at ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 16:59:22 INFO     Start evaluating ...
2024-09-02 16:59:23 INFO     Note that you select the single mode to evaluate!
2024-09-02 16:59:23 INFO     Evaluate result is saved at ./libcity/cache/5/evaluate_cache\2024_09_02_16_59_23_AGCRN_CHITaxi20190406.csv
2024-09-02 16:59:23 INFO     
         MAE       RMSE
1   2.281747   7.014867
2   2.417477   7.817603
3   2.659271   8.880180
4   2.774764   9.616159
5   2.808201  10.119027
6   2.904310  10.555946
7   2.999873  11.134367
8   3.058198  11.596550
9   3.188060  12.092186
10  3.223494  12.502512
11  3.316395  12.943817
12  3.471891  13.508974
2024-09-02 16:59:24 INFO     ----------------------------------------------------------------------------
2024-09-02 16:59:24 INFO     # 4, Kownledge Graph Embedding: TransE, Experiment ids: 9
2024-09-02 16:59:24 INFO     ----------------------------------------------------------------------------
2024-09-02 16:59:24 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=5
2024-09-02 16:59:24 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 5, 'embedding_model': 'TransE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 16:59:24 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 16:59:24 INFO     set_weight_link_or_dist: dist
2024-09-02 16:59:24 INFO     init_weight_inf_or_zero: inf
2024-09-02 16:59:24 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 16:59:24 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 16:59:24 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 16:59:24 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 16:59:26 INFO     Dataset created
2024-09-02 16:59:26 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 16:59:26 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 16:59:26 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 16:59:26 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 16:59:26 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 16:59:26 INFO     NormalScaler max: 1.6393284718907857
2024-09-02 16:59:28 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 16:59:28 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 16:59:28 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 16:59:28 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 16:59:28 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 16:59:28 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 16:59:28 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 16:59:28 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 16:59:28 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 16:59:28 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 16:59:28 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 16:59:28 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 16:59:28 INFO     Total parameter numbers: 874010
2024-09-02 16:59:28 INFO     You select `adam` optimizer.
2024-09-02 16:59:28 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 16:59:28 INFO     Start training ...
2024-09-02 16:59:28 INFO     num_batches:48
2024-09-02 16:59:33 INFO     epoch complete!
2024-09-02 16:59:33 INFO     evaluating now!
2024-09-02 16:59:33 INFO     Epoch [0/200] train_loss: 23.6850, val_loss: 18.0694, lr: 0.003000, 5.30s
2024-09-02 16:59:33 INFO     Saved model at 0
2024-09-02 16:59:33 INFO     Val loss decrease from inf to 18.0694, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 16:59:38 INFO     epoch complete!
2024-09-02 16:59:38 INFO     evaluating now!
2024-09-02 16:59:39 INFO     Epoch [1/200] train_loss: 14.7172, val_loss: 14.1868, lr: 0.003000, 5.09s
2024-09-02 16:59:39 INFO     Saved model at 1
2024-09-02 16:59:39 INFO     Val loss decrease from 18.0694 to 14.1868, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 16:59:43 INFO     epoch complete!
2024-09-02 16:59:43 INFO     evaluating now!
2024-09-02 16:59:44 INFO     Epoch [2/200] train_loss: 11.8851, val_loss: 11.3834, lr: 0.003000, 5.08s
2024-09-02 16:59:44 INFO     Saved model at 2
2024-09-02 16:59:44 INFO     Val loss decrease from 14.1868 to 11.3834, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 16:59:48 INFO     epoch complete!
2024-09-02 16:59:48 INFO     evaluating now!
2024-09-02 16:59:49 INFO     Epoch [3/200] train_loss: 9.7552, val_loss: 9.3144, lr: 0.003000, 5.07s
2024-09-02 16:59:49 INFO     Saved model at 3
2024-09-02 16:59:49 INFO     Val loss decrease from 11.3834 to 9.3144, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 16:59:54 INFO     epoch complete!
2024-09-02 16:59:54 INFO     evaluating now!
2024-09-02 16:59:54 INFO     Epoch [4/200] train_loss: 8.4159, val_loss: 8.1180, lr: 0.003000, 5.07s
2024-09-02 16:59:54 INFO     Saved model at 4
2024-09-02 16:59:54 INFO     Val loss decrease from 9.3144 to 8.1180, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 16:59:59 INFO     epoch complete!
2024-09-02 16:59:59 INFO     evaluating now!
2024-09-02 16:59:59 INFO     Epoch [5/200] train_loss: 7.5712, val_loss: 7.4962, lr: 0.003000, 5.07s
2024-09-02 16:59:59 INFO     Saved model at 5
2024-09-02 16:59:59 INFO     Val loss decrease from 8.1180 to 7.4962, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 17:00:04 INFO     epoch complete!
2024-09-02 17:00:04 INFO     evaluating now!
2024-09-02 17:00:04 INFO     Epoch [6/200] train_loss: 7.0658, val_loss: 7.0037, lr: 0.003000, 5.11s
2024-09-02 17:00:04 INFO     Saved model at 6
2024-09-02 17:00:04 INFO     Val loss decrease from 7.4962 to 7.0037, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 17:00:09 INFO     epoch complete!
2024-09-02 17:00:09 INFO     evaluating now!
2024-09-02 17:00:09 INFO     Epoch [7/200] train_loss: 6.6959, val_loss: 6.4393, lr: 0.003000, 5.07s
2024-09-02 17:00:09 INFO     Saved model at 7
2024-09-02 17:00:09 INFO     Val loss decrease from 7.0037 to 6.4393, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 17:00:14 INFO     epoch complete!
2024-09-02 17:00:14 INFO     evaluating now!
2024-09-02 17:00:14 INFO     Epoch [8/200] train_loss: 6.2771, val_loss: 6.2984, lr: 0.003000, 5.06s
2024-09-02 17:00:14 INFO     Saved model at 8
2024-09-02 17:00:14 INFO     Val loss decrease from 6.4393 to 6.2984, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 17:00:19 INFO     epoch complete!
2024-09-02 17:00:19 INFO     evaluating now!
2024-09-02 17:00:19 INFO     Epoch [9/200] train_loss: 6.0663, val_loss: 6.1706, lr: 0.003000, 5.08s
2024-09-02 17:00:19 INFO     Saved model at 9
2024-09-02 17:00:19 INFO     Val loss decrease from 6.2984 to 6.1706, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 17:00:24 INFO     epoch complete!
2024-09-02 17:00:24 INFO     evaluating now!
2024-09-02 17:00:24 INFO     Epoch [10/200] train_loss: 5.8821, val_loss: 6.0588, lr: 0.003000, 5.08s
2024-09-02 17:00:24 INFO     Saved model at 10
2024-09-02 17:00:24 INFO     Val loss decrease from 6.1706 to 6.0588, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 17:00:29 INFO     epoch complete!
2024-09-02 17:00:29 INFO     evaluating now!
2024-09-02 17:00:29 INFO     Epoch [11/200] train_loss: 5.7959, val_loss: 5.9432, lr: 0.003000, 5.08s
2024-09-02 17:00:29 INFO     Saved model at 11
2024-09-02 17:00:29 INFO     Val loss decrease from 6.0588 to 5.9432, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 17:00:34 INFO     epoch complete!
2024-09-02 17:00:34 INFO     evaluating now!
2024-09-02 17:00:35 INFO     Epoch [12/200] train_loss: 5.6035, val_loss: 5.8986, lr: 0.003000, 5.10s
2024-09-02 17:00:35 INFO     Saved model at 12
2024-09-02 17:00:35 INFO     Val loss decrease from 5.9432 to 5.8986, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 17:00:39 INFO     epoch complete!
2024-09-02 17:00:39 INFO     evaluating now!
2024-09-02 17:00:40 INFO     Epoch [13/200] train_loss: 5.4754, val_loss: 6.1844, lr: 0.003000, 5.08s
2024-09-02 17:00:44 INFO     epoch complete!
2024-09-02 17:00:44 INFO     evaluating now!
2024-09-02 17:00:45 INFO     Epoch [14/200] train_loss: 5.4483, val_loss: 5.5856, lr: 0.003000, 5.07s
2024-09-02 17:00:45 INFO     Saved model at 14
2024-09-02 17:00:45 INFO     Val loss decrease from 5.8986 to 5.5856, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-02 17:00:50 INFO     epoch complete!
2024-09-02 17:00:50 INFO     evaluating now!
2024-09-02 17:00:50 INFO     Epoch [15/200] train_loss: 5.2371, val_loss: 5.5785, lr: 0.003000, 5.08s
2024-09-02 17:00:50 INFO     Saved model at 15
2024-09-02 17:00:50 INFO     Val loss decrease from 5.5856 to 5.5785, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 17:00:55 INFO     epoch complete!
2024-09-02 17:00:55 INFO     evaluating now!
2024-09-02 17:00:55 INFO     Epoch [16/200] train_loss: 5.2074, val_loss: 5.7788, lr: 0.003000, 5.07s
2024-09-02 17:01:00 INFO     epoch complete!
2024-09-02 17:01:00 INFO     evaluating now!
2024-09-02 17:01:00 INFO     Epoch [17/200] train_loss: 5.1633, val_loss: 5.6017, lr: 0.003000, 5.08s
2024-09-02 17:01:05 INFO     epoch complete!
2024-09-02 17:01:05 INFO     evaluating now!
2024-09-02 17:01:05 INFO     Epoch [18/200] train_loss: 5.0421, val_loss: 5.4609, lr: 0.003000, 5.08s
2024-09-02 17:01:05 INFO     Saved model at 18
2024-09-02 17:01:05 INFO     Val loss decrease from 5.5785 to 5.4609, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-02 17:01:10 INFO     epoch complete!
2024-09-02 17:01:10 INFO     evaluating now!
2024-09-02 17:01:10 INFO     Epoch [19/200] train_loss: 4.8965, val_loss: 5.3954, lr: 0.003000, 5.08s
2024-09-02 17:01:10 INFO     Saved model at 19
2024-09-02 17:01:10 INFO     Val loss decrease from 5.4609 to 5.3954, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-02 17:01:15 INFO     epoch complete!
2024-09-02 17:01:15 INFO     evaluating now!
2024-09-02 17:01:15 INFO     Epoch [20/200] train_loss: 4.9452, val_loss: 5.4865, lr: 0.003000, 5.08s
2024-09-02 17:01:20 INFO     epoch complete!
2024-09-02 17:01:20 INFO     evaluating now!
2024-09-02 17:01:20 INFO     Epoch [21/200] train_loss: 4.7992, val_loss: 5.6597, lr: 0.003000, 5.08s
2024-09-02 17:01:25 INFO     epoch complete!
2024-09-02 17:01:25 INFO     evaluating now!
2024-09-02 17:01:25 INFO     Epoch [22/200] train_loss: 4.7471, val_loss: 5.4404, lr: 0.003000, 5.07s
2024-09-02 17:01:30 INFO     epoch complete!
2024-09-02 17:01:30 INFO     evaluating now!
2024-09-02 17:01:30 INFO     Epoch [23/200] train_loss: 4.7223, val_loss: 5.3338, lr: 0.003000, 5.06s
2024-09-02 17:01:30 INFO     Saved model at 23
2024-09-02 17:01:30 INFO     Val loss decrease from 5.3954 to 5.3338, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-02 17:01:35 INFO     epoch complete!
2024-09-02 17:01:35 INFO     evaluating now!
2024-09-02 17:01:36 INFO     Epoch [24/200] train_loss: 4.6455, val_loss: 5.3119, lr: 0.003000, 5.07s
2024-09-02 17:01:36 INFO     Saved model at 24
2024-09-02 17:01:36 INFO     Val loss decrease from 5.3338 to 5.3119, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-02 17:01:40 INFO     epoch complete!
2024-09-02 17:01:40 INFO     evaluating now!
2024-09-02 17:01:41 INFO     Epoch [25/200] train_loss: 4.6299, val_loss: 5.1680, lr: 0.003000, 5.08s
2024-09-02 17:01:41 INFO     Saved model at 25
2024-09-02 17:01:41 INFO     Val loss decrease from 5.3119 to 5.1680, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-02 17:01:45 INFO     epoch complete!
2024-09-02 17:01:45 INFO     evaluating now!
2024-09-02 17:01:46 INFO     Epoch [26/200] train_loss: 4.5115, val_loss: 5.1891, lr: 0.003000, 5.08s
2024-09-02 17:01:51 INFO     epoch complete!
2024-09-02 17:01:51 INFO     evaluating now!
2024-09-02 17:01:51 INFO     Epoch [27/200] train_loss: 4.4804, val_loss: 5.1858, lr: 0.003000, 5.08s
2024-09-02 17:01:56 INFO     epoch complete!
2024-09-02 17:01:56 INFO     evaluating now!
2024-09-02 17:01:56 INFO     Epoch [28/200] train_loss: 4.5482, val_loss: 5.1065, lr: 0.003000, 5.07s
2024-09-02 17:01:56 INFO     Saved model at 28
2024-09-02 17:01:56 INFO     Val loss decrease from 5.1680 to 5.1065, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-02 17:02:01 INFO     epoch complete!
2024-09-02 17:02:01 INFO     evaluating now!
2024-09-02 17:02:01 INFO     Epoch [29/200] train_loss: 4.4330, val_loss: 5.2720, lr: 0.003000, 5.06s
2024-09-02 17:02:06 INFO     epoch complete!
2024-09-02 17:02:06 INFO     evaluating now!
2024-09-02 17:02:06 INFO     Epoch [30/200] train_loss: 4.3530, val_loss: 5.1981, lr: 0.003000, 5.13s
2024-09-02 17:02:11 INFO     epoch complete!
2024-09-02 17:02:11 INFO     evaluating now!
2024-09-02 17:02:11 INFO     Epoch [31/200] train_loss: 4.3585, val_loss: 5.2345, lr: 0.003000, 5.07s
2024-09-02 17:02:16 INFO     epoch complete!
2024-09-02 17:02:16 INFO     evaluating now!
2024-09-02 17:02:16 INFO     Epoch [32/200] train_loss: 4.3578, val_loss: 5.0839, lr: 0.003000, 5.08s
2024-09-02 17:02:16 INFO     Saved model at 32
2024-09-02 17:02:16 INFO     Val loss decrease from 5.1065 to 5.0839, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-09-02 17:02:21 INFO     epoch complete!
2024-09-02 17:02:21 INFO     evaluating now!
2024-09-02 17:02:21 INFO     Epoch [33/200] train_loss: 4.2831, val_loss: 5.1646, lr: 0.003000, 5.10s
2024-09-02 17:02:26 INFO     epoch complete!
2024-09-02 17:02:26 INFO     evaluating now!
2024-09-02 17:02:26 INFO     Epoch [34/200] train_loss: 4.2210, val_loss: 4.9928, lr: 0.003000, 5.07s
2024-09-02 17:02:26 INFO     Saved model at 34
2024-09-02 17:02:26 INFO     Val loss decrease from 5.0839 to 4.9928, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-09-02 17:02:31 INFO     epoch complete!
2024-09-02 17:02:31 INFO     evaluating now!
2024-09-02 17:02:32 INFO     Epoch [35/200] train_loss: 4.1656, val_loss: 5.1093, lr: 0.003000, 5.07s
2024-09-02 17:02:36 INFO     epoch complete!
2024-09-02 17:02:36 INFO     evaluating now!
2024-09-02 17:02:37 INFO     Epoch [36/200] train_loss: 4.1366, val_loss: 5.0313, lr: 0.003000, 5.07s
2024-09-02 17:02:41 INFO     epoch complete!
2024-09-02 17:02:41 INFO     evaluating now!
2024-09-02 17:02:42 INFO     Epoch [37/200] train_loss: 4.1181, val_loss: 5.2268, lr: 0.003000, 5.07s
2024-09-02 17:02:46 INFO     epoch complete!
2024-09-02 17:02:46 INFO     evaluating now!
2024-09-02 17:02:47 INFO     Epoch [38/200] train_loss: 4.1386, val_loss: 5.1126, lr: 0.003000, 5.11s
2024-09-02 17:02:52 INFO     epoch complete!
2024-09-02 17:02:52 INFO     evaluating now!
2024-09-02 17:02:52 INFO     Epoch [39/200] train_loss: 4.0998, val_loss: 5.1583, lr: 0.003000, 5.11s
2024-09-02 17:02:57 INFO     epoch complete!
2024-09-02 17:02:57 INFO     evaluating now!
2024-09-02 17:02:57 INFO     Epoch [40/200] train_loss: 4.1038, val_loss: 5.2069, lr: 0.003000, 5.09s
2024-09-02 17:03:02 INFO     epoch complete!
2024-09-02 17:03:02 INFO     evaluating now!
2024-09-02 17:03:02 INFO     Epoch [41/200] train_loss: 4.0528, val_loss: 5.0710, lr: 0.003000, 5.09s
2024-09-02 17:03:07 INFO     epoch complete!
2024-09-02 17:03:07 INFO     evaluating now!
2024-09-02 17:03:07 INFO     Epoch [42/200] train_loss: 4.0580, val_loss: 5.1711, lr: 0.003000, 5.10s
2024-09-02 17:03:12 INFO     epoch complete!
2024-09-02 17:03:12 INFO     evaluating now!
2024-09-02 17:03:12 INFO     Epoch [43/200] train_loss: 4.1099, val_loss: 5.0939, lr: 0.003000, 5.09s
2024-09-02 17:03:17 INFO     epoch complete!
2024-09-02 17:03:17 INFO     evaluating now!
2024-09-02 17:03:17 INFO     Epoch [44/200] train_loss: 3.9682, val_loss: 4.9249, lr: 0.003000, 5.14s
2024-09-02 17:03:17 INFO     Saved model at 44
2024-09-02 17:03:17 INFO     Val loss decrease from 4.9928 to 4.9249, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-09-02 17:03:22 INFO     epoch complete!
2024-09-02 17:03:22 INFO     evaluating now!
2024-09-02 17:03:23 INFO     Epoch [45/200] train_loss: 3.8993, val_loss: 5.0099, lr: 0.003000, 5.11s
2024-09-02 17:03:27 INFO     epoch complete!
2024-09-02 17:03:27 INFO     evaluating now!
2024-09-02 17:03:28 INFO     Epoch [46/200] train_loss: 3.8726, val_loss: 5.1542, lr: 0.003000, 5.23s
2024-09-02 17:03:33 INFO     epoch complete!
2024-09-02 17:03:33 INFO     evaluating now!
2024-09-02 17:03:33 INFO     Epoch [47/200] train_loss: 3.9107, val_loss: 5.0514, lr: 0.003000, 5.20s
2024-09-02 17:03:38 INFO     epoch complete!
2024-09-02 17:03:38 INFO     evaluating now!
2024-09-02 17:03:38 INFO     Epoch [48/200] train_loss: 3.8435, val_loss: 4.8497, lr: 0.003000, 5.16s
2024-09-02 17:03:38 INFO     Saved model at 48
2024-09-02 17:03:38 INFO     Val loss decrease from 4.9249 to 4.8497, saving to ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-09-02 17:03:43 INFO     epoch complete!
2024-09-02 17:03:43 INFO     evaluating now!
2024-09-02 17:03:43 INFO     Epoch [49/200] train_loss: 3.9205, val_loss: 5.2332, lr: 0.003000, 5.09s
2024-09-02 17:03:48 INFO     epoch complete!
2024-09-02 17:03:48 INFO     evaluating now!
2024-09-02 17:03:48 INFO     Epoch [50/200] train_loss: 3.8818, val_loss: 4.9363, lr: 0.003000, 5.13s
2024-09-02 17:03:53 INFO     epoch complete!
2024-09-02 17:03:53 INFO     evaluating now!
2024-09-02 17:03:53 INFO     Epoch [51/200] train_loss: 3.8249, val_loss: 5.1329, lr: 0.003000, 5.12s
2024-09-02 17:03:58 INFO     epoch complete!
2024-09-02 17:03:58 INFO     evaluating now!
2024-09-02 17:03:59 INFO     Epoch [52/200] train_loss: 3.7687, val_loss: 4.9935, lr: 0.003000, 5.12s
2024-09-02 17:04:03 INFO     epoch complete!
2024-09-02 17:04:03 INFO     evaluating now!
2024-09-02 17:04:04 INFO     Epoch [53/200] train_loss: 3.7398, val_loss: 5.0572, lr: 0.003000, 5.12s
2024-09-02 17:04:09 INFO     epoch complete!
2024-09-02 17:04:09 INFO     evaluating now!
2024-09-02 17:04:09 INFO     Epoch [54/200] train_loss: 3.7305, val_loss: 5.0791, lr: 0.003000, 5.21s
2024-09-02 17:04:14 INFO     epoch complete!
2024-09-02 17:04:14 INFO     evaluating now!
2024-09-02 17:04:14 INFO     Epoch [55/200] train_loss: 3.6815, val_loss: 4.9853, lr: 0.003000, 5.30s
2024-09-02 17:04:19 INFO     epoch complete!
2024-09-02 17:04:19 INFO     evaluating now!
2024-09-02 17:04:20 INFO     Epoch [56/200] train_loss: 3.6896, val_loss: 5.1842, lr: 0.003000, 5.33s
2024-09-02 17:04:24 INFO     epoch complete!
2024-09-02 17:04:24 INFO     evaluating now!
2024-09-02 17:04:25 INFO     Epoch [57/200] train_loss: 3.7285, val_loss: 4.8884, lr: 0.003000, 5.23s
2024-09-02 17:04:30 INFO     epoch complete!
2024-09-02 17:04:30 INFO     evaluating now!
2024-09-02 17:04:30 INFO     Epoch [58/200] train_loss: 3.6815, val_loss: 5.0579, lr: 0.003000, 5.28s
2024-09-02 17:04:35 INFO     epoch complete!
2024-09-02 17:04:35 INFO     evaluating now!
2024-09-02 17:04:35 INFO     Epoch [59/200] train_loss: 3.6451, val_loss: 5.0159, lr: 0.003000, 5.14s
2024-09-02 17:04:40 INFO     epoch complete!
2024-09-02 17:04:40 INFO     evaluating now!
2024-09-02 17:04:40 INFO     Epoch [60/200] train_loss: 3.6384, val_loss: 5.0125, lr: 0.003000, 5.17s
2024-09-02 17:04:45 INFO     epoch complete!
2024-09-02 17:04:45 INFO     evaluating now!
2024-09-02 17:04:46 INFO     Epoch [61/200] train_loss: 3.6403, val_loss: 5.1031, lr: 0.003000, 5.14s
2024-09-02 17:04:50 INFO     epoch complete!
2024-09-02 17:04:50 INFO     evaluating now!
2024-09-02 17:04:51 INFO     Epoch [62/200] train_loss: 3.6351, val_loss: 5.0766, lr: 0.003000, 5.18s
2024-09-02 17:04:56 INFO     epoch complete!
2024-09-02 17:04:56 INFO     evaluating now!
2024-09-02 17:04:56 INFO     Epoch [63/200] train_loss: 3.5841, val_loss: 5.0925, lr: 0.003000, 5.22s
2024-09-02 17:04:56 WARNING  Early stopping at epoch: 63
2024-09-02 17:04:56 INFO     Trained totally 64 epochs, average train time is 4.812s, average eval time is 0.304s
2024-09-02 17:04:56 INFO     Loaded model at 48
2024-09-02 17:04:56 INFO     Saved model at ./libcity/cache/5/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 17:04:56 INFO     Start evaluating ...
2024-09-02 17:04:57 INFO     Note that you select the single mode to evaluate!
2024-09-02 17:04:57 INFO     Evaluate result is saved at ./libcity/cache/5/evaluate_cache\2024_09_02_17_04_57_AGCRN_CHITaxi20190406.csv
2024-09-02 17:04:57 INFO     
         MAE       RMSE
1   2.455867   7.501326
2   2.458496   8.076552
3   2.634680   8.999011
4   2.776663   9.809071
5   2.949692  10.473218
6   3.036349  11.246565
7   3.175425  11.698358
8   3.212329  12.060318
9   3.156924  12.399855
10  3.199656  12.678971
11  3.264939  13.048421
12  3.421066  13.676697
2024-09-02 17:04:57 INFO     ----------------------------------------------------------------------------
2024-09-02 17:04:57 INFO     Kownledge Graph Embedding: TransE, Experiment ids: [5, 6, 7, 8, 9]
2024-09-02 17:04:57 INFO     ----------------------------------------------------------------------------
2024-09-02 17:04:57 INFO     Average: 
         MAE       RMSE
0   2.343884   7.273417
1   2.436825   7.856254
2   2.626992   8.887357
3   2.792992   9.726089
4   2.931053  10.490445
5   3.011878  11.126657
6   3.083527  11.687697
7   3.122013  12.094282
8   3.158607  12.484119
9   3.240107  12.812840
10  3.330105  13.191481
11  3.464517  13.786628 
2024-09-02 17:04:57 INFO     Standard deviation: 
         MAE      RMSE
0   0.131789  0.432407
1   0.071640  0.245267
2   0.025326  0.150766
3   0.042333  0.094795
4   0.086427  0.235404
5   0.067077  0.453221
6   0.100079  0.609358
7   0.132887  0.758663
8   0.112653  0.732094
9   0.104401  0.699731
10  0.084670  0.505921
11  0.043410  0.343704
2024-09-02 17:04:57 INFO     ----------------------------------------------------------------------------
2024-09-02 17:04:57 INFO     12 steps Average: 
        MAE       RMSE
0  2.961875  10.951439
2024-09-02 17:04:57 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.083558  0.438444
