2024-09-02 13:04:02 INFO     Saving logs in: ./logs/CHITaxi20190406\AGCRN\ExtSpace\MuRE
2024-09-02 13:04:02 INFO     ----------------------------------------------------------------------------
2024-09-02 13:04:02 INFO     # 0, Kownledge Graph Embedding: MuRE, Experiment ids: 10
2024-09-02 13:04:02 INFO     ----------------------------------------------------------------------------
2024-09-02 13:04:02 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=10
2024-09-02 13:04:02 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10, 'embedding_model': 'MuRE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 13:04:02 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 13:04:02 INFO     set_weight_link_or_dist: dist
2024-09-02 13:04:02 INFO     init_weight_inf_or_zero: inf
2024-09-02 13:04:02 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 13:04:02 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 13:04:02 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 13:04:02 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 13:04:04 INFO     Dataset created
2024-09-02 13:04:04 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 13:04:04 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 13:04:04 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 13:04:04 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 13:04:04 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 13:04:04 INFO     NormalScaler max: 0.9267852697961692
2024-09-02 13:04:07 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 13:04:07 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 13:04:07 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 13:04:07 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 13:04:07 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 13:04:07 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 13:04:07 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 13:04:07 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 13:04:07 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 13:04:07 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 13:04:07 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 13:04:07 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 13:04:07 INFO     Total parameter numbers: 874010
2024-09-02 13:04:07 INFO     You select `adam` optimizer.
2024-09-02 13:04:07 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 13:04:07 INFO     Start training ...
2024-09-02 13:04:07 INFO     num_batches:48
2024-09-02 13:04:14 INFO     epoch complete!
2024-09-02 13:04:14 INFO     evaluating now!
2024-09-02 13:04:14 INFO     Epoch [0/200] train_loss: 25.7869, val_loss: 18.6436, lr: 0.003000, 6.56s
2024-09-02 13:04:14 INFO     Saved model at 0
2024-09-02 13:04:14 INFO     Val loss decrease from inf to 18.6436, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 13:04:19 INFO     epoch complete!
2024-09-02 13:04:19 INFO     evaluating now!
2024-09-02 13:04:19 INFO     Epoch [1/200] train_loss: 15.8623, val_loss: 15.8870, lr: 0.003000, 5.07s
2024-09-02 13:04:19 INFO     Saved model at 1
2024-09-02 13:04:19 INFO     Val loss decrease from 18.6436 to 15.8870, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 13:04:24 INFO     epoch complete!
2024-09-02 13:04:24 INFO     evaluating now!
2024-09-02 13:04:24 INFO     Epoch [2/200] train_loss: 13.6019, val_loss: 13.5372, lr: 0.003000, 5.08s
2024-09-02 13:04:24 INFO     Saved model at 2
2024-09-02 13:04:24 INFO     Val loss decrease from 15.8870 to 13.5372, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 13:04:29 INFO     epoch complete!
2024-09-02 13:04:29 INFO     evaluating now!
2024-09-02 13:04:29 INFO     Epoch [3/200] train_loss: 11.4475, val_loss: 11.2304, lr: 0.003000, 5.07s
2024-09-02 13:04:29 INFO     Saved model at 3
2024-09-02 13:04:29 INFO     Val loss decrease from 13.5372 to 11.2304, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 13:04:34 INFO     epoch complete!
2024-09-02 13:04:34 INFO     evaluating now!
2024-09-02 13:04:34 INFO     Epoch [4/200] train_loss: 9.7609, val_loss: 9.5070, lr: 0.003000, 5.06s
2024-09-02 13:04:34 INFO     Saved model at 4
2024-09-02 13:04:34 INFO     Val loss decrease from 11.2304 to 9.5070, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 13:04:39 INFO     epoch complete!
2024-09-02 13:04:39 INFO     evaluating now!
2024-09-02 13:04:39 INFO     Epoch [5/200] train_loss: 8.7658, val_loss: 8.2242, lr: 0.003000, 5.08s
2024-09-02 13:04:39 INFO     Saved model at 5
2024-09-02 13:04:39 INFO     Val loss decrease from 9.5070 to 8.2242, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 13:04:44 INFO     epoch complete!
2024-09-02 13:04:44 INFO     evaluating now!
2024-09-02 13:04:44 INFO     Epoch [6/200] train_loss: 7.7076, val_loss: 7.6408, lr: 0.003000, 5.09s
2024-09-02 13:04:44 INFO     Saved model at 6
2024-09-02 13:04:44 INFO     Val loss decrease from 8.2242 to 7.6408, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 13:04:49 INFO     epoch complete!
2024-09-02 13:04:49 INFO     evaluating now!
2024-09-02 13:04:50 INFO     Epoch [7/200] train_loss: 7.1708, val_loss: 7.3664, lr: 0.003000, 5.08s
2024-09-02 13:04:50 INFO     Saved model at 7
2024-09-02 13:04:50 INFO     Val loss decrease from 7.6408 to 7.3664, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 13:04:54 INFO     epoch complete!
2024-09-02 13:04:54 INFO     evaluating now!
2024-09-02 13:04:55 INFO     Epoch [8/200] train_loss: 6.9102, val_loss: 6.8191, lr: 0.003000, 5.07s
2024-09-02 13:04:55 INFO     Saved model at 8
2024-09-02 13:04:55 INFO     Val loss decrease from 7.3664 to 6.8191, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 13:04:59 INFO     epoch complete!
2024-09-02 13:04:59 INFO     evaluating now!
2024-09-02 13:05:00 INFO     Epoch [9/200] train_loss: 6.4177, val_loss: 6.4343, lr: 0.003000, 5.09s
2024-09-02 13:05:00 INFO     Saved model at 9
2024-09-02 13:05:00 INFO     Val loss decrease from 6.8191 to 6.4343, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 13:05:05 INFO     epoch complete!
2024-09-02 13:05:05 INFO     evaluating now!
2024-09-02 13:05:05 INFO     Epoch [10/200] train_loss: 6.2290, val_loss: 6.3763, lr: 0.003000, 5.09s
2024-09-02 13:05:05 INFO     Saved model at 10
2024-09-02 13:05:05 INFO     Val loss decrease from 6.4343 to 6.3763, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 13:05:10 INFO     epoch complete!
2024-09-02 13:05:10 INFO     evaluating now!
2024-09-02 13:05:10 INFO     Epoch [11/200] train_loss: 6.1332, val_loss: 6.1310, lr: 0.003000, 5.09s
2024-09-02 13:05:10 INFO     Saved model at 11
2024-09-02 13:05:10 INFO     Val loss decrease from 6.3763 to 6.1310, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 13:05:15 INFO     epoch complete!
2024-09-02 13:05:15 INFO     evaluating now!
2024-09-02 13:05:15 INFO     Epoch [12/200] train_loss: 5.9766, val_loss: 6.2010, lr: 0.003000, 5.10s
2024-09-02 13:05:20 INFO     epoch complete!
2024-09-02 13:05:20 INFO     evaluating now!
2024-09-02 13:05:20 INFO     Epoch [13/200] train_loss: 5.7479, val_loss: 5.9457, lr: 0.003000, 5.09s
2024-09-02 13:05:20 INFO     Saved model at 13
2024-09-02 13:05:20 INFO     Val loss decrease from 6.1310 to 5.9457, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 13:05:25 INFO     epoch complete!
2024-09-02 13:05:25 INFO     evaluating now!
2024-09-02 13:05:25 INFO     Epoch [14/200] train_loss: 5.7714, val_loss: 6.3168, lr: 0.003000, 5.08s
2024-09-02 13:05:30 INFO     epoch complete!
2024-09-02 13:05:30 INFO     evaluating now!
2024-09-02 13:05:30 INFO     Epoch [15/200] train_loss: 5.6368, val_loss: 5.9086, lr: 0.003000, 5.10s
2024-09-02 13:05:30 INFO     Saved model at 15
2024-09-02 13:05:30 INFO     Val loss decrease from 5.9457 to 5.9086, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 13:05:35 INFO     epoch complete!
2024-09-02 13:05:35 INFO     evaluating now!
2024-09-02 13:05:35 INFO     Epoch [16/200] train_loss: 5.4263, val_loss: 5.6562, lr: 0.003000, 5.09s
2024-09-02 13:05:35 INFO     Saved model at 16
2024-09-02 13:05:35 INFO     Val loss decrease from 5.9086 to 5.6562, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 13:05:40 INFO     epoch complete!
2024-09-02 13:05:40 INFO     evaluating now!
2024-09-02 13:05:41 INFO     Epoch [17/200] train_loss: 5.2583, val_loss: 5.6245, lr: 0.003000, 5.08s
2024-09-02 13:05:41 INFO     Saved model at 17
2024-09-02 13:05:41 INFO     Val loss decrease from 5.6562 to 5.6245, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-02 13:05:45 INFO     epoch complete!
2024-09-02 13:05:45 INFO     evaluating now!
2024-09-02 13:05:46 INFO     Epoch [18/200] train_loss: 5.3328, val_loss: 5.6887, lr: 0.003000, 5.08s
2024-09-02 13:05:50 INFO     epoch complete!
2024-09-02 13:05:50 INFO     evaluating now!
2024-09-02 13:05:51 INFO     Epoch [19/200] train_loss: 5.2255, val_loss: 5.5434, lr: 0.003000, 5.10s
2024-09-02 13:05:51 INFO     Saved model at 19
2024-09-02 13:05:51 INFO     Val loss decrease from 5.6245 to 5.5434, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-02 13:05:56 INFO     epoch complete!
2024-09-02 13:05:56 INFO     evaluating now!
2024-09-02 13:05:56 INFO     Epoch [20/200] train_loss: 5.1549, val_loss: 5.5097, lr: 0.003000, 5.09s
2024-09-02 13:05:56 INFO     Saved model at 20
2024-09-02 13:05:56 INFO     Val loss decrease from 5.5434 to 5.5097, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-02 13:06:01 INFO     epoch complete!
2024-09-02 13:06:01 INFO     evaluating now!
2024-09-02 13:06:01 INFO     Epoch [21/200] train_loss: 5.0558, val_loss: 5.5911, lr: 0.003000, 5.08s
2024-09-02 13:06:06 INFO     epoch complete!
2024-09-02 13:06:06 INFO     evaluating now!
2024-09-02 13:06:06 INFO     Epoch [22/200] train_loss: 4.9738, val_loss: 5.5455, lr: 0.003000, 5.07s
2024-09-02 13:06:11 INFO     epoch complete!
2024-09-02 13:06:11 INFO     evaluating now!
2024-09-02 13:06:11 INFO     Epoch [23/200] train_loss: 5.0275, val_loss: 5.5381, lr: 0.003000, 5.08s
2024-09-02 13:06:16 INFO     epoch complete!
2024-09-02 13:06:16 INFO     evaluating now!
2024-09-02 13:06:16 INFO     Epoch [24/200] train_loss: 4.9496, val_loss: 5.6677, lr: 0.003000, 5.06s
2024-09-02 13:06:21 INFO     epoch complete!
2024-09-02 13:06:21 INFO     evaluating now!
2024-09-02 13:06:21 INFO     Epoch [25/200] train_loss: 4.9097, val_loss: 5.5343, lr: 0.003000, 5.09s
2024-09-02 13:06:26 INFO     epoch complete!
2024-09-02 13:06:26 INFO     evaluating now!
2024-09-02 13:06:26 INFO     Epoch [26/200] train_loss: 4.7330, val_loss: 5.1589, lr: 0.003000, 5.08s
2024-09-02 13:06:26 INFO     Saved model at 26
2024-09-02 13:06:26 INFO     Val loss decrease from 5.5097 to 5.1589, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-02 13:06:31 INFO     epoch complete!
2024-09-02 13:06:31 INFO     evaluating now!
2024-09-02 13:06:31 INFO     Epoch [27/200] train_loss: 4.6871, val_loss: 5.3666, lr: 0.003000, 5.08s
2024-09-02 13:06:36 INFO     epoch complete!
2024-09-02 13:06:36 INFO     evaluating now!
2024-09-02 13:06:37 INFO     Epoch [28/200] train_loss: 4.7348, val_loss: 5.2606, lr: 0.003000, 5.08s
2024-09-02 13:06:41 INFO     epoch complete!
2024-09-02 13:06:41 INFO     evaluating now!
2024-09-02 13:06:42 INFO     Epoch [29/200] train_loss: 4.5683, val_loss: 5.2080, lr: 0.003000, 5.08s
2024-09-02 13:06:46 INFO     epoch complete!
2024-09-02 13:06:46 INFO     evaluating now!
2024-09-02 13:06:47 INFO     Epoch [30/200] train_loss: 4.5827, val_loss: 5.1544, lr: 0.003000, 5.08s
2024-09-02 13:06:47 INFO     Saved model at 30
2024-09-02 13:06:47 INFO     Val loss decrease from 5.1589 to 5.1544, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-09-02 13:06:51 INFO     epoch complete!
2024-09-02 13:06:51 INFO     evaluating now!
2024-09-02 13:06:52 INFO     Epoch [31/200] train_loss: 4.5346, val_loss: 5.2261, lr: 0.003000, 5.07s
2024-09-02 13:06:57 INFO     epoch complete!
2024-09-02 13:06:57 INFO     evaluating now!
2024-09-02 13:06:57 INFO     Epoch [32/200] train_loss: 4.4909, val_loss: 5.2090, lr: 0.003000, 5.09s
2024-09-02 13:07:02 INFO     epoch complete!
2024-09-02 13:07:02 INFO     evaluating now!
2024-09-02 13:07:02 INFO     Epoch [33/200] train_loss: 4.3950, val_loss: 5.1384, lr: 0.003000, 5.09s
2024-09-02 13:07:02 INFO     Saved model at 33
2024-09-02 13:07:02 INFO     Val loss decrease from 5.1544 to 5.1384, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-09-02 13:07:07 INFO     epoch complete!
2024-09-02 13:07:07 INFO     evaluating now!
2024-09-02 13:07:07 INFO     Epoch [34/200] train_loss: 4.4087, val_loss: 5.2913, lr: 0.003000, 5.08s
2024-09-02 13:07:12 INFO     epoch complete!
2024-09-02 13:07:12 INFO     evaluating now!
2024-09-02 13:07:12 INFO     Epoch [35/200] train_loss: 4.3428, val_loss: 5.0115, lr: 0.003000, 5.09s
2024-09-02 13:07:12 INFO     Saved model at 35
2024-09-02 13:07:12 INFO     Val loss decrease from 5.1384 to 5.0115, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-02 13:07:17 INFO     epoch complete!
2024-09-02 13:07:17 INFO     evaluating now!
2024-09-02 13:07:17 INFO     Epoch [36/200] train_loss: 4.3381, val_loss: 5.2412, lr: 0.003000, 5.09s
2024-09-02 13:07:22 INFO     epoch complete!
2024-09-02 13:07:22 INFO     evaluating now!
2024-09-02 13:07:22 INFO     Epoch [37/200] train_loss: 4.3264, val_loss: 5.1698, lr: 0.003000, 5.08s
2024-09-02 13:07:27 INFO     epoch complete!
2024-09-02 13:07:27 INFO     evaluating now!
2024-09-02 13:07:27 INFO     Epoch [38/200] train_loss: 4.2815, val_loss: 5.2225, lr: 0.003000, 5.08s
2024-09-02 13:07:32 INFO     epoch complete!
2024-09-02 13:07:32 INFO     evaluating now!
2024-09-02 13:07:32 INFO     Epoch [39/200] train_loss: 4.2528, val_loss: 5.2012, lr: 0.003000, 5.08s
2024-09-02 13:07:37 INFO     epoch complete!
2024-09-02 13:07:37 INFO     evaluating now!
2024-09-02 13:07:38 INFO     Epoch [40/200] train_loss: 4.2139, val_loss: 5.0899, lr: 0.003000, 5.08s
2024-09-02 13:07:42 INFO     epoch complete!
2024-09-02 13:07:42 INFO     evaluating now!
2024-09-02 13:07:43 INFO     Epoch [41/200] train_loss: 4.1655, val_loss: 5.2090, lr: 0.003000, 5.08s
2024-09-02 13:07:47 INFO     epoch complete!
2024-09-02 13:07:47 INFO     evaluating now!
2024-09-02 13:07:48 INFO     Epoch [42/200] train_loss: 4.1520, val_loss: 5.1424, lr: 0.003000, 5.08s
2024-09-02 13:07:53 INFO     epoch complete!
2024-09-02 13:07:53 INFO     evaluating now!
2024-09-02 13:07:53 INFO     Epoch [43/200] train_loss: 4.1371, val_loss: 5.1209, lr: 0.003000, 5.14s
2024-09-02 13:07:58 INFO     epoch complete!
2024-09-02 13:07:58 INFO     evaluating now!
2024-09-02 13:07:58 INFO     Epoch [44/200] train_loss: 4.1018, val_loss: 5.2307, lr: 0.003000, 5.08s
2024-09-02 13:08:03 INFO     epoch complete!
2024-09-02 13:08:03 INFO     evaluating now!
2024-09-02 13:08:03 INFO     Epoch [45/200] train_loss: 4.0800, val_loss: 5.1190, lr: 0.003000, 5.07s
2024-09-02 13:08:08 INFO     epoch complete!
2024-09-02 13:08:08 INFO     evaluating now!
2024-09-02 13:08:08 INFO     Epoch [46/200] train_loss: 4.0218, val_loss: 5.3054, lr: 0.003000, 5.07s
2024-09-02 13:08:13 INFO     epoch complete!
2024-09-02 13:08:13 INFO     evaluating now!
2024-09-02 13:08:13 INFO     Epoch [47/200] train_loss: 4.0442, val_loss: 5.0552, lr: 0.003000, 5.09s
2024-09-02 13:08:18 INFO     epoch complete!
2024-09-02 13:08:18 INFO     evaluating now!
2024-09-02 13:08:18 INFO     Epoch [48/200] train_loss: 3.9405, val_loss: 5.0615, lr: 0.003000, 5.08s
2024-09-02 13:08:23 INFO     epoch complete!
2024-09-02 13:08:23 INFO     evaluating now!
2024-09-02 13:08:23 INFO     Epoch [49/200] train_loss: 3.9332, val_loss: 5.0746, lr: 0.003000, 5.07s
2024-09-02 13:08:28 INFO     epoch complete!
2024-09-02 13:08:28 INFO     evaluating now!
2024-09-02 13:08:28 INFO     Epoch [50/200] train_loss: 3.9242, val_loss: 5.0595, lr: 0.003000, 5.08s
2024-09-02 13:08:28 WARNING  Early stopping at epoch: 50
2024-09-02 13:08:28 INFO     Trained totally 51 epochs, average train time is 4.803s, average eval time is 0.309s
2024-09-02 13:08:28 INFO     Loaded model at 35
2024-09-02 13:08:28 INFO     Saved model at ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 13:08:28 INFO     Start evaluating ...
2024-09-02 13:08:29 INFO     Note that you select the single mode to evaluate!
2024-09-02 13:08:29 INFO     Evaluate result is saved at ./libcity/cache/10/evaluate_cache\2024_09_02_13_08_29_AGCRN_CHITaxi20190406.csv
2024-09-02 13:08:29 INFO     
         MAE       RMSE
1   2.462174   8.016998
2   2.512565   8.303704
3   2.663399   8.922355
4   2.739885   9.526157
5   2.875165  10.205499
6   3.011003  10.814663
7   3.126883  11.444691
8   3.184053  11.803532
9   3.199042  12.075740
10  3.219054  12.340258
11  3.256193  12.785152
12  3.468104  13.669416
2024-09-02 13:08:30 INFO     ----------------------------------------------------------------------------
2024-09-02 13:08:30 INFO     # 1, Kownledge Graph Embedding: MuRE, Experiment ids: 11
2024-09-02 13:08:30 INFO     ----------------------------------------------------------------------------
2024-09-02 13:08:30 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=10
2024-09-02 13:08:30 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10, 'embedding_model': 'MuRE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 13:08:30 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 13:08:30 INFO     set_weight_link_or_dist: dist
2024-09-02 13:08:30 INFO     init_weight_inf_or_zero: inf
2024-09-02 13:08:30 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 13:08:30 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 13:08:30 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 13:08:30 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 13:08:31 INFO     Dataset created
2024-09-02 13:08:31 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 13:08:31 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 13:08:31 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 13:08:31 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 13:08:31 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 13:08:32 INFO     NormalScaler max: 0.9267852697961692
2024-09-02 13:08:33 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 13:08:33 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 13:08:33 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 13:08:33 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 13:08:33 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 13:08:33 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 13:08:33 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 13:08:33 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 13:08:33 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 13:08:33 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 13:08:33 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 13:08:33 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 13:08:33 INFO     Total parameter numbers: 874010
2024-09-02 13:08:33 INFO     You select `adam` optimizer.
2024-09-02 13:08:33 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 13:08:33 INFO     Start training ...
2024-09-02 13:08:33 INFO     num_batches:48
2024-09-02 13:08:38 INFO     epoch complete!
2024-09-02 13:08:38 INFO     evaluating now!
2024-09-02 13:08:39 INFO     Epoch [0/200] train_loss: 24.0986, val_loss: 18.2644, lr: 0.003000, 5.28s
2024-09-02 13:08:39 INFO     Saved model at 0
2024-09-02 13:08:39 INFO     Val loss decrease from inf to 18.2644, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 13:08:43 INFO     epoch complete!
2024-09-02 13:08:43 INFO     evaluating now!
2024-09-02 13:08:44 INFO     Epoch [1/200] train_loss: 15.0337, val_loss: 14.5768, lr: 0.003000, 5.05s
2024-09-02 13:08:44 INFO     Saved model at 1
2024-09-02 13:08:44 INFO     Val loss decrease from 18.2644 to 14.5768, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 13:08:49 INFO     epoch complete!
2024-09-02 13:08:49 INFO     evaluating now!
2024-09-02 13:08:49 INFO     Epoch [2/200] train_loss: 12.0855, val_loss: 11.7654, lr: 0.003000, 5.07s
2024-09-02 13:08:49 INFO     Saved model at 2
2024-09-02 13:08:49 INFO     Val loss decrease from 14.5768 to 11.7654, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 13:08:54 INFO     epoch complete!
2024-09-02 13:08:54 INFO     evaluating now!
2024-09-02 13:08:54 INFO     Epoch [3/200] train_loss: 9.9942, val_loss: 9.6044, lr: 0.003000, 5.09s
2024-09-02 13:08:54 INFO     Saved model at 3
2024-09-02 13:08:54 INFO     Val loss decrease from 11.7654 to 9.6044, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 13:08:59 INFO     epoch complete!
2024-09-02 13:08:59 INFO     evaluating now!
2024-09-02 13:08:59 INFO     Epoch [4/200] train_loss: 8.7755, val_loss: 8.2560, lr: 0.003000, 5.09s
2024-09-02 13:08:59 INFO     Saved model at 4
2024-09-02 13:08:59 INFO     Val loss decrease from 9.6044 to 8.2560, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 13:09:04 INFO     epoch complete!
2024-09-02 13:09:04 INFO     evaluating now!
2024-09-02 13:09:04 INFO     Epoch [5/200] train_loss: 7.7762, val_loss: 7.7489, lr: 0.003000, 5.10s
2024-09-02 13:09:04 INFO     Saved model at 5
2024-09-02 13:09:04 INFO     Val loss decrease from 8.2560 to 7.7489, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 13:09:09 INFO     epoch complete!
2024-09-02 13:09:09 INFO     evaluating now!
2024-09-02 13:09:09 INFO     Epoch [6/200] train_loss: 7.3175, val_loss: 7.0537, lr: 0.003000, 5.10s
2024-09-02 13:09:09 INFO     Saved model at 6
2024-09-02 13:09:09 INFO     Val loss decrease from 7.7489 to 7.0537, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 13:09:14 INFO     epoch complete!
2024-09-02 13:09:14 INFO     evaluating now!
2024-09-02 13:09:14 INFO     Epoch [7/200] train_loss: 6.7461, val_loss: 7.0734, lr: 0.003000, 5.07s
2024-09-02 13:09:19 INFO     epoch complete!
2024-09-02 13:09:19 INFO     evaluating now!
2024-09-02 13:09:19 INFO     Epoch [8/200] train_loss: 6.4956, val_loss: 6.4406, lr: 0.003000, 5.05s
2024-09-02 13:09:19 INFO     Saved model at 8
2024-09-02 13:09:19 INFO     Val loss decrease from 7.0537 to 6.4406, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 13:09:24 INFO     epoch complete!
2024-09-02 13:09:24 INFO     evaluating now!
2024-09-02 13:09:24 INFO     Epoch [9/200] train_loss: 6.1253, val_loss: 6.2550, lr: 0.003000, 5.04s
2024-09-02 13:09:24 INFO     Saved model at 9
2024-09-02 13:09:24 INFO     Val loss decrease from 6.4406 to 6.2550, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 13:09:29 INFO     epoch complete!
2024-09-02 13:09:29 INFO     evaluating now!
2024-09-02 13:09:30 INFO     Epoch [10/200] train_loss: 5.9567, val_loss: 6.2427, lr: 0.003000, 5.05s
2024-09-02 13:09:30 INFO     Saved model at 10
2024-09-02 13:09:30 INFO     Val loss decrease from 6.2550 to 6.2427, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 13:09:34 INFO     epoch complete!
2024-09-02 13:09:34 INFO     evaluating now!
2024-09-02 13:09:35 INFO     Epoch [11/200] train_loss: 5.7516, val_loss: 6.1134, lr: 0.003000, 5.04s
2024-09-02 13:09:35 INFO     Saved model at 11
2024-09-02 13:09:35 INFO     Val loss decrease from 6.2427 to 6.1134, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 13:09:39 INFO     epoch complete!
2024-09-02 13:09:39 INFO     evaluating now!
2024-09-02 13:09:40 INFO     Epoch [12/200] train_loss: 5.6404, val_loss: 5.9121, lr: 0.003000, 5.05s
2024-09-02 13:09:40 INFO     Saved model at 12
2024-09-02 13:09:40 INFO     Val loss decrease from 6.1134 to 5.9121, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 13:09:44 INFO     epoch complete!
2024-09-02 13:09:44 INFO     evaluating now!
2024-09-02 13:09:45 INFO     Epoch [13/200] train_loss: 5.4792, val_loss: 5.6720, lr: 0.003000, 5.04s
2024-09-02 13:09:45 INFO     Saved model at 13
2024-09-02 13:09:45 INFO     Val loss decrease from 5.9121 to 5.6720, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 13:09:49 INFO     epoch complete!
2024-09-02 13:09:49 INFO     evaluating now!
2024-09-02 13:09:50 INFO     Epoch [14/200] train_loss: 5.4681, val_loss: 5.6366, lr: 0.003000, 5.05s
2024-09-02 13:09:50 INFO     Saved model at 14
2024-09-02 13:09:50 INFO     Val loss decrease from 5.6720 to 5.6366, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-02 13:09:55 INFO     epoch complete!
2024-09-02 13:09:55 INFO     evaluating now!
2024-09-02 13:09:55 INFO     Epoch [15/200] train_loss: 5.3761, val_loss: 5.7217, lr: 0.003000, 5.05s
2024-09-02 13:10:00 INFO     epoch complete!
2024-09-02 13:10:00 INFO     evaluating now!
2024-09-02 13:10:00 INFO     Epoch [16/200] train_loss: 5.2246, val_loss: 5.6640, lr: 0.003000, 5.05s
2024-09-02 13:10:05 INFO     epoch complete!
2024-09-02 13:10:05 INFO     evaluating now!
2024-09-02 13:10:05 INFO     Epoch [17/200] train_loss: 5.1143, val_loss: 5.5533, lr: 0.003000, 5.06s
2024-09-02 13:10:05 INFO     Saved model at 17
2024-09-02 13:10:05 INFO     Val loss decrease from 5.6366 to 5.5533, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-02 13:10:10 INFO     epoch complete!
2024-09-02 13:10:10 INFO     evaluating now!
2024-09-02 13:10:10 INFO     Epoch [18/200] train_loss: 5.0335, val_loss: 5.4440, lr: 0.003000, 5.05s
2024-09-02 13:10:10 INFO     Saved model at 18
2024-09-02 13:10:10 INFO     Val loss decrease from 5.5533 to 5.4440, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-02 13:10:15 INFO     epoch complete!
2024-09-02 13:10:15 INFO     evaluating now!
2024-09-02 13:10:15 INFO     Epoch [19/200] train_loss: 5.0689, val_loss: 5.5615, lr: 0.003000, 5.04s
2024-09-02 13:10:20 INFO     epoch complete!
2024-09-02 13:10:20 INFO     evaluating now!
2024-09-02 13:10:20 INFO     Epoch [20/200] train_loss: 4.9863, val_loss: 5.3463, lr: 0.003000, 5.05s
2024-09-02 13:10:20 INFO     Saved model at 20
2024-09-02 13:10:20 INFO     Val loss decrease from 5.4440 to 5.3463, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-02 13:10:25 INFO     epoch complete!
2024-09-02 13:10:25 INFO     evaluating now!
2024-09-02 13:10:25 INFO     Epoch [21/200] train_loss: 4.8320, val_loss: 5.4121, lr: 0.003000, 5.06s
2024-09-02 13:10:30 INFO     epoch complete!
2024-09-02 13:10:30 INFO     evaluating now!
2024-09-02 13:10:30 INFO     Epoch [22/200] train_loss: 4.7841, val_loss: 5.3133, lr: 0.003000, 5.06s
2024-09-02 13:10:30 INFO     Saved model at 22
2024-09-02 13:10:30 INFO     Val loss decrease from 5.3463 to 5.3133, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-02 13:10:35 INFO     epoch complete!
2024-09-02 13:10:35 INFO     evaluating now!
2024-09-02 13:10:35 INFO     Epoch [23/200] train_loss: 4.7011, val_loss: 5.3299, lr: 0.003000, 5.06s
2024-09-02 13:10:40 INFO     epoch complete!
2024-09-02 13:10:40 INFO     evaluating now!
2024-09-02 13:10:40 INFO     Epoch [24/200] train_loss: 4.6786, val_loss: 5.3183, lr: 0.003000, 5.06s
2024-09-02 13:10:45 INFO     epoch complete!
2024-09-02 13:10:45 INFO     evaluating now!
2024-09-02 13:10:45 INFO     Epoch [25/200] train_loss: 4.6700, val_loss: 5.2868, lr: 0.003000, 5.07s
2024-09-02 13:10:45 INFO     Saved model at 25
2024-09-02 13:10:45 INFO     Val loss decrease from 5.3133 to 5.2868, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-02 13:10:50 INFO     epoch complete!
2024-09-02 13:10:50 INFO     evaluating now!
2024-09-02 13:10:51 INFO     Epoch [26/200] train_loss: 4.6509, val_loss: 5.0696, lr: 0.003000, 5.06s
2024-09-02 13:10:51 INFO     Saved model at 26
2024-09-02 13:10:51 INFO     Val loss decrease from 5.2868 to 5.0696, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-02 13:10:55 INFO     epoch complete!
2024-09-02 13:10:55 INFO     evaluating now!
2024-09-02 13:10:56 INFO     Epoch [27/200] train_loss: 4.5199, val_loss: 5.1516, lr: 0.003000, 5.06s
2024-09-02 13:11:00 INFO     epoch complete!
2024-09-02 13:11:00 INFO     evaluating now!
2024-09-02 13:11:01 INFO     Epoch [28/200] train_loss: 4.4669, val_loss: 5.3664, lr: 0.003000, 5.07s
2024-09-02 13:11:05 INFO     epoch complete!
2024-09-02 13:11:05 INFO     evaluating now!
2024-09-02 13:11:06 INFO     Epoch [29/200] train_loss: 4.5282, val_loss: 5.2996, lr: 0.003000, 5.06s
2024-09-02 13:11:10 INFO     epoch complete!
2024-09-02 13:11:10 INFO     evaluating now!
2024-09-02 13:11:11 INFO     Epoch [30/200] train_loss: 4.5963, val_loss: 5.2325, lr: 0.003000, 5.06s
2024-09-02 13:11:16 INFO     epoch complete!
2024-09-02 13:11:16 INFO     evaluating now!
2024-09-02 13:11:16 INFO     Epoch [31/200] train_loss: 4.3487, val_loss: 5.1016, lr: 0.003000, 5.06s
2024-09-02 13:11:21 INFO     epoch complete!
2024-09-02 13:11:21 INFO     evaluating now!
2024-09-02 13:11:21 INFO     Epoch [32/200] train_loss: 4.3370, val_loss: 5.0379, lr: 0.003000, 5.05s
2024-09-02 13:11:21 INFO     Saved model at 32
2024-09-02 13:11:21 INFO     Val loss decrease from 5.0696 to 5.0379, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-09-02 13:11:26 INFO     epoch complete!
2024-09-02 13:11:26 INFO     evaluating now!
2024-09-02 13:11:26 INFO     Epoch [33/200] train_loss: 4.3789, val_loss: 5.2231, lr: 0.003000, 5.06s
2024-09-02 13:11:31 INFO     epoch complete!
2024-09-02 13:11:31 INFO     evaluating now!
2024-09-02 13:11:31 INFO     Epoch [34/200] train_loss: 4.2777, val_loss: 5.2382, lr: 0.003000, 5.06s
2024-09-02 13:11:36 INFO     epoch complete!
2024-09-02 13:11:36 INFO     evaluating now!
2024-09-02 13:11:36 INFO     Epoch [35/200] train_loss: 4.2325, val_loss: 5.1709, lr: 0.003000, 5.05s
2024-09-02 13:11:41 INFO     epoch complete!
2024-09-02 13:11:41 INFO     evaluating now!
2024-09-02 13:11:41 INFO     Epoch [36/200] train_loss: 4.1940, val_loss: 5.0578, lr: 0.003000, 5.06s
2024-09-02 13:11:46 INFO     epoch complete!
2024-09-02 13:11:46 INFO     evaluating now!
2024-09-02 13:11:46 INFO     Epoch [37/200] train_loss: 4.2059, val_loss: 5.2426, lr: 0.003000, 5.05s
2024-09-02 13:11:51 INFO     epoch complete!
2024-09-02 13:11:51 INFO     evaluating now!
2024-09-02 13:11:51 INFO     Epoch [38/200] train_loss: 4.1618, val_loss: 5.1389, lr: 0.003000, 5.06s
2024-09-02 13:11:56 INFO     epoch complete!
2024-09-02 13:11:56 INFO     evaluating now!
2024-09-02 13:11:56 INFO     Epoch [39/200] train_loss: 4.1073, val_loss: 5.0770, lr: 0.003000, 5.05s
2024-09-02 13:12:01 INFO     epoch complete!
2024-09-02 13:12:01 INFO     evaluating now!
2024-09-02 13:12:01 INFO     Epoch [40/200] train_loss: 4.0861, val_loss: 5.1775, lr: 0.003000, 5.07s
2024-09-02 13:12:06 INFO     epoch complete!
2024-09-02 13:12:06 INFO     evaluating now!
2024-09-02 13:12:06 INFO     Epoch [41/200] train_loss: 4.0839, val_loss: 5.0739, lr: 0.003000, 5.06s
2024-09-02 13:12:11 INFO     epoch complete!
2024-09-02 13:12:11 INFO     evaluating now!
2024-09-02 13:12:11 INFO     Epoch [42/200] train_loss: 4.0298, val_loss: 5.0543, lr: 0.003000, 5.06s
2024-09-02 13:12:16 INFO     epoch complete!
2024-09-02 13:12:16 INFO     evaluating now!
2024-09-02 13:12:17 INFO     Epoch [43/200] train_loss: 4.0060, val_loss: 5.1516, lr: 0.003000, 5.06s
2024-09-02 13:12:21 INFO     epoch complete!
2024-09-02 13:12:21 INFO     evaluating now!
2024-09-02 13:12:22 INFO     Epoch [44/200] train_loss: 3.9538, val_loss: 4.9655, lr: 0.003000, 5.05s
2024-09-02 13:12:22 INFO     Saved model at 44
2024-09-02 13:12:22 INFO     Val loss decrease from 5.0379 to 4.9655, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-09-02 13:12:26 INFO     epoch complete!
2024-09-02 13:12:26 INFO     evaluating now!
2024-09-02 13:12:27 INFO     Epoch [45/200] train_loss: 3.9402, val_loss: 4.9121, lr: 0.003000, 5.07s
2024-09-02 13:12:27 INFO     Saved model at 45
2024-09-02 13:12:27 INFO     Val loss decrease from 4.9655 to 4.9121, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-09-02 13:12:31 INFO     epoch complete!
2024-09-02 13:12:31 INFO     evaluating now!
2024-09-02 13:12:32 INFO     Epoch [46/200] train_loss: 3.9218, val_loss: 4.9657, lr: 0.003000, 5.06s
2024-09-02 13:12:37 INFO     epoch complete!
2024-09-02 13:12:37 INFO     evaluating now!
2024-09-02 13:12:37 INFO     Epoch [47/200] train_loss: 3.9715, val_loss: 5.2907, lr: 0.003000, 5.05s
2024-09-02 13:12:42 INFO     epoch complete!
2024-09-02 13:12:42 INFO     evaluating now!
2024-09-02 13:12:42 INFO     Epoch [48/200] train_loss: 4.2930, val_loss: 5.1147, lr: 0.003000, 5.07s
2024-09-02 13:12:47 INFO     epoch complete!
2024-09-02 13:12:47 INFO     evaluating now!
2024-09-02 13:12:47 INFO     Epoch [49/200] train_loss: 3.9489, val_loss: 4.9863, lr: 0.003000, 5.05s
2024-09-02 13:12:52 INFO     epoch complete!
2024-09-02 13:12:52 INFO     evaluating now!
2024-09-02 13:12:52 INFO     Epoch [50/200] train_loss: 3.8832, val_loss: 4.9859, lr: 0.003000, 5.06s
2024-09-02 13:12:57 INFO     epoch complete!
2024-09-02 13:12:57 INFO     evaluating now!
2024-09-02 13:12:57 INFO     Epoch [51/200] train_loss: 3.9271, val_loss: 5.0474, lr: 0.003000, 5.05s
2024-09-02 13:13:02 INFO     epoch complete!
2024-09-02 13:13:02 INFO     evaluating now!
2024-09-02 13:13:02 INFO     Epoch [52/200] train_loss: 3.8477, val_loss: 4.9956, lr: 0.003000, 5.04s
2024-09-02 13:13:07 INFO     epoch complete!
2024-09-02 13:13:07 INFO     evaluating now!
2024-09-02 13:13:07 INFO     Epoch [53/200] train_loss: 3.7679, val_loss: 4.8393, lr: 0.003000, 5.03s
2024-09-02 13:13:07 INFO     Saved model at 53
2024-09-02 13:13:07 INFO     Val loss decrease from 4.9121 to 4.8393, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch53.tar
2024-09-02 13:13:12 INFO     epoch complete!
2024-09-02 13:13:12 INFO     evaluating now!
2024-09-02 13:13:12 INFO     Epoch [54/200] train_loss: 3.7143, val_loss: 4.8299, lr: 0.003000, 5.04s
2024-09-02 13:13:12 INFO     Saved model at 54
2024-09-02 13:13:12 INFO     Val loss decrease from 4.8393 to 4.8299, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch54.tar
2024-09-02 13:13:17 INFO     epoch complete!
2024-09-02 13:13:17 INFO     evaluating now!
2024-09-02 13:13:17 INFO     Epoch [55/200] train_loss: 3.7327, val_loss: 4.8219, lr: 0.003000, 5.02s
2024-09-02 13:13:17 INFO     Saved model at 55
2024-09-02 13:13:17 INFO     Val loss decrease from 4.8299 to 4.8219, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch55.tar
2024-09-02 13:13:22 INFO     epoch complete!
2024-09-02 13:13:22 INFO     evaluating now!
2024-09-02 13:13:22 INFO     Epoch [56/200] train_loss: 3.7248, val_loss: 4.9757, lr: 0.003000, 5.03s
2024-09-02 13:13:27 INFO     epoch complete!
2024-09-02 13:13:27 INFO     evaluating now!
2024-09-02 13:13:27 INFO     Epoch [57/200] train_loss: 3.7260, val_loss: 4.8809, lr: 0.003000, 5.02s
2024-09-02 13:13:32 INFO     epoch complete!
2024-09-02 13:13:32 INFO     evaluating now!
2024-09-02 13:13:32 INFO     Epoch [58/200] train_loss: 3.6773, val_loss: 4.9613, lr: 0.003000, 5.03s
2024-09-02 13:13:37 INFO     epoch complete!
2024-09-02 13:13:37 INFO     evaluating now!
2024-09-02 13:13:37 INFO     Epoch [59/200] train_loss: 3.6374, val_loss: 4.9269, lr: 0.003000, 5.02s
2024-09-02 13:13:42 INFO     epoch complete!
2024-09-02 13:13:42 INFO     evaluating now!
2024-09-02 13:13:42 INFO     Epoch [60/200] train_loss: 3.6819, val_loss: 4.9542, lr: 0.003000, 5.05s
2024-09-02 13:13:47 INFO     epoch complete!
2024-09-02 13:13:47 INFO     evaluating now!
2024-09-02 13:13:47 INFO     Epoch [61/200] train_loss: 3.6508, val_loss: 5.0611, lr: 0.003000, 5.02s
2024-09-02 13:13:52 INFO     epoch complete!
2024-09-02 13:13:52 INFO     evaluating now!
2024-09-02 13:13:52 INFO     Epoch [62/200] train_loss: 3.6399, val_loss: 4.9389, lr: 0.003000, 5.02s
2024-09-02 13:13:57 INFO     epoch complete!
2024-09-02 13:13:57 INFO     evaluating now!
2024-09-02 13:13:57 INFO     Epoch [63/200] train_loss: 3.6507, val_loss: 4.9671, lr: 0.003000, 5.03s
2024-09-02 13:14:02 INFO     epoch complete!
2024-09-02 13:14:02 INFO     evaluating now!
2024-09-02 13:14:02 INFO     Epoch [64/200] train_loss: 3.6112, val_loss: 4.8364, lr: 0.003000, 5.04s
2024-09-02 13:14:07 INFO     epoch complete!
2024-09-02 13:14:07 INFO     evaluating now!
2024-09-02 13:14:08 INFO     Epoch [65/200] train_loss: 3.5697, val_loss: 4.8852, lr: 0.003000, 5.03s
2024-09-02 13:14:12 INFO     epoch complete!
2024-09-02 13:14:12 INFO     evaluating now!
2024-09-02 13:14:13 INFO     Epoch [66/200] train_loss: 3.5752, val_loss: 4.9250, lr: 0.003000, 5.03s
2024-09-02 13:14:17 INFO     epoch complete!
2024-09-02 13:14:17 INFO     evaluating now!
2024-09-02 13:14:18 INFO     Epoch [67/200] train_loss: 3.5507, val_loss: 4.8360, lr: 0.003000, 5.04s
2024-09-02 13:14:22 INFO     epoch complete!
2024-09-02 13:14:22 INFO     evaluating now!
2024-09-02 13:14:23 INFO     Epoch [68/200] train_loss: 3.5372, val_loss: 5.0083, lr: 0.003000, 5.03s
2024-09-02 13:14:27 INFO     epoch complete!
2024-09-02 13:14:27 INFO     evaluating now!
2024-09-02 13:14:28 INFO     Epoch [69/200] train_loss: 3.5024, val_loss: 4.9760, lr: 0.003000, 5.05s
2024-09-02 13:14:32 INFO     epoch complete!
2024-09-02 13:14:32 INFO     evaluating now!
2024-09-02 13:14:33 INFO     Epoch [70/200] train_loss: 3.4864, val_loss: 5.0865, lr: 0.003000, 5.03s
2024-09-02 13:14:33 WARNING  Early stopping at epoch: 70
2024-09-02 13:14:33 INFO     Trained totally 71 epochs, average train time is 4.753s, average eval time is 0.302s
2024-09-02 13:14:33 INFO     Loaded model at 55
2024-09-02 13:14:33 INFO     Saved model at ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 13:14:33 INFO     Start evaluating ...
2024-09-02 13:14:34 INFO     Note that you select the single mode to evaluate!
2024-09-02 13:14:34 INFO     Evaluate result is saved at ./libcity/cache/10/evaluate_cache\2024_09_02_13_14_34_AGCRN_CHITaxi20190406.csv
2024-09-02 13:14:34 INFO     
         MAE       RMSE
1   2.494736   7.806631
2   2.584204   8.122314
3   2.756802   8.784101
4   2.899850   9.414235
5   3.074341  10.452803
6   3.220203  11.612063
7   3.238583  12.552402
8   3.301976  13.193188
9   3.284407  13.442776
10  3.367955  13.719955
11  3.349164  13.979207
12  3.474801  14.572234
2024-09-02 13:14:34 INFO     ----------------------------------------------------------------------------
2024-09-02 13:14:34 INFO     # 2, Kownledge Graph Embedding: MuRE, Experiment ids: 12
2024-09-02 13:14:34 INFO     ----------------------------------------------------------------------------
2024-09-02 13:14:34 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=10
2024-09-02 13:14:34 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10, 'embedding_model': 'MuRE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 13:14:34 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 13:14:34 INFO     set_weight_link_or_dist: dist
2024-09-02 13:14:34 INFO     init_weight_inf_or_zero: inf
2024-09-02 13:14:34 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 13:14:34 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 13:14:34 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 13:14:34 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 13:14:35 INFO     Dataset created
2024-09-02 13:14:35 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 13:14:36 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 13:14:36 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 13:14:36 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 13:14:36 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 13:14:36 INFO     NormalScaler max: 0.9267852697961692
2024-09-02 13:14:38 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 13:14:38 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 13:14:38 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 13:14:38 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 13:14:38 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 13:14:38 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 13:14:38 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 13:14:38 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 13:14:38 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 13:14:38 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 13:14:38 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 13:14:38 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 13:14:38 INFO     Total parameter numbers: 874010
2024-09-02 13:14:38 INFO     You select `adam` optimizer.
2024-09-02 13:14:38 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 13:14:38 INFO     Start training ...
2024-09-02 13:14:38 INFO     num_batches:48
2024-09-02 13:14:43 INFO     epoch complete!
2024-09-02 13:14:43 INFO     evaluating now!
2024-09-02 13:14:43 INFO     Epoch [0/200] train_loss: 24.7344, val_loss: 18.5522, lr: 0.003000, 5.33s
2024-09-02 13:14:43 INFO     Saved model at 0
2024-09-02 13:14:43 INFO     Val loss decrease from inf to 18.5522, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 13:14:48 INFO     epoch complete!
2024-09-02 13:14:48 INFO     evaluating now!
2024-09-02 13:14:48 INFO     Epoch [1/200] train_loss: 15.3882, val_loss: 14.9589, lr: 0.003000, 5.02s
2024-09-02 13:14:48 INFO     Saved model at 1
2024-09-02 13:14:48 INFO     Val loss decrease from 18.5522 to 14.9589, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 13:14:53 INFO     epoch complete!
2024-09-02 13:14:53 INFO     evaluating now!
2024-09-02 13:14:53 INFO     Epoch [2/200] train_loss: 12.9700, val_loss: 13.0167, lr: 0.003000, 5.02s
2024-09-02 13:14:53 INFO     Saved model at 2
2024-09-02 13:14:53 INFO     Val loss decrease from 14.9589 to 13.0167, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 13:14:58 INFO     epoch complete!
2024-09-02 13:14:58 INFO     evaluating now!
2024-09-02 13:14:58 INFO     Epoch [3/200] train_loss: 10.7111, val_loss: 10.4680, lr: 0.003000, 5.02s
2024-09-02 13:14:58 INFO     Saved model at 3
2024-09-02 13:14:58 INFO     Val loss decrease from 13.0167 to 10.4680, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 13:15:03 INFO     epoch complete!
2024-09-02 13:15:03 INFO     evaluating now!
2024-09-02 13:15:03 INFO     Epoch [4/200] train_loss: 9.3050, val_loss: 8.9599, lr: 0.003000, 5.02s
2024-09-02 13:15:03 INFO     Saved model at 4
2024-09-02 13:15:03 INFO     Val loss decrease from 10.4680 to 8.9599, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 13:15:08 INFO     epoch complete!
2024-09-02 13:15:08 INFO     evaluating now!
2024-09-02 13:15:08 INFO     Epoch [5/200] train_loss: 8.2094, val_loss: 7.9101, lr: 0.003000, 5.01s
2024-09-02 13:15:08 INFO     Saved model at 5
2024-09-02 13:15:08 INFO     Val loss decrease from 8.9599 to 7.9101, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 13:15:13 INFO     epoch complete!
2024-09-02 13:15:13 INFO     evaluating now!
2024-09-02 13:15:13 INFO     Epoch [6/200] train_loss: 7.4453, val_loss: 7.3599, lr: 0.003000, 5.00s
2024-09-02 13:15:13 INFO     Saved model at 6
2024-09-02 13:15:13 INFO     Val loss decrease from 7.9101 to 7.3599, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 13:15:18 INFO     epoch complete!
2024-09-02 13:15:18 INFO     evaluating now!
2024-09-02 13:15:18 INFO     Epoch [7/200] train_loss: 6.8970, val_loss: 6.7681, lr: 0.003000, 5.03s
2024-09-02 13:15:18 INFO     Saved model at 7
2024-09-02 13:15:18 INFO     Val loss decrease from 7.3599 to 6.7681, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 13:15:23 INFO     epoch complete!
2024-09-02 13:15:23 INFO     evaluating now!
2024-09-02 13:15:23 INFO     Epoch [8/200] train_loss: 6.6024, val_loss: 6.8997, lr: 0.003000, 5.02s
2024-09-02 13:15:28 INFO     epoch complete!
2024-09-02 13:15:28 INFO     evaluating now!
2024-09-02 13:15:28 INFO     Epoch [9/200] train_loss: 6.2028, val_loss: 6.1530, lr: 0.003000, 5.02s
2024-09-02 13:15:28 INFO     Saved model at 9
2024-09-02 13:15:28 INFO     Val loss decrease from 6.7681 to 6.1530, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 13:15:33 INFO     epoch complete!
2024-09-02 13:15:33 INFO     evaluating now!
2024-09-02 13:15:33 INFO     Epoch [10/200] train_loss: 6.1207, val_loss: 6.2803, lr: 0.003000, 5.02s
2024-09-02 13:15:38 INFO     epoch complete!
2024-09-02 13:15:38 INFO     evaluating now!
2024-09-02 13:15:38 INFO     Epoch [11/200] train_loss: 5.8548, val_loss: 6.1891, lr: 0.003000, 5.04s
2024-09-02 13:15:43 INFO     epoch complete!
2024-09-02 13:15:43 INFO     evaluating now!
2024-09-02 13:15:43 INFO     Epoch [12/200] train_loss: 5.8190, val_loss: 5.9015, lr: 0.003000, 5.03s
2024-09-02 13:15:43 INFO     Saved model at 12
2024-09-02 13:15:43 INFO     Val loss decrease from 6.1530 to 5.9015, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 13:15:48 INFO     epoch complete!
2024-09-02 13:15:48 INFO     evaluating now!
2024-09-02 13:15:48 INFO     Epoch [13/200] train_loss: 5.5314, val_loss: 6.0126, lr: 0.003000, 5.03s
2024-09-02 13:15:53 INFO     epoch complete!
2024-09-02 13:15:53 INFO     evaluating now!
2024-09-02 13:15:53 INFO     Epoch [14/200] train_loss: 5.5123, val_loss: 5.9720, lr: 0.003000, 5.04s
2024-09-02 13:15:58 INFO     epoch complete!
2024-09-02 13:15:58 INFO     evaluating now!
2024-09-02 13:15:58 INFO     Epoch [15/200] train_loss: 5.3860, val_loss: 5.7201, lr: 0.003000, 5.03s
2024-09-02 13:15:58 INFO     Saved model at 15
2024-09-02 13:15:58 INFO     Val loss decrease from 5.9015 to 5.7201, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 13:16:03 INFO     epoch complete!
2024-09-02 13:16:03 INFO     evaluating now!
2024-09-02 13:16:03 INFO     Epoch [16/200] train_loss: 5.2514, val_loss: 5.5503, lr: 0.003000, 5.04s
2024-09-02 13:16:03 INFO     Saved model at 16
2024-09-02 13:16:03 INFO     Val loss decrease from 5.7201 to 5.5503, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 13:16:08 INFO     epoch complete!
2024-09-02 13:16:08 INFO     evaluating now!
2024-09-02 13:16:08 INFO     Epoch [17/200] train_loss: 5.1589, val_loss: 5.7826, lr: 0.003000, 5.02s
2024-09-02 13:16:13 INFO     epoch complete!
2024-09-02 13:16:13 INFO     evaluating now!
2024-09-02 13:16:14 INFO     Epoch [18/200] train_loss: 5.1239, val_loss: 5.5309, lr: 0.003000, 5.03s
2024-09-02 13:16:14 INFO     Saved model at 18
2024-09-02 13:16:14 INFO     Val loss decrease from 5.5503 to 5.5309, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-02 13:16:18 INFO     epoch complete!
2024-09-02 13:16:18 INFO     evaluating now!
2024-09-02 13:16:19 INFO     Epoch [19/200] train_loss: 5.0171, val_loss: 5.5591, lr: 0.003000, 5.04s
2024-09-02 13:16:23 INFO     epoch complete!
2024-09-02 13:16:23 INFO     evaluating now!
2024-09-02 13:16:24 INFO     Epoch [20/200] train_loss: 4.9481, val_loss: 5.4146, lr: 0.003000, 5.02s
2024-09-02 13:16:24 INFO     Saved model at 20
2024-09-02 13:16:24 INFO     Val loss decrease from 5.5309 to 5.4146, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-02 13:16:28 INFO     epoch complete!
2024-09-02 13:16:28 INFO     evaluating now!
2024-09-02 13:16:29 INFO     Epoch [21/200] train_loss: 4.9761, val_loss: 5.4598, lr: 0.003000, 5.02s
2024-09-02 13:16:33 INFO     epoch complete!
2024-09-02 13:16:33 INFO     evaluating now!
2024-09-02 13:16:34 INFO     Epoch [22/200] train_loss: 4.8853, val_loss: 5.3868, lr: 0.003000, 5.03s
2024-09-02 13:16:34 INFO     Saved model at 22
2024-09-02 13:16:34 INFO     Val loss decrease from 5.4146 to 5.3868, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-02 13:16:38 INFO     epoch complete!
2024-09-02 13:16:38 INFO     evaluating now!
2024-09-02 13:16:39 INFO     Epoch [23/200] train_loss: 4.7422, val_loss: 5.2821, lr: 0.003000, 5.03s
2024-09-02 13:16:39 INFO     Saved model at 23
2024-09-02 13:16:39 INFO     Val loss decrease from 5.3868 to 5.2821, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-02 13:16:43 INFO     epoch complete!
2024-09-02 13:16:43 INFO     evaluating now!
2024-09-02 13:16:44 INFO     Epoch [24/200] train_loss: 4.6916, val_loss: 5.1719, lr: 0.003000, 5.03s
2024-09-02 13:16:44 INFO     Saved model at 24
2024-09-02 13:16:44 INFO     Val loss decrease from 5.2821 to 5.1719, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-02 13:16:48 INFO     epoch complete!
2024-09-02 13:16:48 INFO     evaluating now!
2024-09-02 13:16:49 INFO     Epoch [25/200] train_loss: 4.5945, val_loss: 5.1904, lr: 0.003000, 5.03s
2024-09-02 13:16:54 INFO     epoch complete!
2024-09-02 13:16:54 INFO     evaluating now!
2024-09-02 13:16:54 INFO     Epoch [26/200] train_loss: 4.5949, val_loss: 5.2500, lr: 0.003000, 5.04s
2024-09-02 13:16:59 INFO     epoch complete!
2024-09-02 13:16:59 INFO     evaluating now!
2024-09-02 13:16:59 INFO     Epoch [27/200] train_loss: 4.5534, val_loss: 5.1543, lr: 0.003000, 5.03s
2024-09-02 13:16:59 INFO     Saved model at 27
2024-09-02 13:16:59 INFO     Val loss decrease from 5.1719 to 5.1543, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-02 13:17:04 INFO     epoch complete!
2024-09-02 13:17:04 INFO     evaluating now!
2024-09-02 13:17:04 INFO     Epoch [28/200] train_loss: 4.4894, val_loss: 5.0630, lr: 0.003000, 5.03s
2024-09-02 13:17:04 INFO     Saved model at 28
2024-09-02 13:17:04 INFO     Val loss decrease from 5.1543 to 5.0630, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-02 13:17:09 INFO     epoch complete!
2024-09-02 13:17:09 INFO     evaluating now!
2024-09-02 13:17:09 INFO     Epoch [29/200] train_loss: 4.4395, val_loss: 5.2185, lr: 0.003000, 5.02s
2024-09-02 13:17:14 INFO     epoch complete!
2024-09-02 13:17:14 INFO     evaluating now!
2024-09-02 13:17:14 INFO     Epoch [30/200] train_loss: 4.3944, val_loss: 5.1794, lr: 0.003000, 5.04s
2024-09-02 13:17:19 INFO     epoch complete!
2024-09-02 13:17:19 INFO     evaluating now!
2024-09-02 13:17:19 INFO     Epoch [31/200] train_loss: 4.3713, val_loss: 5.2126, lr: 0.003000, 5.03s
2024-09-02 13:17:24 INFO     epoch complete!
2024-09-02 13:17:24 INFO     evaluating now!
2024-09-02 13:17:24 INFO     Epoch [32/200] train_loss: 4.3472, val_loss: 5.1598, lr: 0.003000, 5.02s
2024-09-02 13:17:29 INFO     epoch complete!
2024-09-02 13:17:29 INFO     evaluating now!
2024-09-02 13:17:29 INFO     Epoch [33/200] train_loss: 4.3579, val_loss: 5.1004, lr: 0.003000, 5.03s
2024-09-02 13:17:34 INFO     epoch complete!
2024-09-02 13:17:34 INFO     evaluating now!
2024-09-02 13:17:34 INFO     Epoch [34/200] train_loss: 4.3141, val_loss: 5.0539, lr: 0.003000, 5.03s
2024-09-02 13:17:34 INFO     Saved model at 34
2024-09-02 13:17:34 INFO     Val loss decrease from 5.0630 to 5.0539, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-09-02 13:17:39 INFO     epoch complete!
2024-09-02 13:17:39 INFO     evaluating now!
2024-09-02 13:17:39 INFO     Epoch [35/200] train_loss: 4.2713, val_loss: 5.1052, lr: 0.003000, 5.02s
2024-09-02 13:17:44 INFO     epoch complete!
2024-09-02 13:17:44 INFO     evaluating now!
2024-09-02 13:17:44 INFO     Epoch [36/200] train_loss: 4.2505, val_loss: 5.1652, lr: 0.003000, 5.03s
2024-09-02 13:17:49 INFO     epoch complete!
2024-09-02 13:17:49 INFO     evaluating now!
2024-09-02 13:17:49 INFO     Epoch [37/200] train_loss: 4.2195, val_loss: 5.0240, lr: 0.003000, 5.04s
2024-09-02 13:17:49 INFO     Saved model at 37
2024-09-02 13:17:49 INFO     Val loss decrease from 5.0539 to 5.0240, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-09-02 13:17:54 INFO     epoch complete!
2024-09-02 13:17:54 INFO     evaluating now!
2024-09-02 13:17:54 INFO     Epoch [38/200] train_loss: 4.2247, val_loss: 5.0320, lr: 0.003000, 5.03s
2024-09-02 13:17:59 INFO     epoch complete!
2024-09-02 13:17:59 INFO     evaluating now!
2024-09-02 13:17:59 INFO     Epoch [39/200] train_loss: 4.2258, val_loss: 5.0118, lr: 0.003000, 5.03s
2024-09-02 13:17:59 INFO     Saved model at 39
2024-09-02 13:17:59 INFO     Val loss decrease from 5.0240 to 5.0118, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-09-02 13:18:04 INFO     epoch complete!
2024-09-02 13:18:04 INFO     evaluating now!
2024-09-02 13:18:04 INFO     Epoch [40/200] train_loss: 4.0910, val_loss: 5.0485, lr: 0.003000, 5.04s
2024-09-02 13:18:09 INFO     epoch complete!
2024-09-02 13:18:09 INFO     evaluating now!
2024-09-02 13:18:09 INFO     Epoch [41/200] train_loss: 3.9953, val_loss: 4.9724, lr: 0.003000, 5.03s
2024-09-02 13:18:09 INFO     Saved model at 41
2024-09-02 13:18:09 INFO     Val loss decrease from 5.0118 to 4.9724, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-09-02 13:18:14 INFO     epoch complete!
2024-09-02 13:18:14 INFO     evaluating now!
2024-09-02 13:18:14 INFO     Epoch [42/200] train_loss: 4.0063, val_loss: 4.9683, lr: 0.003000, 5.05s
2024-09-02 13:18:14 INFO     Saved model at 42
2024-09-02 13:18:14 INFO     Val loss decrease from 4.9724 to 4.9683, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-09-02 13:18:19 INFO     epoch complete!
2024-09-02 13:18:19 INFO     evaluating now!
2024-09-02 13:18:19 INFO     Epoch [43/200] train_loss: 3.9708, val_loss: 4.9770, lr: 0.003000, 5.03s
2024-09-02 13:18:24 INFO     epoch complete!
2024-09-02 13:18:24 INFO     evaluating now!
2024-09-02 13:18:24 INFO     Epoch [44/200] train_loss: 3.8996, val_loss: 5.1002, lr: 0.003000, 5.03s
2024-09-02 13:18:29 INFO     epoch complete!
2024-09-02 13:18:29 INFO     evaluating now!
2024-09-02 13:18:30 INFO     Epoch [45/200] train_loss: 3.9156, val_loss: 4.9429, lr: 0.003000, 5.04s
2024-09-02 13:18:30 INFO     Saved model at 45
2024-09-02 13:18:30 INFO     Val loss decrease from 4.9683 to 4.9429, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-09-02 13:18:34 INFO     epoch complete!
2024-09-02 13:18:34 INFO     evaluating now!
2024-09-02 13:18:35 INFO     Epoch [46/200] train_loss: 3.8955, val_loss: 4.9355, lr: 0.003000, 5.03s
2024-09-02 13:18:35 INFO     Saved model at 46
2024-09-02 13:18:35 INFO     Val loss decrease from 4.9429 to 4.9355, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-09-02 13:18:39 INFO     epoch complete!
2024-09-02 13:18:39 INFO     evaluating now!
2024-09-02 13:18:40 INFO     Epoch [47/200] train_loss: 3.9359, val_loss: 5.0878, lr: 0.003000, 5.03s
2024-09-02 13:18:44 INFO     epoch complete!
2024-09-02 13:18:44 INFO     evaluating now!
2024-09-02 13:18:45 INFO     Epoch [48/200] train_loss: 3.9425, val_loss: 4.9567, lr: 0.003000, 5.03s
2024-09-02 13:18:49 INFO     epoch complete!
2024-09-02 13:18:49 INFO     evaluating now!
2024-09-02 13:18:50 INFO     Epoch [49/200] train_loss: 3.8593, val_loss: 5.0157, lr: 0.003000, 5.03s
2024-09-02 13:18:54 INFO     epoch complete!
2024-09-02 13:18:54 INFO     evaluating now!
2024-09-02 13:18:55 INFO     Epoch [50/200] train_loss: 3.7841, val_loss: 4.9608, lr: 0.003000, 5.04s
2024-09-02 13:18:59 INFO     epoch complete!
2024-09-02 13:18:59 INFO     evaluating now!
2024-09-02 13:19:00 INFO     Epoch [51/200] train_loss: 3.7601, val_loss: 4.9385, lr: 0.003000, 5.03s
2024-09-02 13:19:04 INFO     epoch complete!
2024-09-02 13:19:04 INFO     evaluating now!
2024-09-02 13:19:05 INFO     Epoch [52/200] train_loss: 3.7434, val_loss: 4.8803, lr: 0.003000, 5.03s
2024-09-02 13:19:05 INFO     Saved model at 52
2024-09-02 13:19:05 INFO     Val loss decrease from 4.9355 to 4.8803, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch52.tar
2024-09-02 13:19:10 INFO     epoch complete!
2024-09-02 13:19:10 INFO     evaluating now!
2024-09-02 13:19:10 INFO     Epoch [53/200] train_loss: 3.7728, val_loss: 5.1073, lr: 0.003000, 5.03s
2024-09-02 13:19:15 INFO     epoch complete!
2024-09-02 13:19:15 INFO     evaluating now!
2024-09-02 13:19:15 INFO     Epoch [54/200] train_loss: 3.7324, val_loss: 5.0358, lr: 0.003000, 5.04s
2024-09-02 13:19:20 INFO     epoch complete!
2024-09-02 13:19:20 INFO     evaluating now!
2024-09-02 13:19:20 INFO     Epoch [55/200] train_loss: 3.7213, val_loss: 5.0315, lr: 0.003000, 5.02s
2024-09-02 13:19:25 INFO     epoch complete!
2024-09-02 13:19:25 INFO     evaluating now!
2024-09-02 13:19:25 INFO     Epoch [56/200] train_loss: 3.7085, val_loss: 4.9875, lr: 0.003000, 5.03s
2024-09-02 13:19:30 INFO     epoch complete!
2024-09-02 13:19:30 INFO     evaluating now!
2024-09-02 13:19:30 INFO     Epoch [57/200] train_loss: 3.7479, val_loss: 4.9571, lr: 0.003000, 5.03s
2024-09-02 13:19:35 INFO     epoch complete!
2024-09-02 13:19:35 INFO     evaluating now!
2024-09-02 13:19:35 INFO     Epoch [58/200] train_loss: 3.6205, val_loss: 4.9784, lr: 0.003000, 5.03s
2024-09-02 13:19:40 INFO     epoch complete!
2024-09-02 13:19:40 INFO     evaluating now!
2024-09-02 13:19:40 INFO     Epoch [59/200] train_loss: 3.6603, val_loss: 5.0541, lr: 0.003000, 5.33s
2024-09-02 13:19:46 INFO     epoch complete!
2024-09-02 13:19:46 INFO     evaluating now!
2024-09-02 13:19:46 INFO     Epoch [60/200] train_loss: 3.6726, val_loss: 4.9704, lr: 0.003000, 6.19s
2024-09-02 13:19:51 INFO     epoch complete!
2024-09-02 13:19:51 INFO     evaluating now!
2024-09-02 13:19:52 INFO     Epoch [61/200] train_loss: 3.6827, val_loss: 5.0083, lr: 0.003000, 5.16s
2024-09-02 13:19:56 INFO     epoch complete!
2024-09-02 13:19:56 INFO     evaluating now!
2024-09-02 13:19:57 INFO     Epoch [62/200] train_loss: 3.5860, val_loss: 4.9579, lr: 0.003000, 5.04s
2024-09-02 13:20:01 INFO     epoch complete!
2024-09-02 13:20:01 INFO     evaluating now!
2024-09-02 13:20:02 INFO     Epoch [63/200] train_loss: 3.5635, val_loss: 4.9515, lr: 0.003000, 5.07s
2024-09-02 13:20:07 INFO     epoch complete!
2024-09-02 13:20:07 INFO     evaluating now!
2024-09-02 13:20:07 INFO     Epoch [64/200] train_loss: 3.5641, val_loss: 5.0387, lr: 0.003000, 5.13s
2024-09-02 13:20:12 INFO     epoch complete!
2024-09-02 13:20:12 INFO     evaluating now!
2024-09-02 13:20:12 INFO     Epoch [65/200] train_loss: 3.5832, val_loss: 4.9057, lr: 0.003000, 5.03s
2024-09-02 13:20:17 INFO     epoch complete!
2024-09-02 13:20:17 INFO     evaluating now!
2024-09-02 13:20:17 INFO     Epoch [66/200] train_loss: 3.6025, val_loss: 4.9209, lr: 0.003000, 5.04s
2024-09-02 13:20:22 INFO     epoch complete!
2024-09-02 13:20:22 INFO     evaluating now!
2024-09-02 13:20:22 INFO     Epoch [67/200] train_loss: 3.4994, val_loss: 4.9788, lr: 0.003000, 5.13s
2024-09-02 13:20:22 WARNING  Early stopping at epoch: 67
2024-09-02 13:20:22 INFO     Trained totally 68 epochs, average train time is 4.762s, average eval time is 0.299s
2024-09-02 13:20:22 INFO     Loaded model at 52
2024-09-02 13:20:22 INFO     Saved model at ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 13:20:22 INFO     Start evaluating ...
2024-09-02 13:20:23 INFO     Note that you select the single mode to evaluate!
2024-09-02 13:20:23 INFO     Evaluate result is saved at ./libcity/cache/10/evaluate_cache\2024_09_02_13_20_23_AGCRN_CHITaxi20190406.csv
2024-09-02 13:20:23 INFO     
         MAE       RMSE
1   2.458474   7.729991
2   2.513583   8.190562
3   2.683885   8.966840
4   2.714046   9.522044
5   2.915619  10.237497
6   3.038478  10.954201
7   3.088039  11.590878
8   3.151171  12.245176
9   3.124287  12.551162
10  3.148795  12.898106
11  3.225543  13.094105
12  3.327956  13.448668
2024-09-02 13:20:23 INFO     ----------------------------------------------------------------------------
2024-09-02 13:20:23 INFO     # 3, Kownledge Graph Embedding: MuRE, Experiment ids: 13
2024-09-02 13:20:23 INFO     ----------------------------------------------------------------------------
2024-09-02 13:20:23 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=10
2024-09-02 13:20:23 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10, 'embedding_model': 'MuRE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 13:20:23 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 13:20:23 INFO     set_weight_link_or_dist: dist
2024-09-02 13:20:23 INFO     init_weight_inf_or_zero: inf
2024-09-02 13:20:23 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 13:20:23 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 13:20:23 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 13:20:23 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 13:20:25 INFO     Dataset created
2024-09-02 13:20:25 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 13:20:25 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 13:20:25 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 13:20:25 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 13:20:25 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 13:20:25 INFO     NormalScaler max: 0.9267852697961692
2024-09-02 13:20:27 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 13:20:27 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 13:20:27 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 13:20:27 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 13:20:27 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 13:20:27 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 13:20:27 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 13:20:27 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 13:20:27 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 13:20:27 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 13:20:27 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 13:20:27 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 13:20:27 INFO     Total parameter numbers: 874010
2024-09-02 13:20:27 INFO     You select `adam` optimizer.
2024-09-02 13:20:27 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 13:20:27 INFO     Start training ...
2024-09-02 13:20:27 INFO     num_batches:48
2024-09-02 13:20:32 INFO     epoch complete!
2024-09-02 13:20:32 INFO     evaluating now!
2024-09-02 13:20:32 INFO     Epoch [0/200] train_loss: 23.9336, val_loss: 18.5400, lr: 0.003000, 5.46s
2024-09-02 13:20:32 INFO     Saved model at 0
2024-09-02 13:20:32 INFO     Val loss decrease from inf to 18.5400, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 13:20:37 INFO     epoch complete!
2024-09-02 13:20:37 INFO     evaluating now!
2024-09-02 13:20:37 INFO     Epoch [1/200] train_loss: 14.9945, val_loss: 14.1283, lr: 0.003000, 5.04s
2024-09-02 13:20:37 INFO     Saved model at 1
2024-09-02 13:20:37 INFO     Val loss decrease from 18.5400 to 14.1283, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 13:20:42 INFO     epoch complete!
2024-09-02 13:20:42 INFO     evaluating now!
2024-09-02 13:20:42 INFO     Epoch [2/200] train_loss: 11.7254, val_loss: 11.5488, lr: 0.003000, 5.04s
2024-09-02 13:20:42 INFO     Saved model at 2
2024-09-02 13:20:42 INFO     Val loss decrease from 14.1283 to 11.5488, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 13:20:47 INFO     epoch complete!
2024-09-02 13:20:47 INFO     evaluating now!
2024-09-02 13:20:48 INFO     Epoch [3/200] train_loss: 9.7481, val_loss: 9.0155, lr: 0.003000, 5.12s
2024-09-02 13:20:48 INFO     Saved model at 3
2024-09-02 13:20:48 INFO     Val loss decrease from 11.5488 to 9.0155, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 13:20:52 INFO     epoch complete!
2024-09-02 13:20:52 INFO     evaluating now!
2024-09-02 13:20:53 INFO     Epoch [4/200] train_loss: 8.4308, val_loss: 8.0962, lr: 0.003000, 5.05s
2024-09-02 13:20:53 INFO     Saved model at 4
2024-09-02 13:20:53 INFO     Val loss decrease from 9.0155 to 8.0962, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 13:20:57 INFO     epoch complete!
2024-09-02 13:20:57 INFO     evaluating now!
2024-09-02 13:20:58 INFO     Epoch [5/200] train_loss: 7.5556, val_loss: 7.4242, lr: 0.003000, 5.05s
2024-09-02 13:20:58 INFO     Saved model at 5
2024-09-02 13:20:58 INFO     Val loss decrease from 8.0962 to 7.4242, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 13:21:03 INFO     epoch complete!
2024-09-02 13:21:03 INFO     evaluating now!
2024-09-02 13:21:03 INFO     Epoch [6/200] train_loss: 7.2859, val_loss: 7.0856, lr: 0.003000, 5.10s
2024-09-02 13:21:03 INFO     Saved model at 6
2024-09-02 13:21:03 INFO     Val loss decrease from 7.4242 to 7.0856, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 13:21:08 INFO     epoch complete!
2024-09-02 13:21:08 INFO     evaluating now!
2024-09-02 13:21:08 INFO     Epoch [7/200] train_loss: 6.6838, val_loss: 6.5391, lr: 0.003000, 5.05s
2024-09-02 13:21:08 INFO     Saved model at 7
2024-09-02 13:21:08 INFO     Val loss decrease from 7.0856 to 6.5391, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 13:21:13 INFO     epoch complete!
2024-09-02 13:21:13 INFO     evaluating now!
2024-09-02 13:21:13 INFO     Epoch [8/200] train_loss: 6.3862, val_loss: 6.3155, lr: 0.003000, 5.04s
2024-09-02 13:21:13 INFO     Saved model at 8
2024-09-02 13:21:13 INFO     Val loss decrease from 6.5391 to 6.3155, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 13:21:18 INFO     epoch complete!
2024-09-02 13:21:18 INFO     evaluating now!
2024-09-02 13:21:18 INFO     Epoch [9/200] train_loss: 6.1030, val_loss: 6.2903, lr: 0.003000, 5.10s
2024-09-02 13:21:18 INFO     Saved model at 9
2024-09-02 13:21:18 INFO     Val loss decrease from 6.3155 to 6.2903, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 13:21:23 INFO     epoch complete!
2024-09-02 13:21:23 INFO     evaluating now!
2024-09-02 13:21:23 INFO     Epoch [10/200] train_loss: 5.9189, val_loss: 5.9121, lr: 0.003000, 5.04s
2024-09-02 13:21:23 INFO     Saved model at 10
2024-09-02 13:21:23 INFO     Val loss decrease from 6.2903 to 5.9121, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 13:21:28 INFO     epoch complete!
2024-09-02 13:21:28 INFO     evaluating now!
2024-09-02 13:21:28 INFO     Epoch [11/200] train_loss: 5.7321, val_loss: 5.9321, lr: 0.003000, 5.05s
2024-09-02 13:21:33 INFO     epoch complete!
2024-09-02 13:21:33 INFO     evaluating now!
2024-09-02 13:21:33 INFO     Epoch [12/200] train_loss: 5.7060, val_loss: 6.0897, lr: 0.003000, 5.09s
2024-09-02 13:21:38 INFO     epoch complete!
2024-09-02 13:21:38 INFO     evaluating now!
2024-09-02 13:21:38 INFO     Epoch [13/200] train_loss: 5.5571, val_loss: 5.7243, lr: 0.003000, 5.04s
2024-09-02 13:21:38 INFO     Saved model at 13
2024-09-02 13:21:38 INFO     Val loss decrease from 5.9121 to 5.7243, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 13:21:43 INFO     epoch complete!
2024-09-02 13:21:43 INFO     evaluating now!
2024-09-02 13:21:43 INFO     Epoch [14/200] train_loss: 5.3623, val_loss: 5.8592, lr: 0.003000, 5.04s
2024-09-02 13:21:48 INFO     epoch complete!
2024-09-02 13:21:48 INFO     evaluating now!
2024-09-02 13:21:48 INFO     Epoch [15/200] train_loss: 5.2540, val_loss: 5.6192, lr: 0.003000, 5.12s
2024-09-02 13:21:48 INFO     Saved model at 15
2024-09-02 13:21:48 INFO     Val loss decrease from 5.7243 to 5.6192, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 13:21:53 INFO     epoch complete!
2024-09-02 13:21:53 INFO     evaluating now!
2024-09-02 13:21:54 INFO     Epoch [16/200] train_loss: 5.1277, val_loss: 5.4134, lr: 0.003000, 5.05s
2024-09-02 13:21:54 INFO     Saved model at 16
2024-09-02 13:21:54 INFO     Val loss decrease from 5.6192 to 5.4134, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 13:21:58 INFO     epoch complete!
2024-09-02 13:21:58 INFO     evaluating now!
2024-09-02 13:21:59 INFO     Epoch [17/200] train_loss: 5.0347, val_loss: 5.7016, lr: 0.003000, 5.10s
2024-09-02 13:22:03 INFO     epoch complete!
2024-09-02 13:22:03 INFO     evaluating now!
2024-09-02 13:22:04 INFO     Epoch [18/200] train_loss: 5.0004, val_loss: 5.4096, lr: 0.003000, 5.14s
2024-09-02 13:22:04 INFO     Saved model at 18
2024-09-02 13:22:04 INFO     Val loss decrease from 5.4134 to 5.4096, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-02 13:22:09 INFO     epoch complete!
2024-09-02 13:22:09 INFO     evaluating now!
2024-09-02 13:22:09 INFO     Epoch [19/200] train_loss: 4.9273, val_loss: 5.5223, lr: 0.003000, 5.08s
2024-09-02 13:22:14 INFO     epoch complete!
2024-09-02 13:22:14 INFO     evaluating now!
2024-09-02 13:22:14 INFO     Epoch [20/200] train_loss: 4.8591, val_loss: 5.3922, lr: 0.003000, 5.09s
2024-09-02 13:22:14 INFO     Saved model at 20
2024-09-02 13:22:14 INFO     Val loss decrease from 5.4096 to 5.3922, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-02 13:22:19 INFO     epoch complete!
2024-09-02 13:22:19 INFO     evaluating now!
2024-09-02 13:22:19 INFO     Epoch [21/200] train_loss: 4.8624, val_loss: 5.2951, lr: 0.003000, 5.13s
2024-09-02 13:22:19 INFO     Saved model at 21
2024-09-02 13:22:19 INFO     Val loss decrease from 5.3922 to 5.2951, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-02 13:22:24 INFO     epoch complete!
2024-09-02 13:22:24 INFO     evaluating now!
2024-09-02 13:22:24 INFO     Epoch [22/200] train_loss: 4.8259, val_loss: 5.4081, lr: 0.003000, 5.08s
2024-09-02 13:22:29 INFO     epoch complete!
2024-09-02 13:22:29 INFO     evaluating now!
2024-09-02 13:22:29 INFO     Epoch [23/200] train_loss: 4.7543, val_loss: 5.3128, lr: 0.003000, 5.07s
2024-09-02 13:22:34 INFO     epoch complete!
2024-09-02 13:22:34 INFO     evaluating now!
2024-09-02 13:22:34 INFO     Epoch [24/200] train_loss: 4.6790, val_loss: 5.3134, lr: 0.003000, 5.14s
2024-09-02 13:22:39 INFO     epoch complete!
2024-09-02 13:22:39 INFO     evaluating now!
2024-09-02 13:22:40 INFO     Epoch [25/200] train_loss: 4.5814, val_loss: 5.2686, lr: 0.003000, 5.09s
2024-09-02 13:22:40 INFO     Saved model at 25
2024-09-02 13:22:40 INFO     Val loss decrease from 5.2951 to 5.2686, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-02 13:22:44 INFO     epoch complete!
2024-09-02 13:22:44 INFO     evaluating now!
2024-09-02 13:22:45 INFO     Epoch [26/200] train_loss: 4.5416, val_loss: 5.2076, lr: 0.003000, 5.09s
2024-09-02 13:22:45 INFO     Saved model at 26
2024-09-02 13:22:45 INFO     Val loss decrease from 5.2686 to 5.2076, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-02 13:22:49 INFO     epoch complete!
2024-09-02 13:22:49 INFO     evaluating now!
2024-09-02 13:22:50 INFO     Epoch [27/200] train_loss: 4.4955, val_loss: 5.2168, lr: 0.003000, 5.14s
2024-09-02 13:22:55 INFO     epoch complete!
2024-09-02 13:22:55 INFO     evaluating now!
2024-09-02 13:22:55 INFO     Epoch [28/200] train_loss: 4.4409, val_loss: 5.0637, lr: 0.003000, 5.07s
2024-09-02 13:22:55 INFO     Saved model at 28
2024-09-02 13:22:55 INFO     Val loss decrease from 5.2076 to 5.0637, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-02 13:23:00 INFO     epoch complete!
2024-09-02 13:23:00 INFO     evaluating now!
2024-09-02 13:23:00 INFO     Epoch [29/200] train_loss: 4.3973, val_loss: 5.1437, lr: 0.003000, 5.12s
2024-09-02 13:23:05 INFO     epoch complete!
2024-09-02 13:23:05 INFO     evaluating now!
2024-09-02 13:23:05 INFO     Epoch [30/200] train_loss: 4.3497, val_loss: 5.1658, lr: 0.003000, 5.29s
2024-09-02 13:23:10 INFO     epoch complete!
2024-09-02 13:23:10 INFO     evaluating now!
2024-09-02 13:23:10 INFO     Epoch [31/200] train_loss: 4.3465, val_loss: 5.2636, lr: 0.003000, 5.14s
2024-09-02 13:23:15 INFO     epoch complete!
2024-09-02 13:23:15 INFO     evaluating now!
2024-09-02 13:23:16 INFO     Epoch [32/200] train_loss: 4.2808, val_loss: 5.2824, lr: 0.003000, 5.16s
2024-09-02 13:23:20 INFO     epoch complete!
2024-09-02 13:23:20 INFO     evaluating now!
2024-09-02 13:23:21 INFO     Epoch [33/200] train_loss: 4.2489, val_loss: 5.2960, lr: 0.003000, 5.19s
2024-09-02 13:23:26 INFO     epoch complete!
2024-09-02 13:23:26 INFO     evaluating now!
2024-09-02 13:23:26 INFO     Epoch [34/200] train_loss: 4.2185, val_loss: 5.2423, lr: 0.003000, 5.12s
2024-09-02 13:23:31 INFO     epoch complete!
2024-09-02 13:23:31 INFO     evaluating now!
2024-09-02 13:23:31 INFO     Epoch [35/200] train_loss: 4.2006, val_loss: 5.2002, lr: 0.003000, 5.13s
2024-09-02 13:23:36 INFO     epoch complete!
2024-09-02 13:23:36 INFO     evaluating now!
2024-09-02 13:23:36 INFO     Epoch [36/200] train_loss: 4.1878, val_loss: 5.4338, lr: 0.003000, 5.28s
2024-09-02 13:23:41 INFO     epoch complete!
2024-09-02 13:23:41 INFO     evaluating now!
2024-09-02 13:23:42 INFO     Epoch [37/200] train_loss: 4.1537, val_loss: 5.1366, lr: 0.003000, 5.22s
2024-09-02 13:23:46 INFO     epoch complete!
2024-09-02 13:23:46 INFO     evaluating now!
2024-09-02 13:23:47 INFO     Epoch [38/200] train_loss: 4.0697, val_loss: 5.0699, lr: 0.003000, 5.14s
2024-09-02 13:23:52 INFO     epoch complete!
2024-09-02 13:23:52 INFO     evaluating now!
2024-09-02 13:23:52 INFO     Epoch [39/200] train_loss: 4.0434, val_loss: 5.0736, lr: 0.003000, 5.31s
2024-09-02 13:23:57 INFO     epoch complete!
2024-09-02 13:23:57 INFO     evaluating now!
2024-09-02 13:23:57 INFO     Epoch [40/200] train_loss: 4.0845, val_loss: 5.0726, lr: 0.003000, 5.18s
2024-09-02 13:24:02 INFO     epoch complete!
2024-09-02 13:24:02 INFO     evaluating now!
2024-09-02 13:24:02 INFO     Epoch [41/200] train_loss: 3.9775, val_loss: 5.0604, lr: 0.003000, 5.14s
2024-09-02 13:24:02 INFO     Saved model at 41
2024-09-02 13:24:02 INFO     Val loss decrease from 5.0637 to 5.0604, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-09-02 13:24:07 INFO     epoch complete!
2024-09-02 13:24:07 INFO     evaluating now!
2024-09-02 13:24:08 INFO     Epoch [42/200] train_loss: 3.9467, val_loss: 5.1419, lr: 0.003000, 5.38s
2024-09-02 13:24:13 INFO     epoch complete!
2024-09-02 13:24:13 INFO     evaluating now!
2024-09-02 13:24:13 INFO     Epoch [43/200] train_loss: 4.1050, val_loss: 5.2496, lr: 0.003000, 5.35s
2024-09-02 13:24:18 INFO     epoch complete!
2024-09-02 13:24:18 INFO     evaluating now!
2024-09-02 13:24:18 INFO     Epoch [44/200] train_loss: 4.0161, val_loss: 5.0499, lr: 0.003000, 5.31s
2024-09-02 13:24:18 INFO     Saved model at 44
2024-09-02 13:24:18 INFO     Val loss decrease from 5.0604 to 5.0499, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-09-02 13:24:23 INFO     epoch complete!
2024-09-02 13:24:23 INFO     evaluating now!
2024-09-02 13:24:24 INFO     Epoch [45/200] train_loss: 3.9309, val_loss: 5.1285, lr: 0.003000, 5.22s
2024-09-02 13:24:28 INFO     epoch complete!
2024-09-02 13:24:28 INFO     evaluating now!
2024-09-02 13:24:29 INFO     Epoch [46/200] train_loss: 3.8961, val_loss: 5.0953, lr: 0.003000, 5.21s
2024-09-02 13:24:34 INFO     epoch complete!
2024-09-02 13:24:34 INFO     evaluating now!
2024-09-02 13:24:34 INFO     Epoch [47/200] train_loss: 3.9092, val_loss: 5.0129, lr: 0.003000, 5.22s
2024-09-02 13:24:34 INFO     Saved model at 47
2024-09-02 13:24:34 INFO     Val loss decrease from 5.0499 to 5.0129, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch47.tar
2024-09-02 13:24:39 INFO     epoch complete!
2024-09-02 13:24:39 INFO     evaluating now!
2024-09-02 13:24:39 INFO     Epoch [48/200] train_loss: 3.8779, val_loss: 5.0034, lr: 0.003000, 5.18s
2024-09-02 13:24:39 INFO     Saved model at 48
2024-09-02 13:24:39 INFO     Val loss decrease from 5.0129 to 5.0034, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-09-02 13:24:44 INFO     epoch complete!
2024-09-02 13:24:44 INFO     evaluating now!
2024-09-02 13:24:44 INFO     Epoch [49/200] train_loss: 3.8662, val_loss: 5.0170, lr: 0.003000, 5.18s
2024-09-02 13:24:49 INFO     epoch complete!
2024-09-02 13:24:49 INFO     evaluating now!
2024-09-02 13:24:50 INFO     Epoch [50/200] train_loss: 3.8093, val_loss: 5.1529, lr: 0.003000, 5.28s
2024-09-02 13:24:55 INFO     epoch complete!
2024-09-02 13:24:55 INFO     evaluating now!
2024-09-02 13:24:55 INFO     Epoch [51/200] train_loss: 3.8131, val_loss: 5.1275, lr: 0.003000, 5.25s
2024-09-02 13:25:00 INFO     epoch complete!
2024-09-02 13:25:00 INFO     evaluating now!
2024-09-02 13:25:00 INFO     Epoch [52/200] train_loss: 3.8346, val_loss: 5.1841, lr: 0.003000, 5.27s
2024-09-02 13:25:05 INFO     epoch complete!
2024-09-02 13:25:05 INFO     evaluating now!
2024-09-02 13:25:05 INFO     Epoch [53/200] train_loss: 3.8079, val_loss: 5.1482, lr: 0.003000, 5.21s
2024-09-02 13:25:10 INFO     epoch complete!
2024-09-02 13:25:10 INFO     evaluating now!
2024-09-02 13:25:11 INFO     Epoch [54/200] train_loss: 3.7800, val_loss: 5.1361, lr: 0.003000, 5.19s
2024-09-02 13:25:15 INFO     epoch complete!
2024-09-02 13:25:15 INFO     evaluating now!
2024-09-02 13:25:16 INFO     Epoch [55/200] train_loss: 3.6960, val_loss: 4.9625, lr: 0.003000, 5.21s
2024-09-02 13:25:16 INFO     Saved model at 55
2024-09-02 13:25:16 INFO     Val loss decrease from 5.0034 to 4.9625, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch55.tar
2024-09-02 13:25:21 INFO     epoch complete!
2024-09-02 13:25:21 INFO     evaluating now!
2024-09-02 13:25:21 INFO     Epoch [56/200] train_loss: 3.7178, val_loss: 5.0915, lr: 0.003000, 5.33s
2024-09-02 13:25:26 INFO     epoch complete!
2024-09-02 13:25:26 INFO     evaluating now!
2024-09-02 13:25:26 INFO     Epoch [57/200] train_loss: 3.6445, val_loss: 5.1171, lr: 0.003000, 5.26s
2024-09-02 13:25:31 INFO     epoch complete!
2024-09-02 13:25:31 INFO     evaluating now!
2024-09-02 13:25:32 INFO     Epoch [58/200] train_loss: 3.6182, val_loss: 5.1628, lr: 0.003000, 5.15s
2024-09-02 13:25:36 INFO     epoch complete!
2024-09-02 13:25:36 INFO     evaluating now!
2024-09-02 13:25:37 INFO     Epoch [59/200] train_loss: 3.6511, val_loss: 5.1117, lr: 0.003000, 5.24s
2024-09-02 13:25:42 INFO     epoch complete!
2024-09-02 13:25:42 INFO     evaluating now!
2024-09-02 13:25:42 INFO     Epoch [60/200] train_loss: 3.6669, val_loss: 5.0633, lr: 0.003000, 5.36s
2024-09-02 13:25:47 INFO     epoch complete!
2024-09-02 13:25:47 INFO     evaluating now!
2024-09-02 13:25:47 INFO     Epoch [61/200] train_loss: 3.6000, val_loss: 5.0596, lr: 0.003000, 5.15s
2024-09-02 13:25:52 INFO     epoch complete!
2024-09-02 13:25:52 INFO     evaluating now!
2024-09-02 13:25:52 INFO     Epoch [62/200] train_loss: 3.5839, val_loss: 5.1280, lr: 0.003000, 5.12s
2024-09-02 13:25:57 INFO     epoch complete!
2024-09-02 13:25:57 INFO     evaluating now!
2024-09-02 13:25:58 INFO     Epoch [63/200] train_loss: 3.5855, val_loss: 5.0462, lr: 0.003000, 5.18s
2024-09-02 13:26:02 INFO     epoch complete!
2024-09-02 13:26:02 INFO     evaluating now!
2024-09-02 13:26:03 INFO     Epoch [64/200] train_loss: 3.5778, val_loss: 5.0223, lr: 0.003000, 5.12s
2024-09-02 13:26:07 INFO     epoch complete!
2024-09-02 13:26:07 INFO     evaluating now!
2024-09-02 13:26:08 INFO     Epoch [65/200] train_loss: 3.5751, val_loss: 5.1897, lr: 0.003000, 5.04s
2024-09-02 13:26:12 INFO     epoch complete!
2024-09-02 13:26:12 INFO     evaluating now!
2024-09-02 13:26:13 INFO     Epoch [66/200] train_loss: 3.5446, val_loss: 5.1433, lr: 0.003000, 5.04s
2024-09-02 13:26:18 INFO     epoch complete!
2024-09-02 13:26:18 INFO     evaluating now!
2024-09-02 13:26:18 INFO     Epoch [67/200] train_loss: 3.5450, val_loss: 5.1092, lr: 0.003000, 5.05s
2024-09-02 13:26:23 INFO     epoch complete!
2024-09-02 13:26:23 INFO     evaluating now!
2024-09-02 13:26:23 INFO     Epoch [68/200] train_loss: 3.5134, val_loss: 5.0489, lr: 0.003000, 5.04s
2024-09-02 13:26:28 INFO     epoch complete!
2024-09-02 13:26:28 INFO     evaluating now!
2024-09-02 13:26:28 INFO     Epoch [69/200] train_loss: 3.5540, val_loss: 5.1318, lr: 0.003000, 5.15s
2024-09-02 13:26:33 INFO     epoch complete!
2024-09-02 13:26:33 INFO     evaluating now!
2024-09-02 13:26:33 INFO     Epoch [70/200] train_loss: 3.5331, val_loss: 5.2085, lr: 0.003000, 5.17s
2024-09-02 13:26:33 WARNING  Early stopping at epoch: 70
2024-09-02 13:26:33 INFO     Trained totally 71 epochs, average train time is 4.845s, average eval time is 0.309s
2024-09-02 13:26:33 INFO     Loaded model at 55
2024-09-02 13:26:33 INFO     Saved model at ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 13:26:33 INFO     Start evaluating ...
2024-09-02 13:26:34 INFO     Note that you select the single mode to evaluate!
2024-09-02 13:26:34 INFO     Evaluate result is saved at ./libcity/cache/10/evaluate_cache\2024_09_02_13_26_34_AGCRN_CHITaxi20190406.csv
2024-09-02 13:26:34 INFO     
         MAE       RMSE
1   2.408354   7.741400
2   2.496850   7.966091
3   2.543430   8.758749
4   2.696150   9.252219
5   2.893387   9.995491
6   2.953969  10.865777
7   3.058353  11.724026
8   3.156788  12.477036
9   3.224709  12.967910
10  3.295911  13.336299
11  3.303392  13.515543
12  3.489025  14.077923
2024-09-02 13:26:34 INFO     ----------------------------------------------------------------------------
2024-09-02 13:26:34 INFO     # 4, Kownledge Graph Embedding: MuRE, Experiment ids: 14
2024-09-02 13:26:34 INFO     ----------------------------------------------------------------------------
2024-09-02 13:26:34 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=10
2024-09-02 13:26:34 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10, 'embedding_model': 'MuRE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 13:26:34 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 13:26:34 INFO     set_weight_link_or_dist: dist
2024-09-02 13:26:34 INFO     init_weight_inf_or_zero: inf
2024-09-02 13:26:34 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 13:26:34 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 13:26:34 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 13:26:34 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 13:26:36 INFO     Dataset created
2024-09-02 13:26:36 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 13:26:36 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 13:26:36 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 13:26:36 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 13:26:36 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 13:26:36 INFO     NormalScaler max: 0.9267852697961692
2024-09-02 13:26:38 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 13:26:38 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 13:26:38 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 13:26:38 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 13:26:38 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 13:26:38 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 13:26:38 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 13:26:38 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 13:26:38 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 13:26:38 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 13:26:38 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 13:26:38 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 13:26:38 INFO     Total parameter numbers: 874010
2024-09-02 13:26:38 INFO     You select `adam` optimizer.
2024-09-02 13:26:38 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 13:26:38 INFO     Start training ...
2024-09-02 13:26:38 INFO     num_batches:48
2024-09-02 13:26:43 INFO     epoch complete!
2024-09-02 13:26:43 INFO     evaluating now!
2024-09-02 13:26:44 INFO     Epoch [0/200] train_loss: 23.9946, val_loss: 18.7982, lr: 0.003000, 5.20s
2024-09-02 13:26:44 INFO     Saved model at 0
2024-09-02 13:26:44 INFO     Val loss decrease from inf to 18.7982, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 13:26:48 INFO     epoch complete!
2024-09-02 13:26:48 INFO     evaluating now!
2024-09-02 13:26:49 INFO     Epoch [1/200] train_loss: 15.3103, val_loss: 14.6598, lr: 0.003000, 5.05s
2024-09-02 13:26:49 INFO     Saved model at 1
2024-09-02 13:26:49 INFO     Val loss decrease from 18.7982 to 14.6598, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 13:26:53 INFO     epoch complete!
2024-09-02 13:26:53 INFO     evaluating now!
2024-09-02 13:26:54 INFO     Epoch [2/200] train_loss: 12.0253, val_loss: 11.7232, lr: 0.003000, 5.17s
2024-09-02 13:26:54 INFO     Saved model at 2
2024-09-02 13:26:54 INFO     Val loss decrease from 14.6598 to 11.7232, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 13:26:59 INFO     epoch complete!
2024-09-02 13:26:59 INFO     evaluating now!
2024-09-02 13:26:59 INFO     Epoch [3/200] train_loss: 9.8825, val_loss: 9.5849, lr: 0.003000, 5.16s
2024-09-02 13:26:59 INFO     Saved model at 3
2024-09-02 13:26:59 INFO     Val loss decrease from 11.7232 to 9.5849, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 13:27:04 INFO     epoch complete!
2024-09-02 13:27:04 INFO     evaluating now!
2024-09-02 13:27:04 INFO     Epoch [4/200] train_loss: 8.5410, val_loss: 8.8168, lr: 0.003000, 5.33s
2024-09-02 13:27:04 INFO     Saved model at 4
2024-09-02 13:27:04 INFO     Val loss decrease from 9.5849 to 8.8168, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 13:27:09 INFO     epoch complete!
2024-09-02 13:27:09 INFO     evaluating now!
2024-09-02 13:27:10 INFO     Epoch [5/200] train_loss: 7.7434, val_loss: 7.4397, lr: 0.003000, 5.46s
2024-09-02 13:27:10 INFO     Saved model at 5
2024-09-02 13:27:10 INFO     Val loss decrease from 8.8168 to 7.4397, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 13:27:15 INFO     epoch complete!
2024-09-02 13:27:15 INFO     evaluating now!
2024-09-02 13:27:15 INFO     Epoch [6/200] train_loss: 7.2020, val_loss: 7.4135, lr: 0.003000, 5.15s
2024-09-02 13:27:15 INFO     Saved model at 6
2024-09-02 13:27:15 INFO     Val loss decrease from 7.4397 to 7.4135, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 13:27:20 INFO     epoch complete!
2024-09-02 13:27:20 INFO     evaluating now!
2024-09-02 13:27:20 INFO     Epoch [7/200] train_loss: 6.8128, val_loss: 6.8132, lr: 0.003000, 5.15s
2024-09-02 13:27:20 INFO     Saved model at 7
2024-09-02 13:27:20 INFO     Val loss decrease from 7.4135 to 6.8132, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 13:27:25 INFO     epoch complete!
2024-09-02 13:27:25 INFO     evaluating now!
2024-09-02 13:27:25 INFO     Epoch [8/200] train_loss: 6.4526, val_loss: 6.4715, lr: 0.003000, 5.23s
2024-09-02 13:27:25 INFO     Saved model at 8
2024-09-02 13:27:25 INFO     Val loss decrease from 6.8132 to 6.4715, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 13:27:30 INFO     epoch complete!
2024-09-02 13:27:30 INFO     evaluating now!
2024-09-02 13:27:31 INFO     Epoch [9/200] train_loss: 6.2833, val_loss: 6.5098, lr: 0.003000, 5.22s
2024-09-02 13:27:35 INFO     epoch complete!
2024-09-02 13:27:35 INFO     evaluating now!
2024-09-02 13:27:36 INFO     Epoch [10/200] train_loss: 6.0004, val_loss: 6.0613, lr: 0.003000, 5.07s
2024-09-02 13:27:36 INFO     Saved model at 10
2024-09-02 13:27:36 INFO     Val loss decrease from 6.4715 to 6.0613, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 13:27:40 INFO     epoch complete!
2024-09-02 13:27:40 INFO     evaluating now!
2024-09-02 13:27:41 INFO     Epoch [11/200] train_loss: 5.7436, val_loss: 6.0515, lr: 0.003000, 5.16s
2024-09-02 13:27:41 INFO     Saved model at 11
2024-09-02 13:27:41 INFO     Val loss decrease from 6.0613 to 6.0515, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 13:27:46 INFO     epoch complete!
2024-09-02 13:27:46 INFO     evaluating now!
2024-09-02 13:27:46 INFO     Epoch [12/200] train_loss: 5.6269, val_loss: 5.8300, lr: 0.003000, 5.06s
2024-09-02 13:27:46 INFO     Saved model at 12
2024-09-02 13:27:46 INFO     Val loss decrease from 6.0515 to 5.8300, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 13:27:51 INFO     epoch complete!
2024-09-02 13:27:51 INFO     evaluating now!
2024-09-02 13:27:51 INFO     Epoch [13/200] train_loss: 5.6830, val_loss: 6.1274, lr: 0.003000, 5.11s
2024-09-02 13:27:56 INFO     epoch complete!
2024-09-02 13:27:56 INFO     evaluating now!
2024-09-02 13:27:56 INFO     Epoch [14/200] train_loss: 5.4632, val_loss: 5.7710, lr: 0.003000, 5.24s
2024-09-02 13:27:56 INFO     Saved model at 14
2024-09-02 13:27:56 INFO     Val loss decrease from 5.8300 to 5.7710, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-02 13:28:01 INFO     epoch complete!
2024-09-02 13:28:01 INFO     evaluating now!
2024-09-02 13:28:01 INFO     Epoch [15/200] train_loss: 5.3322, val_loss: 5.7801, lr: 0.003000, 5.09s
2024-09-02 13:28:06 INFO     epoch complete!
2024-09-02 13:28:06 INFO     evaluating now!
2024-09-02 13:28:06 INFO     Epoch [16/200] train_loss: 5.2354, val_loss: 5.6741, lr: 0.003000, 5.08s
2024-09-02 13:28:06 INFO     Saved model at 16
2024-09-02 13:28:06 INFO     Val loss decrease from 5.7710 to 5.6741, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 13:28:11 INFO     epoch complete!
2024-09-02 13:28:11 INFO     evaluating now!
2024-09-02 13:28:12 INFO     Epoch [17/200] train_loss: 5.1314, val_loss: 5.5753, lr: 0.003000, 5.18s
2024-09-02 13:28:12 INFO     Saved model at 17
2024-09-02 13:28:12 INFO     Val loss decrease from 5.6741 to 5.5753, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-02 13:28:16 INFO     epoch complete!
2024-09-02 13:28:16 INFO     evaluating now!
2024-09-02 13:28:17 INFO     Epoch [18/200] train_loss: 5.1450, val_loss: 5.5294, lr: 0.003000, 5.14s
2024-09-02 13:28:17 INFO     Saved model at 18
2024-09-02 13:28:17 INFO     Val loss decrease from 5.5753 to 5.5294, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-02 13:28:22 INFO     epoch complete!
2024-09-02 13:28:22 INFO     evaluating now!
2024-09-02 13:28:22 INFO     Epoch [19/200] train_loss: 5.0444, val_loss: 5.5975, lr: 0.003000, 5.15s
2024-09-02 13:28:27 INFO     epoch complete!
2024-09-02 13:28:27 INFO     evaluating now!
2024-09-02 13:28:27 INFO     Epoch [20/200] train_loss: 4.9858, val_loss: 5.5365, lr: 0.003000, 5.35s
2024-09-02 13:28:32 INFO     epoch complete!
2024-09-02 13:28:32 INFO     evaluating now!
2024-09-02 13:28:32 INFO     Epoch [21/200] train_loss: 4.9227, val_loss: 5.5665, lr: 0.003000, 5.18s
2024-09-02 13:28:37 INFO     epoch complete!
2024-09-02 13:28:37 INFO     evaluating now!
2024-09-02 13:28:38 INFO     Epoch [22/200] train_loss: 4.8205, val_loss: 5.3773, lr: 0.003000, 5.17s
2024-09-02 13:28:38 INFO     Saved model at 22
2024-09-02 13:28:38 INFO     Val loss decrease from 5.5294 to 5.3773, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-02 13:28:43 INFO     epoch complete!
2024-09-02 13:28:43 INFO     evaluating now!
2024-09-02 13:28:43 INFO     Epoch [23/200] train_loss: 4.7872, val_loss: 5.4093, lr: 0.003000, 5.18s
2024-09-02 13:28:48 INFO     epoch complete!
2024-09-02 13:28:48 INFO     evaluating now!
2024-09-02 13:28:48 INFO     Epoch [24/200] train_loss: 4.8332, val_loss: 5.6572, lr: 0.003000, 5.16s
2024-09-02 13:28:53 INFO     epoch complete!
2024-09-02 13:28:53 INFO     evaluating now!
2024-09-02 13:28:53 INFO     Epoch [25/200] train_loss: 4.6889, val_loss: 5.4378, lr: 0.003000, 5.18s
2024-09-02 13:28:58 INFO     epoch complete!
2024-09-02 13:28:58 INFO     evaluating now!
2024-09-02 13:28:58 INFO     Epoch [26/200] train_loss: 4.6209, val_loss: 5.2146, lr: 0.003000, 5.22s
2024-09-02 13:28:58 INFO     Saved model at 26
2024-09-02 13:28:58 INFO     Val loss decrease from 5.3773 to 5.2146, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-02 13:29:03 INFO     epoch complete!
2024-09-02 13:29:03 INFO     evaluating now!
2024-09-02 13:29:04 INFO     Epoch [27/200] train_loss: 4.5862, val_loss: 5.5189, lr: 0.003000, 5.15s
2024-09-02 13:29:08 INFO     epoch complete!
2024-09-02 13:29:08 INFO     evaluating now!
2024-09-02 13:29:09 INFO     Epoch [28/200] train_loss: 4.4784, val_loss: 5.3268, lr: 0.003000, 5.11s
2024-09-02 13:29:14 INFO     epoch complete!
2024-09-02 13:29:14 INFO     evaluating now!
2024-09-02 13:29:14 INFO     Epoch [29/200] train_loss: 4.4891, val_loss: 5.1722, lr: 0.003000, 5.18s
2024-09-02 13:29:14 INFO     Saved model at 29
2024-09-02 13:29:14 INFO     Val loss decrease from 5.2146 to 5.1722, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-02 13:29:19 INFO     epoch complete!
2024-09-02 13:29:19 INFO     evaluating now!
2024-09-02 13:29:19 INFO     Epoch [30/200] train_loss: 4.5389, val_loss: 5.2958, lr: 0.003000, 5.11s
2024-09-02 13:29:24 INFO     epoch complete!
2024-09-02 13:29:24 INFO     evaluating now!
2024-09-02 13:29:24 INFO     Epoch [31/200] train_loss: 4.5355, val_loss: 5.3219, lr: 0.003000, 5.29s
2024-09-02 13:29:29 INFO     epoch complete!
2024-09-02 13:29:29 INFO     evaluating now!
2024-09-02 13:29:29 INFO     Epoch [32/200] train_loss: 4.4295, val_loss: 5.2869, lr: 0.003000, 5.19s
2024-09-02 13:29:34 INFO     epoch complete!
2024-09-02 13:29:34 INFO     evaluating now!
2024-09-02 13:29:35 INFO     Epoch [33/200] train_loss: 4.3614, val_loss: 5.2067, lr: 0.003000, 5.16s
2024-09-02 13:29:39 INFO     epoch complete!
2024-09-02 13:29:39 INFO     evaluating now!
2024-09-02 13:29:40 INFO     Epoch [34/200] train_loss: 4.2771, val_loss: 5.1679, lr: 0.003000, 5.20s
2024-09-02 13:29:40 INFO     Saved model at 34
2024-09-02 13:29:40 INFO     Val loss decrease from 5.1722 to 5.1679, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-09-02 13:29:45 INFO     epoch complete!
2024-09-02 13:29:45 INFO     evaluating now!
2024-09-02 13:29:45 INFO     Epoch [35/200] train_loss: 4.2229, val_loss: 5.4436, lr: 0.003000, 5.12s
2024-09-02 13:29:50 INFO     epoch complete!
2024-09-02 13:29:50 INFO     evaluating now!
2024-09-02 13:29:50 INFO     Epoch [36/200] train_loss: 4.2489, val_loss: 5.3575, lr: 0.003000, 5.13s
2024-09-02 13:29:55 INFO     epoch complete!
2024-09-02 13:29:55 INFO     evaluating now!
2024-09-02 13:29:55 INFO     Epoch [37/200] train_loss: 4.2134, val_loss: 5.1518, lr: 0.003000, 5.21s
2024-09-02 13:29:55 INFO     Saved model at 37
2024-09-02 13:29:55 INFO     Val loss decrease from 5.1679 to 5.1518, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-09-02 13:30:00 INFO     epoch complete!
2024-09-02 13:30:00 INFO     evaluating now!
2024-09-02 13:30:00 INFO     Epoch [38/200] train_loss: 4.1783, val_loss: 5.1004, lr: 0.003000, 5.14s
2024-09-02 13:30:00 INFO     Saved model at 38
2024-09-02 13:30:00 INFO     Val loss decrease from 5.1518 to 5.1004, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-09-02 13:30:05 INFO     epoch complete!
2024-09-02 13:30:05 INFO     evaluating now!
2024-09-02 13:30:06 INFO     Epoch [39/200] train_loss: 4.2180, val_loss: 5.1414, lr: 0.003000, 5.14s
2024-09-02 13:30:10 INFO     epoch complete!
2024-09-02 13:30:10 INFO     evaluating now!
2024-09-02 13:30:11 INFO     Epoch [40/200] train_loss: 4.1712, val_loss: 4.9955, lr: 0.003000, 5.17s
2024-09-02 13:30:11 INFO     Saved model at 40
2024-09-02 13:30:11 INFO     Val loss decrease from 5.1004 to 4.9955, saving to ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-09-02 13:30:16 INFO     epoch complete!
2024-09-02 13:30:16 INFO     evaluating now!
2024-09-02 13:30:16 INFO     Epoch [41/200] train_loss: 4.1654, val_loss: 5.1913, lr: 0.003000, 5.13s
2024-09-02 13:30:21 INFO     epoch complete!
2024-09-02 13:30:21 INFO     evaluating now!
2024-09-02 13:30:21 INFO     Epoch [42/200] train_loss: 4.0783, val_loss: 5.1736, lr: 0.003000, 5.12s
2024-09-02 13:30:26 INFO     epoch complete!
2024-09-02 13:30:26 INFO     evaluating now!
2024-09-02 13:30:26 INFO     Epoch [43/200] train_loss: 4.0297, val_loss: 5.2176, lr: 0.003000, 5.22s
2024-09-02 13:30:31 INFO     epoch complete!
2024-09-02 13:30:31 INFO     evaluating now!
2024-09-02 13:30:31 INFO     Epoch [44/200] train_loss: 3.9958, val_loss: 5.3205, lr: 0.003000, 5.17s
2024-09-02 13:30:36 INFO     epoch complete!
2024-09-02 13:30:36 INFO     evaluating now!
2024-09-02 13:30:37 INFO     Epoch [45/200] train_loss: 3.9929, val_loss: 5.1481, lr: 0.003000, 5.14s
2024-09-02 13:30:42 INFO     epoch complete!
2024-09-02 13:30:42 INFO     evaluating now!
2024-09-02 13:30:42 INFO     Epoch [46/200] train_loss: 4.0176, val_loss: 5.1178, lr: 0.003000, 5.29s
2024-09-02 13:30:47 INFO     epoch complete!
2024-09-02 13:30:47 INFO     evaluating now!
2024-09-02 13:30:47 INFO     Epoch [47/200] train_loss: 3.9678, val_loss: 5.0929, lr: 0.003000, 5.18s
2024-09-02 13:30:52 INFO     epoch complete!
2024-09-02 13:30:52 INFO     evaluating now!
2024-09-02 13:30:52 INFO     Epoch [48/200] train_loss: 3.8995, val_loss: 5.0574, lr: 0.003000, 5.13s
2024-09-02 13:30:57 INFO     epoch complete!
2024-09-02 13:30:57 INFO     evaluating now!
2024-09-02 13:30:57 INFO     Epoch [49/200] train_loss: 3.8903, val_loss: 5.2363, lr: 0.003000, 5.24s
2024-09-02 13:31:02 INFO     epoch complete!
2024-09-02 13:31:02 INFO     evaluating now!
2024-09-02 13:31:03 INFO     Epoch [50/200] train_loss: 3.9366, val_loss: 5.0478, lr: 0.003000, 5.15s
2024-09-02 13:31:07 INFO     epoch complete!
2024-09-02 13:31:07 INFO     evaluating now!
2024-09-02 13:31:08 INFO     Epoch [51/200] train_loss: 3.8872, val_loss: 4.9996, lr: 0.003000, 5.10s
2024-09-02 13:31:13 INFO     epoch complete!
2024-09-02 13:31:13 INFO     evaluating now!
2024-09-02 13:31:13 INFO     Epoch [52/200] train_loss: 3.9367, val_loss: 5.1848, lr: 0.003000, 5.16s
2024-09-02 13:31:18 INFO     epoch complete!
2024-09-02 13:31:18 INFO     evaluating now!
2024-09-02 13:31:18 INFO     Epoch [53/200] train_loss: 3.9014, val_loss: 5.0568, lr: 0.003000, 5.14s
2024-09-02 13:31:23 INFO     epoch complete!
2024-09-02 13:31:23 INFO     evaluating now!
2024-09-02 13:31:23 INFO     Epoch [54/200] train_loss: 3.8832, val_loss: 5.0552, lr: 0.003000, 5.15s
2024-09-02 13:31:28 INFO     epoch complete!
2024-09-02 13:31:28 INFO     evaluating now!
2024-09-02 13:31:28 INFO     Epoch [55/200] train_loss: 3.7717, val_loss: 5.0548, lr: 0.003000, 5.20s
2024-09-02 13:31:28 WARNING  Early stopping at epoch: 55
2024-09-02 13:31:28 INFO     Trained totally 56 epochs, average train time is 4.858s, average eval time is 0.314s
2024-09-02 13:31:28 INFO     Loaded model at 40
2024-09-02 13:31:28 INFO     Saved model at ./libcity/cache/10/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 13:31:28 INFO     Start evaluating ...
2024-09-02 13:31:29 INFO     Note that you select the single mode to evaluate!
2024-09-02 13:31:29 INFO     Evaluate result is saved at ./libcity/cache/10/evaluate_cache\2024_09_02_13_31_29_AGCRN_CHITaxi20190406.csv
2024-09-02 13:31:29 INFO     
         MAE       RMSE
1   2.429400   7.127326
2   2.540410   7.759767
3   2.737158   8.852673
4   2.911273   9.676371
5   3.077138  10.407986
6   3.152320  11.081801
7   3.225066  11.889609
8   3.269894  12.447024
9   3.345197  12.974842
10  3.404655  13.288157
11  3.466189  13.721662
12  3.589408  14.529238
2024-09-02 13:31:29 INFO     ----------------------------------------------------------------------------
2024-09-02 13:31:29 INFO     Kownledge Graph Embedding: MuRE, Experiment ids: [10, 11, 12, 13, 14]
2024-09-02 13:31:29 INFO     ----------------------------------------------------------------------------
2024-09-02 13:31:29 INFO     Average: 
         MAE       RMSE
0   2.450628   7.684469
1   2.529523   8.068488
2   2.676935   8.856943
3   2.792241   9.478205
4   2.967130  10.259855
5   3.075195  11.065701
6   3.147385  11.840321
7   3.212777  12.433191
8   3.235528  12.802486
9   3.287274  13.116555
10  3.320096  13.419134
11  3.469859  14.059496 
2024-09-02 13:31:29 INFO     Standard deviation: 
         MAE      RMSE
0   0.029591  0.297059
1   0.030717  0.189167
2   0.074914  0.079148
3   0.093635  0.140465
4   0.089605  0.162797
5   0.097098  0.287817
6   0.072416  0.385164
7   0.061602  0.449784
8   0.075152  0.460080
9   0.094014  0.467372
10  0.084251  0.429436
11  0.083454  0.449259
2024-09-02 13:31:29 INFO     ----------------------------------------------------------------------------
2024-09-02 13:31:29 INFO     12 steps Average: 
        MAE       RMSE
0  3.013714  11.090404
2024-09-02 13:31:29 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.073871  0.316462
