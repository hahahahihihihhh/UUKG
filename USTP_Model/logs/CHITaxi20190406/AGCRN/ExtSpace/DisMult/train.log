2024-09-02 12:05:43 INFO     Saving logs in: ./logs/CHITaxi20190406\AGCRN\ExtSpace\DisMult
2024-09-02 12:05:43 INFO     ----------------------------------------------------------------------------
2024-09-02 12:05:43 INFO     # 0, Kownledge Graph Embedding: DisMult, Experiment ids: 20
2024-09-02 12:05:43 INFO     ----------------------------------------------------------------------------
2024-09-02 12:05:43 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=20
2024-09-02 12:05:43 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 20, 'embedding_model': 'DisMult', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 12:05:43 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 12:05:43 INFO     set_weight_link_or_dist: dist
2024-09-02 12:05:43 INFO     init_weight_inf_or_zero: inf
2024-09-02 12:05:43 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 12:05:43 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 12:05:43 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 12:05:43 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 12:05:45 INFO     Dataset created
2024-09-02 12:05:45 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 12:05:45 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 12:05:45 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 12:05:45 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 12:05:45 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 12:05:45 INFO     NormalScaler max: 3.24777238294538
2024-09-02 12:05:49 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 12:05:49 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 12:05:49 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 12:05:49 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 12:05:49 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 12:05:49 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 12:05:49 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 12:05:49 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 12:05:49 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 12:05:49 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 12:05:49 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 12:05:49 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 12:05:49 INFO     Total parameter numbers: 874010
2024-09-02 12:05:49 INFO     You select `adam` optimizer.
2024-09-02 12:05:49 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 12:05:49 INFO     Start training ...
2024-09-02 12:05:49 INFO     num_batches:48
2024-09-02 12:05:57 INFO     epoch complete!
2024-09-02 12:05:57 INFO     evaluating now!
2024-09-02 12:05:57 INFO     Epoch [0/200] train_loss: 25.7085, val_loss: 18.7546, lr: 0.003000, 7.96s
2024-09-02 12:05:57 INFO     Saved model at 0
2024-09-02 12:05:57 INFO     Val loss decrease from inf to 18.7546, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 12:06:02 INFO     epoch complete!
2024-09-02 12:06:02 INFO     evaluating now!
2024-09-02 12:06:02 INFO     Epoch [1/200] train_loss: 15.7469, val_loss: 15.6905, lr: 0.003000, 5.15s
2024-09-02 12:06:02 INFO     Saved model at 1
2024-09-02 12:06:02 INFO     Val loss decrease from 18.7546 to 15.6905, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 12:06:07 INFO     epoch complete!
2024-09-02 12:06:07 INFO     evaluating now!
2024-09-02 12:06:07 INFO     Epoch [2/200] train_loss: 13.1879, val_loss: 12.9903, lr: 0.003000, 5.24s
2024-09-02 12:06:08 INFO     Saved model at 2
2024-09-02 12:06:08 INFO     Val loss decrease from 15.6905 to 12.9903, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 12:06:12 INFO     epoch complete!
2024-09-02 12:06:12 INFO     evaluating now!
2024-09-02 12:06:13 INFO     Epoch [3/200] train_loss: 10.8805, val_loss: 10.4493, lr: 0.003000, 5.09s
2024-09-02 12:06:13 INFO     Saved model at 3
2024-09-02 12:06:13 INFO     Val loss decrease from 12.9903 to 10.4493, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 12:06:17 INFO     epoch complete!
2024-09-02 12:06:17 INFO     evaluating now!
2024-09-02 12:06:18 INFO     Epoch [4/200] train_loss: 9.3797, val_loss: 9.4141, lr: 0.003000, 5.08s
2024-09-02 12:06:18 INFO     Saved model at 4
2024-09-02 12:06:18 INFO     Val loss decrease from 10.4493 to 9.4141, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 12:06:22 INFO     epoch complete!
2024-09-02 12:06:22 INFO     evaluating now!
2024-09-02 12:06:23 INFO     Epoch [5/200] train_loss: 8.1042, val_loss: 7.8384, lr: 0.003000, 5.08s
2024-09-02 12:06:23 INFO     Saved model at 5
2024-09-02 12:06:23 INFO     Val loss decrease from 9.4141 to 7.8384, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 12:06:28 INFO     epoch complete!
2024-09-02 12:06:28 INFO     evaluating now!
2024-09-02 12:06:28 INFO     Epoch [6/200] train_loss: 7.4195, val_loss: 7.4378, lr: 0.003000, 5.08s
2024-09-02 12:06:28 INFO     Saved model at 6
2024-09-02 12:06:28 INFO     Val loss decrease from 7.8384 to 7.4378, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 12:06:33 INFO     epoch complete!
2024-09-02 12:06:33 INFO     evaluating now!
2024-09-02 12:06:33 INFO     Epoch [7/200] train_loss: 6.8524, val_loss: 6.7941, lr: 0.003000, 5.08s
2024-09-02 12:06:33 INFO     Saved model at 7
2024-09-02 12:06:33 INFO     Val loss decrease from 7.4378 to 6.7941, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 12:06:38 INFO     epoch complete!
2024-09-02 12:06:38 INFO     evaluating now!
2024-09-02 12:06:38 INFO     Epoch [8/200] train_loss: 6.5449, val_loss: 6.6786, lr: 0.003000, 5.08s
2024-09-02 12:06:38 INFO     Saved model at 8
2024-09-02 12:06:38 INFO     Val loss decrease from 6.7941 to 6.6786, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 12:06:43 INFO     epoch complete!
2024-09-02 12:06:43 INFO     evaluating now!
2024-09-02 12:06:43 INFO     Epoch [9/200] train_loss: 6.1916, val_loss: 6.3532, lr: 0.003000, 5.09s
2024-09-02 12:06:43 INFO     Saved model at 9
2024-09-02 12:06:43 INFO     Val loss decrease from 6.6786 to 6.3532, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 12:06:48 INFO     epoch complete!
2024-09-02 12:06:48 INFO     evaluating now!
2024-09-02 12:06:48 INFO     Epoch [10/200] train_loss: 5.9726, val_loss: 6.2686, lr: 0.003000, 5.09s
2024-09-02 12:06:48 INFO     Saved model at 10
2024-09-02 12:06:48 INFO     Val loss decrease from 6.3532 to 6.2686, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 12:06:53 INFO     epoch complete!
2024-09-02 12:06:53 INFO     evaluating now!
2024-09-02 12:06:53 INFO     Epoch [11/200] train_loss: 5.7388, val_loss: 5.9178, lr: 0.003000, 5.09s
2024-09-02 12:06:53 INFO     Saved model at 11
2024-09-02 12:06:53 INFO     Val loss decrease from 6.2686 to 5.9178, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 12:06:58 INFO     epoch complete!
2024-09-02 12:06:58 INFO     evaluating now!
2024-09-02 12:06:58 INFO     Epoch [12/200] train_loss: 5.7495, val_loss: 6.2727, lr: 0.003000, 5.09s
2024-09-02 12:07:03 INFO     epoch complete!
2024-09-02 12:07:03 INFO     evaluating now!
2024-09-02 12:07:04 INFO     Epoch [13/200] train_loss: 5.5515, val_loss: 5.8747, lr: 0.003000, 5.09s
2024-09-02 12:07:04 INFO     Saved model at 13
2024-09-02 12:07:04 INFO     Val loss decrease from 5.9178 to 5.8747, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 12:07:08 INFO     epoch complete!
2024-09-02 12:07:08 INFO     evaluating now!
2024-09-02 12:07:09 INFO     Epoch [14/200] train_loss: 5.4448, val_loss: 6.0653, lr: 0.003000, 5.09s
2024-09-02 12:07:13 INFO     epoch complete!
2024-09-02 12:07:13 INFO     evaluating now!
2024-09-02 12:07:14 INFO     Epoch [15/200] train_loss: 5.3039, val_loss: 5.7370, lr: 0.003000, 5.08s
2024-09-02 12:07:14 INFO     Saved model at 15
2024-09-02 12:07:14 INFO     Val loss decrease from 5.8747 to 5.7370, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 12:07:19 INFO     epoch complete!
2024-09-02 12:07:19 INFO     evaluating now!
2024-09-02 12:07:19 INFO     Epoch [16/200] train_loss: 5.2779, val_loss: 5.5267, lr: 0.003000, 5.09s
2024-09-02 12:07:19 INFO     Saved model at 16
2024-09-02 12:07:19 INFO     Val loss decrease from 5.7370 to 5.5267, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 12:07:24 INFO     epoch complete!
2024-09-02 12:07:24 INFO     evaluating now!
2024-09-02 12:07:24 INFO     Epoch [17/200] train_loss: 5.2045, val_loss: 5.6181, lr: 0.003000, 5.09s
2024-09-02 12:07:29 INFO     epoch complete!
2024-09-02 12:07:29 INFO     evaluating now!
2024-09-02 12:07:29 INFO     Epoch [18/200] train_loss: 5.0183, val_loss: 5.3647, lr: 0.003000, 5.08s
2024-09-02 12:07:29 INFO     Saved model at 18
2024-09-02 12:07:29 INFO     Val loss decrease from 5.5267 to 5.3647, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-02 12:07:34 INFO     epoch complete!
2024-09-02 12:07:34 INFO     evaluating now!
2024-09-02 12:07:34 INFO     Epoch [19/200] train_loss: 5.0495, val_loss: 5.4048, lr: 0.003000, 5.09s
2024-09-02 12:07:39 INFO     epoch complete!
2024-09-02 12:07:39 INFO     evaluating now!
2024-09-02 12:07:39 INFO     Epoch [20/200] train_loss: 4.9667, val_loss: 5.6618, lr: 0.003000, 5.09s
2024-09-02 12:07:44 INFO     epoch complete!
2024-09-02 12:07:44 INFO     evaluating now!
2024-09-02 12:07:44 INFO     Epoch [21/200] train_loss: 4.8660, val_loss: 5.5188, lr: 0.003000, 5.08s
2024-09-02 12:07:49 INFO     epoch complete!
2024-09-02 12:07:49 INFO     evaluating now!
2024-09-02 12:07:49 INFO     Epoch [22/200] train_loss: 4.8038, val_loss: 5.4501, lr: 0.003000, 5.13s
2024-09-02 12:07:54 INFO     epoch complete!
2024-09-02 12:07:54 INFO     evaluating now!
2024-09-02 12:07:55 INFO     Epoch [23/200] train_loss: 4.7674, val_loss: 5.3719, lr: 0.003000, 5.10s
2024-09-02 12:07:59 INFO     epoch complete!
2024-09-02 12:07:59 INFO     evaluating now!
2024-09-02 12:08:00 INFO     Epoch [24/200] train_loss: 4.6780, val_loss: 5.4653, lr: 0.003000, 5.08s
2024-09-02 12:08:04 INFO     epoch complete!
2024-09-02 12:08:04 INFO     evaluating now!
2024-09-02 12:08:05 INFO     Epoch [25/200] train_loss: 4.5860, val_loss: 5.4961, lr: 0.003000, 5.07s
2024-09-02 12:08:09 INFO     epoch complete!
2024-09-02 12:08:09 INFO     evaluating now!
2024-09-02 12:08:10 INFO     Epoch [26/200] train_loss: 4.6275, val_loss: 5.3052, lr: 0.003000, 5.08s
2024-09-02 12:08:10 INFO     Saved model at 26
2024-09-02 12:08:10 INFO     Val loss decrease from 5.3647 to 5.3052, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-02 12:08:15 INFO     epoch complete!
2024-09-02 12:08:15 INFO     evaluating now!
2024-09-02 12:08:15 INFO     Epoch [27/200] train_loss: 4.5662, val_loss: 5.2759, lr: 0.003000, 5.08s
2024-09-02 12:08:15 INFO     Saved model at 27
2024-09-02 12:08:15 INFO     Val loss decrease from 5.3052 to 5.2759, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-02 12:08:20 INFO     epoch complete!
2024-09-02 12:08:20 INFO     evaluating now!
2024-09-02 12:08:20 INFO     Epoch [28/200] train_loss: 4.5829, val_loss: 5.1990, lr: 0.003000, 5.08s
2024-09-02 12:08:20 INFO     Saved model at 28
2024-09-02 12:08:20 INFO     Val loss decrease from 5.2759 to 5.1990, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-02 12:08:25 INFO     epoch complete!
2024-09-02 12:08:25 INFO     evaluating now!
2024-09-02 12:08:25 INFO     Epoch [29/200] train_loss: 4.5002, val_loss: 5.1893, lr: 0.003000, 5.07s
2024-09-02 12:08:25 INFO     Saved model at 29
2024-09-02 12:08:25 INFO     Val loss decrease from 5.1990 to 5.1893, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-02 12:08:30 INFO     epoch complete!
2024-09-02 12:08:30 INFO     evaluating now!
2024-09-02 12:08:30 INFO     Epoch [30/200] train_loss: 4.4667, val_loss: 5.2712, lr: 0.003000, 5.07s
2024-09-02 12:08:35 INFO     epoch complete!
2024-09-02 12:08:35 INFO     evaluating now!
2024-09-02 12:08:35 INFO     Epoch [31/200] train_loss: 4.3943, val_loss: 5.4718, lr: 0.003000, 5.07s
2024-09-02 12:08:40 INFO     epoch complete!
2024-09-02 12:08:40 INFO     evaluating now!
2024-09-02 12:08:40 INFO     Epoch [32/200] train_loss: 4.3125, val_loss: 5.0132, lr: 0.003000, 5.07s
2024-09-02 12:08:40 INFO     Saved model at 32
2024-09-02 12:08:40 INFO     Val loss decrease from 5.1893 to 5.0132, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-09-02 12:08:45 INFO     epoch complete!
2024-09-02 12:08:45 INFO     evaluating now!
2024-09-02 12:08:45 INFO     Epoch [33/200] train_loss: 4.3047, val_loss: 5.3130, lr: 0.003000, 5.07s
2024-09-02 12:08:50 INFO     epoch complete!
2024-09-02 12:08:50 INFO     evaluating now!
2024-09-02 12:08:50 INFO     Epoch [34/200] train_loss: 4.3598, val_loss: 5.4273, lr: 0.003000, 5.08s
2024-09-02 12:08:55 INFO     epoch complete!
2024-09-02 12:08:55 INFO     evaluating now!
2024-09-02 12:08:55 INFO     Epoch [35/200] train_loss: 4.2573, val_loss: 5.0801, lr: 0.003000, 5.07s
2024-09-02 12:09:00 INFO     epoch complete!
2024-09-02 12:09:00 INFO     evaluating now!
2024-09-02 12:09:01 INFO     Epoch [36/200] train_loss: 4.2558, val_loss: 5.0508, lr: 0.003000, 5.08s
2024-09-02 12:09:05 INFO     epoch complete!
2024-09-02 12:09:05 INFO     evaluating now!
2024-09-02 12:09:06 INFO     Epoch [37/200] train_loss: 4.2432, val_loss: 5.2566, lr: 0.003000, 5.07s
2024-09-02 12:09:10 INFO     epoch complete!
2024-09-02 12:09:10 INFO     evaluating now!
2024-09-02 12:09:11 INFO     Epoch [38/200] train_loss: 4.1963, val_loss: 5.1840, lr: 0.003000, 5.10s
2024-09-02 12:09:15 INFO     epoch complete!
2024-09-02 12:09:15 INFO     evaluating now!
2024-09-02 12:09:16 INFO     Epoch [39/200] train_loss: 4.1610, val_loss: 5.1875, lr: 0.003000, 5.08s
2024-09-02 12:09:21 INFO     epoch complete!
2024-09-02 12:09:21 INFO     evaluating now!
2024-09-02 12:09:21 INFO     Epoch [40/200] train_loss: 4.1083, val_loss: 5.2105, lr: 0.003000, 5.09s
2024-09-02 12:09:26 INFO     epoch complete!
2024-09-02 12:09:26 INFO     evaluating now!
2024-09-02 12:09:26 INFO     Epoch [41/200] train_loss: 4.0544, val_loss: 5.0442, lr: 0.003000, 5.08s
2024-09-02 12:09:31 INFO     epoch complete!
2024-09-02 12:09:31 INFO     evaluating now!
2024-09-02 12:09:31 INFO     Epoch [42/200] train_loss: 4.0446, val_loss: 5.1203, lr: 0.003000, 5.08s
2024-09-02 12:09:36 INFO     epoch complete!
2024-09-02 12:09:36 INFO     evaluating now!
2024-09-02 12:09:36 INFO     Epoch [43/200] train_loss: 3.9929, val_loss: 5.1209, lr: 0.003000, 5.07s
2024-09-02 12:09:41 INFO     epoch complete!
2024-09-02 12:09:41 INFO     evaluating now!
2024-09-02 12:09:41 INFO     Epoch [44/200] train_loss: 3.9678, val_loss: 5.2141, lr: 0.003000, 5.07s
2024-09-02 12:09:46 INFO     epoch complete!
2024-09-02 12:09:46 INFO     evaluating now!
2024-09-02 12:09:46 INFO     Epoch [45/200] train_loss: 3.9514, val_loss: 5.1084, lr: 0.003000, 5.07s
2024-09-02 12:09:51 INFO     epoch complete!
2024-09-02 12:09:51 INFO     evaluating now!
2024-09-02 12:09:51 INFO     Epoch [46/200] train_loss: 3.9997, val_loss: 5.1350, lr: 0.003000, 5.07s
2024-09-02 12:09:56 INFO     epoch complete!
2024-09-02 12:09:56 INFO     evaluating now!
2024-09-02 12:09:56 INFO     Epoch [47/200] train_loss: 3.9137, val_loss: 5.0704, lr: 0.003000, 5.07s
2024-09-02 12:09:56 WARNING  Early stopping at epoch: 47
2024-09-02 12:09:56 INFO     Trained totally 48 epochs, average train time is 4.837s, average eval time is 0.309s
2024-09-02 12:09:56 INFO     Loaded model at 32
2024-09-02 12:09:56 INFO     Saved model at ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 12:09:56 INFO     Start evaluating ...
2024-09-02 12:09:57 INFO     Note that you select the single mode to evaluate!
2024-09-02 12:09:57 INFO     Evaluate result is saved at ./libcity/cache/20/evaluate_cache\2024_09_02_12_09_57_AGCRN_CHITaxi20190406.csv
2024-09-02 12:09:57 INFO     
         MAE       RMSE
1   2.487185   7.532659
2   2.538490   7.884788
3   2.744748   8.779799
4   2.884775   9.476907
5   3.011355  10.213822
6   3.055418  10.822186
7   3.084836  11.451407
8   3.189431  12.087215
9   3.269289  12.543631
10  3.332110  12.909133
11  3.482468  13.392727
12  3.605720  14.149668
2024-09-02 12:09:57 INFO     ----------------------------------------------------------------------------
2024-09-02 12:09:57 INFO     # 1, Kownledge Graph Embedding: DisMult, Experiment ids: 21
2024-09-02 12:09:57 INFO     ----------------------------------------------------------------------------
2024-09-02 12:09:57 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=20
2024-09-02 12:09:57 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 20, 'embedding_model': 'DisMult', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 12:09:57 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 12:09:57 INFO     set_weight_link_or_dist: dist
2024-09-02 12:09:57 INFO     init_weight_inf_or_zero: inf
2024-09-02 12:09:57 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 12:09:57 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 12:09:57 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 12:09:58 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 12:09:59 INFO     Dataset created
2024-09-02 12:09:59 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 12:09:59 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 12:09:59 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 12:09:59 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 12:09:59 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 12:09:59 INFO     NormalScaler max: 3.24777238294538
2024-09-02 12:10:01 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 12:10:01 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 12:10:01 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 12:10:01 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 12:10:01 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 12:10:01 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 12:10:01 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 12:10:01 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 12:10:01 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 12:10:01 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 12:10:01 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 12:10:01 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 12:10:01 INFO     Total parameter numbers: 874010
2024-09-02 12:10:01 INFO     You select `adam` optimizer.
2024-09-02 12:10:01 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 12:10:01 INFO     Start training ...
2024-09-02 12:10:01 INFO     num_batches:48
2024-09-02 12:10:06 INFO     epoch complete!
2024-09-02 12:10:06 INFO     evaluating now!
2024-09-02 12:10:07 INFO     Epoch [0/200] train_loss: 24.0320, val_loss: 18.4214, lr: 0.003000, 5.22s
2024-09-02 12:10:07 INFO     Saved model at 0
2024-09-02 12:10:07 INFO     Val loss decrease from inf to 18.4214, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 12:10:11 INFO     epoch complete!
2024-09-02 12:10:11 INFO     evaluating now!
2024-09-02 12:10:12 INFO     Epoch [1/200] train_loss: 15.1577, val_loss: 14.6326, lr: 0.003000, 5.02s
2024-09-02 12:10:12 INFO     Saved model at 1
2024-09-02 12:10:12 INFO     Val loss decrease from 18.4214 to 14.6326, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 12:10:16 INFO     epoch complete!
2024-09-02 12:10:16 INFO     evaluating now!
2024-09-02 12:10:17 INFO     Epoch [2/200] train_loss: 12.5814, val_loss: 12.1791, lr: 0.003000, 5.03s
2024-09-02 12:10:17 INFO     Saved model at 2
2024-09-02 12:10:17 INFO     Val loss decrease from 14.6326 to 12.1791, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 12:10:21 INFO     epoch complete!
2024-09-02 12:10:21 INFO     evaluating now!
2024-09-02 12:10:22 INFO     Epoch [3/200] train_loss: 10.1853, val_loss: 9.7350, lr: 0.003000, 5.02s
2024-09-02 12:10:22 INFO     Saved model at 3
2024-09-02 12:10:22 INFO     Val loss decrease from 12.1791 to 9.7350, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 12:10:26 INFO     epoch complete!
2024-09-02 12:10:26 INFO     evaluating now!
2024-09-02 12:10:27 INFO     Epoch [4/200] train_loss: 8.6161, val_loss: 8.4006, lr: 0.003000, 5.03s
2024-09-02 12:10:27 INFO     Saved model at 4
2024-09-02 12:10:27 INFO     Val loss decrease from 9.7350 to 8.4006, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 12:10:31 INFO     epoch complete!
2024-09-02 12:10:31 INFO     evaluating now!
2024-09-02 12:10:32 INFO     Epoch [5/200] train_loss: 7.7455, val_loss: 7.7161, lr: 0.003000, 5.03s
2024-09-02 12:10:32 INFO     Saved model at 5
2024-09-02 12:10:32 INFO     Val loss decrease from 8.4006 to 7.7161, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 12:10:37 INFO     epoch complete!
2024-09-02 12:10:37 INFO     evaluating now!
2024-09-02 12:10:37 INFO     Epoch [6/200] train_loss: 7.2134, val_loss: 6.9622, lr: 0.003000, 5.02s
2024-09-02 12:10:37 INFO     Saved model at 6
2024-09-02 12:10:37 INFO     Val loss decrease from 7.7161 to 6.9622, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 12:10:42 INFO     epoch complete!
2024-09-02 12:10:42 INFO     evaluating now!
2024-09-02 12:10:42 INFO     Epoch [7/200] train_loss: 6.7716, val_loss: 6.9730, lr: 0.003000, 5.09s
2024-09-02 12:10:47 INFO     epoch complete!
2024-09-02 12:10:47 INFO     evaluating now!
2024-09-02 12:10:47 INFO     Epoch [8/200] train_loss: 6.3412, val_loss: 6.4768, lr: 0.003000, 5.03s
2024-09-02 12:10:47 INFO     Saved model at 8
2024-09-02 12:10:47 INFO     Val loss decrease from 6.9622 to 6.4768, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 12:10:52 INFO     epoch complete!
2024-09-02 12:10:52 INFO     evaluating now!
2024-09-02 12:10:52 INFO     Epoch [9/200] train_loss: 6.0692, val_loss: 6.1246, lr: 0.003000, 5.02s
2024-09-02 12:10:52 INFO     Saved model at 9
2024-09-02 12:10:52 INFO     Val loss decrease from 6.4768 to 6.1246, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 12:10:57 INFO     epoch complete!
2024-09-02 12:10:57 INFO     evaluating now!
2024-09-02 12:10:57 INFO     Epoch [10/200] train_loss: 5.8684, val_loss: 6.2321, lr: 0.003000, 5.02s
2024-09-02 12:11:02 INFO     epoch complete!
2024-09-02 12:11:02 INFO     evaluating now!
2024-09-02 12:11:02 INFO     Epoch [11/200] train_loss: 5.7746, val_loss: 5.9419, lr: 0.003000, 5.02s
2024-09-02 12:11:02 INFO     Saved model at 11
2024-09-02 12:11:02 INFO     Val loss decrease from 6.1246 to 5.9419, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 12:11:07 INFO     epoch complete!
2024-09-02 12:11:07 INFO     evaluating now!
2024-09-02 12:11:07 INFO     Epoch [12/200] train_loss: 5.6695, val_loss: 5.8352, lr: 0.003000, 5.02s
2024-09-02 12:11:07 INFO     Saved model at 12
2024-09-02 12:11:07 INFO     Val loss decrease from 5.9419 to 5.8352, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 12:11:12 INFO     epoch complete!
2024-09-02 12:11:12 INFO     evaluating now!
2024-09-02 12:11:12 INFO     Epoch [13/200] train_loss: 5.5071, val_loss: 5.7976, lr: 0.003000, 5.02s
2024-09-02 12:11:12 INFO     Saved model at 13
2024-09-02 12:11:12 INFO     Val loss decrease from 5.8352 to 5.7976, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 12:11:17 INFO     epoch complete!
2024-09-02 12:11:17 INFO     evaluating now!
2024-09-02 12:11:17 INFO     Epoch [14/200] train_loss: 5.4313, val_loss: 5.6723, lr: 0.003000, 5.01s
2024-09-02 12:11:17 INFO     Saved model at 14
2024-09-02 12:11:17 INFO     Val loss decrease from 5.7976 to 5.6723, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-02 12:11:22 INFO     epoch complete!
2024-09-02 12:11:22 INFO     evaluating now!
2024-09-02 12:11:22 INFO     Epoch [15/200] train_loss: 5.3175, val_loss: 5.8699, lr: 0.003000, 5.02s
2024-09-02 12:11:27 INFO     epoch complete!
2024-09-02 12:11:27 INFO     evaluating now!
2024-09-02 12:11:27 INFO     Epoch [16/200] train_loss: 5.1189, val_loss: 5.4130, lr: 0.003000, 5.03s
2024-09-02 12:11:27 INFO     Saved model at 16
2024-09-02 12:11:27 INFO     Val loss decrease from 5.6723 to 5.4130, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 12:11:32 INFO     epoch complete!
2024-09-02 12:11:32 INFO     evaluating now!
2024-09-02 12:11:32 INFO     Epoch [17/200] train_loss: 5.1010, val_loss: 5.5860, lr: 0.003000, 5.01s
2024-09-02 12:11:37 INFO     epoch complete!
2024-09-02 12:11:37 INFO     evaluating now!
2024-09-02 12:11:37 INFO     Epoch [18/200] train_loss: 4.9647, val_loss: 5.3708, lr: 0.003000, 5.02s
2024-09-02 12:11:37 INFO     Saved model at 18
2024-09-02 12:11:37 INFO     Val loss decrease from 5.4130 to 5.3708, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-02 12:11:42 INFO     epoch complete!
2024-09-02 12:11:42 INFO     evaluating now!
2024-09-02 12:11:42 INFO     Epoch [19/200] train_loss: 4.9008, val_loss: 5.5356, lr: 0.003000, 5.02s
2024-09-02 12:11:47 INFO     epoch complete!
2024-09-02 12:11:47 INFO     evaluating now!
2024-09-02 12:11:47 INFO     Epoch [20/200] train_loss: 4.9094, val_loss: 5.6091, lr: 0.003000, 5.02s
2024-09-02 12:11:52 INFO     epoch complete!
2024-09-02 12:11:52 INFO     evaluating now!
2024-09-02 12:11:52 INFO     Epoch [21/200] train_loss: 4.8180, val_loss: 5.3694, lr: 0.003000, 5.01s
2024-09-02 12:11:52 INFO     Saved model at 21
2024-09-02 12:11:52 INFO     Val loss decrease from 5.3708 to 5.3694, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-02 12:11:57 INFO     epoch complete!
2024-09-02 12:11:57 INFO     evaluating now!
2024-09-02 12:11:57 INFO     Epoch [22/200] train_loss: 4.7594, val_loss: 5.4424, lr: 0.003000, 5.02s
2024-09-02 12:12:02 INFO     epoch complete!
2024-09-02 12:12:02 INFO     evaluating now!
2024-09-02 12:12:02 INFO     Epoch [23/200] train_loss: 4.6183, val_loss: 5.4432, lr: 0.003000, 5.02s
2024-09-02 12:12:07 INFO     epoch complete!
2024-09-02 12:12:07 INFO     evaluating now!
2024-09-02 12:12:07 INFO     Epoch [24/200] train_loss: 4.6729, val_loss: 5.1852, lr: 0.003000, 5.03s
2024-09-02 12:12:07 INFO     Saved model at 24
2024-09-02 12:12:07 INFO     Val loss decrease from 5.3694 to 5.1852, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-02 12:12:12 INFO     epoch complete!
2024-09-02 12:12:12 INFO     evaluating now!
2024-09-02 12:12:12 INFO     Epoch [25/200] train_loss: 4.6190, val_loss: 5.3653, lr: 0.003000, 5.02s
2024-09-02 12:12:17 INFO     epoch complete!
2024-09-02 12:12:17 INFO     evaluating now!
2024-09-02 12:12:17 INFO     Epoch [26/200] train_loss: 4.5365, val_loss: 5.2077, lr: 0.003000, 5.02s
2024-09-02 12:12:22 INFO     epoch complete!
2024-09-02 12:12:22 INFO     evaluating now!
2024-09-02 12:12:22 INFO     Epoch [27/200] train_loss: 4.5093, val_loss: 5.3570, lr: 0.003000, 5.02s
2024-09-02 12:12:27 INFO     epoch complete!
2024-09-02 12:12:27 INFO     evaluating now!
2024-09-02 12:12:28 INFO     Epoch [28/200] train_loss: 4.4458, val_loss: 5.3175, lr: 0.003000, 5.03s
2024-09-02 12:12:32 INFO     epoch complete!
2024-09-02 12:12:32 INFO     evaluating now!
2024-09-02 12:12:33 INFO     Epoch [29/200] train_loss: 4.3672, val_loss: 5.1722, lr: 0.003000, 5.01s
2024-09-02 12:12:33 INFO     Saved model at 29
2024-09-02 12:12:33 INFO     Val loss decrease from 5.1852 to 5.1722, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-02 12:12:37 INFO     epoch complete!
2024-09-02 12:12:37 INFO     evaluating now!
2024-09-02 12:12:38 INFO     Epoch [30/200] train_loss: 4.3695, val_loss: 5.2887, lr: 0.003000, 5.02s
2024-09-02 12:12:42 INFO     epoch complete!
2024-09-02 12:12:42 INFO     evaluating now!
2024-09-02 12:12:43 INFO     Epoch [31/200] train_loss: 4.3081, val_loss: 5.1821, lr: 0.003000, 5.02s
2024-09-02 12:12:47 INFO     epoch complete!
2024-09-02 12:12:47 INFO     evaluating now!
2024-09-02 12:12:48 INFO     Epoch [32/200] train_loss: 4.3281, val_loss: 5.2017, lr: 0.003000, 5.02s
2024-09-02 12:12:52 INFO     epoch complete!
2024-09-02 12:12:52 INFO     evaluating now!
2024-09-02 12:12:53 INFO     Epoch [33/200] train_loss: 4.2852, val_loss: 5.1951, lr: 0.003000, 5.02s
2024-09-02 12:12:57 INFO     epoch complete!
2024-09-02 12:12:57 INFO     evaluating now!
2024-09-02 12:12:58 INFO     Epoch [34/200] train_loss: 4.4083, val_loss: 5.1765, lr: 0.003000, 5.02s
2024-09-02 12:13:02 INFO     epoch complete!
2024-09-02 12:13:02 INFO     evaluating now!
2024-09-02 12:13:03 INFO     Epoch [35/200] train_loss: 4.2437, val_loss: 5.0626, lr: 0.003000, 5.01s
2024-09-02 12:13:03 INFO     Saved model at 35
2024-09-02 12:13:03 INFO     Val loss decrease from 5.1722 to 5.0626, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-02 12:13:07 INFO     epoch complete!
2024-09-02 12:13:07 INFO     evaluating now!
2024-09-02 12:13:08 INFO     Epoch [36/200] train_loss: 4.1126, val_loss: 5.0396, lr: 0.003000, 5.01s
2024-09-02 12:13:08 INFO     Saved model at 36
2024-09-02 12:13:08 INFO     Val loss decrease from 5.0626 to 5.0396, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-09-02 12:13:12 INFO     epoch complete!
2024-09-02 12:13:12 INFO     evaluating now!
2024-09-02 12:13:13 INFO     Epoch [37/200] train_loss: 4.1576, val_loss: 5.0806, lr: 0.003000, 5.02s
2024-09-02 12:13:17 INFO     epoch complete!
2024-09-02 12:13:17 INFO     evaluating now!
2024-09-02 12:13:18 INFO     Epoch [38/200] train_loss: 4.1025, val_loss: 5.0752, lr: 0.003000, 5.01s
2024-09-02 12:13:22 INFO     epoch complete!
2024-09-02 12:13:22 INFO     evaluating now!
2024-09-02 12:13:23 INFO     Epoch [39/200] train_loss: 4.0189, val_loss: 5.1612, lr: 0.003000, 5.02s
2024-09-02 12:13:27 INFO     epoch complete!
2024-09-02 12:13:27 INFO     evaluating now!
2024-09-02 12:13:28 INFO     Epoch [40/200] train_loss: 3.9809, val_loss: 5.1099, lr: 0.003000, 5.02s
2024-09-02 12:13:32 INFO     epoch complete!
2024-09-02 12:13:32 INFO     evaluating now!
2024-09-02 12:13:33 INFO     Epoch [41/200] train_loss: 4.0061, val_loss: 5.0555, lr: 0.003000, 5.02s
2024-09-02 12:13:38 INFO     epoch complete!
2024-09-02 12:13:38 INFO     evaluating now!
2024-09-02 12:13:38 INFO     Epoch [42/200] train_loss: 3.9325, val_loss: 5.0719, lr: 0.003000, 5.02s
2024-09-02 12:13:43 INFO     epoch complete!
2024-09-02 12:13:43 INFO     evaluating now!
2024-09-02 12:13:43 INFO     Epoch [43/200] train_loss: 3.9090, val_loss: 5.2476, lr: 0.003000, 5.04s
2024-09-02 12:13:48 INFO     epoch complete!
2024-09-02 12:13:48 INFO     evaluating now!
2024-09-02 12:13:48 INFO     Epoch [44/200] train_loss: 4.0017, val_loss: 5.0671, lr: 0.003000, 5.02s
2024-09-02 12:13:53 INFO     epoch complete!
2024-09-02 12:13:53 INFO     evaluating now!
2024-09-02 12:13:53 INFO     Epoch [45/200] train_loss: 3.9292, val_loss: 5.0635, lr: 0.003000, 5.02s
2024-09-02 12:13:58 INFO     epoch complete!
2024-09-02 12:13:58 INFO     evaluating now!
2024-09-02 12:13:58 INFO     Epoch [46/200] train_loss: 3.8505, val_loss: 5.1467, lr: 0.003000, 5.02s
2024-09-02 12:14:03 INFO     epoch complete!
2024-09-02 12:14:03 INFO     evaluating now!
2024-09-02 12:14:03 INFO     Epoch [47/200] train_loss: 3.9051, val_loss: 5.1637, lr: 0.003000, 5.02s
2024-09-02 12:14:08 INFO     epoch complete!
2024-09-02 12:14:08 INFO     evaluating now!
2024-09-02 12:14:08 INFO     Epoch [48/200] train_loss: 3.8619, val_loss: 5.0565, lr: 0.003000, 5.01s
2024-09-02 12:14:13 INFO     epoch complete!
2024-09-02 12:14:13 INFO     evaluating now!
2024-09-02 12:14:13 INFO     Epoch [49/200] train_loss: 3.8282, val_loss: 4.9863, lr: 0.003000, 5.03s
2024-09-02 12:14:13 INFO     Saved model at 49
2024-09-02 12:14:13 INFO     Val loss decrease from 5.0396 to 4.9863, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-09-02 12:14:18 INFO     epoch complete!
2024-09-02 12:14:18 INFO     evaluating now!
2024-09-02 12:14:18 INFO     Epoch [50/200] train_loss: 3.7910, val_loss: 4.9866, lr: 0.003000, 5.02s
2024-09-02 12:14:23 INFO     epoch complete!
2024-09-02 12:14:23 INFO     evaluating now!
2024-09-02 12:14:23 INFO     Epoch [51/200] train_loss: 3.7599, val_loss: 5.0265, lr: 0.003000, 5.02s
2024-09-02 12:14:28 INFO     epoch complete!
2024-09-02 12:14:28 INFO     evaluating now!
2024-09-02 12:14:28 INFO     Epoch [52/200] train_loss: 3.7242, val_loss: 5.0632, lr: 0.003000, 5.02s
2024-09-02 12:14:33 INFO     epoch complete!
2024-09-02 12:14:33 INFO     evaluating now!
2024-09-02 12:14:33 INFO     Epoch [53/200] train_loss: 3.7111, val_loss: 4.9483, lr: 0.003000, 5.02s
2024-09-02 12:14:33 INFO     Saved model at 53
2024-09-02 12:14:33 INFO     Val loss decrease from 4.9863 to 4.9483, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch53.tar
2024-09-02 12:14:38 INFO     epoch complete!
2024-09-02 12:14:38 INFO     evaluating now!
2024-09-02 12:14:38 INFO     Epoch [54/200] train_loss: 3.7235, val_loss: 5.2003, lr: 0.003000, 5.02s
2024-09-02 12:14:43 INFO     epoch complete!
2024-09-02 12:14:43 INFO     evaluating now!
2024-09-02 12:14:43 INFO     Epoch [55/200] train_loss: 3.7347, val_loss: 5.1951, lr: 0.003000, 5.02s
2024-09-02 12:14:48 INFO     epoch complete!
2024-09-02 12:14:48 INFO     evaluating now!
2024-09-02 12:14:48 INFO     Epoch [56/200] train_loss: 3.6684, val_loss: 5.0646, lr: 0.003000, 5.02s
2024-09-02 12:14:53 INFO     epoch complete!
2024-09-02 12:14:53 INFO     evaluating now!
2024-09-02 12:14:53 INFO     Epoch [57/200] train_loss: 3.6272, val_loss: 5.0996, lr: 0.003000, 5.01s
2024-09-02 12:14:58 INFO     epoch complete!
2024-09-02 12:14:58 INFO     evaluating now!
2024-09-02 12:14:58 INFO     Epoch [58/200] train_loss: 3.6710, val_loss: 5.1541, lr: 0.003000, 5.01s
2024-09-02 12:15:03 INFO     epoch complete!
2024-09-02 12:15:03 INFO     evaluating now!
2024-09-02 12:15:03 INFO     Epoch [59/200] train_loss: 3.6585, val_loss: 5.0363, lr: 0.003000, 5.02s
2024-09-02 12:15:08 INFO     epoch complete!
2024-09-02 12:15:08 INFO     evaluating now!
2024-09-02 12:15:08 INFO     Epoch [60/200] train_loss: 3.5927, val_loss: 4.9956, lr: 0.003000, 5.02s
2024-09-02 12:15:13 INFO     epoch complete!
2024-09-02 12:15:13 INFO     evaluating now!
2024-09-02 12:15:13 INFO     Epoch [61/200] train_loss: 3.5706, val_loss: 4.9995, lr: 0.003000, 5.02s
2024-09-02 12:15:18 INFO     epoch complete!
2024-09-02 12:15:18 INFO     evaluating now!
2024-09-02 12:15:18 INFO     Epoch [62/200] train_loss: 3.5738, val_loss: 4.9923, lr: 0.003000, 5.01s
2024-09-02 12:15:23 INFO     epoch complete!
2024-09-02 12:15:23 INFO     evaluating now!
2024-09-02 12:15:23 INFO     Epoch [63/200] train_loss: 3.6166, val_loss: 5.0420, lr: 0.003000, 5.02s
2024-09-02 12:15:28 INFO     epoch complete!
2024-09-02 12:15:28 INFO     evaluating now!
2024-09-02 12:15:28 INFO     Epoch [64/200] train_loss: 3.5441, val_loss: 4.9653, lr: 0.003000, 5.01s
2024-09-02 12:15:33 INFO     epoch complete!
2024-09-02 12:15:33 INFO     evaluating now!
2024-09-02 12:15:33 INFO     Epoch [65/200] train_loss: 3.5117, val_loss: 5.0099, lr: 0.003000, 5.02s
2024-09-02 12:15:38 INFO     epoch complete!
2024-09-02 12:15:38 INFO     evaluating now!
2024-09-02 12:15:38 INFO     Epoch [66/200] train_loss: 3.5213, val_loss: 5.0416, lr: 0.003000, 5.01s
2024-09-02 12:15:43 INFO     epoch complete!
2024-09-02 12:15:43 INFO     evaluating now!
2024-09-02 12:15:43 INFO     Epoch [67/200] train_loss: 3.5602, val_loss: 5.0950, lr: 0.003000, 5.02s
2024-09-02 12:15:48 INFO     epoch complete!
2024-09-02 12:15:48 INFO     evaluating now!
2024-09-02 12:15:48 INFO     Epoch [68/200] train_loss: 3.5495, val_loss: 4.9763, lr: 0.003000, 5.02s
2024-09-02 12:15:48 WARNING  Early stopping at epoch: 68
2024-09-02 12:15:48 INFO     Trained totally 69 epochs, average train time is 4.726s, average eval time is 0.298s
2024-09-02 12:15:48 INFO     Loaded model at 53
2024-09-02 12:15:48 INFO     Saved model at ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 12:15:48 INFO     Start evaluating ...
2024-09-02 12:15:49 INFO     Note that you select the single mode to evaluate!
2024-09-02 12:15:49 INFO     Evaluate result is saved at ./libcity/cache/20/evaluate_cache\2024_09_02_12_15_49_AGCRN_CHITaxi20190406.csv
2024-09-02 12:15:49 INFO     
         MAE       RMSE
1   2.249922   6.724389
2   2.418488   7.411291
3   2.636632   8.596221
4   2.844827   9.782258
5   2.978780  11.138572
6   3.143227  12.537740
7   3.236814  13.628476
8   3.333498  14.118182
9   3.359190  14.241926
10  3.395688  14.381598
11  3.502396  14.528084
12  3.593757  14.995095
2024-09-02 12:15:49 INFO     ----------------------------------------------------------------------------
2024-09-02 12:15:49 INFO     # 2, Kownledge Graph Embedding: DisMult, Experiment ids: 22
2024-09-02 12:15:49 INFO     ----------------------------------------------------------------------------
2024-09-02 12:15:49 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=20
2024-09-02 12:15:49 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 20, 'embedding_model': 'DisMult', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 12:15:49 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 12:15:49 INFO     set_weight_link_or_dist: dist
2024-09-02 12:15:49 INFO     init_weight_inf_or_zero: inf
2024-09-02 12:15:49 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 12:15:49 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 12:15:49 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 12:15:50 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 12:15:51 INFO     Dataset created
2024-09-02 12:15:51 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 12:15:51 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 12:15:51 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 12:15:51 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 12:15:51 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 12:15:51 INFO     NormalScaler max: 3.24777238294538
2024-09-02 12:15:53 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 12:15:53 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 12:15:53 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 12:15:53 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 12:15:53 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 12:15:53 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 12:15:53 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 12:15:53 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 12:15:53 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 12:15:53 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 12:15:53 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 12:15:53 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 12:15:53 INFO     Total parameter numbers: 874010
2024-09-02 12:15:53 INFO     You select `adam` optimizer.
2024-09-02 12:15:53 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 12:15:53 INFO     Start training ...
2024-09-02 12:15:53 INFO     num_batches:48
2024-09-02 12:15:58 INFO     epoch complete!
2024-09-02 12:15:58 INFO     evaluating now!
2024-09-02 12:15:58 INFO     Epoch [0/200] train_loss: 24.5997, val_loss: 18.5790, lr: 0.003000, 5.27s
2024-09-02 12:15:58 INFO     Saved model at 0
2024-09-02 12:15:58 INFO     Val loss decrease from inf to 18.5790, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 12:16:03 INFO     epoch complete!
2024-09-02 12:16:03 INFO     evaluating now!
2024-09-02 12:16:03 INFO     Epoch [1/200] train_loss: 15.5373, val_loss: 15.2480, lr: 0.003000, 5.02s
2024-09-02 12:16:04 INFO     Saved model at 1
2024-09-02 12:16:04 INFO     Val loss decrease from 18.5790 to 15.2480, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 12:16:08 INFO     epoch complete!
2024-09-02 12:16:08 INFO     evaluating now!
2024-09-02 12:16:09 INFO     Epoch [2/200] train_loss: 12.4735, val_loss: 12.3123, lr: 0.003000, 5.02s
2024-09-02 12:16:09 INFO     Saved model at 2
2024-09-02 12:16:09 INFO     Val loss decrease from 15.2480 to 12.3123, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 12:16:13 INFO     epoch complete!
2024-09-02 12:16:13 INFO     evaluating now!
2024-09-02 12:16:14 INFO     Epoch [3/200] train_loss: 10.1534, val_loss: 9.9414, lr: 0.003000, 5.01s
2024-09-02 12:16:14 INFO     Saved model at 3
2024-09-02 12:16:14 INFO     Val loss decrease from 12.3123 to 9.9414, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 12:16:18 INFO     epoch complete!
2024-09-02 12:16:18 INFO     evaluating now!
2024-09-02 12:16:19 INFO     Epoch [4/200] train_loss: 8.7482, val_loss: 8.2459, lr: 0.003000, 5.02s
2024-09-02 12:16:19 INFO     Saved model at 4
2024-09-02 12:16:19 INFO     Val loss decrease from 9.9414 to 8.2459, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 12:16:23 INFO     epoch complete!
2024-09-02 12:16:23 INFO     evaluating now!
2024-09-02 12:16:24 INFO     Epoch [5/200] train_loss: 7.8908, val_loss: 7.8111, lr: 0.003000, 5.02s
2024-09-02 12:16:24 INFO     Saved model at 5
2024-09-02 12:16:24 INFO     Val loss decrease from 8.2459 to 7.8111, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 12:16:28 INFO     epoch complete!
2024-09-02 12:16:28 INFO     evaluating now!
2024-09-02 12:16:29 INFO     Epoch [6/200] train_loss: 7.3151, val_loss: 7.1033, lr: 0.003000, 5.01s
2024-09-02 12:16:29 INFO     Saved model at 6
2024-09-02 12:16:29 INFO     Val loss decrease from 7.8111 to 7.1033, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 12:16:33 INFO     epoch complete!
2024-09-02 12:16:33 INFO     evaluating now!
2024-09-02 12:16:34 INFO     Epoch [7/200] train_loss: 6.9366, val_loss: 7.4847, lr: 0.003000, 5.02s
2024-09-02 12:16:38 INFO     epoch complete!
2024-09-02 12:16:38 INFO     evaluating now!
2024-09-02 12:16:39 INFO     Epoch [8/200] train_loss: 6.5589, val_loss: 6.7722, lr: 0.003000, 5.02s
2024-09-02 12:16:39 INFO     Saved model at 8
2024-09-02 12:16:39 INFO     Val loss decrease from 7.1033 to 6.7722, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 12:16:43 INFO     epoch complete!
2024-09-02 12:16:43 INFO     evaluating now!
2024-09-02 12:16:44 INFO     Epoch [9/200] train_loss: 6.2776, val_loss: 6.2136, lr: 0.003000, 5.02s
2024-09-02 12:16:44 INFO     Saved model at 9
2024-09-02 12:16:44 INFO     Val loss decrease from 6.7722 to 6.2136, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 12:16:48 INFO     epoch complete!
2024-09-02 12:16:48 INFO     evaluating now!
2024-09-02 12:16:49 INFO     Epoch [10/200] train_loss: 6.0834, val_loss: 6.2451, lr: 0.003000, 5.02s
2024-09-02 12:16:53 INFO     epoch complete!
2024-09-02 12:16:53 INFO     evaluating now!
2024-09-02 12:16:54 INFO     Epoch [11/200] train_loss: 5.9156, val_loss: 6.1179, lr: 0.003000, 5.02s
2024-09-02 12:16:54 INFO     Saved model at 11
2024-09-02 12:16:54 INFO     Val loss decrease from 6.2136 to 6.1179, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 12:16:59 INFO     epoch complete!
2024-09-02 12:16:59 INFO     evaluating now!
2024-09-02 12:16:59 INFO     Epoch [12/200] train_loss: 5.8179, val_loss: 5.7829, lr: 0.003000, 5.02s
2024-09-02 12:16:59 INFO     Saved model at 12
2024-09-02 12:16:59 INFO     Val loss decrease from 6.1179 to 5.7829, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 12:17:04 INFO     epoch complete!
2024-09-02 12:17:04 INFO     evaluating now!
2024-09-02 12:17:04 INFO     Epoch [13/200] train_loss: 5.5928, val_loss: 5.9454, lr: 0.003000, 5.02s
2024-09-02 12:17:09 INFO     epoch complete!
2024-09-02 12:17:09 INFO     evaluating now!
2024-09-02 12:17:09 INFO     Epoch [14/200] train_loss: 5.4302, val_loss: 5.8326, lr: 0.003000, 5.02s
2024-09-02 12:17:14 INFO     epoch complete!
2024-09-02 12:17:14 INFO     evaluating now!
2024-09-02 12:17:14 INFO     Epoch [15/200] train_loss: 5.4249, val_loss: 5.7032, lr: 0.003000, 5.02s
2024-09-02 12:17:14 INFO     Saved model at 15
2024-09-02 12:17:14 INFO     Val loss decrease from 5.7829 to 5.7032, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 12:17:19 INFO     epoch complete!
2024-09-02 12:17:19 INFO     evaluating now!
2024-09-02 12:17:19 INFO     Epoch [16/200] train_loss: 5.1892, val_loss: 5.6869, lr: 0.003000, 5.02s
2024-09-02 12:17:19 INFO     Saved model at 16
2024-09-02 12:17:19 INFO     Val loss decrease from 5.7032 to 5.6869, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 12:17:24 INFO     epoch complete!
2024-09-02 12:17:24 INFO     evaluating now!
2024-09-02 12:17:24 INFO     Epoch [17/200] train_loss: 5.1855, val_loss: 5.6099, lr: 0.003000, 5.02s
2024-09-02 12:17:24 INFO     Saved model at 17
2024-09-02 12:17:24 INFO     Val loss decrease from 5.6869 to 5.6099, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-02 12:17:29 INFO     epoch complete!
2024-09-02 12:17:29 INFO     evaluating now!
2024-09-02 12:17:29 INFO     Epoch [18/200] train_loss: 5.1631, val_loss: 5.6970, lr: 0.003000, 5.02s
2024-09-02 12:17:34 INFO     epoch complete!
2024-09-02 12:17:34 INFO     evaluating now!
2024-09-02 12:17:34 INFO     Epoch [19/200] train_loss: 4.9894, val_loss: 5.5654, lr: 0.003000, 5.02s
2024-09-02 12:17:34 INFO     Saved model at 19
2024-09-02 12:17:34 INFO     Val loss decrease from 5.6099 to 5.5654, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-02 12:17:39 INFO     epoch complete!
2024-09-02 12:17:39 INFO     evaluating now!
2024-09-02 12:17:39 INFO     Epoch [20/200] train_loss: 4.8656, val_loss: 5.5584, lr: 0.003000, 5.02s
2024-09-02 12:17:39 INFO     Saved model at 20
2024-09-02 12:17:39 INFO     Val loss decrease from 5.5654 to 5.5584, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-02 12:17:44 INFO     epoch complete!
2024-09-02 12:17:44 INFO     evaluating now!
2024-09-02 12:17:44 INFO     Epoch [21/200] train_loss: 4.8019, val_loss: 5.4493, lr: 0.003000, 5.03s
2024-09-02 12:17:44 INFO     Saved model at 21
2024-09-02 12:17:44 INFO     Val loss decrease from 5.5584 to 5.4493, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-02 12:17:49 INFO     epoch complete!
2024-09-02 12:17:49 INFO     evaluating now!
2024-09-02 12:17:49 INFO     Epoch [22/200] train_loss: 4.7316, val_loss: 5.4898, lr: 0.003000, 5.02s
2024-09-02 12:17:54 INFO     epoch complete!
2024-09-02 12:17:54 INFO     evaluating now!
2024-09-02 12:17:54 INFO     Epoch [23/200] train_loss: 4.8337, val_loss: 5.4068, lr: 0.003000, 5.02s
2024-09-02 12:17:54 INFO     Saved model at 23
2024-09-02 12:17:54 INFO     Val loss decrease from 5.4493 to 5.4068, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-02 12:17:59 INFO     epoch complete!
2024-09-02 12:17:59 INFO     evaluating now!
2024-09-02 12:17:59 INFO     Epoch [24/200] train_loss: 4.8103, val_loss: 5.2190, lr: 0.003000, 5.02s
2024-09-02 12:17:59 INFO     Saved model at 24
2024-09-02 12:17:59 INFO     Val loss decrease from 5.4068 to 5.2190, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-02 12:18:04 INFO     epoch complete!
2024-09-02 12:18:04 INFO     evaluating now!
2024-09-02 12:18:04 INFO     Epoch [25/200] train_loss: 4.6638, val_loss: 5.4162, lr: 0.003000, 5.02s
2024-09-02 12:18:09 INFO     epoch complete!
2024-09-02 12:18:09 INFO     evaluating now!
2024-09-02 12:18:09 INFO     Epoch [26/200] train_loss: 4.5896, val_loss: 5.1659, lr: 0.003000, 5.01s
2024-09-02 12:18:09 INFO     Saved model at 26
2024-09-02 12:18:09 INFO     Val loss decrease from 5.2190 to 5.1659, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-02 12:18:14 INFO     epoch complete!
2024-09-02 12:18:14 INFO     evaluating now!
2024-09-02 12:18:14 INFO     Epoch [27/200] train_loss: 4.5553, val_loss: 5.3946, lr: 0.003000, 5.02s
2024-09-02 12:18:19 INFO     epoch complete!
2024-09-02 12:18:19 INFO     evaluating now!
2024-09-02 12:18:19 INFO     Epoch [28/200] train_loss: 4.4335, val_loss: 5.4889, lr: 0.003000, 5.03s
2024-09-02 12:18:24 INFO     epoch complete!
2024-09-02 12:18:24 INFO     evaluating now!
2024-09-02 12:18:24 INFO     Epoch [29/200] train_loss: 4.4376, val_loss: 5.3895, lr: 0.003000, 5.01s
2024-09-02 12:18:29 INFO     epoch complete!
2024-09-02 12:18:29 INFO     evaluating now!
2024-09-02 12:18:29 INFO     Epoch [30/200] train_loss: 4.4457, val_loss: 5.2181, lr: 0.003000, 5.01s
2024-09-02 12:18:34 INFO     epoch complete!
2024-09-02 12:18:34 INFO     evaluating now!
2024-09-02 12:18:34 INFO     Epoch [31/200] train_loss: 4.3632, val_loss: 5.2144, lr: 0.003000, 5.02s
2024-09-02 12:18:39 INFO     epoch complete!
2024-09-02 12:18:39 INFO     evaluating now!
2024-09-02 12:18:39 INFO     Epoch [32/200] train_loss: 4.3556, val_loss: 5.1162, lr: 0.003000, 5.02s
2024-09-02 12:18:39 INFO     Saved model at 32
2024-09-02 12:18:39 INFO     Val loss decrease from 5.1659 to 5.1162, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-09-02 12:18:44 INFO     epoch complete!
2024-09-02 12:18:44 INFO     evaluating now!
2024-09-02 12:18:44 INFO     Epoch [33/200] train_loss: 4.2498, val_loss: 5.1796, lr: 0.003000, 5.02s
2024-09-02 12:18:49 INFO     epoch complete!
2024-09-02 12:18:49 INFO     evaluating now!
2024-09-02 12:18:49 INFO     Epoch [34/200] train_loss: 4.2603, val_loss: 5.3443, lr: 0.003000, 5.02s
2024-09-02 12:18:54 INFO     epoch complete!
2024-09-02 12:18:54 INFO     evaluating now!
2024-09-02 12:18:54 INFO     Epoch [35/200] train_loss: 4.1973, val_loss: 5.1520, lr: 0.003000, 5.01s
2024-09-02 12:18:59 INFO     epoch complete!
2024-09-02 12:18:59 INFO     evaluating now!
2024-09-02 12:18:59 INFO     Epoch [36/200] train_loss: 4.1933, val_loss: 5.0451, lr: 0.003000, 5.01s
2024-09-02 12:18:59 INFO     Saved model at 36
2024-09-02 12:18:59 INFO     Val loss decrease from 5.1162 to 5.0451, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-09-02 12:19:04 INFO     epoch complete!
2024-09-02 12:19:04 INFO     evaluating now!
2024-09-02 12:19:04 INFO     Epoch [37/200] train_loss: 4.1580, val_loss: 5.0795, lr: 0.003000, 5.02s
2024-09-02 12:19:09 INFO     epoch complete!
2024-09-02 12:19:09 INFO     evaluating now!
2024-09-02 12:19:09 INFO     Epoch [38/200] train_loss: 4.0990, val_loss: 5.1652, lr: 0.003000, 5.02s
2024-09-02 12:19:14 INFO     epoch complete!
2024-09-02 12:19:14 INFO     evaluating now!
2024-09-02 12:19:14 INFO     Epoch [39/200] train_loss: 4.0374, val_loss: 5.2339, lr: 0.003000, 5.02s
2024-09-02 12:19:19 INFO     epoch complete!
2024-09-02 12:19:19 INFO     evaluating now!
2024-09-02 12:19:19 INFO     Epoch [40/200] train_loss: 4.0333, val_loss: 5.1591, lr: 0.003000, 5.02s
2024-09-02 12:19:24 INFO     epoch complete!
2024-09-02 12:19:24 INFO     evaluating now!
2024-09-02 12:19:25 INFO     Epoch [41/200] train_loss: 4.0204, val_loss: 5.1229, lr: 0.003000, 5.02s
2024-09-02 12:19:29 INFO     epoch complete!
2024-09-02 12:19:29 INFO     evaluating now!
2024-09-02 12:19:30 INFO     Epoch [42/200] train_loss: 3.9802, val_loss: 5.1413, lr: 0.003000, 5.02s
2024-09-02 12:19:34 INFO     epoch complete!
2024-09-02 12:19:34 INFO     evaluating now!
2024-09-02 12:19:35 INFO     Epoch [43/200] train_loss: 3.9545, val_loss: 5.1969, lr: 0.003000, 5.02s
2024-09-02 12:19:39 INFO     epoch complete!
2024-09-02 12:19:39 INFO     evaluating now!
2024-09-02 12:19:40 INFO     Epoch [44/200] train_loss: 3.9947, val_loss: 5.1078, lr: 0.003000, 5.03s
2024-09-02 12:19:44 INFO     epoch complete!
2024-09-02 12:19:44 INFO     evaluating now!
2024-09-02 12:19:45 INFO     Epoch [45/200] train_loss: 3.9276, val_loss: 5.0622, lr: 0.003000, 5.02s
2024-09-02 12:19:49 INFO     epoch complete!
2024-09-02 12:19:49 INFO     evaluating now!
2024-09-02 12:19:50 INFO     Epoch [46/200] train_loss: 3.8643, val_loss: 5.1806, lr: 0.003000, 5.02s
2024-09-02 12:19:54 INFO     epoch complete!
2024-09-02 12:19:54 INFO     evaluating now!
2024-09-02 12:19:55 INFO     Epoch [47/200] train_loss: 3.8874, val_loss: 5.2515, lr: 0.003000, 5.02s
2024-09-02 12:19:59 INFO     epoch complete!
2024-09-02 12:19:59 INFO     evaluating now!
2024-09-02 12:20:00 INFO     Epoch [48/200] train_loss: 3.9168, val_loss: 5.3556, lr: 0.003000, 5.01s
2024-09-02 12:20:04 INFO     epoch complete!
2024-09-02 12:20:04 INFO     evaluating now!
2024-09-02 12:20:05 INFO     Epoch [49/200] train_loss: 3.8773, val_loss: 5.0387, lr: 0.003000, 5.02s
2024-09-02 12:20:05 INFO     Saved model at 49
2024-09-02 12:20:05 INFO     Val loss decrease from 5.0451 to 5.0387, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-09-02 12:20:09 INFO     epoch complete!
2024-09-02 12:20:09 INFO     evaluating now!
2024-09-02 12:20:10 INFO     Epoch [50/200] train_loss: 3.8220, val_loss: 5.2795, lr: 0.003000, 5.02s
2024-09-02 12:20:14 INFO     epoch complete!
2024-09-02 12:20:14 INFO     evaluating now!
2024-09-02 12:20:15 INFO     Epoch [51/200] train_loss: 3.8424, val_loss: 4.9625, lr: 0.003000, 5.03s
2024-09-02 12:20:15 INFO     Saved model at 51
2024-09-02 12:20:15 INFO     Val loss decrease from 5.0387 to 4.9625, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-09-02 12:20:19 INFO     epoch complete!
2024-09-02 12:20:19 INFO     evaluating now!
2024-09-02 12:20:20 INFO     Epoch [52/200] train_loss: 3.7312, val_loss: 5.0447, lr: 0.003000, 5.02s
2024-09-02 12:20:24 INFO     epoch complete!
2024-09-02 12:20:24 INFO     evaluating now!
2024-09-02 12:20:25 INFO     Epoch [53/200] train_loss: 3.7311, val_loss: 4.9278, lr: 0.003000, 5.03s
2024-09-02 12:20:25 INFO     Saved model at 53
2024-09-02 12:20:25 INFO     Val loss decrease from 4.9625 to 4.9278, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch53.tar
2024-09-02 12:20:30 INFO     epoch complete!
2024-09-02 12:20:30 INFO     evaluating now!
2024-09-02 12:20:30 INFO     Epoch [54/200] train_loss: 3.7223, val_loss: 5.0962, lr: 0.003000, 5.01s
2024-09-02 12:20:35 INFO     epoch complete!
2024-09-02 12:20:35 INFO     evaluating now!
2024-09-02 12:20:35 INFO     Epoch [55/200] train_loss: 3.7997, val_loss: 5.2758, lr: 0.003000, 5.02s
2024-09-02 12:20:40 INFO     epoch complete!
2024-09-02 12:20:40 INFO     evaluating now!
2024-09-02 12:20:40 INFO     Epoch [56/200] train_loss: 3.7461, val_loss: 5.1230, lr: 0.003000, 5.03s
2024-09-02 12:20:45 INFO     epoch complete!
2024-09-02 12:20:45 INFO     evaluating now!
2024-09-02 12:20:45 INFO     Epoch [57/200] train_loss: 3.6988, val_loss: 5.0526, lr: 0.003000, 5.02s
2024-09-02 12:20:50 INFO     epoch complete!
2024-09-02 12:20:50 INFO     evaluating now!
2024-09-02 12:20:50 INFO     Epoch [58/200] train_loss: 3.6434, val_loss: 5.0049, lr: 0.003000, 5.02s
2024-09-02 12:20:55 INFO     epoch complete!
2024-09-02 12:20:55 INFO     evaluating now!
2024-09-02 12:20:55 INFO     Epoch [59/200] train_loss: 3.6470, val_loss: 5.1443, lr: 0.003000, 5.02s
2024-09-02 12:21:00 INFO     epoch complete!
2024-09-02 12:21:00 INFO     evaluating now!
2024-09-02 12:21:00 INFO     Epoch [60/200] train_loss: 3.6120, val_loss: 5.1061, lr: 0.003000, 5.02s
2024-09-02 12:21:05 INFO     epoch complete!
2024-09-02 12:21:05 INFO     evaluating now!
2024-09-02 12:21:05 INFO     Epoch [61/200] train_loss: 3.6362, val_loss: 5.1655, lr: 0.003000, 5.02s
2024-09-02 12:21:10 INFO     epoch complete!
2024-09-02 12:21:10 INFO     evaluating now!
2024-09-02 12:21:10 INFO     Epoch [62/200] train_loss: 3.6393, val_loss: 5.0551, lr: 0.003000, 5.02s
2024-09-02 12:21:15 INFO     epoch complete!
2024-09-02 12:21:15 INFO     evaluating now!
2024-09-02 12:21:15 INFO     Epoch [63/200] train_loss: 3.5410, val_loss: 5.0737, lr: 0.003000, 5.03s
2024-09-02 12:21:20 INFO     epoch complete!
2024-09-02 12:21:20 INFO     evaluating now!
2024-09-02 12:21:20 INFO     Epoch [64/200] train_loss: 3.5732, val_loss: 5.1466, lr: 0.003000, 5.02s
2024-09-02 12:21:25 INFO     epoch complete!
2024-09-02 12:21:25 INFO     evaluating now!
2024-09-02 12:21:25 INFO     Epoch [65/200] train_loss: 3.5224, val_loss: 5.0118, lr: 0.003000, 5.02s
2024-09-02 12:21:30 INFO     epoch complete!
2024-09-02 12:21:30 INFO     evaluating now!
2024-09-02 12:21:30 INFO     Epoch [66/200] train_loss: 3.5231, val_loss: 5.0102, lr: 0.003000, 5.02s
2024-09-02 12:21:35 INFO     epoch complete!
2024-09-02 12:21:35 INFO     evaluating now!
2024-09-02 12:21:35 INFO     Epoch [67/200] train_loss: 3.5691, val_loss: 5.0679, lr: 0.003000, 5.03s
2024-09-02 12:21:40 INFO     epoch complete!
2024-09-02 12:21:40 INFO     evaluating now!
2024-09-02 12:21:40 INFO     Epoch [68/200] train_loss: 3.4883, val_loss: 5.0149, lr: 0.003000, 5.04s
2024-09-02 12:21:40 WARNING  Early stopping at epoch: 68
2024-09-02 12:21:40 INFO     Trained totally 69 epochs, average train time is 4.724s, average eval time is 0.298s
2024-09-02 12:21:40 INFO     Loaded model at 53
2024-09-02 12:21:40 INFO     Saved model at ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 12:21:40 INFO     Start evaluating ...
2024-09-02 12:21:41 INFO     Note that you select the single mode to evaluate!
2024-09-02 12:21:41 INFO     Evaluate result is saved at ./libcity/cache/20/evaluate_cache\2024_09_02_12_21_41_AGCRN_CHITaxi20190406.csv
2024-09-02 12:21:41 INFO     
         MAE       RMSE
1   2.342885   6.939168
2   2.456613   7.676067
3   2.705842   8.935184
4   2.943296   9.911568
5   3.070471  10.825136
6   3.144729  11.550644
7   3.217691  12.012784
8   3.273207  12.330169
9   3.254294  12.666962
10  3.295409  13.076498
11  3.413966  13.644264
12  3.510928  14.342842
2024-09-02 12:21:41 INFO     ----------------------------------------------------------------------------
2024-09-02 12:21:41 INFO     # 3, Kownledge Graph Embedding: DisMult, Experiment ids: 23
2024-09-02 12:21:41 INFO     ----------------------------------------------------------------------------
2024-09-02 12:21:41 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=20
2024-09-02 12:21:41 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 20, 'embedding_model': 'DisMult', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 12:21:41 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 12:21:41 INFO     set_weight_link_or_dist: dist
2024-09-02 12:21:41 INFO     init_weight_inf_or_zero: inf
2024-09-02 12:21:41 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 12:21:41 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 12:21:41 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 12:21:41 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 12:21:43 INFO     Dataset created
2024-09-02 12:21:43 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 12:21:43 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 12:21:43 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 12:21:43 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 12:21:43 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 12:21:43 INFO     NormalScaler max: 3.24777238294538
2024-09-02 12:21:45 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 12:21:45 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 12:21:45 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 12:21:45 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 12:21:45 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 12:21:45 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 12:21:45 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 12:21:45 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 12:21:45 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 12:21:45 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 12:21:45 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 12:21:45 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 12:21:45 INFO     Total parameter numbers: 874010
2024-09-02 12:21:45 INFO     You select `adam` optimizer.
2024-09-02 12:21:45 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 12:21:45 INFO     Start training ...
2024-09-02 12:21:45 INFO     num_batches:48
2024-09-02 12:21:50 INFO     epoch complete!
2024-09-02 12:21:50 INFO     evaluating now!
2024-09-02 12:21:50 INFO     Epoch [0/200] train_loss: 24.5233, val_loss: 18.9374, lr: 0.003000, 5.31s
2024-09-02 12:21:50 INFO     Saved model at 0
2024-09-02 12:21:50 INFO     Val loss decrease from inf to 18.9374, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 12:21:55 INFO     epoch complete!
2024-09-02 12:21:55 INFO     evaluating now!
2024-09-02 12:21:55 INFO     Epoch [1/200] train_loss: 15.3077, val_loss: 14.5765, lr: 0.003000, 5.03s
2024-09-02 12:21:55 INFO     Saved model at 1
2024-09-02 12:21:55 INFO     Val loss decrease from 18.9374 to 14.5765, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 12:22:00 INFO     epoch complete!
2024-09-02 12:22:00 INFO     evaluating now!
2024-09-02 12:22:00 INFO     Epoch [2/200] train_loss: 12.0603, val_loss: 11.7976, lr: 0.003000, 5.02s
2024-09-02 12:22:00 INFO     Saved model at 2
2024-09-02 12:22:00 INFO     Val loss decrease from 14.5765 to 11.7976, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 12:22:05 INFO     epoch complete!
2024-09-02 12:22:05 INFO     evaluating now!
2024-09-02 12:22:05 INFO     Epoch [3/200] train_loss: 10.2593, val_loss: 10.2804, lr: 0.003000, 5.04s
2024-09-02 12:22:05 INFO     Saved model at 3
2024-09-02 12:22:05 INFO     Val loss decrease from 11.7976 to 10.2804, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 12:22:10 INFO     epoch complete!
2024-09-02 12:22:10 INFO     evaluating now!
2024-09-02 12:22:10 INFO     Epoch [4/200] train_loss: 8.8160, val_loss: 8.7965, lr: 0.003000, 5.02s
2024-09-02 12:22:11 INFO     Saved model at 4
2024-09-02 12:22:11 INFO     Val loss decrease from 10.2804 to 8.7965, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 12:22:15 INFO     epoch complete!
2024-09-02 12:22:15 INFO     evaluating now!
2024-09-02 12:22:16 INFO     Epoch [5/200] train_loss: 8.1811, val_loss: 7.6189, lr: 0.003000, 5.04s
2024-09-02 12:22:16 INFO     Saved model at 5
2024-09-02 12:22:16 INFO     Val loss decrease from 8.7965 to 7.6189, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 12:22:20 INFO     epoch complete!
2024-09-02 12:22:20 INFO     evaluating now!
2024-09-02 12:22:21 INFO     Epoch [6/200] train_loss: 7.2978, val_loss: 7.0449, lr: 0.003000, 5.04s
2024-09-02 12:22:21 INFO     Saved model at 6
2024-09-02 12:22:21 INFO     Val loss decrease from 7.6189 to 7.0449, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 12:22:25 INFO     epoch complete!
2024-09-02 12:22:25 INFO     evaluating now!
2024-09-02 12:22:26 INFO     Epoch [7/200] train_loss: 6.8372, val_loss: 6.7991, lr: 0.003000, 5.05s
2024-09-02 12:22:26 INFO     Saved model at 7
2024-09-02 12:22:26 INFO     Val loss decrease from 7.0449 to 6.7991, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 12:22:30 INFO     epoch complete!
2024-09-02 12:22:30 INFO     evaluating now!
2024-09-02 12:22:31 INFO     Epoch [8/200] train_loss: 6.4509, val_loss: 6.5947, lr: 0.003000, 5.04s
2024-09-02 12:22:31 INFO     Saved model at 8
2024-09-02 12:22:31 INFO     Val loss decrease from 6.7991 to 6.5947, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 12:22:35 INFO     epoch complete!
2024-09-02 12:22:35 INFO     evaluating now!
2024-09-02 12:22:36 INFO     Epoch [9/200] train_loss: 6.1495, val_loss: 6.4709, lr: 0.003000, 5.04s
2024-09-02 12:22:36 INFO     Saved model at 9
2024-09-02 12:22:36 INFO     Val loss decrease from 6.5947 to 6.4709, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 12:22:41 INFO     epoch complete!
2024-09-02 12:22:41 INFO     evaluating now!
2024-09-02 12:22:41 INFO     Epoch [10/200] train_loss: 5.9425, val_loss: 6.2288, lr: 0.003000, 5.05s
2024-09-02 12:22:41 INFO     Saved model at 10
2024-09-02 12:22:41 INFO     Val loss decrease from 6.4709 to 6.2288, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 12:22:46 INFO     epoch complete!
2024-09-02 12:22:46 INFO     evaluating now!
2024-09-02 12:22:46 INFO     Epoch [11/200] train_loss: 5.9663, val_loss: 6.4358, lr: 0.003000, 5.05s
2024-09-02 12:22:51 INFO     epoch complete!
2024-09-02 12:22:51 INFO     evaluating now!
2024-09-02 12:22:51 INFO     Epoch [12/200] train_loss: 5.6129, val_loss: 6.0430, lr: 0.003000, 5.04s
2024-09-02 12:22:51 INFO     Saved model at 12
2024-09-02 12:22:51 INFO     Val loss decrease from 6.2288 to 6.0430, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 12:22:56 INFO     epoch complete!
2024-09-02 12:22:56 INFO     evaluating now!
2024-09-02 12:22:56 INFO     Epoch [13/200] train_loss: 5.6397, val_loss: 5.9300, lr: 0.003000, 5.05s
2024-09-02 12:22:56 INFO     Saved model at 13
2024-09-02 12:22:56 INFO     Val loss decrease from 6.0430 to 5.9300, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 12:23:01 INFO     epoch complete!
2024-09-02 12:23:01 INFO     evaluating now!
2024-09-02 12:23:01 INFO     Epoch [14/200] train_loss: 5.4232, val_loss: 5.8671, lr: 0.003000, 5.04s
2024-09-02 12:23:01 INFO     Saved model at 14
2024-09-02 12:23:01 INFO     Val loss decrease from 5.9300 to 5.8671, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-02 12:23:06 INFO     epoch complete!
2024-09-02 12:23:06 INFO     evaluating now!
2024-09-02 12:23:06 INFO     Epoch [15/200] train_loss: 5.3501, val_loss: 5.6502, lr: 0.003000, 5.05s
2024-09-02 12:23:06 INFO     Saved model at 15
2024-09-02 12:23:06 INFO     Val loss decrease from 5.8671 to 5.6502, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 12:23:11 INFO     epoch complete!
2024-09-02 12:23:11 INFO     evaluating now!
2024-09-02 12:23:11 INFO     Epoch [16/200] train_loss: 5.1877, val_loss: 5.6856, lr: 0.003000, 5.05s
2024-09-02 12:23:16 INFO     epoch complete!
2024-09-02 12:23:16 INFO     evaluating now!
2024-09-02 12:23:16 INFO     Epoch [17/200] train_loss: 5.0649, val_loss: 5.5125, lr: 0.003000, 5.04s
2024-09-02 12:23:16 INFO     Saved model at 17
2024-09-02 12:23:16 INFO     Val loss decrease from 5.6502 to 5.5125, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-02 12:23:21 INFO     epoch complete!
2024-09-02 12:23:21 INFO     evaluating now!
2024-09-02 12:23:21 INFO     Epoch [18/200] train_loss: 5.0073, val_loss: 5.5335, lr: 0.003000, 5.06s
2024-09-02 12:23:26 INFO     epoch complete!
2024-09-02 12:23:26 INFO     evaluating now!
2024-09-02 12:23:26 INFO     Epoch [19/200] train_loss: 5.1123, val_loss: 5.5563, lr: 0.003000, 5.04s
2024-09-02 12:23:31 INFO     epoch complete!
2024-09-02 12:23:31 INFO     evaluating now!
2024-09-02 12:23:31 INFO     Epoch [20/200] train_loss: 5.0029, val_loss: 5.3964, lr: 0.003000, 5.05s
2024-09-02 12:23:31 INFO     Saved model at 20
2024-09-02 12:23:31 INFO     Val loss decrease from 5.5125 to 5.3964, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-02 12:23:36 INFO     epoch complete!
2024-09-02 12:23:36 INFO     evaluating now!
2024-09-02 12:23:36 INFO     Epoch [21/200] train_loss: 4.7952, val_loss: 5.1800, lr: 0.003000, 5.04s
2024-09-02 12:23:36 INFO     Saved model at 21
2024-09-02 12:23:36 INFO     Val loss decrease from 5.3964 to 5.1800, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-02 12:23:41 INFO     epoch complete!
2024-09-02 12:23:41 INFO     evaluating now!
2024-09-02 12:23:42 INFO     Epoch [22/200] train_loss: 4.7336, val_loss: 5.3289, lr: 0.003000, 5.05s
2024-09-02 12:23:46 INFO     epoch complete!
2024-09-02 12:23:46 INFO     evaluating now!
2024-09-02 12:23:47 INFO     Epoch [23/200] train_loss: 4.6803, val_loss: 5.1609, lr: 0.003000, 5.04s
2024-09-02 12:23:47 INFO     Saved model at 23
2024-09-02 12:23:47 INFO     Val loss decrease from 5.1800 to 5.1609, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-02 12:23:51 INFO     epoch complete!
2024-09-02 12:23:51 INFO     evaluating now!
2024-09-02 12:23:52 INFO     Epoch [24/200] train_loss: 4.6596, val_loss: 5.5596, lr: 0.003000, 5.05s
2024-09-02 12:23:56 INFO     epoch complete!
2024-09-02 12:23:56 INFO     evaluating now!
2024-09-02 12:23:57 INFO     Epoch [25/200] train_loss: 4.7143, val_loss: 5.3696, lr: 0.003000, 5.04s
2024-09-02 12:24:01 INFO     epoch complete!
2024-09-02 12:24:01 INFO     evaluating now!
2024-09-02 12:24:02 INFO     Epoch [26/200] train_loss: 4.6944, val_loss: 5.3326, lr: 0.003000, 5.05s
2024-09-02 12:24:06 INFO     epoch complete!
2024-09-02 12:24:06 INFO     evaluating now!
2024-09-02 12:24:07 INFO     Epoch [27/200] train_loss: 4.6166, val_loss: 5.2580, lr: 0.003000, 5.04s
2024-09-02 12:24:11 INFO     epoch complete!
2024-09-02 12:24:11 INFO     evaluating now!
2024-09-02 12:24:12 INFO     Epoch [28/200] train_loss: 4.5733, val_loss: 5.2676, lr: 0.003000, 5.04s
2024-09-02 12:24:17 INFO     epoch complete!
2024-09-02 12:24:17 INFO     evaluating now!
2024-09-02 12:24:17 INFO     Epoch [29/200] train_loss: 4.5154, val_loss: 5.1246, lr: 0.003000, 5.04s
2024-09-02 12:24:17 INFO     Saved model at 29
2024-09-02 12:24:17 INFO     Val loss decrease from 5.1609 to 5.1246, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-02 12:24:22 INFO     epoch complete!
2024-09-02 12:24:22 INFO     evaluating now!
2024-09-02 12:24:22 INFO     Epoch [30/200] train_loss: 4.4203, val_loss: 5.1227, lr: 0.003000, 5.04s
2024-09-02 12:24:22 INFO     Saved model at 30
2024-09-02 12:24:22 INFO     Val loss decrease from 5.1246 to 5.1227, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-09-02 12:24:27 INFO     epoch complete!
2024-09-02 12:24:27 INFO     evaluating now!
2024-09-02 12:24:27 INFO     Epoch [31/200] train_loss: 4.3829, val_loss: 5.1931, lr: 0.003000, 5.05s
2024-09-02 12:24:32 INFO     epoch complete!
2024-09-02 12:24:32 INFO     evaluating now!
2024-09-02 12:24:32 INFO     Epoch [32/200] train_loss: 4.3350, val_loss: 5.1535, lr: 0.003000, 5.04s
2024-09-02 12:24:37 INFO     epoch complete!
2024-09-02 12:24:37 INFO     evaluating now!
2024-09-02 12:24:37 INFO     Epoch [33/200] train_loss: 4.2464, val_loss: 5.2003, lr: 0.003000, 5.05s
2024-09-02 12:24:42 INFO     epoch complete!
2024-09-02 12:24:42 INFO     evaluating now!
2024-09-02 12:24:42 INFO     Epoch [34/200] train_loss: 4.2380, val_loss: 5.1509, lr: 0.003000, 5.04s
2024-09-02 12:24:47 INFO     epoch complete!
2024-09-02 12:24:47 INFO     evaluating now!
2024-09-02 12:24:47 INFO     Epoch [35/200] train_loss: 4.2277, val_loss: 5.0167, lr: 0.003000, 5.04s
2024-09-02 12:24:47 INFO     Saved model at 35
2024-09-02 12:24:47 INFO     Val loss decrease from 5.1227 to 5.0167, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-02 12:24:52 INFO     epoch complete!
2024-09-02 12:24:52 INFO     evaluating now!
2024-09-02 12:24:52 INFO     Epoch [36/200] train_loss: 4.1916, val_loss: 5.1684, lr: 0.003000, 5.04s
2024-09-02 12:24:57 INFO     epoch complete!
2024-09-02 12:24:57 INFO     evaluating now!
2024-09-02 12:24:57 INFO     Epoch [37/200] train_loss: 4.2060, val_loss: 5.0552, lr: 0.003000, 5.04s
2024-09-02 12:25:02 INFO     epoch complete!
2024-09-02 12:25:02 INFO     evaluating now!
2024-09-02 12:25:02 INFO     Epoch [38/200] train_loss: 4.1383, val_loss: 5.0877, lr: 0.003000, 5.05s
2024-09-02 12:25:07 INFO     epoch complete!
2024-09-02 12:25:07 INFO     evaluating now!
2024-09-02 12:25:07 INFO     Epoch [39/200] train_loss: 4.1120, val_loss: 5.1276, lr: 0.003000, 5.04s
2024-09-02 12:25:12 INFO     epoch complete!
2024-09-02 12:25:12 INFO     evaluating now!
2024-09-02 12:25:12 INFO     Epoch [40/200] train_loss: 4.0905, val_loss: 5.0689, lr: 0.003000, 5.05s
2024-09-02 12:25:17 INFO     epoch complete!
2024-09-02 12:25:17 INFO     evaluating now!
2024-09-02 12:25:17 INFO     Epoch [41/200] train_loss: 4.0595, val_loss: 4.9300, lr: 0.003000, 5.04s
2024-09-02 12:25:17 INFO     Saved model at 41
2024-09-02 12:25:17 INFO     Val loss decrease from 5.0167 to 4.9300, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-09-02 12:25:22 INFO     epoch complete!
2024-09-02 12:25:22 INFO     evaluating now!
2024-09-02 12:25:22 INFO     Epoch [42/200] train_loss: 4.0784, val_loss: 5.0921, lr: 0.003000, 5.05s
2024-09-02 12:25:27 INFO     epoch complete!
2024-09-02 12:25:27 INFO     evaluating now!
2024-09-02 12:25:28 INFO     Epoch [43/200] train_loss: 4.0641, val_loss: 5.0254, lr: 0.003000, 5.05s
2024-09-02 12:25:32 INFO     epoch complete!
2024-09-02 12:25:32 INFO     evaluating now!
2024-09-02 12:25:33 INFO     Epoch [44/200] train_loss: 3.9992, val_loss: 4.9902, lr: 0.003000, 5.04s
2024-09-02 12:25:37 INFO     epoch complete!
2024-09-02 12:25:37 INFO     evaluating now!
2024-09-02 12:25:38 INFO     Epoch [45/200] train_loss: 3.9638, val_loss: 4.9060, lr: 0.003000, 5.04s
2024-09-02 12:25:38 INFO     Saved model at 45
2024-09-02 12:25:38 INFO     Val loss decrease from 4.9300 to 4.9060, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-09-02 12:25:42 INFO     epoch complete!
2024-09-02 12:25:42 INFO     evaluating now!
2024-09-02 12:25:43 INFO     Epoch [46/200] train_loss: 3.9133, val_loss: 5.0360, lr: 0.003000, 5.04s
2024-09-02 12:25:47 INFO     epoch complete!
2024-09-02 12:25:47 INFO     evaluating now!
2024-09-02 12:25:48 INFO     Epoch [47/200] train_loss: 3.9059, val_loss: 4.9934, lr: 0.003000, 5.05s
2024-09-02 12:25:52 INFO     epoch complete!
2024-09-02 12:25:52 INFO     evaluating now!
2024-09-02 12:25:53 INFO     Epoch [48/200] train_loss: 3.8538, val_loss: 4.9902, lr: 0.003000, 5.04s
2024-09-02 12:25:57 INFO     epoch complete!
2024-09-02 12:25:57 INFO     evaluating now!
2024-09-02 12:25:58 INFO     Epoch [49/200] train_loss: 3.8835, val_loss: 5.1325, lr: 0.003000, 5.04s
2024-09-02 12:26:03 INFO     epoch complete!
2024-09-02 12:26:03 INFO     evaluating now!
2024-09-02 12:26:03 INFO     Epoch [50/200] train_loss: 3.9004, val_loss: 5.1994, lr: 0.003000, 5.04s
2024-09-02 12:26:08 INFO     epoch complete!
2024-09-02 12:26:08 INFO     evaluating now!
2024-09-02 12:26:08 INFO     Epoch [51/200] train_loss: 3.8506, val_loss: 5.0992, lr: 0.003000, 5.04s
2024-09-02 12:26:13 INFO     epoch complete!
2024-09-02 12:26:13 INFO     evaluating now!
2024-09-02 12:26:13 INFO     Epoch [52/200] train_loss: 3.7507, val_loss: 4.9725, lr: 0.003000, 5.05s
2024-09-02 12:26:18 INFO     epoch complete!
2024-09-02 12:26:18 INFO     evaluating now!
2024-09-02 12:26:18 INFO     Epoch [53/200] train_loss: 3.8168, val_loss: 5.1894, lr: 0.003000, 5.04s
2024-09-02 12:26:23 INFO     epoch complete!
2024-09-02 12:26:23 INFO     evaluating now!
2024-09-02 12:26:23 INFO     Epoch [54/200] train_loss: 3.8633, val_loss: 5.0797, lr: 0.003000, 5.05s
2024-09-02 12:26:28 INFO     epoch complete!
2024-09-02 12:26:28 INFO     evaluating now!
2024-09-02 12:26:28 INFO     Epoch [55/200] train_loss: 3.8105, val_loss: 5.1165, lr: 0.003000, 5.04s
2024-09-02 12:26:33 INFO     epoch complete!
2024-09-02 12:26:33 INFO     evaluating now!
2024-09-02 12:26:33 INFO     Epoch [56/200] train_loss: 3.7484, val_loss: 4.8887, lr: 0.003000, 5.04s
2024-09-02 12:26:33 INFO     Saved model at 56
2024-09-02 12:26:33 INFO     Val loss decrease from 4.9060 to 4.8887, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch56.tar
2024-09-02 12:26:38 INFO     epoch complete!
2024-09-02 12:26:38 INFO     evaluating now!
2024-09-02 12:26:38 INFO     Epoch [57/200] train_loss: 3.7006, val_loss: 4.9712, lr: 0.003000, 5.04s
2024-09-02 12:26:43 INFO     epoch complete!
2024-09-02 12:26:43 INFO     evaluating now!
2024-09-02 12:26:43 INFO     Epoch [58/200] train_loss: 3.6476, val_loss: 5.0200, lr: 0.003000, 5.05s
2024-09-02 12:26:48 INFO     epoch complete!
2024-09-02 12:26:48 INFO     evaluating now!
2024-09-02 12:26:48 INFO     Epoch [59/200] train_loss: 3.6977, val_loss: 5.1027, lr: 0.003000, 5.04s
2024-09-02 12:26:53 INFO     epoch complete!
2024-09-02 12:26:53 INFO     evaluating now!
2024-09-02 12:26:53 INFO     Epoch [60/200] train_loss: 3.6559, val_loss: 4.9839, lr: 0.003000, 5.04s
2024-09-02 12:26:58 INFO     epoch complete!
2024-09-02 12:26:58 INFO     evaluating now!
2024-09-02 12:26:58 INFO     Epoch [61/200] train_loss: 3.6113, val_loss: 4.9885, lr: 0.003000, 5.04s
2024-09-02 12:27:03 INFO     epoch complete!
2024-09-02 12:27:03 INFO     evaluating now!
2024-09-02 12:27:03 INFO     Epoch [62/200] train_loss: 3.5818, val_loss: 4.8865, lr: 0.003000, 5.05s
2024-09-02 12:27:03 INFO     Saved model at 62
2024-09-02 12:27:03 INFO     Val loss decrease from 4.8887 to 4.8865, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch62.tar
2024-09-02 12:27:08 INFO     epoch complete!
2024-09-02 12:27:08 INFO     evaluating now!
2024-09-02 12:27:08 INFO     Epoch [63/200] train_loss: 3.6058, val_loss: 5.1452, lr: 0.003000, 5.05s
2024-09-02 12:27:13 INFO     epoch complete!
2024-09-02 12:27:13 INFO     evaluating now!
2024-09-02 12:27:13 INFO     Epoch [64/200] train_loss: 3.6258, val_loss: 4.9354, lr: 0.003000, 5.06s
2024-09-02 12:27:18 INFO     epoch complete!
2024-09-02 12:27:18 INFO     evaluating now!
2024-09-02 12:27:18 INFO     Epoch [65/200] train_loss: 3.5571, val_loss: 5.0678, lr: 0.003000, 5.04s
2024-09-02 12:27:23 INFO     epoch complete!
2024-09-02 12:27:23 INFO     evaluating now!
2024-09-02 12:27:24 INFO     Epoch [66/200] train_loss: 3.5374, val_loss: 4.9792, lr: 0.003000, 5.06s
2024-09-02 12:27:28 INFO     epoch complete!
2024-09-02 12:27:28 INFO     evaluating now!
2024-09-02 12:27:29 INFO     Epoch [67/200] train_loss: 3.5291, val_loss: 4.9831, lr: 0.003000, 5.04s
2024-09-02 12:27:33 INFO     epoch complete!
2024-09-02 12:27:33 INFO     evaluating now!
2024-09-02 12:27:34 INFO     Epoch [68/200] train_loss: 3.5307, val_loss: 4.9956, lr: 0.003000, 5.05s
2024-09-02 12:27:38 INFO     epoch complete!
2024-09-02 12:27:38 INFO     evaluating now!
2024-09-02 12:27:39 INFO     Epoch [69/200] train_loss: 3.5482, val_loss: 5.0160, lr: 0.003000, 5.04s
2024-09-02 12:27:43 INFO     epoch complete!
2024-09-02 12:27:43 INFO     evaluating now!
2024-09-02 12:27:44 INFO     Epoch [70/200] train_loss: 3.5286, val_loss: 4.9725, lr: 0.003000, 5.06s
2024-09-02 12:27:48 INFO     epoch complete!
2024-09-02 12:27:48 INFO     evaluating now!
2024-09-02 12:27:49 INFO     Epoch [71/200] train_loss: 3.4963, val_loss: 5.0935, lr: 0.003000, 5.05s
2024-09-02 12:27:54 INFO     epoch complete!
2024-09-02 12:27:54 INFO     evaluating now!
2024-09-02 12:27:54 INFO     Epoch [72/200] train_loss: 3.5166, val_loss: 5.1036, lr: 0.003000, 5.06s
2024-09-02 12:27:59 INFO     epoch complete!
2024-09-02 12:27:59 INFO     evaluating now!
2024-09-02 12:27:59 INFO     Epoch [73/200] train_loss: 3.5165, val_loss: 4.9685, lr: 0.003000, 5.05s
2024-09-02 12:28:04 INFO     epoch complete!
2024-09-02 12:28:04 INFO     evaluating now!
2024-09-02 12:28:04 INFO     Epoch [74/200] train_loss: 3.4938, val_loss: 5.1040, lr: 0.003000, 5.06s
2024-09-02 12:28:09 INFO     epoch complete!
2024-09-02 12:28:09 INFO     evaluating now!
2024-09-02 12:28:09 INFO     Epoch [75/200] train_loss: 3.5036, val_loss: 5.0489, lr: 0.003000, 5.04s
2024-09-02 12:28:14 INFO     epoch complete!
2024-09-02 12:28:14 INFO     evaluating now!
2024-09-02 12:28:14 INFO     Epoch [76/200] train_loss: 3.4707, val_loss: 5.0044, lr: 0.003000, 5.05s
2024-09-02 12:28:19 INFO     epoch complete!
2024-09-02 12:28:19 INFO     evaluating now!
2024-09-02 12:28:19 INFO     Epoch [77/200] train_loss: 3.4559, val_loss: 5.1073, lr: 0.003000, 5.04s
2024-09-02 12:28:19 WARNING  Early stopping at epoch: 77
2024-09-02 12:28:19 INFO     Trained totally 78 epochs, average train time is 4.746s, average eval time is 0.301s
2024-09-02 12:28:19 INFO     Loaded model at 62
2024-09-02 12:28:19 INFO     Saved model at ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 12:28:19 INFO     Start evaluating ...
2024-09-02 12:28:20 INFO     Note that you select the single mode to evaluate!
2024-09-02 12:28:20 INFO     Evaluate result is saved at ./libcity/cache/20/evaluate_cache\2024_09_02_12_28_20_AGCRN_CHITaxi20190406.csv
2024-09-02 12:28:20 INFO     
         MAE       RMSE
1   2.391931   7.030985
2   2.533803   7.633179
3   2.776568   8.793577
4   2.914129   9.830321
5   2.940277  11.002944
6   3.189320  12.067000
7   3.212697  12.966304
8   3.331231  13.425138
9   3.503666  13.675250
10  3.538148  13.823544
11  3.525620  13.920090
12  3.593011  14.133966
2024-09-02 12:28:20 INFO     ----------------------------------------------------------------------------
2024-09-02 12:28:20 INFO     # 4, Kownledge Graph Embedding: DisMult, Experiment ids: 24
2024-09-02 12:28:20 INFO     ----------------------------------------------------------------------------
2024-09-02 12:28:20 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=20
2024-09-02 12:28:20 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 20, 'embedding_model': 'DisMult', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 12:28:20 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 12:28:20 INFO     set_weight_link_or_dist: dist
2024-09-02 12:28:20 INFO     init_weight_inf_or_zero: inf
2024-09-02 12:28:20 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 12:28:20 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 12:28:20 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 12:28:20 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 12:28:22 INFO     Dataset created
2024-09-02 12:28:22 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 12:28:22 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 12:28:22 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 12:28:22 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 12:28:22 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 12:28:22 INFO     NormalScaler max: 3.24777238294538
2024-09-02 12:28:24 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 12:28:24 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 12:28:24 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 12:28:24 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 12:28:24 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 12:28:24 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 12:28:24 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 12:28:24 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 12:28:24 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 12:28:24 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 12:28:24 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 12:28:24 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 12:28:24 INFO     Total parameter numbers: 874010
2024-09-02 12:28:24 INFO     You select `adam` optimizer.
2024-09-02 12:28:24 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 12:28:24 INFO     Start training ...
2024-09-02 12:28:24 INFO     num_batches:48
2024-09-02 12:28:29 INFO     epoch complete!
2024-09-02 12:28:29 INFO     evaluating now!
2024-09-02 12:28:29 INFO     Epoch [0/200] train_loss: 23.8673, val_loss: 18.7149, lr: 0.003000, 5.28s
2024-09-02 12:28:29 INFO     Saved model at 0
2024-09-02 12:28:29 INFO     Val loss decrease from inf to 18.7149, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 12:28:34 INFO     epoch complete!
2024-09-02 12:28:34 INFO     evaluating now!
2024-09-02 12:28:34 INFO     Epoch [1/200] train_loss: 15.2202, val_loss: 14.6107, lr: 0.003000, 5.04s
2024-09-02 12:28:34 INFO     Saved model at 1
2024-09-02 12:28:34 INFO     Val loss decrease from 18.7149 to 14.6107, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 12:28:39 INFO     epoch complete!
2024-09-02 12:28:39 INFO     evaluating now!
2024-09-02 12:28:39 INFO     Epoch [2/200] train_loss: 12.4346, val_loss: 12.1098, lr: 0.003000, 5.05s
2024-09-02 12:28:39 INFO     Saved model at 2
2024-09-02 12:28:39 INFO     Val loss decrease from 14.6107 to 12.1098, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 12:28:44 INFO     epoch complete!
2024-09-02 12:28:44 INFO     evaluating now!
2024-09-02 12:28:44 INFO     Epoch [3/200] train_loss: 10.1966, val_loss: 9.9078, lr: 0.003000, 5.04s
2024-09-02 12:28:44 INFO     Saved model at 3
2024-09-02 12:28:44 INFO     Val loss decrease from 12.1098 to 9.9078, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 12:28:49 INFO     epoch complete!
2024-09-02 12:28:49 INFO     evaluating now!
2024-09-02 12:28:49 INFO     Epoch [4/200] train_loss: 8.7990, val_loss: 8.6174, lr: 0.003000, 5.06s
2024-09-02 12:28:50 INFO     Saved model at 4
2024-09-02 12:28:50 INFO     Val loss decrease from 9.9078 to 8.6174, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 12:28:54 INFO     epoch complete!
2024-09-02 12:28:54 INFO     evaluating now!
2024-09-02 12:28:55 INFO     Epoch [5/200] train_loss: 7.8419, val_loss: 7.8086, lr: 0.003000, 5.06s
2024-09-02 12:28:55 INFO     Saved model at 5
2024-09-02 12:28:55 INFO     Val loss decrease from 8.6174 to 7.8086, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 12:28:59 INFO     epoch complete!
2024-09-02 12:28:59 INFO     evaluating now!
2024-09-02 12:29:00 INFO     Epoch [6/200] train_loss: 7.2985, val_loss: 7.0824, lr: 0.003000, 5.06s
2024-09-02 12:29:00 INFO     Saved model at 6
2024-09-02 12:29:00 INFO     Val loss decrease from 7.8086 to 7.0824, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 12:29:04 INFO     epoch complete!
2024-09-02 12:29:04 INFO     evaluating now!
2024-09-02 12:29:05 INFO     Epoch [7/200] train_loss: 6.8211, val_loss: 6.6575, lr: 0.003000, 5.05s
2024-09-02 12:29:05 INFO     Saved model at 7
2024-09-02 12:29:05 INFO     Val loss decrease from 7.0824 to 6.6575, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 12:29:10 INFO     epoch complete!
2024-09-02 12:29:10 INFO     evaluating now!
2024-09-02 12:29:10 INFO     Epoch [8/200] train_loss: 6.4786, val_loss: 6.4568, lr: 0.003000, 5.09s
2024-09-02 12:29:10 INFO     Saved model at 8
2024-09-02 12:29:10 INFO     Val loss decrease from 6.6575 to 6.4568, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 12:29:15 INFO     epoch complete!
2024-09-02 12:29:15 INFO     evaluating now!
2024-09-02 12:29:15 INFO     Epoch [9/200] train_loss: 6.3079, val_loss: 6.5398, lr: 0.003000, 5.06s
2024-09-02 12:29:20 INFO     epoch complete!
2024-09-02 12:29:20 INFO     evaluating now!
2024-09-02 12:29:20 INFO     Epoch [10/200] train_loss: 6.0652, val_loss: 6.1533, lr: 0.003000, 5.06s
2024-09-02 12:29:20 INFO     Saved model at 10
2024-09-02 12:29:20 INFO     Val loss decrease from 6.4568 to 6.1533, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 12:29:25 INFO     epoch complete!
2024-09-02 12:29:25 INFO     evaluating now!
2024-09-02 12:29:25 INFO     Epoch [11/200] train_loss: 5.8345, val_loss: 6.0378, lr: 0.003000, 5.06s
2024-09-02 12:29:25 INFO     Saved model at 11
2024-09-02 12:29:25 INFO     Val loss decrease from 6.1533 to 6.0378, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 12:29:30 INFO     epoch complete!
2024-09-02 12:29:30 INFO     evaluating now!
2024-09-02 12:29:30 INFO     Epoch [12/200] train_loss: 5.6433, val_loss: 5.9055, lr: 0.003000, 5.06s
2024-09-02 12:29:30 INFO     Saved model at 12
2024-09-02 12:29:30 INFO     Val loss decrease from 6.0378 to 5.9055, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 12:29:35 INFO     epoch complete!
2024-09-02 12:29:35 INFO     evaluating now!
2024-09-02 12:29:35 INFO     Epoch [13/200] train_loss: 5.5515, val_loss: 5.7415, lr: 0.003000, 5.06s
2024-09-02 12:29:35 INFO     Saved model at 13
2024-09-02 12:29:35 INFO     Val loss decrease from 5.9055 to 5.7415, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 12:29:40 INFO     epoch complete!
2024-09-02 12:29:40 INFO     evaluating now!
2024-09-02 12:29:40 INFO     Epoch [14/200] train_loss: 5.4341, val_loss: 5.6107, lr: 0.003000, 5.06s
2024-09-02 12:29:40 INFO     Saved model at 14
2024-09-02 12:29:40 INFO     Val loss decrease from 5.7415 to 5.6107, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-02 12:29:45 INFO     epoch complete!
2024-09-02 12:29:45 INFO     evaluating now!
2024-09-02 12:29:45 INFO     Epoch [15/200] train_loss: 5.2426, val_loss: 5.5430, lr: 0.003000, 5.06s
2024-09-02 12:29:45 INFO     Saved model at 15
2024-09-02 12:29:45 INFO     Val loss decrease from 5.6107 to 5.5430, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 12:29:50 INFO     epoch complete!
2024-09-02 12:29:50 INFO     evaluating now!
2024-09-02 12:29:50 INFO     Epoch [16/200] train_loss: 5.2964, val_loss: 5.3936, lr: 0.003000, 5.05s
2024-09-02 12:29:50 INFO     Saved model at 16
2024-09-02 12:29:50 INFO     Val loss decrease from 5.5430 to 5.3936, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 12:29:55 INFO     epoch complete!
2024-09-02 12:29:55 INFO     evaluating now!
2024-09-02 12:29:55 INFO     Epoch [17/200] train_loss: 5.1673, val_loss: 5.5289, lr: 0.003000, 5.06s
2024-09-02 12:30:00 INFO     epoch complete!
2024-09-02 12:30:00 INFO     evaluating now!
2024-09-02 12:30:00 INFO     Epoch [18/200] train_loss: 5.1731, val_loss: 5.4438, lr: 0.003000, 5.06s
2024-09-02 12:30:05 INFO     epoch complete!
2024-09-02 12:30:05 INFO     evaluating now!
2024-09-02 12:30:06 INFO     Epoch [19/200] train_loss: 4.9701, val_loss: 5.3802, lr: 0.003000, 5.06s
2024-09-02 12:30:06 INFO     Saved model at 19
2024-09-02 12:30:06 INFO     Val loss decrease from 5.3936 to 5.3802, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-02 12:30:10 INFO     epoch complete!
2024-09-02 12:30:10 INFO     evaluating now!
2024-09-02 12:30:11 INFO     Epoch [20/200] train_loss: 4.9551, val_loss: 5.3969, lr: 0.003000, 5.07s
2024-09-02 12:30:15 INFO     epoch complete!
2024-09-02 12:30:15 INFO     evaluating now!
2024-09-02 12:30:16 INFO     Epoch [21/200] train_loss: 4.8788, val_loss: 5.1727, lr: 0.003000, 5.05s
2024-09-02 12:30:16 INFO     Saved model at 21
2024-09-02 12:30:16 INFO     Val loss decrease from 5.3802 to 5.1727, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-02 12:30:20 INFO     epoch complete!
2024-09-02 12:30:20 INFO     evaluating now!
2024-09-02 12:30:21 INFO     Epoch [22/200] train_loss: 4.7516, val_loss: 5.3131, lr: 0.003000, 5.06s
2024-09-02 12:30:26 INFO     epoch complete!
2024-09-02 12:30:26 INFO     evaluating now!
2024-09-02 12:30:26 INFO     Epoch [23/200] train_loss: 4.7395, val_loss: 5.3130, lr: 0.003000, 5.06s
2024-09-02 12:30:31 INFO     epoch complete!
2024-09-02 12:30:31 INFO     evaluating now!
2024-09-02 12:30:31 INFO     Epoch [24/200] train_loss: 4.6578, val_loss: 5.3442, lr: 0.003000, 5.05s
2024-09-02 12:30:36 INFO     epoch complete!
2024-09-02 12:30:36 INFO     evaluating now!
2024-09-02 12:30:36 INFO     Epoch [25/200] train_loss: 4.6178, val_loss: 5.3167, lr: 0.003000, 5.06s
2024-09-02 12:30:41 INFO     epoch complete!
2024-09-02 12:30:41 INFO     evaluating now!
2024-09-02 12:30:41 INFO     Epoch [26/200] train_loss: 4.5493, val_loss: 5.0547, lr: 0.003000, 5.05s
2024-09-02 12:30:41 INFO     Saved model at 26
2024-09-02 12:30:41 INFO     Val loss decrease from 5.1727 to 5.0547, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-02 12:30:46 INFO     epoch complete!
2024-09-02 12:30:46 INFO     evaluating now!
2024-09-02 12:30:46 INFO     Epoch [27/200] train_loss: 4.5183, val_loss: 5.4292, lr: 0.003000, 5.06s
2024-09-02 12:30:51 INFO     epoch complete!
2024-09-02 12:30:51 INFO     evaluating now!
2024-09-02 12:30:51 INFO     Epoch [28/200] train_loss: 4.4864, val_loss: 5.2530, lr: 0.003000, 5.06s
2024-09-02 12:30:56 INFO     epoch complete!
2024-09-02 12:30:56 INFO     evaluating now!
2024-09-02 12:30:56 INFO     Epoch [29/200] train_loss: 4.4850, val_loss: 5.1568, lr: 0.003000, 5.05s
2024-09-02 12:31:01 INFO     epoch complete!
2024-09-02 12:31:01 INFO     evaluating now!
2024-09-02 12:31:01 INFO     Epoch [30/200] train_loss: 4.4045, val_loss: 5.3027, lr: 0.003000, 5.05s
2024-09-02 12:31:06 INFO     epoch complete!
2024-09-02 12:31:06 INFO     evaluating now!
2024-09-02 12:31:06 INFO     Epoch [31/200] train_loss: 4.3570, val_loss: 5.0636, lr: 0.003000, 5.05s
2024-09-02 12:31:11 INFO     epoch complete!
2024-09-02 12:31:11 INFO     evaluating now!
2024-09-02 12:31:11 INFO     Epoch [32/200] train_loss: 4.2968, val_loss: 5.0689, lr: 0.003000, 5.06s
2024-09-02 12:31:16 INFO     epoch complete!
2024-09-02 12:31:16 INFO     evaluating now!
2024-09-02 12:31:16 INFO     Epoch [33/200] train_loss: 4.2985, val_loss: 5.2819, lr: 0.003000, 5.05s
2024-09-02 12:31:21 INFO     epoch complete!
2024-09-02 12:31:21 INFO     evaluating now!
2024-09-02 12:31:21 INFO     Epoch [34/200] train_loss: 4.3076, val_loss: 5.1705, lr: 0.003000, 5.06s
2024-09-02 12:31:26 INFO     epoch complete!
2024-09-02 12:31:26 INFO     evaluating now!
2024-09-02 12:31:26 INFO     Epoch [35/200] train_loss: 4.2418, val_loss: 5.2845, lr: 0.003000, 5.05s
2024-09-02 12:31:31 INFO     epoch complete!
2024-09-02 12:31:31 INFO     evaluating now!
2024-09-02 12:31:32 INFO     Epoch [36/200] train_loss: 4.2479, val_loss: 5.0443, lr: 0.003000, 5.06s
2024-09-02 12:31:32 INFO     Saved model at 36
2024-09-02 12:31:32 INFO     Val loss decrease from 5.0547 to 5.0443, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-09-02 12:31:36 INFO     epoch complete!
2024-09-02 12:31:36 INFO     evaluating now!
2024-09-02 12:31:37 INFO     Epoch [37/200] train_loss: 4.1852, val_loss: 5.1810, lr: 0.003000, 5.06s
2024-09-02 12:31:41 INFO     epoch complete!
2024-09-02 12:31:41 INFO     evaluating now!
2024-09-02 12:31:42 INFO     Epoch [38/200] train_loss: 4.1340, val_loss: 5.1045, lr: 0.003000, 5.05s
2024-09-02 12:31:46 INFO     epoch complete!
2024-09-02 12:31:46 INFO     evaluating now!
2024-09-02 12:31:47 INFO     Epoch [39/200] train_loss: 4.0656, val_loss: 5.0067, lr: 0.003000, 5.06s
2024-09-02 12:31:47 INFO     Saved model at 39
2024-09-02 12:31:47 INFO     Val loss decrease from 5.0443 to 5.0067, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-09-02 12:31:52 INFO     epoch complete!
2024-09-02 12:31:52 INFO     evaluating now!
2024-09-02 12:31:52 INFO     Epoch [40/200] train_loss: 4.0358, val_loss: 5.0790, lr: 0.003000, 5.05s
2024-09-02 12:31:57 INFO     epoch complete!
2024-09-02 12:31:57 INFO     evaluating now!
2024-09-02 12:31:57 INFO     Epoch [41/200] train_loss: 4.0139, val_loss: 4.9805, lr: 0.003000, 5.06s
2024-09-02 12:31:57 INFO     Saved model at 41
2024-09-02 12:31:57 INFO     Val loss decrease from 5.0067 to 4.9805, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-09-02 12:32:02 INFO     epoch complete!
2024-09-02 12:32:02 INFO     evaluating now!
2024-09-02 12:32:02 INFO     Epoch [42/200] train_loss: 4.0312, val_loss: 5.0038, lr: 0.003000, 5.06s
2024-09-02 12:32:07 INFO     epoch complete!
2024-09-02 12:32:07 INFO     evaluating now!
2024-09-02 12:32:07 INFO     Epoch [43/200] train_loss: 3.9994, val_loss: 5.1147, lr: 0.003000, 5.05s
2024-09-02 12:32:12 INFO     epoch complete!
2024-09-02 12:32:12 INFO     evaluating now!
2024-09-02 12:32:12 INFO     Epoch [44/200] train_loss: 3.9620, val_loss: 4.9840, lr: 0.003000, 5.06s
2024-09-02 12:32:17 INFO     epoch complete!
2024-09-02 12:32:17 INFO     evaluating now!
2024-09-02 12:32:17 INFO     Epoch [45/200] train_loss: 3.8961, val_loss: 4.8974, lr: 0.003000, 5.05s
2024-09-02 12:32:17 INFO     Saved model at 45
2024-09-02 12:32:17 INFO     Val loss decrease from 4.9805 to 4.8974, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-09-02 12:32:22 INFO     epoch complete!
2024-09-02 12:32:22 INFO     evaluating now!
2024-09-02 12:32:22 INFO     Epoch [46/200] train_loss: 3.9505, val_loss: 5.0772, lr: 0.003000, 5.05s
2024-09-02 12:32:27 INFO     epoch complete!
2024-09-02 12:32:27 INFO     evaluating now!
2024-09-02 12:32:27 INFO     Epoch [47/200] train_loss: 3.9392, val_loss: 5.0113, lr: 0.003000, 5.05s
2024-09-02 12:32:32 INFO     epoch complete!
2024-09-02 12:32:32 INFO     evaluating now!
2024-09-02 12:32:32 INFO     Epoch [48/200] train_loss: 3.8439, val_loss: 5.0448, lr: 0.003000, 5.05s
2024-09-02 12:32:37 INFO     epoch complete!
2024-09-02 12:32:37 INFO     evaluating now!
2024-09-02 12:32:37 INFO     Epoch [49/200] train_loss: 3.8110, val_loss: 4.9642, lr: 0.003000, 5.06s
2024-09-02 12:32:42 INFO     epoch complete!
2024-09-02 12:32:42 INFO     evaluating now!
2024-09-02 12:32:42 INFO     Epoch [50/200] train_loss: 3.7948, val_loss: 5.0199, lr: 0.003000, 5.06s
2024-09-02 12:32:47 INFO     epoch complete!
2024-09-02 12:32:47 INFO     evaluating now!
2024-09-02 12:32:47 INFO     Epoch [51/200] train_loss: 3.7821, val_loss: 4.9725, lr: 0.003000, 5.05s
2024-09-02 12:32:52 INFO     epoch complete!
2024-09-02 12:32:52 INFO     evaluating now!
2024-09-02 12:32:52 INFO     Epoch [52/200] train_loss: 3.7324, val_loss: 4.9312, lr: 0.003000, 5.05s
2024-09-02 12:32:57 INFO     epoch complete!
2024-09-02 12:32:57 INFO     evaluating now!
2024-09-02 12:32:58 INFO     Epoch [53/200] train_loss: 3.7501, val_loss: 5.0201, lr: 0.003000, 5.06s
2024-09-02 12:33:02 INFO     epoch complete!
2024-09-02 12:33:02 INFO     evaluating now!
2024-09-02 12:33:03 INFO     Epoch [54/200] train_loss: 3.7353, val_loss: 5.0456, lr: 0.003000, 5.05s
2024-09-02 12:33:07 INFO     epoch complete!
2024-09-02 12:33:07 INFO     evaluating now!
2024-09-02 12:33:08 INFO     Epoch [55/200] train_loss: 3.7916, val_loss: 5.0386, lr: 0.003000, 5.06s
2024-09-02 12:33:12 INFO     epoch complete!
2024-09-02 12:33:12 INFO     evaluating now!
2024-09-02 12:33:13 INFO     Epoch [56/200] train_loss: 3.7183, val_loss: 4.9744, lr: 0.003000, 5.05s
2024-09-02 12:33:17 INFO     epoch complete!
2024-09-02 12:33:17 INFO     evaluating now!
2024-09-02 12:33:18 INFO     Epoch [57/200] train_loss: 3.6861, val_loss: 4.9639, lr: 0.003000, 5.06s
2024-09-02 12:33:23 INFO     epoch complete!
2024-09-02 12:33:23 INFO     evaluating now!
2024-09-02 12:33:23 INFO     Epoch [58/200] train_loss: 3.6921, val_loss: 4.9466, lr: 0.003000, 5.05s
2024-09-02 12:33:28 INFO     epoch complete!
2024-09-02 12:33:28 INFO     evaluating now!
2024-09-02 12:33:28 INFO     Epoch [59/200] train_loss: 3.6770, val_loss: 5.0252, lr: 0.003000, 5.06s
2024-09-02 12:33:33 INFO     epoch complete!
2024-09-02 12:33:33 INFO     evaluating now!
2024-09-02 12:33:33 INFO     Epoch [60/200] train_loss: 3.6264, val_loss: 4.9849, lr: 0.003000, 5.06s
2024-09-02 12:33:33 WARNING  Early stopping at epoch: 60
2024-09-02 12:33:33 INFO     Trained totally 61 epochs, average train time is 4.758s, average eval time is 0.302s
2024-09-02 12:33:33 INFO     Loaded model at 45
2024-09-02 12:33:33 INFO     Saved model at ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 12:33:33 INFO     Start evaluating ...
2024-09-02 12:33:34 INFO     Note that you select the single mode to evaluate!
2024-09-02 12:33:34 INFO     Evaluate result is saved at ./libcity/cache/20/evaluate_cache\2024_09_02_12_33_34_AGCRN_CHITaxi20190406.csv
2024-09-02 12:33:34 INFO     
         MAE       RMSE
1   2.381396   7.479204
2   2.488112   8.216160
3   2.717294   9.086381
4   2.800079   9.596399
5   2.911113  10.283499
6   3.073020  11.275313
7   3.187846  12.267433
8   3.238244  12.897516
9   3.279126  13.426419
10  3.314597  13.396486
11  3.370057  13.517353
12  3.474736  14.151342
2024-09-02 12:33:34 INFO     ----------------------------------------------------------------------------
2024-09-02 12:33:34 INFO     Kownledge Graph Embedding: DisMult, Experiment ids: [20, 21, 22, 23, 24]
2024-09-02 12:33:34 INFO     ----------------------------------------------------------------------------
2024-09-02 12:33:34 INFO     Average: 
         MAE       RMSE
0   2.370664   7.141281
1   2.487101   7.764297
2   2.716217   8.838232
3   2.877421   9.719491
4   2.982399  10.692795
5   3.121143  11.650577
6   3.187977  12.465281
7   3.273122  12.971644
8   3.333113  13.310838
9   3.375191  13.517452
10  3.458901  13.800504
11  3.555630  14.354583 
2024-09-02 12:33:34 INFO     Standard deviation: 
         MAE      RMSE
0   0.076805  0.314383
1   0.045739  0.271399
2   0.046688  0.164290
3   0.050567  0.159446
4   0.055613  0.376659
5   0.049654  0.599584
6   0.053883  0.758404
7   0.055213  0.737483
8   0.092703  0.635022
9   0.088168  0.532835
10  0.057985  0.403619
11  0.052730  0.329352
2024-09-02 12:33:34 INFO     ----------------------------------------------------------------------------
2024-09-02 12:33:34 INFO     12 steps Average: 
        MAE       RMSE
0  3.061573  11.352248
2024-09-02 12:33:34 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.060479  0.440206
