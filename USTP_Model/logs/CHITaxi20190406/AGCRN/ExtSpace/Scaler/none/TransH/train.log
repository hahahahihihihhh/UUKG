2024-04-30 23:49:51 INFO     ----------------------------------------------------------------------------
2024-04-30 23:49:51 INFO     # 0, Kownledge Graph Embedding: TransH, Experiment ids: 55
2024-04-30 23:49:51 INFO     ----------------------------------------------------------------------------
2024-04-30 23:49:51 INFO     Log directory: ./libcity/log
2024-04-30 23:49:51 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=55
2024-04-30 23:49:51 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 878826824, 'exp_id': 55, 'load_external': True, 'embedding_model': 'TransH', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 23:49:51 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 23:49:51 INFO     set_weight_link_or_dist: dist
2024-04-30 23:49:51 INFO     init_weight_inf_or_zero: inf
2024-04-30 23:49:52 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 23:49:52 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 23:49:52 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 23:49:52 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 23:49:55 INFO     Dataset created
2024-04-30 23:49:55 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 23:49:55 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 23:49:55 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 23:49:55 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 23:49:55 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 23:49:55 INFO     NoneScaler
2024-04-30 23:50:00 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 23:50:00 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 23:50:00 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 23:50:00 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 23:50:00 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 23:50:00 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 23:50:00 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 23:50:00 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 23:50:00 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 23:50:00 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 23:50:00 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 23:50:00 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 23:50:00 INFO     Total parameter numbers: 874010
2024-04-30 23:50:00 INFO     You select `adam` optimizer.
2024-04-30 23:50:00 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 23:50:00 INFO     Start training ...
2024-04-30 23:50:00 INFO     num_batches:48
2024-04-30 23:50:07 INFO     epoch complete!
2024-04-30 23:50:07 INFO     evaluating now!
2024-04-30 23:50:07 INFO     Epoch [0/200] train_loss: 25.2453, val_loss: 18.0302, lr: 0.003000, 7.34s
2024-04-30 23:50:07 INFO     Saved model at 0
2024-04-30 23:50:07 INFO     Val loss decrease from inf to 18.0302, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 23:50:13 INFO     epoch complete!
2024-04-30 23:50:13 INFO     evaluating now!
2024-04-30 23:50:13 INFO     Epoch [1/200] train_loss: 14.8206, val_loss: 14.4364, lr: 0.003000, 6.48s
2024-04-30 23:50:14 INFO     Saved model at 1
2024-04-30 23:50:14 INFO     Val loss decrease from 18.0302 to 14.4364, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 23:50:20 INFO     epoch complete!
2024-04-30 23:50:20 INFO     evaluating now!
2024-04-30 23:50:20 INFO     Epoch [2/200] train_loss: 11.8058, val_loss: 11.3811, lr: 0.003000, 6.53s
2024-04-30 23:50:20 INFO     Saved model at 2
2024-04-30 23:50:20 INFO     Val loss decrease from 14.4364 to 11.3811, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 23:50:26 INFO     epoch complete!
2024-04-30 23:50:26 INFO     evaluating now!
2024-04-30 23:50:27 INFO     Epoch [3/200] train_loss: 9.5400, val_loss: 9.0622, lr: 0.003000, 6.49s
2024-04-30 23:50:27 INFO     Saved model at 3
2024-04-30 23:50:27 INFO     Val loss decrease from 11.3811 to 9.0622, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 23:50:33 INFO     epoch complete!
2024-04-30 23:50:33 INFO     evaluating now!
2024-04-30 23:50:33 INFO     Epoch [4/200] train_loss: 8.1292, val_loss: 7.9584, lr: 0.003000, 6.44s
2024-04-30 23:50:33 INFO     Saved model at 4
2024-04-30 23:50:33 INFO     Val loss decrease from 9.0622 to 7.9584, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 23:50:39 INFO     epoch complete!
2024-04-30 23:50:39 INFO     evaluating now!
2024-04-30 23:50:40 INFO     Epoch [5/200] train_loss: 7.3918, val_loss: 7.1537, lr: 0.003000, 6.41s
2024-04-30 23:50:40 INFO     Saved model at 5
2024-04-30 23:50:40 INFO     Val loss decrease from 7.9584 to 7.1537, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 23:50:46 INFO     epoch complete!
2024-04-30 23:50:46 INFO     evaluating now!
2024-04-30 23:50:46 INFO     Epoch [6/200] train_loss: 6.7685, val_loss: 6.8147, lr: 0.003000, 6.47s
2024-04-30 23:50:46 INFO     Saved model at 6
2024-04-30 23:50:46 INFO     Val loss decrease from 7.1537 to 6.8147, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 23:50:52 INFO     epoch complete!
2024-04-30 23:50:52 INFO     evaluating now!
2024-04-30 23:50:53 INFO     Epoch [7/200] train_loss: 6.3461, val_loss: 6.4297, lr: 0.003000, 6.74s
2024-04-30 23:50:53 INFO     Saved model at 7
2024-04-30 23:50:53 INFO     Val loss decrease from 6.8147 to 6.4297, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 23:50:59 INFO     epoch complete!
2024-04-30 23:50:59 INFO     evaluating now!
2024-04-30 23:51:00 INFO     Epoch [8/200] train_loss: 6.1009, val_loss: 6.2450, lr: 0.003000, 7.01s
2024-04-30 23:51:00 INFO     Saved model at 8
2024-04-30 23:51:00 INFO     Val loss decrease from 6.4297 to 6.2450, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 23:51:06 INFO     epoch complete!
2024-04-30 23:51:06 INFO     evaluating now!
2024-04-30 23:51:07 INFO     Epoch [9/200] train_loss: 5.9355, val_loss: 5.9119, lr: 0.003000, 6.78s
2024-04-30 23:51:07 INFO     Saved model at 9
2024-04-30 23:51:07 INFO     Val loss decrease from 6.2450 to 5.9119, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 23:51:13 INFO     epoch complete!
2024-04-30 23:51:13 INFO     evaluating now!
2024-04-30 23:51:14 INFO     Epoch [10/200] train_loss: 5.6462, val_loss: 5.7842, lr: 0.003000, 7.05s
2024-04-30 23:51:14 INFO     Saved model at 10
2024-04-30 23:51:14 INFO     Val loss decrease from 5.9119 to 5.7842, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 23:51:21 INFO     epoch complete!
2024-04-30 23:51:21 INFO     evaluating now!
2024-04-30 23:51:21 INFO     Epoch [11/200] train_loss: 5.5457, val_loss: 5.7408, lr: 0.003000, 7.49s
2024-04-30 23:51:21 INFO     Saved model at 11
2024-04-30 23:51:21 INFO     Val loss decrease from 5.7842 to 5.7408, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 23:51:29 INFO     epoch complete!
2024-04-30 23:51:29 INFO     evaluating now!
2024-04-30 23:51:29 INFO     Epoch [12/200] train_loss: 5.3818, val_loss: 5.6789, lr: 0.003000, 7.66s
2024-04-30 23:51:29 INFO     Saved model at 12
2024-04-30 23:51:29 INFO     Val loss decrease from 5.7408 to 5.6789, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 23:51:36 INFO     epoch complete!
2024-04-30 23:51:36 INFO     evaluating now!
2024-04-30 23:51:36 INFO     Epoch [13/200] train_loss: 5.2720, val_loss: 5.5887, lr: 0.003000, 7.17s
2024-04-30 23:51:36 INFO     Saved model at 13
2024-04-30 23:51:36 INFO     Val loss decrease from 5.6789 to 5.5887, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 23:51:43 INFO     epoch complete!
2024-04-30 23:51:43 INFO     evaluating now!
2024-04-30 23:51:43 INFO     Epoch [14/200] train_loss: 5.1355, val_loss: 5.6849, lr: 0.003000, 7.06s
2024-04-30 23:51:50 INFO     epoch complete!
2024-04-30 23:51:50 INFO     evaluating now!
2024-04-30 23:51:51 INFO     Epoch [15/200] train_loss: 5.0367, val_loss: 5.6483, lr: 0.003000, 7.20s
2024-04-30 23:51:57 INFO     epoch complete!
2024-04-30 23:51:57 INFO     evaluating now!
2024-04-30 23:51:58 INFO     Epoch [16/200] train_loss: 4.9842, val_loss: 5.5014, lr: 0.003000, 7.25s
2024-04-30 23:51:58 INFO     Saved model at 16
2024-04-30 23:51:58 INFO     Val loss decrease from 5.5887 to 5.5014, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 23:52:04 INFO     epoch complete!
2024-04-30 23:52:04 INFO     evaluating now!
2024-04-30 23:52:05 INFO     Epoch [17/200] train_loss: 4.9152, val_loss: 5.2533, lr: 0.003000, 7.10s
2024-04-30 23:52:05 INFO     Saved model at 17
2024-04-30 23:52:05 INFO     Val loss decrease from 5.5014 to 5.2533, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 23:52:12 INFO     epoch complete!
2024-04-30 23:52:12 INFO     evaluating now!
2024-04-30 23:52:12 INFO     Epoch [18/200] train_loss: 4.8016, val_loss: 5.3460, lr: 0.003000, 7.27s
2024-04-30 23:52:20 INFO     epoch complete!
2024-04-30 23:52:20 INFO     evaluating now!
2024-04-30 23:52:20 INFO     Epoch [19/200] train_loss: 4.7380, val_loss: 5.2922, lr: 0.003000, 8.08s
2024-04-30 23:52:28 INFO     epoch complete!
2024-04-30 23:52:28 INFO     evaluating now!
2024-04-30 23:52:28 INFO     Epoch [20/200] train_loss: 4.6538, val_loss: 5.2990, lr: 0.003000, 7.67s
2024-04-30 23:52:35 INFO     epoch complete!
2024-04-30 23:52:35 INFO     evaluating now!
2024-04-30 23:52:35 INFO     Epoch [21/200] train_loss: 4.6547, val_loss: 5.4035, lr: 0.003000, 7.24s
2024-04-30 23:52:42 INFO     epoch complete!
2024-04-30 23:52:42 INFO     evaluating now!
2024-04-30 23:52:42 INFO     Epoch [22/200] train_loss: 4.5896, val_loss: 5.1909, lr: 0.003000, 7.21s
2024-04-30 23:52:42 INFO     Saved model at 22
2024-04-30 23:52:42 INFO     Val loss decrease from 5.2533 to 5.1909, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-30 23:52:49 INFO     epoch complete!
2024-04-30 23:52:49 INFO     evaluating now!
2024-04-30 23:52:50 INFO     Epoch [23/200] train_loss: 4.4989, val_loss: 5.3209, lr: 0.003000, 7.05s
2024-04-30 23:52:56 INFO     epoch complete!
2024-04-30 23:52:56 INFO     evaluating now!
2024-04-30 23:52:57 INFO     Epoch [24/200] train_loss: 4.4169, val_loss: 5.3200, lr: 0.003000, 7.05s
2024-04-30 23:53:03 INFO     epoch complete!
2024-04-30 23:53:03 INFO     evaluating now!
2024-04-30 23:53:04 INFO     Epoch [25/200] train_loss: 4.3921, val_loss: 5.1127, lr: 0.003000, 7.04s
2024-04-30 23:53:04 INFO     Saved model at 25
2024-04-30 23:53:04 INFO     Val loss decrease from 5.1909 to 5.1127, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-30 23:53:10 INFO     epoch complete!
2024-04-30 23:53:10 INFO     evaluating now!
2024-04-30 23:53:11 INFO     Epoch [26/200] train_loss: 4.3587, val_loss: 5.2997, lr: 0.003000, 7.22s
2024-04-30 23:53:18 INFO     epoch complete!
2024-04-30 23:53:18 INFO     evaluating now!
2024-04-30 23:53:18 INFO     Epoch [27/200] train_loss: 4.3694, val_loss: 5.1596, lr: 0.003000, 7.11s
2024-04-30 23:53:25 INFO     epoch complete!
2024-04-30 23:53:25 INFO     evaluating now!
2024-04-30 23:53:25 INFO     Epoch [28/200] train_loss: 4.2903, val_loss: 5.1386, lr: 0.003000, 7.04s
2024-04-30 23:53:32 INFO     epoch complete!
2024-04-30 23:53:32 INFO     evaluating now!
2024-04-30 23:53:32 INFO     Epoch [29/200] train_loss: 4.2263, val_loss: 4.9980, lr: 0.003000, 7.13s
2024-04-30 23:53:32 INFO     Saved model at 29
2024-04-30 23:53:32 INFO     Val loss decrease from 5.1127 to 4.9980, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-04-30 23:53:39 INFO     epoch complete!
2024-04-30 23:53:39 INFO     evaluating now!
2024-04-30 23:53:39 INFO     Epoch [30/200] train_loss: 4.1447, val_loss: 5.1086, lr: 0.003000, 7.15s
2024-04-30 23:53:46 INFO     epoch complete!
2024-04-30 23:53:46 INFO     evaluating now!
2024-04-30 23:53:46 INFO     Epoch [31/200] train_loss: 4.1282, val_loss: 5.1006, lr: 0.003000, 7.03s
2024-04-30 23:53:53 INFO     epoch complete!
2024-04-30 23:53:53 INFO     evaluating now!
2024-04-30 23:53:54 INFO     Epoch [32/200] train_loss: 4.1161, val_loss: 5.0458, lr: 0.003000, 7.15s
2024-04-30 23:54:00 INFO     epoch complete!
2024-04-30 23:54:00 INFO     evaluating now!
2024-04-30 23:54:01 INFO     Epoch [33/200] train_loss: 4.0966, val_loss: 4.9594, lr: 0.003000, 7.28s
2024-04-30 23:54:01 INFO     Saved model at 33
2024-04-30 23:54:01 INFO     Val loss decrease from 4.9980 to 4.9594, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-04-30 23:54:08 INFO     epoch complete!
2024-04-30 23:54:08 INFO     evaluating now!
2024-04-30 23:54:09 INFO     Epoch [34/200] train_loss: 4.0665, val_loss: 5.0041, lr: 0.003000, 7.86s
2024-04-30 23:54:15 INFO     epoch complete!
2024-04-30 23:54:15 INFO     evaluating now!
2024-04-30 23:54:16 INFO     Epoch [35/200] train_loss: 4.0541, val_loss: 5.1391, lr: 0.003000, 7.16s
2024-04-30 23:54:23 INFO     epoch complete!
2024-04-30 23:54:23 INFO     evaluating now!
2024-04-30 23:54:23 INFO     Epoch [36/200] train_loss: 4.0270, val_loss: 4.9493, lr: 0.003000, 7.26s
2024-04-30 23:54:23 INFO     Saved model at 36
2024-04-30 23:54:23 INFO     Val loss decrease from 4.9594 to 4.9493, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-04-30 23:54:30 INFO     epoch complete!
2024-04-30 23:54:30 INFO     evaluating now!
2024-04-30 23:54:30 INFO     Epoch [37/200] train_loss: 3.9518, val_loss: 4.9532, lr: 0.003000, 7.22s
2024-04-30 23:54:37 INFO     epoch complete!
2024-04-30 23:54:37 INFO     evaluating now!
2024-04-30 23:54:38 INFO     Epoch [38/200] train_loss: 3.8836, val_loss: 5.1185, lr: 0.003000, 7.24s
2024-04-30 23:54:44 INFO     epoch complete!
2024-04-30 23:54:44 INFO     evaluating now!
2024-04-30 23:54:45 INFO     Epoch [39/200] train_loss: 3.8827, val_loss: 5.0828, lr: 0.003000, 7.01s
2024-04-30 23:54:51 INFO     epoch complete!
2024-04-30 23:54:51 INFO     evaluating now!
2024-04-30 23:54:52 INFO     Epoch [40/200] train_loss: 3.8493, val_loss: 5.1416, lr: 0.003000, 7.25s
2024-04-30 23:54:58 INFO     epoch complete!
2024-04-30 23:54:58 INFO     evaluating now!
2024-04-30 23:54:59 INFO     Epoch [41/200] train_loss: 3.8383, val_loss: 5.0628, lr: 0.003000, 6.88s
2024-04-30 23:55:05 INFO     epoch complete!
2024-04-30 23:55:05 INFO     evaluating now!
2024-04-30 23:55:06 INFO     Epoch [42/200] train_loss: 3.7975, val_loss: 5.0755, lr: 0.003000, 7.09s
2024-04-30 23:55:12 INFO     epoch complete!
2024-04-30 23:55:12 INFO     evaluating now!
2024-04-30 23:55:13 INFO     Epoch [43/200] train_loss: 3.7945, val_loss: 5.0055, lr: 0.003000, 6.85s
2024-04-30 23:55:20 INFO     epoch complete!
2024-04-30 23:55:20 INFO     evaluating now!
2024-04-30 23:55:20 INFO     Epoch [44/200] train_loss: 3.7451, val_loss: 5.1168, lr: 0.003000, 7.64s
2024-04-30 23:55:27 INFO     epoch complete!
2024-04-30 23:55:27 INFO     evaluating now!
2024-04-30 23:55:27 INFO     Epoch [45/200] train_loss: 3.7158, val_loss: 4.9141, lr: 0.003000, 6.95s
2024-04-30 23:55:27 INFO     Saved model at 45
2024-04-30 23:55:27 INFO     Val loss decrease from 4.9493 to 4.9141, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-04-30 23:55:33 INFO     epoch complete!
2024-04-30 23:55:33 INFO     evaluating now!
2024-04-30 23:55:34 INFO     Epoch [46/200] train_loss: 3.6980, val_loss: 5.0307, lr: 0.003000, 6.50s
2024-04-30 23:55:40 INFO     epoch complete!
2024-04-30 23:55:40 INFO     evaluating now!
2024-04-30 23:55:40 INFO     Epoch [47/200] train_loss: 3.6734, val_loss: 5.0606, lr: 0.003000, 6.48s
2024-04-30 23:55:46 INFO     epoch complete!
2024-04-30 23:55:46 INFO     evaluating now!
2024-04-30 23:55:47 INFO     Epoch [48/200] train_loss: 3.6620, val_loss: 5.0499, lr: 0.003000, 6.27s
2024-04-30 23:55:53 INFO     epoch complete!
2024-04-30 23:55:53 INFO     evaluating now!
2024-04-30 23:55:53 INFO     Epoch [49/200] train_loss: 3.7122, val_loss: 5.1029, lr: 0.003000, 6.38s
2024-04-30 23:55:59 INFO     epoch complete!
2024-04-30 23:55:59 INFO     evaluating now!
2024-04-30 23:55:59 INFO     Epoch [50/200] train_loss: 3.6893, val_loss: 5.0591, lr: 0.003000, 6.28s
2024-04-30 23:56:05 INFO     epoch complete!
2024-04-30 23:56:05 INFO     evaluating now!
2024-04-30 23:56:06 INFO     Epoch [51/200] train_loss: 3.6078, val_loss: 5.0647, lr: 0.003000, 6.31s
2024-04-30 23:56:12 INFO     epoch complete!
2024-04-30 23:56:12 INFO     evaluating now!
2024-04-30 23:56:13 INFO     Epoch [52/200] train_loss: 3.5607, val_loss: 4.9399, lr: 0.003000, 6.92s
2024-04-30 23:56:19 INFO     epoch complete!
2024-04-30 23:56:19 INFO     evaluating now!
2024-04-30 23:56:19 INFO     Epoch [53/200] train_loss: 3.5733, val_loss: 5.1055, lr: 0.003000, 6.92s
2024-04-30 23:56:26 INFO     epoch complete!
2024-04-30 23:56:26 INFO     evaluating now!
2024-04-30 23:56:26 INFO     Epoch [54/200] train_loss: 3.5435, val_loss: 5.1120, lr: 0.003000, 6.95s
2024-04-30 23:56:33 INFO     epoch complete!
2024-04-30 23:56:33 INFO     evaluating now!
2024-04-30 23:56:33 INFO     Epoch [55/200] train_loss: 3.5457, val_loss: 5.0486, lr: 0.003000, 6.98s
2024-04-30 23:56:40 INFO     epoch complete!
2024-04-30 23:56:40 INFO     evaluating now!
2024-04-30 23:56:40 INFO     Epoch [56/200] train_loss: 3.5412, val_loss: 5.0022, lr: 0.003000, 7.09s
2024-04-30 23:56:47 INFO     epoch complete!
2024-04-30 23:56:47 INFO     evaluating now!
2024-04-30 23:56:47 INFO     Epoch [57/200] train_loss: 3.5155, val_loss: 5.0402, lr: 0.003000, 6.97s
2024-04-30 23:56:54 INFO     epoch complete!
2024-04-30 23:56:54 INFO     evaluating now!
2024-04-30 23:56:54 INFO     Epoch [58/200] train_loss: 3.5102, val_loss: 5.0782, lr: 0.003000, 6.82s
2024-04-30 23:57:01 INFO     epoch complete!
2024-04-30 23:57:01 INFO     evaluating now!
2024-04-30 23:57:01 INFO     Epoch [59/200] train_loss: 3.4847, val_loss: 4.9913, lr: 0.003000, 7.12s
2024-04-30 23:57:08 INFO     epoch complete!
2024-04-30 23:57:08 INFO     evaluating now!
2024-04-30 23:57:08 INFO     Epoch [60/200] train_loss: 3.4411, val_loss: 5.0305, lr: 0.003000, 6.86s
2024-04-30 23:57:08 WARNING  Early stopping at epoch: 60
2024-04-30 23:57:08 INFO     Trained totally 61 epochs, average train time is 6.551s, average eval time is 0.458s
2024-04-30 23:57:08 INFO     Loaded model at 45
2024-04-30 23:57:08 INFO     Saved model at ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 23:57:08 INFO     Start evaluating ...
2024-04-30 23:57:10 INFO     Note that you select the single mode to evaluate!
2024-04-30 23:57:10 INFO     Evaluate result is saved at ./libcity/cache/55/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 23:57:10 INFO     
         MAE       RMSE
1   2.197209   6.829313
2   2.376702   7.514038
3   2.590476   8.453276
4   2.784621   9.430881
5   2.952557  10.660883
6   3.171719  12.234612
7   3.286896  13.524708
8   3.300771  14.193340
9   3.399698  14.453334
10  3.418767  14.296432
11  3.483426  14.198597
12  3.572625  14.563864
2024-04-30 23:57:10 INFO     ----------------------------------------------------------------------------
2024-04-30 23:57:10 INFO     # 1, Kownledge Graph Embedding: TransH, Experiment ids: 56
2024-04-30 23:57:10 INFO     ----------------------------------------------------------------------------
2024-04-30 23:57:10 INFO     Log directory: ./libcity/log
2024-04-30 23:57:10 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=56
2024-04-30 23:57:10 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 139790822, 'exp_id': 56, 'load_external': True, 'embedding_model': 'TransH', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 23:57:10 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 23:57:10 INFO     set_weight_link_or_dist: dist
2024-04-30 23:57:10 INFO     init_weight_inf_or_zero: inf
2024-04-30 23:57:10 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 23:57:10 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 23:57:10 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 23:57:11 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 23:57:13 INFO     Dataset created
2024-04-30 23:57:13 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 23:57:13 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 23:57:13 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 23:57:13 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 23:57:14 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 23:57:14 INFO     NoneScaler
2024-04-30 23:57:16 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 23:57:16 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 23:57:16 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 23:57:16 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 23:57:16 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 23:57:16 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 23:57:16 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 23:57:16 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 23:57:16 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 23:57:16 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 23:57:16 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 23:57:16 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 23:57:16 INFO     Total parameter numbers: 874010
2024-04-30 23:57:16 INFO     You select `adam` optimizer.
2024-04-30 23:57:16 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 23:57:16 INFO     Start training ...
2024-04-30 23:57:16 INFO     num_batches:48
2024-04-30 23:57:22 INFO     epoch complete!
2024-04-30 23:57:22 INFO     evaluating now!
2024-04-30 23:57:22 INFO     Epoch [0/200] train_loss: 24.4756, val_loss: 18.0403, lr: 0.003000, 6.42s
2024-04-30 23:57:30 INFO     Saved model at 0
2024-04-30 23:57:30 INFO     Val loss decrease from inf to 18.0403, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 23:57:36 INFO     epoch complete!
2024-04-30 23:57:36 INFO     evaluating now!
2024-04-30 23:57:37 INFO     Epoch [1/200] train_loss: 14.2052, val_loss: 13.1743, lr: 0.003000, 6.72s
2024-04-30 23:57:37 INFO     Saved model at 1
2024-04-30 23:57:37 INFO     Val loss decrease from 18.0403 to 13.1743, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 23:57:44 INFO     epoch complete!
2024-04-30 23:57:44 INFO     evaluating now!
2024-04-30 23:57:44 INFO     Epoch [2/200] train_loss: 10.5667, val_loss: 10.0265, lr: 0.003000, 7.25s
2024-04-30 23:57:44 INFO     Saved model at 2
2024-04-30 23:57:44 INFO     Val loss decrease from 13.1743 to 10.0265, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 23:57:51 INFO     epoch complete!
2024-04-30 23:57:51 INFO     evaluating now!
2024-04-30 23:57:51 INFO     Epoch [3/200] train_loss: 8.5421, val_loss: 8.0358, lr: 0.003000, 7.14s
2024-04-30 23:57:51 INFO     Saved model at 3
2024-04-30 23:57:51 INFO     Val loss decrease from 10.0265 to 8.0358, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 23:57:58 INFO     epoch complete!
2024-04-30 23:57:58 INFO     evaluating now!
2024-04-30 23:57:58 INFO     Epoch [4/200] train_loss: 7.5083, val_loss: 7.2885, lr: 0.003000, 6.92s
2024-04-30 23:57:58 INFO     Saved model at 4
2024-04-30 23:57:58 INFO     Val loss decrease from 8.0358 to 7.2885, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 23:58:05 INFO     epoch complete!
2024-04-30 23:58:05 INFO     evaluating now!
2024-04-30 23:58:05 INFO     Epoch [5/200] train_loss: 6.8173, val_loss: 6.8206, lr: 0.003000, 6.96s
2024-04-30 23:58:05 INFO     Saved model at 5
2024-04-30 23:58:05 INFO     Val loss decrease from 7.2885 to 6.8206, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 23:58:12 INFO     epoch complete!
2024-04-30 23:58:12 INFO     evaluating now!
2024-04-30 23:58:12 INFO     Epoch [6/200] train_loss: 6.2798, val_loss: 6.3471, lr: 0.003000, 6.83s
2024-04-30 23:58:12 INFO     Saved model at 6
2024-04-30 23:58:12 INFO     Val loss decrease from 6.8206 to 6.3471, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 23:58:19 INFO     epoch complete!
2024-04-30 23:58:19 INFO     evaluating now!
2024-04-30 23:58:19 INFO     Epoch [7/200] train_loss: 6.1121, val_loss: 6.2028, lr: 0.003000, 6.88s
2024-04-30 23:58:19 INFO     Saved model at 7
2024-04-30 23:58:19 INFO     Val loss decrease from 6.3471 to 6.2028, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 23:58:26 INFO     epoch complete!
2024-04-30 23:58:26 INFO     evaluating now!
2024-04-30 23:58:26 INFO     Epoch [8/200] train_loss: 5.8424, val_loss: 5.9447, lr: 0.003000, 6.91s
2024-04-30 23:58:26 INFO     Saved model at 8
2024-04-30 23:58:26 INFO     Val loss decrease from 6.2028 to 5.9447, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 23:58:33 INFO     epoch complete!
2024-04-30 23:58:33 INFO     evaluating now!
2024-04-30 23:58:33 INFO     Epoch [9/200] train_loss: 5.6447, val_loss: 5.8502, lr: 0.003000, 6.94s
2024-04-30 23:58:33 INFO     Saved model at 9
2024-04-30 23:58:33 INFO     Val loss decrease from 5.9447 to 5.8502, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 23:58:40 INFO     epoch complete!
2024-04-30 23:58:40 INFO     evaluating now!
2024-04-30 23:58:40 INFO     Epoch [10/200] train_loss: 5.5904, val_loss: 5.7650, lr: 0.003000, 6.97s
2024-04-30 23:58:40 INFO     Saved model at 10
2024-04-30 23:58:40 INFO     Val loss decrease from 5.8502 to 5.7650, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 23:58:47 INFO     epoch complete!
2024-04-30 23:58:47 INFO     evaluating now!
2024-04-30 23:58:47 INFO     Epoch [11/200] train_loss: 5.4285, val_loss: 5.7128, lr: 0.003000, 6.88s
2024-04-30 23:58:47 INFO     Saved model at 11
2024-04-30 23:58:47 INFO     Val loss decrease from 5.7650 to 5.7128, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 23:58:53 INFO     epoch complete!
2024-04-30 23:58:53 INFO     evaluating now!
2024-04-30 23:58:54 INFO     Epoch [12/200] train_loss: 5.3069, val_loss: 5.5900, lr: 0.003000, 6.83s
2024-04-30 23:58:54 INFO     Saved model at 12
2024-04-30 23:58:54 INFO     Val loss decrease from 5.7128 to 5.5900, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 23:59:00 INFO     epoch complete!
2024-04-30 23:59:00 INFO     evaluating now!
2024-04-30 23:59:01 INFO     Epoch [13/200] train_loss: 5.1933, val_loss: 5.5570, lr: 0.003000, 6.96s
2024-04-30 23:59:01 INFO     Saved model at 13
2024-04-30 23:59:01 INFO     Val loss decrease from 5.5900 to 5.5570, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 23:59:08 INFO     epoch complete!
2024-04-30 23:59:08 INFO     evaluating now!
2024-04-30 23:59:08 INFO     Epoch [14/200] train_loss: 5.1022, val_loss: 5.4985, lr: 0.003000, 7.06s
2024-04-30 23:59:08 INFO     Saved model at 14
2024-04-30 23:59:08 INFO     Val loss decrease from 5.5570 to 5.4985, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 23:59:14 INFO     epoch complete!
2024-04-30 23:59:14 INFO     evaluating now!
2024-04-30 23:59:15 INFO     Epoch [15/200] train_loss: 4.9855, val_loss: 5.4783, lr: 0.003000, 6.88s
2024-04-30 23:59:15 INFO     Saved model at 15
2024-04-30 23:59:15 INFO     Val loss decrease from 5.4985 to 5.4783, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 23:59:21 INFO     epoch complete!
2024-04-30 23:59:21 INFO     evaluating now!
2024-04-30 23:59:22 INFO     Epoch [16/200] train_loss: 4.9511, val_loss: 5.2740, lr: 0.003000, 6.88s
2024-04-30 23:59:22 INFO     Saved model at 16
2024-04-30 23:59:22 INFO     Val loss decrease from 5.4783 to 5.2740, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 23:59:28 INFO     epoch complete!
2024-04-30 23:59:28 INFO     evaluating now!
2024-04-30 23:59:29 INFO     Epoch [17/200] train_loss: 4.8935, val_loss: 5.4168, lr: 0.003000, 6.91s
2024-04-30 23:59:35 INFO     epoch complete!
2024-04-30 23:59:35 INFO     evaluating now!
2024-04-30 23:59:36 INFO     Epoch [18/200] train_loss: 4.7618, val_loss: 5.2431, lr: 0.003000, 7.01s
2024-04-30 23:59:36 INFO     Saved model at 18
2024-04-30 23:59:36 INFO     Val loss decrease from 5.2740 to 5.2431, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 23:59:42 INFO     epoch complete!
2024-04-30 23:59:42 INFO     evaluating now!
2024-04-30 23:59:43 INFO     Epoch [19/200] train_loss: 4.7303, val_loss: 5.4914, lr: 0.003000, 6.95s
2024-04-30 23:59:49 INFO     epoch complete!
2024-04-30 23:59:49 INFO     evaluating now!
2024-04-30 23:59:50 INFO     Epoch [20/200] train_loss: 4.6414, val_loss: 5.3981, lr: 0.003000, 6.99s
2024-04-30 23:59:56 INFO     epoch complete!
2024-04-30 23:59:56 INFO     evaluating now!
2024-04-30 23:59:57 INFO     Epoch [21/200] train_loss: 4.6307, val_loss: 5.3207, lr: 0.003000, 6.98s
2024-05-01 00:00:03 INFO     epoch complete!
2024-05-01 00:00:03 INFO     evaluating now!
2024-05-01 00:00:04 INFO     Epoch [22/200] train_loss: 4.6083, val_loss: 5.4854, lr: 0.003000, 7.09s
2024-05-01 00:00:10 INFO     epoch complete!
2024-05-01 00:00:10 INFO     evaluating now!
2024-05-01 00:00:11 INFO     Epoch [23/200] train_loss: 4.5551, val_loss: 5.3455, lr: 0.003000, 6.88s
2024-05-01 00:00:17 INFO     epoch complete!
2024-05-01 00:00:17 INFO     evaluating now!
2024-05-01 00:00:18 INFO     Epoch [24/200] train_loss: 4.5134, val_loss: 5.3572, lr: 0.003000, 6.90s
2024-05-01 00:00:24 INFO     epoch complete!
2024-05-01 00:00:24 INFO     evaluating now!
2024-05-01 00:00:25 INFO     Epoch [25/200] train_loss: 4.3978, val_loss: 5.2776, lr: 0.003000, 6.96s
2024-05-01 00:00:31 INFO     epoch complete!
2024-05-01 00:00:31 INFO     evaluating now!
2024-05-01 00:00:32 INFO     Epoch [26/200] train_loss: 4.3806, val_loss: 5.3259, lr: 0.003000, 7.05s
2024-05-01 00:00:39 INFO     epoch complete!
2024-05-01 00:00:39 INFO     evaluating now!
2024-05-01 00:00:39 INFO     Epoch [27/200] train_loss: 4.3058, val_loss: 5.5311, lr: 0.003000, 7.53s
2024-05-01 00:00:46 INFO     epoch complete!
2024-05-01 00:00:46 INFO     evaluating now!
2024-05-01 00:00:46 INFO     Epoch [28/200] train_loss: 4.2761, val_loss: 5.2938, lr: 0.003000, 6.95s
2024-05-01 00:00:53 INFO     epoch complete!
2024-05-01 00:00:53 INFO     evaluating now!
2024-05-01 00:00:53 INFO     Epoch [29/200] train_loss: 4.2188, val_loss: 5.1777, lr: 0.003000, 6.86s
2024-05-01 00:00:53 INFO     Saved model at 29
2024-05-01 00:00:53 INFO     Val loss decrease from 5.2431 to 5.1777, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-05-01 00:01:00 INFO     epoch complete!
2024-05-01 00:01:00 INFO     evaluating now!
2024-05-01 00:01:00 INFO     Epoch [30/200] train_loss: 4.2307, val_loss: 5.2464, lr: 0.003000, 6.96s
2024-05-01 00:01:06 INFO     epoch complete!
2024-05-01 00:01:06 INFO     evaluating now!
2024-05-01 00:01:07 INFO     Epoch [31/200] train_loss: 4.1518, val_loss: 5.1998, lr: 0.003000, 6.94s
2024-05-01 00:01:13 INFO     epoch complete!
2024-05-01 00:01:13 INFO     evaluating now!
2024-05-01 00:01:14 INFO     Epoch [32/200] train_loss: 4.1171, val_loss: 5.3662, lr: 0.003000, 6.84s
2024-05-01 00:01:20 INFO     epoch complete!
2024-05-01 00:01:20 INFO     evaluating now!
2024-05-01 00:01:21 INFO     Epoch [33/200] train_loss: 4.0913, val_loss: 5.4845, lr: 0.003000, 6.82s
2024-05-01 00:01:27 INFO     epoch complete!
2024-05-01 00:01:27 INFO     evaluating now!
2024-05-01 00:01:28 INFO     Epoch [34/200] train_loss: 4.0785, val_loss: 5.1120, lr: 0.003000, 6.97s
2024-05-01 00:01:28 INFO     Saved model at 34
2024-05-01 00:01:28 INFO     Val loss decrease from 5.1777 to 5.1120, saving to ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-05-01 00:01:34 INFO     epoch complete!
2024-05-01 00:01:34 INFO     evaluating now!
2024-05-01 00:01:34 INFO     Epoch [35/200] train_loss: 4.0121, val_loss: 5.1812, lr: 0.003000, 6.90s
2024-05-01 00:01:41 INFO     epoch complete!
2024-05-01 00:01:41 INFO     evaluating now!
2024-05-01 00:01:41 INFO     Epoch [36/200] train_loss: 3.9774, val_loss: 5.3245, lr: 0.003000, 6.93s
2024-05-01 00:01:48 INFO     epoch complete!
2024-05-01 00:01:48 INFO     evaluating now!
2024-05-01 00:01:48 INFO     Epoch [37/200] train_loss: 3.9688, val_loss: 5.3513, lr: 0.003000, 7.04s
2024-05-01 00:01:55 INFO     epoch complete!
2024-05-01 00:01:55 INFO     evaluating now!
2024-05-01 00:01:55 INFO     Epoch [38/200] train_loss: 3.9704, val_loss: 5.2914, lr: 0.003000, 6.71s
2024-05-01 00:02:01 INFO     epoch complete!
2024-05-01 00:02:01 INFO     evaluating now!
2024-05-01 00:02:02 INFO     Epoch [39/200] train_loss: 3.8854, val_loss: 5.2099, lr: 0.003000, 6.49s
2024-05-01 00:02:08 INFO     epoch complete!
2024-05-01 00:02:08 INFO     evaluating now!
2024-05-01 00:02:08 INFO     Epoch [40/200] train_loss: 3.9212, val_loss: 5.1504, lr: 0.003000, 6.53s
2024-05-01 00:02:14 INFO     epoch complete!
2024-05-01 00:02:14 INFO     evaluating now!
2024-05-01 00:02:15 INFO     Epoch [41/200] train_loss: 3.9891, val_loss: 5.2234, lr: 0.003000, 6.43s
2024-05-01 00:02:21 INFO     epoch complete!
2024-05-01 00:02:21 INFO     evaluating now!
2024-05-01 00:02:21 INFO     Epoch [42/200] train_loss: 3.8512, val_loss: 5.2916, lr: 0.003000, 6.42s
2024-05-01 00:02:28 INFO     epoch complete!
2024-05-01 00:02:28 INFO     evaluating now!
2024-05-01 00:02:28 INFO     Epoch [43/200] train_loss: 3.8073, val_loss: 5.2077, lr: 0.003000, 6.95s
2024-05-01 00:02:35 INFO     epoch complete!
2024-05-01 00:02:35 INFO     evaluating now!
2024-05-01 00:02:35 INFO     Epoch [44/200] train_loss: 3.8080, val_loss: 5.4378, lr: 0.003000, 7.28s
2024-05-01 00:02:42 INFO     epoch complete!
2024-05-01 00:02:42 INFO     evaluating now!
2024-05-01 00:02:43 INFO     Epoch [45/200] train_loss: 3.7883, val_loss: 5.3126, lr: 0.003000, 7.37s
2024-05-01 00:02:49 INFO     epoch complete!
2024-05-01 00:02:49 INFO     evaluating now!
2024-05-01 00:02:50 INFO     Epoch [46/200] train_loss: 3.7471, val_loss: 5.1129, lr: 0.003000, 7.36s
2024-05-01 00:02:57 INFO     epoch complete!
2024-05-01 00:02:57 INFO     evaluating now!
2024-05-01 00:02:57 INFO     Epoch [47/200] train_loss: 3.7299, val_loss: 5.3889, lr: 0.003000, 7.02s
2024-05-01 00:03:04 INFO     epoch complete!
2024-05-01 00:03:04 INFO     evaluating now!
2024-05-01 00:03:04 INFO     Epoch [48/200] train_loss: 3.7474, val_loss: 5.1726, lr: 0.003000, 6.99s
2024-05-01 00:03:11 INFO     epoch complete!
2024-05-01 00:03:11 INFO     evaluating now!
2024-05-01 00:03:11 INFO     Epoch [49/200] train_loss: 3.7689, val_loss: 5.3155, lr: 0.003000, 6.97s
2024-05-01 00:03:11 WARNING  Early stopping at epoch: 49
2024-05-01 00:03:11 INFO     Trained totally 50 epochs, average train time is 6.475s, average eval time is 0.450s
2024-05-01 00:03:11 INFO     Loaded model at 34
2024-05-01 00:03:11 INFO     Saved model at ./libcity/cache/56/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 00:03:11 INFO     Start evaluating ...
2024-05-01 00:03:13 INFO     Note that you select the single mode to evaluate!
2024-05-01 00:03:13 INFO     Evaluate result is saved at ./libcity/cache/56/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 00:03:13 INFO     
         MAE       RMSE
1   2.567191   7.838397
2   2.704662   8.435231
3   2.909502   9.403436
4   3.030755  10.098981
5   3.043579  10.539999
6   3.086296  11.034019
7   3.205947  11.801824
8   3.208901  12.348447
9   3.289414  12.856901
10  3.396732  13.487748
11  3.462238  13.833249
12  3.548112  14.087509
2024-05-01 00:03:13 INFO     ----------------------------------------------------------------------------
2024-05-01 00:03:13 INFO     # 2, Kownledge Graph Embedding: TransH, Experiment ids: 57
2024-05-01 00:03:13 INFO     ----------------------------------------------------------------------------
2024-05-01 00:03:13 INFO     Log directory: ./libcity/log
2024-05-01 00:03:13 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=57
2024-05-01 00:03:13 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 490150352, 'exp_id': 57, 'load_external': True, 'embedding_model': 'TransH', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 00:03:13 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 00:03:13 INFO     set_weight_link_or_dist: dist
2024-05-01 00:03:13 INFO     init_weight_inf_or_zero: inf
2024-05-01 00:03:13 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 00:03:13 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 00:03:13 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 00:03:13 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 00:03:16 INFO     Dataset created
2024-05-01 00:03:16 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 00:03:16 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 00:03:16 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 00:03:16 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 00:03:16 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 00:03:16 INFO     NoneScaler
2024-05-01 00:03:18 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 00:03:18 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 00:03:18 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 00:03:18 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 00:03:18 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 00:03:18 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 00:03:18 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 00:03:18 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 00:03:18 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 00:03:18 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 00:03:18 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 00:03:18 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 00:03:18 INFO     Total parameter numbers: 874010
2024-05-01 00:03:18 INFO     You select `adam` optimizer.
2024-05-01 00:03:18 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 00:03:18 INFO     Start training ...
2024-05-01 00:03:18 INFO     num_batches:48
2024-05-01 00:03:25 INFO     epoch complete!
2024-05-01 00:03:25 INFO     evaluating now!
2024-05-01 00:03:25 INFO     Epoch [0/200] train_loss: 24.4645, val_loss: 17.7090, lr: 0.003000, 6.94s
2024-05-01 00:03:25 INFO     Saved model at 0
2024-05-01 00:03:25 INFO     Val loss decrease from inf to 17.7090, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 00:03:32 INFO     epoch complete!
2024-05-01 00:03:32 INFO     evaluating now!
2024-05-01 00:03:32 INFO     Epoch [1/200] train_loss: 14.2225, val_loss: 13.4644, lr: 0.003000, 6.97s
2024-05-01 00:03:32 INFO     Saved model at 1
2024-05-01 00:03:32 INFO     Val loss decrease from 17.7090 to 13.4644, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 00:03:39 INFO     epoch complete!
2024-05-01 00:03:39 INFO     evaluating now!
2024-05-01 00:03:39 INFO     Epoch [2/200] train_loss: 10.9796, val_loss: 10.5697, lr: 0.003000, 6.97s
2024-05-01 00:03:39 INFO     Saved model at 2
2024-05-01 00:03:39 INFO     Val loss decrease from 13.4644 to 10.5697, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 00:03:46 INFO     epoch complete!
2024-05-01 00:03:46 INFO     evaluating now!
2024-05-01 00:03:46 INFO     Epoch [3/200] train_loss: 9.0140, val_loss: 8.9408, lr: 0.003000, 6.87s
2024-05-01 00:03:46 INFO     Saved model at 3
2024-05-01 00:03:46 INFO     Val loss decrease from 10.5697 to 8.9408, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 00:03:53 INFO     epoch complete!
2024-05-01 00:03:53 INFO     evaluating now!
2024-05-01 00:03:53 INFO     Epoch [4/200] train_loss: 7.8261, val_loss: 7.4801, lr: 0.003000, 7.03s
2024-05-01 00:03:53 INFO     Saved model at 4
2024-05-01 00:03:53 INFO     Val loss decrease from 8.9408 to 7.4801, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 00:04:00 INFO     epoch complete!
2024-05-01 00:04:00 INFO     evaluating now!
2024-05-01 00:04:00 INFO     Epoch [5/200] train_loss: 7.0746, val_loss: 6.8473, lr: 0.003000, 6.87s
2024-05-01 00:04:00 INFO     Saved model at 5
2024-05-01 00:04:00 INFO     Val loss decrease from 7.4801 to 6.8473, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 00:04:07 INFO     epoch complete!
2024-05-01 00:04:07 INFO     evaluating now!
2024-05-01 00:04:07 INFO     Epoch [6/200] train_loss: 6.5434, val_loss: 6.6132, lr: 0.003000, 6.90s
2024-05-01 00:04:07 INFO     Saved model at 6
2024-05-01 00:04:07 INFO     Val loss decrease from 6.8473 to 6.6132, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 00:04:13 INFO     epoch complete!
2024-05-01 00:04:13 INFO     evaluating now!
2024-05-01 00:04:14 INFO     Epoch [7/200] train_loss: 6.1542, val_loss: 6.2233, lr: 0.003000, 6.74s
2024-05-01 00:04:14 INFO     Saved model at 7
2024-05-01 00:04:14 INFO     Val loss decrease from 6.6132 to 6.2233, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 00:04:20 INFO     epoch complete!
2024-05-01 00:04:20 INFO     evaluating now!
2024-05-01 00:04:21 INFO     Epoch [8/200] train_loss: 5.9182, val_loss: 6.0550, lr: 0.003000, 6.80s
2024-05-01 00:04:21 INFO     Saved model at 8
2024-05-01 00:04:21 INFO     Val loss decrease from 6.2233 to 6.0550, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-01 00:04:27 INFO     epoch complete!
2024-05-01 00:04:27 INFO     evaluating now!
2024-05-01 00:04:27 INFO     Epoch [9/200] train_loss: 5.8198, val_loss: 6.0995, lr: 0.003000, 6.80s
2024-05-01 00:04:34 INFO     epoch complete!
2024-05-01 00:04:34 INFO     evaluating now!
2024-05-01 00:04:34 INFO     Epoch [10/200] train_loss: 5.5627, val_loss: 5.8267, lr: 0.003000, 6.73s
2024-05-01 00:04:34 INFO     Saved model at 10
2024-05-01 00:04:34 INFO     Val loss decrease from 6.0550 to 5.8267, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-01 00:04:41 INFO     epoch complete!
2024-05-01 00:04:41 INFO     evaluating now!
2024-05-01 00:04:41 INFO     Epoch [11/200] train_loss: 5.4301, val_loss: 5.7951, lr: 0.003000, 6.77s
2024-05-01 00:04:41 INFO     Saved model at 11
2024-05-01 00:04:41 INFO     Val loss decrease from 5.8267 to 5.7951, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-01 00:04:47 INFO     epoch complete!
2024-05-01 00:04:47 INFO     evaluating now!
2024-05-01 00:04:48 INFO     Epoch [12/200] train_loss: 5.3656, val_loss: 5.5700, lr: 0.003000, 6.77s
2024-05-01 00:04:48 INFO     Saved model at 12
2024-05-01 00:04:48 INFO     Val loss decrease from 5.7951 to 5.5700, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-01 00:04:54 INFO     epoch complete!
2024-05-01 00:04:54 INFO     evaluating now!
2024-05-01 00:04:55 INFO     Epoch [13/200] train_loss: 5.1606, val_loss: 5.6117, lr: 0.003000, 6.67s
2024-05-01 00:05:01 INFO     epoch complete!
2024-05-01 00:05:01 INFO     evaluating now!
2024-05-01 00:05:01 INFO     Epoch [14/200] train_loss: 5.1161, val_loss: 5.4670, lr: 0.003000, 6.89s
2024-05-01 00:05:02 INFO     Saved model at 14
2024-05-01 00:05:02 INFO     Val loss decrease from 5.5700 to 5.4670, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-01 00:05:08 INFO     epoch complete!
2024-05-01 00:05:08 INFO     evaluating now!
2024-05-01 00:05:08 INFO     Epoch [15/200] train_loss: 5.0033, val_loss: 5.5590, lr: 0.003000, 6.69s
2024-05-01 00:05:14 INFO     epoch complete!
2024-05-01 00:05:14 INFO     evaluating now!
2024-05-01 00:05:15 INFO     Epoch [16/200] train_loss: 4.9804, val_loss: 5.6272, lr: 0.003000, 6.66s
2024-05-01 00:05:21 INFO     epoch complete!
2024-05-01 00:05:21 INFO     evaluating now!
2024-05-01 00:05:21 INFO     Epoch [17/200] train_loss: 4.8348, val_loss: 5.4442, lr: 0.003000, 6.55s
2024-05-01 00:05:21 INFO     Saved model at 17
2024-05-01 00:05:21 INFO     Val loss decrease from 5.4670 to 5.4442, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-01 00:05:28 INFO     epoch complete!
2024-05-01 00:05:28 INFO     evaluating now!
2024-05-01 00:05:28 INFO     Epoch [18/200] train_loss: 4.7705, val_loss: 5.4004, lr: 0.003000, 6.52s
2024-05-01 00:05:28 INFO     Saved model at 18
2024-05-01 00:05:28 INFO     Val loss decrease from 5.4442 to 5.4004, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-01 00:05:34 INFO     epoch complete!
2024-05-01 00:05:34 INFO     evaluating now!
2024-05-01 00:05:35 INFO     Epoch [19/200] train_loss: 4.7088, val_loss: 5.3934, lr: 0.003000, 6.59s
2024-05-01 00:05:35 INFO     Saved model at 19
2024-05-01 00:05:35 INFO     Val loss decrease from 5.4004 to 5.3934, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-01 00:05:41 INFO     epoch complete!
2024-05-01 00:05:41 INFO     evaluating now!
2024-05-01 00:05:41 INFO     Epoch [20/200] train_loss: 4.7267, val_loss: 5.5581, lr: 0.003000, 6.62s
2024-05-01 00:05:47 INFO     epoch complete!
2024-05-01 00:05:47 INFO     evaluating now!
2024-05-01 00:05:48 INFO     Epoch [21/200] train_loss: 4.5930, val_loss: 5.2889, lr: 0.003000, 6.57s
2024-05-01 00:05:48 INFO     Saved model at 21
2024-05-01 00:05:48 INFO     Val loss decrease from 5.3934 to 5.2889, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-01 00:05:54 INFO     epoch complete!
2024-05-01 00:05:54 INFO     evaluating now!
2024-05-01 00:05:55 INFO     Epoch [22/200] train_loss: 4.5856, val_loss: 5.5222, lr: 0.003000, 6.67s
2024-05-01 00:06:01 INFO     epoch complete!
2024-05-01 00:06:01 INFO     evaluating now!
2024-05-01 00:06:01 INFO     Epoch [23/200] train_loss: 4.4909, val_loss: 5.3714, lr: 0.003000, 6.63s
2024-05-01 00:06:08 INFO     epoch complete!
2024-05-01 00:06:08 INFO     evaluating now!
2024-05-01 00:06:08 INFO     Epoch [24/200] train_loss: 4.4689, val_loss: 5.2839, lr: 0.003000, 6.87s
2024-05-01 00:06:08 INFO     Saved model at 24
2024-05-01 00:06:08 INFO     Val loss decrease from 5.2889 to 5.2839, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-01 00:06:14 INFO     epoch complete!
2024-05-01 00:06:14 INFO     evaluating now!
2024-05-01 00:06:15 INFO     Epoch [25/200] train_loss: 4.3605, val_loss: 5.2503, lr: 0.003000, 6.60s
2024-05-01 00:06:15 INFO     Saved model at 25
2024-05-01 00:06:15 INFO     Val loss decrease from 5.2839 to 5.2503, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-01 00:06:21 INFO     epoch complete!
2024-05-01 00:06:21 INFO     evaluating now!
2024-05-01 00:06:21 INFO     Epoch [26/200] train_loss: 4.3143, val_loss: 5.3944, lr: 0.003000, 6.60s
2024-05-01 00:06:28 INFO     epoch complete!
2024-05-01 00:06:28 INFO     evaluating now!
2024-05-01 00:06:28 INFO     Epoch [27/200] train_loss: 4.4219, val_loss: 5.1637, lr: 0.003000, 6.68s
2024-05-01 00:06:28 INFO     Saved model at 27
2024-05-01 00:06:28 INFO     Val loss decrease from 5.2503 to 5.1637, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-05-01 00:06:34 INFO     epoch complete!
2024-05-01 00:06:34 INFO     evaluating now!
2024-05-01 00:06:35 INFO     Epoch [28/200] train_loss: 4.3042, val_loss: 5.5347, lr: 0.003000, 6.63s
2024-05-01 00:06:41 INFO     epoch complete!
2024-05-01 00:06:41 INFO     evaluating now!
2024-05-01 00:06:41 INFO     Epoch [29/200] train_loss: 4.2070, val_loss: 5.4013, lr: 0.003000, 6.62s
2024-05-01 00:06:48 INFO     epoch complete!
2024-05-01 00:06:48 INFO     evaluating now!
2024-05-01 00:06:48 INFO     Epoch [30/200] train_loss: 4.1718, val_loss: 5.2806, lr: 0.003000, 6.65s
2024-05-01 00:06:54 INFO     epoch complete!
2024-05-01 00:06:54 INFO     evaluating now!
2024-05-01 00:06:55 INFO     Epoch [31/200] train_loss: 4.1524, val_loss: 5.3339, lr: 0.003000, 6.65s
2024-05-01 00:07:01 INFO     epoch complete!
2024-05-01 00:07:01 INFO     evaluating now!
2024-05-01 00:07:01 INFO     Epoch [32/200] train_loss: 4.1053, val_loss: 5.2304, lr: 0.003000, 6.74s
2024-05-01 00:07:08 INFO     epoch complete!
2024-05-01 00:07:08 INFO     evaluating now!
2024-05-01 00:07:08 INFO     Epoch [33/200] train_loss: 4.1020, val_loss: 5.2529, lr: 0.003000, 6.64s
2024-05-01 00:07:14 INFO     epoch complete!
2024-05-01 00:07:14 INFO     evaluating now!
2024-05-01 00:07:15 INFO     Epoch [34/200] train_loss: 3.9996, val_loss: 5.3097, lr: 0.003000, 6.62s
2024-05-01 00:07:21 INFO     epoch complete!
2024-05-01 00:07:21 INFO     evaluating now!
2024-05-01 00:07:21 INFO     Epoch [35/200] train_loss: 4.0660, val_loss: 5.3095, lr: 0.003000, 6.74s
2024-05-01 00:07:28 INFO     epoch complete!
2024-05-01 00:07:28 INFO     evaluating now!
2024-05-01 00:07:28 INFO     Epoch [36/200] train_loss: 4.0020, val_loss: 5.2842, lr: 0.003000, 6.82s
2024-05-01 00:07:34 INFO     epoch complete!
2024-05-01 00:07:34 INFO     evaluating now!
2024-05-01 00:07:35 INFO     Epoch [37/200] train_loss: 3.9177, val_loss: 5.2055, lr: 0.003000, 6.69s
2024-05-01 00:07:41 INFO     epoch complete!
2024-05-01 00:07:41 INFO     evaluating now!
2024-05-01 00:07:42 INFO     Epoch [38/200] train_loss: 3.9123, val_loss: 5.2316, lr: 0.003000, 6.68s
2024-05-01 00:07:48 INFO     epoch complete!
2024-05-01 00:07:48 INFO     evaluating now!
2024-05-01 00:07:48 INFO     Epoch [39/200] train_loss: 3.8388, val_loss: 5.2259, lr: 0.003000, 6.60s
2024-05-01 00:07:55 INFO     epoch complete!
2024-05-01 00:07:55 INFO     evaluating now!
2024-05-01 00:07:55 INFO     Epoch [40/200] train_loss: 3.9104, val_loss: 5.0581, lr: 0.003000, 6.80s
2024-05-01 00:07:55 INFO     Saved model at 40
2024-05-01 00:07:55 INFO     Val loss decrease from 5.1637 to 5.0581, saving to ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-05-01 00:08:01 INFO     epoch complete!
2024-05-01 00:08:01 INFO     evaluating now!
2024-05-01 00:08:02 INFO     Epoch [41/200] train_loss: 3.8093, val_loss: 5.0941, lr: 0.003000, 6.74s
2024-05-01 00:08:08 INFO     epoch complete!
2024-05-01 00:08:08 INFO     evaluating now!
2024-05-01 00:08:08 INFO     Epoch [42/200] train_loss: 3.8119, val_loss: 5.2126, lr: 0.003000, 6.73s
2024-05-01 00:08:15 INFO     epoch complete!
2024-05-01 00:08:15 INFO     evaluating now!
2024-05-01 00:08:15 INFO     Epoch [43/200] train_loss: 3.7956, val_loss: 5.1382, lr: 0.003000, 6.72s
2024-05-01 00:08:21 INFO     epoch complete!
2024-05-01 00:08:21 INFO     evaluating now!
2024-05-01 00:08:21 INFO     Epoch [44/200] train_loss: 3.7171, val_loss: 5.1778, lr: 0.003000, 6.28s
2024-05-01 00:08:27 INFO     epoch complete!
2024-05-01 00:08:27 INFO     evaluating now!
2024-05-01 00:08:28 INFO     Epoch [45/200] train_loss: 3.7248, val_loss: 5.2078, lr: 0.003000, 6.24s
2024-05-01 00:08:34 INFO     epoch complete!
2024-05-01 00:08:34 INFO     evaluating now!
2024-05-01 00:08:34 INFO     Epoch [46/200] train_loss: 3.6844, val_loss: 5.1596, lr: 0.003000, 6.30s
2024-05-01 00:08:40 INFO     epoch complete!
2024-05-01 00:08:40 INFO     evaluating now!
2024-05-01 00:08:40 INFO     Epoch [47/200] train_loss: 3.6877, val_loss: 5.1649, lr: 0.003000, 6.29s
2024-05-01 00:08:46 INFO     epoch complete!
2024-05-01 00:08:46 INFO     evaluating now!
2024-05-01 00:08:47 INFO     Epoch [48/200] train_loss: 3.6760, val_loss: 5.1262, lr: 0.003000, 6.25s
2024-05-01 00:08:52 INFO     epoch complete!
2024-05-01 00:08:52 INFO     evaluating now!
2024-05-01 00:08:53 INFO     Epoch [49/200] train_loss: 3.7292, val_loss: 5.1793, lr: 0.003000, 6.21s
2024-05-01 00:08:59 INFO     epoch complete!
2024-05-01 00:08:59 INFO     evaluating now!
2024-05-01 00:09:00 INFO     Epoch [50/200] train_loss: 3.6375, val_loss: 5.1786, lr: 0.003000, 6.88s
2024-05-01 00:09:06 INFO     epoch complete!
2024-05-01 00:09:06 INFO     evaluating now!
2024-05-01 00:09:07 INFO     Epoch [51/200] train_loss: 3.5813, val_loss: 5.1273, lr: 0.003000, 6.95s
2024-05-01 00:09:13 INFO     epoch complete!
2024-05-01 00:09:13 INFO     evaluating now!
2024-05-01 00:09:14 INFO     Epoch [52/200] train_loss: 3.5686, val_loss: 5.2221, lr: 0.003000, 6.88s
2024-05-01 00:09:20 INFO     epoch complete!
2024-05-01 00:09:20 INFO     evaluating now!
2024-05-01 00:09:20 INFO     Epoch [53/200] train_loss: 3.6099, val_loss: 5.0805, lr: 0.003000, 6.79s
2024-05-01 00:09:27 INFO     epoch complete!
2024-05-01 00:09:27 INFO     evaluating now!
2024-05-01 00:09:27 INFO     Epoch [54/200] train_loss: 3.5793, val_loss: 5.0993, lr: 0.003000, 6.88s
2024-05-01 00:09:34 INFO     epoch complete!
2024-05-01 00:09:34 INFO     evaluating now!
2024-05-01 00:09:34 INFO     Epoch [55/200] train_loss: 3.5318, val_loss: 5.0965, lr: 0.003000, 6.88s
2024-05-01 00:09:34 WARNING  Early stopping at epoch: 55
2024-05-01 00:09:34 INFO     Trained totally 56 epochs, average train time is 6.248s, average eval time is 0.443s
2024-05-01 00:09:34 INFO     Loaded model at 40
2024-05-01 00:09:34 INFO     Saved model at ./libcity/cache/57/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 00:09:34 INFO     Start evaluating ...
2024-05-01 00:09:36 INFO     Note that you select the single mode to evaluate!
2024-05-01 00:09:36 INFO     Evaluate result is saved at ./libcity/cache/57/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 00:09:36 INFO     
         MAE       RMSE
1   2.620341   8.038850
2   2.629062   8.530560
3   2.733566   9.241588
4   2.845147   9.728789
5   2.935010  10.232771
6   3.036358  10.997492
7   3.148890  11.926503
8   3.242375  12.582877
9   3.267350  12.890514
10  3.299509  13.080638
11  3.421366  13.252371
12  3.476029  13.547036
2024-05-01 00:09:36 INFO     ----------------------------------------------------------------------------
2024-05-01 00:09:36 INFO     # 3, Kownledge Graph Embedding: TransH, Experiment ids: 58
2024-05-01 00:09:36 INFO     ----------------------------------------------------------------------------
2024-05-01 00:09:36 INFO     Log directory: ./libcity/log
2024-05-01 00:09:36 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=58
2024-05-01 00:09:36 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 95166801, 'exp_id': 58, 'load_external': True, 'embedding_model': 'TransH', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 00:09:36 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 00:09:36 INFO     set_weight_link_or_dist: dist
2024-05-01 00:09:36 INFO     init_weight_inf_or_zero: inf
2024-05-01 00:09:36 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 00:09:36 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 00:09:36 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 00:09:36 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 00:09:39 INFO     Dataset created
2024-05-01 00:09:39 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 00:09:39 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 00:09:39 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 00:09:39 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 00:09:39 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 00:09:39 INFO     NoneScaler
2024-05-01 00:09:42 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 00:09:42 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 00:09:42 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 00:09:42 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 00:09:42 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 00:09:42 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 00:09:42 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 00:09:42 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 00:09:42 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 00:09:42 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 00:09:42 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 00:09:42 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 00:09:42 INFO     Total parameter numbers: 874010
2024-05-01 00:09:42 INFO     You select `adam` optimizer.
2024-05-01 00:09:42 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 00:09:42 INFO     Start training ...
2024-05-01 00:09:42 INFO     num_batches:48
2024-05-01 00:09:49 INFO     epoch complete!
2024-05-01 00:09:49 INFO     evaluating now!
2024-05-01 00:09:50 INFO     Epoch [0/200] train_loss: 23.8218, val_loss: 17.9288, lr: 0.003000, 8.03s
2024-05-01 00:09:50 INFO     Saved model at 0
2024-05-01 00:09:50 INFO     Val loss decrease from inf to 17.9288, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 00:09:57 INFO     epoch complete!
2024-05-01 00:09:57 INFO     evaluating now!
2024-05-01 00:09:57 INFO     Epoch [1/200] train_loss: 14.5021, val_loss: 13.6572, lr: 0.003000, 7.50s
2024-05-01 00:09:58 INFO     Saved model at 1
2024-05-01 00:09:58 INFO     Val loss decrease from 17.9288 to 13.6572, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 00:10:04 INFO     epoch complete!
2024-05-01 00:10:04 INFO     evaluating now!
2024-05-01 00:10:05 INFO     Epoch [2/200] train_loss: 11.2835, val_loss: 11.1192, lr: 0.003000, 7.09s
2024-05-01 00:10:05 INFO     Saved model at 2
2024-05-01 00:10:05 INFO     Val loss decrease from 13.6572 to 11.1192, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 00:10:11 INFO     epoch complete!
2024-05-01 00:10:11 INFO     evaluating now!
2024-05-01 00:10:12 INFO     Epoch [3/200] train_loss: 9.4720, val_loss: 9.1161, lr: 0.003000, 7.10s
2024-05-01 00:10:12 INFO     Saved model at 3
2024-05-01 00:10:12 INFO     Val loss decrease from 11.1192 to 9.1161, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 00:10:18 INFO     epoch complete!
2024-05-01 00:10:18 INFO     evaluating now!
2024-05-01 00:10:19 INFO     Epoch [4/200] train_loss: 8.2053, val_loss: 7.9222, lr: 0.003000, 6.97s
2024-05-01 00:10:19 INFO     Saved model at 4
2024-05-01 00:10:19 INFO     Val loss decrease from 9.1161 to 7.9222, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 00:10:25 INFO     epoch complete!
2024-05-01 00:10:25 INFO     evaluating now!
2024-05-01 00:10:26 INFO     Epoch [5/200] train_loss: 7.3901, val_loss: 7.4031, lr: 0.003000, 7.07s
2024-05-01 00:10:26 INFO     Saved model at 5
2024-05-01 00:10:26 INFO     Val loss decrease from 7.9222 to 7.4031, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 00:10:32 INFO     epoch complete!
2024-05-01 00:10:32 INFO     evaluating now!
2024-05-01 00:10:33 INFO     Epoch [6/200] train_loss: 6.9418, val_loss: 6.9233, lr: 0.003000, 6.80s
2024-05-01 00:10:33 INFO     Saved model at 6
2024-05-01 00:10:33 INFO     Val loss decrease from 7.4031 to 6.9233, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 00:10:39 INFO     epoch complete!
2024-05-01 00:10:39 INFO     evaluating now!
2024-05-01 00:10:40 INFO     Epoch [7/200] train_loss: 6.4436, val_loss: 6.7072, lr: 0.003000, 6.75s
2024-05-01 00:10:40 INFO     Saved model at 7
2024-05-01 00:10:40 INFO     Val loss decrease from 6.9233 to 6.7072, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 00:10:46 INFO     epoch complete!
2024-05-01 00:10:46 INFO     evaluating now!
2024-05-01 00:10:47 INFO     Epoch [8/200] train_loss: 6.2031, val_loss: 6.2834, lr: 0.003000, 6.77s
2024-05-01 00:10:47 INFO     Saved model at 8
2024-05-01 00:10:47 INFO     Val loss decrease from 6.7072 to 6.2834, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-01 00:10:53 INFO     epoch complete!
2024-05-01 00:10:53 INFO     evaluating now!
2024-05-01 00:10:53 INFO     Epoch [9/200] train_loss: 6.0383, val_loss: 6.0368, lr: 0.003000, 6.77s
2024-05-01 00:10:53 INFO     Saved model at 9
2024-05-01 00:10:53 INFO     Val loss decrease from 6.2834 to 6.0368, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-01 00:11:00 INFO     epoch complete!
2024-05-01 00:11:00 INFO     evaluating now!
2024-05-01 00:11:00 INFO     Epoch [10/200] train_loss: 5.7936, val_loss: 6.1978, lr: 0.003000, 6.75s
2024-05-01 00:11:06 INFO     epoch complete!
2024-05-01 00:11:06 INFO     evaluating now!
2024-05-01 00:11:07 INFO     Epoch [11/200] train_loss: 5.6446, val_loss: 5.9225, lr: 0.003000, 6.69s
2024-05-01 00:11:07 INFO     Saved model at 11
2024-05-01 00:11:07 INFO     Val loss decrease from 6.0368 to 5.9225, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-01 00:11:13 INFO     epoch complete!
2024-05-01 00:11:13 INFO     evaluating now!
2024-05-01 00:11:14 INFO     Epoch [12/200] train_loss: 5.5010, val_loss: 5.6387, lr: 0.003000, 6.75s
2024-05-01 00:11:14 INFO     Saved model at 12
2024-05-01 00:11:14 INFO     Val loss decrease from 5.9225 to 5.6387, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-01 00:11:20 INFO     epoch complete!
2024-05-01 00:11:20 INFO     evaluating now!
2024-05-01 00:11:20 INFO     Epoch [13/200] train_loss: 5.3660, val_loss: 5.7680, lr: 0.003000, 6.72s
2024-05-01 00:11:27 INFO     epoch complete!
2024-05-01 00:11:27 INFO     evaluating now!
2024-05-01 00:11:27 INFO     Epoch [14/200] train_loss: 5.3857, val_loss: 5.5689, lr: 0.003000, 6.78s
2024-05-01 00:11:27 INFO     Saved model at 14
2024-05-01 00:11:27 INFO     Val loss decrease from 5.6387 to 5.5689, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-01 00:11:34 INFO     epoch complete!
2024-05-01 00:11:34 INFO     evaluating now!
2024-05-01 00:11:34 INFO     Epoch [15/200] train_loss: 5.1806, val_loss: 5.4858, lr: 0.003000, 6.97s
2024-05-01 00:11:34 INFO     Saved model at 15
2024-05-01 00:11:34 INFO     Val loss decrease from 5.5689 to 5.4858, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-01 00:11:41 INFO     epoch complete!
2024-05-01 00:11:41 INFO     evaluating now!
2024-05-01 00:11:41 INFO     Epoch [16/200] train_loss: 5.0863, val_loss: 5.6150, lr: 0.003000, 7.01s
2024-05-01 00:11:48 INFO     epoch complete!
2024-05-01 00:11:48 INFO     evaluating now!
2024-05-01 00:11:48 INFO     Epoch [17/200] train_loss: 5.0650, val_loss: 5.8048, lr: 0.003000, 6.96s
2024-05-01 00:11:55 INFO     epoch complete!
2024-05-01 00:11:55 INFO     evaluating now!
2024-05-01 00:11:55 INFO     Epoch [18/200] train_loss: 5.0459, val_loss: 5.4197, lr: 0.003000, 7.10s
2024-05-01 00:11:55 INFO     Saved model at 18
2024-05-01 00:11:55 INFO     Val loss decrease from 5.4858 to 5.4197, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-01 00:12:02 INFO     epoch complete!
2024-05-01 00:12:02 INFO     evaluating now!
2024-05-01 00:12:02 INFO     Epoch [19/200] train_loss: 4.8901, val_loss: 5.3485, lr: 0.003000, 6.81s
2024-05-01 00:12:02 INFO     Saved model at 19
2024-05-01 00:12:02 INFO     Val loss decrease from 5.4197 to 5.3485, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-01 00:12:09 INFO     epoch complete!
2024-05-01 00:12:09 INFO     evaluating now!
2024-05-01 00:12:09 INFO     Epoch [20/200] train_loss: 4.7593, val_loss: 5.5267, lr: 0.003000, 6.73s
2024-05-01 00:12:15 INFO     epoch complete!
2024-05-01 00:12:15 INFO     evaluating now!
2024-05-01 00:12:16 INFO     Epoch [21/200] train_loss: 4.7625, val_loss: 5.3774, lr: 0.003000, 6.78s
2024-05-01 00:12:22 INFO     epoch complete!
2024-05-01 00:12:22 INFO     evaluating now!
2024-05-01 00:12:23 INFO     Epoch [22/200] train_loss: 4.7179, val_loss: 5.4083, lr: 0.003000, 6.84s
2024-05-01 00:12:29 INFO     epoch complete!
2024-05-01 00:12:29 INFO     evaluating now!
2024-05-01 00:12:29 INFO     Epoch [23/200] train_loss: 4.6808, val_loss: 5.4334, lr: 0.003000, 6.85s
2024-05-01 00:12:36 INFO     epoch complete!
2024-05-01 00:12:36 INFO     evaluating now!
2024-05-01 00:12:36 INFO     Epoch [24/200] train_loss: 4.6079, val_loss: 5.2206, lr: 0.003000, 6.95s
2024-05-01 00:12:36 INFO     Saved model at 24
2024-05-01 00:12:36 INFO     Val loss decrease from 5.3485 to 5.2206, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-01 00:12:43 INFO     epoch complete!
2024-05-01 00:12:43 INFO     evaluating now!
2024-05-01 00:12:43 INFO     Epoch [25/200] train_loss: 4.5246, val_loss: 5.3480, lr: 0.003000, 6.89s
2024-05-01 00:12:50 INFO     epoch complete!
2024-05-01 00:12:50 INFO     evaluating now!
2024-05-01 00:12:50 INFO     Epoch [26/200] train_loss: 4.5002, val_loss: 5.2693, lr: 0.003000, 6.76s
2024-05-01 00:12:56 INFO     epoch complete!
2024-05-01 00:12:56 INFO     evaluating now!
2024-05-01 00:12:57 INFO     Epoch [27/200] train_loss: 4.4102, val_loss: 5.2059, lr: 0.003000, 6.75s
2024-05-01 00:12:57 INFO     Saved model at 27
2024-05-01 00:12:57 INFO     Val loss decrease from 5.2206 to 5.2059, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-05-01 00:13:03 INFO     epoch complete!
2024-05-01 00:13:03 INFO     evaluating now!
2024-05-01 00:13:04 INFO     Epoch [28/200] train_loss: 4.3448, val_loss: 5.2150, lr: 0.003000, 6.95s
2024-05-01 00:13:11 INFO     epoch complete!
2024-05-01 00:13:11 INFO     evaluating now!
2024-05-01 00:13:11 INFO     Epoch [29/200] train_loss: 4.4440, val_loss: 5.4866, lr: 0.003000, 7.57s
2024-05-01 00:13:18 INFO     epoch complete!
2024-05-01 00:13:18 INFO     evaluating now!
2024-05-01 00:13:19 INFO     Epoch [30/200] train_loss: 4.3579, val_loss: 5.2748, lr: 0.003000, 7.60s
2024-05-01 00:13:26 INFO     epoch complete!
2024-05-01 00:13:26 INFO     evaluating now!
2024-05-01 00:13:26 INFO     Epoch [31/200] train_loss: 4.2841, val_loss: 5.1901, lr: 0.003000, 7.45s
2024-05-01 00:13:27 INFO     Saved model at 31
2024-05-01 00:13:27 INFO     Val loss decrease from 5.2059 to 5.1901, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-05-01 00:13:34 INFO     epoch complete!
2024-05-01 00:13:34 INFO     evaluating now!
2024-05-01 00:13:34 INFO     Epoch [32/200] train_loss: 4.2103, val_loss: 5.2871, lr: 0.003000, 7.64s
2024-05-01 00:13:41 INFO     epoch complete!
2024-05-01 00:13:41 INFO     evaluating now!
2024-05-01 00:13:42 INFO     Epoch [33/200] train_loss: 4.1559, val_loss: 5.1122, lr: 0.003000, 7.58s
2024-05-01 00:13:42 INFO     Saved model at 33
2024-05-01 00:13:42 INFO     Val loss decrease from 5.1901 to 5.1122, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-05-01 00:13:49 INFO     epoch complete!
2024-05-01 00:13:49 INFO     evaluating now!
2024-05-01 00:13:49 INFO     Epoch [34/200] train_loss: 4.1461, val_loss: 5.2634, lr: 0.003000, 7.45s
2024-05-01 00:13:56 INFO     epoch complete!
2024-05-01 00:13:56 INFO     evaluating now!
2024-05-01 00:13:57 INFO     Epoch [35/200] train_loss: 4.1545, val_loss: 5.2387, lr: 0.003000, 7.40s
2024-05-01 00:14:04 INFO     epoch complete!
2024-05-01 00:14:04 INFO     evaluating now!
2024-05-01 00:14:04 INFO     Epoch [36/200] train_loss: 4.1272, val_loss: 5.3200, lr: 0.003000, 7.35s
2024-05-01 00:14:10 INFO     epoch complete!
2024-05-01 00:14:10 INFO     evaluating now!
2024-05-01 00:14:11 INFO     Epoch [37/200] train_loss: 4.0571, val_loss: 5.0671, lr: 0.003000, 6.62s
2024-05-01 00:14:11 INFO     Saved model at 37
2024-05-01 00:14:11 INFO     Val loss decrease from 5.1122 to 5.0671, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-05-01 00:14:17 INFO     epoch complete!
2024-05-01 00:14:17 INFO     evaluating now!
2024-05-01 00:14:17 INFO     Epoch [38/200] train_loss: 4.0477, val_loss: 5.2407, lr: 0.003000, 6.78s
2024-05-01 00:14:24 INFO     epoch complete!
2024-05-01 00:14:24 INFO     evaluating now!
2024-05-01 00:14:24 INFO     Epoch [39/200] train_loss: 3.9718, val_loss: 5.1183, lr: 0.003000, 6.73s
2024-05-01 00:14:31 INFO     epoch complete!
2024-05-01 00:14:31 INFO     evaluating now!
2024-05-01 00:14:31 INFO     Epoch [40/200] train_loss: 4.0148, val_loss: 5.0207, lr: 0.003000, 6.98s
2024-05-01 00:14:36 INFO     Saved model at 40
2024-05-01 00:14:36 INFO     Val loss decrease from 5.0671 to 5.0207, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-05-01 00:14:43 INFO     epoch complete!
2024-05-01 00:14:43 INFO     evaluating now!
2024-05-01 00:14:43 INFO     Epoch [41/200] train_loss: 3.9237, val_loss: 4.9745, lr: 0.003000, 7.38s
2024-05-01 00:14:43 INFO     Saved model at 41
2024-05-01 00:14:43 INFO     Val loss decrease from 5.0207 to 4.9745, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-05-01 00:14:50 INFO     epoch complete!
2024-05-01 00:14:50 INFO     evaluating now!
2024-05-01 00:14:50 INFO     Epoch [42/200] train_loss: 3.9215, val_loss: 5.2285, lr: 0.003000, 6.84s
2024-05-01 00:14:56 INFO     epoch complete!
2024-05-01 00:14:56 INFO     evaluating now!
2024-05-01 00:14:56 INFO     Epoch [43/200] train_loss: 3.8708, val_loss: 5.0368, lr: 0.003000, 6.42s
2024-05-01 00:15:02 INFO     epoch complete!
2024-05-01 00:15:02 INFO     evaluating now!
2024-05-01 00:15:03 INFO     Epoch [44/200] train_loss: 3.8783, val_loss: 5.1917, lr: 0.003000, 6.47s
2024-05-01 00:15:09 INFO     epoch complete!
2024-05-01 00:15:09 INFO     evaluating now!
2024-05-01 00:15:09 INFO     Epoch [45/200] train_loss: 3.8774, val_loss: 5.0710, lr: 0.003000, 6.40s
2024-05-01 00:15:15 INFO     epoch complete!
2024-05-01 00:15:15 INFO     evaluating now!
2024-05-01 00:15:16 INFO     Epoch [46/200] train_loss: 3.8011, val_loss: 5.0807, lr: 0.003000, 6.56s
2024-05-01 00:15:23 INFO     epoch complete!
2024-05-01 00:15:23 INFO     evaluating now!
2024-05-01 00:15:23 INFO     Epoch [47/200] train_loss: 3.8001, val_loss: 5.1799, lr: 0.003000, 7.57s
2024-05-01 00:15:30 INFO     epoch complete!
2024-05-01 00:15:30 INFO     evaluating now!
2024-05-01 00:15:31 INFO     Epoch [48/200] train_loss: 3.8622, val_loss: 5.1172, lr: 0.003000, 7.40s
2024-05-01 00:15:38 INFO     epoch complete!
2024-05-01 00:15:38 INFO     evaluating now!
2024-05-01 00:15:39 INFO     Epoch [49/200] train_loss: 3.7442, val_loss: 5.0201, lr: 0.003000, 7.79s
2024-05-01 00:15:46 INFO     epoch complete!
2024-05-01 00:15:46 INFO     evaluating now!
2024-05-01 00:15:46 INFO     Epoch [50/200] train_loss: 3.7262, val_loss: 4.9524, lr: 0.003000, 7.41s
2024-05-01 00:15:46 INFO     Saved model at 50
2024-05-01 00:15:46 INFO     Val loss decrease from 4.9745 to 4.9524, saving to ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406_epoch50.tar
2024-05-01 00:15:53 INFO     epoch complete!
2024-05-01 00:15:53 INFO     evaluating now!
2024-05-01 00:15:54 INFO     Epoch [51/200] train_loss: 3.7203, val_loss: 5.1610, lr: 0.003000, 7.42s
2024-05-01 00:16:00 INFO     epoch complete!
2024-05-01 00:16:00 INFO     evaluating now!
2024-05-01 00:16:01 INFO     Epoch [52/200] train_loss: 3.7128, val_loss: 5.0210, lr: 0.003000, 7.42s
2024-05-01 00:16:08 INFO     epoch complete!
2024-05-01 00:16:08 INFO     evaluating now!
2024-05-01 00:16:08 INFO     Epoch [53/200] train_loss: 3.6526, val_loss: 5.0417, lr: 0.003000, 7.33s
2024-05-01 00:16:15 INFO     epoch complete!
2024-05-01 00:16:15 INFO     evaluating now!
2024-05-01 00:16:16 INFO     Epoch [54/200] train_loss: 3.6520, val_loss: 5.0854, lr: 0.003000, 7.59s
2024-05-01 00:16:23 INFO     epoch complete!
2024-05-01 00:16:23 INFO     evaluating now!
2024-05-01 00:16:23 INFO     Epoch [55/200] train_loss: 3.6465, val_loss: 4.9995, lr: 0.003000, 7.46s
2024-05-01 00:16:30 INFO     epoch complete!
2024-05-01 00:16:30 INFO     evaluating now!
2024-05-01 00:16:31 INFO     Epoch [56/200] train_loss: 3.6046, val_loss: 5.0213, lr: 0.003000, 7.31s
2024-05-01 00:16:38 INFO     epoch complete!
2024-05-01 00:16:38 INFO     evaluating now!
2024-05-01 00:16:38 INFO     Epoch [57/200] train_loss: 3.6255, val_loss: 5.0162, lr: 0.003000, 7.48s
2024-05-01 00:16:45 INFO     epoch complete!
2024-05-01 00:16:45 INFO     evaluating now!
2024-05-01 00:16:45 INFO     Epoch [58/200] train_loss: 3.5863, val_loss: 4.9686, lr: 0.003000, 7.34s
2024-05-01 00:16:52 INFO     epoch complete!
2024-05-01 00:16:52 INFO     evaluating now!
2024-05-01 00:16:53 INFO     Epoch [59/200] train_loss: 3.5567, val_loss: 5.0845, lr: 0.003000, 7.36s
2024-05-01 00:17:00 INFO     epoch complete!
2024-05-01 00:17:00 INFO     evaluating now!
2024-05-01 00:17:00 INFO     Epoch [60/200] train_loss: 3.5395, val_loss: 5.1330, lr: 0.003000, 7.48s
2024-05-01 00:17:07 INFO     epoch complete!
2024-05-01 00:17:07 INFO     evaluating now!
2024-05-01 00:17:08 INFO     Epoch [61/200] train_loss: 3.5153, val_loss: 4.9725, lr: 0.003000, 7.35s
2024-05-01 00:17:15 INFO     epoch complete!
2024-05-01 00:17:15 INFO     evaluating now!
2024-05-01 00:17:15 INFO     Epoch [62/200] train_loss: 3.5353, val_loss: 4.9670, lr: 0.003000, 7.40s
2024-05-01 00:17:22 INFO     epoch complete!
2024-05-01 00:17:22 INFO     evaluating now!
2024-05-01 00:17:22 INFO     Epoch [63/200] train_loss: 3.5250, val_loss: 5.2094, lr: 0.003000, 7.34s
2024-05-01 00:17:29 INFO     epoch complete!
2024-05-01 00:17:29 INFO     evaluating now!
2024-05-01 00:17:30 INFO     Epoch [64/200] train_loss: 3.4803, val_loss: 5.0945, lr: 0.003000, 7.48s
2024-05-01 00:17:37 INFO     epoch complete!
2024-05-01 00:17:37 INFO     evaluating now!
2024-05-01 00:17:37 INFO     Epoch [65/200] train_loss: 3.4942, val_loss: 5.0485, lr: 0.003000, 7.40s
2024-05-01 00:17:37 WARNING  Early stopping at epoch: 65
2024-05-01 00:17:37 INFO     Trained totally 66 epochs, average train time is 6.633s, average eval time is 0.477s
2024-05-01 00:17:37 INFO     Loaded model at 50
2024-05-01 00:17:37 INFO     Saved model at ./libcity/cache/58/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 00:17:37 INFO     Start evaluating ...
2024-05-01 00:17:39 INFO     Note that you select the single mode to evaluate!
2024-05-01 00:17:39 INFO     Evaluate result is saved at ./libcity/cache/58/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 00:17:39 INFO     
         MAE       RMSE
1   2.257034   6.867753
2   2.410883   7.678724
3   2.587467   8.942273
4   2.805814  10.209715
5   2.993357  11.289799
6   3.066313  12.179421
7   3.170359  12.712147
8   3.192063  12.905438
9   3.214275  12.944402
10  3.236730  13.233510
11  3.355414  13.558620
12  3.574125  14.217982
2024-05-01 00:17:39 INFO     ----------------------------------------------------------------------------
2024-05-01 00:17:39 INFO     # 4, Kownledge Graph Embedding: TransH, Experiment ids: 59
2024-05-01 00:17:39 INFO     ----------------------------------------------------------------------------
2024-05-01 00:17:39 INFO     Log directory: ./libcity/log
2024-05-01 00:17:39 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=59
2024-05-01 00:17:39 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 446293054, 'exp_id': 59, 'load_external': True, 'embedding_model': 'TransH', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 00:17:39 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 00:17:39 INFO     set_weight_link_or_dist: dist
2024-05-01 00:17:39 INFO     init_weight_inf_or_zero: inf
2024-05-01 00:17:39 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 00:17:39 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 00:17:39 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 00:17:40 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 00:17:43 INFO     Dataset created
2024-05-01 00:17:43 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 00:17:43 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 00:17:43 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 00:17:43 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 00:17:43 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 00:17:43 INFO     NoneScaler
2024-05-01 00:17:45 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 00:17:45 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 00:17:45 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 00:17:45 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 00:17:45 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 00:17:45 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 00:17:45 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 00:17:45 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 00:17:45 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 00:17:45 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 00:17:45 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 00:17:45 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 00:17:45 INFO     Total parameter numbers: 874010
2024-05-01 00:17:45 INFO     You select `adam` optimizer.
2024-05-01 00:17:45 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 00:17:45 INFO     Start training ...
2024-05-01 00:17:45 INFO     num_batches:48
2024-05-01 00:17:52 INFO     epoch complete!
2024-05-01 00:17:52 INFO     evaluating now!
2024-05-01 00:17:53 INFO     Epoch [0/200] train_loss: 25.3057, val_loss: 17.6846, lr: 0.003000, 7.93s
2024-05-01 00:17:53 INFO     Saved model at 0
2024-05-01 00:17:53 INFO     Val loss decrease from inf to 17.6846, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 00:18:00 INFO     epoch complete!
2024-05-01 00:18:00 INFO     evaluating now!
2024-05-01 00:18:01 INFO     Epoch [1/200] train_loss: 14.6958, val_loss: 14.6801, lr: 0.003000, 7.66s
2024-05-01 00:18:01 INFO     Saved model at 1
2024-05-01 00:18:01 INFO     Val loss decrease from 17.6846 to 14.6801, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 00:18:08 INFO     epoch complete!
2024-05-01 00:18:08 INFO     evaluating now!
2024-05-01 00:18:08 INFO     Epoch [2/200] train_loss: 12.0284, val_loss: 11.5572, lr: 0.003000, 7.45s
2024-05-01 00:18:08 INFO     Saved model at 2
2024-05-01 00:18:08 INFO     Val loss decrease from 14.6801 to 11.5572, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 00:18:15 INFO     epoch complete!
2024-05-01 00:18:15 INFO     evaluating now!
2024-05-01 00:18:15 INFO     Epoch [3/200] train_loss: 9.9894, val_loss: 9.7193, lr: 0.003000, 7.36s
2024-05-01 00:18:16 INFO     Saved model at 3
2024-05-01 00:18:16 INFO     Val loss decrease from 11.5572 to 9.7193, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 00:18:22 INFO     epoch complete!
2024-05-01 00:18:22 INFO     evaluating now!
2024-05-01 00:18:23 INFO     Epoch [4/200] train_loss: 8.6597, val_loss: 8.3720, lr: 0.003000, 7.29s
2024-05-01 00:18:23 INFO     Saved model at 4
2024-05-01 00:18:23 INFO     Val loss decrease from 9.7193 to 8.3720, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 00:18:30 INFO     epoch complete!
2024-05-01 00:18:30 INFO     evaluating now!
2024-05-01 00:18:30 INFO     Epoch [5/200] train_loss: 7.7789, val_loss: 7.5201, lr: 0.003000, 7.48s
2024-05-01 00:18:30 INFO     Saved model at 5
2024-05-01 00:18:30 INFO     Val loss decrease from 8.3720 to 7.5201, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 00:18:37 INFO     epoch complete!
2024-05-01 00:18:37 INFO     evaluating now!
2024-05-01 00:18:38 INFO     Epoch [6/200] train_loss: 7.0436, val_loss: 6.9401, lr: 0.003000, 7.34s
2024-05-01 00:18:38 INFO     Saved model at 6
2024-05-01 00:18:38 INFO     Val loss decrease from 7.5201 to 6.9401, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 00:18:45 INFO     epoch complete!
2024-05-01 00:18:45 INFO     evaluating now!
2024-05-01 00:18:45 INFO     Epoch [7/200] train_loss: 6.6051, val_loss: 6.6139, lr: 0.003000, 7.36s
2024-05-01 00:18:45 INFO     Saved model at 7
2024-05-01 00:18:45 INFO     Val loss decrease from 6.9401 to 6.6139, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 00:18:52 INFO     epoch complete!
2024-05-01 00:18:52 INFO     evaluating now!
2024-05-01 00:18:53 INFO     Epoch [8/200] train_loss: 6.3863, val_loss: 6.4614, lr: 0.003000, 7.49s
2024-05-01 00:18:53 INFO     Saved model at 8
2024-05-01 00:18:53 INFO     Val loss decrease from 6.6139 to 6.4614, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-01 00:19:00 INFO     epoch complete!
2024-05-01 00:19:00 INFO     evaluating now!
2024-05-01 00:19:00 INFO     Epoch [9/200] train_loss: 6.0451, val_loss: 6.2567, lr: 0.003000, 7.43s
2024-05-01 00:19:00 INFO     Saved model at 9
2024-05-01 00:19:00 INFO     Val loss decrease from 6.4614 to 6.2567, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-01 00:19:07 INFO     epoch complete!
2024-05-01 00:19:07 INFO     evaluating now!
2024-05-01 00:19:08 INFO     Epoch [10/200] train_loss: 5.8857, val_loss: 6.0372, lr: 0.003000, 7.52s
2024-05-01 00:19:08 INFO     Saved model at 10
2024-05-01 00:19:08 INFO     Val loss decrease from 6.2567 to 6.0372, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-01 00:19:15 INFO     epoch complete!
2024-05-01 00:19:15 INFO     evaluating now!
2024-05-01 00:19:16 INFO     Epoch [11/200] train_loss: 5.7496, val_loss: 5.8793, lr: 0.003000, 8.09s
2024-05-01 00:19:16 INFO     Saved model at 11
2024-05-01 00:19:16 INFO     Val loss decrease from 6.0372 to 5.8793, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-01 00:19:23 INFO     epoch complete!
2024-05-01 00:19:23 INFO     evaluating now!
2024-05-01 00:19:23 INFO     Epoch [12/200] train_loss: 5.5328, val_loss: 5.8377, lr: 0.003000, 7.57s
2024-05-01 00:19:24 INFO     Saved model at 12
2024-05-01 00:19:24 INFO     Val loss decrease from 5.8793 to 5.8377, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-01 00:19:30 INFO     epoch complete!
2024-05-01 00:19:30 INFO     evaluating now!
2024-05-01 00:19:31 INFO     Epoch [13/200] train_loss: 5.4543, val_loss: 5.7589, lr: 0.003000, 7.35s
2024-05-01 00:19:31 INFO     Saved model at 13
2024-05-01 00:19:31 INFO     Val loss decrease from 5.8377 to 5.7589, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-01 00:19:38 INFO     epoch complete!
2024-05-01 00:19:38 INFO     evaluating now!
2024-05-01 00:19:38 INFO     Epoch [14/200] train_loss: 5.2710, val_loss: 5.6813, lr: 0.003000, 7.34s
2024-05-01 00:19:38 INFO     Saved model at 14
2024-05-01 00:19:38 INFO     Val loss decrease from 5.7589 to 5.6813, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-01 00:19:45 INFO     epoch complete!
2024-05-01 00:19:45 INFO     evaluating now!
2024-05-01 00:19:46 INFO     Epoch [15/200] train_loss: 5.2254, val_loss: 5.6239, lr: 0.003000, 7.33s
2024-05-01 00:19:46 INFO     Saved model at 15
2024-05-01 00:19:46 INFO     Val loss decrease from 5.6813 to 5.6239, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-01 00:19:52 INFO     epoch complete!
2024-05-01 00:19:52 INFO     evaluating now!
2024-05-01 00:19:53 INFO     Epoch [16/200] train_loss: 5.1254, val_loss: 5.5620, lr: 0.003000, 7.29s
2024-05-01 00:19:53 INFO     Saved model at 16
2024-05-01 00:19:53 INFO     Val loss decrease from 5.6239 to 5.5620, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-01 00:20:00 INFO     epoch complete!
2024-05-01 00:20:00 INFO     evaluating now!
2024-05-01 00:20:00 INFO     Epoch [17/200] train_loss: 5.0409, val_loss: 5.5470, lr: 0.003000, 7.47s
2024-05-01 00:20:01 INFO     Saved model at 17
2024-05-01 00:20:01 INFO     Val loss decrease from 5.5620 to 5.5470, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-01 00:20:07 INFO     epoch complete!
2024-05-01 00:20:07 INFO     evaluating now!
2024-05-01 00:20:08 INFO     Epoch [18/200] train_loss: 4.9089, val_loss: 5.4490, lr: 0.003000, 7.38s
2024-05-01 00:20:08 INFO     Saved model at 18
2024-05-01 00:20:08 INFO     Val loss decrease from 5.5470 to 5.4490, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-01 00:20:15 INFO     epoch complete!
2024-05-01 00:20:15 INFO     evaluating now!
2024-05-01 00:20:15 INFO     Epoch [19/200] train_loss: 4.9032, val_loss: 5.3920, lr: 0.003000, 7.32s
2024-05-01 00:20:15 INFO     Saved model at 19
2024-05-01 00:20:15 INFO     Val loss decrease from 5.4490 to 5.3920, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-01 00:20:22 INFO     epoch complete!
2024-05-01 00:20:22 INFO     evaluating now!
2024-05-01 00:20:23 INFO     Epoch [20/200] train_loss: 4.8194, val_loss: 5.4694, lr: 0.003000, 7.42s
2024-05-01 00:20:30 INFO     epoch complete!
2024-05-01 00:20:30 INFO     evaluating now!
2024-05-01 00:20:30 INFO     Epoch [21/200] train_loss: 4.7699, val_loss: 5.2866, lr: 0.003000, 7.71s
2024-05-01 00:20:31 INFO     Saved model at 21
2024-05-01 00:20:31 INFO     Val loss decrease from 5.3920 to 5.2866, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-01 00:20:38 INFO     epoch complete!
2024-05-01 00:20:38 INFO     evaluating now!
2024-05-01 00:20:39 INFO     Epoch [22/200] train_loss: 4.7502, val_loss: 5.3120, lr: 0.003000, 7.98s
2024-05-01 00:20:46 INFO     epoch complete!
2024-05-01 00:20:46 INFO     evaluating now!
2024-05-01 00:20:46 INFO     Epoch [23/200] train_loss: 4.6655, val_loss: 5.3583, lr: 0.003000, 7.91s
2024-05-01 00:20:53 INFO     epoch complete!
2024-05-01 00:20:53 INFO     evaluating now!
2024-05-01 00:20:54 INFO     Epoch [24/200] train_loss: 4.6092, val_loss: 5.2128, lr: 0.003000, 7.42s
2024-05-01 00:20:54 INFO     Saved model at 24
2024-05-01 00:20:54 INFO     Val loss decrease from 5.2866 to 5.2128, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-01 00:21:00 INFO     epoch complete!
2024-05-01 00:21:00 INFO     evaluating now!
2024-05-01 00:21:01 INFO     Epoch [25/200] train_loss: 4.6345, val_loss: 5.3919, lr: 0.003000, 7.04s
2024-05-01 00:21:08 INFO     epoch complete!
2024-05-01 00:21:08 INFO     evaluating now!
2024-05-01 00:21:08 INFO     Epoch [26/200] train_loss: 4.5873, val_loss: 5.2221, lr: 0.003000, 7.08s
2024-05-01 00:21:15 INFO     epoch complete!
2024-05-01 00:21:15 INFO     evaluating now!
2024-05-01 00:21:15 INFO     Epoch [27/200] train_loss: 4.4732, val_loss: 5.1100, lr: 0.003000, 6.98s
2024-05-01 00:21:15 INFO     Saved model at 27
2024-05-01 00:21:15 INFO     Val loss decrease from 5.2128 to 5.1100, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-05-01 00:21:22 INFO     epoch complete!
2024-05-01 00:21:22 INFO     evaluating now!
2024-05-01 00:21:22 INFO     Epoch [28/200] train_loss: 4.4132, val_loss: 5.1427, lr: 0.003000, 6.95s
2024-05-01 00:21:29 INFO     epoch complete!
2024-05-01 00:21:29 INFO     evaluating now!
2024-05-01 00:21:29 INFO     Epoch [29/200] train_loss: 4.4055, val_loss: 5.2039, lr: 0.003000, 7.01s
2024-05-01 00:21:36 INFO     epoch complete!
2024-05-01 00:21:36 INFO     evaluating now!
2024-05-01 00:21:36 INFO     Epoch [30/200] train_loss: 4.3429, val_loss: 5.1601, lr: 0.003000, 7.04s
2024-05-01 00:21:43 INFO     epoch complete!
2024-05-01 00:21:43 INFO     evaluating now!
2024-05-01 00:21:43 INFO     Epoch [31/200] train_loss: 4.2763, val_loss: 5.1516, lr: 0.003000, 7.23s
2024-05-01 00:21:50 INFO     epoch complete!
2024-05-01 00:21:50 INFO     evaluating now!
2024-05-01 00:21:50 INFO     Epoch [32/200] train_loss: 4.2680, val_loss: 5.1386, lr: 0.003000, 7.04s
2024-05-01 00:21:57 INFO     epoch complete!
2024-05-01 00:21:57 INFO     evaluating now!
2024-05-01 00:21:57 INFO     Epoch [33/200] train_loss: 4.2257, val_loss: 5.2043, lr: 0.003000, 6.92s
2024-05-01 00:22:04 INFO     epoch complete!
2024-05-01 00:22:04 INFO     evaluating now!
2024-05-01 00:22:04 INFO     Epoch [34/200] train_loss: 4.2453, val_loss: 5.1244, lr: 0.003000, 6.83s
2024-05-01 00:22:11 INFO     epoch complete!
2024-05-01 00:22:11 INFO     evaluating now!
2024-05-01 00:22:11 INFO     Epoch [35/200] train_loss: 4.2030, val_loss: 5.0589, lr: 0.003000, 6.94s
2024-05-01 00:22:11 INFO     Saved model at 35
2024-05-01 00:22:11 INFO     Val loss decrease from 5.1100 to 5.0589, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-05-01 00:22:18 INFO     epoch complete!
2024-05-01 00:22:18 INFO     evaluating now!
2024-05-01 00:22:18 INFO     Epoch [36/200] train_loss: 4.1328, val_loss: 5.1394, lr: 0.003000, 7.01s
2024-05-01 00:22:25 INFO     epoch complete!
2024-05-01 00:22:25 INFO     evaluating now!
2024-05-01 00:22:25 INFO     Epoch [37/200] train_loss: 4.0987, val_loss: 5.0686, lr: 0.003000, 6.95s
2024-05-01 00:22:31 INFO     epoch complete!
2024-05-01 00:22:31 INFO     evaluating now!
2024-05-01 00:22:32 INFO     Epoch [38/200] train_loss: 4.1194, val_loss: 5.0479, lr: 0.003000, 6.81s
2024-05-01 00:22:32 INFO     Saved model at 38
2024-05-01 00:22:32 INFO     Val loss decrease from 5.0589 to 5.0479, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-05-01 00:22:39 INFO     epoch complete!
2024-05-01 00:22:39 INFO     evaluating now!
2024-05-01 00:22:39 INFO     Epoch [39/200] train_loss: 4.0607, val_loss: 5.1454, lr: 0.003000, 7.11s
2024-05-01 00:22:45 INFO     epoch complete!
2024-05-01 00:22:45 INFO     evaluating now!
2024-05-01 00:22:46 INFO     Epoch [40/200] train_loss: 3.9944, val_loss: 5.0760, lr: 0.003000, 6.89s
2024-05-01 00:22:52 INFO     epoch complete!
2024-05-01 00:22:52 INFO     evaluating now!
2024-05-01 00:22:53 INFO     Epoch [41/200] train_loss: 4.0256, val_loss: 4.9747, lr: 0.003000, 6.92s
2024-05-01 00:22:53 INFO     Saved model at 41
2024-05-01 00:22:53 INFO     Val loss decrease from 5.0479 to 4.9747, saving to ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-05-01 00:22:59 INFO     epoch complete!
2024-05-01 00:22:59 INFO     evaluating now!
2024-05-01 00:23:00 INFO     Epoch [42/200] train_loss: 3.9896, val_loss: 5.0195, lr: 0.003000, 7.00s
2024-05-01 00:23:06 INFO     epoch complete!
2024-05-01 00:23:06 INFO     evaluating now!
2024-05-01 00:23:07 INFO     Epoch [43/200] train_loss: 3.9815, val_loss: 5.0552, lr: 0.003000, 7.05s
2024-05-01 00:23:13 INFO     epoch complete!
2024-05-01 00:23:13 INFO     evaluating now!
2024-05-01 00:23:14 INFO     Epoch [44/200] train_loss: 3.9318, val_loss: 5.0475, lr: 0.003000, 7.00s
2024-05-01 00:23:20 INFO     epoch complete!
2024-05-01 00:23:20 INFO     evaluating now!
2024-05-01 00:23:21 INFO     Epoch [45/200] train_loss: 3.8976, val_loss: 4.9917, lr: 0.003000, 6.89s
2024-05-01 00:23:27 INFO     epoch complete!
2024-05-01 00:23:27 INFO     evaluating now!
2024-05-01 00:23:28 INFO     Epoch [46/200] train_loss: 3.8632, val_loss: 4.9839, lr: 0.003000, 6.97s
2024-05-01 00:23:34 INFO     epoch complete!
2024-05-01 00:23:34 INFO     evaluating now!
2024-05-01 00:23:35 INFO     Epoch [47/200] train_loss: 3.8491, val_loss: 5.1063, lr: 0.003000, 7.06s
2024-05-01 00:23:41 INFO     epoch complete!
2024-05-01 00:23:41 INFO     evaluating now!
2024-05-01 00:23:42 INFO     Epoch [48/200] train_loss: 3.8481, val_loss: 5.0896, lr: 0.003000, 7.12s
2024-05-01 00:23:48 INFO     epoch complete!
2024-05-01 00:23:48 INFO     evaluating now!
2024-05-01 00:23:49 INFO     Epoch [49/200] train_loss: 3.8301, val_loss: 4.9919, lr: 0.003000, 6.99s
2024-05-01 00:23:55 INFO     epoch complete!
2024-05-01 00:23:55 INFO     evaluating now!
2024-05-01 00:23:56 INFO     Epoch [50/200] train_loss: 3.8299, val_loss: 5.0735, lr: 0.003000, 6.98s
2024-05-01 00:24:03 INFO     epoch complete!
2024-05-01 00:24:03 INFO     evaluating now!
2024-05-01 00:24:03 INFO     Epoch [51/200] train_loss: 3.8347, val_loss: 5.0556, lr: 0.003000, 7.11s
2024-05-01 00:24:10 INFO     epoch complete!
2024-05-01 00:24:10 INFO     evaluating now!
2024-05-01 00:24:10 INFO     Epoch [52/200] train_loss: 3.7940, val_loss: 4.9913, lr: 0.003000, 7.10s
2024-05-01 00:24:17 INFO     epoch complete!
2024-05-01 00:24:17 INFO     evaluating now!
2024-05-01 00:24:17 INFO     Epoch [53/200] train_loss: 3.7352, val_loss: 5.0113, lr: 0.003000, 7.02s
2024-05-01 00:24:24 INFO     epoch complete!
2024-05-01 00:24:24 INFO     evaluating now!
2024-05-01 00:24:24 INFO     Epoch [54/200] train_loss: 3.7172, val_loss: 4.9963, lr: 0.003000, 7.02s
2024-05-01 00:24:31 INFO     epoch complete!
2024-05-01 00:24:31 INFO     evaluating now!
2024-05-01 00:24:32 INFO     Epoch [55/200] train_loss: 3.7142, val_loss: 5.0370, lr: 0.003000, 7.54s
2024-05-01 00:24:39 INFO     epoch complete!
2024-05-01 00:24:39 INFO     evaluating now!
2024-05-01 00:24:39 INFO     Epoch [56/200] train_loss: 3.6861, val_loss: 5.0706, lr: 0.003000, 7.53s
2024-05-01 00:24:39 WARNING  Early stopping at epoch: 56
2024-05-01 00:24:39 INFO     Trained totally 57 epochs, average train time is 6.750s, average eval time is 0.493s
2024-05-01 00:24:39 INFO     Loaded model at 41
2024-05-01 00:24:39 INFO     Saved model at ./libcity/cache/59/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 00:24:39 INFO     Start evaluating ...
2024-05-01 00:24:41 INFO     Note that you select the single mode to evaluate!
2024-05-01 00:24:41 INFO     Evaluate result is saved at ./libcity/cache/59/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 00:24:41 INFO     
         MAE       RMSE
1   2.484518   8.039433
2   2.535010   8.123552
3   2.697249   8.998055
4   2.876531   9.745015
5   2.974382  10.446984
6   3.084828  11.036483
7   3.164245  11.520586
8   3.215086  11.973208
9   3.320936  12.369580
10  3.358464  12.650422
11  3.477779  13.023374
12  3.530823  13.595972
2024-05-01 00:24:41 INFO     ----------------------------------------------------------------------------
2024-05-01 00:24:41 INFO     Kownledge Graph Embedding: TransH, Experiment ids: [55, 56, 57, 58, 59]
2024-05-01 00:24:41 INFO     ----------------------------------------------------------------------------
2024-05-01 00:24:41 INFO     Average: 
         MAE       RMSE
0   2.425259   7.522749
1   2.531264   8.056421
2   2.703652   9.007726
3   2.868573   9.842676
4   2.979777  10.634087
5   3.089103  11.496405
6   3.195267  12.297153
7   3.231839  12.800662
8   3.298335  13.102946
9   3.342040  13.349750
10  3.440044  13.573242
11  3.540343  14.002473 
2024-05-01 00:24:41 INFO     Standard deviation: 
         MAE      RMSE
0   0.168535  0.555487
1   0.124921  0.402404
2   0.117998  0.323441
3   0.087065  0.280176
4   0.037495  0.356536
5   0.045062  0.580638
6   0.049484  0.730055
7   0.038083  0.759887
8   0.061467  0.705999
9   0.066403  0.545938
10  0.047560  0.415740
11  0.035974  0.385098
2024-05-01 00:24:41 INFO     ----------------------------------------------------------------------------
2024-05-01 00:24:41 INFO     12 steps Average: 
        MAE       RMSE
0  3.053791  11.307191
2024-05-01 00:24:41 INFO     12 steps Standard deviation: 
        MAE     RMSE
0  0.073337  0.50345
