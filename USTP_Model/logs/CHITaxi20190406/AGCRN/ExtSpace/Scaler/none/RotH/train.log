2024-04-30 21:10:23 INFO     ----------------------------------------------------------------------------
2024-04-30 21:10:23 INFO     # 0, Kownledge Graph Embedding: RotH, Experiment ids: 30
2024-04-30 21:10:23 INFO     ----------------------------------------------------------------------------
2024-04-30 21:10:23 INFO     Log directory: ./libcity/log
2024-04-30 21:10:23 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=30
2024-04-30 21:10:23 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 699748583, 'exp_id': 30, 'load_external': True, 'embedding_model': 'RotH', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 21:10:23 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 21:10:23 INFO     set_weight_link_or_dist: dist
2024-04-30 21:10:23 INFO     init_weight_inf_or_zero: inf
2024-04-30 21:10:23 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 21:10:23 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 21:10:23 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 21:10:24 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 21:10:26 INFO     Dataset created
2024-04-30 21:10:26 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 21:10:26 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 21:10:26 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 21:10:26 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 21:10:27 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 21:10:27 INFO     NoneScaler
2024-04-30 21:10:31 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 21:10:31 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 21:10:31 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 21:10:31 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 21:10:31 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 21:10:31 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 21:10:31 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 21:10:31 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 21:10:31 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 21:10:31 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 21:10:31 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 21:10:31 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 21:10:31 INFO     Total parameter numbers: 874010
2024-04-30 21:10:31 INFO     You select `adam` optimizer.
2024-04-30 21:10:31 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 21:10:31 INFO     Start training ...
2024-04-30 21:10:31 INFO     num_batches:48
2024-04-30 21:10:38 INFO     epoch complete!
2024-04-30 21:10:38 INFO     evaluating now!
2024-04-30 21:10:39 INFO     Epoch [0/200] train_loss: 24.0264, val_loss: 17.9168, lr: 0.003000, 7.50s
2024-04-30 21:10:39 INFO     Saved model at 0
2024-04-30 21:10:39 INFO     Val loss decrease from inf to 17.9168, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 21:10:45 INFO     epoch complete!
2024-04-30 21:10:45 INFO     evaluating now!
2024-04-30 21:10:45 INFO     Epoch [1/200] train_loss: 14.5788, val_loss: 13.8879, lr: 0.003000, 6.36s
2024-04-30 21:10:45 INFO     Saved model at 1
2024-04-30 21:10:45 INFO     Val loss decrease from 17.9168 to 13.8879, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 21:10:51 INFO     epoch complete!
2024-04-30 21:10:51 INFO     evaluating now!
2024-04-30 21:10:52 INFO     Epoch [2/200] train_loss: 11.3825, val_loss: 11.0849, lr: 0.003000, 6.44s
2024-04-30 21:10:52 INFO     Saved model at 2
2024-04-30 21:10:52 INFO     Val loss decrease from 13.8879 to 11.0849, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 21:10:58 INFO     epoch complete!
2024-04-30 21:10:58 INFO     evaluating now!
2024-04-30 21:10:59 INFO     Epoch [3/200] train_loss: 9.5001, val_loss: 8.9850, lr: 0.003000, 6.84s
2024-04-30 21:10:59 INFO     Saved model at 3
2024-04-30 21:10:59 INFO     Val loss decrease from 11.0849 to 8.9850, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 21:11:05 INFO     epoch complete!
2024-04-30 21:11:05 INFO     evaluating now!
2024-04-30 21:11:05 INFO     Epoch [4/200] train_loss: 8.1942, val_loss: 7.7359, lr: 0.003000, 6.46s
2024-04-30 21:11:05 INFO     Saved model at 4
2024-04-30 21:11:05 INFO     Val loss decrease from 8.9850 to 7.7359, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 21:11:11 INFO     epoch complete!
2024-04-30 21:11:11 INFO     evaluating now!
2024-04-30 21:11:12 INFO     Epoch [5/200] train_loss: 7.4398, val_loss: 7.2138, lr: 0.003000, 6.32s
2024-04-30 21:11:12 INFO     Saved model at 5
2024-04-30 21:11:12 INFO     Val loss decrease from 7.7359 to 7.2138, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 21:11:18 INFO     epoch complete!
2024-04-30 21:11:18 INFO     evaluating now!
2024-04-30 21:11:18 INFO     Epoch [6/200] train_loss: 6.8430, val_loss: 6.6879, lr: 0.003000, 6.50s
2024-04-30 21:11:18 INFO     Saved model at 6
2024-04-30 21:11:18 INFO     Val loss decrease from 7.2138 to 6.6879, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 21:11:25 INFO     epoch complete!
2024-04-30 21:11:25 INFO     evaluating now!
2024-04-30 21:11:26 INFO     Epoch [7/200] train_loss: 6.4916, val_loss: 6.3663, lr: 0.003000, 7.53s
2024-04-30 21:11:26 INFO     Saved model at 7
2024-04-30 21:11:26 INFO     Val loss decrease from 6.6879 to 6.3663, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 21:11:33 INFO     epoch complete!
2024-04-30 21:11:33 INFO     evaluating now!
2024-04-30 21:11:33 INFO     Epoch [8/200] train_loss: 6.2282, val_loss: 6.2678, lr: 0.003000, 7.53s
2024-04-30 21:11:33 INFO     Saved model at 8
2024-04-30 21:11:33 INFO     Val loss decrease from 6.3663 to 6.2678, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 21:11:40 INFO     epoch complete!
2024-04-30 21:11:40 INFO     evaluating now!
2024-04-30 21:11:41 INFO     Epoch [9/200] train_loss: 6.0003, val_loss: 6.1255, lr: 0.003000, 7.53s
2024-04-30 21:11:41 INFO     Saved model at 9
2024-04-30 21:11:41 INFO     Val loss decrease from 6.2678 to 6.1255, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 21:11:48 INFO     epoch complete!
2024-04-30 21:11:48 INFO     evaluating now!
2024-04-30 21:11:48 INFO     Epoch [10/200] train_loss: 5.8307, val_loss: 5.8646, lr: 0.003000, 7.25s
2024-04-30 21:11:48 INFO     Saved model at 10
2024-04-30 21:11:48 INFO     Val loss decrease from 6.1255 to 5.8646, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 21:11:55 INFO     epoch complete!
2024-04-30 21:11:55 INFO     evaluating now!
2024-04-30 21:11:55 INFO     Epoch [11/200] train_loss: 5.6721, val_loss: 5.9419, lr: 0.003000, 7.25s
2024-04-30 21:12:02 INFO     epoch complete!
2024-04-30 21:12:02 INFO     evaluating now!
2024-04-30 21:12:03 INFO     Epoch [12/200] train_loss: 5.5655, val_loss: 5.5968, lr: 0.003000, 7.21s
2024-04-30 21:12:03 INFO     Saved model at 12
2024-04-30 21:12:03 INFO     Val loss decrease from 5.8646 to 5.5968, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 21:12:09 INFO     epoch complete!
2024-04-30 21:12:09 INFO     evaluating now!
2024-04-30 21:12:10 INFO     Epoch [13/200] train_loss: 5.3757, val_loss: 5.6065, lr: 0.003000, 7.11s
2024-04-30 21:12:16 INFO     epoch complete!
2024-04-30 21:12:16 INFO     evaluating now!
2024-04-30 21:12:17 INFO     Epoch [14/200] train_loss: 5.2488, val_loss: 5.6597, lr: 0.003000, 7.10s
2024-04-30 21:12:23 INFO     epoch complete!
2024-04-30 21:12:23 INFO     evaluating now!
2024-04-30 21:12:24 INFO     Epoch [15/200] train_loss: 5.1920, val_loss: 5.4473, lr: 0.003000, 7.04s
2024-04-30 21:12:24 INFO     Saved model at 15
2024-04-30 21:12:24 INFO     Val loss decrease from 5.5968 to 5.4473, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 21:12:31 INFO     epoch complete!
2024-04-30 21:12:31 INFO     evaluating now!
2024-04-30 21:12:31 INFO     Epoch [16/200] train_loss: 5.1004, val_loss: 5.2951, lr: 0.003000, 7.11s
2024-04-30 21:12:31 INFO     Saved model at 16
2024-04-30 21:12:31 INFO     Val loss decrease from 5.4473 to 5.2951, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 21:12:38 INFO     epoch complete!
2024-04-30 21:12:38 INFO     evaluating now!
2024-04-30 21:12:38 INFO     Epoch [17/200] train_loss: 4.9574, val_loss: 5.2954, lr: 0.003000, 7.23s
2024-04-30 21:12:45 INFO     epoch complete!
2024-04-30 21:12:45 INFO     evaluating now!
2024-04-30 21:12:46 INFO     Epoch [18/200] train_loss: 4.9530, val_loss: 5.4227, lr: 0.003000, 7.15s
2024-04-30 21:12:52 INFO     epoch complete!
2024-04-30 21:12:52 INFO     evaluating now!
2024-04-30 21:12:53 INFO     Epoch [19/200] train_loss: 4.8890, val_loss: 5.5166, lr: 0.003000, 7.06s
2024-04-30 21:12:59 INFO     epoch complete!
2024-04-30 21:12:59 INFO     evaluating now!
2024-04-30 21:13:00 INFO     Epoch [20/200] train_loss: 4.8131, val_loss: 5.3999, lr: 0.003000, 7.12s
2024-04-30 21:13:06 INFO     epoch complete!
2024-04-30 21:13:06 INFO     evaluating now!
2024-04-30 21:13:07 INFO     Epoch [21/200] train_loss: 4.7459, val_loss: 5.4364, lr: 0.003000, 7.09s
2024-04-30 21:13:14 INFO     epoch complete!
2024-04-30 21:13:14 INFO     evaluating now!
2024-04-30 21:13:14 INFO     Epoch [22/200] train_loss: 4.6369, val_loss: 5.1963, lr: 0.003000, 7.17s
2024-04-30 21:13:14 INFO     Saved model at 22
2024-04-30 21:13:14 INFO     Val loss decrease from 5.2951 to 5.1963, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-30 21:13:21 INFO     epoch complete!
2024-04-30 21:13:21 INFO     evaluating now!
2024-04-30 21:13:22 INFO     Epoch [23/200] train_loss: 4.6045, val_loss: 5.2152, lr: 0.003000, 7.54s
2024-04-30 21:13:29 INFO     epoch complete!
2024-04-30 21:13:29 INFO     evaluating now!
2024-04-30 21:13:29 INFO     Epoch [24/200] train_loss: 4.5257, val_loss: 5.3425, lr: 0.003000, 7.59s
2024-04-30 21:13:36 INFO     epoch complete!
2024-04-30 21:13:36 INFO     evaluating now!
2024-04-30 21:13:36 INFO     Epoch [25/200] train_loss: 4.4516, val_loss: 5.0662, lr: 0.003000, 7.28s
2024-04-30 21:13:36 INFO     Saved model at 25
2024-04-30 21:13:36 INFO     Val loss decrease from 5.1963 to 5.0662, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-30 21:13:43 INFO     epoch complete!
2024-04-30 21:13:43 INFO     evaluating now!
2024-04-30 21:13:44 INFO     Epoch [26/200] train_loss: 4.4444, val_loss: 5.0562, lr: 0.003000, 7.10s
2024-04-30 21:13:44 INFO     Saved model at 26
2024-04-30 21:13:44 INFO     Val loss decrease from 5.0662 to 5.0562, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-04-30 21:13:50 INFO     epoch complete!
2024-04-30 21:13:50 INFO     evaluating now!
2024-04-30 21:13:51 INFO     Epoch [27/200] train_loss: 4.4701, val_loss: 5.1034, lr: 0.003000, 7.24s
2024-04-30 21:13:58 INFO     epoch complete!
2024-04-30 21:13:58 INFO     evaluating now!
2024-04-30 21:13:58 INFO     Epoch [28/200] train_loss: 4.3377, val_loss: 5.1061, lr: 0.003000, 7.11s
2024-04-30 21:14:05 INFO     epoch complete!
2024-04-30 21:14:05 INFO     evaluating now!
2024-04-30 21:14:05 INFO     Epoch [29/200] train_loss: 4.3602, val_loss: 5.2468, lr: 0.003000, 7.15s
2024-04-30 21:14:12 INFO     epoch complete!
2024-04-30 21:14:12 INFO     evaluating now!
2024-04-30 21:14:12 INFO     Epoch [30/200] train_loss: 4.2896, val_loss: 5.0699, lr: 0.003000, 7.16s
2024-04-30 21:14:19 INFO     epoch complete!
2024-04-30 21:14:19 INFO     evaluating now!
2024-04-30 21:14:19 INFO     Epoch [31/200] train_loss: 4.2561, val_loss: 5.3364, lr: 0.003000, 7.08s
2024-04-30 21:14:26 INFO     epoch complete!
2024-04-30 21:14:26 INFO     evaluating now!
2024-04-30 21:14:26 INFO     Epoch [32/200] train_loss: 4.1805, val_loss: 5.2806, lr: 0.003000, 6.94s
2024-04-30 21:14:33 INFO     epoch complete!
2024-04-30 21:14:33 INFO     evaluating now!
2024-04-30 21:14:33 INFO     Epoch [33/200] train_loss: 4.1949, val_loss: 5.0647, lr: 0.003000, 6.83s
2024-04-30 21:14:40 INFO     epoch complete!
2024-04-30 21:14:40 INFO     evaluating now!
2024-04-30 21:14:40 INFO     Epoch [34/200] train_loss: 4.1127, val_loss: 5.1965, lr: 0.003000, 6.89s
2024-04-30 21:14:46 INFO     epoch complete!
2024-04-30 21:14:46 INFO     evaluating now!
2024-04-30 21:14:47 INFO     Epoch [35/200] train_loss: 4.0802, val_loss: 5.1866, lr: 0.003000, 6.51s
2024-04-30 21:14:53 INFO     epoch complete!
2024-04-30 21:14:53 INFO     evaluating now!
2024-04-30 21:14:53 INFO     Epoch [36/200] train_loss: 4.0960, val_loss: 5.0892, lr: 0.003000, 6.56s
2024-04-30 21:15:00 INFO     epoch complete!
2024-04-30 21:15:00 INFO     evaluating now!
2024-04-30 21:15:00 INFO     Epoch [37/200] train_loss: 4.1087, val_loss: 5.2382, lr: 0.003000, 7.01s
2024-04-30 21:15:07 INFO     epoch complete!
2024-04-30 21:15:07 INFO     evaluating now!
2024-04-30 21:15:07 INFO     Epoch [38/200] train_loss: 4.1292, val_loss: 5.0444, lr: 0.003000, 6.99s
2024-04-30 21:15:07 INFO     Saved model at 38
2024-04-30 21:15:07 INFO     Val loss decrease from 5.0562 to 5.0444, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-04-30 21:15:14 INFO     epoch complete!
2024-04-30 21:15:14 INFO     evaluating now!
2024-04-30 21:15:14 INFO     Epoch [39/200] train_loss: 3.9861, val_loss: 4.9791, lr: 0.003000, 6.99s
2024-04-30 21:15:14 INFO     Saved model at 39
2024-04-30 21:15:14 INFO     Val loss decrease from 5.0444 to 4.9791, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-04-30 21:15:21 INFO     epoch complete!
2024-04-30 21:15:21 INFO     evaluating now!
2024-04-30 21:15:21 INFO     Epoch [40/200] train_loss: 3.9811, val_loss: 5.0205, lr: 0.003000, 7.28s
2024-04-30 21:15:28 INFO     epoch complete!
2024-04-30 21:15:28 INFO     evaluating now!
2024-04-30 21:15:29 INFO     Epoch [41/200] train_loss: 3.9690, val_loss: 5.1182, lr: 0.003000, 7.40s
2024-04-30 21:15:36 INFO     epoch complete!
2024-04-30 21:15:36 INFO     evaluating now!
2024-04-30 21:15:36 INFO     Epoch [42/200] train_loss: 3.9803, val_loss: 4.9812, lr: 0.003000, 7.13s
2024-04-30 21:15:43 INFO     epoch complete!
2024-04-30 21:15:43 INFO     evaluating now!
2024-04-30 21:15:43 INFO     Epoch [43/200] train_loss: 3.8546, val_loss: 5.1537, lr: 0.003000, 7.22s
2024-04-30 21:15:50 INFO     epoch complete!
2024-04-30 21:15:50 INFO     evaluating now!
2024-04-30 21:15:50 INFO     Epoch [44/200] train_loss: 3.9342, val_loss: 5.0750, lr: 0.003000, 7.07s
2024-04-30 21:15:57 INFO     epoch complete!
2024-04-30 21:15:57 INFO     evaluating now!
2024-04-30 21:15:57 INFO     Epoch [45/200] train_loss: 3.8384, val_loss: 5.1325, lr: 0.003000, 6.79s
2024-04-30 21:16:04 INFO     epoch complete!
2024-04-30 21:16:04 INFO     evaluating now!
2024-04-30 21:16:04 INFO     Epoch [46/200] train_loss: 3.7843, val_loss: 4.9163, lr: 0.003000, 6.94s
2024-04-30 21:16:04 INFO     Saved model at 46
2024-04-30 21:16:04 INFO     Val loss decrease from 4.9791 to 4.9163, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-04-30 21:16:10 INFO     epoch complete!
2024-04-30 21:16:10 INFO     evaluating now!
2024-04-30 21:16:11 INFO     Epoch [47/200] train_loss: 3.7479, val_loss: 5.1099, lr: 0.003000, 6.82s
2024-04-30 21:16:17 INFO     epoch complete!
2024-04-30 21:16:17 INFO     evaluating now!
2024-04-30 21:16:17 INFO     Epoch [48/200] train_loss: 3.7462, val_loss: 5.0692, lr: 0.003000, 6.60s
2024-04-30 21:16:24 INFO     epoch complete!
2024-04-30 21:16:24 INFO     evaluating now!
2024-04-30 21:16:24 INFO     Epoch [49/200] train_loss: 3.7684, val_loss: 5.0911, lr: 0.003000, 6.76s
2024-04-30 21:16:30 INFO     epoch complete!
2024-04-30 21:16:30 INFO     evaluating now!
2024-04-30 21:16:31 INFO     Epoch [50/200] train_loss: 3.7990, val_loss: 5.1424, lr: 0.003000, 6.59s
2024-04-30 21:16:37 INFO     epoch complete!
2024-04-30 21:16:37 INFO     evaluating now!
2024-04-30 21:16:38 INFO     Epoch [51/200] train_loss: 3.7453, val_loss: 4.9838, lr: 0.003000, 6.71s
2024-04-30 21:16:44 INFO     epoch complete!
2024-04-30 21:16:44 INFO     evaluating now!
2024-04-30 21:16:44 INFO     Epoch [52/200] train_loss: 3.6934, val_loss: 5.1139, lr: 0.003000, 6.75s
2024-04-30 21:16:51 INFO     epoch complete!
2024-04-30 21:16:51 INFO     evaluating now!
2024-04-30 21:16:51 INFO     Epoch [53/200] train_loss: 3.6540, val_loss: 5.0274, lr: 0.003000, 6.68s
2024-04-30 21:16:57 INFO     epoch complete!
2024-04-30 21:16:57 INFO     evaluating now!
2024-04-30 21:16:58 INFO     Epoch [54/200] train_loss: 3.6462, val_loss: 4.9804, lr: 0.003000, 6.95s
2024-04-30 21:17:04 INFO     epoch complete!
2024-04-30 21:17:04 INFO     evaluating now!
2024-04-30 21:17:04 INFO     Epoch [55/200] train_loss: 3.6398, val_loss: 5.1289, lr: 0.003000, 6.49s
2024-04-30 21:17:11 INFO     epoch complete!
2024-04-30 21:17:11 INFO     evaluating now!
2024-04-30 21:17:11 INFO     Epoch [56/200] train_loss: 3.6089, val_loss: 4.8706, lr: 0.003000, 6.56s
2024-04-30 21:17:11 INFO     Saved model at 56
2024-04-30 21:17:11 INFO     Val loss decrease from 4.9163 to 4.8706, saving to ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406_epoch56.tar
2024-04-30 21:17:17 INFO     epoch complete!
2024-04-30 21:17:17 INFO     evaluating now!
2024-04-30 21:17:18 INFO     Epoch [57/200] train_loss: 3.5916, val_loss: 4.9154, lr: 0.003000, 6.48s
2024-04-30 21:17:24 INFO     epoch complete!
2024-04-30 21:17:24 INFO     evaluating now!
2024-04-30 21:17:24 INFO     Epoch [58/200] train_loss: 3.5796, val_loss: 5.1498, lr: 0.003000, 6.46s
2024-04-30 21:17:30 INFO     epoch complete!
2024-04-30 21:17:30 INFO     evaluating now!
2024-04-30 21:17:31 INFO     Epoch [59/200] train_loss: 3.5627, val_loss: 5.0861, lr: 0.003000, 6.54s
2024-04-30 21:17:37 INFO     epoch complete!
2024-04-30 21:17:37 INFO     evaluating now!
2024-04-30 21:17:37 INFO     Epoch [60/200] train_loss: 3.5936, val_loss: 5.2154, lr: 0.003000, 6.51s
2024-04-30 21:17:44 INFO     epoch complete!
2024-04-30 21:17:44 INFO     evaluating now!
2024-04-30 21:17:44 INFO     Epoch [61/200] train_loss: 3.5710, val_loss: 5.1553, lr: 0.003000, 7.15s
2024-04-30 21:17:51 INFO     epoch complete!
2024-04-30 21:17:51 INFO     evaluating now!
2024-04-30 21:17:51 INFO     Epoch [62/200] train_loss: 3.5402, val_loss: 5.1496, lr: 0.003000, 7.16s
2024-04-30 21:17:58 INFO     epoch complete!
2024-04-30 21:17:58 INFO     evaluating now!
2024-04-30 21:17:58 INFO     Epoch [63/200] train_loss: 3.5791, val_loss: 5.1022, lr: 0.003000, 6.62s
2024-04-30 21:18:04 INFO     epoch complete!
2024-04-30 21:18:04 INFO     evaluating now!
2024-04-30 21:18:04 INFO     Epoch [64/200] train_loss: 3.4868, val_loss: 5.2060, lr: 0.003000, 6.48s
2024-04-30 21:18:10 INFO     epoch complete!
2024-04-30 21:18:10 INFO     evaluating now!
2024-04-30 21:18:11 INFO     Epoch [65/200] train_loss: 3.4964, val_loss: 5.0961, lr: 0.003000, 6.51s
2024-04-30 21:18:17 INFO     epoch complete!
2024-04-30 21:18:17 INFO     evaluating now!
2024-04-30 21:18:18 INFO     Epoch [66/200] train_loss: 3.5140, val_loss: 5.0390, lr: 0.003000, 6.77s
2024-04-30 21:18:24 INFO     epoch complete!
2024-04-30 21:18:24 INFO     evaluating now!
2024-04-30 21:18:25 INFO     Epoch [67/200] train_loss: 3.6003, val_loss: 5.1096, lr: 0.003000, 6.95s
2024-04-30 21:18:31 INFO     epoch complete!
2024-04-30 21:18:31 INFO     evaluating now!
2024-04-30 21:18:31 INFO     Epoch [68/200] train_loss: 3.5018, val_loss: 5.1698, lr: 0.003000, 6.63s
2024-04-30 21:18:38 INFO     epoch complete!
2024-04-30 21:18:38 INFO     evaluating now!
2024-04-30 21:18:38 INFO     Epoch [69/200] train_loss: 3.4550, val_loss: 4.9177, lr: 0.003000, 6.83s
2024-04-30 21:18:44 INFO     epoch complete!
2024-04-30 21:18:44 INFO     evaluating now!
2024-04-30 21:18:45 INFO     Epoch [70/200] train_loss: 3.3949, val_loss: 5.1242, lr: 0.003000, 6.78s
2024-04-30 21:18:51 INFO     epoch complete!
2024-04-30 21:18:51 INFO     evaluating now!
2024-04-30 21:18:52 INFO     Epoch [71/200] train_loss: 3.4858, val_loss: 5.1706, lr: 0.003000, 6.57s
2024-04-30 21:18:52 WARNING  Early stopping at epoch: 71
2024-04-30 21:18:52 INFO     Trained totally 72 epochs, average train time is 6.459s, average eval time is 0.471s
2024-04-30 21:18:52 INFO     Loaded model at 56
2024-04-30 21:18:52 INFO     Saved model at ./libcity/cache/30/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 21:18:52 INFO     Start evaluating ...
2024-04-30 21:18:53 INFO     Note that you select the single mode to evaluate!
2024-04-30 21:18:53 INFO     Evaluate result is saved at ./libcity/cache/30/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 21:18:53 INFO     
         MAE       RMSE
1   2.555264   7.980973
2   2.672444   8.238493
3   2.694983   8.914255
4   2.824099   9.587956
5   2.972669  10.465515
6   3.081808  11.226624
7   3.207624  11.917465
8   3.269774  12.185461
9   3.314672  12.313546
10  3.331277  12.322751
11  3.372871  12.418304
12  3.379983  12.604454
2024-04-30 21:18:53 INFO     ----------------------------------------------------------------------------
2024-04-30 21:18:53 INFO     # 1, Kownledge Graph Embedding: RotH, Experiment ids: 31
2024-04-30 21:18:53 INFO     ----------------------------------------------------------------------------
2024-04-30 21:18:53 INFO     Log directory: ./libcity/log
2024-04-30 21:18:53 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=31
2024-04-30 21:18:53 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 425270535, 'exp_id': 31, 'load_external': True, 'embedding_model': 'RotH', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 21:18:53 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 21:18:53 INFO     set_weight_link_or_dist: dist
2024-04-30 21:18:53 INFO     init_weight_inf_or_zero: inf
2024-04-30 21:18:53 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 21:18:53 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 21:18:53 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 21:18:54 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 21:18:57 INFO     Dataset created
2024-04-30 21:18:57 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 21:18:57 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 21:18:57 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 21:18:57 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 21:18:57 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 21:18:57 INFO     NoneScaler
2024-04-30 21:18:59 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 21:18:59 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 21:18:59 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 21:18:59 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 21:18:59 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 21:18:59 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 21:18:59 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 21:18:59 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 21:18:59 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 21:18:59 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 21:18:59 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 21:18:59 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 21:18:59 INFO     Total parameter numbers: 874010
2024-04-30 21:18:59 INFO     You select `adam` optimizer.
2024-04-30 21:18:59 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 21:18:59 INFO     Start training ...
2024-04-30 21:18:59 INFO     num_batches:48
2024-04-30 21:19:05 INFO     epoch complete!
2024-04-30 21:19:05 INFO     evaluating now!
2024-04-30 21:19:06 INFO     Epoch [0/200] train_loss: 24.3030, val_loss: 18.1725, lr: 0.003000, 6.74s
2024-04-30 21:19:06 INFO     Saved model at 0
2024-04-30 21:19:06 INFO     Val loss decrease from inf to 18.1725, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 21:19:12 INFO     epoch complete!
2024-04-30 21:19:12 INFO     evaluating now!
2024-04-30 21:19:12 INFO     Epoch [1/200] train_loss: 14.9797, val_loss: 14.5540, lr: 0.003000, 6.63s
2024-04-30 21:19:12 INFO     Saved model at 1
2024-04-30 21:19:12 INFO     Val loss decrease from 18.1725 to 14.5540, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 21:19:19 INFO     epoch complete!
2024-04-30 21:19:19 INFO     evaluating now!
2024-04-30 21:19:19 INFO     Epoch [2/200] train_loss: 11.8877, val_loss: 11.2561, lr: 0.003000, 6.63s
2024-04-30 21:19:19 INFO     Saved model at 2
2024-04-30 21:19:19 INFO     Val loss decrease from 14.5540 to 11.2561, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 21:19:25 INFO     epoch complete!
2024-04-30 21:19:25 INFO     evaluating now!
2024-04-30 21:19:26 INFO     Epoch [3/200] train_loss: 9.7452, val_loss: 9.3551, lr: 0.003000, 6.63s
2024-04-30 21:19:26 INFO     Saved model at 3
2024-04-30 21:19:26 INFO     Val loss decrease from 11.2561 to 9.3551, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 21:19:32 INFO     epoch complete!
2024-04-30 21:19:32 INFO     evaluating now!
2024-04-30 21:19:33 INFO     Epoch [4/200] train_loss: 8.3874, val_loss: 8.2891, lr: 0.003000, 6.72s
2024-04-30 21:19:33 INFO     Saved model at 4
2024-04-30 21:19:33 INFO     Val loss decrease from 9.3551 to 8.2891, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 21:19:39 INFO     epoch complete!
2024-04-30 21:19:39 INFO     evaluating now!
2024-04-30 21:19:39 INFO     Epoch [5/200] train_loss: 7.6250, val_loss: 7.2696, lr: 0.003000, 6.71s
2024-04-30 21:19:39 INFO     Saved model at 5
2024-04-30 21:19:39 INFO     Val loss decrease from 8.2891 to 7.2696, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 21:19:46 INFO     epoch complete!
2024-04-30 21:19:46 INFO     evaluating now!
2024-04-30 21:19:47 INFO     Epoch [6/200] train_loss: 6.9629, val_loss: 6.6469, lr: 0.003000, 7.23s
2024-04-30 21:19:47 INFO     Saved model at 6
2024-04-30 21:19:47 INFO     Val loss decrease from 7.2696 to 6.6469, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 21:19:54 INFO     epoch complete!
2024-04-30 21:19:54 INFO     evaluating now!
2024-04-30 21:19:54 INFO     Epoch [7/200] train_loss: 6.5727, val_loss: 6.5903, lr: 0.003000, 7.42s
2024-04-30 21:19:54 INFO     Saved model at 7
2024-04-30 21:19:54 INFO     Val loss decrease from 6.6469 to 6.5903, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 21:20:01 INFO     epoch complete!
2024-04-30 21:20:01 INFO     evaluating now!
2024-04-30 21:20:01 INFO     Epoch [8/200] train_loss: 6.2587, val_loss: 6.2760, lr: 0.003000, 6.94s
2024-04-30 21:20:01 INFO     Saved model at 8
2024-04-30 21:20:01 INFO     Val loss decrease from 6.5903 to 6.2760, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 21:20:08 INFO     epoch complete!
2024-04-30 21:20:08 INFO     evaluating now!
2024-04-30 21:20:09 INFO     Epoch [9/200] train_loss: 6.0109, val_loss: 6.1346, lr: 0.003000, 7.50s
2024-04-30 21:20:09 INFO     Saved model at 9
2024-04-30 21:20:09 INFO     Val loss decrease from 6.2760 to 6.1346, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 21:20:16 INFO     epoch complete!
2024-04-30 21:20:16 INFO     evaluating now!
2024-04-30 21:20:16 INFO     Epoch [10/200] train_loss: 5.8553, val_loss: 6.0684, lr: 0.003000, 7.36s
2024-04-30 21:20:16 INFO     Saved model at 10
2024-04-30 21:20:16 INFO     Val loss decrease from 6.1346 to 6.0684, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 21:20:23 INFO     epoch complete!
2024-04-30 21:20:23 INFO     evaluating now!
2024-04-30 21:20:23 INFO     Epoch [11/200] train_loss: 5.6688, val_loss: 5.9061, lr: 0.003000, 6.73s
2024-04-30 21:20:23 INFO     Saved model at 11
2024-04-30 21:20:23 INFO     Val loss decrease from 6.0684 to 5.9061, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 21:20:29 INFO     epoch complete!
2024-04-30 21:20:29 INFO     evaluating now!
2024-04-30 21:20:30 INFO     Epoch [12/200] train_loss: 5.5309, val_loss: 5.9306, lr: 0.003000, 6.79s
2024-04-30 21:20:36 INFO     epoch complete!
2024-04-30 21:20:36 INFO     evaluating now!
2024-04-30 21:20:37 INFO     Epoch [13/200] train_loss: 5.4637, val_loss: 5.6734, lr: 0.003000, 6.86s
2024-04-30 21:20:37 INFO     Saved model at 13
2024-04-30 21:20:37 INFO     Val loss decrease from 5.9061 to 5.6734, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 21:20:43 INFO     epoch complete!
2024-04-30 21:20:43 INFO     evaluating now!
2024-04-30 21:20:44 INFO     Epoch [14/200] train_loss: 5.3359, val_loss: 5.5873, lr: 0.003000, 6.73s
2024-04-30 21:20:44 INFO     Saved model at 14
2024-04-30 21:20:44 INFO     Val loss decrease from 5.6734 to 5.5873, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 21:20:50 INFO     epoch complete!
2024-04-30 21:20:50 INFO     evaluating now!
2024-04-30 21:20:50 INFO     Epoch [15/200] train_loss: 5.1943, val_loss: 5.4126, lr: 0.003000, 6.75s
2024-04-30 21:20:50 INFO     Saved model at 15
2024-04-30 21:20:50 INFO     Val loss decrease from 5.5873 to 5.4126, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 21:20:57 INFO     epoch complete!
2024-04-30 21:20:57 INFO     evaluating now!
2024-04-30 21:20:57 INFO     Epoch [16/200] train_loss: 5.1488, val_loss: 5.6058, lr: 0.003000, 6.73s
2024-04-30 21:21:04 INFO     epoch complete!
2024-04-30 21:21:04 INFO     evaluating now!
2024-04-30 21:21:04 INFO     Epoch [17/200] train_loss: 4.9679, val_loss: 5.2704, lr: 0.003000, 7.03s
2024-04-30 21:21:04 INFO     Saved model at 17
2024-04-30 21:21:04 INFO     Val loss decrease from 5.4126 to 5.2704, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 21:21:10 INFO     epoch complete!
2024-04-30 21:21:10 INFO     evaluating now!
2024-04-30 21:21:11 INFO     Epoch [18/200] train_loss: 4.9332, val_loss: 5.2793, lr: 0.003000, 6.69s
2024-04-30 21:21:17 INFO     epoch complete!
2024-04-30 21:21:17 INFO     evaluating now!
2024-04-30 21:21:18 INFO     Epoch [19/200] train_loss: 4.7735, val_loss: 5.4040, lr: 0.003000, 6.94s
2024-04-30 21:21:24 INFO     epoch complete!
2024-04-30 21:21:24 INFO     evaluating now!
2024-04-30 21:21:25 INFO     Epoch [20/200] train_loss: 4.7492, val_loss: 5.1725, lr: 0.003000, 6.91s
2024-04-30 21:21:25 INFO     Saved model at 20
2024-04-30 21:21:25 INFO     Val loss decrease from 5.2704 to 5.1725, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-30 21:21:31 INFO     epoch complete!
2024-04-30 21:21:31 INFO     evaluating now!
2024-04-30 21:21:32 INFO     Epoch [21/200] train_loss: 4.6987, val_loss: 5.5256, lr: 0.003000, 6.96s
2024-04-30 21:21:38 INFO     epoch complete!
2024-04-30 21:21:38 INFO     evaluating now!
2024-04-30 21:21:39 INFO     Epoch [22/200] train_loss: 4.6456, val_loss: 5.2236, lr: 0.003000, 6.99s
2024-04-30 21:21:45 INFO     epoch complete!
2024-04-30 21:21:45 INFO     evaluating now!
2024-04-30 21:21:46 INFO     Epoch [23/200] train_loss: 4.6609, val_loss: 5.3692, lr: 0.003000, 7.04s
2024-04-30 21:21:53 INFO     epoch complete!
2024-04-30 21:21:53 INFO     evaluating now!
2024-04-30 21:21:53 INFO     Epoch [24/200] train_loss: 4.5756, val_loss: 5.0527, lr: 0.003000, 7.66s
2024-04-30 21:21:54 INFO     Saved model at 24
2024-04-30 21:21:54 INFO     Val loss decrease from 5.1725 to 5.0527, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-04-30 21:22:01 INFO     epoch complete!
2024-04-30 21:22:01 INFO     evaluating now!
2024-04-30 21:22:01 INFO     Epoch [25/200] train_loss: 4.4945, val_loss: 5.3150, lr: 0.003000, 7.76s
2024-04-30 21:22:09 INFO     epoch complete!
2024-04-30 21:22:09 INFO     evaluating now!
2024-04-30 21:22:09 INFO     Epoch [26/200] train_loss: 4.4760, val_loss: 5.1776, lr: 0.003000, 7.88s
2024-04-30 21:22:16 INFO     epoch complete!
2024-04-30 21:22:16 INFO     evaluating now!
2024-04-30 21:22:17 INFO     Epoch [27/200] train_loss: 4.4309, val_loss: 5.2416, lr: 0.003000, 7.68s
2024-04-30 21:22:24 INFO     epoch complete!
2024-04-30 21:22:24 INFO     evaluating now!
2024-04-30 21:22:25 INFO     Epoch [28/200] train_loss: 4.3607, val_loss: 5.2185, lr: 0.003000, 7.77s
2024-04-30 21:22:32 INFO     epoch complete!
2024-04-30 21:22:32 INFO     evaluating now!
2024-04-30 21:22:32 INFO     Epoch [29/200] train_loss: 4.3284, val_loss: 5.2008, lr: 0.003000, 7.79s
2024-04-30 21:22:40 INFO     epoch complete!
2024-04-30 21:22:40 INFO     evaluating now!
2024-04-30 21:22:40 INFO     Epoch [30/200] train_loss: 4.2507, val_loss: 5.1625, lr: 0.003000, 7.87s
2024-04-30 21:22:48 INFO     epoch complete!
2024-04-30 21:22:48 INFO     evaluating now!
2024-04-30 21:22:48 INFO     Epoch [31/200] train_loss: 4.2871, val_loss: 5.2278, lr: 0.003000, 7.79s
2024-04-30 21:22:55 INFO     epoch complete!
2024-04-30 21:22:55 INFO     evaluating now!
2024-04-30 21:22:56 INFO     Epoch [32/200] train_loss: 4.1849, val_loss: 5.0771, lr: 0.003000, 7.47s
2024-04-30 21:23:02 INFO     epoch complete!
2024-04-30 21:23:02 INFO     evaluating now!
2024-04-30 21:23:02 INFO     Epoch [33/200] train_loss: 4.1953, val_loss: 5.1564, lr: 0.003000, 6.73s
2024-04-30 21:23:09 INFO     epoch complete!
2024-04-30 21:23:09 INFO     evaluating now!
2024-04-30 21:23:09 INFO     Epoch [34/200] train_loss: 4.1286, val_loss: 5.1787, lr: 0.003000, 6.88s
2024-04-30 21:23:16 INFO     epoch complete!
2024-04-30 21:23:16 INFO     evaluating now!
2024-04-30 21:23:16 INFO     Epoch [35/200] train_loss: 4.0792, val_loss: 5.0190, lr: 0.003000, 7.08s
2024-04-30 21:23:16 INFO     Saved model at 35
2024-04-30 21:23:16 INFO     Val loss decrease from 5.0527 to 5.0190, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-04-30 21:23:23 INFO     epoch complete!
2024-04-30 21:23:23 INFO     evaluating now!
2024-04-30 21:23:23 INFO     Epoch [36/200] train_loss: 4.0866, val_loss: 5.2095, lr: 0.003000, 6.70s
2024-04-30 21:23:29 INFO     epoch complete!
2024-04-30 21:23:29 INFO     evaluating now!
2024-04-30 21:23:30 INFO     Epoch [37/200] train_loss: 4.0995, val_loss: 5.1096, lr: 0.003000, 6.60s
2024-04-30 21:23:36 INFO     epoch complete!
2024-04-30 21:23:36 INFO     evaluating now!
2024-04-30 21:23:36 INFO     Epoch [38/200] train_loss: 4.0240, val_loss: 5.2649, lr: 0.003000, 6.61s
2024-04-30 21:23:42 INFO     epoch complete!
2024-04-30 21:23:42 INFO     evaluating now!
2024-04-30 21:23:43 INFO     Epoch [39/200] train_loss: 3.9617, val_loss: 5.1186, lr: 0.003000, 6.47s
2024-04-30 21:23:49 INFO     epoch complete!
2024-04-30 21:23:49 INFO     evaluating now!
2024-04-30 21:23:49 INFO     Epoch [40/200] train_loss: 3.9974, val_loss: 5.0121, lr: 0.003000, 6.51s
2024-04-30 21:23:49 INFO     Saved model at 40
2024-04-30 21:23:49 INFO     Val loss decrease from 5.0190 to 5.0121, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-04-30 21:23:56 INFO     epoch complete!
2024-04-30 21:23:56 INFO     evaluating now!
2024-04-30 21:23:56 INFO     Epoch [41/200] train_loss: 3.9129, val_loss: 5.0708, lr: 0.003000, 6.76s
2024-04-30 21:24:02 INFO     epoch complete!
2024-04-30 21:24:02 INFO     evaluating now!
2024-04-30 21:24:03 INFO     Epoch [42/200] train_loss: 3.8927, val_loss: 5.1057, lr: 0.003000, 6.91s
2024-04-30 21:24:10 INFO     epoch complete!
2024-04-30 21:24:10 INFO     evaluating now!
2024-04-30 21:24:10 INFO     Epoch [43/200] train_loss: 3.8925, val_loss: 5.1227, lr: 0.003000, 7.08s
2024-04-30 21:24:16 INFO     epoch complete!
2024-04-30 21:24:16 INFO     evaluating now!
2024-04-30 21:24:17 INFO     Epoch [44/200] train_loss: 3.8794, val_loss: 5.1166, lr: 0.003000, 6.88s
2024-04-30 21:24:23 INFO     epoch complete!
2024-04-30 21:24:23 INFO     evaluating now!
2024-04-30 21:24:24 INFO     Epoch [45/200] train_loss: 3.8080, val_loss: 4.9957, lr: 0.003000, 7.05s
2024-04-30 21:24:24 INFO     Saved model at 45
2024-04-30 21:24:24 INFO     Val loss decrease from 5.0121 to 4.9957, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-04-30 21:24:30 INFO     epoch complete!
2024-04-30 21:24:30 INFO     evaluating now!
2024-04-30 21:24:31 INFO     Epoch [46/200] train_loss: 3.7730, val_loss: 4.9315, lr: 0.003000, 7.00s
2024-04-30 21:24:31 INFO     Saved model at 46
2024-04-30 21:24:31 INFO     Val loss decrease from 4.9957 to 4.9315, saving to ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-04-30 21:24:38 INFO     epoch complete!
2024-04-30 21:24:38 INFO     evaluating now!
2024-04-30 21:24:38 INFO     Epoch [47/200] train_loss: 3.7835, val_loss: 5.1366, lr: 0.003000, 7.10s
2024-04-30 21:24:45 INFO     epoch complete!
2024-04-30 21:24:45 INFO     evaluating now!
2024-04-30 21:24:45 INFO     Epoch [48/200] train_loss: 3.7602, val_loss: 4.9916, lr: 0.003000, 6.98s
2024-04-30 21:24:52 INFO     epoch complete!
2024-04-30 21:24:52 INFO     evaluating now!
2024-04-30 21:24:52 INFO     Epoch [49/200] train_loss: 3.7454, val_loss: 5.1098, lr: 0.003000, 7.33s
2024-04-30 21:25:00 INFO     epoch complete!
2024-04-30 21:25:00 INFO     evaluating now!
2024-04-30 21:25:00 INFO     Epoch [50/200] train_loss: 3.7297, val_loss: 4.9655, lr: 0.003000, 7.76s
2024-04-30 21:25:07 INFO     epoch complete!
2024-04-30 21:25:07 INFO     evaluating now!
2024-04-30 21:25:07 INFO     Epoch [51/200] train_loss: 3.7194, val_loss: 4.9842, lr: 0.003000, 7.01s
2024-04-30 21:25:14 INFO     epoch complete!
2024-04-30 21:25:14 INFO     evaluating now!
2024-04-30 21:25:14 INFO     Epoch [52/200] train_loss: 3.6624, val_loss: 5.0263, lr: 0.003000, 6.90s
2024-04-30 21:25:21 INFO     epoch complete!
2024-04-30 21:25:21 INFO     evaluating now!
2024-04-30 21:25:21 INFO     Epoch [53/200] train_loss: 3.6394, val_loss: 5.1310, lr: 0.003000, 7.00s
2024-04-30 21:25:28 INFO     epoch complete!
2024-04-30 21:25:28 INFO     evaluating now!
2024-04-30 21:25:28 INFO     Epoch [54/200] train_loss: 3.6720, val_loss: 5.1026, lr: 0.003000, 6.97s
2024-04-30 21:25:35 INFO     epoch complete!
2024-04-30 21:25:35 INFO     evaluating now!
2024-04-30 21:25:35 INFO     Epoch [55/200] train_loss: 3.6219, val_loss: 5.0897, lr: 0.003000, 7.00s
2024-04-30 21:25:42 INFO     epoch complete!
2024-04-30 21:25:42 INFO     evaluating now!
2024-04-30 21:25:42 INFO     Epoch [56/200] train_loss: 3.6816, val_loss: 4.9646, lr: 0.003000, 6.92s
2024-04-30 21:25:48 INFO     epoch complete!
2024-04-30 21:25:48 INFO     evaluating now!
2024-04-30 21:25:49 INFO     Epoch [57/200] train_loss: 3.6632, val_loss: 5.0579, lr: 0.003000, 6.88s
2024-04-30 21:25:56 INFO     epoch complete!
2024-04-30 21:25:56 INFO     evaluating now!
2024-04-30 21:25:56 INFO     Epoch [58/200] train_loss: 3.6341, val_loss: 5.0168, lr: 0.003000, 7.39s
2024-04-30 21:26:03 INFO     epoch complete!
2024-04-30 21:26:03 INFO     evaluating now!
2024-04-30 21:26:04 INFO     Epoch [59/200] train_loss: 3.5940, val_loss: 4.9497, lr: 0.003000, 7.37s
2024-04-30 21:26:11 INFO     epoch complete!
2024-04-30 21:26:11 INFO     evaluating now!
2024-04-30 21:26:11 INFO     Epoch [60/200] train_loss: 3.5805, val_loss: 5.0757, lr: 0.003000, 7.54s
2024-04-30 21:26:18 INFO     epoch complete!
2024-04-30 21:26:18 INFO     evaluating now!
2024-04-30 21:26:18 INFO     Epoch [61/200] train_loss: 3.5611, val_loss: 5.2082, lr: 0.003000, 6.88s
2024-04-30 21:26:18 WARNING  Early stopping at epoch: 61
2024-04-30 21:26:18 INFO     Trained totally 62 epochs, average train time is 6.595s, average eval time is 0.461s
2024-04-30 21:26:18 INFO     Loaded model at 46
2024-04-30 21:26:18 INFO     Saved model at ./libcity/cache/31/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 21:26:18 INFO     Start evaluating ...
2024-04-30 21:26:20 INFO     Note that you select the single mode to evaluate!
2024-04-30 21:26:20 INFO     Evaluate result is saved at ./libcity/cache/31/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 21:26:20 INFO     
         MAE       RMSE
1   2.403082   7.069820
2   2.498669   7.639501
3   2.655315   8.650081
4   2.796282   9.572474
5   2.909079  10.491643
6   3.008415  11.167850
7   3.044926  11.706594
8   3.104268  12.092239
9   3.134380  12.332067
10  3.244502  12.640820
11  3.302948  13.086851
12  3.473416  13.791688
2024-04-30 21:26:20 INFO     ----------------------------------------------------------------------------
2024-04-30 21:26:20 INFO     # 2, Kownledge Graph Embedding: RotH, Experiment ids: 32
2024-04-30 21:26:20 INFO     ----------------------------------------------------------------------------
2024-04-30 21:26:20 INFO     Log directory: ./libcity/log
2024-04-30 21:26:20 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=32
2024-04-30 21:26:20 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 455649632, 'exp_id': 32, 'load_external': True, 'embedding_model': 'RotH', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 21:26:20 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 21:26:20 INFO     set_weight_link_or_dist: dist
2024-04-30 21:26:20 INFO     init_weight_inf_or_zero: inf
2024-04-30 21:26:20 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 21:26:20 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 21:26:20 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 21:26:20 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 21:26:23 INFO     Dataset created
2024-04-30 21:26:23 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 21:26:23 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 21:26:23 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 21:26:23 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 21:26:23 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 21:26:23 INFO     NoneScaler
2024-04-30 21:26:25 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 21:26:25 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 21:26:25 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 21:26:25 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 21:26:25 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 21:26:25 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 21:26:25 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 21:26:25 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 21:26:25 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 21:26:25 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 21:26:25 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 21:26:25 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 21:26:25 INFO     Total parameter numbers: 874010
2024-04-30 21:26:25 INFO     You select `adam` optimizer.
2024-04-30 21:26:25 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 21:26:25 INFO     Start training ...
2024-04-30 21:26:25 INFO     num_batches:48
2024-04-30 21:26:32 INFO     epoch complete!
2024-04-30 21:26:32 INFO     evaluating now!
2024-04-30 21:26:32 INFO     Epoch [0/200] train_loss: 23.7237, val_loss: 17.4432, lr: 0.003000, 6.91s
2024-04-30 21:26:32 INFO     Saved model at 0
2024-04-30 21:26:32 INFO     Val loss decrease from inf to 17.4432, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 21:26:39 INFO     epoch complete!
2024-04-30 21:26:39 INFO     evaluating now!
2024-04-30 21:26:39 INFO     Epoch [1/200] train_loss: 13.9791, val_loss: 13.2391, lr: 0.003000, 7.03s
2024-04-30 21:26:39 INFO     Saved model at 1
2024-04-30 21:26:39 INFO     Val loss decrease from 17.4432 to 13.2391, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 21:26:45 INFO     epoch complete!
2024-04-30 21:26:45 INFO     evaluating now!
2024-04-30 21:26:46 INFO     Epoch [2/200] train_loss: 11.0372, val_loss: 10.7007, lr: 0.003000, 6.43s
2024-04-30 21:26:48 INFO     Saved model at 2
2024-04-30 21:26:48 INFO     Val loss decrease from 13.2391 to 10.7007, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 21:26:55 INFO     epoch complete!
2024-04-30 21:26:55 INFO     evaluating now!
2024-04-30 21:26:55 INFO     Epoch [3/200] train_loss: 9.2322, val_loss: 8.8256, lr: 0.003000, 6.77s
2024-04-30 21:26:55 INFO     Saved model at 3
2024-04-30 21:26:55 INFO     Val loss decrease from 10.7007 to 8.8256, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 21:27:02 INFO     epoch complete!
2024-04-30 21:27:02 INFO     evaluating now!
2024-04-30 21:27:02 INFO     Epoch [4/200] train_loss: 8.1026, val_loss: 7.7651, lr: 0.003000, 6.96s
2024-04-30 21:27:02 INFO     Saved model at 4
2024-04-30 21:27:02 INFO     Val loss decrease from 8.8256 to 7.7651, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 21:27:08 INFO     epoch complete!
2024-04-30 21:27:08 INFO     evaluating now!
2024-04-30 21:27:09 INFO     Epoch [5/200] train_loss: 7.4414, val_loss: 7.1131, lr: 0.003000, 6.27s
2024-04-30 21:27:09 INFO     Saved model at 5
2024-04-30 21:27:09 INFO     Val loss decrease from 7.7651 to 7.1131, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 21:27:15 INFO     epoch complete!
2024-04-30 21:27:15 INFO     evaluating now!
2024-04-30 21:27:15 INFO     Epoch [6/200] train_loss: 6.8741, val_loss: 6.7277, lr: 0.003000, 6.74s
2024-04-30 21:27:16 INFO     Saved model at 6
2024-04-30 21:27:16 INFO     Val loss decrease from 7.1131 to 6.7277, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 21:27:22 INFO     epoch complete!
2024-04-30 21:27:22 INFO     evaluating now!
2024-04-30 21:27:22 INFO     Epoch [7/200] train_loss: 6.4445, val_loss: 6.4101, lr: 0.003000, 6.93s
2024-04-30 21:27:23 INFO     Saved model at 7
2024-04-30 21:27:23 INFO     Val loss decrease from 6.7277 to 6.4101, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 21:27:29 INFO     epoch complete!
2024-04-30 21:27:29 INFO     evaluating now!
2024-04-30 21:27:29 INFO     Epoch [8/200] train_loss: 6.1996, val_loss: 6.3344, lr: 0.003000, 6.80s
2024-04-30 21:27:29 INFO     Saved model at 8
2024-04-30 21:27:29 INFO     Val loss decrease from 6.4101 to 6.3344, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 21:27:36 INFO     epoch complete!
2024-04-30 21:27:36 INFO     evaluating now!
2024-04-30 21:27:36 INFO     Epoch [9/200] train_loss: 6.1240, val_loss: 6.1588, lr: 0.003000, 6.85s
2024-04-30 21:27:36 INFO     Saved model at 9
2024-04-30 21:27:36 INFO     Val loss decrease from 6.3344 to 6.1588, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 21:27:43 INFO     epoch complete!
2024-04-30 21:27:43 INFO     evaluating now!
2024-04-30 21:27:43 INFO     Epoch [10/200] train_loss: 5.8098, val_loss: 5.9597, lr: 0.003000, 6.77s
2024-04-30 21:27:43 INFO     Saved model at 10
2024-04-30 21:27:43 INFO     Val loss decrease from 6.1588 to 5.9597, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 21:27:49 INFO     epoch complete!
2024-04-30 21:27:49 INFO     evaluating now!
2024-04-30 21:27:50 INFO     Epoch [11/200] train_loss: 5.6750, val_loss: 5.9024, lr: 0.003000, 6.70s
2024-04-30 21:27:50 INFO     Saved model at 11
2024-04-30 21:27:50 INFO     Val loss decrease from 5.9597 to 5.9024, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 21:27:56 INFO     epoch complete!
2024-04-30 21:27:56 INFO     evaluating now!
2024-04-30 21:27:57 INFO     Epoch [12/200] train_loss: 5.5043, val_loss: 5.8135, lr: 0.003000, 6.76s
2024-04-30 21:27:57 INFO     Saved model at 12
2024-04-30 21:27:57 INFO     Val loss decrease from 5.9024 to 5.8135, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 21:28:03 INFO     epoch complete!
2024-04-30 21:28:03 INFO     evaluating now!
2024-04-30 21:28:03 INFO     Epoch [13/200] train_loss: 5.4428, val_loss: 5.8608, lr: 0.003000, 6.71s
2024-04-30 21:28:10 INFO     epoch complete!
2024-04-30 21:28:10 INFO     evaluating now!
2024-04-30 21:28:10 INFO     Epoch [14/200] train_loss: 5.2824, val_loss: 5.7460, lr: 0.003000, 6.83s
2024-04-30 21:28:10 INFO     Saved model at 14
2024-04-30 21:28:10 INFO     Val loss decrease from 5.8135 to 5.7460, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 21:28:16 INFO     epoch complete!
2024-04-30 21:28:16 INFO     evaluating now!
2024-04-30 21:28:17 INFO     Epoch [15/200] train_loss: 5.2269, val_loss: 5.7904, lr: 0.003000, 6.69s
2024-04-30 21:28:23 INFO     epoch complete!
2024-04-30 21:28:23 INFO     evaluating now!
2024-04-30 21:28:24 INFO     Epoch [16/200] train_loss: 5.1701, val_loss: 5.5315, lr: 0.003000, 6.63s
2024-04-30 21:28:24 INFO     Saved model at 16
2024-04-30 21:28:24 INFO     Val loss decrease from 5.7460 to 5.5315, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 21:28:30 INFO     epoch complete!
2024-04-30 21:28:30 INFO     evaluating now!
2024-04-30 21:28:30 INFO     Epoch [17/200] train_loss: 5.0529, val_loss: 5.4512, lr: 0.003000, 6.64s
2024-04-30 21:28:30 INFO     Saved model at 17
2024-04-30 21:28:30 INFO     Val loss decrease from 5.5315 to 5.4512, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 21:28:36 INFO     epoch complete!
2024-04-30 21:28:36 INFO     evaluating now!
2024-04-30 21:28:37 INFO     Epoch [18/200] train_loss: 4.9686, val_loss: 5.4279, lr: 0.003000, 6.61s
2024-04-30 21:28:37 INFO     Saved model at 18
2024-04-30 21:28:37 INFO     Val loss decrease from 5.4512 to 5.4279, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 21:28:43 INFO     epoch complete!
2024-04-30 21:28:43 INFO     evaluating now!
2024-04-30 21:28:43 INFO     Epoch [19/200] train_loss: 4.9726, val_loss: 5.3073, lr: 0.003000, 6.59s
2024-04-30 21:28:44 INFO     Saved model at 19
2024-04-30 21:28:44 INFO     Val loss decrease from 5.4279 to 5.3073, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 21:28:50 INFO     epoch complete!
2024-04-30 21:28:50 INFO     evaluating now!
2024-04-30 21:28:50 INFO     Epoch [20/200] train_loss: 4.8525, val_loss: 5.1571, lr: 0.003000, 6.64s
2024-04-30 21:28:50 INFO     Saved model at 20
2024-04-30 21:28:50 INFO     Val loss decrease from 5.3073 to 5.1571, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-30 21:28:56 INFO     epoch complete!
2024-04-30 21:28:56 INFO     evaluating now!
2024-04-30 21:28:57 INFO     Epoch [21/200] train_loss: 4.8268, val_loss: 5.2042, lr: 0.003000, 6.68s
2024-04-30 21:29:03 INFO     epoch complete!
2024-04-30 21:29:03 INFO     evaluating now!
2024-04-30 21:29:04 INFO     Epoch [22/200] train_loss: 4.7143, val_loss: 5.2767, lr: 0.003000, 6.76s
2024-04-30 21:29:10 INFO     epoch complete!
2024-04-30 21:29:10 INFO     evaluating now!
2024-04-30 21:29:10 INFO     Epoch [23/200] train_loss: 4.6141, val_loss: 5.2209, lr: 0.003000, 6.74s
2024-04-30 21:29:17 INFO     epoch complete!
2024-04-30 21:29:17 INFO     evaluating now!
2024-04-30 21:29:17 INFO     Epoch [24/200] train_loss: 4.6362, val_loss: 5.3040, lr: 0.003000, 6.71s
2024-04-30 21:29:23 INFO     epoch complete!
2024-04-30 21:29:23 INFO     evaluating now!
2024-04-30 21:29:24 INFO     Epoch [25/200] train_loss: 4.5858, val_loss: 5.2294, lr: 0.003000, 6.63s
2024-04-30 21:29:30 INFO     epoch complete!
2024-04-30 21:29:30 INFO     evaluating now!
2024-04-30 21:29:30 INFO     Epoch [26/200] train_loss: 4.5726, val_loss: 5.2320, lr: 0.003000, 6.61s
2024-04-30 21:29:37 INFO     epoch complete!
2024-04-30 21:29:37 INFO     evaluating now!
2024-04-30 21:29:37 INFO     Epoch [27/200] train_loss: 4.5435, val_loss: 5.0881, lr: 0.003000, 6.77s
2024-04-30 21:29:37 INFO     Saved model at 27
2024-04-30 21:29:37 INFO     Val loss decrease from 5.1571 to 5.0881, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-30 21:29:44 INFO     epoch complete!
2024-04-30 21:29:44 INFO     evaluating now!
2024-04-30 21:29:44 INFO     Epoch [28/200] train_loss: 4.4604, val_loss: 5.1082, lr: 0.003000, 6.93s
2024-04-30 21:29:50 INFO     epoch complete!
2024-04-30 21:29:50 INFO     evaluating now!
2024-04-30 21:29:51 INFO     Epoch [29/200] train_loss: 4.4297, val_loss: 5.1731, lr: 0.003000, 6.60s
2024-04-30 21:29:57 INFO     epoch complete!
2024-04-30 21:29:57 INFO     evaluating now!
2024-04-30 21:29:57 INFO     Epoch [30/200] train_loss: 4.3476, val_loss: 5.1319, lr: 0.003000, 6.31s
2024-04-30 21:30:03 INFO     epoch complete!
2024-04-30 21:30:03 INFO     evaluating now!
2024-04-30 21:30:03 INFO     Epoch [31/200] train_loss: 4.2927, val_loss: 5.0357, lr: 0.003000, 6.39s
2024-04-30 21:30:03 INFO     Saved model at 31
2024-04-30 21:30:03 INFO     Val loss decrease from 5.0881 to 5.0357, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-04-30 21:30:09 INFO     epoch complete!
2024-04-30 21:30:09 INFO     evaluating now!
2024-04-30 21:30:10 INFO     Epoch [32/200] train_loss: 4.2523, val_loss: 5.2371, lr: 0.003000, 6.31s
2024-04-30 21:30:16 INFO     epoch complete!
2024-04-30 21:30:16 INFO     evaluating now!
2024-04-30 21:30:17 INFO     Epoch [33/200] train_loss: 4.2624, val_loss: 5.0845, lr: 0.003000, 7.04s
2024-04-30 21:30:23 INFO     epoch complete!
2024-04-30 21:30:23 INFO     evaluating now!
2024-04-30 21:30:24 INFO     Epoch [34/200] train_loss: 4.2320, val_loss: 5.0788, lr: 0.003000, 7.17s
2024-04-30 21:30:31 INFO     epoch complete!
2024-04-30 21:30:31 INFO     evaluating now!
2024-04-30 21:30:31 INFO     Epoch [35/200] train_loss: 4.1632, val_loss: 5.1005, lr: 0.003000, 7.51s
2024-04-30 21:30:38 INFO     epoch complete!
2024-04-30 21:30:38 INFO     evaluating now!
2024-04-30 21:30:39 INFO     Epoch [36/200] train_loss: 4.1341, val_loss: 5.0438, lr: 0.003000, 7.52s
2024-04-30 21:30:46 INFO     epoch complete!
2024-04-30 21:30:46 INFO     evaluating now!
2024-04-30 21:30:46 INFO     Epoch [37/200] train_loss: 4.0875, val_loss: 5.0872, lr: 0.003000, 7.23s
2024-04-30 21:30:53 INFO     epoch complete!
2024-04-30 21:30:53 INFO     evaluating now!
2024-04-30 21:30:54 INFO     Epoch [38/200] train_loss: 4.1078, val_loss: 5.0511, lr: 0.003000, 7.34s
2024-04-30 21:31:00 INFO     epoch complete!
2024-04-30 21:31:00 INFO     evaluating now!
2024-04-30 21:31:01 INFO     Epoch [39/200] train_loss: 4.0582, val_loss: 5.0443, lr: 0.003000, 7.40s
2024-04-30 21:31:08 INFO     epoch complete!
2024-04-30 21:31:08 INFO     evaluating now!
2024-04-30 21:31:08 INFO     Epoch [40/200] train_loss: 4.0322, val_loss: 5.1297, lr: 0.003000, 7.38s
2024-04-30 21:31:15 INFO     epoch complete!
2024-04-30 21:31:15 INFO     evaluating now!
2024-04-30 21:31:16 INFO     Epoch [41/200] train_loss: 3.9857, val_loss: 5.1152, lr: 0.003000, 7.27s
2024-04-30 21:31:22 INFO     epoch complete!
2024-04-30 21:31:22 INFO     evaluating now!
2024-04-30 21:31:23 INFO     Epoch [42/200] train_loss: 4.0057, val_loss: 5.1249, lr: 0.003000, 7.32s
2024-04-30 21:31:30 INFO     epoch complete!
2024-04-30 21:31:30 INFO     evaluating now!
2024-04-30 21:31:30 INFO     Epoch [43/200] train_loss: 3.9840, val_loss: 4.9620, lr: 0.003000, 7.31s
2024-04-30 21:31:30 INFO     Saved model at 43
2024-04-30 21:31:30 INFO     Val loss decrease from 5.0357 to 4.9620, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-04-30 21:31:37 INFO     epoch complete!
2024-04-30 21:31:37 INFO     evaluating now!
2024-04-30 21:31:38 INFO     Epoch [44/200] train_loss: 3.9564, val_loss: 5.0144, lr: 0.003000, 7.41s
2024-04-30 21:31:44 INFO     epoch complete!
2024-04-30 21:31:44 INFO     evaluating now!
2024-04-30 21:31:45 INFO     Epoch [45/200] train_loss: 3.8767, val_loss: 5.0944, lr: 0.003000, 7.31s
2024-04-30 21:31:52 INFO     epoch complete!
2024-04-30 21:31:52 INFO     evaluating now!
2024-04-30 21:31:52 INFO     Epoch [46/200] train_loss: 3.8744, val_loss: 5.0934, lr: 0.003000, 7.38s
2024-04-30 21:31:59 INFO     epoch complete!
2024-04-30 21:31:59 INFO     evaluating now!
2024-04-30 21:32:00 INFO     Epoch [47/200] train_loss: 3.8488, val_loss: 5.0946, lr: 0.003000, 7.39s
2024-04-30 21:32:07 INFO     epoch complete!
2024-04-30 21:32:07 INFO     evaluating now!
2024-04-30 21:32:07 INFO     Epoch [48/200] train_loss: 3.8406, val_loss: 4.9741, lr: 0.003000, 7.52s
2024-04-30 21:32:14 INFO     epoch complete!
2024-04-30 21:32:14 INFO     evaluating now!
2024-04-30 21:32:15 INFO     Epoch [49/200] train_loss: 3.8315, val_loss: 5.0912, lr: 0.003000, 7.44s
2024-04-30 21:32:22 INFO     epoch complete!
2024-04-30 21:32:22 INFO     evaluating now!
2024-04-30 21:32:22 INFO     Epoch [50/200] train_loss: 3.8233, val_loss: 5.0660, lr: 0.003000, 7.46s
2024-04-30 21:32:29 INFO     epoch complete!
2024-04-30 21:32:29 INFO     evaluating now!
2024-04-30 21:32:30 INFO     Epoch [51/200] train_loss: 3.8357, val_loss: 5.0506, lr: 0.003000, 7.39s
2024-04-30 21:32:37 INFO     epoch complete!
2024-04-30 21:32:37 INFO     evaluating now!
2024-04-30 21:32:37 INFO     Epoch [52/200] train_loss: 3.7472, val_loss: 5.0701, lr: 0.003000, 7.47s
2024-04-30 21:32:44 INFO     epoch complete!
2024-04-30 21:32:44 INFO     evaluating now!
2024-04-30 21:32:45 INFO     Epoch [53/200] train_loss: 3.7761, val_loss: 4.9670, lr: 0.003000, 7.50s
2024-04-30 21:32:51 INFO     epoch complete!
2024-04-30 21:32:51 INFO     evaluating now!
2024-04-30 21:32:52 INFO     Epoch [54/200] train_loss: 3.7717, val_loss: 5.0292, lr: 0.003000, 7.42s
2024-04-30 21:32:59 INFO     epoch complete!
2024-04-30 21:32:59 INFO     evaluating now!
2024-04-30 21:32:59 INFO     Epoch [55/200] train_loss: 3.7341, val_loss: 5.0076, lr: 0.003000, 7.45s
2024-04-30 21:33:06 INFO     epoch complete!
2024-04-30 21:33:06 INFO     evaluating now!
2024-04-30 21:33:07 INFO     Epoch [56/200] train_loss: 3.6937, val_loss: 5.0677, lr: 0.003000, 7.42s
2024-04-30 21:33:14 INFO     epoch complete!
2024-04-30 21:33:14 INFO     evaluating now!
2024-04-30 21:33:14 INFO     Epoch [57/200] train_loss: 3.6553, val_loss: 4.9376, lr: 0.003000, 7.44s
2024-04-30 21:33:14 INFO     Saved model at 57
2024-04-30 21:33:14 INFO     Val loss decrease from 4.9620 to 4.9376, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch57.tar
2024-04-30 21:33:21 INFO     epoch complete!
2024-04-30 21:33:21 INFO     evaluating now!
2024-04-30 21:33:22 INFO     Epoch [58/200] train_loss: 3.7012, val_loss: 4.9725, lr: 0.003000, 7.39s
2024-04-30 21:33:29 INFO     epoch complete!
2024-04-30 21:33:29 INFO     evaluating now!
2024-04-30 21:33:29 INFO     Epoch [59/200] train_loss: 3.6666, val_loss: 4.9815, lr: 0.003000, 7.79s
2024-04-30 21:33:37 INFO     epoch complete!
2024-04-30 21:33:37 INFO     evaluating now!
2024-04-30 21:33:37 INFO     Epoch [60/200] train_loss: 3.6647, val_loss: 5.0552, lr: 0.003000, 7.86s
2024-04-30 21:33:44 INFO     epoch complete!
2024-04-30 21:33:44 INFO     evaluating now!
2024-04-30 21:33:45 INFO     Epoch [61/200] train_loss: 3.6263, val_loss: 4.9316, lr: 0.003000, 7.42s
2024-04-30 21:33:45 INFO     Saved model at 61
2024-04-30 21:33:45 INFO     Val loss decrease from 4.9376 to 4.9316, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch61.tar
2024-04-30 21:33:52 INFO     epoch complete!
2024-04-30 21:33:52 INFO     evaluating now!
2024-04-30 21:33:52 INFO     Epoch [62/200] train_loss: 3.6024, val_loss: 5.1282, lr: 0.003000, 7.44s
2024-04-30 21:33:59 INFO     epoch complete!
2024-04-30 21:33:59 INFO     evaluating now!
2024-04-30 21:34:00 INFO     Epoch [63/200] train_loss: 3.6150, val_loss: 5.1257, lr: 0.003000, 7.45s
2024-04-30 21:34:07 INFO     epoch complete!
2024-04-30 21:34:07 INFO     evaluating now!
2024-04-30 21:34:07 INFO     Epoch [64/200] train_loss: 3.5512, val_loss: 5.0902, lr: 0.003000, 7.49s
2024-04-30 21:34:14 INFO     epoch complete!
2024-04-30 21:34:14 INFO     evaluating now!
2024-04-30 21:34:15 INFO     Epoch [65/200] train_loss: 3.5374, val_loss: 5.0331, lr: 0.003000, 7.37s
2024-04-30 21:34:21 INFO     epoch complete!
2024-04-30 21:34:21 INFO     evaluating now!
2024-04-30 21:34:22 INFO     Epoch [66/200] train_loss: 3.5439, val_loss: 5.0136, lr: 0.003000, 7.26s
2024-04-30 21:34:29 INFO     epoch complete!
2024-04-30 21:34:29 INFO     evaluating now!
2024-04-30 21:34:29 INFO     Epoch [67/200] train_loss: 3.5149, val_loss: 5.0488, lr: 0.003000, 7.34s
2024-04-30 21:34:36 INFO     epoch complete!
2024-04-30 21:34:36 INFO     evaluating now!
2024-04-30 21:34:37 INFO     Epoch [68/200] train_loss: 3.5453, val_loss: 4.9357, lr: 0.003000, 7.46s
2024-04-30 21:34:44 INFO     epoch complete!
2024-04-30 21:34:44 INFO     evaluating now!
2024-04-30 21:34:44 INFO     Epoch [69/200] train_loss: 3.4956, val_loss: 5.0303, lr: 0.003000, 7.49s
2024-04-30 21:34:51 INFO     epoch complete!
2024-04-30 21:34:51 INFO     evaluating now!
2024-04-30 21:34:51 INFO     Epoch [70/200] train_loss: 3.4912, val_loss: 5.0060, lr: 0.003000, 7.36s
2024-04-30 21:34:58 INFO     epoch complete!
2024-04-30 21:34:58 INFO     evaluating now!
2024-04-30 21:34:59 INFO     Epoch [71/200] train_loss: 3.5303, val_loss: 5.1168, lr: 0.003000, 7.46s
2024-04-30 21:35:06 INFO     epoch complete!
2024-04-30 21:35:06 INFO     evaluating now!
2024-04-30 21:35:06 INFO     Epoch [72/200] train_loss: 3.5362, val_loss: 4.9116, lr: 0.003000, 7.35s
2024-04-30 21:35:06 INFO     Saved model at 72
2024-04-30 21:35:06 INFO     Val loss decrease from 4.9316 to 4.9116, saving to ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406_epoch72.tar
2024-04-30 21:35:13 INFO     epoch complete!
2024-04-30 21:35:13 INFO     evaluating now!
2024-04-30 21:35:14 INFO     Epoch [73/200] train_loss: 3.4604, val_loss: 4.9922, lr: 0.003000, 7.35s
2024-04-30 21:35:20 INFO     epoch complete!
2024-04-30 21:35:20 INFO     evaluating now!
2024-04-30 21:35:21 INFO     Epoch [74/200] train_loss: 3.4958, val_loss: 4.9877, lr: 0.003000, 7.32s
2024-04-30 21:35:28 INFO     epoch complete!
2024-04-30 21:35:28 INFO     evaluating now!
2024-04-30 21:35:28 INFO     Epoch [75/200] train_loss: 3.4186, val_loss: 5.0204, lr: 0.003000, 7.48s
2024-04-30 21:35:35 INFO     epoch complete!
2024-04-30 21:35:35 INFO     evaluating now!
2024-04-30 21:35:36 INFO     Epoch [76/200] train_loss: 3.4058, val_loss: 5.0100, lr: 0.003000, 7.08s
2024-04-30 21:35:42 INFO     epoch complete!
2024-04-30 21:35:42 INFO     evaluating now!
2024-04-30 21:35:43 INFO     Epoch [77/200] train_loss: 3.4286, val_loss: 5.0494, lr: 0.003000, 7.04s
2024-04-30 21:35:49 INFO     epoch complete!
2024-04-30 21:35:49 INFO     evaluating now!
2024-04-30 21:35:50 INFO     Epoch [78/200] train_loss: 3.3964, val_loss: 5.0013, lr: 0.003000, 7.13s
2024-04-30 21:35:56 INFO     epoch complete!
2024-04-30 21:35:56 INFO     evaluating now!
2024-04-30 21:35:57 INFO     Epoch [79/200] train_loss: 3.3812, val_loss: 5.0824, lr: 0.003000, 7.01s
2024-04-30 21:36:04 INFO     epoch complete!
2024-04-30 21:36:04 INFO     evaluating now!
2024-04-30 21:36:04 INFO     Epoch [80/200] train_loss: 3.3711, val_loss: 5.0872, lr: 0.003000, 7.30s
2024-04-30 21:36:10 INFO     epoch complete!
2024-04-30 21:36:10 INFO     evaluating now!
2024-04-30 21:36:11 INFO     Epoch [81/200] train_loss: 3.3894, val_loss: 5.0347, lr: 0.003000, 6.49s
2024-04-30 21:36:16 INFO     epoch complete!
2024-04-30 21:36:16 INFO     evaluating now!
2024-04-30 21:36:17 INFO     Epoch [82/200] train_loss: 3.3585, val_loss: 4.9405, lr: 0.003000, 6.32s
2024-04-30 21:36:23 INFO     epoch complete!
2024-04-30 21:36:23 INFO     evaluating now!
2024-04-30 21:36:23 INFO     Epoch [83/200] train_loss: 3.3936, val_loss: 5.0304, lr: 0.003000, 6.51s
2024-04-30 21:36:29 INFO     epoch complete!
2024-04-30 21:36:29 INFO     evaluating now!
2024-04-30 21:36:30 INFO     Epoch [84/200] train_loss: 3.3388, val_loss: 5.1374, lr: 0.003000, 6.57s
2024-04-30 21:36:36 INFO     epoch complete!
2024-04-30 21:36:36 INFO     evaluating now!
2024-04-30 21:36:37 INFO     Epoch [85/200] train_loss: 3.3378, val_loss: 5.0263, lr: 0.003000, 6.78s
2024-04-30 21:36:43 INFO     epoch complete!
2024-04-30 21:36:43 INFO     evaluating now!
2024-04-30 21:36:43 INFO     Epoch [86/200] train_loss: 3.3150, val_loss: 4.9795, lr: 0.003000, 6.61s
2024-04-30 21:36:50 INFO     epoch complete!
2024-04-30 21:36:50 INFO     evaluating now!
2024-04-30 21:36:50 INFO     Epoch [87/200] train_loss: 3.3203, val_loss: 5.1397, lr: 0.003000, 7.01s
2024-04-30 21:36:50 WARNING  Early stopping at epoch: 87
2024-04-30 21:36:50 INFO     Trained totally 88 epochs, average train time is 6.583s, average eval time is 0.473s
2024-04-30 21:36:51 INFO     Loaded model at 72
2024-04-30 21:36:51 INFO     Saved model at ./libcity/cache/32/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 21:36:51 INFO     Start evaluating ...
2024-04-30 21:36:53 INFO     Note that you select the single mode to evaluate!
2024-04-30 21:36:53 INFO     Evaluate result is saved at ./libcity/cache/32/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 21:36:53 INFO     
         MAE       RMSE
1   2.358228   7.315127
2   2.505338   8.045582
3   2.650576   8.869423
4   2.754621   9.536182
5   2.832837  10.134720
6   2.980249  10.774800
7   3.061498  11.521431
8   3.109380  12.111199
9   3.151498  12.410729
10  3.198807  12.625302
11  3.287026  12.852555
12  3.394163  13.287719
2024-04-30 21:36:53 INFO     ----------------------------------------------------------------------------
2024-04-30 21:36:53 INFO     # 3, Kownledge Graph Embedding: RotH, Experiment ids: 33
2024-04-30 21:36:53 INFO     ----------------------------------------------------------------------------
2024-04-30 21:36:53 INFO     Log directory: ./libcity/log
2024-04-30 21:36:53 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=33
2024-04-30 21:36:53 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 948266344, 'exp_id': 33, 'load_external': True, 'embedding_model': 'RotH', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 21:36:53 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 21:36:53 INFO     set_weight_link_or_dist: dist
2024-04-30 21:36:53 INFO     init_weight_inf_or_zero: inf
2024-04-30 21:36:53 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 21:36:53 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 21:36:53 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 21:36:53 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 21:36:56 INFO     Dataset created
2024-04-30 21:36:56 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 21:36:56 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 21:36:56 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 21:36:56 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 21:36:56 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 21:36:56 INFO     NoneScaler
2024-04-30 21:36:58 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 21:36:58 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 21:36:58 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 21:36:58 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 21:36:58 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 21:36:58 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 21:36:58 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 21:36:58 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 21:36:58 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 21:36:58 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 21:36:58 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 21:36:58 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 21:36:58 INFO     Total parameter numbers: 874010
2024-04-30 21:36:58 INFO     You select `adam` optimizer.
2024-04-30 21:36:58 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 21:36:58 INFO     Start training ...
2024-04-30 21:36:58 INFO     num_batches:48
2024-04-30 21:37:05 INFO     epoch complete!
2024-04-30 21:37:05 INFO     evaluating now!
2024-04-30 21:37:05 INFO     Epoch [0/200] train_loss: 24.0014, val_loss: 17.8823, lr: 0.003000, 7.04s
2024-04-30 21:37:05 INFO     Saved model at 0
2024-04-30 21:37:05 INFO     Val loss decrease from inf to 17.8823, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 21:37:12 INFO     epoch complete!
2024-04-30 21:37:12 INFO     evaluating now!
2024-04-30 21:37:12 INFO     Epoch [1/200] train_loss: 14.4332, val_loss: 13.7352, lr: 0.003000, 7.21s
2024-04-30 21:37:12 INFO     Saved model at 1
2024-04-30 21:37:12 INFO     Val loss decrease from 17.8823 to 13.7352, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 21:37:19 INFO     epoch complete!
2024-04-30 21:37:19 INFO     evaluating now!
2024-04-30 21:37:20 INFO     Epoch [2/200] train_loss: 11.0575, val_loss: 10.3352, lr: 0.003000, 7.13s
2024-04-30 21:37:20 INFO     Saved model at 2
2024-04-30 21:37:20 INFO     Val loss decrease from 13.7352 to 10.3352, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 21:37:26 INFO     epoch complete!
2024-04-30 21:37:26 INFO     evaluating now!
2024-04-30 21:37:27 INFO     Epoch [3/200] train_loss: 9.0051, val_loss: 8.7538, lr: 0.003000, 6.94s
2024-04-30 21:37:27 INFO     Saved model at 3
2024-04-30 21:37:27 INFO     Val loss decrease from 10.3352 to 8.7538, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 21:37:33 INFO     epoch complete!
2024-04-30 21:37:33 INFO     evaluating now!
2024-04-30 21:37:34 INFO     Epoch [4/200] train_loss: 7.8049, val_loss: 7.3646, lr: 0.003000, 7.02s
2024-04-30 21:37:34 INFO     Saved model at 4
2024-04-30 21:37:34 INFO     Val loss decrease from 8.7538 to 7.3646, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 21:37:40 INFO     epoch complete!
2024-04-30 21:37:40 INFO     evaluating now!
2024-04-30 21:37:41 INFO     Epoch [5/200] train_loss: 7.0422, val_loss: 7.2669, lr: 0.003000, 6.91s
2024-04-30 21:37:41 INFO     Saved model at 5
2024-04-30 21:37:41 INFO     Val loss decrease from 7.3646 to 7.2669, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 21:37:47 INFO     epoch complete!
2024-04-30 21:37:47 INFO     evaluating now!
2024-04-30 21:37:48 INFO     Epoch [6/200] train_loss: 6.6114, val_loss: 6.4188, lr: 0.003000, 7.03s
2024-04-30 21:37:48 INFO     Saved model at 6
2024-04-30 21:37:48 INFO     Val loss decrease from 7.2669 to 6.4188, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 21:37:54 INFO     epoch complete!
2024-04-30 21:37:54 INFO     evaluating now!
2024-04-30 21:37:55 INFO     Epoch [7/200] train_loss: 6.2874, val_loss: 6.3345, lr: 0.003000, 6.79s
2024-04-30 21:37:55 INFO     Saved model at 7
2024-04-30 21:37:55 INFO     Val loss decrease from 6.4188 to 6.3345, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 21:38:01 INFO     epoch complete!
2024-04-30 21:38:01 INFO     evaluating now!
2024-04-30 21:38:02 INFO     Epoch [8/200] train_loss: 6.0380, val_loss: 6.1593, lr: 0.003000, 7.11s
2024-04-30 21:38:02 INFO     Saved model at 8
2024-04-30 21:38:02 INFO     Val loss decrease from 6.3345 to 6.1593, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 21:38:08 INFO     epoch complete!
2024-04-30 21:38:08 INFO     evaluating now!
2024-04-30 21:38:09 INFO     Epoch [9/200] train_loss: 5.8129, val_loss: 5.9228, lr: 0.003000, 7.23s
2024-04-30 21:38:09 INFO     Saved model at 9
2024-04-30 21:38:09 INFO     Val loss decrease from 6.1593 to 5.9228, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 21:38:15 INFO     epoch complete!
2024-04-30 21:38:15 INFO     evaluating now!
2024-04-30 21:38:16 INFO     Epoch [10/200] train_loss: 5.6603, val_loss: 6.1596, lr: 0.003000, 6.74s
2024-04-30 21:38:22 INFO     epoch complete!
2024-04-30 21:38:22 INFO     evaluating now!
2024-04-30 21:38:23 INFO     Epoch [11/200] train_loss: 5.5205, val_loss: 5.9762, lr: 0.003000, 6.93s
2024-04-30 21:38:29 INFO     epoch complete!
2024-04-30 21:38:29 INFO     evaluating now!
2024-04-30 21:38:30 INFO     Epoch [12/200] train_loss: 5.3473, val_loss: 5.5769, lr: 0.003000, 6.96s
2024-04-30 21:38:30 INFO     Saved model at 12
2024-04-30 21:38:30 INFO     Val loss decrease from 5.9228 to 5.5769, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 21:38:36 INFO     epoch complete!
2024-04-30 21:38:36 INFO     evaluating now!
2024-04-30 21:38:36 INFO     Epoch [13/200] train_loss: 5.2137, val_loss: 5.4516, lr: 0.003000, 6.72s
2024-04-30 21:38:36 INFO     Saved model at 13
2024-04-30 21:38:36 INFO     Val loss decrease from 5.5769 to 5.4516, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 21:38:43 INFO     epoch complete!
2024-04-30 21:38:43 INFO     evaluating now!
2024-04-30 21:38:43 INFO     Epoch [14/200] train_loss: 5.1897, val_loss: 5.4729, lr: 0.003000, 6.58s
2024-04-30 21:38:49 INFO     epoch complete!
2024-04-30 21:38:49 INFO     evaluating now!
2024-04-30 21:38:50 INFO     Epoch [15/200] train_loss: 5.1383, val_loss: 5.5024, lr: 0.003000, 6.91s
2024-04-30 21:38:56 INFO     epoch complete!
2024-04-30 21:38:56 INFO     evaluating now!
2024-04-30 21:38:57 INFO     Epoch [16/200] train_loss: 4.9713, val_loss: 5.4989, lr: 0.003000, 7.02s
2024-04-30 21:39:03 INFO     epoch complete!
2024-04-30 21:39:03 INFO     evaluating now!
2024-04-30 21:39:04 INFO     Epoch [17/200] train_loss: 4.9323, val_loss: 5.4699, lr: 0.003000, 7.05s
2024-04-30 21:39:11 INFO     epoch complete!
2024-04-30 21:39:11 INFO     evaluating now!
2024-04-30 21:39:11 INFO     Epoch [18/200] train_loss: 4.8591, val_loss: 5.4735, lr: 0.003000, 7.23s
2024-04-30 21:39:18 INFO     epoch complete!
2024-04-30 21:39:18 INFO     evaluating now!
2024-04-30 21:39:19 INFO     Epoch [19/200] train_loss: 4.8356, val_loss: 5.2016, lr: 0.003000, 7.61s
2024-04-30 21:39:19 INFO     Saved model at 19
2024-04-30 21:39:19 INFO     Val loss decrease from 5.4516 to 5.2016, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 21:39:26 INFO     epoch complete!
2024-04-30 21:39:26 INFO     evaluating now!
2024-04-30 21:39:27 INFO     Epoch [20/200] train_loss: 4.6546, val_loss: 5.4226, lr: 0.003000, 7.92s
2024-04-30 21:39:34 INFO     epoch complete!
2024-04-30 21:39:34 INFO     evaluating now!
2024-04-30 21:39:34 INFO     Epoch [21/200] train_loss: 4.6335, val_loss: 5.2186, lr: 0.003000, 7.38s
2024-04-30 21:39:41 INFO     epoch complete!
2024-04-30 21:39:41 INFO     evaluating now!
2024-04-30 21:39:41 INFO     Epoch [22/200] train_loss: 4.5932, val_loss: 5.3060, lr: 0.003000, 7.24s
2024-04-30 21:39:48 INFO     epoch complete!
2024-04-30 21:39:48 INFO     evaluating now!
2024-04-30 21:39:49 INFO     Epoch [23/200] train_loss: 4.5673, val_loss: 5.1336, lr: 0.003000, 7.36s
2024-04-30 21:39:49 INFO     Saved model at 23
2024-04-30 21:39:49 INFO     Val loss decrease from 5.2016 to 5.1336, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-30 21:39:56 INFO     epoch complete!
2024-04-30 21:39:56 INFO     evaluating now!
2024-04-30 21:39:56 INFO     Epoch [24/200] train_loss: 4.4795, val_loss: 5.2307, lr: 0.003000, 7.39s
2024-04-30 21:40:03 INFO     epoch complete!
2024-04-30 21:40:03 INFO     evaluating now!
2024-04-30 21:40:04 INFO     Epoch [25/200] train_loss: 4.4652, val_loss: 5.1199, lr: 0.003000, 7.46s
2024-04-30 21:40:04 INFO     Saved model at 25
2024-04-30 21:40:04 INFO     Val loss decrease from 5.1336 to 5.1199, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-30 21:40:10 INFO     epoch complete!
2024-04-30 21:40:10 INFO     evaluating now!
2024-04-30 21:40:11 INFO     Epoch [26/200] train_loss: 4.4035, val_loss: 5.0627, lr: 0.003000, 7.21s
2024-04-30 21:40:11 INFO     Saved model at 26
2024-04-30 21:40:11 INFO     Val loss decrease from 5.1199 to 5.0627, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-04-30 21:40:18 INFO     epoch complete!
2024-04-30 21:40:18 INFO     evaluating now!
2024-04-30 21:40:18 INFO     Epoch [27/200] train_loss: 4.4125, val_loss: 5.2214, lr: 0.003000, 7.34s
2024-04-30 21:40:25 INFO     epoch complete!
2024-04-30 21:40:25 INFO     evaluating now!
2024-04-30 21:40:26 INFO     Epoch [28/200] train_loss: 4.4017, val_loss: 5.1601, lr: 0.003000, 7.34s
2024-04-30 21:40:32 INFO     epoch complete!
2024-04-30 21:40:32 INFO     evaluating now!
2024-04-30 21:40:33 INFO     Epoch [29/200] train_loss: 4.3095, val_loss: 5.1823, lr: 0.003000, 7.27s
2024-04-30 21:40:40 INFO     epoch complete!
2024-04-30 21:40:40 INFO     evaluating now!
2024-04-30 21:40:40 INFO     Epoch [30/200] train_loss: 4.2407, val_loss: 5.2267, lr: 0.003000, 7.27s
2024-04-30 21:40:47 INFO     epoch complete!
2024-04-30 21:40:47 INFO     evaluating now!
2024-04-30 21:40:47 INFO     Epoch [31/200] train_loss: 4.2331, val_loss: 5.2260, lr: 0.003000, 7.29s
2024-04-30 21:40:54 INFO     epoch complete!
2024-04-30 21:40:54 INFO     evaluating now!
2024-04-30 21:40:55 INFO     Epoch [32/200] train_loss: 4.2052, val_loss: 5.0504, lr: 0.003000, 7.45s
2024-04-30 21:40:55 INFO     Saved model at 32
2024-04-30 21:40:55 INFO     Val loss decrease from 5.0627 to 5.0504, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-04-30 21:41:02 INFO     epoch complete!
2024-04-30 21:41:02 INFO     evaluating now!
2024-04-30 21:41:02 INFO     Epoch [33/200] train_loss: 4.1418, val_loss: 5.0605, lr: 0.003000, 7.45s
2024-04-30 21:41:10 INFO     epoch complete!
2024-04-30 21:41:10 INFO     evaluating now!
2024-04-30 21:41:10 INFO     Epoch [34/200] train_loss: 4.0838, val_loss: 5.0569, lr: 0.003000, 7.92s
2024-04-30 21:41:17 INFO     epoch complete!
2024-04-30 21:41:17 INFO     evaluating now!
2024-04-30 21:41:18 INFO     Epoch [35/200] train_loss: 4.1122, val_loss: 5.0655, lr: 0.003000, 7.51s
2024-04-30 21:41:25 INFO     epoch complete!
2024-04-30 21:41:25 INFO     evaluating now!
2024-04-30 21:41:25 INFO     Epoch [36/200] train_loss: 4.0354, val_loss: 5.2453, lr: 0.003000, 7.37s
2024-04-30 21:41:32 INFO     epoch complete!
2024-04-30 21:41:32 INFO     evaluating now!
2024-04-30 21:41:33 INFO     Epoch [37/200] train_loss: 4.0099, val_loss: 5.0093, lr: 0.003000, 7.27s
2024-04-30 21:41:33 INFO     Saved model at 37
2024-04-30 21:41:33 INFO     Val loss decrease from 5.0504 to 5.0093, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-04-30 21:41:40 INFO     epoch complete!
2024-04-30 21:41:40 INFO     evaluating now!
2024-04-30 21:41:40 INFO     Epoch [38/200] train_loss: 3.9865, val_loss: 4.9896, lr: 0.003000, 7.49s
2024-04-30 21:41:40 INFO     Saved model at 38
2024-04-30 21:41:40 INFO     Val loss decrease from 5.0093 to 4.9896, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-04-30 21:41:47 INFO     epoch complete!
2024-04-30 21:41:47 INFO     evaluating now!
2024-04-30 21:41:48 INFO     Epoch [39/200] train_loss: 3.9427, val_loss: 5.2002, lr: 0.003000, 7.62s
2024-04-30 21:41:55 INFO     epoch complete!
2024-04-30 21:41:55 INFO     evaluating now!
2024-04-30 21:41:55 INFO     Epoch [40/200] train_loss: 3.9495, val_loss: 5.0945, lr: 0.003000, 7.54s
2024-04-30 21:42:02 INFO     epoch complete!
2024-04-30 21:42:02 INFO     evaluating now!
2024-04-30 21:42:03 INFO     Epoch [41/200] train_loss: 3.8712, val_loss: 5.1413, lr: 0.003000, 7.51s
2024-04-30 21:42:09 INFO     epoch complete!
2024-04-30 21:42:09 INFO     evaluating now!
2024-04-30 21:42:10 INFO     Epoch [42/200] train_loss: 3.9334, val_loss: 4.9228, lr: 0.003000, 6.84s
2024-04-30 21:42:10 INFO     Saved model at 42
2024-04-30 21:42:10 INFO     Val loss decrease from 4.9896 to 4.9228, saving to ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-04-30 21:42:16 INFO     epoch complete!
2024-04-30 21:42:16 INFO     evaluating now!
2024-04-30 21:42:17 INFO     Epoch [43/200] train_loss: 3.8664, val_loss: 5.0275, lr: 0.003000, 6.95s
2024-04-30 21:42:23 INFO     epoch complete!
2024-04-30 21:42:23 INFO     evaluating now!
2024-04-30 21:42:24 INFO     Epoch [44/200] train_loss: 3.8859, val_loss: 5.2610, lr: 0.003000, 6.99s
2024-04-30 21:42:30 INFO     epoch complete!
2024-04-30 21:42:30 INFO     evaluating now!
2024-04-30 21:42:30 INFO     Epoch [45/200] train_loss: 3.8652, val_loss: 5.0830, lr: 0.003000, 6.54s
2024-04-30 21:42:36 INFO     epoch complete!
2024-04-30 21:42:36 INFO     evaluating now!
2024-04-30 21:42:37 INFO     Epoch [46/200] train_loss: 3.7633, val_loss: 5.1411, lr: 0.003000, 6.42s
2024-04-30 21:42:43 INFO     epoch complete!
2024-04-30 21:42:43 INFO     evaluating now!
2024-04-30 21:42:43 INFO     Epoch [47/200] train_loss: 3.7577, val_loss: 5.1635, lr: 0.003000, 6.39s
2024-04-30 21:42:49 INFO     epoch complete!
2024-04-30 21:42:49 INFO     evaluating now!
2024-04-30 21:42:49 INFO     Epoch [48/200] train_loss: 3.7540, val_loss: 5.1834, lr: 0.003000, 6.38s
2024-04-30 21:42:55 INFO     epoch complete!
2024-04-30 21:42:55 INFO     evaluating now!
2024-04-30 21:42:56 INFO     Epoch [49/200] train_loss: 3.7347, val_loss: 5.1018, lr: 0.003000, 6.38s
2024-04-30 21:43:02 INFO     epoch complete!
2024-04-30 21:43:02 INFO     evaluating now!
2024-04-30 21:43:02 INFO     Epoch [50/200] train_loss: 3.6960, val_loss: 5.1446, lr: 0.003000, 6.40s
2024-04-30 21:43:08 INFO     epoch complete!
2024-04-30 21:43:08 INFO     evaluating now!
2024-04-30 21:43:09 INFO     Epoch [51/200] train_loss: 3.6582, val_loss: 5.0619, lr: 0.003000, 6.82s
2024-04-30 21:43:16 INFO     epoch complete!
2024-04-30 21:43:16 INFO     evaluating now!
2024-04-30 21:43:16 INFO     Epoch [52/200] train_loss: 3.6614, val_loss: 5.0818, lr: 0.003000, 7.04s
2024-04-30 21:43:22 INFO     epoch complete!
2024-04-30 21:43:22 INFO     evaluating now!
2024-04-30 21:43:23 INFO     Epoch [53/200] train_loss: 3.6802, val_loss: 5.2801, lr: 0.003000, 6.95s
2024-04-30 21:43:30 INFO     epoch complete!
2024-04-30 21:43:30 INFO     evaluating now!
2024-04-30 21:43:30 INFO     Epoch [54/200] train_loss: 3.7015, val_loss: 5.1301, lr: 0.003000, 7.10s
2024-04-30 21:43:37 INFO     epoch complete!
2024-04-30 21:43:37 INFO     evaluating now!
2024-04-30 21:43:37 INFO     Epoch [55/200] train_loss: 3.6446, val_loss: 5.1255, lr: 0.003000, 7.20s
2024-04-30 21:43:44 INFO     epoch complete!
2024-04-30 21:43:44 INFO     evaluating now!
2024-04-30 21:43:44 INFO     Epoch [56/200] train_loss: 3.5909, val_loss: 5.0171, lr: 0.003000, 7.17s
2024-04-30 21:43:51 INFO     epoch complete!
2024-04-30 21:43:51 INFO     evaluating now!
2024-04-30 21:43:51 INFO     Epoch [57/200] train_loss: 3.5893, val_loss: 5.1910, lr: 0.003000, 7.08s
2024-04-30 21:43:51 WARNING  Early stopping at epoch: 57
2024-04-30 21:43:51 INFO     Trained totally 58 epochs, average train time is 6.627s, average eval time is 0.480s
2024-04-30 21:43:52 INFO     Loaded model at 42
2024-04-30 21:43:52 INFO     Saved model at ./libcity/cache/33/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 21:43:52 INFO     Start evaluating ...
2024-04-30 21:43:53 INFO     Note that you select the single mode to evaluate!
2024-04-30 21:43:53 INFO     Evaluate result is saved at ./libcity/cache/33/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 21:43:53 INFO     
         MAE       RMSE
1   2.515073   7.358198
2   2.625147   7.937058
3   2.783055   8.855672
4   2.878703   9.569621
5   3.047933  10.463731
6   3.188792  11.365543
7   3.259388  12.249228
8   3.298254  12.793119
9   3.334828  13.121552
10  3.371978  13.229718
11  3.390675  13.409937
12  3.478636  13.940662
2024-04-30 21:43:53 INFO     ----------------------------------------------------------------------------
2024-04-30 21:43:53 INFO     # 4, Kownledge Graph Embedding: RotH, Experiment ids: 34
2024-04-30 21:43:53 INFO     ----------------------------------------------------------------------------
2024-04-30 21:43:53 INFO     Log directory: ./libcity/log
2024-04-30 21:43:53 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=34
2024-04-30 21:43:53 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 642972814, 'exp_id': 34, 'load_external': True, 'embedding_model': 'RotH', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 21:43:53 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 21:43:53 INFO     set_weight_link_or_dist: dist
2024-04-30 21:43:53 INFO     init_weight_inf_or_zero: inf
2024-04-30 21:43:53 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 21:43:53 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 21:43:53 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 21:43:54 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 21:43:57 INFO     Dataset created
2024-04-30 21:43:57 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 21:43:57 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 21:43:57 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 21:43:57 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 21:43:57 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 21:43:57 INFO     NoneScaler
2024-04-30 21:43:59 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 21:43:59 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 21:43:59 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 21:43:59 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 21:43:59 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 21:43:59 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 21:43:59 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 21:43:59 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 21:43:59 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 21:43:59 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 21:43:59 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 21:43:59 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 21:43:59 INFO     Total parameter numbers: 874010
2024-04-30 21:43:59 INFO     You select `adam` optimizer.
2024-04-30 21:43:59 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 21:43:59 INFO     Start training ...
2024-04-30 21:43:59 INFO     num_batches:48
2024-04-30 21:44:05 INFO     epoch complete!
2024-04-30 21:44:05 INFO     evaluating now!
2024-04-30 21:44:06 INFO     Epoch [0/200] train_loss: 25.0173, val_loss: 18.1122, lr: 0.003000, 6.96s
2024-04-30 21:44:06 INFO     Saved model at 0
2024-04-30 21:44:06 INFO     Val loss decrease from inf to 18.1122, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 21:44:12 INFO     epoch complete!
2024-04-30 21:44:12 INFO     evaluating now!
2024-04-30 21:44:13 INFO     Epoch [1/200] train_loss: 14.7868, val_loss: 13.8746, lr: 0.003000, 6.88s
2024-04-30 21:44:13 INFO     Saved model at 1
2024-04-30 21:44:13 INFO     Val loss decrease from 18.1122 to 13.8746, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 21:44:19 INFO     epoch complete!
2024-04-30 21:44:19 INFO     evaluating now!
2024-04-30 21:44:20 INFO     Epoch [2/200] train_loss: 11.6355, val_loss: 11.2932, lr: 0.003000, 7.02s
2024-04-30 21:44:20 INFO     Saved model at 2
2024-04-30 21:44:20 INFO     Val loss decrease from 13.8746 to 11.2932, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 21:44:26 INFO     epoch complete!
2024-04-30 21:44:26 INFO     evaluating now!
2024-04-30 21:44:27 INFO     Epoch [3/200] train_loss: 9.8091, val_loss: 9.5569, lr: 0.003000, 7.04s
2024-04-30 21:44:27 INFO     Saved model at 3
2024-04-30 21:44:27 INFO     Val loss decrease from 11.2932 to 9.5569, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 21:44:33 INFO     epoch complete!
2024-04-30 21:44:33 INFO     evaluating now!
2024-04-30 21:44:34 INFO     Epoch [4/200] train_loss: 8.5773, val_loss: 8.4134, lr: 0.003000, 6.83s
2024-04-30 21:44:34 INFO     Saved model at 4
2024-04-30 21:44:34 INFO     Val loss decrease from 9.5569 to 8.4134, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 21:44:40 INFO     epoch complete!
2024-04-30 21:44:40 INFO     evaluating now!
2024-04-30 21:44:41 INFO     Epoch [5/200] train_loss: 7.6274, val_loss: 7.3469, lr: 0.003000, 6.96s
2024-04-30 21:44:41 INFO     Saved model at 5
2024-04-30 21:44:41 INFO     Val loss decrease from 8.4134 to 7.3469, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 21:44:47 INFO     epoch complete!
2024-04-30 21:44:47 INFO     evaluating now!
2024-04-30 21:44:48 INFO     Epoch [6/200] train_loss: 6.9947, val_loss: 7.3561, lr: 0.003000, 6.93s
2024-04-30 21:44:54 INFO     epoch complete!
2024-04-30 21:44:54 INFO     evaluating now!
2024-04-30 21:44:55 INFO     Epoch [7/200] train_loss: 6.7179, val_loss: 6.9214, lr: 0.003000, 6.99s
2024-04-30 21:44:55 INFO     Saved model at 7
2024-04-30 21:44:55 INFO     Val loss decrease from 7.3469 to 6.9214, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 21:45:01 INFO     epoch complete!
2024-04-30 21:45:01 INFO     evaluating now!
2024-04-30 21:45:02 INFO     Epoch [8/200] train_loss: 6.3078, val_loss: 6.2616, lr: 0.003000, 7.08s
2024-04-30 21:45:02 INFO     Saved model at 8
2024-04-30 21:45:02 INFO     Val loss decrease from 6.9214 to 6.2616, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 21:45:08 INFO     epoch complete!
2024-04-30 21:45:08 INFO     evaluating now!
2024-04-30 21:45:09 INFO     Epoch [9/200] train_loss: 6.0344, val_loss: 6.0989, lr: 0.003000, 6.87s
2024-04-30 21:45:09 INFO     Saved model at 9
2024-04-30 21:45:09 INFO     Val loss decrease from 6.2616 to 6.0989, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 21:45:15 INFO     epoch complete!
2024-04-30 21:45:15 INFO     evaluating now!
2024-04-30 21:45:16 INFO     Epoch [10/200] train_loss: 5.9048, val_loss: 6.0287, lr: 0.003000, 6.89s
2024-04-30 21:45:16 INFO     Saved model at 10
2024-04-30 21:45:16 INFO     Val loss decrease from 6.0989 to 6.0287, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 21:45:22 INFO     epoch complete!
2024-04-30 21:45:22 INFO     evaluating now!
2024-04-30 21:45:23 INFO     Epoch [11/200] train_loss: 5.7620, val_loss: 5.7783, lr: 0.003000, 6.93s
2024-04-30 21:45:23 INFO     Saved model at 11
2024-04-30 21:45:23 INFO     Val loss decrease from 6.0287 to 5.7783, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 21:45:29 INFO     epoch complete!
2024-04-30 21:45:29 INFO     evaluating now!
2024-04-30 21:45:30 INFO     Epoch [12/200] train_loss: 5.6168, val_loss: 5.8743, lr: 0.003000, 6.93s
2024-04-30 21:45:36 INFO     epoch complete!
2024-04-30 21:45:36 INFO     evaluating now!
2024-04-30 21:45:36 INFO     Epoch [13/200] train_loss: 5.5445, val_loss: 5.8870, lr: 0.003000, 6.72s
2024-04-30 21:45:43 INFO     epoch complete!
2024-04-30 21:45:43 INFO     evaluating now!
2024-04-30 21:45:43 INFO     Epoch [14/200] train_loss: 5.3655, val_loss: 5.9108, lr: 0.003000, 6.93s
2024-04-30 21:45:50 INFO     epoch complete!
2024-04-30 21:45:50 INFO     evaluating now!
2024-04-30 21:45:50 INFO     Epoch [15/200] train_loss: 5.3023, val_loss: 5.6213, lr: 0.003000, 6.86s
2024-04-30 21:45:50 INFO     Saved model at 15
2024-04-30 21:45:50 INFO     Val loss decrease from 5.7783 to 5.6213, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 21:45:57 INFO     epoch complete!
2024-04-30 21:45:57 INFO     evaluating now!
2024-04-30 21:45:57 INFO     Epoch [16/200] train_loss: 5.2376, val_loss: 5.6207, lr: 0.003000, 6.93s
2024-04-30 21:45:57 INFO     Saved model at 16
2024-04-30 21:45:57 INFO     Val loss decrease from 5.6213 to 5.6207, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 21:46:04 INFO     epoch complete!
2024-04-30 21:46:04 INFO     evaluating now!
2024-04-30 21:46:04 INFO     Epoch [17/200] train_loss: 5.1200, val_loss: 5.5682, lr: 0.003000, 6.88s
2024-04-30 21:46:04 INFO     Saved model at 17
2024-04-30 21:46:04 INFO     Val loss decrease from 5.6207 to 5.5682, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 21:46:11 INFO     epoch complete!
2024-04-30 21:46:11 INFO     evaluating now!
2024-04-30 21:46:11 INFO     Epoch [18/200] train_loss: 5.0268, val_loss: 5.6673, lr: 0.003000, 6.87s
2024-04-30 21:46:17 INFO     epoch complete!
2024-04-30 21:46:17 INFO     evaluating now!
2024-04-30 21:46:18 INFO     Epoch [19/200] train_loss: 4.9874, val_loss: 5.4101, lr: 0.003000, 6.91s
2024-04-30 21:46:18 INFO     Saved model at 19
2024-04-30 21:46:18 INFO     Val loss decrease from 5.5682 to 5.4101, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 21:46:24 INFO     epoch complete!
2024-04-30 21:46:24 INFO     evaluating now!
2024-04-30 21:46:25 INFO     Epoch [20/200] train_loss: 4.9246, val_loss: 5.4651, lr: 0.003000, 6.91s
2024-04-30 21:46:31 INFO     epoch complete!
2024-04-30 21:46:31 INFO     evaluating now!
2024-04-30 21:46:32 INFO     Epoch [21/200] train_loss: 4.8405, val_loss: 5.4774, lr: 0.003000, 6.94s
2024-04-30 21:46:38 INFO     epoch complete!
2024-04-30 21:46:38 INFO     evaluating now!
2024-04-30 21:46:39 INFO     Epoch [22/200] train_loss: 4.7655, val_loss: 5.2241, lr: 0.003000, 6.87s
2024-04-30 21:46:39 INFO     Saved model at 22
2024-04-30 21:46:39 INFO     Val loss decrease from 5.4101 to 5.2241, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-30 21:46:45 INFO     epoch complete!
2024-04-30 21:46:45 INFO     evaluating now!
2024-04-30 21:46:46 INFO     Epoch [23/200] train_loss: 4.6747, val_loss: 5.3110, lr: 0.003000, 6.79s
2024-04-30 21:46:52 INFO     epoch complete!
2024-04-30 21:46:52 INFO     evaluating now!
2024-04-30 21:46:52 INFO     Epoch [24/200] train_loss: 4.5988, val_loss: 5.3498, lr: 0.003000, 6.68s
2024-04-30 21:46:59 INFO     epoch complete!
2024-04-30 21:46:59 INFO     evaluating now!
2024-04-30 21:46:59 INFO     Epoch [25/200] train_loss: 4.7569, val_loss: 5.2312, lr: 0.003000, 6.78s
2024-04-30 21:47:05 INFO     epoch complete!
2024-04-30 21:47:05 INFO     evaluating now!
2024-04-30 21:47:06 INFO     Epoch [26/200] train_loss: 4.6563, val_loss: 5.3296, lr: 0.003000, 6.88s
2024-04-30 21:47:12 INFO     epoch complete!
2024-04-30 21:47:12 INFO     evaluating now!
2024-04-30 21:47:13 INFO     Epoch [27/200] train_loss: 4.4668, val_loss: 5.2528, lr: 0.003000, 6.84s
2024-04-30 21:47:19 INFO     epoch complete!
2024-04-30 21:47:19 INFO     evaluating now!
2024-04-30 21:47:20 INFO     Epoch [28/200] train_loss: 4.4562, val_loss: 5.1041, lr: 0.003000, 6.82s
2024-04-30 21:47:20 INFO     Saved model at 28
2024-04-30 21:47:20 INFO     Val loss decrease from 5.2241 to 5.1041, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-04-30 21:47:26 INFO     epoch complete!
2024-04-30 21:47:26 INFO     evaluating now!
2024-04-30 21:47:27 INFO     Epoch [29/200] train_loss: 4.4998, val_loss: 5.2030, lr: 0.003000, 6.96s
2024-04-30 21:47:33 INFO     epoch complete!
2024-04-30 21:47:33 INFO     evaluating now!
2024-04-30 21:47:33 INFO     Epoch [30/200] train_loss: 4.4025, val_loss: 5.2296, lr: 0.003000, 6.90s
2024-04-30 21:47:40 INFO     epoch complete!
2024-04-30 21:47:40 INFO     evaluating now!
2024-04-30 21:47:40 INFO     Epoch [31/200] train_loss: 4.3505, val_loss: 5.1367, lr: 0.003000, 6.82s
2024-04-30 21:47:47 INFO     epoch complete!
2024-04-30 21:47:47 INFO     evaluating now!
2024-04-30 21:47:47 INFO     Epoch [32/200] train_loss: 4.2959, val_loss: 5.1873, lr: 0.003000, 6.89s
2024-04-30 21:47:54 INFO     epoch complete!
2024-04-30 21:47:54 INFO     evaluating now!
2024-04-30 21:47:54 INFO     Epoch [33/200] train_loss: 4.2833, val_loss: 5.1632, lr: 0.003000, 6.85s
2024-04-30 21:48:00 INFO     epoch complete!
2024-04-30 21:48:00 INFO     evaluating now!
2024-04-30 21:48:01 INFO     Epoch [34/200] train_loss: 4.2293, val_loss: 5.2886, lr: 0.003000, 6.83s
2024-04-30 21:48:07 INFO     epoch complete!
2024-04-30 21:48:07 INFO     evaluating now!
2024-04-30 21:48:08 INFO     Epoch [35/200] train_loss: 4.2087, val_loss: 5.1853, lr: 0.003000, 6.88s
2024-04-30 21:48:14 INFO     epoch complete!
2024-04-30 21:48:14 INFO     evaluating now!
2024-04-30 21:48:15 INFO     Epoch [36/200] train_loss: 4.2003, val_loss: 5.0996, lr: 0.003000, 7.01s
2024-04-30 21:48:15 INFO     Saved model at 36
2024-04-30 21:48:15 INFO     Val loss decrease from 5.1041 to 5.0996, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-04-30 21:48:21 INFO     epoch complete!
2024-04-30 21:48:21 INFO     evaluating now!
2024-04-30 21:48:22 INFO     Epoch [37/200] train_loss: 4.1800, val_loss: 5.1531, lr: 0.003000, 7.09s
2024-04-30 21:48:28 INFO     epoch complete!
2024-04-30 21:48:28 INFO     evaluating now!
2024-04-30 21:48:29 INFO     Epoch [38/200] train_loss: 4.1598, val_loss: 5.1331, lr: 0.003000, 6.97s
2024-04-30 21:48:35 INFO     epoch complete!
2024-04-30 21:48:35 INFO     evaluating now!
2024-04-30 21:48:36 INFO     Epoch [39/200] train_loss: 4.0685, val_loss: 5.1946, lr: 0.003000, 6.86s
2024-04-30 21:48:42 INFO     epoch complete!
2024-04-30 21:48:42 INFO     evaluating now!
2024-04-30 21:48:43 INFO     Epoch [40/200] train_loss: 4.0670, val_loss: 5.2032, lr: 0.003000, 7.03s
2024-04-30 21:48:49 INFO     epoch complete!
2024-04-30 21:48:49 INFO     evaluating now!
2024-04-30 21:48:49 INFO     Epoch [41/200] train_loss: 4.0496, val_loss: 5.2072, lr: 0.003000, 6.40s
2024-04-30 21:48:55 INFO     epoch complete!
2024-04-30 21:48:55 INFO     evaluating now!
2024-04-30 21:48:56 INFO     Epoch [42/200] train_loss: 4.0673, val_loss: 5.2140, lr: 0.003000, 6.46s
2024-04-30 21:49:02 INFO     epoch complete!
2024-04-30 21:49:02 INFO     evaluating now!
2024-04-30 21:49:02 INFO     Epoch [43/200] train_loss: 4.1053, val_loss: 5.1755, lr: 0.003000, 6.44s
2024-04-30 21:49:08 INFO     epoch complete!
2024-04-30 21:49:08 INFO     evaluating now!
2024-04-30 21:49:08 INFO     Epoch [44/200] train_loss: 4.0153, val_loss: 5.0347, lr: 0.003000, 6.26s
2024-04-30 21:49:08 INFO     Saved model at 44
2024-04-30 21:49:08 INFO     Val loss decrease from 5.0996 to 5.0347, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-04-30 21:49:14 INFO     epoch complete!
2024-04-30 21:49:14 INFO     evaluating now!
2024-04-30 21:49:15 INFO     Epoch [45/200] train_loss: 3.9242, val_loss: 4.9481, lr: 0.003000, 6.33s
2024-04-30 21:49:15 INFO     Saved model at 45
2024-04-30 21:49:15 INFO     Val loss decrease from 5.0347 to 4.9481, saving to ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-04-30 21:49:21 INFO     epoch complete!
2024-04-30 21:49:21 INFO     evaluating now!
2024-04-30 21:49:21 INFO     Epoch [46/200] train_loss: 3.9406, val_loss: 5.0874, lr: 0.003000, 6.39s
2024-04-30 21:49:27 INFO     epoch complete!
2024-04-30 21:49:27 INFO     evaluating now!
2024-04-30 21:49:28 INFO     Epoch [47/200] train_loss: 3.9118, val_loss: 5.1767, lr: 0.003000, 6.76s
2024-04-30 21:49:34 INFO     epoch complete!
2024-04-30 21:49:34 INFO     evaluating now!
2024-04-30 21:49:35 INFO     Epoch [48/200] train_loss: 3.8708, val_loss: 5.0953, lr: 0.003000, 6.91s
2024-04-30 21:49:41 INFO     epoch complete!
2024-04-30 21:49:41 INFO     evaluating now!
2024-04-30 21:49:42 INFO     Epoch [49/200] train_loss: 3.8502, val_loss: 5.0480, lr: 0.003000, 6.85s
2024-04-30 21:49:48 INFO     epoch complete!
2024-04-30 21:49:48 INFO     evaluating now!
2024-04-30 21:49:49 INFO     Epoch [50/200] train_loss: 3.8296, val_loss: 5.1914, lr: 0.003000, 7.01s
2024-04-30 21:49:55 INFO     epoch complete!
2024-04-30 21:49:55 INFO     evaluating now!
2024-04-30 21:49:56 INFO     Epoch [51/200] train_loss: 3.7977, val_loss: 5.1697, lr: 0.003000, 6.94s
2024-04-30 21:50:02 INFO     epoch complete!
2024-04-30 21:50:02 INFO     evaluating now!
2024-04-30 21:50:03 INFO     Epoch [52/200] train_loss: 3.7785, val_loss: 5.0851, lr: 0.003000, 6.98s
2024-04-30 21:50:09 INFO     epoch complete!
2024-04-30 21:50:09 INFO     evaluating now!
2024-04-30 21:50:09 INFO     Epoch [53/200] train_loss: 3.8083, val_loss: 5.1134, lr: 0.003000, 6.80s
2024-04-30 21:50:16 INFO     epoch complete!
2024-04-30 21:50:16 INFO     evaluating now!
2024-04-30 21:50:16 INFO     Epoch [54/200] train_loss: 3.7946, val_loss: 5.0936, lr: 0.003000, 6.86s
2024-04-30 21:50:23 INFO     epoch complete!
2024-04-30 21:50:23 INFO     evaluating now!
2024-04-30 21:50:23 INFO     Epoch [55/200] train_loss: 3.7804, val_loss: 5.0155, lr: 0.003000, 6.85s
2024-04-30 21:50:29 INFO     epoch complete!
2024-04-30 21:50:29 INFO     evaluating now!
2024-04-30 21:50:30 INFO     Epoch [56/200] train_loss: 3.7098, val_loss: 5.0642, lr: 0.003000, 6.86s
2024-04-30 21:50:37 INFO     epoch complete!
2024-04-30 21:50:37 INFO     evaluating now!
2024-04-30 21:50:37 INFO     Epoch [57/200] train_loss: 3.7007, val_loss: 5.0502, lr: 0.003000, 7.15s
2024-04-30 21:50:43 INFO     epoch complete!
2024-04-30 21:50:43 INFO     evaluating now!
2024-04-30 21:50:44 INFO     Epoch [58/200] train_loss: 3.6754, val_loss: 5.1143, lr: 0.003000, 6.86s
2024-04-30 21:50:50 INFO     epoch complete!
2024-04-30 21:50:50 INFO     evaluating now!
2024-04-30 21:50:51 INFO     Epoch [59/200] train_loss: 3.7004, val_loss: 5.1086, lr: 0.003000, 6.89s
2024-04-30 21:50:57 INFO     epoch complete!
2024-04-30 21:50:57 INFO     evaluating now!
2024-04-30 21:50:58 INFO     Epoch [60/200] train_loss: 3.6260, val_loss: 5.0412, lr: 0.003000, 6.96s
2024-04-30 21:50:58 WARNING  Early stopping at epoch: 60
2024-04-30 21:50:58 INFO     Trained totally 61 epochs, average train time is 6.410s, average eval time is 0.438s
2024-04-30 21:50:58 INFO     Loaded model at 45
2024-04-30 21:50:58 INFO     Saved model at ./libcity/cache/34/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 21:50:58 INFO     Start evaluating ...
2024-04-30 21:50:59 INFO     Note that you select the single mode to evaluate!
2024-04-30 21:50:59 INFO     Evaluate result is saved at ./libcity/cache/34/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 21:50:59 INFO     
         MAE       RMSE
1   2.335119   7.279266
2   2.413645   7.596688
3   2.673571   8.885388
4   2.915153  10.316657
5   3.089470  11.817378
6   3.214418  12.937096
7   3.292499  13.606032
8   3.328466  13.990963
9   3.349637  14.135670
10  3.376331  14.037511
11  3.414738  14.335491
12  3.531435  14.794474
2024-04-30 21:50:59 INFO     ----------------------------------------------------------------------------
2024-04-30 21:50:59 INFO     Kownledge Graph Embedding: RotH, Experiment ids: [30, 31, 32, 33, 34]
2024-04-30 21:51:00 INFO     ----------------------------------------------------------------------------
2024-04-30 21:51:00 INFO     Average: 
         MAE       RMSE
0   2.433353   7.400677
1   2.543049   7.891464
2   2.691500   8.834964
3   2.833771   9.716578
4   2.970398  10.674597
5   3.094736  11.494383
6   3.173187  12.200150
7   3.222028  12.634596
8   3.257003  12.862713
9   3.304579  12.971220
10  3.353652  13.220628
11  3.451526  13.683799 
2024-04-30 21:51:00 INFO     Standard deviation: 
         MAE      RMSE
0   0.086891  0.306618
1   0.093403  0.243573
2   0.048374  0.094475
3   0.057281  0.300514
4   0.092605  0.586356
5   0.093697  0.747548
6   0.101761  0.743382
7   0.095892  0.725903
8   0.093948  0.703545
9   0.070994  0.608791
10  0.049963  0.644338
11  0.056584  0.725683
2024-04-30 21:51:00 INFO     ----------------------------------------------------------------------------
2024-04-30 21:51:00 INFO     12 steps Average: 
        MAE       RMSE
0  3.027399  11.132148
2024-04-30 21:51:00 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.078449  0.535894
