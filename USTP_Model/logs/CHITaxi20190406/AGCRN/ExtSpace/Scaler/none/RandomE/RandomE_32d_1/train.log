2024-04-30 13:30:26 INFO     ----------------------------------------------------------------------------
2024-04-30 13:30:26 INFO     # 0, Kownledge Graph Embedding: RandomE, Experiment ids: 60
2024-04-30 13:30:26 INFO     ----------------------------------------------------------------------------
2024-04-30 13:30:26 INFO     Log directory: ./libcity/log
2024-04-30 13:30:26 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=60
2024-04-30 13:30:26 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 129588021, 'exp_id': 60, 'load_external': True, 'embedding_model': 'RandomE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 13:30:26 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 13:30:26 INFO     set_weight_link_or_dist: dist
2024-04-30 13:30:26 INFO     init_weight_inf_or_zero: inf
2024-04-30 13:30:26 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 13:30:26 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 13:30:26 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 13:30:26 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 13:30:28 INFO     Dataset created
2024-04-30 13:30:28 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 13:30:29 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 13:30:29 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 13:30:29 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 13:30:29 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 13:30:29 INFO     NoneScaler
2024-04-30 13:30:33 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 13:30:33 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 13:30:33 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 13:30:33 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 13:30:33 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 13:30:33 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 13:30:33 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 13:30:33 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 13:30:33 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 13:30:33 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 13:30:33 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 13:30:33 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 13:30:33 INFO     Total parameter numbers: 874010
2024-04-30 13:30:33 INFO     You select `adam` optimizer.
2024-04-30 13:30:33 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 13:30:33 INFO     Start training ...
2024-04-30 13:30:33 INFO     num_batches:48
2024-04-30 13:30:42 INFO     epoch complete!
2024-04-30 13:30:42 INFO     evaluating now!
2024-04-30 13:30:43 INFO     Epoch [0/200] train_loss: 25.3466, val_loss: 17.7962, lr: 0.003000, 9.94s
2024-04-30 13:30:43 INFO     Saved model at 0
2024-04-30 13:30:43 INFO     Val loss decrease from inf to 17.7962, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 13:30:48 INFO     epoch complete!
2024-04-30 13:30:48 INFO     evaluating now!
2024-04-30 13:30:48 INFO     Epoch [1/200] train_loss: 14.1163, val_loss: 12.9840, lr: 0.003000, 5.53s
2024-04-30 13:30:48 INFO     Saved model at 1
2024-04-30 13:30:48 INFO     Val loss decrease from 17.7962 to 12.9840, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 13:30:53 INFO     epoch complete!
2024-04-30 13:30:53 INFO     evaluating now!
2024-04-30 13:30:54 INFO     Epoch [2/200] train_loss: 10.7270, val_loss: 9.9616, lr: 0.003000, 5.40s
2024-04-30 13:30:54 INFO     Saved model at 2
2024-04-30 13:30:54 INFO     Val loss decrease from 12.9840 to 9.9616, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 13:30:59 INFO     epoch complete!
2024-04-30 13:30:59 INFO     evaluating now!
2024-04-30 13:30:59 INFO     Epoch [3/200] train_loss: 8.5848, val_loss: 8.0037, lr: 0.003000, 5.47s
2024-04-30 13:30:59 INFO     Saved model at 3
2024-04-30 13:30:59 INFO     Val loss decrease from 9.9616 to 8.0037, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 13:31:05 INFO     epoch complete!
2024-04-30 13:31:05 INFO     evaluating now!
2024-04-30 13:31:05 INFO     Epoch [4/200] train_loss: 7.4336, val_loss: 7.1962, lr: 0.003000, 5.72s
2024-04-30 13:31:05 INFO     Saved model at 4
2024-04-30 13:31:05 INFO     Val loss decrease from 8.0037 to 7.1962, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 13:31:10 INFO     epoch complete!
2024-04-30 13:31:10 INFO     evaluating now!
2024-04-30 13:31:10 INFO     Epoch [5/200] train_loss: 6.7592, val_loss: 6.5695, lr: 0.003000, 5.38s
2024-04-30 13:31:10 INFO     Saved model at 5
2024-04-30 13:31:10 INFO     Val loss decrease from 7.1962 to 6.5695, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 13:31:15 INFO     epoch complete!
2024-04-30 13:31:15 INFO     evaluating now!
2024-04-30 13:31:16 INFO     Epoch [6/200] train_loss: 6.3541, val_loss: 6.3788, lr: 0.003000, 5.26s
2024-04-30 13:31:16 INFO     Saved model at 6
2024-04-30 13:31:16 INFO     Val loss decrease from 6.5695 to 6.3788, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 13:31:20 INFO     epoch complete!
2024-04-30 13:31:20 INFO     evaluating now!
2024-04-30 13:31:21 INFO     Epoch [7/200] train_loss: 5.9875, val_loss: 5.9322, lr: 0.003000, 5.20s
2024-04-30 13:31:21 INFO     Saved model at 7
2024-04-30 13:31:21 INFO     Val loss decrease from 6.3788 to 5.9322, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 13:31:26 INFO     epoch complete!
2024-04-30 13:31:26 INFO     evaluating now!
2024-04-30 13:31:26 INFO     Epoch [8/200] train_loss: 5.8921, val_loss: 5.8906, lr: 0.003000, 5.37s
2024-04-30 13:31:26 INFO     Saved model at 8
2024-04-30 13:31:26 INFO     Val loss decrease from 5.9322 to 5.8906, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 13:31:32 INFO     epoch complete!
2024-04-30 13:31:32 INFO     evaluating now!
2024-04-30 13:31:32 INFO     Epoch [9/200] train_loss: 5.5906, val_loss: 5.7260, lr: 0.003000, 5.95s
2024-04-30 13:31:32 INFO     Saved model at 9
2024-04-30 13:31:32 INFO     Val loss decrease from 5.8906 to 5.7260, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 13:31:37 INFO     epoch complete!
2024-04-30 13:31:37 INFO     evaluating now!
2024-04-30 13:31:37 INFO     Epoch [10/200] train_loss: 5.4718, val_loss: 5.6608, lr: 0.003000, 5.31s
2024-04-30 13:31:37 INFO     Saved model at 10
2024-04-30 13:31:37 INFO     Val loss decrease from 5.7260 to 5.6608, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 13:31:43 INFO     epoch complete!
2024-04-30 13:31:43 INFO     evaluating now!
2024-04-30 13:31:43 INFO     Epoch [11/200] train_loss: 5.3713, val_loss: 5.5712, lr: 0.003000, 5.44s
2024-04-30 13:31:43 INFO     Saved model at 11
2024-04-30 13:31:43 INFO     Val loss decrease from 5.6608 to 5.5712, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 13:31:48 INFO     epoch complete!
2024-04-30 13:31:48 INFO     evaluating now!
2024-04-30 13:31:48 INFO     Epoch [12/200] train_loss: 5.1689, val_loss: 5.6777, lr: 0.003000, 5.23s
2024-04-30 13:31:53 INFO     epoch complete!
2024-04-30 13:31:53 INFO     evaluating now!
2024-04-30 13:31:53 INFO     Epoch [13/200] train_loss: 5.0543, val_loss: 5.5474, lr: 0.003000, 5.26s
2024-04-30 13:31:53 INFO     Saved model at 13
2024-04-30 13:31:53 INFO     Val loss decrease from 5.5712 to 5.5474, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 13:31:58 INFO     epoch complete!
2024-04-30 13:31:58 INFO     evaluating now!
2024-04-30 13:31:59 INFO     Epoch [14/200] train_loss: 5.0383, val_loss: 5.3998, lr: 0.003000, 5.19s
2024-04-30 13:31:59 INFO     Saved model at 14
2024-04-30 13:31:59 INFO     Val loss decrease from 5.5474 to 5.3998, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 13:32:04 INFO     epoch complete!
2024-04-30 13:32:04 INFO     evaluating now!
2024-04-30 13:32:04 INFO     Epoch [15/200] train_loss: 4.9150, val_loss: 5.3640, lr: 0.003000, 5.21s
2024-04-30 13:32:04 INFO     Saved model at 15
2024-04-30 13:32:04 INFO     Val loss decrease from 5.3998 to 5.3640, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 13:32:09 INFO     epoch complete!
2024-04-30 13:32:09 INFO     evaluating now!
2024-04-30 13:32:09 INFO     Epoch [16/200] train_loss: 4.8206, val_loss: 5.3231, lr: 0.003000, 5.35s
2024-04-30 13:32:09 INFO     Saved model at 16
2024-04-30 13:32:09 INFO     Val loss decrease from 5.3640 to 5.3231, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 13:32:14 INFO     epoch complete!
2024-04-30 13:32:14 INFO     evaluating now!
2024-04-30 13:32:14 INFO     Epoch [17/200] train_loss: 4.7324, val_loss: 5.3795, lr: 0.003000, 5.18s
2024-04-30 13:32:19 INFO     epoch complete!
2024-04-30 13:32:19 INFO     evaluating now!
2024-04-30 13:32:20 INFO     Epoch [18/200] train_loss: 4.6895, val_loss: 5.1554, lr: 0.003000, 5.18s
2024-04-30 13:32:20 INFO     Saved model at 18
2024-04-30 13:32:20 INFO     Val loss decrease from 5.3231 to 5.1554, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 13:32:25 INFO     epoch complete!
2024-04-30 13:32:25 INFO     evaluating now!
2024-04-30 13:32:25 INFO     Epoch [19/200] train_loss: 4.6135, val_loss: 5.1078, lr: 0.003000, 5.26s
2024-04-30 13:32:25 INFO     Saved model at 19
2024-04-30 13:32:25 INFO     Val loss decrease from 5.1554 to 5.1078, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 13:32:30 INFO     epoch complete!
2024-04-30 13:32:30 INFO     evaluating now!
2024-04-30 13:32:30 INFO     Epoch [20/200] train_loss: 4.5115, val_loss: 5.1504, lr: 0.003000, 5.36s
2024-04-30 13:32:35 INFO     epoch complete!
2024-04-30 13:32:35 INFO     evaluating now!
2024-04-30 13:32:36 INFO     Epoch [21/200] train_loss: 4.5322, val_loss: 5.1634, lr: 0.003000, 5.37s
2024-04-30 13:32:40 INFO     epoch complete!
2024-04-30 13:32:40 INFO     evaluating now!
2024-04-30 13:32:41 INFO     Epoch [22/200] train_loss: 4.4519, val_loss: 5.1137, lr: 0.003000, 5.19s
2024-04-30 13:32:46 INFO     epoch complete!
2024-04-30 13:32:46 INFO     evaluating now!
2024-04-30 13:32:46 INFO     Epoch [23/200] train_loss: 4.3971, val_loss: 5.5061, lr: 0.003000, 5.14s
2024-04-30 13:32:51 INFO     epoch complete!
2024-04-30 13:32:51 INFO     evaluating now!
2024-04-30 13:32:51 INFO     Epoch [24/200] train_loss: 4.3848, val_loss: 5.2130, lr: 0.003000, 5.13s
2024-04-30 13:32:56 INFO     epoch complete!
2024-04-30 13:32:56 INFO     evaluating now!
2024-04-30 13:32:56 INFO     Epoch [25/200] train_loss: 4.3329, val_loss: 5.1166, lr: 0.003000, 5.22s
2024-04-30 13:33:01 INFO     epoch complete!
2024-04-30 13:33:01 INFO     evaluating now!
2024-04-30 13:33:01 INFO     Epoch [26/200] train_loss: 4.2989, val_loss: 5.1546, lr: 0.003000, 5.20s
2024-04-30 13:33:07 INFO     epoch complete!
2024-04-30 13:33:07 INFO     evaluating now!
2024-04-30 13:33:07 INFO     Epoch [27/200] train_loss: 4.2374, val_loss: 5.0579, lr: 0.003000, 5.37s
2024-04-30 13:33:07 INFO     Saved model at 27
2024-04-30 13:33:07 INFO     Val loss decrease from 5.1078 to 5.0579, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-30 13:33:12 INFO     epoch complete!
2024-04-30 13:33:12 INFO     evaluating now!
2024-04-30 13:33:12 INFO     Epoch [28/200] train_loss: 4.2049, val_loss: 5.0669, lr: 0.003000, 5.32s
2024-04-30 13:33:17 INFO     epoch complete!
2024-04-30 13:33:17 INFO     evaluating now!
2024-04-30 13:33:17 INFO     Epoch [29/200] train_loss: 4.1574, val_loss: 5.1181, lr: 0.003000, 5.18s
2024-04-30 13:33:22 INFO     epoch complete!
2024-04-30 13:33:22 INFO     evaluating now!
2024-04-30 13:33:23 INFO     Epoch [30/200] train_loss: 4.1017, val_loss: 4.9538, lr: 0.003000, 5.15s
2024-04-30 13:33:23 INFO     Saved model at 30
2024-04-30 13:33:23 INFO     Val loss decrease from 5.0579 to 4.9538, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-04-30 13:33:27 INFO     epoch complete!
2024-04-30 13:33:27 INFO     evaluating now!
2024-04-30 13:33:28 INFO     Epoch [31/200] train_loss: 4.0337, val_loss: 5.0140, lr: 0.003000, 5.14s
2024-04-30 13:33:32 INFO     epoch complete!
2024-04-30 13:33:32 INFO     evaluating now!
2024-04-30 13:33:33 INFO     Epoch [32/200] train_loss: 4.0719, val_loss: 5.1860, lr: 0.003000, 5.14s
2024-04-30 13:33:38 INFO     epoch complete!
2024-04-30 13:33:38 INFO     evaluating now!
2024-04-30 13:33:38 INFO     Epoch [33/200] train_loss: 3.9887, val_loss: 5.0962, lr: 0.003000, 5.14s
2024-04-30 13:33:43 INFO     epoch complete!
2024-04-30 13:33:43 INFO     evaluating now!
2024-04-30 13:33:43 INFO     Epoch [34/200] train_loss: 3.9802, val_loss: 5.0457, lr: 0.003000, 5.20s
2024-04-30 13:33:48 INFO     epoch complete!
2024-04-30 13:33:48 INFO     evaluating now!
2024-04-30 13:33:48 INFO     Epoch [35/200] train_loss: 4.0110, val_loss: 4.9861, lr: 0.003000, 5.30s
2024-04-30 13:33:53 INFO     epoch complete!
2024-04-30 13:33:53 INFO     evaluating now!
2024-04-30 13:33:54 INFO     Epoch [36/200] train_loss: 3.9396, val_loss: 5.0254, lr: 0.003000, 5.30s
2024-04-30 13:33:59 INFO     epoch complete!
2024-04-30 13:33:59 INFO     evaluating now!
2024-04-30 13:33:59 INFO     Epoch [37/200] train_loss: 3.9105, val_loss: 5.0515, lr: 0.003000, 5.33s
2024-04-30 13:34:04 INFO     epoch complete!
2024-04-30 13:34:04 INFO     evaluating now!
2024-04-30 13:34:04 INFO     Epoch [38/200] train_loss: 3.8793, val_loss: 5.1669, lr: 0.003000, 5.34s
2024-04-30 13:34:10 INFO     epoch complete!
2024-04-30 13:34:10 INFO     evaluating now!
2024-04-30 13:34:10 INFO     Epoch [39/200] train_loss: 3.8646, val_loss: 5.0726, lr: 0.003000, 5.54s
2024-04-30 13:34:15 INFO     epoch complete!
2024-04-30 13:34:15 INFO     evaluating now!
2024-04-30 13:34:16 INFO     Epoch [40/200] train_loss: 3.8317, val_loss: 4.9157, lr: 0.003000, 5.66s
2024-04-30 13:34:16 INFO     Saved model at 40
2024-04-30 13:34:16 INFO     Val loss decrease from 4.9538 to 4.9157, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-04-30 13:34:21 INFO     epoch complete!
2024-04-30 13:34:21 INFO     evaluating now!
2024-04-30 13:34:21 INFO     Epoch [41/200] train_loss: 3.8092, val_loss: 5.0891, lr: 0.003000, 5.50s
2024-04-30 13:34:26 INFO     epoch complete!
2024-04-30 13:34:26 INFO     evaluating now!
2024-04-30 13:34:27 INFO     Epoch [42/200] train_loss: 3.7674, val_loss: 5.1222, lr: 0.003000, 5.52s
2024-04-30 13:34:32 INFO     epoch complete!
2024-04-30 13:34:32 INFO     evaluating now!
2024-04-30 13:34:32 INFO     Epoch [43/200] train_loss: 3.8023, val_loss: 5.0860, lr: 0.003000, 5.39s
2024-04-30 13:34:37 INFO     epoch complete!
2024-04-30 13:34:37 INFO     evaluating now!
2024-04-30 13:34:38 INFO     Epoch [44/200] train_loss: 3.7545, val_loss: 4.9978, lr: 0.003000, 5.60s
2024-04-30 13:34:43 INFO     epoch complete!
2024-04-30 13:34:43 INFO     evaluating now!
2024-04-30 13:34:43 INFO     Epoch [45/200] train_loss: 3.7033, val_loss: 5.0858, lr: 0.003000, 5.50s
2024-04-30 13:34:48 INFO     epoch complete!
2024-04-30 13:34:48 INFO     evaluating now!
2024-04-30 13:34:48 INFO     Epoch [46/200] train_loss: 3.6860, val_loss: 5.0644, lr: 0.003000, 5.33s
2024-04-30 13:34:54 INFO     epoch complete!
2024-04-30 13:34:54 INFO     evaluating now!
2024-04-30 13:34:54 INFO     Epoch [47/200] train_loss: 3.6565, val_loss: 5.0350, lr: 0.003000, 5.41s
2024-04-30 13:34:59 INFO     epoch complete!
2024-04-30 13:34:59 INFO     evaluating now!
2024-04-30 13:34:59 INFO     Epoch [48/200] train_loss: 3.6829, val_loss: 5.1856, lr: 0.003000, 5.39s
2024-04-30 13:35:04 INFO     epoch complete!
2024-04-30 13:35:04 INFO     evaluating now!
2024-04-30 13:35:05 INFO     Epoch [49/200] train_loss: 3.6635, val_loss: 5.0313, lr: 0.003000, 5.48s
2024-04-30 13:35:10 INFO     epoch complete!
2024-04-30 13:35:10 INFO     evaluating now!
2024-04-30 13:35:10 INFO     Epoch [50/200] train_loss: 3.6512, val_loss: 5.0861, lr: 0.003000, 5.54s
2024-04-30 13:35:15 INFO     epoch complete!
2024-04-30 13:35:15 INFO     evaluating now!
2024-04-30 13:35:16 INFO     Epoch [51/200] train_loss: 3.5946, val_loss: 5.1696, lr: 0.003000, 5.53s
2024-04-30 13:35:21 INFO     epoch complete!
2024-04-30 13:35:21 INFO     evaluating now!
2024-04-30 13:35:21 INFO     Epoch [52/200] train_loss: 3.6071, val_loss: 4.9870, lr: 0.003000, 5.57s
2024-04-30 13:35:26 INFO     epoch complete!
2024-04-30 13:35:26 INFO     evaluating now!
2024-04-30 13:35:27 INFO     Epoch [53/200] train_loss: 3.5671, val_loss: 4.9566, lr: 0.003000, 5.36s
2024-04-30 13:35:32 INFO     epoch complete!
2024-04-30 13:35:32 INFO     evaluating now!
2024-04-30 13:35:32 INFO     Epoch [54/200] train_loss: 3.5335, val_loss: 5.2717, lr: 0.003000, 5.30s
2024-04-30 13:35:37 INFO     epoch complete!
2024-04-30 13:35:37 INFO     evaluating now!
2024-04-30 13:35:37 INFO     Epoch [55/200] train_loss: 3.5592, val_loss: 5.0636, lr: 0.003000, 5.15s
2024-04-30 13:35:37 WARNING  Early stopping at epoch: 55
2024-04-30 13:35:37 INFO     Trained totally 56 epochs, average train time is 5.093s, average eval time is 0.337s
2024-04-30 13:35:37 INFO     Loaded model at 40
2024-04-30 13:35:37 INFO     Saved model at ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 13:35:37 INFO     Start evaluating ...
2024-04-30 13:35:38 INFO     Note that you select the single mode to evaluate!
2024-04-30 13:35:38 INFO     Evaluate result is saved at ./libcity/cache/60/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-30 13:35:38 INFO     
         MAE       RMSE
1   2.328936   7.350301
2   2.466858   8.048710
3   2.644060   8.899629
4   2.800942   9.674467
5   2.908929  10.602986
6   3.064055  11.517546
7   3.192376  12.501144
8   3.336629  13.196018
9   3.346307  13.226267
10  3.387185  13.287884
11  3.419670  13.231474
12  3.477914  13.368834
2024-04-30 13:35:38 INFO     ----------------------------------------------------------------------------
2024-04-30 13:35:38 INFO     # 1, Kownledge Graph Embedding: RandomE, Experiment ids: 61
2024-04-30 13:35:38 INFO     ----------------------------------------------------------------------------
2024-04-30 13:35:38 INFO     Log directory: ./libcity/log
2024-04-30 13:35:38 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=61
2024-04-30 13:35:38 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 46306522, 'exp_id': 61, 'load_external': True, 'embedding_model': 'RandomE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 13:35:38 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 13:35:38 INFO     set_weight_link_or_dist: dist
2024-04-30 13:35:38 INFO     init_weight_inf_or_zero: inf
2024-04-30 13:35:38 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 13:35:38 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 13:35:38 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 13:35:39 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 13:35:41 INFO     Dataset created
2024-04-30 13:35:41 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 13:35:41 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 13:35:41 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 13:35:41 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 13:35:41 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 13:35:41 INFO     NoneScaler
2024-04-30 13:35:43 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 13:35:43 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 13:35:43 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 13:35:43 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 13:35:43 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 13:35:43 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 13:35:43 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 13:35:43 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 13:35:43 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 13:35:43 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 13:35:43 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 13:35:43 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 13:35:43 INFO     Total parameter numbers: 874010
2024-04-30 13:35:43 INFO     You select `adam` optimizer.
2024-04-30 13:35:43 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 13:35:43 INFO     Start training ...
2024-04-30 13:35:43 INFO     num_batches:48
2024-04-30 13:35:48 INFO     epoch complete!
2024-04-30 13:35:48 INFO     evaluating now!
2024-04-30 13:35:48 INFO     Epoch [0/200] train_loss: 25.4806, val_loss: 17.4261, lr: 0.003000, 5.52s
2024-04-30 13:35:48 INFO     Saved model at 0
2024-04-30 13:35:48 INFO     Val loss decrease from inf to 17.4261, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 13:35:53 INFO     epoch complete!
2024-04-30 13:35:53 INFO     evaluating now!
2024-04-30 13:35:53 INFO     Epoch [1/200] train_loss: 14.0131, val_loss: 13.4007, lr: 0.003000, 5.21s
2024-04-30 13:35:53 INFO     Saved model at 1
2024-04-30 13:35:53 INFO     Val loss decrease from 17.4261 to 13.4007, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 13:35:59 INFO     epoch complete!
2024-04-30 13:35:59 INFO     evaluating now!
2024-04-30 13:35:59 INFO     Epoch [2/200] train_loss: 10.9536, val_loss: 10.5038, lr: 0.003000, 5.45s
2024-04-30 13:35:59 INFO     Saved model at 2
2024-04-30 13:35:59 INFO     Val loss decrease from 13.4007 to 10.5038, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 13:36:04 INFO     epoch complete!
2024-04-30 13:36:04 INFO     evaluating now!
2024-04-30 13:36:04 INFO     Epoch [3/200] train_loss: 8.9941, val_loss: 8.5518, lr: 0.003000, 5.33s
2024-04-30 13:36:04 INFO     Saved model at 3
2024-04-30 13:36:04 INFO     Val loss decrease from 10.5038 to 8.5518, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 13:36:09 INFO     epoch complete!
2024-04-30 13:36:09 INFO     evaluating now!
2024-04-30 13:36:10 INFO     Epoch [4/200] train_loss: 7.8004, val_loss: 7.5783, lr: 0.003000, 5.41s
2024-04-30 13:36:10 INFO     Saved model at 4
2024-04-30 13:36:10 INFO     Val loss decrease from 8.5518 to 7.5783, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 13:36:15 INFO     epoch complete!
2024-04-30 13:36:15 INFO     evaluating now!
2024-04-30 13:36:15 INFO     Epoch [5/200] train_loss: 7.2190, val_loss: 7.0556, lr: 0.003000, 5.63s
2024-04-30 13:36:15 INFO     Saved model at 5
2024-04-30 13:36:15 INFO     Val loss decrease from 7.5783 to 7.0556, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 13:36:20 INFO     epoch complete!
2024-04-30 13:36:20 INFO     evaluating now!
2024-04-30 13:36:21 INFO     Epoch [6/200] train_loss: 6.7913, val_loss: 6.6659, lr: 0.003000, 5.31s
2024-04-30 13:36:21 INFO     Saved model at 6
2024-04-30 13:36:21 INFO     Val loss decrease from 7.0556 to 6.6659, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 13:36:26 INFO     epoch complete!
2024-04-30 13:36:26 INFO     evaluating now!
2024-04-30 13:36:26 INFO     Epoch [7/200] train_loss: 6.4011, val_loss: 6.6571, lr: 0.003000, 5.32s
2024-04-30 13:36:26 INFO     Saved model at 7
2024-04-30 13:36:26 INFO     Val loss decrease from 6.6659 to 6.6571, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 13:36:31 INFO     epoch complete!
2024-04-30 13:36:31 INFO     evaluating now!
2024-04-30 13:36:31 INFO     Epoch [8/200] train_loss: 6.1512, val_loss: 6.2502, lr: 0.003000, 5.24s
2024-04-30 13:36:31 INFO     Saved model at 8
2024-04-30 13:36:31 INFO     Val loss decrease from 6.6571 to 6.2502, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 13:36:36 INFO     epoch complete!
2024-04-30 13:36:36 INFO     evaluating now!
2024-04-30 13:36:36 INFO     Epoch [9/200] train_loss: 5.8818, val_loss: 6.3302, lr: 0.003000, 5.18s
2024-04-30 13:36:41 INFO     epoch complete!
2024-04-30 13:36:41 INFO     evaluating now!
2024-04-30 13:36:42 INFO     Epoch [10/200] train_loss: 5.7407, val_loss: 5.8883, lr: 0.003000, 5.19s
2024-04-30 13:36:42 INFO     Saved model at 10
2024-04-30 13:36:42 INFO     Val loss decrease from 6.2502 to 5.8883, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 13:36:47 INFO     epoch complete!
2024-04-30 13:36:47 INFO     evaluating now!
2024-04-30 13:36:47 INFO     Epoch [11/200] train_loss: 5.5607, val_loss: 5.5807, lr: 0.003000, 5.25s
2024-04-30 13:36:47 INFO     Saved model at 11
2024-04-30 13:36:47 INFO     Val loss decrease from 5.8883 to 5.5807, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 13:36:52 INFO     epoch complete!
2024-04-30 13:36:52 INFO     evaluating now!
2024-04-30 13:36:52 INFO     Epoch [12/200] train_loss: 5.5954, val_loss: 5.6175, lr: 0.003000, 5.40s
2024-04-30 13:36:57 INFO     epoch complete!
2024-04-30 13:36:57 INFO     evaluating now!
2024-04-30 13:36:57 INFO     Epoch [13/200] train_loss: 5.3211, val_loss: 5.5304, lr: 0.003000, 5.15s
2024-04-30 13:36:58 INFO     Saved model at 13
2024-04-30 13:36:58 INFO     Val loss decrease from 5.5807 to 5.5304, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 13:37:02 INFO     epoch complete!
2024-04-30 13:37:02 INFO     evaluating now!
2024-04-30 13:37:03 INFO     Epoch [14/200] train_loss: 5.2382, val_loss: 5.5094, lr: 0.003000, 5.19s
2024-04-30 13:37:03 INFO     Saved model at 14
2024-04-30 13:37:03 INFO     Val loss decrease from 5.5304 to 5.5094, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 13:37:08 INFO     epoch complete!
2024-04-30 13:37:08 INFO     evaluating now!
2024-04-30 13:37:08 INFO     Epoch [15/200] train_loss: 5.0910, val_loss: 5.3759, lr: 0.003000, 5.25s
2024-04-30 13:37:08 INFO     Saved model at 15
2024-04-30 13:37:08 INFO     Val loss decrease from 5.5094 to 5.3759, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 13:37:13 INFO     epoch complete!
2024-04-30 13:37:13 INFO     evaluating now!
2024-04-30 13:37:13 INFO     Epoch [16/200] train_loss: 5.0262, val_loss: 5.5477, lr: 0.003000, 5.34s
2024-04-30 13:37:18 INFO     epoch complete!
2024-04-30 13:37:18 INFO     evaluating now!
2024-04-30 13:37:18 INFO     Epoch [17/200] train_loss: 4.9742, val_loss: 5.4670, lr: 0.003000, 5.16s
2024-04-30 13:37:23 INFO     epoch complete!
2024-04-30 13:37:23 INFO     evaluating now!
2024-04-30 13:37:24 INFO     Epoch [18/200] train_loss: 4.9829, val_loss: 5.4728, lr: 0.003000, 5.20s
2024-04-30 13:37:29 INFO     epoch complete!
2024-04-30 13:37:29 INFO     evaluating now!
2024-04-30 13:37:29 INFO     Epoch [19/200] train_loss: 4.8233, val_loss: 5.1986, lr: 0.003000, 5.21s
2024-04-30 13:37:29 INFO     Saved model at 19
2024-04-30 13:37:29 INFO     Val loss decrease from 5.3759 to 5.1986, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 13:37:34 INFO     epoch complete!
2024-04-30 13:37:34 INFO     evaluating now!
2024-04-30 13:37:34 INFO     Epoch [20/200] train_loss: 4.7244, val_loss: 5.4270, lr: 0.003000, 5.27s
2024-04-30 13:37:39 INFO     epoch complete!
2024-04-30 13:37:39 INFO     evaluating now!
2024-04-30 13:37:40 INFO     Epoch [21/200] train_loss: 4.7045, val_loss: 5.2314, lr: 0.003000, 5.44s
2024-04-30 13:37:45 INFO     epoch complete!
2024-04-30 13:37:45 INFO     evaluating now!
2024-04-30 13:37:45 INFO     Epoch [22/200] train_loss: 4.6264, val_loss: 5.2904, lr: 0.003000, 5.23s
2024-04-30 13:37:50 INFO     epoch complete!
2024-04-30 13:37:50 INFO     evaluating now!
2024-04-30 13:37:50 INFO     Epoch [23/200] train_loss: 4.6038, val_loss: 5.2336, lr: 0.003000, 5.20s
2024-04-30 13:37:55 INFO     epoch complete!
2024-04-30 13:37:55 INFO     evaluating now!
2024-04-30 13:37:55 INFO     Epoch [24/200] train_loss: 4.5255, val_loss: 5.2122, lr: 0.003000, 5.18s
2024-04-30 13:38:00 INFO     epoch complete!
2024-04-30 13:38:00 INFO     evaluating now!
2024-04-30 13:38:00 INFO     Epoch [25/200] train_loss: 4.5403, val_loss: 5.3020, lr: 0.003000, 5.21s
2024-04-30 13:38:05 INFO     epoch complete!
2024-04-30 13:38:05 INFO     evaluating now!
2024-04-30 13:38:06 INFO     Epoch [26/200] train_loss: 4.4665, val_loss: 5.2952, lr: 0.003000, 5.22s
2024-04-30 13:38:11 INFO     epoch complete!
2024-04-30 13:38:11 INFO     evaluating now!
2024-04-30 13:38:11 INFO     Epoch [27/200] train_loss: 4.4165, val_loss: 5.0298, lr: 0.003000, 5.21s
2024-04-30 13:38:11 INFO     Saved model at 27
2024-04-30 13:38:11 INFO     Val loss decrease from 5.1986 to 5.0298, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-30 13:38:16 INFO     epoch complete!
2024-04-30 13:38:16 INFO     evaluating now!
2024-04-30 13:38:16 INFO     Epoch [28/200] train_loss: 4.3685, val_loss: 5.0899, lr: 0.003000, 5.18s
2024-04-30 13:38:21 INFO     epoch complete!
2024-04-30 13:38:21 INFO     evaluating now!
2024-04-30 13:38:21 INFO     Epoch [29/200] train_loss: 4.2812, val_loss: 5.0876, lr: 0.003000, 5.25s
2024-04-30 13:38:26 INFO     epoch complete!
2024-04-30 13:38:26 INFO     evaluating now!
2024-04-30 13:38:27 INFO     Epoch [30/200] train_loss: 4.3274, val_loss: 5.1235, lr: 0.003000, 5.44s
2024-04-30 13:38:32 INFO     epoch complete!
2024-04-30 13:38:32 INFO     evaluating now!
2024-04-30 13:38:32 INFO     Epoch [31/200] train_loss: 4.2496, val_loss: 5.0670, lr: 0.003000, 5.35s
2024-04-30 13:38:37 INFO     epoch complete!
2024-04-30 13:38:37 INFO     evaluating now!
2024-04-30 13:38:37 INFO     Epoch [32/200] train_loss: 4.1982, val_loss: 5.0354, lr: 0.003000, 5.23s
2024-04-30 13:38:42 INFO     epoch complete!
2024-04-30 13:38:42 INFO     evaluating now!
2024-04-30 13:38:43 INFO     Epoch [33/200] train_loss: 4.1593, val_loss: 5.0830, lr: 0.003000, 5.30s
2024-04-30 13:38:48 INFO     epoch complete!
2024-04-30 13:38:48 INFO     evaluating now!
2024-04-30 13:38:48 INFO     Epoch [34/200] train_loss: 4.1826, val_loss: 5.0658, lr: 0.003000, 5.34s
2024-04-30 13:38:53 INFO     epoch complete!
2024-04-30 13:38:53 INFO     evaluating now!
2024-04-30 13:38:53 INFO     Epoch [35/200] train_loss: 4.1157, val_loss: 5.0754, lr: 0.003000, 5.23s
2024-04-30 13:38:58 INFO     epoch complete!
2024-04-30 13:38:58 INFO     evaluating now!
2024-04-30 13:38:59 INFO     Epoch [36/200] train_loss: 4.1229, val_loss: 5.2335, lr: 0.003000, 5.36s
2024-04-30 13:39:03 INFO     epoch complete!
2024-04-30 13:39:03 INFO     evaluating now!
2024-04-30 13:39:04 INFO     Epoch [37/200] train_loss: 4.0670, val_loss: 5.0932, lr: 0.003000, 5.24s
2024-04-30 13:39:09 INFO     epoch complete!
2024-04-30 13:39:09 INFO     evaluating now!
2024-04-30 13:39:09 INFO     Epoch [38/200] train_loss: 4.0030, val_loss: 5.0253, lr: 0.003000, 5.32s
2024-04-30 13:39:09 INFO     Saved model at 38
2024-04-30 13:39:09 INFO     Val loss decrease from 5.0298 to 5.0253, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-04-30 13:39:14 INFO     epoch complete!
2024-04-30 13:39:14 INFO     evaluating now!
2024-04-30 13:39:14 INFO     Epoch [39/200] train_loss: 3.9950, val_loss: 5.2617, lr: 0.003000, 5.33s
2024-04-30 13:39:19 INFO     epoch complete!
2024-04-30 13:39:19 INFO     evaluating now!
2024-04-30 13:39:20 INFO     Epoch [40/200] train_loss: 3.9911, val_loss: 5.0541, lr: 0.003000, 5.23s
2024-04-30 13:39:25 INFO     epoch complete!
2024-04-30 13:39:25 INFO     evaluating now!
2024-04-30 13:39:25 INFO     Epoch [41/200] train_loss: 3.9239, val_loss: 5.1301, lr: 0.003000, 5.34s
2024-04-30 13:39:30 INFO     epoch complete!
2024-04-30 13:39:30 INFO     evaluating now!
2024-04-30 13:39:31 INFO     Epoch [42/200] train_loss: 3.8930, val_loss: 5.0971, lr: 0.003000, 5.49s
2024-04-30 13:39:36 INFO     epoch complete!
2024-04-30 13:39:36 INFO     evaluating now!
2024-04-30 13:39:36 INFO     Epoch [43/200] train_loss: 3.9096, val_loss: 5.2658, lr: 0.003000, 5.31s
2024-04-30 13:39:41 INFO     epoch complete!
2024-04-30 13:39:41 INFO     evaluating now!
2024-04-30 13:39:41 INFO     Epoch [44/200] train_loss: 3.8687, val_loss: 5.1763, lr: 0.003000, 5.19s
2024-04-30 13:39:46 INFO     epoch complete!
2024-04-30 13:39:46 INFO     evaluating now!
2024-04-30 13:39:46 INFO     Epoch [45/200] train_loss: 3.9255, val_loss: 5.0926, lr: 0.003000, 5.25s
2024-04-30 13:39:51 INFO     epoch complete!
2024-04-30 13:39:51 INFO     evaluating now!
2024-04-30 13:39:51 INFO     Epoch [46/200] train_loss: 3.8568, val_loss: 5.1197, lr: 0.003000, 5.20s
2024-04-30 13:39:57 INFO     epoch complete!
2024-04-30 13:39:57 INFO     evaluating now!
2024-04-30 13:39:57 INFO     Epoch [47/200] train_loss: 3.8037, val_loss: 5.0234, lr: 0.003000, 5.44s
2024-04-30 13:39:57 INFO     Saved model at 47
2024-04-30 13:39:57 INFO     Val loss decrease from 5.0253 to 5.0234, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch47.tar
2024-04-30 13:40:02 INFO     epoch complete!
2024-04-30 13:40:02 INFO     evaluating now!
2024-04-30 13:40:02 INFO     Epoch [48/200] train_loss: 3.7679, val_loss: 4.9719, lr: 0.003000, 5.53s
2024-04-30 13:40:02 INFO     Saved model at 48
2024-04-30 13:40:02 INFO     Val loss decrease from 5.0234 to 4.9719, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-04-30 13:40:08 INFO     epoch complete!
2024-04-30 13:40:08 INFO     evaluating now!
2024-04-30 13:40:08 INFO     Epoch [49/200] train_loss: 3.8028, val_loss: 5.0940, lr: 0.003000, 5.67s
2024-04-30 13:40:13 INFO     epoch complete!
2024-04-30 13:40:13 INFO     evaluating now!
2024-04-30 13:40:13 INFO     Epoch [50/200] train_loss: 3.7182, val_loss: 5.1793, lr: 0.003000, 5.31s
2024-04-30 13:40:18 INFO     epoch complete!
2024-04-30 13:40:18 INFO     evaluating now!
2024-04-30 13:40:19 INFO     Epoch [51/200] train_loss: 3.8752, val_loss: 5.0473, lr: 0.003000, 5.30s
2024-04-30 13:40:24 INFO     epoch complete!
2024-04-30 13:40:24 INFO     evaluating now!
2024-04-30 13:40:24 INFO     Epoch [52/200] train_loss: 3.8165, val_loss: 5.1239, lr: 0.003000, 5.41s
2024-04-30 13:40:29 INFO     epoch complete!
2024-04-30 13:40:29 INFO     evaluating now!
2024-04-30 13:40:29 INFO     Epoch [53/200] train_loss: 3.7711, val_loss: 5.1375, lr: 0.003000, 5.28s
2024-04-30 13:40:34 INFO     epoch complete!
2024-04-30 13:40:34 INFO     evaluating now!
2024-04-30 13:40:35 INFO     Epoch [54/200] train_loss: 3.7455, val_loss: 4.9744, lr: 0.003000, 5.27s
2024-04-30 13:40:40 INFO     epoch complete!
2024-04-30 13:40:40 INFO     evaluating now!
2024-04-30 13:40:40 INFO     Epoch [55/200] train_loss: 3.7034, val_loss: 5.0241, lr: 0.003000, 5.42s
2024-04-30 13:40:45 INFO     epoch complete!
2024-04-30 13:40:45 INFO     evaluating now!
2024-04-30 13:40:46 INFO     Epoch [56/200] train_loss: 3.6446, val_loss: 5.0820, lr: 0.003000, 5.39s
2024-04-30 13:40:51 INFO     epoch complete!
2024-04-30 13:40:51 INFO     evaluating now!
2024-04-30 13:40:51 INFO     Epoch [57/200] train_loss: 3.6245, val_loss: 5.0668, lr: 0.003000, 5.46s
2024-04-30 13:40:56 INFO     epoch complete!
2024-04-30 13:40:56 INFO     evaluating now!
2024-04-30 13:40:56 INFO     Epoch [58/200] train_loss: 3.6188, val_loss: 5.1291, lr: 0.003000, 5.35s
2024-04-30 13:41:01 INFO     epoch complete!
2024-04-30 13:41:01 INFO     evaluating now!
2024-04-30 13:41:01 INFO     Epoch [59/200] train_loss: 3.6557, val_loss: 5.1040, lr: 0.003000, 5.14s
2024-04-30 13:41:07 INFO     epoch complete!
2024-04-30 13:41:07 INFO     evaluating now!
2024-04-30 13:41:07 INFO     Epoch [60/200] train_loss: 3.5892, val_loss: 4.9549, lr: 0.003000, 5.49s
2024-04-30 13:41:07 INFO     Saved model at 60
2024-04-30 13:41:07 INFO     Val loss decrease from 4.9719 to 4.9549, saving to ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406_epoch60.tar
2024-04-30 13:41:12 INFO     epoch complete!
2024-04-30 13:41:12 INFO     evaluating now!
2024-04-30 13:41:12 INFO     Epoch [61/200] train_loss: 3.5971, val_loss: 5.1849, lr: 0.003000, 5.33s
2024-04-30 13:41:17 INFO     epoch complete!
2024-04-30 13:41:17 INFO     evaluating now!
2024-04-30 13:41:18 INFO     Epoch [62/200] train_loss: 3.5607, val_loss: 5.0191, lr: 0.003000, 5.35s
2024-04-30 13:41:23 INFO     epoch complete!
2024-04-30 13:41:23 INFO     evaluating now!
2024-04-30 13:41:23 INFO     Epoch [63/200] train_loss: 3.5717, val_loss: 5.0379, lr: 0.003000, 5.29s
2024-04-30 13:41:28 INFO     epoch complete!
2024-04-30 13:41:28 INFO     evaluating now!
2024-04-30 13:41:28 INFO     Epoch [64/200] train_loss: 3.5741, val_loss: 5.1139, lr: 0.003000, 5.38s
2024-04-30 13:41:33 INFO     epoch complete!
2024-04-30 13:41:33 INFO     evaluating now!
2024-04-30 13:41:34 INFO     Epoch [65/200] train_loss: 3.4998, val_loss: 5.0146, lr: 0.003000, 5.24s
2024-04-30 13:41:38 INFO     epoch complete!
2024-04-30 13:41:38 INFO     evaluating now!
2024-04-30 13:41:39 INFO     Epoch [66/200] train_loss: 3.5020, val_loss: 4.9935, lr: 0.003000, 5.14s
2024-04-30 13:41:44 INFO     epoch complete!
2024-04-30 13:41:44 INFO     evaluating now!
2024-04-30 13:41:44 INFO     Epoch [67/200] train_loss: 3.4794, val_loss: 5.0647, lr: 0.003000, 5.14s
2024-04-30 13:41:49 INFO     epoch complete!
2024-04-30 13:41:49 INFO     evaluating now!
2024-04-30 13:41:49 INFO     Epoch [68/200] train_loss: 3.4396, val_loss: 5.0220, lr: 0.003000, 5.46s
2024-04-30 13:41:54 INFO     epoch complete!
2024-04-30 13:41:54 INFO     evaluating now!
2024-04-30 13:41:55 INFO     Epoch [69/200] train_loss: 3.4864, val_loss: 4.9679, lr: 0.003000, 5.33s
2024-04-30 13:42:00 INFO     epoch complete!
2024-04-30 13:42:00 INFO     evaluating now!
2024-04-30 13:42:00 INFO     Epoch [70/200] train_loss: 3.4370, val_loss: 5.0409, lr: 0.003000, 5.47s
2024-04-30 13:42:05 INFO     epoch complete!
2024-04-30 13:42:05 INFO     evaluating now!
2024-04-30 13:42:06 INFO     Epoch [71/200] train_loss: 3.4091, val_loss: 4.9722, lr: 0.003000, 5.60s
2024-04-30 13:42:11 INFO     epoch complete!
2024-04-30 13:42:11 INFO     evaluating now!
2024-04-30 13:42:11 INFO     Epoch [72/200] train_loss: 3.4152, val_loss: 5.1328, lr: 0.003000, 5.35s
2024-04-30 13:42:16 INFO     epoch complete!
2024-04-30 13:42:16 INFO     evaluating now!
2024-04-30 13:42:16 INFO     Epoch [73/200] train_loss: 3.4176, val_loss: 5.1528, lr: 0.003000, 5.35s
2024-04-30 13:42:21 INFO     epoch complete!
2024-04-30 13:42:21 INFO     evaluating now!
2024-04-30 13:42:22 INFO     Epoch [74/200] train_loss: 3.4400, val_loss: 5.1007, lr: 0.003000, 5.25s
2024-04-30 13:42:27 INFO     epoch complete!
2024-04-30 13:42:27 INFO     evaluating now!
2024-04-30 13:42:27 INFO     Epoch [75/200] train_loss: 3.3984, val_loss: 5.0252, lr: 0.003000, 5.21s
2024-04-30 13:42:27 WARNING  Early stopping at epoch: 75
2024-04-30 13:42:27 INFO     Trained totally 76 epochs, average train time is 4.983s, average eval time is 0.330s
2024-04-30 13:42:27 INFO     Loaded model at 60
2024-04-30 13:42:27 INFO     Saved model at ./libcity/cache/61/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 13:42:27 INFO     Start evaluating ...
2024-04-30 13:42:28 INFO     Note that you select the single mode to evaluate!
2024-04-30 13:42:28 INFO     Evaluate result is saved at ./libcity/cache/61/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-30 13:42:28 INFO     
         MAE       RMSE
1   2.428134   7.075169
2   2.587740   7.912601
3   2.730423   8.939770
4   2.876018   9.815369
5   3.017798  10.881410
6   3.109589  11.985507
7   3.197934  12.924958
8   3.301150  13.521489
9   3.384299  13.693884
10  3.408886  13.539956
11  3.480317  13.764101
12  3.559850  14.172412
2024-04-30 13:42:28 INFO     ----------------------------------------------------------------------------
2024-04-30 13:42:28 INFO     # 2, Kownledge Graph Embedding: RandomE, Experiment ids: 62
2024-04-30 13:42:28 INFO     ----------------------------------------------------------------------------
2024-04-30 13:42:28 INFO     Log directory: ./libcity/log
2024-04-30 13:42:28 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=62
2024-04-30 13:42:28 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 161843251, 'exp_id': 62, 'load_external': True, 'embedding_model': 'RandomE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 13:42:28 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 13:42:28 INFO     set_weight_link_or_dist: dist
2024-04-30 13:42:28 INFO     init_weight_inf_or_zero: inf
2024-04-30 13:42:28 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 13:42:28 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 13:42:28 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 13:42:28 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 13:42:30 INFO     Dataset created
2024-04-30 13:42:30 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 13:42:30 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 13:42:30 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 13:42:30 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 13:42:30 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 13:42:30 INFO     NoneScaler
2024-04-30 13:42:32 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 13:42:32 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 13:42:32 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 13:42:32 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 13:42:32 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 13:42:32 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 13:42:32 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 13:42:32 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 13:42:32 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 13:42:32 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 13:42:32 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 13:42:32 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 13:42:32 INFO     Total parameter numbers: 874010
2024-04-30 13:42:32 INFO     You select `adam` optimizer.
2024-04-30 13:42:32 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 13:42:32 INFO     Start training ...
2024-04-30 13:42:32 INFO     num_batches:48
2024-04-30 13:42:37 INFO     epoch complete!
2024-04-30 13:42:37 INFO     evaluating now!
2024-04-30 13:42:38 INFO     Epoch [0/200] train_loss: 24.2974, val_loss: 17.0333, lr: 0.003000, 5.51s
2024-04-30 13:42:38 INFO     Saved model at 0
2024-04-30 13:42:38 INFO     Val loss decrease from inf to 17.0333, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 13:42:43 INFO     epoch complete!
2024-04-30 13:42:43 INFO     evaluating now!
2024-04-30 13:42:43 INFO     Epoch [1/200] train_loss: 13.6850, val_loss: 12.8007, lr: 0.003000, 5.33s
2024-04-30 13:42:43 INFO     Saved model at 1
2024-04-30 13:42:43 INFO     Val loss decrease from 17.0333 to 12.8007, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 13:42:48 INFO     epoch complete!
2024-04-30 13:42:48 INFO     evaluating now!
2024-04-30 13:42:48 INFO     Epoch [2/200] train_loss: 10.6674, val_loss: 10.1027, lr: 0.003000, 5.33s
2024-04-30 13:42:48 INFO     Saved model at 2
2024-04-30 13:42:48 INFO     Val loss decrease from 12.8007 to 10.1027, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 13:42:53 INFO     epoch complete!
2024-04-30 13:42:53 INFO     evaluating now!
2024-04-30 13:42:54 INFO     Epoch [3/200] train_loss: 8.8392, val_loss: 8.4110, lr: 0.003000, 5.37s
2024-04-30 13:42:54 INFO     Saved model at 3
2024-04-30 13:42:54 INFO     Val loss decrease from 10.1027 to 8.4110, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 13:42:59 INFO     epoch complete!
2024-04-30 13:42:59 INFO     evaluating now!
2024-04-30 13:42:59 INFO     Epoch [4/200] train_loss: 7.5733, val_loss: 7.3804, lr: 0.003000, 5.24s
2024-04-30 13:42:59 INFO     Saved model at 4
2024-04-30 13:42:59 INFO     Val loss decrease from 8.4110 to 7.3804, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 13:43:04 INFO     epoch complete!
2024-04-30 13:43:04 INFO     evaluating now!
2024-04-30 13:43:04 INFO     Epoch [5/200] train_loss: 6.9777, val_loss: 6.9025, lr: 0.003000, 5.30s
2024-04-30 13:43:04 INFO     Saved model at 5
2024-04-30 13:43:04 INFO     Val loss decrease from 7.3804 to 6.9025, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 13:43:09 INFO     epoch complete!
2024-04-30 13:43:09 INFO     evaluating now!
2024-04-30 13:43:10 INFO     Epoch [6/200] train_loss: 6.4022, val_loss: 6.6853, lr: 0.003000, 5.31s
2024-04-30 13:43:10 INFO     Saved model at 6
2024-04-30 13:43:10 INFO     Val loss decrease from 6.9025 to 6.6853, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 13:43:14 INFO     epoch complete!
2024-04-30 13:43:14 INFO     evaluating now!
2024-04-30 13:43:15 INFO     Epoch [7/200] train_loss: 6.2421, val_loss: 6.4182, lr: 0.003000, 5.15s
2024-04-30 13:43:15 INFO     Saved model at 7
2024-04-30 13:43:15 INFO     Val loss decrease from 6.6853 to 6.4182, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 13:43:20 INFO     epoch complete!
2024-04-30 13:43:20 INFO     evaluating now!
2024-04-30 13:43:20 INFO     Epoch [8/200] train_loss: 5.9156, val_loss: 6.0319, lr: 0.003000, 5.26s
2024-04-30 13:43:20 INFO     Saved model at 8
2024-04-30 13:43:20 INFO     Val loss decrease from 6.4182 to 6.0319, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 13:43:25 INFO     epoch complete!
2024-04-30 13:43:25 INFO     evaluating now!
2024-04-30 13:43:25 INFO     Epoch [9/200] train_loss: 5.6707, val_loss: 5.8308, lr: 0.003000, 5.41s
2024-04-30 13:43:25 INFO     Saved model at 9
2024-04-30 13:43:25 INFO     Val loss decrease from 6.0319 to 5.8308, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 13:43:30 INFO     epoch complete!
2024-04-30 13:43:30 INFO     evaluating now!
2024-04-30 13:43:31 INFO     Epoch [10/200] train_loss: 5.5183, val_loss: 5.8872, lr: 0.003000, 5.31s
2024-04-30 13:43:36 INFO     epoch complete!
2024-04-30 13:43:36 INFO     evaluating now!
2024-04-30 13:43:36 INFO     Epoch [11/200] train_loss: 5.3861, val_loss: 5.5589, lr: 0.003000, 5.35s
2024-04-30 13:43:36 INFO     Saved model at 11
2024-04-30 13:43:36 INFO     Val loss decrease from 5.8308 to 5.5589, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 13:43:41 INFO     epoch complete!
2024-04-30 13:43:41 INFO     evaluating now!
2024-04-30 13:43:41 INFO     Epoch [12/200] train_loss: 5.2360, val_loss: 5.6918, lr: 0.003000, 5.19s
2024-04-30 13:43:46 INFO     epoch complete!
2024-04-30 13:43:46 INFO     evaluating now!
2024-04-30 13:43:47 INFO     Epoch [13/200] train_loss: 5.1414, val_loss: 5.5398, lr: 0.003000, 5.39s
2024-04-30 13:43:47 INFO     Saved model at 13
2024-04-30 13:43:47 INFO     Val loss decrease from 5.5589 to 5.5398, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 13:43:52 INFO     epoch complete!
2024-04-30 13:43:52 INFO     evaluating now!
2024-04-30 13:43:52 INFO     Epoch [14/200] train_loss: 5.0591, val_loss: 5.4575, lr: 0.003000, 5.28s
2024-04-30 13:43:52 INFO     Saved model at 14
2024-04-30 13:43:52 INFO     Val loss decrease from 5.5398 to 5.4575, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 13:43:57 INFO     epoch complete!
2024-04-30 13:43:57 INFO     evaluating now!
2024-04-30 13:43:57 INFO     Epoch [15/200] train_loss: 4.9243, val_loss: 5.3623, lr: 0.003000, 5.29s
2024-04-30 13:43:57 INFO     Saved model at 15
2024-04-30 13:43:57 INFO     Val loss decrease from 5.4575 to 5.3623, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 13:44:02 INFO     epoch complete!
2024-04-30 13:44:02 INFO     evaluating now!
2024-04-30 13:44:03 INFO     Epoch [16/200] train_loss: 4.9240, val_loss: 5.1952, lr: 0.003000, 5.34s
2024-04-30 13:44:03 INFO     Saved model at 16
2024-04-30 13:44:03 INFO     Val loss decrease from 5.3623 to 5.1952, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 13:44:08 INFO     epoch complete!
2024-04-30 13:44:08 INFO     evaluating now!
2024-04-30 13:44:08 INFO     Epoch [17/200] train_loss: 4.7578, val_loss: 5.2881, lr: 0.003000, 5.25s
2024-04-30 13:44:13 INFO     epoch complete!
2024-04-30 13:44:13 INFO     evaluating now!
2024-04-30 13:44:13 INFO     Epoch [18/200] train_loss: 4.7108, val_loss: 5.5329, lr: 0.003000, 5.25s
2024-04-30 13:44:18 INFO     epoch complete!
2024-04-30 13:44:18 INFO     evaluating now!
2024-04-30 13:44:18 INFO     Epoch [19/200] train_loss: 4.6918, val_loss: 5.3062, lr: 0.003000, 5.20s
2024-04-30 13:44:23 INFO     epoch complete!
2024-04-30 13:44:23 INFO     evaluating now!
2024-04-30 13:44:24 INFO     Epoch [20/200] train_loss: 4.5725, val_loss: 5.2413, lr: 0.003000, 5.31s
2024-04-30 13:44:29 INFO     epoch complete!
2024-04-30 13:44:29 INFO     evaluating now!
2024-04-30 13:44:29 INFO     Epoch [21/200] train_loss: 4.5443, val_loss: 5.0867, lr: 0.003000, 5.35s
2024-04-30 13:44:29 INFO     Saved model at 21
2024-04-30 13:44:29 INFO     Val loss decrease from 5.1952 to 5.0867, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-30 13:44:34 INFO     epoch complete!
2024-04-30 13:44:34 INFO     evaluating now!
2024-04-30 13:44:34 INFO     Epoch [22/200] train_loss: 4.5097, val_loss: 5.2482, lr: 0.003000, 5.34s
2024-04-30 13:44:39 INFO     epoch complete!
2024-04-30 13:44:39 INFO     evaluating now!
2024-04-30 13:44:40 INFO     Epoch [23/200] train_loss: 4.4959, val_loss: 5.2304, lr: 0.003000, 5.34s
2024-04-30 13:44:45 INFO     epoch complete!
2024-04-30 13:44:45 INFO     evaluating now!
2024-04-30 13:44:45 INFO     Epoch [24/200] train_loss: 4.3917, val_loss: 5.1413, lr: 0.003000, 5.27s
2024-04-30 13:44:50 INFO     epoch complete!
2024-04-30 13:44:50 INFO     evaluating now!
2024-04-30 13:44:50 INFO     Epoch [25/200] train_loss: 4.3568, val_loss: 5.1167, lr: 0.003000, 5.31s
2024-04-30 13:44:55 INFO     epoch complete!
2024-04-30 13:44:55 INFO     evaluating now!
2024-04-30 13:44:56 INFO     Epoch [26/200] train_loss: 4.2916, val_loss: 5.2066, lr: 0.003000, 5.32s
2024-04-30 13:45:01 INFO     epoch complete!
2024-04-30 13:45:01 INFO     evaluating now!
2024-04-30 13:45:01 INFO     Epoch [27/200] train_loss: 4.2681, val_loss: 5.2578, lr: 0.003000, 5.25s
2024-04-30 13:45:06 INFO     epoch complete!
2024-04-30 13:45:06 INFO     evaluating now!
2024-04-30 13:45:06 INFO     Epoch [28/200] train_loss: 4.1915, val_loss: 5.2233, lr: 0.003000, 5.22s
2024-04-30 13:45:11 INFO     epoch complete!
2024-04-30 13:45:11 INFO     evaluating now!
2024-04-30 13:45:12 INFO     Epoch [29/200] train_loss: 4.1930, val_loss: 5.0768, lr: 0.003000, 5.46s
2024-04-30 13:45:12 INFO     Saved model at 29
2024-04-30 13:45:12 INFO     Val loss decrease from 5.0867 to 5.0768, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-04-30 13:45:17 INFO     epoch complete!
2024-04-30 13:45:17 INFO     evaluating now!
2024-04-30 13:45:17 INFO     Epoch [30/200] train_loss: 4.1845, val_loss: 5.1775, lr: 0.003000, 5.23s
2024-04-30 13:45:22 INFO     epoch complete!
2024-04-30 13:45:22 INFO     evaluating now!
2024-04-30 13:45:22 INFO     Epoch [31/200] train_loss: 4.1335, val_loss: 5.1398, lr: 0.003000, 5.33s
2024-04-30 13:45:27 INFO     epoch complete!
2024-04-30 13:45:27 INFO     evaluating now!
2024-04-30 13:45:28 INFO     Epoch [32/200] train_loss: 4.1755, val_loss: 5.1692, lr: 0.003000, 5.30s
2024-04-30 13:45:33 INFO     epoch complete!
2024-04-30 13:45:33 INFO     evaluating now!
2024-04-30 13:45:33 INFO     Epoch [33/200] train_loss: 4.0577, val_loss: 5.0087, lr: 0.003000, 5.49s
2024-04-30 13:45:33 INFO     Saved model at 33
2024-04-30 13:45:33 INFO     Val loss decrease from 5.0768 to 5.0087, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-04-30 13:45:38 INFO     epoch complete!
2024-04-30 13:45:38 INFO     evaluating now!
2024-04-30 13:45:38 INFO     Epoch [34/200] train_loss: 4.0075, val_loss: 5.0762, lr: 0.003000, 5.32s
2024-04-30 13:45:43 INFO     epoch complete!
2024-04-30 13:45:43 INFO     evaluating now!
2024-04-30 13:45:44 INFO     Epoch [35/200] train_loss: 4.0050, val_loss: 4.9456, lr: 0.003000, 5.26s
2024-04-30 13:45:44 INFO     Saved model at 35
2024-04-30 13:45:44 INFO     Val loss decrease from 5.0087 to 4.9456, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-04-30 13:45:49 INFO     epoch complete!
2024-04-30 13:45:49 INFO     evaluating now!
2024-04-30 13:45:49 INFO     Epoch [36/200] train_loss: 3.9723, val_loss: 5.1473, lr: 0.003000, 5.44s
2024-04-30 13:45:54 INFO     epoch complete!
2024-04-30 13:45:54 INFO     evaluating now!
2024-04-30 13:45:54 INFO     Epoch [37/200] train_loss: 3.9130, val_loss: 5.0543, lr: 0.003000, 5.19s
2024-04-30 13:45:59 INFO     epoch complete!
2024-04-30 13:45:59 INFO     evaluating now!
2024-04-30 13:46:00 INFO     Epoch [38/200] train_loss: 3.9046, val_loss: 4.9310, lr: 0.003000, 5.31s
2024-04-30 13:46:00 INFO     Saved model at 38
2024-04-30 13:46:00 INFO     Val loss decrease from 4.9456 to 4.9310, saving to ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-04-30 13:46:05 INFO     epoch complete!
2024-04-30 13:46:05 INFO     evaluating now!
2024-04-30 13:46:05 INFO     Epoch [39/200] train_loss: 3.8565, val_loss: 5.0307, lr: 0.003000, 5.41s
2024-04-30 13:46:10 INFO     epoch complete!
2024-04-30 13:46:10 INFO     evaluating now!
2024-04-30 13:46:10 INFO     Epoch [40/200] train_loss: 3.8434, val_loss: 5.0283, lr: 0.003000, 5.28s
2024-04-30 13:46:16 INFO     epoch complete!
2024-04-30 13:46:16 INFO     evaluating now!
2024-04-30 13:46:16 INFO     Epoch [41/200] train_loss: 3.8811, val_loss: 5.1278, lr: 0.003000, 5.62s
2024-04-30 13:46:21 INFO     epoch complete!
2024-04-30 13:46:21 INFO     evaluating now!
2024-04-30 13:46:21 INFO     Epoch [42/200] train_loss: 3.8179, val_loss: 5.0839, lr: 0.003000, 5.36s
2024-04-30 13:46:26 INFO     epoch complete!
2024-04-30 13:46:26 INFO     evaluating now!
2024-04-30 13:46:27 INFO     Epoch [43/200] train_loss: 3.7800, val_loss: 4.9675, lr: 0.003000, 5.26s
2024-04-30 13:46:31 INFO     epoch complete!
2024-04-30 13:46:31 INFO     evaluating now!
2024-04-30 13:46:32 INFO     Epoch [44/200] train_loss: 3.7428, val_loss: 4.9650, lr: 0.003000, 5.22s
2024-04-30 13:46:37 INFO     epoch complete!
2024-04-30 13:46:37 INFO     evaluating now!
2024-04-30 13:46:37 INFO     Epoch [45/200] train_loss: 3.7750, val_loss: 5.0396, lr: 0.003000, 5.21s
2024-04-30 13:46:42 INFO     epoch complete!
2024-04-30 13:46:42 INFO     evaluating now!
2024-04-30 13:46:42 INFO     Epoch [46/200] train_loss: 3.7257, val_loss: 4.9991, lr: 0.003000, 5.24s
2024-04-30 13:46:47 INFO     epoch complete!
2024-04-30 13:46:47 INFO     evaluating now!
2024-04-30 13:46:47 INFO     Epoch [47/200] train_loss: 3.6753, val_loss: 5.0611, lr: 0.003000, 5.24s
2024-04-30 13:46:52 INFO     epoch complete!
2024-04-30 13:46:52 INFO     evaluating now!
2024-04-30 13:46:53 INFO     Epoch [48/200] train_loss: 3.6999, val_loss: 5.0454, lr: 0.003000, 5.18s
2024-04-30 13:46:58 INFO     epoch complete!
2024-04-30 13:46:58 INFO     evaluating now!
2024-04-30 13:46:58 INFO     Epoch [49/200] train_loss: 3.7080, val_loss: 5.0654, lr: 0.003000, 5.34s
2024-04-30 13:47:03 INFO     epoch complete!
2024-04-30 13:47:03 INFO     evaluating now!
2024-04-30 13:47:03 INFO     Epoch [50/200] train_loss: 3.6785, val_loss: 5.1095, lr: 0.003000, 5.18s
2024-04-30 13:47:08 INFO     epoch complete!
2024-04-30 13:47:08 INFO     evaluating now!
2024-04-30 13:47:08 INFO     Epoch [51/200] train_loss: 3.6436, val_loss: 5.0257, lr: 0.003000, 5.34s
2024-04-30 13:47:13 INFO     epoch complete!
2024-04-30 13:47:13 INFO     evaluating now!
2024-04-30 13:47:14 INFO     Epoch [52/200] train_loss: 3.5926, val_loss: 5.1106, lr: 0.003000, 5.23s
2024-04-30 13:47:19 INFO     epoch complete!
2024-04-30 13:47:19 INFO     evaluating now!
2024-04-30 13:47:19 INFO     Epoch [53/200] train_loss: 3.5844, val_loss: 5.1847, lr: 0.003000, 5.34s
2024-04-30 13:47:19 WARNING  Early stopping at epoch: 53
2024-04-30 13:47:19 INFO     Trained totally 54 epochs, average train time is 4.976s, average eval time is 0.330s
2024-04-30 13:47:19 INFO     Loaded model at 38
2024-04-30 13:47:19 INFO     Saved model at ./libcity/cache/62/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 13:47:19 INFO     Start evaluating ...
2024-04-30 13:47:20 INFO     Note that you select the single mode to evaluate!
2024-04-30 13:47:20 INFO     Evaluate result is saved at ./libcity/cache/62/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-30 13:47:20 INFO     
         MAE       RMSE
1   2.358956   8.244007
2   2.456604   8.389101
3   2.612338   9.149607
4   2.767368   9.771390
5   2.939622  10.512023
6   3.001518  11.049467
7   3.030400  11.553320
8   3.077859  11.984326
9   3.109704  12.224664
10  3.149710  12.390594
11  3.188781  12.474319
12  3.348340  12.856530
2024-04-30 13:47:20 INFO     ----------------------------------------------------------------------------
2024-04-30 13:47:20 INFO     # 3, Kownledge Graph Embedding: RandomE, Experiment ids: 63
2024-04-30 13:47:20 INFO     ----------------------------------------------------------------------------
2024-04-30 13:47:20 INFO     Log directory: ./libcity/log
2024-04-30 13:47:20 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=63
2024-04-30 13:47:20 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 356778723, 'exp_id': 63, 'load_external': True, 'embedding_model': 'RandomE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 13:47:20 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 13:47:20 INFO     set_weight_link_or_dist: dist
2024-04-30 13:47:20 INFO     init_weight_inf_or_zero: inf
2024-04-30 13:47:20 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 13:47:20 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 13:47:20 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 13:47:20 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 13:47:22 INFO     Dataset created
2024-04-30 13:47:22 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 13:47:22 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 13:47:22 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 13:47:22 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 13:47:22 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 13:47:22 INFO     NoneScaler
2024-04-30 13:47:24 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 13:47:24 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 13:47:24 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 13:47:24 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 13:47:24 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 13:47:24 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 13:47:24 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 13:47:24 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 13:47:24 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 13:47:24 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 13:47:24 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 13:47:24 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 13:47:24 INFO     Total parameter numbers: 874010
2024-04-30 13:47:24 INFO     You select `adam` optimizer.
2024-04-30 13:47:24 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 13:47:24 INFO     Start training ...
2024-04-30 13:47:24 INFO     num_batches:48
2024-04-30 13:47:29 INFO     epoch complete!
2024-04-30 13:47:29 INFO     evaluating now!
2024-04-30 13:47:29 INFO     Epoch [0/200] train_loss: 23.3033, val_loss: 16.9743, lr: 0.003000, 5.41s
2024-04-30 13:47:29 INFO     Saved model at 0
2024-04-30 13:47:29 INFO     Val loss decrease from inf to 16.9743, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 13:47:34 INFO     epoch complete!
2024-04-30 13:47:34 INFO     evaluating now!
2024-04-30 13:47:35 INFO     Epoch [1/200] train_loss: 13.1841, val_loss: 11.9581, lr: 0.003000, 5.27s
2024-04-30 13:47:35 INFO     Saved model at 1
2024-04-30 13:47:35 INFO     Val loss decrease from 16.9743 to 11.9581, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 13:47:40 INFO     epoch complete!
2024-04-30 13:47:40 INFO     evaluating now!
2024-04-30 13:47:40 INFO     Epoch [2/200] train_loss: 9.9760, val_loss: 9.0814, lr: 0.003000, 5.54s
2024-04-30 13:47:40 INFO     Saved model at 2
2024-04-30 13:47:40 INFO     Val loss decrease from 11.9581 to 9.0814, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 13:47:45 INFO     epoch complete!
2024-04-30 13:47:45 INFO     evaluating now!
2024-04-30 13:47:46 INFO     Epoch [3/200] train_loss: 8.2008, val_loss: 7.6421, lr: 0.003000, 5.52s
2024-04-30 13:47:46 INFO     Saved model at 3
2024-04-30 13:47:46 INFO     Val loss decrease from 9.0814 to 7.6421, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 13:47:51 INFO     epoch complete!
2024-04-30 13:47:51 INFO     evaluating now!
2024-04-30 13:47:51 INFO     Epoch [4/200] train_loss: 7.3517, val_loss: 7.1257, lr: 0.003000, 5.50s
2024-04-30 13:47:51 INFO     Saved model at 4
2024-04-30 13:47:51 INFO     Val loss decrease from 7.6421 to 7.1257, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 13:47:56 INFO     epoch complete!
2024-04-30 13:47:56 INFO     evaluating now!
2024-04-30 13:47:57 INFO     Epoch [5/200] train_loss: 6.7186, val_loss: 6.4556, lr: 0.003000, 5.27s
2024-04-30 13:47:57 INFO     Saved model at 5
2024-04-30 13:47:57 INFO     Val loss decrease from 7.1257 to 6.4556, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 13:48:02 INFO     epoch complete!
2024-04-30 13:48:02 INFO     evaluating now!
2024-04-30 13:48:02 INFO     Epoch [6/200] train_loss: 6.2570, val_loss: 6.1772, lr: 0.003000, 5.35s
2024-04-30 13:48:02 INFO     Saved model at 6
2024-04-30 13:48:02 INFO     Val loss decrease from 6.4556 to 6.1772, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 13:48:07 INFO     epoch complete!
2024-04-30 13:48:07 INFO     evaluating now!
2024-04-30 13:48:07 INFO     Epoch [7/200] train_loss: 6.0047, val_loss: 6.0450, lr: 0.003000, 5.17s
2024-04-30 13:48:07 INFO     Saved model at 7
2024-04-30 13:48:07 INFO     Val loss decrease from 6.1772 to 6.0450, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 13:48:12 INFO     epoch complete!
2024-04-30 13:48:12 INFO     evaluating now!
2024-04-30 13:48:12 INFO     Epoch [8/200] train_loss: 5.7253, val_loss: 5.7637, lr: 0.003000, 5.30s
2024-04-30 13:48:12 INFO     Saved model at 8
2024-04-30 13:48:12 INFO     Val loss decrease from 6.0450 to 5.7637, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 13:48:17 INFO     epoch complete!
2024-04-30 13:48:17 INFO     evaluating now!
2024-04-30 13:48:18 INFO     Epoch [9/200] train_loss: 5.5438, val_loss: 5.6416, lr: 0.003000, 5.21s
2024-04-30 13:48:18 INFO     Saved model at 9
2024-04-30 13:48:18 INFO     Val loss decrease from 5.7637 to 5.6416, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 13:48:23 INFO     epoch complete!
2024-04-30 13:48:23 INFO     evaluating now!
2024-04-30 13:48:23 INFO     Epoch [10/200] train_loss: 5.3910, val_loss: 5.5799, lr: 0.003000, 5.19s
2024-04-30 13:48:23 INFO     Saved model at 10
2024-04-30 13:48:23 INFO     Val loss decrease from 5.6416 to 5.5799, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 13:48:28 INFO     epoch complete!
2024-04-30 13:48:28 INFO     evaluating now!
2024-04-30 13:48:28 INFO     Epoch [11/200] train_loss: 5.2083, val_loss: 5.4314, lr: 0.003000, 5.17s
2024-04-30 13:48:28 INFO     Saved model at 11
2024-04-30 13:48:28 INFO     Val loss decrease from 5.5799 to 5.4314, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 13:48:33 INFO     epoch complete!
2024-04-30 13:48:33 INFO     evaluating now!
2024-04-30 13:48:33 INFO     Epoch [12/200] train_loss: 5.1691, val_loss: 5.5551, lr: 0.003000, 5.32s
2024-04-30 13:48:38 INFO     epoch complete!
2024-04-30 13:48:38 INFO     evaluating now!
2024-04-30 13:48:39 INFO     Epoch [13/200] train_loss: 5.0822, val_loss: 5.5157, lr: 0.003000, 5.34s
2024-04-30 13:48:44 INFO     epoch complete!
2024-04-30 13:48:44 INFO     evaluating now!
2024-04-30 13:48:44 INFO     Epoch [14/200] train_loss: 4.9709, val_loss: 5.5854, lr: 0.003000, 5.26s
2024-04-30 13:48:49 INFO     epoch complete!
2024-04-30 13:48:49 INFO     evaluating now!
2024-04-30 13:48:50 INFO     Epoch [15/200] train_loss: 4.8262, val_loss: 5.2630, lr: 0.003000, 5.52s
2024-04-30 13:48:50 INFO     Saved model at 15
2024-04-30 13:48:50 INFO     Val loss decrease from 5.4314 to 5.2630, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 13:48:54 INFO     epoch complete!
2024-04-30 13:48:54 INFO     evaluating now!
2024-04-30 13:48:55 INFO     Epoch [16/200] train_loss: 4.7785, val_loss: 5.2284, lr: 0.003000, 5.16s
2024-04-30 13:48:55 INFO     Saved model at 16
2024-04-30 13:48:55 INFO     Val loss decrease from 5.2630 to 5.2284, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 13:49:00 INFO     epoch complete!
2024-04-30 13:49:00 INFO     evaluating now!
2024-04-30 13:49:00 INFO     Epoch [17/200] train_loss: 4.6692, val_loss: 5.3963, lr: 0.003000, 5.31s
2024-04-30 13:49:05 INFO     epoch complete!
2024-04-30 13:49:05 INFO     evaluating now!
2024-04-30 13:49:05 INFO     Epoch [18/200] train_loss: 4.6134, val_loss: 5.2960, lr: 0.003000, 5.26s
2024-04-30 13:49:10 INFO     epoch complete!
2024-04-30 13:49:10 INFO     evaluating now!
2024-04-30 13:49:11 INFO     Epoch [19/200] train_loss: 4.6088, val_loss: 5.2268, lr: 0.003000, 5.51s
2024-04-30 13:49:11 INFO     Saved model at 19
2024-04-30 13:49:11 INFO     Val loss decrease from 5.2284 to 5.2268, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 13:49:16 INFO     epoch complete!
2024-04-30 13:49:16 INFO     evaluating now!
2024-04-30 13:49:16 INFO     Epoch [20/200] train_loss: 4.4988, val_loss: 5.4247, lr: 0.003000, 5.28s
2024-04-30 13:49:21 INFO     epoch complete!
2024-04-30 13:49:21 INFO     evaluating now!
2024-04-30 13:49:21 INFO     Epoch [21/200] train_loss: 4.4348, val_loss: 5.1203, lr: 0.003000, 5.38s
2024-04-30 13:49:21 INFO     Saved model at 21
2024-04-30 13:49:21 INFO     Val loss decrease from 5.2268 to 5.1203, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-30 13:49:27 INFO     epoch complete!
2024-04-30 13:49:27 INFO     evaluating now!
2024-04-30 13:49:27 INFO     Epoch [22/200] train_loss: 4.4054, val_loss: 5.0565, lr: 0.003000, 5.53s
2024-04-30 13:49:27 INFO     Saved model at 22
2024-04-30 13:49:27 INFO     Val loss decrease from 5.1203 to 5.0565, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-30 13:49:32 INFO     epoch complete!
2024-04-30 13:49:32 INFO     evaluating now!
2024-04-30 13:49:33 INFO     Epoch [23/200] train_loss: 4.3370, val_loss: 5.2477, lr: 0.003000, 5.55s
2024-04-30 13:49:38 INFO     epoch complete!
2024-04-30 13:49:38 INFO     evaluating now!
2024-04-30 13:49:38 INFO     Epoch [24/200] train_loss: 4.2902, val_loss: 5.2373, lr: 0.003000, 5.45s
2024-04-30 13:49:43 INFO     epoch complete!
2024-04-30 13:49:43 INFO     evaluating now!
2024-04-30 13:49:44 INFO     Epoch [25/200] train_loss: 4.2352, val_loss: 5.1317, lr: 0.003000, 5.70s
2024-04-30 13:49:49 INFO     epoch complete!
2024-04-30 13:49:49 INFO     evaluating now!
2024-04-30 13:49:49 INFO     Epoch [26/200] train_loss: 4.2489, val_loss: 5.2111, lr: 0.003000, 5.36s
2024-04-30 13:49:54 INFO     epoch complete!
2024-04-30 13:49:54 INFO     evaluating now!
2024-04-30 13:49:54 INFO     Epoch [27/200] train_loss: 4.2203, val_loss: 4.9912, lr: 0.003000, 5.34s
2024-04-30 13:49:54 INFO     Saved model at 27
2024-04-30 13:49:54 INFO     Val loss decrease from 5.0565 to 4.9912, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-30 13:49:59 INFO     epoch complete!
2024-04-30 13:49:59 INFO     evaluating now!
2024-04-30 13:50:00 INFO     Epoch [28/200] train_loss: 4.1585, val_loss: 5.0167, lr: 0.003000, 5.34s
2024-04-30 13:50:05 INFO     epoch complete!
2024-04-30 13:50:05 INFO     evaluating now!
2024-04-30 13:50:05 INFO     Epoch [29/200] train_loss: 4.1063, val_loss: 5.1309, lr: 0.003000, 5.39s
2024-04-30 13:50:10 INFO     epoch complete!
2024-04-30 13:50:10 INFO     evaluating now!
2024-04-30 13:50:11 INFO     Epoch [30/200] train_loss: 4.0760, val_loss: 5.1630, lr: 0.003000, 5.44s
2024-04-30 13:50:16 INFO     epoch complete!
2024-04-30 13:50:16 INFO     evaluating now!
2024-04-30 13:50:16 INFO     Epoch [31/200] train_loss: 4.0344, val_loss: 5.0969, lr: 0.003000, 5.40s
2024-04-30 13:50:21 INFO     epoch complete!
2024-04-30 13:50:21 INFO     evaluating now!
2024-04-30 13:50:21 INFO     Epoch [32/200] train_loss: 3.9823, val_loss: 5.1096, lr: 0.003000, 5.41s
2024-04-30 13:50:26 INFO     epoch complete!
2024-04-30 13:50:26 INFO     evaluating now!
2024-04-30 13:50:27 INFO     Epoch [33/200] train_loss: 3.9990, val_loss: 5.3164, lr: 0.003000, 5.24s
2024-04-30 13:50:32 INFO     epoch complete!
2024-04-30 13:50:32 INFO     evaluating now!
2024-04-30 13:50:32 INFO     Epoch [34/200] train_loss: 3.9904, val_loss: 5.1746, lr: 0.003000, 5.28s
2024-04-30 13:50:37 INFO     epoch complete!
2024-04-30 13:50:37 INFO     evaluating now!
2024-04-30 13:50:37 INFO     Epoch [35/200] train_loss: 3.9496, val_loss: 4.8998, lr: 0.003000, 5.25s
2024-04-30 13:50:37 INFO     Saved model at 35
2024-04-30 13:50:37 INFO     Val loss decrease from 4.9912 to 4.8998, saving to ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-04-30 13:50:42 INFO     epoch complete!
2024-04-30 13:50:42 INFO     evaluating now!
2024-04-30 13:50:43 INFO     Epoch [36/200] train_loss: 3.9135, val_loss: 5.0976, lr: 0.003000, 5.38s
2024-04-30 13:50:47 INFO     epoch complete!
2024-04-30 13:50:47 INFO     evaluating now!
2024-04-30 13:50:48 INFO     Epoch [37/200] train_loss: 3.8905, val_loss: 5.0971, lr: 0.003000, 5.18s
2024-04-30 13:50:53 INFO     epoch complete!
2024-04-30 13:50:53 INFO     evaluating now!
2024-04-30 13:50:53 INFO     Epoch [38/200] train_loss: 3.9123, val_loss: 5.0761, lr: 0.003000, 5.31s
2024-04-30 13:50:58 INFO     epoch complete!
2024-04-30 13:50:58 INFO     evaluating now!
2024-04-30 13:50:58 INFO     Epoch [39/200] train_loss: 3.8289, val_loss: 5.1901, lr: 0.003000, 5.19s
2024-04-30 13:51:03 INFO     epoch complete!
2024-04-30 13:51:03 INFO     evaluating now!
2024-04-30 13:51:04 INFO     Epoch [40/200] train_loss: 3.8206, val_loss: 5.0720, lr: 0.003000, 5.33s
2024-04-30 13:51:09 INFO     epoch complete!
2024-04-30 13:51:09 INFO     evaluating now!
2024-04-30 13:51:09 INFO     Epoch [41/200] train_loss: 3.7459, val_loss: 5.0230, lr: 0.003000, 5.23s
2024-04-30 13:51:14 INFO     epoch complete!
2024-04-30 13:51:14 INFO     evaluating now!
2024-04-30 13:51:14 INFO     Epoch [42/200] train_loss: 3.7105, val_loss: 5.1553, lr: 0.003000, 5.31s
2024-04-30 13:51:19 INFO     epoch complete!
2024-04-30 13:51:19 INFO     evaluating now!
2024-04-30 13:51:19 INFO     Epoch [43/200] train_loss: 3.7312, val_loss: 5.0373, lr: 0.003000, 5.29s
2024-04-30 13:51:24 INFO     epoch complete!
2024-04-30 13:51:24 INFO     evaluating now!
2024-04-30 13:51:25 INFO     Epoch [44/200] train_loss: 3.7341, val_loss: 5.0575, lr: 0.003000, 5.36s
2024-04-30 13:51:30 INFO     epoch complete!
2024-04-30 13:51:30 INFO     evaluating now!
2024-04-30 13:51:30 INFO     Epoch [45/200] train_loss: 3.7131, val_loss: 5.1213, lr: 0.003000, 5.29s
2024-04-30 13:51:35 INFO     epoch complete!
2024-04-30 13:51:35 INFO     evaluating now!
2024-04-30 13:51:35 INFO     Epoch [46/200] train_loss: 3.6727, val_loss: 4.9980, lr: 0.003000, 5.42s
2024-04-30 13:51:41 INFO     epoch complete!
2024-04-30 13:51:41 INFO     evaluating now!
2024-04-30 13:51:41 INFO     Epoch [47/200] train_loss: 3.6529, val_loss: 5.0809, lr: 0.003000, 5.40s
2024-04-30 13:51:46 INFO     epoch complete!
2024-04-30 13:51:46 INFO     evaluating now!
2024-04-30 13:51:47 INFO     Epoch [48/200] train_loss: 3.6729, val_loss: 5.0043, lr: 0.003000, 5.73s
2024-04-30 13:51:52 INFO     epoch complete!
2024-04-30 13:51:52 INFO     evaluating now!
2024-04-30 13:51:52 INFO     Epoch [49/200] train_loss: 3.6216, val_loss: 4.9572, lr: 0.003000, 5.51s
2024-04-30 13:51:57 INFO     epoch complete!
2024-04-30 13:51:57 INFO     evaluating now!
2024-04-30 13:51:57 INFO     Epoch [50/200] train_loss: 3.6505, val_loss: 5.0284, lr: 0.003000, 5.28s
2024-04-30 13:51:57 WARNING  Early stopping at epoch: 50
2024-04-30 13:51:57 INFO     Trained totally 51 epochs, average train time is 5.023s, average eval time is 0.331s
2024-04-30 13:51:57 INFO     Loaded model at 35
2024-04-30 13:51:57 INFO     Saved model at ./libcity/cache/63/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 13:51:57 INFO     Start evaluating ...
2024-04-30 13:51:59 INFO     Note that you select the single mode to evaluate!
2024-04-30 13:51:59 INFO     Evaluate result is saved at ./libcity/cache/63/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-30 13:51:59 INFO     
         MAE       RMSE
1   2.301378   7.012411
2   2.380831   7.648026
3   2.584703   8.839448
4   2.844681   9.956094
5   2.934685  10.950421
6   3.071083  11.764246
7   3.127645  12.435740
8   3.147113  12.832911
9   3.226073  13.220431
10  3.301084  13.482250
11  3.351990  13.910652
12  3.448333  14.462047
2024-04-30 13:51:59 INFO     ----------------------------------------------------------------------------
2024-04-30 13:51:59 INFO     # 4, Kownledge Graph Embedding: RandomE, Experiment ids: 64
2024-04-30 13:51:59 INFO     ----------------------------------------------------------------------------
2024-04-30 13:51:59 INFO     Log directory: ./libcity/log
2024-04-30 13:51:59 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=64
2024-04-30 13:51:59 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 861339244, 'exp_id': 64, 'load_external': True, 'embedding_model': 'RandomE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 13:51:59 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 13:51:59 INFO     set_weight_link_or_dist: dist
2024-04-30 13:51:59 INFO     init_weight_inf_or_zero: inf
2024-04-30 13:51:59 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 13:51:59 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 13:51:59 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 13:51:59 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 13:52:00 INFO     Dataset created
2024-04-30 13:52:00 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 13:52:01 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 13:52:01 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 13:52:01 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 13:52:01 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 13:52:01 INFO     NoneScaler
2024-04-30 13:52:02 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 13:52:02 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 13:52:02 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 13:52:02 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 13:52:02 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 13:52:02 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 13:52:02 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 13:52:02 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 13:52:02 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 13:52:02 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 13:52:02 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 13:52:02 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 13:52:02 INFO     Total parameter numbers: 874010
2024-04-30 13:52:02 INFO     You select `adam` optimizer.
2024-04-30 13:52:02 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 13:52:02 INFO     Start training ...
2024-04-30 13:52:02 INFO     num_batches:48
2024-04-30 13:52:07 INFO     epoch complete!
2024-04-30 13:52:07 INFO     evaluating now!
2024-04-30 13:52:08 INFO     Epoch [0/200] train_loss: 25.7553, val_loss: 17.8452, lr: 0.003000, 5.50s
2024-04-30 13:52:08 INFO     Saved model at 0
2024-04-30 13:52:08 INFO     Val loss decrease from inf to 17.8452, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 13:52:13 INFO     epoch complete!
2024-04-30 13:52:13 INFO     evaluating now!
2024-04-30 13:52:13 INFO     Epoch [1/200] train_loss: 14.6429, val_loss: 13.7092, lr: 0.003000, 5.18s
2024-04-30 13:52:13 INFO     Saved model at 1
2024-04-30 13:52:13 INFO     Val loss decrease from 17.8452 to 13.7092, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 13:52:18 INFO     epoch complete!
2024-04-30 13:52:18 INFO     evaluating now!
2024-04-30 13:52:18 INFO     Epoch [2/200] train_loss: 11.0693, val_loss: 10.1163, lr: 0.003000, 5.38s
2024-04-30 13:52:18 INFO     Saved model at 2
2024-04-30 13:52:18 INFO     Val loss decrease from 13.7092 to 10.1163, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 13:52:23 INFO     epoch complete!
2024-04-30 13:52:23 INFO     evaluating now!
2024-04-30 13:52:24 INFO     Epoch [3/200] train_loss: 8.8199, val_loss: 8.3338, lr: 0.003000, 5.36s
2024-04-30 13:52:24 INFO     Saved model at 3
2024-04-30 13:52:24 INFO     Val loss decrease from 10.1163 to 8.3338, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 13:52:29 INFO     epoch complete!
2024-04-30 13:52:29 INFO     evaluating now!
2024-04-30 13:52:29 INFO     Epoch [4/200] train_loss: 7.8022, val_loss: 7.3965, lr: 0.003000, 5.35s
2024-04-30 13:52:29 INFO     Saved model at 4
2024-04-30 13:52:29 INFO     Val loss decrease from 8.3338 to 7.3965, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 13:52:34 INFO     epoch complete!
2024-04-30 13:52:34 INFO     evaluating now!
2024-04-30 13:52:34 INFO     Epoch [5/200] train_loss: 7.0418, val_loss: 6.7413, lr: 0.003000, 5.28s
2024-04-30 13:52:34 INFO     Saved model at 5
2024-04-30 13:52:34 INFO     Val loss decrease from 7.3965 to 6.7413, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 13:52:39 INFO     epoch complete!
2024-04-30 13:52:39 INFO     evaluating now!
2024-04-30 13:52:40 INFO     Epoch [6/200] train_loss: 6.6157, val_loss: 6.4332, lr: 0.003000, 5.22s
2024-04-30 13:52:40 INFO     Saved model at 6
2024-04-30 13:52:40 INFO     Val loss decrease from 6.7413 to 6.4332, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 13:52:45 INFO     epoch complete!
2024-04-30 13:52:45 INFO     evaluating now!
2024-04-30 13:52:45 INFO     Epoch [7/200] train_loss: 6.2604, val_loss: 6.2132, lr: 0.003000, 5.22s
2024-04-30 13:52:45 INFO     Saved model at 7
2024-04-30 13:52:45 INFO     Val loss decrease from 6.4332 to 6.2132, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 13:52:50 INFO     epoch complete!
2024-04-30 13:52:50 INFO     evaluating now!
2024-04-30 13:52:50 INFO     Epoch [8/200] train_loss: 6.0588, val_loss: 6.0614, lr: 0.003000, 5.21s
2024-04-30 13:52:50 INFO     Saved model at 8
2024-04-30 13:52:50 INFO     Val loss decrease from 6.2132 to 6.0614, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 13:52:55 INFO     epoch complete!
2024-04-30 13:52:55 INFO     evaluating now!
2024-04-30 13:52:55 INFO     Epoch [9/200] train_loss: 5.7737, val_loss: 5.8112, lr: 0.003000, 5.32s
2024-04-30 13:52:55 INFO     Saved model at 9
2024-04-30 13:52:55 INFO     Val loss decrease from 6.0614 to 5.8112, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 13:53:00 INFO     epoch complete!
2024-04-30 13:53:00 INFO     evaluating now!
2024-04-30 13:53:01 INFO     Epoch [10/200] train_loss: 5.5944, val_loss: 5.7126, lr: 0.003000, 5.18s
2024-04-30 13:53:01 INFO     Saved model at 10
2024-04-30 13:53:01 INFO     Val loss decrease from 5.8112 to 5.7126, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 13:53:06 INFO     epoch complete!
2024-04-30 13:53:06 INFO     evaluating now!
2024-04-30 13:53:06 INFO     Epoch [11/200] train_loss: 5.4443, val_loss: 5.7148, lr: 0.003000, 5.24s
2024-04-30 13:53:11 INFO     epoch complete!
2024-04-30 13:53:11 INFO     evaluating now!
2024-04-30 13:53:11 INFO     Epoch [12/200] train_loss: 5.3293, val_loss: 5.6139, lr: 0.003000, 5.19s
2024-04-30 13:53:11 INFO     Saved model at 12
2024-04-30 13:53:11 INFO     Val loss decrease from 5.7126 to 5.6139, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 13:53:16 INFO     epoch complete!
2024-04-30 13:53:16 INFO     evaluating now!
2024-04-30 13:53:16 INFO     Epoch [13/200] train_loss: 5.1830, val_loss: 5.5727, lr: 0.003000, 5.18s
2024-04-30 13:53:16 INFO     Saved model at 13
2024-04-30 13:53:16 INFO     Val loss decrease from 5.6139 to 5.5727, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 13:53:21 INFO     epoch complete!
2024-04-30 13:53:21 INFO     evaluating now!
2024-04-30 13:53:22 INFO     Epoch [14/200] train_loss: 5.1097, val_loss: 5.2621, lr: 0.003000, 5.35s
2024-04-30 13:53:22 INFO     Saved model at 14
2024-04-30 13:53:22 INFO     Val loss decrease from 5.5727 to 5.2621, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 13:53:26 INFO     epoch complete!
2024-04-30 13:53:26 INFO     evaluating now!
2024-04-30 13:53:27 INFO     Epoch [15/200] train_loss: 5.0361, val_loss: 5.3328, lr: 0.003000, 5.20s
2024-04-30 13:53:32 INFO     epoch complete!
2024-04-30 13:53:32 INFO     evaluating now!
2024-04-30 13:53:32 INFO     Epoch [16/200] train_loss: 4.8962, val_loss: 5.2524, lr: 0.003000, 5.38s
2024-04-30 13:53:32 INFO     Saved model at 16
2024-04-30 13:53:32 INFO     Val loss decrease from 5.2621 to 5.2524, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 13:53:37 INFO     epoch complete!
2024-04-30 13:53:37 INFO     evaluating now!
2024-04-30 13:53:37 INFO     Epoch [17/200] train_loss: 4.8553, val_loss: 5.2408, lr: 0.003000, 5.25s
2024-04-30 13:53:37 INFO     Saved model at 17
2024-04-30 13:53:37 INFO     Val loss decrease from 5.2524 to 5.2408, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 13:53:42 INFO     epoch complete!
2024-04-30 13:53:42 INFO     evaluating now!
2024-04-30 13:53:43 INFO     Epoch [18/200] train_loss: 4.7024, val_loss: 5.2960, lr: 0.003000, 5.28s
2024-04-30 13:53:48 INFO     epoch complete!
2024-04-30 13:53:48 INFO     evaluating now!
2024-04-30 13:53:48 INFO     Epoch [19/200] train_loss: 4.6448, val_loss: 5.1879, lr: 0.003000, 5.60s
2024-04-30 13:53:48 INFO     Saved model at 19
2024-04-30 13:53:48 INFO     Val loss decrease from 5.2408 to 5.1879, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 13:53:53 INFO     epoch complete!
2024-04-30 13:53:53 INFO     evaluating now!
2024-04-30 13:53:54 INFO     Epoch [20/200] train_loss: 4.6554, val_loss: 5.3300, lr: 0.003000, 5.28s
2024-04-30 13:53:59 INFO     epoch complete!
2024-04-30 13:53:59 INFO     evaluating now!
2024-04-30 13:53:59 INFO     Epoch [21/200] train_loss: 4.5827, val_loss: 5.5254, lr: 0.003000, 5.18s
2024-04-30 13:54:04 INFO     epoch complete!
2024-04-30 13:54:04 INFO     evaluating now!
2024-04-30 13:54:04 INFO     Epoch [22/200] train_loss: 4.5774, val_loss: 5.0595, lr: 0.003000, 5.31s
2024-04-30 13:54:04 INFO     Saved model at 22
2024-04-30 13:54:04 INFO     Val loss decrease from 5.1879 to 5.0595, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-30 13:54:09 INFO     epoch complete!
2024-04-30 13:54:09 INFO     evaluating now!
2024-04-30 13:54:09 INFO     Epoch [23/200] train_loss: 4.4496, val_loss: 4.9836, lr: 0.003000, 5.18s
2024-04-30 13:54:09 INFO     Saved model at 23
2024-04-30 13:54:09 INFO     Val loss decrease from 5.0595 to 4.9836, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-30 13:54:14 INFO     epoch complete!
2024-04-30 13:54:14 INFO     evaluating now!
2024-04-30 13:54:15 INFO     Epoch [24/200] train_loss: 4.4906, val_loss: 5.0728, lr: 0.003000, 5.18s
2024-04-30 13:54:20 INFO     epoch complete!
2024-04-30 13:54:20 INFO     evaluating now!
2024-04-30 13:54:20 INFO     Epoch [25/200] train_loss: 4.3672, val_loss: 5.0255, lr: 0.003000, 5.36s
2024-04-30 13:54:25 INFO     epoch complete!
2024-04-30 13:54:25 INFO     evaluating now!
2024-04-30 13:54:25 INFO     Epoch [26/200] train_loss: 4.3205, val_loss: 5.1157, lr: 0.003000, 5.44s
2024-04-30 13:54:30 INFO     epoch complete!
2024-04-30 13:54:30 INFO     evaluating now!
2024-04-30 13:54:31 INFO     Epoch [27/200] train_loss: 4.2893, val_loss: 5.0476, lr: 0.003000, 5.33s
2024-04-30 13:54:36 INFO     epoch complete!
2024-04-30 13:54:36 INFO     evaluating now!
2024-04-30 13:54:36 INFO     Epoch [28/200] train_loss: 4.2461, val_loss: 4.9864, lr: 0.003000, 5.32s
2024-04-30 13:54:41 INFO     epoch complete!
2024-04-30 13:54:41 INFO     evaluating now!
2024-04-30 13:54:41 INFO     Epoch [29/200] train_loss: 4.2191, val_loss: 5.0418, lr: 0.003000, 5.23s
2024-04-30 13:54:46 INFO     epoch complete!
2024-04-30 13:54:46 INFO     evaluating now!
2024-04-30 13:54:46 INFO     Epoch [30/200] train_loss: 4.1891, val_loss: 5.1414, lr: 0.003000, 5.19s
2024-04-30 13:54:51 INFO     epoch complete!
2024-04-30 13:54:51 INFO     evaluating now!
2024-04-30 13:54:52 INFO     Epoch [31/200] train_loss: 4.1543, val_loss: 5.1197, lr: 0.003000, 5.43s
2024-04-30 13:54:57 INFO     epoch complete!
2024-04-30 13:54:57 INFO     evaluating now!
2024-04-30 13:54:57 INFO     Epoch [32/200] train_loss: 4.1024, val_loss: 4.9585, lr: 0.003000, 5.26s
2024-04-30 13:54:57 INFO     Saved model at 32
2024-04-30 13:54:57 INFO     Val loss decrease from 4.9836 to 4.9585, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-04-30 13:55:02 INFO     epoch complete!
2024-04-30 13:55:02 INFO     evaluating now!
2024-04-30 13:55:02 INFO     Epoch [33/200] train_loss: 4.0924, val_loss: 5.0005, lr: 0.003000, 5.37s
2024-04-30 13:55:07 INFO     epoch complete!
2024-04-30 13:55:07 INFO     evaluating now!
2024-04-30 13:55:08 INFO     Epoch [34/200] train_loss: 4.0441, val_loss: 5.2202, lr: 0.003000, 5.20s
2024-04-30 13:55:13 INFO     epoch complete!
2024-04-30 13:55:13 INFO     evaluating now!
2024-04-30 13:55:13 INFO     Epoch [35/200] train_loss: 4.0206, val_loss: 5.1102, lr: 0.003000, 5.26s
2024-04-30 13:55:18 INFO     epoch complete!
2024-04-30 13:55:18 INFO     evaluating now!
2024-04-30 13:55:18 INFO     Epoch [36/200] train_loss: 3.9921, val_loss: 5.0658, lr: 0.003000, 5.24s
2024-04-30 13:55:23 INFO     epoch complete!
2024-04-30 13:55:23 INFO     evaluating now!
2024-04-30 13:55:23 INFO     Epoch [37/200] train_loss: 3.9566, val_loss: 5.0747, lr: 0.003000, 5.24s
2024-04-30 13:55:28 INFO     epoch complete!
2024-04-30 13:55:28 INFO     evaluating now!
2024-04-30 13:55:29 INFO     Epoch [38/200] train_loss: 3.9387, val_loss: 5.0504, lr: 0.003000, 5.33s
2024-04-30 13:55:34 INFO     epoch complete!
2024-04-30 13:55:34 INFO     evaluating now!
2024-04-30 13:55:34 INFO     Epoch [39/200] train_loss: 3.8835, val_loss: 5.1756, lr: 0.003000, 5.42s
2024-04-30 13:55:39 INFO     epoch complete!
2024-04-30 13:55:39 INFO     evaluating now!
2024-04-30 13:55:39 INFO     Epoch [40/200] train_loss: 3.8607, val_loss: 4.9411, lr: 0.003000, 5.26s
2024-04-30 13:55:39 INFO     Saved model at 40
2024-04-30 13:55:39 INFO     Val loss decrease from 4.9585 to 4.9411, saving to ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-04-30 13:55:44 INFO     epoch complete!
2024-04-30 13:55:44 INFO     evaluating now!
2024-04-30 13:55:45 INFO     Epoch [41/200] train_loss: 3.8617, val_loss: 5.1295, lr: 0.003000, 5.34s
2024-04-30 13:55:50 INFO     epoch complete!
2024-04-30 13:55:50 INFO     evaluating now!
2024-04-30 13:55:50 INFO     Epoch [42/200] train_loss: 3.8492, val_loss: 5.1279, lr: 0.003000, 5.25s
2024-04-30 13:55:55 INFO     epoch complete!
2024-04-30 13:55:55 INFO     evaluating now!
2024-04-30 13:55:55 INFO     Epoch [43/200] train_loss: 3.8059, val_loss: 5.0498, lr: 0.003000, 5.21s
2024-04-30 13:56:00 INFO     epoch complete!
2024-04-30 13:56:00 INFO     evaluating now!
2024-04-30 13:56:00 INFO     Epoch [44/200] train_loss: 3.7883, val_loss: 4.9662, lr: 0.003000, 5.19s
2024-04-30 13:56:05 INFO     epoch complete!
2024-04-30 13:56:05 INFO     evaluating now!
2024-04-30 13:56:06 INFO     Epoch [45/200] train_loss: 3.7545, val_loss: 5.0079, lr: 0.003000, 5.31s
2024-04-30 13:56:11 INFO     epoch complete!
2024-04-30 13:56:11 INFO     evaluating now!
2024-04-30 13:56:11 INFO     Epoch [46/200] train_loss: 3.7283, val_loss: 5.1201, lr: 0.003000, 5.31s
2024-04-30 13:56:16 INFO     epoch complete!
2024-04-30 13:56:16 INFO     evaluating now!
2024-04-30 13:56:16 INFO     Epoch [47/200] train_loss: 3.7242, val_loss: 4.9715, lr: 0.003000, 5.15s
2024-04-30 13:56:21 INFO     epoch complete!
2024-04-30 13:56:21 INFO     evaluating now!
2024-04-30 13:56:21 INFO     Epoch [48/200] train_loss: 3.6936, val_loss: 5.0705, lr: 0.003000, 5.21s
2024-04-30 13:56:27 INFO     epoch complete!
2024-04-30 13:56:27 INFO     evaluating now!
2024-04-30 13:56:27 INFO     Epoch [49/200] train_loss: 3.6879, val_loss: 4.9793, lr: 0.003000, 5.50s
2024-04-30 13:56:32 INFO     epoch complete!
2024-04-30 13:56:32 INFO     evaluating now!
2024-04-30 13:56:32 INFO     Epoch [50/200] train_loss: 3.6600, val_loss: 4.9965, lr: 0.003000, 5.39s
2024-04-30 13:56:37 INFO     epoch complete!
2024-04-30 13:56:37 INFO     evaluating now!
2024-04-30 13:56:37 INFO     Epoch [51/200] train_loss: 3.6257, val_loss: 5.1832, lr: 0.003000, 5.15s
2024-04-30 13:56:42 INFO     epoch complete!
2024-04-30 13:56:42 INFO     evaluating now!
2024-04-30 13:56:43 INFO     Epoch [52/200] train_loss: 3.6507, val_loss: 5.1357, lr: 0.003000, 5.17s
2024-04-30 13:56:47 INFO     epoch complete!
2024-04-30 13:56:47 INFO     evaluating now!
2024-04-30 13:56:48 INFO     Epoch [53/200] train_loss: 3.5969, val_loss: 5.1253, lr: 0.003000, 5.15s
2024-04-30 13:56:53 INFO     epoch complete!
2024-04-30 13:56:53 INFO     evaluating now!
2024-04-30 13:56:53 INFO     Epoch [54/200] train_loss: 3.6001, val_loss: 5.0595, lr: 0.003000, 5.16s
2024-04-30 13:56:58 INFO     epoch complete!
2024-04-30 13:56:58 INFO     evaluating now!
2024-04-30 13:56:58 INFO     Epoch [55/200] train_loss: 3.5583, val_loss: 5.1001, lr: 0.003000, 5.15s
2024-04-30 13:56:58 WARNING  Early stopping at epoch: 55
2024-04-30 13:56:58 INFO     Trained totally 56 epochs, average train time is 4.950s, average eval time is 0.326s
2024-04-30 13:56:58 INFO     Loaded model at 40
2024-04-30 13:56:58 INFO     Saved model at ./libcity/cache/64/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 13:56:58 INFO     Start evaluating ...
2024-04-30 13:56:59 INFO     Note that you select the single mode to evaluate!
2024-04-30 13:56:59 INFO     Evaluate result is saved at ./libcity/cache/64/evaluate_cache\AGCRN_CHITaxi20190406.csv
2024-04-30 13:56:59 INFO     
         MAE       RMSE
1   2.324439   7.068739
2   2.406960   7.577626
3   2.645696   8.612447
4   2.859747   9.585836
5   3.012558  10.567939
6   3.109751  11.437161
7   3.180910  12.157609
8   3.213002  12.686480
9   3.234504  12.946233
10  3.290901  13.180164
11  3.287098  13.208997
12  3.428070  13.600412
2024-04-30 13:56:59 INFO     ----------------------------------------------------------------------------
2024-04-30 13:56:59 INFO     Kownledge Graph Embedding: RandomE, Experiment ids: [60, 61, 62, 63, 64]
2024-04-30 13:56:59 INFO     ----------------------------------------------------------------------------
2024-04-30 13:56:59 INFO     Average: 
         MAE       RMSE
0   2.348369   7.350126
1   2.459799   7.915213
2   2.643444   8.888180
3   2.829751   9.760631
4   2.962718  10.702956
5   3.071199  11.550785
6   3.145853  12.314554
7   3.215151  12.844245
8   3.260177  13.062296
9   3.307553  13.176170
10  3.345571  13.317908
11  3.452502  13.692047 
2024-04-30 13:56:59 INFO     Standard deviation: 
         MAE      RMSE
0   0.043893  0.462137
1   0.071354  0.292490
2   0.048967  0.172939
3   0.039962  0.125933
4   0.044114  0.177631
5   0.039665  0.316191
6   0.062876  0.453035
7   0.095536  0.519015
8   0.097251  0.482886
9   0.091480  0.413679
10  0.101677  0.506243
11  0.068751  0.571770
2024-04-30 13:56:59 INFO     ----------------------------------------------------------------------------
2024-04-30 13:56:59 INFO     12 steps Average: 
        MAE       RMSE
0  3.003507  11.214593
2024-04-30 13:56:59 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.067127  0.374496
