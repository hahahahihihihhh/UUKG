2024-04-30 22:21:15 INFO     ----------------------------------------------------------------------------
2024-04-30 22:21:15 INFO     # 0, Kownledge Graph Embedding: AttE, Experiment ids: 45
2024-04-30 22:21:15 INFO     ----------------------------------------------------------------------------
2024-04-30 22:21:15 INFO     Log directory: ./libcity/log
2024-04-30 22:21:15 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=45
2024-04-30 22:21:15 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 537911831, 'exp_id': 45, 'load_external': True, 'embedding_model': 'AttE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 22:21:15 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 22:21:15 INFO     set_weight_link_or_dist: dist
2024-04-30 22:21:15 INFO     init_weight_inf_or_zero: inf
2024-04-30 22:21:15 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 22:21:15 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 22:21:15 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 22:21:16 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 22:21:18 INFO     Dataset created
2024-04-30 22:21:18 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 22:21:18 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 22:21:18 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 22:21:18 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 22:21:18 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 22:21:18 INFO     NoneScaler
2024-04-30 22:21:23 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 22:21:23 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 22:21:23 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 22:21:23 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 22:21:23 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 22:21:23 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 22:21:23 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 22:21:23 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 22:21:23 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 22:21:23 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 22:21:23 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 22:21:23 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 22:21:23 INFO     Total parameter numbers: 874010
2024-04-30 22:21:23 INFO     You select `adam` optimizer.
2024-04-30 22:21:23 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 22:21:23 INFO     Start training ...
2024-04-30 22:21:23 INFO     num_batches:48
2024-04-30 22:21:30 INFO     epoch complete!
2024-04-30 22:21:30 INFO     evaluating now!
2024-04-30 22:21:30 INFO     Epoch [0/200] train_loss: 24.0866, val_loss: 18.3924, lr: 0.003000, 7.47s
2024-04-30 22:21:30 INFO     Saved model at 0
2024-04-30 22:21:30 INFO     Val loss decrease from inf to 18.3924, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 22:21:37 INFO     epoch complete!
2024-04-30 22:21:37 INFO     evaluating now!
2024-04-30 22:21:38 INFO     Epoch [1/200] train_loss: 14.9787, val_loss: 14.4950, lr: 0.003000, 7.10s
2024-04-30 22:21:38 INFO     Saved model at 1
2024-04-30 22:21:38 INFO     Val loss decrease from 18.3924 to 14.4950, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 22:21:44 INFO     epoch complete!
2024-04-30 22:21:44 INFO     evaluating now!
2024-04-30 22:21:45 INFO     Epoch [2/200] train_loss: 12.0128, val_loss: 11.7733, lr: 0.003000, 7.14s
2024-04-30 22:21:45 INFO     Saved model at 2
2024-04-30 22:21:45 INFO     Val loss decrease from 14.4950 to 11.7733, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 22:21:51 INFO     epoch complete!
2024-04-30 22:21:51 INFO     evaluating now!
2024-04-30 22:21:52 INFO     Epoch [3/200] train_loss: 10.0744, val_loss: 9.7309, lr: 0.003000, 7.18s
2024-04-30 22:21:52 INFO     Saved model at 3
2024-04-30 22:21:52 INFO     Val loss decrease from 11.7733 to 9.7309, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 22:21:59 INFO     epoch complete!
2024-04-30 22:21:59 INFO     evaluating now!
2024-04-30 22:21:59 INFO     Epoch [4/200] train_loss: 8.7806, val_loss: 8.4978, lr: 0.003000, 7.22s
2024-04-30 22:21:59 INFO     Saved model at 4
2024-04-30 22:21:59 INFO     Val loss decrease from 9.7309 to 8.4978, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 22:22:06 INFO     epoch complete!
2024-04-30 22:22:06 INFO     evaluating now!
2024-04-30 22:22:06 INFO     Epoch [5/200] train_loss: 7.7924, val_loss: 7.6443, lr: 0.003000, 6.97s
2024-04-30 22:22:06 INFO     Saved model at 5
2024-04-30 22:22:06 INFO     Val loss decrease from 8.4978 to 7.6443, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 22:22:13 INFO     epoch complete!
2024-04-30 22:22:13 INFO     evaluating now!
2024-04-30 22:22:13 INFO     Epoch [6/200] train_loss: 7.2721, val_loss: 7.4205, lr: 0.003000, 6.84s
2024-04-30 22:22:13 INFO     Saved model at 6
2024-04-30 22:22:13 INFO     Val loss decrease from 7.6443 to 7.4205, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 22:22:19 INFO     epoch complete!
2024-04-30 22:22:19 INFO     evaluating now!
2024-04-30 22:22:20 INFO     Epoch [7/200] train_loss: 6.8319, val_loss: 6.6874, lr: 0.003000, 6.76s
2024-04-30 22:22:20 INFO     Saved model at 7
2024-04-30 22:22:20 INFO     Val loss decrease from 7.4205 to 6.6874, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 22:22:26 INFO     epoch complete!
2024-04-30 22:22:26 INFO     evaluating now!
2024-04-30 22:22:27 INFO     Epoch [8/200] train_loss: 6.4531, val_loss: 6.7371, lr: 0.003000, 6.78s
2024-04-30 22:22:33 INFO     epoch complete!
2024-04-30 22:22:33 INFO     evaluating now!
2024-04-30 22:22:33 INFO     Epoch [9/200] train_loss: 6.3002, val_loss: 6.2890, lr: 0.003000, 6.74s
2024-04-30 22:22:33 INFO     Saved model at 9
2024-04-30 22:22:33 INFO     Val loss decrease from 6.6874 to 6.2890, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 22:22:40 INFO     epoch complete!
2024-04-30 22:22:40 INFO     evaluating now!
2024-04-30 22:22:40 INFO     Epoch [10/200] train_loss: 5.9842, val_loss: 6.2483, lr: 0.003000, 6.75s
2024-04-30 22:22:40 INFO     Saved model at 10
2024-04-30 22:22:40 INFO     Val loss decrease from 6.2890 to 6.2483, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 22:22:47 INFO     epoch complete!
2024-04-30 22:22:47 INFO     evaluating now!
2024-04-30 22:22:47 INFO     Epoch [11/200] train_loss: 5.8052, val_loss: 6.1056, lr: 0.003000, 6.79s
2024-04-30 22:22:47 INFO     Saved model at 11
2024-04-30 22:22:47 INFO     Val loss decrease from 6.2483 to 6.1056, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 22:22:53 INFO     epoch complete!
2024-04-30 22:22:53 INFO     evaluating now!
2024-04-30 22:22:54 INFO     Epoch [12/200] train_loss: 5.6396, val_loss: 5.7083, lr: 0.003000, 6.71s
2024-04-30 22:22:54 INFO     Saved model at 12
2024-04-30 22:22:54 INFO     Val loss decrease from 6.1056 to 5.7083, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 22:23:00 INFO     epoch complete!
2024-04-30 22:23:00 INFO     evaluating now!
2024-04-30 22:23:01 INFO     Epoch [13/200] train_loss: 5.5442, val_loss: 5.8441, lr: 0.003000, 7.08s
2024-04-30 22:23:08 INFO     epoch complete!
2024-04-30 22:23:08 INFO     evaluating now!
2024-04-30 22:23:08 INFO     Epoch [14/200] train_loss: 5.3798, val_loss: 5.6538, lr: 0.003000, 7.39s
2024-04-30 22:23:08 INFO     Saved model at 14
2024-04-30 22:23:08 INFO     Val loss decrease from 5.7083 to 5.6538, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 22:23:15 INFO     epoch complete!
2024-04-30 22:23:15 INFO     evaluating now!
2024-04-30 22:23:15 INFO     Epoch [15/200] train_loss: 5.4089, val_loss: 5.8932, lr: 0.003000, 6.94s
2024-04-30 22:23:22 INFO     epoch complete!
2024-04-30 22:23:22 INFO     evaluating now!
2024-04-30 22:23:22 INFO     Epoch [16/200] train_loss: 5.2534, val_loss: 6.0394, lr: 0.003000, 6.81s
2024-04-30 22:23:29 INFO     epoch complete!
2024-04-30 22:23:29 INFO     evaluating now!
2024-04-30 22:23:29 INFO     Epoch [17/200] train_loss: 5.1436, val_loss: 5.5793, lr: 0.003000, 6.97s
2024-04-30 22:23:29 INFO     Saved model at 17
2024-04-30 22:23:29 INFO     Val loss decrease from 5.6538 to 5.5793, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 22:23:36 INFO     epoch complete!
2024-04-30 22:23:36 INFO     evaluating now!
2024-04-30 22:23:36 INFO     Epoch [18/200] train_loss: 5.0018, val_loss: 5.4976, lr: 0.003000, 7.01s
2024-04-30 22:23:36 INFO     Saved model at 18
2024-04-30 22:23:36 INFO     Val loss decrease from 5.5793 to 5.4976, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 22:23:43 INFO     epoch complete!
2024-04-30 22:23:43 INFO     evaluating now!
2024-04-30 22:23:43 INFO     Epoch [19/200] train_loss: 5.0225, val_loss: 5.5297, lr: 0.003000, 7.13s
2024-04-30 22:23:50 INFO     epoch complete!
2024-04-30 22:23:50 INFO     evaluating now!
2024-04-30 22:23:50 INFO     Epoch [20/200] train_loss: 4.9332, val_loss: 5.5999, lr: 0.003000, 6.93s
2024-04-30 22:23:57 INFO     epoch complete!
2024-04-30 22:23:57 INFO     evaluating now!
2024-04-30 22:23:57 INFO     Epoch [21/200] train_loss: 4.8686, val_loss: 5.4833, lr: 0.003000, 7.10s
2024-04-30 22:23:57 INFO     Saved model at 21
2024-04-30 22:23:57 INFO     Val loss decrease from 5.4976 to 5.4833, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-30 22:24:04 INFO     epoch complete!
2024-04-30 22:24:04 INFO     evaluating now!
2024-04-30 22:24:05 INFO     Epoch [22/200] train_loss: 4.7969, val_loss: 5.2914, lr: 0.003000, 7.08s
2024-04-30 22:24:05 INFO     Saved model at 22
2024-04-30 22:24:05 INFO     Val loss decrease from 5.4833 to 5.2914, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-30 22:24:11 INFO     epoch complete!
2024-04-30 22:24:11 INFO     evaluating now!
2024-04-30 22:24:12 INFO     Epoch [23/200] train_loss: 4.8355, val_loss: 5.3047, lr: 0.003000, 7.06s
2024-04-30 22:24:18 INFO     epoch complete!
2024-04-30 22:24:18 INFO     evaluating now!
2024-04-30 22:24:19 INFO     Epoch [24/200] train_loss: 4.7654, val_loss: 5.4396, lr: 0.003000, 6.97s
2024-04-30 22:24:25 INFO     epoch complete!
2024-04-30 22:24:25 INFO     evaluating now!
2024-04-30 22:24:26 INFO     Epoch [25/200] train_loss: 4.6668, val_loss: 5.3782, lr: 0.003000, 6.98s
2024-04-30 22:24:32 INFO     epoch complete!
2024-04-30 22:24:32 INFO     evaluating now!
2024-04-30 22:24:32 INFO     Epoch [26/200] train_loss: 4.6924, val_loss: 5.2608, lr: 0.003000, 6.87s
2024-04-30 22:24:32 INFO     Saved model at 26
2024-04-30 22:24:32 INFO     Val loss decrease from 5.2914 to 5.2608, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-04-30 22:24:39 INFO     epoch complete!
2024-04-30 22:24:39 INFO     evaluating now!
2024-04-30 22:24:39 INFO     Epoch [27/200] train_loss: 4.5653, val_loss: 5.1903, lr: 0.003000, 6.87s
2024-04-30 22:24:39 INFO     Saved model at 27
2024-04-30 22:24:39 INFO     Val loss decrease from 5.2608 to 5.1903, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-30 22:24:46 INFO     epoch complete!
2024-04-30 22:24:46 INFO     evaluating now!
2024-04-30 22:24:46 INFO     Epoch [28/200] train_loss: 4.5196, val_loss: 5.2974, lr: 0.003000, 6.82s
2024-04-30 22:24:53 INFO     epoch complete!
2024-04-30 22:24:53 INFO     evaluating now!
2024-04-30 22:24:53 INFO     Epoch [29/200] train_loss: 4.4853, val_loss: 5.1135, lr: 0.003000, 6.95s
2024-04-30 22:24:53 INFO     Saved model at 29
2024-04-30 22:24:53 INFO     Val loss decrease from 5.1903 to 5.1135, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-04-30 22:25:00 INFO     epoch complete!
2024-04-30 22:25:00 INFO     evaluating now!
2024-04-30 22:25:00 INFO     Epoch [30/200] train_loss: 4.4271, val_loss: 5.2518, lr: 0.003000, 7.15s
2024-04-30 22:25:07 INFO     epoch complete!
2024-04-30 22:25:07 INFO     evaluating now!
2024-04-30 22:25:07 INFO     Epoch [31/200] train_loss: 4.4200, val_loss: 5.4744, lr: 0.003000, 6.99s
2024-04-30 22:25:14 INFO     epoch complete!
2024-04-30 22:25:14 INFO     evaluating now!
2024-04-30 22:25:14 INFO     Epoch [32/200] train_loss: 4.4173, val_loss: 5.0870, lr: 0.003000, 6.89s
2024-04-30 22:25:14 INFO     Saved model at 32
2024-04-30 22:25:14 INFO     Val loss decrease from 5.1135 to 5.0870, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-04-30 22:25:21 INFO     epoch complete!
2024-04-30 22:25:21 INFO     evaluating now!
2024-04-30 22:25:21 INFO     Epoch [33/200] train_loss: 4.3041, val_loss: 5.1560, lr: 0.003000, 6.94s
2024-04-30 22:25:28 INFO     epoch complete!
2024-04-30 22:25:28 INFO     evaluating now!
2024-04-30 22:25:28 INFO     Epoch [34/200] train_loss: 4.2811, val_loss: 5.1433, lr: 0.003000, 6.87s
2024-04-30 22:25:34 INFO     epoch complete!
2024-04-30 22:25:34 INFO     evaluating now!
2024-04-30 22:25:35 INFO     Epoch [35/200] train_loss: 4.3149, val_loss: 5.1711, lr: 0.003000, 6.84s
2024-04-30 22:25:41 INFO     epoch complete!
2024-04-30 22:25:41 INFO     evaluating now!
2024-04-30 22:25:42 INFO     Epoch [36/200] train_loss: 4.1668, val_loss: 4.9884, lr: 0.003000, 6.83s
2024-04-30 22:25:42 INFO     Saved model at 36
2024-04-30 22:25:42 INFO     Val loss decrease from 5.0870 to 4.9884, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-04-30 22:25:48 INFO     epoch complete!
2024-04-30 22:25:48 INFO     evaluating now!
2024-04-30 22:25:49 INFO     Epoch [37/200] train_loss: 4.1949, val_loss: 5.2924, lr: 0.003000, 6.85s
2024-04-30 22:25:55 INFO     epoch complete!
2024-04-30 22:25:55 INFO     evaluating now!
2024-04-30 22:25:55 INFO     Epoch [38/200] train_loss: 4.2147, val_loss: 5.2380, lr: 0.003000, 6.84s
2024-04-30 22:26:02 INFO     epoch complete!
2024-04-30 22:26:02 INFO     evaluating now!
2024-04-30 22:26:02 INFO     Epoch [39/200] train_loss: 4.1893, val_loss: 5.1773, lr: 0.003000, 6.75s
2024-04-30 22:26:08 INFO     epoch complete!
2024-04-30 22:26:08 INFO     evaluating now!
2024-04-30 22:26:09 INFO     Epoch [40/200] train_loss: 4.1684, val_loss: 5.0546, lr: 0.003000, 6.66s
2024-04-30 22:26:15 INFO     epoch complete!
2024-04-30 22:26:15 INFO     evaluating now!
2024-04-30 22:26:16 INFO     Epoch [41/200] train_loss: 4.0488, val_loss: 4.9324, lr: 0.003000, 6.70s
2024-04-30 22:26:16 INFO     Saved model at 41
2024-04-30 22:26:16 INFO     Val loss decrease from 4.9884 to 4.9324, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-04-30 22:26:22 INFO     epoch complete!
2024-04-30 22:26:22 INFO     evaluating now!
2024-04-30 22:26:22 INFO     Epoch [42/200] train_loss: 4.1142, val_loss: 5.1663, lr: 0.003000, 6.84s
2024-04-30 22:26:29 INFO     epoch complete!
2024-04-30 22:26:29 INFO     evaluating now!
2024-04-30 22:26:29 INFO     Epoch [43/200] train_loss: 4.1146, val_loss: 5.0804, lr: 0.003000, 6.75s
2024-04-30 22:26:36 INFO     epoch complete!
2024-04-30 22:26:36 INFO     evaluating now!
2024-04-30 22:26:36 INFO     Epoch [44/200] train_loss: 4.0366, val_loss: 5.0740, lr: 0.003000, 6.95s
2024-04-30 22:26:42 INFO     epoch complete!
2024-04-30 22:26:42 INFO     evaluating now!
2024-04-30 22:26:43 INFO     Epoch [45/200] train_loss: 3.9438, val_loss: 5.0563, lr: 0.003000, 6.61s
2024-04-30 22:26:49 INFO     epoch complete!
2024-04-30 22:26:49 INFO     evaluating now!
2024-04-30 22:26:49 INFO     Epoch [46/200] train_loss: 3.9801, val_loss: 5.2422, lr: 0.003000, 6.34s
2024-04-30 22:26:55 INFO     epoch complete!
2024-04-30 22:26:55 INFO     evaluating now!
2024-04-30 22:26:55 INFO     Epoch [47/200] train_loss: 3.9389, val_loss: 4.9946, lr: 0.003000, 6.30s
2024-04-30 22:27:01 INFO     epoch complete!
2024-04-30 22:27:01 INFO     evaluating now!
2024-04-30 22:27:02 INFO     Epoch [48/200] train_loss: 3.8528, val_loss: 5.0970, lr: 0.003000, 6.34s
2024-04-30 22:27:08 INFO     epoch complete!
2024-04-30 22:27:08 INFO     evaluating now!
2024-04-30 22:27:08 INFO     Epoch [49/200] train_loss: 3.9554, val_loss: 5.1805, lr: 0.003000, 6.29s
2024-04-30 22:27:14 INFO     epoch complete!
2024-04-30 22:27:14 INFO     evaluating now!
2024-04-30 22:27:14 INFO     Epoch [50/200] train_loss: 3.9679, val_loss: 4.9992, lr: 0.003000, 6.31s
2024-04-30 22:27:20 INFO     epoch complete!
2024-04-30 22:27:20 INFO     evaluating now!
2024-04-30 22:27:21 INFO     Epoch [51/200] train_loss: 3.8585, val_loss: 5.1505, lr: 0.003000, 6.48s
2024-04-30 22:27:28 INFO     epoch complete!
2024-04-30 22:27:28 INFO     evaluating now!
2024-04-30 22:27:28 INFO     Epoch [52/200] train_loss: 3.7837, val_loss: 4.9399, lr: 0.003000, 7.23s
2024-04-30 22:27:34 INFO     epoch complete!
2024-04-30 22:27:34 INFO     evaluating now!
2024-04-30 22:27:35 INFO     Epoch [53/200] train_loss: 3.8126, val_loss: 5.1063, lr: 0.003000, 6.80s
2024-04-30 22:27:41 INFO     epoch complete!
2024-04-30 22:27:41 INFO     evaluating now!
2024-04-30 22:27:42 INFO     Epoch [54/200] train_loss: 3.7771, val_loss: 5.1675, lr: 0.003000, 6.78s
2024-04-30 22:27:48 INFO     epoch complete!
2024-04-30 22:27:48 INFO     evaluating now!
2024-04-30 22:27:49 INFO     Epoch [55/200] train_loss: 3.7187, val_loss: 4.9232, lr: 0.003000, 6.83s
2024-04-30 22:27:49 INFO     Saved model at 55
2024-04-30 22:27:49 INFO     Val loss decrease from 4.9324 to 4.9232, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch55.tar
2024-04-30 22:27:55 INFO     epoch complete!
2024-04-30 22:27:55 INFO     evaluating now!
2024-04-30 22:27:55 INFO     Epoch [56/200] train_loss: 3.6991, val_loss: 5.2594, lr: 0.003000, 6.87s
2024-04-30 22:28:02 INFO     epoch complete!
2024-04-30 22:28:02 INFO     evaluating now!
2024-04-30 22:28:02 INFO     Epoch [57/200] train_loss: 3.6953, val_loss: 5.1408, lr: 0.003000, 6.82s
2024-04-30 22:28:09 INFO     epoch complete!
2024-04-30 22:28:09 INFO     evaluating now!
2024-04-30 22:28:09 INFO     Epoch [58/200] train_loss: 3.6629, val_loss: 5.0755, lr: 0.003000, 6.80s
2024-04-30 22:28:16 INFO     epoch complete!
2024-04-30 22:28:16 INFO     evaluating now!
2024-04-30 22:28:16 INFO     Epoch [59/200] train_loss: 3.6808, val_loss: 5.0168, lr: 0.003000, 6.93s
2024-04-30 22:28:22 INFO     epoch complete!
2024-04-30 22:28:22 INFO     evaluating now!
2024-04-30 22:28:23 INFO     Epoch [60/200] train_loss: 3.6543, val_loss: 5.0275, lr: 0.003000, 6.87s
2024-04-30 22:28:29 INFO     epoch complete!
2024-04-30 22:28:29 INFO     evaluating now!
2024-04-30 22:28:30 INFO     Epoch [61/200] train_loss: 3.6407, val_loss: 5.0963, lr: 0.003000, 6.79s
2024-04-30 22:28:36 INFO     epoch complete!
2024-04-30 22:28:36 INFO     evaluating now!
2024-04-30 22:28:37 INFO     Epoch [62/200] train_loss: 3.6212, val_loss: 5.0024, lr: 0.003000, 6.90s
2024-04-30 22:28:43 INFO     epoch complete!
2024-04-30 22:28:43 INFO     evaluating now!
2024-04-30 22:28:43 INFO     Epoch [63/200] train_loss: 3.6319, val_loss: 5.0520, lr: 0.003000, 6.81s
2024-04-30 22:28:50 INFO     epoch complete!
2024-04-30 22:28:50 INFO     evaluating now!
2024-04-30 22:28:50 INFO     Epoch [64/200] train_loss: 3.6807, val_loss: 5.2002, lr: 0.003000, 6.83s
2024-04-30 22:28:57 INFO     epoch complete!
2024-04-30 22:28:57 INFO     evaluating now!
2024-04-30 22:28:57 INFO     Epoch [65/200] train_loss: 3.6467, val_loss: 5.1357, lr: 0.003000, 6.84s
2024-04-30 22:29:04 INFO     epoch complete!
2024-04-30 22:29:04 INFO     evaluating now!
2024-04-30 22:29:04 INFO     Epoch [66/200] train_loss: 3.5628, val_loss: 5.0829, lr: 0.003000, 6.96s
2024-04-30 22:29:11 INFO     epoch complete!
2024-04-30 22:29:11 INFO     evaluating now!
2024-04-30 22:29:11 INFO     Epoch [67/200] train_loss: 3.6069, val_loss: 5.1392, lr: 0.003000, 7.04s
2024-04-30 22:29:18 INFO     epoch complete!
2024-04-30 22:29:18 INFO     evaluating now!
2024-04-30 22:29:18 INFO     Epoch [68/200] train_loss: 3.5440, val_loss: 5.0543, lr: 0.003000, 6.93s
2024-04-30 22:29:24 INFO     epoch complete!
2024-04-30 22:29:24 INFO     evaluating now!
2024-04-30 22:29:25 INFO     Epoch [69/200] train_loss: 3.5372, val_loss: 5.0779, lr: 0.003000, 6.92s
2024-04-30 22:29:31 INFO     epoch complete!
2024-04-30 22:29:31 INFO     evaluating now!
2024-04-30 22:29:32 INFO     Epoch [70/200] train_loss: 3.5174, val_loss: 5.0260, lr: 0.003000, 6.92s
2024-04-30 22:29:32 WARNING  Early stopping at epoch: 70
2024-04-30 22:29:32 INFO     Trained totally 71 epochs, average train time is 6.418s, average eval time is 0.451s
2024-04-30 22:29:32 INFO     Loaded model at 55
2024-04-30 22:29:32 INFO     Saved model at ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 22:29:32 INFO     Start evaluating ...
2024-04-30 22:29:34 INFO     Note that you select the single mode to evaluate!
2024-04-30 22:29:34 INFO     Evaluate result is saved at ./libcity/cache/45/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 22:29:34 INFO     
         MAE       RMSE
1   2.313507   7.026457
2   2.430305   7.657144
3   2.589939   8.588878
4   2.699203   9.146949
5   2.779483   9.725290
6   2.949230  10.509645
7   3.045703  11.337118
8   3.150031  12.004609
9   3.192337  12.422221
10  3.188384  12.601197
11  3.333146  13.095104
12  3.467516  13.685232
2024-04-30 22:29:34 INFO     ----------------------------------------------------------------------------
2024-04-30 22:29:34 INFO     # 1, Kownledge Graph Embedding: AttE, Experiment ids: 46
2024-04-30 22:29:34 INFO     ----------------------------------------------------------------------------
2024-04-30 22:29:34 INFO     Log directory: ./libcity/log
2024-04-30 22:29:34 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=46
2024-04-30 22:29:34 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 77270388, 'exp_id': 46, 'load_external': True, 'embedding_model': 'AttE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 22:29:34 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 22:29:34 INFO     set_weight_link_or_dist: dist
2024-04-30 22:29:34 INFO     init_weight_inf_or_zero: inf
2024-04-30 22:29:34 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 22:29:34 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 22:29:34 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 22:29:34 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 22:29:37 INFO     Dataset created
2024-04-30 22:29:37 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 22:29:37 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 22:29:37 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 22:29:37 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 22:29:37 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 22:29:37 INFO     NoneScaler
2024-04-30 22:29:39 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 22:29:39 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 22:29:39 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 22:29:39 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 22:29:39 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 22:29:39 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 22:29:39 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 22:29:39 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 22:29:39 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 22:29:39 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 22:29:39 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 22:29:39 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 22:29:39 INFO     Total parameter numbers: 874010
2024-04-30 22:29:39 INFO     You select `adam` optimizer.
2024-04-30 22:29:39 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 22:29:39 INFO     Start training ...
2024-04-30 22:29:39 INFO     num_batches:48
2024-04-30 22:29:46 INFO     epoch complete!
2024-04-30 22:29:46 INFO     evaluating now!
2024-04-30 22:29:46 INFO     Epoch [0/200] train_loss: 25.0324, val_loss: 18.3724, lr: 0.003000, 7.10s
2024-04-30 22:29:47 INFO     Saved model at 0
2024-04-30 22:29:47 INFO     Val loss decrease from inf to 18.3724, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 22:29:53 INFO     epoch complete!
2024-04-30 22:29:53 INFO     evaluating now!
2024-04-30 22:29:54 INFO     Epoch [1/200] train_loss: 15.2929, val_loss: 15.4686, lr: 0.003000, 7.20s
2024-04-30 22:29:54 INFO     Saved model at 1
2024-04-30 22:29:54 INFO     Val loss decrease from 18.3724 to 15.4686, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 22:30:01 INFO     epoch complete!
2024-04-30 22:30:01 INFO     evaluating now!
2024-04-30 22:30:01 INFO     Epoch [2/200] train_loss: 12.7589, val_loss: 12.6528, lr: 0.003000, 7.29s
2024-04-30 22:30:01 INFO     Saved model at 2
2024-04-30 22:30:01 INFO     Val loss decrease from 15.4686 to 12.6528, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 22:30:08 INFO     epoch complete!
2024-04-30 22:30:08 INFO     evaluating now!
2024-04-30 22:30:08 INFO     Epoch [3/200] train_loss: 10.4565, val_loss: 10.3469, lr: 0.003000, 7.23s
2024-04-30 22:30:08 INFO     Saved model at 3
2024-04-30 22:30:08 INFO     Val loss decrease from 12.6528 to 10.3469, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 22:30:15 INFO     epoch complete!
2024-04-30 22:30:15 INFO     evaluating now!
2024-04-30 22:30:16 INFO     Epoch [4/200] train_loss: 9.0661, val_loss: 9.0159, lr: 0.003000, 7.19s
2024-04-30 22:30:16 INFO     Saved model at 4
2024-04-30 22:30:16 INFO     Val loss decrease from 10.3469 to 9.0159, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 22:30:22 INFO     epoch complete!
2024-04-30 22:30:22 INFO     evaluating now!
2024-04-30 22:30:23 INFO     Epoch [5/200] train_loss: 8.3538, val_loss: 8.2066, lr: 0.003000, 7.23s
2024-04-30 22:30:23 INFO     Saved model at 5
2024-04-30 22:30:23 INFO     Val loss decrease from 9.0159 to 8.2066, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 22:30:30 INFO     epoch complete!
2024-04-30 22:30:30 INFO     evaluating now!
2024-04-30 22:30:30 INFO     Epoch [6/200] train_loss: 7.6932, val_loss: 7.3811, lr: 0.003000, 7.30s
2024-04-30 22:30:30 INFO     Saved model at 6
2024-04-30 22:30:30 INFO     Val loss decrease from 8.2066 to 7.3811, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 22:30:37 INFO     epoch complete!
2024-04-30 22:30:37 INFO     evaluating now!
2024-04-30 22:30:37 INFO     Epoch [7/200] train_loss: 6.9786, val_loss: 7.1395, lr: 0.003000, 7.23s
2024-04-30 22:30:37 INFO     Saved model at 7
2024-04-30 22:30:37 INFO     Val loss decrease from 7.3811 to 7.1395, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 22:30:44 INFO     epoch complete!
2024-04-30 22:30:44 INFO     evaluating now!
2024-04-30 22:30:45 INFO     Epoch [8/200] train_loss: 6.7531, val_loss: 6.7128, lr: 0.003000, 7.09s
2024-04-30 22:30:45 INFO     Saved model at 8
2024-04-30 22:30:45 INFO     Val loss decrease from 7.1395 to 6.7128, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 22:30:51 INFO     epoch complete!
2024-04-30 22:30:51 INFO     evaluating now!
2024-04-30 22:30:52 INFO     Epoch [9/200] train_loss: 6.4769, val_loss: 6.9035, lr: 0.003000, 7.28s
2024-04-30 22:30:59 INFO     epoch complete!
2024-04-30 22:30:59 INFO     evaluating now!
2024-04-30 22:30:59 INFO     Epoch [10/200] train_loss: 6.2165, val_loss: 6.3186, lr: 0.003000, 7.23s
2024-04-30 22:30:59 INFO     Saved model at 10
2024-04-30 22:30:59 INFO     Val loss decrease from 6.7128 to 6.3186, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 22:31:06 INFO     epoch complete!
2024-04-30 22:31:06 INFO     evaluating now!
2024-04-30 22:31:06 INFO     Epoch [11/200] train_loss: 5.9812, val_loss: 6.1280, lr: 0.003000, 7.26s
2024-04-30 22:31:06 INFO     Saved model at 11
2024-04-30 22:31:06 INFO     Val loss decrease from 6.3186 to 6.1280, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 22:31:13 INFO     epoch complete!
2024-04-30 22:31:13 INFO     evaluating now!
2024-04-30 22:31:14 INFO     Epoch [12/200] train_loss: 5.8042, val_loss: 5.9595, lr: 0.003000, 7.35s
2024-04-30 22:31:14 INFO     Saved model at 12
2024-04-30 22:31:14 INFO     Val loss decrease from 6.1280 to 5.9595, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 22:31:21 INFO     epoch complete!
2024-04-30 22:31:21 INFO     evaluating now!
2024-04-30 22:31:21 INFO     Epoch [13/200] train_loss: 5.7201, val_loss: 5.7753, lr: 0.003000, 7.29s
2024-04-30 22:31:21 INFO     Saved model at 13
2024-04-30 22:31:21 INFO     Val loss decrease from 5.9595 to 5.7753, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 22:31:28 INFO     epoch complete!
2024-04-30 22:31:28 INFO     evaluating now!
2024-04-30 22:31:28 INFO     Epoch [14/200] train_loss: 5.5325, val_loss: 5.8322, lr: 0.003000, 7.17s
2024-04-30 22:31:35 INFO     epoch complete!
2024-04-30 22:31:35 INFO     evaluating now!
2024-04-30 22:31:36 INFO     Epoch [15/200] train_loss: 5.3664, val_loss: 5.7711, lr: 0.003000, 7.21s
2024-04-30 22:31:36 INFO     Saved model at 15
2024-04-30 22:31:36 INFO     Val loss decrease from 5.7753 to 5.7711, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 22:31:42 INFO     epoch complete!
2024-04-30 22:31:42 INFO     evaluating now!
2024-04-30 22:31:43 INFO     Epoch [16/200] train_loss: 5.3254, val_loss: 5.5045, lr: 0.003000, 7.18s
2024-04-30 22:31:43 INFO     Saved model at 16
2024-04-30 22:31:43 INFO     Val loss decrease from 5.7711 to 5.5045, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 22:31:50 INFO     epoch complete!
2024-04-30 22:31:50 INFO     evaluating now!
2024-04-30 22:31:51 INFO     Epoch [17/200] train_loss: 5.2039, val_loss: 5.6914, lr: 0.003000, 7.73s
2024-04-30 22:31:57 INFO     epoch complete!
2024-04-30 22:31:57 INFO     evaluating now!
2024-04-30 22:31:58 INFO     Epoch [18/200] train_loss: 5.1390, val_loss: 5.3005, lr: 0.003000, 7.40s
2024-04-30 22:31:58 INFO     Saved model at 18
2024-04-30 22:31:58 INFO     Val loss decrease from 5.5045 to 5.3005, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 22:32:05 INFO     epoch complete!
2024-04-30 22:32:05 INFO     evaluating now!
2024-04-30 22:32:05 INFO     Epoch [19/200] train_loss: 5.0178, val_loss: 5.5572, lr: 0.003000, 7.35s
2024-04-30 22:32:12 INFO     epoch complete!
2024-04-30 22:32:12 INFO     evaluating now!
2024-04-30 22:32:13 INFO     Epoch [20/200] train_loss: 4.9386, val_loss: 5.5251, lr: 0.003000, 7.22s
2024-04-30 22:32:19 INFO     epoch complete!
2024-04-30 22:32:19 INFO     evaluating now!
2024-04-30 22:32:20 INFO     Epoch [21/200] train_loss: 4.9044, val_loss: 5.3335, lr: 0.003000, 7.22s
2024-04-30 22:32:27 INFO     epoch complete!
2024-04-30 22:32:27 INFO     evaluating now!
2024-04-30 22:32:27 INFO     Epoch [22/200] train_loss: 4.8466, val_loss: 5.4200, lr: 0.003000, 7.30s
2024-04-30 22:32:34 INFO     epoch complete!
2024-04-30 22:32:34 INFO     evaluating now!
2024-04-30 22:32:35 INFO     Epoch [23/200] train_loss: 4.7553, val_loss: 5.4881, lr: 0.003000, 7.42s
2024-04-30 22:32:42 INFO     epoch complete!
2024-04-30 22:32:42 INFO     evaluating now!
2024-04-30 22:32:42 INFO     Epoch [24/200] train_loss: 4.7823, val_loss: 5.4316, lr: 0.003000, 7.64s
2024-04-30 22:32:49 INFO     epoch complete!
2024-04-30 22:32:49 INFO     evaluating now!
2024-04-30 22:32:50 INFO     Epoch [25/200] train_loss: 4.7197, val_loss: 5.3733, lr: 0.003000, 7.69s
2024-04-30 22:32:57 INFO     epoch complete!
2024-04-30 22:32:57 INFO     evaluating now!
2024-04-30 22:32:57 INFO     Epoch [26/200] train_loss: 4.7195, val_loss: 5.1413, lr: 0.003000, 7.32s
2024-04-30 22:32:57 INFO     Saved model at 26
2024-04-30 22:32:57 INFO     Val loss decrease from 5.3005 to 5.1413, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-04-30 22:33:04 INFO     epoch complete!
2024-04-30 22:33:04 INFO     evaluating now!
2024-04-30 22:33:04 INFO     Epoch [27/200] train_loss: 4.6027, val_loss: 5.2315, lr: 0.003000, 6.91s
2024-04-30 22:33:10 INFO     epoch complete!
2024-04-30 22:33:10 INFO     evaluating now!
2024-04-30 22:33:11 INFO     Epoch [28/200] train_loss: 4.6814, val_loss: 5.2757, lr: 0.003000, 6.81s
2024-04-30 22:33:17 INFO     epoch complete!
2024-04-30 22:33:17 INFO     evaluating now!
2024-04-30 22:33:18 INFO     Epoch [29/200] train_loss: 4.5321, val_loss: 5.2909, lr: 0.003000, 6.77s
2024-04-30 22:33:24 INFO     epoch complete!
2024-04-30 22:33:24 INFO     evaluating now!
2024-04-30 22:33:25 INFO     Epoch [30/200] train_loss: 4.5100, val_loss: 5.1633, lr: 0.003000, 6.83s
2024-04-30 22:33:31 INFO     epoch complete!
2024-04-30 22:33:31 INFO     evaluating now!
2024-04-30 22:33:31 INFO     Epoch [31/200] train_loss: 4.3881, val_loss: 5.2518, lr: 0.003000, 6.90s
2024-04-30 22:33:38 INFO     epoch complete!
2024-04-30 22:33:38 INFO     evaluating now!
2024-04-30 22:33:39 INFO     Epoch [32/200] train_loss: 4.3513, val_loss: 5.1697, lr: 0.003000, 7.17s
2024-04-30 22:33:46 INFO     epoch complete!
2024-04-30 22:33:46 INFO     evaluating now!
2024-04-30 22:33:46 INFO     Epoch [33/200] train_loss: 4.3498, val_loss: 5.2728, lr: 0.003000, 7.56s
2024-04-30 22:33:53 INFO     epoch complete!
2024-04-30 22:33:53 INFO     evaluating now!
2024-04-30 22:33:53 INFO     Epoch [34/200] train_loss: 4.3570, val_loss: 5.1928, lr: 0.003000, 7.20s
2024-04-30 22:34:00 INFO     epoch complete!
2024-04-30 22:34:00 INFO     evaluating now!
2024-04-30 22:34:01 INFO     Epoch [35/200] train_loss: 4.3973, val_loss: 5.1117, lr: 0.003000, 7.26s
2024-04-30 22:34:01 INFO     Saved model at 35
2024-04-30 22:34:01 INFO     Val loss decrease from 5.1413 to 5.1117, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-04-30 22:34:07 INFO     epoch complete!
2024-04-30 22:34:07 INFO     evaluating now!
2024-04-30 22:34:08 INFO     Epoch [36/200] train_loss: 4.2435, val_loss: 5.1305, lr: 0.003000, 7.32s
2024-04-30 22:34:15 INFO     epoch complete!
2024-04-30 22:34:15 INFO     evaluating now!
2024-04-30 22:34:15 INFO     Epoch [37/200] train_loss: 4.4095, val_loss: 5.1770, lr: 0.003000, 7.35s
2024-04-30 22:34:22 INFO     epoch complete!
2024-04-30 22:34:22 INFO     evaluating now!
2024-04-30 22:34:23 INFO     Epoch [38/200] train_loss: 4.4078, val_loss: 5.1055, lr: 0.003000, 7.30s
2024-04-30 22:34:23 INFO     Saved model at 38
2024-04-30 22:34:23 INFO     Val loss decrease from 5.1117 to 5.1055, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-04-30 22:34:29 INFO     epoch complete!
2024-04-30 22:34:29 INFO     evaluating now!
2024-04-30 22:34:30 INFO     Epoch [39/200] train_loss: 4.3232, val_loss: 5.0864, lr: 0.003000, 7.28s
2024-04-30 22:34:30 INFO     Saved model at 39
2024-04-30 22:34:30 INFO     Val loss decrease from 5.1055 to 5.0864, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-04-30 22:34:37 INFO     epoch complete!
2024-04-30 22:34:37 INFO     evaluating now!
2024-04-30 22:34:37 INFO     Epoch [40/200] train_loss: 4.2396, val_loss: 5.0859, lr: 0.003000, 7.26s
2024-04-30 22:34:37 INFO     Saved model at 40
2024-04-30 22:34:37 INFO     Val loss decrease from 5.0864 to 5.0859, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-04-30 22:34:44 INFO     epoch complete!
2024-04-30 22:34:44 INFO     evaluating now!
2024-04-30 22:34:44 INFO     Epoch [41/200] train_loss: 4.1104, val_loss: 5.0571, lr: 0.003000, 7.06s
2024-04-30 22:34:44 INFO     Saved model at 41
2024-04-30 22:34:44 INFO     Val loss decrease from 5.0859 to 5.0571, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-04-30 22:34:51 INFO     epoch complete!
2024-04-30 22:34:51 INFO     evaluating now!
2024-04-30 22:34:52 INFO     Epoch [42/200] train_loss: 4.0756, val_loss: 5.1438, lr: 0.003000, 7.13s
2024-04-30 22:34:58 INFO     epoch complete!
2024-04-30 22:34:58 INFO     evaluating now!
2024-04-30 22:34:59 INFO     Epoch [43/200] train_loss: 4.0744, val_loss: 5.0336, lr: 0.003000, 7.38s
2024-04-30 22:34:59 INFO     Saved model at 43
2024-04-30 22:34:59 INFO     Val loss decrease from 5.0571 to 5.0336, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-04-30 22:35:06 INFO     epoch complete!
2024-04-30 22:35:06 INFO     evaluating now!
2024-04-30 22:35:06 INFO     Epoch [44/200] train_loss: 4.0017, val_loss: 5.0235, lr: 0.003000, 7.30s
2024-04-30 22:35:06 INFO     Saved model at 44
2024-04-30 22:35:06 INFO     Val loss decrease from 5.0336 to 5.0235, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-04-30 22:35:13 INFO     epoch complete!
2024-04-30 22:35:13 INFO     evaluating now!
2024-04-30 22:35:14 INFO     Epoch [45/200] train_loss: 4.0215, val_loss: 5.1088, lr: 0.003000, 7.33s
2024-04-30 22:35:20 INFO     epoch complete!
2024-04-30 22:35:20 INFO     evaluating now!
2024-04-30 22:35:21 INFO     Epoch [46/200] train_loss: 3.9783, val_loss: 5.0775, lr: 0.003000, 7.23s
2024-04-30 22:35:28 INFO     epoch complete!
2024-04-30 22:35:28 INFO     evaluating now!
2024-04-30 22:35:28 INFO     Epoch [47/200] train_loss: 4.0061, val_loss: 5.0979, lr: 0.003000, 7.28s
2024-04-30 22:35:35 INFO     epoch complete!
2024-04-30 22:35:35 INFO     evaluating now!
2024-04-30 22:35:35 INFO     Epoch [48/200] train_loss: 3.9918, val_loss: 5.1371, lr: 0.003000, 7.26s
2024-04-30 22:35:42 INFO     epoch complete!
2024-04-30 22:35:42 INFO     evaluating now!
2024-04-30 22:35:43 INFO     Epoch [49/200] train_loss: 3.9407, val_loss: 4.9899, lr: 0.003000, 7.14s
2024-04-30 22:35:43 INFO     Saved model at 49
2024-04-30 22:35:43 INFO     Val loss decrease from 5.0235 to 4.9899, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-04-30 22:35:49 INFO     epoch complete!
2024-04-30 22:35:49 INFO     evaluating now!
2024-04-30 22:35:50 INFO     Epoch [50/200] train_loss: 3.8938, val_loss: 5.0815, lr: 0.003000, 7.03s
2024-04-30 22:35:56 INFO     epoch complete!
2024-04-30 22:35:56 INFO     evaluating now!
2024-04-30 22:35:57 INFO     Epoch [51/200] train_loss: 3.8566, val_loss: 4.9706, lr: 0.003000, 7.06s
2024-04-30 22:35:57 INFO     Saved model at 51
2024-04-30 22:35:57 INFO     Val loss decrease from 4.9899 to 4.9706, saving to ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-04-30 22:36:03 INFO     epoch complete!
2024-04-30 22:36:03 INFO     evaluating now!
2024-04-30 22:36:04 INFO     Epoch [52/200] train_loss: 3.8719, val_loss: 5.1281, lr: 0.003000, 7.22s
2024-04-30 22:36:11 INFO     epoch complete!
2024-04-30 22:36:11 INFO     evaluating now!
2024-04-30 22:36:11 INFO     Epoch [53/200] train_loss: 3.8321, val_loss: 5.2510, lr: 0.003000, 7.14s
2024-04-30 22:36:18 INFO     epoch complete!
2024-04-30 22:36:18 INFO     evaluating now!
2024-04-30 22:36:18 INFO     Epoch [54/200] train_loss: 3.8022, val_loss: 5.0325, lr: 0.003000, 7.04s
2024-04-30 22:36:25 INFO     epoch complete!
2024-04-30 22:36:25 INFO     evaluating now!
2024-04-30 22:36:25 INFO     Epoch [55/200] train_loss: 3.7811, val_loss: 5.0017, lr: 0.003000, 6.96s
2024-04-30 22:36:32 INFO     epoch complete!
2024-04-30 22:36:32 INFO     evaluating now!
2024-04-30 22:36:32 INFO     Epoch [56/200] train_loss: 3.7837, val_loss: 5.0708, lr: 0.003000, 7.09s
2024-04-30 22:36:39 INFO     epoch complete!
2024-04-30 22:36:39 INFO     evaluating now!
2024-04-30 22:36:39 INFO     Epoch [57/200] train_loss: 3.7605, val_loss: 5.0981, lr: 0.003000, 7.05s
2024-04-30 22:36:46 INFO     epoch complete!
2024-04-30 22:36:46 INFO     evaluating now!
2024-04-30 22:36:46 INFO     Epoch [58/200] train_loss: 3.7426, val_loss: 4.9710, lr: 0.003000, 7.03s
2024-04-30 22:36:53 INFO     epoch complete!
2024-04-30 22:36:53 INFO     evaluating now!
2024-04-30 22:36:53 INFO     Epoch [59/200] train_loss: 3.7144, val_loss: 5.0807, lr: 0.003000, 7.06s
2024-04-30 22:37:00 INFO     epoch complete!
2024-04-30 22:37:00 INFO     evaluating now!
2024-04-30 22:37:00 INFO     Epoch [60/200] train_loss: 3.7368, val_loss: 5.1144, lr: 0.003000, 7.06s
2024-04-30 22:37:07 INFO     epoch complete!
2024-04-30 22:37:07 INFO     evaluating now!
2024-04-30 22:37:07 INFO     Epoch [61/200] train_loss: 3.6931, val_loss: 5.0517, lr: 0.003000, 7.10s
2024-04-30 22:37:14 INFO     epoch complete!
2024-04-30 22:37:14 INFO     evaluating now!
2024-04-30 22:37:15 INFO     Epoch [62/200] train_loss: 3.7011, val_loss: 5.0284, lr: 0.003000, 7.19s
2024-04-30 22:37:21 INFO     epoch complete!
2024-04-30 22:37:21 INFO     evaluating now!
2024-04-30 22:37:22 INFO     Epoch [63/200] train_loss: 3.6449, val_loss: 4.9986, lr: 0.003000, 7.14s
2024-04-30 22:37:29 INFO     epoch complete!
2024-04-30 22:37:29 INFO     evaluating now!
2024-04-30 22:37:29 INFO     Epoch [64/200] train_loss: 3.5895, val_loss: 5.0599, lr: 0.003000, 7.20s
2024-04-30 22:37:36 INFO     epoch complete!
2024-04-30 22:37:36 INFO     evaluating now!
2024-04-30 22:37:36 INFO     Epoch [65/200] train_loss: 3.5884, val_loss: 5.1897, lr: 0.003000, 7.21s
2024-04-30 22:37:43 INFO     epoch complete!
2024-04-30 22:37:43 INFO     evaluating now!
2024-04-30 22:37:43 INFO     Epoch [66/200] train_loss: 3.5848, val_loss: 5.0487, lr: 0.003000, 7.21s
2024-04-30 22:37:43 WARNING  Early stopping at epoch: 66
2024-04-30 22:37:43 INFO     Trained totally 67 epochs, average train time is 6.717s, average eval time is 0.487s
2024-04-30 22:37:44 INFO     Loaded model at 51
2024-04-30 22:37:44 INFO     Saved model at ./libcity/cache/46/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 22:37:44 INFO     Start evaluating ...
2024-04-30 22:37:45 INFO     Note that you select the single mode to evaluate!
2024-04-30 22:37:45 INFO     Evaluate result is saved at ./libcity/cache/46/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 22:37:45 INFO     
         MAE       RMSE
1   2.443202   7.022106
2   2.533422   7.610756
3   2.702779   8.664648
4   2.825750   9.491438
5   2.978114  10.401892
6   3.108911  11.382825
7   3.219364  12.414485
8   3.334641  13.464881
9   3.380533  14.077680
10  3.462128  14.416567
11  3.494673  14.483810
12  3.612777  14.727733
2024-04-30 22:37:45 INFO     ----------------------------------------------------------------------------
2024-04-30 22:37:45 INFO     # 2, Kownledge Graph Embedding: AttE, Experiment ids: 47
2024-04-30 22:37:45 INFO     ----------------------------------------------------------------------------
2024-04-30 22:37:45 INFO     Log directory: ./libcity/log
2024-04-30 22:37:45 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=47
2024-04-30 22:37:45 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 902973897, 'exp_id': 47, 'load_external': True, 'embedding_model': 'AttE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 22:37:45 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 22:37:45 INFO     set_weight_link_or_dist: dist
2024-04-30 22:37:45 INFO     init_weight_inf_or_zero: inf
2024-04-30 22:37:45 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 22:37:45 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 22:37:45 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 22:37:46 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 22:37:49 INFO     Dataset created
2024-04-30 22:37:49 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 22:37:49 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 22:37:49 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 22:37:49 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 22:37:49 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 22:37:49 INFO     NoneScaler
2024-04-30 22:37:51 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 22:37:51 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 22:37:51 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 22:37:51 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 22:37:51 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 22:37:51 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 22:37:51 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 22:37:51 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 22:37:51 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 22:37:51 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 22:37:51 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 22:37:51 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 22:37:51 INFO     Total parameter numbers: 874010
2024-04-30 22:37:51 INFO     You select `adam` optimizer.
2024-04-30 22:37:51 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 22:37:51 INFO     Start training ...
2024-04-30 22:37:51 INFO     num_batches:48
2024-04-30 22:37:58 INFO     epoch complete!
2024-04-30 22:37:58 INFO     evaluating now!
2024-04-30 22:37:58 INFO     Epoch [0/200] train_loss: 23.3317, val_loss: 18.5804, lr: 0.003000, 7.25s
2024-04-30 22:37:58 INFO     Saved model at 0
2024-04-30 22:37:58 INFO     Val loss decrease from inf to 18.5804, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 22:38:05 INFO     epoch complete!
2024-04-30 22:38:05 INFO     evaluating now!
2024-04-30 22:38:05 INFO     Epoch [1/200] train_loss: 14.8700, val_loss: 14.3932, lr: 0.003000, 7.14s
2024-04-30 22:38:05 INFO     Saved model at 1
2024-04-30 22:38:05 INFO     Val loss decrease from 18.5804 to 14.3932, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 22:38:12 INFO     epoch complete!
2024-04-30 22:38:12 INFO     evaluating now!
2024-04-30 22:38:13 INFO     Epoch [2/200] train_loss: 11.8905, val_loss: 11.1566, lr: 0.003000, 7.17s
2024-04-30 22:38:13 INFO     Saved model at 2
2024-04-30 22:38:13 INFO     Val loss decrease from 14.3932 to 11.1566, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 22:38:19 INFO     epoch complete!
2024-04-30 22:38:19 INFO     evaluating now!
2024-04-30 22:38:20 INFO     Epoch [3/200] train_loss: 9.5280, val_loss: 9.0224, lr: 0.003000, 7.08s
2024-04-30 22:38:20 INFO     Saved model at 3
2024-04-30 22:38:20 INFO     Val loss decrease from 11.1566 to 9.0224, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 22:38:26 INFO     epoch complete!
2024-04-30 22:38:26 INFO     evaluating now!
2024-04-30 22:38:27 INFO     Epoch [4/200] train_loss: 8.1974, val_loss: 7.8429, lr: 0.003000, 7.15s
2024-04-30 22:38:27 INFO     Saved model at 4
2024-04-30 22:38:27 INFO     Val loss decrease from 9.0224 to 7.8429, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 22:38:33 INFO     epoch complete!
2024-04-30 22:38:33 INFO     evaluating now!
2024-04-30 22:38:34 INFO     Epoch [5/200] train_loss: 7.4527, val_loss: 7.3600, lr: 0.003000, 7.07s
2024-04-30 22:38:34 INFO     Saved model at 5
2024-04-30 22:38:34 INFO     Val loss decrease from 7.8429 to 7.3600, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 22:38:41 INFO     epoch complete!
2024-04-30 22:38:41 INFO     evaluating now!
2024-04-30 22:38:41 INFO     Epoch [6/200] train_loss: 6.8497, val_loss: 6.9938, lr: 0.003000, 7.18s
2024-04-30 22:38:41 INFO     Saved model at 6
2024-04-30 22:38:41 INFO     Val loss decrease from 7.3600 to 6.9938, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 22:38:48 INFO     epoch complete!
2024-04-30 22:38:48 INFO     evaluating now!
2024-04-30 22:38:48 INFO     Epoch [7/200] train_loss: 6.4719, val_loss: 6.3742, lr: 0.003000, 7.02s
2024-04-30 22:38:48 INFO     Saved model at 7
2024-04-30 22:38:48 INFO     Val loss decrease from 6.9938 to 6.3742, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 22:38:55 INFO     epoch complete!
2024-04-30 22:38:55 INFO     evaluating now!
2024-04-30 22:38:55 INFO     Epoch [8/200] train_loss: 6.2433, val_loss: 6.3642, lr: 0.003000, 7.14s
2024-04-30 22:38:55 INFO     Saved model at 8
2024-04-30 22:38:55 INFO     Val loss decrease from 6.3742 to 6.3642, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 22:39:02 INFO     epoch complete!
2024-04-30 22:39:02 INFO     evaluating now!
2024-04-30 22:39:03 INFO     Epoch [9/200] train_loss: 5.8654, val_loss: 5.8844, lr: 0.003000, 7.35s
2024-04-30 22:39:03 INFO     Saved model at 9
2024-04-30 22:39:03 INFO     Val loss decrease from 6.3642 to 5.8844, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 22:39:10 INFO     epoch complete!
2024-04-30 22:39:10 INFO     evaluating now!
2024-04-30 22:39:10 INFO     Epoch [10/200] train_loss: 5.7464, val_loss: 6.0134, lr: 0.003000, 7.49s
2024-04-30 22:39:17 INFO     epoch complete!
2024-04-30 22:39:17 INFO     evaluating now!
2024-04-30 22:39:17 INFO     Epoch [11/200] train_loss: 5.5592, val_loss: 5.8528, lr: 0.003000, 6.63s
2024-04-30 22:39:17 INFO     Saved model at 11
2024-04-30 22:39:17 INFO     Val loss decrease from 5.8844 to 5.8528, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 22:39:23 INFO     epoch complete!
2024-04-30 22:39:23 INFO     evaluating now!
2024-04-30 22:39:24 INFO     Epoch [12/200] train_loss: 5.5321, val_loss: 5.5713, lr: 0.003000, 6.55s
2024-04-30 22:39:24 INFO     Saved model at 12
2024-04-30 22:39:24 INFO     Val loss decrease from 5.8528 to 5.5713, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 22:39:30 INFO     epoch complete!
2024-04-30 22:39:30 INFO     evaluating now!
2024-04-30 22:39:30 INFO     Epoch [13/200] train_loss: 5.3091, val_loss: 5.5653, lr: 0.003000, 6.66s
2024-04-30 22:39:30 INFO     Saved model at 13
2024-04-30 22:39:30 INFO     Val loss decrease from 5.5713 to 5.5653, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 22:39:36 INFO     epoch complete!
2024-04-30 22:39:36 INFO     evaluating now!
2024-04-30 22:39:37 INFO     Epoch [14/200] train_loss: 5.2028, val_loss: 5.4158, lr: 0.003000, 6.54s
2024-04-30 22:39:37 INFO     Saved model at 14
2024-04-30 22:39:37 INFO     Val loss decrease from 5.5653 to 5.4158, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 22:39:43 INFO     epoch complete!
2024-04-30 22:39:43 INFO     evaluating now!
2024-04-30 22:39:43 INFO     Epoch [15/200] train_loss: 5.0684, val_loss: 5.5896, lr: 0.003000, 6.54s
2024-04-30 22:39:50 INFO     epoch complete!
2024-04-30 22:39:50 INFO     evaluating now!
2024-04-30 22:39:50 INFO     Epoch [16/200] train_loss: 5.0052, val_loss: 5.5792, lr: 0.003000, 6.67s
2024-04-30 22:39:57 INFO     epoch complete!
2024-04-30 22:39:57 INFO     evaluating now!
2024-04-30 22:39:57 INFO     Epoch [17/200] train_loss: 5.0248, val_loss: 5.4176, lr: 0.003000, 7.08s
2024-04-30 22:40:04 INFO     epoch complete!
2024-04-30 22:40:04 INFO     evaluating now!
2024-04-30 22:40:05 INFO     Epoch [18/200] train_loss: 4.8451, val_loss: 5.3779, lr: 0.003000, 7.35s
2024-04-30 22:40:05 INFO     Saved model at 18
2024-04-30 22:40:05 INFO     Val loss decrease from 5.4158 to 5.3779, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 22:40:12 INFO     epoch complete!
2024-04-30 22:40:12 INFO     evaluating now!
2024-04-30 22:40:12 INFO     Epoch [19/200] train_loss: 4.7908, val_loss: 5.3550, lr: 0.003000, 7.48s
2024-04-30 22:40:12 INFO     Saved model at 19
2024-04-30 22:40:12 INFO     Val loss decrease from 5.3779 to 5.3550, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 22:40:19 INFO     epoch complete!
2024-04-30 22:40:19 INFO     evaluating now!
2024-04-30 22:40:20 INFO     Epoch [20/200] train_loss: 4.6808, val_loss: 5.2378, lr: 0.003000, 7.65s
2024-04-30 22:40:20 INFO     Saved model at 20
2024-04-30 22:40:20 INFO     Val loss decrease from 5.3550 to 5.2378, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-30 22:40:27 INFO     epoch complete!
2024-04-30 22:40:27 INFO     evaluating now!
2024-04-30 22:40:27 INFO     Epoch [21/200] train_loss: 4.6292, val_loss: 5.2717, lr: 0.003000, 7.36s
2024-04-30 22:40:34 INFO     epoch complete!
2024-04-30 22:40:34 INFO     evaluating now!
2024-04-30 22:40:34 INFO     Epoch [22/200] train_loss: 4.5665, val_loss: 5.2300, lr: 0.003000, 7.15s
2024-04-30 22:40:34 INFO     Saved model at 22
2024-04-30 22:40:34 INFO     Val loss decrease from 5.2378 to 5.2300, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-30 22:40:41 INFO     epoch complete!
2024-04-30 22:40:41 INFO     evaluating now!
2024-04-30 22:40:42 INFO     Epoch [23/200] train_loss: 4.5608, val_loss: 5.2076, lr: 0.003000, 7.20s
2024-04-30 22:40:42 INFO     Saved model at 23
2024-04-30 22:40:42 INFO     Val loss decrease from 5.2300 to 5.2076, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-30 22:40:48 INFO     epoch complete!
2024-04-30 22:40:48 INFO     evaluating now!
2024-04-30 22:40:49 INFO     Epoch [24/200] train_loss: 4.5562, val_loss: 5.2544, lr: 0.003000, 7.29s
2024-04-30 22:40:56 INFO     epoch complete!
2024-04-30 22:40:56 INFO     evaluating now!
2024-04-30 22:40:56 INFO     Epoch [25/200] train_loss: 4.5074, val_loss: 5.2224, lr: 0.003000, 7.33s
2024-04-30 22:41:03 INFO     epoch complete!
2024-04-30 22:41:03 INFO     evaluating now!
2024-04-30 22:41:04 INFO     Epoch [26/200] train_loss: 4.4332, val_loss: 5.2001, lr: 0.003000, 7.32s
2024-04-30 22:41:04 INFO     Saved model at 26
2024-04-30 22:41:04 INFO     Val loss decrease from 5.2076 to 5.2001, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-04-30 22:41:10 INFO     epoch complete!
2024-04-30 22:41:10 INFO     evaluating now!
2024-04-30 22:41:11 INFO     Epoch [27/200] train_loss: 4.3473, val_loss: 5.2249, lr: 0.003000, 7.33s
2024-04-30 22:41:18 INFO     epoch complete!
2024-04-30 22:41:18 INFO     evaluating now!
2024-04-30 22:41:18 INFO     Epoch [28/200] train_loss: 4.3926, val_loss: 5.3823, lr: 0.003000, 7.21s
2024-04-30 22:41:25 INFO     epoch complete!
2024-04-30 22:41:25 INFO     evaluating now!
2024-04-30 22:41:25 INFO     Epoch [29/200] train_loss: 4.3249, val_loss: 5.1048, lr: 0.003000, 7.17s
2024-04-30 22:41:25 INFO     Saved model at 29
2024-04-30 22:41:25 INFO     Val loss decrease from 5.2001 to 5.1048, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-04-30 22:41:32 INFO     epoch complete!
2024-04-30 22:41:32 INFO     evaluating now!
2024-04-30 22:41:32 INFO     Epoch [30/200] train_loss: 4.2189, val_loss: 5.1712, lr: 0.003000, 7.11s
2024-04-30 22:41:39 INFO     epoch complete!
2024-04-30 22:41:39 INFO     evaluating now!
2024-04-30 22:41:40 INFO     Epoch [31/200] train_loss: 4.1931, val_loss: 5.2641, lr: 0.003000, 7.12s
2024-04-30 22:41:46 INFO     epoch complete!
2024-04-30 22:41:46 INFO     evaluating now!
2024-04-30 22:41:47 INFO     Epoch [32/200] train_loss: 4.1864, val_loss: 5.0560, lr: 0.003000, 6.95s
2024-04-30 22:41:47 INFO     Saved model at 32
2024-04-30 22:41:47 INFO     Val loss decrease from 5.1048 to 5.0560, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-04-30 22:41:53 INFO     epoch complete!
2024-04-30 22:41:53 INFO     evaluating now!
2024-04-30 22:41:54 INFO     Epoch [33/200] train_loss: 4.1677, val_loss: 5.1010, lr: 0.003000, 7.22s
2024-04-30 22:42:01 INFO     epoch complete!
2024-04-30 22:42:01 INFO     evaluating now!
2024-04-30 22:42:01 INFO     Epoch [34/200] train_loss: 4.1081, val_loss: 5.1618, lr: 0.003000, 7.29s
2024-04-30 22:42:08 INFO     epoch complete!
2024-04-30 22:42:08 INFO     evaluating now!
2024-04-30 22:42:08 INFO     Epoch [35/200] train_loss: 4.0770, val_loss: 5.1074, lr: 0.003000, 7.24s
2024-04-30 22:42:15 INFO     epoch complete!
2024-04-30 22:42:15 INFO     evaluating now!
2024-04-30 22:42:16 INFO     Epoch [36/200] train_loss: 4.0692, val_loss: 5.1865, lr: 0.003000, 7.20s
2024-04-30 22:42:22 INFO     epoch complete!
2024-04-30 22:42:22 INFO     evaluating now!
2024-04-30 22:42:23 INFO     Epoch [37/200] train_loss: 4.0553, val_loss: 5.1402, lr: 0.003000, 7.26s
2024-04-30 22:42:30 INFO     epoch complete!
2024-04-30 22:42:30 INFO     evaluating now!
2024-04-30 22:42:30 INFO     Epoch [38/200] train_loss: 3.9841, val_loss: 5.1302, lr: 0.003000, 7.19s
2024-04-30 22:42:37 INFO     epoch complete!
2024-04-30 22:42:37 INFO     evaluating now!
2024-04-30 22:42:37 INFO     Epoch [39/200] train_loss: 4.0211, val_loss: 5.1746, lr: 0.003000, 7.27s
2024-04-30 22:42:44 INFO     epoch complete!
2024-04-30 22:42:44 INFO     evaluating now!
2024-04-30 22:42:44 INFO     Epoch [40/200] train_loss: 3.9091, val_loss: 5.1855, lr: 0.003000, 7.18s
2024-04-30 22:42:51 INFO     epoch complete!
2024-04-30 22:42:51 INFO     evaluating now!
2024-04-30 22:42:52 INFO     Epoch [41/200] train_loss: 3.9093, val_loss: 5.0805, lr: 0.003000, 7.19s
2024-04-30 22:42:58 INFO     epoch complete!
2024-04-30 22:42:58 INFO     evaluating now!
2024-04-30 22:42:59 INFO     Epoch [42/200] train_loss: 3.9257, val_loss: 5.1160, lr: 0.003000, 7.20s
2024-04-30 22:43:05 INFO     epoch complete!
2024-04-30 22:43:05 INFO     evaluating now!
2024-04-30 22:43:06 INFO     Epoch [43/200] train_loss: 3.8789, val_loss: 4.9858, lr: 0.003000, 6.97s
2024-04-30 22:43:06 INFO     Saved model at 43
2024-04-30 22:43:06 INFO     Val loss decrease from 5.0560 to 4.9858, saving to ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-04-30 22:43:12 INFO     epoch complete!
2024-04-30 22:43:12 INFO     evaluating now!
2024-04-30 22:43:13 INFO     Epoch [44/200] train_loss: 3.8574, val_loss: 5.1751, lr: 0.003000, 6.99s
2024-04-30 22:43:20 INFO     epoch complete!
2024-04-30 22:43:20 INFO     evaluating now!
2024-04-30 22:43:20 INFO     Epoch [45/200] train_loss: 3.8439, val_loss: 5.1248, lr: 0.003000, 7.15s
2024-04-30 22:43:27 INFO     epoch complete!
2024-04-30 22:43:27 INFO     evaluating now!
2024-04-30 22:43:27 INFO     Epoch [46/200] train_loss: 3.8333, val_loss: 5.1165, lr: 0.003000, 7.28s
2024-04-30 22:43:34 INFO     epoch complete!
2024-04-30 22:43:34 INFO     evaluating now!
2024-04-30 22:43:34 INFO     Epoch [47/200] train_loss: 3.7894, val_loss: 5.0676, lr: 0.003000, 7.07s
2024-04-30 22:43:41 INFO     epoch complete!
2024-04-30 22:43:41 INFO     evaluating now!
2024-04-30 22:43:41 INFO     Epoch [48/200] train_loss: 3.7481, val_loss: 5.1545, lr: 0.003000, 7.09s
2024-04-30 22:43:48 INFO     epoch complete!
2024-04-30 22:43:48 INFO     evaluating now!
2024-04-30 22:43:49 INFO     Epoch [49/200] train_loss: 3.7220, val_loss: 5.1744, lr: 0.003000, 7.08s
2024-04-30 22:43:55 INFO     epoch complete!
2024-04-30 22:43:55 INFO     evaluating now!
2024-04-30 22:43:56 INFO     Epoch [50/200] train_loss: 3.7664, val_loss: 5.1953, lr: 0.003000, 7.09s
2024-04-30 22:44:02 INFO     epoch complete!
2024-04-30 22:44:02 INFO     evaluating now!
2024-04-30 22:44:03 INFO     Epoch [51/200] train_loss: 3.6965, val_loss: 5.1381, lr: 0.003000, 7.29s
2024-04-30 22:44:10 INFO     epoch complete!
2024-04-30 22:44:10 INFO     evaluating now!
2024-04-30 22:44:10 INFO     Epoch [52/200] train_loss: 3.6727, val_loss: 5.2420, lr: 0.003000, 7.16s
2024-04-30 22:44:17 INFO     epoch complete!
2024-04-30 22:44:17 INFO     evaluating now!
2024-04-30 22:44:17 INFO     Epoch [53/200] train_loss: 3.7153, val_loss: 5.1544, lr: 0.003000, 7.32s
2024-04-30 22:44:24 INFO     epoch complete!
2024-04-30 22:44:24 INFO     evaluating now!
2024-04-30 22:44:25 INFO     Epoch [54/200] train_loss: 3.7623, val_loss: 5.1961, lr: 0.003000, 7.31s
2024-04-30 22:44:31 INFO     epoch complete!
2024-04-30 22:44:31 INFO     evaluating now!
2024-04-30 22:44:32 INFO     Epoch [55/200] train_loss: 3.7197, val_loss: 5.0067, lr: 0.003000, 7.23s
2024-04-30 22:44:39 INFO     epoch complete!
2024-04-30 22:44:39 INFO     evaluating now!
2024-04-30 22:44:39 INFO     Epoch [56/200] train_loss: 3.6179, val_loss: 5.0815, lr: 0.003000, 7.24s
2024-04-30 22:44:46 INFO     epoch complete!
2024-04-30 22:44:46 INFO     evaluating now!
2024-04-30 22:44:46 INFO     Epoch [57/200] train_loss: 3.6245, val_loss: 5.1457, lr: 0.003000, 7.16s
2024-04-30 22:44:53 INFO     epoch complete!
2024-04-30 22:44:53 INFO     evaluating now!
2024-04-30 22:44:54 INFO     Epoch [58/200] train_loss: 3.6267, val_loss: 5.1858, lr: 0.003000, 7.18s
2024-04-30 22:44:54 WARNING  Early stopping at epoch: 58
2024-04-30 22:44:54 INFO     Trained totally 59 epochs, average train time is 6.656s, average eval time is 0.486s
2024-04-30 22:44:54 INFO     Loaded model at 43
2024-04-30 22:44:54 INFO     Saved model at ./libcity/cache/47/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 22:44:54 INFO     Start evaluating ...
2024-04-30 22:44:55 INFO     Note that you select the single mode to evaluate!
2024-04-30 22:44:55 INFO     Evaluate result is saved at ./libcity/cache/47/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 22:44:55 INFO     
         MAE       RMSE
1   2.426187   7.122291
2   2.531931   7.662689
3   2.635063   8.462153
4   2.811702   9.101957
5   2.889252   9.919354
6   3.026939  10.785266
7   3.072972  11.670232
8   3.143392  12.359520
9   3.200662  12.867072
10  3.286705  13.251488
11  3.379483  13.791326
12  3.509035  14.424624
2024-04-30 22:44:55 INFO     ----------------------------------------------------------------------------
2024-04-30 22:44:55 INFO     # 3, Kownledge Graph Embedding: AttE, Experiment ids: 48
2024-04-30 22:44:55 INFO     ----------------------------------------------------------------------------
2024-04-30 22:44:55 INFO     Log directory: ./libcity/log
2024-04-30 22:44:55 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=48
2024-04-30 22:44:55 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 305478958, 'exp_id': 48, 'load_external': True, 'embedding_model': 'AttE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 22:44:55 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 22:44:55 INFO     set_weight_link_or_dist: dist
2024-04-30 22:44:55 INFO     init_weight_inf_or_zero: inf
2024-04-30 22:44:56 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 22:44:56 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 22:44:56 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 22:44:56 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 22:44:59 INFO     Dataset created
2024-04-30 22:44:59 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 22:44:59 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 22:44:59 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 22:44:59 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 22:44:59 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 22:44:59 INFO     NoneScaler
2024-04-30 22:45:01 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 22:45:01 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 22:45:01 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 22:45:01 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 22:45:01 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 22:45:01 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 22:45:01 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 22:45:01 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 22:45:01 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 22:45:01 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 22:45:01 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 22:45:01 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 22:45:01 INFO     Total parameter numbers: 874010
2024-04-30 22:45:01 INFO     You select `adam` optimizer.
2024-04-30 22:45:01 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 22:45:01 INFO     Start training ...
2024-04-30 22:45:01 INFO     num_batches:48
2024-04-30 22:45:08 INFO     epoch complete!
2024-04-30 22:45:08 INFO     evaluating now!
2024-04-30 22:45:08 INFO     Epoch [0/200] train_loss: 23.8139, val_loss: 18.4853, lr: 0.003000, 7.16s
2024-04-30 22:45:08 INFO     Saved model at 0
2024-04-30 22:45:08 INFO     Val loss decrease from inf to 18.4853, saving to ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 22:45:15 INFO     epoch complete!
2024-04-30 22:45:15 INFO     evaluating now!
2024-04-30 22:45:15 INFO     Epoch [1/200] train_loss: 15.2517, val_loss: 14.6213, lr: 0.003000, 7.05s
2024-04-30 22:45:15 INFO     Saved model at 1
2024-04-30 22:45:15 INFO     Val loss decrease from 18.4853 to 14.6213, saving to ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 22:45:22 INFO     epoch complete!
2024-04-30 22:45:22 INFO     evaluating now!
2024-04-30 22:45:22 INFO     Epoch [2/200] train_loss: 12.0843, val_loss: 11.7074, lr: 0.003000, 7.08s
2024-04-30 22:45:22 INFO     Saved model at 2
2024-04-30 22:45:22 INFO     Val loss decrease from 14.6213 to 11.7074, saving to ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 22:45:29 INFO     epoch complete!
2024-04-30 22:45:29 INFO     evaluating now!
2024-04-30 22:45:30 INFO     Epoch [3/200] train_loss: 10.1166, val_loss: 9.7944, lr: 0.003000, 7.27s
2024-04-30 22:45:30 INFO     Saved model at 3
2024-04-30 22:45:30 INFO     Val loss decrease from 11.7074 to 9.7944, saving to ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 22:45:36 INFO     epoch complete!
2024-04-30 22:45:36 INFO     evaluating now!
2024-04-30 22:45:36 INFO     Epoch [4/200] train_loss: 8.6870, val_loss: 8.2833, lr: 0.003000, 6.72s
2024-04-30 22:45:36 INFO     Saved model at 4
2024-04-30 22:45:36 INFO     Val loss decrease from 9.7944 to 8.2833, saving to ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 22:45:43 INFO     epoch complete!
2024-04-30 22:45:43 INFO     evaluating now!
2024-04-30 22:45:43 INFO     Epoch [5/200] train_loss: 7.8341, val_loss: 7.7453, lr: 0.003000, 6.61s
2024-04-30 22:45:43 INFO     Saved model at 5
2024-04-30 22:45:43 INFO     Val loss decrease from 8.2833 to 7.7453, saving to ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 22:45:49 INFO     epoch complete!
2024-04-30 22:45:49 INFO     evaluating now!
2024-04-30 22:45:50 INFO     Epoch [6/200] train_loss: 7.1359, val_loss: 7.0902, lr: 0.003000, 6.64s
2024-04-30 22:45:50 INFO     Saved model at 6
2024-04-30 22:45:50 INFO     Val loss decrease from 7.7453 to 7.0902, saving to ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 22:45:56 INFO     epoch complete!
2024-04-30 22:45:56 INFO     evaluating now!
2024-04-30 22:45:56 INFO     Epoch [7/200] train_loss: 6.7430, val_loss: 6.8965, lr: 0.003000, 6.70s
2024-04-30 22:45:57 INFO     Saved model at 7
2024-04-30 22:45:57 INFO     Val loss decrease from 7.0902 to 6.8965, saving to ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 22:46:03 INFO     epoch complete!
2024-04-30 22:46:03 INFO     evaluating now!
2024-04-30 22:46:03 INFO     Epoch [8/200] train_loss: 6.3072, val_loss: 6.3389, lr: 0.003000, 6.64s
2024-04-30 22:46:03 INFO     Saved model at 8
2024-04-30 22:46:03 INFO     Val loss decrease from 6.8965 to 6.3389, saving to ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 22:46:09 INFO     epoch complete!
2024-04-30 22:46:09 INFO     evaluating now!
2024-04-30 22:46:10 INFO     Epoch [9/200] train_loss: 6.0951, val_loss: 6.3459, lr: 0.003000, 6.63s
2024-04-30 22:46:16 INFO     epoch complete!
2024-04-30 22:46:16 INFO     evaluating now!
2024-04-30 22:46:17 INFO     Epoch [10/200] train_loss: 5.9468, val_loss: 6.1399, lr: 0.003000, 7.07s
2024-04-30 22:46:17 INFO     Saved model at 10
2024-04-30 22:46:17 INFO     Val loss decrease from 6.3389 to 6.1399, saving to ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 22:46:24 INFO     epoch complete!
2024-04-30 22:46:24 INFO     evaluating now!
2024-04-30 22:46:24 INFO     Epoch [11/200] train_loss: 5.7114, val_loss: 6.0950, lr: 0.003000, 7.27s
2024-04-30 22:46:24 INFO     Saved model at 11
2024-04-30 22:46:24 INFO     Val loss decrease from 6.1399 to 6.0950, saving to ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 22:46:31 INFO     epoch complete!
2024-04-30 22:46:31 INFO     evaluating now!
2024-04-30 22:46:32 INFO     Epoch [12/200] train_loss: 5.6135, val_loss: 5.8226, lr: 0.003000, 7.28s
2024-04-30 22:46:32 INFO     Saved model at 12
2024-04-30 22:46:32 INFO     Val loss decrease from 6.0950 to 5.8226, saving to ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 22:46:38 INFO     epoch complete!
2024-04-30 22:46:38 INFO     evaluating now!
2024-04-30 22:46:39 INFO     Epoch [13/200] train_loss: 5.4612, val_loss: 5.7610, lr: 0.003000, 7.11s
2024-04-30 22:46:39 INFO     Saved model at 13
2024-04-30 22:46:39 INFO     Val loss decrease from 5.8226 to 5.7610, saving to ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 22:46:45 INFO     epoch complete!
2024-04-30 22:46:45 INFO     evaluating now!
2024-04-30 22:46:46 INFO     Epoch [14/200] train_loss: 5.4144, val_loss: 5.8872, lr: 0.003000, 7.15s
2024-04-30 22:46:52 INFO     epoch complete!
2024-04-30 22:46:52 INFO     evaluating now!
2024-04-30 22:46:53 INFO     Epoch [15/200] train_loss: 5.3220, val_loss: 5.6887, lr: 0.003000, 7.05s
2024-04-30 22:46:53 INFO     Saved model at 15
2024-04-30 22:46:53 INFO     Val loss decrease from 5.7610 to 5.6887, saving to ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 22:47:00 INFO     epoch complete!
2024-04-30 22:47:00 INFO     evaluating now!
2024-04-30 22:47:00 INFO     Epoch [16/200] train_loss: 5.2211, val_loss: 5.6910, lr: 0.003000, 7.09s
2024-04-30 22:47:07 INFO     epoch complete!
2024-04-30 22:47:07 INFO     evaluating now!
2024-04-30 22:47:07 INFO     Epoch [17/200] train_loss: 5.1653, val_loss: 5.5772, lr: 0.003000, 7.15s
2024-04-30 22:47:07 INFO     Saved model at 17
2024-04-30 22:47:07 INFO     Val loss decrease from 5.6887 to 5.5772, saving to ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 22:47:14 INFO     epoch complete!
2024-04-30 22:47:14 INFO     evaluating now!
2024-04-30 22:47:15 INFO     Epoch [18/200] train_loss: 5.0442, val_loss: 5.6345, lr: 0.003000, 7.30s
2024-04-30 22:47:21 INFO     epoch complete!
2024-04-30 22:47:21 INFO     evaluating now!
2024-04-30 22:47:22 INFO     Epoch [19/200] train_loss: 4.9419, val_loss: 5.5397, lr: 0.003000, 7.33s
2024-04-30 22:47:22 INFO     Saved model at 19
2024-04-30 22:47:22 INFO     Val loss decrease from 5.5772 to 5.5397, saving to ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 22:47:29 INFO     epoch complete!
2024-04-30 22:47:29 INFO     evaluating now!
2024-04-30 22:47:29 INFO     Epoch [20/200] train_loss: 4.8742, val_loss: 5.4366, lr: 0.003000, 7.36s
2024-04-30 22:47:29 INFO     Saved model at 20
2024-04-30 22:47:29 INFO     Val loss decrease from 5.5397 to 5.4366, saving to ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-30 22:47:36 INFO     epoch complete!
2024-04-30 22:47:36 INFO     evaluating now!
2024-04-30 22:47:37 INFO     Epoch [21/200] train_loss: 4.9128, val_loss: 5.5721, lr: 0.003000, 7.38s
2024-04-30 22:47:44 INFO     epoch complete!
2024-04-30 22:47:44 INFO     evaluating now!
2024-04-30 22:47:44 INFO     Epoch [22/200] train_loss: 4.8827, val_loss: 5.2258, lr: 0.003000, 7.26s
2024-04-30 22:47:44 INFO     Saved model at 22
2024-04-30 22:47:44 INFO     Val loss decrease from 5.4366 to 5.2258, saving to ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-30 22:47:51 INFO     epoch complete!
2024-04-30 22:47:51 INFO     evaluating now!
2024-04-30 22:47:51 INFO     Epoch [23/200] train_loss: 4.7759, val_loss: 5.5143, lr: 0.003000, 7.13s
2024-04-30 22:47:58 INFO     epoch complete!
2024-04-30 22:47:58 INFO     evaluating now!
2024-04-30 22:47:58 INFO     Epoch [24/200] train_loss: 4.7078, val_loss: 5.4270, lr: 0.003000, 7.24s
2024-04-30 22:48:05 INFO     epoch complete!
2024-04-30 22:48:05 INFO     evaluating now!
2024-04-30 22:48:06 INFO     Epoch [25/200] train_loss: 4.6759, val_loss: 5.0829, lr: 0.003000, 7.09s
2024-04-30 22:48:06 INFO     Saved model at 25
2024-04-30 22:48:06 INFO     Val loss decrease from 5.2258 to 5.0829, saving to ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-30 22:48:12 INFO     epoch complete!
2024-04-30 22:48:12 INFO     evaluating now!
2024-04-30 22:48:13 INFO     Epoch [26/200] train_loss: 4.5356, val_loss: 5.3041, lr: 0.003000, 7.15s
2024-04-30 22:48:19 INFO     epoch complete!
2024-04-30 22:48:19 INFO     evaluating now!
2024-04-30 22:48:20 INFO     Epoch [27/200] train_loss: 4.5354, val_loss: 5.3429, lr: 0.003000, 7.11s
2024-04-30 22:48:27 INFO     epoch complete!
2024-04-30 22:48:27 INFO     evaluating now!
2024-04-30 22:48:27 INFO     Epoch [28/200] train_loss: 4.4617, val_loss: 5.4875, lr: 0.003000, 7.31s
2024-04-30 22:48:34 INFO     epoch complete!
2024-04-30 22:48:34 INFO     evaluating now!
2024-04-30 22:48:34 INFO     Epoch [29/200] train_loss: 4.6130, val_loss: 5.3825, lr: 0.003000, 7.16s
2024-04-30 22:48:41 INFO     epoch complete!
2024-04-30 22:48:41 INFO     evaluating now!
2024-04-30 22:48:41 INFO     Epoch [30/200] train_loss: 4.4110, val_loss: 5.1744, lr: 0.003000, 7.15s
2024-04-30 22:48:48 INFO     epoch complete!
2024-04-30 22:48:48 INFO     evaluating now!
2024-04-30 22:48:49 INFO     Epoch [31/200] train_loss: 4.3724, val_loss: 5.1765, lr: 0.003000, 7.15s
2024-04-30 22:48:55 INFO     epoch complete!
2024-04-30 22:48:55 INFO     evaluating now!
2024-04-30 22:48:56 INFO     Epoch [32/200] train_loss: 4.3292, val_loss: 5.1253, lr: 0.003000, 7.17s
2024-04-30 22:49:03 INFO     epoch complete!
2024-04-30 22:49:03 INFO     evaluating now!
2024-04-30 22:49:03 INFO     Epoch [33/200] train_loss: 4.2925, val_loss: 5.3830, lr: 0.003000, 7.27s
2024-04-30 22:49:10 INFO     epoch complete!
2024-04-30 22:49:10 INFO     evaluating now!
2024-04-30 22:49:10 INFO     Epoch [34/200] train_loss: 4.1576, val_loss: 5.1346, lr: 0.003000, 7.13s
2024-04-30 22:49:17 INFO     epoch complete!
2024-04-30 22:49:17 INFO     evaluating now!
2024-04-30 22:49:17 INFO     Epoch [35/200] train_loss: 4.1631, val_loss: 5.3229, lr: 0.003000, 7.19s
2024-04-30 22:49:24 INFO     epoch complete!
2024-04-30 22:49:24 INFO     evaluating now!
2024-04-30 22:49:25 INFO     Epoch [36/200] train_loss: 4.3025, val_loss: 5.3807, lr: 0.003000, 7.26s
2024-04-30 22:49:31 INFO     epoch complete!
2024-04-30 22:49:31 INFO     evaluating now!
2024-04-30 22:49:32 INFO     Epoch [37/200] train_loss: 4.2524, val_loss: 5.2381, lr: 0.003000, 7.24s
2024-04-30 22:49:39 INFO     epoch complete!
2024-04-30 22:49:39 INFO     evaluating now!
2024-04-30 22:49:39 INFO     Epoch [38/200] train_loss: 4.0837, val_loss: 5.2115, lr: 0.003000, 7.24s
2024-04-30 22:49:46 INFO     epoch complete!
2024-04-30 22:49:46 INFO     evaluating now!
2024-04-30 22:49:46 INFO     Epoch [39/200] train_loss: 4.0198, val_loss: 5.1792, lr: 0.003000, 7.23s
2024-04-30 22:49:53 INFO     epoch complete!
2024-04-30 22:49:53 INFO     evaluating now!
2024-04-30 22:49:54 INFO     Epoch [40/200] train_loss: 4.0233, val_loss: 5.1832, lr: 0.003000, 7.21s
2024-04-30 22:49:54 WARNING  Early stopping at epoch: 40
2024-04-30 22:49:54 INFO     Trained totally 41 epochs, average train time is 6.627s, average eval time is 0.485s
2024-04-30 22:49:54 INFO     Loaded model at 25
2024-04-30 22:49:54 INFO     Saved model at ./libcity/cache/48/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 22:49:54 INFO     Start evaluating ...
2024-04-30 22:49:55 INFO     Note that you select the single mode to evaluate!
2024-04-30 22:49:55 INFO     Evaluate result is saved at ./libcity/cache/48/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 22:49:55 INFO     
         MAE       RMSE
1   2.531749   7.470154
2   2.615696   7.935552
3   2.806720   9.002857
4   2.954128   9.826034
5   3.069956  10.456656
6   3.163042  11.004020
7   3.162900  11.573146
8   3.180546  11.993948
9   3.201135  12.492005
10  3.273622  13.010907
11  3.357905  13.501139
12  3.462681  14.350094
2024-04-30 22:49:55 INFO     ----------------------------------------------------------------------------
2024-04-30 22:49:55 INFO     # 4, Kownledge Graph Embedding: AttE, Experiment ids: 49
2024-04-30 22:49:55 INFO     ----------------------------------------------------------------------------
2024-04-30 22:49:56 INFO     Log directory: ./libcity/log
2024-04-30 22:49:56 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=49
2024-04-30 22:49:56 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 851095817, 'exp_id': 49, 'load_external': True, 'embedding_model': 'AttE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 22:49:56 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 22:49:56 INFO     set_weight_link_or_dist: dist
2024-04-30 22:49:56 INFO     init_weight_inf_or_zero: inf
2024-04-30 22:49:56 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 22:49:56 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 22:49:56 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 22:49:56 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 22:49:59 INFO     Dataset created
2024-04-30 22:49:59 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 22:49:59 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 22:49:59 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 22:49:59 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 22:49:59 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 22:49:59 INFO     NoneScaler
2024-04-30 22:50:01 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 22:50:01 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 22:50:01 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 22:50:01 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 22:50:01 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 22:50:01 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 22:50:01 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 22:50:01 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 22:50:01 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 22:50:01 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 22:50:01 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 22:50:01 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 22:50:01 INFO     Total parameter numbers: 874010
2024-04-30 22:50:01 INFO     You select `adam` optimizer.
2024-04-30 22:50:01 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 22:50:01 INFO     Start training ...
2024-04-30 22:50:01 INFO     num_batches:48
2024-04-30 22:50:08 INFO     epoch complete!
2024-04-30 22:50:08 INFO     evaluating now!
2024-04-30 22:50:08 INFO     Epoch [0/200] train_loss: 23.0185, val_loss: 18.3928, lr: 0.003000, 7.38s
2024-04-30 22:50:09 INFO     Saved model at 0
2024-04-30 22:50:09 INFO     Val loss decrease from inf to 18.3928, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 22:50:15 INFO     epoch complete!
2024-04-30 22:50:15 INFO     evaluating now!
2024-04-30 22:50:16 INFO     Epoch [1/200] train_loss: 14.8677, val_loss: 14.4622, lr: 0.003000, 7.32s
2024-04-30 22:50:16 INFO     Saved model at 1
2024-04-30 22:50:16 INFO     Val loss decrease from 18.3928 to 14.4622, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 22:50:23 INFO     epoch complete!
2024-04-30 22:50:23 INFO     evaluating now!
2024-04-30 22:50:23 INFO     Epoch [2/200] train_loss: 11.8441, val_loss: 11.1136, lr: 0.003000, 7.32s
2024-04-30 22:50:23 INFO     Saved model at 2
2024-04-30 22:50:23 INFO     Val loss decrease from 14.4622 to 11.1136, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 22:50:30 INFO     epoch complete!
2024-04-30 22:50:30 INFO     evaluating now!
2024-04-30 22:50:31 INFO     Epoch [3/200] train_loss: 9.7805, val_loss: 9.4984, lr: 0.003000, 7.26s
2024-04-30 22:50:31 INFO     Saved model at 3
2024-04-30 22:50:31 INFO     Val loss decrease from 11.1136 to 9.4984, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 22:50:37 INFO     epoch complete!
2024-04-30 22:50:37 INFO     evaluating now!
2024-04-30 22:50:38 INFO     Epoch [4/200] train_loss: 8.4122, val_loss: 7.9773, lr: 0.003000, 7.19s
2024-04-30 22:50:38 INFO     Saved model at 4
2024-04-30 22:50:38 INFO     Val loss decrease from 9.4984 to 7.9773, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 22:50:44 INFO     epoch complete!
2024-04-30 22:50:44 INFO     evaluating now!
2024-04-30 22:50:45 INFO     Epoch [5/200] train_loss: 7.5932, val_loss: 7.5191, lr: 0.003000, 7.18s
2024-04-30 22:50:45 INFO     Saved model at 5
2024-04-30 22:50:45 INFO     Val loss decrease from 7.9773 to 7.5191, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 22:50:52 INFO     epoch complete!
2024-04-30 22:50:52 INFO     evaluating now!
2024-04-30 22:50:52 INFO     Epoch [6/200] train_loss: 6.9309, val_loss: 7.2351, lr: 0.003000, 7.20s
2024-04-30 22:50:52 INFO     Saved model at 6
2024-04-30 22:50:52 INFO     Val loss decrease from 7.5191 to 7.2351, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 22:50:59 INFO     epoch complete!
2024-04-30 22:50:59 INFO     evaluating now!
2024-04-30 22:50:59 INFO     Epoch [7/200] train_loss: 6.5655, val_loss: 6.5574, lr: 0.003000, 7.20s
2024-04-30 22:50:59 INFO     Saved model at 7
2024-04-30 22:50:59 INFO     Val loss decrease from 7.2351 to 6.5574, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 22:51:06 INFO     epoch complete!
2024-04-30 22:51:06 INFO     evaluating now!
2024-04-30 22:51:07 INFO     Epoch [8/200] train_loss: 6.1975, val_loss: 6.2394, lr: 0.003000, 7.11s
2024-04-30 22:51:07 INFO     Saved model at 8
2024-04-30 22:51:07 INFO     Val loss decrease from 6.5574 to 6.2394, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 22:51:13 INFO     epoch complete!
2024-04-30 22:51:13 INFO     evaluating now!
2024-04-30 22:51:14 INFO     Epoch [9/200] train_loss: 5.9460, val_loss: 6.2382, lr: 0.003000, 7.15s
2024-04-30 22:51:14 INFO     Saved model at 9
2024-04-30 22:51:14 INFO     Val loss decrease from 6.2394 to 6.2382, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 22:51:20 INFO     epoch complete!
2024-04-30 22:51:20 INFO     evaluating now!
2024-04-30 22:51:21 INFO     Epoch [10/200] train_loss: 5.8502, val_loss: 6.1249, lr: 0.003000, 7.07s
2024-04-30 22:51:21 INFO     Saved model at 10
2024-04-30 22:51:21 INFO     Val loss decrease from 6.2382 to 6.1249, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 22:51:28 INFO     epoch complete!
2024-04-30 22:51:28 INFO     evaluating now!
2024-04-30 22:51:28 INFO     Epoch [11/200] train_loss: 5.6874, val_loss: 6.0050, lr: 0.003000, 7.24s
2024-04-30 22:51:28 INFO     Saved model at 11
2024-04-30 22:51:28 INFO     Val loss decrease from 6.1249 to 6.0050, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 22:51:35 INFO     epoch complete!
2024-04-30 22:51:35 INFO     evaluating now!
2024-04-30 22:51:35 INFO     Epoch [12/200] train_loss: 5.5045, val_loss: 6.1106, lr: 0.003000, 7.17s
2024-04-30 22:51:42 INFO     epoch complete!
2024-04-30 22:51:42 INFO     evaluating now!
2024-04-30 22:51:43 INFO     Epoch [13/200] train_loss: 5.4399, val_loss: 5.7330, lr: 0.003000, 7.17s
2024-04-30 22:51:43 INFO     Saved model at 13
2024-04-30 22:51:43 INFO     Val loss decrease from 6.0050 to 5.7330, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 22:51:50 INFO     epoch complete!
2024-04-30 22:51:50 INFO     evaluating now!
2024-04-30 22:51:50 INFO     Epoch [14/200] train_loss: 5.3545, val_loss: 5.5878, lr: 0.003000, 7.36s
2024-04-30 22:51:50 INFO     Saved model at 14
2024-04-30 22:51:50 INFO     Val loss decrease from 5.7330 to 5.5878, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 22:51:56 INFO     epoch complete!
2024-04-30 22:51:56 INFO     evaluating now!
2024-04-30 22:51:57 INFO     Epoch [15/200] train_loss: 5.2530, val_loss: 5.5757, lr: 0.003000, 6.68s
2024-04-30 22:51:57 INFO     Saved model at 15
2024-04-30 22:51:57 INFO     Val loss decrease from 5.5878 to 5.5757, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 22:52:03 INFO     epoch complete!
2024-04-30 22:52:03 INFO     evaluating now!
2024-04-30 22:52:03 INFO     Epoch [16/200] train_loss: 5.1740, val_loss: 5.7745, lr: 0.003000, 6.55s
2024-04-30 22:52:09 INFO     epoch complete!
2024-04-30 22:52:09 INFO     evaluating now!
2024-04-30 22:52:10 INFO     Epoch [17/200] train_loss: 5.0266, val_loss: 5.6502, lr: 0.003000, 6.58s
2024-04-30 22:52:16 INFO     epoch complete!
2024-04-30 22:52:16 INFO     evaluating now!
2024-04-30 22:52:16 INFO     Epoch [18/200] train_loss: 4.9146, val_loss: 5.4810, lr: 0.003000, 6.63s
2024-04-30 22:52:17 INFO     Saved model at 18
2024-04-30 22:52:17 INFO     Val loss decrease from 5.5757 to 5.4810, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 22:52:23 INFO     epoch complete!
2024-04-30 22:52:23 INFO     evaluating now!
2024-04-30 22:52:23 INFO     Epoch [19/200] train_loss: 4.8619, val_loss: 5.6968, lr: 0.003000, 6.55s
2024-04-30 22:52:29 INFO     epoch complete!
2024-04-30 22:52:29 INFO     evaluating now!
2024-04-30 22:52:30 INFO     Epoch [20/200] train_loss: 4.9828, val_loss: 5.2804, lr: 0.003000, 6.64s
2024-04-30 22:52:30 INFO     Saved model at 20
2024-04-30 22:52:30 INFO     Val loss decrease from 5.4810 to 5.2804, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-30 22:52:37 INFO     epoch complete!
2024-04-30 22:52:37 INFO     evaluating now!
2024-04-30 22:52:37 INFO     Epoch [21/200] train_loss: 4.8573, val_loss: 5.5043, lr: 0.003000, 7.29s
2024-04-30 22:52:44 INFO     epoch complete!
2024-04-30 22:52:44 INFO     evaluating now!
2024-04-30 22:52:44 INFO     Epoch [22/200] train_loss: 4.7898, val_loss: 5.4391, lr: 0.003000, 7.38s
2024-04-30 22:52:52 INFO     epoch complete!
2024-04-30 22:52:52 INFO     evaluating now!
2024-04-30 22:52:52 INFO     Epoch [23/200] train_loss: 4.6950, val_loss: 5.1570, lr: 0.003000, 7.57s
2024-04-30 22:52:52 INFO     Saved model at 23
2024-04-30 22:52:52 INFO     Val loss decrease from 5.2804 to 5.1570, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-30 22:52:59 INFO     epoch complete!
2024-04-30 22:52:59 INFO     evaluating now!
2024-04-30 22:52:59 INFO     Epoch [24/200] train_loss: 4.6984, val_loss: 5.6237, lr: 0.003000, 7.35s
2024-04-30 22:53:06 INFO     epoch complete!
2024-04-30 22:53:06 INFO     evaluating now!
2024-04-30 22:53:07 INFO     Epoch [25/200] train_loss: 4.5716, val_loss: 5.2872, lr: 0.003000, 7.23s
2024-04-30 22:53:13 INFO     epoch complete!
2024-04-30 22:53:13 INFO     evaluating now!
2024-04-30 22:53:14 INFO     Epoch [26/200] train_loss: 4.5834, val_loss: 5.4479, lr: 0.003000, 7.29s
2024-04-30 22:53:21 INFO     epoch complete!
2024-04-30 22:53:21 INFO     evaluating now!
2024-04-30 22:53:21 INFO     Epoch [27/200] train_loss: 4.5036, val_loss: 5.0965, lr: 0.003000, 7.17s
2024-04-30 22:53:21 INFO     Saved model at 27
2024-04-30 22:53:21 INFO     Val loss decrease from 5.1570 to 5.0965, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-30 22:53:28 INFO     epoch complete!
2024-04-30 22:53:28 INFO     evaluating now!
2024-04-30 22:53:28 INFO     Epoch [28/200] train_loss: 4.4458, val_loss: 5.2431, lr: 0.003000, 7.20s
2024-04-30 22:53:35 INFO     epoch complete!
2024-04-30 22:53:35 INFO     evaluating now!
2024-04-30 22:53:36 INFO     Epoch [29/200] train_loss: 4.3902, val_loss: 5.2348, lr: 0.003000, 7.18s
2024-04-30 22:53:42 INFO     epoch complete!
2024-04-30 22:53:42 INFO     evaluating now!
2024-04-30 22:53:43 INFO     Epoch [30/200] train_loss: 4.3135, val_loss: 5.1098, lr: 0.003000, 7.19s
2024-04-30 22:53:49 INFO     epoch complete!
2024-04-30 22:53:49 INFO     evaluating now!
2024-04-30 22:53:50 INFO     Epoch [31/200] train_loss: 4.4495, val_loss: 5.1985, lr: 0.003000, 7.15s
2024-04-30 22:53:57 INFO     epoch complete!
2024-04-30 22:53:57 INFO     evaluating now!
2024-04-30 22:53:57 INFO     Epoch [32/200] train_loss: 4.2797, val_loss: 5.1680, lr: 0.003000, 7.17s
2024-04-30 22:54:04 INFO     epoch complete!
2024-04-30 22:54:04 INFO     evaluating now!
2024-04-30 22:54:04 INFO     Epoch [33/200] train_loss: 4.2476, val_loss: 5.1219, lr: 0.003000, 7.30s
2024-04-30 22:54:11 INFO     epoch complete!
2024-04-30 22:54:11 INFO     evaluating now!
2024-04-30 22:54:12 INFO     Epoch [34/200] train_loss: 4.1929, val_loss: 5.2625, lr: 0.003000, 7.22s
2024-04-30 22:54:19 INFO     epoch complete!
2024-04-30 22:54:19 INFO     evaluating now!
2024-04-30 22:54:19 INFO     Epoch [35/200] train_loss: 4.2076, val_loss: 5.0751, lr: 0.003000, 7.40s
2024-04-30 22:54:19 INFO     Saved model at 35
2024-04-30 22:54:19 INFO     Val loss decrease from 5.0965 to 5.0751, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-04-30 22:54:26 INFO     epoch complete!
2024-04-30 22:54:26 INFO     evaluating now!
2024-04-30 22:54:27 INFO     Epoch [36/200] train_loss: 4.1941, val_loss: 5.2633, lr: 0.003000, 7.49s
2024-04-30 22:54:33 INFO     epoch complete!
2024-04-30 22:54:33 INFO     evaluating now!
2024-04-30 22:54:34 INFO     Epoch [37/200] train_loss: 4.2051, val_loss: 5.2747, lr: 0.003000, 7.37s
2024-04-30 22:54:41 INFO     epoch complete!
2024-04-30 22:54:41 INFO     evaluating now!
2024-04-30 22:54:41 INFO     Epoch [38/200] train_loss: 4.1344, val_loss: 5.1382, lr: 0.003000, 7.46s
2024-04-30 22:54:48 INFO     epoch complete!
2024-04-30 22:54:48 INFO     evaluating now!
2024-04-30 22:54:49 INFO     Epoch [39/200] train_loss: 4.0630, val_loss: 5.0943, lr: 0.003000, 7.32s
2024-04-30 22:54:55 INFO     epoch complete!
2024-04-30 22:54:55 INFO     evaluating now!
2024-04-30 22:54:56 INFO     Epoch [40/200] train_loss: 4.0395, val_loss: 5.1294, lr: 0.003000, 7.28s
2024-04-30 22:55:03 INFO     epoch complete!
2024-04-30 22:55:03 INFO     evaluating now!
2024-04-30 22:55:04 INFO     Epoch [41/200] train_loss: 3.9913, val_loss: 5.0641, lr: 0.003000, 7.82s
2024-04-30 22:55:04 INFO     Saved model at 41
2024-04-30 22:55:04 INFO     Val loss decrease from 5.0751 to 5.0641, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-04-30 22:55:11 INFO     epoch complete!
2024-04-30 22:55:11 INFO     evaluating now!
2024-04-30 22:55:12 INFO     Epoch [42/200] train_loss: 4.0254, val_loss: 5.3229, lr: 0.003000, 7.96s
2024-04-30 22:55:19 INFO     epoch complete!
2024-04-30 22:55:19 INFO     evaluating now!
2024-04-30 22:55:20 INFO     Epoch [43/200] train_loss: 4.0109, val_loss: 5.1860, lr: 0.003000, 7.84s
2024-04-30 22:55:25 INFO     epoch complete!
2024-04-30 22:55:25 INFO     evaluating now!
2024-04-30 22:55:26 INFO     Epoch [44/200] train_loss: 3.9489, val_loss: 5.1932, lr: 0.003000, 6.18s
2024-04-30 22:55:32 INFO     epoch complete!
2024-04-30 22:55:32 INFO     evaluating now!
2024-04-30 22:55:32 INFO     Epoch [45/200] train_loss: 3.9608, val_loss: 5.1274, lr: 0.003000, 6.42s
2024-04-30 22:55:39 INFO     epoch complete!
2024-04-30 22:55:39 INFO     evaluating now!
2024-04-30 22:55:39 INFO     Epoch [46/200] train_loss: 3.9155, val_loss: 5.0890, lr: 0.003000, 6.86s
2024-04-30 22:55:46 INFO     epoch complete!
2024-04-30 22:55:46 INFO     evaluating now!
2024-04-30 22:55:46 INFO     Epoch [47/200] train_loss: 3.8539, val_loss: 5.1197, lr: 0.003000, 6.94s
2024-04-30 22:55:53 INFO     epoch complete!
2024-04-30 22:55:53 INFO     evaluating now!
2024-04-30 22:55:53 INFO     Epoch [48/200] train_loss: 3.8765, val_loss: 5.2969, lr: 0.003000, 6.90s
2024-04-30 22:56:00 INFO     epoch complete!
2024-04-30 22:56:00 INFO     evaluating now!
2024-04-30 22:56:00 INFO     Epoch [49/200] train_loss: 3.8765, val_loss: 5.0449, lr: 0.003000, 6.97s
2024-04-30 22:56:00 INFO     Saved model at 49
2024-04-30 22:56:00 INFO     Val loss decrease from 5.0641 to 5.0449, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-04-30 22:56:07 INFO     epoch complete!
2024-04-30 22:56:07 INFO     evaluating now!
2024-04-30 22:56:07 INFO     Epoch [50/200] train_loss: 3.8162, val_loss: 5.1823, lr: 0.003000, 7.03s
2024-04-30 22:56:13 INFO     epoch complete!
2024-04-30 22:56:13 INFO     evaluating now!
2024-04-30 22:56:14 INFO     Epoch [51/200] train_loss: 3.8013, val_loss: 5.1967, lr: 0.003000, 6.86s
2024-04-30 22:56:20 INFO     epoch complete!
2024-04-30 22:56:20 INFO     evaluating now!
2024-04-30 22:56:21 INFO     Epoch [52/200] train_loss: 3.7618, val_loss: 5.2974, lr: 0.003000, 6.81s
2024-04-30 22:56:27 INFO     epoch complete!
2024-04-30 22:56:27 INFO     evaluating now!
2024-04-30 22:56:28 INFO     Epoch [53/200] train_loss: 3.8003, val_loss: 5.1183, lr: 0.003000, 6.86s
2024-04-30 22:56:34 INFO     epoch complete!
2024-04-30 22:56:34 INFO     evaluating now!
2024-04-30 22:56:34 INFO     Epoch [54/200] train_loss: 3.7172, val_loss: 5.1123, lr: 0.003000, 6.79s
2024-04-30 22:56:41 INFO     epoch complete!
2024-04-30 22:56:41 INFO     evaluating now!
2024-04-30 22:56:41 INFO     Epoch [55/200] train_loss: 3.7627, val_loss: 5.2490, lr: 0.003000, 6.83s
2024-04-30 22:56:48 INFO     epoch complete!
2024-04-30 22:56:48 INFO     evaluating now!
2024-04-30 22:56:48 INFO     Epoch [56/200] train_loss: 3.7818, val_loss: 5.0881, lr: 0.003000, 6.81s
2024-04-30 22:56:55 INFO     epoch complete!
2024-04-30 22:56:55 INFO     evaluating now!
2024-04-30 22:56:55 INFO     Epoch [57/200] train_loss: 3.6925, val_loss: 5.2690, lr: 0.003000, 7.04s
2024-04-30 22:57:02 INFO     epoch complete!
2024-04-30 22:57:02 INFO     evaluating now!
2024-04-30 22:57:02 INFO     Epoch [58/200] train_loss: 3.7025, val_loss: 5.2688, lr: 0.003000, 7.03s
2024-04-30 22:57:09 INFO     epoch complete!
2024-04-30 22:57:09 INFO     evaluating now!
2024-04-30 22:57:09 INFO     Epoch [59/200] train_loss: 3.6543, val_loss: 5.0954, lr: 0.003000, 6.95s
2024-04-30 22:57:16 INFO     epoch complete!
2024-04-30 22:57:16 INFO     evaluating now!
2024-04-30 22:57:16 INFO     Epoch [60/200] train_loss: 3.5987, val_loss: 5.0732, lr: 0.003000, 7.31s
2024-04-30 22:57:22 INFO     epoch complete!
2024-04-30 22:57:22 INFO     evaluating now!
2024-04-30 22:57:22 INFO     Epoch [61/200] train_loss: 3.6053, val_loss: 4.9072, lr: 0.003000, 5.59s
2024-04-30 22:57:24 INFO     Saved model at 61
2024-04-30 22:57:24 INFO     Val loss decrease from 5.0449 to 4.9072, saving to ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406_epoch61.tar
2024-04-30 22:57:30 INFO     epoch complete!
2024-04-30 22:57:30 INFO     evaluating now!
2024-04-30 22:57:30 INFO     Epoch [62/200] train_loss: 3.6860, val_loss: 5.0510, lr: 0.003000, 6.71s
2024-04-30 22:57:37 INFO     epoch complete!
2024-04-30 22:57:37 INFO     evaluating now!
2024-04-30 22:57:38 INFO     Epoch [63/200] train_loss: 3.6098, val_loss: 4.9578, lr: 0.003000, 7.26s
2024-04-30 22:57:45 INFO     epoch complete!
2024-04-30 22:57:45 INFO     evaluating now!
2024-04-30 22:57:45 INFO     Epoch [64/200] train_loss: 3.5855, val_loss: 5.0807, lr: 0.003000, 7.39s
2024-04-30 22:57:52 INFO     epoch complete!
2024-04-30 22:57:52 INFO     evaluating now!
2024-04-30 22:57:52 INFO     Epoch [65/200] train_loss: 3.5486, val_loss: 5.0484, lr: 0.003000, 7.36s
2024-04-30 22:57:59 INFO     epoch complete!
2024-04-30 22:57:59 INFO     evaluating now!
2024-04-30 22:58:00 INFO     Epoch [66/200] train_loss: 3.5926, val_loss: 5.1316, lr: 0.003000, 7.31s
2024-04-30 22:58:06 INFO     epoch complete!
2024-04-30 22:58:06 INFO     evaluating now!
2024-04-30 22:58:07 INFO     Epoch [67/200] train_loss: 3.5601, val_loss: 5.1287, lr: 0.003000, 7.02s
2024-04-30 22:58:13 INFO     epoch complete!
2024-04-30 22:58:13 INFO     evaluating now!
2024-04-30 22:58:14 INFO     Epoch [68/200] train_loss: 3.5281, val_loss: 5.1594, lr: 0.003000, 7.11s
2024-04-30 22:58:21 INFO     epoch complete!
2024-04-30 22:58:21 INFO     evaluating now!
2024-04-30 22:58:21 INFO     Epoch [69/200] train_loss: 3.4616, val_loss: 5.0142, lr: 0.003000, 7.20s
2024-04-30 22:58:27 INFO     epoch complete!
2024-04-30 22:58:27 INFO     evaluating now!
2024-04-30 22:58:27 INFO     Epoch [70/200] train_loss: 3.4787, val_loss: 5.0347, lr: 0.003000, 6.32s
2024-04-30 22:58:33 INFO     epoch complete!
2024-04-30 22:58:33 INFO     evaluating now!
2024-04-30 22:58:33 INFO     Epoch [71/200] train_loss: 3.4653, val_loss: 5.0161, lr: 0.003000, 5.84s
2024-04-30 22:58:39 INFO     epoch complete!
2024-04-30 22:58:39 INFO     evaluating now!
2024-04-30 22:58:39 INFO     Epoch [72/200] train_loss: 3.4945, val_loss: 5.0471, lr: 0.003000, 6.20s
2024-04-30 22:58:46 INFO     epoch complete!
2024-04-30 22:58:46 INFO     evaluating now!
2024-04-30 22:58:47 INFO     Epoch [73/200] train_loss: 3.4973, val_loss: 5.1785, lr: 0.003000, 7.17s
2024-04-30 22:58:52 INFO     epoch complete!
2024-04-30 22:58:52 INFO     evaluating now!
2024-04-30 22:58:53 INFO     Epoch [74/200] train_loss: 3.5014, val_loss: 4.9634, lr: 0.003000, 6.15s
2024-04-30 22:58:59 INFO     epoch complete!
2024-04-30 22:58:59 INFO     evaluating now!
2024-04-30 22:59:00 INFO     Epoch [75/200] train_loss: 3.4331, val_loss: 5.0033, lr: 0.003000, 6.96s
2024-04-30 22:59:06 INFO     epoch complete!
2024-04-30 22:59:06 INFO     evaluating now!
2024-04-30 22:59:06 INFO     Epoch [76/200] train_loss: 3.4615, val_loss: 4.9926, lr: 0.003000, 6.59s
2024-04-30 22:59:06 WARNING  Early stopping at epoch: 76
2024-04-30 22:59:06 INFO     Trained totally 77 epochs, average train time is 6.570s, average eval time is 0.470s
2024-04-30 22:59:06 INFO     Loaded model at 61
2024-04-30 22:59:06 INFO     Saved model at ./libcity/cache/49/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 22:59:06 INFO     Start evaluating ...
2024-04-30 22:59:08 INFO     Note that you select the single mode to evaluate!
2024-04-30 22:59:08 INFO     Evaluate result is saved at ./libcity/cache/49/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 22:59:08 INFO     
         MAE       RMSE
1   2.379443   6.937613
2   2.436930   7.501488
3   2.619084   8.527651
4   2.796950   9.480172
5   2.942390  10.517157
6   3.104242  11.531415
7   3.210561  12.403884
8   3.245797  12.961944
9   3.307513  13.242203
10  3.307508  13.423506
11  3.331329  13.623923
12  3.503854  14.144769
2024-04-30 22:59:08 INFO     ----------------------------------------------------------------------------
2024-04-30 22:59:08 INFO     Kownledge Graph Embedding: AttE, Experiment ids: [45, 46, 47, 48, 49]
2024-04-30 22:59:08 INFO     ----------------------------------------------------------------------------
2024-04-30 22:59:08 INFO     Average: 
         MAE       RMSE
0   2.418818   7.115724
1   2.509657   7.673526
2   2.670717   8.649237
3   2.817546   9.409310
4   2.931839  10.204070
5   3.070473  11.042634
6   3.142300  11.879773
7   3.210882  12.556980
8   3.256436  13.020236
9   3.303669  13.340733
10  3.379307  13.699060
11  3.511173  14.266490 
2024-04-30 22:59:08 INFO     Standard deviation: 
         MAE      RMSE
0   0.072171  0.186612
1   0.069125  0.143234
2   0.077443  0.189056
3   0.081468  0.264092
4   0.096286  0.319765
5   0.074541  0.375884
6   0.070937  0.445648
7   0.071712  0.574350
8   0.075215  0.604577
9   0.089001  0.604638
10  0.060333  0.454737
11  0.054109  0.345664
2024-04-30 22:59:08 INFO     ----------------------------------------------------------------------------
2024-04-30 22:59:08 INFO     12 steps Average: 
        MAE       RMSE
0  3.018568  11.071481
2024-04-30 22:59:08 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.074362  0.375688
