2024-05-01 12:08:05 INFO     ----------------------------------------------------------------------------
2024-05-01 12:08:05 INFO     # 0, Kownledge Graph Embedding: GIE, Experiment ids: 15
2024-05-01 12:08:05 INFO     ----------------------------------------------------------------------------
2024-05-01 12:08:05 INFO     Log directory: ./libcity/log
2024-05-01 12:08:05 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=15
2024-05-01 12:08:05 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 318396306, 'exp_id': 15, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'standard', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 12:08:05 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 12:08:05 INFO     set_weight_link_or_dist: dist
2024-05-01 12:08:05 INFO     init_weight_inf_or_zero: inf
2024-05-01 12:08:05 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 12:08:05 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 12:08:05 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 12:08:06 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 12:08:08 INFO     Dataset created
2024-05-01 12:08:08 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 12:08:08 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 12:08:08 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 12:08:08 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 12:08:09 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 12:08:09 INFO     StandardScaler mean: -0.1104628281371549, std: 0.18990125195044946
2024-05-01 12:08:15 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 12:08:15 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 12:08:15 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 12:08:15 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 12:08:15 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 12:08:15 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 12:08:15 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 12:08:15 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 12:08:15 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 12:08:15 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 12:08:15 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 12:08:15 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 12:08:15 INFO     Total parameter numbers: 874010
2024-05-01 12:08:15 INFO     You select `adam` optimizer.
2024-05-01 12:08:15 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 12:08:15 INFO     Start training ...
2024-05-01 12:08:15 INFO     num_batches:48
2024-05-01 12:08:20 INFO     epoch complete!
2024-05-01 12:08:20 INFO     evaluating now!
2024-05-01 12:08:21 INFO     Epoch [0/200] train_loss: 22.7926, val_loss: 18.3692, lr: 0.003000, 6.12s
2024-05-01 12:08:21 INFO     Saved model at 0
2024-05-01 12:08:21 INFO     Val loss decrease from inf to 18.3692, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 12:08:26 INFO     epoch complete!
2024-05-01 12:08:26 INFO     evaluating now!
2024-05-01 12:08:27 INFO     Epoch [1/200] train_loss: 15.0513, val_loss: 14.0709, lr: 0.003000, 5.77s
2024-05-01 12:08:27 INFO     Saved model at 1
2024-05-01 12:08:27 INFO     Val loss decrease from 18.3692 to 14.0709, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 12:08:32 INFO     epoch complete!
2024-05-01 12:08:32 INFO     evaluating now!
2024-05-01 12:08:32 INFO     Epoch [2/200] train_loss: 11.7242, val_loss: 11.3534, lr: 0.003000, 5.68s
2024-05-01 12:08:32 INFO     Saved model at 2
2024-05-01 12:08:32 INFO     Val loss decrease from 14.0709 to 11.3534, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 12:08:38 INFO     epoch complete!
2024-05-01 12:08:38 INFO     evaluating now!
2024-05-01 12:08:38 INFO     Epoch [3/200] train_loss: 9.8969, val_loss: 9.6338, lr: 0.003000, 5.64s
2024-05-01 12:08:38 INFO     Saved model at 3
2024-05-01 12:08:38 INFO     Val loss decrease from 11.3534 to 9.6338, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 12:08:43 INFO     epoch complete!
2024-05-01 12:08:43 INFO     evaluating now!
2024-05-01 12:08:44 INFO     Epoch [4/200] train_loss: 8.5137, val_loss: 8.0013, lr: 0.003000, 5.65s
2024-05-01 12:08:44 INFO     Saved model at 4
2024-05-01 12:08:44 INFO     Val loss decrease from 9.6338 to 8.0013, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 12:08:49 INFO     epoch complete!
2024-05-01 12:08:49 INFO     evaluating now!
2024-05-01 12:08:50 INFO     Epoch [5/200] train_loss: 7.8405, val_loss: 7.7808, lr: 0.003000, 5.98s
2024-05-01 12:08:50 INFO     Saved model at 5
2024-05-01 12:08:50 INFO     Val loss decrease from 8.0013 to 7.7808, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 12:08:55 INFO     epoch complete!
2024-05-01 12:08:55 INFO     evaluating now!
2024-05-01 12:08:55 INFO     Epoch [6/200] train_loss: 7.3250, val_loss: 7.0633, lr: 0.003000, 5.58s
2024-05-01 12:08:55 INFO     Saved model at 6
2024-05-01 12:08:55 INFO     Val loss decrease from 7.7808 to 7.0633, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 12:09:01 INFO     epoch complete!
2024-05-01 12:09:01 INFO     evaluating now!
2024-05-01 12:09:01 INFO     Epoch [7/200] train_loss: 6.9836, val_loss: 6.5900, lr: 0.003000, 5.79s
2024-05-01 12:09:01 INFO     Saved model at 7
2024-05-01 12:09:01 INFO     Val loss decrease from 7.0633 to 6.5900, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 12:09:07 INFO     epoch complete!
2024-05-01 12:09:07 INFO     evaluating now!
2024-05-01 12:09:07 INFO     Epoch [8/200] train_loss: 6.6288, val_loss: 6.5088, lr: 0.003000, 5.80s
2024-05-01 12:09:07 INFO     Saved model at 8
2024-05-01 12:09:07 INFO     Val loss decrease from 6.5900 to 6.5088, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-01 12:09:12 INFO     epoch complete!
2024-05-01 12:09:12 INFO     evaluating now!
2024-05-01 12:09:13 INFO     Epoch [9/200] train_loss: 6.2678, val_loss: 6.1887, lr: 0.003000, 5.76s
2024-05-01 12:09:13 INFO     Saved model at 9
2024-05-01 12:09:13 INFO     Val loss decrease from 6.5088 to 6.1887, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-01 12:09:18 INFO     epoch complete!
2024-05-01 12:09:18 INFO     evaluating now!
2024-05-01 12:09:18 INFO     Epoch [10/200] train_loss: 6.1435, val_loss: 6.1335, lr: 0.003000, 5.63s
2024-05-01 12:09:18 INFO     Saved model at 10
2024-05-01 12:09:18 INFO     Val loss decrease from 6.1887 to 6.1335, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-01 12:09:24 INFO     epoch complete!
2024-05-01 12:09:24 INFO     evaluating now!
2024-05-01 12:09:24 INFO     Epoch [11/200] train_loss: 5.9756, val_loss: 5.9438, lr: 0.003000, 5.63s
2024-05-01 12:09:24 INFO     Saved model at 11
2024-05-01 12:09:24 INFO     Val loss decrease from 6.1335 to 5.9438, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-01 12:09:30 INFO     epoch complete!
2024-05-01 12:09:30 INFO     evaluating now!
2024-05-01 12:09:30 INFO     Epoch [12/200] train_loss: 5.7387, val_loss: 6.0269, lr: 0.003000, 5.94s
2024-05-01 12:09:36 INFO     epoch complete!
2024-05-01 12:09:36 INFO     evaluating now!
2024-05-01 12:09:36 INFO     Epoch [13/200] train_loss: 5.6257, val_loss: 5.7184, lr: 0.003000, 6.11s
2024-05-01 12:09:36 INFO     Saved model at 13
2024-05-01 12:09:36 INFO     Val loss decrease from 5.9438 to 5.7184, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-01 12:09:42 INFO     epoch complete!
2024-05-01 12:09:42 INFO     evaluating now!
2024-05-01 12:09:42 INFO     Epoch [14/200] train_loss: 5.5252, val_loss: 5.7926, lr: 0.003000, 6.06s
2024-05-01 12:09:48 INFO     epoch complete!
2024-05-01 12:09:48 INFO     evaluating now!
2024-05-01 12:09:48 INFO     Epoch [15/200] train_loss: 5.3635, val_loss: 5.5954, lr: 0.003000, 6.01s
2024-05-01 12:09:48 INFO     Saved model at 15
2024-05-01 12:09:48 INFO     Val loss decrease from 5.7184 to 5.5954, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-01 12:09:54 INFO     epoch complete!
2024-05-01 12:09:54 INFO     evaluating now!
2024-05-01 12:09:54 INFO     Epoch [16/200] train_loss: 5.2147, val_loss: 5.5228, lr: 0.003000, 5.72s
2024-05-01 12:09:54 INFO     Saved model at 16
2024-05-01 12:09:54 INFO     Val loss decrease from 5.5954 to 5.5228, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-01 12:10:00 INFO     epoch complete!
2024-05-01 12:10:00 INFO     evaluating now!
2024-05-01 12:10:00 INFO     Epoch [17/200] train_loss: 5.1991, val_loss: 5.7798, lr: 0.003000, 5.84s
2024-05-01 12:10:05 INFO     epoch complete!
2024-05-01 12:10:05 INFO     evaluating now!
2024-05-01 12:10:06 INFO     Epoch [18/200] train_loss: 5.1607, val_loss: 5.4510, lr: 0.003000, 5.58s
2024-05-01 12:10:06 INFO     Saved model at 18
2024-05-01 12:10:06 INFO     Val loss decrease from 5.5228 to 5.4510, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-01 12:10:11 INFO     epoch complete!
2024-05-01 12:10:11 INFO     evaluating now!
2024-05-01 12:10:11 INFO     Epoch [19/200] train_loss: 5.0807, val_loss: 5.3332, lr: 0.003000, 5.49s
2024-05-01 12:10:11 INFO     Saved model at 19
2024-05-01 12:10:11 INFO     Val loss decrease from 5.4510 to 5.3332, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-01 12:10:16 INFO     epoch complete!
2024-05-01 12:10:16 INFO     evaluating now!
2024-05-01 12:10:17 INFO     Epoch [20/200] train_loss: 5.0349, val_loss: 5.3840, lr: 0.003000, 5.56s
2024-05-01 12:10:22 INFO     epoch complete!
2024-05-01 12:10:22 INFO     evaluating now!
2024-05-01 12:10:22 INFO     Epoch [21/200] train_loss: 4.8818, val_loss: 5.2322, lr: 0.003000, 5.57s
2024-05-01 12:10:22 INFO     Saved model at 21
2024-05-01 12:10:22 INFO     Val loss decrease from 5.3332 to 5.2322, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-01 12:10:28 INFO     epoch complete!
2024-05-01 12:10:28 INFO     evaluating now!
2024-05-01 12:10:28 INFO     Epoch [22/200] train_loss: 4.8793, val_loss: 5.4052, lr: 0.003000, 5.74s
2024-05-01 12:10:33 INFO     epoch complete!
2024-05-01 12:10:33 INFO     evaluating now!
2024-05-01 12:10:34 INFO     Epoch [23/200] train_loss: 4.8699, val_loss: 5.3807, lr: 0.003000, 5.68s
2024-05-01 12:10:39 INFO     epoch complete!
2024-05-01 12:10:39 INFO     evaluating now!
2024-05-01 12:10:40 INFO     Epoch [24/200] train_loss: 4.7603, val_loss: 5.3203, lr: 0.003000, 5.86s
2024-05-01 12:10:45 INFO     epoch complete!
2024-05-01 12:10:45 INFO     evaluating now!
2024-05-01 12:10:45 INFO     Epoch [25/200] train_loss: 4.7908, val_loss: 5.2265, lr: 0.003000, 5.61s
2024-05-01 12:10:45 INFO     Saved model at 25
2024-05-01 12:10:45 INFO     Val loss decrease from 5.2322 to 5.2265, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-01 12:10:50 INFO     epoch complete!
2024-05-01 12:10:50 INFO     evaluating now!
2024-05-01 12:10:51 INFO     Epoch [26/200] train_loss: 4.6631, val_loss: 5.2942, lr: 0.003000, 5.53s
2024-05-01 12:10:56 INFO     epoch complete!
2024-05-01 12:10:56 INFO     evaluating now!
2024-05-01 12:10:56 INFO     Epoch [27/200] train_loss: 4.6242, val_loss: 5.5528, lr: 0.003000, 5.67s
2024-05-01 12:11:02 INFO     epoch complete!
2024-05-01 12:11:02 INFO     evaluating now!
2024-05-01 12:11:02 INFO     Epoch [28/200] train_loss: 4.6583, val_loss: 5.2288, lr: 0.003000, 5.67s
2024-05-01 12:11:07 INFO     epoch complete!
2024-05-01 12:11:07 INFO     evaluating now!
2024-05-01 12:11:08 INFO     Epoch [29/200] train_loss: 4.5329, val_loss: 5.0483, lr: 0.003000, 5.58s
2024-05-01 12:11:08 INFO     Saved model at 29
2024-05-01 12:11:08 INFO     Val loss decrease from 5.2265 to 5.0483, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-05-01 12:11:13 INFO     epoch complete!
2024-05-01 12:11:13 INFO     evaluating now!
2024-05-01 12:11:13 INFO     Epoch [30/200] train_loss: 4.5685, val_loss: 5.2104, lr: 0.003000, 5.59s
2024-05-01 12:11:18 INFO     epoch complete!
2024-05-01 12:11:18 INFO     evaluating now!
2024-05-01 12:11:19 INFO     Epoch [31/200] train_loss: 4.4888, val_loss: 5.1976, lr: 0.003000, 5.51s
2024-05-01 12:11:24 INFO     epoch complete!
2024-05-01 12:11:24 INFO     evaluating now!
2024-05-01 12:11:24 INFO     Epoch [32/200] train_loss: 4.5002, val_loss: 5.1486, lr: 0.003000, 5.59s
2024-05-01 12:11:30 INFO     epoch complete!
2024-05-01 12:11:30 INFO     evaluating now!
2024-05-01 12:11:30 INFO     Epoch [33/200] train_loss: 4.3928, val_loss: 5.1856, lr: 0.003000, 5.64s
2024-05-01 12:11:35 INFO     epoch complete!
2024-05-01 12:11:35 INFO     evaluating now!
2024-05-01 12:11:36 INFO     Epoch [34/200] train_loss: 4.3465, val_loss: 5.1735, lr: 0.003000, 5.55s
2024-05-01 12:11:41 INFO     epoch complete!
2024-05-01 12:11:41 INFO     evaluating now!
2024-05-01 12:11:41 INFO     Epoch [35/200] train_loss: 4.2822, val_loss: 5.2318, lr: 0.003000, 5.57s
2024-05-01 12:11:46 INFO     epoch complete!
2024-05-01 12:11:46 INFO     evaluating now!
2024-05-01 12:11:47 INFO     Epoch [36/200] train_loss: 4.3373, val_loss: 5.1473, lr: 0.003000, 5.63s
2024-05-01 12:11:52 INFO     epoch complete!
2024-05-01 12:11:52 INFO     evaluating now!
2024-05-01 12:11:52 INFO     Epoch [37/200] train_loss: 4.2080, val_loss: 5.1630, lr: 0.003000, 5.57s
2024-05-01 12:11:58 INFO     epoch complete!
2024-05-01 12:11:58 INFO     evaluating now!
2024-05-01 12:11:58 INFO     Epoch [38/200] train_loss: 4.2202, val_loss: 5.1722, lr: 0.003000, 5.62s
2024-05-01 12:12:03 INFO     epoch complete!
2024-05-01 12:12:03 INFO     evaluating now!
2024-05-01 12:12:04 INFO     Epoch [39/200] train_loss: 4.1757, val_loss: 4.9921, lr: 0.003000, 5.70s
2024-05-01 12:12:04 INFO     Saved model at 39
2024-05-01 12:12:04 INFO     Val loss decrease from 5.0483 to 4.9921, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-05-01 12:12:09 INFO     epoch complete!
2024-05-01 12:12:09 INFO     evaluating now!
2024-05-01 12:12:09 INFO     Epoch [40/200] train_loss: 4.1749, val_loss: 5.0103, lr: 0.003000, 5.69s
2024-05-01 12:12:15 INFO     epoch complete!
2024-05-01 12:12:15 INFO     evaluating now!
2024-05-01 12:12:15 INFO     Epoch [41/200] train_loss: 4.1548, val_loss: 5.2122, lr: 0.003000, 5.70s
2024-05-01 12:12:20 INFO     epoch complete!
2024-05-01 12:12:20 INFO     evaluating now!
2024-05-01 12:12:21 INFO     Epoch [42/200] train_loss: 4.0931, val_loss: 5.2046, lr: 0.003000, 5.63s
2024-05-01 12:12:26 INFO     epoch complete!
2024-05-01 12:12:26 INFO     evaluating now!
2024-05-01 12:12:27 INFO     Epoch [43/200] train_loss: 4.0913, val_loss: 5.1888, lr: 0.003000, 5.77s
2024-05-01 12:12:32 INFO     epoch complete!
2024-05-01 12:12:32 INFO     evaluating now!
2024-05-01 12:12:32 INFO     Epoch [44/200] train_loss: 4.0744, val_loss: 5.0320, lr: 0.003000, 5.68s
2024-05-01 12:12:38 INFO     epoch complete!
2024-05-01 12:12:38 INFO     evaluating now!
2024-05-01 12:12:38 INFO     Epoch [45/200] train_loss: 4.0526, val_loss: 4.9531, lr: 0.003000, 5.71s
2024-05-01 12:12:38 INFO     Saved model at 45
2024-05-01 12:12:38 INFO     Val loss decrease from 4.9921 to 4.9531, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-05-01 12:12:43 INFO     epoch complete!
2024-05-01 12:12:43 INFO     evaluating now!
2024-05-01 12:12:44 INFO     Epoch [46/200] train_loss: 3.9794, val_loss: 5.0371, lr: 0.003000, 5.58s
2024-05-01 12:12:49 INFO     epoch complete!
2024-05-01 12:12:49 INFO     evaluating now!
2024-05-01 12:12:49 INFO     Epoch [47/200] train_loss: 3.9643, val_loss: 5.0333, lr: 0.003000, 5.55s
2024-05-01 12:12:54 INFO     epoch complete!
2024-05-01 12:12:54 INFO     evaluating now!
2024-05-01 12:12:55 INFO     Epoch [48/200] train_loss: 3.9179, val_loss: 4.9067, lr: 0.003000, 5.60s
2024-05-01 12:12:55 INFO     Saved model at 48
2024-05-01 12:12:55 INFO     Val loss decrease from 4.9531 to 4.9067, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-05-01 12:13:00 INFO     epoch complete!
2024-05-01 12:13:00 INFO     evaluating now!
2024-05-01 12:13:00 INFO     Epoch [49/200] train_loss: 3.8936, val_loss: 5.1471, lr: 0.003000, 5.58s
2024-05-01 12:13:06 INFO     epoch complete!
2024-05-01 12:13:06 INFO     evaluating now!
2024-05-01 12:13:06 INFO     Epoch [50/200] train_loss: 4.0413, val_loss: 5.1122, lr: 0.003000, 5.70s
2024-05-01 12:13:11 INFO     epoch complete!
2024-05-01 12:13:11 INFO     evaluating now!
2024-05-01 12:13:12 INFO     Epoch [51/200] train_loss: 3.9542, val_loss: 5.2097, lr: 0.003000, 5.54s
2024-05-01 12:13:17 INFO     epoch complete!
2024-05-01 12:13:17 INFO     evaluating now!
2024-05-01 12:13:17 INFO     Epoch [52/200] train_loss: 3.8708, val_loss: 4.9937, lr: 0.003000, 5.73s
2024-05-01 12:13:23 INFO     epoch complete!
2024-05-01 12:13:23 INFO     evaluating now!
2024-05-01 12:13:23 INFO     Epoch [53/200] train_loss: 3.7994, val_loss: 5.1550, lr: 0.003000, 5.66s
2024-05-01 12:13:28 INFO     epoch complete!
2024-05-01 12:13:28 INFO     evaluating now!
2024-05-01 12:13:29 INFO     Epoch [54/200] train_loss: 3.8022, val_loss: 4.9964, lr: 0.003000, 5.59s
2024-05-01 12:13:34 INFO     epoch complete!
2024-05-01 12:13:34 INFO     evaluating now!
2024-05-01 12:13:34 INFO     Epoch [55/200] train_loss: 3.8811, val_loss: 5.1354, lr: 0.003000, 5.62s
2024-05-01 12:13:39 INFO     epoch complete!
2024-05-01 12:13:39 INFO     evaluating now!
2024-05-01 12:13:40 INFO     Epoch [56/200] train_loss: 3.9091, val_loss: 4.9484, lr: 0.003000, 5.66s
2024-05-01 12:13:45 INFO     epoch complete!
2024-05-01 12:13:45 INFO     evaluating now!
2024-05-01 12:13:45 INFO     Epoch [57/200] train_loss: 3.8591, val_loss: 5.1275, lr: 0.003000, 5.60s
2024-05-01 12:13:51 INFO     epoch complete!
2024-05-01 12:13:51 INFO     evaluating now!
2024-05-01 12:13:51 INFO     Epoch [58/200] train_loss: 3.8235, val_loss: 4.9928, lr: 0.003000, 5.59s
2024-05-01 12:13:56 INFO     epoch complete!
2024-05-01 12:13:56 INFO     evaluating now!
2024-05-01 12:13:57 INFO     Epoch [59/200] train_loss: 3.7429, val_loss: 5.1961, lr: 0.003000, 5.64s
2024-05-01 12:14:02 INFO     epoch complete!
2024-05-01 12:14:02 INFO     evaluating now!
2024-05-01 12:14:02 INFO     Epoch [60/200] train_loss: 3.8487, val_loss: 4.9790, lr: 0.003000, 5.62s
2024-05-01 12:14:07 INFO     epoch complete!
2024-05-01 12:14:07 INFO     evaluating now!
2024-05-01 12:14:08 INFO     Epoch [61/200] train_loss: 3.7783, val_loss: 5.1958, lr: 0.003000, 5.58s
2024-05-01 12:14:13 INFO     epoch complete!
2024-05-01 12:14:13 INFO     evaluating now!
2024-05-01 12:14:13 INFO     Epoch [62/200] train_loss: 3.7251, val_loss: 5.0152, lr: 0.003000, 5.62s
2024-05-01 12:14:19 INFO     epoch complete!
2024-05-01 12:14:19 INFO     evaluating now!
2024-05-01 12:14:19 INFO     Epoch [63/200] train_loss: 3.6874, val_loss: 5.0219, lr: 0.003000, 5.65s
2024-05-01 12:14:19 WARNING  Early stopping at epoch: 63
2024-05-01 12:14:19 INFO     Trained totally 64 epochs, average train time is 5.316s, average eval time is 0.362s
2024-05-01 12:14:19 INFO     Loaded model at 48
2024-05-01 12:14:19 INFO     Saved model at ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 12:14:19 INFO     Start evaluating ...
2024-05-01 12:14:21 INFO     Note that you select the single mode to evaluate!
2024-05-01 12:14:21 INFO     Evaluate result is saved at ./libcity/cache/15/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 12:14:21 INFO     
         MAE       RMSE
1   2.331533   6.893702
2   2.483847   7.500782
3   2.617953   8.489197
4   2.809986   9.129972
5   2.988386   9.836164
6   3.109033  10.625495
7   3.172609  11.446069
8   3.262865  11.958327
9   3.232885  12.338649
10  3.314559  12.612895
11  3.316455  13.078625
12  3.452350  13.869953
2024-05-01 12:14:21 INFO     ----------------------------------------------------------------------------
2024-05-01 12:14:21 INFO     # 1, Kownledge Graph Embedding: GIE, Experiment ids: 16
2024-05-01 12:14:21 INFO     ----------------------------------------------------------------------------
2024-05-01 12:14:21 INFO     Log directory: ./libcity/log
2024-05-01 12:14:21 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=16
2024-05-01 12:14:21 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 418756852, 'exp_id': 16, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'standard', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 12:14:21 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 12:14:21 INFO     set_weight_link_or_dist: dist
2024-05-01 12:14:21 INFO     init_weight_inf_or_zero: inf
2024-05-01 12:14:21 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 12:14:21 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 12:14:21 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 12:14:21 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 12:14:24 INFO     Dataset created
2024-05-01 12:14:24 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 12:14:24 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 12:14:24 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 12:14:24 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 12:14:24 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 12:14:25 INFO     StandardScaler mean: -0.1104628281371549, std: 0.18990125195044946
2024-05-01 12:14:28 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 12:14:28 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 12:14:28 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 12:14:28 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 12:14:28 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 12:14:28 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 12:14:28 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 12:14:28 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 12:14:28 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 12:14:28 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 12:14:28 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 12:14:28 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 12:14:28 INFO     Total parameter numbers: 874010
2024-05-01 12:14:28 INFO     You select `adam` optimizer.
2024-05-01 12:14:28 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 12:14:28 INFO     Start training ...
2024-05-01 12:14:28 INFO     num_batches:48
2024-05-01 12:14:34 INFO     epoch complete!
2024-05-01 12:14:34 INFO     evaluating now!
2024-05-01 12:14:34 INFO     Epoch [0/200] train_loss: 24.3742, val_loss: 19.2428, lr: 0.003000, 5.73s
2024-05-01 12:14:34 INFO     Saved model at 0
2024-05-01 12:14:34 INFO     Val loss decrease from inf to 19.2428, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 12:14:40 INFO     epoch complete!
2024-05-01 12:14:40 INFO     evaluating now!
2024-05-01 12:14:40 INFO     Epoch [1/200] train_loss: 16.5212, val_loss: 16.7048, lr: 0.003000, 5.80s
2024-05-01 12:14:40 INFO     Saved model at 1
2024-05-01 12:14:40 INFO     Val loss decrease from 19.2428 to 16.7048, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 12:14:46 INFO     epoch complete!
2024-05-01 12:14:46 INFO     evaluating now!
2024-05-01 12:14:46 INFO     Epoch [2/200] train_loss: 14.9434, val_loss: 15.2040, lr: 0.003000, 5.93s
2024-05-01 12:14:46 INFO     Saved model at 2
2024-05-01 12:14:46 INFO     Val loss decrease from 16.7048 to 15.2040, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 12:14:51 INFO     epoch complete!
2024-05-01 12:14:51 INFO     evaluating now!
2024-05-01 12:14:52 INFO     Epoch [3/200] train_loss: 13.5674, val_loss: 13.3511, lr: 0.003000, 5.84s
2024-05-01 12:14:52 INFO     Saved model at 3
2024-05-01 12:14:52 INFO     Val loss decrease from 15.2040 to 13.3511, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 12:14:58 INFO     epoch complete!
2024-05-01 12:14:58 INFO     evaluating now!
2024-05-01 12:14:58 INFO     Epoch [4/200] train_loss: 11.1341, val_loss: 11.3105, lr: 0.003000, 6.35s
2024-05-01 12:14:58 INFO     Saved model at 4
2024-05-01 12:14:58 INFO     Val loss decrease from 13.3511 to 11.3105, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 12:15:04 INFO     epoch complete!
2024-05-01 12:15:04 INFO     evaluating now!
2024-05-01 12:15:04 INFO     Epoch [5/200] train_loss: 9.5800, val_loss: 9.5310, lr: 0.003000, 5.98s
2024-05-01 12:15:04 INFO     Saved model at 5
2024-05-01 12:15:04 INFO     Val loss decrease from 11.3105 to 9.5310, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 12:15:10 INFO     epoch complete!
2024-05-01 12:15:10 INFO     evaluating now!
2024-05-01 12:15:10 INFO     Epoch [6/200] train_loss: 8.5866, val_loss: 8.6098, lr: 0.003000, 5.84s
2024-05-01 12:15:10 INFO     Saved model at 6
2024-05-01 12:15:10 INFO     Val loss decrease from 9.5310 to 8.6098, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 12:15:16 INFO     epoch complete!
2024-05-01 12:15:16 INFO     evaluating now!
2024-05-01 12:15:16 INFO     Epoch [7/200] train_loss: 7.7893, val_loss: 7.9810, lr: 0.003000, 5.88s
2024-05-01 12:15:16 INFO     Saved model at 7
2024-05-01 12:15:16 INFO     Val loss decrease from 8.6098 to 7.9810, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 12:15:22 INFO     epoch complete!
2024-05-01 12:15:22 INFO     evaluating now!
2024-05-01 12:15:22 INFO     Epoch [8/200] train_loss: 7.6071, val_loss: 7.3297, lr: 0.003000, 5.86s
2024-05-01 12:15:22 INFO     Saved model at 8
2024-05-01 12:15:22 INFO     Val loss decrease from 7.9810 to 7.3297, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-01 12:15:28 INFO     epoch complete!
2024-05-01 12:15:28 INFO     evaluating now!
2024-05-01 12:15:28 INFO     Epoch [9/200] train_loss: 6.8726, val_loss: 6.7274, lr: 0.003000, 6.06s
2024-05-01 12:15:28 INFO     Saved model at 9
2024-05-01 12:15:28 INFO     Val loss decrease from 7.3297 to 6.7274, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-01 12:15:33 INFO     epoch complete!
2024-05-01 12:15:33 INFO     evaluating now!
2024-05-01 12:15:34 INFO     Epoch [10/200] train_loss: 6.5453, val_loss: 6.9041, lr: 0.003000, 5.69s
2024-05-01 12:15:39 INFO     epoch complete!
2024-05-01 12:15:39 INFO     evaluating now!
2024-05-01 12:15:40 INFO     Epoch [11/200] train_loss: 6.4180, val_loss: 6.7193, lr: 0.003000, 5.86s
2024-05-01 12:15:40 INFO     Saved model at 11
2024-05-01 12:15:40 INFO     Val loss decrease from 6.7274 to 6.7193, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-01 12:15:45 INFO     epoch complete!
2024-05-01 12:15:45 INFO     evaluating now!
2024-05-01 12:15:45 INFO     Epoch [12/200] train_loss: 6.1544, val_loss: 6.3906, lr: 0.003000, 5.75s
2024-05-01 12:15:45 INFO     Saved model at 12
2024-05-01 12:15:45 INFO     Val loss decrease from 6.7193 to 6.3906, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-01 12:15:51 INFO     epoch complete!
2024-05-01 12:15:51 INFO     evaluating now!
2024-05-01 12:15:51 INFO     Epoch [13/200] train_loss: 5.9888, val_loss: 6.0663, lr: 0.003000, 5.89s
2024-05-01 12:15:51 INFO     Saved model at 13
2024-05-01 12:15:51 INFO     Val loss decrease from 6.3906 to 6.0663, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-01 12:15:57 INFO     epoch complete!
2024-05-01 12:15:57 INFO     evaluating now!
2024-05-01 12:15:57 INFO     Epoch [14/200] train_loss: 5.8735, val_loss: 6.1560, lr: 0.003000, 5.85s
2024-05-01 12:16:03 INFO     epoch complete!
2024-05-01 12:16:03 INFO     evaluating now!
2024-05-01 12:16:03 INFO     Epoch [15/200] train_loss: 5.7670, val_loss: 5.9357, lr: 0.003000, 5.78s
2024-05-01 12:16:03 INFO     Saved model at 15
2024-05-01 12:16:03 INFO     Val loss decrease from 6.0663 to 5.9357, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-01 12:16:08 INFO     epoch complete!
2024-05-01 12:16:08 INFO     evaluating now!
2024-05-01 12:16:09 INFO     Epoch [16/200] train_loss: 5.6548, val_loss: 6.0323, lr: 0.003000, 5.77s
2024-05-01 12:16:14 INFO     epoch complete!
2024-05-01 12:16:14 INFO     evaluating now!
2024-05-01 12:16:15 INFO     Epoch [17/200] train_loss: 5.8012, val_loss: 6.1531, lr: 0.003000, 5.75s
2024-05-01 12:16:20 INFO     epoch complete!
2024-05-01 12:16:20 INFO     evaluating now!
2024-05-01 12:16:20 INFO     Epoch [18/200] train_loss: 5.4289, val_loss: 5.7677, lr: 0.003000, 5.89s
2024-05-01 12:16:21 INFO     Saved model at 18
2024-05-01 12:16:21 INFO     Val loss decrease from 5.9357 to 5.7677, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-01 12:16:26 INFO     epoch complete!
2024-05-01 12:16:26 INFO     evaluating now!
2024-05-01 12:16:26 INFO     Epoch [19/200] train_loss: 5.2609, val_loss: 5.4678, lr: 0.003000, 5.91s
2024-05-01 12:16:26 INFO     Saved model at 19
2024-05-01 12:16:26 INFO     Val loss decrease from 5.7677 to 5.4678, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-01 12:16:32 INFO     epoch complete!
2024-05-01 12:16:32 INFO     evaluating now!
2024-05-01 12:16:32 INFO     Epoch [20/200] train_loss: 5.1336, val_loss: 5.4579, lr: 0.003000, 5.87s
2024-05-01 12:16:32 INFO     Saved model at 20
2024-05-01 12:16:32 INFO     Val loss decrease from 5.4678 to 5.4579, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-01 12:16:38 INFO     epoch complete!
2024-05-01 12:16:38 INFO     evaluating now!
2024-05-01 12:16:38 INFO     Epoch [21/200] train_loss: 5.0697, val_loss: 5.6257, lr: 0.003000, 5.90s
2024-05-01 12:16:44 INFO     epoch complete!
2024-05-01 12:16:44 INFO     evaluating now!
2024-05-01 12:16:44 INFO     Epoch [22/200] train_loss: 5.0524, val_loss: 5.4460, lr: 0.003000, 5.65s
2024-05-01 12:16:44 INFO     Saved model at 22
2024-05-01 12:16:44 INFO     Val loss decrease from 5.4579 to 5.4460, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-01 12:16:49 INFO     epoch complete!
2024-05-01 12:16:49 INFO     evaluating now!
2024-05-01 12:16:49 INFO     Epoch [23/200] train_loss: 5.0406, val_loss: 5.4777, lr: 0.003000, 5.24s
2024-05-01 12:16:54 INFO     epoch complete!
2024-05-01 12:16:54 INFO     evaluating now!
2024-05-01 12:16:54 INFO     Epoch [24/200] train_loss: 4.9771, val_loss: 5.6891, lr: 0.003000, 5.20s
2024-05-01 12:16:59 INFO     epoch complete!
2024-05-01 12:16:59 INFO     evaluating now!
2024-05-01 12:17:00 INFO     Epoch [25/200] train_loss: 4.9033, val_loss: 5.7033, lr: 0.003000, 5.11s
2024-05-01 12:17:04 INFO     epoch complete!
2024-05-01 12:17:04 INFO     evaluating now!
2024-05-01 12:17:05 INFO     Epoch [26/200] train_loss: 4.8748, val_loss: 5.5499, lr: 0.003000, 5.19s
2024-05-01 12:17:10 INFO     epoch complete!
2024-05-01 12:17:10 INFO     evaluating now!
2024-05-01 12:17:10 INFO     Epoch [27/200] train_loss: 4.8183, val_loss: 5.4617, lr: 0.003000, 5.14s
2024-05-01 12:17:15 INFO     epoch complete!
2024-05-01 12:17:15 INFO     evaluating now!
2024-05-01 12:17:15 INFO     Epoch [28/200] train_loss: 4.7186, val_loss: 5.2802, lr: 0.003000, 5.19s
2024-05-01 12:17:15 INFO     Saved model at 28
2024-05-01 12:17:15 INFO     Val loss decrease from 5.4460 to 5.2802, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-05-01 12:17:20 INFO     epoch complete!
2024-05-01 12:17:20 INFO     evaluating now!
2024-05-01 12:17:20 INFO     Epoch [29/200] train_loss: 4.7537, val_loss: 5.2629, lr: 0.003000, 5.35s
2024-05-01 12:17:20 INFO     Saved model at 29
2024-05-01 12:17:20 INFO     Val loss decrease from 5.2802 to 5.2629, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-05-01 12:17:26 INFO     epoch complete!
2024-05-01 12:17:26 INFO     evaluating now!
2024-05-01 12:17:26 INFO     Epoch [30/200] train_loss: 4.6588, val_loss: 5.2349, lr: 0.003000, 5.46s
2024-05-01 12:17:26 INFO     Saved model at 30
2024-05-01 12:17:26 INFO     Val loss decrease from 5.2629 to 5.2349, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-05-01 12:17:31 INFO     epoch complete!
2024-05-01 12:17:31 INFO     evaluating now!
2024-05-01 12:17:31 INFO     Epoch [31/200] train_loss: 4.5790, val_loss: 5.3390, lr: 0.003000, 5.14s
2024-05-01 12:17:36 INFO     epoch complete!
2024-05-01 12:17:36 INFO     evaluating now!
2024-05-01 12:17:36 INFO     Epoch [32/200] train_loss: 4.5191, val_loss: 5.1862, lr: 0.003000, 5.15s
2024-05-01 12:17:36 INFO     Saved model at 32
2024-05-01 12:17:36 INFO     Val loss decrease from 5.2349 to 5.1862, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-05-01 12:17:41 INFO     epoch complete!
2024-05-01 12:17:41 INFO     evaluating now!
2024-05-01 12:17:42 INFO     Epoch [33/200] train_loss: 4.4622, val_loss: 5.1884, lr: 0.003000, 5.40s
2024-05-01 12:17:47 INFO     epoch complete!
2024-05-01 12:17:47 INFO     evaluating now!
2024-05-01 12:17:47 INFO     Epoch [34/200] train_loss: 4.4169, val_loss: 4.9964, lr: 0.003000, 5.16s
2024-05-01 12:17:47 INFO     Saved model at 34
2024-05-01 12:17:47 INFO     Val loss decrease from 5.1862 to 4.9964, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-05-01 12:17:52 INFO     epoch complete!
2024-05-01 12:17:52 INFO     evaluating now!
2024-05-01 12:17:52 INFO     Epoch [35/200] train_loss: 4.4254, val_loss: 5.1408, lr: 0.003000, 5.19s
2024-05-01 12:17:57 INFO     epoch complete!
2024-05-01 12:17:57 INFO     evaluating now!
2024-05-01 12:17:57 INFO     Epoch [36/200] train_loss: 4.3654, val_loss: 5.1106, lr: 0.003000, 5.09s
2024-05-01 12:18:02 INFO     epoch complete!
2024-05-01 12:18:02 INFO     evaluating now!
2024-05-01 12:18:02 INFO     Epoch [37/200] train_loss: 4.3942, val_loss: 5.2496, lr: 0.003000, 5.18s
2024-05-01 12:18:07 INFO     epoch complete!
2024-05-01 12:18:07 INFO     evaluating now!
2024-05-01 12:18:08 INFO     Epoch [38/200] train_loss: 4.3384, val_loss: 5.0054, lr: 0.003000, 5.35s
2024-05-01 12:18:13 INFO     epoch complete!
2024-05-01 12:18:13 INFO     evaluating now!
2024-05-01 12:18:13 INFO     Epoch [39/200] train_loss: 4.2972, val_loss: 5.0304, lr: 0.003000, 5.27s
2024-05-01 12:18:18 INFO     epoch complete!
2024-05-01 12:18:18 INFO     evaluating now!
2024-05-01 12:18:18 INFO     Epoch [40/200] train_loss: 4.2489, val_loss: 5.0218, lr: 0.003000, 5.08s
2024-05-01 12:18:23 INFO     epoch complete!
2024-05-01 12:18:23 INFO     evaluating now!
2024-05-01 12:18:23 INFO     Epoch [41/200] train_loss: 4.1930, val_loss: 5.0409, lr: 0.003000, 5.16s
2024-05-01 12:18:28 INFO     epoch complete!
2024-05-01 12:18:28 INFO     evaluating now!
2024-05-01 12:18:28 INFO     Epoch [42/200] train_loss: 4.1373, val_loss: 5.1044, lr: 0.003000, 5.18s
2024-05-01 12:18:33 INFO     epoch complete!
2024-05-01 12:18:33 INFO     evaluating now!
2024-05-01 12:18:34 INFO     Epoch [43/200] train_loss: 4.2054, val_loss: 5.0784, lr: 0.003000, 5.21s
2024-05-01 12:18:38 INFO     epoch complete!
2024-05-01 12:18:38 INFO     evaluating now!
2024-05-01 12:18:39 INFO     Epoch [44/200] train_loss: 4.2431, val_loss: 5.0338, lr: 0.003000, 5.10s
2024-05-01 12:18:44 INFO     epoch complete!
2024-05-01 12:18:44 INFO     evaluating now!
2024-05-01 12:18:44 INFO     Epoch [45/200] train_loss: 4.0928, val_loss: 5.0723, lr: 0.003000, 5.21s
2024-05-01 12:18:49 INFO     epoch complete!
2024-05-01 12:18:49 INFO     evaluating now!
2024-05-01 12:18:49 INFO     Epoch [46/200] train_loss: 4.1388, val_loss: 5.1441, lr: 0.003000, 5.18s
2024-05-01 12:18:54 INFO     epoch complete!
2024-05-01 12:18:54 INFO     evaluating now!
2024-05-01 12:18:55 INFO     Epoch [47/200] train_loss: 4.0136, val_loss: 5.0143, lr: 0.003000, 5.72s
2024-05-01 12:19:00 INFO     epoch complete!
2024-05-01 12:19:00 INFO     evaluating now!
2024-05-01 12:19:00 INFO     Epoch [48/200] train_loss: 4.0520, val_loss: 5.1666, lr: 0.003000, 5.38s
2024-05-01 12:19:05 INFO     epoch complete!
2024-05-01 12:19:05 INFO     evaluating now!
2024-05-01 12:19:05 INFO     Epoch [49/200] train_loss: 3.9841, val_loss: 4.9837, lr: 0.003000, 5.18s
2024-05-01 12:19:05 INFO     Saved model at 49
2024-05-01 12:19:05 INFO     Val loss decrease from 4.9964 to 4.9837, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-05-01 12:19:10 INFO     epoch complete!
2024-05-01 12:19:10 INFO     evaluating now!
2024-05-01 12:19:11 INFO     Epoch [50/200] train_loss: 3.9394, val_loss: 4.8918, lr: 0.003000, 5.12s
2024-05-01 12:19:11 INFO     Saved model at 50
2024-05-01 12:19:11 INFO     Val loss decrease from 4.9837 to 4.8918, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch50.tar
2024-05-01 12:19:15 INFO     epoch complete!
2024-05-01 12:19:15 INFO     evaluating now!
2024-05-01 12:19:16 INFO     Epoch [51/200] train_loss: 3.9252, val_loss: 4.8798, lr: 0.003000, 5.17s
2024-05-01 12:19:16 INFO     Saved model at 51
2024-05-01 12:19:16 INFO     Val loss decrease from 4.8918 to 4.8798, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-05-01 12:19:21 INFO     epoch complete!
2024-05-01 12:19:21 INFO     evaluating now!
2024-05-01 12:19:21 INFO     Epoch [52/200] train_loss: 3.9411, val_loss: 5.0270, lr: 0.003000, 5.10s
2024-05-01 12:19:26 INFO     epoch complete!
2024-05-01 12:19:26 INFO     evaluating now!
2024-05-01 12:19:26 INFO     Epoch [53/200] train_loss: 3.9376, val_loss: 5.2766, lr: 0.003000, 5.14s
2024-05-01 12:19:31 INFO     epoch complete!
2024-05-01 12:19:31 INFO     evaluating now!
2024-05-01 12:19:31 INFO     Epoch [54/200] train_loss: 3.9674, val_loss: 4.8902, lr: 0.003000, 5.10s
2024-05-01 12:19:36 INFO     epoch complete!
2024-05-01 12:19:36 INFO     evaluating now!
2024-05-01 12:19:36 INFO     Epoch [55/200] train_loss: 3.8759, val_loss: 4.9771, lr: 0.003000, 5.14s
2024-05-01 12:19:41 INFO     epoch complete!
2024-05-01 12:19:41 INFO     evaluating now!
2024-05-01 12:19:41 INFO     Epoch [56/200] train_loss: 3.8102, val_loss: 5.1559, lr: 0.003000, 5.17s
2024-05-01 12:19:46 INFO     epoch complete!
2024-05-01 12:19:46 INFO     evaluating now!
2024-05-01 12:19:46 INFO     Epoch [57/200] train_loss: 3.8443, val_loss: 4.9721, lr: 0.003000, 4.99s
2024-05-01 12:19:51 INFO     epoch complete!
2024-05-01 12:19:51 INFO     evaluating now!
2024-05-01 12:19:51 INFO     Epoch [58/200] train_loss: 3.8513, val_loss: 4.9966, lr: 0.003000, 4.99s
2024-05-01 12:19:56 INFO     epoch complete!
2024-05-01 12:19:56 INFO     evaluating now!
2024-05-01 12:19:56 INFO     Epoch [59/200] train_loss: 3.7969, val_loss: 4.9322, lr: 0.003000, 5.04s
2024-05-01 12:20:02 INFO     epoch complete!
2024-05-01 12:20:02 INFO     evaluating now!
2024-05-01 12:20:02 INFO     Epoch [60/200] train_loss: 3.7589, val_loss: 4.8822, lr: 0.003000, 5.68s
2024-05-01 12:20:07 INFO     epoch complete!
2024-05-01 12:20:07 INFO     evaluating now!
2024-05-01 12:20:07 INFO     Epoch [61/200] train_loss: 3.8140, val_loss: 5.0908, lr: 0.003000, 5.06s
2024-05-01 12:20:12 INFO     epoch complete!
2024-05-01 12:20:12 INFO     evaluating now!
2024-05-01 12:20:13 INFO     Epoch [62/200] train_loss: 3.7421, val_loss: 4.9448, lr: 0.003000, 5.37s
2024-05-01 12:20:17 INFO     epoch complete!
2024-05-01 12:20:17 INFO     evaluating now!
2024-05-01 12:20:18 INFO     Epoch [63/200] train_loss: 3.7047, val_loss: 4.8986, lr: 0.003000, 5.16s
2024-05-01 12:20:23 INFO     epoch complete!
2024-05-01 12:20:23 INFO     evaluating now!
2024-05-01 12:20:23 INFO     Epoch [64/200] train_loss: 3.6617, val_loss: 4.8799, lr: 0.003000, 5.25s
2024-05-01 12:20:28 INFO     epoch complete!
2024-05-01 12:20:28 INFO     evaluating now!
2024-05-01 12:20:28 INFO     Epoch [65/200] train_loss: 3.6540, val_loss: 4.9157, lr: 0.003000, 5.07s
2024-05-01 12:20:33 INFO     epoch complete!
2024-05-01 12:20:33 INFO     evaluating now!
2024-05-01 12:20:33 INFO     Epoch [66/200] train_loss: 3.7065, val_loss: 5.1286, lr: 0.003000, 4.97s
2024-05-01 12:20:33 WARNING  Early stopping at epoch: 66
2024-05-01 12:20:33 INFO     Trained totally 67 epochs, average train time is 5.066s, average eval time is 0.357s
2024-05-01 12:20:33 INFO     Loaded model at 51
2024-05-01 12:20:33 INFO     Saved model at ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 12:20:33 INFO     Start evaluating ...
2024-05-01 12:20:34 INFO     Note that you select the single mode to evaluate!
2024-05-01 12:20:35 INFO     Evaluate result is saved at ./libcity/cache/16/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 12:20:35 INFO     
         MAE       RMSE
1   2.302882   6.962387
2   2.384592   7.566446
3   2.633873   8.664795
4   2.868591   9.534015
5   2.959910  10.610344
6   3.134872  11.887275
7   3.215855  13.111959
8   3.318971  13.910411
9   3.359983  14.370475
10  3.328371  14.436980
11  3.345914  14.457108
12  3.473788  14.816839
2024-05-01 12:20:35 INFO     ----------------------------------------------------------------------------
2024-05-01 12:20:35 INFO     # 2, Kownledge Graph Embedding: GIE, Experiment ids: 17
2024-05-01 12:20:35 INFO     ----------------------------------------------------------------------------
2024-05-01 12:20:35 INFO     Log directory: ./libcity/log
2024-05-01 12:20:35 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=17
2024-05-01 12:20:35 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 476123194, 'exp_id': 17, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'standard', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 12:20:35 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 12:20:35 INFO     set_weight_link_or_dist: dist
2024-05-01 12:20:35 INFO     init_weight_inf_or_zero: inf
2024-05-01 12:20:35 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 12:20:35 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 12:20:35 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 12:20:35 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 12:20:38 INFO     Dataset created
2024-05-01 12:20:38 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 12:20:38 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 12:20:38 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 12:20:38 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 12:20:38 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 12:20:39 INFO     StandardScaler mean: -0.1104628281371549, std: 0.18990125195044946
2024-05-01 12:20:42 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 12:20:42 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 12:20:42 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 12:20:42 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 12:20:42 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 12:20:42 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 12:20:42 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 12:20:42 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 12:20:42 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 12:20:42 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 12:20:42 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 12:20:42 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 12:20:42 INFO     Total parameter numbers: 874010
2024-05-01 12:20:42 INFO     You select `adam` optimizer.
2024-05-01 12:20:42 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 12:20:42 INFO     Start training ...
2024-05-01 12:20:42 INFO     num_batches:48
2024-05-01 12:20:47 INFO     epoch complete!
2024-05-01 12:20:47 INFO     evaluating now!
2024-05-01 12:20:48 INFO     Epoch [0/200] train_loss: 24.1252, val_loss: 18.7054, lr: 0.003000, 5.27s
2024-05-01 12:20:48 INFO     Saved model at 0
2024-05-01 12:20:48 INFO     Val loss decrease from inf to 18.7054, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 12:20:52 INFO     epoch complete!
2024-05-01 12:20:52 INFO     evaluating now!
2024-05-01 12:20:53 INFO     Epoch [1/200] train_loss: 15.5949, val_loss: 15.5303, lr: 0.003000, 5.03s
2024-05-01 12:20:53 INFO     Saved model at 1
2024-05-01 12:20:53 INFO     Val loss decrease from 18.7054 to 15.5303, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 12:20:57 INFO     epoch complete!
2024-05-01 12:20:57 INFO     evaluating now!
2024-05-01 12:20:58 INFO     Epoch [2/200] train_loss: 13.3455, val_loss: 13.5803, lr: 0.003000, 5.08s
2024-05-01 12:20:58 INFO     Saved model at 2
2024-05-01 12:20:58 INFO     Val loss decrease from 15.5303 to 13.5803, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 12:21:03 INFO     epoch complete!
2024-05-01 12:21:03 INFO     evaluating now!
2024-05-01 12:21:03 INFO     Epoch [3/200] train_loss: 11.4401, val_loss: 11.1985, lr: 0.003000, 5.15s
2024-05-01 12:21:03 INFO     Saved model at 3
2024-05-01 12:21:03 INFO     Val loss decrease from 13.5803 to 11.1985, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 12:21:08 INFO     epoch complete!
2024-05-01 12:21:08 INFO     evaluating now!
2024-05-01 12:21:08 INFO     Epoch [4/200] train_loss: 10.0080, val_loss: 10.4356, lr: 0.003000, 5.17s
2024-05-01 12:21:08 INFO     Saved model at 4
2024-05-01 12:21:08 INFO     Val loss decrease from 11.1985 to 10.4356, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 12:21:13 INFO     epoch complete!
2024-05-01 12:21:13 INFO     evaluating now!
2024-05-01 12:21:13 INFO     Epoch [5/200] train_loss: 8.8020, val_loss: 8.7316, lr: 0.003000, 5.20s
2024-05-01 12:21:13 INFO     Saved model at 5
2024-05-01 12:21:13 INFO     Val loss decrease from 10.4356 to 8.7316, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 12:21:18 INFO     epoch complete!
2024-05-01 12:21:18 INFO     evaluating now!
2024-05-01 12:21:18 INFO     Epoch [6/200] train_loss: 7.9462, val_loss: 8.0339, lr: 0.003000, 5.01s
2024-05-01 12:21:19 INFO     Saved model at 6
2024-05-01 12:21:19 INFO     Val loss decrease from 8.7316 to 8.0339, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 12:21:23 INFO     epoch complete!
2024-05-01 12:21:23 INFO     evaluating now!
2024-05-01 12:21:24 INFO     Epoch [7/200] train_loss: 7.4838, val_loss: 7.3720, lr: 0.003000, 5.18s
2024-05-01 12:21:24 INFO     Saved model at 7
2024-05-01 12:21:24 INFO     Val loss decrease from 8.0339 to 7.3720, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 12:21:29 INFO     epoch complete!
2024-05-01 12:21:29 INFO     evaluating now!
2024-05-01 12:21:29 INFO     Epoch [8/200] train_loss: 7.0503, val_loss: 6.9788, lr: 0.003000, 5.34s
2024-05-01 12:21:29 INFO     Saved model at 8
2024-05-01 12:21:29 INFO     Val loss decrease from 7.3720 to 6.9788, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-01 12:21:34 INFO     epoch complete!
2024-05-01 12:21:34 INFO     evaluating now!
2024-05-01 12:21:34 INFO     Epoch [9/200] train_loss: 6.9112, val_loss: 6.7800, lr: 0.003000, 5.17s
2024-05-01 12:21:34 INFO     Saved model at 9
2024-05-01 12:21:34 INFO     Val loss decrease from 6.9788 to 6.7800, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-01 12:21:39 INFO     epoch complete!
2024-05-01 12:21:39 INFO     evaluating now!
2024-05-01 12:21:40 INFO     Epoch [10/200] train_loss: 6.5980, val_loss: 6.5297, lr: 0.003000, 5.22s
2024-05-01 12:21:40 INFO     Saved model at 10
2024-05-01 12:21:40 INFO     Val loss decrease from 6.7800 to 6.5297, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-01 12:21:44 INFO     epoch complete!
2024-05-01 12:21:44 INFO     evaluating now!
2024-05-01 12:21:45 INFO     Epoch [11/200] train_loss: 6.3264, val_loss: 6.3996, lr: 0.003000, 5.14s
2024-05-01 12:21:45 INFO     Saved model at 11
2024-05-01 12:21:45 INFO     Val loss decrease from 6.5297 to 6.3996, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-01 12:21:50 INFO     epoch complete!
2024-05-01 12:21:50 INFO     evaluating now!
2024-05-01 12:21:51 INFO     Epoch [12/200] train_loss: 6.1071, val_loss: 6.3683, lr: 0.003000, 5.95s
2024-05-01 12:21:51 INFO     Saved model at 12
2024-05-01 12:21:51 INFO     Val loss decrease from 6.3996 to 6.3683, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-01 12:21:56 INFO     epoch complete!
2024-05-01 12:21:56 INFO     evaluating now!
2024-05-01 12:21:57 INFO     Epoch [13/200] train_loss: 6.0610, val_loss: 6.1565, lr: 0.003000, 5.79s
2024-05-01 12:21:57 INFO     Saved model at 13
2024-05-01 12:21:57 INFO     Val loss decrease from 6.3683 to 6.1565, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-01 12:22:02 INFO     epoch complete!
2024-05-01 12:22:02 INFO     evaluating now!
2024-05-01 12:22:02 INFO     Epoch [14/200] train_loss: 5.9442, val_loss: 6.5314, lr: 0.003000, 5.69s
2024-05-01 12:22:07 INFO     epoch complete!
2024-05-01 12:22:07 INFO     evaluating now!
2024-05-01 12:22:07 INFO     Epoch [15/200] train_loss: 5.8024, val_loss: 5.8874, lr: 0.003000, 5.14s
2024-05-01 12:22:07 INFO     Saved model at 15
2024-05-01 12:22:07 INFO     Val loss decrease from 6.1565 to 5.8874, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-01 12:22:12 INFO     epoch complete!
2024-05-01 12:22:12 INFO     evaluating now!
2024-05-01 12:22:13 INFO     Epoch [16/200] train_loss: 5.7335, val_loss: 6.1622, lr: 0.003000, 5.10s
2024-05-01 12:22:17 INFO     epoch complete!
2024-05-01 12:22:17 INFO     evaluating now!
2024-05-01 12:22:18 INFO     Epoch [17/200] train_loss: 5.7162, val_loss: 5.8030, lr: 0.003000, 5.04s
2024-05-01 12:22:18 INFO     Saved model at 17
2024-05-01 12:22:18 INFO     Val loss decrease from 5.8874 to 5.8030, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-01 12:22:22 INFO     epoch complete!
2024-05-01 12:22:22 INFO     evaluating now!
2024-05-01 12:22:23 INFO     Epoch [18/200] train_loss: 5.5168, val_loss: 5.7774, lr: 0.003000, 5.06s
2024-05-01 12:22:23 INFO     Saved model at 18
2024-05-01 12:22:23 INFO     Val loss decrease from 5.8030 to 5.7774, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-01 12:22:28 INFO     epoch complete!
2024-05-01 12:22:28 INFO     evaluating now!
2024-05-01 12:22:28 INFO     Epoch [19/200] train_loss: 5.4584, val_loss: 5.7891, lr: 0.003000, 5.34s
2024-05-01 12:22:33 INFO     epoch complete!
2024-05-01 12:22:33 INFO     evaluating now!
2024-05-01 12:22:33 INFO     Epoch [20/200] train_loss: 5.4319, val_loss: 5.6695, lr: 0.003000, 5.30s
2024-05-01 12:22:46 INFO     Saved model at 20
2024-05-01 12:22:46 INFO     Val loss decrease from 5.7774 to 5.6695, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-01 12:22:51 INFO     epoch complete!
2024-05-01 12:22:51 INFO     evaluating now!
2024-05-01 12:22:51 INFO     Epoch [21/200] train_loss: 5.3220, val_loss: 5.6432, lr: 0.003000, 5.22s
2024-05-01 12:22:51 INFO     Saved model at 21
2024-05-01 12:22:51 INFO     Val loss decrease from 5.6695 to 5.6432, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-01 12:22:56 INFO     epoch complete!
2024-05-01 12:22:56 INFO     evaluating now!
2024-05-01 12:22:56 INFO     Epoch [22/200] train_loss: 5.2944, val_loss: 5.5949, lr: 0.003000, 5.44s
2024-05-01 12:22:57 INFO     Saved model at 22
2024-05-01 12:22:57 INFO     Val loss decrease from 5.6432 to 5.5949, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-01 12:23:01 INFO     epoch complete!
2024-05-01 12:23:01 INFO     evaluating now!
2024-05-01 12:23:02 INFO     Epoch [23/200] train_loss: 5.1941, val_loss: 5.6979, lr: 0.003000, 5.28s
2024-05-01 12:23:07 INFO     epoch complete!
2024-05-01 12:23:07 INFO     evaluating now!
2024-05-01 12:23:07 INFO     Epoch [24/200] train_loss: 5.1057, val_loss: 5.4270, lr: 0.003000, 5.20s
2024-05-01 12:23:07 INFO     Saved model at 24
2024-05-01 12:23:07 INFO     Val loss decrease from 5.5949 to 5.4270, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-01 12:23:12 INFO     epoch complete!
2024-05-01 12:23:12 INFO     evaluating now!
2024-05-01 12:23:12 INFO     Epoch [25/200] train_loss: 5.0405, val_loss: 5.5838, lr: 0.003000, 5.29s
2024-05-01 12:23:18 INFO     epoch complete!
2024-05-01 12:23:18 INFO     evaluating now!
2024-05-01 12:23:18 INFO     Epoch [26/200] train_loss: 4.9843, val_loss: 5.4883, lr: 0.003000, 5.63s
2024-05-01 12:23:23 INFO     epoch complete!
2024-05-01 12:23:23 INFO     evaluating now!
2024-05-01 12:23:23 INFO     Epoch [27/200] train_loss: 5.0260, val_loss: 5.4418, lr: 0.003000, 5.41s
2024-05-01 12:23:29 INFO     epoch complete!
2024-05-01 12:23:29 INFO     evaluating now!
2024-05-01 12:23:29 INFO     Epoch [28/200] train_loss: 4.9007, val_loss: 5.4797, lr: 0.003000, 5.59s
2024-05-01 12:23:34 INFO     epoch complete!
2024-05-01 12:23:34 INFO     evaluating now!
2024-05-01 12:23:34 INFO     Epoch [29/200] train_loss: 5.0559, val_loss: 5.5148, lr: 0.003000, 5.53s
2024-05-01 12:23:39 INFO     epoch complete!
2024-05-01 12:23:39 INFO     evaluating now!
2024-05-01 12:23:40 INFO     Epoch [30/200] train_loss: 4.8933, val_loss: 5.2965, lr: 0.003000, 5.36s
2024-05-01 12:23:40 INFO     Saved model at 30
2024-05-01 12:23:40 INFO     Val loss decrease from 5.4270 to 5.2965, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-05-01 12:23:45 INFO     epoch complete!
2024-05-01 12:23:45 INFO     evaluating now!
2024-05-01 12:23:45 INFO     Epoch [31/200] train_loss: 4.7652, val_loss: 5.2774, lr: 0.003000, 5.44s
2024-05-01 12:23:45 INFO     Saved model at 31
2024-05-01 12:23:45 INFO     Val loss decrease from 5.2965 to 5.2774, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-05-01 12:23:51 INFO     epoch complete!
2024-05-01 12:23:51 INFO     evaluating now!
2024-05-01 12:23:51 INFO     Epoch [32/200] train_loss: 4.8036, val_loss: 5.4670, lr: 0.003000, 5.69s
2024-05-01 12:23:56 INFO     epoch complete!
2024-05-01 12:23:56 INFO     evaluating now!
2024-05-01 12:23:57 INFO     Epoch [33/200] train_loss: 4.7008, val_loss: 5.2639, lr: 0.003000, 5.56s
2024-05-01 12:23:57 INFO     Saved model at 33
2024-05-01 12:23:57 INFO     Val loss decrease from 5.2774 to 5.2639, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-05-01 12:24:02 INFO     epoch complete!
2024-05-01 12:24:02 INFO     evaluating now!
2024-05-01 12:24:02 INFO     Epoch [34/200] train_loss: 4.7819, val_loss: 5.3207, lr: 0.003000, 5.61s
2024-05-01 12:24:07 INFO     epoch complete!
2024-05-01 12:24:07 INFO     evaluating now!
2024-05-01 12:24:08 INFO     Epoch [35/200] train_loss: 4.6295, val_loss: 5.1654, lr: 0.003000, 5.60s
2024-05-01 12:24:08 INFO     Saved model at 35
2024-05-01 12:24:08 INFO     Val loss decrease from 5.2639 to 5.1654, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-05-01 12:24:13 INFO     epoch complete!
2024-05-01 12:24:13 INFO     evaluating now!
2024-05-01 12:24:13 INFO     Epoch [36/200] train_loss: 4.5632, val_loss: 5.4574, lr: 0.003000, 5.53s
2024-05-01 12:24:19 INFO     epoch complete!
2024-05-01 12:24:19 INFO     evaluating now!
2024-05-01 12:24:19 INFO     Epoch [37/200] train_loss: 4.5618, val_loss: 5.4260, lr: 0.003000, 5.53s
2024-05-01 12:24:24 INFO     epoch complete!
2024-05-01 12:24:24 INFO     evaluating now!
2024-05-01 12:24:24 INFO     Epoch [38/200] train_loss: 4.5472, val_loss: 5.4049, lr: 0.003000, 5.50s
2024-05-01 12:24:29 INFO     epoch complete!
2024-05-01 12:24:29 INFO     evaluating now!
2024-05-01 12:24:30 INFO     Epoch [39/200] train_loss: 4.5669, val_loss: 5.3900, lr: 0.003000, 5.35s
2024-05-01 12:24:35 INFO     epoch complete!
2024-05-01 12:24:35 INFO     evaluating now!
2024-05-01 12:24:35 INFO     Epoch [40/200] train_loss: 4.4408, val_loss: 5.2301, lr: 0.003000, 5.24s
2024-05-01 12:24:40 INFO     epoch complete!
2024-05-01 12:24:40 INFO     evaluating now!
2024-05-01 12:24:40 INFO     Epoch [41/200] train_loss: 4.3678, val_loss: 5.1811, lr: 0.003000, 5.33s
2024-05-01 12:24:46 INFO     epoch complete!
2024-05-01 12:24:46 INFO     evaluating now!
2024-05-01 12:24:46 INFO     Epoch [42/200] train_loss: 4.3863, val_loss: 5.1737, lr: 0.003000, 5.79s
2024-05-01 12:24:51 INFO     epoch complete!
2024-05-01 12:24:51 INFO     evaluating now!
2024-05-01 12:24:52 INFO     Epoch [43/200] train_loss: 4.3629, val_loss: 5.6190, lr: 0.003000, 5.61s
2024-05-01 12:24:57 INFO     epoch complete!
2024-05-01 12:24:57 INFO     evaluating now!
2024-05-01 12:24:57 INFO     Epoch [44/200] train_loss: 4.4280, val_loss: 5.1347, lr: 0.003000, 5.55s
2024-05-01 12:24:57 INFO     Saved model at 44
2024-05-01 12:24:57 INFO     Val loss decrease from 5.1654 to 5.1347, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-05-01 12:25:03 INFO     epoch complete!
2024-05-01 12:25:03 INFO     evaluating now!
2024-05-01 12:25:03 INFO     Epoch [45/200] train_loss: 4.3166, val_loss: 5.0778, lr: 0.003000, 5.60s
2024-05-01 12:25:03 INFO     Saved model at 45
2024-05-01 12:25:03 INFO     Val loss decrease from 5.1347 to 5.0778, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-05-01 12:25:09 INFO     epoch complete!
2024-05-01 12:25:09 INFO     evaluating now!
2024-05-01 12:25:09 INFO     Epoch [46/200] train_loss: 4.3117, val_loss: 4.9684, lr: 0.003000, 5.97s
2024-05-01 12:25:09 INFO     Saved model at 46
2024-05-01 12:25:09 INFO     Val loss decrease from 5.0778 to 4.9684, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-05-01 12:25:15 INFO     epoch complete!
2024-05-01 12:25:15 INFO     evaluating now!
2024-05-01 12:25:15 INFO     Epoch [47/200] train_loss: 4.2286, val_loss: 5.2141, lr: 0.003000, 6.40s
2024-05-01 12:25:21 INFO     epoch complete!
2024-05-01 12:25:21 INFO     evaluating now!
2024-05-01 12:25:21 INFO     Epoch [48/200] train_loss: 4.2266, val_loss: 5.1487, lr: 0.003000, 5.55s
2024-05-01 12:25:26 INFO     epoch complete!
2024-05-01 12:25:26 INFO     evaluating now!
2024-05-01 12:25:26 INFO     Epoch [49/200] train_loss: 4.2068, val_loss: 5.1291, lr: 0.003000, 5.50s
2024-05-01 12:25:32 INFO     epoch complete!
2024-05-01 12:25:32 INFO     evaluating now!
2024-05-01 12:25:32 INFO     Epoch [50/200] train_loss: 4.1326, val_loss: 5.1201, lr: 0.003000, 5.72s
2024-05-01 12:25:37 INFO     epoch complete!
2024-05-01 12:25:37 INFO     evaluating now!
2024-05-01 12:25:38 INFO     Epoch [51/200] train_loss: 4.0857, val_loss: 5.0441, lr: 0.003000, 5.63s
2024-05-01 12:25:43 INFO     epoch complete!
2024-05-01 12:25:43 INFO     evaluating now!
2024-05-01 12:25:43 INFO     Epoch [52/200] train_loss: 4.1122, val_loss: 5.2316, lr: 0.003000, 5.48s
2024-05-01 12:25:49 INFO     epoch complete!
2024-05-01 12:25:49 INFO     evaluating now!
2024-05-01 12:25:49 INFO     Epoch [53/200] train_loss: 4.1904, val_loss: 5.1954, lr: 0.003000, 5.79s
2024-05-01 12:25:54 INFO     epoch complete!
2024-05-01 12:25:54 INFO     evaluating now!
2024-05-01 12:25:55 INFO     Epoch [54/200] train_loss: 4.2030, val_loss: 5.0859, lr: 0.003000, 5.57s
2024-05-01 12:26:00 INFO     epoch complete!
2024-05-01 12:26:00 INFO     evaluating now!
2024-05-01 12:26:00 INFO     Epoch [55/200] train_loss: 4.1141, val_loss: 5.0323, lr: 0.003000, 5.59s
2024-05-01 12:26:06 INFO     epoch complete!
2024-05-01 12:26:06 INFO     evaluating now!
2024-05-01 12:26:06 INFO     Epoch [56/200] train_loss: 4.1507, val_loss: 5.1328, lr: 0.003000, 5.80s
2024-05-01 12:26:11 INFO     epoch complete!
2024-05-01 12:26:11 INFO     evaluating now!
2024-05-01 12:26:12 INFO     Epoch [57/200] train_loss: 4.1539, val_loss: 5.0179, lr: 0.003000, 5.79s
2024-05-01 12:26:17 INFO     epoch complete!
2024-05-01 12:26:17 INFO     evaluating now!
2024-05-01 12:26:17 INFO     Epoch [58/200] train_loss: 3.9964, val_loss: 5.1067, lr: 0.003000, 5.57s
2024-05-01 12:26:23 INFO     epoch complete!
2024-05-01 12:26:23 INFO     evaluating now!
2024-05-01 12:26:23 INFO     Epoch [59/200] train_loss: 3.9769, val_loss: 5.0940, lr: 0.003000, 5.63s
2024-05-01 12:26:28 INFO     epoch complete!
2024-05-01 12:26:28 INFO     evaluating now!
2024-05-01 12:26:29 INFO     Epoch [60/200] train_loss: 3.9279, val_loss: 5.0152, lr: 0.003000, 5.53s
2024-05-01 12:26:34 INFO     epoch complete!
2024-05-01 12:26:34 INFO     evaluating now!
2024-05-01 12:26:34 INFO     Epoch [61/200] train_loss: 3.9403, val_loss: 5.0764, lr: 0.003000, 5.53s
2024-05-01 12:26:34 WARNING  Early stopping at epoch: 61
2024-05-01 12:26:34 INFO     Trained totally 62 epochs, average train time is 5.084s, average eval time is 0.370s
2024-05-01 12:26:34 INFO     Loaded model at 46
2024-05-01 12:26:34 INFO     Saved model at ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 12:26:34 INFO     Start evaluating ...
2024-05-01 12:26:36 INFO     Note that you select the single mode to evaluate!
2024-05-01 12:26:36 INFO     Evaluate result is saved at ./libcity/cache/17/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 12:26:36 INFO     
         MAE       RMSE
1   2.508795   7.549541
2   2.455720   8.065854
3   2.612730   8.917271
4   2.772622   9.546850
5   2.901763  10.224379
6   2.936830  10.873258
7   3.060050  11.445321
8   3.154896  12.010264
9   3.197373  12.519302
10  3.295680  12.702422
11  3.311053  13.165067
12  3.462486  14.125947
2024-05-01 12:26:36 INFO     ----------------------------------------------------------------------------
2024-05-01 12:26:36 INFO     # 3, Kownledge Graph Embedding: GIE, Experiment ids: 18
2024-05-01 12:26:36 INFO     ----------------------------------------------------------------------------
2024-05-01 12:26:36 INFO     Log directory: ./libcity/log
2024-05-01 12:26:36 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=18
2024-05-01 12:26:36 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 553783909, 'exp_id': 18, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'standard', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 12:26:36 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 12:26:36 INFO     set_weight_link_or_dist: dist
2024-05-01 12:26:36 INFO     init_weight_inf_or_zero: inf
2024-05-01 12:26:36 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 12:26:36 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 12:26:36 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 12:26:36 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 12:26:39 INFO     Dataset created
2024-05-01 12:26:39 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 12:26:39 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 12:26:39 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 12:26:39 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 12:26:39 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 12:26:40 INFO     StandardScaler mean: -0.1104628281371549, std: 0.18990125195044946
2024-05-01 12:26:44 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 12:26:44 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 12:26:44 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 12:26:44 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 12:26:44 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 12:26:44 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 12:26:44 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 12:26:44 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 12:26:44 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 12:26:44 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 12:26:44 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 12:26:44 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 12:26:44 INFO     Total parameter numbers: 874010
2024-05-01 12:26:44 INFO     You select `adam` optimizer.
2024-05-01 12:26:44 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 12:26:44 INFO     Start training ...
2024-05-01 12:26:44 INFO     num_batches:48
2024-05-01 12:26:49 INFO     epoch complete!
2024-05-01 12:26:49 INFO     evaluating now!
2024-05-01 12:26:49 INFO     Epoch [0/200] train_loss: 23.6248, val_loss: 18.8516, lr: 0.003000, 5.38s
2024-05-01 12:26:49 INFO     Saved model at 0
2024-05-01 12:26:49 INFO     Val loss decrease from inf to 18.8516, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 12:26:54 INFO     epoch complete!
2024-05-01 12:26:54 INFO     evaluating now!
2024-05-01 12:26:55 INFO     Epoch [1/200] train_loss: 15.6994, val_loss: 15.7151, lr: 0.003000, 5.68s
2024-05-01 12:26:55 INFO     Saved model at 1
2024-05-01 12:26:55 INFO     Val loss decrease from 18.8516 to 15.7151, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 12:27:00 INFO     epoch complete!
2024-05-01 12:27:00 INFO     evaluating now!
2024-05-01 12:27:00 INFO     Epoch [2/200] train_loss: 12.8391, val_loss: 12.5428, lr: 0.003000, 5.53s
2024-05-01 12:27:00 INFO     Saved model at 2
2024-05-01 12:27:00 INFO     Val loss decrease from 15.7151 to 12.5428, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 12:27:05 INFO     epoch complete!
2024-05-01 12:27:05 INFO     evaluating now!
2024-05-01 12:27:06 INFO     Epoch [3/200] train_loss: 10.7428, val_loss: 10.4295, lr: 0.003000, 5.51s
2024-05-01 12:27:06 INFO     Saved model at 3
2024-05-01 12:27:06 INFO     Val loss decrease from 12.5428 to 10.4295, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 12:27:11 INFO     epoch complete!
2024-05-01 12:27:11 INFO     evaluating now!
2024-05-01 12:27:11 INFO     Epoch [4/200] train_loss: 9.2312, val_loss: 9.5014, lr: 0.003000, 5.54s
2024-05-01 12:27:11 INFO     Saved model at 4
2024-05-01 12:27:11 INFO     Val loss decrease from 10.4295 to 9.5014, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 12:27:17 INFO     epoch complete!
2024-05-01 12:27:17 INFO     evaluating now!
2024-05-01 12:27:17 INFO     Epoch [5/200] train_loss: 8.2842, val_loss: 8.2068, lr: 0.003000, 5.71s
2024-05-01 12:27:17 INFO     Saved model at 5
2024-05-01 12:27:17 INFO     Val loss decrease from 9.5014 to 8.2068, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 12:27:22 INFO     epoch complete!
2024-05-01 12:27:22 INFO     evaluating now!
2024-05-01 12:27:23 INFO     Epoch [6/200] train_loss: 7.8085, val_loss: 7.9830, lr: 0.003000, 5.69s
2024-05-01 12:27:23 INFO     Saved model at 6
2024-05-01 12:27:23 INFO     Val loss decrease from 8.2068 to 7.9830, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 12:27:28 INFO     epoch complete!
2024-05-01 12:27:28 INFO     evaluating now!
2024-05-01 12:27:29 INFO     Epoch [7/200] train_loss: 7.3570, val_loss: 7.5005, lr: 0.003000, 5.67s
2024-05-01 12:27:29 INFO     Saved model at 7
2024-05-01 12:27:29 INFO     Val loss decrease from 7.9830 to 7.5005, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 12:27:34 INFO     epoch complete!
2024-05-01 12:27:34 INFO     evaluating now!
2024-05-01 12:27:34 INFO     Epoch [8/200] train_loss: 6.9657, val_loss: 6.7125, lr: 0.003000, 5.73s
2024-05-01 12:27:34 INFO     Saved model at 8
2024-05-01 12:27:34 INFO     Val loss decrease from 7.5005 to 6.7125, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-01 12:27:40 INFO     epoch complete!
2024-05-01 12:27:40 INFO     evaluating now!
2024-05-01 12:27:40 INFO     Epoch [9/200] train_loss: 6.5785, val_loss: 6.6270, lr: 0.003000, 5.94s
2024-05-01 12:27:40 INFO     Saved model at 9
2024-05-01 12:27:40 INFO     Val loss decrease from 6.7125 to 6.6270, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-01 12:27:46 INFO     epoch complete!
2024-05-01 12:27:46 INFO     evaluating now!
2024-05-01 12:27:46 INFO     Epoch [10/200] train_loss: 6.3694, val_loss: 6.2997, lr: 0.003000, 6.16s
2024-05-01 12:27:47 INFO     Saved model at 10
2024-05-01 12:27:47 INFO     Val loss decrease from 6.6270 to 6.2997, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-01 12:27:52 INFO     epoch complete!
2024-05-01 12:27:52 INFO     evaluating now!
2024-05-01 12:27:53 INFO     Epoch [11/200] train_loss: 6.4665, val_loss: 6.8178, lr: 0.003000, 6.16s
2024-05-01 12:27:59 INFO     epoch complete!
2024-05-01 12:27:59 INFO     evaluating now!
2024-05-01 12:27:59 INFO     Epoch [12/200] train_loss: 6.1070, val_loss: 6.0232, lr: 0.003000, 6.27s
2024-05-01 12:27:59 INFO     Saved model at 12
2024-05-01 12:27:59 INFO     Val loss decrease from 6.2997 to 6.0232, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-01 12:28:05 INFO     epoch complete!
2024-05-01 12:28:05 INFO     evaluating now!
2024-05-01 12:28:05 INFO     Epoch [13/200] train_loss: 6.0094, val_loss: 6.0639, lr: 0.003000, 5.95s
2024-05-01 12:28:10 INFO     epoch complete!
2024-05-01 12:28:10 INFO     evaluating now!
2024-05-01 12:28:10 INFO     Epoch [14/200] train_loss: 5.7734, val_loss: 5.9865, lr: 0.003000, 5.43s
2024-05-01 12:28:10 INFO     Saved model at 14
2024-05-01 12:28:10 INFO     Val loss decrease from 6.0232 to 5.9865, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-01 12:28:16 INFO     epoch complete!
2024-05-01 12:28:16 INFO     evaluating now!
2024-05-01 12:28:16 INFO     Epoch [15/200] train_loss: 5.7514, val_loss: 6.1162, lr: 0.003000, 5.70s
2024-05-01 12:28:21 INFO     epoch complete!
2024-05-01 12:28:21 INFO     evaluating now!
2024-05-01 12:28:22 INFO     Epoch [16/200] train_loss: 5.6670, val_loss: 6.0914, lr: 0.003000, 5.75s
2024-05-01 12:28:27 INFO     epoch complete!
2024-05-01 12:28:27 INFO     evaluating now!
2024-05-01 12:28:27 INFO     Epoch [17/200] train_loss: 5.6796, val_loss: 6.0066, lr: 0.003000, 5.53s
2024-05-01 12:28:33 INFO     epoch complete!
2024-05-01 12:28:33 INFO     evaluating now!
2024-05-01 12:28:33 INFO     Epoch [18/200] train_loss: 5.3881, val_loss: 5.6489, lr: 0.003000, 5.48s
2024-05-01 12:28:33 INFO     Saved model at 18
2024-05-01 12:28:33 INFO     Val loss decrease from 5.9865 to 5.6489, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-01 12:28:38 INFO     epoch complete!
2024-05-01 12:28:38 INFO     evaluating now!
2024-05-01 12:28:39 INFO     Epoch [19/200] train_loss: 5.3128, val_loss: 5.7419, lr: 0.003000, 5.60s
2024-05-01 12:28:44 INFO     epoch complete!
2024-05-01 12:28:44 INFO     evaluating now!
2024-05-01 12:28:44 INFO     Epoch [20/200] train_loss: 5.2822, val_loss: 5.5211, lr: 0.003000, 5.49s
2024-05-01 12:28:44 INFO     Saved model at 20
2024-05-01 12:28:44 INFO     Val loss decrease from 5.6489 to 5.5211, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-01 12:28:49 INFO     epoch complete!
2024-05-01 12:28:49 INFO     evaluating now!
2024-05-01 12:28:49 INFO     Epoch [21/200] train_loss: 5.1555, val_loss: 5.8635, lr: 0.003000, 5.31s
2024-05-01 12:28:54 INFO     epoch complete!
2024-05-01 12:28:54 INFO     evaluating now!
2024-05-01 12:28:55 INFO     Epoch [22/200] train_loss: 5.1811, val_loss: 5.5316, lr: 0.003000, 5.29s
2024-05-01 12:29:00 INFO     epoch complete!
2024-05-01 12:29:00 INFO     evaluating now!
2024-05-01 12:29:00 INFO     Epoch [23/200] train_loss: 5.0688, val_loss: 5.7006, lr: 0.003000, 5.58s
2024-05-01 12:29:05 INFO     epoch complete!
2024-05-01 12:29:05 INFO     evaluating now!
2024-05-01 12:29:06 INFO     Epoch [24/200] train_loss: 5.0363, val_loss: 5.5218, lr: 0.003000, 5.58s
2024-05-01 12:29:11 INFO     epoch complete!
2024-05-01 12:29:11 INFO     evaluating now!
2024-05-01 12:29:11 INFO     Epoch [25/200] train_loss: 4.9199, val_loss: 5.5521, lr: 0.003000, 5.63s
2024-05-01 12:29:17 INFO     epoch complete!
2024-05-01 12:29:17 INFO     evaluating now!
2024-05-01 12:29:17 INFO     Epoch [26/200] train_loss: 4.9685, val_loss: 5.2902, lr: 0.003000, 5.60s
2024-05-01 12:29:17 INFO     Saved model at 26
2024-05-01 12:29:17 INFO     Val loss decrease from 5.5211 to 5.2902, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-05-01 12:29:22 INFO     epoch complete!
2024-05-01 12:29:22 INFO     evaluating now!
2024-05-01 12:29:23 INFO     Epoch [27/200] train_loss: 4.8800, val_loss: 5.4587, lr: 0.003000, 5.52s
2024-05-01 12:29:28 INFO     epoch complete!
2024-05-01 12:29:28 INFO     evaluating now!
2024-05-01 12:29:28 INFO     Epoch [28/200] train_loss: 4.8747, val_loss: 5.2188, lr: 0.003000, 5.59s
2024-05-01 12:29:28 INFO     Saved model at 28
2024-05-01 12:29:28 INFO     Val loss decrease from 5.2902 to 5.2188, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-05-01 12:29:34 INFO     epoch complete!
2024-05-01 12:29:34 INFO     evaluating now!
2024-05-01 12:29:34 INFO     Epoch [29/200] train_loss: 4.8424, val_loss: 5.6612, lr: 0.003000, 5.80s
2024-05-01 12:29:39 INFO     epoch complete!
2024-05-01 12:29:39 INFO     evaluating now!
2024-05-01 12:29:40 INFO     Epoch [30/200] train_loss: 4.6934, val_loss: 5.2696, lr: 0.003000, 5.52s
2024-05-01 12:29:45 INFO     epoch complete!
2024-05-01 12:29:45 INFO     evaluating now!
2024-05-01 12:29:45 INFO     Epoch [31/200] train_loss: 4.5892, val_loss: 5.2897, lr: 0.003000, 5.52s
2024-05-01 12:29:50 INFO     epoch complete!
2024-05-01 12:29:50 INFO     evaluating now!
2024-05-01 12:29:50 INFO     Epoch [32/200] train_loss: 4.6117, val_loss: 5.2624, lr: 0.003000, 5.32s
2024-05-01 12:29:55 INFO     epoch complete!
2024-05-01 12:29:55 INFO     evaluating now!
2024-05-01 12:29:56 INFO     Epoch [33/200] train_loss: 4.5895, val_loss: 5.4420, lr: 0.003000, 5.32s
2024-05-01 12:30:01 INFO     epoch complete!
2024-05-01 12:30:01 INFO     evaluating now!
2024-05-01 12:30:02 INFO     Epoch [34/200] train_loss: 4.4636, val_loss: 5.3479, lr: 0.003000, 5.79s
2024-05-01 12:30:07 INFO     epoch complete!
2024-05-01 12:30:07 INFO     evaluating now!
2024-05-01 12:30:07 INFO     Epoch [35/200] train_loss: 4.4671, val_loss: 5.3357, lr: 0.003000, 5.50s
2024-05-01 12:30:12 INFO     epoch complete!
2024-05-01 12:30:12 INFO     evaluating now!
2024-05-01 12:30:13 INFO     Epoch [36/200] train_loss: 4.3708, val_loss: 5.3815, lr: 0.003000, 5.58s
2024-05-01 12:30:18 INFO     epoch complete!
2024-05-01 12:30:18 INFO     evaluating now!
2024-05-01 12:30:18 INFO     Epoch [37/200] train_loss: 4.3876, val_loss: 5.1785, lr: 0.003000, 5.88s
2024-05-01 12:30:19 INFO     Saved model at 37
2024-05-01 12:30:19 INFO     Val loss decrease from 5.2188 to 5.1785, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-05-01 12:30:24 INFO     epoch complete!
2024-05-01 12:30:24 INFO     evaluating now!
2024-05-01 12:30:25 INFO     Epoch [38/200] train_loss: 4.3770, val_loss: 5.2806, lr: 0.003000, 6.08s
2024-05-01 12:30:30 INFO     epoch complete!
2024-05-01 12:30:30 INFO     evaluating now!
2024-05-01 12:30:31 INFO     Epoch [39/200] train_loss: 4.3977, val_loss: 5.3157, lr: 0.003000, 5.95s
2024-05-01 12:30:36 INFO     epoch complete!
2024-05-01 12:30:36 INFO     evaluating now!
2024-05-01 12:30:37 INFO     Epoch [40/200] train_loss: 4.3237, val_loss: 5.2104, lr: 0.003000, 6.25s
2024-05-01 12:30:42 INFO     epoch complete!
2024-05-01 12:30:42 INFO     evaluating now!
2024-05-01 12:30:43 INFO     Epoch [41/200] train_loss: 4.3638, val_loss: 5.1294, lr: 0.003000, 5.95s
2024-05-01 12:30:43 INFO     Saved model at 41
2024-05-01 12:30:43 INFO     Val loss decrease from 5.1785 to 5.1294, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-05-01 12:30:48 INFO     epoch complete!
2024-05-01 12:30:48 INFO     evaluating now!
2024-05-01 12:30:49 INFO     Epoch [42/200] train_loss: 4.3632, val_loss: 5.2609, lr: 0.003000, 6.05s
2024-05-01 12:30:54 INFO     epoch complete!
2024-05-01 12:30:54 INFO     evaluating now!
2024-05-01 12:30:55 INFO     Epoch [43/200] train_loss: 4.2593, val_loss: 5.0280, lr: 0.003000, 6.00s
2024-05-01 12:30:55 INFO     Saved model at 43
2024-05-01 12:30:55 INFO     Val loss decrease from 5.1294 to 5.0280, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-05-01 12:31:00 INFO     epoch complete!
2024-05-01 12:31:00 INFO     evaluating now!
2024-05-01 12:31:01 INFO     Epoch [44/200] train_loss: 4.1945, val_loss: 5.0004, lr: 0.003000, 5.92s
2024-05-01 12:31:01 INFO     Saved model at 44
2024-05-01 12:31:01 INFO     Val loss decrease from 5.0280 to 5.0004, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-05-01 12:31:06 INFO     epoch complete!
2024-05-01 12:31:06 INFO     evaluating now!
2024-05-01 12:31:07 INFO     Epoch [45/200] train_loss: 4.1651, val_loss: 5.0864, lr: 0.003000, 5.97s
2024-05-01 12:31:13 INFO     epoch complete!
2024-05-01 12:31:13 INFO     evaluating now!
2024-05-01 12:31:13 INFO     Epoch [46/200] train_loss: 4.2231, val_loss: 5.2718, lr: 0.003000, 6.17s
2024-05-01 12:31:19 INFO     epoch complete!
2024-05-01 12:31:19 INFO     evaluating now!
2024-05-01 12:31:19 INFO     Epoch [47/200] train_loss: 4.1198, val_loss: 5.0530, lr: 0.003000, 6.29s
2024-05-01 12:31:25 INFO     epoch complete!
2024-05-01 12:31:25 INFO     evaluating now!
2024-05-01 12:31:25 INFO     Epoch [48/200] train_loss: 4.1141, val_loss: 5.1380, lr: 0.003000, 5.97s
2024-05-01 12:31:31 INFO     epoch complete!
2024-05-01 12:31:31 INFO     evaluating now!
2024-05-01 12:31:31 INFO     Epoch [49/200] train_loss: 4.1202, val_loss: 5.0648, lr: 0.003000, 5.83s
2024-05-01 12:31:36 INFO     epoch complete!
2024-05-01 12:31:36 INFO     evaluating now!
2024-05-01 12:31:37 INFO     Epoch [50/200] train_loss: 4.0644, val_loss: 5.1786, lr: 0.003000, 5.69s
2024-05-01 12:31:42 INFO     epoch complete!
2024-05-01 12:31:42 INFO     evaluating now!
2024-05-01 12:31:42 INFO     Epoch [51/200] train_loss: 4.0341, val_loss: 5.0388, lr: 0.003000, 5.61s
2024-05-01 12:31:48 INFO     epoch complete!
2024-05-01 12:31:48 INFO     evaluating now!
2024-05-01 12:31:48 INFO     Epoch [52/200] train_loss: 4.0366, val_loss: 5.0972, lr: 0.003000, 5.82s
2024-05-01 12:31:54 INFO     epoch complete!
2024-05-01 12:31:54 INFO     evaluating now!
2024-05-01 12:31:54 INFO     Epoch [53/200] train_loss: 4.0981, val_loss: 5.0894, lr: 0.003000, 5.96s
2024-05-01 12:32:00 INFO     epoch complete!
2024-05-01 12:32:00 INFO     evaluating now!
2024-05-01 12:32:00 INFO     Epoch [54/200] train_loss: 4.0349, val_loss: 5.2493, lr: 0.003000, 5.71s
2024-05-01 12:32:05 INFO     epoch complete!
2024-05-01 12:32:05 INFO     evaluating now!
2024-05-01 12:32:05 INFO     Epoch [55/200] train_loss: 4.0425, val_loss: 5.1477, lr: 0.003000, 5.58s
2024-05-01 12:32:10 INFO     epoch complete!
2024-05-01 12:32:10 INFO     evaluating now!
2024-05-01 12:32:11 INFO     Epoch [56/200] train_loss: 4.1263, val_loss: 5.2672, lr: 0.003000, 5.35s
2024-05-01 12:32:16 INFO     epoch complete!
2024-05-01 12:32:16 INFO     evaluating now!
2024-05-01 12:32:16 INFO     Epoch [57/200] train_loss: 3.9119, val_loss: 5.2122, lr: 0.003000, 5.16s
2024-05-01 12:32:21 INFO     epoch complete!
2024-05-01 12:32:21 INFO     evaluating now!
2024-05-01 12:32:21 INFO     Epoch [58/200] train_loss: 3.9367, val_loss: 5.1050, lr: 0.003000, 5.10s
2024-05-01 12:32:26 INFO     epoch complete!
2024-05-01 12:32:26 INFO     evaluating now!
2024-05-01 12:32:26 INFO     Epoch [59/200] train_loss: 3.9247, val_loss: 5.0897, lr: 0.003000, 4.98s
2024-05-01 12:32:26 WARNING  Early stopping at epoch: 59
2024-05-01 12:32:26 INFO     Trained totally 60 epochs, average train time is 5.304s, average eval time is 0.387s
2024-05-01 12:32:26 INFO     Loaded model at 44
2024-05-01 12:32:26 INFO     Saved model at ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 12:32:26 INFO     Start evaluating ...
2024-05-01 12:32:28 INFO     Note that you select the single mode to evaluate!
2024-05-01 12:32:28 INFO     Evaluate result is saved at ./libcity/cache/18/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 12:32:28 INFO     
         MAE       RMSE
1   2.485806   7.366361
2   2.605906   7.999914
3   2.827766   9.244853
4   3.046041  10.229544
5   3.168753  11.070925
6   3.269533  11.678815
7   3.324822  12.354888
8   3.324015  12.788066
9   3.368548  13.105130
10  3.351441  13.249843
11  3.472516  13.526704
12  3.605923  14.195696
2024-05-01 12:32:28 INFO     ----------------------------------------------------------------------------
2024-05-01 12:32:28 INFO     # 4, Kownledge Graph Embedding: GIE, Experiment ids: 19
2024-05-01 12:32:28 INFO     ----------------------------------------------------------------------------
2024-05-01 12:32:28 INFO     Log directory: ./libcity/log
2024-05-01 12:32:28 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=19
2024-05-01 12:32:28 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 811129828, 'exp_id': 19, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'standard', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 12:32:28 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 12:32:28 INFO     set_weight_link_or_dist: dist
2024-05-01 12:32:28 INFO     init_weight_inf_or_zero: inf
2024-05-01 12:32:28 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 12:32:28 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 12:32:28 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 12:32:28 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 12:32:31 INFO     Dataset created
2024-05-01 12:32:31 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 12:32:31 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 12:32:31 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 12:32:31 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 12:32:31 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 12:32:31 INFO     StandardScaler mean: -0.1104628281371549, std: 0.18990125195044946
2024-05-01 12:32:35 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 12:32:35 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 12:32:35 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 12:32:35 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 12:32:35 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 12:32:35 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 12:32:35 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 12:32:35 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 12:32:35 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 12:32:35 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 12:32:35 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 12:32:35 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 12:32:35 INFO     Total parameter numbers: 874010
2024-05-01 12:32:35 INFO     You select `adam` optimizer.
2024-05-01 12:32:35 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 12:32:35 INFO     Start training ...
2024-05-01 12:32:35 INFO     num_batches:48
2024-05-01 12:32:39 INFO     epoch complete!
2024-05-01 12:32:39 INFO     evaluating now!
2024-05-01 12:32:40 INFO     Epoch [0/200] train_loss: 22.6739, val_loss: 18.7159, lr: 0.003000, 4.96s
2024-05-01 12:32:40 INFO     Saved model at 0
2024-05-01 12:32:40 INFO     Val loss decrease from inf to 18.7159, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 12:32:44 INFO     epoch complete!
2024-05-01 12:32:44 INFO     evaluating now!
2024-05-01 12:32:45 INFO     Epoch [1/200] train_loss: 15.8490, val_loss: 15.6685, lr: 0.003000, 5.04s
2024-05-01 12:32:45 INFO     Saved model at 1
2024-05-01 12:32:45 INFO     Val loss decrease from 18.7159 to 15.6685, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 12:32:50 INFO     epoch complete!
2024-05-01 12:32:50 INFO     evaluating now!
2024-05-01 12:32:50 INFO     Epoch [2/200] train_loss: 12.7113, val_loss: 11.9825, lr: 0.003000, 5.16s
2024-05-01 12:32:50 INFO     Saved model at 2
2024-05-01 12:32:50 INFO     Val loss decrease from 15.6685 to 11.9825, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 12:32:55 INFO     epoch complete!
2024-05-01 12:32:55 INFO     evaluating now!
2024-05-01 12:32:55 INFO     Epoch [3/200] train_loss: 10.1827, val_loss: 9.7033, lr: 0.003000, 4.86s
2024-05-01 12:32:55 INFO     Saved model at 3
2024-05-01 12:32:55 INFO     Val loss decrease from 11.9825 to 9.7033, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 12:33:00 INFO     epoch complete!
2024-05-01 12:33:00 INFO     evaluating now!
2024-05-01 12:33:00 INFO     Epoch [4/200] train_loss: 8.9676, val_loss: 8.7801, lr: 0.003000, 5.23s
2024-05-01 12:33:00 INFO     Saved model at 4
2024-05-01 12:33:00 INFO     Val loss decrease from 9.7033 to 8.7801, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 12:33:05 INFO     epoch complete!
2024-05-01 12:33:05 INFO     evaluating now!
2024-05-01 12:33:05 INFO     Epoch [5/200] train_loss: 8.1509, val_loss: 8.2749, lr: 0.003000, 5.09s
2024-05-01 12:33:05 INFO     Saved model at 5
2024-05-01 12:33:05 INFO     Val loss decrease from 8.7801 to 8.2749, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 12:33:10 INFO     epoch complete!
2024-05-01 12:33:10 INFO     evaluating now!
2024-05-01 12:33:10 INFO     Epoch [6/200] train_loss: 7.5398, val_loss: 7.2056, lr: 0.003000, 4.89s
2024-05-01 12:33:10 INFO     Saved model at 6
2024-05-01 12:33:10 INFO     Val loss decrease from 8.2749 to 7.2056, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 12:33:15 INFO     epoch complete!
2024-05-01 12:33:15 INFO     evaluating now!
2024-05-01 12:33:15 INFO     Epoch [7/200] train_loss: 6.9725, val_loss: 6.6679, lr: 0.003000, 4.98s
2024-05-01 12:33:15 INFO     Saved model at 7
2024-05-01 12:33:15 INFO     Val loss decrease from 7.2056 to 6.6679, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 12:33:20 INFO     epoch complete!
2024-05-01 12:33:20 INFO     evaluating now!
2024-05-01 12:33:20 INFO     Epoch [8/200] train_loss: 6.5754, val_loss: 6.3762, lr: 0.003000, 5.16s
2024-05-01 12:33:20 INFO     Saved model at 8
2024-05-01 12:33:20 INFO     Val loss decrease from 6.6679 to 6.3762, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-01 12:33:25 INFO     epoch complete!
2024-05-01 12:33:25 INFO     evaluating now!
2024-05-01 12:33:26 INFO     Epoch [9/200] train_loss: 6.3088, val_loss: 6.2567, lr: 0.003000, 5.07s
2024-05-01 12:33:26 INFO     Saved model at 9
2024-05-01 12:33:26 INFO     Val loss decrease from 6.3762 to 6.2567, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-01 12:33:30 INFO     epoch complete!
2024-05-01 12:33:30 INFO     evaluating now!
2024-05-01 12:33:31 INFO     Epoch [10/200] train_loss: 6.0800, val_loss: 6.1167, lr: 0.003000, 4.93s
2024-05-01 12:33:31 INFO     Saved model at 10
2024-05-01 12:33:31 INFO     Val loss decrease from 6.2567 to 6.1167, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-01 12:33:35 INFO     epoch complete!
2024-05-01 12:33:35 INFO     evaluating now!
2024-05-01 12:33:35 INFO     Epoch [11/200] train_loss: 5.8526, val_loss: 6.0761, lr: 0.003000, 4.89s
2024-05-01 12:33:36 INFO     Saved model at 11
2024-05-01 12:33:36 INFO     Val loss decrease from 6.1167 to 6.0761, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-01 12:33:40 INFO     epoch complete!
2024-05-01 12:33:40 INFO     evaluating now!
2024-05-01 12:33:41 INFO     Epoch [12/200] train_loss: 5.6923, val_loss: 5.9052, lr: 0.003000, 5.04s
2024-05-01 12:33:41 INFO     Saved model at 12
2024-05-01 12:33:41 INFO     Val loss decrease from 6.0761 to 5.9052, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-01 12:33:45 INFO     epoch complete!
2024-05-01 12:33:45 INFO     evaluating now!
2024-05-01 12:33:45 INFO     Epoch [13/200] train_loss: 5.5810, val_loss: 5.8742, lr: 0.003000, 4.85s
2024-05-01 12:33:45 INFO     Saved model at 13
2024-05-01 12:33:45 INFO     Val loss decrease from 5.9052 to 5.8742, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-01 12:33:50 INFO     epoch complete!
2024-05-01 12:33:50 INFO     evaluating now!
2024-05-01 12:33:51 INFO     Epoch [14/200] train_loss: 5.4897, val_loss: 5.6464, lr: 0.003000, 5.05s
2024-05-01 12:33:51 INFO     Saved model at 14
2024-05-01 12:33:51 INFO     Val loss decrease from 5.8742 to 5.6464, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-01 12:33:55 INFO     epoch complete!
2024-05-01 12:33:55 INFO     evaluating now!
2024-05-01 12:33:56 INFO     Epoch [15/200] train_loss: 5.4438, val_loss: 5.7060, lr: 0.003000, 5.26s
2024-05-01 12:34:01 INFO     epoch complete!
2024-05-01 12:34:01 INFO     evaluating now!
2024-05-01 12:34:01 INFO     Epoch [16/200] train_loss: 5.3362, val_loss: 5.7543, lr: 0.003000, 5.08s
2024-05-01 12:34:06 INFO     epoch complete!
2024-05-01 12:34:06 INFO     evaluating now!
2024-05-01 12:34:06 INFO     Epoch [17/200] train_loss: 5.2402, val_loss: 5.8454, lr: 0.003000, 5.00s
2024-05-01 12:34:11 INFO     epoch complete!
2024-05-01 12:34:11 INFO     evaluating now!
2024-05-01 12:34:11 INFO     Epoch [18/200] train_loss: 5.1775, val_loss: 5.6561, lr: 0.003000, 5.06s
2024-05-01 12:34:16 INFO     epoch complete!
2024-05-01 12:34:16 INFO     evaluating now!
2024-05-01 12:34:16 INFO     Epoch [19/200] train_loss: 5.1119, val_loss: 5.6199, lr: 0.003000, 4.95s
2024-05-01 12:34:16 INFO     Saved model at 19
2024-05-01 12:34:16 INFO     Val loss decrease from 5.6464 to 5.6199, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-01 12:34:20 INFO     epoch complete!
2024-05-01 12:34:21 INFO     evaluating now!
2024-05-01 12:34:21 INFO     Epoch [20/200] train_loss: 5.0060, val_loss: 5.4301, lr: 0.003000, 4.87s
2024-05-01 12:34:21 INFO     Saved model at 20
2024-05-01 12:34:21 INFO     Val loss decrease from 5.6199 to 5.4301, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-01 12:34:26 INFO     epoch complete!
2024-05-01 12:34:26 INFO     evaluating now!
2024-05-01 12:34:26 INFO     Epoch [21/200] train_loss: 4.9976, val_loss: 5.4716, lr: 0.003000, 5.04s
2024-05-01 12:34:30 INFO     epoch complete!
2024-05-01 12:34:30 INFO     evaluating now!
2024-05-01 12:34:31 INFO     Epoch [22/200] train_loss: 4.9166, val_loss: 5.3320, lr: 0.003000, 4.84s
2024-05-01 12:34:31 INFO     Saved model at 22
2024-05-01 12:34:31 INFO     Val loss decrease from 5.4301 to 5.3320, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-01 12:34:36 INFO     epoch complete!
2024-05-01 12:34:36 INFO     evaluating now!
2024-05-01 12:34:36 INFO     Epoch [23/200] train_loss: 4.7951, val_loss: 5.4622, lr: 0.003000, 5.11s
2024-05-01 12:34:40 INFO     epoch complete!
2024-05-01 12:34:40 INFO     evaluating now!
2024-05-01 12:34:41 INFO     Epoch [24/200] train_loss: 4.8696, val_loss: 5.4750, lr: 0.003000, 4.88s
2024-05-01 12:34:45 INFO     epoch complete!
2024-05-01 12:34:45 INFO     evaluating now!
2024-05-01 12:34:46 INFO     Epoch [25/200] train_loss: 4.7399, val_loss: 5.1880, lr: 0.003000, 4.90s
2024-05-01 12:34:46 INFO     Saved model at 25
2024-05-01 12:34:46 INFO     Val loss decrease from 5.3320 to 5.1880, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-01 12:34:51 INFO     epoch complete!
2024-05-01 12:34:51 INFO     evaluating now!
2024-05-01 12:34:51 INFO     Epoch [26/200] train_loss: 4.6528, val_loss: 5.3747, lr: 0.003000, 5.16s
2024-05-01 12:34:56 INFO     epoch complete!
2024-05-01 12:34:56 INFO     evaluating now!
2024-05-01 12:34:56 INFO     Epoch [27/200] train_loss: 4.5738, val_loss: 5.5986, lr: 0.003000, 4.94s
2024-05-01 12:35:01 INFO     epoch complete!
2024-05-01 12:35:01 INFO     evaluating now!
2024-05-01 12:35:01 INFO     Epoch [28/200] train_loss: 4.5099, val_loss: 5.4903, lr: 0.003000, 5.44s
2024-05-01 12:35:06 INFO     epoch complete!
2024-05-01 12:35:06 INFO     evaluating now!
2024-05-01 12:35:07 INFO     Epoch [29/200] train_loss: 4.5203, val_loss: 5.2814, lr: 0.003000, 5.39s
2024-05-01 12:35:11 INFO     epoch complete!
2024-05-01 12:35:11 INFO     evaluating now!
2024-05-01 12:35:12 INFO     Epoch [30/200] train_loss: 4.4974, val_loss: 5.2868, lr: 0.003000, 5.05s
2024-05-01 12:35:17 INFO     epoch complete!
2024-05-01 12:35:17 INFO     evaluating now!
2024-05-01 12:35:17 INFO     Epoch [31/200] train_loss: 4.4224, val_loss: 5.1349, lr: 0.003000, 5.19s
2024-05-01 12:35:17 INFO     Saved model at 31
2024-05-01 12:35:17 INFO     Val loss decrease from 5.1880 to 5.1349, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-05-01 12:35:22 INFO     epoch complete!
2024-05-01 12:35:22 INFO     evaluating now!
2024-05-01 12:35:22 INFO     Epoch [32/200] train_loss: 4.3624, val_loss: 5.2775, lr: 0.003000, 5.01s
2024-05-01 12:35:27 INFO     epoch complete!
2024-05-01 12:35:27 INFO     evaluating now!
2024-05-01 12:35:27 INFO     Epoch [33/200] train_loss: 4.3230, val_loss: 5.3042, lr: 0.003000, 5.17s
2024-05-01 12:35:32 INFO     epoch complete!
2024-05-01 12:35:32 INFO     evaluating now!
2024-05-01 12:35:32 INFO     Epoch [34/200] train_loss: 4.3024, val_loss: 5.1161, lr: 0.003000, 5.04s
2024-05-01 12:35:32 INFO     Saved model at 34
2024-05-01 12:35:32 INFO     Val loss decrease from 5.1349 to 5.1161, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-05-01 12:35:37 INFO     epoch complete!
2024-05-01 12:35:37 INFO     evaluating now!
2024-05-01 12:35:37 INFO     Epoch [35/200] train_loss: 4.2960, val_loss: 5.3823, lr: 0.003000, 5.00s
2024-05-01 12:35:42 INFO     epoch complete!
2024-05-01 12:35:42 INFO     evaluating now!
2024-05-01 12:35:42 INFO     Epoch [36/200] train_loss: 4.2803, val_loss: 5.3112, lr: 0.003000, 4.93s
2024-05-01 12:35:47 INFO     epoch complete!
2024-05-01 12:35:47 INFO     evaluating now!
2024-05-01 12:35:47 INFO     Epoch [37/200] train_loss: 4.2291, val_loss: 5.2157, lr: 0.003000, 4.91s
2024-05-01 12:35:52 INFO     epoch complete!
2024-05-01 12:35:52 INFO     evaluating now!
2024-05-01 12:35:52 INFO     Epoch [38/200] train_loss: 4.1820, val_loss: 5.0954, lr: 0.003000, 4.88s
2024-05-01 12:35:52 INFO     Saved model at 38
2024-05-01 12:35:52 INFO     Val loss decrease from 5.1161 to 5.0954, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-05-01 12:35:57 INFO     epoch complete!
2024-05-01 12:35:57 INFO     evaluating now!
2024-05-01 12:35:57 INFO     Epoch [39/200] train_loss: 4.1459, val_loss: 5.0965, lr: 0.003000, 5.01s
2024-05-01 12:36:02 INFO     epoch complete!
2024-05-01 12:36:02 INFO     evaluating now!
2024-05-01 12:36:02 INFO     Epoch [40/200] train_loss: 4.1343, val_loss: 5.2326, lr: 0.003000, 4.95s
2024-05-01 12:36:07 INFO     epoch complete!
2024-05-01 12:36:07 INFO     evaluating now!
2024-05-01 12:36:07 INFO     Epoch [41/200] train_loss: 4.1684, val_loss: 5.1240, lr: 0.003000, 4.98s
2024-05-01 12:36:11 INFO     epoch complete!
2024-05-01 12:36:11 INFO     evaluating now!
2024-05-01 12:36:12 INFO     Epoch [42/200] train_loss: 5.1394, val_loss: 5.1816, lr: 0.003000, 4.85s
2024-05-01 12:36:16 INFO     epoch complete!
2024-05-01 12:36:16 INFO     evaluating now!
2024-05-01 12:36:17 INFO     Epoch [43/200] train_loss: 4.4184, val_loss: 5.1039, lr: 0.003000, 4.87s
2024-05-01 12:36:21 INFO     epoch complete!
2024-05-01 12:36:21 INFO     evaluating now!
2024-05-01 12:36:22 INFO     Epoch [44/200] train_loss: 4.1856, val_loss: 4.9214, lr: 0.003000, 4.86s
2024-05-01 12:36:22 INFO     Saved model at 44
2024-05-01 12:36:22 INFO     Val loss decrease from 5.0954 to 4.9214, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-05-01 12:36:26 INFO     epoch complete!
2024-05-01 12:36:26 INFO     evaluating now!
2024-05-01 12:36:26 INFO     Epoch [45/200] train_loss: 4.1626, val_loss: 5.1669, lr: 0.003000, 4.92s
2024-05-01 12:36:31 INFO     epoch complete!
2024-05-01 12:36:31 INFO     evaluating now!
2024-05-01 12:36:31 INFO     Epoch [46/200] train_loss: 4.1381, val_loss: 5.0420, lr: 0.003000, 4.84s
2024-05-01 12:36:36 INFO     epoch complete!
2024-05-01 12:36:36 INFO     evaluating now!
2024-05-01 12:36:36 INFO     Epoch [47/200] train_loss: 3.9979, val_loss: 5.1220, lr: 0.003000, 4.95s
2024-05-01 12:36:41 INFO     epoch complete!
2024-05-01 12:36:41 INFO     evaluating now!
2024-05-01 12:36:41 INFO     Epoch [48/200] train_loss: 4.0321, val_loss: 5.0974, lr: 0.003000, 4.97s
2024-05-01 12:36:46 INFO     epoch complete!
2024-05-01 12:36:46 INFO     evaluating now!
2024-05-01 12:36:46 INFO     Epoch [49/200] train_loss: 3.9475, val_loss: 5.1051, lr: 0.003000, 4.82s
2024-05-01 12:36:51 INFO     epoch complete!
2024-05-01 12:36:51 INFO     evaluating now!
2024-05-01 12:36:51 INFO     Epoch [50/200] train_loss: 3.9240, val_loss: 5.1600, lr: 0.003000, 5.07s
2024-05-01 12:36:56 INFO     epoch complete!
2024-05-01 12:36:56 INFO     evaluating now!
2024-05-01 12:36:56 INFO     Epoch [51/200] train_loss: 3.8927, val_loss: 5.0517, lr: 0.003000, 4.84s
2024-05-01 12:37:01 INFO     epoch complete!
2024-05-01 12:37:01 INFO     evaluating now!
2024-05-01 12:37:01 INFO     Epoch [52/200] train_loss: 3.8837, val_loss: 5.0922, lr: 0.003000, 4.86s
2024-05-01 12:37:05 INFO     epoch complete!
2024-05-01 12:37:05 INFO     evaluating now!
2024-05-01 12:37:06 INFO     Epoch [53/200] train_loss: 3.8315, val_loss: 4.9844, lr: 0.003000, 4.84s
2024-05-01 12:37:10 INFO     epoch complete!
2024-05-01 12:37:10 INFO     evaluating now!
2024-05-01 12:37:11 INFO     Epoch [54/200] train_loss: 3.8596, val_loss: 5.1367, lr: 0.003000, 4.80s
2024-05-01 12:37:15 INFO     epoch complete!
2024-05-01 12:37:15 INFO     evaluating now!
2024-05-01 12:37:15 INFO     Epoch [55/200] train_loss: 3.7952, val_loss: 4.9938, lr: 0.003000, 4.84s
2024-05-01 12:37:20 INFO     epoch complete!
2024-05-01 12:37:20 INFO     evaluating now!
2024-05-01 12:37:20 INFO     Epoch [56/200] train_loss: 3.8249, val_loss: 5.0899, lr: 0.003000, 4.84s
2024-05-01 12:37:25 INFO     epoch complete!
2024-05-01 12:37:25 INFO     evaluating now!
2024-05-01 12:37:25 INFO     Epoch [57/200] train_loss: 3.8186, val_loss: 5.0330, lr: 0.003000, 4.86s
2024-05-01 12:37:30 INFO     epoch complete!
2024-05-01 12:37:30 INFO     evaluating now!
2024-05-01 12:37:30 INFO     Epoch [58/200] train_loss: 3.7185, val_loss: 4.9669, lr: 0.003000, 4.86s
2024-05-01 12:37:34 INFO     epoch complete!
2024-05-01 12:37:34 INFO     evaluating now!
2024-05-01 12:37:35 INFO     Epoch [59/200] train_loss: 3.7108, val_loss: 4.9743, lr: 0.003000, 4.84s
2024-05-01 12:37:35 WARNING  Early stopping at epoch: 59
2024-05-01 12:37:35 INFO     Trained totally 60 epochs, average train time is 4.624s, average eval time is 0.356s
2024-05-01 12:37:35 INFO     Loaded model at 44
2024-05-01 12:37:35 INFO     Saved model at ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 12:37:35 INFO     Start evaluating ...
2024-05-01 12:37:36 INFO     Note that you select the single mode to evaluate!
2024-05-01 12:37:36 INFO     Evaluate result is saved at ./libcity/cache/19/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 12:37:36 INFO     
         MAE       RMSE
1   2.457748   7.191284
2   2.524660   7.700315
3   2.615489   8.567344
4   2.752001   9.210504
5   2.914796  10.001945
6   3.031234  11.014239
7   3.214880  12.090464
8   3.327141  12.882373
9   3.388285  13.319715
10  3.409706  13.405969
11  3.554924  13.736310
12  3.604989  14.347640
2024-05-01 12:37:36 INFO     ----------------------------------------------------------------------------
2024-05-01 12:37:36 INFO     Kownledge Graph Embedding: GIE, Experiment ids: [15, 16, 17, 18, 19]
2024-05-01 12:37:36 INFO     ----------------------------------------------------------------------------
2024-05-01 12:37:36 INFO     Average: 
         MAE       RMSE
0   2.417353   7.192655
1   2.490945   7.766662
2   2.661562   8.776692
3   2.849848   9.530177
4   2.986722  10.348751
5   3.096300  11.215816
6   3.197643  12.089740
7   3.277577  12.709888
8   3.309415  13.130654
9   3.339951  13.281622
10  3.400172  13.592763
11  3.519907  14.271215 
2024-05-01 12:37:36 INFO     Standard deviation: 
         MAE      RMSE
0   0.083842  0.244924
1   0.073423  0.227641
2   0.083426  0.274932
3   0.105802  0.387753
4   0.096175  0.444624
5   0.110747  0.484083
6   0.085278  0.623671
7   0.065717  0.711538
8   0.078338  0.717576
9   0.039336  0.653298
10  0.097033  0.493827
11  0.070179  0.313485
2024-05-01 12:37:36 INFO     ----------------------------------------------------------------------------
2024-05-01 12:37:36 INFO     12 steps Average: 
        MAE       RMSE
0  3.045616  11.158886
2024-05-01 12:37:36 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.082441  0.464779
