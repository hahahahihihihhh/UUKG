2024-05-02 23:25:51 INFO     Saving logs in: ./logs/CHITaxi20190406/AGCRN/ExtSpace/Scaler/normal/AttH
2024-05-02 23:25:51 INFO     ----------------------------------------------------------------------------
2024-05-02 23:25:51 INFO     # 0, Kownledge Graph Embedding: AttH, Experiment ids: 50
2024-05-02 23:25:51 INFO     ----------------------------------------------------------------------------
2024-05-02 23:25:51 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=50
2024-05-02 23:25:51 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 50, 'load_external': True, 'embedding_model': 'AttH', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 23:25:51 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 23:25:51 INFO     set_weight_link_or_dist: dist
2024-05-02 23:25:51 INFO     init_weight_inf_or_zero: inf
2024-05-02 23:25:51 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 23:25:51 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 23:25:51 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 23:25:52 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 23:25:54 INFO     Dataset created
2024-05-02 23:25:54 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-02 23:25:54 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-02 23:25:54 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-02 23:25:54 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-02 23:25:54 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 23:25:55 INFO     NormalScaler max: 0.42800777917098476
2024-05-02 23:26:01 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 23:26:01 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 23:26:01 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-02 23:26:01 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 23:26:01 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-02 23:26:01 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 23:26:01 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 23:26:01 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 23:26:01 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 23:26:01 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 23:26:01 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 23:26:01 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 23:26:01 INFO     Total parameter numbers: 874010
2024-05-02 23:26:01 INFO     You select `adam` optimizer.
2024-05-02 23:26:01 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 23:26:01 INFO     Start training ...
2024-05-02 23:26:01 INFO     num_batches:48
2024-05-02 23:26:07 INFO     epoch complete!
2024-05-02 23:26:07 INFO     evaluating now!
2024-05-02 23:26:08 INFO     Epoch [0/200] train_loss: 23.4803, val_loss: 18.3489, lr: 0.003000, 6.79s
2024-05-02 23:26:08 INFO     Saved model at 0
2024-05-02 23:26:08 INFO     Val loss decrease from inf to 18.3489, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 23:26:14 INFO     epoch complete!
2024-05-02 23:26:14 INFO     evaluating now!
2024-05-02 23:26:14 INFO     Epoch [1/200] train_loss: 14.7456, val_loss: 13.8306, lr: 0.003000, 6.31s
2024-05-02 23:26:14 INFO     Saved model at 1
2024-05-02 23:26:14 INFO     Val loss decrease from 18.3489 to 13.8306, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 23:26:20 INFO     epoch complete!
2024-05-02 23:26:20 INFO     evaluating now!
2024-05-02 23:26:21 INFO     Epoch [2/200] train_loss: 11.3950, val_loss: 11.0109, lr: 0.003000, 6.39s
2024-05-02 23:26:21 INFO     Saved model at 2
2024-05-02 23:26:21 INFO     Val loss decrease from 13.8306 to 11.0109, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 23:26:27 INFO     epoch complete!
2024-05-02 23:26:27 INFO     evaluating now!
2024-05-02 23:26:28 INFO     Epoch [3/200] train_loss: 9.5233, val_loss: 9.5388, lr: 0.003000, 7.15s
2024-05-02 23:26:28 INFO     Saved model at 3
2024-05-02 23:26:28 INFO     Val loss decrease from 11.0109 to 9.5388, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 23:26:34 INFO     epoch complete!
2024-05-02 23:26:34 INFO     evaluating now!
2024-05-02 23:26:35 INFO     Epoch [4/200] train_loss: 8.2721, val_loss: 8.1736, lr: 0.003000, 6.74s
2024-05-02 23:26:35 INFO     Saved model at 4
2024-05-02 23:26:35 INFO     Val loss decrease from 9.5388 to 8.1736, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 23:26:41 INFO     epoch complete!
2024-05-02 23:26:41 INFO     evaluating now!
2024-05-02 23:26:41 INFO     Epoch [5/200] train_loss: 7.4959, val_loss: 7.0828, lr: 0.003000, 6.77s
2024-05-02 23:26:41 INFO     Saved model at 5
2024-05-02 23:26:41 INFO     Val loss decrease from 8.1736 to 7.0828, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 23:26:48 INFO     epoch complete!
2024-05-02 23:26:48 INFO     evaluating now!
2024-05-02 23:26:48 INFO     Epoch [6/200] train_loss: 6.9796, val_loss: 6.9536, lr: 0.003000, 6.94s
2024-05-02 23:26:48 INFO     Saved model at 6
2024-05-02 23:26:48 INFO     Val loss decrease from 7.0828 to 6.9536, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 23:26:55 INFO     epoch complete!
2024-05-02 23:26:55 INFO     evaluating now!
2024-05-02 23:26:55 INFO     Epoch [7/200] train_loss: 6.5439, val_loss: 6.3382, lr: 0.003000, 6.75s
2024-05-02 23:26:55 INFO     Saved model at 7
2024-05-02 23:26:55 INFO     Val loss decrease from 6.9536 to 6.3382, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 23:27:02 INFO     epoch complete!
2024-05-02 23:27:02 INFO     evaluating now!
2024-05-02 23:27:02 INFO     Epoch [8/200] train_loss: 6.3159, val_loss: 6.3981, lr: 0.003000, 6.85s
2024-05-02 23:27:08 INFO     epoch complete!
2024-05-02 23:27:08 INFO     evaluating now!
2024-05-02 23:27:09 INFO     Epoch [9/200] train_loss: 5.9888, val_loss: 6.0972, lr: 0.003000, 6.84s
2024-05-02 23:27:09 INFO     Saved model at 9
2024-05-02 23:27:09 INFO     Val loss decrease from 6.3382 to 6.0972, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 23:27:15 INFO     epoch complete!
2024-05-02 23:27:15 INFO     evaluating now!
2024-05-02 23:27:16 INFO     Epoch [10/200] train_loss: 5.8502, val_loss: 6.0600, lr: 0.003000, 6.96s
2024-05-02 23:27:16 INFO     Saved model at 10
2024-05-02 23:27:16 INFO     Val loss decrease from 6.0972 to 6.0600, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 23:27:22 INFO     epoch complete!
2024-05-02 23:27:22 INFO     evaluating now!
2024-05-02 23:27:23 INFO     Epoch [11/200] train_loss: 5.6719, val_loss: 5.9131, lr: 0.003000, 6.86s
2024-05-02 23:27:23 INFO     Saved model at 11
2024-05-02 23:27:23 INFO     Val loss decrease from 6.0600 to 5.9131, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 23:27:29 INFO     epoch complete!
2024-05-02 23:27:29 INFO     evaluating now!
2024-05-02 23:27:30 INFO     Epoch [12/200] train_loss: 5.5545, val_loss: 5.8352, lr: 0.003000, 6.65s
2024-05-02 23:27:30 INFO     Saved model at 12
2024-05-02 23:27:30 INFO     Val loss decrease from 5.9131 to 5.8352, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 23:27:36 INFO     epoch complete!
2024-05-02 23:27:36 INFO     evaluating now!
2024-05-02 23:27:36 INFO     Epoch [13/200] train_loss: 5.3367, val_loss: 5.5437, lr: 0.003000, 6.76s
2024-05-02 23:27:36 INFO     Saved model at 13
2024-05-02 23:27:36 INFO     Val loss decrease from 5.8352 to 5.5437, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-02 23:27:43 INFO     epoch complete!
2024-05-02 23:27:43 INFO     evaluating now!
2024-05-02 23:27:43 INFO     Epoch [14/200] train_loss: 5.3674, val_loss: 5.6202, lr: 0.003000, 6.71s
2024-05-02 23:27:49 INFO     epoch complete!
2024-05-02 23:27:49 INFO     evaluating now!
2024-05-02 23:27:50 INFO     Epoch [15/200] train_loss: 5.3291, val_loss: 5.4692, lr: 0.003000, 6.59s
2024-05-02 23:27:50 INFO     Saved model at 15
2024-05-02 23:27:50 INFO     Val loss decrease from 5.5437 to 5.4692, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-02 23:27:56 INFO     epoch complete!
2024-05-02 23:27:56 INFO     evaluating now!
2024-05-02 23:27:56 INFO     Epoch [16/200] train_loss: 5.2333, val_loss: 5.5074, lr: 0.003000, 6.64s
2024-05-02 23:28:03 INFO     epoch complete!
2024-05-02 23:28:03 INFO     evaluating now!
2024-05-02 23:28:03 INFO     Epoch [17/200] train_loss: 5.0473, val_loss: 5.5927, lr: 0.003000, 6.79s
2024-05-02 23:28:09 INFO     epoch complete!
2024-05-02 23:28:09 INFO     evaluating now!
2024-05-02 23:28:10 INFO     Epoch [18/200] train_loss: 5.0497, val_loss: 5.4509, lr: 0.003000, 6.80s
2024-05-02 23:28:10 INFO     Saved model at 18
2024-05-02 23:28:10 INFO     Val loss decrease from 5.4692 to 5.4509, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-02 23:28:16 INFO     epoch complete!
2024-05-02 23:28:16 INFO     evaluating now!
2024-05-02 23:28:17 INFO     Epoch [19/200] train_loss: 4.8545, val_loss: 5.3201, lr: 0.003000, 6.80s
2024-05-02 23:28:17 INFO     Saved model at 19
2024-05-02 23:28:17 INFO     Val loss decrease from 5.4509 to 5.3201, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-02 23:28:23 INFO     epoch complete!
2024-05-02 23:28:23 INFO     evaluating now!
2024-05-02 23:28:24 INFO     Epoch [20/200] train_loss: 4.8239, val_loss: 5.4793, lr: 0.003000, 7.00s
2024-05-02 23:28:30 INFO     epoch complete!
2024-05-02 23:28:30 INFO     evaluating now!
2024-05-02 23:28:31 INFO     Epoch [21/200] train_loss: 4.8110, val_loss: 5.2513, lr: 0.003000, 6.77s
2024-05-02 23:28:31 INFO     Saved model at 21
2024-05-02 23:28:31 INFO     Val loss decrease from 5.3201 to 5.2513, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-02 23:28:37 INFO     epoch complete!
2024-05-02 23:28:37 INFO     evaluating now!
2024-05-02 23:28:38 INFO     Epoch [22/200] train_loss: 4.7372, val_loss: 5.3342, lr: 0.003000, 7.08s
2024-05-02 23:28:44 INFO     epoch complete!
2024-05-02 23:28:44 INFO     evaluating now!
2024-05-02 23:28:45 INFO     Epoch [23/200] train_loss: 4.6179, val_loss: 5.2859, lr: 0.003000, 6.79s
2024-05-02 23:28:51 INFO     epoch complete!
2024-05-02 23:28:51 INFO     evaluating now!
2024-05-02 23:28:51 INFO     Epoch [24/200] train_loss: 4.5864, val_loss: 5.1870, lr: 0.003000, 6.78s
2024-05-02 23:28:51 INFO     Saved model at 24
2024-05-02 23:28:51 INFO     Val loss decrease from 5.2513 to 5.1870, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-02 23:28:58 INFO     epoch complete!
2024-05-02 23:28:58 INFO     evaluating now!
2024-05-02 23:28:58 INFO     Epoch [25/200] train_loss: 4.5694, val_loss: 5.1667, lr: 0.003000, 6.78s
2024-05-02 23:28:58 INFO     Saved model at 25
2024-05-02 23:28:58 INFO     Val loss decrease from 5.1870 to 5.1667, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-02 23:29:05 INFO     epoch complete!
2024-05-02 23:29:05 INFO     evaluating now!
2024-05-02 23:29:05 INFO     Epoch [26/200] train_loss: 4.4541, val_loss: 5.3579, lr: 0.003000, 6.92s
2024-05-02 23:29:11 INFO     epoch complete!
2024-05-02 23:29:11 INFO     evaluating now!
2024-05-02 23:29:12 INFO     Epoch [27/200] train_loss: 4.4635, val_loss: 5.2251, lr: 0.003000, 6.81s
2024-05-02 23:29:18 INFO     epoch complete!
2024-05-02 23:29:18 INFO     evaluating now!
2024-05-02 23:29:19 INFO     Epoch [28/200] train_loss: 4.4055, val_loss: 5.3992, lr: 0.003000, 6.87s
2024-05-02 23:29:25 INFO     epoch complete!
2024-05-02 23:29:25 INFO     evaluating now!
2024-05-02 23:29:26 INFO     Epoch [29/200] train_loss: 4.3274, val_loss: 5.2321, lr: 0.003000, 6.79s
2024-05-02 23:29:32 INFO     epoch complete!
2024-05-02 23:29:32 INFO     evaluating now!
2024-05-02 23:29:32 INFO     Epoch [30/200] train_loss: 4.3225, val_loss: 5.3075, lr: 0.003000, 6.68s
2024-05-02 23:29:39 INFO     epoch complete!
2024-05-02 23:29:39 INFO     evaluating now!
2024-05-02 23:29:39 INFO     Epoch [31/200] train_loss: 4.2918, val_loss: 5.1820, lr: 0.003000, 6.84s
2024-05-02 23:29:45 INFO     epoch complete!
2024-05-02 23:29:45 INFO     evaluating now!
2024-05-02 23:29:46 INFO     Epoch [32/200] train_loss: 4.2856, val_loss: 5.1769, lr: 0.003000, 6.75s
2024-05-02 23:29:52 INFO     epoch complete!
2024-05-02 23:29:52 INFO     evaluating now!
2024-05-02 23:29:53 INFO     Epoch [33/200] train_loss: 4.2455, val_loss: 5.2580, lr: 0.003000, 6.80s
2024-05-02 23:29:59 INFO     epoch complete!
2024-05-02 23:29:59 INFO     evaluating now!
2024-05-02 23:29:59 INFO     Epoch [34/200] train_loss: 4.2210, val_loss: 5.2106, lr: 0.003000, 6.79s
2024-05-02 23:30:06 INFO     epoch complete!
2024-05-02 23:30:06 INFO     evaluating now!
2024-05-02 23:30:06 INFO     Epoch [35/200] train_loss: 4.1872, val_loss: 5.1546, lr: 0.003000, 6.64s
2024-05-02 23:30:06 INFO     Saved model at 35
2024-05-02 23:30:06 INFO     Val loss decrease from 5.1667 to 5.1546, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-05-02 23:30:12 INFO     epoch complete!
2024-05-02 23:30:12 INFO     evaluating now!
2024-05-02 23:30:13 INFO     Epoch [36/200] train_loss: 4.1308, val_loss: 5.2141, lr: 0.003000, 6.63s
2024-05-02 23:30:19 INFO     epoch complete!
2024-05-02 23:30:19 INFO     evaluating now!
2024-05-02 23:30:20 INFO     Epoch [37/200] train_loss: 4.0966, val_loss: 5.2112, lr: 0.003000, 6.88s
2024-05-02 23:30:26 INFO     epoch complete!
2024-05-02 23:30:26 INFO     evaluating now!
2024-05-02 23:30:26 INFO     Epoch [38/200] train_loss: 4.0417, val_loss: 5.1517, lr: 0.003000, 6.69s
2024-05-02 23:30:26 INFO     Saved model at 38
2024-05-02 23:30:26 INFO     Val loss decrease from 5.1546 to 5.1517, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-05-02 23:30:33 INFO     epoch complete!
2024-05-02 23:30:33 INFO     evaluating now!
2024-05-02 23:30:33 INFO     Epoch [39/200] train_loss: 4.0829, val_loss: 5.2827, lr: 0.003000, 6.62s
2024-05-02 23:30:39 INFO     epoch complete!
2024-05-02 23:30:39 INFO     evaluating now!
2024-05-02 23:30:40 INFO     Epoch [40/200] train_loss: 4.0619, val_loss: 5.1697, lr: 0.003000, 6.75s
2024-05-02 23:30:46 INFO     epoch complete!
2024-05-02 23:30:46 INFO     evaluating now!
2024-05-02 23:30:46 INFO     Epoch [41/200] train_loss: 3.9978, val_loss: 5.2244, lr: 0.003000, 6.70s
2024-05-02 23:30:53 INFO     epoch complete!
2024-05-02 23:30:53 INFO     evaluating now!
2024-05-02 23:30:53 INFO     Epoch [42/200] train_loss: 4.0376, val_loss: 5.1165, lr: 0.003000, 6.60s
2024-05-02 23:30:53 INFO     Saved model at 42
2024-05-02 23:30:53 INFO     Val loss decrease from 5.1517 to 5.1165, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-05-02 23:31:00 INFO     epoch complete!
2024-05-02 23:31:00 INFO     evaluating now!
2024-05-02 23:31:00 INFO     Epoch [43/200] train_loss: 3.9450, val_loss: 5.3066, lr: 0.003000, 7.27s
2024-05-02 23:31:07 INFO     epoch complete!
2024-05-02 23:31:07 INFO     evaluating now!
2024-05-02 23:31:08 INFO     Epoch [44/200] train_loss: 3.9256, val_loss: 5.2533, lr: 0.003000, 7.28s
2024-05-02 23:31:14 INFO     epoch complete!
2024-05-02 23:31:14 INFO     evaluating now!
2024-05-02 23:31:15 INFO     Epoch [45/200] train_loss: 3.9229, val_loss: 5.1051, lr: 0.003000, 7.28s
2024-05-02 23:31:15 INFO     Saved model at 45
2024-05-02 23:31:15 INFO     Val loss decrease from 5.1165 to 5.1051, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-05-02 23:31:21 INFO     epoch complete!
2024-05-02 23:31:21 INFO     evaluating now!
2024-05-02 23:31:22 INFO     Epoch [46/200] train_loss: 3.8750, val_loss: 5.1533, lr: 0.003000, 6.79s
2024-05-02 23:31:28 INFO     epoch complete!
2024-05-02 23:31:28 INFO     evaluating now!
2024-05-02 23:31:28 INFO     Epoch [47/200] train_loss: 3.8474, val_loss: 5.1531, lr: 0.003000, 6.40s
2024-05-02 23:31:34 INFO     epoch complete!
2024-05-02 23:31:34 INFO     evaluating now!
2024-05-02 23:31:34 INFO     Epoch [48/200] train_loss: 3.8594, val_loss: 5.1636, lr: 0.003000, 6.37s
2024-05-02 23:31:40 INFO     epoch complete!
2024-05-02 23:31:40 INFO     evaluating now!
2024-05-02 23:31:41 INFO     Epoch [49/200] train_loss: 3.7866, val_loss: 5.1909, lr: 0.003000, 6.37s
2024-05-02 23:31:47 INFO     epoch complete!
2024-05-02 23:31:47 INFO     evaluating now!
2024-05-02 23:31:47 INFO     Epoch [50/200] train_loss: 3.8512, val_loss: 5.1392, lr: 0.003000, 6.36s
2024-05-02 23:31:53 INFO     epoch complete!
2024-05-02 23:31:53 INFO     evaluating now!
2024-05-02 23:31:54 INFO     Epoch [51/200] train_loss: 3.8169, val_loss: 5.0268, lr: 0.003000, 6.39s
2024-05-02 23:31:54 INFO     Saved model at 51
2024-05-02 23:31:54 INFO     Val loss decrease from 5.1051 to 5.0268, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-05-02 23:32:00 INFO     epoch complete!
2024-05-02 23:32:00 INFO     evaluating now!
2024-05-02 23:32:00 INFO     Epoch [52/200] train_loss: 3.8053, val_loss: 5.0469, lr: 0.003000, 6.76s
2024-05-02 23:32:07 INFO     epoch complete!
2024-05-02 23:32:07 INFO     evaluating now!
2024-05-02 23:32:08 INFO     Epoch [53/200] train_loss: 3.7535, val_loss: 5.1359, lr: 0.003000, 7.13s
2024-05-02 23:32:14 INFO     epoch complete!
2024-05-02 23:32:14 INFO     evaluating now!
2024-05-02 23:32:14 INFO     Epoch [54/200] train_loss: 3.7617, val_loss: 5.2277, lr: 0.003000, 6.68s
2024-05-02 23:32:20 INFO     epoch complete!
2024-05-02 23:32:20 INFO     evaluating now!
2024-05-02 23:32:21 INFO     Epoch [55/200] train_loss: 3.7776, val_loss: 5.2735, lr: 0.003000, 6.69s
2024-05-02 23:32:28 INFO     epoch complete!
2024-05-02 23:32:28 INFO     evaluating now!
2024-05-02 23:32:28 INFO     Epoch [56/200] train_loss: 3.6678, val_loss: 5.1698, lr: 0.003000, 7.02s
2024-05-02 23:32:35 INFO     epoch complete!
2024-05-02 23:32:35 INFO     evaluating now!
2024-05-02 23:32:35 INFO     Epoch [57/200] train_loss: 3.6554, val_loss: 5.1081, lr: 0.003000, 7.31s
2024-05-02 23:32:42 INFO     epoch complete!
2024-05-02 23:32:42 INFO     evaluating now!
2024-05-02 23:32:42 INFO     Epoch [58/200] train_loss: 3.6970, val_loss: 5.1201, lr: 0.003000, 6.90s
2024-05-02 23:32:48 INFO     epoch complete!
2024-05-02 23:32:48 INFO     evaluating now!
2024-05-02 23:32:49 INFO     Epoch [59/200] train_loss: 3.6579, val_loss: 5.3088, lr: 0.003000, 6.68s
2024-05-02 23:32:55 INFO     epoch complete!
2024-05-02 23:32:55 INFO     evaluating now!
2024-05-02 23:32:56 INFO     Epoch [60/200] train_loss: 3.6519, val_loss: 5.2330, lr: 0.003000, 6.76s
2024-05-02 23:33:02 INFO     epoch complete!
2024-05-02 23:33:02 INFO     evaluating now!
2024-05-02 23:33:02 INFO     Epoch [61/200] train_loss: 3.6521, val_loss: 5.1777, lr: 0.003000, 6.77s
2024-05-02 23:33:09 INFO     epoch complete!
2024-05-02 23:33:09 INFO     evaluating now!
2024-05-02 23:33:09 INFO     Epoch [62/200] train_loss: 3.6575, val_loss: 5.1284, lr: 0.003000, 6.93s
2024-05-02 23:33:16 INFO     epoch complete!
2024-05-02 23:33:16 INFO     evaluating now!
2024-05-02 23:33:16 INFO     Epoch [63/200] train_loss: 3.6297, val_loss: 5.1787, lr: 0.003000, 6.70s
2024-05-02 23:33:22 INFO     epoch complete!
2024-05-02 23:33:22 INFO     evaluating now!
2024-05-02 23:33:23 INFO     Epoch [64/200] train_loss: 3.5675, val_loss: 5.0241, lr: 0.003000, 6.76s
2024-05-02 23:33:23 INFO     Saved model at 64
2024-05-02 23:33:23 INFO     Val loss decrease from 5.0268 to 5.0241, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch64.tar
2024-05-02 23:33:29 INFO     epoch complete!
2024-05-02 23:33:29 INFO     evaluating now!
2024-05-02 23:33:30 INFO     Epoch [65/200] train_loss: 3.5781, val_loss: 5.0888, lr: 0.003000, 6.91s
2024-05-02 23:33:36 INFO     epoch complete!
2024-05-02 23:33:36 INFO     evaluating now!
2024-05-02 23:33:37 INFO     Epoch [66/200] train_loss: 3.5820, val_loss: 5.0224, lr: 0.003000, 6.80s
2024-05-02 23:33:37 INFO     Saved model at 66
2024-05-02 23:33:37 INFO     Val loss decrease from 5.0241 to 5.0224, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch66.tar
2024-05-02 23:33:43 INFO     epoch complete!
2024-05-02 23:33:43 INFO     evaluating now!
2024-05-02 23:33:43 INFO     Epoch [67/200] train_loss: 3.5151, val_loss: 5.1517, lr: 0.003000, 6.88s
2024-05-02 23:33:50 INFO     epoch complete!
2024-05-02 23:33:50 INFO     evaluating now!
2024-05-02 23:33:50 INFO     Epoch [68/200] train_loss: 3.5411, val_loss: 5.1193, lr: 0.003000, 6.44s
2024-05-02 23:33:55 INFO     epoch complete!
2024-05-02 23:33:55 INFO     evaluating now!
2024-05-02 23:33:56 INFO     Epoch [69/200] train_loss: 3.5197, val_loss: 5.1221, lr: 0.003000, 5.89s
2024-05-02 23:34:01 INFO     epoch complete!
2024-05-02 23:34:01 INFO     evaluating now!
2024-05-02 23:34:02 INFO     Epoch [70/200] train_loss: 3.5768, val_loss: 5.0652, lr: 0.003000, 5.84s
2024-05-02 23:34:08 INFO     epoch complete!
2024-05-02 23:34:08 INFO     evaluating now!
2024-05-02 23:34:08 INFO     Epoch [71/200] train_loss: 3.5722, val_loss: 5.1831, lr: 0.003000, 6.60s
2024-05-02 23:34:15 INFO     epoch complete!
2024-05-02 23:34:15 INFO     evaluating now!
2024-05-02 23:34:15 INFO     Epoch [72/200] train_loss: 3.5201, val_loss: 5.1998, lr: 0.003000, 6.74s
2024-05-02 23:34:21 INFO     epoch complete!
2024-05-02 23:34:21 INFO     evaluating now!
2024-05-02 23:34:22 INFO     Epoch [73/200] train_loss: 3.5758, val_loss: 5.0356, lr: 0.003000, 6.72s
2024-05-02 23:34:28 INFO     epoch complete!
2024-05-02 23:34:28 INFO     evaluating now!
2024-05-02 23:34:28 INFO     Epoch [74/200] train_loss: 3.4683, val_loss: 5.0805, lr: 0.003000, 6.73s
2024-05-02 23:34:35 INFO     epoch complete!
2024-05-02 23:34:35 INFO     evaluating now!
2024-05-02 23:34:35 INFO     Epoch [75/200] train_loss: 3.4808, val_loss: 5.1539, lr: 0.003000, 6.87s
2024-05-02 23:34:42 INFO     epoch complete!
2024-05-02 23:34:42 INFO     evaluating now!
2024-05-02 23:34:42 INFO     Epoch [76/200] train_loss: 3.5001, val_loss: 5.0777, lr: 0.003000, 7.00s
2024-05-02 23:34:49 INFO     epoch complete!
2024-05-02 23:34:49 INFO     evaluating now!
2024-05-02 23:34:49 INFO     Epoch [77/200] train_loss: 3.4444, val_loss: 5.0824, lr: 0.003000, 6.74s
2024-05-02 23:34:55 INFO     epoch complete!
2024-05-02 23:34:55 INFO     evaluating now!
2024-05-02 23:34:56 INFO     Epoch [78/200] train_loss: 3.3862, val_loss: 5.1094, lr: 0.003000, 6.64s
2024-05-02 23:35:02 INFO     epoch complete!
2024-05-02 23:35:02 INFO     evaluating now!
2024-05-02 23:35:03 INFO     Epoch [79/200] train_loss: 3.3822, val_loss: 5.1417, lr: 0.003000, 6.92s
2024-05-02 23:35:09 INFO     epoch complete!
2024-05-02 23:35:09 INFO     evaluating now!
2024-05-02 23:35:09 INFO     Epoch [80/200] train_loss: 3.3942, val_loss: 5.2310, lr: 0.003000, 6.75s
2024-05-02 23:35:16 INFO     epoch complete!
2024-05-02 23:35:16 INFO     evaluating now!
2024-05-02 23:35:16 INFO     Epoch [81/200] train_loss: 3.3716, val_loss: 5.2499, lr: 0.003000, 6.76s
2024-05-02 23:35:16 WARNING  Early stopping at epoch: 81
2024-05-02 23:35:16 INFO     Trained totally 82 epochs, average train time is 6.325s, average eval time is 0.429s
2024-05-02 23:35:16 INFO     Loaded model at 66
2024-05-02 23:35:16 INFO     Saved model at ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 23:35:16 INFO     Start evaluating ...
2024-05-02 23:35:18 INFO     Note that you select the single mode to evaluate!
2024-05-02 23:35:18 INFO     Evaluate result is saved at ./libcity/cache/50/evaluate_cache/2024_05_02_23_35_18_AGCRN_CHITaxi20190406.csv
2024-05-02 23:35:18 INFO     
         MAE       RMSE
1   2.470089   7.073771
2   2.566301   7.749826
3   2.682248   8.727003
4   2.848766   9.361187
5   3.005374  10.089719
6   3.065299  10.829594
7   3.215473  11.763227
8   3.180918  12.397554
9   3.282644  12.821860
10  3.318344  13.006749
11  3.425252  13.291142
12  3.525104  13.649894
2024-05-02 23:35:18 INFO     ----------------------------------------------------------------------------
2024-05-02 23:35:18 INFO     # 1, Kownledge Graph Embedding: AttH, Experiment ids: 51
2024-05-02 23:35:18 INFO     ----------------------------------------------------------------------------
2024-05-02 23:35:18 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=50
2024-05-02 23:35:18 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 50, 'load_external': True, 'embedding_model': 'AttH', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 23:35:18 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 23:35:18 INFO     set_weight_link_or_dist: dist
2024-05-02 23:35:18 INFO     init_weight_inf_or_zero: inf
2024-05-02 23:35:18 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 23:35:18 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 23:35:18 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 23:35:18 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 23:35:21 INFO     Dataset created
2024-05-02 23:35:21 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-02 23:35:21 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-02 23:35:21 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-02 23:35:21 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-02 23:35:22 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 23:35:22 INFO     NormalScaler max: 0.42800777917098476
2024-05-02 23:35:25 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 23:35:25 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 23:35:25 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-02 23:35:25 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 23:35:25 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-02 23:35:25 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 23:35:25 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 23:35:25 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 23:35:25 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 23:35:25 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 23:35:25 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 23:35:25 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 23:35:25 INFO     Total parameter numbers: 874010
2024-05-02 23:35:25 INFO     You select `adam` optimizer.
2024-05-02 23:35:25 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 23:35:25 INFO     Start training ...
2024-05-02 23:35:25 INFO     num_batches:48
2024-05-02 23:35:32 INFO     epoch complete!
2024-05-02 23:35:32 INFO     evaluating now!
2024-05-02 23:35:33 INFO     Epoch [0/200] train_loss: 24.7574, val_loss: 18.6365, lr: 0.003000, 7.08s
2024-05-02 23:35:33 INFO     Saved model at 0
2024-05-02 23:35:33 INFO     Val loss decrease from inf to 18.6365, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 23:35:39 INFO     epoch complete!
2024-05-02 23:35:39 INFO     evaluating now!
2024-05-02 23:35:39 INFO     Epoch [1/200] train_loss: 15.5959, val_loss: 15.8521, lr: 0.003000, 6.42s
2024-05-02 23:35:39 INFO     Saved model at 1
2024-05-02 23:35:39 INFO     Val loss decrease from 18.6365 to 15.8521, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 23:35:45 INFO     epoch complete!
2024-05-02 23:35:45 INFO     evaluating now!
2024-05-02 23:35:46 INFO     Epoch [2/200] train_loss: 13.1429, val_loss: 13.0120, lr: 0.003000, 6.45s
2024-05-02 23:35:46 INFO     Saved model at 2
2024-05-02 23:35:46 INFO     Val loss decrease from 15.8521 to 13.0120, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 23:35:51 INFO     epoch complete!
2024-05-02 23:35:51 INFO     evaluating now!
2024-05-02 23:35:52 INFO     Epoch [3/200] train_loss: 11.0451, val_loss: 11.2657, lr: 0.003000, 6.31s
2024-05-02 23:35:52 INFO     Saved model at 3
2024-05-02 23:35:52 INFO     Val loss decrease from 13.0120 to 11.2657, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 23:35:58 INFO     epoch complete!
2024-05-02 23:35:58 INFO     evaluating now!
2024-05-02 23:35:59 INFO     Epoch [4/200] train_loss: 9.5816, val_loss: 9.5598, lr: 0.003000, 6.59s
2024-05-02 23:35:59 INFO     Saved model at 4
2024-05-02 23:35:59 INFO     Val loss decrease from 11.2657 to 9.5598, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 23:36:05 INFO     epoch complete!
2024-05-02 23:36:05 INFO     evaluating now!
2024-05-02 23:36:05 INFO     Epoch [5/200] train_loss: 8.4839, val_loss: 8.2118, lr: 0.003000, 6.61s
2024-05-02 23:36:05 INFO     Saved model at 5
2024-05-02 23:36:05 INFO     Val loss decrease from 9.5598 to 8.2118, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 23:36:11 INFO     epoch complete!
2024-05-02 23:36:11 INFO     evaluating now!
2024-05-02 23:36:12 INFO     Epoch [6/200] train_loss: 7.8364, val_loss: 7.7457, lr: 0.003000, 6.69s
2024-05-02 23:36:12 INFO     Saved model at 6
2024-05-02 23:36:12 INFO     Val loss decrease from 8.2118 to 7.7457, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 23:36:18 INFO     epoch complete!
2024-05-02 23:36:18 INFO     evaluating now!
2024-05-02 23:36:19 INFO     Epoch [7/200] train_loss: 7.2492, val_loss: 7.0003, lr: 0.003000, 6.74s
2024-05-02 23:36:19 INFO     Saved model at 7
2024-05-02 23:36:19 INFO     Val loss decrease from 7.7457 to 7.0003, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 23:36:25 INFO     epoch complete!
2024-05-02 23:36:25 INFO     evaluating now!
2024-05-02 23:36:25 INFO     Epoch [8/200] train_loss: 6.9746, val_loss: 6.7901, lr: 0.003000, 6.69s
2024-05-02 23:36:25 INFO     Saved model at 8
2024-05-02 23:36:25 INFO     Val loss decrease from 7.0003 to 6.7901, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 23:36:32 INFO     epoch complete!
2024-05-02 23:36:32 INFO     evaluating now!
2024-05-02 23:36:33 INFO     Epoch [9/200] train_loss: 6.5658, val_loss: 6.4891, lr: 0.003000, 7.34s
2024-05-02 23:36:33 INFO     Saved model at 9
2024-05-02 23:36:33 INFO     Val loss decrease from 6.7901 to 6.4891, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 23:36:39 INFO     epoch complete!
2024-05-02 23:36:39 INFO     evaluating now!
2024-05-02 23:36:40 INFO     Epoch [10/200] train_loss: 6.3475, val_loss: 6.9543, lr: 0.003000, 6.96s
2024-05-02 23:36:46 INFO     epoch complete!
2024-05-02 23:36:46 INFO     evaluating now!
2024-05-02 23:36:47 INFO     Epoch [11/200] train_loss: 6.2520, val_loss: 6.2539, lr: 0.003000, 6.97s
2024-05-02 23:36:47 INFO     Saved model at 11
2024-05-02 23:36:47 INFO     Val loss decrease from 6.4891 to 6.2539, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 23:36:54 INFO     epoch complete!
2024-05-02 23:36:54 INFO     evaluating now!
2024-05-02 23:36:54 INFO     Epoch [12/200] train_loss: 5.8827, val_loss: 5.9312, lr: 0.003000, 7.40s
2024-05-02 23:36:54 INFO     Saved model at 12
2024-05-02 23:36:54 INFO     Val loss decrease from 6.2539 to 5.9312, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 23:37:01 INFO     epoch complete!
2024-05-02 23:37:01 INFO     evaluating now!
2024-05-02 23:37:01 INFO     Epoch [13/200] train_loss: 5.7480, val_loss: 6.1046, lr: 0.003000, 6.94s
2024-05-02 23:37:08 INFO     epoch complete!
2024-05-02 23:37:08 INFO     evaluating now!
2024-05-02 23:37:08 INFO     Epoch [14/200] train_loss: 5.6390, val_loss: 5.8270, lr: 0.003000, 6.91s
2024-05-02 23:37:08 INFO     Saved model at 14
2024-05-02 23:37:08 INFO     Val loss decrease from 5.9312 to 5.8270, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-02 23:37:14 INFO     epoch complete!
2024-05-02 23:37:14 INFO     evaluating now!
2024-05-02 23:37:15 INFO     Epoch [15/200] train_loss: 5.6606, val_loss: 6.3501, lr: 0.003000, 6.65s
2024-05-02 23:37:21 INFO     epoch complete!
2024-05-02 23:37:21 INFO     evaluating now!
2024-05-02 23:37:21 INFO     Epoch [16/200] train_loss: 5.4771, val_loss: 5.7739, lr: 0.003000, 6.50s
2024-05-02 23:37:21 INFO     Saved model at 16
2024-05-02 23:37:21 INFO     Val loss decrease from 5.8270 to 5.7739, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-02 23:37:28 INFO     epoch complete!
2024-05-02 23:37:28 INFO     evaluating now!
2024-05-02 23:37:28 INFO     Epoch [17/200] train_loss: 5.3231, val_loss: 5.7766, lr: 0.003000, 6.63s
2024-05-02 23:37:34 INFO     epoch complete!
2024-05-02 23:37:34 INFO     evaluating now!
2024-05-02 23:37:35 INFO     Epoch [18/200] train_loss: 5.2315, val_loss: 5.9573, lr: 0.003000, 6.48s
2024-05-02 23:37:41 INFO     epoch complete!
2024-05-02 23:37:41 INFO     evaluating now!
2024-05-02 23:37:41 INFO     Epoch [19/200] train_loss: 5.1617, val_loss: 5.8142, lr: 0.003000, 6.79s
2024-05-02 23:37:48 INFO     epoch complete!
2024-05-02 23:37:48 INFO     evaluating now!
2024-05-02 23:37:48 INFO     Epoch [20/200] train_loss: 5.1319, val_loss: 5.6403, lr: 0.003000, 6.88s
2024-05-02 23:37:48 INFO     Saved model at 20
2024-05-02 23:37:48 INFO     Val loss decrease from 5.7739 to 5.6403, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-02 23:37:55 INFO     epoch complete!
2024-05-02 23:37:55 INFO     evaluating now!
2024-05-02 23:37:56 INFO     Epoch [21/200] train_loss: 5.1835, val_loss: 5.5806, lr: 0.003000, 7.25s
2024-05-02 23:37:56 INFO     Saved model at 21
2024-05-02 23:37:56 INFO     Val loss decrease from 5.6403 to 5.5806, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-02 23:38:02 INFO     epoch complete!
2024-05-02 23:38:02 INFO     evaluating now!
2024-05-02 23:38:03 INFO     Epoch [22/200] train_loss: 5.0483, val_loss: 5.7047, lr: 0.003000, 7.00s
2024-05-02 23:38:09 INFO     epoch complete!
2024-05-02 23:38:09 INFO     evaluating now!
2024-05-02 23:38:09 INFO     Epoch [23/200] train_loss: 4.9713, val_loss: 5.5193, lr: 0.003000, 6.89s
2024-05-02 23:38:09 INFO     Saved model at 23
2024-05-02 23:38:09 INFO     Val loss decrease from 5.5806 to 5.5193, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-05-02 23:38:16 INFO     epoch complete!
2024-05-02 23:38:16 INFO     evaluating now!
2024-05-02 23:38:17 INFO     Epoch [24/200] train_loss: 4.9318, val_loss: 5.3583, lr: 0.003000, 7.31s
2024-05-02 23:38:17 INFO     Saved model at 24
2024-05-02 23:38:17 INFO     Val loss decrease from 5.5193 to 5.3583, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-02 23:38:23 INFO     epoch complete!
2024-05-02 23:38:23 INFO     evaluating now!
2024-05-02 23:38:24 INFO     Epoch [25/200] train_loss: 4.9172, val_loss: 5.3102, lr: 0.003000, 7.04s
2024-05-02 23:38:24 INFO     Saved model at 25
2024-05-02 23:38:24 INFO     Val loss decrease from 5.3583 to 5.3102, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-02 23:38:30 INFO     epoch complete!
2024-05-02 23:38:30 INFO     evaluating now!
2024-05-02 23:38:31 INFO     Epoch [26/200] train_loss: 4.6891, val_loss: 5.4001, lr: 0.003000, 6.88s
2024-05-02 23:38:38 INFO     epoch complete!
2024-05-02 23:38:38 INFO     evaluating now!
2024-05-02 23:38:38 INFO     Epoch [27/200] train_loss: 4.6777, val_loss: 5.3574, lr: 0.003000, 7.31s
2024-05-02 23:38:45 INFO     epoch complete!
2024-05-02 23:38:45 INFO     evaluating now!
2024-05-02 23:38:45 INFO     Epoch [28/200] train_loss: 4.5855, val_loss: 5.1752, lr: 0.003000, 6.86s
2024-05-02 23:38:45 INFO     Saved model at 28
2024-05-02 23:38:45 INFO     Val loss decrease from 5.3102 to 5.1752, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-05-02 23:38:52 INFO     epoch complete!
2024-05-02 23:38:52 INFO     evaluating now!
2024-05-02 23:38:52 INFO     Epoch [29/200] train_loss: 4.5592, val_loss: 5.5057, lr: 0.003000, 6.92s
2024-05-02 23:38:59 INFO     epoch complete!
2024-05-02 23:38:59 INFO     evaluating now!
2024-05-02 23:38:59 INFO     Epoch [30/200] train_loss: 4.5877, val_loss: 5.2493, lr: 0.003000, 7.18s
2024-05-02 23:39:06 INFO     epoch complete!
2024-05-02 23:39:06 INFO     evaluating now!
2024-05-02 23:39:06 INFO     Epoch [31/200] train_loss: 4.5473, val_loss: 5.2372, lr: 0.003000, 7.14s
2024-05-02 23:39:13 INFO     epoch complete!
2024-05-02 23:39:13 INFO     evaluating now!
2024-05-02 23:39:13 INFO     Epoch [32/200] train_loss: 4.4508, val_loss: 5.1242, lr: 0.003000, 7.17s
2024-05-02 23:39:13 INFO     Saved model at 32
2024-05-02 23:39:13 INFO     Val loss decrease from 5.1752 to 5.1242, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-05-02 23:39:20 INFO     epoch complete!
2024-05-02 23:39:20 INFO     evaluating now!
2024-05-02 23:39:21 INFO     Epoch [33/200] train_loss: 4.4389, val_loss: 5.3151, lr: 0.003000, 7.04s
2024-05-02 23:39:27 INFO     epoch complete!
2024-05-02 23:39:27 INFO     evaluating now!
2024-05-02 23:39:27 INFO     Epoch [34/200] train_loss: 4.3075, val_loss: 5.2840, lr: 0.003000, 6.87s
2024-05-02 23:39:34 INFO     epoch complete!
2024-05-02 23:39:34 INFO     evaluating now!
2024-05-02 23:39:34 INFO     Epoch [35/200] train_loss: 4.2635, val_loss: 5.2213, lr: 0.003000, 6.89s
2024-05-02 23:39:41 INFO     epoch complete!
2024-05-02 23:39:41 INFO     evaluating now!
2024-05-02 23:39:41 INFO     Epoch [36/200] train_loss: 4.2402, val_loss: 5.1689, lr: 0.003000, 6.87s
2024-05-02 23:39:48 INFO     epoch complete!
2024-05-02 23:39:48 INFO     evaluating now!
2024-05-02 23:39:48 INFO     Epoch [37/200] train_loss: 4.2727, val_loss: 5.3801, lr: 0.003000, 6.86s
2024-05-02 23:39:54 INFO     epoch complete!
2024-05-02 23:39:54 INFO     evaluating now!
2024-05-02 23:39:55 INFO     Epoch [38/200] train_loss: 4.2248, val_loss: 5.2889, lr: 0.003000, 6.88s
2024-05-02 23:40:01 INFO     epoch complete!
2024-05-02 23:40:01 INFO     evaluating now!
2024-05-02 23:40:02 INFO     Epoch [39/200] train_loss: 4.2082, val_loss: 5.5235, lr: 0.003000, 6.98s
2024-05-02 23:40:08 INFO     epoch complete!
2024-05-02 23:40:08 INFO     evaluating now!
2024-05-02 23:40:09 INFO     Epoch [40/200] train_loss: 4.2622, val_loss: 5.2905, lr: 0.003000, 6.70s
2024-05-02 23:40:15 INFO     epoch complete!
2024-05-02 23:40:15 INFO     evaluating now!
2024-05-02 23:40:15 INFO     Epoch [41/200] train_loss: 4.2319, val_loss: 5.2118, lr: 0.003000, 6.62s
2024-05-02 23:40:22 INFO     epoch complete!
2024-05-02 23:40:22 INFO     evaluating now!
2024-05-02 23:40:22 INFO     Epoch [42/200] train_loss: 4.1396, val_loss: 5.2728, lr: 0.003000, 6.98s
2024-05-02 23:40:29 INFO     epoch complete!
2024-05-02 23:40:29 INFO     evaluating now!
2024-05-02 23:40:30 INFO     Epoch [43/200] train_loss: 4.1261, val_loss: 5.2702, lr: 0.003000, 7.37s
2024-05-02 23:40:36 INFO     epoch complete!
2024-05-02 23:40:36 INFO     evaluating now!
2024-05-02 23:40:37 INFO     Epoch [44/200] train_loss: 4.0485, val_loss: 5.1616, lr: 0.003000, 7.03s
2024-05-02 23:40:43 INFO     epoch complete!
2024-05-02 23:40:43 INFO     evaluating now!
2024-05-02 23:40:43 INFO     Epoch [45/200] train_loss: 4.0417, val_loss: 5.3924, lr: 0.003000, 6.59s
2024-05-02 23:40:49 INFO     epoch complete!
2024-05-02 23:40:49 INFO     evaluating now!
2024-05-02 23:40:50 INFO     Epoch [46/200] train_loss: 3.9777, val_loss: 5.3145, lr: 0.003000, 6.47s
2024-05-02 23:40:56 INFO     epoch complete!
2024-05-02 23:40:56 INFO     evaluating now!
2024-05-02 23:40:56 INFO     Epoch [47/200] train_loss: 4.0004, val_loss: 5.3570, lr: 0.003000, 6.34s
2024-05-02 23:40:56 WARNING  Early stopping at epoch: 47
2024-05-02 23:40:56 INFO     Trained totally 48 epochs, average train time is 6.424s, average eval time is 0.439s
2024-05-02 23:40:56 INFO     Loaded model at 32
2024-05-02 23:40:56 INFO     Saved model at ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 23:40:56 INFO     Start evaluating ...
2024-05-02 23:40:58 INFO     Note that you select the single mode to evaluate!
2024-05-02 23:40:58 INFO     Evaluate result is saved at ./libcity/cache/50/evaluate_cache/2024_05_02_23_40_58_AGCRN_CHITaxi20190406.csv
2024-05-02 23:40:58 INFO     
         MAE       RMSE
1   2.251569   7.758194
2   2.310696   7.953980
3   2.443239   8.703552
4   2.570621   9.399959
5   2.726018  10.097077
6   2.796728  10.702081
7   2.893185  11.252413
8   2.965203  11.747718
9   3.029379  12.151336
10  3.163871  12.576984
11  3.178536  13.026481
12  3.406787  13.844763
2024-05-02 23:40:58 INFO     ----------------------------------------------------------------------------
2024-05-02 23:40:58 INFO     # 2, Kownledge Graph Embedding: AttH, Experiment ids: 52
2024-05-02 23:40:58 INFO     ----------------------------------------------------------------------------
2024-05-02 23:40:58 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=50
2024-05-02 23:40:58 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 50, 'load_external': True, 'embedding_model': 'AttH', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 23:40:58 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 23:40:58 INFO     set_weight_link_or_dist: dist
2024-05-02 23:40:58 INFO     init_weight_inf_or_zero: inf
2024-05-02 23:40:58 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 23:40:58 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 23:40:58 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 23:40:58 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 23:41:01 INFO     Dataset created
2024-05-02 23:41:01 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-02 23:41:01 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-02 23:41:01 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-02 23:41:01 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-02 23:41:02 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 23:41:02 INFO     NormalScaler max: 0.42800777917098476
2024-05-02 23:41:06 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 23:41:06 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 23:41:06 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-02 23:41:06 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 23:41:06 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-02 23:41:06 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 23:41:06 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 23:41:06 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 23:41:06 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 23:41:06 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 23:41:06 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 23:41:06 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 23:41:06 INFO     Total parameter numbers: 874010
2024-05-02 23:41:06 INFO     You select `adam` optimizer.
2024-05-02 23:41:06 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 23:41:06 INFO     Start training ...
2024-05-02 23:41:06 INFO     num_batches:48
2024-05-02 23:41:12 INFO     epoch complete!
2024-05-02 23:41:12 INFO     evaluating now!
2024-05-02 23:41:12 INFO     Epoch [0/200] train_loss: 24.1745, val_loss: 18.8808, lr: 0.003000, 6.37s
2024-05-02 23:41:12 INFO     Saved model at 0
2024-05-02 23:41:12 INFO     Val loss decrease from inf to 18.8808, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 23:41:18 INFO     epoch complete!
2024-05-02 23:41:18 INFO     evaluating now!
2024-05-02 23:41:18 INFO     Epoch [1/200] train_loss: 15.4769, val_loss: 14.7604, lr: 0.003000, 6.49s
2024-05-02 23:41:19 INFO     Saved model at 1
2024-05-02 23:41:19 INFO     Val loss decrease from 18.8808 to 14.7604, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 23:41:25 INFO     epoch complete!
2024-05-02 23:41:25 INFO     evaluating now!
2024-05-02 23:41:25 INFO     Epoch [2/200] train_loss: 12.4595, val_loss: 12.2327, lr: 0.003000, 6.50s
2024-05-02 23:41:25 INFO     Saved model at 2
2024-05-02 23:41:25 INFO     Val loss decrease from 14.7604 to 12.2327, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 23:41:31 INFO     epoch complete!
2024-05-02 23:41:31 INFO     evaluating now!
2024-05-02 23:41:32 INFO     Epoch [3/200] train_loss: 10.2240, val_loss: 9.7395, lr: 0.003000, 6.56s
2024-05-02 23:41:32 INFO     Saved model at 3
2024-05-02 23:41:32 INFO     Val loss decrease from 12.2327 to 9.7395, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 23:41:38 INFO     epoch complete!
2024-05-02 23:41:38 INFO     evaluating now!
2024-05-02 23:41:38 INFO     Epoch [4/200] train_loss: 8.6347, val_loss: 8.2177, lr: 0.003000, 6.63s
2024-05-02 23:41:38 INFO     Saved model at 4
2024-05-02 23:41:38 INFO     Val loss decrease from 9.7395 to 8.2177, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 23:41:45 INFO     epoch complete!
2024-05-02 23:41:45 INFO     evaluating now!
2024-05-02 23:41:45 INFO     Epoch [5/200] train_loss: 7.7669, val_loss: 7.5727, lr: 0.003000, 7.07s
2024-05-02 23:41:45 INFO     Saved model at 5
2024-05-02 23:41:45 INFO     Val loss decrease from 8.2177 to 7.5727, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 23:41:52 INFO     epoch complete!
2024-05-02 23:41:52 INFO     evaluating now!
2024-05-02 23:41:52 INFO     Epoch [6/200] train_loss: 7.1697, val_loss: 7.0885, lr: 0.003000, 6.99s
2024-05-02 23:41:53 INFO     Saved model at 6
2024-05-02 23:41:53 INFO     Val loss decrease from 7.5727 to 7.0885, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 23:41:59 INFO     epoch complete!
2024-05-02 23:41:59 INFO     evaluating now!
2024-05-02 23:41:59 INFO     Epoch [7/200] train_loss: 6.8071, val_loss: 6.6902, lr: 0.003000, 6.45s
2024-05-02 23:41:59 INFO     Saved model at 7
2024-05-02 23:41:59 INFO     Val loss decrease from 7.0885 to 6.6902, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 23:42:05 INFO     epoch complete!
2024-05-02 23:42:05 INFO     evaluating now!
2024-05-02 23:42:06 INFO     Epoch [8/200] train_loss: 6.4585, val_loss: 6.6631, lr: 0.003000, 6.52s
2024-05-02 23:42:06 INFO     Saved model at 8
2024-05-02 23:42:06 INFO     Val loss decrease from 6.6902 to 6.6631, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 23:42:12 INFO     epoch complete!
2024-05-02 23:42:12 INFO     evaluating now!
2024-05-02 23:42:12 INFO     Epoch [9/200] train_loss: 6.1092, val_loss: 6.6464, lr: 0.003000, 6.46s
2024-05-02 23:42:12 INFO     Saved model at 9
2024-05-02 23:42:12 INFO     Val loss decrease from 6.6631 to 6.6464, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 23:42:18 INFO     epoch complete!
2024-05-02 23:42:18 INFO     evaluating now!
2024-05-02 23:42:19 INFO     Epoch [10/200] train_loss: 6.1320, val_loss: 6.0502, lr: 0.003000, 6.47s
2024-05-02 23:42:19 INFO     Saved model at 10
2024-05-02 23:42:19 INFO     Val loss decrease from 6.6464 to 6.0502, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 23:42:25 INFO     epoch complete!
2024-05-02 23:42:25 INFO     evaluating now!
2024-05-02 23:42:25 INFO     Epoch [11/200] train_loss: 5.7893, val_loss: 5.9866, lr: 0.003000, 6.47s
2024-05-02 23:42:25 INFO     Saved model at 11
2024-05-02 23:42:25 INFO     Val loss decrease from 6.0502 to 5.9866, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 23:42:31 INFO     epoch complete!
2024-05-02 23:42:31 INFO     evaluating now!
2024-05-02 23:42:32 INFO     Epoch [12/200] train_loss: 5.6226, val_loss: 6.0889, lr: 0.003000, 6.59s
2024-05-02 23:42:38 INFO     epoch complete!
2024-05-02 23:42:38 INFO     evaluating now!
2024-05-02 23:42:38 INFO     Epoch [13/200] train_loss: 5.5744, val_loss: 6.0013, lr: 0.003000, 6.51s
2024-05-02 23:42:44 INFO     epoch complete!
2024-05-02 23:42:44 INFO     evaluating now!
2024-05-02 23:42:45 INFO     Epoch [14/200] train_loss: 5.4551, val_loss: 5.7734, lr: 0.003000, 6.52s
2024-05-02 23:42:45 INFO     Saved model at 14
2024-05-02 23:42:45 INFO     Val loss decrease from 5.9866 to 5.7734, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-02 23:42:51 INFO     epoch complete!
2024-05-02 23:42:51 INFO     evaluating now!
2024-05-02 23:42:51 INFO     Epoch [15/200] train_loss: 5.3701, val_loss: 5.8039, lr: 0.003000, 6.38s
2024-05-02 23:42:57 INFO     epoch complete!
2024-05-02 23:42:57 INFO     evaluating now!
2024-05-02 23:42:58 INFO     Epoch [16/200] train_loss: 5.3130, val_loss: 5.7320, lr: 0.003000, 6.40s
2024-05-02 23:42:58 INFO     Saved model at 16
2024-05-02 23:42:58 INFO     Val loss decrease from 5.7734 to 5.7320, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-02 23:43:04 INFO     epoch complete!
2024-05-02 23:43:04 INFO     evaluating now!
2024-05-02 23:43:04 INFO     Epoch [17/200] train_loss: 5.1818, val_loss: 5.4484, lr: 0.003000, 6.52s
2024-05-02 23:43:04 INFO     Saved model at 17
2024-05-02 23:43:04 INFO     Val loss decrease from 5.7320 to 5.4484, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-02 23:43:10 INFO     epoch complete!
2024-05-02 23:43:10 INFO     evaluating now!
2024-05-02 23:43:11 INFO     Epoch [18/200] train_loss: 5.1526, val_loss: 5.7664, lr: 0.003000, 6.54s
2024-05-02 23:43:17 INFO     epoch complete!
2024-05-02 23:43:17 INFO     evaluating now!
2024-05-02 23:43:17 INFO     Epoch [19/200] train_loss: 5.0715, val_loss: 5.3997, lr: 0.003000, 6.47s
2024-05-02 23:43:17 INFO     Saved model at 19
2024-05-02 23:43:17 INFO     Val loss decrease from 5.4484 to 5.3997, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-02 23:43:24 INFO     epoch complete!
2024-05-02 23:43:24 INFO     evaluating now!
2024-05-02 23:43:24 INFO     Epoch [20/200] train_loss: 4.9200, val_loss: 5.2899, lr: 0.003000, 6.84s
2024-05-02 23:43:24 INFO     Saved model at 20
2024-05-02 23:43:24 INFO     Val loss decrease from 5.3997 to 5.2899, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-02 23:43:30 INFO     epoch complete!
2024-05-02 23:43:30 INFO     evaluating now!
2024-05-02 23:43:31 INFO     Epoch [21/200] train_loss: 4.9016, val_loss: 5.5838, lr: 0.003000, 6.57s
2024-05-02 23:43:37 INFO     epoch complete!
2024-05-02 23:43:37 INFO     evaluating now!
2024-05-02 23:43:37 INFO     Epoch [22/200] train_loss: 4.8634, val_loss: 5.3309, lr: 0.003000, 6.61s
2024-05-02 23:43:43 INFO     epoch complete!
2024-05-02 23:43:43 INFO     evaluating now!
2024-05-02 23:43:44 INFO     Epoch [23/200] train_loss: 4.7972, val_loss: 5.3326, lr: 0.003000, 6.55s
2024-05-02 23:43:50 INFO     epoch complete!
2024-05-02 23:43:50 INFO     evaluating now!
2024-05-02 23:43:50 INFO     Epoch [24/200] train_loss: 4.7332, val_loss: 5.8453, lr: 0.003000, 6.46s
2024-05-02 23:43:56 INFO     epoch complete!
2024-05-02 23:43:56 INFO     evaluating now!
2024-05-02 23:43:57 INFO     Epoch [25/200] train_loss: 4.6989, val_loss: 5.1232, lr: 0.003000, 6.54s
2024-05-02 23:43:57 INFO     Saved model at 25
2024-05-02 23:43:57 INFO     Val loss decrease from 5.2899 to 5.1232, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-02 23:44:03 INFO     epoch complete!
2024-05-02 23:44:03 INFO     evaluating now!
2024-05-02 23:44:03 INFO     Epoch [26/200] train_loss: 4.5970, val_loss: 5.2648, lr: 0.003000, 6.45s
2024-05-02 23:44:09 INFO     epoch complete!
2024-05-02 23:44:09 INFO     evaluating now!
2024-05-02 23:44:10 INFO     Epoch [27/200] train_loss: 4.6366, val_loss: 5.4050, lr: 0.003000, 6.44s
2024-05-02 23:44:16 INFO     epoch complete!
2024-05-02 23:44:16 INFO     evaluating now!
2024-05-02 23:44:16 INFO     Epoch [28/200] train_loss: 4.6319, val_loss: 5.2786, lr: 0.003000, 6.37s
2024-05-02 23:44:22 INFO     epoch complete!
2024-05-02 23:44:22 INFO     evaluating now!
2024-05-02 23:44:23 INFO     Epoch [29/200] train_loss: 4.5110, val_loss: 5.0789, lr: 0.003000, 6.57s
2024-05-02 23:44:23 INFO     Saved model at 29
2024-05-02 23:44:23 INFO     Val loss decrease from 5.1232 to 5.0789, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-05-02 23:44:29 INFO     epoch complete!
2024-05-02 23:44:29 INFO     evaluating now!
2024-05-02 23:44:29 INFO     Epoch [30/200] train_loss: 4.4456, val_loss: 5.1581, lr: 0.003000, 6.51s
2024-05-02 23:44:35 INFO     epoch complete!
2024-05-02 23:44:35 INFO     evaluating now!
2024-05-02 23:44:36 INFO     Epoch [31/200] train_loss: 4.4885, val_loss: 5.2574, lr: 0.003000, 6.52s
2024-05-02 23:44:42 INFO     epoch complete!
2024-05-02 23:44:42 INFO     evaluating now!
2024-05-02 23:44:42 INFO     Epoch [32/200] train_loss: 4.3659, val_loss: 5.1159, lr: 0.003000, 6.36s
2024-05-02 23:44:48 INFO     epoch complete!
2024-05-02 23:44:48 INFO     evaluating now!
2024-05-02 23:44:49 INFO     Epoch [33/200] train_loss: 4.2899, val_loss: 5.2583, lr: 0.003000, 6.35s
2024-05-02 23:44:54 INFO     epoch complete!
2024-05-02 23:44:54 INFO     evaluating now!
2024-05-02 23:44:55 INFO     Epoch [34/200] train_loss: 4.3404, val_loss: 5.1742, lr: 0.003000, 6.38s
2024-05-02 23:45:01 INFO     epoch complete!
2024-05-02 23:45:01 INFO     evaluating now!
2024-05-02 23:45:02 INFO     Epoch [35/200] train_loss: 4.3413, val_loss: 5.1228, lr: 0.003000, 6.65s
2024-05-02 23:45:08 INFO     epoch complete!
2024-05-02 23:45:08 INFO     evaluating now!
2024-05-02 23:45:08 INFO     Epoch [36/200] train_loss: 4.2118, val_loss: 5.1399, lr: 0.003000, 6.62s
2024-05-02 23:45:14 INFO     epoch complete!
2024-05-02 23:45:14 INFO     evaluating now!
2024-05-02 23:45:15 INFO     Epoch [37/200] train_loss: 4.3107, val_loss: 5.2047, lr: 0.003000, 6.50s
2024-05-02 23:45:21 INFO     epoch complete!
2024-05-02 23:45:21 INFO     evaluating now!
2024-05-02 23:45:22 INFO     Epoch [38/200] train_loss: 4.1879, val_loss: 5.2065, lr: 0.003000, 6.98s
2024-05-02 23:45:28 INFO     epoch complete!
2024-05-02 23:45:28 INFO     evaluating now!
2024-05-02 23:45:28 INFO     Epoch [39/200] train_loss: 4.1178, val_loss: 5.0564, lr: 0.003000, 6.83s
2024-05-02 23:45:29 INFO     Saved model at 39
2024-05-02 23:45:29 INFO     Val loss decrease from 5.0789 to 5.0564, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-05-02 23:45:35 INFO     epoch complete!
2024-05-02 23:45:35 INFO     evaluating now!
2024-05-02 23:45:35 INFO     Epoch [40/200] train_loss: 4.0628, val_loss: 5.3703, lr: 0.003000, 6.46s
2024-05-02 23:45:41 INFO     epoch complete!
2024-05-02 23:45:41 INFO     evaluating now!
2024-05-02 23:45:41 INFO     Epoch [41/200] train_loss: 4.1838, val_loss: 5.2290, lr: 0.003000, 6.42s
2024-05-02 23:45:47 INFO     epoch complete!
2024-05-02 23:45:47 INFO     evaluating now!
2024-05-02 23:45:48 INFO     Epoch [42/200] train_loss: 4.0440, val_loss: 4.9932, lr: 0.003000, 6.26s
2024-05-02 23:45:48 INFO     Saved model at 42
2024-05-02 23:45:48 INFO     Val loss decrease from 5.0564 to 4.9932, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-05-02 23:45:54 INFO     epoch complete!
2024-05-02 23:45:54 INFO     evaluating now!
2024-05-02 23:45:54 INFO     Epoch [43/200] train_loss: 4.0352, val_loss: 5.1666, lr: 0.003000, 6.65s
2024-05-02 23:46:01 INFO     epoch complete!
2024-05-02 23:46:01 INFO     evaluating now!
2024-05-02 23:46:01 INFO     Epoch [44/200] train_loss: 4.0096, val_loss: 5.3214, lr: 0.003000, 7.01s
2024-05-02 23:46:08 INFO     epoch complete!
2024-05-02 23:46:08 INFO     evaluating now!
2024-05-02 23:46:08 INFO     Epoch [45/200] train_loss: 4.0255, val_loss: 5.2041, lr: 0.003000, 7.03s
2024-05-02 23:46:15 INFO     epoch complete!
2024-05-02 23:46:15 INFO     evaluating now!
2024-05-02 23:46:15 INFO     Epoch [46/200] train_loss: 3.9432, val_loss: 4.8901, lr: 0.003000, 6.98s
2024-05-02 23:46:15 INFO     Saved model at 46
2024-05-02 23:46:15 INFO     Val loss decrease from 4.9932 to 4.8901, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-05-02 23:46:22 INFO     epoch complete!
2024-05-02 23:46:22 INFO     evaluating now!
2024-05-02 23:46:22 INFO     Epoch [47/200] train_loss: 3.9507, val_loss: 5.1283, lr: 0.003000, 7.04s
2024-05-02 23:46:29 INFO     epoch complete!
2024-05-02 23:46:29 INFO     evaluating now!
2024-05-02 23:46:29 INFO     Epoch [48/200] train_loss: 3.9126, val_loss: 4.9057, lr: 0.003000, 6.47s
2024-05-02 23:46:35 INFO     epoch complete!
2024-05-02 23:46:35 INFO     evaluating now!
2024-05-02 23:46:36 INFO     Epoch [49/200] train_loss: 3.8278, val_loss: 4.9252, lr: 0.003000, 6.71s
2024-05-02 23:46:42 INFO     epoch complete!
2024-05-02 23:46:42 INFO     evaluating now!
2024-05-02 23:46:43 INFO     Epoch [50/200] train_loss: 3.9250, val_loss: 5.0976, lr: 0.003000, 7.05s
2024-05-02 23:46:49 INFO     epoch complete!
2024-05-02 23:46:49 INFO     evaluating now!
2024-05-02 23:46:50 INFO     Epoch [51/200] train_loss: 3.7941, val_loss: 5.0233, lr: 0.003000, 7.13s
2024-05-02 23:46:57 INFO     epoch complete!
2024-05-02 23:46:57 INFO     evaluating now!
2024-05-02 23:46:57 INFO     Epoch [52/200] train_loss: 3.8561, val_loss: 5.0565, lr: 0.003000, 7.43s
2024-05-02 23:47:04 INFO     epoch complete!
2024-05-02 23:47:04 INFO     evaluating now!
2024-05-02 23:47:04 INFO     Epoch [53/200] train_loss: 3.9535, val_loss: 5.0316, lr: 0.003000, 7.17s
2024-05-02 23:47:11 INFO     epoch complete!
2024-05-02 23:47:11 INFO     evaluating now!
2024-05-02 23:47:12 INFO     Epoch [54/200] train_loss: 3.8494, val_loss: 5.1440, lr: 0.003000, 7.21s
2024-05-02 23:47:18 INFO     epoch complete!
2024-05-02 23:47:18 INFO     evaluating now!
2024-05-02 23:47:19 INFO     Epoch [55/200] train_loss: 3.7596, val_loss: 4.9285, lr: 0.003000, 6.86s
2024-05-02 23:47:25 INFO     epoch complete!
2024-05-02 23:47:25 INFO     evaluating now!
2024-05-02 23:47:25 INFO     Epoch [56/200] train_loss: 3.7104, val_loss: 5.0370, lr: 0.003000, 6.71s
2024-05-02 23:47:31 INFO     epoch complete!
2024-05-02 23:47:31 INFO     evaluating now!
2024-05-02 23:47:32 INFO     Epoch [57/200] train_loss: 3.7302, val_loss: 4.9373, lr: 0.003000, 6.70s
2024-05-02 23:47:38 INFO     epoch complete!
2024-05-02 23:47:38 INFO     evaluating now!
2024-05-02 23:47:39 INFO     Epoch [58/200] train_loss: 3.6943, val_loss: 5.0296, lr: 0.003000, 6.64s
2024-05-02 23:47:45 INFO     epoch complete!
2024-05-02 23:47:45 INFO     evaluating now!
2024-05-02 23:47:45 INFO     Epoch [59/200] train_loss: 3.7207, val_loss: 5.0056, lr: 0.003000, 6.68s
2024-05-02 23:47:51 INFO     epoch complete!
2024-05-02 23:47:51 INFO     evaluating now!
2024-05-02 23:47:52 INFO     Epoch [60/200] train_loss: 3.6805, val_loss: 4.9705, lr: 0.003000, 6.60s
2024-05-02 23:47:58 INFO     epoch complete!
2024-05-02 23:47:58 INFO     evaluating now!
2024-05-02 23:47:59 INFO     Epoch [61/200] train_loss: 3.6165, val_loss: 4.9105, lr: 0.003000, 6.72s
2024-05-02 23:47:59 WARNING  Early stopping at epoch: 61
2024-05-02 23:47:59 INFO     Trained totally 62 epochs, average train time is 6.206s, average eval time is 0.437s
2024-05-02 23:47:59 INFO     Loaded model at 46
2024-05-02 23:47:59 INFO     Saved model at ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 23:47:59 INFO     Start evaluating ...
2024-05-02 23:48:00 INFO     Note that you select the single mode to evaluate!
2024-05-02 23:48:00 INFO     Evaluate result is saved at ./libcity/cache/50/evaluate_cache/2024_05_02_23_48_00_AGCRN_CHITaxi20190406.csv
2024-05-02 23:48:00 INFO     
         MAE       RMSE
1   2.394950   7.067583
2   2.392736   7.685535
3   2.531457   8.669477
4   2.653306   9.352894
5   2.801041  10.173199
6   2.955037  11.201437
7   3.080895  12.219689
8   3.178817  13.009324
9   3.220606  13.302150
10  3.282191  13.442374
11  3.319442  13.636962
12  3.502402  14.202156
2024-05-02 23:48:00 INFO     ----------------------------------------------------------------------------
2024-05-02 23:48:00 INFO     # 3, Kownledge Graph Embedding: AttH, Experiment ids: 53
2024-05-02 23:48:00 INFO     ----------------------------------------------------------------------------
2024-05-02 23:48:00 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=50
2024-05-02 23:48:00 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 50, 'load_external': True, 'embedding_model': 'AttH', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 23:48:00 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 23:48:00 INFO     set_weight_link_or_dist: dist
2024-05-02 23:48:00 INFO     init_weight_inf_or_zero: inf
2024-05-02 23:48:00 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 23:48:00 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 23:48:00 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 23:48:01 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 23:48:04 INFO     Dataset created
2024-05-02 23:48:04 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-02 23:48:04 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-02 23:48:04 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-02 23:48:04 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-02 23:48:04 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 23:48:04 INFO     NormalScaler max: 0.42800777917098476
2024-05-02 23:48:08 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 23:48:08 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 23:48:08 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-02 23:48:08 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 23:48:08 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-02 23:48:08 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 23:48:08 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 23:48:08 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 23:48:08 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 23:48:08 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 23:48:08 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 23:48:08 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 23:48:08 INFO     Total parameter numbers: 874010
2024-05-02 23:48:08 INFO     You select `adam` optimizer.
2024-05-02 23:48:08 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 23:48:08 INFO     Start training ...
2024-05-02 23:48:08 INFO     num_batches:48
2024-05-02 23:48:14 INFO     epoch complete!
2024-05-02 23:48:14 INFO     evaluating now!
2024-05-02 23:48:14 INFO     Epoch [0/200] train_loss: 25.6582, val_loss: 18.6537, lr: 0.003000, 6.16s
2024-05-02 23:48:14 INFO     Saved model at 0
2024-05-02 23:48:14 INFO     Val loss decrease from inf to 18.6537, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 23:48:21 INFO     epoch complete!
2024-05-02 23:48:21 INFO     evaluating now!
2024-05-02 23:48:21 INFO     Epoch [1/200] train_loss: 15.5923, val_loss: 15.3221, lr: 0.003000, 6.65s
2024-05-02 23:48:21 INFO     Saved model at 1
2024-05-02 23:48:21 INFO     Val loss decrease from 18.6537 to 15.3221, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 23:48:27 INFO     epoch complete!
2024-05-02 23:48:27 INFO     evaluating now!
2024-05-02 23:48:28 INFO     Epoch [2/200] train_loss: 13.3594, val_loss: 13.4838, lr: 0.003000, 6.72s
2024-05-02 23:48:28 INFO     Saved model at 2
2024-05-02 23:48:28 INFO     Val loss decrease from 15.3221 to 13.4838, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 23:48:33 INFO     epoch complete!
2024-05-02 23:48:33 INFO     evaluating now!
2024-05-02 23:48:34 INFO     Epoch [3/200] train_loss: 11.3798, val_loss: 11.2011, lr: 0.003000, 6.04s
2024-05-02 23:48:34 INFO     Saved model at 3
2024-05-02 23:48:34 INFO     Val loss decrease from 13.4838 to 11.2011, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 23:48:39 INFO     epoch complete!
2024-05-02 23:48:39 INFO     evaluating now!
2024-05-02 23:48:40 INFO     Epoch [4/200] train_loss: 9.6881, val_loss: 9.6394, lr: 0.003000, 6.01s
2024-05-02 23:48:40 INFO     Saved model at 4
2024-05-02 23:48:40 INFO     Val loss decrease from 11.2011 to 9.6394, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 23:48:46 INFO     epoch complete!
2024-05-02 23:48:46 INFO     evaluating now!
2024-05-02 23:48:46 INFO     Epoch [5/200] train_loss: 8.9178, val_loss: 8.9004, lr: 0.003000, 6.02s
2024-05-02 23:48:46 INFO     Saved model at 5
2024-05-02 23:48:46 INFO     Val loss decrease from 9.6394 to 8.9004, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 23:48:52 INFO     epoch complete!
2024-05-02 23:48:52 INFO     evaluating now!
2024-05-02 23:48:52 INFO     Epoch [6/200] train_loss: 7.9208, val_loss: 7.7341, lr: 0.003000, 6.17s
2024-05-02 23:48:52 INFO     Saved model at 6
2024-05-02 23:48:52 INFO     Val loss decrease from 8.9004 to 7.7341, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 23:48:59 INFO     epoch complete!
2024-05-02 23:48:59 INFO     evaluating now!
2024-05-02 23:48:59 INFO     Epoch [7/200] train_loss: 7.3176, val_loss: 6.9869, lr: 0.003000, 6.97s
2024-05-02 23:48:59 INFO     Saved model at 7
2024-05-02 23:48:59 INFO     Val loss decrease from 7.7341 to 6.9869, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 23:49:06 INFO     epoch complete!
2024-05-02 23:49:06 INFO     evaluating now!
2024-05-02 23:49:07 INFO     Epoch [8/200] train_loss: 6.8243, val_loss: 6.8694, lr: 0.003000, 7.29s
2024-05-02 23:49:07 INFO     Saved model at 8
2024-05-02 23:49:07 INFO     Val loss decrease from 6.9869 to 6.8694, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 23:49:13 INFO     epoch complete!
2024-05-02 23:49:13 INFO     evaluating now!
2024-05-02 23:49:13 INFO     Epoch [9/200] train_loss: 6.5186, val_loss: 6.4971, lr: 0.003000, 6.61s
2024-05-02 23:49:13 INFO     Saved model at 9
2024-05-02 23:49:13 INFO     Val loss decrease from 6.8694 to 6.4971, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 23:49:19 INFO     epoch complete!
2024-05-02 23:49:19 INFO     evaluating now!
2024-05-02 23:49:20 INFO     Epoch [10/200] train_loss: 6.2419, val_loss: 6.2731, lr: 0.003000, 6.59s
2024-05-02 23:49:20 INFO     Saved model at 10
2024-05-02 23:49:20 INFO     Val loss decrease from 6.4971 to 6.2731, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 23:49:26 INFO     epoch complete!
2024-05-02 23:49:26 INFO     evaluating now!
2024-05-02 23:49:26 INFO     Epoch [11/200] train_loss: 5.9135, val_loss: 6.1972, lr: 0.003000, 6.58s
2024-05-02 23:49:26 INFO     Saved model at 11
2024-05-02 23:49:26 INFO     Val loss decrease from 6.2731 to 6.1972, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 23:49:33 INFO     epoch complete!
2024-05-02 23:49:33 INFO     evaluating now!
2024-05-02 23:49:33 INFO     Epoch [12/200] train_loss: 5.7793, val_loss: 6.1654, lr: 0.003000, 6.53s
2024-05-02 23:49:33 INFO     Saved model at 12
2024-05-02 23:49:33 INFO     Val loss decrease from 6.1972 to 6.1654, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 23:49:39 INFO     epoch complete!
2024-05-02 23:49:39 INFO     evaluating now!
2024-05-02 23:49:40 INFO     Epoch [13/200] train_loss: 5.6191, val_loss: 5.8977, lr: 0.003000, 6.63s
2024-05-02 23:49:40 INFO     Saved model at 13
2024-05-02 23:49:40 INFO     Val loss decrease from 6.1654 to 5.8977, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-02 23:49:46 INFO     epoch complete!
2024-05-02 23:49:46 INFO     evaluating now!
2024-05-02 23:49:46 INFO     Epoch [14/200] train_loss: 5.5982, val_loss: 5.9677, lr: 0.003000, 6.77s
2024-05-02 23:49:53 INFO     epoch complete!
2024-05-02 23:49:53 INFO     evaluating now!
2024-05-02 23:49:53 INFO     Epoch [15/200] train_loss: 5.4696, val_loss: 5.9279, lr: 0.003000, 6.66s
2024-05-02 23:50:00 INFO     epoch complete!
2024-05-02 23:50:00 INFO     evaluating now!
2024-05-02 23:50:00 INFO     Epoch [16/200] train_loss: 5.4347, val_loss: 5.9114, lr: 0.003000, 7.05s
2024-05-02 23:50:07 INFO     epoch complete!
2024-05-02 23:50:07 INFO     evaluating now!
2024-05-02 23:50:07 INFO     Epoch [17/200] train_loss: 5.3531, val_loss: 5.5831, lr: 0.003000, 7.25s
2024-05-02 23:50:08 INFO     Saved model at 17
2024-05-02 23:50:08 INFO     Val loss decrease from 5.8977 to 5.5831, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-02 23:50:14 INFO     epoch complete!
2024-05-02 23:50:14 INFO     evaluating now!
2024-05-02 23:50:15 INFO     Epoch [18/200] train_loss: 5.1517, val_loss: 5.5956, lr: 0.003000, 7.12s
2024-05-02 23:50:21 INFO     epoch complete!
2024-05-02 23:50:21 INFO     evaluating now!
2024-05-02 23:50:22 INFO     Epoch [19/200] train_loss: 5.1166, val_loss: 5.4614, lr: 0.003000, 7.21s
2024-05-02 23:50:22 INFO     Saved model at 19
2024-05-02 23:50:22 INFO     Val loss decrease from 5.5831 to 5.4614, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-02 23:50:28 INFO     epoch complete!
2024-05-02 23:50:28 INFO     evaluating now!
2024-05-02 23:50:29 INFO     Epoch [20/200] train_loss: 4.9721, val_loss: 5.4064, lr: 0.003000, 6.73s
2024-05-02 23:50:29 INFO     Saved model at 20
2024-05-02 23:50:29 INFO     Val loss decrease from 5.4614 to 5.4064, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-02 23:50:35 INFO     epoch complete!
2024-05-02 23:50:35 INFO     evaluating now!
2024-05-02 23:50:35 INFO     Epoch [21/200] train_loss: 4.9515, val_loss: 5.6352, lr: 0.003000, 6.50s
2024-05-02 23:50:41 INFO     epoch complete!
2024-05-02 23:50:41 INFO     evaluating now!
2024-05-02 23:50:42 INFO     Epoch [22/200] train_loss: 4.8607, val_loss: 5.4730, lr: 0.003000, 6.46s
2024-05-02 23:50:48 INFO     epoch complete!
2024-05-02 23:50:48 INFO     evaluating now!
2024-05-02 23:50:48 INFO     Epoch [23/200] train_loss: 4.7593, val_loss: 5.3980, lr: 0.003000, 6.60s
2024-05-02 23:50:48 INFO     Saved model at 23
2024-05-02 23:50:48 INFO     Val loss decrease from 5.4064 to 5.3980, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-05-02 23:50:55 INFO     epoch complete!
2024-05-02 23:50:55 INFO     evaluating now!
2024-05-02 23:50:55 INFO     Epoch [24/200] train_loss: 4.8030, val_loss: 5.3677, lr: 0.003000, 6.99s
2024-05-02 23:50:55 INFO     Saved model at 24
2024-05-02 23:50:55 INFO     Val loss decrease from 5.3980 to 5.3677, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-02 23:51:01 INFO     epoch complete!
2024-05-02 23:51:01 INFO     evaluating now!
2024-05-02 23:51:02 INFO     Epoch [25/200] train_loss: 4.6651, val_loss: 5.3008, lr: 0.003000, 6.43s
2024-05-02 23:51:02 INFO     Saved model at 25
2024-05-02 23:51:02 INFO     Val loss decrease from 5.3677 to 5.3008, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-02 23:51:08 INFO     epoch complete!
2024-05-02 23:51:08 INFO     evaluating now!
2024-05-02 23:51:08 INFO     Epoch [26/200] train_loss: 4.6173, val_loss: 5.2703, lr: 0.003000, 6.54s
2024-05-02 23:51:08 INFO     Saved model at 26
2024-05-02 23:51:08 INFO     Val loss decrease from 5.3008 to 5.2703, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-05-02 23:51:14 INFO     epoch complete!
2024-05-02 23:51:14 INFO     evaluating now!
2024-05-02 23:51:15 INFO     Epoch [27/200] train_loss: 4.6715, val_loss: 5.3021, lr: 0.003000, 6.55s
2024-05-02 23:51:21 INFO     epoch complete!
2024-05-02 23:51:21 INFO     evaluating now!
2024-05-02 23:51:21 INFO     Epoch [28/200] train_loss: 4.5629, val_loss: 5.4029, lr: 0.003000, 6.45s
2024-05-02 23:51:27 INFO     epoch complete!
2024-05-02 23:51:27 INFO     evaluating now!
2024-05-02 23:51:28 INFO     Epoch [29/200] train_loss: 4.6122, val_loss: 5.1668, lr: 0.003000, 6.17s
2024-05-02 23:51:28 INFO     Saved model at 29
2024-05-02 23:51:28 INFO     Val loss decrease from 5.2703 to 5.1668, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-05-02 23:51:34 INFO     epoch complete!
2024-05-02 23:51:34 INFO     evaluating now!
2024-05-02 23:51:34 INFO     Epoch [30/200] train_loss: 4.5145, val_loss: 5.2197, lr: 0.003000, 6.44s
2024-05-02 23:51:40 INFO     epoch complete!
2024-05-02 23:51:40 INFO     evaluating now!
2024-05-02 23:51:41 INFO     Epoch [31/200] train_loss: 4.4157, val_loss: 5.2537, lr: 0.003000, 6.64s
2024-05-02 23:51:47 INFO     epoch complete!
2024-05-02 23:51:47 INFO     evaluating now!
2024-05-02 23:51:47 INFO     Epoch [32/200] train_loss: 4.3864, val_loss: 5.4946, lr: 0.003000, 6.32s
2024-05-02 23:51:53 INFO     epoch complete!
2024-05-02 23:51:53 INFO     evaluating now!
2024-05-02 23:51:53 INFO     Epoch [33/200] train_loss: 4.4599, val_loss: 5.4009, lr: 0.003000, 6.33s
2024-05-02 23:51:59 INFO     epoch complete!
2024-05-02 23:51:59 INFO     evaluating now!
2024-05-02 23:52:00 INFO     Epoch [34/200] train_loss: 4.2984, val_loss: 5.1721, lr: 0.003000, 6.47s
2024-05-02 23:52:06 INFO     epoch complete!
2024-05-02 23:52:06 INFO     evaluating now!
2024-05-02 23:52:06 INFO     Epoch [35/200] train_loss: 4.2347, val_loss: 5.0923, lr: 0.003000, 6.60s
2024-05-02 23:52:06 INFO     Saved model at 35
2024-05-02 23:52:06 INFO     Val loss decrease from 5.1668 to 5.0923, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-05-02 23:52:12 INFO     epoch complete!
2024-05-02 23:52:12 INFO     evaluating now!
2024-05-02 23:52:13 INFO     Epoch [36/200] train_loss: 4.2743, val_loss: 5.1994, lr: 0.003000, 6.44s
2024-05-02 23:52:19 INFO     epoch complete!
2024-05-02 23:52:19 INFO     evaluating now!
2024-05-02 23:52:19 INFO     Epoch [37/200] train_loss: 4.1530, val_loss: 5.1093, lr: 0.003000, 6.41s
2024-05-02 23:52:25 INFO     epoch complete!
2024-05-02 23:52:25 INFO     evaluating now!
2024-05-02 23:52:26 INFO     Epoch [38/200] train_loss: 4.1389, val_loss: 5.1100, lr: 0.003000, 6.36s
2024-05-02 23:52:32 INFO     epoch complete!
2024-05-02 23:52:32 INFO     evaluating now!
2024-05-02 23:52:32 INFO     Epoch [39/200] train_loss: 4.0854, val_loss: 5.2133, lr: 0.003000, 6.35s
2024-05-02 23:52:38 INFO     epoch complete!
2024-05-02 23:52:38 INFO     evaluating now!
2024-05-02 23:52:38 INFO     Epoch [40/200] train_loss: 4.1314, val_loss: 5.2137, lr: 0.003000, 6.44s
2024-05-02 23:52:44 INFO     epoch complete!
2024-05-02 23:52:44 INFO     evaluating now!
2024-05-02 23:52:45 INFO     Epoch [41/200] train_loss: 4.1158, val_loss: 5.2098, lr: 0.003000, 6.41s
2024-05-02 23:52:51 INFO     epoch complete!
2024-05-02 23:52:51 INFO     evaluating now!
2024-05-02 23:52:51 INFO     Epoch [42/200] train_loss: 4.0196, val_loss: 5.1536, lr: 0.003000, 6.46s
2024-05-02 23:52:57 INFO     epoch complete!
2024-05-02 23:52:57 INFO     evaluating now!
2024-05-02 23:52:58 INFO     Epoch [43/200] train_loss: 4.0315, val_loss: 5.1173, lr: 0.003000, 6.26s
2024-05-02 23:53:04 INFO     epoch complete!
2024-05-02 23:53:04 INFO     evaluating now!
2024-05-02 23:53:04 INFO     Epoch [44/200] train_loss: 3.9803, val_loss: 5.3047, lr: 0.003000, 6.46s
2024-05-02 23:53:10 INFO     epoch complete!
2024-05-02 23:53:10 INFO     evaluating now!
2024-05-02 23:53:10 INFO     Epoch [45/200] train_loss: 3.9932, val_loss: 5.2152, lr: 0.003000, 6.32s
2024-05-02 23:53:16 INFO     epoch complete!
2024-05-02 23:53:16 INFO     evaluating now!
2024-05-02 23:53:17 INFO     Epoch [46/200] train_loss: 3.8781, val_loss: 5.1304, lr: 0.003000, 6.35s
2024-05-02 23:53:23 INFO     epoch complete!
2024-05-02 23:53:23 INFO     evaluating now!
2024-05-02 23:53:24 INFO     Epoch [47/200] train_loss: 3.8646, val_loss: 5.1530, lr: 0.003000, 7.10s
2024-05-02 23:53:30 INFO     epoch complete!
2024-05-02 23:53:30 INFO     evaluating now!
2024-05-02 23:53:30 INFO     Epoch [48/200] train_loss: 3.9150, val_loss: 5.0842, lr: 0.003000, 6.29s
2024-05-02 23:53:30 INFO     Saved model at 48
2024-05-02 23:53:30 INFO     Val loss decrease from 5.0923 to 5.0842, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-05-02 23:53:36 INFO     epoch complete!
2024-05-02 23:53:36 INFO     evaluating now!
2024-05-02 23:53:36 INFO     Epoch [49/200] train_loss: 3.8483, val_loss: 5.2785, lr: 0.003000, 6.39s
2024-05-02 23:53:43 INFO     epoch complete!
2024-05-02 23:53:43 INFO     evaluating now!
2024-05-02 23:53:43 INFO     Epoch [50/200] train_loss: 3.8016, val_loss: 5.0690, lr: 0.003000, 6.71s
2024-05-02 23:53:43 INFO     Saved model at 50
2024-05-02 23:53:43 INFO     Val loss decrease from 5.0842 to 5.0690, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch50.tar
2024-05-02 23:53:49 INFO     epoch complete!
2024-05-02 23:53:49 INFO     evaluating now!
2024-05-02 23:53:50 INFO     Epoch [51/200] train_loss: 3.8389, val_loss: 5.1293, lr: 0.003000, 6.48s
2024-05-02 23:53:56 INFO     epoch complete!
2024-05-02 23:53:56 INFO     evaluating now!
2024-05-02 23:53:56 INFO     Epoch [52/200] train_loss: 3.8216, val_loss: 5.1320, lr: 0.003000, 6.50s
2024-05-02 23:54:02 INFO     epoch complete!
2024-05-02 23:54:02 INFO     evaluating now!
2024-05-02 23:54:03 INFO     Epoch [53/200] train_loss: 3.7870, val_loss: 5.1502, lr: 0.003000, 6.57s
2024-05-02 23:54:09 INFO     epoch complete!
2024-05-02 23:54:09 INFO     evaluating now!
2024-05-02 23:54:09 INFO     Epoch [54/200] train_loss: 3.7491, val_loss: 5.0859, lr: 0.003000, 6.48s
2024-05-02 23:54:15 INFO     epoch complete!
2024-05-02 23:54:15 INFO     evaluating now!
2024-05-02 23:54:16 INFO     Epoch [55/200] train_loss: 3.6958, val_loss: 5.0142, lr: 0.003000, 6.49s
2024-05-02 23:54:16 INFO     Saved model at 55
2024-05-02 23:54:16 INFO     Val loss decrease from 5.0690 to 5.0142, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch55.tar
2024-05-02 23:54:22 INFO     epoch complete!
2024-05-02 23:54:22 INFO     evaluating now!
2024-05-02 23:54:22 INFO     Epoch [56/200] train_loss: 3.6751, val_loss: 5.1573, lr: 0.003000, 6.49s
2024-05-02 23:54:29 INFO     epoch complete!
2024-05-02 23:54:29 INFO     evaluating now!
2024-05-02 23:54:29 INFO     Epoch [57/200] train_loss: 3.6931, val_loss: 5.0276, lr: 0.003000, 7.00s
2024-05-02 23:54:36 INFO     epoch complete!
2024-05-02 23:54:36 INFO     evaluating now!
2024-05-02 23:54:36 INFO     Epoch [58/200] train_loss: 3.6180, val_loss: 5.1986, lr: 0.003000, 6.98s
2024-05-02 23:54:43 INFO     epoch complete!
2024-05-02 23:54:43 INFO     evaluating now!
2024-05-02 23:54:43 INFO     Epoch [59/200] train_loss: 3.7103, val_loss: 5.1086, lr: 0.003000, 6.93s
2024-05-02 23:54:50 INFO     epoch complete!
2024-05-02 23:54:50 INFO     evaluating now!
2024-05-02 23:54:50 INFO     Epoch [60/200] train_loss: 3.6457, val_loss: 5.0389, lr: 0.003000, 7.02s
2024-05-02 23:54:57 INFO     epoch complete!
2024-05-02 23:54:57 INFO     evaluating now!
2024-05-02 23:54:57 INFO     Epoch [61/200] train_loss: 3.6420, val_loss: 5.1109, lr: 0.003000, 6.99s
2024-05-02 23:55:04 INFO     epoch complete!
2024-05-02 23:55:04 INFO     evaluating now!
2024-05-02 23:55:04 INFO     Epoch [62/200] train_loss: 3.5937, val_loss: 5.1056, lr: 0.003000, 7.05s
2024-05-02 23:55:11 INFO     epoch complete!
2024-05-02 23:55:11 INFO     evaluating now!
2024-05-02 23:55:11 INFO     Epoch [63/200] train_loss: 3.6605, val_loss: 5.2147, lr: 0.003000, 6.92s
2024-05-02 23:55:18 INFO     epoch complete!
2024-05-02 23:55:18 INFO     evaluating now!
2024-05-02 23:55:18 INFO     Epoch [64/200] train_loss: 3.5909, val_loss: 5.1399, lr: 0.003000, 6.89s
2024-05-02 23:55:25 INFO     epoch complete!
2024-05-02 23:55:25 INFO     evaluating now!
2024-05-02 23:55:25 INFO     Epoch [65/200] train_loss: 3.5300, val_loss: 5.0330, lr: 0.003000, 7.05s
2024-05-02 23:55:32 INFO     epoch complete!
2024-05-02 23:55:32 INFO     evaluating now!
2024-05-02 23:55:32 INFO     Epoch [66/200] train_loss: 3.5295, val_loss: 5.1811, lr: 0.003000, 7.18s
2024-05-02 23:55:39 INFO     epoch complete!
2024-05-02 23:55:39 INFO     evaluating now!
2024-05-02 23:55:39 INFO     Epoch [67/200] train_loss: 3.4943, val_loss: 5.2123, lr: 0.003000, 6.86s
2024-05-02 23:55:46 INFO     epoch complete!
2024-05-02 23:55:46 INFO     evaluating now!
2024-05-02 23:55:46 INFO     Epoch [68/200] train_loss: 3.4507, val_loss: 5.1597, lr: 0.003000, 6.83s
2024-05-02 23:55:53 INFO     epoch complete!
2024-05-02 23:55:53 INFO     evaluating now!
2024-05-02 23:55:53 INFO     Epoch [69/200] train_loss: 3.4987, val_loss: 5.0556, lr: 0.003000, 6.93s
2024-05-02 23:55:59 INFO     epoch complete!
2024-05-02 23:55:59 INFO     evaluating now!
2024-05-02 23:56:00 INFO     Epoch [70/200] train_loss: 3.4964, val_loss: 5.1306, lr: 0.003000, 6.92s
2024-05-02 23:56:00 WARNING  Early stopping at epoch: 70
2024-05-02 23:56:00 INFO     Trained totally 71 epochs, average train time is 6.196s, average eval time is 0.431s
2024-05-02 23:56:00 INFO     Loaded model at 55
2024-05-02 23:56:00 INFO     Saved model at ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 23:56:00 INFO     Start evaluating ...
2024-05-02 23:56:02 INFO     Note that you select the single mode to evaluate!
2024-05-02 23:56:02 INFO     Evaluate result is saved at ./libcity/cache/50/evaluate_cache/2024_05_02_23_56_02_AGCRN_CHITaxi20190406.csv
2024-05-02 23:56:02 INFO     
         MAE       RMSE
1   2.468711   7.085841
2   2.589475   7.659398
3   2.738194   8.689429
4   2.915938   9.897090
5   3.074268  11.079777
6   3.204045  12.447952
7   3.331491  13.420081
8   3.347683  13.715083
9   3.437905  13.867110
10  3.364342  13.981192
11  3.495845  14.208430
12  3.520512  14.938713
2024-05-02 23:56:02 INFO     ----------------------------------------------------------------------------
2024-05-02 23:56:02 INFO     # 4, Kownledge Graph Embedding: AttH, Experiment ids: 54
2024-05-02 23:56:02 INFO     ----------------------------------------------------------------------------
2024-05-02 23:56:02 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=50
2024-05-02 23:56:02 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 50, 'load_external': True, 'embedding_model': 'AttH', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 23:56:02 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 23:56:02 INFO     set_weight_link_or_dist: dist
2024-05-02 23:56:02 INFO     init_weight_inf_or_zero: inf
2024-05-02 23:56:02 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 23:56:02 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 23:56:02 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 23:56:02 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 23:56:05 INFO     Dataset created
2024-05-02 23:56:05 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-02 23:56:05 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-02 23:56:05 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-02 23:56:05 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-02 23:56:05 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 23:56:06 INFO     NormalScaler max: 0.42800777917098476
2024-05-02 23:56:09 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 23:56:09 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 23:56:09 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-02 23:56:09 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 23:56:09 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-02 23:56:09 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 23:56:09 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 23:56:09 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 23:56:09 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 23:56:09 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 23:56:09 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 23:56:09 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 23:56:09 INFO     Total parameter numbers: 874010
2024-05-02 23:56:09 INFO     You select `adam` optimizer.
2024-05-02 23:56:09 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 23:56:09 INFO     Start training ...
2024-05-02 23:56:09 INFO     num_batches:48
2024-05-02 23:56:16 INFO     epoch complete!
2024-05-02 23:56:16 INFO     evaluating now!
2024-05-02 23:56:16 INFO     Epoch [0/200] train_loss: 23.0070, val_loss: 17.8758, lr: 0.003000, 6.83s
2024-05-02 23:56:16 INFO     Saved model at 0
2024-05-02 23:56:16 INFO     Val loss decrease from inf to 17.8758, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 23:56:23 INFO     epoch complete!
2024-05-02 23:56:23 INFO     evaluating now!
2024-05-02 23:56:23 INFO     Epoch [1/200] train_loss: 14.1774, val_loss: 13.2950, lr: 0.003000, 6.89s
2024-05-02 23:56:23 INFO     Saved model at 1
2024-05-02 23:56:23 INFO     Val loss decrease from 17.8758 to 13.2950, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 23:56:29 INFO     epoch complete!
2024-05-02 23:56:29 INFO     evaluating now!
2024-05-02 23:56:30 INFO     Epoch [2/200] train_loss: 11.0407, val_loss: 10.4518, lr: 0.003000, 6.86s
2024-05-02 23:56:30 INFO     Saved model at 2
2024-05-02 23:56:30 INFO     Val loss decrease from 13.2950 to 10.4518, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 23:56:37 INFO     epoch complete!
2024-05-02 23:56:37 INFO     evaluating now!
2024-05-02 23:56:37 INFO     Epoch [3/200] train_loss: 9.2711, val_loss: 8.6476, lr: 0.003000, 7.04s
2024-05-02 23:56:37 INFO     Saved model at 3
2024-05-02 23:56:37 INFO     Val loss decrease from 10.4518 to 8.6476, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 23:56:44 INFO     epoch complete!
2024-05-02 23:56:44 INFO     evaluating now!
2024-05-02 23:56:44 INFO     Epoch [4/200] train_loss: 8.1511, val_loss: 7.7562, lr: 0.003000, 7.06s
2024-05-02 23:56:44 INFO     Saved model at 4
2024-05-02 23:56:44 INFO     Val loss decrease from 8.6476 to 7.7562, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 23:56:51 INFO     epoch complete!
2024-05-02 23:56:51 INFO     evaluating now!
2024-05-02 23:56:51 INFO     Epoch [5/200] train_loss: 7.6179, val_loss: 7.3719, lr: 0.003000, 6.95s
2024-05-02 23:56:51 INFO     Saved model at 5
2024-05-02 23:56:51 INFO     Val loss decrease from 7.7562 to 7.3719, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 23:56:58 INFO     epoch complete!
2024-05-02 23:56:58 INFO     evaluating now!
2024-05-02 23:56:58 INFO     Epoch [6/200] train_loss: 7.0781, val_loss: 7.1230, lr: 0.003000, 7.22s
2024-05-02 23:56:58 INFO     Saved model at 6
2024-05-02 23:56:58 INFO     Val loss decrease from 7.3719 to 7.1230, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 23:57:05 INFO     epoch complete!
2024-05-02 23:57:05 INFO     evaluating now!
2024-05-02 23:57:06 INFO     Epoch [7/200] train_loss: 6.5697, val_loss: 6.5421, lr: 0.003000, 7.10s
2024-05-02 23:57:06 INFO     Saved model at 7
2024-05-02 23:57:06 INFO     Val loss decrease from 7.1230 to 6.5421, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 23:57:12 INFO     epoch complete!
2024-05-02 23:57:12 INFO     evaluating now!
2024-05-02 23:57:12 INFO     Epoch [8/200] train_loss: 6.3360, val_loss: 6.3341, lr: 0.003000, 6.93s
2024-05-02 23:57:13 INFO     Saved model at 8
2024-05-02 23:57:13 INFO     Val loss decrease from 6.5421 to 6.3341, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 23:57:19 INFO     epoch complete!
2024-05-02 23:57:19 INFO     evaluating now!
2024-05-02 23:57:19 INFO     Epoch [9/200] train_loss: 6.1652, val_loss: 6.2352, lr: 0.003000, 6.97s
2024-05-02 23:57:20 INFO     Saved model at 9
2024-05-02 23:57:20 INFO     Val loss decrease from 6.3341 to 6.2352, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 23:57:27 INFO     epoch complete!
2024-05-02 23:57:27 INFO     evaluating now!
2024-05-02 23:57:27 INFO     Epoch [10/200] train_loss: 5.8889, val_loss: 6.2001, lr: 0.003000, 7.55s
2024-05-02 23:57:27 INFO     Saved model at 10
2024-05-02 23:57:27 INFO     Val loss decrease from 6.2352 to 6.2001, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 23:57:34 INFO     epoch complete!
2024-05-02 23:57:34 INFO     evaluating now!
2024-05-02 23:57:35 INFO     Epoch [11/200] train_loss: 5.7760, val_loss: 6.1555, lr: 0.003000, 7.42s
2024-05-02 23:57:35 INFO     Saved model at 11
2024-05-02 23:57:35 INFO     Val loss decrease from 6.2001 to 6.1555, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 23:57:42 INFO     epoch complete!
2024-05-02 23:57:42 INFO     evaluating now!
2024-05-02 23:57:42 INFO     Epoch [12/200] train_loss: 5.6098, val_loss: 5.8543, lr: 0.003000, 7.47s
2024-05-02 23:57:42 INFO     Saved model at 12
2024-05-02 23:57:42 INFO     Val loss decrease from 6.1555 to 5.8543, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 23:57:49 INFO     epoch complete!
2024-05-02 23:57:49 INFO     evaluating now!
2024-05-02 23:57:50 INFO     Epoch [13/200] train_loss: 5.5475, val_loss: 5.6808, lr: 0.003000, 7.48s
2024-05-02 23:57:50 INFO     Saved model at 13
2024-05-02 23:57:50 INFO     Val loss decrease from 5.8543 to 5.6808, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-02 23:57:57 INFO     epoch complete!
2024-05-02 23:57:57 INFO     evaluating now!
2024-05-02 23:57:57 INFO     Epoch [14/200] train_loss: 5.2940, val_loss: 5.7214, lr: 0.003000, 7.64s
2024-05-02 23:58:04 INFO     epoch complete!
2024-05-02 23:58:04 INFO     evaluating now!
2024-05-02 23:58:04 INFO     Epoch [15/200] train_loss: 5.2353, val_loss: 5.5419, lr: 0.003000, 7.04s
2024-05-02 23:58:04 INFO     Saved model at 15
2024-05-02 23:58:04 INFO     Val loss decrease from 5.6808 to 5.5419, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-02 23:58:11 INFO     epoch complete!
2024-05-02 23:58:11 INFO     evaluating now!
2024-05-02 23:58:11 INFO     Epoch [16/200] train_loss: 5.1786, val_loss: 5.8598, lr: 0.003000, 6.99s
2024-05-02 23:58:18 INFO     epoch complete!
2024-05-02 23:58:18 INFO     evaluating now!
2024-05-02 23:58:18 INFO     Epoch [17/200] train_loss: 5.1309, val_loss: 5.3142, lr: 0.003000, 7.09s
2024-05-02 23:58:18 INFO     Saved model at 17
2024-05-02 23:58:18 INFO     Val loss decrease from 5.5419 to 5.3142, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-02 23:58:26 INFO     epoch complete!
2024-05-02 23:58:26 INFO     evaluating now!
2024-05-02 23:58:26 INFO     Epoch [18/200] train_loss: 5.0776, val_loss: 5.4053, lr: 0.003000, 7.64s
2024-05-02 23:58:33 INFO     epoch complete!
2024-05-02 23:58:33 INFO     evaluating now!
2024-05-02 23:58:34 INFO     Epoch [19/200] train_loss: 4.9310, val_loss: 5.2701, lr: 0.003000, 7.51s
2024-05-02 23:58:34 INFO     Saved model at 19
2024-05-02 23:58:34 INFO     Val loss decrease from 5.3142 to 5.2701, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-02 23:58:40 INFO     epoch complete!
2024-05-02 23:58:40 INFO     evaluating now!
2024-05-02 23:58:41 INFO     Epoch [20/200] train_loss: 4.8141, val_loss: 5.4008, lr: 0.003000, 6.92s
2024-05-02 23:58:47 INFO     epoch complete!
2024-05-02 23:58:47 INFO     evaluating now!
2024-05-02 23:58:47 INFO     Epoch [21/200] train_loss: 4.9759, val_loss: 5.4029, lr: 0.003000, 6.89s
2024-05-02 23:58:54 INFO     epoch complete!
2024-05-02 23:58:54 INFO     evaluating now!
2024-05-02 23:58:55 INFO     Epoch [22/200] train_loss: 4.7566, val_loss: 5.3458, lr: 0.003000, 7.04s
2024-05-02 23:59:01 INFO     epoch complete!
2024-05-02 23:59:01 INFO     evaluating now!
2024-05-02 23:59:02 INFO     Epoch [23/200] train_loss: 4.7809, val_loss: 5.2059, lr: 0.003000, 7.22s
2024-05-02 23:59:02 INFO     Saved model at 23
2024-05-02 23:59:02 INFO     Val loss decrease from 5.2701 to 5.2059, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-05-02 23:59:09 INFO     epoch complete!
2024-05-02 23:59:09 INFO     evaluating now!
2024-05-02 23:59:09 INFO     Epoch [24/200] train_loss: 4.6508, val_loss: 5.1320, lr: 0.003000, 7.15s
2024-05-02 23:59:09 INFO     Saved model at 24
2024-05-02 23:59:09 INFO     Val loss decrease from 5.2059 to 5.1320, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-02 23:59:16 INFO     epoch complete!
2024-05-02 23:59:16 INFO     evaluating now!
2024-05-02 23:59:16 INFO     Epoch [25/200] train_loss: 4.5957, val_loss: 5.3953, lr: 0.003000, 7.03s
2024-05-02 23:59:23 INFO     epoch complete!
2024-05-02 23:59:23 INFO     evaluating now!
2024-05-02 23:59:23 INFO     Epoch [26/200] train_loss: 4.6312, val_loss: 5.3590, lr: 0.003000, 6.94s
2024-05-02 23:59:29 INFO     epoch complete!
2024-05-02 23:59:29 INFO     evaluating now!
2024-05-02 23:59:30 INFO     Epoch [27/200] train_loss: 4.5282, val_loss: 5.1593, lr: 0.003000, 6.62s
2024-05-02 23:59:36 INFO     epoch complete!
2024-05-02 23:59:36 INFO     evaluating now!
2024-05-02 23:59:36 INFO     Epoch [28/200] train_loss: 4.4535, val_loss: 5.4820, lr: 0.003000, 6.49s
2024-05-02 23:59:43 INFO     epoch complete!
2024-05-02 23:59:43 INFO     evaluating now!
2024-05-02 23:59:43 INFO     Epoch [29/200] train_loss: 4.3835, val_loss: 5.1733, lr: 0.003000, 7.19s
2024-05-02 23:59:50 INFO     epoch complete!
2024-05-02 23:59:50 INFO     evaluating now!
2024-05-02 23:59:51 INFO     Epoch [30/200] train_loss: 4.3379, val_loss: 5.3085, lr: 0.003000, 7.41s
2024-05-02 23:59:57 INFO     epoch complete!
2024-05-02 23:59:57 INFO     evaluating now!
2024-05-02 23:59:58 INFO     Epoch [31/200] train_loss: 4.3994, val_loss: 5.1794, lr: 0.003000, 7.10s
2024-05-03 00:00:05 INFO     epoch complete!
2024-05-03 00:00:05 INFO     evaluating now!
2024-05-03 00:00:05 INFO     Epoch [32/200] train_loss: 4.3248, val_loss: 5.2283, lr: 0.003000, 7.36s
2024-05-03 00:00:13 INFO     epoch complete!
2024-05-03 00:00:13 INFO     evaluating now!
2024-05-03 00:00:13 INFO     Epoch [33/200] train_loss: 4.2792, val_loss: 5.5299, lr: 0.003000, 7.94s
2024-05-03 00:00:20 INFO     epoch complete!
2024-05-03 00:00:20 INFO     evaluating now!
2024-05-03 00:00:21 INFO     Epoch [34/200] train_loss: 4.3386, val_loss: 5.2153, lr: 0.003000, 7.57s
2024-05-03 00:00:28 INFO     epoch complete!
2024-05-03 00:00:28 INFO     evaluating now!
2024-05-03 00:00:28 INFO     Epoch [35/200] train_loss: 4.3180, val_loss: 5.2555, lr: 0.003000, 7.62s
2024-05-03 00:00:35 INFO     epoch complete!
2024-05-03 00:00:35 INFO     evaluating now!
2024-05-03 00:00:36 INFO     Epoch [36/200] train_loss: 4.2139, val_loss: 5.2333, lr: 0.003000, 7.71s
2024-05-03 00:00:43 INFO     epoch complete!
2024-05-03 00:00:43 INFO     evaluating now!
2024-05-03 00:00:44 INFO     Epoch [37/200] train_loss: 4.2465, val_loss: 5.1608, lr: 0.003000, 8.00s
2024-05-03 00:00:51 INFO     epoch complete!
2024-05-03 00:00:51 INFO     evaluating now!
2024-05-03 00:00:52 INFO     Epoch [38/200] train_loss: 4.0810, val_loss: 5.1817, lr: 0.003000, 8.04s
2024-05-03 00:00:59 INFO     epoch complete!
2024-05-03 00:00:59 INFO     evaluating now!
2024-05-03 00:01:00 INFO     Epoch [39/200] train_loss: 4.1455, val_loss: 5.2516, lr: 0.003000, 7.96s
2024-05-03 00:01:00 WARNING  Early stopping at epoch: 39
2024-05-03 00:01:00 INFO     Trained totally 40 epochs, average train time is 6.778s, average eval time is 0.467s
2024-05-03 00:01:00 INFO     Loaded model at 24
2024-05-03 00:01:00 INFO     Saved model at ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406.m
2024-05-03 00:01:00 INFO     Start evaluating ...
2024-05-03 00:01:02 INFO     Note that you select the single mode to evaluate!
2024-05-03 00:01:02 INFO     Evaluate result is saved at ./libcity/cache/50/evaluate_cache/2024_05_03_00_01_02_AGCRN_CHITaxi20190406.csv
2024-05-03 00:01:02 INFO     
         MAE       RMSE
1   2.421456   7.473939
2   2.404169   7.914371
3   2.611871   8.997113
4   2.791961   9.865567
5   2.884322  10.560659
6   3.105037  10.965706
7   3.069721  11.583517
8   3.110902  12.200075
9   3.161437  12.638595
10  3.241028  12.997487
11  3.309855  13.625484
12  3.549059  14.358801
2024-05-03 00:01:02 INFO     ----------------------------------------------------------------------------
2024-05-03 00:01:02 INFO     Kownledge Graph Embedding: AttH, Experiment ids: [50, 51, 52, 53, 54]
2024-05-03 00:01:02 INFO     ----------------------------------------------------------------------------
2024-05-03 00:01:02 INFO     Average: 
         MAE       RMSE
0   2.401355   7.291866
1   2.452675   7.792622
2   2.601402   8.757315
3   2.756118   9.575339
4   2.898205  10.400086
5   3.025229  11.229354
6   3.118153  12.047786
7   3.156705  12.613951
8   3.226394  12.956210
9   3.273955  13.200957
10  3.345786  13.557700
11  3.500773  14.198865 
2024-05-03 00:01:02 INFO     Standard deviation: 
         MAE      RMSE
0   0.080178  0.279617
1   0.107451  0.119923
2   0.105134  0.121356
3   0.126799  0.250542
4   0.127879  0.381414
5   0.139348  0.631363
6   0.147871  0.753907
7   0.123547  0.683709
8   0.134884  0.585861
9   0.068426  0.476552
10  0.108435  0.396881
11  0.049293  0.447152
2024-05-03 00:01:02 INFO     ----------------------------------------------------------------------------
2024-05-03 00:01:02 INFO     12 steps Average: 
        MAE       RMSE
0  2.979729  11.135171
2024-05-03 00:01:02 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.109937  0.427356
