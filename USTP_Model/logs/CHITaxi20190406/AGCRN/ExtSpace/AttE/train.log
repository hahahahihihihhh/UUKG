2024-09-01 16:58:24 INFO     Saving logs in: ./logs/CHITaxi20190406\AGCRN\ExtSpace\AttE
2024-09-01 16:58:24 INFO     ----------------------------------------------------------------------------
2024-09-01 16:58:24 INFO     # 0, Kownledge Graph Embedding: AttE, Experiment ids: 45
2024-09-01 16:58:24 INFO     ----------------------------------------------------------------------------
2024-09-01 16:58:24 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=45
2024-09-01 16:58:24 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 45, 'embedding_model': 'AttE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-01 16:58:24 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-01 16:58:24 INFO     set_weight_link_or_dist: dist
2024-09-01 16:58:24 INFO     init_weight_inf_or_zero: inf
2024-09-01 16:58:24 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-01 16:58:24 INFO     Start Calculate the weight by Gauss kernel!
2024-09-01 16:58:24 INFO     Loading file CHITaxi20190406.dyna
2024-09-01 16:58:24 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-01 16:58:26 INFO     Dataset created
2024-09-01 16:58:26 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-01 16:58:26 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-01 16:58:26 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-01 16:58:26 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-01 16:58:26 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-01 16:58:26 INFO     NormalScaler max: 1.4853242543142366
2024-09-01 16:58:29 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-01 16:58:29 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-01 16:58:29 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-01 16:58:29 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 16:58:29 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-01 16:58:29 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 16:58:29 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-01 16:58:29 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 16:58:29 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-01 16:58:29 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 16:58:29 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-01 16:58:29 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-01 16:58:29 INFO     Total parameter numbers: 874010
2024-09-01 16:58:29 INFO     You select `adam` optimizer.
2024-09-01 16:58:29 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-01 16:58:29 INFO     Start training ...
2024-09-01 16:58:29 INFO     num_batches:48
2024-09-01 16:58:36 INFO     epoch complete!
2024-09-01 16:58:36 INFO     evaluating now!
2024-09-01 16:58:36 INFO     Epoch [0/200] train_loss: 23.2042, val_loss: 17.7555, lr: 0.003000, 6.86s
2024-09-01 16:58:36 INFO     Saved model at 0
2024-09-01 16:58:36 INFO     Val loss decrease from inf to 17.7555, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-01 16:58:41 INFO     epoch complete!
2024-09-01 16:58:41 INFO     evaluating now!
2024-09-01 16:58:42 INFO     Epoch [1/200] train_loss: 14.2395, val_loss: 13.3898, lr: 0.003000, 5.30s
2024-09-01 16:58:42 INFO     Saved model at 1
2024-09-01 16:58:42 INFO     Val loss decrease from 17.7555 to 13.3898, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-01 16:58:47 INFO     epoch complete!
2024-09-01 16:58:47 INFO     evaluating now!
2024-09-01 16:58:47 INFO     Epoch [2/200] train_loss: 11.1402, val_loss: 10.4411, lr: 0.003000, 5.37s
2024-09-01 16:58:47 INFO     Saved model at 2
2024-09-01 16:58:47 INFO     Val loss decrease from 13.3898 to 10.4411, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-01 16:58:52 INFO     epoch complete!
2024-09-01 16:58:52 INFO     evaluating now!
2024-09-01 16:58:52 INFO     Epoch [3/200] train_loss: 9.2169, val_loss: 8.8109, lr: 0.003000, 5.32s
2024-09-01 16:58:52 INFO     Saved model at 3
2024-09-01 16:58:52 INFO     Val loss decrease from 10.4411 to 8.8109, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-01 16:58:57 INFO     epoch complete!
2024-09-01 16:58:57 INFO     evaluating now!
2024-09-01 16:58:58 INFO     Epoch [4/200] train_loss: 8.0471, val_loss: 7.8735, lr: 0.003000, 5.25s
2024-09-01 16:58:58 INFO     Saved model at 4
2024-09-01 16:58:58 INFO     Val loss decrease from 8.8109 to 7.8735, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-01 16:59:02 INFO     epoch complete!
2024-09-01 16:59:02 INFO     evaluating now!
2024-09-01 16:59:03 INFO     Epoch [5/200] train_loss: 7.3410, val_loss: 6.9696, lr: 0.003000, 5.23s
2024-09-01 16:59:03 INFO     Saved model at 5
2024-09-01 16:59:03 INFO     Val loss decrease from 7.8735 to 6.9696, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-01 16:59:08 INFO     epoch complete!
2024-09-01 16:59:08 INFO     evaluating now!
2024-09-01 16:59:08 INFO     Epoch [6/200] train_loss: 6.6636, val_loss: 6.9219, lr: 0.003000, 5.33s
2024-09-01 16:59:08 INFO     Saved model at 6
2024-09-01 16:59:08 INFO     Val loss decrease from 6.9696 to 6.9219, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-01 16:59:13 INFO     epoch complete!
2024-09-01 16:59:13 INFO     evaluating now!
2024-09-01 16:59:13 INFO     Epoch [7/200] train_loss: 6.3520, val_loss: 6.4154, lr: 0.003000, 5.33s
2024-09-01 16:59:13 INFO     Saved model at 7
2024-09-01 16:59:13 INFO     Val loss decrease from 6.9219 to 6.4154, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-01 16:59:18 INFO     epoch complete!
2024-09-01 16:59:18 INFO     evaluating now!
2024-09-01 16:59:19 INFO     Epoch [8/200] train_loss: 6.0780, val_loss: 6.0727, lr: 0.003000, 5.32s
2024-09-01 16:59:19 INFO     Saved model at 8
2024-09-01 16:59:19 INFO     Val loss decrease from 6.4154 to 6.0727, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-01 16:59:24 INFO     epoch complete!
2024-09-01 16:59:24 INFO     evaluating now!
2024-09-01 16:59:24 INFO     Epoch [9/200] train_loss: 5.8466, val_loss: 6.0592, lr: 0.003000, 5.32s
2024-09-01 16:59:24 INFO     Saved model at 9
2024-09-01 16:59:24 INFO     Val loss decrease from 6.0727 to 6.0592, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-01 16:59:29 INFO     epoch complete!
2024-09-01 16:59:29 INFO     evaluating now!
2024-09-01 16:59:29 INFO     Epoch [10/200] train_loss: 5.6803, val_loss: 5.9464, lr: 0.003000, 5.28s
2024-09-01 16:59:29 INFO     Saved model at 10
2024-09-01 16:59:29 INFO     Val loss decrease from 6.0592 to 5.9464, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-01 16:59:34 INFO     epoch complete!
2024-09-01 16:59:34 INFO     evaluating now!
2024-09-01 16:59:35 INFO     Epoch [11/200] train_loss: 5.5787, val_loss: 5.8308, lr: 0.003000, 5.21s
2024-09-01 16:59:35 INFO     Saved model at 11
2024-09-01 16:59:35 INFO     Val loss decrease from 5.9464 to 5.8308, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-01 16:59:40 INFO     epoch complete!
2024-09-01 16:59:40 INFO     evaluating now!
2024-09-01 16:59:40 INFO     Epoch [12/200] train_loss: 5.3651, val_loss: 5.7458, lr: 0.003000, 5.36s
2024-09-01 16:59:40 INFO     Saved model at 12
2024-09-01 16:59:40 INFO     Val loss decrease from 5.8308 to 5.7458, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-01 16:59:45 INFO     epoch complete!
2024-09-01 16:59:45 INFO     evaluating now!
2024-09-01 16:59:45 INFO     Epoch [13/200] train_loss: 5.3382, val_loss: 5.6169, lr: 0.003000, 5.33s
2024-09-01 16:59:45 INFO     Saved model at 13
2024-09-01 16:59:45 INFO     Val loss decrease from 5.7458 to 5.6169, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-01 16:59:50 INFO     epoch complete!
2024-09-01 16:59:50 INFO     evaluating now!
2024-09-01 16:59:51 INFO     Epoch [14/200] train_loss: 5.1730, val_loss: 5.4094, lr: 0.003000, 5.40s
2024-09-01 16:59:51 INFO     Saved model at 14
2024-09-01 16:59:51 INFO     Val loss decrease from 5.6169 to 5.4094, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-01 16:59:56 INFO     epoch complete!
2024-09-01 16:59:56 INFO     evaluating now!
2024-09-01 16:59:56 INFO     Epoch [15/200] train_loss: 5.0631, val_loss: 5.3228, lr: 0.003000, 5.27s
2024-09-01 16:59:56 INFO     Saved model at 15
2024-09-01 16:59:56 INFO     Val loss decrease from 5.4094 to 5.3228, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-01 17:00:01 INFO     epoch complete!
2024-09-01 17:00:01 INFO     evaluating now!
2024-09-01 17:00:01 INFO     Epoch [16/200] train_loss: 5.0992, val_loss: 5.4410, lr: 0.003000, 5.37s
2024-09-01 17:00:06 INFO     epoch complete!
2024-09-01 17:00:06 INFO     evaluating now!
2024-09-01 17:00:07 INFO     Epoch [17/200] train_loss: 4.9105, val_loss: 5.4064, lr: 0.003000, 5.26s
2024-09-01 17:00:12 INFO     epoch complete!
2024-09-01 17:00:12 INFO     evaluating now!
2024-09-01 17:00:12 INFO     Epoch [18/200] train_loss: 4.8258, val_loss: 5.3258, lr: 0.003000, 5.51s
2024-09-01 17:00:17 INFO     epoch complete!
2024-09-01 17:00:17 INFO     evaluating now!
2024-09-01 17:00:18 INFO     Epoch [19/200] train_loss: 4.7758, val_loss: 5.3712, lr: 0.003000, 5.42s
2024-09-01 17:00:23 INFO     epoch complete!
2024-09-01 17:00:23 INFO     evaluating now!
2024-09-01 17:00:23 INFO     Epoch [20/200] train_loss: 4.7212, val_loss: 5.4219, lr: 0.003000, 5.29s
2024-09-01 17:00:28 INFO     epoch complete!
2024-09-01 17:00:28 INFO     evaluating now!
2024-09-01 17:00:28 INFO     Epoch [21/200] train_loss: 4.6579, val_loss: 5.4848, lr: 0.003000, 5.40s
2024-09-01 17:00:33 INFO     epoch complete!
2024-09-01 17:00:33 INFO     evaluating now!
2024-09-01 17:00:34 INFO     Epoch [22/200] train_loss: 4.6522, val_loss: 5.2635, lr: 0.003000, 5.47s
2024-09-01 17:00:34 INFO     Saved model at 22
2024-09-01 17:00:34 INFO     Val loss decrease from 5.3228 to 5.2635, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-01 17:00:39 INFO     epoch complete!
2024-09-01 17:00:39 INFO     evaluating now!
2024-09-01 17:00:39 INFO     Epoch [23/200] train_loss: 4.6156, val_loss: 5.3162, lr: 0.003000, 5.37s
2024-09-01 17:00:44 INFO     epoch complete!
2024-09-01 17:00:44 INFO     evaluating now!
2024-09-01 17:00:45 INFO     Epoch [24/200] train_loss: 4.5962, val_loss: 5.5969, lr: 0.003000, 5.33s
2024-09-01 17:00:49 INFO     epoch complete!
2024-09-01 17:00:49 INFO     evaluating now!
2024-09-01 17:00:50 INFO     Epoch [25/200] train_loss: 4.5521, val_loss: 5.3408, lr: 0.003000, 5.24s
2024-09-01 17:00:55 INFO     epoch complete!
2024-09-01 17:00:55 INFO     evaluating now!
2024-09-01 17:00:55 INFO     Epoch [26/200] train_loss: 4.4708, val_loss: 5.1269, lr: 0.003000, 5.34s
2024-09-01 17:00:55 INFO     Saved model at 26
2024-09-01 17:00:55 INFO     Val loss decrease from 5.2635 to 5.1269, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-01 17:01:00 INFO     epoch complete!
2024-09-01 17:01:00 INFO     evaluating now!
2024-09-01 17:01:00 INFO     Epoch [27/200] train_loss: 4.4089, val_loss: 5.5028, lr: 0.003000, 5.28s
2024-09-01 17:01:05 INFO     epoch complete!
2024-09-01 17:01:05 INFO     evaluating now!
2024-09-01 17:01:06 INFO     Epoch [28/200] train_loss: 4.3918, val_loss: 5.3651, lr: 0.003000, 5.22s
2024-09-01 17:01:11 INFO     epoch complete!
2024-09-01 17:01:11 INFO     evaluating now!
2024-09-01 17:01:11 INFO     Epoch [29/200] train_loss: 4.3444, val_loss: 5.0671, lr: 0.003000, 5.29s
2024-09-01 17:01:11 INFO     Saved model at 29
2024-09-01 17:01:11 INFO     Val loss decrease from 5.1269 to 5.0671, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-01 17:01:16 INFO     epoch complete!
2024-09-01 17:01:16 INFO     evaluating now!
2024-09-01 17:01:16 INFO     Epoch [30/200] train_loss: 4.3399, val_loss: 5.1433, lr: 0.003000, 5.25s
2024-09-01 17:01:21 INFO     epoch complete!
2024-09-01 17:01:21 INFO     evaluating now!
2024-09-01 17:01:21 INFO     Epoch [31/200] train_loss: 4.2660, val_loss: 5.2049, lr: 0.003000, 5.22s
2024-09-01 17:01:26 INFO     epoch complete!
2024-09-01 17:01:26 INFO     evaluating now!
2024-09-01 17:01:27 INFO     Epoch [32/200] train_loss: 4.2361, val_loss: 4.9775, lr: 0.003000, 5.31s
2024-09-01 17:01:27 INFO     Saved model at 32
2024-09-01 17:01:27 INFO     Val loss decrease from 5.0671 to 4.9775, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-09-01 17:01:32 INFO     epoch complete!
2024-09-01 17:01:32 INFO     evaluating now!
2024-09-01 17:01:32 INFO     Epoch [33/200] train_loss: 4.1636, val_loss: 5.2774, lr: 0.003000, 5.26s
2024-09-01 17:01:37 INFO     epoch complete!
2024-09-01 17:01:37 INFO     evaluating now!
2024-09-01 17:01:37 INFO     Epoch [34/200] train_loss: 4.1857, val_loss: 5.2893, lr: 0.003000, 5.26s
2024-09-01 17:01:42 INFO     epoch complete!
2024-09-01 17:01:42 INFO     evaluating now!
2024-09-01 17:01:42 INFO     Epoch [35/200] train_loss: 4.0993, val_loss: 5.0947, lr: 0.003000, 5.27s
2024-09-01 17:01:47 INFO     epoch complete!
2024-09-01 17:01:47 INFO     evaluating now!
2024-09-01 17:01:48 INFO     Epoch [36/200] train_loss: 4.1336, val_loss: 5.1052, lr: 0.003000, 5.28s
2024-09-01 17:01:53 INFO     epoch complete!
2024-09-01 17:01:53 INFO     evaluating now!
2024-09-01 17:01:53 INFO     Epoch [37/200] train_loss: 4.1672, val_loss: 5.2694, lr: 0.003000, 5.57s
2024-09-01 17:01:58 INFO     epoch complete!
2024-09-01 17:01:58 INFO     evaluating now!
2024-09-01 17:01:59 INFO     Epoch [38/200] train_loss: 4.0536, val_loss: 5.1926, lr: 0.003000, 5.25s
2024-09-01 17:02:03 INFO     epoch complete!
2024-09-01 17:02:03 INFO     evaluating now!
2024-09-01 17:02:04 INFO     Epoch [39/200] train_loss: 4.0427, val_loss: 5.1865, lr: 0.003000, 5.22s
2024-09-01 17:02:09 INFO     epoch complete!
2024-09-01 17:02:09 INFO     evaluating now!
2024-09-01 17:02:09 INFO     Epoch [40/200] train_loss: 3.9944, val_loss: 5.2738, lr: 0.003000, 5.22s
2024-09-01 17:02:14 INFO     epoch complete!
2024-09-01 17:02:14 INFO     evaluating now!
2024-09-01 17:02:14 INFO     Epoch [41/200] train_loss: 3.9672, val_loss: 5.1054, lr: 0.003000, 5.25s
2024-09-01 17:02:19 INFO     epoch complete!
2024-09-01 17:02:19 INFO     evaluating now!
2024-09-01 17:02:20 INFO     Epoch [42/200] train_loss: 3.9166, val_loss: 5.0913, lr: 0.003000, 5.38s
2024-09-01 17:02:25 INFO     epoch complete!
2024-09-01 17:02:25 INFO     evaluating now!
2024-09-01 17:02:25 INFO     Epoch [43/200] train_loss: 3.9194, val_loss: 5.1495, lr: 0.003000, 5.22s
2024-09-01 17:02:30 INFO     epoch complete!
2024-09-01 17:02:30 INFO     evaluating now!
2024-09-01 17:02:30 INFO     Epoch [44/200] train_loss: 3.8905, val_loss: 5.0990, lr: 0.003000, 5.20s
2024-09-01 17:02:35 INFO     epoch complete!
2024-09-01 17:02:35 INFO     evaluating now!
2024-09-01 17:02:35 INFO     Epoch [45/200] train_loss: 3.8830, val_loss: 5.1698, lr: 0.003000, 5.34s
2024-09-01 17:02:41 INFO     epoch complete!
2024-09-01 17:02:41 INFO     evaluating now!
2024-09-01 17:02:41 INFO     Epoch [46/200] train_loss: 3.8545, val_loss: 5.2777, lr: 0.003000, 5.45s
2024-09-01 17:02:46 INFO     epoch complete!
2024-09-01 17:02:46 INFO     evaluating now!
2024-09-01 17:02:46 INFO     Epoch [47/200] train_loss: 3.9331, val_loss: 5.0671, lr: 0.003000, 5.22s
2024-09-01 17:02:46 WARNING  Early stopping at epoch: 47
2024-09-01 17:02:46 INFO     Trained totally 48 epochs, average train time is 5.009s, average eval time is 0.333s
2024-09-01 17:02:46 INFO     Loaded model at 32
2024-09-01 17:02:46 INFO     Saved model at ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406.m
2024-09-01 17:02:46 INFO     Start evaluating ...
2024-09-01 17:02:47 INFO     Note that you select the single mode to evaluate!
2024-09-01 17:02:47 INFO     Evaluate result is saved at ./libcity/cache/45/evaluate_cache\2024_09_01_17_02_47_AGCRN_CHITaxi20190406.csv
2024-09-01 17:02:47 INFO     
         MAE       RMSE
1   2.362025   6.960770
2   2.484193   7.691751
3   2.654610   8.764364
4   2.697235   9.239516
5   2.794986   9.739398
6   2.932673  10.280491
7   2.961855  10.806958
8   3.085230  11.257174
9   3.233123  11.694485
10  3.217677  12.017225
11  3.224286  12.309388
12  3.298586  12.960059
2024-09-01 17:02:47 INFO     ----------------------------------------------------------------------------
2024-09-01 17:02:47 INFO     # 1, Kownledge Graph Embedding: AttE, Experiment ids: 46
2024-09-01 17:02:47 INFO     ----------------------------------------------------------------------------
2024-09-01 17:02:47 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=45
2024-09-01 17:02:47 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 45, 'embedding_model': 'AttE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-01 17:02:47 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-01 17:02:47 INFO     set_weight_link_or_dist: dist
2024-09-01 17:02:47 INFO     init_weight_inf_or_zero: inf
2024-09-01 17:02:47 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-01 17:02:47 INFO     Start Calculate the weight by Gauss kernel!
2024-09-01 17:02:47 INFO     Loading file CHITaxi20190406.dyna
2024-09-01 17:02:47 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-01 17:02:49 INFO     Dataset created
2024-09-01 17:02:49 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-01 17:02:49 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-01 17:02:49 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-01 17:02:49 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-01 17:02:49 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-01 17:02:50 INFO     NormalScaler max: 1.4853242543142366
2024-09-01 17:02:52 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-01 17:02:52 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-01 17:02:52 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-01 17:02:52 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 17:02:52 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-01 17:02:52 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 17:02:52 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-01 17:02:52 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 17:02:52 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-01 17:02:52 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 17:02:52 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-01 17:02:52 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-01 17:02:52 INFO     Total parameter numbers: 874010
2024-09-01 17:02:52 INFO     You select `adam` optimizer.
2024-09-01 17:02:52 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-01 17:02:52 INFO     Start training ...
2024-09-01 17:02:52 INFO     num_batches:48
2024-09-01 17:02:57 INFO     epoch complete!
2024-09-01 17:02:57 INFO     evaluating now!
2024-09-01 17:02:57 INFO     Epoch [0/200] train_loss: 24.5570, val_loss: 18.2974, lr: 0.003000, 5.44s
2024-09-01 17:02:57 INFO     Saved model at 0
2024-09-01 17:02:57 INFO     Val loss decrease from inf to 18.2974, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-01 17:03:02 INFO     epoch complete!
2024-09-01 17:03:02 INFO     evaluating now!
2024-09-01 17:03:02 INFO     Epoch [1/200] train_loss: 15.3563, val_loss: 15.1598, lr: 0.003000, 5.17s
2024-09-01 17:03:02 INFO     Saved model at 1
2024-09-01 17:03:02 INFO     Val loss decrease from 18.2974 to 15.1598, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-01 17:03:07 INFO     epoch complete!
2024-09-01 17:03:07 INFO     evaluating now!
2024-09-01 17:03:07 INFO     Epoch [2/200] train_loss: 12.6256, val_loss: 12.1092, lr: 0.003000, 5.15s
2024-09-01 17:03:07 INFO     Saved model at 2
2024-09-01 17:03:07 INFO     Val loss decrease from 15.1598 to 12.1092, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-01 17:03:12 INFO     epoch complete!
2024-09-01 17:03:12 INFO     evaluating now!
2024-09-01 17:03:13 INFO     Epoch [3/200] train_loss: 10.3940, val_loss: 10.5073, lr: 0.003000, 5.13s
2024-09-01 17:03:13 INFO     Saved model at 3
2024-09-01 17:03:13 INFO     Val loss decrease from 12.1092 to 10.5073, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-01 17:03:17 INFO     epoch complete!
2024-09-01 17:03:17 INFO     evaluating now!
2024-09-01 17:03:18 INFO     Epoch [4/200] train_loss: 8.9447, val_loss: 8.5378, lr: 0.003000, 5.16s
2024-09-01 17:03:18 INFO     Saved model at 4
2024-09-01 17:03:18 INFO     Val loss decrease from 10.5073 to 8.5378, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-01 17:03:23 INFO     epoch complete!
2024-09-01 17:03:23 INFO     evaluating now!
2024-09-01 17:03:23 INFO     Epoch [5/200] train_loss: 8.0448, val_loss: 8.0313, lr: 0.003000, 5.20s
2024-09-01 17:03:23 INFO     Saved model at 5
2024-09-01 17:03:23 INFO     Val loss decrease from 8.5378 to 8.0313, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-01 17:03:28 INFO     epoch complete!
2024-09-01 17:03:28 INFO     evaluating now!
2024-09-01 17:03:28 INFO     Epoch [6/200] train_loss: 7.3673, val_loss: 7.3119, lr: 0.003000, 5.13s
2024-09-01 17:03:28 INFO     Saved model at 6
2024-09-01 17:03:28 INFO     Val loss decrease from 8.0313 to 7.3119, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-01 17:03:33 INFO     epoch complete!
2024-09-01 17:03:33 INFO     evaluating now!
2024-09-01 17:03:33 INFO     Epoch [7/200] train_loss: 6.7960, val_loss: 6.7010, lr: 0.003000, 5.23s
2024-09-01 17:03:33 INFO     Saved model at 7
2024-09-01 17:03:33 INFO     Val loss decrease from 7.3119 to 6.7010, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-01 17:03:38 INFO     epoch complete!
2024-09-01 17:03:38 INFO     evaluating now!
2024-09-01 17:03:39 INFO     Epoch [8/200] train_loss: 6.4511, val_loss: 6.5388, lr: 0.003000, 5.20s
2024-09-01 17:03:39 INFO     Saved model at 8
2024-09-01 17:03:39 INFO     Val loss decrease from 6.7010 to 6.5388, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-01 17:03:43 INFO     epoch complete!
2024-09-01 17:03:43 INFO     evaluating now!
2024-09-01 17:03:44 INFO     Epoch [9/200] train_loss: 6.1515, val_loss: 6.1860, lr: 0.003000, 5.16s
2024-09-01 17:03:44 INFO     Saved model at 9
2024-09-01 17:03:44 INFO     Val loss decrease from 6.5388 to 6.1860, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-01 17:03:49 INFO     epoch complete!
2024-09-01 17:03:49 INFO     evaluating now!
2024-09-01 17:03:49 INFO     Epoch [10/200] train_loss: 5.9007, val_loss: 6.0022, lr: 0.003000, 5.14s
2024-09-01 17:03:49 INFO     Saved model at 10
2024-09-01 17:03:49 INFO     Val loss decrease from 6.1860 to 6.0022, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-01 17:03:54 INFO     epoch complete!
2024-09-01 17:03:54 INFO     evaluating now!
2024-09-01 17:03:54 INFO     Epoch [11/200] train_loss: 5.7646, val_loss: 5.9910, lr: 0.003000, 5.12s
2024-09-01 17:03:54 INFO     Saved model at 11
2024-09-01 17:03:54 INFO     Val loss decrease from 6.0022 to 5.9910, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-01 17:03:59 INFO     epoch complete!
2024-09-01 17:03:59 INFO     evaluating now!
2024-09-01 17:03:59 INFO     Epoch [12/200] train_loss: 5.6324, val_loss: 5.9534, lr: 0.003000, 5.12s
2024-09-01 17:03:59 INFO     Saved model at 12
2024-09-01 17:03:59 INFO     Val loss decrease from 5.9910 to 5.9534, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-01 17:04:04 INFO     epoch complete!
2024-09-01 17:04:04 INFO     evaluating now!
2024-09-01 17:04:04 INFO     Epoch [13/200] train_loss: 5.4775, val_loss: 5.7806, lr: 0.003000, 5.24s
2024-09-01 17:04:04 INFO     Saved model at 13
2024-09-01 17:04:04 INFO     Val loss decrease from 5.9534 to 5.7806, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-01 17:04:09 INFO     epoch complete!
2024-09-01 17:04:09 INFO     evaluating now!
2024-09-01 17:04:10 INFO     Epoch [14/200] train_loss: 5.3917, val_loss: 5.7375, lr: 0.003000, 5.20s
2024-09-01 17:04:10 INFO     Saved model at 14
2024-09-01 17:04:10 INFO     Val loss decrease from 5.7806 to 5.7375, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-01 17:04:15 INFO     epoch complete!
2024-09-01 17:04:15 INFO     evaluating now!
2024-09-01 17:04:15 INFO     Epoch [15/200] train_loss: 5.2874, val_loss: 5.8659, lr: 0.003000, 5.20s
2024-09-01 17:04:20 INFO     epoch complete!
2024-09-01 17:04:20 INFO     evaluating now!
2024-09-01 17:04:20 INFO     Epoch [16/200] train_loss: 5.1948, val_loss: 5.7418, lr: 0.003000, 5.15s
2024-09-01 17:04:25 INFO     epoch complete!
2024-09-01 17:04:25 INFO     evaluating now!
2024-09-01 17:04:25 INFO     Epoch [17/200] train_loss: 5.0478, val_loss: 5.3598, lr: 0.003000, 5.11s
2024-09-01 17:04:25 INFO     Saved model at 17
2024-09-01 17:04:25 INFO     Val loss decrease from 5.7375 to 5.3598, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-01 17:04:30 INFO     epoch complete!
2024-09-01 17:04:30 INFO     evaluating now!
2024-09-01 17:04:30 INFO     Epoch [18/200] train_loss: 5.0614, val_loss: 5.6996, lr: 0.003000, 5.09s
2024-09-01 17:04:35 INFO     epoch complete!
2024-09-01 17:04:35 INFO     evaluating now!
2024-09-01 17:04:35 INFO     Epoch [19/200] train_loss: 5.0199, val_loss: 5.5444, lr: 0.003000, 5.14s
2024-09-01 17:04:40 INFO     epoch complete!
2024-09-01 17:04:40 INFO     evaluating now!
2024-09-01 17:04:41 INFO     Epoch [20/200] train_loss: 4.8562, val_loss: 5.4342, lr: 0.003000, 5.18s
2024-09-01 17:04:45 INFO     epoch complete!
2024-09-01 17:04:45 INFO     evaluating now!
2024-09-01 17:04:46 INFO     Epoch [21/200] train_loss: 4.8038, val_loss: 5.3724, lr: 0.003000, 5.11s
2024-09-01 17:04:51 INFO     epoch complete!
2024-09-01 17:04:51 INFO     evaluating now!
2024-09-01 17:04:51 INFO     Epoch [22/200] train_loss: 4.7386, val_loss: 5.6003, lr: 0.003000, 5.14s
2024-09-01 17:04:56 INFO     epoch complete!
2024-09-01 17:04:56 INFO     evaluating now!
2024-09-01 17:04:56 INFO     Epoch [23/200] train_loss: 4.7132, val_loss: 5.4148, lr: 0.003000, 5.14s
2024-09-01 17:05:01 INFO     epoch complete!
2024-09-01 17:05:01 INFO     evaluating now!
2024-09-01 17:05:01 INFO     Epoch [24/200] train_loss: 4.7104, val_loss: 5.3028, lr: 0.003000, 5.29s
2024-09-01 17:05:01 INFO     Saved model at 24
2024-09-01 17:05:01 INFO     Val loss decrease from 5.3598 to 5.3028, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-01 17:05:06 INFO     epoch complete!
2024-09-01 17:05:06 INFO     evaluating now!
2024-09-01 17:05:06 INFO     Epoch [25/200] train_loss: 4.5927, val_loss: 5.3991, lr: 0.003000, 5.12s
2024-09-01 17:05:11 INFO     epoch complete!
2024-09-01 17:05:11 INFO     evaluating now!
2024-09-01 17:05:12 INFO     Epoch [26/200] train_loss: 4.5593, val_loss: 5.3100, lr: 0.003000, 5.12s
2024-09-01 17:05:16 INFO     epoch complete!
2024-09-01 17:05:16 INFO     evaluating now!
2024-09-01 17:05:17 INFO     Epoch [27/200] train_loss: 4.4938, val_loss: 5.1852, lr: 0.003000, 5.12s
2024-09-01 17:05:17 INFO     Saved model at 27
2024-09-01 17:05:17 INFO     Val loss decrease from 5.3028 to 5.1852, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-01 17:05:21 INFO     epoch complete!
2024-09-01 17:05:21 INFO     evaluating now!
2024-09-01 17:05:22 INFO     Epoch [28/200] train_loss: 4.4329, val_loss: 5.2508, lr: 0.003000, 5.15s
2024-09-01 17:05:27 INFO     epoch complete!
2024-09-01 17:05:27 INFO     evaluating now!
2024-09-01 17:05:27 INFO     Epoch [29/200] train_loss: 4.3481, val_loss: 5.4262, lr: 0.003000, 5.24s
2024-09-01 17:05:32 INFO     epoch complete!
2024-09-01 17:05:32 INFO     evaluating now!
2024-09-01 17:05:32 INFO     Epoch [30/200] train_loss: 4.4156, val_loss: 5.0515, lr: 0.003000, 5.25s
2024-09-01 17:05:32 INFO     Saved model at 30
2024-09-01 17:05:32 INFO     Val loss decrease from 5.1852 to 5.0515, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-09-01 17:05:37 INFO     epoch complete!
2024-09-01 17:05:37 INFO     evaluating now!
2024-09-01 17:05:37 INFO     Epoch [31/200] train_loss: 4.3418, val_loss: 5.1851, lr: 0.003000, 5.11s
2024-09-01 17:05:42 INFO     epoch complete!
2024-09-01 17:05:42 INFO     evaluating now!
2024-09-01 17:05:43 INFO     Epoch [32/200] train_loss: 4.2900, val_loss: 5.2195, lr: 0.003000, 5.15s
2024-09-01 17:05:47 INFO     epoch complete!
2024-09-01 17:05:47 INFO     evaluating now!
2024-09-01 17:05:48 INFO     Epoch [33/200] train_loss: 4.2343, val_loss: 5.1713, lr: 0.003000, 5.18s
2024-09-01 17:05:53 INFO     epoch complete!
2024-09-01 17:05:53 INFO     evaluating now!
2024-09-01 17:05:53 INFO     Epoch [34/200] train_loss: 4.1622, val_loss: 5.1679, lr: 0.003000, 5.11s
2024-09-01 17:05:58 INFO     epoch complete!
2024-09-01 17:05:58 INFO     evaluating now!
2024-09-01 17:05:58 INFO     Epoch [35/200] train_loss: 4.1434, val_loss: 5.2255, lr: 0.003000, 5.19s
2024-09-01 17:06:03 INFO     epoch complete!
2024-09-01 17:06:03 INFO     evaluating now!
2024-09-01 17:06:03 INFO     Epoch [36/200] train_loss: 4.1581, val_loss: 5.1828, lr: 0.003000, 5.20s
2024-09-01 17:06:08 INFO     epoch complete!
2024-09-01 17:06:08 INFO     evaluating now!
2024-09-01 17:06:08 INFO     Epoch [37/200] train_loss: 4.1090, val_loss: 5.2192, lr: 0.003000, 5.13s
2024-09-01 17:06:13 INFO     epoch complete!
2024-09-01 17:06:13 INFO     evaluating now!
2024-09-01 17:06:14 INFO     Epoch [38/200] train_loss: 4.0739, val_loss: 5.1524, lr: 0.003000, 5.18s
2024-09-01 17:06:18 INFO     epoch complete!
2024-09-01 17:06:18 INFO     evaluating now!
2024-09-01 17:06:19 INFO     Epoch [39/200] train_loss: 4.1386, val_loss: 5.1975, lr: 0.003000, 5.12s
2024-09-01 17:06:24 INFO     epoch complete!
2024-09-01 17:06:24 INFO     evaluating now!
2024-09-01 17:06:24 INFO     Epoch [40/200] train_loss: 3.9964, val_loss: 5.1388, lr: 0.003000, 5.25s
2024-09-01 17:06:29 INFO     epoch complete!
2024-09-01 17:06:29 INFO     evaluating now!
2024-09-01 17:06:29 INFO     Epoch [41/200] train_loss: 3.9596, val_loss: 5.2012, lr: 0.003000, 5.17s
2024-09-01 17:06:34 INFO     epoch complete!
2024-09-01 17:06:34 INFO     evaluating now!
2024-09-01 17:06:34 INFO     Epoch [42/200] train_loss: 3.9602, val_loss: 5.2201, lr: 0.003000, 5.20s
2024-09-01 17:06:39 INFO     epoch complete!
2024-09-01 17:06:39 INFO     evaluating now!
2024-09-01 17:06:40 INFO     Epoch [43/200] train_loss: 3.8907, val_loss: 5.0739, lr: 0.003000, 5.20s
2024-09-01 17:06:44 INFO     epoch complete!
2024-09-01 17:06:44 INFO     evaluating now!
2024-09-01 17:06:45 INFO     Epoch [44/200] train_loss: 3.8343, val_loss: 5.0593, lr: 0.003000, 5.14s
2024-09-01 17:06:50 INFO     epoch complete!
2024-09-01 17:06:50 INFO     evaluating now!
2024-09-01 17:06:50 INFO     Epoch [45/200] train_loss: 3.8596, val_loss: 4.9285, lr: 0.003000, 5.17s
2024-09-01 17:06:50 INFO     Saved model at 45
2024-09-01 17:06:50 INFO     Val loss decrease from 5.0515 to 4.9285, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-09-01 17:06:55 INFO     epoch complete!
2024-09-01 17:06:55 INFO     evaluating now!
2024-09-01 17:06:55 INFO     Epoch [46/200] train_loss: 3.8616, val_loss: 5.1177, lr: 0.003000, 5.23s
2024-09-01 17:07:00 INFO     epoch complete!
2024-09-01 17:07:00 INFO     evaluating now!
2024-09-01 17:07:00 INFO     Epoch [47/200] train_loss: 3.8539, val_loss: 5.0974, lr: 0.003000, 5.22s
2024-09-01 17:07:05 INFO     epoch complete!
2024-09-01 17:07:05 INFO     evaluating now!
2024-09-01 17:07:05 INFO     Epoch [48/200] train_loss: 3.7793, val_loss: 4.8941, lr: 0.003000, 5.17s
2024-09-01 17:07:05 INFO     Saved model at 48
2024-09-01 17:07:05 INFO     Val loss decrease from 4.9285 to 4.8941, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-09-01 17:07:10 INFO     epoch complete!
2024-09-01 17:07:10 INFO     evaluating now!
2024-09-01 17:07:11 INFO     Epoch [49/200] train_loss: 3.7805, val_loss: 5.0796, lr: 0.003000, 5.24s
2024-09-01 17:07:16 INFO     epoch complete!
2024-09-01 17:07:16 INFO     evaluating now!
2024-09-01 17:07:16 INFO     Epoch [50/200] train_loss: 3.7545, val_loss: 5.0200, lr: 0.003000, 5.15s
2024-09-01 17:07:21 INFO     epoch complete!
2024-09-01 17:07:21 INFO     evaluating now!
2024-09-01 17:07:21 INFO     Epoch [51/200] train_loss: 3.7263, val_loss: 5.0259, lr: 0.003000, 5.15s
2024-09-01 17:07:26 INFO     epoch complete!
2024-09-01 17:07:26 INFO     evaluating now!
2024-09-01 17:07:26 INFO     Epoch [52/200] train_loss: 3.6674, val_loss: 4.9187, lr: 0.003000, 5.20s
2024-09-01 17:07:31 INFO     epoch complete!
2024-09-01 17:07:31 INFO     evaluating now!
2024-09-01 17:07:31 INFO     Epoch [53/200] train_loss: 3.6525, val_loss: 4.9759, lr: 0.003000, 5.17s
2024-09-01 17:07:36 INFO     epoch complete!
2024-09-01 17:07:36 INFO     evaluating now!
2024-09-01 17:07:37 INFO     Epoch [54/200] train_loss: 3.6396, val_loss: 5.0771, lr: 0.003000, 5.19s
2024-09-01 17:07:42 INFO     epoch complete!
2024-09-01 17:07:42 INFO     evaluating now!
2024-09-01 17:07:42 INFO     Epoch [55/200] train_loss: 3.6775, val_loss: 4.9716, lr: 0.003000, 5.25s
2024-09-01 17:07:47 INFO     epoch complete!
2024-09-01 17:07:47 INFO     evaluating now!
2024-09-01 17:07:47 INFO     Epoch [56/200] train_loss: 3.7105, val_loss: 4.9997, lr: 0.003000, 5.22s
2024-09-01 17:07:52 INFO     epoch complete!
2024-09-01 17:07:52 INFO     evaluating now!
2024-09-01 17:07:52 INFO     Epoch [57/200] train_loss: 3.6295, val_loss: 5.1528, lr: 0.003000, 5.23s
2024-09-01 17:07:57 INFO     epoch complete!
2024-09-01 17:07:57 INFO     evaluating now!
2024-09-01 17:07:58 INFO     Epoch [58/200] train_loss: 3.5839, val_loss: 4.8814, lr: 0.003000, 5.24s
2024-09-01 17:07:58 INFO     Saved model at 58
2024-09-01 17:07:58 INFO     Val loss decrease from 4.8941 to 4.8814, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch58.tar
2024-09-01 17:08:02 INFO     epoch complete!
2024-09-01 17:08:02 INFO     evaluating now!
2024-09-01 17:08:03 INFO     Epoch [59/200] train_loss: 3.5571, val_loss: 5.0624, lr: 0.003000, 5.21s
2024-09-01 17:08:08 INFO     epoch complete!
2024-09-01 17:08:08 INFO     evaluating now!
2024-09-01 17:08:08 INFO     Epoch [60/200] train_loss: 3.6282, val_loss: 5.0334, lr: 0.003000, 5.14s
2024-09-01 17:08:13 INFO     epoch complete!
2024-09-01 17:08:13 INFO     evaluating now!
2024-09-01 17:08:13 INFO     Epoch [61/200] train_loss: 3.6199, val_loss: 5.0457, lr: 0.003000, 5.19s
2024-09-01 17:08:18 INFO     epoch complete!
2024-09-01 17:08:18 INFO     evaluating now!
2024-09-01 17:08:18 INFO     Epoch [62/200] train_loss: 3.5558, val_loss: 4.9557, lr: 0.003000, 5.16s
2024-09-01 17:08:23 INFO     epoch complete!
2024-09-01 17:08:23 INFO     evaluating now!
2024-09-01 17:08:23 INFO     Epoch [63/200] train_loss: 3.5053, val_loss: 4.9525, lr: 0.003000, 5.17s
2024-09-01 17:08:28 INFO     epoch complete!
2024-09-01 17:08:28 INFO     evaluating now!
2024-09-01 17:08:29 INFO     Epoch [64/200] train_loss: 3.5590, val_loss: 4.9386, lr: 0.003000, 5.14s
2024-09-01 17:08:33 INFO     epoch complete!
2024-09-01 17:08:33 INFO     evaluating now!
2024-09-01 17:08:34 INFO     Epoch [65/200] train_loss: 3.4897, val_loss: 5.1300, lr: 0.003000, 5.13s
2024-09-01 17:08:39 INFO     epoch complete!
2024-09-01 17:08:39 INFO     evaluating now!
2024-09-01 17:08:39 INFO     Epoch [66/200] train_loss: 3.4507, val_loss: 5.0462, lr: 0.003000, 5.17s
2024-09-01 17:08:44 INFO     epoch complete!
2024-09-01 17:08:44 INFO     evaluating now!
2024-09-01 17:08:44 INFO     Epoch [67/200] train_loss: 3.4402, val_loss: 4.9818, lr: 0.003000, 5.17s
2024-09-01 17:08:49 INFO     epoch complete!
2024-09-01 17:08:49 INFO     evaluating now!
2024-09-01 17:08:49 INFO     Epoch [68/200] train_loss: 3.3883, val_loss: 4.9864, lr: 0.003000, 5.15s
2024-09-01 17:08:54 INFO     epoch complete!
2024-09-01 17:08:54 INFO     evaluating now!
2024-09-01 17:08:54 INFO     Epoch [69/200] train_loss: 3.4358, val_loss: 4.9869, lr: 0.003000, 5.19s
2024-09-01 17:08:59 INFO     epoch complete!
2024-09-01 17:08:59 INFO     evaluating now!
2024-09-01 17:09:00 INFO     Epoch [70/200] train_loss: 3.4052, val_loss: 4.9878, lr: 0.003000, 5.16s
2024-09-01 17:09:04 INFO     epoch complete!
2024-09-01 17:09:04 INFO     evaluating now!
2024-09-01 17:09:05 INFO     Epoch [71/200] train_loss: 3.4326, val_loss: 5.0250, lr: 0.003000, 5.19s
2024-09-01 17:09:10 INFO     epoch complete!
2024-09-01 17:09:10 INFO     evaluating now!
2024-09-01 17:09:10 INFO     Epoch [72/200] train_loss: 3.3945, val_loss: 5.1019, lr: 0.003000, 5.20s
2024-09-01 17:09:15 INFO     epoch complete!
2024-09-01 17:09:15 INFO     evaluating now!
2024-09-01 17:09:15 INFO     Epoch [73/200] train_loss: 3.3677, val_loss: 4.9667, lr: 0.003000, 5.15s
2024-09-01 17:09:15 WARNING  Early stopping at epoch: 73
2024-09-01 17:09:15 INFO     Trained totally 74 epochs, average train time is 4.863s, average eval time is 0.313s
2024-09-01 17:09:15 INFO     Loaded model at 58
2024-09-01 17:09:15 INFO     Saved model at ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406.m
2024-09-01 17:09:15 INFO     Start evaluating ...
2024-09-01 17:09:16 INFO     Note that you select the single mode to evaluate!
2024-09-01 17:09:16 INFO     Evaluate result is saved at ./libcity/cache/45/evaluate_cache\2024_09_01_17_09_16_AGCRN_CHITaxi20190406.csv
2024-09-01 17:09:16 INFO     
         MAE       RMSE
1   2.325706   7.271945
2   2.424094   7.554731
3   2.536935   8.529543
4   2.675768   9.441509
5   2.801372  10.471233
6   2.940782  11.483619
7   3.059057  12.324907
8   3.131255  12.939433
9   3.209536  13.344712
10  3.230051  13.562067
11  3.322815  14.076527
12  3.470012  14.952332
2024-09-01 17:09:16 INFO     ----------------------------------------------------------------------------
2024-09-01 17:09:16 INFO     # 2, Kownledge Graph Embedding: AttE, Experiment ids: 47
2024-09-01 17:09:16 INFO     ----------------------------------------------------------------------------
2024-09-01 17:09:16 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=45
2024-09-01 17:09:16 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 45, 'embedding_model': 'AttE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-01 17:09:16 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-01 17:09:16 INFO     set_weight_link_or_dist: dist
2024-09-01 17:09:16 INFO     init_weight_inf_or_zero: inf
2024-09-01 17:09:16 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-01 17:09:16 INFO     Start Calculate the weight by Gauss kernel!
2024-09-01 17:09:16 INFO     Loading file CHITaxi20190406.dyna
2024-09-01 17:09:16 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-01 17:09:18 INFO     Dataset created
2024-09-01 17:09:18 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-01 17:09:18 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-01 17:09:18 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-01 17:09:18 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-01 17:09:18 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-01 17:09:18 INFO     NormalScaler max: 1.4853242543142366
2024-09-01 17:09:21 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-01 17:09:21 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-01 17:09:21 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-01 17:09:21 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 17:09:21 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-01 17:09:21 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 17:09:21 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-01 17:09:21 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 17:09:21 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-01 17:09:21 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 17:09:21 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-01 17:09:21 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-01 17:09:21 INFO     Total parameter numbers: 874010
2024-09-01 17:09:21 INFO     You select `adam` optimizer.
2024-09-01 17:09:21 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-01 17:09:21 INFO     Start training ...
2024-09-01 17:09:21 INFO     num_batches:48
2024-09-01 17:09:26 INFO     epoch complete!
2024-09-01 17:09:26 INFO     evaluating now!
2024-09-01 17:09:26 INFO     Epoch [0/200] train_loss: 24.2619, val_loss: 18.8254, lr: 0.003000, 5.47s
2024-09-01 17:09:26 INFO     Saved model at 0
2024-09-01 17:09:26 INFO     Val loss decrease from inf to 18.8254, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-01 17:09:31 INFO     epoch complete!
2024-09-01 17:09:31 INFO     evaluating now!
2024-09-01 17:09:31 INFO     Epoch [1/200] train_loss: 15.3005, val_loss: 14.5876, lr: 0.003000, 5.13s
2024-09-01 17:09:31 INFO     Saved model at 1
2024-09-01 17:09:31 INFO     Val loss decrease from 18.8254 to 14.5876, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-01 17:09:36 INFO     epoch complete!
2024-09-01 17:09:36 INFO     evaluating now!
2024-09-01 17:09:36 INFO     Epoch [2/200] train_loss: 11.7724, val_loss: 11.6297, lr: 0.003000, 5.12s
2024-09-01 17:09:36 INFO     Saved model at 2
2024-09-01 17:09:36 INFO     Val loss decrease from 14.5876 to 11.6297, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-01 17:09:41 INFO     epoch complete!
2024-09-01 17:09:41 INFO     evaluating now!
2024-09-01 17:09:41 INFO     Epoch [3/200] train_loss: 9.7779, val_loss: 9.6187, lr: 0.003000, 5.14s
2024-09-01 17:09:41 INFO     Saved model at 3
2024-09-01 17:09:41 INFO     Val loss decrease from 11.6297 to 9.6187, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-01 17:09:46 INFO     epoch complete!
2024-09-01 17:09:46 INFO     evaluating now!
2024-09-01 17:09:47 INFO     Epoch [4/200] train_loss: 8.6477, val_loss: 8.4471, lr: 0.003000, 5.13s
2024-09-01 17:09:47 INFO     Saved model at 4
2024-09-01 17:09:47 INFO     Val loss decrease from 9.6187 to 8.4471, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-01 17:09:51 INFO     epoch complete!
2024-09-01 17:09:51 INFO     evaluating now!
2024-09-01 17:09:52 INFO     Epoch [5/200] train_loss: 7.8819, val_loss: 7.4797, lr: 0.003000, 5.15s
2024-09-01 17:09:52 INFO     Saved model at 5
2024-09-01 17:09:52 INFO     Val loss decrease from 8.4471 to 7.4797, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-01 17:09:57 INFO     epoch complete!
2024-09-01 17:09:57 INFO     evaluating now!
2024-09-01 17:09:57 INFO     Epoch [6/200] train_loss: 7.3318, val_loss: 7.1262, lr: 0.003000, 5.12s
2024-09-01 17:09:57 INFO     Saved model at 6
2024-09-01 17:09:57 INFO     Val loss decrease from 7.4797 to 7.1262, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-01 17:10:02 INFO     epoch complete!
2024-09-01 17:10:02 INFO     evaluating now!
2024-09-01 17:10:02 INFO     Epoch [7/200] train_loss: 6.7592, val_loss: 6.8175, lr: 0.003000, 5.17s
2024-09-01 17:10:02 INFO     Saved model at 7
2024-09-01 17:10:02 INFO     Val loss decrease from 7.1262 to 6.8175, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-01 17:10:07 INFO     epoch complete!
2024-09-01 17:10:07 INFO     evaluating now!
2024-09-01 17:10:07 INFO     Epoch [8/200] train_loss: 6.4417, val_loss: 6.3742, lr: 0.003000, 5.12s
2024-09-01 17:10:07 INFO     Saved model at 8
2024-09-01 17:10:07 INFO     Val loss decrease from 6.8175 to 6.3742, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-01 17:10:12 INFO     epoch complete!
2024-09-01 17:10:12 INFO     evaluating now!
2024-09-01 17:10:12 INFO     Epoch [9/200] train_loss: 6.1318, val_loss: 6.1793, lr: 0.003000, 5.15s
2024-09-01 17:10:12 INFO     Saved model at 9
2024-09-01 17:10:12 INFO     Val loss decrease from 6.3742 to 6.1793, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-01 17:10:17 INFO     epoch complete!
2024-09-01 17:10:17 INFO     evaluating now!
2024-09-01 17:10:18 INFO     Epoch [10/200] train_loss: 5.8918, val_loss: 6.1196, lr: 0.003000, 5.14s
2024-09-01 17:10:18 INFO     Saved model at 10
2024-09-01 17:10:18 INFO     Val loss decrease from 6.1793 to 6.1196, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-01 17:10:23 INFO     epoch complete!
2024-09-01 17:10:23 INFO     evaluating now!
2024-09-01 17:10:23 INFO     Epoch [11/200] train_loss: 5.8896, val_loss: 6.0439, lr: 0.003000, 5.34s
2024-09-01 17:10:23 INFO     Saved model at 11
2024-09-01 17:10:23 INFO     Val loss decrease from 6.1196 to 6.0439, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-01 17:10:28 INFO     epoch complete!
2024-09-01 17:10:28 INFO     evaluating now!
2024-09-01 17:10:28 INFO     Epoch [12/200] train_loss: 5.5553, val_loss: 5.7958, lr: 0.003000, 5.35s
2024-09-01 17:10:28 INFO     Saved model at 12
2024-09-01 17:10:28 INFO     Val loss decrease from 6.0439 to 5.7958, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-01 17:10:33 INFO     epoch complete!
2024-09-01 17:10:33 INFO     evaluating now!
2024-09-01 17:10:34 INFO     Epoch [13/200] train_loss: 5.4786, val_loss: 5.7597, lr: 0.003000, 5.27s
2024-09-01 17:10:34 INFO     Saved model at 13
2024-09-01 17:10:34 INFO     Val loss decrease from 5.7958 to 5.7597, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-01 17:10:38 INFO     epoch complete!
2024-09-01 17:10:39 INFO     evaluating now!
2024-09-01 17:10:39 INFO     Epoch [14/200] train_loss: 5.4174, val_loss: 5.6769, lr: 0.003000, 5.26s
2024-09-01 17:10:39 INFO     Saved model at 14
2024-09-01 17:10:39 INFO     Val loss decrease from 5.7597 to 5.6769, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-01 17:10:44 INFO     epoch complete!
2024-09-01 17:10:44 INFO     evaluating now!
2024-09-01 17:10:44 INFO     Epoch [15/200] train_loss: 5.3058, val_loss: 5.5018, lr: 0.003000, 5.17s
2024-09-01 17:10:44 INFO     Saved model at 15
2024-09-01 17:10:44 INFO     Val loss decrease from 5.6769 to 5.5018, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-01 17:10:49 INFO     epoch complete!
2024-09-01 17:10:49 INFO     evaluating now!
2024-09-01 17:10:49 INFO     Epoch [16/200] train_loss: 5.1746, val_loss: 5.5776, lr: 0.003000, 5.16s
2024-09-01 17:10:54 INFO     epoch complete!
2024-09-01 17:10:54 INFO     evaluating now!
2024-09-01 17:10:54 INFO     Epoch [17/200] train_loss: 5.0336, val_loss: 5.4613, lr: 0.003000, 5.15s
2024-09-01 17:10:54 INFO     Saved model at 17
2024-09-01 17:10:54 INFO     Val loss decrease from 5.5018 to 5.4613, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-01 17:10:59 INFO     epoch complete!
2024-09-01 17:10:59 INFO     evaluating now!
2024-09-01 17:11:00 INFO     Epoch [18/200] train_loss: 4.9651, val_loss: 5.4998, lr: 0.003000, 5.18s
2024-09-01 17:11:04 INFO     epoch complete!
2024-09-01 17:11:04 INFO     evaluating now!
2024-09-01 17:11:05 INFO     Epoch [19/200] train_loss: 4.9186, val_loss: 5.5048, lr: 0.003000, 5.20s
2024-09-01 17:11:10 INFO     epoch complete!
2024-09-01 17:11:10 INFO     evaluating now!
2024-09-01 17:11:10 INFO     Epoch [20/200] train_loss: 4.8508, val_loss: 5.4859, lr: 0.003000, 5.13s
2024-09-01 17:11:15 INFO     epoch complete!
2024-09-01 17:11:15 INFO     evaluating now!
2024-09-01 17:11:15 INFO     Epoch [21/200] train_loss: 4.7709, val_loss: 5.3756, lr: 0.003000, 5.16s
2024-09-01 17:11:15 INFO     Saved model at 21
2024-09-01 17:11:15 INFO     Val loss decrease from 5.4613 to 5.3756, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-01 17:11:20 INFO     epoch complete!
2024-09-01 17:11:20 INFO     evaluating now!
2024-09-01 17:11:20 INFO     Epoch [22/200] train_loss: 4.7687, val_loss: 5.4535, lr: 0.003000, 5.21s
2024-09-01 17:11:25 INFO     epoch complete!
2024-09-01 17:11:25 INFO     evaluating now!
2024-09-01 17:11:25 INFO     Epoch [23/200] train_loss: 4.6634, val_loss: 5.2235, lr: 0.003000, 5.21s
2024-09-01 17:11:25 INFO     Saved model at 23
2024-09-01 17:11:25 INFO     Val loss decrease from 5.3756 to 5.2235, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-01 17:11:30 INFO     epoch complete!
2024-09-01 17:11:30 INFO     evaluating now!
2024-09-01 17:11:31 INFO     Epoch [24/200] train_loss: 4.6220, val_loss: 5.3338, lr: 0.003000, 5.18s
2024-09-01 17:11:36 INFO     epoch complete!
2024-09-01 17:11:36 INFO     evaluating now!
2024-09-01 17:11:36 INFO     Epoch [25/200] train_loss: 4.5565, val_loss: 5.1518, lr: 0.003000, 5.26s
2024-09-01 17:11:36 INFO     Saved model at 25
2024-09-01 17:11:36 INFO     Val loss decrease from 5.2235 to 5.1518, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-01 17:11:41 INFO     epoch complete!
2024-09-01 17:11:41 INFO     evaluating now!
2024-09-01 17:11:41 INFO     Epoch [26/200] train_loss: 4.4602, val_loss: 5.1192, lr: 0.003000, 5.21s
2024-09-01 17:11:41 INFO     Saved model at 26
2024-09-01 17:11:41 INFO     Val loss decrease from 5.1518 to 5.1192, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-01 17:11:46 INFO     epoch complete!
2024-09-01 17:11:46 INFO     evaluating now!
2024-09-01 17:11:46 INFO     Epoch [27/200] train_loss: 4.5116, val_loss: 5.5707, lr: 0.003000, 5.16s
2024-09-01 17:11:51 INFO     epoch complete!
2024-09-01 17:11:51 INFO     evaluating now!
2024-09-01 17:11:52 INFO     Epoch [28/200] train_loss: 4.5534, val_loss: 5.3074, lr: 0.003000, 5.24s
2024-09-01 17:11:56 INFO     epoch complete!
2024-09-01 17:11:56 INFO     evaluating now!
2024-09-01 17:11:57 INFO     Epoch [29/200] train_loss: 4.4104, val_loss: 5.3184, lr: 0.003000, 5.21s
2024-09-01 17:12:02 INFO     epoch complete!
2024-09-01 17:12:02 INFO     evaluating now!
2024-09-01 17:12:02 INFO     Epoch [30/200] train_loss: 4.3393, val_loss: 5.1402, lr: 0.003000, 5.26s
2024-09-01 17:12:07 INFO     epoch complete!
2024-09-01 17:12:07 INFO     evaluating now!
2024-09-01 17:12:07 INFO     Epoch [31/200] train_loss: 4.2787, val_loss: 5.2349, lr: 0.003000, 5.16s
2024-09-01 17:12:12 INFO     epoch complete!
2024-09-01 17:12:12 INFO     evaluating now!
2024-09-01 17:12:12 INFO     Epoch [32/200] train_loss: 4.2969, val_loss: 5.2473, lr: 0.003000, 5.32s
2024-09-01 17:12:17 INFO     epoch complete!
2024-09-01 17:12:17 INFO     evaluating now!
2024-09-01 17:12:18 INFO     Epoch [33/200] train_loss: 4.2188, val_loss: 5.2312, lr: 0.003000, 5.17s
2024-09-01 17:12:23 INFO     epoch complete!
2024-09-01 17:12:23 INFO     evaluating now!
2024-09-01 17:12:23 INFO     Epoch [34/200] train_loss: 4.2237, val_loss: 5.1223, lr: 0.003000, 5.20s
2024-09-01 17:12:28 INFO     epoch complete!
2024-09-01 17:12:28 INFO     evaluating now!
2024-09-01 17:12:28 INFO     Epoch [35/200] train_loss: 4.1552, val_loss: 5.0445, lr: 0.003000, 5.26s
2024-09-01 17:12:28 INFO     Saved model at 35
2024-09-01 17:12:28 INFO     Val loss decrease from 5.1192 to 5.0445, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-01 17:12:33 INFO     epoch complete!
2024-09-01 17:12:33 INFO     evaluating now!
2024-09-01 17:12:34 INFO     Epoch [36/200] train_loss: 4.1044, val_loss: 5.2075, lr: 0.003000, 5.37s
2024-09-01 17:12:38 INFO     epoch complete!
2024-09-01 17:12:38 INFO     evaluating now!
2024-09-01 17:12:39 INFO     Epoch [37/200] train_loss: 4.0846, val_loss: 5.1200, lr: 0.003000, 5.24s
2024-09-01 17:12:44 INFO     epoch complete!
2024-09-01 17:12:44 INFO     evaluating now!
2024-09-01 17:12:44 INFO     Epoch [38/200] train_loss: 4.0967, val_loss: 5.1814, lr: 0.003000, 5.22s
2024-09-01 17:12:49 INFO     epoch complete!
2024-09-01 17:12:49 INFO     evaluating now!
2024-09-01 17:12:49 INFO     Epoch [39/200] train_loss: 4.0604, val_loss: 5.3333, lr: 0.003000, 5.17s
2024-09-01 17:12:54 INFO     epoch complete!
2024-09-01 17:12:54 INFO     evaluating now!
2024-09-01 17:12:54 INFO     Epoch [40/200] train_loss: 4.0533, val_loss: 5.2122, lr: 0.003000, 5.20s
2024-09-01 17:12:59 INFO     epoch complete!
2024-09-01 17:12:59 INFO     evaluating now!
2024-09-01 17:13:00 INFO     Epoch [41/200] train_loss: 4.0526, val_loss: 5.1928, lr: 0.003000, 5.22s
2024-09-01 17:13:04 INFO     epoch complete!
2024-09-01 17:13:04 INFO     evaluating now!
2024-09-01 17:13:05 INFO     Epoch [42/200] train_loss: 4.0361, val_loss: 5.1167, lr: 0.003000, 5.22s
2024-09-01 17:13:10 INFO     epoch complete!
2024-09-01 17:13:10 INFO     evaluating now!
2024-09-01 17:13:10 INFO     Epoch [43/200] train_loss: 3.9501, val_loss: 5.0743, lr: 0.003000, 5.30s
2024-09-01 17:13:15 INFO     epoch complete!
2024-09-01 17:13:15 INFO     evaluating now!
2024-09-01 17:13:15 INFO     Epoch [44/200] train_loss: 3.9917, val_loss: 5.0585, lr: 0.003000, 5.31s
2024-09-01 17:13:20 INFO     epoch complete!
2024-09-01 17:13:20 INFO     evaluating now!
2024-09-01 17:13:21 INFO     Epoch [45/200] train_loss: 3.8661, val_loss: 5.0987, lr: 0.003000, 5.33s
2024-09-01 17:13:26 INFO     epoch complete!
2024-09-01 17:13:26 INFO     evaluating now!
2024-09-01 17:13:26 INFO     Epoch [46/200] train_loss: 3.8746, val_loss: 5.0274, lr: 0.003000, 5.34s
2024-09-01 17:13:26 INFO     Saved model at 46
2024-09-01 17:13:26 INFO     Val loss decrease from 5.0445 to 5.0274, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-09-01 17:13:31 INFO     epoch complete!
2024-09-01 17:13:31 INFO     evaluating now!
2024-09-01 17:13:31 INFO     Epoch [47/200] train_loss: 3.8641, val_loss: 5.0778, lr: 0.003000, 5.30s
2024-09-01 17:13:36 INFO     epoch complete!
2024-09-01 17:13:36 INFO     evaluating now!
2024-09-01 17:13:37 INFO     Epoch [48/200] train_loss: 3.8440, val_loss: 5.0438, lr: 0.003000, 5.41s
2024-09-01 17:13:42 INFO     epoch complete!
2024-09-01 17:13:42 INFO     evaluating now!
2024-09-01 17:13:42 INFO     Epoch [49/200] train_loss: 3.8136, val_loss: 5.1024, lr: 0.003000, 5.30s
2024-09-01 17:13:47 INFO     epoch complete!
2024-09-01 17:13:47 INFO     evaluating now!
2024-09-01 17:13:47 INFO     Epoch [50/200] train_loss: 3.8118, val_loss: 5.2119, lr: 0.003000, 5.31s
2024-09-01 17:13:52 INFO     epoch complete!
2024-09-01 17:13:52 INFO     evaluating now!
2024-09-01 17:13:53 INFO     Epoch [51/200] train_loss: 3.7545, val_loss: 5.1707, lr: 0.003000, 5.29s
2024-09-01 17:13:58 INFO     epoch complete!
2024-09-01 17:13:58 INFO     evaluating now!
2024-09-01 17:13:58 INFO     Epoch [52/200] train_loss: 3.7196, val_loss: 4.9882, lr: 0.003000, 5.38s
2024-09-01 17:13:58 INFO     Saved model at 52
2024-09-01 17:13:58 INFO     Val loss decrease from 5.0274 to 4.9882, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch52.tar
2024-09-01 17:14:03 INFO     epoch complete!
2024-09-01 17:14:03 INFO     evaluating now!
2024-09-01 17:14:04 INFO     Epoch [53/200] train_loss: 3.7399, val_loss: 5.1112, lr: 0.003000, 5.51s
2024-09-01 17:14:09 INFO     epoch complete!
2024-09-01 17:14:09 INFO     evaluating now!
2024-09-01 17:14:09 INFO     Epoch [54/200] train_loss: 3.6850, val_loss: 5.1567, lr: 0.003000, 5.35s
2024-09-01 17:14:14 INFO     epoch complete!
2024-09-01 17:14:14 INFO     evaluating now!
2024-09-01 17:14:14 INFO     Epoch [55/200] train_loss: 3.7645, val_loss: 5.1908, lr: 0.003000, 5.36s
2024-09-01 17:14:19 INFO     epoch complete!
2024-09-01 17:14:19 INFO     evaluating now!
2024-09-01 17:14:20 INFO     Epoch [56/200] train_loss: 3.6812, val_loss: 5.0323, lr: 0.003000, 5.32s
2024-09-01 17:14:25 INFO     epoch complete!
2024-09-01 17:14:25 INFO     evaluating now!
2024-09-01 17:14:25 INFO     Epoch [57/200] train_loss: 3.6430, val_loss: 5.0207, lr: 0.003000, 5.29s
2024-09-01 17:14:30 INFO     epoch complete!
2024-09-01 17:14:30 INFO     evaluating now!
2024-09-01 17:14:30 INFO     Epoch [58/200] train_loss: 3.6019, val_loss: 5.0623, lr: 0.003000, 5.43s
2024-09-01 17:14:35 INFO     epoch complete!
2024-09-01 17:14:35 INFO     evaluating now!
2024-09-01 17:14:36 INFO     Epoch [59/200] train_loss: 3.5761, val_loss: 5.1114, lr: 0.003000, 5.27s
2024-09-01 17:14:41 INFO     epoch complete!
2024-09-01 17:14:41 INFO     evaluating now!
2024-09-01 17:14:41 INFO     Epoch [60/200] train_loss: 3.5912, val_loss: 5.0238, lr: 0.003000, 5.28s
2024-09-01 17:14:46 INFO     epoch complete!
2024-09-01 17:14:46 INFO     evaluating now!
2024-09-01 17:14:46 INFO     Epoch [61/200] train_loss: 3.5921, val_loss: 5.0569, lr: 0.003000, 5.41s
2024-09-01 17:14:51 INFO     epoch complete!
2024-09-01 17:14:51 INFO     evaluating now!
2024-09-01 17:14:52 INFO     Epoch [62/200] train_loss: 3.5777, val_loss: 5.2718, lr: 0.003000, 5.27s
2024-09-01 17:14:57 INFO     epoch complete!
2024-09-01 17:14:57 INFO     evaluating now!
2024-09-01 17:14:57 INFO     Epoch [63/200] train_loss: 3.5413, val_loss: 5.1616, lr: 0.003000, 5.36s
2024-09-01 17:15:02 INFO     epoch complete!
2024-09-01 17:15:02 INFO     evaluating now!
2024-09-01 17:15:02 INFO     Epoch [64/200] train_loss: 3.5551, val_loss: 5.0102, lr: 0.003000, 5.36s
2024-09-01 17:15:07 INFO     epoch complete!
2024-09-01 17:15:07 INFO     evaluating now!
2024-09-01 17:15:08 INFO     Epoch [65/200] train_loss: 3.5387, val_loss: 5.0602, lr: 0.003000, 5.32s
2024-09-01 17:15:13 INFO     epoch complete!
2024-09-01 17:15:13 INFO     evaluating now!
2024-09-01 17:15:13 INFO     Epoch [66/200] train_loss: 3.5147, val_loss: 5.2776, lr: 0.003000, 5.29s
2024-09-01 17:15:18 INFO     epoch complete!
2024-09-01 17:15:18 INFO     evaluating now!
2024-09-01 17:15:18 INFO     Epoch [67/200] train_loss: 3.5129, val_loss: 5.1088, lr: 0.003000, 5.41s
2024-09-01 17:15:18 WARNING  Early stopping at epoch: 67
2024-09-01 17:15:18 INFO     Trained totally 68 epochs, average train time is 4.933s, average eval time is 0.323s
2024-09-01 17:15:18 INFO     Loaded model at 52
2024-09-01 17:15:18 INFO     Saved model at ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406.m
2024-09-01 17:15:18 INFO     Start evaluating ...
2024-09-01 17:15:19 INFO     Note that you select the single mode to evaluate!
2024-09-01 17:15:19 INFO     Evaluate result is saved at ./libcity/cache/45/evaluate_cache\2024_09_01_17_15_19_AGCRN_CHITaxi20190406.csv
2024-09-01 17:15:19 INFO     
         MAE       RMSE
1   2.373173   7.686703
2   2.433409   7.952444
3   2.583797   8.933757
4   2.758105   9.719501
5   2.858749  10.471399
6   2.979904  10.968671
7   3.114832  11.569581
8   3.135609  12.024040
9   3.271248  12.500302
10  3.231523  12.817807
11  3.240102  13.212728
12  3.393559  13.722071
2024-09-01 17:15:20 INFO     ----------------------------------------------------------------------------
2024-09-01 17:15:20 INFO     # 3, Kownledge Graph Embedding: AttE, Experiment ids: 48
2024-09-01 17:15:20 INFO     ----------------------------------------------------------------------------
2024-09-01 17:15:20 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=45
2024-09-01 17:15:20 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 45, 'embedding_model': 'AttE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-01 17:15:20 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-01 17:15:20 INFO     set_weight_link_or_dist: dist
2024-09-01 17:15:20 INFO     init_weight_inf_or_zero: inf
2024-09-01 17:15:20 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-01 17:15:20 INFO     Start Calculate the weight by Gauss kernel!
2024-09-01 17:15:20 INFO     Loading file CHITaxi20190406.dyna
2024-09-01 17:15:20 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-01 17:15:21 INFO     Dataset created
2024-09-01 17:15:21 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-01 17:15:22 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-01 17:15:22 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-01 17:15:22 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-01 17:15:22 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-01 17:15:22 INFO     NormalScaler max: 1.4853242543142366
2024-09-01 17:15:24 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-01 17:15:24 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-01 17:15:24 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-01 17:15:24 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 17:15:24 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-01 17:15:24 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 17:15:24 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-01 17:15:24 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 17:15:24 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-01 17:15:24 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 17:15:24 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-01 17:15:24 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-01 17:15:24 INFO     Total parameter numbers: 874010
2024-09-01 17:15:24 INFO     You select `adam` optimizer.
2024-09-01 17:15:24 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-01 17:15:24 INFO     Start training ...
2024-09-01 17:15:24 INFO     num_batches:48
2024-09-01 17:15:29 INFO     epoch complete!
2024-09-01 17:15:29 INFO     evaluating now!
2024-09-01 17:15:29 INFO     Epoch [0/200] train_loss: 24.5158, val_loss: 18.5502, lr: 0.003000, 5.35s
2024-09-01 17:15:29 INFO     Saved model at 0
2024-09-01 17:15:29 INFO     Val loss decrease from inf to 18.5502, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-01 17:15:34 INFO     epoch complete!
2024-09-01 17:15:34 INFO     evaluating now!
2024-09-01 17:15:34 INFO     Epoch [1/200] train_loss: 15.0837, val_loss: 14.5415, lr: 0.003000, 5.15s
2024-09-01 17:15:34 INFO     Saved model at 1
2024-09-01 17:15:34 INFO     Val loss decrease from 18.5502 to 14.5415, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-01 17:15:39 INFO     epoch complete!
2024-09-01 17:15:39 INFO     evaluating now!
2024-09-01 17:15:40 INFO     Epoch [2/200] train_loss: 11.8727, val_loss: 11.5542, lr: 0.003000, 5.13s
2024-09-01 17:15:40 INFO     Saved model at 2
2024-09-01 17:15:40 INFO     Val loss decrease from 14.5415 to 11.5542, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-01 17:15:44 INFO     epoch complete!
2024-09-01 17:15:44 INFO     evaluating now!
2024-09-01 17:15:45 INFO     Epoch [3/200] train_loss: 9.9316, val_loss: 9.5492, lr: 0.003000, 5.10s
2024-09-01 17:15:45 INFO     Saved model at 3
2024-09-01 17:15:45 INFO     Val loss decrease from 11.5542 to 9.5492, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-01 17:15:50 INFO     epoch complete!
2024-09-01 17:15:50 INFO     evaluating now!
2024-09-01 17:15:50 INFO     Epoch [4/200] train_loss: 8.5411, val_loss: 8.1982, lr: 0.003000, 5.20s
2024-09-01 17:15:50 INFO     Saved model at 4
2024-09-01 17:15:50 INFO     Val loss decrease from 9.5492 to 8.1982, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-01 17:15:55 INFO     epoch complete!
2024-09-01 17:15:55 INFO     evaluating now!
2024-09-01 17:15:55 INFO     Epoch [5/200] train_loss: 7.6679, val_loss: 7.7342, lr: 0.003000, 5.15s
2024-09-01 17:15:55 INFO     Saved model at 5
2024-09-01 17:15:55 INFO     Val loss decrease from 8.1982 to 7.7342, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-01 17:16:00 INFO     epoch complete!
2024-09-01 17:16:00 INFO     evaluating now!
2024-09-01 17:16:00 INFO     Epoch [6/200] train_loss: 7.1714, val_loss: 6.9879, lr: 0.003000, 5.23s
2024-09-01 17:16:00 INFO     Saved model at 6
2024-09-01 17:16:00 INFO     Val loss decrease from 7.7342 to 6.9879, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-01 17:16:05 INFO     epoch complete!
2024-09-01 17:16:05 INFO     evaluating now!
2024-09-01 17:16:05 INFO     Epoch [7/200] train_loss: 6.8190, val_loss: 6.7143, lr: 0.003000, 5.13s
2024-09-01 17:16:05 INFO     Saved model at 7
2024-09-01 17:16:05 INFO     Val loss decrease from 6.9879 to 6.7143, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-01 17:16:10 INFO     epoch complete!
2024-09-01 17:16:10 INFO     evaluating now!
2024-09-01 17:16:11 INFO     Epoch [8/200] train_loss: 6.4412, val_loss: 6.3705, lr: 0.003000, 5.11s
2024-09-01 17:16:11 INFO     Saved model at 8
2024-09-01 17:16:11 INFO     Val loss decrease from 6.7143 to 6.3705, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-01 17:16:15 INFO     epoch complete!
2024-09-01 17:16:15 INFO     evaluating now!
2024-09-01 17:16:16 INFO     Epoch [9/200] train_loss: 6.2696, val_loss: 6.5450, lr: 0.003000, 5.15s
2024-09-01 17:16:21 INFO     epoch complete!
2024-09-01 17:16:21 INFO     evaluating now!
2024-09-01 17:16:21 INFO     Epoch [10/200] train_loss: 5.9550, val_loss: 6.1827, lr: 0.003000, 5.22s
2024-09-01 17:16:21 INFO     Saved model at 10
2024-09-01 17:16:21 INFO     Val loss decrease from 6.3705 to 6.1827, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-01 17:16:26 INFO     epoch complete!
2024-09-01 17:16:26 INFO     evaluating now!
2024-09-01 17:16:26 INFO     Epoch [11/200] train_loss: 5.9074, val_loss: 6.0340, lr: 0.003000, 5.15s
2024-09-01 17:16:26 INFO     Saved model at 11
2024-09-01 17:16:26 INFO     Val loss decrease from 6.1827 to 6.0340, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-01 17:16:31 INFO     epoch complete!
2024-09-01 17:16:31 INFO     evaluating now!
2024-09-01 17:16:31 INFO     Epoch [12/200] train_loss: 5.7219, val_loss: 6.1558, lr: 0.003000, 5.16s
2024-09-01 17:16:36 INFO     epoch complete!
2024-09-01 17:16:36 INFO     evaluating now!
2024-09-01 17:16:37 INFO     Epoch [13/200] train_loss: 5.6273, val_loss: 5.7792, lr: 0.003000, 5.32s
2024-09-01 17:16:37 INFO     Saved model at 13
2024-09-01 17:16:37 INFO     Val loss decrease from 6.0340 to 5.7792, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-01 17:16:42 INFO     epoch complete!
2024-09-01 17:16:42 INFO     evaluating now!
2024-09-01 17:16:42 INFO     Epoch [14/200] train_loss: 5.4530, val_loss: 5.6981, lr: 0.003000, 5.29s
2024-09-01 17:16:42 INFO     Saved model at 14
2024-09-01 17:16:42 INFO     Val loss decrease from 5.7792 to 5.6981, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-01 17:16:47 INFO     epoch complete!
2024-09-01 17:16:47 INFO     evaluating now!
2024-09-01 17:16:47 INFO     Epoch [15/200] train_loss: 5.3094, val_loss: 5.5420, lr: 0.003000, 5.19s
2024-09-01 17:16:47 INFO     Saved model at 15
2024-09-01 17:16:47 INFO     Val loss decrease from 5.6981 to 5.5420, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-01 17:16:52 INFO     epoch complete!
2024-09-01 17:16:52 INFO     evaluating now!
2024-09-01 17:16:52 INFO     Epoch [16/200] train_loss: 5.2343, val_loss: 5.4420, lr: 0.003000, 5.25s
2024-09-01 17:16:52 INFO     Saved model at 16
2024-09-01 17:16:52 INFO     Val loss decrease from 5.5420 to 5.4420, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-01 17:16:57 INFO     epoch complete!
2024-09-01 17:16:57 INFO     evaluating now!
2024-09-01 17:16:58 INFO     Epoch [17/200] train_loss: 5.2284, val_loss: 5.5520, lr: 0.003000, 5.22s
2024-09-01 17:17:03 INFO     epoch complete!
2024-09-01 17:17:03 INFO     evaluating now!
2024-09-01 17:17:03 INFO     Epoch [18/200] train_loss: 5.1141, val_loss: 5.5876, lr: 0.003000, 5.22s
2024-09-01 17:17:08 INFO     epoch complete!
2024-09-01 17:17:08 INFO     evaluating now!
2024-09-01 17:17:08 INFO     Epoch [19/200] train_loss: 5.1004, val_loss: 5.3648, lr: 0.003000, 5.22s
2024-09-01 17:17:08 INFO     Saved model at 19
2024-09-01 17:17:08 INFO     Val loss decrease from 5.4420 to 5.3648, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-01 17:17:13 INFO     epoch complete!
2024-09-01 17:17:13 INFO     evaluating now!
2024-09-01 17:17:13 INFO     Epoch [20/200] train_loss: 4.8979, val_loss: 5.3781, lr: 0.003000, 5.27s
2024-09-01 17:17:18 INFO     epoch complete!
2024-09-01 17:17:18 INFO     evaluating now!
2024-09-01 17:17:19 INFO     Epoch [21/200] train_loss: 4.8590, val_loss: 5.5364, lr: 0.003000, 5.23s
2024-09-01 17:17:24 INFO     epoch complete!
2024-09-01 17:17:24 INFO     evaluating now!
2024-09-01 17:17:24 INFO     Epoch [22/200] train_loss: 4.8540, val_loss: 5.4568, lr: 0.003000, 5.30s
2024-09-01 17:17:29 INFO     epoch complete!
2024-09-01 17:17:29 INFO     evaluating now!
2024-09-01 17:17:29 INFO     Epoch [23/200] train_loss: 4.7352, val_loss: 5.5436, lr: 0.003000, 5.20s
2024-09-01 17:17:34 INFO     epoch complete!
2024-09-01 17:17:34 INFO     evaluating now!
2024-09-01 17:17:34 INFO     Epoch [24/200] train_loss: 4.7082, val_loss: 5.2944, lr: 0.003000, 5.21s
2024-09-01 17:17:34 INFO     Saved model at 24
2024-09-01 17:17:34 INFO     Val loss decrease from 5.3648 to 5.2944, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-01 17:17:39 INFO     epoch complete!
2024-09-01 17:17:39 INFO     evaluating now!
2024-09-01 17:17:39 INFO     Epoch [25/200] train_loss: 4.5942, val_loss: 5.1390, lr: 0.003000, 5.20s
2024-09-01 17:17:40 INFO     Saved model at 25
2024-09-01 17:17:40 INFO     Val loss decrease from 5.2944 to 5.1390, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-01 17:17:44 INFO     epoch complete!
2024-09-01 17:17:44 INFO     evaluating now!
2024-09-01 17:17:45 INFO     Epoch [26/200] train_loss: 4.5527, val_loss: 5.2596, lr: 0.003000, 5.20s
2024-09-01 17:17:50 INFO     epoch complete!
2024-09-01 17:17:50 INFO     evaluating now!
2024-09-01 17:17:50 INFO     Epoch [27/200] train_loss: 4.5057, val_loss: 5.2413, lr: 0.003000, 5.13s
2024-09-01 17:17:55 INFO     epoch complete!
2024-09-01 17:17:55 INFO     evaluating now!
2024-09-01 17:17:55 INFO     Epoch [28/200] train_loss: 4.4785, val_loss: 5.1950, lr: 0.003000, 5.14s
2024-09-01 17:18:00 INFO     epoch complete!
2024-09-01 17:18:00 INFO     evaluating now!
2024-09-01 17:18:00 INFO     Epoch [29/200] train_loss: 4.5731, val_loss: 5.2028, lr: 0.003000, 5.13s
2024-09-01 17:18:05 INFO     epoch complete!
2024-09-01 17:18:05 INFO     evaluating now!
2024-09-01 17:18:05 INFO     Epoch [30/200] train_loss: 4.4711, val_loss: 5.2666, lr: 0.003000, 5.16s
2024-09-01 17:18:10 INFO     epoch complete!
2024-09-01 17:18:10 INFO     evaluating now!
2024-09-01 17:18:10 INFO     Epoch [31/200] train_loss: 4.3545, val_loss: 5.1885, lr: 0.003000, 5.15s
2024-09-01 17:18:15 INFO     epoch complete!
2024-09-01 17:18:15 INFO     evaluating now!
2024-09-01 17:18:16 INFO     Epoch [32/200] train_loss: 4.3073, val_loss: 5.1682, lr: 0.003000, 5.18s
2024-09-01 17:18:20 INFO     epoch complete!
2024-09-01 17:18:20 INFO     evaluating now!
2024-09-01 17:18:21 INFO     Epoch [33/200] train_loss: 4.3255, val_loss: 5.1639, lr: 0.003000, 5.14s
2024-09-01 17:18:26 INFO     epoch complete!
2024-09-01 17:18:26 INFO     evaluating now!
2024-09-01 17:18:26 INFO     Epoch [34/200] train_loss: 4.3192, val_loss: 5.1777, lr: 0.003000, 5.18s
2024-09-01 17:18:31 INFO     epoch complete!
2024-09-01 17:18:31 INFO     evaluating now!
2024-09-01 17:18:31 INFO     Epoch [35/200] train_loss: 4.2024, val_loss: 5.1093, lr: 0.003000, 5.17s
2024-09-01 17:18:31 INFO     Saved model at 35
2024-09-01 17:18:31 INFO     Val loss decrease from 5.1390 to 5.1093, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-01 17:18:36 INFO     epoch complete!
2024-09-01 17:18:36 INFO     evaluating now!
2024-09-01 17:18:36 INFO     Epoch [36/200] train_loss: 4.1942, val_loss: 5.2290, lr: 0.003000, 5.13s
2024-09-01 17:18:41 INFO     epoch complete!
2024-09-01 17:18:41 INFO     evaluating now!
2024-09-01 17:18:41 INFO     Epoch [37/200] train_loss: 4.2055, val_loss: 5.1909, lr: 0.003000, 5.18s
2024-09-01 17:18:46 INFO     epoch complete!
2024-09-01 17:18:46 INFO     evaluating now!
2024-09-01 17:18:47 INFO     Epoch [38/200] train_loss: 4.1007, val_loss: 5.1925, lr: 0.003000, 5.13s
2024-09-01 17:18:51 INFO     epoch complete!
2024-09-01 17:18:51 INFO     evaluating now!
2024-09-01 17:18:52 INFO     Epoch [39/200] train_loss: 4.1633, val_loss: 5.2357, lr: 0.003000, 5.12s
2024-09-01 17:18:56 INFO     epoch complete!
2024-09-01 17:18:56 INFO     evaluating now!
2024-09-01 17:18:57 INFO     Epoch [40/200] train_loss: 4.1157, val_loss: 5.0503, lr: 0.003000, 5.16s
2024-09-01 17:18:57 INFO     Saved model at 40
2024-09-01 17:18:57 INFO     Val loss decrease from 5.1093 to 5.0503, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-09-01 17:19:02 INFO     epoch complete!
2024-09-01 17:19:02 INFO     evaluating now!
2024-09-01 17:19:02 INFO     Epoch [41/200] train_loss: 4.0633, val_loss: 5.0529, lr: 0.003000, 5.13s
2024-09-01 17:19:07 INFO     epoch complete!
2024-09-01 17:19:07 INFO     evaluating now!
2024-09-01 17:19:07 INFO     Epoch [42/200] train_loss: 3.9960, val_loss: 5.1911, lr: 0.003000, 5.15s
2024-09-01 17:19:12 INFO     epoch complete!
2024-09-01 17:19:12 INFO     evaluating now!
2024-09-01 17:19:12 INFO     Epoch [43/200] train_loss: 3.9992, val_loss: 5.1171, lr: 0.003000, 5.18s
2024-09-01 17:19:17 INFO     epoch complete!
2024-09-01 17:19:17 INFO     evaluating now!
2024-09-01 17:19:17 INFO     Epoch [44/200] train_loss: 3.9936, val_loss: 5.2093, lr: 0.003000, 5.14s
2024-09-01 17:19:22 INFO     epoch complete!
2024-09-01 17:19:22 INFO     evaluating now!
2024-09-01 17:19:23 INFO     Epoch [45/200] train_loss: 3.9418, val_loss: 5.0796, lr: 0.003000, 5.18s
2024-09-01 17:19:27 INFO     epoch complete!
2024-09-01 17:19:27 INFO     evaluating now!
2024-09-01 17:19:28 INFO     Epoch [46/200] train_loss: 3.9042, val_loss: 5.1230, lr: 0.003000, 5.15s
2024-09-01 17:19:33 INFO     epoch complete!
2024-09-01 17:19:33 INFO     evaluating now!
2024-09-01 17:19:33 INFO     Epoch [47/200] train_loss: 3.8812, val_loss: 5.1341, lr: 0.003000, 5.13s
2024-09-01 17:19:38 INFO     epoch complete!
2024-09-01 17:19:38 INFO     evaluating now!
2024-09-01 17:19:38 INFO     Epoch [48/200] train_loss: 3.8533, val_loss: 4.9836, lr: 0.003000, 5.15s
2024-09-01 17:19:38 INFO     Saved model at 48
2024-09-01 17:19:38 INFO     Val loss decrease from 5.0503 to 4.9836, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-09-01 17:19:43 INFO     epoch complete!
2024-09-01 17:19:43 INFO     evaluating now!
2024-09-01 17:19:43 INFO     Epoch [49/200] train_loss: 3.8498, val_loss: 5.1315, lr: 0.003000, 5.17s
2024-09-01 17:19:48 INFO     epoch complete!
2024-09-01 17:19:48 INFO     evaluating now!
2024-09-01 17:19:48 INFO     Epoch [50/200] train_loss: 3.8895, val_loss: 5.0064, lr: 0.003000, 5.11s
2024-09-01 17:19:53 INFO     epoch complete!
2024-09-01 17:19:53 INFO     evaluating now!
2024-09-01 17:19:54 INFO     Epoch [51/200] train_loss: 3.8310, val_loss: 5.0668, lr: 0.003000, 5.14s
2024-09-01 17:19:58 INFO     epoch complete!
2024-09-01 17:19:58 INFO     evaluating now!
2024-09-01 17:19:59 INFO     Epoch [52/200] train_loss: 3.7591, val_loss: 5.1797, lr: 0.003000, 5.17s
2024-09-01 17:20:04 INFO     epoch complete!
2024-09-01 17:20:04 INFO     evaluating now!
2024-09-01 17:20:04 INFO     Epoch [53/200] train_loss: 3.7764, val_loss: 5.0350, lr: 0.003000, 5.17s
2024-09-01 17:20:09 INFO     epoch complete!
2024-09-01 17:20:09 INFO     evaluating now!
2024-09-01 17:20:09 INFO     Epoch [54/200] train_loss: 3.7261, val_loss: 5.0901, lr: 0.003000, 5.15s
2024-09-01 17:20:14 INFO     epoch complete!
2024-09-01 17:20:14 INFO     evaluating now!
2024-09-01 17:20:14 INFO     Epoch [55/200] train_loss: 3.7313, val_loss: 5.2506, lr: 0.003000, 5.13s
2024-09-01 17:20:19 INFO     epoch complete!
2024-09-01 17:20:19 INFO     evaluating now!
2024-09-01 17:20:19 INFO     Epoch [56/200] train_loss: 3.7266, val_loss: 5.1682, lr: 0.003000, 5.13s
2024-09-01 17:20:24 INFO     epoch complete!
2024-09-01 17:20:24 INFO     evaluating now!
2024-09-01 17:20:24 INFO     Epoch [57/200] train_loss: 3.7252, val_loss: 5.0602, lr: 0.003000, 5.14s
2024-09-01 17:20:29 INFO     epoch complete!
2024-09-01 17:20:29 INFO     evaluating now!
2024-09-01 17:20:30 INFO     Epoch [58/200] train_loss: 3.6765, val_loss: 5.0810, lr: 0.003000, 5.14s
2024-09-01 17:20:34 INFO     epoch complete!
2024-09-01 17:20:34 INFO     evaluating now!
2024-09-01 17:20:35 INFO     Epoch [59/200] train_loss: 3.6267, val_loss: 5.0664, lr: 0.003000, 5.12s
2024-09-01 17:20:39 INFO     epoch complete!
2024-09-01 17:20:39 INFO     evaluating now!
2024-09-01 17:20:40 INFO     Epoch [60/200] train_loss: 3.6610, val_loss: 4.8976, lr: 0.003000, 5.13s
2024-09-01 17:20:40 INFO     Saved model at 60
2024-09-01 17:20:40 INFO     Val loss decrease from 4.9836 to 4.8976, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch60.tar
2024-09-01 17:20:45 INFO     epoch complete!
2024-09-01 17:20:45 INFO     evaluating now!
2024-09-01 17:20:45 INFO     Epoch [61/200] train_loss: 3.6546, val_loss: 5.0434, lr: 0.003000, 5.14s
2024-09-01 17:20:50 INFO     epoch complete!
2024-09-01 17:20:50 INFO     evaluating now!
2024-09-01 17:20:50 INFO     Epoch [62/200] train_loss: 3.6136, val_loss: 4.9780, lr: 0.003000, 5.14s
2024-09-01 17:20:55 INFO     epoch complete!
2024-09-01 17:20:55 INFO     evaluating now!
2024-09-01 17:20:55 INFO     Epoch [63/200] train_loss: 3.5938, val_loss: 5.0007, lr: 0.003000, 5.18s
2024-09-01 17:21:00 INFO     epoch complete!
2024-09-01 17:21:00 INFO     evaluating now!
2024-09-01 17:21:00 INFO     Epoch [64/200] train_loss: 3.6093, val_loss: 5.0727, lr: 0.003000, 5.15s
2024-09-01 17:21:05 INFO     epoch complete!
2024-09-01 17:21:05 INFO     evaluating now!
2024-09-01 17:21:06 INFO     Epoch [65/200] train_loss: 3.5976, val_loss: 5.0453, lr: 0.003000, 5.13s
2024-09-01 17:21:10 INFO     epoch complete!
2024-09-01 17:21:10 INFO     evaluating now!
2024-09-01 17:21:11 INFO     Epoch [66/200] train_loss: 3.5545, val_loss: 5.0584, lr: 0.003000, 5.13s
2024-09-01 17:21:15 INFO     epoch complete!
2024-09-01 17:21:15 INFO     evaluating now!
2024-09-01 17:21:16 INFO     Epoch [67/200] train_loss: 3.5542, val_loss: 5.0775, lr: 0.003000, 5.12s
2024-09-01 17:21:21 INFO     epoch complete!
2024-09-01 17:21:21 INFO     evaluating now!
2024-09-01 17:21:21 INFO     Epoch [68/200] train_loss: 3.5150, val_loss: 5.1724, lr: 0.003000, 5.15s
2024-09-01 17:21:26 INFO     epoch complete!
2024-09-01 17:21:26 INFO     evaluating now!
2024-09-01 17:21:26 INFO     Epoch [69/200] train_loss: 3.5142, val_loss: 5.0864, lr: 0.003000, 5.16s
2024-09-01 17:21:31 INFO     epoch complete!
2024-09-01 17:21:31 INFO     evaluating now!
2024-09-01 17:21:31 INFO     Epoch [70/200] train_loss: 3.4931, val_loss: 4.9490, lr: 0.003000, 5.17s
2024-09-01 17:21:36 INFO     epoch complete!
2024-09-01 17:21:36 INFO     evaluating now!
2024-09-01 17:21:36 INFO     Epoch [71/200] train_loss: 3.4624, val_loss: 4.9872, lr: 0.003000, 5.15s
2024-09-01 17:21:41 INFO     epoch complete!
2024-09-01 17:21:41 INFO     evaluating now!
2024-09-01 17:21:42 INFO     Epoch [72/200] train_loss: 3.4692, val_loss: 5.0663, lr: 0.003000, 5.11s
2024-09-01 17:21:46 INFO     epoch complete!
2024-09-01 17:21:46 INFO     evaluating now!
2024-09-01 17:21:47 INFO     Epoch [73/200] train_loss: 3.4350, val_loss: 5.0523, lr: 0.003000, 5.12s
2024-09-01 17:21:51 INFO     epoch complete!
2024-09-01 17:21:51 INFO     evaluating now!
2024-09-01 17:21:52 INFO     Epoch [74/200] train_loss: 3.5447, val_loss: 4.9827, lr: 0.003000, 5.09s
2024-09-01 17:21:57 INFO     epoch complete!
2024-09-01 17:21:57 INFO     evaluating now!
2024-09-01 17:21:57 INFO     Epoch [75/200] train_loss: 3.4407, val_loss: 5.0589, lr: 0.003000, 5.11s
2024-09-01 17:21:57 WARNING  Early stopping at epoch: 75
2024-09-01 17:21:57 INFO     Trained totally 76 epochs, average train time is 4.853s, average eval time is 0.313s
2024-09-01 17:21:57 INFO     Loaded model at 60
2024-09-01 17:21:57 INFO     Saved model at ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406.m
2024-09-01 17:21:57 INFO     Start evaluating ...
2024-09-01 17:21:58 INFO     Note that you select the single mode to evaluate!
2024-09-01 17:21:58 INFO     Evaluate result is saved at ./libcity/cache/45/evaluate_cache\2024_09_01_17_21_58_AGCRN_CHITaxi20190406.csv
2024-09-01 17:21:58 INFO     
         MAE       RMSE
1   2.510859   7.495862
2   2.590270   7.890850
3   2.755959   8.514392
4   2.787943   9.111768
5   2.923042   9.789772
6   3.057347  10.693719
7   3.119189  11.594008
8   3.315965  12.304262
9   3.348708  12.927190
10  3.412591  13.163189
11  3.498014  13.438804
12  3.609588  14.115497
2024-09-01 17:21:58 INFO     ----------------------------------------------------------------------------
2024-09-01 17:21:58 INFO     # 4, Kownledge Graph Embedding: AttE, Experiment ids: 49
2024-09-01 17:21:58 INFO     ----------------------------------------------------------------------------
2024-09-01 17:21:58 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=45
2024-09-01 17:21:58 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 45, 'embedding_model': 'AttE', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-01 17:21:58 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-01 17:21:58 INFO     set_weight_link_or_dist: dist
2024-09-01 17:21:58 INFO     init_weight_inf_or_zero: inf
2024-09-01 17:21:58 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-01 17:21:58 INFO     Start Calculate the weight by Gauss kernel!
2024-09-01 17:21:58 INFO     Loading file CHITaxi20190406.dyna
2024-09-01 17:21:58 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-01 17:22:00 INFO     Dataset created
2024-09-01 17:22:00 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-01 17:22:00 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-01 17:22:00 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-01 17:22:00 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-01 17:22:00 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-01 17:22:00 INFO     NormalScaler max: 1.4853242543142366
2024-09-01 17:22:02 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-01 17:22:02 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-01 17:22:02 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-01 17:22:02 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 17:22:02 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-01 17:22:02 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 17:22:02 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-01 17:22:02 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-01 17:22:02 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-01 17:22:02 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-01 17:22:02 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-01 17:22:02 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-01 17:22:02 INFO     Total parameter numbers: 874010
2024-09-01 17:22:02 INFO     You select `adam` optimizer.
2024-09-01 17:22:02 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-01 17:22:02 INFO     Start training ...
2024-09-01 17:22:02 INFO     num_batches:48
2024-09-01 17:22:07 INFO     epoch complete!
2024-09-01 17:22:07 INFO     evaluating now!
2024-09-01 17:22:08 INFO     Epoch [0/200] train_loss: 24.3407, val_loss: 18.6552, lr: 0.003000, 5.39s
2024-09-01 17:22:08 INFO     Saved model at 0
2024-09-01 17:22:08 INFO     Val loss decrease from inf to 18.6552, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-01 17:22:13 INFO     epoch complete!
2024-09-01 17:22:13 INFO     evaluating now!
2024-09-01 17:22:13 INFO     Epoch [1/200] train_loss: 15.1952, val_loss: 14.8504, lr: 0.003000, 5.11s
2024-09-01 17:22:13 INFO     Saved model at 1
2024-09-01 17:22:13 INFO     Val loss decrease from 18.6552 to 14.8504, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-01 17:22:18 INFO     epoch complete!
2024-09-01 17:22:18 INFO     evaluating now!
2024-09-01 17:22:18 INFO     Epoch [2/200] train_loss: 12.3318, val_loss: 11.8501, lr: 0.003000, 5.09s
2024-09-01 17:22:18 INFO     Saved model at 2
2024-09-01 17:22:18 INFO     Val loss decrease from 14.8504 to 11.8501, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-01 17:22:23 INFO     epoch complete!
2024-09-01 17:22:23 INFO     evaluating now!
2024-09-01 17:22:23 INFO     Epoch [3/200] train_loss: 10.2647, val_loss: 9.8781, lr: 0.003000, 5.09s
2024-09-01 17:22:23 INFO     Saved model at 3
2024-09-01 17:22:23 INFO     Val loss decrease from 11.8501 to 9.8781, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-01 17:22:28 INFO     epoch complete!
2024-09-01 17:22:28 INFO     evaluating now!
2024-09-01 17:22:28 INFO     Epoch [4/200] train_loss: 8.5851, val_loss: 8.5104, lr: 0.003000, 5.15s
2024-09-01 17:22:28 INFO     Saved model at 4
2024-09-01 17:22:28 INFO     Val loss decrease from 9.8781 to 8.5104, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-01 17:22:33 INFO     epoch complete!
2024-09-01 17:22:33 INFO     evaluating now!
2024-09-01 17:22:33 INFO     Epoch [5/200] train_loss: 7.5963, val_loss: 7.3290, lr: 0.003000, 5.11s
2024-09-01 17:22:33 INFO     Saved model at 5
2024-09-01 17:22:33 INFO     Val loss decrease from 8.5104 to 7.3290, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-01 17:22:38 INFO     epoch complete!
2024-09-01 17:22:38 INFO     evaluating now!
2024-09-01 17:22:39 INFO     Epoch [6/200] train_loss: 6.9993, val_loss: 6.9052, lr: 0.003000, 5.14s
2024-09-01 17:22:39 INFO     Saved model at 6
2024-09-01 17:22:39 INFO     Val loss decrease from 7.3290 to 6.9052, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-01 17:22:43 INFO     epoch complete!
2024-09-01 17:22:43 INFO     evaluating now!
2024-09-01 17:22:44 INFO     Epoch [7/200] train_loss: 6.6702, val_loss: 6.6570, lr: 0.003000, 5.12s
2024-09-01 17:22:44 INFO     Saved model at 7
2024-09-01 17:22:44 INFO     Val loss decrease from 6.9052 to 6.6570, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-01 17:22:48 INFO     epoch complete!
2024-09-01 17:22:48 INFO     evaluating now!
2024-09-01 17:22:49 INFO     Epoch [8/200] train_loss: 6.1588, val_loss: 6.5046, lr: 0.003000, 5.09s
2024-09-01 17:22:49 INFO     Saved model at 8
2024-09-01 17:22:49 INFO     Val loss decrease from 6.6570 to 6.5046, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-01 17:22:54 INFO     epoch complete!
2024-09-01 17:22:54 INFO     evaluating now!
2024-09-01 17:22:54 INFO     Epoch [9/200] train_loss: 6.1981, val_loss: 6.1910, lr: 0.003000, 5.15s
2024-09-01 17:22:54 INFO     Saved model at 9
2024-09-01 17:22:54 INFO     Val loss decrease from 6.5046 to 6.1910, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-01 17:22:59 INFO     epoch complete!
2024-09-01 17:22:59 INFO     evaluating now!
2024-09-01 17:22:59 INFO     Epoch [10/200] train_loss: 5.8105, val_loss: 5.9722, lr: 0.003000, 5.15s
2024-09-01 17:22:59 INFO     Saved model at 10
2024-09-01 17:22:59 INFO     Val loss decrease from 6.1910 to 5.9722, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-01 17:23:04 INFO     epoch complete!
2024-09-01 17:23:04 INFO     evaluating now!
2024-09-01 17:23:04 INFO     Epoch [11/200] train_loss: 5.7148, val_loss: 6.0309, lr: 0.003000, 5.09s
2024-09-01 17:23:09 INFO     epoch complete!
2024-09-01 17:23:09 INFO     evaluating now!
2024-09-01 17:23:09 INFO     Epoch [12/200] train_loss: 5.5559, val_loss: 6.0437, lr: 0.003000, 5.08s
2024-09-01 17:23:14 INFO     epoch complete!
2024-09-01 17:23:14 INFO     evaluating now!
2024-09-01 17:23:14 INFO     Epoch [13/200] train_loss: 5.4255, val_loss: 5.8130, lr: 0.003000, 5.10s
2024-09-01 17:23:14 INFO     Saved model at 13
2024-09-01 17:23:14 INFO     Val loss decrease from 5.9722 to 5.8130, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-01 17:23:19 INFO     epoch complete!
2024-09-01 17:23:19 INFO     evaluating now!
2024-09-01 17:23:20 INFO     Epoch [14/200] train_loss: 5.3295, val_loss: 5.6833, lr: 0.003000, 5.13s
2024-09-01 17:23:20 INFO     Saved model at 14
2024-09-01 17:23:20 INFO     Val loss decrease from 5.8130 to 5.6833, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-01 17:23:24 INFO     epoch complete!
2024-09-01 17:23:24 INFO     evaluating now!
2024-09-01 17:23:25 INFO     Epoch [15/200] train_loss: 5.1992, val_loss: 5.8537, lr: 0.003000, 5.19s
2024-09-01 17:23:30 INFO     epoch complete!
2024-09-01 17:23:30 INFO     evaluating now!
2024-09-01 17:23:30 INFO     Epoch [16/200] train_loss: 5.0427, val_loss: 5.7202, lr: 0.003000, 5.15s
2024-09-01 17:23:35 INFO     epoch complete!
2024-09-01 17:23:35 INFO     evaluating now!
2024-09-01 17:23:35 INFO     Epoch [17/200] train_loss: 5.1392, val_loss: 5.6221, lr: 0.003000, 5.17s
2024-09-01 17:23:35 INFO     Saved model at 17
2024-09-01 17:23:35 INFO     Val loss decrease from 5.6833 to 5.6221, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-01 17:23:40 INFO     epoch complete!
2024-09-01 17:23:40 INFO     evaluating now!
2024-09-01 17:23:40 INFO     Epoch [18/200] train_loss: 5.1718, val_loss: 5.7509, lr: 0.003000, 5.12s
2024-09-01 17:23:45 INFO     epoch complete!
2024-09-01 17:23:45 INFO     evaluating now!
2024-09-01 17:23:45 INFO     Epoch [19/200] train_loss: 4.9242, val_loss: 5.5183, lr: 0.003000, 5.13s
2024-09-01 17:23:45 INFO     Saved model at 19
2024-09-01 17:23:45 INFO     Val loss decrease from 5.6221 to 5.5183, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-01 17:23:50 INFO     epoch complete!
2024-09-01 17:23:50 INFO     evaluating now!
2024-09-01 17:23:50 INFO     Epoch [20/200] train_loss: 4.8183, val_loss: 5.4300, lr: 0.003000, 5.11s
2024-09-01 17:23:50 INFO     Saved model at 20
2024-09-01 17:23:50 INFO     Val loss decrease from 5.5183 to 5.4300, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-01 17:23:55 INFO     epoch complete!
2024-09-01 17:23:55 INFO     evaluating now!
2024-09-01 17:23:56 INFO     Epoch [21/200] train_loss: 4.7846, val_loss: 5.3270, lr: 0.003000, 5.12s
2024-09-01 17:23:56 INFO     Saved model at 21
2024-09-01 17:23:56 INFO     Val loss decrease from 5.4300 to 5.3270, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-01 17:24:00 INFO     epoch complete!
2024-09-01 17:24:00 INFO     evaluating now!
2024-09-01 17:24:01 INFO     Epoch [22/200] train_loss: 4.7692, val_loss: 5.3862, lr: 0.003000, 5.12s
2024-09-01 17:24:06 INFO     epoch complete!
2024-09-01 17:24:06 INFO     evaluating now!
2024-09-01 17:24:06 INFO     Epoch [23/200] train_loss: 4.6726, val_loss: 5.3273, lr: 0.003000, 5.15s
2024-09-01 17:24:11 INFO     epoch complete!
2024-09-01 17:24:11 INFO     evaluating now!
2024-09-01 17:24:11 INFO     Epoch [24/200] train_loss: 4.7200, val_loss: 5.6182, lr: 0.003000, 5.20s
2024-09-01 17:24:16 INFO     epoch complete!
2024-09-01 17:24:16 INFO     evaluating now!
2024-09-01 17:24:16 INFO     Epoch [25/200] train_loss: 4.6308, val_loss: 5.3166, lr: 0.003000, 5.18s
2024-09-01 17:24:16 INFO     Saved model at 25
2024-09-01 17:24:16 INFO     Val loss decrease from 5.3270 to 5.3166, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-01 17:24:21 INFO     epoch complete!
2024-09-01 17:24:21 INFO     evaluating now!
2024-09-01 17:24:21 INFO     Epoch [26/200] train_loss: 4.5495, val_loss: 5.1374, lr: 0.003000, 5.15s
2024-09-01 17:24:21 INFO     Saved model at 26
2024-09-01 17:24:21 INFO     Val loss decrease from 5.3166 to 5.1374, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-01 17:24:26 INFO     epoch complete!
2024-09-01 17:24:26 INFO     evaluating now!
2024-09-01 17:24:27 INFO     Epoch [27/200] train_loss: 4.4837, val_loss: 5.2351, lr: 0.003000, 5.12s
2024-09-01 17:24:31 INFO     epoch complete!
2024-09-01 17:24:31 INFO     evaluating now!
2024-09-01 17:24:32 INFO     Epoch [28/200] train_loss: 4.4261, val_loss: 5.1600, lr: 0.003000, 5.13s
2024-09-01 17:24:36 INFO     epoch complete!
2024-09-01 17:24:36 INFO     evaluating now!
2024-09-01 17:24:37 INFO     Epoch [29/200] train_loss: 4.3943, val_loss: 5.1706, lr: 0.003000, 5.11s
2024-09-01 17:24:42 INFO     epoch complete!
2024-09-01 17:24:42 INFO     evaluating now!
2024-09-01 17:24:42 INFO     Epoch [30/200] train_loss: 4.2992, val_loss: 5.1633, lr: 0.003000, 5.14s
2024-09-01 17:24:47 INFO     epoch complete!
2024-09-01 17:24:47 INFO     evaluating now!
2024-09-01 17:24:47 INFO     Epoch [31/200] train_loss: 4.4067, val_loss: 5.6397, lr: 0.003000, 5.13s
2024-09-01 17:24:52 INFO     epoch complete!
2024-09-01 17:24:52 INFO     evaluating now!
2024-09-01 17:24:52 INFO     Epoch [32/200] train_loss: 4.3134, val_loss: 5.2866, lr: 0.003000, 5.17s
2024-09-01 17:24:57 INFO     epoch complete!
2024-09-01 17:24:57 INFO     evaluating now!
2024-09-01 17:24:58 INFO     Epoch [33/200] train_loss: 4.1901, val_loss: 5.1415, lr: 0.003000, 5.32s
2024-09-01 17:25:02 INFO     epoch complete!
2024-09-01 17:25:02 INFO     evaluating now!
2024-09-01 17:25:03 INFO     Epoch [34/200] train_loss: 4.1840, val_loss: 5.2712, lr: 0.003000, 5.27s
2024-09-01 17:25:08 INFO     epoch complete!
2024-09-01 17:25:08 INFO     evaluating now!
2024-09-01 17:25:08 INFO     Epoch [35/200] train_loss: 4.1898, val_loss: 5.2200, lr: 0.003000, 5.13s
2024-09-01 17:25:13 INFO     epoch complete!
2024-09-01 17:25:13 INFO     evaluating now!
2024-09-01 17:25:13 INFO     Epoch [36/200] train_loss: 4.1815, val_loss: 5.1234, lr: 0.003000, 5.11s
2024-09-01 17:25:13 INFO     Saved model at 36
2024-09-01 17:25:13 INFO     Val loss decrease from 5.1374 to 5.1234, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-09-01 17:25:18 INFO     epoch complete!
2024-09-01 17:25:18 INFO     evaluating now!
2024-09-01 17:25:18 INFO     Epoch [37/200] train_loss: 4.0874, val_loss: 5.1023, lr: 0.003000, 5.11s
2024-09-01 17:25:18 INFO     Saved model at 37
2024-09-01 17:25:18 INFO     Val loss decrease from 5.1234 to 5.1023, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-09-01 17:25:23 INFO     epoch complete!
2024-09-01 17:25:23 INFO     evaluating now!
2024-09-01 17:25:23 INFO     Epoch [38/200] train_loss: 4.1471, val_loss: 5.0400, lr: 0.003000, 5.09s
2024-09-01 17:25:23 INFO     Saved model at 38
2024-09-01 17:25:23 INFO     Val loss decrease from 5.1023 to 5.0400, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-09-01 17:25:28 INFO     epoch complete!
2024-09-01 17:25:28 INFO     evaluating now!
2024-09-01 17:25:28 INFO     Epoch [39/200] train_loss: 4.0553, val_loss: 5.1006, lr: 0.003000, 5.11s
2024-09-01 17:25:33 INFO     epoch complete!
2024-09-01 17:25:33 INFO     evaluating now!
2024-09-01 17:25:33 INFO     Epoch [40/200] train_loss: 4.0588, val_loss: 5.0851, lr: 0.003000, 5.11s
2024-09-01 17:25:38 INFO     epoch complete!
2024-09-01 17:25:38 INFO     evaluating now!
2024-09-01 17:25:39 INFO     Epoch [41/200] train_loss: 3.9757, val_loss: 5.2713, lr: 0.003000, 5.11s
2024-09-01 17:25:43 INFO     epoch complete!
2024-09-01 17:25:43 INFO     evaluating now!
2024-09-01 17:25:44 INFO     Epoch [42/200] train_loss: 3.9427, val_loss: 5.2245, lr: 0.003000, 5.12s
2024-09-01 17:25:49 INFO     epoch complete!
2024-09-01 17:25:49 INFO     evaluating now!
2024-09-01 17:25:49 INFO     Epoch [43/200] train_loss: 3.9755, val_loss: 5.1222, lr: 0.003000, 5.12s
2024-09-01 17:25:54 INFO     epoch complete!
2024-09-01 17:25:54 INFO     evaluating now!
2024-09-01 17:25:54 INFO     Epoch [44/200] train_loss: 3.9603, val_loss: 5.3533, lr: 0.003000, 5.14s
2024-09-01 17:25:59 INFO     epoch complete!
2024-09-01 17:25:59 INFO     evaluating now!
2024-09-01 17:25:59 INFO     Epoch [45/200] train_loss: 3.9050, val_loss: 5.1619, lr: 0.003000, 5.14s
2024-09-01 17:26:04 INFO     epoch complete!
2024-09-01 17:26:04 INFO     evaluating now!
2024-09-01 17:26:04 INFO     Epoch [46/200] train_loss: 3.9062, val_loss: 5.1189, lr: 0.003000, 5.11s
2024-09-01 17:26:09 INFO     epoch complete!
2024-09-01 17:26:09 INFO     evaluating now!
2024-09-01 17:26:09 INFO     Epoch [47/200] train_loss: 3.9298, val_loss: 5.0487, lr: 0.003000, 5.12s
2024-09-01 17:26:14 INFO     epoch complete!
2024-09-01 17:26:14 INFO     evaluating now!
2024-09-01 17:26:14 INFO     Epoch [48/200] train_loss: 3.7996, val_loss: 5.1481, lr: 0.003000, 5.11s
2024-09-01 17:26:19 INFO     epoch complete!
2024-09-01 17:26:19 INFO     evaluating now!
2024-09-01 17:26:20 INFO     Epoch [49/200] train_loss: 3.7933, val_loss: 5.0715, lr: 0.003000, 5.11s
2024-09-01 17:26:24 INFO     epoch complete!
2024-09-01 17:26:24 INFO     evaluating now!
2024-09-01 17:26:25 INFO     Epoch [50/200] train_loss: 3.7419, val_loss: 5.0686, lr: 0.003000, 5.12s
2024-09-01 17:26:29 INFO     epoch complete!
2024-09-01 17:26:29 INFO     evaluating now!
2024-09-01 17:26:30 INFO     Epoch [51/200] train_loss: 3.7646, val_loss: 4.9938, lr: 0.003000, 5.12s
2024-09-01 17:26:30 INFO     Saved model at 51
2024-09-01 17:26:30 INFO     Val loss decrease from 5.0400 to 4.9938, saving to ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-09-01 17:26:35 INFO     epoch complete!
2024-09-01 17:26:35 INFO     evaluating now!
2024-09-01 17:26:35 INFO     Epoch [52/200] train_loss: 3.6971, val_loss: 5.0861, lr: 0.003000, 5.12s
2024-09-01 17:26:40 INFO     epoch complete!
2024-09-01 17:26:40 INFO     evaluating now!
2024-09-01 17:26:40 INFO     Epoch [53/200] train_loss: 3.6660, val_loss: 5.0862, lr: 0.003000, 5.10s
2024-09-01 17:26:45 INFO     epoch complete!
2024-09-01 17:26:45 INFO     evaluating now!
2024-09-01 17:26:45 INFO     Epoch [54/200] train_loss: 3.7084, val_loss: 5.1191, lr: 0.003000, 5.11s
2024-09-01 17:26:50 INFO     epoch complete!
2024-09-01 17:26:50 INFO     evaluating now!
2024-09-01 17:26:50 INFO     Epoch [55/200] train_loss: 3.6958, val_loss: 5.1058, lr: 0.003000, 5.11s
2024-09-01 17:26:55 INFO     epoch complete!
2024-09-01 17:26:55 INFO     evaluating now!
2024-09-01 17:26:55 INFO     Epoch [56/200] train_loss: 3.6794, val_loss: 5.0273, lr: 0.003000, 5.12s
2024-09-01 17:27:00 INFO     epoch complete!
2024-09-01 17:27:00 INFO     evaluating now!
2024-09-01 17:27:00 INFO     Epoch [57/200] train_loss: 3.6383, val_loss: 5.0736, lr: 0.003000, 5.11s
2024-09-01 17:27:05 INFO     epoch complete!
2024-09-01 17:27:05 INFO     evaluating now!
2024-09-01 17:27:06 INFO     Epoch [58/200] train_loss: 3.6492, val_loss: 5.0751, lr: 0.003000, 5.11s
2024-09-01 17:27:10 INFO     epoch complete!
2024-09-01 17:27:10 INFO     evaluating now!
2024-09-01 17:27:11 INFO     Epoch [59/200] train_loss: 3.5928, val_loss: 5.0931, lr: 0.003000, 5.10s
2024-09-01 17:27:15 INFO     epoch complete!
2024-09-01 17:27:15 INFO     evaluating now!
2024-09-01 17:27:16 INFO     Epoch [60/200] train_loss: 3.5944, val_loss: 5.2159, lr: 0.003000, 5.10s
2024-09-01 17:27:21 INFO     epoch complete!
2024-09-01 17:27:21 INFO     evaluating now!
2024-09-01 17:27:21 INFO     Epoch [61/200] train_loss: 3.6134, val_loss: 5.1414, lr: 0.003000, 5.11s
2024-09-01 17:27:26 INFO     epoch complete!
2024-09-01 17:27:26 INFO     evaluating now!
2024-09-01 17:27:26 INFO     Epoch [62/200] train_loss: 3.5640, val_loss: 5.0797, lr: 0.003000, 5.11s
2024-09-01 17:27:31 INFO     epoch complete!
2024-09-01 17:27:31 INFO     evaluating now!
2024-09-01 17:27:31 INFO     Epoch [63/200] train_loss: 3.5283, val_loss: 5.1001, lr: 0.003000, 5.13s
2024-09-01 17:27:36 INFO     epoch complete!
2024-09-01 17:27:36 INFO     evaluating now!
2024-09-01 17:27:36 INFO     Epoch [64/200] train_loss: 3.5089, val_loss: 5.1005, lr: 0.003000, 5.10s
2024-09-01 17:27:41 INFO     epoch complete!
2024-09-01 17:27:41 INFO     evaluating now!
2024-09-01 17:27:41 INFO     Epoch [65/200] train_loss: 3.4892, val_loss: 5.0895, lr: 0.003000, 5.14s
2024-09-01 17:27:46 INFO     epoch complete!
2024-09-01 17:27:46 INFO     evaluating now!
2024-09-01 17:27:46 INFO     Epoch [66/200] train_loss: 3.4520, val_loss: 5.0694, lr: 0.003000, 5.12s
2024-09-01 17:27:46 WARNING  Early stopping at epoch: 66
2024-09-01 17:27:46 INFO     Trained totally 67 epochs, average train time is 4.821s, average eval time is 0.310s
2024-09-01 17:27:46 INFO     Loaded model at 51
2024-09-01 17:27:46 INFO     Saved model at ./libcity/cache/45/model_cache/AGCRN_CHITaxi20190406.m
2024-09-01 17:27:47 INFO     Start evaluating ...
2024-09-01 17:27:48 INFO     Note that you select the single mode to evaluate!
2024-09-01 17:27:48 INFO     Evaluate result is saved at ./libcity/cache/45/evaluate_cache\2024_09_01_17_27_48_AGCRN_CHITaxi20190406.csv
2024-09-01 17:27:48 INFO     
         MAE       RMSE
1   2.517893   6.915917
2   2.571664   7.627888
3   2.720193   8.660733
4   2.872568   9.642041
5   3.050833  10.844482
6   3.121449  12.158846
7   3.298548  13.464670
8   3.364484  14.135612
9   3.419008  14.316025
10  3.516825  14.293526
11  3.520265  14.421273
12  3.615784  14.804366
2024-09-01 17:27:48 INFO     ----------------------------------------------------------------------------
2024-09-01 17:27:48 INFO     Kownledge Graph Embedding: AttE, Experiment ids: [45, 46, 47, 48, 49]
2024-09-01 17:27:48 INFO     ----------------------------------------------------------------------------
2024-09-01 17:27:48 INFO     Average: 
         MAE       RMSE
0   2.417931   7.266239
1   2.500726   7.743533
2   2.650299   8.680558
3   2.758324   9.430867
4   2.885796  10.263257
5   3.006431  11.117069
6   3.110696  11.952025
7   3.206509  12.532104
8   3.296324  12.956543
9   3.321733  13.170763
10  3.361096  13.491744
11  3.477506  14.110865 
2024-09-01 17:27:48 INFO     Standard deviation: 
         MAE      RMSE
0   0.080327  0.298525
1   0.068888  0.153001
2   0.081660  0.156168
3   0.069966  0.230849
4   0.094583  0.429655
5   0.072492  0.651271
6   0.109725  0.895852
7   0.111656  0.966710
8   0.077396  0.871857
9   0.121398  0.757496
10  0.125621  0.732750
11  0.123030  0.730006
2024-09-01 17:27:48 INFO     ----------------------------------------------------------------------------
2024-09-01 17:27:48 INFO     12 steps Average: 
        MAE       RMSE
0  2.999448  11.059631
2024-09-01 17:27:48 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.094729  0.572845
