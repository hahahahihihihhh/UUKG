2024-09-02 15:59:02 INFO     Saving logs in: ./logs/CHITaxi20190406\AGCRN\ExtSpace\RefH
2024-09-02 15:59:02 INFO     ----------------------------------------------------------------------------
2024-09-02 15:59:02 INFO     # 0, Kownledge Graph Embedding: RefH, Experiment ids: 40
2024-09-02 15:59:02 INFO     ----------------------------------------------------------------------------
2024-09-02 15:59:02 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=40
2024-09-02 15:59:02 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 40, 'embedding_model': 'RefH', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 15:59:02 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 15:59:02 INFO     set_weight_link_or_dist: dist
2024-09-02 15:59:02 INFO     init_weight_inf_or_zero: inf
2024-09-02 15:59:02 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 15:59:02 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 15:59:02 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 15:59:02 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 15:59:04 INFO     Dataset created
2024-09-02 15:59:04 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 15:59:04 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 15:59:04 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 15:59:04 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 15:59:04 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 15:59:04 INFO     NormalScaler max: 0.39871441235290517
2024-09-02 15:59:07 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 15:59:07 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 15:59:07 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 15:59:07 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:59:07 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 15:59:07 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:59:07 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 15:59:07 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:59:07 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 15:59:07 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:59:07 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 15:59:07 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 15:59:07 INFO     Total parameter numbers: 874010
2024-09-02 15:59:07 INFO     You select `adam` optimizer.
2024-09-02 15:59:07 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 15:59:07 INFO     Start training ...
2024-09-02 15:59:07 INFO     num_batches:48
2024-09-02 15:59:14 INFO     epoch complete!
2024-09-02 15:59:14 INFO     evaluating now!
2024-09-02 15:59:15 INFO     Epoch [0/200] train_loss: 24.8813, val_loss: 18.8257, lr: 0.003000, 7.48s
2024-09-02 15:59:15 INFO     Saved model at 0
2024-09-02 15:59:15 INFO     Val loss decrease from inf to 18.8257, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 15:59:20 INFO     epoch complete!
2024-09-02 15:59:20 INFO     evaluating now!
2024-09-02 15:59:20 INFO     Epoch [1/200] train_loss: 15.5888, val_loss: 15.3121, lr: 0.003000, 5.27s
2024-09-02 15:59:20 INFO     Saved model at 1
2024-09-02 15:59:20 INFO     Val loss decrease from 18.8257 to 15.3121, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 15:59:25 INFO     epoch complete!
2024-09-02 15:59:25 INFO     evaluating now!
2024-09-02 15:59:25 INFO     Epoch [2/200] train_loss: 12.6100, val_loss: 12.2339, lr: 0.003000, 5.47s
2024-09-02 15:59:25 INFO     Saved model at 2
2024-09-02 15:59:25 INFO     Val loss decrease from 15.3121 to 12.2339, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 15:59:30 INFO     epoch complete!
2024-09-02 15:59:30 INFO     evaluating now!
2024-09-02 15:59:31 INFO     Epoch [3/200] train_loss: 10.4773, val_loss: 10.4347, lr: 0.003000, 5.36s
2024-09-02 15:59:31 INFO     Saved model at 3
2024-09-02 15:59:31 INFO     Val loss decrease from 12.2339 to 10.4347, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 15:59:36 INFO     epoch complete!
2024-09-02 15:59:36 INFO     evaluating now!
2024-09-02 15:59:36 INFO     Epoch [4/200] train_loss: 9.1360, val_loss: 8.9043, lr: 0.003000, 5.21s
2024-09-02 15:59:36 INFO     Saved model at 4
2024-09-02 15:59:36 INFO     Val loss decrease from 10.4347 to 8.9043, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 15:59:41 INFO     epoch complete!
2024-09-02 15:59:41 INFO     evaluating now!
2024-09-02 15:59:41 INFO     Epoch [5/200] train_loss: 7.9573, val_loss: 7.8354, lr: 0.003000, 5.28s
2024-09-02 15:59:41 INFO     Saved model at 5
2024-09-02 15:59:41 INFO     Val loss decrease from 8.9043 to 7.8354, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 15:59:46 INFO     epoch complete!
2024-09-02 15:59:46 INFO     evaluating now!
2024-09-02 15:59:47 INFO     Epoch [6/200] train_loss: 7.3102, val_loss: 7.3906, lr: 0.003000, 5.20s
2024-09-02 15:59:47 INFO     Saved model at 6
2024-09-02 15:59:47 INFO     Val loss decrease from 7.8354 to 7.3906, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 15:59:51 INFO     epoch complete!
2024-09-02 15:59:51 INFO     evaluating now!
2024-09-02 15:59:52 INFO     Epoch [7/200] train_loss: 6.9681, val_loss: 7.0469, lr: 0.003000, 5.22s
2024-09-02 15:59:52 INFO     Saved model at 7
2024-09-02 15:59:52 INFO     Val loss decrease from 7.3906 to 7.0469, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 15:59:57 INFO     epoch complete!
2024-09-02 15:59:57 INFO     evaluating now!
2024-09-02 15:59:57 INFO     Epoch [8/200] train_loss: 6.5182, val_loss: 6.8237, lr: 0.003000, 5.24s
2024-09-02 15:59:57 INFO     Saved model at 8
2024-09-02 15:59:57 INFO     Val loss decrease from 7.0469 to 6.8237, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 16:00:02 INFO     epoch complete!
2024-09-02 16:00:02 INFO     evaluating now!
2024-09-02 16:00:02 INFO     Epoch [9/200] train_loss: 6.3549, val_loss: 6.2695, lr: 0.003000, 5.13s
2024-09-02 16:00:02 INFO     Saved model at 9
2024-09-02 16:00:02 INFO     Val loss decrease from 6.8237 to 6.2695, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 16:00:07 INFO     epoch complete!
2024-09-02 16:00:07 INFO     evaluating now!
2024-09-02 16:00:07 INFO     Epoch [10/200] train_loss: 6.0218, val_loss: 6.3527, lr: 0.003000, 5.16s
2024-09-02 16:00:12 INFO     epoch complete!
2024-09-02 16:00:12 INFO     evaluating now!
2024-09-02 16:00:13 INFO     Epoch [11/200] train_loss: 5.8743, val_loss: 5.9979, lr: 0.003000, 5.23s
2024-09-02 16:00:13 INFO     Saved model at 11
2024-09-02 16:00:13 INFO     Val loss decrease from 6.2695 to 5.9979, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 16:00:17 INFO     epoch complete!
2024-09-02 16:00:17 INFO     evaluating now!
2024-09-02 16:00:18 INFO     Epoch [12/200] train_loss: 5.8137, val_loss: 6.0810, lr: 0.003000, 5.19s
2024-09-02 16:00:23 INFO     epoch complete!
2024-09-02 16:00:23 INFO     evaluating now!
2024-09-02 16:00:23 INFO     Epoch [13/200] train_loss: 5.7178, val_loss: 6.3315, lr: 0.003000, 5.25s
2024-09-02 16:00:28 INFO     epoch complete!
2024-09-02 16:00:28 INFO     evaluating now!
2024-09-02 16:00:28 INFO     Epoch [14/200] train_loss: 5.5809, val_loss: 5.6866, lr: 0.003000, 5.39s
2024-09-02 16:00:28 INFO     Saved model at 14
2024-09-02 16:00:28 INFO     Val loss decrease from 5.9979 to 5.6866, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-02 16:00:33 INFO     epoch complete!
2024-09-02 16:00:33 INFO     evaluating now!
2024-09-02 16:00:34 INFO     Epoch [15/200] train_loss: 5.4242, val_loss: 5.9116, lr: 0.003000, 5.34s
2024-09-02 16:00:39 INFO     epoch complete!
2024-09-02 16:00:39 INFO     evaluating now!
2024-09-02 16:00:39 INFO     Epoch [16/200] train_loss: 5.2478, val_loss: 5.6075, lr: 0.003000, 5.46s
2024-09-02 16:00:39 INFO     Saved model at 16
2024-09-02 16:00:39 INFO     Val loss decrease from 5.6866 to 5.6075, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 16:00:44 INFO     epoch complete!
2024-09-02 16:00:44 INFO     evaluating now!
2024-09-02 16:00:45 INFO     Epoch [17/200] train_loss: 5.2401, val_loss: 5.7417, lr: 0.003000, 5.55s
2024-09-02 16:00:50 INFO     epoch complete!
2024-09-02 16:00:50 INFO     evaluating now!
2024-09-02 16:00:50 INFO     Epoch [18/200] train_loss: 5.1633, val_loss: 5.4653, lr: 0.003000, 5.55s
2024-09-02 16:00:50 INFO     Saved model at 18
2024-09-02 16:00:50 INFO     Val loss decrease from 5.6075 to 5.4653, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-02 16:00:55 INFO     epoch complete!
2024-09-02 16:00:55 INFO     evaluating now!
2024-09-02 16:00:56 INFO     Epoch [19/200] train_loss: 5.0464, val_loss: 5.5501, lr: 0.003000, 5.45s
2024-09-02 16:01:01 INFO     epoch complete!
2024-09-02 16:01:01 INFO     evaluating now!
2024-09-02 16:01:01 INFO     Epoch [20/200] train_loss: 5.0094, val_loss: 5.4026, lr: 0.003000, 5.31s
2024-09-02 16:01:01 INFO     Saved model at 20
2024-09-02 16:01:01 INFO     Val loss decrease from 5.4653 to 5.4026, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-02 16:01:06 INFO     epoch complete!
2024-09-02 16:01:06 INFO     evaluating now!
2024-09-02 16:01:06 INFO     Epoch [21/200] train_loss: 4.9069, val_loss: 5.4003, lr: 0.003000, 5.21s
2024-09-02 16:01:06 INFO     Saved model at 21
2024-09-02 16:01:06 INFO     Val loss decrease from 5.4026 to 5.4003, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-02 16:01:11 INFO     epoch complete!
2024-09-02 16:01:11 INFO     evaluating now!
2024-09-02 16:01:12 INFO     Epoch [22/200] train_loss: 4.9070, val_loss: 5.6990, lr: 0.003000, 5.27s
2024-09-02 16:01:16 INFO     epoch complete!
2024-09-02 16:01:16 INFO     evaluating now!
2024-09-02 16:01:17 INFO     Epoch [23/200] train_loss: 4.8663, val_loss: 5.2817, lr: 0.003000, 5.10s
2024-09-02 16:01:17 INFO     Saved model at 23
2024-09-02 16:01:17 INFO     Val loss decrease from 5.4003 to 5.2817, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-02 16:01:22 INFO     epoch complete!
2024-09-02 16:01:22 INFO     evaluating now!
2024-09-02 16:01:22 INFO     Epoch [24/200] train_loss: 4.8204, val_loss: 5.2051, lr: 0.003000, 5.12s
2024-09-02 16:01:22 INFO     Saved model at 24
2024-09-02 16:01:22 INFO     Val loss decrease from 5.2817 to 5.2051, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-02 16:01:27 INFO     epoch complete!
2024-09-02 16:01:27 INFO     evaluating now!
2024-09-02 16:01:27 INFO     Epoch [25/200] train_loss: 4.6434, val_loss: 5.2951, lr: 0.003000, 5.21s
2024-09-02 16:01:32 INFO     epoch complete!
2024-09-02 16:01:32 INFO     evaluating now!
2024-09-02 16:01:32 INFO     Epoch [26/200] train_loss: 4.6083, val_loss: 5.2826, lr: 0.003000, 5.29s
2024-09-02 16:01:37 INFO     epoch complete!
2024-09-02 16:01:37 INFO     evaluating now!
2024-09-02 16:01:38 INFO     Epoch [27/200] train_loss: 4.5951, val_loss: 5.1572, lr: 0.003000, 5.19s
2024-09-02 16:01:38 INFO     Saved model at 27
2024-09-02 16:01:38 INFO     Val loss decrease from 5.2051 to 5.1572, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-02 16:01:42 INFO     epoch complete!
2024-09-02 16:01:42 INFO     evaluating now!
2024-09-02 16:01:43 INFO     Epoch [28/200] train_loss: 4.5660, val_loss: 5.2348, lr: 0.003000, 5.13s
2024-09-02 16:01:48 INFO     epoch complete!
2024-09-02 16:01:48 INFO     evaluating now!
2024-09-02 16:01:48 INFO     Epoch [29/200] train_loss: 4.5412, val_loss: 5.1957, lr: 0.003000, 5.23s
2024-09-02 16:01:53 INFO     epoch complete!
2024-09-02 16:01:53 INFO     evaluating now!
2024-09-02 16:01:53 INFO     Epoch [30/200] train_loss: 4.4779, val_loss: 5.0458, lr: 0.003000, 5.27s
2024-09-02 16:01:53 INFO     Saved model at 30
2024-09-02 16:01:53 INFO     Val loss decrease from 5.1572 to 5.0458, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-09-02 16:01:58 INFO     epoch complete!
2024-09-02 16:01:58 INFO     evaluating now!
2024-09-02 16:01:58 INFO     Epoch [31/200] train_loss: 4.3780, val_loss: 5.2738, lr: 0.003000, 5.14s
2024-09-02 16:02:03 INFO     epoch complete!
2024-09-02 16:02:03 INFO     evaluating now!
2024-09-02 16:02:04 INFO     Epoch [32/200] train_loss: 4.3528, val_loss: 5.1965, lr: 0.003000, 5.18s
2024-09-02 16:02:09 INFO     epoch complete!
2024-09-02 16:02:09 INFO     evaluating now!
2024-09-02 16:02:09 INFO     Epoch [33/200] train_loss: 4.3955, val_loss: 5.3362, lr: 0.003000, 5.32s
2024-09-02 16:02:14 INFO     epoch complete!
2024-09-02 16:02:14 INFO     evaluating now!
2024-09-02 16:02:14 INFO     Epoch [34/200] train_loss: 4.2846, val_loss: 5.3643, lr: 0.003000, 5.13s
2024-09-02 16:02:19 INFO     epoch complete!
2024-09-02 16:02:19 INFO     evaluating now!
2024-09-02 16:02:19 INFO     Epoch [35/200] train_loss: 4.2973, val_loss: 5.0852, lr: 0.003000, 5.22s
2024-09-02 16:02:24 INFO     epoch complete!
2024-09-02 16:02:24 INFO     evaluating now!
2024-09-02 16:02:25 INFO     Epoch [36/200] train_loss: 4.2207, val_loss: 5.1042, lr: 0.003000, 5.36s
2024-09-02 16:02:30 INFO     epoch complete!
2024-09-02 16:02:30 INFO     evaluating now!
2024-09-02 16:02:30 INFO     Epoch [37/200] train_loss: 4.1730, val_loss: 5.0391, lr: 0.003000, 5.27s
2024-09-02 16:02:30 INFO     Saved model at 37
2024-09-02 16:02:30 INFO     Val loss decrease from 5.0458 to 5.0391, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-09-02 16:02:35 INFO     epoch complete!
2024-09-02 16:02:35 INFO     evaluating now!
2024-09-02 16:02:35 INFO     Epoch [38/200] train_loss: 4.1447, val_loss: 5.2019, lr: 0.003000, 5.31s
2024-09-02 16:02:40 INFO     epoch complete!
2024-09-02 16:02:40 INFO     evaluating now!
2024-09-02 16:02:40 INFO     Epoch [39/200] train_loss: 4.1279, val_loss: 4.9583, lr: 0.003000, 5.28s
2024-09-02 16:02:40 INFO     Saved model at 39
2024-09-02 16:02:40 INFO     Val loss decrease from 5.0391 to 4.9583, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-09-02 16:02:45 INFO     epoch complete!
2024-09-02 16:02:45 INFO     evaluating now!
2024-09-02 16:02:46 INFO     Epoch [40/200] train_loss: 4.0960, val_loss: 5.3160, lr: 0.003000, 5.23s
2024-09-02 16:02:51 INFO     epoch complete!
2024-09-02 16:02:51 INFO     evaluating now!
2024-09-02 16:02:51 INFO     Epoch [41/200] train_loss: 4.0549, val_loss: 4.8887, lr: 0.003000, 5.31s
2024-09-02 16:02:51 INFO     Saved model at 41
2024-09-02 16:02:51 INFO     Val loss decrease from 4.9583 to 4.8887, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-09-02 16:02:56 INFO     epoch complete!
2024-09-02 16:02:56 INFO     evaluating now!
2024-09-02 16:02:57 INFO     Epoch [42/200] train_loss: 4.0263, val_loss: 4.9937, lr: 0.003000, 5.49s
2024-09-02 16:03:02 INFO     epoch complete!
2024-09-02 16:03:02 INFO     evaluating now!
2024-09-02 16:03:02 INFO     Epoch [43/200] train_loss: 3.9864, val_loss: 4.9768, lr: 0.003000, 5.40s
2024-09-02 16:03:07 INFO     epoch complete!
2024-09-02 16:03:07 INFO     evaluating now!
2024-09-02 16:03:07 INFO     Epoch [44/200] train_loss: 4.0445, val_loss: 5.0510, lr: 0.003000, 5.21s
2024-09-02 16:03:12 INFO     epoch complete!
2024-09-02 16:03:12 INFO     evaluating now!
2024-09-02 16:03:12 INFO     Epoch [45/200] train_loss: 3.9471, val_loss: 5.0451, lr: 0.003000, 5.25s
2024-09-02 16:03:17 INFO     epoch complete!
2024-09-02 16:03:17 INFO     evaluating now!
2024-09-02 16:03:18 INFO     Epoch [46/200] train_loss: 3.9291, val_loss: 5.0011, lr: 0.003000, 5.19s
2024-09-02 16:03:22 INFO     epoch complete!
2024-09-02 16:03:22 INFO     evaluating now!
2024-09-02 16:03:23 INFO     Epoch [47/200] train_loss: 3.9668, val_loss: 5.2301, lr: 0.003000, 5.17s
2024-09-02 16:03:28 INFO     epoch complete!
2024-09-02 16:03:28 INFO     evaluating now!
2024-09-02 16:03:28 INFO     Epoch [48/200] train_loss: 3.9132, val_loss: 4.8521, lr: 0.003000, 5.19s
2024-09-02 16:03:28 INFO     Saved model at 48
2024-09-02 16:03:28 INFO     Val loss decrease from 4.8887 to 4.8521, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-09-02 16:03:33 INFO     epoch complete!
2024-09-02 16:03:33 INFO     evaluating now!
2024-09-02 16:03:33 INFO     Epoch [49/200] train_loss: 3.9188, val_loss: 4.9991, lr: 0.003000, 5.18s
2024-09-02 16:03:38 INFO     epoch complete!
2024-09-02 16:03:38 INFO     evaluating now!
2024-09-02 16:03:39 INFO     Epoch [50/200] train_loss: 3.8492, val_loss: 4.9361, lr: 0.003000, 5.40s
2024-09-02 16:03:43 INFO     epoch complete!
2024-09-02 16:03:43 INFO     evaluating now!
2024-09-02 16:03:44 INFO     Epoch [51/200] train_loss: 3.8231, val_loss: 5.0526, lr: 0.003000, 5.25s
2024-09-02 16:03:49 INFO     epoch complete!
2024-09-02 16:03:49 INFO     evaluating now!
2024-09-02 16:03:49 INFO     Epoch [52/200] train_loss: 3.7709, val_loss: 5.0548, lr: 0.003000, 5.21s
2024-09-02 16:03:54 INFO     epoch complete!
2024-09-02 16:03:54 INFO     evaluating now!
2024-09-02 16:03:54 INFO     Epoch [53/200] train_loss: 3.8181, val_loss: 5.0787, lr: 0.003000, 5.28s
2024-09-02 16:03:59 INFO     epoch complete!
2024-09-02 16:03:59 INFO     evaluating now!
2024-09-02 16:04:00 INFO     Epoch [54/200] train_loss: 3.7389, val_loss: 4.9782, lr: 0.003000, 5.26s
2024-09-02 16:04:04 INFO     epoch complete!
2024-09-02 16:04:04 INFO     evaluating now!
2024-09-02 16:04:05 INFO     Epoch [55/200] train_loss: 3.7543, val_loss: 5.0392, lr: 0.003000, 5.20s
2024-09-02 16:04:10 INFO     epoch complete!
2024-09-02 16:04:10 INFO     evaluating now!
2024-09-02 16:04:10 INFO     Epoch [56/200] train_loss: 3.7368, val_loss: 5.0056, lr: 0.003000, 5.18s
2024-09-02 16:04:15 INFO     epoch complete!
2024-09-02 16:04:15 INFO     evaluating now!
2024-09-02 16:04:15 INFO     Epoch [57/200] train_loss: 3.6981, val_loss: 4.9663, lr: 0.003000, 5.15s
2024-09-02 16:04:20 INFO     epoch complete!
2024-09-02 16:04:20 INFO     evaluating now!
2024-09-02 16:04:20 INFO     Epoch [58/200] train_loss: 3.7701, val_loss: 5.0880, lr: 0.003000, 5.40s
2024-09-02 16:04:25 INFO     epoch complete!
2024-09-02 16:04:25 INFO     evaluating now!
2024-09-02 16:04:26 INFO     Epoch [59/200] train_loss: 3.7949, val_loss: 5.1330, lr: 0.003000, 5.34s
2024-09-02 16:04:31 INFO     epoch complete!
2024-09-02 16:04:31 INFO     evaluating now!
2024-09-02 16:04:31 INFO     Epoch [60/200] train_loss: 3.6869, val_loss: 4.9904, lr: 0.003000, 5.41s
2024-09-02 16:04:36 INFO     epoch complete!
2024-09-02 16:04:36 INFO     evaluating now!
2024-09-02 16:04:36 INFO     Epoch [61/200] train_loss: 3.6648, val_loss: 4.9331, lr: 0.003000, 5.26s
2024-09-02 16:04:41 INFO     epoch complete!
2024-09-02 16:04:41 INFO     evaluating now!
2024-09-02 16:04:42 INFO     Epoch [62/200] train_loss: 3.6057, val_loss: 5.1223, lr: 0.003000, 5.19s
2024-09-02 16:04:46 INFO     epoch complete!
2024-09-02 16:04:46 INFO     evaluating now!
2024-09-02 16:04:47 INFO     Epoch [63/200] train_loss: 3.6354, val_loss: 4.9997, lr: 0.003000, 5.12s
2024-09-02 16:04:47 WARNING  Early stopping at epoch: 63
2024-09-02 16:04:47 INFO     Trained totally 64 epochs, average train time is 4.978s, average eval time is 0.322s
2024-09-02 16:04:47 INFO     Loaded model at 48
2024-09-02 16:04:47 INFO     Saved model at ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 16:04:47 INFO     Start evaluating ...
2024-09-02 16:04:48 INFO     Note that you select the single mode to evaluate!
2024-09-02 16:04:48 INFO     Evaluate result is saved at ./libcity/cache/40/evaluate_cache\2024_09_02_16_04_48_AGCRN_CHITaxi20190406.csv
2024-09-02 16:04:48 INFO     
         MAE       RMSE
1   2.331375   7.047637
2   2.423756   7.693762
3   2.633994   8.634511
4   2.764463   9.265910
5   2.875611   9.747956
6   2.921139  10.227755
7   3.069941  10.765512
8   3.160635  11.376925
9   3.247496  11.896757
10  3.239164  12.387953
11  3.310684  12.897502
12  3.423414  13.717627
2024-09-02 16:04:48 INFO     ----------------------------------------------------------------------------
2024-09-02 16:04:48 INFO     # 1, Kownledge Graph Embedding: RefH, Experiment ids: 41
2024-09-02 16:04:48 INFO     ----------------------------------------------------------------------------
2024-09-02 16:04:48 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=40
2024-09-02 16:04:48 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 40, 'embedding_model': 'RefH', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 16:04:48 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 16:04:48 INFO     set_weight_link_or_dist: dist
2024-09-02 16:04:48 INFO     init_weight_inf_or_zero: inf
2024-09-02 16:04:48 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 16:04:48 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 16:04:48 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 16:04:48 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 16:04:51 INFO     Dataset created
2024-09-02 16:04:51 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 16:04:51 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 16:04:51 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 16:04:51 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 16:04:51 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 16:04:52 INFO     NormalScaler max: 0.39871441235290517
2024-09-02 16:04:53 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 16:04:53 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 16:04:53 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 16:04:53 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 16:04:53 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 16:04:53 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 16:04:53 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 16:04:53 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 16:04:53 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 16:04:53 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 16:04:53 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 16:04:53 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 16:04:53 INFO     Total parameter numbers: 874010
2024-09-02 16:04:53 INFO     You select `adam` optimizer.
2024-09-02 16:04:53 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 16:04:53 INFO     Start training ...
2024-09-02 16:04:53 INFO     num_batches:48
2024-09-02 16:04:59 INFO     epoch complete!
2024-09-02 16:04:59 INFO     evaluating now!
2024-09-02 16:04:59 INFO     Epoch [0/200] train_loss: 23.4803, val_loss: 18.5737, lr: 0.003000, 5.91s
2024-09-02 16:04:59 INFO     Saved model at 0
2024-09-02 16:04:59 INFO     Val loss decrease from inf to 18.5737, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 16:05:04 INFO     epoch complete!
2024-09-02 16:05:04 INFO     evaluating now!
2024-09-02 16:05:05 INFO     Epoch [1/200] train_loss: 15.0817, val_loss: 14.5524, lr: 0.003000, 5.27s
2024-09-02 16:05:05 INFO     Saved model at 1
2024-09-02 16:05:05 INFO     Val loss decrease from 18.5737 to 14.5524, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 16:05:10 INFO     epoch complete!
2024-09-02 16:05:10 INFO     evaluating now!
2024-09-02 16:05:10 INFO     Epoch [2/200] train_loss: 12.5250, val_loss: 11.7244, lr: 0.003000, 5.39s
2024-09-02 16:05:10 INFO     Saved model at 2
2024-09-02 16:05:10 INFO     Val loss decrease from 14.5524 to 11.7244, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 16:05:15 INFO     epoch complete!
2024-09-02 16:05:15 INFO     evaluating now!
2024-09-02 16:05:16 INFO     Epoch [3/200] train_loss: 10.0610, val_loss: 9.5889, lr: 0.003000, 5.48s
2024-09-02 16:05:16 INFO     Saved model at 3
2024-09-02 16:05:16 INFO     Val loss decrease from 11.7244 to 9.5889, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 16:05:21 INFO     epoch complete!
2024-09-02 16:05:21 INFO     evaluating now!
2024-09-02 16:05:21 INFO     Epoch [4/200] train_loss: 8.5386, val_loss: 8.0060, lr: 0.003000, 5.37s
2024-09-02 16:05:21 INFO     Saved model at 4
2024-09-02 16:05:21 INFO     Val loss decrease from 9.5889 to 8.0060, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 16:05:26 INFO     epoch complete!
2024-09-02 16:05:26 INFO     evaluating now!
2024-09-02 16:05:26 INFO     Epoch [5/200] train_loss: 7.5935, val_loss: 7.5438, lr: 0.003000, 5.31s
2024-09-02 16:05:26 INFO     Saved model at 5
2024-09-02 16:05:26 INFO     Val loss decrease from 8.0060 to 7.5438, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 16:05:31 INFO     epoch complete!
2024-09-02 16:05:31 INFO     evaluating now!
2024-09-02 16:05:32 INFO     Epoch [6/200] train_loss: 7.0566, val_loss: 6.8717, lr: 0.003000, 5.47s
2024-09-02 16:05:32 INFO     Saved model at 6
2024-09-02 16:05:32 INFO     Val loss decrease from 7.5438 to 6.8717, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 16:05:37 INFO     epoch complete!
2024-09-02 16:05:37 INFO     evaluating now!
2024-09-02 16:05:37 INFO     Epoch [7/200] train_loss: 6.6999, val_loss: 6.6273, lr: 0.003000, 5.59s
2024-09-02 16:05:37 INFO     Saved model at 7
2024-09-02 16:05:37 INFO     Val loss decrease from 6.8717 to 6.6273, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 16:05:42 INFO     epoch complete!
2024-09-02 16:05:42 INFO     evaluating now!
2024-09-02 16:05:43 INFO     Epoch [8/200] train_loss: 6.2682, val_loss: 6.4787, lr: 0.003000, 5.28s
2024-09-02 16:05:43 INFO     Saved model at 8
2024-09-02 16:05:43 INFO     Val loss decrease from 6.6273 to 6.4787, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 16:05:48 INFO     epoch complete!
2024-09-02 16:05:48 INFO     evaluating now!
2024-09-02 16:05:48 INFO     Epoch [9/200] train_loss: 6.0553, val_loss: 6.1853, lr: 0.003000, 5.41s
2024-09-02 16:05:48 INFO     Saved model at 9
2024-09-02 16:05:48 INFO     Val loss decrease from 6.4787 to 6.1853, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 16:05:53 INFO     epoch complete!
2024-09-02 16:05:53 INFO     evaluating now!
2024-09-02 16:05:54 INFO     Epoch [10/200] train_loss: 5.8611, val_loss: 6.0421, lr: 0.003000, 5.50s
2024-09-02 16:05:54 INFO     Saved model at 10
2024-09-02 16:05:54 INFO     Val loss decrease from 6.1853 to 6.0421, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 16:05:59 INFO     epoch complete!
2024-09-02 16:05:59 INFO     evaluating now!
2024-09-02 16:05:59 INFO     Epoch [11/200] train_loss: 5.8136, val_loss: 6.1576, lr: 0.003000, 5.22s
2024-09-02 16:06:04 INFO     epoch complete!
2024-09-02 16:06:04 INFO     evaluating now!
2024-09-02 16:06:04 INFO     Epoch [12/200] train_loss: 5.5823, val_loss: 5.7497, lr: 0.003000, 5.48s
2024-09-02 16:06:04 INFO     Saved model at 12
2024-09-02 16:06:04 INFO     Val loss decrease from 6.0421 to 5.7497, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 16:06:10 INFO     epoch complete!
2024-09-02 16:06:10 INFO     evaluating now!
2024-09-02 16:06:10 INFO     Epoch [13/200] train_loss: 5.4316, val_loss: 5.6055, lr: 0.003000, 5.48s
2024-09-02 16:06:10 INFO     Saved model at 13
2024-09-02 16:06:10 INFO     Val loss decrease from 5.7497 to 5.6055, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 16:06:15 INFO     epoch complete!
2024-09-02 16:06:15 INFO     evaluating now!
2024-09-02 16:06:15 INFO     Epoch [14/200] train_loss: 5.3698, val_loss: 5.6596, lr: 0.003000, 5.37s
2024-09-02 16:06:21 INFO     epoch complete!
2024-09-02 16:06:21 INFO     evaluating now!
2024-09-02 16:06:21 INFO     Epoch [15/200] train_loss: 5.2640, val_loss: 5.6718, lr: 0.003000, 5.97s
2024-09-02 16:06:27 INFO     epoch complete!
2024-09-02 16:06:27 INFO     evaluating now!
2024-09-02 16:06:28 INFO     Epoch [16/200] train_loss: 5.2076, val_loss: 5.5669, lr: 0.003000, 5.64s
2024-09-02 16:06:28 INFO     Saved model at 16
2024-09-02 16:06:28 INFO     Val loss decrease from 5.6055 to 5.5669, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 16:06:33 INFO     epoch complete!
2024-09-02 16:06:33 INFO     evaluating now!
2024-09-02 16:06:33 INFO     Epoch [17/200] train_loss: 5.0462, val_loss: 5.4169, lr: 0.003000, 5.22s
2024-09-02 16:06:33 INFO     Saved model at 17
2024-09-02 16:06:33 INFO     Val loss decrease from 5.5669 to 5.4169, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-02 16:06:38 INFO     epoch complete!
2024-09-02 16:06:38 INFO     evaluating now!
2024-09-02 16:06:38 INFO     Epoch [18/200] train_loss: 4.9923, val_loss: 5.5076, lr: 0.003000, 5.19s
2024-09-02 16:06:43 INFO     epoch complete!
2024-09-02 16:06:43 INFO     evaluating now!
2024-09-02 16:06:43 INFO     Epoch [19/200] train_loss: 4.9287, val_loss: 5.3959, lr: 0.003000, 5.14s
2024-09-02 16:06:43 INFO     Saved model at 19
2024-09-02 16:06:43 INFO     Val loss decrease from 5.4169 to 5.3959, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-02 16:06:48 INFO     epoch complete!
2024-09-02 16:06:48 INFO     evaluating now!
2024-09-02 16:06:48 INFO     Epoch [20/200] train_loss: 4.8326, val_loss: 5.2992, lr: 0.003000, 5.11s
2024-09-02 16:06:48 INFO     Saved model at 20
2024-09-02 16:06:48 INFO     Val loss decrease from 5.3959 to 5.2992, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-02 16:06:53 INFO     epoch complete!
2024-09-02 16:06:53 INFO     evaluating now!
2024-09-02 16:06:54 INFO     Epoch [21/200] train_loss: 4.8073, val_loss: 5.3694, lr: 0.003000, 5.19s
2024-09-02 16:06:58 INFO     epoch complete!
2024-09-02 16:06:58 INFO     evaluating now!
2024-09-02 16:06:59 INFO     Epoch [22/200] train_loss: 4.7574, val_loss: 5.3471, lr: 0.003000, 5.13s
2024-09-02 16:07:04 INFO     epoch complete!
2024-09-02 16:07:04 INFO     evaluating now!
2024-09-02 16:07:04 INFO     Epoch [23/200] train_loss: 4.6881, val_loss: 5.2055, lr: 0.003000, 5.20s
2024-09-02 16:07:04 INFO     Saved model at 23
2024-09-02 16:07:04 INFO     Val loss decrease from 5.2992 to 5.2055, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-02 16:07:09 INFO     epoch complete!
2024-09-02 16:07:09 INFO     evaluating now!
2024-09-02 16:07:09 INFO     Epoch [24/200] train_loss: 4.6438, val_loss: 5.3266, lr: 0.003000, 5.27s
2024-09-02 16:07:14 INFO     epoch complete!
2024-09-02 16:07:14 INFO     evaluating now!
2024-09-02 16:07:15 INFO     Epoch [25/200] train_loss: 4.6372, val_loss: 5.1871, lr: 0.003000, 5.54s
2024-09-02 16:07:15 INFO     Saved model at 25
2024-09-02 16:07:15 INFO     Val loss decrease from 5.2055 to 5.1871, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-02 16:07:20 INFO     epoch complete!
2024-09-02 16:07:20 INFO     evaluating now!
2024-09-02 16:07:20 INFO     Epoch [26/200] train_loss: 4.5846, val_loss: 5.6250, lr: 0.003000, 5.40s
2024-09-02 16:07:25 INFO     epoch complete!
2024-09-02 16:07:25 INFO     evaluating now!
2024-09-02 16:07:26 INFO     Epoch [27/200] train_loss: 4.4965, val_loss: 5.1708, lr: 0.003000, 5.40s
2024-09-02 16:07:26 INFO     Saved model at 27
2024-09-02 16:07:26 INFO     Val loss decrease from 5.1871 to 5.1708, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-02 16:07:31 INFO     epoch complete!
2024-09-02 16:07:31 INFO     evaluating now!
2024-09-02 16:07:31 INFO     Epoch [28/200] train_loss: 4.4677, val_loss: 5.2366, lr: 0.003000, 5.35s
2024-09-02 16:07:36 INFO     epoch complete!
2024-09-02 16:07:36 INFO     evaluating now!
2024-09-02 16:07:36 INFO     Epoch [29/200] train_loss: 4.4221, val_loss: 5.0106, lr: 0.003000, 5.50s
2024-09-02 16:07:36 INFO     Saved model at 29
2024-09-02 16:07:36 INFO     Val loss decrease from 5.1708 to 5.0106, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-02 16:07:41 INFO     epoch complete!
2024-09-02 16:07:41 INFO     evaluating now!
2024-09-02 16:07:42 INFO     Epoch [30/200] train_loss: 4.4156, val_loss: 5.1042, lr: 0.003000, 5.29s
2024-09-02 16:07:47 INFO     epoch complete!
2024-09-02 16:07:47 INFO     evaluating now!
2024-09-02 16:07:47 INFO     Epoch [31/200] train_loss: 4.3436, val_loss: 5.2166, lr: 0.003000, 5.21s
2024-09-02 16:07:52 INFO     epoch complete!
2024-09-02 16:07:52 INFO     evaluating now!
2024-09-02 16:07:52 INFO     Epoch [32/200] train_loss: 4.2661, val_loss: 5.0110, lr: 0.003000, 5.38s
2024-09-02 16:07:57 INFO     epoch complete!
2024-09-02 16:07:57 INFO     evaluating now!
2024-09-02 16:07:58 INFO     Epoch [33/200] train_loss: 4.2208, val_loss: 4.9735, lr: 0.003000, 5.25s
2024-09-02 16:07:58 INFO     Saved model at 33
2024-09-02 16:07:58 INFO     Val loss decrease from 5.0106 to 4.9735, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-09-02 16:08:03 INFO     epoch complete!
2024-09-02 16:08:03 INFO     evaluating now!
2024-09-02 16:08:03 INFO     Epoch [34/200] train_loss: 4.2113, val_loss: 5.0430, lr: 0.003000, 5.41s
2024-09-02 16:08:08 INFO     epoch complete!
2024-09-02 16:08:08 INFO     evaluating now!
2024-09-02 16:08:08 INFO     Epoch [35/200] train_loss: 4.2423, val_loss: 5.0061, lr: 0.003000, 5.39s
2024-09-02 16:08:13 INFO     epoch complete!
2024-09-02 16:08:13 INFO     evaluating now!
2024-09-02 16:08:14 INFO     Epoch [36/200] train_loss: 4.1561, val_loss: 4.9390, lr: 0.003000, 5.20s
2024-09-02 16:08:14 INFO     Saved model at 36
2024-09-02 16:08:14 INFO     Val loss decrease from 4.9735 to 4.9390, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-09-02 16:08:18 INFO     epoch complete!
2024-09-02 16:08:18 INFO     evaluating now!
2024-09-02 16:08:19 INFO     Epoch [37/200] train_loss: 4.0995, val_loss: 5.0444, lr: 0.003000, 5.22s
2024-09-02 16:08:24 INFO     epoch complete!
2024-09-02 16:08:24 INFO     evaluating now!
2024-09-02 16:08:24 INFO     Epoch [38/200] train_loss: 4.0233, val_loss: 4.9191, lr: 0.003000, 5.31s
2024-09-02 16:08:24 INFO     Saved model at 38
2024-09-02 16:08:24 INFO     Val loss decrease from 4.9390 to 4.9191, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-09-02 16:08:29 INFO     epoch complete!
2024-09-02 16:08:29 INFO     evaluating now!
2024-09-02 16:08:29 INFO     Epoch [39/200] train_loss: 4.0243, val_loss: 5.0546, lr: 0.003000, 5.22s
2024-09-02 16:08:34 INFO     epoch complete!
2024-09-02 16:08:34 INFO     evaluating now!
2024-09-02 16:08:35 INFO     Epoch [40/200] train_loss: 4.0169, val_loss: 4.9615, lr: 0.003000, 5.20s
2024-09-02 16:08:40 INFO     epoch complete!
2024-09-02 16:08:40 INFO     evaluating now!
2024-09-02 16:08:40 INFO     Epoch [41/200] train_loss: 4.0348, val_loss: 5.1297, lr: 0.003000, 5.30s
2024-09-02 16:08:45 INFO     epoch complete!
2024-09-02 16:08:45 INFO     evaluating now!
2024-09-02 16:08:45 INFO     Epoch [42/200] train_loss: 4.0251, val_loss: 4.9910, lr: 0.003000, 5.21s
2024-09-02 16:08:50 INFO     epoch complete!
2024-09-02 16:08:50 INFO     evaluating now!
2024-09-02 16:08:50 INFO     Epoch [43/200] train_loss: 3.9014, val_loss: 5.0993, lr: 0.003000, 5.20s
2024-09-02 16:08:55 INFO     epoch complete!
2024-09-02 16:08:55 INFO     evaluating now!
2024-09-02 16:08:56 INFO     Epoch [44/200] train_loss: 3.8820, val_loss: 4.9376, lr: 0.003000, 5.26s
2024-09-02 16:09:00 INFO     epoch complete!
2024-09-02 16:09:00 INFO     evaluating now!
2024-09-02 16:09:01 INFO     Epoch [45/200] train_loss: 3.8386, val_loss: 4.9976, lr: 0.003000, 5.19s
2024-09-02 16:09:06 INFO     epoch complete!
2024-09-02 16:09:06 INFO     evaluating now!
2024-09-02 16:09:06 INFO     Epoch [46/200] train_loss: 3.8220, val_loss: 4.9296, lr: 0.003000, 5.14s
2024-09-02 16:09:11 INFO     epoch complete!
2024-09-02 16:09:11 INFO     evaluating now!
2024-09-02 16:09:11 INFO     Epoch [47/200] train_loss: 3.8501, val_loss: 4.9589, lr: 0.003000, 5.23s
2024-09-02 16:09:16 INFO     epoch complete!
2024-09-02 16:09:16 INFO     evaluating now!
2024-09-02 16:09:16 INFO     Epoch [48/200] train_loss: 3.8503, val_loss: 4.9914, lr: 0.003000, 5.14s
2024-09-02 16:09:21 INFO     epoch complete!
2024-09-02 16:09:21 INFO     evaluating now!
2024-09-02 16:09:21 INFO     Epoch [49/200] train_loss: 3.8323, val_loss: 5.0531, lr: 0.003000, 5.17s
2024-09-02 16:09:26 INFO     epoch complete!
2024-09-02 16:09:26 INFO     evaluating now!
2024-09-02 16:09:27 INFO     Epoch [50/200] train_loss: 3.9416, val_loss: 4.9678, lr: 0.003000, 5.20s
2024-09-02 16:09:31 INFO     epoch complete!
2024-09-02 16:09:31 INFO     evaluating now!
2024-09-02 16:09:32 INFO     Epoch [51/200] train_loss: 3.7469, val_loss: 4.8679, lr: 0.003000, 5.13s
2024-09-02 16:09:32 INFO     Saved model at 51
2024-09-02 16:09:32 INFO     Val loss decrease from 4.9191 to 4.8679, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-09-02 16:09:37 INFO     epoch complete!
2024-09-02 16:09:37 INFO     evaluating now!
2024-09-02 16:09:37 INFO     Epoch [52/200] train_loss: 3.6800, val_loss: 4.9567, lr: 0.003000, 5.14s
2024-09-02 16:09:42 INFO     epoch complete!
2024-09-02 16:09:42 INFO     evaluating now!
2024-09-02 16:09:42 INFO     Epoch [53/200] train_loss: 3.7199, val_loss: 4.8436, lr: 0.003000, 5.15s
2024-09-02 16:09:42 INFO     Saved model at 53
2024-09-02 16:09:42 INFO     Val loss decrease from 4.8679 to 4.8436, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch53.tar
2024-09-02 16:09:47 INFO     epoch complete!
2024-09-02 16:09:47 INFO     evaluating now!
2024-09-02 16:09:47 INFO     Epoch [54/200] train_loss: 3.6933, val_loss: 4.8451, lr: 0.003000, 5.13s
2024-09-02 16:09:52 INFO     epoch complete!
2024-09-02 16:09:52 INFO     evaluating now!
2024-09-02 16:09:52 INFO     Epoch [55/200] train_loss: 3.6662, val_loss: 4.9235, lr: 0.003000, 5.19s
2024-09-02 16:09:57 INFO     epoch complete!
2024-09-02 16:09:57 INFO     evaluating now!
2024-09-02 16:09:58 INFO     Epoch [56/200] train_loss: 3.7137, val_loss: 4.9060, lr: 0.003000, 5.14s
2024-09-02 16:10:02 INFO     epoch complete!
2024-09-02 16:10:02 INFO     evaluating now!
2024-09-02 16:10:03 INFO     Epoch [57/200] train_loss: 3.7436, val_loss: 4.8827, lr: 0.003000, 5.18s
2024-09-02 16:10:08 INFO     epoch complete!
2024-09-02 16:10:08 INFO     evaluating now!
2024-09-02 16:10:08 INFO     Epoch [58/200] train_loss: 3.5822, val_loss: 4.9085, lr: 0.003000, 5.20s
2024-09-02 16:10:13 INFO     epoch complete!
2024-09-02 16:10:13 INFO     evaluating now!
2024-09-02 16:10:13 INFO     Epoch [59/200] train_loss: 3.5729, val_loss: 4.9857, lr: 0.003000, 5.17s
2024-09-02 16:10:18 INFO     epoch complete!
2024-09-02 16:10:18 INFO     evaluating now!
2024-09-02 16:10:18 INFO     Epoch [60/200] train_loss: 3.5876, val_loss: 4.9453, lr: 0.003000, 5.15s
2024-09-02 16:10:23 INFO     epoch complete!
2024-09-02 16:10:23 INFO     evaluating now!
2024-09-02 16:10:23 INFO     Epoch [61/200] train_loss: 3.5873, val_loss: 4.8125, lr: 0.003000, 5.19s
2024-09-02 16:10:23 INFO     Saved model at 61
2024-09-02 16:10:23 INFO     Val loss decrease from 4.8436 to 4.8125, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch61.tar
2024-09-02 16:10:28 INFO     epoch complete!
2024-09-02 16:10:28 INFO     evaluating now!
2024-09-02 16:10:29 INFO     Epoch [62/200] train_loss: 3.5265, val_loss: 4.8513, lr: 0.003000, 5.15s
2024-09-02 16:10:33 INFO     epoch complete!
2024-09-02 16:10:33 INFO     evaluating now!
2024-09-02 16:10:34 INFO     Epoch [63/200] train_loss: 3.5196, val_loss: 4.7942, lr: 0.003000, 5.17s
2024-09-02 16:10:34 INFO     Saved model at 63
2024-09-02 16:10:34 INFO     Val loss decrease from 4.8125 to 4.7942, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch63.tar
2024-09-02 16:10:39 INFO     epoch complete!
2024-09-02 16:10:39 INFO     evaluating now!
2024-09-02 16:10:39 INFO     Epoch [64/200] train_loss: 3.4808, val_loss: 4.8283, lr: 0.003000, 5.29s
2024-09-02 16:10:44 INFO     epoch complete!
2024-09-02 16:10:44 INFO     evaluating now!
2024-09-02 16:10:44 INFO     Epoch [65/200] train_loss: 3.5180, val_loss: 4.8636, lr: 0.003000, 5.24s
2024-09-02 16:10:49 INFO     epoch complete!
2024-09-02 16:10:49 INFO     evaluating now!
2024-09-02 16:10:49 INFO     Epoch [66/200] train_loss: 3.4869, val_loss: 4.8793, lr: 0.003000, 5.22s
2024-09-02 16:10:54 INFO     epoch complete!
2024-09-02 16:10:54 INFO     evaluating now!
2024-09-02 16:10:55 INFO     Epoch [67/200] train_loss: 3.4903, val_loss: 4.7955, lr: 0.003000, 5.28s
2024-09-02 16:11:00 INFO     epoch complete!
2024-09-02 16:11:00 INFO     evaluating now!
2024-09-02 16:11:00 INFO     Epoch [68/200] train_loss: 3.4624, val_loss: 4.8944, lr: 0.003000, 5.22s
2024-09-02 16:11:05 INFO     epoch complete!
2024-09-02 16:11:05 INFO     evaluating now!
2024-09-02 16:11:05 INFO     Epoch [69/200] train_loss: 3.4945, val_loss: 4.9189, lr: 0.003000, 5.20s
2024-09-02 16:11:10 INFO     epoch complete!
2024-09-02 16:11:10 INFO     evaluating now!
2024-09-02 16:11:10 INFO     Epoch [70/200] train_loss: 3.4219, val_loss: 4.7611, lr: 0.003000, 5.26s
2024-09-02 16:11:10 INFO     Saved model at 70
2024-09-02 16:11:10 INFO     Val loss decrease from 4.7942 to 4.7611, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch70.tar
2024-09-02 16:11:15 INFO     epoch complete!
2024-09-02 16:11:15 INFO     evaluating now!
2024-09-02 16:11:16 INFO     Epoch [71/200] train_loss: 3.4412, val_loss: 4.9101, lr: 0.003000, 5.21s
2024-09-02 16:11:21 INFO     epoch complete!
2024-09-02 16:11:21 INFO     evaluating now!
2024-09-02 16:11:21 INFO     Epoch [72/200] train_loss: 3.4334, val_loss: 4.7990, lr: 0.003000, 5.23s
2024-09-02 16:11:26 INFO     epoch complete!
2024-09-02 16:11:26 INFO     evaluating now!
2024-09-02 16:11:26 INFO     Epoch [73/200] train_loss: 3.4109, val_loss: 4.9753, lr: 0.003000, 5.28s
2024-09-02 16:11:31 INFO     epoch complete!
2024-09-02 16:11:31 INFO     evaluating now!
2024-09-02 16:11:31 INFO     Epoch [74/200] train_loss: 3.4269, val_loss: 4.8810, lr: 0.003000, 5.23s
2024-09-02 16:11:36 INFO     epoch complete!
2024-09-02 16:11:36 INFO     evaluating now!
2024-09-02 16:11:37 INFO     Epoch [75/200] train_loss: 3.4701, val_loss: 4.8224, lr: 0.003000, 5.25s
2024-09-02 16:11:42 INFO     epoch complete!
2024-09-02 16:11:42 INFO     evaluating now!
2024-09-02 16:11:42 INFO     Epoch [76/200] train_loss: 3.3532, val_loss: 4.7904, lr: 0.003000, 5.27s
2024-09-02 16:11:47 INFO     epoch complete!
2024-09-02 16:11:47 INFO     evaluating now!
2024-09-02 16:11:47 INFO     Epoch [77/200] train_loss: 3.3399, val_loss: 4.8894, lr: 0.003000, 5.23s
2024-09-02 16:11:52 INFO     epoch complete!
2024-09-02 16:11:52 INFO     evaluating now!
2024-09-02 16:11:53 INFO     Epoch [78/200] train_loss: 3.3430, val_loss: 4.8596, lr: 0.003000, 5.35s
2024-09-02 16:11:57 INFO     epoch complete!
2024-09-02 16:11:57 INFO     evaluating now!
2024-09-02 16:11:58 INFO     Epoch [79/200] train_loss: 3.3477, val_loss: 4.9161, lr: 0.003000, 5.24s
2024-09-02 16:12:03 INFO     epoch complete!
2024-09-02 16:12:03 INFO     evaluating now!
2024-09-02 16:12:03 INFO     Epoch [80/200] train_loss: 3.3846, val_loss: 4.8281, lr: 0.003000, 5.25s
2024-09-02 16:12:08 INFO     epoch complete!
2024-09-02 16:12:08 INFO     evaluating now!
2024-09-02 16:12:08 INFO     Epoch [81/200] train_loss: 3.3616, val_loss: 4.8013, lr: 0.003000, 5.25s
2024-09-02 16:12:13 INFO     epoch complete!
2024-09-02 16:12:13 INFO     evaluating now!
2024-09-02 16:12:13 INFO     Epoch [82/200] train_loss: 3.2858, val_loss: 4.8123, lr: 0.003000, 5.23s
2024-09-02 16:12:18 INFO     epoch complete!
2024-09-02 16:12:18 INFO     evaluating now!
2024-09-02 16:12:19 INFO     Epoch [83/200] train_loss: 3.3077, val_loss: 4.8525, lr: 0.003000, 5.21s
2024-09-02 16:12:24 INFO     epoch complete!
2024-09-02 16:12:24 INFO     evaluating now!
2024-09-02 16:12:24 INFO     Epoch [84/200] train_loss: 3.2959, val_loss: 4.8593, lr: 0.003000, 5.22s
2024-09-02 16:12:29 INFO     epoch complete!
2024-09-02 16:12:29 INFO     evaluating now!
2024-09-02 16:12:29 INFO     Epoch [85/200] train_loss: 3.2903, val_loss: 4.8440, lr: 0.003000, 5.20s
2024-09-02 16:12:29 WARNING  Early stopping at epoch: 85
2024-09-02 16:12:29 INFO     Trained totally 86 epochs, average train time is 4.960s, average eval time is 0.323s
2024-09-02 16:12:29 INFO     Loaded model at 70
2024-09-02 16:12:29 INFO     Saved model at ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 16:12:29 INFO     Start evaluating ...
2024-09-02 16:12:30 INFO     Note that you select the single mode to evaluate!
2024-09-02 16:12:30 INFO     Evaluate result is saved at ./libcity/cache/40/evaluate_cache\2024_09_02_16_12_30_AGCRN_CHITaxi20190406.csv
2024-09-02 16:12:30 INFO     
         MAE       RMSE
1   2.454361   6.891474
2   2.517386   7.401975
3   2.609029   8.291483
4   2.799517   9.235040
5   2.955039  10.314922
6   3.135290  11.327644
7   3.203719  12.076668
8   3.212860  12.434278
9   3.224708  12.561575
10  3.254659  12.664104
11  3.299725  12.955781
12  3.469276  13.478677
2024-09-02 16:12:30 INFO     ----------------------------------------------------------------------------
2024-09-02 16:12:30 INFO     # 2, Kownledge Graph Embedding: RefH, Experiment ids: 42
2024-09-02 16:12:30 INFO     ----------------------------------------------------------------------------
2024-09-02 16:12:30 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=40
2024-09-02 16:12:30 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 40, 'embedding_model': 'RefH', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 16:12:30 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 16:12:30 INFO     set_weight_link_or_dist: dist
2024-09-02 16:12:30 INFO     init_weight_inf_or_zero: inf
2024-09-02 16:12:30 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 16:12:30 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 16:12:30 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 16:12:30 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 16:12:32 INFO     Dataset created
2024-09-02 16:12:32 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 16:12:32 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 16:12:32 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 16:12:32 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 16:12:32 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 16:12:32 INFO     NormalScaler max: 0.39871441235290517
2024-09-02 16:12:34 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 16:12:34 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 16:12:34 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 16:12:34 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 16:12:34 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 16:12:34 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 16:12:34 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 16:12:34 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 16:12:34 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 16:12:34 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 16:12:34 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 16:12:34 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 16:12:34 INFO     Total parameter numbers: 874010
2024-09-02 16:12:34 INFO     You select `adam` optimizer.
2024-09-02 16:12:34 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 16:12:34 INFO     Start training ...
2024-09-02 16:12:34 INFO     num_batches:48
2024-09-02 16:12:40 INFO     epoch complete!
2024-09-02 16:12:40 INFO     evaluating now!
2024-09-02 16:12:40 INFO     Epoch [0/200] train_loss: 24.1619, val_loss: 18.7107, lr: 0.003000, 5.51s
2024-09-02 16:12:40 INFO     Saved model at 0
2024-09-02 16:12:40 INFO     Val loss decrease from inf to 18.7107, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 16:12:45 INFO     epoch complete!
2024-09-02 16:12:45 INFO     evaluating now!
2024-09-02 16:12:45 INFO     Epoch [1/200] train_loss: 15.5584, val_loss: 15.4428, lr: 0.003000, 5.15s
2024-09-02 16:12:45 INFO     Saved model at 1
2024-09-02 16:12:45 INFO     Val loss decrease from 18.7107 to 15.4428, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 16:12:50 INFO     epoch complete!
2024-09-02 16:12:50 INFO     evaluating now!
2024-09-02 16:12:50 INFO     Epoch [2/200] train_loss: 12.7411, val_loss: 12.2559, lr: 0.003000, 5.16s
2024-09-02 16:12:50 INFO     Saved model at 2
2024-09-02 16:12:50 INFO     Val loss decrease from 15.4428 to 12.2559, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 16:12:55 INFO     epoch complete!
2024-09-02 16:12:55 INFO     evaluating now!
2024-09-02 16:12:56 INFO     Epoch [3/200] train_loss: 10.2874, val_loss: 9.7117, lr: 0.003000, 5.19s
2024-09-02 16:12:56 INFO     Saved model at 3
2024-09-02 16:12:56 INFO     Val loss decrease from 12.2559 to 9.7117, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 16:13:00 INFO     epoch complete!
2024-09-02 16:13:00 INFO     evaluating now!
2024-09-02 16:13:01 INFO     Epoch [4/200] train_loss: 8.7791, val_loss: 8.4920, lr: 0.003000, 5.16s
2024-09-02 16:13:01 INFO     Saved model at 4
2024-09-02 16:13:01 INFO     Val loss decrease from 9.7117 to 8.4920, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 16:13:06 INFO     epoch complete!
2024-09-02 16:13:06 INFO     evaluating now!
2024-09-02 16:13:06 INFO     Epoch [5/200] train_loss: 7.8800, val_loss: 7.5376, lr: 0.003000, 5.22s
2024-09-02 16:13:06 INFO     Saved model at 5
2024-09-02 16:13:06 INFO     Val loss decrease from 8.4920 to 7.5376, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 16:13:11 INFO     epoch complete!
2024-09-02 16:13:11 INFO     evaluating now!
2024-09-02 16:13:11 INFO     Epoch [6/200] train_loss: 7.1882, val_loss: 7.0696, lr: 0.003000, 5.17s
2024-09-02 16:13:11 INFO     Saved model at 6
2024-09-02 16:13:11 INFO     Val loss decrease from 7.5376 to 7.0696, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 16:13:16 INFO     epoch complete!
2024-09-02 16:13:16 INFO     evaluating now!
2024-09-02 16:13:16 INFO     Epoch [7/200] train_loss: 6.7357, val_loss: 6.7287, lr: 0.003000, 5.11s
2024-09-02 16:13:16 INFO     Saved model at 7
2024-09-02 16:13:16 INFO     Val loss decrease from 7.0696 to 6.7287, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 16:13:21 INFO     epoch complete!
2024-09-02 16:13:21 INFO     evaluating now!
2024-09-02 16:13:21 INFO     Epoch [8/200] train_loss: 6.5115, val_loss: 6.6794, lr: 0.003000, 5.12s
2024-09-02 16:13:21 INFO     Saved model at 8
2024-09-02 16:13:21 INFO     Val loss decrease from 6.7287 to 6.6794, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 16:13:26 INFO     epoch complete!
2024-09-02 16:13:26 INFO     evaluating now!
2024-09-02 16:13:27 INFO     Epoch [9/200] train_loss: 6.1514, val_loss: 6.2431, lr: 0.003000, 5.18s
2024-09-02 16:13:27 INFO     Saved model at 9
2024-09-02 16:13:27 INFO     Val loss decrease from 6.6794 to 6.2431, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 16:13:31 INFO     epoch complete!
2024-09-02 16:13:31 INFO     evaluating now!
2024-09-02 16:13:32 INFO     Epoch [10/200] train_loss: 5.8862, val_loss: 6.1880, lr: 0.003000, 5.15s
2024-09-02 16:13:32 INFO     Saved model at 10
2024-09-02 16:13:32 INFO     Val loss decrease from 6.2431 to 6.1880, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 16:13:37 INFO     epoch complete!
2024-09-02 16:13:37 INFO     evaluating now!
2024-09-02 16:13:37 INFO     Epoch [11/200] train_loss: 5.7487, val_loss: 6.0288, lr: 0.003000, 5.12s
2024-09-02 16:13:37 INFO     Saved model at 11
2024-09-02 16:13:37 INFO     Val loss decrease from 6.1880 to 6.0288, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 16:13:42 INFO     epoch complete!
2024-09-02 16:13:42 INFO     evaluating now!
2024-09-02 16:13:42 INFO     Epoch [12/200] train_loss: 5.6567, val_loss: 6.1261, lr: 0.003000, 5.19s
2024-09-02 16:13:47 INFO     epoch complete!
2024-09-02 16:13:47 INFO     evaluating now!
2024-09-02 16:13:47 INFO     Epoch [13/200] train_loss: 5.4716, val_loss: 5.9219, lr: 0.003000, 5.12s
2024-09-02 16:13:47 INFO     Saved model at 13
2024-09-02 16:13:47 INFO     Val loss decrease from 6.0288 to 5.9219, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 16:13:52 INFO     epoch complete!
2024-09-02 16:13:52 INFO     evaluating now!
2024-09-02 16:13:52 INFO     Epoch [14/200] train_loss: 5.4525, val_loss: 5.8733, lr: 0.003000, 5.18s
2024-09-02 16:13:52 INFO     Saved model at 14
2024-09-02 16:13:52 INFO     Val loss decrease from 5.9219 to 5.8733, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-02 16:13:57 INFO     epoch complete!
2024-09-02 16:13:57 INFO     evaluating now!
2024-09-02 16:13:57 INFO     Epoch [15/200] train_loss: 5.3804, val_loss: 5.9129, lr: 0.003000, 5.10s
2024-09-02 16:14:02 INFO     epoch complete!
2024-09-02 16:14:02 INFO     evaluating now!
2024-09-02 16:14:03 INFO     Epoch [16/200] train_loss: 5.2773, val_loss: 5.6745, lr: 0.003000, 5.11s
2024-09-02 16:14:03 INFO     Saved model at 16
2024-09-02 16:14:03 INFO     Val loss decrease from 5.8733 to 5.6745, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 16:14:07 INFO     epoch complete!
2024-09-02 16:14:07 INFO     evaluating now!
2024-09-02 16:14:08 INFO     Epoch [17/200] train_loss: 5.2266, val_loss: 5.7198, lr: 0.003000, 5.16s
2024-09-02 16:14:13 INFO     epoch complete!
2024-09-02 16:14:13 INFO     evaluating now!
2024-09-02 16:14:13 INFO     Epoch [18/200] train_loss: 5.0493, val_loss: 5.5836, lr: 0.003000, 5.14s
2024-09-02 16:14:13 INFO     Saved model at 18
2024-09-02 16:14:13 INFO     Val loss decrease from 5.6745 to 5.5836, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-02 16:14:18 INFO     epoch complete!
2024-09-02 16:14:18 INFO     evaluating now!
2024-09-02 16:14:18 INFO     Epoch [19/200] train_loss: 4.9809, val_loss: 5.4718, lr: 0.003000, 5.10s
2024-09-02 16:14:18 INFO     Saved model at 19
2024-09-02 16:14:18 INFO     Val loss decrease from 5.5836 to 5.4718, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-02 16:14:23 INFO     epoch complete!
2024-09-02 16:14:23 INFO     evaluating now!
2024-09-02 16:14:23 INFO     Epoch [20/200] train_loss: 4.9160, val_loss: 5.8746, lr: 0.003000, 5.18s
2024-09-02 16:14:28 INFO     epoch complete!
2024-09-02 16:14:28 INFO     evaluating now!
2024-09-02 16:14:28 INFO     Epoch [21/200] train_loss: 4.8574, val_loss: 5.2937, lr: 0.003000, 5.10s
2024-09-02 16:14:28 INFO     Saved model at 21
2024-09-02 16:14:28 INFO     Val loss decrease from 5.4718 to 5.2937, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-02 16:14:33 INFO     epoch complete!
2024-09-02 16:14:33 INFO     evaluating now!
2024-09-02 16:14:33 INFO     Epoch [22/200] train_loss: 4.8558, val_loss: 5.5486, lr: 0.003000, 5.11s
2024-09-02 16:14:38 INFO     epoch complete!
2024-09-02 16:14:38 INFO     evaluating now!
2024-09-02 16:14:39 INFO     Epoch [23/200] train_loss: 4.7509, val_loss: 5.3538, lr: 0.003000, 5.17s
2024-09-02 16:14:43 INFO     epoch complete!
2024-09-02 16:14:43 INFO     evaluating now!
2024-09-02 16:14:44 INFO     Epoch [24/200] train_loss: 4.6768, val_loss: 5.3222, lr: 0.003000, 5.14s
2024-09-02 16:14:49 INFO     epoch complete!
2024-09-02 16:14:49 INFO     evaluating now!
2024-09-02 16:14:49 INFO     Epoch [25/200] train_loss: 4.7543, val_loss: 5.3642, lr: 0.003000, 5.12s
2024-09-02 16:14:54 INFO     epoch complete!
2024-09-02 16:14:54 INFO     evaluating now!
2024-09-02 16:14:54 INFO     Epoch [26/200] train_loss: 4.6563, val_loss: 5.2177, lr: 0.003000, 5.18s
2024-09-02 16:14:54 INFO     Saved model at 26
2024-09-02 16:14:54 INFO     Val loss decrease from 5.2937 to 5.2177, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-02 16:14:59 INFO     epoch complete!
2024-09-02 16:14:59 INFO     evaluating now!
2024-09-02 16:14:59 INFO     Epoch [27/200] train_loss: 4.5535, val_loss: 5.1569, lr: 0.003000, 5.12s
2024-09-02 16:14:59 INFO     Saved model at 27
2024-09-02 16:14:59 INFO     Val loss decrease from 5.2177 to 5.1569, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-02 16:15:04 INFO     epoch complete!
2024-09-02 16:15:04 INFO     evaluating now!
2024-09-02 16:15:04 INFO     Epoch [28/200] train_loss: 4.4839, val_loss: 5.2843, lr: 0.003000, 5.13s
2024-09-02 16:15:09 INFO     epoch complete!
2024-09-02 16:15:09 INFO     evaluating now!
2024-09-02 16:15:09 INFO     Epoch [29/200] train_loss: 4.4307, val_loss: 5.3101, lr: 0.003000, 5.16s
2024-09-02 16:15:14 INFO     epoch complete!
2024-09-02 16:15:14 INFO     evaluating now!
2024-09-02 16:15:15 INFO     Epoch [30/200] train_loss: 4.4346, val_loss: 5.4027, lr: 0.003000, 5.11s
2024-09-02 16:15:19 INFO     epoch complete!
2024-09-02 16:15:19 INFO     evaluating now!
2024-09-02 16:15:20 INFO     Epoch [31/200] train_loss: 4.3945, val_loss: 5.1723, lr: 0.003000, 5.09s
2024-09-02 16:15:25 INFO     epoch complete!
2024-09-02 16:15:25 INFO     evaluating now!
2024-09-02 16:15:25 INFO     Epoch [32/200] train_loss: 4.2910, val_loss: 5.0504, lr: 0.003000, 5.14s
2024-09-02 16:15:25 INFO     Saved model at 32
2024-09-02 16:15:25 INFO     Val loss decrease from 5.1569 to 5.0504, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-09-02 16:15:30 INFO     epoch complete!
2024-09-02 16:15:30 INFO     evaluating now!
2024-09-02 16:15:30 INFO     Epoch [33/200] train_loss: 4.2716, val_loss: 5.0608, lr: 0.003000, 5.12s
2024-09-02 16:15:35 INFO     epoch complete!
2024-09-02 16:15:35 INFO     evaluating now!
2024-09-02 16:15:35 INFO     Epoch [34/200] train_loss: 4.2422, val_loss: 5.1653, lr: 0.003000, 5.11s
2024-09-02 16:15:40 INFO     epoch complete!
2024-09-02 16:15:40 INFO     evaluating now!
2024-09-02 16:15:40 INFO     Epoch [35/200] train_loss: 4.2697, val_loss: 4.9591, lr: 0.003000, 5.18s
2024-09-02 16:15:40 INFO     Saved model at 35
2024-09-02 16:15:40 INFO     Val loss decrease from 5.0504 to 4.9591, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-02 16:15:45 INFO     epoch complete!
2024-09-02 16:15:45 INFO     evaluating now!
2024-09-02 16:15:45 INFO     Epoch [36/200] train_loss: 4.1808, val_loss: 5.1060, lr: 0.003000, 5.12s
2024-09-02 16:15:50 INFO     epoch complete!
2024-09-02 16:15:50 INFO     evaluating now!
2024-09-02 16:15:50 INFO     Epoch [37/200] train_loss: 4.2063, val_loss: 5.1131, lr: 0.003000, 5.10s
2024-09-02 16:15:55 INFO     epoch complete!
2024-09-02 16:15:55 INFO     evaluating now!
2024-09-02 16:15:56 INFO     Epoch [38/200] train_loss: 4.1625, val_loss: 5.0951, lr: 0.003000, 5.13s
2024-09-02 16:16:00 INFO     epoch complete!
2024-09-02 16:16:00 INFO     evaluating now!
2024-09-02 16:16:01 INFO     Epoch [39/200] train_loss: 4.0950, val_loss: 5.1404, lr: 0.003000, 5.09s
2024-09-02 16:16:06 INFO     epoch complete!
2024-09-02 16:16:06 INFO     evaluating now!
2024-09-02 16:16:06 INFO     Epoch [40/200] train_loss: 4.0671, val_loss: 4.9871, lr: 0.003000, 5.10s
2024-09-02 16:16:11 INFO     epoch complete!
2024-09-02 16:16:11 INFO     evaluating now!
2024-09-02 16:16:11 INFO     Epoch [41/200] train_loss: 4.0116, val_loss: 5.0438, lr: 0.003000, 5.12s
2024-09-02 16:16:16 INFO     epoch complete!
2024-09-02 16:16:16 INFO     evaluating now!
2024-09-02 16:16:16 INFO     Epoch [42/200] train_loss: 4.0232, val_loss: 5.0333, lr: 0.003000, 5.25s
2024-09-02 16:16:23 INFO     epoch complete!
2024-09-02 16:16:23 INFO     evaluating now!
2024-09-02 16:16:23 INFO     Epoch [43/200] train_loss: 4.0415, val_loss: 5.0857, lr: 0.003000, 6.75s
2024-09-02 16:16:28 INFO     epoch complete!
2024-09-02 16:16:28 INFO     evaluating now!
2024-09-02 16:16:28 INFO     Epoch [44/200] train_loss: 4.0025, val_loss: 5.1432, lr: 0.003000, 5.07s
2024-09-02 16:16:33 INFO     epoch complete!
2024-09-02 16:16:33 INFO     evaluating now!
2024-09-02 16:16:33 INFO     Epoch [45/200] train_loss: 3.9524, val_loss: 5.0299, lr: 0.003000, 5.07s
2024-09-02 16:16:38 INFO     epoch complete!
2024-09-02 16:16:38 INFO     evaluating now!
2024-09-02 16:16:38 INFO     Epoch [46/200] train_loss: 4.0028, val_loss: 5.2288, lr: 0.003000, 5.06s
2024-09-02 16:16:43 INFO     epoch complete!
2024-09-02 16:16:43 INFO     evaluating now!
2024-09-02 16:16:43 INFO     Epoch [47/200] train_loss: 3.9874, val_loss: 5.1981, lr: 0.003000, 5.07s
2024-09-02 16:16:48 INFO     epoch complete!
2024-09-02 16:16:48 INFO     evaluating now!
2024-09-02 16:16:48 INFO     Epoch [48/200] train_loss: 3.8916, val_loss: 5.1338, lr: 0.003000, 5.06s
2024-09-02 16:16:53 INFO     epoch complete!
2024-09-02 16:16:53 INFO     evaluating now!
2024-09-02 16:16:53 INFO     Epoch [49/200] train_loss: 3.8687, val_loss: 5.0653, lr: 0.003000, 5.08s
2024-09-02 16:16:58 INFO     epoch complete!
2024-09-02 16:16:58 INFO     evaluating now!
2024-09-02 16:16:58 INFO     Epoch [50/200] train_loss: 3.8501, val_loss: 5.0747, lr: 0.003000, 5.07s
2024-09-02 16:16:58 WARNING  Early stopping at epoch: 50
2024-09-02 16:16:58 INFO     Trained totally 51 epochs, average train time is 4.861s, average eval time is 0.308s
2024-09-02 16:16:58 INFO     Loaded model at 35
2024-09-02 16:16:58 INFO     Saved model at ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 16:16:58 INFO     Start evaluating ...
2024-09-02 16:16:59 INFO     Note that you select the single mode to evaluate!
2024-09-02 16:16:59 INFO     Evaluate result is saved at ./libcity/cache/40/evaluate_cache\2024_09_02_16_16_59_AGCRN_CHITaxi20190406.csv
2024-09-02 16:16:59 INFO     
         MAE       RMSE
1   2.479372   7.199661
2   2.535694   7.667127
3   2.604137   8.631692
4   2.673366   9.332254
5   2.808858  10.052991
6   2.919375  10.689149
7   3.042080  11.276546
8   3.063280  11.752619
9   3.069909  12.131851
10  3.106910  12.400772
11  3.129199  12.782140
12  3.271868  13.443246
2024-09-02 16:17:00 INFO     ----------------------------------------------------------------------------
2024-09-02 16:17:00 INFO     # 3, Kownledge Graph Embedding: RefH, Experiment ids: 43
2024-09-02 16:17:00 INFO     ----------------------------------------------------------------------------
2024-09-02 16:17:00 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=40
2024-09-02 16:17:00 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 40, 'embedding_model': 'RefH', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 16:17:00 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 16:17:00 INFO     set_weight_link_or_dist: dist
2024-09-02 16:17:00 INFO     init_weight_inf_or_zero: inf
2024-09-02 16:17:00 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 16:17:00 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 16:17:00 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 16:17:00 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 16:17:01 INFO     Dataset created
2024-09-02 16:17:01 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 16:17:01 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 16:17:01 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 16:17:01 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 16:17:01 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 16:17:02 INFO     NormalScaler max: 0.39871441235290517
2024-09-02 16:17:04 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 16:17:04 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 16:17:04 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 16:17:04 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 16:17:04 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 16:17:04 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 16:17:04 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 16:17:04 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 16:17:04 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 16:17:04 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 16:17:04 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 16:17:04 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 16:17:04 INFO     Total parameter numbers: 874010
2024-09-02 16:17:04 INFO     You select `adam` optimizer.
2024-09-02 16:17:04 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 16:17:04 INFO     Start training ...
2024-09-02 16:17:04 INFO     num_batches:48
2024-09-02 16:17:09 INFO     epoch complete!
2024-09-02 16:17:09 INFO     evaluating now!
2024-09-02 16:17:09 INFO     Epoch [0/200] train_loss: 24.1927, val_loss: 18.4202, lr: 0.003000, 5.45s
2024-09-02 16:17:09 INFO     Saved model at 0
2024-09-02 16:17:09 INFO     Val loss decrease from inf to 18.4202, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 16:17:14 INFO     epoch complete!
2024-09-02 16:17:14 INFO     evaluating now!
2024-09-02 16:17:14 INFO     Epoch [1/200] train_loss: 14.8695, val_loss: 14.4230, lr: 0.003000, 5.12s
2024-09-02 16:17:14 INFO     Saved model at 1
2024-09-02 16:17:14 INFO     Val loss decrease from 18.4202 to 14.4230, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 16:17:19 INFO     epoch complete!
2024-09-02 16:17:19 INFO     evaluating now!
2024-09-02 16:17:19 INFO     Epoch [2/200] train_loss: 11.9235, val_loss: 11.5178, lr: 0.003000, 5.08s
2024-09-02 16:17:19 INFO     Saved model at 2
2024-09-02 16:17:19 INFO     Val loss decrease from 14.4230 to 11.5178, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 16:17:24 INFO     epoch complete!
2024-09-02 16:17:24 INFO     evaluating now!
2024-09-02 16:17:25 INFO     Epoch [3/200] train_loss: 9.6556, val_loss: 9.2965, lr: 0.003000, 5.14s
2024-09-02 16:17:25 INFO     Saved model at 3
2024-09-02 16:17:25 INFO     Val loss decrease from 11.5178 to 9.2965, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 16:17:29 INFO     epoch complete!
2024-09-02 16:17:29 INFO     evaluating now!
2024-09-02 16:17:30 INFO     Epoch [4/200] train_loss: 8.2370, val_loss: 7.7979, lr: 0.003000, 5.16s
2024-09-02 16:17:30 INFO     Saved model at 4
2024-09-02 16:17:30 INFO     Val loss decrease from 9.2965 to 7.7979, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 16:17:35 INFO     epoch complete!
2024-09-02 16:17:35 INFO     evaluating now!
2024-09-02 16:17:35 INFO     Epoch [5/200] train_loss: 7.3109, val_loss: 7.0406, lr: 0.003000, 5.31s
2024-09-02 16:17:35 INFO     Saved model at 5
2024-09-02 16:17:35 INFO     Val loss decrease from 7.7979 to 7.0406, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 16:17:40 INFO     epoch complete!
2024-09-02 16:17:40 INFO     evaluating now!
2024-09-02 16:17:40 INFO     Epoch [6/200] train_loss: 6.7984, val_loss: 6.8484, lr: 0.003000, 5.33s
2024-09-02 16:17:40 INFO     Saved model at 6
2024-09-02 16:17:40 INFO     Val loss decrease from 7.0406 to 6.8484, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 16:17:45 INFO     epoch complete!
2024-09-02 16:17:45 INFO     evaluating now!
2024-09-02 16:17:46 INFO     Epoch [7/200] train_loss: 6.4547, val_loss: 6.4651, lr: 0.003000, 5.28s
2024-09-02 16:17:46 INFO     Saved model at 7
2024-09-02 16:17:46 INFO     Val loss decrease from 6.8484 to 6.4651, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 16:17:50 INFO     epoch complete!
2024-09-02 16:17:50 INFO     evaluating now!
2024-09-02 16:17:51 INFO     Epoch [8/200] train_loss: 6.1501, val_loss: 6.5266, lr: 0.003000, 5.13s
2024-09-02 16:17:56 INFO     epoch complete!
2024-09-02 16:17:56 INFO     evaluating now!
2024-09-02 16:17:56 INFO     Epoch [9/200] train_loss: 5.9055, val_loss: 5.9643, lr: 0.003000, 5.20s
2024-09-02 16:17:56 INFO     Saved model at 9
2024-09-02 16:17:56 INFO     Val loss decrease from 6.4651 to 5.9643, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 16:18:01 INFO     epoch complete!
2024-09-02 16:18:01 INFO     evaluating now!
2024-09-02 16:18:01 INFO     Epoch [10/200] train_loss: 5.7533, val_loss: 6.1500, lr: 0.003000, 5.12s
2024-09-02 16:18:06 INFO     epoch complete!
2024-09-02 16:18:06 INFO     evaluating now!
2024-09-02 16:18:06 INFO     Epoch [11/200] train_loss: 5.6060, val_loss: 5.8574, lr: 0.003000, 5.17s
2024-09-02 16:18:06 INFO     Saved model at 11
2024-09-02 16:18:06 INFO     Val loss decrease from 5.9643 to 5.8574, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 16:18:11 INFO     epoch complete!
2024-09-02 16:18:11 INFO     evaluating now!
2024-09-02 16:18:11 INFO     Epoch [12/200] train_loss: 5.5287, val_loss: 5.7596, lr: 0.003000, 5.18s
2024-09-02 16:18:12 INFO     Saved model at 12
2024-09-02 16:18:12 INFO     Val loss decrease from 5.8574 to 5.7596, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 16:18:16 INFO     epoch complete!
2024-09-02 16:18:16 INFO     evaluating now!
2024-09-02 16:18:17 INFO     Epoch [13/200] train_loss: 5.3747, val_loss: 5.6564, lr: 0.003000, 5.13s
2024-09-02 16:18:17 INFO     Saved model at 13
2024-09-02 16:18:17 INFO     Val loss decrease from 5.7596 to 5.6564, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 16:18:22 INFO     epoch complete!
2024-09-02 16:18:22 INFO     evaluating now!
2024-09-02 16:18:22 INFO     Epoch [14/200] train_loss: 5.2782, val_loss: 5.7196, lr: 0.003000, 5.16s
2024-09-02 16:18:27 INFO     epoch complete!
2024-09-02 16:18:27 INFO     evaluating now!
2024-09-02 16:18:27 INFO     Epoch [15/200] train_loss: 5.1491, val_loss: 5.6433, lr: 0.003000, 5.18s
2024-09-02 16:18:27 INFO     Saved model at 15
2024-09-02 16:18:27 INFO     Val loss decrease from 5.6564 to 5.6433, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 16:18:32 INFO     epoch complete!
2024-09-02 16:18:32 INFO     evaluating now!
2024-09-02 16:18:32 INFO     Epoch [16/200] train_loss: 5.2086, val_loss: 5.7027, lr: 0.003000, 5.14s
2024-09-02 16:18:37 INFO     epoch complete!
2024-09-02 16:18:37 INFO     evaluating now!
2024-09-02 16:18:37 INFO     Epoch [17/200] train_loss: 5.1243, val_loss: 5.7416, lr: 0.003000, 5.14s
2024-09-02 16:18:42 INFO     epoch complete!
2024-09-02 16:18:42 INFO     evaluating now!
2024-09-02 16:18:43 INFO     Epoch [18/200] train_loss: 4.9625, val_loss: 5.6417, lr: 0.003000, 5.22s
2024-09-02 16:18:43 INFO     Saved model at 18
2024-09-02 16:18:43 INFO     Val loss decrease from 5.6433 to 5.6417, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-02 16:18:47 INFO     epoch complete!
2024-09-02 16:18:47 INFO     evaluating now!
2024-09-02 16:18:48 INFO     Epoch [19/200] train_loss: 4.8726, val_loss: 5.4994, lr: 0.003000, 5.14s
2024-09-02 16:18:48 INFO     Saved model at 19
2024-09-02 16:18:48 INFO     Val loss decrease from 5.6417 to 5.4994, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-02 16:18:52 INFO     epoch complete!
2024-09-02 16:18:52 INFO     evaluating now!
2024-09-02 16:18:53 INFO     Epoch [20/200] train_loss: 4.8107, val_loss: 5.3322, lr: 0.003000, 5.13s
2024-09-02 16:18:53 INFO     Saved model at 20
2024-09-02 16:18:53 INFO     Val loss decrease from 5.4994 to 5.3322, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-02 16:18:58 INFO     epoch complete!
2024-09-02 16:18:58 INFO     evaluating now!
2024-09-02 16:18:58 INFO     Epoch [21/200] train_loss: 4.6987, val_loss: 5.3653, lr: 0.003000, 5.19s
2024-09-02 16:19:03 INFO     epoch complete!
2024-09-02 16:19:03 INFO     evaluating now!
2024-09-02 16:19:03 INFO     Epoch [22/200] train_loss: 4.8199, val_loss: 5.4153, lr: 0.003000, 5.16s
2024-09-02 16:19:08 INFO     epoch complete!
2024-09-02 16:19:08 INFO     evaluating now!
2024-09-02 16:19:08 INFO     Epoch [23/200] train_loss: 4.6880, val_loss: 5.2119, lr: 0.003000, 5.13s
2024-09-02 16:19:08 INFO     Saved model at 23
2024-09-02 16:19:08 INFO     Val loss decrease from 5.3322 to 5.2119, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-02 16:19:13 INFO     epoch complete!
2024-09-02 16:19:13 INFO     evaluating now!
2024-09-02 16:19:14 INFO     Epoch [24/200] train_loss: 4.6483, val_loss: 5.2209, lr: 0.003000, 5.23s
2024-09-02 16:19:18 INFO     epoch complete!
2024-09-02 16:19:18 INFO     evaluating now!
2024-09-02 16:19:19 INFO     Epoch [25/200] train_loss: 4.5667, val_loss: 5.2956, lr: 0.003000, 5.15s
2024-09-02 16:19:24 INFO     epoch complete!
2024-09-02 16:19:24 INFO     evaluating now!
2024-09-02 16:19:24 INFO     Epoch [26/200] train_loss: 4.4964, val_loss: 5.1878, lr: 0.003000, 5.15s
2024-09-02 16:19:24 INFO     Saved model at 26
2024-09-02 16:19:24 INFO     Val loss decrease from 5.2119 to 5.1878, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-02 16:19:29 INFO     epoch complete!
2024-09-02 16:19:29 INFO     evaluating now!
2024-09-02 16:19:29 INFO     Epoch [27/200] train_loss: 4.4943, val_loss: 5.2217, lr: 0.003000, 5.18s
2024-09-02 16:19:34 INFO     epoch complete!
2024-09-02 16:19:34 INFO     evaluating now!
2024-09-02 16:19:34 INFO     Epoch [28/200] train_loss: 4.4390, val_loss: 5.2206, lr: 0.003000, 5.14s
2024-09-02 16:19:39 INFO     epoch complete!
2024-09-02 16:19:39 INFO     evaluating now!
2024-09-02 16:19:39 INFO     Epoch [29/200] train_loss: 4.3166, val_loss: 5.1755, lr: 0.003000, 5.20s
2024-09-02 16:19:39 INFO     Saved model at 29
2024-09-02 16:19:39 INFO     Val loss decrease from 5.1878 to 5.1755, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-02 16:19:44 INFO     epoch complete!
2024-09-02 16:19:44 INFO     evaluating now!
2024-09-02 16:19:45 INFO     Epoch [30/200] train_loss: 4.3523, val_loss: 5.1758, lr: 0.003000, 5.19s
2024-09-02 16:19:49 INFO     epoch complete!
2024-09-02 16:19:49 INFO     evaluating now!
2024-09-02 16:19:50 INFO     Epoch [31/200] train_loss: 4.2375, val_loss: 5.5802, lr: 0.003000, 5.16s
2024-09-02 16:19:55 INFO     epoch complete!
2024-09-02 16:19:55 INFO     evaluating now!
2024-09-02 16:19:55 INFO     Epoch [32/200] train_loss: 4.2091, val_loss: 5.0719, lr: 0.003000, 5.21s
2024-09-02 16:19:55 INFO     Saved model at 32
2024-09-02 16:19:55 INFO     Val loss decrease from 5.1755 to 5.0719, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-09-02 16:20:00 INFO     epoch complete!
2024-09-02 16:20:00 INFO     evaluating now!
2024-09-02 16:20:00 INFO     Epoch [33/200] train_loss: 4.1739, val_loss: 5.3327, lr: 0.003000, 5.15s
2024-09-02 16:20:05 INFO     epoch complete!
2024-09-02 16:20:05 INFO     evaluating now!
2024-09-02 16:20:05 INFO     Epoch [34/200] train_loss: 4.2862, val_loss: 5.2966, lr: 0.003000, 5.20s
2024-09-02 16:20:10 INFO     epoch complete!
2024-09-02 16:20:10 INFO     evaluating now!
2024-09-02 16:20:11 INFO     Epoch [35/200] train_loss: 4.2153, val_loss: 5.2502, lr: 0.003000, 5.28s
2024-09-02 16:20:15 INFO     epoch complete!
2024-09-02 16:20:15 INFO     evaluating now!
2024-09-02 16:20:16 INFO     Epoch [36/200] train_loss: 4.1394, val_loss: 5.1146, lr: 0.003000, 5.12s
2024-09-02 16:20:21 INFO     epoch complete!
2024-09-02 16:20:21 INFO     evaluating now!
2024-09-02 16:20:21 INFO     Epoch [37/200] train_loss: 4.0373, val_loss: 5.0856, lr: 0.003000, 5.16s
2024-09-02 16:20:26 INFO     epoch complete!
2024-09-02 16:20:26 INFO     evaluating now!
2024-09-02 16:20:26 INFO     Epoch [38/200] train_loss: 4.0742, val_loss: 5.1961, lr: 0.003000, 5.20s
2024-09-02 16:20:31 INFO     epoch complete!
2024-09-02 16:20:31 INFO     evaluating now!
2024-09-02 16:20:31 INFO     Epoch [39/200] train_loss: 4.0034, val_loss: 5.2073, lr: 0.003000, 5.15s
2024-09-02 16:20:36 INFO     epoch complete!
2024-09-02 16:20:36 INFO     evaluating now!
2024-09-02 16:20:36 INFO     Epoch [40/200] train_loss: 4.0078, val_loss: 5.1743, lr: 0.003000, 5.17s
2024-09-02 16:20:41 INFO     epoch complete!
2024-09-02 16:20:41 INFO     evaluating now!
2024-09-02 16:20:42 INFO     Epoch [41/200] train_loss: 3.9780, val_loss: 5.0922, lr: 0.003000, 5.23s
2024-09-02 16:20:46 INFO     epoch complete!
2024-09-02 16:20:46 INFO     evaluating now!
2024-09-02 16:20:47 INFO     Epoch [42/200] train_loss: 3.9643, val_loss: 5.2959, lr: 0.003000, 5.14s
2024-09-02 16:20:52 INFO     epoch complete!
2024-09-02 16:20:52 INFO     evaluating now!
2024-09-02 16:20:52 INFO     Epoch [43/200] train_loss: 3.9541, val_loss: 5.0574, lr: 0.003000, 5.17s
2024-09-02 16:20:52 INFO     Saved model at 43
2024-09-02 16:20:52 INFO     Val loss decrease from 5.0719 to 5.0574, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-09-02 16:20:57 INFO     epoch complete!
2024-09-02 16:20:57 INFO     evaluating now!
2024-09-02 16:20:57 INFO     Epoch [44/200] train_loss: 3.9038, val_loss: 5.0415, lr: 0.003000, 5.42s
2024-09-02 16:20:57 INFO     Saved model at 44
2024-09-02 16:20:57 INFO     Val loss decrease from 5.0574 to 5.0415, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-09-02 16:21:02 INFO     epoch complete!
2024-09-02 16:21:02 INFO     evaluating now!
2024-09-02 16:21:03 INFO     Epoch [45/200] train_loss: 3.8612, val_loss: 5.0561, lr: 0.003000, 5.16s
2024-09-02 16:21:07 INFO     epoch complete!
2024-09-02 16:21:07 INFO     evaluating now!
2024-09-02 16:21:08 INFO     Epoch [46/200] train_loss: 3.8678, val_loss: 5.1554, lr: 0.003000, 5.17s
2024-09-02 16:21:13 INFO     epoch complete!
2024-09-02 16:21:13 INFO     evaluating now!
2024-09-02 16:21:13 INFO     Epoch [47/200] train_loss: 3.8610, val_loss: 5.2363, lr: 0.003000, 5.31s
2024-09-02 16:21:18 INFO     epoch complete!
2024-09-02 16:21:18 INFO     evaluating now!
2024-09-02 16:21:18 INFO     Epoch [48/200] train_loss: 3.8367, val_loss: 5.2450, lr: 0.003000, 5.22s
2024-09-02 16:21:23 INFO     epoch complete!
2024-09-02 16:21:23 INFO     evaluating now!
2024-09-02 16:21:23 INFO     Epoch [49/200] train_loss: 3.8761, val_loss: 5.2060, lr: 0.003000, 5.20s
2024-09-02 16:21:28 INFO     epoch complete!
2024-09-02 16:21:28 INFO     evaluating now!
2024-09-02 16:21:29 INFO     Epoch [50/200] train_loss: 3.8516, val_loss: 5.1186, lr: 0.003000, 5.31s
2024-09-02 16:21:34 INFO     epoch complete!
2024-09-02 16:21:34 INFO     evaluating now!
2024-09-02 16:21:34 INFO     Epoch [51/200] train_loss: 3.8831, val_loss: 5.3389, lr: 0.003000, 5.16s
2024-09-02 16:21:39 INFO     epoch complete!
2024-09-02 16:21:39 INFO     evaluating now!
2024-09-02 16:21:39 INFO     Epoch [52/200] train_loss: 3.8546, val_loss: 5.0691, lr: 0.003000, 5.17s
2024-09-02 16:21:44 INFO     epoch complete!
2024-09-02 16:21:44 INFO     evaluating now!
2024-09-02 16:21:44 INFO     Epoch [53/200] train_loss: 3.7340, val_loss: 5.1186, lr: 0.003000, 5.35s
2024-09-02 16:21:50 INFO     epoch complete!
2024-09-02 16:21:50 INFO     evaluating now!
2024-09-02 16:21:50 INFO     Epoch [54/200] train_loss: 3.7242, val_loss: 5.0640, lr: 0.003000, 5.35s
2024-09-02 16:21:55 INFO     epoch complete!
2024-09-02 16:21:55 INFO     evaluating now!
2024-09-02 16:21:55 INFO     Epoch [55/200] train_loss: 3.7199, val_loss: 4.9613, lr: 0.003000, 5.24s
2024-09-02 16:21:55 INFO     Saved model at 55
2024-09-02 16:21:55 INFO     Val loss decrease from 5.0415 to 4.9613, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch55.tar
2024-09-02 16:22:00 INFO     epoch complete!
2024-09-02 16:22:00 INFO     evaluating now!
2024-09-02 16:22:00 INFO     Epoch [56/200] train_loss: 3.6873, val_loss: 5.1487, lr: 0.003000, 5.30s
2024-09-02 16:22:06 INFO     epoch complete!
2024-09-02 16:22:06 INFO     evaluating now!
2024-09-02 16:22:06 INFO     Epoch [57/200] train_loss: 3.6336, val_loss: 5.1261, lr: 0.003000, 5.44s
2024-09-02 16:22:11 INFO     epoch complete!
2024-09-02 16:22:11 INFO     evaluating now!
2024-09-02 16:22:11 INFO     Epoch [58/200] train_loss: 3.6971, val_loss: 5.1123, lr: 0.003000, 5.27s
2024-09-02 16:22:16 INFO     epoch complete!
2024-09-02 16:22:16 INFO     evaluating now!
2024-09-02 16:22:16 INFO     Epoch [59/200] train_loss: 3.6226, val_loss: 5.0074, lr: 0.003000, 5.26s
2024-09-02 16:22:21 INFO     epoch complete!
2024-09-02 16:22:21 INFO     evaluating now!
2024-09-02 16:22:22 INFO     Epoch [60/200] train_loss: 3.6109, val_loss: 4.9419, lr: 0.003000, 5.26s
2024-09-02 16:22:22 INFO     Saved model at 60
2024-09-02 16:22:22 INFO     Val loss decrease from 4.9613 to 4.9419, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch60.tar
2024-09-02 16:22:27 INFO     epoch complete!
2024-09-02 16:22:27 INFO     evaluating now!
2024-09-02 16:22:27 INFO     Epoch [61/200] train_loss: 3.6137, val_loss: 5.0764, lr: 0.003000, 5.38s
2024-09-02 16:22:32 INFO     epoch complete!
2024-09-02 16:22:32 INFO     evaluating now!
2024-09-02 16:22:32 INFO     Epoch [62/200] train_loss: 3.6576, val_loss: 5.1905, lr: 0.003000, 5.21s
2024-09-02 16:22:37 INFO     epoch complete!
2024-09-02 16:22:37 INFO     evaluating now!
2024-09-02 16:22:38 INFO     Epoch [63/200] train_loss: 3.5664, val_loss: 5.0387, lr: 0.003000, 5.31s
2024-09-02 16:22:43 INFO     epoch complete!
2024-09-02 16:22:43 INFO     evaluating now!
2024-09-02 16:22:43 INFO     Epoch [64/200] train_loss: 3.5622, val_loss: 4.9694, lr: 0.003000, 5.38s
2024-09-02 16:22:48 INFO     epoch complete!
2024-09-02 16:22:48 INFO     evaluating now!
2024-09-02 16:22:48 INFO     Epoch [65/200] train_loss: 3.5547, val_loss: 5.1011, lr: 0.003000, 5.23s
2024-09-02 16:22:53 INFO     epoch complete!
2024-09-02 16:22:53 INFO     evaluating now!
2024-09-02 16:22:53 INFO     Epoch [66/200] train_loss: 3.5507, val_loss: 5.0973, lr: 0.003000, 5.21s
2024-09-02 16:22:58 INFO     epoch complete!
2024-09-02 16:22:58 INFO     evaluating now!
2024-09-02 16:22:59 INFO     Epoch [67/200] train_loss: 3.7206, val_loss: 5.1531, lr: 0.003000, 5.34s
2024-09-02 16:23:04 INFO     epoch complete!
2024-09-02 16:23:04 INFO     evaluating now!
2024-09-02 16:23:04 INFO     Epoch [68/200] train_loss: 3.7740, val_loss: 5.0158, lr: 0.003000, 5.22s
2024-09-02 16:23:09 INFO     epoch complete!
2024-09-02 16:23:09 INFO     evaluating now!
2024-09-02 16:23:09 INFO     Epoch [69/200] train_loss: 3.6567, val_loss: 5.1073, lr: 0.003000, 5.17s
2024-09-02 16:23:14 INFO     epoch complete!
2024-09-02 16:23:14 INFO     evaluating now!
2024-09-02 16:23:14 INFO     Epoch [70/200] train_loss: 3.5428, val_loss: 5.0725, lr: 0.003000, 5.33s
2024-09-02 16:23:19 INFO     epoch complete!
2024-09-02 16:23:19 INFO     evaluating now!
2024-09-02 16:23:20 INFO     Epoch [71/200] train_loss: 3.4776, val_loss: 5.0439, lr: 0.003000, 5.29s
2024-09-02 16:23:25 INFO     epoch complete!
2024-09-02 16:23:25 INFO     evaluating now!
2024-09-02 16:23:25 INFO     Epoch [72/200] train_loss: 3.4532, val_loss: 4.9469, lr: 0.003000, 5.29s
2024-09-02 16:23:30 INFO     epoch complete!
2024-09-02 16:23:30 INFO     evaluating now!
2024-09-02 16:23:30 INFO     Epoch [73/200] train_loss: 3.4567, val_loss: 5.0365, lr: 0.003000, 5.29s
2024-09-02 16:23:35 INFO     epoch complete!
2024-09-02 16:23:35 INFO     evaluating now!
2024-09-02 16:23:36 INFO     Epoch [74/200] train_loss: 3.4451, val_loss: 4.9883, lr: 0.003000, 5.27s
2024-09-02 16:23:41 INFO     epoch complete!
2024-09-02 16:23:41 INFO     evaluating now!
2024-09-02 16:23:41 INFO     Epoch [75/200] train_loss: 3.4275, val_loss: 5.1036, lr: 0.003000, 5.32s
2024-09-02 16:23:41 WARNING  Early stopping at epoch: 75
2024-09-02 16:23:41 INFO     Trained totally 76 epochs, average train time is 4.907s, average eval time is 0.314s
2024-09-02 16:23:41 INFO     Loaded model at 60
2024-09-02 16:23:41 INFO     Saved model at ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 16:23:41 INFO     Start evaluating ...
2024-09-02 16:23:42 INFO     Note that you select the single mode to evaluate!
2024-09-02 16:23:42 INFO     Evaluate result is saved at ./libcity/cache/40/evaluate_cache\2024_09_02_16_23_42_AGCRN_CHITaxi20190406.csv
2024-09-02 16:23:42 INFO     
         MAE       RMSE
1   2.375043   6.807708
2   2.471843   7.381674
3   2.582986   8.311025
4   2.845292   9.146910
5   2.934314   9.973043
6   3.029446  10.955789
7   3.103421  12.073751
8   3.168483  13.050007
9   3.271235  13.601994
10  3.343963  13.827484
11  3.366907  13.918487
12  3.513742  14.143016
2024-09-02 16:23:42 INFO     ----------------------------------------------------------------------------
2024-09-02 16:23:42 INFO     # 4, Kownledge Graph Embedding: RefH, Experiment ids: 44
2024-09-02 16:23:42 INFO     ----------------------------------------------------------------------------
2024-09-02 16:23:42 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=40
2024-09-02 16:23:42 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 40, 'embedding_model': 'RefH', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 16:23:42 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 16:23:42 INFO     set_weight_link_or_dist: dist
2024-09-02 16:23:42 INFO     init_weight_inf_or_zero: inf
2024-09-02 16:23:42 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 16:23:42 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 16:23:42 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 16:23:42 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 16:23:44 INFO     Dataset created
2024-09-02 16:23:44 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 16:23:44 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 16:23:44 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 16:23:44 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 16:23:44 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 16:23:44 INFO     NormalScaler max: 0.39871441235290517
2024-09-02 16:23:46 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 16:23:46 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 16:23:46 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 16:23:46 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 16:23:46 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 16:23:46 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 16:23:46 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 16:23:46 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 16:23:46 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 16:23:46 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 16:23:46 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 16:23:46 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 16:23:46 INFO     Total parameter numbers: 874010
2024-09-02 16:23:46 INFO     You select `adam` optimizer.
2024-09-02 16:23:46 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 16:23:46 INFO     Start training ...
2024-09-02 16:23:46 INFO     num_batches:48
2024-09-02 16:23:51 INFO     epoch complete!
2024-09-02 16:23:51 INFO     evaluating now!
2024-09-02 16:23:52 INFO     Epoch [0/200] train_loss: 23.4526, val_loss: 17.9655, lr: 0.003000, 5.53s
2024-09-02 16:23:52 INFO     Saved model at 0
2024-09-02 16:23:52 INFO     Val loss decrease from inf to 17.9655, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 16:23:57 INFO     epoch complete!
2024-09-02 16:23:57 INFO     evaluating now!
2024-09-02 16:23:57 INFO     Epoch [1/200] train_loss: 14.3890, val_loss: 13.6636, lr: 0.003000, 5.32s
2024-09-02 16:23:57 INFO     Saved model at 1
2024-09-02 16:23:57 INFO     Val loss decrease from 17.9655 to 13.6636, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 16:24:02 INFO     epoch complete!
2024-09-02 16:24:02 INFO     evaluating now!
2024-09-02 16:24:02 INFO     Epoch [2/200] train_loss: 11.3371, val_loss: 10.6803, lr: 0.003000, 5.31s
2024-09-02 16:24:02 INFO     Saved model at 2
2024-09-02 16:24:02 INFO     Val loss decrease from 13.6636 to 10.6803, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 16:24:07 INFO     epoch complete!
2024-09-02 16:24:07 INFO     evaluating now!
2024-09-02 16:24:08 INFO     Epoch [3/200] train_loss: 9.2202, val_loss: 8.7340, lr: 0.003000, 5.23s
2024-09-02 16:24:08 INFO     Saved model at 3
2024-09-02 16:24:08 INFO     Val loss decrease from 10.6803 to 8.7340, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 16:24:13 INFO     epoch complete!
2024-09-02 16:24:13 INFO     evaluating now!
2024-09-02 16:24:13 INFO     Epoch [4/200] train_loss: 8.1946, val_loss: 7.9091, lr: 0.003000, 5.30s
2024-09-02 16:24:13 INFO     Saved model at 4
2024-09-02 16:24:13 INFO     Val loss decrease from 8.7340 to 7.9091, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 16:24:18 INFO     epoch complete!
2024-09-02 16:24:18 INFO     evaluating now!
2024-09-02 16:24:18 INFO     Epoch [5/200] train_loss: 7.2965, val_loss: 7.1185, lr: 0.003000, 5.27s
2024-09-02 16:24:18 INFO     Saved model at 5
2024-09-02 16:24:18 INFO     Val loss decrease from 7.9091 to 7.1185, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 16:24:23 INFO     epoch complete!
2024-09-02 16:24:23 INFO     evaluating now!
2024-09-02 16:24:23 INFO     Epoch [6/200] train_loss: 6.8474, val_loss: 6.6549, lr: 0.003000, 5.25s
2024-09-02 16:24:23 INFO     Saved model at 6
2024-09-02 16:24:23 INFO     Val loss decrease from 7.1185 to 6.6549, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 16:24:28 INFO     epoch complete!
2024-09-02 16:24:28 INFO     evaluating now!
2024-09-02 16:24:29 INFO     Epoch [7/200] train_loss: 6.3094, val_loss: 6.3772, lr: 0.003000, 5.27s
2024-09-02 16:24:29 INFO     Saved model at 7
2024-09-02 16:24:29 INFO     Val loss decrease from 6.6549 to 6.3772, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 16:24:34 INFO     epoch complete!
2024-09-02 16:24:34 INFO     evaluating now!
2024-09-02 16:24:34 INFO     Epoch [8/200] train_loss: 6.1613, val_loss: 6.2429, lr: 0.003000, 5.28s
2024-09-02 16:24:34 INFO     Saved model at 8
2024-09-02 16:24:34 INFO     Val loss decrease from 6.3772 to 6.2429, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 16:24:39 INFO     epoch complete!
2024-09-02 16:24:39 INFO     evaluating now!
2024-09-02 16:24:39 INFO     Epoch [9/200] train_loss: 5.9337, val_loss: 6.0676, lr: 0.003000, 5.20s
2024-09-02 16:24:39 INFO     Saved model at 9
2024-09-02 16:24:39 INFO     Val loss decrease from 6.2429 to 6.0676, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 16:24:44 INFO     epoch complete!
2024-09-02 16:24:44 INFO     evaluating now!
2024-09-02 16:24:45 INFO     Epoch [10/200] train_loss: 5.7942, val_loss: 6.4024, lr: 0.003000, 5.30s
2024-09-02 16:24:49 INFO     epoch complete!
2024-09-02 16:24:49 INFO     evaluating now!
2024-09-02 16:24:50 INFO     Epoch [11/200] train_loss: 5.6795, val_loss: 6.0030, lr: 0.003000, 5.14s
2024-09-02 16:24:50 INFO     Saved model at 11
2024-09-02 16:24:50 INFO     Val loss decrease from 6.0676 to 6.0030, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 16:24:54 INFO     epoch complete!
2024-09-02 16:24:54 INFO     evaluating now!
2024-09-02 16:24:55 INFO     Epoch [12/200] train_loss: 5.4300, val_loss: 5.7126, lr: 0.003000, 5.22s
2024-09-02 16:24:55 INFO     Saved model at 12
2024-09-02 16:24:55 INFO     Val loss decrease from 6.0030 to 5.7126, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 16:25:00 INFO     epoch complete!
2024-09-02 16:25:00 INFO     evaluating now!
2024-09-02 16:25:00 INFO     Epoch [13/200] train_loss: 5.2897, val_loss: 5.5271, lr: 0.003000, 5.26s
2024-09-02 16:25:00 INFO     Saved model at 13
2024-09-02 16:25:00 INFO     Val loss decrease from 5.7126 to 5.5271, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 16:25:05 INFO     epoch complete!
2024-09-02 16:25:05 INFO     evaluating now!
2024-09-02 16:25:05 INFO     Epoch [14/200] train_loss: 5.2154, val_loss: 5.7989, lr: 0.003000, 5.25s
2024-09-02 16:25:10 INFO     epoch complete!
2024-09-02 16:25:10 INFO     evaluating now!
2024-09-02 16:25:11 INFO     Epoch [15/200] train_loss: 5.2167, val_loss: 5.6712, lr: 0.003000, 5.40s
2024-09-02 16:25:16 INFO     epoch complete!
2024-09-02 16:25:16 INFO     evaluating now!
2024-09-02 16:25:16 INFO     Epoch [16/200] train_loss: 5.0623, val_loss: 5.6069, lr: 0.003000, 5.25s
2024-09-02 16:25:21 INFO     epoch complete!
2024-09-02 16:25:21 INFO     evaluating now!
2024-09-02 16:25:21 INFO     Epoch [17/200] train_loss: 4.9564, val_loss: 5.4192, lr: 0.003000, 5.16s
2024-09-02 16:25:21 INFO     Saved model at 17
2024-09-02 16:25:21 INFO     Val loss decrease from 5.5271 to 5.4192, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-02 16:25:26 INFO     epoch complete!
2024-09-02 16:25:26 INFO     evaluating now!
2024-09-02 16:25:27 INFO     Epoch [18/200] train_loss: 5.0042, val_loss: 5.6152, lr: 0.003000, 5.27s
2024-09-02 16:25:31 INFO     epoch complete!
2024-09-02 16:25:31 INFO     evaluating now!
2024-09-02 16:25:32 INFO     Epoch [19/200] train_loss: 4.9368, val_loss: 5.4331, lr: 0.003000, 5.19s
2024-09-02 16:25:37 INFO     epoch complete!
2024-09-02 16:25:37 INFO     evaluating now!
2024-09-02 16:25:37 INFO     Epoch [20/200] train_loss: 4.8118, val_loss: 5.3118, lr: 0.003000, 5.15s
2024-09-02 16:25:37 INFO     Saved model at 20
2024-09-02 16:25:37 INFO     Val loss decrease from 5.4192 to 5.3118, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-02 16:25:42 INFO     epoch complete!
2024-09-02 16:25:42 INFO     evaluating now!
2024-09-02 16:25:42 INFO     Epoch [21/200] train_loss: 4.6914, val_loss: 5.6537, lr: 0.003000, 5.16s
2024-09-02 16:25:47 INFO     epoch complete!
2024-09-02 16:25:47 INFO     evaluating now!
2024-09-02 16:25:47 INFO     Epoch [22/200] train_loss: 4.6509, val_loss: 5.5040, lr: 0.003000, 5.11s
2024-09-02 16:25:52 INFO     epoch complete!
2024-09-02 16:25:52 INFO     evaluating now!
2024-09-02 16:25:52 INFO     Epoch [23/200] train_loss: 4.6081, val_loss: 5.2153, lr: 0.003000, 5.15s
2024-09-02 16:25:52 INFO     Saved model at 23
2024-09-02 16:25:52 INFO     Val loss decrease from 5.3118 to 5.2153, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-02 16:25:57 INFO     epoch complete!
2024-09-02 16:25:57 INFO     evaluating now!
2024-09-02 16:25:57 INFO     Epoch [24/200] train_loss: 4.5058, val_loss: 5.2767, lr: 0.003000, 5.16s
2024-09-02 16:26:02 INFO     epoch complete!
2024-09-02 16:26:02 INFO     evaluating now!
2024-09-02 16:26:03 INFO     Epoch [25/200] train_loss: 4.4829, val_loss: 5.2766, lr: 0.003000, 5.15s
2024-09-02 16:26:07 INFO     epoch complete!
2024-09-02 16:26:07 INFO     evaluating now!
2024-09-02 16:26:08 INFO     Epoch [26/200] train_loss: 4.5180, val_loss: 5.2522, lr: 0.003000, 5.15s
2024-09-02 16:26:13 INFO     epoch complete!
2024-09-02 16:26:13 INFO     evaluating now!
2024-09-02 16:26:13 INFO     Epoch [27/200] train_loss: 4.4822, val_loss: 5.3424, lr: 0.003000, 5.22s
2024-09-02 16:26:18 INFO     epoch complete!
2024-09-02 16:26:18 INFO     evaluating now!
2024-09-02 16:26:18 INFO     Epoch [28/200] train_loss: 4.3795, val_loss: 5.2372, lr: 0.003000, 5.24s
2024-09-02 16:26:23 INFO     epoch complete!
2024-09-02 16:26:23 INFO     evaluating now!
2024-09-02 16:26:23 INFO     Epoch [29/200] train_loss: 4.3849, val_loss: 5.4466, lr: 0.003000, 5.14s
2024-09-02 16:26:28 INFO     epoch complete!
2024-09-02 16:26:28 INFO     evaluating now!
2024-09-02 16:26:29 INFO     Epoch [30/200] train_loss: 4.4376, val_loss: 5.1060, lr: 0.003000, 5.22s
2024-09-02 16:26:29 INFO     Saved model at 30
2024-09-02 16:26:29 INFO     Val loss decrease from 5.2153 to 5.1060, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-09-02 16:26:33 INFO     epoch complete!
2024-09-02 16:26:33 INFO     evaluating now!
2024-09-02 16:26:34 INFO     Epoch [31/200] train_loss: 4.3089, val_loss: 5.2445, lr: 0.003000, 5.20s
2024-09-02 16:26:39 INFO     epoch complete!
2024-09-02 16:26:39 INFO     evaluating now!
2024-09-02 16:26:39 INFO     Epoch [32/200] train_loss: 4.3427, val_loss: 5.3333, lr: 0.003000, 5.17s
2024-09-02 16:26:44 INFO     epoch complete!
2024-09-02 16:26:44 INFO     evaluating now!
2024-09-02 16:26:44 INFO     Epoch [33/200] train_loss: 4.2436, val_loss: 5.3055, lr: 0.003000, 5.30s
2024-09-02 16:26:49 INFO     epoch complete!
2024-09-02 16:26:49 INFO     evaluating now!
2024-09-02 16:26:50 INFO     Epoch [34/200] train_loss: 4.1861, val_loss: 5.2326, lr: 0.003000, 5.31s
2024-09-02 16:26:55 INFO     epoch complete!
2024-09-02 16:26:55 INFO     evaluating now!
2024-09-02 16:26:55 INFO     Epoch [35/200] train_loss: 4.1277, val_loss: 5.1790, lr: 0.003000, 5.35s
2024-09-02 16:27:00 INFO     epoch complete!
2024-09-02 16:27:00 INFO     evaluating now!
2024-09-02 16:27:00 INFO     Epoch [36/200] train_loss: 4.1960, val_loss: 5.1604, lr: 0.003000, 5.20s
2024-09-02 16:27:05 INFO     epoch complete!
2024-09-02 16:27:05 INFO     evaluating now!
2024-09-02 16:27:05 INFO     Epoch [37/200] train_loss: 4.1466, val_loss: 5.1328, lr: 0.003000, 5.20s
2024-09-02 16:27:10 INFO     epoch complete!
2024-09-02 16:27:10 INFO     evaluating now!
2024-09-02 16:27:11 INFO     Epoch [38/200] train_loss: 4.0676, val_loss: 5.1028, lr: 0.003000, 5.19s
2024-09-02 16:27:11 INFO     Saved model at 38
2024-09-02 16:27:11 INFO     Val loss decrease from 5.1060 to 5.1028, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-09-02 16:27:15 INFO     epoch complete!
2024-09-02 16:27:15 INFO     evaluating now!
2024-09-02 16:27:16 INFO     Epoch [39/200] train_loss: 3.9860, val_loss: 5.3494, lr: 0.003000, 5.15s
2024-09-02 16:27:20 INFO     epoch complete!
2024-09-02 16:27:20 INFO     evaluating now!
2024-09-02 16:27:21 INFO     Epoch [40/200] train_loss: 4.0107, val_loss: 5.0399, lr: 0.003000, 5.12s
2024-09-02 16:27:21 INFO     Saved model at 40
2024-09-02 16:27:21 INFO     Val loss decrease from 5.1028 to 5.0399, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-09-02 16:27:26 INFO     epoch complete!
2024-09-02 16:27:26 INFO     evaluating now!
2024-09-02 16:27:26 INFO     Epoch [41/200] train_loss: 4.0310, val_loss: 5.1587, lr: 0.003000, 5.18s
2024-09-02 16:27:31 INFO     epoch complete!
2024-09-02 16:27:31 INFO     evaluating now!
2024-09-02 16:27:31 INFO     Epoch [42/200] train_loss: 4.0363, val_loss: 5.2300, lr: 0.003000, 5.13s
2024-09-02 16:27:36 INFO     epoch complete!
2024-09-02 16:27:36 INFO     evaluating now!
2024-09-02 16:27:36 INFO     Epoch [43/200] train_loss: 3.9981, val_loss: 5.2657, lr: 0.003000, 5.11s
2024-09-02 16:27:41 INFO     epoch complete!
2024-09-02 16:27:41 INFO     evaluating now!
2024-09-02 16:27:41 INFO     Epoch [44/200] train_loss: 3.9931, val_loss: 5.0897, lr: 0.003000, 5.18s
2024-09-02 16:27:46 INFO     epoch complete!
2024-09-02 16:27:46 INFO     evaluating now!
2024-09-02 16:27:47 INFO     Epoch [45/200] train_loss: 3.8946, val_loss: 5.1292, lr: 0.003000, 5.12s
2024-09-02 16:27:51 INFO     epoch complete!
2024-09-02 16:27:51 INFO     evaluating now!
2024-09-02 16:27:52 INFO     Epoch [46/200] train_loss: 3.8491, val_loss: 5.0859, lr: 0.003000, 5.11s
2024-09-02 16:27:57 INFO     epoch complete!
2024-09-02 16:27:57 INFO     evaluating now!
2024-09-02 16:27:57 INFO     Epoch [47/200] train_loss: 3.8763, val_loss: 5.0252, lr: 0.003000, 5.17s
2024-09-02 16:27:57 INFO     Saved model at 47
2024-09-02 16:27:57 INFO     Val loss decrease from 5.0399 to 5.0252, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch47.tar
2024-09-02 16:28:02 INFO     epoch complete!
2024-09-02 16:28:02 INFO     evaluating now!
2024-09-02 16:28:02 INFO     Epoch [48/200] train_loss: 3.8215, val_loss: 5.2494, lr: 0.003000, 5.10s
2024-09-02 16:28:07 INFO     epoch complete!
2024-09-02 16:28:07 INFO     evaluating now!
2024-09-02 16:28:07 INFO     Epoch [49/200] train_loss: 3.8188, val_loss: 5.3217, lr: 0.003000, 5.09s
2024-09-02 16:28:12 INFO     epoch complete!
2024-09-02 16:28:12 INFO     evaluating now!
2024-09-02 16:28:12 INFO     Epoch [50/200] train_loss: 3.8363, val_loss: 5.2344, lr: 0.003000, 5.22s
2024-09-02 16:28:17 INFO     epoch complete!
2024-09-02 16:28:17 INFO     evaluating now!
2024-09-02 16:28:17 INFO     Epoch [51/200] train_loss: 3.8103, val_loss: 5.1238, lr: 0.003000, 5.15s
2024-09-02 16:28:22 INFO     epoch complete!
2024-09-02 16:28:22 INFO     evaluating now!
2024-09-02 16:28:23 INFO     Epoch [52/200] train_loss: 3.8079, val_loss: 5.1454, lr: 0.003000, 5.15s
2024-09-02 16:28:28 INFO     epoch complete!
2024-09-02 16:28:28 INFO     evaluating now!
2024-09-02 16:28:28 INFO     Epoch [53/200] train_loss: 3.7518, val_loss: 5.3368, lr: 0.003000, 5.34s
2024-09-02 16:28:33 INFO     epoch complete!
2024-09-02 16:28:33 INFO     evaluating now!
2024-09-02 16:28:33 INFO     Epoch [54/200] train_loss: 3.7845, val_loss: 5.1167, lr: 0.003000, 5.27s
2024-09-02 16:28:38 INFO     epoch complete!
2024-09-02 16:28:38 INFO     evaluating now!
2024-09-02 16:28:38 INFO     Epoch [55/200] train_loss: 3.7240, val_loss: 5.1605, lr: 0.003000, 5.21s
2024-09-02 16:28:43 INFO     epoch complete!
2024-09-02 16:28:43 INFO     evaluating now!
2024-09-02 16:28:44 INFO     Epoch [56/200] train_loss: 3.6963, val_loss: 5.0069, lr: 0.003000, 5.34s
2024-09-02 16:28:44 INFO     Saved model at 56
2024-09-02 16:28:44 INFO     Val loss decrease from 5.0252 to 5.0069, saving to ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406_epoch56.tar
2024-09-02 16:28:49 INFO     epoch complete!
2024-09-02 16:28:49 INFO     evaluating now!
2024-09-02 16:28:49 INFO     Epoch [57/200] train_loss: 3.6578, val_loss: 5.1135, lr: 0.003000, 5.13s
2024-09-02 16:28:54 INFO     epoch complete!
2024-09-02 16:28:54 INFO     evaluating now!
2024-09-02 16:28:54 INFO     Epoch [58/200] train_loss: 3.6695, val_loss: 5.0828, lr: 0.003000, 5.19s
2024-09-02 16:28:59 INFO     epoch complete!
2024-09-02 16:28:59 INFO     evaluating now!
2024-09-02 16:28:59 INFO     Epoch [59/200] train_loss: 3.6270, val_loss: 5.1869, lr: 0.003000, 5.36s
2024-09-02 16:29:04 INFO     epoch complete!
2024-09-02 16:29:04 INFO     evaluating now!
2024-09-02 16:29:05 INFO     Epoch [60/200] train_loss: 3.6975, val_loss: 5.3005, lr: 0.003000, 5.24s
2024-09-02 16:29:09 INFO     epoch complete!
2024-09-02 16:29:09 INFO     evaluating now!
2024-09-02 16:29:10 INFO     Epoch [61/200] train_loss: 3.8229, val_loss: 5.1532, lr: 0.003000, 5.15s
2024-09-02 16:29:15 INFO     epoch complete!
2024-09-02 16:29:15 INFO     evaluating now!
2024-09-02 16:29:15 INFO     Epoch [62/200] train_loss: 3.6432, val_loss: 5.1060, lr: 0.003000, 5.15s
2024-09-02 16:29:20 INFO     epoch complete!
2024-09-02 16:29:20 INFO     evaluating now!
2024-09-02 16:29:20 INFO     Epoch [63/200] train_loss: 3.6247, val_loss: 5.0202, lr: 0.003000, 5.10s
2024-09-02 16:29:25 INFO     epoch complete!
2024-09-02 16:29:25 INFO     evaluating now!
2024-09-02 16:29:25 INFO     Epoch [64/200] train_loss: 3.6178, val_loss: 5.1940, lr: 0.003000, 5.16s
2024-09-02 16:29:30 INFO     epoch complete!
2024-09-02 16:29:30 INFO     evaluating now!
2024-09-02 16:29:30 INFO     Epoch [65/200] train_loss: 3.5527, val_loss: 5.1633, lr: 0.003000, 5.14s
2024-09-02 16:29:35 INFO     epoch complete!
2024-09-02 16:29:35 INFO     evaluating now!
2024-09-02 16:29:35 INFO     Epoch [66/200] train_loss: 3.5545, val_loss: 5.0933, lr: 0.003000, 5.11s
2024-09-02 16:29:40 INFO     epoch complete!
2024-09-02 16:29:40 INFO     evaluating now!
2024-09-02 16:29:41 INFO     Epoch [67/200] train_loss: 3.6038, val_loss: 5.1442, lr: 0.003000, 5.16s
2024-09-02 16:29:45 INFO     epoch complete!
2024-09-02 16:29:45 INFO     evaluating now!
2024-09-02 16:29:46 INFO     Epoch [68/200] train_loss: 3.5475, val_loss: 5.2107, lr: 0.003000, 5.15s
2024-09-02 16:29:51 INFO     epoch complete!
2024-09-02 16:29:51 INFO     evaluating now!
2024-09-02 16:29:51 INFO     Epoch [69/200] train_loss: 3.5367, val_loss: 5.1149, lr: 0.003000, 5.26s
2024-09-02 16:29:56 INFO     epoch complete!
2024-09-02 16:29:56 INFO     evaluating now!
2024-09-02 16:29:56 INFO     Epoch [70/200] train_loss: 3.5161, val_loss: 5.0217, lr: 0.003000, 5.34s
2024-09-02 16:30:01 INFO     epoch complete!
2024-09-02 16:30:01 INFO     evaluating now!
2024-09-02 16:30:02 INFO     Epoch [71/200] train_loss: 3.4583, val_loss: 5.1121, lr: 0.003000, 5.33s
2024-09-02 16:30:02 WARNING  Early stopping at epoch: 71
2024-09-02 16:30:02 INFO     Trained totally 72 epochs, average train time is 4.894s, average eval time is 0.317s
2024-09-02 16:30:02 INFO     Loaded model at 56
2024-09-02 16:30:02 INFO     Saved model at ./libcity/cache/40/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 16:30:02 INFO     Start evaluating ...
2024-09-02 16:30:03 INFO     Note that you select the single mode to evaluate!
2024-09-02 16:30:03 INFO     Evaluate result is saved at ./libcity/cache/40/evaluate_cache\2024_09_02_16_30_03_AGCRN_CHITaxi20190406.csv
2024-09-02 16:30:03 INFO     
         MAE       RMSE
1   2.354511   6.907596
2   2.447876   7.507895
3   2.546368   8.424364
4   2.779814   9.153083
5   2.973168   9.908998
6   3.058775  10.851570
7   3.166362  11.743299
8   3.225578  12.364820
9   3.265744  12.702934
10  3.357465  12.827497
11  3.340831  13.185660
12  3.436335  13.643154
2024-09-02 16:30:03 INFO     ----------------------------------------------------------------------------
2024-09-02 16:30:03 INFO     Kownledge Graph Embedding: RefH, Experiment ids: [40, 41, 42, 43, 44]
2024-09-02 16:30:03 INFO     ----------------------------------------------------------------------------
2024-09-02 16:30:03 INFO     Average: 
         MAE       RMSE
0   2.398932   6.970815
1   2.479311   7.530486
2   2.595303   8.458615
3   2.772490   9.226639
4   2.909398   9.999582
5   3.012805  10.810381
6   3.117105  11.587155
7   3.166167  12.195730
8   3.215819  12.579022
9   3.260432  12.821562
10  3.289469  13.147914
11  3.422927  13.685144 
2024-09-02 16:30:03 INFO     Standard deviation: 
         MAE      RMSE
0   0.057708  0.137962
1   0.041854  0.130000
2   0.029359  0.149522
3   0.056523  0.070050
4   0.060034  0.186825
5   0.083096  0.359041
6   0.059948  0.504451
7   0.057152  0.580013
8   0.074747  0.587806
9   0.089942  0.529488
10  0.083518  0.407092
11  0.081725  0.250443
2024-09-02 16:30:03 INFO     ----------------------------------------------------------------------------
2024-09-02 16:30:03 INFO     12 steps Average: 
        MAE       RMSE
0  2.970013  10.751087
2024-09-02 16:30:03 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.064634  0.324391
