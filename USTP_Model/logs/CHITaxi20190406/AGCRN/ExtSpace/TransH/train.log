2024-09-02 17:13:34 INFO     Saving logs in: ./logs/CHITaxi20190406\AGCRN\ExtSpace\TransH
2024-09-02 17:13:34 INFO     ----------------------------------------------------------------------------
2024-09-02 17:13:34 INFO     # 0, Kownledge Graph Embedding: TransH, Experiment ids: 55
2024-09-02 17:13:34 INFO     ----------------------------------------------------------------------------
2024-09-02 17:13:34 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=55
2024-09-02 17:13:34 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 55, 'embedding_model': 'TransH', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 17:13:34 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 17:13:34 INFO     set_weight_link_or_dist: dist
2024-09-02 17:13:34 INFO     init_weight_inf_or_zero: inf
2024-09-02 17:13:34 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 17:13:34 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 17:13:34 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 17:13:35 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 17:13:36 INFO     Dataset created
2024-09-02 17:13:36 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 17:13:36 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 17:13:36 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 17:13:36 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 17:13:36 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 17:13:36 INFO     NormalScaler max: 0.49840353722686526
2024-09-02 17:13:40 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 17:13:40 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 17:13:40 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 17:13:40 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 17:13:40 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 17:13:40 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 17:13:40 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 17:13:40 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 17:13:40 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 17:13:40 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 17:13:40 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 17:13:40 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 17:13:40 INFO     Total parameter numbers: 874010
2024-09-02 17:13:40 INFO     You select `adam` optimizer.
2024-09-02 17:13:40 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 17:13:40 INFO     Start training ...
2024-09-02 17:13:40 INFO     num_batches:48
2024-09-02 17:13:47 INFO     epoch complete!
2024-09-02 17:13:47 INFO     evaluating now!
2024-09-02 17:13:47 INFO     Epoch [0/200] train_loss: 24.0526, val_loss: 18.1276, lr: 0.003000, 7.35s
2024-09-02 17:13:47 INFO     Saved model at 0
2024-09-02 17:13:47 INFO     Val loss decrease from inf to 18.1276, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 17:13:52 INFO     epoch complete!
2024-09-02 17:13:52 INFO     evaluating now!
2024-09-02 17:13:52 INFO     Epoch [1/200] train_loss: 14.8364, val_loss: 14.5210, lr: 0.003000, 5.14s
2024-09-02 17:13:52 INFO     Saved model at 1
2024-09-02 17:13:52 INFO     Val loss decrease from 18.1276 to 14.5210, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 17:13:57 INFO     epoch complete!
2024-09-02 17:13:57 INFO     evaluating now!
2024-09-02 17:13:57 INFO     Epoch [2/200] train_loss: 11.7423, val_loss: 11.3182, lr: 0.003000, 5.14s
2024-09-02 17:13:57 INFO     Saved model at 2
2024-09-02 17:13:57 INFO     Val loss decrease from 14.5210 to 11.3182, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 17:14:02 INFO     epoch complete!
2024-09-02 17:14:02 INFO     evaluating now!
2024-09-02 17:14:03 INFO     Epoch [3/200] train_loss: 9.4807, val_loss: 8.9089, lr: 0.003000, 5.22s
2024-09-02 17:14:03 INFO     Saved model at 3
2024-09-02 17:14:03 INFO     Val loss decrease from 11.3182 to 8.9089, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 17:14:07 INFO     epoch complete!
2024-09-02 17:14:07 INFO     evaluating now!
2024-09-02 17:14:08 INFO     Epoch [4/200] train_loss: 8.2035, val_loss: 7.9075, lr: 0.003000, 5.22s
2024-09-02 17:14:08 INFO     Saved model at 4
2024-09-02 17:14:08 INFO     Val loss decrease from 8.9089 to 7.9075, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 17:14:13 INFO     epoch complete!
2024-09-02 17:14:13 INFO     evaluating now!
2024-09-02 17:14:13 INFO     Epoch [5/200] train_loss: 7.5766, val_loss: 7.2376, lr: 0.003000, 5.18s
2024-09-02 17:14:13 INFO     Saved model at 5
2024-09-02 17:14:13 INFO     Val loss decrease from 7.9075 to 7.2376, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 17:14:18 INFO     epoch complete!
2024-09-02 17:14:18 INFO     evaluating now!
2024-09-02 17:14:18 INFO     Epoch [6/200] train_loss: 6.8886, val_loss: 6.7145, lr: 0.003000, 5.15s
2024-09-02 17:14:18 INFO     Saved model at 6
2024-09-02 17:14:18 INFO     Val loss decrease from 7.2376 to 6.7145, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 17:14:23 INFO     epoch complete!
2024-09-02 17:14:23 INFO     evaluating now!
2024-09-02 17:14:23 INFO     Epoch [7/200] train_loss: 6.4653, val_loss: 6.5773, lr: 0.003000, 5.23s
2024-09-02 17:14:23 INFO     Saved model at 7
2024-09-02 17:14:23 INFO     Val loss decrease from 6.7145 to 6.5773, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 17:14:28 INFO     epoch complete!
2024-09-02 17:14:28 INFO     evaluating now!
2024-09-02 17:14:29 INFO     Epoch [8/200] train_loss: 6.1775, val_loss: 6.2558, lr: 0.003000, 5.17s
2024-09-02 17:14:29 INFO     Saved model at 8
2024-09-02 17:14:29 INFO     Val loss decrease from 6.5773 to 6.2558, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 17:14:33 INFO     epoch complete!
2024-09-02 17:14:33 INFO     evaluating now!
2024-09-02 17:14:34 INFO     Epoch [9/200] train_loss: 5.9407, val_loss: 5.9952, lr: 0.003000, 5.22s
2024-09-02 17:14:34 INFO     Saved model at 9
2024-09-02 17:14:34 INFO     Val loss decrease from 6.2558 to 5.9952, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 17:14:39 INFO     epoch complete!
2024-09-02 17:14:39 INFO     evaluating now!
2024-09-02 17:14:39 INFO     Epoch [10/200] train_loss: 5.7269, val_loss: 5.8892, lr: 0.003000, 5.21s
2024-09-02 17:14:39 INFO     Saved model at 10
2024-09-02 17:14:39 INFO     Val loss decrease from 5.9952 to 5.8892, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 17:14:44 INFO     epoch complete!
2024-09-02 17:14:44 INFO     evaluating now!
2024-09-02 17:14:44 INFO     Epoch [11/200] train_loss: 5.6167, val_loss: 6.0122, lr: 0.003000, 5.16s
2024-09-02 17:14:49 INFO     epoch complete!
2024-09-02 17:14:49 INFO     evaluating now!
2024-09-02 17:14:49 INFO     Epoch [12/200] train_loss: 5.4415, val_loss: 5.7663, lr: 0.003000, 5.21s
2024-09-02 17:14:49 INFO     Saved model at 12
2024-09-02 17:14:49 INFO     Val loss decrease from 5.8892 to 5.7663, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 17:14:54 INFO     epoch complete!
2024-09-02 17:14:54 INFO     evaluating now!
2024-09-02 17:14:55 INFO     Epoch [13/200] train_loss: 5.2933, val_loss: 5.6714, lr: 0.003000, 5.14s
2024-09-02 17:14:55 INFO     Saved model at 13
2024-09-02 17:14:55 INFO     Val loss decrease from 5.7663 to 5.6714, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 17:14:59 INFO     epoch complete!
2024-09-02 17:14:59 INFO     evaluating now!
2024-09-02 17:15:00 INFO     Epoch [14/200] train_loss: 5.2336, val_loss: 5.8354, lr: 0.003000, 5.11s
2024-09-02 17:15:04 INFO     epoch complete!
2024-09-02 17:15:04 INFO     evaluating now!
2024-09-02 17:15:05 INFO     Epoch [15/200] train_loss: 5.3034, val_loss: 5.4394, lr: 0.003000, 5.11s
2024-09-02 17:15:05 INFO     Saved model at 15
2024-09-02 17:15:05 INFO     Val loss decrease from 5.6714 to 5.4394, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 17:15:10 INFO     epoch complete!
2024-09-02 17:15:10 INFO     evaluating now!
2024-09-02 17:15:10 INFO     Epoch [16/200] train_loss: 5.1175, val_loss: 5.5091, lr: 0.003000, 5.11s
2024-09-02 17:15:15 INFO     epoch complete!
2024-09-02 17:15:15 INFO     evaluating now!
2024-09-02 17:15:15 INFO     Epoch [17/200] train_loss: 5.0387, val_loss: 5.4257, lr: 0.003000, 5.11s
2024-09-02 17:15:15 INFO     Saved model at 17
2024-09-02 17:15:15 INFO     Val loss decrease from 5.4394 to 5.4257, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-02 17:15:20 INFO     epoch complete!
2024-09-02 17:15:20 INFO     evaluating now!
2024-09-02 17:15:20 INFO     Epoch [18/200] train_loss: 4.8789, val_loss: 5.3656, lr: 0.003000, 5.12s
2024-09-02 17:15:20 INFO     Saved model at 18
2024-09-02 17:15:20 INFO     Val loss decrease from 5.4257 to 5.3656, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-02 17:15:25 INFO     epoch complete!
2024-09-02 17:15:25 INFO     evaluating now!
2024-09-02 17:15:25 INFO     Epoch [19/200] train_loss: 4.8098, val_loss: 5.3130, lr: 0.003000, 5.12s
2024-09-02 17:15:25 INFO     Saved model at 19
2024-09-02 17:15:25 INFO     Val loss decrease from 5.3656 to 5.3130, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-02 17:15:30 INFO     epoch complete!
2024-09-02 17:15:30 INFO     evaluating now!
2024-09-02 17:15:30 INFO     Epoch [20/200] train_loss: 4.7395, val_loss: 5.2316, lr: 0.003000, 5.16s
2024-09-02 17:15:30 INFO     Saved model at 20
2024-09-02 17:15:30 INFO     Val loss decrease from 5.3130 to 5.2316, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-02 17:15:35 INFO     epoch complete!
2024-09-02 17:15:35 INFO     evaluating now!
2024-09-02 17:15:36 INFO     Epoch [21/200] train_loss: 4.7396, val_loss: 5.5065, lr: 0.003000, 5.16s
2024-09-02 17:15:41 INFO     epoch complete!
2024-09-02 17:15:41 INFO     evaluating now!
2024-09-02 17:15:41 INFO     Epoch [22/200] train_loss: 4.6246, val_loss: 5.2956, lr: 0.003000, 5.24s
2024-09-02 17:15:46 INFO     epoch complete!
2024-09-02 17:15:46 INFO     evaluating now!
2024-09-02 17:15:46 INFO     Epoch [23/200] train_loss: 4.5512, val_loss: 5.2685, lr: 0.003000, 5.07s
2024-09-02 17:15:51 INFO     epoch complete!
2024-09-02 17:15:51 INFO     evaluating now!
2024-09-02 17:15:51 INFO     Epoch [24/200] train_loss: 4.4933, val_loss: 5.3528, lr: 0.003000, 5.05s
2024-09-02 17:15:56 INFO     epoch complete!
2024-09-02 17:15:56 INFO     evaluating now!
2024-09-02 17:15:56 INFO     Epoch [25/200] train_loss: 4.5363, val_loss: 5.2470, lr: 0.003000, 5.06s
2024-09-02 17:16:01 INFO     epoch complete!
2024-09-02 17:16:01 INFO     evaluating now!
2024-09-02 17:16:01 INFO     Epoch [26/200] train_loss: 4.4094, val_loss: 5.2630, lr: 0.003000, 5.06s
2024-09-02 17:16:06 INFO     epoch complete!
2024-09-02 17:16:06 INFO     evaluating now!
2024-09-02 17:16:06 INFO     Epoch [27/200] train_loss: 4.3354, val_loss: 5.1982, lr: 0.003000, 5.16s
2024-09-02 17:16:06 INFO     Saved model at 27
2024-09-02 17:16:06 INFO     Val loss decrease from 5.2316 to 5.1982, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-02 17:16:11 INFO     epoch complete!
2024-09-02 17:16:11 INFO     evaluating now!
2024-09-02 17:16:11 INFO     Epoch [28/200] train_loss: 4.3622, val_loss: 5.1335, lr: 0.003000, 5.15s
2024-09-02 17:16:11 INFO     Saved model at 28
2024-09-02 17:16:11 INFO     Val loss decrease from 5.1982 to 5.1335, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-02 17:16:16 INFO     epoch complete!
2024-09-02 17:16:16 INFO     evaluating now!
2024-09-02 17:16:17 INFO     Epoch [29/200] train_loss: 4.2709, val_loss: 5.0974, lr: 0.003000, 5.13s
2024-09-02 17:16:17 INFO     Saved model at 29
2024-09-02 17:16:17 INFO     Val loss decrease from 5.1335 to 5.0974, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-02 17:16:21 INFO     epoch complete!
2024-09-02 17:16:21 INFO     evaluating now!
2024-09-02 17:16:22 INFO     Epoch [30/200] train_loss: 4.2382, val_loss: 5.2833, lr: 0.003000, 5.10s
2024-09-02 17:16:26 INFO     epoch complete!
2024-09-02 17:16:26 INFO     evaluating now!
2024-09-02 17:16:27 INFO     Epoch [31/200] train_loss: 4.1998, val_loss: 5.1605, lr: 0.003000, 5.07s
2024-09-02 17:16:31 INFO     epoch complete!
2024-09-02 17:16:31 INFO     evaluating now!
2024-09-02 17:16:32 INFO     Epoch [32/200] train_loss: 4.1570, val_loss: 5.1077, lr: 0.003000, 5.06s
2024-09-02 17:16:37 INFO     epoch complete!
2024-09-02 17:16:37 INFO     evaluating now!
2024-09-02 17:16:37 INFO     Epoch [33/200] train_loss: 4.1224, val_loss: 5.3875, lr: 0.003000, 5.07s
2024-09-02 17:16:42 INFO     epoch complete!
2024-09-02 17:16:42 INFO     evaluating now!
2024-09-02 17:16:42 INFO     Epoch [34/200] train_loss: 4.0913, val_loss: 5.0937, lr: 0.003000, 5.08s
2024-09-02 17:16:42 INFO     Saved model at 34
2024-09-02 17:16:42 INFO     Val loss decrease from 5.0974 to 5.0937, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-09-02 17:16:47 INFO     epoch complete!
2024-09-02 17:16:47 INFO     evaluating now!
2024-09-02 17:16:47 INFO     Epoch [35/200] train_loss: 4.0339, val_loss: 5.0498, lr: 0.003000, 5.07s
2024-09-02 17:16:47 INFO     Saved model at 35
2024-09-02 17:16:47 INFO     Val loss decrease from 5.0937 to 5.0498, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-02 17:16:52 INFO     epoch complete!
2024-09-02 17:16:52 INFO     evaluating now!
2024-09-02 17:16:52 INFO     Epoch [36/200] train_loss: 4.0572, val_loss: 5.0925, lr: 0.003000, 5.07s
2024-09-02 17:16:57 INFO     epoch complete!
2024-09-02 17:16:57 INFO     evaluating now!
2024-09-02 17:16:57 INFO     Epoch [37/200] train_loss: 3.9878, val_loss: 5.2234, lr: 0.003000, 5.16s
2024-09-02 17:17:02 INFO     epoch complete!
2024-09-02 17:17:02 INFO     evaluating now!
2024-09-02 17:17:02 INFO     Epoch [38/200] train_loss: 3.9659, val_loss: 5.0487, lr: 0.003000, 5.13s
2024-09-02 17:17:02 INFO     Saved model at 38
2024-09-02 17:17:02 INFO     Val loss decrease from 5.0498 to 5.0487, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-09-02 17:17:07 INFO     epoch complete!
2024-09-02 17:17:07 INFO     evaluating now!
2024-09-02 17:17:08 INFO     Epoch [39/200] train_loss: 3.9454, val_loss: 5.0202, lr: 0.003000, 5.14s
2024-09-02 17:17:08 INFO     Saved model at 39
2024-09-02 17:17:08 INFO     Val loss decrease from 5.0487 to 5.0202, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-09-02 17:17:12 INFO     epoch complete!
2024-09-02 17:17:12 INFO     evaluating now!
2024-09-02 17:17:13 INFO     Epoch [40/200] train_loss: 3.8869, val_loss: 5.0542, lr: 0.003000, 5.12s
2024-09-02 17:17:18 INFO     epoch complete!
2024-09-02 17:17:18 INFO     evaluating now!
2024-09-02 17:17:18 INFO     Epoch [41/200] train_loss: 3.8404, val_loss: 5.1310, lr: 0.003000, 5.12s
2024-09-02 17:17:23 INFO     epoch complete!
2024-09-02 17:17:23 INFO     evaluating now!
2024-09-02 17:17:23 INFO     Epoch [42/200] train_loss: 3.8338, val_loss: 5.1508, lr: 0.003000, 5.13s
2024-09-02 17:17:28 INFO     epoch complete!
2024-09-02 17:17:28 INFO     evaluating now!
2024-09-02 17:17:28 INFO     Epoch [43/200] train_loss: 3.7505, val_loss: 5.0617, lr: 0.003000, 5.11s
2024-09-02 17:17:33 INFO     epoch complete!
2024-09-02 17:17:33 INFO     evaluating now!
2024-09-02 17:17:33 INFO     Epoch [44/200] train_loss: 3.7541, val_loss: 5.1842, lr: 0.003000, 5.14s
2024-09-02 17:17:38 INFO     epoch complete!
2024-09-02 17:17:38 INFO     evaluating now!
2024-09-02 17:17:38 INFO     Epoch [45/200] train_loss: 3.8314, val_loss: 5.2089, lr: 0.003000, 5.12s
2024-09-02 17:17:43 INFO     epoch complete!
2024-09-02 17:17:43 INFO     evaluating now!
2024-09-02 17:17:43 INFO     Epoch [46/200] train_loss: 3.7737, val_loss: 5.0789, lr: 0.003000, 5.13s
2024-09-02 17:17:48 INFO     epoch complete!
2024-09-02 17:17:48 INFO     evaluating now!
2024-09-02 17:17:49 INFO     Epoch [47/200] train_loss: 3.7264, val_loss: 5.1029, lr: 0.003000, 5.13s
2024-09-02 17:17:53 INFO     epoch complete!
2024-09-02 17:17:53 INFO     evaluating now!
2024-09-02 17:17:54 INFO     Epoch [48/200] train_loss: 3.7471, val_loss: 4.9748, lr: 0.003000, 5.13s
2024-09-02 17:17:54 INFO     Saved model at 48
2024-09-02 17:17:54 INFO     Val loss decrease from 5.0202 to 4.9748, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-09-02 17:17:59 INFO     epoch complete!
2024-09-02 17:17:59 INFO     evaluating now!
2024-09-02 17:17:59 INFO     Epoch [49/200] train_loss: 3.6867, val_loss: 5.0674, lr: 0.003000, 5.09s
2024-09-02 17:18:04 INFO     epoch complete!
2024-09-02 17:18:04 INFO     evaluating now!
2024-09-02 17:18:04 INFO     Epoch [50/200] train_loss: 3.7095, val_loss: 5.1587, lr: 0.003000, 5.08s
2024-09-02 17:18:09 INFO     epoch complete!
2024-09-02 17:18:09 INFO     evaluating now!
2024-09-02 17:18:09 INFO     Epoch [51/200] train_loss: 3.6480, val_loss: 5.0593, lr: 0.003000, 5.09s
2024-09-02 17:18:14 INFO     epoch complete!
2024-09-02 17:18:14 INFO     evaluating now!
2024-09-02 17:18:14 INFO     Epoch [52/200] train_loss: 3.5944, val_loss: 5.1142, lr: 0.003000, 5.11s
2024-09-02 17:18:19 INFO     epoch complete!
2024-09-02 17:18:19 INFO     evaluating now!
2024-09-02 17:18:19 INFO     Epoch [53/200] train_loss: 3.6014, val_loss: 5.1704, lr: 0.003000, 5.12s
2024-09-02 17:18:24 INFO     epoch complete!
2024-09-02 17:18:24 INFO     evaluating now!
2024-09-02 17:18:24 INFO     Epoch [54/200] train_loss: 3.5682, val_loss: 5.0902, lr: 0.003000, 5.12s
2024-09-02 17:18:29 INFO     epoch complete!
2024-09-02 17:18:29 INFO     evaluating now!
2024-09-02 17:18:30 INFO     Epoch [55/200] train_loss: 3.5736, val_loss: 5.1228, lr: 0.003000, 5.19s
2024-09-02 17:18:34 INFO     epoch complete!
2024-09-02 17:18:34 INFO     evaluating now!
2024-09-02 17:18:35 INFO     Epoch [56/200] train_loss: 3.5689, val_loss: 5.0832, lr: 0.003000, 5.12s
2024-09-02 17:18:39 INFO     epoch complete!
2024-09-02 17:18:39 INFO     evaluating now!
2024-09-02 17:18:40 INFO     Epoch [57/200] train_loss: 3.4825, val_loss: 5.0777, lr: 0.003000, 5.12s
2024-09-02 17:18:45 INFO     epoch complete!
2024-09-02 17:18:45 INFO     evaluating now!
2024-09-02 17:18:45 INFO     Epoch [58/200] train_loss: 3.4943, val_loss: 5.0077, lr: 0.003000, 5.11s
2024-09-02 17:18:50 INFO     epoch complete!
2024-09-02 17:18:50 INFO     evaluating now!
2024-09-02 17:18:50 INFO     Epoch [59/200] train_loss: 3.5124, val_loss: 5.0757, lr: 0.003000, 5.10s
2024-09-02 17:18:55 INFO     epoch complete!
2024-09-02 17:18:55 INFO     evaluating now!
2024-09-02 17:18:55 INFO     Epoch [60/200] train_loss: 3.4846, val_loss: 5.0442, lr: 0.003000, 5.10s
2024-09-02 17:19:00 INFO     epoch complete!
2024-09-02 17:19:00 INFO     evaluating now!
2024-09-02 17:19:00 INFO     Epoch [61/200] train_loss: 3.4580, val_loss: 5.0012, lr: 0.003000, 5.10s
2024-09-02 17:19:05 INFO     epoch complete!
2024-09-02 17:19:05 INFO     evaluating now!
2024-09-02 17:19:05 INFO     Epoch [62/200] train_loss: 3.4520, val_loss: 5.0431, lr: 0.003000, 5.10s
2024-09-02 17:19:10 INFO     epoch complete!
2024-09-02 17:19:10 INFO     evaluating now!
2024-09-02 17:19:10 INFO     Epoch [63/200] train_loss: 3.4187, val_loss: 5.0875, lr: 0.003000, 5.11s
2024-09-02 17:19:10 WARNING  Early stopping at epoch: 63
2024-09-02 17:19:10 INFO     Trained totally 64 epochs, average train time is 4.850s, average eval time is 0.312s
2024-09-02 17:19:10 INFO     Loaded model at 48
2024-09-02 17:19:10 INFO     Saved model at ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 17:19:10 INFO     Start evaluating ...
2024-09-02 17:19:11 INFO     Note that you select the single mode to evaluate!
2024-09-02 17:19:11 INFO     Evaluate result is saved at ./libcity/cache/55/evaluate_cache\2024_09_02_17_19_11_AGCRN_CHITaxi20190406.csv
2024-09-02 17:19:11 INFO     
         MAE       RMSE
1   2.251149   7.165809
2   2.361808   7.876606
3   2.501064   8.753227
4   2.620193   9.401301
5   2.803899  10.037878
6   2.948433  10.833567
7   3.064853  11.616445
8   3.102874  12.131456
9   3.181044  12.320158
10  3.199425  12.476658
11  3.233520  12.741196
12  3.411521  13.119728
2024-09-02 17:19:11 INFO     ----------------------------------------------------------------------------
2024-09-02 17:19:11 INFO     # 1, Kownledge Graph Embedding: TransH, Experiment ids: 56
2024-09-02 17:19:11 INFO     ----------------------------------------------------------------------------
2024-09-02 17:19:11 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=55
2024-09-02 17:19:11 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 55, 'embedding_model': 'TransH', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 17:19:11 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 17:19:12 INFO     set_weight_link_or_dist: dist
2024-09-02 17:19:12 INFO     init_weight_inf_or_zero: inf
2024-09-02 17:19:12 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 17:19:12 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 17:19:12 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 17:19:12 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 17:19:13 INFO     Dataset created
2024-09-02 17:19:13 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 17:19:14 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 17:19:14 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 17:19:14 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 17:19:14 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 17:19:14 INFO     NormalScaler max: 0.49840353722686526
2024-09-02 17:19:16 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 17:19:16 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 17:19:16 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 17:19:16 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 17:19:16 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 17:19:16 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 17:19:16 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 17:19:16 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 17:19:16 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 17:19:16 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 17:19:16 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 17:19:16 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 17:19:16 INFO     Total parameter numbers: 874010
2024-09-02 17:19:16 INFO     You select `adam` optimizer.
2024-09-02 17:19:16 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 17:19:16 INFO     Start training ...
2024-09-02 17:19:16 INFO     num_batches:48
2024-09-02 17:19:21 INFO     epoch complete!
2024-09-02 17:19:21 INFO     evaluating now!
2024-09-02 17:19:21 INFO     Epoch [0/200] train_loss: 24.8430, val_loss: 18.5974, lr: 0.003000, 5.30s
2024-09-02 17:19:21 INFO     Saved model at 0
2024-09-02 17:19:21 INFO     Val loss decrease from inf to 18.5974, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 17:19:26 INFO     epoch complete!
2024-09-02 17:19:26 INFO     evaluating now!
2024-09-02 17:19:26 INFO     Epoch [1/200] train_loss: 15.2962, val_loss: 14.8148, lr: 0.003000, 5.04s
2024-09-02 17:19:26 INFO     Saved model at 1
2024-09-02 17:19:26 INFO     Val loss decrease from 18.5974 to 14.8148, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 17:19:31 INFO     epoch complete!
2024-09-02 17:19:31 INFO     evaluating now!
2024-09-02 17:19:31 INFO     Epoch [2/200] train_loss: 12.0106, val_loss: 11.5281, lr: 0.003000, 5.04s
2024-09-02 17:19:31 INFO     Saved model at 2
2024-09-02 17:19:31 INFO     Val loss decrease from 14.8148 to 11.5281, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 17:19:36 INFO     epoch complete!
2024-09-02 17:19:36 INFO     evaluating now!
2024-09-02 17:19:36 INFO     Epoch [3/200] train_loss: 9.7532, val_loss: 9.4778, lr: 0.003000, 5.03s
2024-09-02 17:19:36 INFO     Saved model at 3
2024-09-02 17:19:36 INFO     Val loss decrease from 11.5281 to 9.4778, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 17:19:41 INFO     epoch complete!
2024-09-02 17:19:41 INFO     evaluating now!
2024-09-02 17:19:41 INFO     Epoch [4/200] train_loss: 8.4315, val_loss: 8.2828, lr: 0.003000, 5.04s
2024-09-02 17:19:41 INFO     Saved model at 4
2024-09-02 17:19:41 INFO     Val loss decrease from 9.4778 to 8.2828, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 17:19:46 INFO     epoch complete!
2024-09-02 17:19:46 INFO     evaluating now!
2024-09-02 17:19:46 INFO     Epoch [5/200] train_loss: 7.5827, val_loss: 7.3114, lr: 0.003000, 5.04s
2024-09-02 17:19:46 INFO     Saved model at 5
2024-09-02 17:19:46 INFO     Val loss decrease from 8.2828 to 7.3114, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 17:19:51 INFO     epoch complete!
2024-09-02 17:19:51 INFO     evaluating now!
2024-09-02 17:19:51 INFO     Epoch [6/200] train_loss: 6.9002, val_loss: 6.7059, lr: 0.003000, 5.05s
2024-09-02 17:19:51 INFO     Saved model at 6
2024-09-02 17:19:51 INFO     Val loss decrease from 7.3114 to 6.7059, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 17:19:56 INFO     epoch complete!
2024-09-02 17:19:56 INFO     evaluating now!
2024-09-02 17:19:57 INFO     Epoch [7/200] train_loss: 6.5477, val_loss: 6.6723, lr: 0.003000, 5.04s
2024-09-02 17:19:57 INFO     Saved model at 7
2024-09-02 17:19:57 INFO     Val loss decrease from 6.7059 to 6.6723, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 17:20:01 INFO     epoch complete!
2024-09-02 17:20:01 INFO     evaluating now!
2024-09-02 17:20:02 INFO     Epoch [8/200] train_loss: 6.1962, val_loss: 6.4080, lr: 0.003000, 5.04s
2024-09-02 17:20:02 INFO     Saved model at 8
2024-09-02 17:20:02 INFO     Val loss decrease from 6.6723 to 6.4080, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 17:20:06 INFO     epoch complete!
2024-09-02 17:20:06 INFO     evaluating now!
2024-09-02 17:20:07 INFO     Epoch [9/200] train_loss: 5.9971, val_loss: 6.3998, lr: 0.003000, 5.04s
2024-09-02 17:20:07 INFO     Saved model at 9
2024-09-02 17:20:07 INFO     Val loss decrease from 6.4080 to 6.3998, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 17:20:11 INFO     epoch complete!
2024-09-02 17:20:11 INFO     evaluating now!
2024-09-02 17:20:12 INFO     Epoch [10/200] train_loss: 5.8235, val_loss: 6.1203, lr: 0.003000, 5.04s
2024-09-02 17:20:12 INFO     Saved model at 10
2024-09-02 17:20:12 INFO     Val loss decrease from 6.3998 to 6.1203, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 17:20:16 INFO     epoch complete!
2024-09-02 17:20:16 INFO     evaluating now!
2024-09-02 17:20:17 INFO     Epoch [11/200] train_loss: 5.6079, val_loss: 6.1707, lr: 0.003000, 5.04s
2024-09-02 17:20:21 INFO     epoch complete!
2024-09-02 17:20:21 INFO     evaluating now!
2024-09-02 17:20:22 INFO     Epoch [12/200] train_loss: 5.5405, val_loss: 5.7159, lr: 0.003000, 5.04s
2024-09-02 17:20:22 INFO     Saved model at 12
2024-09-02 17:20:22 INFO     Val loss decrease from 6.1203 to 5.7159, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 17:20:27 INFO     epoch complete!
2024-09-02 17:20:27 INFO     evaluating now!
2024-09-02 17:20:27 INFO     Epoch [13/200] train_loss: 5.4257, val_loss: 5.9736, lr: 0.003000, 5.04s
2024-09-02 17:20:32 INFO     epoch complete!
2024-09-02 17:20:32 INFO     evaluating now!
2024-09-02 17:20:32 INFO     Epoch [14/200] train_loss: 5.2978, val_loss: 5.6886, lr: 0.003000, 5.04s
2024-09-02 17:20:32 INFO     Saved model at 14
2024-09-02 17:20:32 INFO     Val loss decrease from 5.7159 to 5.6886, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-02 17:20:37 INFO     epoch complete!
2024-09-02 17:20:37 INFO     evaluating now!
2024-09-02 17:20:37 INFO     Epoch [15/200] train_loss: 5.1801, val_loss: 5.6511, lr: 0.003000, 5.05s
2024-09-02 17:20:37 INFO     Saved model at 15
2024-09-02 17:20:37 INFO     Val loss decrease from 5.6886 to 5.6511, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 17:20:42 INFO     epoch complete!
2024-09-02 17:20:42 INFO     evaluating now!
2024-09-02 17:20:42 INFO     Epoch [16/200] train_loss: 5.1277, val_loss: 5.6013, lr: 0.003000, 5.09s
2024-09-02 17:20:42 INFO     Saved model at 16
2024-09-02 17:20:42 INFO     Val loss decrease from 5.6511 to 5.6013, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 17:20:47 INFO     epoch complete!
2024-09-02 17:20:47 INFO     evaluating now!
2024-09-02 17:20:47 INFO     Epoch [17/200] train_loss: 5.0156, val_loss: 5.5276, lr: 0.003000, 5.04s
2024-09-02 17:20:47 INFO     Saved model at 17
2024-09-02 17:20:47 INFO     Val loss decrease from 5.6013 to 5.5276, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-02 17:20:52 INFO     epoch complete!
2024-09-02 17:20:52 INFO     evaluating now!
2024-09-02 17:20:52 INFO     Epoch [18/200] train_loss: 4.9332, val_loss: 5.6398, lr: 0.003000, 5.06s
2024-09-02 17:20:57 INFO     epoch complete!
2024-09-02 17:20:57 INFO     evaluating now!
2024-09-02 17:20:57 INFO     Epoch [19/200] train_loss: 4.8871, val_loss: 5.3473, lr: 0.003000, 5.05s
2024-09-02 17:20:57 INFO     Saved model at 19
2024-09-02 17:20:57 INFO     Val loss decrease from 5.5276 to 5.3473, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-02 17:21:02 INFO     epoch complete!
2024-09-02 17:21:02 INFO     evaluating now!
2024-09-02 17:21:02 INFO     Epoch [20/200] train_loss: 4.7769, val_loss: 5.3466, lr: 0.003000, 5.05s
2024-09-02 17:21:02 INFO     Saved model at 20
2024-09-02 17:21:02 INFO     Val loss decrease from 5.3473 to 5.3466, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-02 17:21:07 INFO     epoch complete!
2024-09-02 17:21:07 INFO     evaluating now!
2024-09-02 17:21:07 INFO     Epoch [21/200] train_loss: 4.7375, val_loss: 5.3304, lr: 0.003000, 5.06s
2024-09-02 17:21:07 INFO     Saved model at 21
2024-09-02 17:21:07 INFO     Val loss decrease from 5.3466 to 5.3304, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-02 17:21:12 INFO     epoch complete!
2024-09-02 17:21:12 INFO     evaluating now!
2024-09-02 17:21:12 INFO     Epoch [22/200] train_loss: 4.6805, val_loss: 5.4917, lr: 0.003000, 5.07s
2024-09-02 17:21:17 INFO     epoch complete!
2024-09-02 17:21:17 INFO     evaluating now!
2024-09-02 17:21:17 INFO     Epoch [23/200] train_loss: 4.6328, val_loss: 5.2838, lr: 0.003000, 5.06s
2024-09-02 17:21:17 INFO     Saved model at 23
2024-09-02 17:21:17 INFO     Val loss decrease from 5.3304 to 5.2838, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-02 17:21:22 INFO     epoch complete!
2024-09-02 17:21:22 INFO     evaluating now!
2024-09-02 17:21:23 INFO     Epoch [24/200] train_loss: 4.6217, val_loss: 5.3369, lr: 0.003000, 5.06s
2024-09-02 17:21:27 INFO     epoch complete!
2024-09-02 17:21:27 INFO     evaluating now!
2024-09-02 17:21:28 INFO     Epoch [25/200] train_loss: 4.5167, val_loss: 5.4195, lr: 0.003000, 5.05s
2024-09-02 17:21:32 INFO     epoch complete!
2024-09-02 17:21:32 INFO     evaluating now!
2024-09-02 17:21:33 INFO     Epoch [26/200] train_loss: 4.4586, val_loss: 5.3676, lr: 0.003000, 5.05s
2024-09-02 17:21:37 INFO     epoch complete!
2024-09-02 17:21:37 INFO     evaluating now!
2024-09-02 17:21:38 INFO     Epoch [27/200] train_loss: 4.4285, val_loss: 5.2383, lr: 0.003000, 5.05s
2024-09-02 17:21:38 INFO     Saved model at 27
2024-09-02 17:21:38 INFO     Val loss decrease from 5.2838 to 5.2383, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-02 17:21:42 INFO     epoch complete!
2024-09-02 17:21:42 INFO     evaluating now!
2024-09-02 17:21:43 INFO     Epoch [28/200] train_loss: 4.3948, val_loss: 5.0124, lr: 0.003000, 5.05s
2024-09-02 17:21:43 INFO     Saved model at 28
2024-09-02 17:21:43 INFO     Val loss decrease from 5.2383 to 5.0124, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-02 17:21:48 INFO     epoch complete!
2024-09-02 17:21:48 INFO     evaluating now!
2024-09-02 17:21:48 INFO     Epoch [29/200] train_loss: 4.3342, val_loss: 5.1315, lr: 0.003000, 5.05s
2024-09-02 17:21:53 INFO     epoch complete!
2024-09-02 17:21:53 INFO     evaluating now!
2024-09-02 17:21:53 INFO     Epoch [30/200] train_loss: 4.2805, val_loss: 5.2591, lr: 0.003000, 5.06s
2024-09-02 17:21:58 INFO     epoch complete!
2024-09-02 17:21:58 INFO     evaluating now!
2024-09-02 17:21:58 INFO     Epoch [31/200] train_loss: 4.2646, val_loss: 5.1414, lr: 0.003000, 5.06s
2024-09-02 17:22:03 INFO     epoch complete!
2024-09-02 17:22:03 INFO     evaluating now!
2024-09-02 17:22:03 INFO     Epoch [32/200] train_loss: 4.2239, val_loss: 5.2518, lr: 0.003000, 5.05s
2024-09-02 17:22:08 INFO     epoch complete!
2024-09-02 17:22:08 INFO     evaluating now!
2024-09-02 17:22:08 INFO     Epoch [33/200] train_loss: 4.2041, val_loss: 5.0872, lr: 0.003000, 5.06s
2024-09-02 17:22:13 INFO     epoch complete!
2024-09-02 17:22:13 INFO     evaluating now!
2024-09-02 17:22:13 INFO     Epoch [34/200] train_loss: 4.1249, val_loss: 5.0756, lr: 0.003000, 5.05s
2024-09-02 17:22:18 INFO     epoch complete!
2024-09-02 17:22:18 INFO     evaluating now!
2024-09-02 17:22:18 INFO     Epoch [35/200] train_loss: 4.1071, val_loss: 5.1191, lr: 0.003000, 5.05s
2024-09-02 17:22:23 INFO     epoch complete!
2024-09-02 17:22:23 INFO     evaluating now!
2024-09-02 17:22:23 INFO     Epoch [36/200] train_loss: 4.0996, val_loss: 5.1250, lr: 0.003000, 5.05s
2024-09-02 17:22:28 INFO     epoch complete!
2024-09-02 17:22:28 INFO     evaluating now!
2024-09-02 17:22:28 INFO     Epoch [37/200] train_loss: 4.1372, val_loss: 5.1497, lr: 0.003000, 5.05s
2024-09-02 17:22:33 INFO     epoch complete!
2024-09-02 17:22:33 INFO     evaluating now!
2024-09-02 17:22:33 INFO     Epoch [38/200] train_loss: 4.0486, val_loss: 5.2106, lr: 0.003000, 5.05s
2024-09-02 17:22:38 INFO     epoch complete!
2024-09-02 17:22:38 INFO     evaluating now!
2024-09-02 17:22:38 INFO     Epoch [39/200] train_loss: 3.9475, val_loss: 5.0068, lr: 0.003000, 5.05s
2024-09-02 17:22:38 INFO     Saved model at 39
2024-09-02 17:22:38 INFO     Val loss decrease from 5.0124 to 5.0068, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-09-02 17:22:43 INFO     epoch complete!
2024-09-02 17:22:43 INFO     evaluating now!
2024-09-02 17:22:43 INFO     Epoch [40/200] train_loss: 3.9209, val_loss: 5.0471, lr: 0.003000, 5.07s
2024-09-02 17:22:48 INFO     epoch complete!
2024-09-02 17:22:48 INFO     evaluating now!
2024-09-02 17:22:49 INFO     Epoch [41/200] train_loss: 3.9341, val_loss: 5.0695, lr: 0.003000, 5.06s
2024-09-02 17:22:53 INFO     epoch complete!
2024-09-02 17:22:53 INFO     evaluating now!
2024-09-02 17:22:54 INFO     Epoch [42/200] train_loss: 3.8962, val_loss: 5.1004, lr: 0.003000, 5.05s
2024-09-02 17:22:58 INFO     epoch complete!
2024-09-02 17:22:58 INFO     evaluating now!
2024-09-02 17:22:59 INFO     Epoch [43/200] train_loss: 3.9089, val_loss: 5.0652, lr: 0.003000, 5.05s
2024-09-02 17:23:03 INFO     epoch complete!
2024-09-02 17:23:03 INFO     evaluating now!
2024-09-02 17:23:04 INFO     Epoch [44/200] train_loss: 3.9159, val_loss: 5.1959, lr: 0.003000, 5.06s
2024-09-02 17:23:08 INFO     epoch complete!
2024-09-02 17:23:08 INFO     evaluating now!
2024-09-02 17:23:09 INFO     Epoch [45/200] train_loss: 3.8213, val_loss: 5.0602, lr: 0.003000, 5.05s
2024-09-02 17:23:13 INFO     epoch complete!
2024-09-02 17:23:13 INFO     evaluating now!
2024-09-02 17:23:14 INFO     Epoch [46/200] train_loss: 3.7725, val_loss: 5.0671, lr: 0.003000, 5.06s
2024-09-02 17:23:19 INFO     epoch complete!
2024-09-02 17:23:19 INFO     evaluating now!
2024-09-02 17:23:19 INFO     Epoch [47/200] train_loss: 3.7677, val_loss: 5.0943, lr: 0.003000, 5.06s
2024-09-02 17:23:24 INFO     epoch complete!
2024-09-02 17:23:24 INFO     evaluating now!
2024-09-02 17:23:24 INFO     Epoch [48/200] train_loss: 3.8324, val_loss: 4.9266, lr: 0.003000, 5.05s
2024-09-02 17:23:24 INFO     Saved model at 48
2024-09-02 17:23:24 INFO     Val loss decrease from 5.0068 to 4.9266, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-09-02 17:23:29 INFO     epoch complete!
2024-09-02 17:23:29 INFO     evaluating now!
2024-09-02 17:23:29 INFO     Epoch [49/200] train_loss: 3.7690, val_loss: 5.2454, lr: 0.003000, 5.05s
2024-09-02 17:23:34 INFO     epoch complete!
2024-09-02 17:23:34 INFO     evaluating now!
2024-09-02 17:23:34 INFO     Epoch [50/200] train_loss: 3.7709, val_loss: 5.1368, lr: 0.003000, 5.05s
2024-09-02 17:23:39 INFO     epoch complete!
2024-09-02 17:23:39 INFO     evaluating now!
2024-09-02 17:23:39 INFO     Epoch [51/200] train_loss: 3.7247, val_loss: 4.9634, lr: 0.003000, 5.06s
2024-09-02 17:23:44 INFO     epoch complete!
2024-09-02 17:23:44 INFO     evaluating now!
2024-09-02 17:23:44 INFO     Epoch [52/200] train_loss: 3.7195, val_loss: 5.0285, lr: 0.003000, 5.06s
2024-09-02 17:23:49 INFO     epoch complete!
2024-09-02 17:23:49 INFO     evaluating now!
2024-09-02 17:23:49 INFO     Epoch [53/200] train_loss: 3.7282, val_loss: 5.1039, lr: 0.003000, 5.05s
2024-09-02 17:23:54 INFO     epoch complete!
2024-09-02 17:23:54 INFO     evaluating now!
2024-09-02 17:23:54 INFO     Epoch [54/200] train_loss: 3.6755, val_loss: 4.9427, lr: 0.003000, 5.06s
2024-09-02 17:23:59 INFO     epoch complete!
2024-09-02 17:23:59 INFO     evaluating now!
2024-09-02 17:23:59 INFO     Epoch [55/200] train_loss: 3.6077, val_loss: 4.9845, lr: 0.003000, 5.05s
2024-09-02 17:24:04 INFO     epoch complete!
2024-09-02 17:24:04 INFO     evaluating now!
2024-09-02 17:24:04 INFO     Epoch [56/200] train_loss: 3.6268, val_loss: 5.0823, lr: 0.003000, 5.06s
2024-09-02 17:24:09 INFO     epoch complete!
2024-09-02 17:24:09 INFO     evaluating now!
2024-09-02 17:24:09 INFO     Epoch [57/200] train_loss: 3.5715, val_loss: 5.0005, lr: 0.003000, 5.05s
2024-09-02 17:24:14 INFO     epoch complete!
2024-09-02 17:24:14 INFO     evaluating now!
2024-09-02 17:24:14 INFO     Epoch [58/200] train_loss: 3.6359, val_loss: 5.0914, lr: 0.003000, 5.06s
2024-09-02 17:24:19 INFO     epoch complete!
2024-09-02 17:24:19 INFO     evaluating now!
2024-09-02 17:24:20 INFO     Epoch [59/200] train_loss: 3.5870, val_loss: 5.1159, lr: 0.003000, 5.05s
2024-09-02 17:24:24 INFO     epoch complete!
2024-09-02 17:24:24 INFO     evaluating now!
2024-09-02 17:24:25 INFO     Epoch [60/200] train_loss: 3.5481, val_loss: 5.0495, lr: 0.003000, 5.05s
2024-09-02 17:24:29 INFO     epoch complete!
2024-09-02 17:24:29 INFO     evaluating now!
2024-09-02 17:24:30 INFO     Epoch [61/200] train_loss: 3.5491, val_loss: 5.0108, lr: 0.003000, 5.06s
2024-09-02 17:24:34 INFO     epoch complete!
2024-09-02 17:24:34 INFO     evaluating now!
2024-09-02 17:24:35 INFO     Epoch [62/200] train_loss: 3.5435, val_loss: 5.0937, lr: 0.003000, 5.05s
2024-09-02 17:24:39 INFO     epoch complete!
2024-09-02 17:24:39 INFO     evaluating now!
2024-09-02 17:24:40 INFO     Epoch [63/200] train_loss: 3.5098, val_loss: 5.0989, lr: 0.003000, 5.06s
2024-09-02 17:24:40 WARNING  Early stopping at epoch: 63
2024-09-02 17:24:40 INFO     Trained totally 64 epochs, average train time is 4.755s, average eval time is 0.300s
2024-09-02 17:24:40 INFO     Loaded model at 48
2024-09-02 17:24:40 INFO     Saved model at ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 17:24:40 INFO     Start evaluating ...
2024-09-02 17:24:41 INFO     Note that you select the single mode to evaluate!
2024-09-02 17:24:41 INFO     Evaluate result is saved at ./libcity/cache/55/evaluate_cache\2024_09_02_17_24_41_AGCRN_CHITaxi20190406.csv
2024-09-02 17:24:41 INFO     
         MAE       RMSE
1   2.514716   7.345042
2   2.555551   7.848514
3   2.680912   8.771978
4   2.815635   9.502246
5   2.907742  10.475571
6   3.058922  11.616904
7   3.171222  12.596577
8   3.212836  13.233128
9   3.262361  13.476871
10  3.282535  13.617080
11  3.325013  13.811964
12  3.450312  14.377233
2024-09-02 17:24:41 INFO     ----------------------------------------------------------------------------
2024-09-02 17:24:41 INFO     # 2, Kownledge Graph Embedding: TransH, Experiment ids: 57
2024-09-02 17:24:41 INFO     ----------------------------------------------------------------------------
2024-09-02 17:24:41 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=55
2024-09-02 17:24:41 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 55, 'embedding_model': 'TransH', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 17:24:41 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 17:24:41 INFO     set_weight_link_or_dist: dist
2024-09-02 17:24:41 INFO     init_weight_inf_or_zero: inf
2024-09-02 17:24:41 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 17:24:41 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 17:24:41 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 17:24:41 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 17:24:43 INFO     Dataset created
2024-09-02 17:24:43 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 17:24:43 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 17:24:43 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 17:24:43 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 17:24:43 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 17:24:43 INFO     NormalScaler max: 0.49840353722686526
2024-09-02 17:24:45 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 17:24:45 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 17:24:45 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 17:24:45 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 17:24:45 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 17:24:45 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 17:24:45 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 17:24:45 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 17:24:45 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 17:24:45 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 17:24:45 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 17:24:45 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 17:24:45 INFO     Total parameter numbers: 874010
2024-09-02 17:24:45 INFO     You select `adam` optimizer.
2024-09-02 17:24:45 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 17:24:45 INFO     Start training ...
2024-09-02 17:24:45 INFO     num_batches:48
2024-09-02 17:24:50 INFO     epoch complete!
2024-09-02 17:24:50 INFO     evaluating now!
2024-09-02 17:24:50 INFO     Epoch [0/200] train_loss: 25.0944, val_loss: 18.3710, lr: 0.003000, 5.24s
2024-09-02 17:24:50 INFO     Saved model at 0
2024-09-02 17:24:50 INFO     Val loss decrease from inf to 18.3710, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 17:24:55 INFO     epoch complete!
2024-09-02 17:24:55 INFO     evaluating now!
2024-09-02 17:24:55 INFO     Epoch [1/200] train_loss: 15.0937, val_loss: 14.6839, lr: 0.003000, 5.05s
2024-09-02 17:24:55 INFO     Saved model at 1
2024-09-02 17:24:55 INFO     Val loss decrease from 18.3710 to 14.6839, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 17:25:00 INFO     epoch complete!
2024-09-02 17:25:00 INFO     evaluating now!
2024-09-02 17:25:00 INFO     Epoch [2/200] train_loss: 11.9741, val_loss: 11.4962, lr: 0.003000, 5.06s
2024-09-02 17:25:00 INFO     Saved model at 2
2024-09-02 17:25:00 INFO     Val loss decrease from 14.6839 to 11.4962, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 17:25:05 INFO     epoch complete!
2024-09-02 17:25:05 INFO     evaluating now!
2024-09-02 17:25:05 INFO     Epoch [3/200] train_loss: 9.9018, val_loss: 9.8071, lr: 0.003000, 5.06s
2024-09-02 17:25:05 INFO     Saved model at 3
2024-09-02 17:25:05 INFO     Val loss decrease from 11.4962 to 9.8071, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 17:25:10 INFO     epoch complete!
2024-09-02 17:25:10 INFO     evaluating now!
2024-09-02 17:25:10 INFO     Epoch [4/200] train_loss: 8.6858, val_loss: 8.5592, lr: 0.003000, 5.05s
2024-09-02 17:25:10 INFO     Saved model at 4
2024-09-02 17:25:10 INFO     Val loss decrease from 9.8071 to 8.5592, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 17:25:15 INFO     epoch complete!
2024-09-02 17:25:15 INFO     evaluating now!
2024-09-02 17:25:15 INFO     Epoch [5/200] train_loss: 7.7230, val_loss: 7.4621, lr: 0.003000, 5.06s
2024-09-02 17:25:15 INFO     Saved model at 5
2024-09-02 17:25:15 INFO     Val loss decrease from 8.5592 to 7.4621, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 17:25:20 INFO     epoch complete!
2024-09-02 17:25:20 INFO     evaluating now!
2024-09-02 17:25:20 INFO     Epoch [6/200] train_loss: 7.0895, val_loss: 6.9850, lr: 0.003000, 5.06s
2024-09-02 17:25:20 INFO     Saved model at 6
2024-09-02 17:25:20 INFO     Val loss decrease from 7.4621 to 6.9850, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 17:25:25 INFO     epoch complete!
2024-09-02 17:25:25 INFO     evaluating now!
2024-09-02 17:25:26 INFO     Epoch [7/200] train_loss: 6.7012, val_loss: 6.5487, lr: 0.003000, 5.05s
2024-09-02 17:25:26 INFO     Saved model at 7
2024-09-02 17:25:26 INFO     Val loss decrease from 6.9850 to 6.5487, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 17:25:30 INFO     epoch complete!
2024-09-02 17:25:30 INFO     evaluating now!
2024-09-02 17:25:31 INFO     Epoch [8/200] train_loss: 6.4137, val_loss: 6.5791, lr: 0.003000, 5.05s
2024-09-02 17:25:35 INFO     epoch complete!
2024-09-02 17:25:35 INFO     evaluating now!
2024-09-02 17:25:36 INFO     Epoch [9/200] train_loss: 6.1061, val_loss: 6.2477, lr: 0.003000, 5.05s
2024-09-02 17:25:36 INFO     Saved model at 9
2024-09-02 17:25:36 INFO     Val loss decrease from 6.5487 to 6.2477, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 17:25:40 INFO     epoch complete!
2024-09-02 17:25:40 INFO     evaluating now!
2024-09-02 17:25:41 INFO     Epoch [10/200] train_loss: 6.0112, val_loss: 6.3624, lr: 0.003000, 5.05s
2024-09-02 17:25:45 INFO     epoch complete!
2024-09-02 17:25:45 INFO     evaluating now!
2024-09-02 17:25:46 INFO     Epoch [11/200] train_loss: 5.7602, val_loss: 6.0411, lr: 0.003000, 5.05s
2024-09-02 17:25:46 INFO     Saved model at 11
2024-09-02 17:25:46 INFO     Val loss decrease from 6.2477 to 6.0411, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 17:25:51 INFO     epoch complete!
2024-09-02 17:25:51 INFO     evaluating now!
2024-09-02 17:25:51 INFO     Epoch [12/200] train_loss: 5.7063, val_loss: 5.8432, lr: 0.003000, 5.06s
2024-09-02 17:25:51 INFO     Saved model at 12
2024-09-02 17:25:51 INFO     Val loss decrease from 6.0411 to 5.8432, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 17:25:56 INFO     epoch complete!
2024-09-02 17:25:56 INFO     evaluating now!
2024-09-02 17:25:56 INFO     Epoch [13/200] train_loss: 5.5402, val_loss: 5.7254, lr: 0.003000, 5.05s
2024-09-02 17:25:56 INFO     Saved model at 13
2024-09-02 17:25:56 INFO     Val loss decrease from 5.8432 to 5.7254, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 17:26:01 INFO     epoch complete!
2024-09-02 17:26:01 INFO     evaluating now!
2024-09-02 17:26:01 INFO     Epoch [14/200] train_loss: 5.4302, val_loss: 5.7199, lr: 0.003000, 5.05s
2024-09-02 17:26:01 INFO     Saved model at 14
2024-09-02 17:26:01 INFO     Val loss decrease from 5.7254 to 5.7199, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-02 17:26:06 INFO     epoch complete!
2024-09-02 17:26:06 INFO     evaluating now!
2024-09-02 17:26:06 INFO     Epoch [15/200] train_loss: 5.3478, val_loss: 5.6241, lr: 0.003000, 5.05s
2024-09-02 17:26:06 INFO     Saved model at 15
2024-09-02 17:26:06 INFO     Val loss decrease from 5.7199 to 5.6241, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 17:26:11 INFO     epoch complete!
2024-09-02 17:26:11 INFO     evaluating now!
2024-09-02 17:26:11 INFO     Epoch [16/200] train_loss: 5.1994, val_loss: 5.5436, lr: 0.003000, 5.06s
2024-09-02 17:26:11 INFO     Saved model at 16
2024-09-02 17:26:11 INFO     Val loss decrease from 5.6241 to 5.5436, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 17:26:16 INFO     epoch complete!
2024-09-02 17:26:16 INFO     evaluating now!
2024-09-02 17:26:16 INFO     Epoch [17/200] train_loss: 5.0751, val_loss: 5.6356, lr: 0.003000, 5.06s
2024-09-02 17:26:21 INFO     epoch complete!
2024-09-02 17:26:21 INFO     evaluating now!
2024-09-02 17:26:21 INFO     Epoch [18/200] train_loss: 5.0150, val_loss: 5.5704, lr: 0.003000, 5.05s
2024-09-02 17:26:26 INFO     epoch complete!
2024-09-02 17:26:26 INFO     evaluating now!
2024-09-02 17:26:26 INFO     Epoch [19/200] train_loss: 5.1150, val_loss: 5.5252, lr: 0.003000, 5.05s
2024-09-02 17:26:26 INFO     Saved model at 19
2024-09-02 17:26:26 INFO     Val loss decrease from 5.5436 to 5.5252, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-02 17:26:31 INFO     epoch complete!
2024-09-02 17:26:31 INFO     evaluating now!
2024-09-02 17:26:31 INFO     Epoch [20/200] train_loss: 4.9462, val_loss: 5.5193, lr: 0.003000, 5.05s
2024-09-02 17:26:31 INFO     Saved model at 20
2024-09-02 17:26:31 INFO     Val loss decrease from 5.5252 to 5.5193, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-02 17:26:36 INFO     epoch complete!
2024-09-02 17:26:36 INFO     evaluating now!
2024-09-02 17:26:36 INFO     Epoch [21/200] train_loss: 4.8977, val_loss: 5.2950, lr: 0.003000, 5.06s
2024-09-02 17:26:36 INFO     Saved model at 21
2024-09-02 17:26:36 INFO     Val loss decrease from 5.5193 to 5.2950, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-02 17:26:41 INFO     epoch complete!
2024-09-02 17:26:41 INFO     evaluating now!
2024-09-02 17:26:41 INFO     Epoch [22/200] train_loss: 4.8310, val_loss: 5.3229, lr: 0.003000, 5.06s
2024-09-02 17:26:46 INFO     epoch complete!
2024-09-02 17:26:46 INFO     evaluating now!
2024-09-02 17:26:47 INFO     Epoch [23/200] train_loss: 4.6985, val_loss: 5.3668, lr: 0.003000, 5.07s
2024-09-02 17:26:51 INFO     epoch complete!
2024-09-02 17:26:51 INFO     evaluating now!
2024-09-02 17:26:52 INFO     Epoch [24/200] train_loss: 4.6430, val_loss: 5.3270, lr: 0.003000, 5.06s
2024-09-02 17:26:56 INFO     epoch complete!
2024-09-02 17:26:56 INFO     evaluating now!
2024-09-02 17:26:57 INFO     Epoch [25/200] train_loss: 4.6611, val_loss: 5.2595, lr: 0.003000, 5.06s
2024-09-02 17:26:57 INFO     Saved model at 25
2024-09-02 17:26:57 INFO     Val loss decrease from 5.2950 to 5.2595, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-02 17:27:01 INFO     epoch complete!
2024-09-02 17:27:01 INFO     evaluating now!
2024-09-02 17:27:02 INFO     Epoch [26/200] train_loss: 4.5501, val_loss: 5.3917, lr: 0.003000, 5.07s
2024-09-02 17:27:07 INFO     epoch complete!
2024-09-02 17:27:07 INFO     evaluating now!
2024-09-02 17:27:07 INFO     Epoch [27/200] train_loss: 4.5313, val_loss: 5.4098, lr: 0.003000, 5.07s
2024-09-02 17:27:12 INFO     epoch complete!
2024-09-02 17:27:12 INFO     evaluating now!
2024-09-02 17:27:12 INFO     Epoch [28/200] train_loss: 4.4571, val_loss: 5.3664, lr: 0.003000, 5.07s
2024-09-02 17:27:17 INFO     epoch complete!
2024-09-02 17:27:17 INFO     evaluating now!
2024-09-02 17:27:17 INFO     Epoch [29/200] train_loss: 4.4783, val_loss: 5.3816, lr: 0.003000, 5.06s
2024-09-02 17:27:22 INFO     epoch complete!
2024-09-02 17:27:22 INFO     evaluating now!
2024-09-02 17:27:22 INFO     Epoch [30/200] train_loss: 4.4413, val_loss: 5.2252, lr: 0.003000, 5.07s
2024-09-02 17:27:22 INFO     Saved model at 30
2024-09-02 17:27:22 INFO     Val loss decrease from 5.2595 to 5.2252, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-09-02 17:27:27 INFO     epoch complete!
2024-09-02 17:27:27 INFO     evaluating now!
2024-09-02 17:27:27 INFO     Epoch [31/200] train_loss: 4.3436, val_loss: 5.3097, lr: 0.003000, 5.07s
2024-09-02 17:27:32 INFO     epoch complete!
2024-09-02 17:27:32 INFO     evaluating now!
2024-09-02 17:27:32 INFO     Epoch [32/200] train_loss: 4.4234, val_loss: 5.1228, lr: 0.003000, 5.06s
2024-09-02 17:27:32 INFO     Saved model at 32
2024-09-02 17:27:32 INFO     Val loss decrease from 5.2252 to 5.1228, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-09-02 17:27:37 INFO     epoch complete!
2024-09-02 17:27:37 INFO     evaluating now!
2024-09-02 17:27:37 INFO     Epoch [33/200] train_loss: 4.3446, val_loss: 5.4242, lr: 0.003000, 5.07s
2024-09-02 17:27:42 INFO     epoch complete!
2024-09-02 17:27:42 INFO     evaluating now!
2024-09-02 17:27:42 INFO     Epoch [34/200] train_loss: 4.2707, val_loss: 5.5987, lr: 0.003000, 5.06s
2024-09-02 17:27:47 INFO     epoch complete!
2024-09-02 17:27:47 INFO     evaluating now!
2024-09-02 17:27:47 INFO     Epoch [35/200] train_loss: 4.2410, val_loss: 5.1030, lr: 0.003000, 5.05s
2024-09-02 17:27:47 INFO     Saved model at 35
2024-09-02 17:27:47 INFO     Val loss decrease from 5.1228 to 5.1030, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-02 17:27:52 INFO     epoch complete!
2024-09-02 17:27:52 INFO     evaluating now!
2024-09-02 17:27:52 INFO     Epoch [36/200] train_loss: 4.1708, val_loss: 5.1905, lr: 0.003000, 5.05s
2024-09-02 17:27:57 INFO     epoch complete!
2024-09-02 17:27:57 INFO     evaluating now!
2024-09-02 17:27:58 INFO     Epoch [37/200] train_loss: 4.2201, val_loss: 5.1681, lr: 0.003000, 5.06s
2024-09-02 17:28:02 INFO     epoch complete!
2024-09-02 17:28:02 INFO     evaluating now!
2024-09-02 17:28:03 INFO     Epoch [38/200] train_loss: 4.1531, val_loss: 5.1532, lr: 0.003000, 5.06s
2024-09-02 17:28:07 INFO     epoch complete!
2024-09-02 17:28:07 INFO     evaluating now!
2024-09-02 17:28:08 INFO     Epoch [39/200] train_loss: 4.1167, val_loss: 5.4064, lr: 0.003000, 5.07s
2024-09-02 17:28:12 INFO     epoch complete!
2024-09-02 17:28:12 INFO     evaluating now!
2024-09-02 17:28:13 INFO     Epoch [40/200] train_loss: 4.0490, val_loss: 5.1914, lr: 0.003000, 5.06s
2024-09-02 17:28:17 INFO     epoch complete!
2024-09-02 17:28:17 INFO     evaluating now!
2024-09-02 17:28:18 INFO     Epoch [41/200] train_loss: 4.0069, val_loss: 5.1960, lr: 0.003000, 5.06s
2024-09-02 17:28:23 INFO     epoch complete!
2024-09-02 17:28:23 INFO     evaluating now!
2024-09-02 17:28:23 INFO     Epoch [42/200] train_loss: 4.0387, val_loss: 5.2020, lr: 0.003000, 5.06s
2024-09-02 17:28:28 INFO     epoch complete!
2024-09-02 17:28:28 INFO     evaluating now!
2024-09-02 17:28:28 INFO     Epoch [43/200] train_loss: 3.9413, val_loss: 5.3409, lr: 0.003000, 5.08s
2024-09-02 17:28:33 INFO     epoch complete!
2024-09-02 17:28:33 INFO     evaluating now!
2024-09-02 17:28:33 INFO     Epoch [44/200] train_loss: 3.9717, val_loss: 5.1368, lr: 0.003000, 5.06s
2024-09-02 17:28:38 INFO     epoch complete!
2024-09-02 17:28:38 INFO     evaluating now!
2024-09-02 17:28:38 INFO     Epoch [45/200] train_loss: 3.9023, val_loss: 5.2367, lr: 0.003000, 5.06s
2024-09-02 17:28:43 INFO     epoch complete!
2024-09-02 17:28:43 INFO     evaluating now!
2024-09-02 17:28:43 INFO     Epoch [46/200] train_loss: 3.9192, val_loss: 5.2225, lr: 0.003000, 5.08s
2024-09-02 17:28:48 INFO     epoch complete!
2024-09-02 17:28:48 INFO     evaluating now!
2024-09-02 17:28:48 INFO     Epoch [47/200] train_loss: 3.9174, val_loss: 5.2396, lr: 0.003000, 5.06s
2024-09-02 17:28:53 INFO     epoch complete!
2024-09-02 17:28:53 INFO     evaluating now!
2024-09-02 17:28:53 INFO     Epoch [48/200] train_loss: 3.8983, val_loss: 5.2453, lr: 0.003000, 5.06s
2024-09-02 17:28:58 INFO     epoch complete!
2024-09-02 17:28:58 INFO     evaluating now!
2024-09-02 17:28:58 INFO     Epoch [49/200] train_loss: 3.8538, val_loss: 5.2251, lr: 0.003000, 5.07s
2024-09-02 17:29:03 INFO     epoch complete!
2024-09-02 17:29:03 INFO     evaluating now!
2024-09-02 17:29:03 INFO     Epoch [50/200] train_loss: 3.7851, val_loss: 5.0788, lr: 0.003000, 5.06s
2024-09-02 17:29:03 INFO     Saved model at 50
2024-09-02 17:29:03 INFO     Val loss decrease from 5.1030 to 5.0788, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch50.tar
2024-09-02 17:29:08 INFO     epoch complete!
2024-09-02 17:29:08 INFO     evaluating now!
2024-09-02 17:29:08 INFO     Epoch [51/200] train_loss: 3.7613, val_loss: 5.2603, lr: 0.003000, 5.11s
2024-09-02 17:29:13 INFO     epoch complete!
2024-09-02 17:29:13 INFO     evaluating now!
2024-09-02 17:29:14 INFO     Epoch [52/200] train_loss: 3.8312, val_loss: 5.2474, lr: 0.003000, 5.07s
2024-09-02 17:29:18 INFO     epoch complete!
2024-09-02 17:29:18 INFO     evaluating now!
2024-09-02 17:29:19 INFO     Epoch [53/200] train_loss: 3.8438, val_loss: 4.9944, lr: 0.003000, 5.06s
2024-09-02 17:29:19 INFO     Saved model at 53
2024-09-02 17:29:19 INFO     Val loss decrease from 5.0788 to 4.9944, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch53.tar
2024-09-02 17:29:23 INFO     epoch complete!
2024-09-02 17:29:23 INFO     evaluating now!
2024-09-02 17:29:24 INFO     Epoch [54/200] train_loss: 3.7400, val_loss: 5.0967, lr: 0.003000, 5.06s
2024-09-02 17:29:28 INFO     epoch complete!
2024-09-02 17:29:28 INFO     evaluating now!
2024-09-02 17:29:29 INFO     Epoch [55/200] train_loss: 3.7057, val_loss: 5.1679, lr: 0.003000, 5.06s
2024-09-02 17:29:34 INFO     epoch complete!
2024-09-02 17:29:34 INFO     evaluating now!
2024-09-02 17:29:34 INFO     Epoch [56/200] train_loss: 3.6943, val_loss: 5.2534, lr: 0.003000, 5.07s
2024-09-02 17:29:39 INFO     epoch complete!
2024-09-02 17:29:39 INFO     evaluating now!
2024-09-02 17:29:39 INFO     Epoch [57/200] train_loss: 3.6733, val_loss: 5.2404, lr: 0.003000, 5.06s
2024-09-02 17:29:44 INFO     epoch complete!
2024-09-02 17:29:44 INFO     evaluating now!
2024-09-02 17:29:44 INFO     Epoch [58/200] train_loss: 3.6683, val_loss: 5.1268, lr: 0.003000, 5.07s
2024-09-02 17:29:49 INFO     epoch complete!
2024-09-02 17:29:49 INFO     evaluating now!
2024-09-02 17:29:49 INFO     Epoch [59/200] train_loss: 3.6459, val_loss: 5.1845, lr: 0.003000, 5.06s
2024-09-02 17:29:54 INFO     epoch complete!
2024-09-02 17:29:54 INFO     evaluating now!
2024-09-02 17:29:54 INFO     Epoch [60/200] train_loss: 3.6610, val_loss: 5.1554, lr: 0.003000, 5.06s
2024-09-02 17:29:59 INFO     epoch complete!
2024-09-02 17:29:59 INFO     evaluating now!
2024-09-02 17:29:59 INFO     Epoch [61/200] train_loss: 3.6803, val_loss: 5.1728, lr: 0.003000, 5.06s
2024-09-02 17:30:04 INFO     epoch complete!
2024-09-02 17:30:04 INFO     evaluating now!
2024-09-02 17:30:04 INFO     Epoch [62/200] train_loss: 3.6224, val_loss: 5.0464, lr: 0.003000, 5.06s
2024-09-02 17:30:09 INFO     epoch complete!
2024-09-02 17:30:09 INFO     evaluating now!
2024-09-02 17:30:09 INFO     Epoch [63/200] train_loss: 3.5552, val_loss: 5.0740, lr: 0.003000, 5.06s
2024-09-02 17:30:14 INFO     epoch complete!
2024-09-02 17:30:14 INFO     evaluating now!
2024-09-02 17:30:14 INFO     Epoch [64/200] train_loss: 3.5514, val_loss: 5.1606, lr: 0.003000, 5.06s
2024-09-02 17:30:19 INFO     epoch complete!
2024-09-02 17:30:19 INFO     evaluating now!
2024-09-02 17:30:19 INFO     Epoch [65/200] train_loss: 3.5511, val_loss: 4.9735, lr: 0.003000, 5.06s
2024-09-02 17:30:19 INFO     Saved model at 65
2024-09-02 17:30:19 INFO     Val loss decrease from 4.9944 to 4.9735, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch65.tar
2024-09-02 17:30:24 INFO     epoch complete!
2024-09-02 17:30:24 INFO     evaluating now!
2024-09-02 17:30:24 INFO     Epoch [66/200] train_loss: 3.5239, val_loss: 5.0725, lr: 0.003000, 5.06s
2024-09-02 17:30:29 INFO     epoch complete!
2024-09-02 17:30:29 INFO     evaluating now!
2024-09-02 17:30:30 INFO     Epoch [67/200] train_loss: 3.5272, val_loss: 5.0126, lr: 0.003000, 5.06s
2024-09-02 17:30:34 INFO     epoch complete!
2024-09-02 17:30:34 INFO     evaluating now!
2024-09-02 17:30:35 INFO     Epoch [68/200] train_loss: 3.5282, val_loss: 5.1511, lr: 0.003000, 5.06s
2024-09-02 17:30:39 INFO     epoch complete!
2024-09-02 17:30:39 INFO     evaluating now!
2024-09-02 17:30:40 INFO     Epoch [69/200] train_loss: 3.4802, val_loss: 4.9438, lr: 0.003000, 5.07s
2024-09-02 17:30:40 INFO     Saved model at 69
2024-09-02 17:30:40 INFO     Val loss decrease from 4.9735 to 4.9438, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch69.tar
2024-09-02 17:30:44 INFO     epoch complete!
2024-09-02 17:30:44 INFO     evaluating now!
2024-09-02 17:30:45 INFO     Epoch [70/200] train_loss: 3.4834, val_loss: 5.0822, lr: 0.003000, 5.07s
2024-09-02 17:30:49 INFO     epoch complete!
2024-09-02 17:30:49 INFO     evaluating now!
2024-09-02 17:30:50 INFO     Epoch [71/200] train_loss: 3.4631, val_loss: 4.9702, lr: 0.003000, 5.07s
2024-09-02 17:30:55 INFO     epoch complete!
2024-09-02 17:30:55 INFO     evaluating now!
2024-09-02 17:30:55 INFO     Epoch [72/200] train_loss: 3.4295, val_loss: 5.1454, lr: 0.003000, 5.08s
2024-09-02 17:31:00 INFO     epoch complete!
2024-09-02 17:31:00 INFO     evaluating now!
2024-09-02 17:31:00 INFO     Epoch [73/200] train_loss: 3.4544, val_loss: 5.1375, lr: 0.003000, 5.06s
2024-09-02 17:31:05 INFO     epoch complete!
2024-09-02 17:31:05 INFO     evaluating now!
2024-09-02 17:31:05 INFO     Epoch [74/200] train_loss: 3.4232, val_loss: 5.1201, lr: 0.003000, 5.07s
2024-09-02 17:31:10 INFO     epoch complete!
2024-09-02 17:31:10 INFO     evaluating now!
2024-09-02 17:31:10 INFO     Epoch [75/200] train_loss: 3.4480, val_loss: 5.0739, lr: 0.003000, 5.06s
2024-09-02 17:31:15 INFO     epoch complete!
2024-09-02 17:31:15 INFO     evaluating now!
2024-09-02 17:31:15 INFO     Epoch [76/200] train_loss: 3.4290, val_loss: 4.9578, lr: 0.003000, 5.06s
2024-09-02 17:31:20 INFO     epoch complete!
2024-09-02 17:31:20 INFO     evaluating now!
2024-09-02 17:31:20 INFO     Epoch [77/200] train_loss: 3.3942, val_loss: 5.1916, lr: 0.003000, 5.06s
2024-09-02 17:31:25 INFO     epoch complete!
2024-09-02 17:31:25 INFO     evaluating now!
2024-09-02 17:31:25 INFO     Epoch [78/200] train_loss: 3.3733, val_loss: 5.1610, lr: 0.003000, 5.07s
2024-09-02 17:31:30 INFO     epoch complete!
2024-09-02 17:31:30 INFO     evaluating now!
2024-09-02 17:31:30 INFO     Epoch [79/200] train_loss: 3.3412, val_loss: 5.1033, lr: 0.003000, 5.06s
2024-09-02 17:31:35 INFO     epoch complete!
2024-09-02 17:31:35 INFO     evaluating now!
2024-09-02 17:31:35 INFO     Epoch [80/200] train_loss: 3.3300, val_loss: 5.0199, lr: 0.003000, 5.05s
2024-09-02 17:31:40 INFO     epoch complete!
2024-09-02 17:31:40 INFO     evaluating now!
2024-09-02 17:31:40 INFO     Epoch [81/200] train_loss: 3.3334, val_loss: 5.1417, lr: 0.003000, 5.07s
2024-09-02 17:31:45 INFO     epoch complete!
2024-09-02 17:31:45 INFO     evaluating now!
2024-09-02 17:31:45 INFO     Epoch [82/200] train_loss: 3.3394, val_loss: 5.0641, lr: 0.003000, 5.05s
2024-09-02 17:31:50 INFO     epoch complete!
2024-09-02 17:31:50 INFO     evaluating now!
2024-09-02 17:31:51 INFO     Epoch [83/200] train_loss: 3.3964, val_loss: 5.0550, lr: 0.003000, 5.05s
2024-09-02 17:31:55 INFO     epoch complete!
2024-09-02 17:31:55 INFO     evaluating now!
2024-09-02 17:31:56 INFO     Epoch [84/200] train_loss: 3.3180, val_loss: 5.0469, lr: 0.003000, 5.04s
2024-09-02 17:31:56 WARNING  Early stopping at epoch: 84
2024-09-02 17:31:56 INFO     Trained totally 85 epochs, average train time is 4.762s, average eval time is 0.301s
2024-09-02 17:31:56 INFO     Loaded model at 69
2024-09-02 17:31:56 INFO     Saved model at ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 17:31:56 INFO     Start evaluating ...
2024-09-02 17:31:57 INFO     Note that you select the single mode to evaluate!
2024-09-02 17:31:57 INFO     Evaluate result is saved at ./libcity/cache/55/evaluate_cache\2024_09_02_17_31_57_AGCRN_CHITaxi20190406.csv
2024-09-02 17:31:57 INFO     
         MAE       RMSE
1   2.381908   7.684783
2   2.501148   7.985795
3   2.677313   8.728068
4   2.778677   9.299543
5   2.889150   9.917683
6   2.945918  10.549046
7   3.066025  11.248959
8   3.161192  11.977958
9   3.307247  12.687119
10  3.426504  13.351241
11  3.628223  13.896489
12  3.647467  14.453652
2024-09-02 17:31:57 INFO     ----------------------------------------------------------------------------
2024-09-02 17:31:57 INFO     # 3, Kownledge Graph Embedding: TransH, Experiment ids: 58
2024-09-02 17:31:57 INFO     ----------------------------------------------------------------------------
2024-09-02 17:31:57 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=55
2024-09-02 17:31:57 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 55, 'embedding_model': 'TransH', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 17:31:57 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 17:31:57 INFO     set_weight_link_or_dist: dist
2024-09-02 17:31:57 INFO     init_weight_inf_or_zero: inf
2024-09-02 17:31:57 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 17:31:57 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 17:31:57 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 17:31:57 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 17:31:58 INFO     Dataset created
2024-09-02 17:31:58 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 17:31:58 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 17:31:58 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 17:31:58 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 17:31:59 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 17:31:59 INFO     NormalScaler max: 0.49840353722686526
2024-09-02 17:32:01 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 17:32:01 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 17:32:01 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 17:32:01 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 17:32:01 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 17:32:01 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 17:32:01 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 17:32:01 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 17:32:01 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 17:32:01 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 17:32:01 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 17:32:01 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 17:32:01 INFO     Total parameter numbers: 874010
2024-09-02 17:32:01 INFO     You select `adam` optimizer.
2024-09-02 17:32:01 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 17:32:01 INFO     Start training ...
2024-09-02 17:32:01 INFO     num_batches:48
2024-09-02 17:32:06 INFO     epoch complete!
2024-09-02 17:32:06 INFO     evaluating now!
2024-09-02 17:32:06 INFO     Epoch [0/200] train_loss: 24.6924, val_loss: 18.4149, lr: 0.003000, 5.30s
2024-09-02 17:32:06 INFO     Saved model at 0
2024-09-02 17:32:06 INFO     Val loss decrease from inf to 18.4149, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 17:32:11 INFO     epoch complete!
2024-09-02 17:32:11 INFO     evaluating now!
2024-09-02 17:32:11 INFO     Epoch [1/200] train_loss: 15.2171, val_loss: 14.8187, lr: 0.003000, 5.06s
2024-09-02 17:32:11 INFO     Saved model at 1
2024-09-02 17:32:11 INFO     Val loss decrease from 18.4149 to 14.8187, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 17:32:16 INFO     epoch complete!
2024-09-02 17:32:16 INFO     evaluating now!
2024-09-02 17:32:16 INFO     Epoch [2/200] train_loss: 12.1278, val_loss: 11.6184, lr: 0.003000, 5.05s
2024-09-02 17:32:16 INFO     Saved model at 2
2024-09-02 17:32:16 INFO     Val loss decrease from 14.8187 to 11.6184, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 17:32:21 INFO     epoch complete!
2024-09-02 17:32:21 INFO     evaluating now!
2024-09-02 17:32:21 INFO     Epoch [3/200] train_loss: 10.1380, val_loss: 9.9788, lr: 0.003000, 5.05s
2024-09-02 17:32:21 INFO     Saved model at 3
2024-09-02 17:32:21 INFO     Val loss decrease from 11.6184 to 9.9788, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 17:32:26 INFO     epoch complete!
2024-09-02 17:32:26 INFO     evaluating now!
2024-09-02 17:32:26 INFO     Epoch [4/200] train_loss: 8.6480, val_loss: 8.7323, lr: 0.003000, 5.05s
2024-09-02 17:32:26 INFO     Saved model at 4
2024-09-02 17:32:26 INFO     Val loss decrease from 9.9788 to 8.7323, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 17:32:31 INFO     epoch complete!
2024-09-02 17:32:31 INFO     evaluating now!
2024-09-02 17:32:31 INFO     Epoch [5/200] train_loss: 7.9172, val_loss: 7.6321, lr: 0.003000, 5.06s
2024-09-02 17:32:31 INFO     Saved model at 5
2024-09-02 17:32:31 INFO     Val loss decrease from 8.7323 to 7.6321, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 17:32:36 INFO     epoch complete!
2024-09-02 17:32:36 INFO     evaluating now!
2024-09-02 17:32:36 INFO     Epoch [6/200] train_loss: 7.2837, val_loss: 7.1619, lr: 0.003000, 5.06s
2024-09-02 17:32:36 INFO     Saved model at 6
2024-09-02 17:32:36 INFO     Val loss decrease from 7.6321 to 7.1619, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 17:32:41 INFO     epoch complete!
2024-09-02 17:32:41 INFO     evaluating now!
2024-09-02 17:32:41 INFO     Epoch [7/200] train_loss: 6.8824, val_loss: 6.7467, lr: 0.003000, 5.07s
2024-09-02 17:32:41 INFO     Saved model at 7
2024-09-02 17:32:41 INFO     Val loss decrease from 7.1619 to 6.7467, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 17:32:46 INFO     epoch complete!
2024-09-02 17:32:46 INFO     evaluating now!
2024-09-02 17:32:46 INFO     Epoch [8/200] train_loss: 6.4463, val_loss: 6.4420, lr: 0.003000, 5.07s
2024-09-02 17:32:46 INFO     Saved model at 8
2024-09-02 17:32:46 INFO     Val loss decrease from 6.7467 to 6.4420, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 17:32:51 INFO     epoch complete!
2024-09-02 17:32:51 INFO     evaluating now!
2024-09-02 17:32:52 INFO     Epoch [9/200] train_loss: 6.3161, val_loss: 6.6926, lr: 0.003000, 5.07s
2024-09-02 17:32:56 INFO     epoch complete!
2024-09-02 17:32:56 INFO     evaluating now!
2024-09-02 17:32:57 INFO     Epoch [10/200] train_loss: 6.0100, val_loss: 6.1489, lr: 0.003000, 5.07s
2024-09-02 17:32:57 INFO     Saved model at 10
2024-09-02 17:32:57 INFO     Val loss decrease from 6.4420 to 6.1489, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 17:33:01 INFO     epoch complete!
2024-09-02 17:33:01 INFO     evaluating now!
2024-09-02 17:33:02 INFO     Epoch [11/200] train_loss: 5.8620, val_loss: 6.0381, lr: 0.003000, 5.07s
2024-09-02 17:33:02 INFO     Saved model at 11
2024-09-02 17:33:02 INFO     Val loss decrease from 6.1489 to 6.0381, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 17:33:06 INFO     epoch complete!
2024-09-02 17:33:06 INFO     evaluating now!
2024-09-02 17:33:07 INFO     Epoch [12/200] train_loss: 5.7407, val_loss: 5.9547, lr: 0.003000, 5.06s
2024-09-02 17:33:07 INFO     Saved model at 12
2024-09-02 17:33:07 INFO     Val loss decrease from 6.0381 to 5.9547, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 17:33:12 INFO     epoch complete!
2024-09-02 17:33:12 INFO     evaluating now!
2024-09-02 17:33:12 INFO     Epoch [13/200] train_loss: 5.5904, val_loss: 5.9255, lr: 0.003000, 5.06s
2024-09-02 17:33:12 INFO     Saved model at 13
2024-09-02 17:33:12 INFO     Val loss decrease from 5.9547 to 5.9255, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 17:33:17 INFO     epoch complete!
2024-09-02 17:33:17 INFO     evaluating now!
2024-09-02 17:33:17 INFO     Epoch [14/200] train_loss: 5.4971, val_loss: 5.8913, lr: 0.003000, 5.06s
2024-09-02 17:33:17 INFO     Saved model at 14
2024-09-02 17:33:17 INFO     Val loss decrease from 5.9255 to 5.8913, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-02 17:33:22 INFO     epoch complete!
2024-09-02 17:33:22 INFO     evaluating now!
2024-09-02 17:33:22 INFO     Epoch [15/200] train_loss: 5.3608, val_loss: 5.7646, lr: 0.003000, 5.07s
2024-09-02 17:33:22 INFO     Saved model at 15
2024-09-02 17:33:22 INFO     Val loss decrease from 5.8913 to 5.7646, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 17:33:27 INFO     epoch complete!
2024-09-02 17:33:27 INFO     evaluating now!
2024-09-02 17:33:27 INFO     Epoch [16/200] train_loss: 5.2679, val_loss: 5.8216, lr: 0.003000, 5.08s
2024-09-02 17:33:32 INFO     epoch complete!
2024-09-02 17:33:32 INFO     evaluating now!
2024-09-02 17:33:32 INFO     Epoch [17/200] train_loss: 5.2494, val_loss: 5.7214, lr: 0.003000, 5.07s
2024-09-02 17:33:32 INFO     Saved model at 17
2024-09-02 17:33:32 INFO     Val loss decrease from 5.7646 to 5.7214, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-02 17:33:37 INFO     epoch complete!
2024-09-02 17:33:37 INFO     evaluating now!
2024-09-02 17:33:37 INFO     Epoch [18/200] train_loss: 5.0840, val_loss: 5.5338, lr: 0.003000, 5.07s
2024-09-02 17:33:37 INFO     Saved model at 18
2024-09-02 17:33:37 INFO     Val loss decrease from 5.7214 to 5.5338, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-02 17:33:42 INFO     epoch complete!
2024-09-02 17:33:42 INFO     evaluating now!
2024-09-02 17:33:42 INFO     Epoch [19/200] train_loss: 5.0344, val_loss: 5.8461, lr: 0.003000, 5.07s
2024-09-02 17:33:47 INFO     epoch complete!
2024-09-02 17:33:47 INFO     evaluating now!
2024-09-02 17:33:47 INFO     Epoch [20/200] train_loss: 4.9054, val_loss: 5.4367, lr: 0.003000, 5.07s
2024-09-02 17:33:47 INFO     Saved model at 20
2024-09-02 17:33:47 INFO     Val loss decrease from 5.5338 to 5.4367, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-02 17:33:52 INFO     epoch complete!
2024-09-02 17:33:52 INFO     evaluating now!
2024-09-02 17:33:53 INFO     Epoch [21/200] train_loss: 4.8644, val_loss: 5.3455, lr: 0.003000, 5.07s
2024-09-02 17:33:53 INFO     Saved model at 21
2024-09-02 17:33:53 INFO     Val loss decrease from 5.4367 to 5.3455, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-02 17:33:57 INFO     epoch complete!
2024-09-02 17:33:57 INFO     evaluating now!
2024-09-02 17:33:58 INFO     Epoch [22/200] train_loss: 4.8349, val_loss: 5.4197, lr: 0.003000, 5.06s
2024-09-02 17:34:02 INFO     epoch complete!
2024-09-02 17:34:02 INFO     evaluating now!
2024-09-02 17:34:03 INFO     Epoch [23/200] train_loss: 4.8503, val_loss: 5.3923, lr: 0.003000, 5.08s
2024-09-02 17:34:07 INFO     epoch complete!
2024-09-02 17:34:07 INFO     evaluating now!
2024-09-02 17:34:08 INFO     Epoch [24/200] train_loss: 4.7981, val_loss: 5.4871, lr: 0.003000, 5.07s
2024-09-02 17:34:12 INFO     epoch complete!
2024-09-02 17:34:12 INFO     evaluating now!
2024-09-02 17:34:13 INFO     Epoch [25/200] train_loss: 4.6884, val_loss: 5.3365, lr: 0.003000, 5.07s
2024-09-02 17:34:13 INFO     Saved model at 25
2024-09-02 17:34:13 INFO     Val loss decrease from 5.3455 to 5.3365, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-02 17:34:18 INFO     epoch complete!
2024-09-02 17:34:18 INFO     evaluating now!
2024-09-02 17:34:18 INFO     Epoch [26/200] train_loss: 4.5491, val_loss: 5.3511, lr: 0.003000, 5.07s
2024-09-02 17:34:23 INFO     epoch complete!
2024-09-02 17:34:23 INFO     evaluating now!
2024-09-02 17:34:23 INFO     Epoch [27/200] train_loss: 4.5455, val_loss: 5.1853, lr: 0.003000, 5.07s
2024-09-02 17:34:23 INFO     Saved model at 27
2024-09-02 17:34:23 INFO     Val loss decrease from 5.3365 to 5.1853, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-02 17:34:28 INFO     epoch complete!
2024-09-02 17:34:28 INFO     evaluating now!
2024-09-02 17:34:28 INFO     Epoch [28/200] train_loss: 4.5041, val_loss: 5.3344, lr: 0.003000, 5.09s
2024-09-02 17:34:33 INFO     epoch complete!
2024-09-02 17:34:33 INFO     evaluating now!
2024-09-02 17:34:33 INFO     Epoch [29/200] train_loss: 4.4688, val_loss: 5.4570, lr: 0.003000, 5.06s
2024-09-02 17:34:38 INFO     epoch complete!
2024-09-02 17:34:38 INFO     evaluating now!
2024-09-02 17:34:38 INFO     Epoch [30/200] train_loss: 4.4290, val_loss: 5.3230, lr: 0.003000, 5.06s
2024-09-02 17:34:43 INFO     epoch complete!
2024-09-02 17:34:43 INFO     evaluating now!
2024-09-02 17:34:43 INFO     Epoch [31/200] train_loss: 4.3617, val_loss: 5.4404, lr: 0.003000, 5.07s
2024-09-02 17:34:48 INFO     epoch complete!
2024-09-02 17:34:48 INFO     evaluating now!
2024-09-02 17:34:48 INFO     Epoch [32/200] train_loss: 4.3410, val_loss: 5.1113, lr: 0.003000, 5.06s
2024-09-02 17:34:48 INFO     Saved model at 32
2024-09-02 17:34:48 INFO     Val loss decrease from 5.1853 to 5.1113, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-09-02 17:34:53 INFO     epoch complete!
2024-09-02 17:34:53 INFO     evaluating now!
2024-09-02 17:34:53 INFO     Epoch [33/200] train_loss: 4.2966, val_loss: 5.2797, lr: 0.003000, 5.07s
2024-09-02 17:34:58 INFO     epoch complete!
2024-09-02 17:34:58 INFO     evaluating now!
2024-09-02 17:34:58 INFO     Epoch [34/200] train_loss: 4.3325, val_loss: 5.1901, lr: 0.003000, 5.06s
2024-09-02 17:35:03 INFO     epoch complete!
2024-09-02 17:35:03 INFO     evaluating now!
2024-09-02 17:35:04 INFO     Epoch [35/200] train_loss: 4.2931, val_loss: 5.3613, lr: 0.003000, 5.06s
2024-09-02 17:35:08 INFO     epoch complete!
2024-09-02 17:35:08 INFO     evaluating now!
2024-09-02 17:35:09 INFO     Epoch [36/200] train_loss: 4.2294, val_loss: 5.2739, lr: 0.003000, 5.06s
2024-09-02 17:35:13 INFO     epoch complete!
2024-09-02 17:35:13 INFO     evaluating now!
2024-09-02 17:35:14 INFO     Epoch [37/200] train_loss: 4.1320, val_loss: 5.2484, lr: 0.003000, 5.06s
2024-09-02 17:35:18 INFO     epoch complete!
2024-09-02 17:35:18 INFO     evaluating now!
2024-09-02 17:35:19 INFO     Epoch [38/200] train_loss: 4.1760, val_loss: 5.2721, lr: 0.003000, 5.06s
2024-09-02 17:35:23 INFO     epoch complete!
2024-09-02 17:35:23 INFO     evaluating now!
2024-09-02 17:35:24 INFO     Epoch [39/200] train_loss: 4.1037, val_loss: 5.1905, lr: 0.003000, 5.06s
2024-09-02 17:35:29 INFO     epoch complete!
2024-09-02 17:35:29 INFO     evaluating now!
2024-09-02 17:35:29 INFO     Epoch [40/200] train_loss: 4.0658, val_loss: 5.2679, lr: 0.003000, 5.06s
2024-09-02 17:35:34 INFO     epoch complete!
2024-09-02 17:35:34 INFO     evaluating now!
2024-09-02 17:35:34 INFO     Epoch [41/200] train_loss: 4.1363, val_loss: 5.1895, lr: 0.003000, 5.06s
2024-09-02 17:35:39 INFO     epoch complete!
2024-09-02 17:35:39 INFO     evaluating now!
2024-09-02 17:35:39 INFO     Epoch [42/200] train_loss: 4.0122, val_loss: 5.1577, lr: 0.003000, 5.06s
2024-09-02 17:35:44 INFO     epoch complete!
2024-09-02 17:35:44 INFO     evaluating now!
2024-09-02 17:35:44 INFO     Epoch [43/200] train_loss: 4.0321, val_loss: 5.2501, lr: 0.003000, 5.07s
2024-09-02 17:35:49 INFO     epoch complete!
2024-09-02 17:35:49 INFO     evaluating now!
2024-09-02 17:35:49 INFO     Epoch [44/200] train_loss: 3.9408, val_loss: 5.3142, lr: 0.003000, 5.07s
2024-09-02 17:35:54 INFO     epoch complete!
2024-09-02 17:35:54 INFO     evaluating now!
2024-09-02 17:35:54 INFO     Epoch [45/200] train_loss: 3.9027, val_loss: 5.3776, lr: 0.003000, 5.06s
2024-09-02 17:35:59 INFO     epoch complete!
2024-09-02 17:35:59 INFO     evaluating now!
2024-09-02 17:35:59 INFO     Epoch [46/200] train_loss: 3.9312, val_loss: 5.2758, lr: 0.003000, 5.07s
2024-09-02 17:36:04 INFO     epoch complete!
2024-09-02 17:36:04 INFO     evaluating now!
2024-09-02 17:36:04 INFO     Epoch [47/200] train_loss: 3.9650, val_loss: 5.3112, lr: 0.003000, 5.06s
2024-09-02 17:36:04 WARNING  Early stopping at epoch: 47
2024-09-02 17:36:04 INFO     Trained totally 48 epochs, average train time is 4.769s, average eval time is 0.301s
2024-09-02 17:36:04 INFO     Loaded model at 32
2024-09-02 17:36:04 INFO     Saved model at ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 17:36:04 INFO     Start evaluating ...
2024-09-02 17:36:05 INFO     Note that you select the single mode to evaluate!
2024-09-02 17:36:05 INFO     Evaluate result is saved at ./libcity/cache/55/evaluate_cache\2024_09_02_17_36_05_AGCRN_CHITaxi20190406.csv
2024-09-02 17:36:05 INFO     
         MAE       RMSE
1   2.465384   7.907761
2   2.520783   8.184558
3   2.665325   8.950419
4   2.757762   9.501652
5   2.833011  10.054736
6   3.017075  10.849582
7   3.017465  11.389072
8   3.141438  12.003654
9   3.234795  12.461123
10  3.310007  12.793243
11  3.362875  13.223936
12  3.546386  13.843966
2024-09-02 17:36:05 INFO     ----------------------------------------------------------------------------
2024-09-02 17:36:05 INFO     # 4, Kownledge Graph Embedding: TransH, Experiment ids: 59
2024-09-02 17:36:05 INFO     ----------------------------------------------------------------------------
2024-09-02 17:36:05 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=55
2024-09-02 17:36:05 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 55, 'embedding_model': 'TransH', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 17:36:05 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 17:36:05 INFO     set_weight_link_or_dist: dist
2024-09-02 17:36:05 INFO     init_weight_inf_or_zero: inf
2024-09-02 17:36:05 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 17:36:05 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 17:36:05 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 17:36:05 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 17:36:07 INFO     Dataset created
2024-09-02 17:36:07 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 17:36:07 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 17:36:07 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 17:36:07 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 17:36:07 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 17:36:07 INFO     NormalScaler max: 0.49840353722686526
2024-09-02 17:36:09 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 17:36:09 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 17:36:09 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 17:36:09 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 17:36:09 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 17:36:09 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 17:36:09 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 17:36:09 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 17:36:09 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 17:36:09 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 17:36:09 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 17:36:09 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 17:36:09 INFO     Total parameter numbers: 874010
2024-09-02 17:36:09 INFO     You select `adam` optimizer.
2024-09-02 17:36:09 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 17:36:09 INFO     Start training ...
2024-09-02 17:36:09 INFO     num_batches:48
2024-09-02 17:36:14 INFO     epoch complete!
2024-09-02 17:36:14 INFO     evaluating now!
2024-09-02 17:36:15 INFO     Epoch [0/200] train_loss: 24.3835, val_loss: 18.8259, lr: 0.003000, 5.37s
2024-09-02 17:36:15 INFO     Saved model at 0
2024-09-02 17:36:15 INFO     Val loss decrease from inf to 18.8259, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 17:36:19 INFO     epoch complete!
2024-09-02 17:36:19 INFO     evaluating now!
2024-09-02 17:36:20 INFO     Epoch [1/200] train_loss: 15.5907, val_loss: 15.0260, lr: 0.003000, 5.06s
2024-09-02 17:36:20 INFO     Saved model at 1
2024-09-02 17:36:20 INFO     Val loss decrease from 18.8259 to 15.0260, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 17:36:24 INFO     epoch complete!
2024-09-02 17:36:24 INFO     evaluating now!
2024-09-02 17:36:25 INFO     Epoch [2/200] train_loss: 12.9990, val_loss: 13.0422, lr: 0.003000, 5.06s
2024-09-02 17:36:25 INFO     Saved model at 2
2024-09-02 17:36:25 INFO     Val loss decrease from 15.0260 to 13.0422, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 17:36:30 INFO     epoch complete!
2024-09-02 17:36:30 INFO     evaluating now!
2024-09-02 17:36:30 INFO     Epoch [3/200] train_loss: 11.0278, val_loss: 10.4790, lr: 0.003000, 5.06s
2024-09-02 17:36:30 INFO     Saved model at 3
2024-09-02 17:36:30 INFO     Val loss decrease from 13.0422 to 10.4790, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 17:36:35 INFO     epoch complete!
2024-09-02 17:36:35 INFO     evaluating now!
2024-09-02 17:36:35 INFO     Epoch [4/200] train_loss: 9.3038, val_loss: 9.0742, lr: 0.003000, 5.06s
2024-09-02 17:36:35 INFO     Saved model at 4
2024-09-02 17:36:35 INFO     Val loss decrease from 10.4790 to 9.0742, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 17:36:40 INFO     epoch complete!
2024-09-02 17:36:40 INFO     evaluating now!
2024-09-02 17:36:40 INFO     Epoch [5/200] train_loss: 8.2071, val_loss: 8.3815, lr: 0.003000, 5.07s
2024-09-02 17:36:40 INFO     Saved model at 5
2024-09-02 17:36:40 INFO     Val loss decrease from 9.0742 to 8.3815, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 17:36:45 INFO     epoch complete!
2024-09-02 17:36:45 INFO     evaluating now!
2024-09-02 17:36:45 INFO     Epoch [6/200] train_loss: 7.4623, val_loss: 7.6524, lr: 0.003000, 5.08s
2024-09-02 17:36:45 INFO     Saved model at 6
2024-09-02 17:36:45 INFO     Val loss decrease from 8.3815 to 7.6524, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 17:36:50 INFO     epoch complete!
2024-09-02 17:36:50 INFO     evaluating now!
2024-09-02 17:36:50 INFO     Epoch [7/200] train_loss: 6.9449, val_loss: 6.7382, lr: 0.003000, 5.07s
2024-09-02 17:36:50 INFO     Saved model at 7
2024-09-02 17:36:50 INFO     Val loss decrease from 7.6524 to 6.7382, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 17:36:55 INFO     epoch complete!
2024-09-02 17:36:55 INFO     evaluating now!
2024-09-02 17:36:55 INFO     Epoch [8/200] train_loss: 6.5570, val_loss: 6.5267, lr: 0.003000, 5.07s
2024-09-02 17:36:55 INFO     Saved model at 8
2024-09-02 17:36:55 INFO     Val loss decrease from 6.7382 to 6.5267, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 17:37:00 INFO     epoch complete!
2024-09-02 17:37:00 INFO     evaluating now!
2024-09-02 17:37:00 INFO     Epoch [9/200] train_loss: 6.4662, val_loss: 6.4113, lr: 0.003000, 5.07s
2024-09-02 17:37:00 INFO     Saved model at 9
2024-09-02 17:37:00 INFO     Val loss decrease from 6.5267 to 6.4113, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 17:37:05 INFO     epoch complete!
2024-09-02 17:37:05 INFO     evaluating now!
2024-09-02 17:37:05 INFO     Epoch [10/200] train_loss: 6.1275, val_loss: 6.1126, lr: 0.003000, 5.06s
2024-09-02 17:37:05 INFO     Saved model at 10
2024-09-02 17:37:05 INFO     Val loss decrease from 6.4113 to 6.1126, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 17:37:10 INFO     epoch complete!
2024-09-02 17:37:10 INFO     evaluating now!
2024-09-02 17:37:10 INFO     Epoch [11/200] train_loss: 5.8333, val_loss: 6.1450, lr: 0.003000, 5.07s
2024-09-02 17:37:15 INFO     epoch complete!
2024-09-02 17:37:15 INFO     evaluating now!
2024-09-02 17:37:16 INFO     Epoch [12/200] train_loss: 5.7692, val_loss: 5.8673, lr: 0.003000, 5.06s
2024-09-02 17:37:16 INFO     Saved model at 12
2024-09-02 17:37:16 INFO     Val loss decrease from 6.1126 to 5.8673, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 17:37:20 INFO     epoch complete!
2024-09-02 17:37:20 INFO     evaluating now!
2024-09-02 17:37:21 INFO     Epoch [13/200] train_loss: 5.5878, val_loss: 5.7315, lr: 0.003000, 5.06s
2024-09-02 17:37:21 INFO     Saved model at 13
2024-09-02 17:37:21 INFO     Val loss decrease from 5.8673 to 5.7315, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 17:37:25 INFO     epoch complete!
2024-09-02 17:37:25 INFO     evaluating now!
2024-09-02 17:37:26 INFO     Epoch [14/200] train_loss: 5.4578, val_loss: 5.7172, lr: 0.003000, 5.07s
2024-09-02 17:37:26 INFO     Saved model at 14
2024-09-02 17:37:26 INFO     Val loss decrease from 5.7315 to 5.7172, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-02 17:37:30 INFO     epoch complete!
2024-09-02 17:37:30 INFO     evaluating now!
2024-09-02 17:37:31 INFO     Epoch [15/200] train_loss: 5.4321, val_loss: 5.6967, lr: 0.003000, 5.06s
2024-09-02 17:37:31 INFO     Saved model at 15
2024-09-02 17:37:31 INFO     Val loss decrease from 5.7172 to 5.6967, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 17:37:36 INFO     epoch complete!
2024-09-02 17:37:36 INFO     evaluating now!
2024-09-02 17:37:36 INFO     Epoch [16/200] train_loss: 5.2940, val_loss: 5.4611, lr: 0.003000, 5.07s
2024-09-02 17:37:36 INFO     Saved model at 16
2024-09-02 17:37:36 INFO     Val loss decrease from 5.6967 to 5.4611, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 17:37:41 INFO     epoch complete!
2024-09-02 17:37:41 INFO     evaluating now!
2024-09-02 17:37:41 INFO     Epoch [17/200] train_loss: 5.1485, val_loss: 5.5556, lr: 0.003000, 5.06s
2024-09-02 17:37:46 INFO     epoch complete!
2024-09-02 17:37:46 INFO     evaluating now!
2024-09-02 17:37:46 INFO     Epoch [18/200] train_loss: 5.0557, val_loss: 5.7004, lr: 0.003000, 5.07s
2024-09-02 17:37:51 INFO     epoch complete!
2024-09-02 17:37:51 INFO     evaluating now!
2024-09-02 17:37:51 INFO     Epoch [19/200] train_loss: 4.9863, val_loss: 5.2573, lr: 0.003000, 5.07s
2024-09-02 17:37:51 INFO     Saved model at 19
2024-09-02 17:37:51 INFO     Val loss decrease from 5.4611 to 5.2573, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-02 17:37:56 INFO     epoch complete!
2024-09-02 17:37:56 INFO     evaluating now!
2024-09-02 17:37:56 INFO     Epoch [20/200] train_loss: 4.8677, val_loss: 5.3843, lr: 0.003000, 5.06s
2024-09-02 17:38:01 INFO     epoch complete!
2024-09-02 17:38:01 INFO     evaluating now!
2024-09-02 17:38:01 INFO     Epoch [21/200] train_loss: 4.9641, val_loss: 5.4459, lr: 0.003000, 5.07s
2024-09-02 17:38:06 INFO     epoch complete!
2024-09-02 17:38:06 INFO     evaluating now!
2024-09-02 17:38:06 INFO     Epoch [22/200] train_loss: 4.7714, val_loss: 5.3687, lr: 0.003000, 5.06s
2024-09-02 17:38:11 INFO     epoch complete!
2024-09-02 17:38:11 INFO     evaluating now!
2024-09-02 17:38:11 INFO     Epoch [23/200] train_loss: 4.7699, val_loss: 5.1509, lr: 0.003000, 5.07s
2024-09-02 17:38:11 INFO     Saved model at 23
2024-09-02 17:38:11 INFO     Val loss decrease from 5.2573 to 5.1509, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-02 17:38:16 INFO     epoch complete!
2024-09-02 17:38:16 INFO     evaluating now!
2024-09-02 17:38:16 INFO     Epoch [24/200] train_loss: 4.6201, val_loss: 5.1896, lr: 0.003000, 5.07s
2024-09-02 17:38:21 INFO     epoch complete!
2024-09-02 17:38:21 INFO     evaluating now!
2024-09-02 17:38:22 INFO     Epoch [25/200] train_loss: 4.5385, val_loss: 5.3043, lr: 0.003000, 5.07s
2024-09-02 17:38:26 INFO     epoch complete!
2024-09-02 17:38:26 INFO     evaluating now!
2024-09-02 17:38:27 INFO     Epoch [26/200] train_loss: 4.5480, val_loss: 5.1905, lr: 0.003000, 5.07s
2024-09-02 17:38:31 INFO     epoch complete!
2024-09-02 17:38:31 INFO     evaluating now!
2024-09-02 17:38:32 INFO     Epoch [27/200] train_loss: 4.4900, val_loss: 5.1595, lr: 0.003000, 5.06s
2024-09-02 17:38:36 INFO     epoch complete!
2024-09-02 17:38:36 INFO     evaluating now!
2024-09-02 17:38:37 INFO     Epoch [28/200] train_loss: 4.4286, val_loss: 5.0214, lr: 0.003000, 5.07s
2024-09-02 17:38:37 INFO     Saved model at 28
2024-09-02 17:38:37 INFO     Val loss decrease from 5.1509 to 5.0214, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-02 17:38:41 INFO     epoch complete!
2024-09-02 17:38:41 INFO     evaluating now!
2024-09-02 17:38:42 INFO     Epoch [29/200] train_loss: 4.3792, val_loss: 5.1309, lr: 0.003000, 5.06s
2024-09-02 17:38:47 INFO     epoch complete!
2024-09-02 17:38:47 INFO     evaluating now!
2024-09-02 17:38:47 INFO     Epoch [30/200] train_loss: 4.3541, val_loss: 5.0623, lr: 0.003000, 5.07s
2024-09-02 17:38:52 INFO     epoch complete!
2024-09-02 17:38:52 INFO     evaluating now!
2024-09-02 17:38:52 INFO     Epoch [31/200] train_loss: 4.2965, val_loss: 5.1434, lr: 0.003000, 5.07s
2024-09-02 17:38:57 INFO     epoch complete!
2024-09-02 17:38:57 INFO     evaluating now!
2024-09-02 17:38:57 INFO     Epoch [32/200] train_loss: 4.2778, val_loss: 5.1304, lr: 0.003000, 5.07s
2024-09-02 17:39:02 INFO     epoch complete!
2024-09-02 17:39:02 INFO     evaluating now!
2024-09-02 17:39:02 INFO     Epoch [33/200] train_loss: 4.2211, val_loss: 5.1327, lr: 0.003000, 5.07s
2024-09-02 17:39:07 INFO     epoch complete!
2024-09-02 17:39:07 INFO     evaluating now!
2024-09-02 17:39:07 INFO     Epoch [34/200] train_loss: 4.1256, val_loss: 5.0419, lr: 0.003000, 5.04s
2024-09-02 17:39:12 INFO     epoch complete!
2024-09-02 17:39:12 INFO     evaluating now!
2024-09-02 17:39:12 INFO     Epoch [35/200] train_loss: 4.1266, val_loss: 5.1491, lr: 0.003000, 5.06s
2024-09-02 17:39:17 INFO     epoch complete!
2024-09-02 17:39:17 INFO     evaluating now!
2024-09-02 17:39:17 INFO     Epoch [36/200] train_loss: 4.0679, val_loss: 5.0955, lr: 0.003000, 5.07s
2024-09-02 17:39:22 INFO     epoch complete!
2024-09-02 17:39:22 INFO     evaluating now!
2024-09-02 17:39:22 INFO     Epoch [37/200] train_loss: 4.0797, val_loss: 5.0691, lr: 0.003000, 5.05s
2024-09-02 17:39:27 INFO     epoch complete!
2024-09-02 17:39:27 INFO     evaluating now!
2024-09-02 17:39:27 INFO     Epoch [38/200] train_loss: 4.0727, val_loss: 4.9829, lr: 0.003000, 5.05s
2024-09-02 17:39:27 INFO     Saved model at 38
2024-09-02 17:39:27 INFO     Val loss decrease from 5.0214 to 4.9829, saving to ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-09-02 17:39:32 INFO     epoch complete!
2024-09-02 17:39:32 INFO     evaluating now!
2024-09-02 17:39:32 INFO     Epoch [39/200] train_loss: 3.9996, val_loss: 5.0446, lr: 0.003000, 5.05s
2024-09-02 17:39:37 INFO     epoch complete!
2024-09-02 17:39:37 INFO     evaluating now!
2024-09-02 17:39:37 INFO     Epoch [40/200] train_loss: 3.9753, val_loss: 5.0349, lr: 0.003000, 5.05s
2024-09-02 17:39:42 INFO     epoch complete!
2024-09-02 17:39:42 INFO     evaluating now!
2024-09-02 17:39:42 INFO     Epoch [41/200] train_loss: 3.9978, val_loss: 5.1340, lr: 0.003000, 5.05s
2024-09-02 17:39:47 INFO     epoch complete!
2024-09-02 17:39:47 INFO     evaluating now!
2024-09-02 17:39:48 INFO     Epoch [42/200] train_loss: 3.9105, val_loss: 5.1441, lr: 0.003000, 5.05s
2024-09-02 17:39:52 INFO     epoch complete!
2024-09-02 17:39:52 INFO     evaluating now!
2024-09-02 17:39:53 INFO     Epoch [43/200] train_loss: 3.9327, val_loss: 5.0882, lr: 0.003000, 5.05s
2024-09-02 17:39:57 INFO     epoch complete!
2024-09-02 17:39:57 INFO     evaluating now!
2024-09-02 17:39:58 INFO     Epoch [44/200] train_loss: 3.8984, val_loss: 5.0636, lr: 0.003000, 5.05s
2024-09-02 17:40:02 INFO     epoch complete!
2024-09-02 17:40:02 INFO     evaluating now!
2024-09-02 17:40:03 INFO     Epoch [45/200] train_loss: 3.8614, val_loss: 5.0693, lr: 0.003000, 5.05s
2024-09-02 17:40:07 INFO     epoch complete!
2024-09-02 17:40:07 INFO     evaluating now!
2024-09-02 17:40:08 INFO     Epoch [46/200] train_loss: 3.8536, val_loss: 5.1329, lr: 0.003000, 5.05s
2024-09-02 17:40:12 INFO     epoch complete!
2024-09-02 17:40:12 INFO     evaluating now!
2024-09-02 17:40:13 INFO     Epoch [47/200] train_loss: 3.8328, val_loss: 5.1433, lr: 0.003000, 5.05s
2024-09-02 17:40:18 INFO     epoch complete!
2024-09-02 17:40:18 INFO     evaluating now!
2024-09-02 17:40:18 INFO     Epoch [48/200] train_loss: 3.8300, val_loss: 5.1116, lr: 0.003000, 5.05s
2024-09-02 17:40:23 INFO     epoch complete!
2024-09-02 17:40:23 INFO     evaluating now!
2024-09-02 17:40:23 INFO     Epoch [49/200] train_loss: 3.7768, val_loss: 5.0981, lr: 0.003000, 5.04s
2024-09-02 17:40:28 INFO     epoch complete!
2024-09-02 17:40:28 INFO     evaluating now!
2024-09-02 17:40:28 INFO     Epoch [50/200] train_loss: 3.6970, val_loss: 5.0537, lr: 0.003000, 5.05s
2024-09-02 17:40:33 INFO     epoch complete!
2024-09-02 17:40:33 INFO     evaluating now!
2024-09-02 17:40:33 INFO     Epoch [51/200] train_loss: 3.7211, val_loss: 5.0372, lr: 0.003000, 5.05s
2024-09-02 17:40:38 INFO     epoch complete!
2024-09-02 17:40:38 INFO     evaluating now!
2024-09-02 17:40:38 INFO     Epoch [52/200] train_loss: 3.6827, val_loss: 5.0929, lr: 0.003000, 5.05s
2024-09-02 17:40:43 INFO     epoch complete!
2024-09-02 17:40:43 INFO     evaluating now!
2024-09-02 17:40:43 INFO     Epoch [53/200] train_loss: 3.6784, val_loss: 4.9934, lr: 0.003000, 5.04s
2024-09-02 17:40:43 WARNING  Early stopping at epoch: 53
2024-09-02 17:40:43 INFO     Trained totally 54 epochs, average train time is 4.765s, average eval time is 0.300s
2024-09-02 17:40:43 INFO     Loaded model at 38
2024-09-02 17:40:43 INFO     Saved model at ./libcity/cache/55/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 17:40:43 INFO     Start evaluating ...
2024-09-02 17:40:44 INFO     Note that you select the single mode to evaluate!
2024-09-02 17:40:44 INFO     Evaluate result is saved at ./libcity/cache/55/evaluate_cache\2024_09_02_17_40_44_AGCRN_CHITaxi20190406.csv
2024-09-02 17:40:44 INFO     
         MAE       RMSE
1   2.363715   7.415790
2   2.453240   7.999996
3   2.603760   8.845363
4   2.680646   9.385086
5   2.780547  10.042334
6   2.997337  10.806845
7   3.079465  11.598527
8   3.222223  12.352839
9   3.329324  12.837253
10  3.416404  13.312016
11  3.437002  13.612906
12  3.606011  14.029483
2024-09-02 17:40:44 INFO     ----------------------------------------------------------------------------
2024-09-02 17:40:44 INFO     Kownledge Graph Embedding: TransH, Experiment ids: [55, 56, 57, 58, 59]
2024-09-02 17:40:44 INFO     ----------------------------------------------------------------------------
2024-09-02 17:40:44 INFO     Average: 
         MAE       RMSE
0   2.395374   7.503837
1   2.478506   7.979094
2   2.625675   8.809811
3   2.730583   9.417966
4   2.842870  10.105640
5   2.993537  10.931189
6   3.079806  11.689916
7   3.168113  12.339807
8   3.262954  12.756505
9   3.326975  13.110048
10  3.397327  13.457298
11  3.532339  13.964812 
2024-09-02 17:40:44 INFO     Standard deviation: 
         MAE      RMSE
0   0.090696  0.261965
1   0.067071  0.118535
2   0.068261  0.080436
3   0.070661  0.076797
4   0.048683  0.191503
5   0.042768  0.359970
6   0.050313  0.473441
7   0.044595  0.465948
8   0.052667  0.401973
9   0.085364  0.414148
10  0.132768  0.426650
11  0.089671  0.477914
2024-09-02 17:40:44 INFO     ----------------------------------------------------------------------------
2024-09-02 17:40:44 INFO     12 steps Average: 
        MAE       RMSE
0  2.986172  11.005494
2024-09-02 17:40:44 INFO     12 steps Standard deviation: 
        MAE     RMSE
0  0.070293  0.31244
