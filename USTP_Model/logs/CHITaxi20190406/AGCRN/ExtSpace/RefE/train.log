2024-05-03 00:09:22 INFO     Saving logs in: ./logs/CHITaxi20190406/AGCRN/ExtSpace/Scaler/normal/RefE
2024-05-03 00:09:22 INFO     ----------------------------------------------------------------------------
2024-05-03 00:09:22 INFO     # 0, Kownledge Graph Embedding: RefE, Experiment ids: 35
2024-05-03 00:09:22 INFO     ----------------------------------------------------------------------------
2024-05-03 00:09:22 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=35
2024-05-03 00:09:22 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 35, 'load_external': True, 'embedding_model': 'RefE', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-03 00:09:23 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-03 00:09:23 INFO     set_weight_link_or_dist: dist
2024-05-03 00:09:23 INFO     init_weight_inf_or_zero: inf
2024-05-03 00:09:23 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-03 00:09:23 INFO     Start Calculate the weight by Gauss kernel!
2024-05-03 00:09:23 INFO     Loading file CHITaxi20190406.dyna
2024-05-03 00:09:23 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-03 00:09:26 INFO     Dataset created
2024-05-03 00:09:26 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-03 00:09:26 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-03 00:09:26 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-03 00:09:26 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-03 00:09:26 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-03 00:09:26 INFO     NormalScaler max: 1.6586810199691633
2024-05-03 00:09:32 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-03 00:09:32 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-03 00:09:32 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-03 00:09:32 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-03 00:09:32 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-03 00:09:32 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-03 00:09:32 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-03 00:09:32 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-03 00:09:32 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-03 00:09:32 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-03 00:09:32 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-03 00:09:32 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-03 00:09:32 INFO     Total parameter numbers: 874010
2024-05-03 00:09:32 INFO     You select `adam` optimizer.
2024-05-03 00:09:32 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-03 00:09:32 INFO     Start training ...
2024-05-03 00:09:32 INFO     num_batches:48
2024-05-03 00:09:39 INFO     epoch complete!
2024-05-03 00:09:39 INFO     evaluating now!
2024-05-03 00:09:39 INFO     Epoch [0/200] train_loss: 24.7956, val_loss: 18.7494, lr: 0.003000, 7.24s
2024-05-03 00:09:39 INFO     Saved model at 0
2024-05-03 00:09:39 INFO     Val loss decrease from inf to 18.7494, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-03 00:09:45 INFO     epoch complete!
2024-05-03 00:09:45 INFO     evaluating now!
2024-05-03 00:09:46 INFO     Epoch [1/200] train_loss: 15.5991, val_loss: 15.2216, lr: 0.003000, 6.64s
2024-05-03 00:09:46 INFO     Saved model at 1
2024-05-03 00:09:46 INFO     Val loss decrease from 18.7494 to 15.2216, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-03 00:09:53 INFO     epoch complete!
2024-05-03 00:09:53 INFO     evaluating now!
2024-05-03 00:09:53 INFO     Epoch [2/200] train_loss: 12.2837, val_loss: 11.7970, lr: 0.003000, 7.04s
2024-05-03 00:09:53 INFO     Saved model at 2
2024-05-03 00:09:53 INFO     Val loss decrease from 15.2216 to 11.7970, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-03 00:10:00 INFO     epoch complete!
2024-05-03 00:10:00 INFO     evaluating now!
2024-05-03 00:10:00 INFO     Epoch [3/200] train_loss: 9.8692, val_loss: 9.7789, lr: 0.003000, 7.37s
2024-05-03 00:10:01 INFO     Saved model at 3
2024-05-03 00:10:01 INFO     Val loss decrease from 11.7970 to 9.7789, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-03 00:10:07 INFO     epoch complete!
2024-05-03 00:10:07 INFO     evaluating now!
2024-05-03 00:10:08 INFO     Epoch [4/200] train_loss: 8.6302, val_loss: 8.5373, lr: 0.003000, 7.09s
2024-05-03 00:10:08 INFO     Saved model at 4
2024-05-03 00:10:08 INFO     Val loss decrease from 9.7789 to 8.5373, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-03 00:10:14 INFO     epoch complete!
2024-05-03 00:10:14 INFO     evaluating now!
2024-05-03 00:10:15 INFO     Epoch [5/200] train_loss: 7.9037, val_loss: 7.4548, lr: 0.003000, 7.13s
2024-05-03 00:10:15 INFO     Saved model at 5
2024-05-03 00:10:15 INFO     Val loss decrease from 8.5373 to 7.4548, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-03 00:10:21 INFO     epoch complete!
2024-05-03 00:10:21 INFO     evaluating now!
2024-05-03 00:10:22 INFO     Epoch [6/200] train_loss: 7.1809, val_loss: 7.1589, lr: 0.003000, 7.14s
2024-05-03 00:10:22 INFO     Saved model at 6
2024-05-03 00:10:22 INFO     Val loss decrease from 7.4548 to 7.1589, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-03 00:10:29 INFO     epoch complete!
2024-05-03 00:10:29 INFO     evaluating now!
2024-05-03 00:10:29 INFO     Epoch [7/200] train_loss: 6.6865, val_loss: 6.7003, lr: 0.003000, 7.23s
2024-05-03 00:10:29 INFO     Saved model at 7
2024-05-03 00:10:29 INFO     Val loss decrease from 7.1589 to 6.7003, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-03 00:10:36 INFO     epoch complete!
2024-05-03 00:10:36 INFO     evaluating now!
2024-05-03 00:10:36 INFO     Epoch [8/200] train_loss: 6.2992, val_loss: 6.3075, lr: 0.003000, 6.88s
2024-05-03 00:10:36 INFO     Saved model at 8
2024-05-03 00:10:36 INFO     Val loss decrease from 6.7003 to 6.3075, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-03 00:10:42 INFO     epoch complete!
2024-05-03 00:10:42 INFO     evaluating now!
2024-05-03 00:10:43 INFO     Epoch [9/200] train_loss: 6.0789, val_loss: 6.1353, lr: 0.003000, 6.63s
2024-05-03 00:10:43 INFO     Saved model at 9
2024-05-03 00:10:43 INFO     Val loss decrease from 6.3075 to 6.1353, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-03 00:10:49 INFO     epoch complete!
2024-05-03 00:10:49 INFO     evaluating now!
2024-05-03 00:10:49 INFO     Epoch [10/200] train_loss: 5.8694, val_loss: 6.1218, lr: 0.003000, 6.59s
2024-05-03 00:10:50 INFO     Saved model at 10
2024-05-03 00:10:50 INFO     Val loss decrease from 6.1353 to 6.1218, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-03 00:10:56 INFO     epoch complete!
2024-05-03 00:10:56 INFO     evaluating now!
2024-05-03 00:10:56 INFO     Epoch [11/200] train_loss: 5.7704, val_loss: 5.9667, lr: 0.003000, 6.71s
2024-05-03 00:10:57 INFO     Saved model at 11
2024-05-03 00:10:57 INFO     Val loss decrease from 6.1218 to 5.9667, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-03 00:11:03 INFO     epoch complete!
2024-05-03 00:11:03 INFO     evaluating now!
2024-05-03 00:11:03 INFO     Epoch [12/200] train_loss: 5.5458, val_loss: 5.6572, lr: 0.003000, 6.81s
2024-05-03 00:11:03 INFO     Saved model at 12
2024-05-03 00:11:03 INFO     Val loss decrease from 5.9667 to 5.6572, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-03 00:11:10 INFO     epoch complete!
2024-05-03 00:11:10 INFO     evaluating now!
2024-05-03 00:11:10 INFO     Epoch [13/200] train_loss: 5.4740, val_loss: 6.0308, lr: 0.003000, 6.93s
2024-05-03 00:11:17 INFO     epoch complete!
2024-05-03 00:11:17 INFO     evaluating now!
2024-05-03 00:11:18 INFO     Epoch [14/200] train_loss: 5.3435, val_loss: 5.6170, lr: 0.003000, 7.29s
2024-05-03 00:11:18 INFO     Saved model at 14
2024-05-03 00:11:18 INFO     Val loss decrease from 5.6572 to 5.6170, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-03 00:11:24 INFO     epoch complete!
2024-05-03 00:11:24 INFO     evaluating now!
2024-05-03 00:11:25 INFO     Epoch [15/200] train_loss: 5.2085, val_loss: 5.7102, lr: 0.003000, 7.05s
2024-05-03 00:11:31 INFO     epoch complete!
2024-05-03 00:11:31 INFO     evaluating now!
2024-05-03 00:11:32 INFO     Epoch [16/200] train_loss: 5.1140, val_loss: 5.7088, lr: 0.003000, 7.02s
2024-05-03 00:11:38 INFO     epoch complete!
2024-05-03 00:11:38 INFO     evaluating now!
2024-05-03 00:11:39 INFO     Epoch [17/200] train_loss: 5.1074, val_loss: 5.2881, lr: 0.003000, 6.93s
2024-05-03 00:11:39 INFO     Saved model at 17
2024-05-03 00:11:39 INFO     Val loss decrease from 5.6170 to 5.2881, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-03 00:11:45 INFO     epoch complete!
2024-05-03 00:11:45 INFO     evaluating now!
2024-05-03 00:11:46 INFO     Epoch [18/200] train_loss: 5.0002, val_loss: 5.5208, lr: 0.003000, 6.91s
2024-05-03 00:11:52 INFO     epoch complete!
2024-05-03 00:11:52 INFO     evaluating now!
2024-05-03 00:11:53 INFO     Epoch [19/200] train_loss: 4.9346, val_loss: 5.6398, lr: 0.003000, 7.04s
2024-05-03 00:11:59 INFO     epoch complete!
2024-05-03 00:11:59 INFO     evaluating now!
2024-05-03 00:12:00 INFO     Epoch [20/200] train_loss: 4.8137, val_loss: 5.4004, lr: 0.003000, 6.98s
2024-05-03 00:12:06 INFO     epoch complete!
2024-05-03 00:12:06 INFO     evaluating now!
2024-05-03 00:12:07 INFO     Epoch [21/200] train_loss: 4.8289, val_loss: 5.3849, lr: 0.003000, 6.99s
2024-05-03 00:12:13 INFO     epoch complete!
2024-05-03 00:12:13 INFO     evaluating now!
2024-05-03 00:12:14 INFO     Epoch [22/200] train_loss: 4.7657, val_loss: 5.3137, lr: 0.003000, 7.20s
2024-05-03 00:12:20 INFO     epoch complete!
2024-05-03 00:12:20 INFO     evaluating now!
2024-05-03 00:12:21 INFO     Epoch [23/200] train_loss: 4.6622, val_loss: 5.2593, lr: 0.003000, 6.98s
2024-05-03 00:12:21 INFO     Saved model at 23
2024-05-03 00:12:21 INFO     Val loss decrease from 5.2881 to 5.2593, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-05-03 00:12:28 INFO     epoch complete!
2024-05-03 00:12:28 INFO     evaluating now!
2024-05-03 00:12:28 INFO     Epoch [24/200] train_loss: 4.6741, val_loss: 5.3734, lr: 0.003000, 7.17s
2024-05-03 00:12:35 INFO     epoch complete!
2024-05-03 00:12:35 INFO     evaluating now!
2024-05-03 00:12:35 INFO     Epoch [25/200] train_loss: 4.5420, val_loss: 5.2814, lr: 0.003000, 7.22s
2024-05-03 00:12:42 INFO     epoch complete!
2024-05-03 00:12:42 INFO     evaluating now!
2024-05-03 00:12:42 INFO     Epoch [26/200] train_loss: 4.4837, val_loss: 5.4620, lr: 0.003000, 7.12s
2024-05-03 00:12:49 INFO     epoch complete!
2024-05-03 00:12:49 INFO     evaluating now!
2024-05-03 00:12:49 INFO     Epoch [27/200] train_loss: 4.5087, val_loss: 5.3483, lr: 0.003000, 6.83s
2024-05-03 00:12:56 INFO     epoch complete!
2024-05-03 00:12:56 INFO     evaluating now!
2024-05-03 00:12:56 INFO     Epoch [28/200] train_loss: 4.4496, val_loss: 5.1818, lr: 0.003000, 6.81s
2024-05-03 00:12:56 INFO     Saved model at 28
2024-05-03 00:12:56 INFO     Val loss decrease from 5.2593 to 5.1818, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-05-03 00:13:03 INFO     epoch complete!
2024-05-03 00:13:03 INFO     evaluating now!
2024-05-03 00:13:03 INFO     Epoch [29/200] train_loss: 4.4078, val_loss: 5.3291, lr: 0.003000, 7.05s
2024-05-03 00:13:10 INFO     epoch complete!
2024-05-03 00:13:10 INFO     evaluating now!
2024-05-03 00:13:10 INFO     Epoch [30/200] train_loss: 4.4206, val_loss: 5.2990, lr: 0.003000, 7.00s
2024-05-03 00:13:17 INFO     epoch complete!
2024-05-03 00:13:17 INFO     evaluating now!
2024-05-03 00:13:17 INFO     Epoch [31/200] train_loss: 4.3618, val_loss: 5.3936, lr: 0.003000, 6.88s
2024-05-03 00:13:23 INFO     epoch complete!
2024-05-03 00:13:23 INFO     evaluating now!
2024-05-03 00:13:24 INFO     Epoch [32/200] train_loss: 4.3595, val_loss: 5.3077, lr: 0.003000, 6.95s
2024-05-03 00:13:30 INFO     epoch complete!
2024-05-03 00:13:30 INFO     evaluating now!
2024-05-03 00:13:31 INFO     Epoch [33/200] train_loss: 4.2684, val_loss: 5.2238, lr: 0.003000, 7.00s
2024-05-03 00:13:38 INFO     epoch complete!
2024-05-03 00:13:38 INFO     evaluating now!
2024-05-03 00:13:38 INFO     Epoch [34/200] train_loss: 4.1870, val_loss: 5.2682, lr: 0.003000, 7.08s
2024-05-03 00:13:45 INFO     epoch complete!
2024-05-03 00:13:45 INFO     evaluating now!
2024-05-03 00:13:45 INFO     Epoch [35/200] train_loss: 4.1601, val_loss: 5.1482, lr: 0.003000, 7.01s
2024-05-03 00:13:45 INFO     Saved model at 35
2024-05-03 00:13:45 INFO     Val loss decrease from 5.1818 to 5.1482, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-05-03 00:13:51 INFO     epoch complete!
2024-05-03 00:13:51 INFO     evaluating now!
2024-05-03 00:13:52 INFO     Epoch [36/200] train_loss: 4.2009, val_loss: 5.2665, lr: 0.003000, 6.87s
2024-05-03 00:13:59 INFO     epoch complete!
2024-05-03 00:13:59 INFO     evaluating now!
2024-05-03 00:13:59 INFO     Epoch [37/200] train_loss: 4.1571, val_loss: 5.2445, lr: 0.003000, 7.03s
2024-05-03 00:14:05 INFO     epoch complete!
2024-05-03 00:14:05 INFO     evaluating now!
2024-05-03 00:14:06 INFO     Epoch [38/200] train_loss: 4.1052, val_loss: 5.1350, lr: 0.003000, 6.97s
2024-05-03 00:14:06 INFO     Saved model at 38
2024-05-03 00:14:06 INFO     Val loss decrease from 5.1482 to 5.1350, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-05-03 00:14:12 INFO     epoch complete!
2024-05-03 00:14:12 INFO     evaluating now!
2024-05-03 00:14:13 INFO     Epoch [39/200] train_loss: 4.1155, val_loss: 5.1628, lr: 0.003000, 6.91s
2024-05-03 00:14:19 INFO     epoch complete!
2024-05-03 00:14:19 INFO     evaluating now!
2024-05-03 00:14:20 INFO     Epoch [40/200] train_loss: 4.0193, val_loss: 5.1584, lr: 0.003000, 7.00s
2024-05-03 00:14:26 INFO     epoch complete!
2024-05-03 00:14:26 INFO     evaluating now!
2024-05-03 00:14:27 INFO     Epoch [41/200] train_loss: 3.9902, val_loss: 5.1699, lr: 0.003000, 6.94s
2024-05-03 00:14:33 INFO     epoch complete!
2024-05-03 00:14:33 INFO     evaluating now!
2024-05-03 00:14:34 INFO     Epoch [42/200] train_loss: 4.0010, val_loss: 5.2113, lr: 0.003000, 6.85s
2024-05-03 00:14:40 INFO     epoch complete!
2024-05-03 00:14:40 INFO     evaluating now!
2024-05-03 00:14:41 INFO     Epoch [43/200] train_loss: 3.9674, val_loss: 5.1568, lr: 0.003000, 6.98s
2024-05-03 00:14:47 INFO     epoch complete!
2024-05-03 00:14:47 INFO     evaluating now!
2024-05-03 00:14:47 INFO     Epoch [44/200] train_loss: 3.9394, val_loss: 5.1694, lr: 0.003000, 6.78s
2024-05-03 00:14:54 INFO     epoch complete!
2024-05-03 00:14:54 INFO     evaluating now!
2024-05-03 00:14:54 INFO     Epoch [45/200] train_loss: 3.8708, val_loss: 5.1252, lr: 0.003000, 6.92s
2024-05-03 00:14:54 INFO     Saved model at 45
2024-05-03 00:14:54 INFO     Val loss decrease from 5.1350 to 5.1252, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-05-03 00:15:01 INFO     epoch complete!
2024-05-03 00:15:01 INFO     evaluating now!
2024-05-03 00:15:02 INFO     Epoch [46/200] train_loss: 3.8901, val_loss: 5.0769, lr: 0.003000, 7.14s
2024-05-03 00:15:02 INFO     Saved model at 46
2024-05-03 00:15:02 INFO     Val loss decrease from 5.1252 to 5.0769, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-05-03 00:15:08 INFO     epoch complete!
2024-05-03 00:15:08 INFO     evaluating now!
2024-05-03 00:15:09 INFO     Epoch [47/200] train_loss: 3.8554, val_loss: 5.1107, lr: 0.003000, 6.98s
2024-05-03 00:15:15 INFO     epoch complete!
2024-05-03 00:15:15 INFO     evaluating now!
2024-05-03 00:15:16 INFO     Epoch [48/200] train_loss: 3.8637, val_loss: 5.2661, lr: 0.003000, 7.16s
2024-05-03 00:15:22 INFO     epoch complete!
2024-05-03 00:15:22 INFO     evaluating now!
2024-05-03 00:15:23 INFO     Epoch [49/200] train_loss: 3.8878, val_loss: 5.1860, lr: 0.003000, 7.03s
2024-05-03 00:15:29 INFO     epoch complete!
2024-05-03 00:15:29 INFO     evaluating now!
2024-05-03 00:15:30 INFO     Epoch [50/200] train_loss: 3.8214, val_loss: 5.2697, lr: 0.003000, 6.95s
2024-05-03 00:15:36 INFO     epoch complete!
2024-05-03 00:15:36 INFO     evaluating now!
2024-05-03 00:15:37 INFO     Epoch [51/200] train_loss: 3.7881, val_loss: 5.0832, lr: 0.003000, 6.99s
2024-05-03 00:15:43 INFO     epoch complete!
2024-05-03 00:15:43 INFO     evaluating now!
2024-05-03 00:15:44 INFO     Epoch [52/200] train_loss: 3.8356, val_loss: 5.0411, lr: 0.003000, 7.09s
2024-05-03 00:15:44 INFO     Saved model at 52
2024-05-03 00:15:44 INFO     Val loss decrease from 5.0769 to 5.0411, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch52.tar
2024-05-03 00:15:50 INFO     epoch complete!
2024-05-03 00:15:50 INFO     evaluating now!
2024-05-03 00:15:51 INFO     Epoch [53/200] train_loss: 3.7331, val_loss: 5.3041, lr: 0.003000, 6.97s
2024-05-03 00:15:57 INFO     epoch complete!
2024-05-03 00:15:57 INFO     evaluating now!
2024-05-03 00:15:58 INFO     Epoch [54/200] train_loss: 3.7398, val_loss: 5.2213, lr: 0.003000, 7.00s
2024-05-03 00:16:04 INFO     epoch complete!
2024-05-03 00:16:04 INFO     evaluating now!
2024-05-03 00:16:04 INFO     Epoch [55/200] train_loss: 3.7129, val_loss: 5.1777, lr: 0.003000, 6.62s
2024-05-03 00:16:11 INFO     epoch complete!
2024-05-03 00:16:11 INFO     evaluating now!
2024-05-03 00:16:11 INFO     Epoch [56/200] train_loss: 3.6528, val_loss: 5.0030, lr: 0.003000, 6.59s
2024-05-03 00:16:11 INFO     Saved model at 56
2024-05-03 00:16:11 INFO     Val loss decrease from 5.0411 to 5.0030, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch56.tar
2024-05-03 00:16:17 INFO     epoch complete!
2024-05-03 00:16:17 INFO     evaluating now!
2024-05-03 00:16:18 INFO     Epoch [57/200] train_loss: 3.6861, val_loss: 5.1382, lr: 0.003000, 6.73s
2024-05-03 00:16:24 INFO     epoch complete!
2024-05-03 00:16:24 INFO     evaluating now!
2024-05-03 00:16:24 INFO     Epoch [58/200] train_loss: 3.6763, val_loss: 4.9418, lr: 0.003000, 6.49s
2024-05-03 00:16:24 INFO     Saved model at 58
2024-05-03 00:16:24 INFO     Val loss decrease from 5.0030 to 4.9418, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch58.tar
2024-05-03 00:16:30 INFO     epoch complete!
2024-05-03 00:16:30 INFO     evaluating now!
2024-05-03 00:16:31 INFO     Epoch [59/200] train_loss: 3.6366, val_loss: 5.1027, lr: 0.003000, 6.39s
2024-05-03 00:16:37 INFO     epoch complete!
2024-05-03 00:16:37 INFO     evaluating now!
2024-05-03 00:16:37 INFO     Epoch [60/200] train_loss: 3.6390, val_loss: 5.0366, lr: 0.003000, 6.55s
2024-05-03 00:16:44 INFO     epoch complete!
2024-05-03 00:16:44 INFO     evaluating now!
2024-05-03 00:16:44 INFO     Epoch [61/200] train_loss: 3.6470, val_loss: 5.0955, lr: 0.003000, 7.15s
2024-05-03 00:16:51 INFO     epoch complete!
2024-05-03 00:16:51 INFO     evaluating now!
2024-05-03 00:16:51 INFO     Epoch [62/200] train_loss: 3.5952, val_loss: 5.2397, lr: 0.003000, 7.01s
2024-05-03 00:16:58 INFO     epoch complete!
2024-05-03 00:16:58 INFO     evaluating now!
2024-05-03 00:16:58 INFO     Epoch [63/200] train_loss: 3.5796, val_loss: 4.9718, lr: 0.003000, 6.94s
2024-05-03 00:17:05 INFO     epoch complete!
2024-05-03 00:17:05 INFO     evaluating now!
2024-05-03 00:17:06 INFO     Epoch [64/200] train_loss: 3.5751, val_loss: 5.0905, lr: 0.003000, 7.28s
2024-05-03 00:17:12 INFO     epoch complete!
2024-05-03 00:17:12 INFO     evaluating now!
2024-05-03 00:17:13 INFO     Epoch [65/200] train_loss: 3.5352, val_loss: 5.1238, lr: 0.003000, 7.30s
2024-05-03 00:17:20 INFO     epoch complete!
2024-05-03 00:17:20 INFO     evaluating now!
2024-05-03 00:17:20 INFO     Epoch [66/200] train_loss: 3.5240, val_loss: 5.0302, lr: 0.003000, 7.17s
2024-05-03 00:17:27 INFO     epoch complete!
2024-05-03 00:17:27 INFO     evaluating now!
2024-05-03 00:17:27 INFO     Epoch [67/200] train_loss: 3.5962, val_loss: 5.1617, lr: 0.003000, 7.11s
2024-05-03 00:17:34 INFO     epoch complete!
2024-05-03 00:17:34 INFO     evaluating now!
2024-05-03 00:17:34 INFO     Epoch [68/200] train_loss: 3.5436, val_loss: 4.9830, lr: 0.003000, 7.18s
2024-05-03 00:17:41 INFO     epoch complete!
2024-05-03 00:17:41 INFO     evaluating now!
2024-05-03 00:17:42 INFO     Epoch [69/200] train_loss: 3.5568, val_loss: 5.1062, lr: 0.003000, 7.19s
2024-05-03 00:17:48 INFO     epoch complete!
2024-05-03 00:17:48 INFO     evaluating now!
2024-05-03 00:17:49 INFO     Epoch [70/200] train_loss: 3.5702, val_loss: 5.0823, lr: 0.003000, 7.20s
2024-05-03 00:17:55 INFO     epoch complete!
2024-05-03 00:17:55 INFO     evaluating now!
2024-05-03 00:17:56 INFO     Epoch [71/200] train_loss: 3.5163, val_loss: 5.1763, lr: 0.003000, 7.11s
2024-05-03 00:18:01 INFO     epoch complete!
2024-05-03 00:18:01 INFO     evaluating now!
2024-05-03 00:18:02 INFO     Epoch [72/200] train_loss: 3.5565, val_loss: 5.1484, lr: 0.003000, 5.88s
2024-05-03 00:18:08 INFO     epoch complete!
2024-05-03 00:18:08 INFO     evaluating now!
2024-05-03 00:18:09 INFO     Epoch [73/200] train_loss: 3.5478, val_loss: 5.0781, lr: 0.003000, 6.76s
2024-05-03 00:18:09 WARNING  Early stopping at epoch: 73
2024-05-03 00:18:09 INFO     Trained totally 74 epochs, average train time is 6.470s, average eval time is 0.490s
2024-05-03 00:18:09 INFO     Loaded model at 58
2024-05-03 00:18:09 INFO     Saved model at ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406.m
2024-05-03 00:18:09 INFO     Start evaluating ...
2024-05-03 00:18:10 INFO     Note that you select the single mode to evaluate!
2024-05-03 00:18:10 INFO     Evaluate result is saved at ./libcity/cache/35/evaluate_cache/2024_05_03_00_18_10_AGCRN_CHITaxi20190406.csv
2024-05-03 00:18:10 INFO     
         MAE       RMSE
1   2.323218   7.280078
2   2.379680   7.605283
3   2.558952   8.457350
4   2.689910   9.152632
5   2.902161  10.142162
6   2.938138  11.108839
7   3.072817  12.030386
8   3.149680  12.586397
9   3.187304  12.843879
10  3.210282  12.846804
11  3.315550  13.083466
12  3.506942  13.582775
2024-05-03 00:18:11 INFO     ----------------------------------------------------------------------------
2024-05-03 00:18:11 INFO     # 1, Kownledge Graph Embedding: RefE, Experiment ids: 36
2024-05-03 00:18:11 INFO     ----------------------------------------------------------------------------
2024-05-03 00:18:11 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=35
2024-05-03 00:18:11 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 35, 'load_external': True, 'embedding_model': 'RefE', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-03 00:18:11 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-03 00:18:11 INFO     set_weight_link_or_dist: dist
2024-05-03 00:18:11 INFO     init_weight_inf_or_zero: inf
2024-05-03 00:18:11 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-03 00:18:11 INFO     Start Calculate the weight by Gauss kernel!
2024-05-03 00:18:11 INFO     Loading file CHITaxi20190406.dyna
2024-05-03 00:18:11 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-03 00:18:14 INFO     Dataset created
2024-05-03 00:18:14 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-03 00:18:14 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-03 00:18:14 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-03 00:18:14 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-03 00:18:14 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-03 00:18:14 INFO     NormalScaler max: 1.6586810199691633
2024-05-03 00:18:17 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-03 00:18:17 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-03 00:18:17 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-03 00:18:17 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-03 00:18:17 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-03 00:18:17 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-03 00:18:17 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-03 00:18:17 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-03 00:18:17 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-03 00:18:17 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-03 00:18:17 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-03 00:18:17 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-03 00:18:17 INFO     Total parameter numbers: 874010
2024-05-03 00:18:17 INFO     You select `adam` optimizer.
2024-05-03 00:18:17 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-03 00:18:17 INFO     Start training ...
2024-05-03 00:18:17 INFO     num_batches:48
2024-05-03 00:18:24 INFO     epoch complete!
2024-05-03 00:18:24 INFO     evaluating now!
2024-05-03 00:18:24 INFO     Epoch [0/200] train_loss: 23.1564, val_loss: 18.1325, lr: 0.003000, 6.70s
2024-05-03 00:18:24 INFO     Saved model at 0
2024-05-03 00:18:24 INFO     Val loss decrease from inf to 18.1325, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-03 00:18:31 INFO     epoch complete!
2024-05-03 00:18:31 INFO     evaluating now!
2024-05-03 00:18:31 INFO     Epoch [1/200] train_loss: 14.8213, val_loss: 14.2055, lr: 0.003000, 6.85s
2024-05-03 00:18:31 INFO     Saved model at 1
2024-05-03 00:18:31 INFO     Val loss decrease from 18.1325 to 14.2055, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-03 00:18:37 INFO     epoch complete!
2024-05-03 00:18:37 INFO     evaluating now!
2024-05-03 00:18:38 INFO     Epoch [2/200] train_loss: 11.6986, val_loss: 10.7145, lr: 0.003000, 6.54s
2024-05-03 00:18:38 INFO     Saved model at 2
2024-05-03 00:18:38 INFO     Val loss decrease from 14.2055 to 10.7145, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-03 00:18:43 INFO     epoch complete!
2024-05-03 00:18:43 INFO     evaluating now!
2024-05-03 00:18:43 INFO     Epoch [3/200] train_loss: 9.3904, val_loss: 9.5342, lr: 0.003000, 5.57s
2024-05-03 00:18:46 INFO     Saved model at 3
2024-05-03 00:18:46 INFO     Val loss decrease from 10.7145 to 9.5342, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-03 00:18:53 INFO     epoch complete!
2024-05-03 00:18:53 INFO     evaluating now!
2024-05-03 00:18:53 INFO     Epoch [4/200] train_loss: 8.2650, val_loss: 7.5801, lr: 0.003000, 7.30s
2024-05-03 00:18:54 INFO     Saved model at 4
2024-05-03 00:18:54 INFO     Val loss decrease from 9.5342 to 7.5801, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-03 00:19:00 INFO     epoch complete!
2024-05-03 00:19:00 INFO     evaluating now!
2024-05-03 00:19:01 INFO     Epoch [5/200] train_loss: 7.4069, val_loss: 6.9349, lr: 0.003000, 7.30s
2024-05-03 00:19:01 INFO     Saved model at 5
2024-05-03 00:19:01 INFO     Val loss decrease from 7.5801 to 6.9349, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-03 00:19:08 INFO     epoch complete!
2024-05-03 00:19:08 INFO     evaluating now!
2024-05-03 00:19:08 INFO     Epoch [6/200] train_loss: 6.9203, val_loss: 6.7144, lr: 0.003000, 7.35s
2024-05-03 00:19:08 INFO     Saved model at 6
2024-05-03 00:19:08 INFO     Val loss decrease from 6.9349 to 6.7144, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-03 00:19:15 INFO     epoch complete!
2024-05-03 00:19:15 INFO     evaluating now!
2024-05-03 00:19:16 INFO     Epoch [7/200] train_loss: 6.5003, val_loss: 6.4392, lr: 0.003000, 7.51s
2024-05-03 00:19:16 INFO     Saved model at 7
2024-05-03 00:19:16 INFO     Val loss decrease from 6.7144 to 6.4392, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-03 00:19:23 INFO     epoch complete!
2024-05-03 00:19:23 INFO     evaluating now!
2024-05-03 00:19:23 INFO     Epoch [8/200] train_loss: 6.2268, val_loss: 6.0650, lr: 0.003000, 7.35s
2024-05-03 00:19:23 INFO     Saved model at 8
2024-05-03 00:19:23 INFO     Val loss decrease from 6.4392 to 6.0650, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-03 00:19:30 INFO     epoch complete!
2024-05-03 00:19:30 INFO     evaluating now!
2024-05-03 00:19:31 INFO     Epoch [9/200] train_loss: 5.9665, val_loss: 6.3224, lr: 0.003000, 7.39s
2024-05-03 00:19:37 INFO     epoch complete!
2024-05-03 00:19:37 INFO     evaluating now!
2024-05-03 00:19:38 INFO     Epoch [10/200] train_loss: 5.9282, val_loss: 6.1712, lr: 0.003000, 7.28s
2024-05-03 00:19:45 INFO     epoch complete!
2024-05-03 00:19:45 INFO     evaluating now!
2024-05-03 00:19:45 INFO     Epoch [11/200] train_loss: 5.7159, val_loss: 5.9279, lr: 0.003000, 7.25s
2024-05-03 00:19:45 INFO     Saved model at 11
2024-05-03 00:19:45 INFO     Val loss decrease from 6.0650 to 5.9279, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-03 00:19:52 INFO     epoch complete!
2024-05-03 00:19:52 INFO     evaluating now!
2024-05-03 00:19:53 INFO     Epoch [12/200] train_loss: 5.5641, val_loss: 5.7519, lr: 0.003000, 7.32s
2024-05-03 00:19:53 INFO     Saved model at 12
2024-05-03 00:19:53 INFO     Val loss decrease from 5.9279 to 5.7519, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-03 00:20:00 INFO     epoch complete!
2024-05-03 00:20:00 INFO     evaluating now!
2024-05-03 00:20:00 INFO     Epoch [13/200] train_loss: 5.3917, val_loss: 5.7183, lr: 0.003000, 7.50s
2024-05-03 00:20:00 INFO     Saved model at 13
2024-05-03 00:20:00 INFO     Val loss decrease from 5.7519 to 5.7183, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-03 00:20:07 INFO     epoch complete!
2024-05-03 00:20:07 INFO     evaluating now!
2024-05-03 00:20:08 INFO     Epoch [14/200] train_loss: 5.4081, val_loss: 5.4568, lr: 0.003000, 7.41s
2024-05-03 00:20:08 INFO     Saved model at 14
2024-05-03 00:20:08 INFO     Val loss decrease from 5.7183 to 5.4568, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-03 00:20:15 INFO     epoch complete!
2024-05-03 00:20:15 INFO     evaluating now!
2024-05-03 00:20:15 INFO     Epoch [15/200] train_loss: 5.2277, val_loss: 5.7778, lr: 0.003000, 7.34s
2024-05-03 00:20:22 INFO     epoch complete!
2024-05-03 00:20:22 INFO     evaluating now!
2024-05-03 00:20:23 INFO     Epoch [16/200] train_loss: 5.1568, val_loss: 5.4600, lr: 0.003000, 7.41s
2024-05-03 00:20:29 INFO     epoch complete!
2024-05-03 00:20:29 INFO     evaluating now!
2024-05-03 00:20:30 INFO     Epoch [17/200] train_loss: 5.0497, val_loss: 5.3177, lr: 0.003000, 7.33s
2024-05-03 00:20:30 INFO     Saved model at 17
2024-05-03 00:20:30 INFO     Val loss decrease from 5.4568 to 5.3177, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-03 00:20:37 INFO     epoch complete!
2024-05-03 00:20:37 INFO     evaluating now!
2024-05-03 00:20:37 INFO     Epoch [18/200] train_loss: 5.0058, val_loss: 5.3615, lr: 0.003000, 7.31s
2024-05-03 00:20:44 INFO     epoch complete!
2024-05-03 00:20:44 INFO     evaluating now!
2024-05-03 00:20:44 INFO     Epoch [19/200] train_loss: 4.8808, val_loss: 5.2860, lr: 0.003000, 7.22s
2024-05-03 00:20:44 INFO     Saved model at 19
2024-05-03 00:20:44 INFO     Val loss decrease from 5.3177 to 5.2860, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-03 00:20:51 INFO     epoch complete!
2024-05-03 00:20:51 INFO     evaluating now!
2024-05-03 00:20:52 INFO     Epoch [20/200] train_loss: 4.8294, val_loss: 5.2187, lr: 0.003000, 7.30s
2024-05-03 00:20:52 INFO     Saved model at 20
2024-05-03 00:20:52 INFO     Val loss decrease from 5.2860 to 5.2187, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-03 00:20:59 INFO     epoch complete!
2024-05-03 00:20:59 INFO     evaluating now!
2024-05-03 00:20:59 INFO     Epoch [21/200] train_loss: 4.8084, val_loss: 5.2270, lr: 0.003000, 7.51s
2024-05-03 00:21:06 INFO     epoch complete!
2024-05-03 00:21:06 INFO     evaluating now!
2024-05-03 00:21:07 INFO     Epoch [22/200] train_loss: 4.6871, val_loss: 5.2503, lr: 0.003000, 7.36s
2024-05-03 00:21:14 INFO     epoch complete!
2024-05-03 00:21:14 INFO     evaluating now!
2024-05-03 00:21:14 INFO     Epoch [23/200] train_loss: 4.6443, val_loss: 5.2324, lr: 0.003000, 7.40s
2024-05-03 00:21:21 INFO     epoch complete!
2024-05-03 00:21:21 INFO     evaluating now!
2024-05-03 00:21:21 INFO     Epoch [24/200] train_loss: 4.6149, val_loss: 4.9915, lr: 0.003000, 7.34s
2024-05-03 00:21:21 INFO     Saved model at 24
2024-05-03 00:21:21 INFO     Val loss decrease from 5.2187 to 4.9915, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-03 00:21:28 INFO     epoch complete!
2024-05-03 00:21:28 INFO     evaluating now!
2024-05-03 00:21:29 INFO     Epoch [25/200] train_loss: 4.5575, val_loss: 5.2066, lr: 0.003000, 7.38s
2024-05-03 00:21:35 INFO     epoch complete!
2024-05-03 00:21:35 INFO     evaluating now!
2024-05-03 00:21:36 INFO     Epoch [26/200] train_loss: 4.4815, val_loss: 5.2109, lr: 0.003000, 7.05s
2024-05-03 00:21:42 INFO     epoch complete!
2024-05-03 00:21:42 INFO     evaluating now!
2024-05-03 00:21:43 INFO     Epoch [27/200] train_loss: 4.4406, val_loss: 5.1782, lr: 0.003000, 6.87s
2024-05-03 00:21:49 INFO     epoch complete!
2024-05-03 00:21:49 INFO     evaluating now!
2024-05-03 00:21:50 INFO     Epoch [28/200] train_loss: 4.4470, val_loss: 5.0290, lr: 0.003000, 6.91s
2024-05-03 00:21:56 INFO     epoch complete!
2024-05-03 00:21:56 INFO     evaluating now!
2024-05-03 00:21:57 INFO     Epoch [29/200] train_loss: 4.3490, val_loss: 5.0732, lr: 0.003000, 6.94s
2024-05-03 00:22:03 INFO     epoch complete!
2024-05-03 00:22:03 INFO     evaluating now!
2024-05-03 00:22:04 INFO     Epoch [30/200] train_loss: 4.3275, val_loss: 5.2723, lr: 0.003000, 6.91s
2024-05-03 00:22:10 INFO     epoch complete!
2024-05-03 00:22:10 INFO     evaluating now!
2024-05-03 00:22:11 INFO     Epoch [31/200] train_loss: 4.2730, val_loss: 5.2521, lr: 0.003000, 7.00s
2024-05-03 00:22:17 INFO     epoch complete!
2024-05-03 00:22:17 INFO     evaluating now!
2024-05-03 00:22:17 INFO     Epoch [32/200] train_loss: 4.2376, val_loss: 5.0271, lr: 0.003000, 6.91s
2024-05-03 00:22:25 INFO     epoch complete!
2024-05-03 00:22:25 INFO     evaluating now!
2024-05-03 00:22:25 INFO     Epoch [33/200] train_loss: 4.2027, val_loss: 5.3121, lr: 0.003000, 7.64s
2024-05-03 00:22:32 INFO     epoch complete!
2024-05-03 00:22:32 INFO     evaluating now!
2024-05-03 00:22:32 INFO     Epoch [34/200] train_loss: 4.1844, val_loss: 5.1663, lr: 0.003000, 7.35s
2024-05-03 00:22:39 INFO     epoch complete!
2024-05-03 00:22:39 INFO     evaluating now!
2024-05-03 00:22:40 INFO     Epoch [35/200] train_loss: 4.1969, val_loss: 5.0264, lr: 0.003000, 7.37s
2024-05-03 00:22:47 INFO     epoch complete!
2024-05-03 00:22:47 INFO     evaluating now!
2024-05-03 00:22:47 INFO     Epoch [36/200] train_loss: 4.1536, val_loss: 5.0947, lr: 0.003000, 7.30s
2024-05-03 00:22:54 INFO     epoch complete!
2024-05-03 00:22:54 INFO     evaluating now!
2024-05-03 00:22:55 INFO     Epoch [37/200] train_loss: 4.1321, val_loss: 4.9641, lr: 0.003000, 7.58s
2024-05-03 00:22:55 INFO     Saved model at 37
2024-05-03 00:22:55 INFO     Val loss decrease from 4.9915 to 4.9641, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-05-03 00:23:02 INFO     epoch complete!
2024-05-03 00:23:02 INFO     evaluating now!
2024-05-03 00:23:02 INFO     Epoch [38/200] train_loss: 4.0904, val_loss: 5.0298, lr: 0.003000, 7.64s
2024-05-03 00:23:09 INFO     epoch complete!
2024-05-03 00:23:09 INFO     evaluating now!
2024-05-03 00:23:10 INFO     Epoch [39/200] train_loss: 4.0355, val_loss: 5.0534, lr: 0.003000, 7.46s
2024-05-03 00:23:16 INFO     epoch complete!
2024-05-03 00:23:16 INFO     evaluating now!
2024-05-03 00:23:17 INFO     Epoch [40/200] train_loss: 4.0165, val_loss: 5.0676, lr: 0.003000, 7.13s
2024-05-03 00:23:24 INFO     epoch complete!
2024-05-03 00:23:24 INFO     evaluating now!
2024-05-03 00:23:24 INFO     Epoch [41/200] train_loss: 4.0422, val_loss: 5.2123, lr: 0.003000, 7.16s
2024-05-03 00:23:31 INFO     epoch complete!
2024-05-03 00:23:31 INFO     evaluating now!
2024-05-03 00:23:31 INFO     Epoch [42/200] train_loss: 3.9466, val_loss: 5.1310, lr: 0.003000, 7.13s
2024-05-03 00:23:38 INFO     epoch complete!
2024-05-03 00:23:38 INFO     evaluating now!
2024-05-03 00:23:39 INFO     Epoch [43/200] train_loss: 3.9227, val_loss: 5.0049, lr: 0.003000, 7.26s
2024-05-03 00:23:45 INFO     epoch complete!
2024-05-03 00:23:45 INFO     evaluating now!
2024-05-03 00:23:46 INFO     Epoch [44/200] train_loss: 3.8629, val_loss: 5.0085, lr: 0.003000, 7.06s
2024-05-03 00:23:52 INFO     epoch complete!
2024-05-03 00:23:52 INFO     evaluating now!
2024-05-03 00:23:52 INFO     Epoch [45/200] train_loss: 3.8569, val_loss: 5.0038, lr: 0.003000, 6.90s
2024-05-03 00:23:59 INFO     epoch complete!
2024-05-03 00:23:59 INFO     evaluating now!
2024-05-03 00:24:00 INFO     Epoch [46/200] train_loss: 3.8576, val_loss: 5.0121, lr: 0.003000, 7.10s
2024-05-03 00:24:06 INFO     epoch complete!
2024-05-03 00:24:06 INFO     evaluating now!
2024-05-03 00:24:06 INFO     Epoch [47/200] train_loss: 3.8661, val_loss: 5.1475, lr: 0.003000, 6.88s
2024-05-03 00:24:13 INFO     epoch complete!
2024-05-03 00:24:13 INFO     evaluating now!
2024-05-03 00:24:13 INFO     Epoch [48/200] train_loss: 3.8345, val_loss: 5.0364, lr: 0.003000, 6.96s
2024-05-03 00:24:20 INFO     epoch complete!
2024-05-03 00:24:20 INFO     evaluating now!
2024-05-03 00:24:20 INFO     Epoch [49/200] train_loss: 3.8058, val_loss: 4.9885, lr: 0.003000, 6.61s
2024-05-03 00:24:26 INFO     epoch complete!
2024-05-03 00:24:26 INFO     evaluating now!
2024-05-03 00:24:27 INFO     Epoch [50/200] train_loss: 3.7813, val_loss: 5.0249, lr: 0.003000, 6.91s
2024-05-03 00:24:33 INFO     epoch complete!
2024-05-03 00:24:33 INFO     evaluating now!
2024-05-03 00:24:34 INFO     Epoch [51/200] train_loss: 3.7140, val_loss: 4.9548, lr: 0.003000, 6.96s
2024-05-03 00:24:41 INFO     Saved model at 51
2024-05-03 00:24:41 INFO     Val loss decrease from 4.9641 to 4.9548, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-05-03 00:24:48 INFO     epoch complete!
2024-05-03 00:24:48 INFO     evaluating now!
2024-05-03 00:24:48 INFO     Epoch [52/200] train_loss: 3.7017, val_loss: 4.8809, lr: 0.003000, 6.81s
2024-05-03 00:24:48 INFO     Saved model at 52
2024-05-03 00:24:48 INFO     Val loss decrease from 4.9548 to 4.8809, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch52.tar
2024-05-03 00:24:54 INFO     epoch complete!
2024-05-03 00:24:54 INFO     evaluating now!
2024-05-03 00:24:55 INFO     Epoch [53/200] train_loss: 3.6638, val_loss: 5.0857, lr: 0.003000, 6.60s
2024-05-03 00:25:02 INFO     epoch complete!
2024-05-03 00:25:02 INFO     evaluating now!
2024-05-03 00:25:02 INFO     Epoch [54/200] train_loss: 3.6981, val_loss: 4.9579, lr: 0.003000, 7.23s
2024-05-03 00:25:08 INFO     epoch complete!
2024-05-03 00:25:08 INFO     evaluating now!
2024-05-03 00:25:09 INFO     Epoch [55/200] train_loss: 3.6725, val_loss: 4.8445, lr: 0.003000, 6.65s
2024-05-03 00:25:09 INFO     Saved model at 55
2024-05-03 00:25:09 INFO     Val loss decrease from 4.8809 to 4.8445, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch55.tar
2024-05-03 00:25:15 INFO     epoch complete!
2024-05-03 00:25:15 INFO     evaluating now!
2024-05-03 00:25:15 INFO     Epoch [56/200] train_loss: 3.6639, val_loss: 5.0771, lr: 0.003000, 6.66s
2024-05-03 00:25:22 INFO     epoch complete!
2024-05-03 00:25:22 INFO     evaluating now!
2024-05-03 00:25:22 INFO     Epoch [57/200] train_loss: 3.6117, val_loss: 4.8798, lr: 0.003000, 6.85s
2024-05-03 00:25:29 INFO     epoch complete!
2024-05-03 00:25:29 INFO     evaluating now!
2024-05-03 00:25:29 INFO     Epoch [58/200] train_loss: 3.6325, val_loss: 4.9923, lr: 0.003000, 6.81s
2024-05-03 00:25:35 INFO     epoch complete!
2024-05-03 00:25:35 INFO     evaluating now!
2024-05-03 00:25:36 INFO     Epoch [59/200] train_loss: 3.5927, val_loss: 5.1172, lr: 0.003000, 6.62s
2024-05-03 00:25:42 INFO     epoch complete!
2024-05-03 00:25:42 INFO     evaluating now!
2024-05-03 00:25:42 INFO     Epoch [60/200] train_loss: 3.5812, val_loss: 5.0075, lr: 0.003000, 6.74s
2024-05-03 00:25:49 INFO     epoch complete!
2024-05-03 00:25:49 INFO     evaluating now!
2024-05-03 00:25:49 INFO     Epoch [61/200] train_loss: 3.5449, val_loss: 4.9977, lr: 0.003000, 6.69s
2024-05-03 00:25:55 INFO     epoch complete!
2024-05-03 00:25:55 INFO     evaluating now!
2024-05-03 00:25:56 INFO     Epoch [62/200] train_loss: 3.5405, val_loss: 5.0238, lr: 0.003000, 6.77s
2024-05-03 00:26:02 INFO     epoch complete!
2024-05-03 00:26:02 INFO     evaluating now!
2024-05-03 00:26:03 INFO     Epoch [63/200] train_loss: 3.5429, val_loss: 5.1166, lr: 0.003000, 6.70s
2024-05-03 00:26:09 INFO     epoch complete!
2024-05-03 00:26:09 INFO     evaluating now!
2024-05-03 00:26:09 INFO     Epoch [64/200] train_loss: 3.5057, val_loss: 5.0204, lr: 0.003000, 6.71s
2024-05-03 00:26:15 INFO     epoch complete!
2024-05-03 00:26:15 INFO     evaluating now!
2024-05-03 00:26:16 INFO     Epoch [65/200] train_loss: 3.4843, val_loss: 4.9433, lr: 0.003000, 6.64s
2024-05-03 00:26:22 INFO     epoch complete!
2024-05-03 00:26:22 INFO     evaluating now!
2024-05-03 00:26:23 INFO     Epoch [66/200] train_loss: 3.4569, val_loss: 5.0219, lr: 0.003000, 6.81s
2024-05-03 00:26:29 INFO     epoch complete!
2024-05-03 00:26:29 INFO     evaluating now!
2024-05-03 00:26:30 INFO     Epoch [67/200] train_loss: 3.4243, val_loss: 4.9777, lr: 0.003000, 7.00s
2024-05-03 00:26:36 INFO     epoch complete!
2024-05-03 00:26:36 INFO     evaluating now!
2024-05-03 00:26:36 INFO     Epoch [68/200] train_loss: 3.5011, val_loss: 5.1782, lr: 0.003000, 6.60s
2024-05-03 00:26:43 INFO     epoch complete!
2024-05-03 00:26:43 INFO     evaluating now!
2024-05-03 00:26:43 INFO     Epoch [69/200] train_loss: 3.4398, val_loss: 4.9658, lr: 0.003000, 6.61s
2024-05-03 00:26:49 INFO     epoch complete!
2024-05-03 00:26:49 INFO     evaluating now!
2024-05-03 00:26:50 INFO     Epoch [70/200] train_loss: 3.4688, val_loss: 4.9846, lr: 0.003000, 6.57s
2024-05-03 00:26:50 WARNING  Early stopping at epoch: 70
2024-05-03 00:26:50 INFO     Trained totally 71 epochs, average train time is 6.570s, average eval time is 0.479s
2024-05-03 00:26:50 INFO     Loaded model at 55
2024-05-03 00:26:50 INFO     Saved model at ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406.m
2024-05-03 00:26:50 INFO     Start evaluating ...
2024-05-03 00:26:51 INFO     Note that you select the single mode to evaluate!
2024-05-03 00:26:51 INFO     Evaluate result is saved at ./libcity/cache/35/evaluate_cache/2024_05_03_00_26_51_AGCRN_CHITaxi20190406.csv
2024-05-03 00:26:51 INFO     
         MAE       RMSE
1   2.284670   7.203277
2   2.415760   8.001167
3   2.604419   8.959782
4   2.746938   9.658427
5   2.903920  10.488046
6   2.990607  11.391126
7   3.088877  12.205421
8   3.197997  12.807639
9   3.215676  13.082860
10  3.245113  13.337428
11  3.285755  13.324848
12  3.438327  13.845094
2024-05-03 00:26:51 INFO     ----------------------------------------------------------------------------
2024-05-03 00:26:51 INFO     # 2, Kownledge Graph Embedding: RefE, Experiment ids: 37
2024-05-03 00:26:51 INFO     ----------------------------------------------------------------------------
2024-05-03 00:26:51 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=35
2024-05-03 00:26:51 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 35, 'load_external': True, 'embedding_model': 'RefE', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-03 00:26:52 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-03 00:26:52 INFO     set_weight_link_or_dist: dist
2024-05-03 00:26:52 INFO     init_weight_inf_or_zero: inf
2024-05-03 00:26:52 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-03 00:26:52 INFO     Start Calculate the weight by Gauss kernel!
2024-05-03 00:26:52 INFO     Loading file CHITaxi20190406.dyna
2024-05-03 00:26:52 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-03 00:26:55 INFO     Dataset created
2024-05-03 00:26:55 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-03 00:26:55 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-03 00:26:55 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-03 00:26:55 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-03 00:26:55 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-03 00:26:55 INFO     NormalScaler max: 1.6586810199691633
2024-05-03 00:26:58 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-03 00:26:58 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-03 00:26:58 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-03 00:26:58 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-03 00:26:58 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-03 00:26:58 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-03 00:26:58 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-03 00:26:58 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-03 00:26:58 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-03 00:26:58 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-03 00:26:58 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-03 00:26:58 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-03 00:26:58 INFO     Total parameter numbers: 874010
2024-05-03 00:26:58 INFO     You select `adam` optimizer.
2024-05-03 00:26:58 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-03 00:26:58 INFO     Start training ...
2024-05-03 00:26:58 INFO     num_batches:48
2024-05-03 00:27:05 INFO     epoch complete!
2024-05-03 00:27:05 INFO     evaluating now!
2024-05-03 00:27:05 INFO     Epoch [0/200] train_loss: 23.8856, val_loss: 18.0564, lr: 0.003000, 6.91s
2024-05-03 00:27:05 INFO     Saved model at 0
2024-05-03 00:27:05 INFO     Val loss decrease from inf to 18.0564, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-03 00:27:12 INFO     epoch complete!
2024-05-03 00:27:12 INFO     evaluating now!
2024-05-03 00:27:12 INFO     Epoch [1/200] train_loss: 14.8817, val_loss: 14.6578, lr: 0.003000, 7.03s
2024-05-03 00:27:12 INFO     Saved model at 1
2024-05-03 00:27:12 INFO     Val loss decrease from 18.0564 to 14.6578, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-03 00:27:19 INFO     epoch complete!
2024-05-03 00:27:19 INFO     evaluating now!
2024-05-03 00:27:20 INFO     Epoch [2/200] train_loss: 12.4428, val_loss: 12.0477, lr: 0.003000, 7.28s
2024-05-03 00:27:20 INFO     Saved model at 2
2024-05-03 00:27:20 INFO     Val loss decrease from 14.6578 to 12.0477, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-03 00:27:26 INFO     epoch complete!
2024-05-03 00:27:26 INFO     evaluating now!
2024-05-03 00:27:27 INFO     Epoch [3/200] train_loss: 10.1570, val_loss: 9.7406, lr: 0.003000, 7.03s
2024-05-03 00:27:27 INFO     Saved model at 3
2024-05-03 00:27:27 INFO     Val loss decrease from 12.0477 to 9.7406, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-03 00:27:33 INFO     epoch complete!
2024-05-03 00:27:33 INFO     evaluating now!
2024-05-03 00:27:34 INFO     Epoch [4/200] train_loss: 8.9215, val_loss: 9.0246, lr: 0.003000, 6.97s
2024-05-03 00:27:34 INFO     Saved model at 4
2024-05-03 00:27:34 INFO     Val loss decrease from 9.7406 to 9.0246, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-03 00:27:40 INFO     epoch complete!
2024-05-03 00:27:40 INFO     evaluating now!
2024-05-03 00:27:41 INFO     Epoch [5/200] train_loss: 8.0827, val_loss: 8.0129, lr: 0.003000, 7.05s
2024-05-03 00:27:41 INFO     Saved model at 5
2024-05-03 00:27:41 INFO     Val loss decrease from 9.0246 to 8.0129, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-03 00:27:48 INFO     epoch complete!
2024-05-03 00:27:48 INFO     evaluating now!
2024-05-03 00:27:48 INFO     Epoch [6/200] train_loss: 7.3701, val_loss: 7.7790, lr: 0.003000, 7.30s
2024-05-03 00:27:48 INFO     Saved model at 6
2024-05-03 00:27:48 INFO     Val loss decrease from 8.0129 to 7.7790, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-03 00:27:55 INFO     epoch complete!
2024-05-03 00:27:55 INFO     evaluating now!
2024-05-03 00:27:55 INFO     Epoch [7/200] train_loss: 6.9410, val_loss: 7.1009, lr: 0.003000, 7.14s
2024-05-03 00:27:55 INFO     Saved model at 7
2024-05-03 00:27:55 INFO     Val loss decrease from 7.7790 to 7.1009, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-03 00:28:02 INFO     epoch complete!
2024-05-03 00:28:02 INFO     evaluating now!
2024-05-03 00:28:02 INFO     Epoch [8/200] train_loss: 6.6643, val_loss: 6.7402, lr: 0.003000, 6.87s
2024-05-03 00:28:02 INFO     Saved model at 8
2024-05-03 00:28:02 INFO     Val loss decrease from 7.1009 to 6.7402, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-03 00:28:09 INFO     epoch complete!
2024-05-03 00:28:09 INFO     evaluating now!
2024-05-03 00:28:10 INFO     Epoch [9/200] train_loss: 6.3329, val_loss: 6.2532, lr: 0.003000, 7.13s
2024-05-03 00:28:10 INFO     Saved model at 9
2024-05-03 00:28:10 INFO     Val loss decrease from 6.7402 to 6.2532, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-03 00:28:16 INFO     epoch complete!
2024-05-03 00:28:16 INFO     evaluating now!
2024-05-03 00:28:17 INFO     Epoch [10/200] train_loss: 6.0703, val_loss: 6.2620, lr: 0.003000, 7.20s
2024-05-03 00:28:23 INFO     epoch complete!
2024-05-03 00:28:23 INFO     evaluating now!
2024-05-03 00:28:24 INFO     Epoch [11/200] train_loss: 5.8639, val_loss: 6.1172, lr: 0.003000, 7.04s
2024-05-03 00:28:30 INFO     Saved model at 11
2024-05-03 00:28:30 INFO     Val loss decrease from 6.2532 to 6.1172, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-03 00:28:36 INFO     epoch complete!
2024-05-03 00:28:36 INFO     evaluating now!
2024-05-03 00:28:37 INFO     Epoch [12/200] train_loss: 5.7382, val_loss: 5.7976, lr: 0.003000, 6.63s
2024-05-03 00:28:37 INFO     Saved model at 12
2024-05-03 00:28:37 INFO     Val loss decrease from 6.1172 to 5.7976, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-03 00:28:43 INFO     epoch complete!
2024-05-03 00:28:43 INFO     evaluating now!
2024-05-03 00:28:43 INFO     Epoch [13/200] train_loss: 5.5973, val_loss: 5.8158, lr: 0.003000, 6.70s
2024-05-03 00:28:50 INFO     epoch complete!
2024-05-03 00:28:50 INFO     evaluating now!
2024-05-03 00:28:50 INFO     Epoch [14/200] train_loss: 5.4341, val_loss: 5.7455, lr: 0.003000, 6.66s
2024-05-03 00:28:50 INFO     Saved model at 14
2024-05-03 00:28:50 INFO     Val loss decrease from 5.7976 to 5.7455, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-03 00:28:56 INFO     epoch complete!
2024-05-03 00:28:56 INFO     evaluating now!
2024-05-03 00:28:57 INFO     Epoch [15/200] train_loss: 5.3858, val_loss: 5.6682, lr: 0.003000, 6.70s
2024-05-03 00:28:57 INFO     Saved model at 15
2024-05-03 00:28:57 INFO     Val loss decrease from 5.7455 to 5.6682, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-03 00:29:03 INFO     epoch complete!
2024-05-03 00:29:03 INFO     evaluating now!
2024-05-03 00:29:04 INFO     Epoch [16/200] train_loss: 5.2687, val_loss: 5.4745, lr: 0.003000, 6.80s
2024-05-03 00:29:04 INFO     Saved model at 16
2024-05-03 00:29:04 INFO     Val loss decrease from 5.6682 to 5.4745, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-03 00:29:10 INFO     epoch complete!
2024-05-03 00:29:10 INFO     evaluating now!
2024-05-03 00:29:10 INFO     Epoch [17/200] train_loss: 5.2182, val_loss: 5.3608, lr: 0.003000, 6.62s
2024-05-03 00:29:10 INFO     Saved model at 17
2024-05-03 00:29:10 INFO     Val loss decrease from 5.4745 to 5.3608, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-03 00:29:17 INFO     epoch complete!
2024-05-03 00:29:17 INFO     evaluating now!
2024-05-03 00:29:17 INFO     Epoch [18/200] train_loss: 5.0512, val_loss: 5.5177, lr: 0.003000, 6.68s
2024-05-03 00:29:23 INFO     epoch complete!
2024-05-03 00:29:23 INFO     evaluating now!
2024-05-03 00:29:24 INFO     Epoch [19/200] train_loss: 4.9698, val_loss: 5.3737, lr: 0.003000, 6.79s
2024-05-03 00:29:30 INFO     epoch complete!
2024-05-03 00:29:30 INFO     evaluating now!
2024-05-03 00:29:31 INFO     Epoch [20/200] train_loss: 4.9393, val_loss: 5.4367, lr: 0.003000, 6.69s
2024-05-03 00:29:37 INFO     epoch complete!
2024-05-03 00:29:37 INFO     evaluating now!
2024-05-03 00:29:37 INFO     Epoch [21/200] train_loss: 4.8879, val_loss: 5.4648, lr: 0.003000, 6.83s
2024-05-03 00:29:44 INFO     epoch complete!
2024-05-03 00:29:44 INFO     evaluating now!
2024-05-03 00:29:44 INFO     Epoch [22/200] train_loss: 4.7526, val_loss: 5.2284, lr: 0.003000, 6.93s
2024-05-03 00:29:44 INFO     Saved model at 22
2024-05-03 00:29:44 INFO     Val loss decrease from 5.3608 to 5.2284, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-03 00:29:51 INFO     epoch complete!
2024-05-03 00:29:51 INFO     evaluating now!
2024-05-03 00:29:51 INFO     Epoch [23/200] train_loss: 4.7276, val_loss: 5.2747, lr: 0.003000, 6.83s
2024-05-03 00:29:58 INFO     epoch complete!
2024-05-03 00:29:58 INFO     evaluating now!
2024-05-03 00:29:58 INFO     Epoch [24/200] train_loss: 4.6752, val_loss: 5.3526, lr: 0.003000, 7.22s
2024-05-03 00:30:05 INFO     epoch complete!
2024-05-03 00:30:05 INFO     evaluating now!
2024-05-03 00:30:05 INFO     Epoch [25/200] train_loss: 4.5832, val_loss: 5.2060, lr: 0.003000, 6.92s
2024-05-03 00:30:05 INFO     Saved model at 25
2024-05-03 00:30:05 INFO     Val loss decrease from 5.2284 to 5.2060, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-03 00:30:12 INFO     epoch complete!
2024-05-03 00:30:12 INFO     evaluating now!
2024-05-03 00:30:13 INFO     Epoch [26/200] train_loss: 4.5810, val_loss: 5.1525, lr: 0.003000, 7.43s
2024-05-03 00:30:23 INFO     Saved model at 26
2024-05-03 00:30:23 INFO     Val loss decrease from 5.2060 to 5.1525, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-05-03 00:30:30 INFO     epoch complete!
2024-05-03 00:30:30 INFO     evaluating now!
2024-05-03 00:30:30 INFO     Epoch [27/200] train_loss: 4.5466, val_loss: 5.0825, lr: 0.003000, 7.05s
2024-05-03 00:30:30 INFO     Saved model at 27
2024-05-03 00:30:30 INFO     Val loss decrease from 5.1525 to 5.0825, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-05-03 00:30:37 INFO     epoch complete!
2024-05-03 00:30:37 INFO     evaluating now!
2024-05-03 00:30:37 INFO     Epoch [28/200] train_loss: 4.4962, val_loss: 5.1877, lr: 0.003000, 7.22s
2024-05-03 00:30:44 INFO     epoch complete!
2024-05-03 00:30:44 INFO     evaluating now!
2024-05-03 00:30:44 INFO     Epoch [29/200] train_loss: 4.4898, val_loss: 5.2309, lr: 0.003000, 7.09s
2024-05-03 00:30:51 INFO     epoch complete!
2024-05-03 00:30:51 INFO     evaluating now!
2024-05-03 00:30:52 INFO     Epoch [30/200] train_loss: 4.4223, val_loss: 5.3458, lr: 0.003000, 7.17s
2024-05-03 00:30:58 INFO     epoch complete!
2024-05-03 00:30:58 INFO     evaluating now!
2024-05-03 00:30:59 INFO     Epoch [31/200] train_loss: 4.3212, val_loss: 5.0971, lr: 0.003000, 7.13s
2024-05-03 00:31:05 INFO     epoch complete!
2024-05-03 00:31:05 INFO     evaluating now!
2024-05-03 00:31:06 INFO     Epoch [32/200] train_loss: 4.3446, val_loss: 4.9994, lr: 0.003000, 7.15s
2024-05-03 00:31:06 INFO     Saved model at 32
2024-05-03 00:31:06 INFO     Val loss decrease from 5.0825 to 4.9994, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-05-03 00:31:13 INFO     epoch complete!
2024-05-03 00:31:13 INFO     evaluating now!
2024-05-03 00:31:13 INFO     Epoch [33/200] train_loss: 4.3189, val_loss: 5.2343, lr: 0.003000, 7.27s
2024-05-03 00:31:20 INFO     epoch complete!
2024-05-03 00:31:20 INFO     evaluating now!
2024-05-03 00:31:20 INFO     Epoch [34/200] train_loss: 4.2767, val_loss: 5.0096, lr: 0.003000, 7.13s
2024-05-03 00:31:27 INFO     epoch complete!
2024-05-03 00:31:27 INFO     evaluating now!
2024-05-03 00:31:28 INFO     Epoch [35/200] train_loss: 4.2001, val_loss: 5.0352, lr: 0.003000, 7.33s
2024-05-03 00:31:34 INFO     epoch complete!
2024-05-03 00:31:34 INFO     evaluating now!
2024-05-03 00:31:35 INFO     Epoch [36/200] train_loss: 4.2216, val_loss: 4.9196, lr: 0.003000, 7.07s
2024-05-03 00:31:35 INFO     Saved model at 36
2024-05-03 00:31:35 INFO     Val loss decrease from 4.9994 to 4.9196, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-05-03 00:31:41 INFO     epoch complete!
2024-05-03 00:31:41 INFO     evaluating now!
2024-05-03 00:31:41 INFO     Epoch [37/200] train_loss: 4.1722, val_loss: 5.1296, lr: 0.003000, 6.72s
2024-05-03 00:31:48 INFO     epoch complete!
2024-05-03 00:31:48 INFO     evaluating now!
2024-05-03 00:31:48 INFO     Epoch [38/200] train_loss: 4.1222, val_loss: 5.0585, lr: 0.003000, 6.75s
2024-05-03 00:31:54 INFO     epoch complete!
2024-05-03 00:31:54 INFO     evaluating now!
2024-05-03 00:31:55 INFO     Epoch [39/200] train_loss: 4.1601, val_loss: 5.1946, lr: 0.003000, 6.58s
2024-05-03 00:32:01 INFO     epoch complete!
2024-05-03 00:32:01 INFO     evaluating now!
2024-05-03 00:32:02 INFO     Epoch [40/200] train_loss: 4.0630, val_loss: 4.9735, lr: 0.003000, 6.87s
2024-05-03 00:32:08 INFO     epoch complete!
2024-05-03 00:32:08 INFO     evaluating now!
2024-05-03 00:32:08 INFO     Epoch [41/200] train_loss: 4.0571, val_loss: 5.1091, lr: 0.003000, 6.63s
2024-05-03 00:32:15 INFO     epoch complete!
2024-05-03 00:32:15 INFO     evaluating now!
2024-05-03 00:32:15 INFO     Epoch [42/200] train_loss: 4.0299, val_loss: 5.2172, lr: 0.003000, 6.66s
2024-05-03 00:32:21 INFO     epoch complete!
2024-05-03 00:32:21 INFO     evaluating now!
2024-05-03 00:32:22 INFO     Epoch [43/200] train_loss: 3.9831, val_loss: 5.0967, lr: 0.003000, 6.88s
2024-05-03 00:32:28 INFO     epoch complete!
2024-05-03 00:32:28 INFO     evaluating now!
2024-05-03 00:32:29 INFO     Epoch [44/200] train_loss: 3.9811, val_loss: 4.9968, lr: 0.003000, 6.90s
2024-05-03 00:32:35 INFO     epoch complete!
2024-05-03 00:32:35 INFO     evaluating now!
2024-05-03 00:32:36 INFO     Epoch [45/200] train_loss: 4.0065, val_loss: 5.0287, lr: 0.003000, 7.00s
2024-05-03 00:32:42 INFO     epoch complete!
2024-05-03 00:32:42 INFO     evaluating now!
2024-05-03 00:32:42 INFO     Epoch [46/200] train_loss: 3.9381, val_loss: 4.9724, lr: 0.003000, 6.39s
2024-05-03 00:32:48 INFO     epoch complete!
2024-05-03 00:32:48 INFO     evaluating now!
2024-05-03 00:32:48 INFO     Epoch [47/200] train_loss: 3.9160, val_loss: 5.0830, lr: 0.003000, 6.33s
2024-05-03 00:32:54 INFO     epoch complete!
2024-05-03 00:32:54 INFO     evaluating now!
2024-05-03 00:32:55 INFO     Epoch [48/200] train_loss: 3.9078, val_loss: 5.0978, lr: 0.003000, 6.33s
2024-05-03 00:33:01 INFO     epoch complete!
2024-05-03 00:33:01 INFO     evaluating now!
2024-05-03 00:33:01 INFO     Epoch [49/200] train_loss: 3.8560, val_loss: 5.0672, lr: 0.003000, 6.38s
2024-05-03 00:33:07 INFO     epoch complete!
2024-05-03 00:33:07 INFO     evaluating now!
2024-05-03 00:33:08 INFO     Epoch [50/200] train_loss: 3.8407, val_loss: 5.0933, lr: 0.003000, 6.38s
2024-05-03 00:33:14 INFO     epoch complete!
2024-05-03 00:33:14 INFO     evaluating now!
2024-05-03 00:33:14 INFO     Epoch [51/200] train_loss: 3.8149, val_loss: 5.0058, lr: 0.003000, 6.35s
2024-05-03 00:33:14 WARNING  Early stopping at epoch: 51
2024-05-03 00:33:14 INFO     Trained totally 52 epochs, average train time is 6.440s, average eval time is 0.446s
2024-05-03 00:33:14 INFO     Loaded model at 36
2024-05-03 00:33:14 INFO     Saved model at ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406.m
2024-05-03 00:33:14 INFO     Start evaluating ...
2024-05-03 00:33:16 INFO     Note that you select the single mode to evaluate!
2024-05-03 00:33:16 INFO     Evaluate result is saved at ./libcity/cache/35/evaluate_cache/2024_05_03_00_33_16_AGCRN_CHITaxi20190406.csv
2024-05-03 00:33:16 INFO     
         MAE       RMSE
1   2.456024   8.123361
2   2.511074   8.418530
3   2.664891   9.282292
4   2.811700   9.962195
5   2.962924  10.667544
6   3.085419  11.170457
7   3.092312  11.584963
8   3.148770  11.773958
9   3.172956  11.900376
10  3.220245  12.051903
11  3.279440  12.254156
12  3.374582  12.769410
2024-05-03 00:33:16 INFO     ----------------------------------------------------------------------------
2024-05-03 00:33:16 INFO     # 3, Kownledge Graph Embedding: RefE, Experiment ids: 38
2024-05-03 00:33:16 INFO     ----------------------------------------------------------------------------
2024-05-03 00:33:16 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=35
2024-05-03 00:33:16 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 35, 'load_external': True, 'embedding_model': 'RefE', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-03 00:33:16 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-03 00:33:16 INFO     set_weight_link_or_dist: dist
2024-05-03 00:33:16 INFO     init_weight_inf_or_zero: inf
2024-05-03 00:33:16 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-03 00:33:16 INFO     Start Calculate the weight by Gauss kernel!
2024-05-03 00:33:16 INFO     Loading file CHITaxi20190406.dyna
2024-05-03 00:33:16 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-03 00:33:19 INFO     Dataset created
2024-05-03 00:33:19 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-03 00:33:19 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-03 00:33:19 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-03 00:33:19 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-03 00:33:19 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-03 00:33:19 INFO     NormalScaler max: 1.6586810199691633
2024-05-03 00:33:23 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-03 00:33:23 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-03 00:33:23 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-03 00:33:23 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-03 00:33:23 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-03 00:33:23 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-03 00:33:23 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-03 00:33:23 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-03 00:33:23 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-03 00:33:23 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-03 00:33:23 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-03 00:33:23 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-03 00:33:23 INFO     Total parameter numbers: 874010
2024-05-03 00:33:23 INFO     You select `adam` optimizer.
2024-05-03 00:33:23 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-03 00:33:23 INFO     Start training ...
2024-05-03 00:33:23 INFO     num_batches:48
2024-05-03 00:33:29 INFO     epoch complete!
2024-05-03 00:33:29 INFO     evaluating now!
2024-05-03 00:33:30 INFO     Epoch [0/200] train_loss: 25.6561, val_loss: 18.5012, lr: 0.003000, 6.91s
2024-05-03 00:33:30 INFO     Saved model at 0
2024-05-03 00:33:30 INFO     Val loss decrease from inf to 18.5012, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-03 00:33:36 INFO     epoch complete!
2024-05-03 00:33:36 INFO     evaluating now!
2024-05-03 00:33:36 INFO     Epoch [1/200] train_loss: 15.4164, val_loss: 15.0275, lr: 0.003000, 6.65s
2024-05-03 00:33:36 INFO     Saved model at 1
2024-05-03 00:33:36 INFO     Val loss decrease from 18.5012 to 15.0275, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-03 00:33:42 INFO     epoch complete!
2024-05-03 00:33:42 INFO     evaluating now!
2024-05-03 00:33:43 INFO     Epoch [2/200] train_loss: 12.4989, val_loss: 12.0907, lr: 0.003000, 6.54s
2024-05-03 00:33:43 INFO     Saved model at 2
2024-05-03 00:33:43 INFO     Val loss decrease from 15.0275 to 12.0907, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-03 00:33:49 INFO     epoch complete!
2024-05-03 00:33:49 INFO     evaluating now!
2024-05-03 00:33:49 INFO     Epoch [3/200] train_loss: 10.3248, val_loss: 10.1061, lr: 0.003000, 6.59s
2024-05-03 00:33:49 INFO     Saved model at 3
2024-05-03 00:33:49 INFO     Val loss decrease from 12.0907 to 10.1061, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-03 00:33:56 INFO     epoch complete!
2024-05-03 00:33:56 INFO     evaluating now!
2024-05-03 00:33:56 INFO     Epoch [4/200] train_loss: 8.7835, val_loss: 8.4329, lr: 0.003000, 6.49s
2024-05-03 00:33:56 INFO     Saved model at 4
2024-05-03 00:33:56 INFO     Val loss decrease from 10.1061 to 8.4329, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-03 00:34:02 INFO     epoch complete!
2024-05-03 00:34:02 INFO     evaluating now!
2024-05-03 00:34:03 INFO     Epoch [5/200] train_loss: 7.8462, val_loss: 8.0095, lr: 0.003000, 6.51s
2024-05-03 00:34:03 INFO     Saved model at 5
2024-05-03 00:34:03 INFO     Val loss decrease from 8.4329 to 8.0095, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-03 00:34:09 INFO     epoch complete!
2024-05-03 00:34:09 INFO     evaluating now!
2024-05-03 00:34:09 INFO     Epoch [6/200] train_loss: 7.2385, val_loss: 7.2066, lr: 0.003000, 6.48s
2024-05-03 00:34:09 INFO     Saved model at 6
2024-05-03 00:34:09 INFO     Val loss decrease from 8.0095 to 7.2066, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-03 00:34:15 INFO     epoch complete!
2024-05-03 00:34:15 INFO     evaluating now!
2024-05-03 00:34:16 INFO     Epoch [7/200] train_loss: 6.7443, val_loss: 6.7932, lr: 0.003000, 6.59s
2024-05-03 00:34:16 INFO     Saved model at 7
2024-05-03 00:34:16 INFO     Val loss decrease from 7.2066 to 6.7932, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-03 00:34:22 INFO     epoch complete!
2024-05-03 00:34:22 INFO     evaluating now!
2024-05-03 00:34:22 INFO     Epoch [8/200] train_loss: 6.3409, val_loss: 6.5618, lr: 0.003000, 6.63s
2024-05-03 00:34:22 INFO     Saved model at 8
2024-05-03 00:34:22 INFO     Val loss decrease from 6.7932 to 6.5618, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-03 00:34:29 INFO     epoch complete!
2024-05-03 00:34:29 INFO     evaluating now!
2024-05-03 00:34:29 INFO     Epoch [9/200] train_loss: 6.2015, val_loss: 6.4822, lr: 0.003000, 6.59s
2024-05-03 00:34:29 INFO     Saved model at 9
2024-05-03 00:34:29 INFO     Val loss decrease from 6.5618 to 6.4822, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-03 00:34:35 INFO     epoch complete!
2024-05-03 00:34:35 INFO     evaluating now!
2024-05-03 00:34:36 INFO     Epoch [10/200] train_loss: 5.8335, val_loss: 6.1267, lr: 0.003000, 6.61s
2024-05-03 00:34:36 INFO     Saved model at 10
2024-05-03 00:34:36 INFO     Val loss decrease from 6.4822 to 6.1267, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-03 00:34:42 INFO     epoch complete!
2024-05-03 00:34:42 INFO     evaluating now!
2024-05-03 00:34:42 INFO     Epoch [11/200] train_loss: 5.6878, val_loss: 6.1099, lr: 0.003000, 6.57s
2024-05-03 00:34:42 INFO     Saved model at 11
2024-05-03 00:34:42 INFO     Val loss decrease from 6.1267 to 6.1099, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-03 00:34:49 INFO     epoch complete!
2024-05-03 00:34:49 INFO     evaluating now!
2024-05-03 00:34:49 INFO     Epoch [12/200] train_loss: 5.7347, val_loss: 6.1868, lr: 0.003000, 6.69s
2024-05-03 00:34:55 INFO     epoch complete!
2024-05-03 00:34:55 INFO     evaluating now!
2024-05-03 00:34:55 INFO     Epoch [13/200] train_loss: 5.4889, val_loss: 5.8102, lr: 0.003000, 6.52s
2024-05-03 00:34:56 INFO     Saved model at 13
2024-05-03 00:34:56 INFO     Val loss decrease from 6.1099 to 5.8102, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-03 00:35:02 INFO     epoch complete!
2024-05-03 00:35:02 INFO     evaluating now!
2024-05-03 00:35:02 INFO     Epoch [14/200] train_loss: 5.4255, val_loss: 5.6804, lr: 0.003000, 6.84s
2024-05-03 00:35:02 INFO     Saved model at 14
2024-05-03 00:35:02 INFO     Val loss decrease from 5.8102 to 5.6804, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-03 00:35:09 INFO     epoch complete!
2024-05-03 00:35:09 INFO     evaluating now!
2024-05-03 00:35:09 INFO     Epoch [15/200] train_loss: 5.2910, val_loss: 5.7972, lr: 0.003000, 6.62s
2024-05-03 00:35:15 INFO     epoch complete!
2024-05-03 00:35:15 INFO     evaluating now!
2024-05-03 00:35:16 INFO     Epoch [16/200] train_loss: 5.2551, val_loss: 5.7160, lr: 0.003000, 6.68s
2024-05-03 00:35:22 INFO     epoch complete!
2024-05-03 00:35:22 INFO     evaluating now!
2024-05-03 00:35:22 INFO     Epoch [17/200] train_loss: 5.1459, val_loss: 5.5169, lr: 0.003000, 6.60s
2024-05-03 00:35:22 INFO     Saved model at 17
2024-05-03 00:35:22 INFO     Val loss decrease from 5.6804 to 5.5169, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-03 00:35:28 INFO     epoch complete!
2024-05-03 00:35:28 INFO     evaluating now!
2024-05-03 00:35:29 INFO     Epoch [18/200] train_loss: 4.9748, val_loss: 5.6556, lr: 0.003000, 6.46s
2024-05-03 00:35:35 INFO     epoch complete!
2024-05-03 00:35:35 INFO     evaluating now!
2024-05-03 00:35:35 INFO     Epoch [19/200] train_loss: 4.9128, val_loss: 5.5314, lr: 0.003000, 6.53s
2024-05-03 00:35:41 INFO     epoch complete!
2024-05-03 00:35:41 INFO     evaluating now!
2024-05-03 00:35:42 INFO     Epoch [20/200] train_loss: 4.8856, val_loss: 5.6980, lr: 0.003000, 6.55s
2024-05-03 00:35:48 INFO     epoch complete!
2024-05-03 00:35:48 INFO     evaluating now!
2024-05-03 00:35:49 INFO     Epoch [21/200] train_loss: 4.7815, val_loss: 5.4110, lr: 0.003000, 6.78s
2024-05-03 00:35:49 INFO     Saved model at 21
2024-05-03 00:35:49 INFO     Val loss decrease from 5.5169 to 5.4110, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-03 00:35:55 INFO     epoch complete!
2024-05-03 00:35:55 INFO     evaluating now!
2024-05-03 00:35:55 INFO     Epoch [22/200] train_loss: 4.7902, val_loss: 5.5548, lr: 0.003000, 6.74s
2024-05-03 00:36:02 INFO     epoch complete!
2024-05-03 00:36:02 INFO     evaluating now!
2024-05-03 00:36:02 INFO     Epoch [23/200] train_loss: 4.6661, val_loss: 5.3696, lr: 0.003000, 6.79s
2024-05-03 00:36:02 INFO     Saved model at 23
2024-05-03 00:36:02 INFO     Val loss decrease from 5.4110 to 5.3696, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-05-03 00:36:09 INFO     epoch complete!
2024-05-03 00:36:09 INFO     evaluating now!
2024-05-03 00:36:09 INFO     Epoch [24/200] train_loss: 4.6282, val_loss: 5.5749, lr: 0.003000, 6.95s
2024-05-03 00:36:16 INFO     epoch complete!
2024-05-03 00:36:16 INFO     evaluating now!
2024-05-03 00:36:16 INFO     Epoch [25/200] train_loss: 4.5452, val_loss: 5.3934, lr: 0.003000, 6.91s
2024-05-03 00:36:23 INFO     epoch complete!
2024-05-03 00:36:23 INFO     evaluating now!
2024-05-03 00:36:23 INFO     Epoch [26/200] train_loss: 4.5259, val_loss: 5.2830, lr: 0.003000, 6.79s
2024-05-03 00:36:23 INFO     Saved model at 26
2024-05-03 00:36:23 INFO     Val loss decrease from 5.3696 to 5.2830, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-05-03 00:36:29 INFO     epoch complete!
2024-05-03 00:36:29 INFO     evaluating now!
2024-05-03 00:36:30 INFO     Epoch [27/200] train_loss: 4.4409, val_loss: 5.2605, lr: 0.003000, 6.90s
2024-05-03 00:36:30 INFO     Saved model at 27
2024-05-03 00:36:30 INFO     Val loss decrease from 5.2830 to 5.2605, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-05-03 00:36:36 INFO     epoch complete!
2024-05-03 00:36:36 INFO     evaluating now!
2024-05-03 00:36:37 INFO     Epoch [28/200] train_loss: 4.4402, val_loss: 5.2907, lr: 0.003000, 6.87s
2024-05-03 00:36:43 INFO     epoch complete!
2024-05-03 00:36:43 INFO     evaluating now!
2024-05-03 00:36:44 INFO     Epoch [29/200] train_loss: 4.3660, val_loss: 5.2987, lr: 0.003000, 6.85s
2024-05-03 00:36:50 INFO     epoch complete!
2024-05-03 00:36:50 INFO     evaluating now!
2024-05-03 00:36:51 INFO     Epoch [30/200] train_loss: 4.3263, val_loss: 5.2621, lr: 0.003000, 6.95s
2024-05-03 00:36:57 INFO     epoch complete!
2024-05-03 00:36:57 INFO     evaluating now!
2024-05-03 00:36:57 INFO     Epoch [31/200] train_loss: 4.2764, val_loss: 5.2864, lr: 0.003000, 6.78s
2024-05-03 00:37:04 INFO     epoch complete!
2024-05-03 00:37:04 INFO     evaluating now!
2024-05-03 00:37:04 INFO     Epoch [32/200] train_loss: 4.2165, val_loss: 5.3007, lr: 0.003000, 6.77s
2024-05-03 00:37:11 INFO     epoch complete!
2024-05-03 00:37:11 INFO     evaluating now!
2024-05-03 00:37:12 INFO     Epoch [33/200] train_loss: 4.2471, val_loss: 5.3071, lr: 0.003000, 7.42s
2024-05-03 00:37:18 INFO     epoch complete!
2024-05-03 00:37:18 INFO     evaluating now!
2024-05-03 00:37:18 INFO     Epoch [34/200] train_loss: 4.1982, val_loss: 5.1673, lr: 0.003000, 6.86s
2024-05-03 00:37:19 INFO     Saved model at 34
2024-05-03 00:37:19 INFO     Val loss decrease from 5.2605 to 5.1673, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-05-03 00:37:25 INFO     epoch complete!
2024-05-03 00:37:25 INFO     evaluating now!
2024-05-03 00:37:25 INFO     Epoch [35/200] train_loss: 4.1454, val_loss: 5.2381, lr: 0.003000, 6.76s
2024-05-03 00:37:32 INFO     epoch complete!
2024-05-03 00:37:32 INFO     evaluating now!
2024-05-03 00:37:32 INFO     Epoch [36/200] train_loss: 4.1630, val_loss: 5.3319, lr: 0.003000, 6.73s
2024-05-03 00:37:38 INFO     epoch complete!
2024-05-03 00:37:38 INFO     evaluating now!
2024-05-03 00:37:39 INFO     Epoch [37/200] train_loss: 4.1084, val_loss: 5.1222, lr: 0.003000, 6.89s
2024-05-03 00:37:39 INFO     Saved model at 37
2024-05-03 00:37:39 INFO     Val loss decrease from 5.1673 to 5.1222, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-05-03 00:37:45 INFO     epoch complete!
2024-05-03 00:37:45 INFO     evaluating now!
2024-05-03 00:37:46 INFO     Epoch [38/200] train_loss: 4.0925, val_loss: 5.3033, lr: 0.003000, 6.77s
2024-05-03 00:37:52 INFO     epoch complete!
2024-05-03 00:37:52 INFO     evaluating now!
2024-05-03 00:37:52 INFO     Epoch [39/200] train_loss: 4.0858, val_loss: 5.2509, lr: 0.003000, 6.73s
2024-05-03 00:37:59 INFO     epoch complete!
2024-05-03 00:37:59 INFO     evaluating now!
2024-05-03 00:37:59 INFO     Epoch [40/200] train_loss: 3.9957, val_loss: 5.1931, lr: 0.003000, 6.73s
2024-05-03 00:38:05 INFO     epoch complete!
2024-05-03 00:38:05 INFO     evaluating now!
2024-05-03 00:38:06 INFO     Epoch [41/200] train_loss: 3.9077, val_loss: 5.3120, lr: 0.003000, 6.38s
2024-05-03 00:38:11 INFO     epoch complete!
2024-05-03 00:38:11 INFO     evaluating now!
2024-05-03 00:38:12 INFO     Epoch [42/200] train_loss: 3.9208, val_loss: 5.1929, lr: 0.003000, 6.31s
2024-05-03 00:38:18 INFO     epoch complete!
2024-05-03 00:38:18 INFO     evaluating now!
2024-05-03 00:38:18 INFO     Epoch [43/200] train_loss: 3.8766, val_loss: 5.2545, lr: 0.003000, 6.25s
2024-05-03 00:38:24 INFO     epoch complete!
2024-05-03 00:38:24 INFO     evaluating now!
2024-05-03 00:38:24 INFO     Epoch [44/200] train_loss: 3.8812, val_loss: 5.1008, lr: 0.003000, 6.31s
2024-05-03 00:38:24 INFO     Saved model at 44
2024-05-03 00:38:24 INFO     Val loss decrease from 5.1222 to 5.1008, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-05-03 00:38:31 INFO     epoch complete!
2024-05-03 00:38:31 INFO     evaluating now!
2024-05-03 00:38:31 INFO     Epoch [45/200] train_loss: 3.8122, val_loss: 5.0921, lr: 0.003000, 6.51s
2024-05-03 00:38:31 INFO     Saved model at 45
2024-05-03 00:38:31 INFO     Val loss decrease from 5.1008 to 5.0921, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-05-03 00:38:37 INFO     epoch complete!
2024-05-03 00:38:37 INFO     evaluating now!
2024-05-03 00:38:37 INFO     Epoch [46/200] train_loss: 3.7995, val_loss: 5.1471, lr: 0.003000, 6.39s
2024-05-03 00:38:44 INFO     epoch complete!
2024-05-03 00:38:44 INFO     evaluating now!
2024-05-03 00:38:44 INFO     Epoch [47/200] train_loss: 3.7760, val_loss: 5.1179, lr: 0.003000, 7.00s
2024-05-03 00:38:51 INFO     epoch complete!
2024-05-03 00:38:51 INFO     evaluating now!
2024-05-03 00:38:51 INFO     Epoch [48/200] train_loss: 3.8020, val_loss: 5.1459, lr: 0.003000, 6.73s
2024-05-03 00:38:57 INFO     epoch complete!
2024-05-03 00:38:57 INFO     evaluating now!
2024-05-03 00:38:58 INFO     Epoch [49/200] train_loss: 3.7615, val_loss: 5.1059, lr: 0.003000, 6.70s
2024-05-03 00:39:04 INFO     epoch complete!
2024-05-03 00:39:04 INFO     evaluating now!
2024-05-03 00:39:04 INFO     Epoch [50/200] train_loss: 3.7263, val_loss: 5.2886, lr: 0.003000, 6.59s
2024-05-03 00:39:11 INFO     epoch complete!
2024-05-03 00:39:11 INFO     evaluating now!
2024-05-03 00:39:11 INFO     Epoch [51/200] train_loss: 3.6851, val_loss: 5.2095, lr: 0.003000, 6.64s
2024-05-03 00:39:17 INFO     epoch complete!
2024-05-03 00:39:17 INFO     evaluating now!
2024-05-03 00:39:18 INFO     Epoch [52/200] train_loss: 3.6765, val_loss: 5.1215, lr: 0.003000, 6.61s
2024-05-03 00:39:24 INFO     epoch complete!
2024-05-03 00:39:24 INFO     evaluating now!
2024-05-03 00:39:24 INFO     Epoch [53/200] train_loss: 3.7079, val_loss: 5.0655, lr: 0.003000, 6.64s
2024-05-03 00:39:24 INFO     Saved model at 53
2024-05-03 00:39:24 INFO     Val loss decrease from 5.0921 to 5.0655, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch53.tar
2024-05-03 00:39:31 INFO     epoch complete!
2024-05-03 00:39:31 INFO     evaluating now!
2024-05-03 00:39:31 INFO     Epoch [54/200] train_loss: 3.6163, val_loss: 5.0209, lr: 0.003000, 6.65s
2024-05-03 00:39:31 INFO     Saved model at 54
2024-05-03 00:39:31 INFO     Val loss decrease from 5.0655 to 5.0209, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch54.tar
2024-05-03 00:39:37 INFO     epoch complete!
2024-05-03 00:39:37 INFO     evaluating now!
2024-05-03 00:39:38 INFO     Epoch [55/200] train_loss: 3.6179, val_loss: 5.1449, lr: 0.003000, 6.68s
2024-05-03 00:39:44 INFO     epoch complete!
2024-05-03 00:39:44 INFO     evaluating now!
2024-05-03 00:39:44 INFO     Epoch [56/200] train_loss: 3.5802, val_loss: 5.1648, lr: 0.003000, 6.64s
2024-05-03 00:39:51 INFO     epoch complete!
2024-05-03 00:39:51 INFO     evaluating now!
2024-05-03 00:39:51 INFO     Epoch [57/200] train_loss: 3.6362, val_loss: 5.3271, lr: 0.003000, 6.78s
2024-05-03 00:39:58 INFO     epoch complete!
2024-05-03 00:39:58 INFO     evaluating now!
2024-05-03 00:39:58 INFO     Epoch [58/200] train_loss: 3.6245, val_loss: 5.1418, lr: 0.003000, 6.77s
2024-05-03 00:40:04 INFO     epoch complete!
2024-05-03 00:40:04 INFO     evaluating now!
2024-05-03 00:40:05 INFO     Epoch [59/200] train_loss: 3.5367, val_loss: 5.1022, lr: 0.003000, 6.82s
2024-05-03 00:40:11 INFO     epoch complete!
2024-05-03 00:40:11 INFO     evaluating now!
2024-05-03 00:40:12 INFO     Epoch [60/200] train_loss: 3.5506, val_loss: 5.2438, lr: 0.003000, 6.77s
2024-05-03 00:40:18 INFO     epoch complete!
2024-05-03 00:40:18 INFO     evaluating now!
2024-05-03 00:40:18 INFO     Epoch [61/200] train_loss: 3.5575, val_loss: 5.1758, lr: 0.003000, 6.71s
2024-05-03 00:40:25 INFO     epoch complete!
2024-05-03 00:40:25 INFO     evaluating now!
2024-05-03 00:40:25 INFO     Epoch [62/200] train_loss: 3.5007, val_loss: 5.0243, lr: 0.003000, 6.78s
2024-05-03 00:40:31 INFO     epoch complete!
2024-05-03 00:40:31 INFO     evaluating now!
2024-05-03 00:40:31 INFO     Epoch [63/200] train_loss: 3.4875, val_loss: 5.1101, lr: 0.003000, 6.27s
2024-05-03 00:40:38 INFO     epoch complete!
2024-05-03 00:40:38 INFO     evaluating now!
2024-05-03 00:40:38 INFO     Epoch [64/200] train_loss: 3.5894, val_loss: 5.2363, lr: 0.003000, 6.87s
2024-05-03 00:40:44 INFO     epoch complete!
2024-05-03 00:40:44 INFO     evaluating now!
2024-05-03 00:40:45 INFO     Epoch [65/200] train_loss: 3.5902, val_loss: 5.0737, lr: 0.003000, 6.76s
2024-05-03 00:40:51 INFO     epoch complete!
2024-05-03 00:40:51 INFO     evaluating now!
2024-05-03 00:40:52 INFO     Epoch [66/200] train_loss: 3.4551, val_loss: 5.1398, lr: 0.003000, 6.76s
2024-05-03 00:40:58 INFO     epoch complete!
2024-05-03 00:40:58 INFO     evaluating now!
2024-05-03 00:40:59 INFO     Epoch [67/200] train_loss: 3.4244, val_loss: 5.1231, lr: 0.003000, 6.90s
2024-05-03 00:41:05 INFO     epoch complete!
2024-05-03 00:41:05 INFO     evaluating now!
2024-05-03 00:41:05 INFO     Epoch [68/200] train_loss: 3.4758, val_loss: 5.1481, lr: 0.003000, 6.90s
2024-05-03 00:41:12 INFO     epoch complete!
2024-05-03 00:41:12 INFO     evaluating now!
2024-05-03 00:41:12 INFO     Epoch [69/200] train_loss: 3.4273, val_loss: 4.9761, lr: 0.003000, 6.86s
2024-05-03 00:41:12 INFO     Saved model at 69
2024-05-03 00:41:12 INFO     Val loss decrease from 5.0209 to 4.9761, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch69.tar
2024-05-03 00:41:19 INFO     epoch complete!
2024-05-03 00:41:19 INFO     evaluating now!
2024-05-03 00:41:19 INFO     Epoch [70/200] train_loss: 3.4221, val_loss: 5.1013, lr: 0.003000, 6.72s
2024-05-03 00:41:25 INFO     epoch complete!
2024-05-03 00:41:25 INFO     evaluating now!
2024-05-03 00:41:26 INFO     Epoch [71/200] train_loss: 3.4299, val_loss: 5.1942, lr: 0.003000, 6.80s
2024-05-03 00:41:32 INFO     epoch complete!
2024-05-03 00:41:32 INFO     evaluating now!
2024-05-03 00:41:33 INFO     Epoch [72/200] train_loss: 3.4138, val_loss: 5.2326, lr: 0.003000, 6.78s
2024-05-03 00:41:39 INFO     epoch complete!
2024-05-03 00:41:39 INFO     evaluating now!
2024-05-03 00:41:39 INFO     Epoch [73/200] train_loss: 3.4033, val_loss: 5.0496, lr: 0.003000, 6.76s
2024-05-03 00:41:46 INFO     epoch complete!
2024-05-03 00:41:46 INFO     evaluating now!
2024-05-03 00:41:46 INFO     Epoch [74/200] train_loss: 3.3518, val_loss: 5.0322, lr: 0.003000, 6.73s
2024-05-03 00:41:52 INFO     epoch complete!
2024-05-03 00:41:52 INFO     evaluating now!
2024-05-03 00:41:53 INFO     Epoch [75/200] train_loss: 3.3305, val_loss: 5.1008, lr: 0.003000, 6.75s
2024-05-03 00:41:59 INFO     epoch complete!
2024-05-03 00:41:59 INFO     evaluating now!
2024-05-03 00:42:00 INFO     Epoch [76/200] train_loss: 3.4075, val_loss: 5.1182, lr: 0.003000, 6.68s
2024-05-03 00:42:06 INFO     epoch complete!
2024-05-03 00:42:06 INFO     evaluating now!
2024-05-03 00:42:06 INFO     Epoch [77/200] train_loss: 3.3699, val_loss: 5.1145, lr: 0.003000, 6.48s
2024-05-03 00:42:12 INFO     epoch complete!
2024-05-03 00:42:12 INFO     evaluating now!
2024-05-03 00:42:13 INFO     Epoch [78/200] train_loss: 3.3645, val_loss: 5.1942, lr: 0.003000, 6.56s
2024-05-03 00:42:19 INFO     epoch complete!
2024-05-03 00:42:19 INFO     evaluating now!
2024-05-03 00:42:19 INFO     Epoch [79/200] train_loss: 3.3341, val_loss: 5.0942, lr: 0.003000, 6.47s
2024-05-03 00:42:25 INFO     epoch complete!
2024-05-03 00:42:25 INFO     evaluating now!
2024-05-03 00:42:26 INFO     Epoch [80/200] train_loss: 3.2941, val_loss: 5.0410, lr: 0.003000, 6.53s
2024-05-03 00:42:32 INFO     epoch complete!
2024-05-03 00:42:32 INFO     evaluating now!
2024-05-03 00:42:32 INFO     Epoch [81/200] train_loss: 3.2609, val_loss: 5.0159, lr: 0.003000, 6.46s
2024-05-03 00:42:38 INFO     epoch complete!
2024-05-03 00:42:38 INFO     evaluating now!
2024-05-03 00:42:39 INFO     Epoch [82/200] train_loss: 3.2868, val_loss: 5.1131, lr: 0.003000, 6.67s
2024-05-03 00:42:45 INFO     epoch complete!
2024-05-03 00:42:45 INFO     evaluating now!
2024-05-03 00:42:45 INFO     Epoch [83/200] train_loss: 3.2524, val_loss: 5.0231, lr: 0.003000, 6.52s
2024-05-03 00:42:51 INFO     epoch complete!
2024-05-03 00:42:51 INFO     evaluating now!
2024-05-03 00:42:52 INFO     Epoch [84/200] train_loss: 3.2672, val_loss: 5.0941, lr: 0.003000, 6.51s
2024-05-03 00:42:52 WARNING  Early stopping at epoch: 84
2024-05-03 00:42:52 INFO     Trained totally 85 epochs, average train time is 6.256s, average eval time is 0.425s
2024-05-03 00:42:52 INFO     Loaded model at 69
2024-05-03 00:42:52 INFO     Saved model at ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406.m
2024-05-03 00:42:52 INFO     Start evaluating ...
2024-05-03 00:42:53 INFO     Note that you select the single mode to evaluate!
2024-05-03 00:42:53 INFO     Evaluate result is saved at ./libcity/cache/35/evaluate_cache/2024_05_03_00_42_53_AGCRN_CHITaxi20190406.csv
2024-05-03 00:42:53 INFO     
         MAE       RMSE
1   2.317019   6.839643
2   2.421955   7.412360
3   2.613279   8.437703
4   2.742578   9.235180
5   2.889666  10.005753
6   2.966504  10.659664
7   3.106075  11.221493
8   3.160912  11.753897
9   3.241839  12.170427
10  3.279910  12.627452
11  3.367107  13.030668
12  3.402617  13.439854
2024-05-03 00:42:54 INFO     ----------------------------------------------------------------------------
2024-05-03 00:42:54 INFO     # 4, Kownledge Graph Embedding: RefE, Experiment ids: 39
2024-05-03 00:42:54 INFO     ----------------------------------------------------------------------------
2024-05-03 00:42:54 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=35
2024-05-03 00:42:54 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 35, 'load_external': True, 'embedding_model': 'RefE', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-03 00:42:54 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-03 00:42:54 INFO     set_weight_link_or_dist: dist
2024-05-03 00:42:54 INFO     init_weight_inf_or_zero: inf
2024-05-03 00:42:54 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-03 00:42:54 INFO     Start Calculate the weight by Gauss kernel!
2024-05-03 00:42:54 INFO     Loading file CHITaxi20190406.dyna
2024-05-03 00:42:54 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-03 00:42:57 INFO     Dataset created
2024-05-03 00:42:57 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-03 00:42:57 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-03 00:42:57 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-03 00:42:57 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-03 00:42:57 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-03 00:42:57 INFO     NormalScaler max: 1.6586810199691633
2024-05-03 00:43:00 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-03 00:43:00 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-03 00:43:00 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-03 00:43:00 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-03 00:43:00 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-03 00:43:00 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-03 00:43:00 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-03 00:43:00 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-03 00:43:00 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-03 00:43:00 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-03 00:43:00 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-03 00:43:00 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-03 00:43:00 INFO     Total parameter numbers: 874010
2024-05-03 00:43:00 INFO     You select `adam` optimizer.
2024-05-03 00:43:00 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-03 00:43:00 INFO     Start training ...
2024-05-03 00:43:00 INFO     num_batches:48
2024-05-03 00:43:07 INFO     epoch complete!
2024-05-03 00:43:07 INFO     evaluating now!
2024-05-03 00:43:07 INFO     Epoch [0/200] train_loss: 23.5493, val_loss: 18.0131, lr: 0.003000, 6.49s
2024-05-03 00:43:07 INFO     Saved model at 0
2024-05-03 00:43:07 INFO     Val loss decrease from inf to 18.0131, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-03 00:43:13 INFO     epoch complete!
2024-05-03 00:43:13 INFO     evaluating now!
2024-05-03 00:43:14 INFO     Epoch [1/200] train_loss: 14.1876, val_loss: 13.3119, lr: 0.003000, 6.60s
2024-05-03 00:43:14 INFO     Saved model at 1
2024-05-03 00:43:14 INFO     Val loss decrease from 18.0131 to 13.3119, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-03 00:43:20 INFO     epoch complete!
2024-05-03 00:43:20 INFO     evaluating now!
2024-05-03 00:43:21 INFO     Epoch [2/200] train_loss: 10.9509, val_loss: 10.2609, lr: 0.003000, 6.45s
2024-05-03 00:43:21 INFO     Saved model at 2
2024-05-03 00:43:21 INFO     Val loss decrease from 13.3119 to 10.2609, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-03 00:43:26 INFO     epoch complete!
2024-05-03 00:43:26 INFO     evaluating now!
2024-05-03 00:43:27 INFO     Epoch [3/200] train_loss: 9.0763, val_loss: 8.6144, lr: 0.003000, 6.20s
2024-05-03 00:43:27 INFO     Saved model at 3
2024-05-03 00:43:27 INFO     Val loss decrease from 10.2609 to 8.6144, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-03 00:43:33 INFO     epoch complete!
2024-05-03 00:43:33 INFO     evaluating now!
2024-05-03 00:43:33 INFO     Epoch [4/200] train_loss: 8.0006, val_loss: 7.3920, lr: 0.003000, 6.08s
2024-05-03 00:43:33 INFO     Saved model at 4
2024-05-03 00:43:33 INFO     Val loss decrease from 8.6144 to 7.3920, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-03 00:43:39 INFO     epoch complete!
2024-05-03 00:43:39 INFO     evaluating now!
2024-05-03 00:43:39 INFO     Epoch [5/200] train_loss: 7.2361, val_loss: 7.0904, lr: 0.003000, 6.26s
2024-05-03 00:43:39 INFO     Saved model at 5
2024-05-03 00:43:39 INFO     Val loss decrease from 7.3920 to 7.0904, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-03 00:43:45 INFO     epoch complete!
2024-05-03 00:43:45 INFO     evaluating now!
2024-05-03 00:43:45 INFO     Epoch [6/200] train_loss: 6.7546, val_loss: 6.6333, lr: 0.003000, 6.13s
2024-05-03 00:43:46 INFO     Saved model at 6
2024-05-03 00:43:46 INFO     Val loss decrease from 7.0904 to 6.6333, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-03 00:43:51 INFO     epoch complete!
2024-05-03 00:43:51 INFO     evaluating now!
2024-05-03 00:43:52 INFO     Epoch [7/200] train_loss: 6.3839, val_loss: 6.3545, lr: 0.003000, 6.23s
2024-05-03 00:43:52 INFO     Saved model at 7
2024-05-03 00:43:52 INFO     Val loss decrease from 6.6333 to 6.3545, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-03 00:43:58 INFO     epoch complete!
2024-05-03 00:43:58 INFO     evaluating now!
2024-05-03 00:43:58 INFO     Epoch [8/200] train_loss: 6.1279, val_loss: 6.0861, lr: 0.003000, 6.34s
2024-05-03 00:43:58 INFO     Saved model at 8
2024-05-03 00:43:58 INFO     Val loss decrease from 6.3545 to 6.0861, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-03 00:44:04 INFO     epoch complete!
2024-05-03 00:44:04 INFO     evaluating now!
2024-05-03 00:44:05 INFO     Epoch [9/200] train_loss: 6.0004, val_loss: 6.0214, lr: 0.003000, 6.68s
2024-05-03 00:44:05 INFO     Saved model at 9
2024-05-03 00:44:05 INFO     Val loss decrease from 6.0861 to 6.0214, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-03 00:44:11 INFO     epoch complete!
2024-05-03 00:44:11 INFO     evaluating now!
2024-05-03 00:44:12 INFO     Epoch [10/200] train_loss: 5.6983, val_loss: 5.9861, lr: 0.003000, 6.89s
2024-05-03 00:44:12 INFO     Saved model at 10
2024-05-03 00:44:12 INFO     Val loss decrease from 6.0214 to 5.9861, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-03 00:44:18 INFO     epoch complete!
2024-05-03 00:44:18 INFO     evaluating now!
2024-05-03 00:44:19 INFO     Epoch [11/200] train_loss: 5.5995, val_loss: 5.9713, lr: 0.003000, 6.86s
2024-05-03 00:44:19 INFO     Saved model at 11
2024-05-03 00:44:19 INFO     Val loss decrease from 5.9861 to 5.9713, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-03 00:44:25 INFO     epoch complete!
2024-05-03 00:44:25 INFO     evaluating now!
2024-05-03 00:44:26 INFO     Epoch [12/200] train_loss: 5.4106, val_loss: 5.8071, lr: 0.003000, 6.66s
2024-05-03 00:44:26 INFO     Saved model at 12
2024-05-03 00:44:26 INFO     Val loss decrease from 5.9713 to 5.8071, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-03 00:44:32 INFO     epoch complete!
2024-05-03 00:44:32 INFO     evaluating now!
2024-05-03 00:44:32 INFO     Epoch [13/200] train_loss: 5.3177, val_loss: 5.5297, lr: 0.003000, 6.59s
2024-05-03 00:44:32 INFO     Saved model at 13
2024-05-03 00:44:32 INFO     Val loss decrease from 5.8071 to 5.5297, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-03 00:44:39 INFO     epoch complete!
2024-05-03 00:44:39 INFO     evaluating now!
2024-05-03 00:44:39 INFO     Epoch [14/200] train_loss: 5.2480, val_loss: 5.9330, lr: 0.003000, 6.67s
2024-05-03 00:44:45 INFO     epoch complete!
2024-05-03 00:44:45 INFO     evaluating now!
2024-05-03 00:44:46 INFO     Epoch [15/200] train_loss: 5.1505, val_loss: 5.5901, lr: 0.003000, 6.67s
2024-05-03 00:44:52 INFO     epoch complete!
2024-05-03 00:44:52 INFO     evaluating now!
2024-05-03 00:44:53 INFO     Epoch [16/200] train_loss: 5.0964, val_loss: 5.8408, lr: 0.003000, 6.80s
2024-05-03 00:44:59 INFO     epoch complete!
2024-05-03 00:44:59 INFO     evaluating now!
2024-05-03 00:44:59 INFO     Epoch [17/200] train_loss: 4.9937, val_loss: 5.3612, lr: 0.003000, 6.91s
2024-05-03 00:45:00 INFO     Saved model at 17
2024-05-03 00:45:00 INFO     Val loss decrease from 5.5297 to 5.3612, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-03 00:45:06 INFO     epoch complete!
2024-05-03 00:45:06 INFO     evaluating now!
2024-05-03 00:45:07 INFO     Epoch [18/200] train_loss: 4.9091, val_loss: 5.4197, lr: 0.003000, 7.00s
2024-05-03 00:45:13 INFO     epoch complete!
2024-05-03 00:45:13 INFO     evaluating now!
2024-05-03 00:45:14 INFO     Epoch [19/200] train_loss: 4.9110, val_loss: 5.6190, lr: 0.003000, 7.08s
2024-05-03 00:45:20 INFO     epoch complete!
2024-05-03 00:45:20 INFO     evaluating now!
2024-05-03 00:45:21 INFO     Epoch [20/200] train_loss: 4.7670, val_loss: 5.4925, lr: 0.003000, 7.19s
2024-05-03 00:45:28 INFO     epoch complete!
2024-05-03 00:45:28 INFO     evaluating now!
2024-05-03 00:45:28 INFO     Epoch [21/200] train_loss: 4.7807, val_loss: 5.3088, lr: 0.003000, 7.42s
2024-05-03 00:45:28 INFO     Saved model at 21
2024-05-03 00:45:28 INFO     Val loss decrease from 5.3612 to 5.3088, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-03 00:45:35 INFO     epoch complete!
2024-05-03 00:45:35 INFO     evaluating now!
2024-05-03 00:45:36 INFO     Epoch [22/200] train_loss: 4.6409, val_loss: 5.3838, lr: 0.003000, 7.35s
2024-05-03 00:45:43 INFO     epoch complete!
2024-05-03 00:45:43 INFO     evaluating now!
2024-05-03 00:45:43 INFO     Epoch [23/200] train_loss: 4.5775, val_loss: 5.2354, lr: 0.003000, 7.47s
2024-05-03 00:45:43 INFO     Saved model at 23
2024-05-03 00:45:43 INFO     Val loss decrease from 5.3088 to 5.2354, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-05-03 00:45:50 INFO     epoch complete!
2024-05-03 00:45:50 INFO     evaluating now!
2024-05-03 00:45:50 INFO     Epoch [24/200] train_loss: 4.5502, val_loss: 5.2487, lr: 0.003000, 7.21s
2024-05-03 00:45:57 INFO     epoch complete!
2024-05-03 00:45:57 INFO     evaluating now!
2024-05-03 00:45:58 INFO     Epoch [25/200] train_loss: 4.4918, val_loss: 5.1905, lr: 0.003000, 7.35s
2024-05-03 00:45:58 INFO     Saved model at 25
2024-05-03 00:45:58 INFO     Val loss decrease from 5.2354 to 5.1905, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-03 00:46:05 INFO     epoch complete!
2024-05-03 00:46:05 INFO     evaluating now!
2024-05-03 00:46:05 INFO     Epoch [26/200] train_loss: 4.4432, val_loss: 5.1700, lr: 0.003000, 7.46s
2024-05-03 00:46:05 INFO     Saved model at 26
2024-05-03 00:46:05 INFO     Val loss decrease from 5.1905 to 5.1700, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-05-03 00:46:12 INFO     epoch complete!
2024-05-03 00:46:12 INFO     evaluating now!
2024-05-03 00:46:13 INFO     Epoch [27/200] train_loss: 4.3730, val_loss: 5.1692, lr: 0.003000, 7.39s
2024-05-03 00:46:13 INFO     Saved model at 27
2024-05-03 00:46:13 INFO     Val loss decrease from 5.1700 to 5.1692, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-05-03 00:46:19 INFO     epoch complete!
2024-05-03 00:46:19 INFO     evaluating now!
2024-05-03 00:46:20 INFO     Epoch [28/200] train_loss: 4.2968, val_loss: 5.1304, lr: 0.003000, 7.16s
2024-05-03 00:46:22 INFO     Saved model at 28
2024-05-03 00:46:22 INFO     Val loss decrease from 5.1692 to 5.1304, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-05-03 00:46:29 INFO     epoch complete!
2024-05-03 00:46:29 INFO     evaluating now!
2024-05-03 00:46:29 INFO     Epoch [29/200] train_loss: 4.2564, val_loss: 5.2920, lr: 0.003000, 7.40s
2024-05-03 00:46:36 INFO     epoch complete!
2024-05-03 00:46:36 INFO     evaluating now!
2024-05-03 00:46:37 INFO     Epoch [30/200] train_loss: 4.2515, val_loss: 5.1883, lr: 0.003000, 7.54s
2024-05-03 00:46:44 INFO     epoch complete!
2024-05-03 00:46:44 INFO     evaluating now!
2024-05-03 00:46:44 INFO     Epoch [31/200] train_loss: 4.2502, val_loss: 5.2081, lr: 0.003000, 7.49s
2024-05-03 00:46:51 INFO     epoch complete!
2024-05-03 00:46:51 INFO     evaluating now!
2024-05-03 00:46:51 INFO     Epoch [32/200] train_loss: 4.2465, val_loss: 5.4108, lr: 0.003000, 7.33s
2024-05-03 00:46:58 INFO     epoch complete!
2024-05-03 00:46:58 INFO     evaluating now!
2024-05-03 00:46:59 INFO     Epoch [33/200] train_loss: 4.1885, val_loss: 5.2325, lr: 0.003000, 7.38s
2024-05-03 00:47:06 INFO     epoch complete!
2024-05-03 00:47:06 INFO     evaluating now!
2024-05-03 00:47:06 INFO     Epoch [34/200] train_loss: 4.1112, val_loss: 5.1646, lr: 0.003000, 7.56s
2024-05-03 00:47:14 INFO     epoch complete!
2024-05-03 00:47:14 INFO     evaluating now!
2024-05-03 00:47:14 INFO     Epoch [35/200] train_loss: 4.1014, val_loss: 5.0188, lr: 0.003000, 7.77s
2024-05-03 00:47:14 INFO     Saved model at 35
2024-05-03 00:47:14 INFO     Val loss decrease from 5.1304 to 5.0188, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-05-03 00:47:21 INFO     epoch complete!
2024-05-03 00:47:21 INFO     evaluating now!
2024-05-03 00:47:21 INFO     Epoch [36/200] train_loss: 4.0421, val_loss: 5.1471, lr: 0.003000, 7.26s
2024-05-03 00:47:28 INFO     epoch complete!
2024-05-03 00:47:28 INFO     evaluating now!
2024-05-03 00:47:29 INFO     Epoch [37/200] train_loss: 3.9675, val_loss: 5.1872, lr: 0.003000, 7.47s
2024-05-03 00:47:36 INFO     epoch complete!
2024-05-03 00:47:36 INFO     evaluating now!
2024-05-03 00:47:36 INFO     Epoch [38/200] train_loss: 3.9786, val_loss: 5.1696, lr: 0.003000, 7.12s
2024-05-03 00:47:42 INFO     epoch complete!
2024-05-03 00:47:42 INFO     evaluating now!
2024-05-03 00:47:43 INFO     Epoch [39/200] train_loss: 3.9290, val_loss: 5.1457, lr: 0.003000, 6.93s
2024-05-03 00:47:50 INFO     epoch complete!
2024-05-03 00:47:50 INFO     evaluating now!
2024-05-03 00:47:50 INFO     Epoch [40/200] train_loss: 3.9738, val_loss: 5.1376, lr: 0.003000, 7.26s
2024-05-03 00:47:57 INFO     epoch complete!
2024-05-03 00:47:57 INFO     evaluating now!
2024-05-03 00:47:57 INFO     Epoch [41/200] train_loss: 3.9004, val_loss: 5.0427, lr: 0.003000, 6.90s
2024-05-03 00:48:04 INFO     epoch complete!
2024-05-03 00:48:04 INFO     evaluating now!
2024-05-03 00:48:04 INFO     Epoch [42/200] train_loss: 3.9013, val_loss: 5.2624, lr: 0.003000, 7.00s
2024-05-03 00:48:11 INFO     epoch complete!
2024-05-03 00:48:11 INFO     evaluating now!
2024-05-03 00:48:11 INFO     Epoch [43/200] train_loss: 3.9111, val_loss: 5.1273, lr: 0.003000, 7.23s
2024-05-03 00:48:18 INFO     epoch complete!
2024-05-03 00:48:18 INFO     evaluating now!
2024-05-03 00:48:19 INFO     Epoch [44/200] train_loss: 3.8513, val_loss: 5.1443, lr: 0.003000, 7.33s
2024-05-03 00:48:25 INFO     epoch complete!
2024-05-03 00:48:25 INFO     evaluating now!
2024-05-03 00:48:26 INFO     Epoch [45/200] train_loss: 3.7696, val_loss: 5.0139, lr: 0.003000, 7.23s
2024-05-03 00:48:26 INFO     Saved model at 45
2024-05-03 00:48:26 INFO     Val loss decrease from 5.0188 to 5.0139, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-05-03 00:48:33 INFO     epoch complete!
2024-05-03 00:48:33 INFO     evaluating now!
2024-05-03 00:48:33 INFO     Epoch [46/200] train_loss: 3.8033, val_loss: 5.2076, lr: 0.003000, 7.24s
2024-05-03 00:48:40 INFO     epoch complete!
2024-05-03 00:48:40 INFO     evaluating now!
2024-05-03 00:48:41 INFO     Epoch [47/200] train_loss: 3.8127, val_loss: 5.1446, lr: 0.003000, 7.31s
2024-05-03 00:48:48 INFO     epoch complete!
2024-05-03 00:48:48 INFO     evaluating now!
2024-05-03 00:48:48 INFO     Epoch [48/200] train_loss: 3.7344, val_loss: 5.0954, lr: 0.003000, 7.62s
2024-05-03 00:48:55 INFO     epoch complete!
2024-05-03 00:48:55 INFO     evaluating now!
2024-05-03 00:48:55 INFO     Epoch [49/200] train_loss: 3.7681, val_loss: 5.1391, lr: 0.003000, 6.82s
2024-05-03 00:49:01 INFO     epoch complete!
2024-05-03 00:49:01 INFO     evaluating now!
2024-05-03 00:49:02 INFO     Epoch [50/200] train_loss: 3.7268, val_loss: 5.1043, lr: 0.003000, 6.50s
2024-05-03 00:49:08 INFO     epoch complete!
2024-05-03 00:49:08 INFO     evaluating now!
2024-05-03 00:49:08 INFO     Epoch [51/200] train_loss: 3.7193, val_loss: 5.0792, lr: 0.003000, 6.52s
2024-05-03 00:49:14 INFO     epoch complete!
2024-05-03 00:49:14 INFO     evaluating now!
2024-05-03 00:49:15 INFO     Epoch [52/200] train_loss: 3.6928, val_loss: 5.1862, lr: 0.003000, 6.52s
2024-05-03 00:49:21 INFO     epoch complete!
2024-05-03 00:49:21 INFO     evaluating now!
2024-05-03 00:49:21 INFO     Epoch [53/200] train_loss: 3.6521, val_loss: 5.0503, lr: 0.003000, 6.49s
2024-05-03 00:49:27 INFO     epoch complete!
2024-05-03 00:49:27 INFO     evaluating now!
2024-05-03 00:49:28 INFO     Epoch [54/200] train_loss: 3.6677, val_loss: 5.0877, lr: 0.003000, 6.67s
2024-05-03 00:49:34 INFO     epoch complete!
2024-05-03 00:49:34 INFO     evaluating now!
2024-05-03 00:49:35 INFO     Epoch [55/200] train_loss: 3.6503, val_loss: 5.0798, lr: 0.003000, 6.76s
2024-05-03 00:49:42 INFO     epoch complete!
2024-05-03 00:49:42 INFO     evaluating now!
2024-05-03 00:49:42 INFO     Epoch [56/200] train_loss: 3.6349, val_loss: 4.9860, lr: 0.003000, 7.52s
2024-05-03 00:49:42 INFO     Saved model at 56
2024-05-03 00:49:42 INFO     Val loss decrease from 5.0139 to 4.9860, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch56.tar
2024-05-03 00:49:49 INFO     epoch complete!
2024-05-03 00:49:49 INFO     evaluating now!
2024-05-03 00:49:49 INFO     Epoch [57/200] train_loss: 3.5494, val_loss: 5.0928, lr: 0.003000, 7.20s
2024-05-03 00:49:56 INFO     epoch complete!
2024-05-03 00:49:56 INFO     evaluating now!
2024-05-03 00:49:57 INFO     Epoch [58/200] train_loss: 3.6026, val_loss: 5.0889, lr: 0.003000, 7.14s
2024-05-03 00:50:03 INFO     epoch complete!
2024-05-03 00:50:03 INFO     evaluating now!
2024-05-03 00:50:04 INFO     Epoch [59/200] train_loss: 3.6082, val_loss: 5.0117, lr: 0.003000, 7.25s
2024-05-03 00:50:10 INFO     epoch complete!
2024-05-03 00:50:10 INFO     evaluating now!
2024-05-03 00:50:11 INFO     Epoch [60/200] train_loss: 3.5527, val_loss: 5.2167, lr: 0.003000, 6.93s
2024-05-03 00:50:17 INFO     epoch complete!
2024-05-03 00:50:17 INFO     evaluating now!
2024-05-03 00:50:18 INFO     Epoch [61/200] train_loss: 3.5523, val_loss: 5.0327, lr: 0.003000, 6.93s
2024-05-03 00:50:24 INFO     epoch complete!
2024-05-03 00:50:24 INFO     evaluating now!
2024-05-03 00:50:24 INFO     Epoch [62/200] train_loss: 3.5240, val_loss: 4.9895, lr: 0.003000, 6.84s
2024-05-03 00:50:31 INFO     epoch complete!
2024-05-03 00:50:31 INFO     evaluating now!
2024-05-03 00:50:31 INFO     Epoch [63/200] train_loss: 3.5001, val_loss: 5.0070, lr: 0.003000, 6.84s
2024-05-03 00:50:38 INFO     epoch complete!
2024-05-03 00:50:38 INFO     evaluating now!
2024-05-03 00:50:38 INFO     Epoch [64/200] train_loss: 3.5465, val_loss: 5.0340, lr: 0.003000, 6.91s
2024-05-03 00:50:44 INFO     epoch complete!
2024-05-03 00:50:44 INFO     evaluating now!
2024-05-03 00:50:45 INFO     Epoch [65/200] train_loss: 3.4921, val_loss: 5.0557, lr: 0.003000, 6.75s
2024-05-03 00:50:51 INFO     epoch complete!
2024-05-03 00:50:51 INFO     evaluating now!
2024-05-03 00:50:52 INFO     Epoch [66/200] train_loss: 3.4317, val_loss: 5.0567, lr: 0.003000, 6.84s
2024-05-03 00:50:58 INFO     epoch complete!
2024-05-03 00:50:58 INFO     evaluating now!
2024-05-03 00:50:59 INFO     Epoch [67/200] train_loss: 3.4011, val_loss: 4.9455, lr: 0.003000, 6.88s
2024-05-03 00:50:59 INFO     Saved model at 67
2024-05-03 00:50:59 INFO     Val loss decrease from 4.9860 to 4.9455, saving to ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406_epoch67.tar
2024-05-03 00:51:05 INFO     epoch complete!
2024-05-03 00:51:05 INFO     evaluating now!
2024-05-03 00:51:06 INFO     Epoch [68/200] train_loss: 3.4455, val_loss: 5.1516, lr: 0.003000, 7.13s
2024-05-03 00:51:13 INFO     epoch complete!
2024-05-03 00:51:13 INFO     evaluating now!
2024-05-03 00:51:13 INFO     Epoch [69/200] train_loss: 3.4699, val_loss: 5.0874, lr: 0.003000, 7.53s
2024-05-03 00:51:21 INFO     epoch complete!
2024-05-03 00:51:21 INFO     evaluating now!
2024-05-03 00:51:21 INFO     Epoch [70/200] train_loss: 3.4666, val_loss: 5.0462, lr: 0.003000, 7.68s
2024-05-03 00:51:28 INFO     epoch complete!
2024-05-03 00:51:28 INFO     evaluating now!
2024-05-03 00:51:28 INFO     Epoch [71/200] train_loss: 3.4417, val_loss: 5.1374, lr: 0.003000, 7.25s
2024-05-03 00:51:35 INFO     epoch complete!
2024-05-03 00:51:35 INFO     evaluating now!
2024-05-03 00:51:35 INFO     Epoch [72/200] train_loss: 3.4338, val_loss: 5.0395, lr: 0.003000, 6.95s
2024-05-03 00:51:42 INFO     epoch complete!
2024-05-03 00:51:42 INFO     evaluating now!
2024-05-03 00:51:42 INFO     Epoch [73/200] train_loss: 3.3876, val_loss: 5.1871, lr: 0.003000, 6.86s
2024-05-03 00:51:48 INFO     epoch complete!
2024-05-03 00:51:48 INFO     evaluating now!
2024-05-03 00:51:49 INFO     Epoch [74/200] train_loss: 3.3701, val_loss: 5.0127, lr: 0.003000, 6.75s
2024-05-03 00:51:55 INFO     epoch complete!
2024-05-03 00:51:55 INFO     evaluating now!
2024-05-03 00:51:56 INFO     Epoch [75/200] train_loss: 3.3302, val_loss: 5.0366, lr: 0.003000, 6.88s
2024-05-03 00:52:02 INFO     epoch complete!
2024-05-03 00:52:02 INFO     evaluating now!
2024-05-03 00:52:03 INFO     Epoch [76/200] train_loss: 3.3810, val_loss: 5.0421, lr: 0.003000, 6.83s
2024-05-03 00:52:09 INFO     epoch complete!
2024-05-03 00:52:09 INFO     evaluating now!
2024-05-03 00:52:10 INFO     Epoch [77/200] train_loss: 3.3682, val_loss: 5.0522, lr: 0.003000, 7.03s
2024-05-03 00:52:16 INFO     epoch complete!
2024-05-03 00:52:16 INFO     evaluating now!
2024-05-03 00:52:17 INFO     Epoch [78/200] train_loss: 3.3500, val_loss: 5.1512, lr: 0.003000, 7.29s
2024-05-03 00:52:24 INFO     epoch complete!
2024-05-03 00:52:24 INFO     evaluating now!
2024-05-03 00:52:24 INFO     Epoch [79/200] train_loss: 3.3427, val_loss: 5.0365, lr: 0.003000, 7.46s
2024-05-03 00:52:31 INFO     epoch complete!
2024-05-03 00:52:31 INFO     evaluating now!
2024-05-03 00:52:32 INFO     Epoch [80/200] train_loss: 3.3193, val_loss: 5.0162, lr: 0.003000, 7.41s
2024-05-03 00:52:39 INFO     epoch complete!
2024-05-03 00:52:39 INFO     evaluating now!
2024-05-03 00:52:39 INFO     Epoch [81/200] train_loss: 3.3108, val_loss: 5.0293, lr: 0.003000, 7.35s
2024-05-03 00:52:46 INFO     epoch complete!
2024-05-03 00:52:46 INFO     evaluating now!
2024-05-03 00:52:46 INFO     Epoch [82/200] train_loss: 3.3170, val_loss: 5.0989, lr: 0.003000, 7.00s
2024-05-03 00:52:46 WARNING  Early stopping at epoch: 82
2024-05-03 00:52:46 INFO     Trained totally 83 epochs, average train time is 6.521s, average eval time is 0.486s
2024-05-03 00:52:46 INFO     Loaded model at 67
2024-05-03 00:52:46 INFO     Saved model at ./libcity/cache/35/model_cache/AGCRN_CHITaxi20190406.m
2024-05-03 00:52:46 INFO     Start evaluating ...
2024-05-03 00:52:48 INFO     Note that you select the single mode to evaluate!
2024-05-03 00:52:48 INFO     Evaluate result is saved at ./libcity/cache/35/evaluate_cache/2024_05_03_00_52_48_AGCRN_CHITaxi20190406.csv
2024-05-03 00:52:48 INFO     
         MAE       RMSE
1   2.239799   7.052989
2   2.380129   7.721719
3   2.548838   8.732590
4   2.705294   9.491629
5   2.847945  10.320042
6   2.966874  11.090795
7   3.029082  11.856384
8   3.126032  12.401055
9   3.167879  12.717790
10  3.261079  13.000547
11  3.370930  13.114611
12  3.501960  13.378675
2024-05-03 00:52:48 INFO     ----------------------------------------------------------------------------
2024-05-03 00:52:48 INFO     Kownledge Graph Embedding: RefE, Experiment ids: [35, 36, 37, 38, 39]
2024-05-03 00:52:48 INFO     ----------------------------------------------------------------------------
2024-05-03 00:52:48 INFO     Average: 
         MAE       RMSE
0   2.324146   7.299869
1   2.421720   7.831812
2   2.598076   8.773943
3   2.739284   9.500013
4   2.901323  10.324709
5   2.989508  11.084176
6   3.077833  11.779729
7   3.156678  12.264589
8   3.197131  12.543066
9   3.243326  12.772827
10  3.323756  12.961550
11  3.444886  13.403162 
2024-05-03 00:52:48 INFO     Standard deviation: 
         MAE      RMSE
0   0.072272  0.438319
1   0.047994  0.349942
2   0.041691  0.318733
3   0.042206  0.293117
4   0.036843  0.236344
5   0.050755  0.237708
6   0.026574  0.346260
7   0.023562  0.428629
8   0.027855  0.439159
9   0.025618  0.428245
10  0.038936  0.367549
11  0.052689  0.355289
2024-05-03 00:52:48 INFO     ----------------------------------------------------------------------------
2024-05-03 00:52:48 INFO     12 steps Average: 
        MAE       RMSE
0  2.951472  10.878287
2024-05-03 00:52:48 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.040583  0.353274
