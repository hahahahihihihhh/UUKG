2024-09-02 15:25:00 INFO     Saving logs in: ./logs/CHITaxi20190406\AGCRN\ExtSpace\ComplEx
2024-09-02 15:25:00 INFO     ----------------------------------------------------------------------------
2024-09-02 15:25:00 INFO     # 0, Kownledge Graph Embedding: ComplEx, Experiment ids: 70
2024-09-02 15:25:00 INFO     ----------------------------------------------------------------------------
2024-09-02 15:25:00 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=70
2024-09-02 15:25:00 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 70, 'embedding_model': 'ComplEx', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 15:25:00 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 15:25:00 INFO     set_weight_link_or_dist: dist
2024-09-02 15:25:00 INFO     init_weight_inf_or_zero: inf
2024-09-02 15:25:00 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 15:25:00 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 15:25:00 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 15:25:00 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 15:25:02 INFO     Dataset created
2024-09-02 15:25:02 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 15:25:02 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 15:25:02 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 15:25:02 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 15:25:02 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 15:25:02 INFO     NormalScaler max: 3.0343689918518066
2024-09-02 15:25:05 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 15:25:05 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 15:25:05 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 15:25:05 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:25:05 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 15:25:05 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:25:05 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 15:25:05 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:25:05 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 15:25:05 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:25:05 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 15:25:05 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 15:25:05 INFO     Total parameter numbers: 874010
2024-09-02 15:25:05 INFO     You select `adam` optimizer.
2024-09-02 15:25:05 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 15:25:05 INFO     Start training ...
2024-09-02 15:25:05 INFO     num_batches:48
2024-09-02 15:25:12 INFO     epoch complete!
2024-09-02 15:25:12 INFO     evaluating now!
2024-09-02 15:25:12 INFO     Epoch [0/200] train_loss: 23.5709, val_loss: 17.3110, lr: 0.003000, 6.92s
2024-09-02 15:25:12 INFO     Saved model at 0
2024-09-02 15:25:12 INFO     Val loss decrease from inf to 17.3110, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 15:25:17 INFO     epoch complete!
2024-09-02 15:25:17 INFO     evaluating now!
2024-09-02 15:25:17 INFO     Epoch [1/200] train_loss: 13.5500, val_loss: 12.3493, lr: 0.003000, 5.09s
2024-09-02 15:25:17 INFO     Saved model at 1
2024-09-02 15:25:17 INFO     Val loss decrease from 17.3110 to 12.3493, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 15:25:22 INFO     epoch complete!
2024-09-02 15:25:22 INFO     evaluating now!
2024-09-02 15:25:22 INFO     Epoch [2/200] train_loss: 10.1894, val_loss: 9.5503, lr: 0.003000, 5.15s
2024-09-02 15:25:22 INFO     Saved model at 2
2024-09-02 15:25:22 INFO     Val loss decrease from 12.3493 to 9.5503, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 15:25:27 INFO     epoch complete!
2024-09-02 15:25:27 INFO     evaluating now!
2024-09-02 15:25:28 INFO     Epoch [3/200] train_loss: 8.3154, val_loss: 7.8012, lr: 0.003000, 5.24s
2024-09-02 15:25:28 INFO     Saved model at 3
2024-09-02 15:25:28 INFO     Val loss decrease from 9.5503 to 7.8012, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 15:25:32 INFO     epoch complete!
2024-09-02 15:25:32 INFO     evaluating now!
2024-09-02 15:25:33 INFO     Epoch [4/200] train_loss: 7.3043, val_loss: 7.0388, lr: 0.003000, 5.11s
2024-09-02 15:25:33 INFO     Saved model at 4
2024-09-02 15:25:33 INFO     Val loss decrease from 7.8012 to 7.0388, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 15:25:38 INFO     epoch complete!
2024-09-02 15:25:38 INFO     evaluating now!
2024-09-02 15:25:38 INFO     Epoch [5/200] train_loss: 6.7826, val_loss: 6.7505, lr: 0.003000, 5.13s
2024-09-02 15:25:38 INFO     Saved model at 5
2024-09-02 15:25:38 INFO     Val loss decrease from 7.0388 to 6.7505, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 15:25:43 INFO     epoch complete!
2024-09-02 15:25:43 INFO     evaluating now!
2024-09-02 15:25:43 INFO     Epoch [6/200] train_loss: 6.3280, val_loss: 6.2503, lr: 0.003000, 5.20s
2024-09-02 15:25:43 INFO     Saved model at 6
2024-09-02 15:25:43 INFO     Val loss decrease from 6.7505 to 6.2503, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 15:25:48 INFO     epoch complete!
2024-09-02 15:25:48 INFO     evaluating now!
2024-09-02 15:25:48 INFO     Epoch [7/200] train_loss: 6.0670, val_loss: 6.2048, lr: 0.003000, 5.19s
2024-09-02 15:25:48 INFO     Saved model at 7
2024-09-02 15:25:48 INFO     Val loss decrease from 6.2503 to 6.2048, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 15:25:54 INFO     epoch complete!
2024-09-02 15:25:54 INFO     evaluating now!
2024-09-02 15:25:54 INFO     Epoch [8/200] train_loss: 5.8542, val_loss: 6.1252, lr: 0.003000, 5.74s
2024-09-02 15:25:54 INFO     Saved model at 8
2024-09-02 15:25:54 INFO     Val loss decrease from 6.2048 to 6.1252, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 15:25:59 INFO     epoch complete!
2024-09-02 15:25:59 INFO     evaluating now!
2024-09-02 15:25:59 INFO     Epoch [9/200] train_loss: 5.6439, val_loss: 5.8130, lr: 0.003000, 5.22s
2024-09-02 15:25:59 INFO     Saved model at 9
2024-09-02 15:25:59 INFO     Val loss decrease from 6.1252 to 5.8130, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 15:26:04 INFO     epoch complete!
2024-09-02 15:26:04 INFO     evaluating now!
2024-09-02 15:26:05 INFO     Epoch [10/200] train_loss: 5.4816, val_loss: 5.8417, lr: 0.003000, 5.14s
2024-09-02 15:26:09 INFO     epoch complete!
2024-09-02 15:26:09 INFO     evaluating now!
2024-09-02 15:26:10 INFO     Epoch [11/200] train_loss: 5.3391, val_loss: 5.5776, lr: 0.003000, 5.16s
2024-09-02 15:26:10 INFO     Saved model at 11
2024-09-02 15:26:10 INFO     Val loss decrease from 5.8130 to 5.5776, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 15:26:15 INFO     epoch complete!
2024-09-02 15:26:15 INFO     evaluating now!
2024-09-02 15:26:15 INFO     Epoch [12/200] train_loss: 5.2390, val_loss: 5.6110, lr: 0.003000, 5.28s
2024-09-02 15:26:20 INFO     epoch complete!
2024-09-02 15:26:20 INFO     evaluating now!
2024-09-02 15:26:20 INFO     Epoch [13/200] train_loss: 5.1338, val_loss: 5.5496, lr: 0.003000, 5.13s
2024-09-02 15:26:20 INFO     Saved model at 13
2024-09-02 15:26:20 INFO     Val loss decrease from 5.5776 to 5.5496, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 15:26:25 INFO     epoch complete!
2024-09-02 15:26:25 INFO     evaluating now!
2024-09-02 15:26:25 INFO     Epoch [14/200] train_loss: 5.0225, val_loss: 5.5554, lr: 0.003000, 5.22s
2024-09-02 15:26:30 INFO     epoch complete!
2024-09-02 15:26:30 INFO     evaluating now!
2024-09-02 15:26:30 INFO     Epoch [15/200] train_loss: 5.0227, val_loss: 5.4431, lr: 0.003000, 5.15s
2024-09-02 15:26:31 INFO     Saved model at 15
2024-09-02 15:26:31 INFO     Val loss decrease from 5.5496 to 5.4431, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 15:26:35 INFO     epoch complete!
2024-09-02 15:26:35 INFO     evaluating now!
2024-09-02 15:26:36 INFO     Epoch [16/200] train_loss: 4.8898, val_loss: 5.5218, lr: 0.003000, 5.13s
2024-09-02 15:26:41 INFO     epoch complete!
2024-09-02 15:26:41 INFO     evaluating now!
2024-09-02 15:26:41 INFO     Epoch [17/200] train_loss: 4.8223, val_loss: 5.3710, lr: 0.003000, 5.22s
2024-09-02 15:26:41 INFO     Saved model at 17
2024-09-02 15:26:41 INFO     Val loss decrease from 5.4431 to 5.3710, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-02 15:26:46 INFO     epoch complete!
2024-09-02 15:26:46 INFO     evaluating now!
2024-09-02 15:26:46 INFO     Epoch [18/200] train_loss: 4.8049, val_loss: 5.3425, lr: 0.003000, 5.15s
2024-09-02 15:26:46 INFO     Saved model at 18
2024-09-02 15:26:46 INFO     Val loss decrease from 5.3710 to 5.3425, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-02 15:26:51 INFO     epoch complete!
2024-09-02 15:26:51 INFO     evaluating now!
2024-09-02 15:26:51 INFO     Epoch [19/200] train_loss: 4.7369, val_loss: 5.3032, lr: 0.003000, 5.17s
2024-09-02 15:26:51 INFO     Saved model at 19
2024-09-02 15:26:51 INFO     Val loss decrease from 5.3425 to 5.3032, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-02 15:26:56 INFO     epoch complete!
2024-09-02 15:26:56 INFO     evaluating now!
2024-09-02 15:26:56 INFO     Epoch [20/200] train_loss: 4.6231, val_loss: 5.2334, lr: 0.003000, 5.21s
2024-09-02 15:26:56 INFO     Saved model at 20
2024-09-02 15:26:56 INFO     Val loss decrease from 5.3032 to 5.2334, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-02 15:27:01 INFO     epoch complete!
2024-09-02 15:27:01 INFO     evaluating now!
2024-09-02 15:27:02 INFO     Epoch [21/200] train_loss: 4.5608, val_loss: 5.3335, lr: 0.003000, 5.16s
2024-09-02 15:27:06 INFO     epoch complete!
2024-09-02 15:27:06 INFO     evaluating now!
2024-09-02 15:27:07 INFO     Epoch [22/200] train_loss: 4.5428, val_loss: 5.3880, lr: 0.003000, 5.16s
2024-09-02 15:27:12 INFO     epoch complete!
2024-09-02 15:27:12 INFO     evaluating now!
2024-09-02 15:27:12 INFO     Epoch [23/200] train_loss: 4.4924, val_loss: 5.4971, lr: 0.003000, 5.25s
2024-09-02 15:27:17 INFO     epoch complete!
2024-09-02 15:27:17 INFO     evaluating now!
2024-09-02 15:27:17 INFO     Epoch [24/200] train_loss: 4.4282, val_loss: 5.3694, lr: 0.003000, 5.23s
2024-09-02 15:27:22 INFO     epoch complete!
2024-09-02 15:27:22 INFO     evaluating now!
2024-09-02 15:27:22 INFO     Epoch [25/200] train_loss: 4.4170, val_loss: 5.1884, lr: 0.003000, 5.22s
2024-09-02 15:27:22 INFO     Saved model at 25
2024-09-02 15:27:22 INFO     Val loss decrease from 5.2334 to 5.1884, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-02 15:27:28 INFO     epoch complete!
2024-09-02 15:27:28 INFO     evaluating now!
2024-09-02 15:27:28 INFO     Epoch [26/200] train_loss: 4.3409, val_loss: 5.0748, lr: 0.003000, 5.41s
2024-09-02 15:27:28 INFO     Saved model at 26
2024-09-02 15:27:28 INFO     Val loss decrease from 5.1884 to 5.0748, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-02 15:27:33 INFO     epoch complete!
2024-09-02 15:27:33 INFO     evaluating now!
2024-09-02 15:27:34 INFO     Epoch [27/200] train_loss: 4.3096, val_loss: 5.4154, lr: 0.003000, 5.82s
2024-09-02 15:27:39 INFO     epoch complete!
2024-09-02 15:27:39 INFO     evaluating now!
2024-09-02 15:27:39 INFO     Epoch [28/200] train_loss: 4.2429, val_loss: 5.1015, lr: 0.003000, 5.76s
2024-09-02 15:27:45 INFO     epoch complete!
2024-09-02 15:27:45 INFO     evaluating now!
2024-09-02 15:27:45 INFO     Epoch [29/200] train_loss: 4.2289, val_loss: 5.1228, lr: 0.003000, 5.44s
2024-09-02 15:27:50 INFO     epoch complete!
2024-09-02 15:27:50 INFO     evaluating now!
2024-09-02 15:27:50 INFO     Epoch [30/200] train_loss: 4.2257, val_loss: 5.1256, lr: 0.003000, 5.15s
2024-09-02 15:27:55 INFO     epoch complete!
2024-09-02 15:27:55 INFO     evaluating now!
2024-09-02 15:27:55 INFO     Epoch [31/200] train_loss: 4.1101, val_loss: 5.1244, lr: 0.003000, 5.12s
2024-09-02 15:28:00 INFO     epoch complete!
2024-09-02 15:28:00 INFO     evaluating now!
2024-09-02 15:28:00 INFO     Epoch [32/200] train_loss: 4.1121, val_loss: 5.0927, lr: 0.003000, 5.16s
2024-09-02 15:28:05 INFO     epoch complete!
2024-09-02 15:28:05 INFO     evaluating now!
2024-09-02 15:28:06 INFO     Epoch [33/200] train_loss: 4.0673, val_loss: 5.0619, lr: 0.003000, 5.20s
2024-09-02 15:28:06 INFO     Saved model at 33
2024-09-02 15:28:06 INFO     Val loss decrease from 5.0748 to 5.0619, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-09-02 15:28:11 INFO     epoch complete!
2024-09-02 15:28:11 INFO     evaluating now!
2024-09-02 15:28:11 INFO     Epoch [34/200] train_loss: 4.0241, val_loss: 5.2043, lr: 0.003000, 5.25s
2024-09-02 15:28:16 INFO     epoch complete!
2024-09-02 15:28:16 INFO     evaluating now!
2024-09-02 15:28:16 INFO     Epoch [35/200] train_loss: 4.0049, val_loss: 5.0758, lr: 0.003000, 5.17s
2024-09-02 15:28:21 INFO     epoch complete!
2024-09-02 15:28:21 INFO     evaluating now!
2024-09-02 15:28:21 INFO     Epoch [36/200] train_loss: 3.9453, val_loss: 5.1215, lr: 0.003000, 5.28s
2024-09-02 15:28:26 INFO     epoch complete!
2024-09-02 15:28:26 INFO     evaluating now!
2024-09-02 15:28:27 INFO     Epoch [37/200] train_loss: 3.9311, val_loss: 5.0502, lr: 0.003000, 5.22s
2024-09-02 15:28:27 INFO     Saved model at 37
2024-09-02 15:28:27 INFO     Val loss decrease from 5.0619 to 5.0502, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-09-02 15:28:31 INFO     epoch complete!
2024-09-02 15:28:31 INFO     evaluating now!
2024-09-02 15:28:32 INFO     Epoch [38/200] train_loss: 3.8998, val_loss: 5.1656, lr: 0.003000, 5.13s
2024-09-02 15:28:37 INFO     epoch complete!
2024-09-02 15:28:37 INFO     evaluating now!
2024-09-02 15:28:37 INFO     Epoch [39/200] train_loss: 3.9016, val_loss: 5.1586, lr: 0.003000, 5.17s
2024-09-02 15:28:42 INFO     epoch complete!
2024-09-02 15:28:42 INFO     evaluating now!
2024-09-02 15:28:42 INFO     Epoch [40/200] train_loss: 3.8448, val_loss: 5.0872, lr: 0.003000, 5.24s
2024-09-02 15:28:47 INFO     epoch complete!
2024-09-02 15:28:47 INFO     evaluating now!
2024-09-02 15:28:47 INFO     Epoch [41/200] train_loss: 3.7970, val_loss: 5.0273, lr: 0.003000, 5.23s
2024-09-02 15:28:47 INFO     Saved model at 41
2024-09-02 15:28:47 INFO     Val loss decrease from 5.0502 to 5.0273, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-09-02 15:28:52 INFO     epoch complete!
2024-09-02 15:28:52 INFO     evaluating now!
2024-09-02 15:28:52 INFO     Epoch [42/200] train_loss: 3.7766, val_loss: 5.1984, lr: 0.003000, 5.15s
2024-09-02 15:28:57 INFO     epoch complete!
2024-09-02 15:28:57 INFO     evaluating now!
2024-09-02 15:28:58 INFO     Epoch [43/200] train_loss: 3.8326, val_loss: 5.0977, lr: 0.003000, 5.22s
2024-09-02 15:29:03 INFO     epoch complete!
2024-09-02 15:29:03 INFO     evaluating now!
2024-09-02 15:29:03 INFO     Epoch [44/200] train_loss: 3.7736, val_loss: 5.0300, lr: 0.003000, 5.17s
2024-09-02 15:29:08 INFO     epoch complete!
2024-09-02 15:29:08 INFO     evaluating now!
2024-09-02 15:29:08 INFO     Epoch [45/200] train_loss: 3.7344, val_loss: 4.8997, lr: 0.003000, 5.22s
2024-09-02 15:29:08 INFO     Saved model at 45
2024-09-02 15:29:08 INFO     Val loss decrease from 5.0273 to 4.8997, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-09-02 15:29:13 INFO     epoch complete!
2024-09-02 15:29:13 INFO     evaluating now!
2024-09-02 15:29:13 INFO     Epoch [46/200] train_loss: 3.7010, val_loss: 5.0320, lr: 0.003000, 5.21s
2024-09-02 15:29:18 INFO     epoch complete!
2024-09-02 15:29:18 INFO     evaluating now!
2024-09-02 15:29:18 INFO     Epoch [47/200] train_loss: 3.7134, val_loss: 5.1279, lr: 0.003000, 5.16s
2024-09-02 15:29:23 INFO     epoch complete!
2024-09-02 15:29:23 INFO     evaluating now!
2024-09-02 15:29:24 INFO     Epoch [48/200] train_loss: 3.6741, val_loss: 5.0642, lr: 0.003000, 5.16s
2024-09-02 15:29:28 INFO     epoch complete!
2024-09-02 15:29:28 INFO     evaluating now!
2024-09-02 15:29:29 INFO     Epoch [49/200] train_loss: 3.6106, val_loss: 5.1946, lr: 0.003000, 5.19s
2024-09-02 15:29:34 INFO     epoch complete!
2024-09-02 15:29:34 INFO     evaluating now!
2024-09-02 15:29:34 INFO     Epoch [50/200] train_loss: 3.6211, val_loss: 5.0085, lr: 0.003000, 5.14s
2024-09-02 15:29:39 INFO     epoch complete!
2024-09-02 15:29:39 INFO     evaluating now!
2024-09-02 15:29:39 INFO     Epoch [51/200] train_loss: 3.5847, val_loss: 5.0428, lr: 0.003000, 5.14s
2024-09-02 15:29:44 INFO     epoch complete!
2024-09-02 15:29:44 INFO     evaluating now!
2024-09-02 15:29:44 INFO     Epoch [52/200] train_loss: 3.6044, val_loss: 5.0676, lr: 0.003000, 5.19s
2024-09-02 15:29:49 INFO     epoch complete!
2024-09-02 15:29:49 INFO     evaluating now!
2024-09-02 15:29:49 INFO     Epoch [53/200] train_loss: 3.6107, val_loss: 5.2188, lr: 0.003000, 5.13s
2024-09-02 15:29:54 INFO     epoch complete!
2024-09-02 15:29:54 INFO     evaluating now!
2024-09-02 15:29:55 INFO     Epoch [54/200] train_loss: 3.5932, val_loss: 4.9126, lr: 0.003000, 5.14s
2024-09-02 15:29:59 INFO     epoch complete!
2024-09-02 15:29:59 INFO     evaluating now!
2024-09-02 15:30:00 INFO     Epoch [55/200] train_loss: 3.5251, val_loss: 5.1124, lr: 0.003000, 5.19s
2024-09-02 15:30:05 INFO     epoch complete!
2024-09-02 15:30:05 INFO     evaluating now!
2024-09-02 15:30:05 INFO     Epoch [56/200] train_loss: 3.4870, val_loss: 5.0457, lr: 0.003000, 5.16s
2024-09-02 15:30:10 INFO     epoch complete!
2024-09-02 15:30:10 INFO     evaluating now!
2024-09-02 15:30:10 INFO     Epoch [57/200] train_loss: 3.4829, val_loss: 5.0087, lr: 0.003000, 5.22s
2024-09-02 15:30:15 INFO     epoch complete!
2024-09-02 15:30:15 INFO     evaluating now!
2024-09-02 15:30:15 INFO     Epoch [58/200] train_loss: 3.5198, val_loss: 5.0035, lr: 0.003000, 5.17s
2024-09-02 15:30:20 INFO     epoch complete!
2024-09-02 15:30:20 INFO     evaluating now!
2024-09-02 15:30:20 INFO     Epoch [59/200] train_loss: 3.4732, val_loss: 4.9607, lr: 0.003000, 5.12s
2024-09-02 15:30:25 INFO     epoch complete!
2024-09-02 15:30:25 INFO     evaluating now!
2024-09-02 15:30:26 INFO     Epoch [60/200] train_loss: 3.4426, val_loss: 5.0203, lr: 0.003000, 5.14s
2024-09-02 15:30:26 WARNING  Early stopping at epoch: 60
2024-09-02 15:30:26 INFO     Trained totally 61 epochs, average train time is 4.924s, average eval time is 0.321s
2024-09-02 15:30:26 INFO     Loaded model at 45
2024-09-02 15:30:26 INFO     Saved model at ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 15:30:26 INFO     Start evaluating ...
2024-09-02 15:30:27 INFO     Note that you select the single mode to evaluate!
2024-09-02 15:30:27 INFO     Evaluate result is saved at ./libcity/cache/70/evaluate_cache\2024_09_02_15_30_27_AGCRN_CHITaxi20190406.csv
2024-09-02 15:30:27 INFO     
         MAE       RMSE
1   2.367124   7.070670
2   2.466113   7.598635
3   2.675426   8.571692
4   2.856547   9.318037
5   3.054062  10.182846
6   3.126268  10.980356
7   3.202091  11.740769
8   3.264045  12.279604
9   3.298211  12.557942
10  3.363202  12.689702
11  3.333440  12.863877
12  3.467560  13.282696
2024-09-02 15:30:27 INFO     ----------------------------------------------------------------------------
2024-09-02 15:30:27 INFO     # 1, Kownledge Graph Embedding: ComplEx, Experiment ids: 71
2024-09-02 15:30:27 INFO     ----------------------------------------------------------------------------
2024-09-02 15:30:27 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=70
2024-09-02 15:30:27 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 70, 'embedding_model': 'ComplEx', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 15:30:27 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 15:30:27 INFO     set_weight_link_or_dist: dist
2024-09-02 15:30:27 INFO     init_weight_inf_or_zero: inf
2024-09-02 15:30:27 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 15:30:27 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 15:30:27 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 15:30:27 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 15:30:28 INFO     Dataset created
2024-09-02 15:30:28 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 15:30:28 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 15:30:28 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 15:30:28 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 15:30:29 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 15:30:29 INFO     NormalScaler max: 3.0343689918518066
2024-09-02 15:30:30 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 15:30:30 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 15:30:30 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 15:30:30 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:30:30 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 15:30:30 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:30:30 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 15:30:30 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:30:30 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 15:30:30 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:30:30 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 15:30:30 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 15:30:30 INFO     Total parameter numbers: 874010
2024-09-02 15:30:30 INFO     You select `adam` optimizer.
2024-09-02 15:30:30 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 15:30:30 INFO     Start training ...
2024-09-02 15:30:30 INFO     num_batches:48
2024-09-02 15:30:35 INFO     epoch complete!
2024-09-02 15:30:35 INFO     evaluating now!
2024-09-02 15:30:36 INFO     Epoch [0/200] train_loss: 24.6058, val_loss: 17.2590, lr: 0.003000, 5.25s
2024-09-02 15:30:36 INFO     Saved model at 0
2024-09-02 15:30:36 INFO     Val loss decrease from inf to 17.2590, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 15:30:41 INFO     epoch complete!
2024-09-02 15:30:41 INFO     evaluating now!
2024-09-02 15:30:41 INFO     Epoch [1/200] train_loss: 14.1119, val_loss: 13.3125, lr: 0.003000, 5.19s
2024-09-02 15:30:41 INFO     Saved model at 1
2024-09-02 15:30:41 INFO     Val loss decrease from 17.2590 to 13.3125, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 15:30:46 INFO     epoch complete!
2024-09-02 15:30:46 INFO     evaluating now!
2024-09-02 15:30:46 INFO     Epoch [2/200] train_loss: 10.7681, val_loss: 10.0214, lr: 0.003000, 5.07s
2024-09-02 15:30:46 INFO     Saved model at 2
2024-09-02 15:30:46 INFO     Val loss decrease from 13.3125 to 10.0214, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 15:30:51 INFO     epoch complete!
2024-09-02 15:30:51 INFO     evaluating now!
2024-09-02 15:30:51 INFO     Epoch [3/200] train_loss: 8.9855, val_loss: 8.3528, lr: 0.003000, 5.10s
2024-09-02 15:30:51 INFO     Saved model at 3
2024-09-02 15:30:51 INFO     Val loss decrease from 10.0214 to 8.3528, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 15:30:56 INFO     epoch complete!
2024-09-02 15:30:56 INFO     evaluating now!
2024-09-02 15:30:56 INFO     Epoch [4/200] train_loss: 7.9341, val_loss: 7.6560, lr: 0.003000, 5.15s
2024-09-02 15:30:56 INFO     Saved model at 4
2024-09-02 15:30:56 INFO     Val loss decrease from 8.3528 to 7.6560, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 15:31:01 INFO     epoch complete!
2024-09-02 15:31:01 INFO     evaluating now!
2024-09-02 15:31:01 INFO     Epoch [5/200] train_loss: 7.1125, val_loss: 6.7954, lr: 0.003000, 5.08s
2024-09-02 15:31:01 INFO     Saved model at 5
2024-09-02 15:31:01 INFO     Val loss decrease from 7.6560 to 6.7954, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 15:31:06 INFO     epoch complete!
2024-09-02 15:31:06 INFO     evaluating now!
2024-09-02 15:31:06 INFO     Epoch [6/200] train_loss: 6.7181, val_loss: 6.6866, lr: 0.003000, 5.09s
2024-09-02 15:31:06 INFO     Saved model at 6
2024-09-02 15:31:06 INFO     Val loss decrease from 6.7954 to 6.6866, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 15:31:11 INFO     epoch complete!
2024-09-02 15:31:11 INFO     evaluating now!
2024-09-02 15:31:12 INFO     Epoch [7/200] train_loss: 6.2931, val_loss: 6.4328, lr: 0.003000, 5.14s
2024-09-02 15:31:12 INFO     Saved model at 7
2024-09-02 15:31:12 INFO     Val loss decrease from 6.6866 to 6.4328, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 15:31:16 INFO     epoch complete!
2024-09-02 15:31:16 INFO     evaluating now!
2024-09-02 15:31:17 INFO     Epoch [8/200] train_loss: 5.9786, val_loss: 6.0736, lr: 0.003000, 5.07s
2024-09-02 15:31:17 INFO     Saved model at 8
2024-09-02 15:31:17 INFO     Val loss decrease from 6.4328 to 6.0736, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 15:31:21 INFO     epoch complete!
2024-09-02 15:31:21 INFO     evaluating now!
2024-09-02 15:31:22 INFO     Epoch [9/200] train_loss: 5.8547, val_loss: 5.9490, lr: 0.003000, 5.09s
2024-09-02 15:31:22 INFO     Saved model at 9
2024-09-02 15:31:22 INFO     Val loss decrease from 6.0736 to 5.9490, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 15:31:27 INFO     epoch complete!
2024-09-02 15:31:27 INFO     evaluating now!
2024-09-02 15:31:27 INFO     Epoch [10/200] train_loss: 5.6525, val_loss: 5.7982, lr: 0.003000, 5.13s
2024-09-02 15:31:27 INFO     Saved model at 10
2024-09-02 15:31:27 INFO     Val loss decrease from 5.9490 to 5.7982, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 15:31:32 INFO     epoch complete!
2024-09-02 15:31:32 INFO     evaluating now!
2024-09-02 15:31:32 INFO     Epoch [11/200] train_loss: 5.5198, val_loss: 5.7039, lr: 0.003000, 5.07s
2024-09-02 15:31:32 INFO     Saved model at 11
2024-09-02 15:31:32 INFO     Val loss decrease from 5.7982 to 5.7039, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 15:31:37 INFO     epoch complete!
2024-09-02 15:31:37 INFO     evaluating now!
2024-09-02 15:31:37 INFO     Epoch [12/200] train_loss: 5.3606, val_loss: 5.6315, lr: 0.003000, 5.08s
2024-09-02 15:31:37 INFO     Saved model at 12
2024-09-02 15:31:37 INFO     Val loss decrease from 5.7039 to 5.6315, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 15:31:42 INFO     epoch complete!
2024-09-02 15:31:42 INFO     evaluating now!
2024-09-02 15:31:42 INFO     Epoch [13/200] train_loss: 5.3027, val_loss: 5.5540, lr: 0.003000, 5.13s
2024-09-02 15:31:42 INFO     Saved model at 13
2024-09-02 15:31:42 INFO     Val loss decrease from 5.6315 to 5.5540, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 15:31:47 INFO     epoch complete!
2024-09-02 15:31:47 INFO     evaluating now!
2024-09-02 15:31:47 INFO     Epoch [14/200] train_loss: 5.0912, val_loss: 5.3971, lr: 0.003000, 5.11s
2024-09-02 15:31:47 INFO     Saved model at 14
2024-09-02 15:31:47 INFO     Val loss decrease from 5.5540 to 5.3971, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-02 15:31:52 INFO     epoch complete!
2024-09-02 15:31:52 INFO     evaluating now!
2024-09-02 15:31:52 INFO     Epoch [15/200] train_loss: 5.0542, val_loss: 5.4071, lr: 0.003000, 5.09s
2024-09-02 15:31:57 INFO     epoch complete!
2024-09-02 15:31:57 INFO     evaluating now!
2024-09-02 15:31:58 INFO     Epoch [16/200] train_loss: 4.9177, val_loss: 5.2960, lr: 0.003000, 5.17s
2024-09-02 15:31:58 INFO     Saved model at 16
2024-09-02 15:31:58 INFO     Val loss decrease from 5.3971 to 5.2960, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 15:32:02 INFO     epoch complete!
2024-09-02 15:32:02 INFO     evaluating now!
2024-09-02 15:32:03 INFO     Epoch [17/200] train_loss: 4.8885, val_loss: 5.3066, lr: 0.003000, 5.09s
2024-09-02 15:32:08 INFO     epoch complete!
2024-09-02 15:32:08 INFO     evaluating now!
2024-09-02 15:32:08 INFO     Epoch [18/200] train_loss: 4.7912, val_loss: 5.5214, lr: 0.003000, 5.16s
2024-09-02 15:32:13 INFO     epoch complete!
2024-09-02 15:32:13 INFO     evaluating now!
2024-09-02 15:32:13 INFO     Epoch [19/200] train_loss: 4.7698, val_loss: 5.3217, lr: 0.003000, 5.20s
2024-09-02 15:32:18 INFO     epoch complete!
2024-09-02 15:32:18 INFO     evaluating now!
2024-09-02 15:32:18 INFO     Epoch [20/200] train_loss: 4.6428, val_loss: 5.2140, lr: 0.003000, 5.25s
2024-09-02 15:32:18 INFO     Saved model at 20
2024-09-02 15:32:18 INFO     Val loss decrease from 5.2960 to 5.2140, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-02 15:32:24 INFO     epoch complete!
2024-09-02 15:32:24 INFO     evaluating now!
2024-09-02 15:32:24 INFO     Epoch [21/200] train_loss: 4.6114, val_loss: 5.1995, lr: 0.003000, 5.44s
2024-09-02 15:32:24 INFO     Saved model at 21
2024-09-02 15:32:24 INFO     Val loss decrease from 5.2140 to 5.1995, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-02 15:32:29 INFO     epoch complete!
2024-09-02 15:32:29 INFO     evaluating now!
2024-09-02 15:32:29 INFO     Epoch [22/200] train_loss: 4.6232, val_loss: 5.5281, lr: 0.003000, 5.30s
2024-09-02 15:32:34 INFO     epoch complete!
2024-09-02 15:32:34 INFO     evaluating now!
2024-09-02 15:32:34 INFO     Epoch [23/200] train_loss: 4.5439, val_loss: 5.1673, lr: 0.003000, 5.10s
2024-09-02 15:32:34 INFO     Saved model at 23
2024-09-02 15:32:34 INFO     Val loss decrease from 5.1995 to 5.1673, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-02 15:32:39 INFO     epoch complete!
2024-09-02 15:32:39 INFO     evaluating now!
2024-09-02 15:32:39 INFO     Epoch [24/200] train_loss: 4.4998, val_loss: 5.0823, lr: 0.003000, 5.14s
2024-09-02 15:32:39 INFO     Saved model at 24
2024-09-02 15:32:39 INFO     Val loss decrease from 5.1673 to 5.0823, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-02 15:32:44 INFO     epoch complete!
2024-09-02 15:32:44 INFO     evaluating now!
2024-09-02 15:32:45 INFO     Epoch [25/200] train_loss: 4.3826, val_loss: 5.2501, lr: 0.003000, 5.19s
2024-09-02 15:32:49 INFO     epoch complete!
2024-09-02 15:32:49 INFO     evaluating now!
2024-09-02 15:32:50 INFO     Epoch [26/200] train_loss: 4.4460, val_loss: 5.2257, lr: 0.003000, 5.09s
2024-09-02 15:32:54 INFO     epoch complete!
2024-09-02 15:32:54 INFO     evaluating now!
2024-09-02 15:32:55 INFO     Epoch [27/200] train_loss: 4.3611, val_loss: 5.1307, lr: 0.003000, 5.07s
2024-09-02 15:33:00 INFO     epoch complete!
2024-09-02 15:33:00 INFO     evaluating now!
2024-09-02 15:33:00 INFO     Epoch [28/200] train_loss: 4.3006, val_loss: 5.1187, lr: 0.003000, 5.16s
2024-09-02 15:33:05 INFO     epoch complete!
2024-09-02 15:33:05 INFO     evaluating now!
2024-09-02 15:33:05 INFO     Epoch [29/200] train_loss: 4.2807, val_loss: 5.1206, lr: 0.003000, 5.10s
2024-09-02 15:33:10 INFO     epoch complete!
2024-09-02 15:33:10 INFO     evaluating now!
2024-09-02 15:33:10 INFO     Epoch [30/200] train_loss: 4.2382, val_loss: 5.2142, lr: 0.003000, 5.10s
2024-09-02 15:33:15 INFO     epoch complete!
2024-09-02 15:33:15 INFO     evaluating now!
2024-09-02 15:33:15 INFO     Epoch [31/200] train_loss: 4.1361, val_loss: 5.0496, lr: 0.003000, 5.12s
2024-09-02 15:33:15 INFO     Saved model at 31
2024-09-02 15:33:15 INFO     Val loss decrease from 5.0823 to 5.0496, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-09-02 15:33:20 INFO     epoch complete!
2024-09-02 15:33:20 INFO     evaluating now!
2024-09-02 15:33:20 INFO     Epoch [32/200] train_loss: 4.1210, val_loss: 5.1745, lr: 0.003000, 5.09s
2024-09-02 15:33:25 INFO     epoch complete!
2024-09-02 15:33:25 INFO     evaluating now!
2024-09-02 15:33:25 INFO     Epoch [33/200] train_loss: 4.0573, val_loss: 5.0973, lr: 0.003000, 5.07s
2024-09-02 15:33:30 INFO     epoch complete!
2024-09-02 15:33:30 INFO     evaluating now!
2024-09-02 15:33:31 INFO     Epoch [34/200] train_loss: 4.1410, val_loss: 5.0899, lr: 0.003000, 5.18s
2024-09-02 15:33:35 INFO     epoch complete!
2024-09-02 15:33:35 INFO     evaluating now!
2024-09-02 15:33:36 INFO     Epoch [35/200] train_loss: 4.0838, val_loss: 4.9068, lr: 0.003000, 5.08s
2024-09-02 15:33:36 INFO     Saved model at 35
2024-09-02 15:33:36 INFO     Val loss decrease from 5.0496 to 4.9068, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-02 15:33:40 INFO     epoch complete!
2024-09-02 15:33:40 INFO     evaluating now!
2024-09-02 15:33:41 INFO     Epoch [36/200] train_loss: 3.9686, val_loss: 4.9963, lr: 0.003000, 5.12s
2024-09-02 15:33:46 INFO     epoch complete!
2024-09-02 15:33:46 INFO     evaluating now!
2024-09-02 15:33:46 INFO     Epoch [37/200] train_loss: 3.9094, val_loss: 4.8587, lr: 0.003000, 5.15s
2024-09-02 15:33:46 INFO     Saved model at 37
2024-09-02 15:33:46 INFO     Val loss decrease from 4.9068 to 4.8587, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-09-02 15:33:51 INFO     epoch complete!
2024-09-02 15:33:51 INFO     evaluating now!
2024-09-02 15:33:51 INFO     Epoch [38/200] train_loss: 3.9609, val_loss: 4.9630, lr: 0.003000, 5.09s
2024-09-02 15:33:56 INFO     epoch complete!
2024-09-02 15:33:56 INFO     evaluating now!
2024-09-02 15:33:56 INFO     Epoch [39/200] train_loss: 3.9055, val_loss: 5.0389, lr: 0.003000, 5.19s
2024-09-02 15:34:01 INFO     epoch complete!
2024-09-02 15:34:01 INFO     evaluating now!
2024-09-02 15:34:01 INFO     Epoch [40/200] train_loss: 3.8992, val_loss: 4.9159, lr: 0.003000, 5.09s
2024-09-02 15:34:06 INFO     epoch complete!
2024-09-02 15:34:06 INFO     evaluating now!
2024-09-02 15:34:07 INFO     Epoch [41/200] train_loss: 3.8336, val_loss: 4.9514, lr: 0.003000, 5.15s
2024-09-02 15:34:11 INFO     epoch complete!
2024-09-02 15:34:11 INFO     evaluating now!
2024-09-02 15:34:12 INFO     Epoch [42/200] train_loss: 3.8561, val_loss: 4.9640, lr: 0.003000, 5.13s
2024-09-02 15:34:16 INFO     epoch complete!
2024-09-02 15:34:16 INFO     evaluating now!
2024-09-02 15:34:17 INFO     Epoch [43/200] train_loss: 3.8122, val_loss: 5.0143, lr: 0.003000, 5.08s
2024-09-02 15:34:21 INFO     epoch complete!
2024-09-02 15:34:21 INFO     evaluating now!
2024-09-02 15:34:22 INFO     Epoch [44/200] train_loss: 3.7914, val_loss: 5.0037, lr: 0.003000, 5.07s
2024-09-02 15:34:27 INFO     epoch complete!
2024-09-02 15:34:27 INFO     evaluating now!
2024-09-02 15:34:27 INFO     Epoch [45/200] train_loss: 3.7779, val_loss: 5.1612, lr: 0.003000, 5.16s
2024-09-02 15:34:32 INFO     epoch complete!
2024-09-02 15:34:32 INFO     evaluating now!
2024-09-02 15:34:32 INFO     Epoch [46/200] train_loss: 3.8005, val_loss: 4.8719, lr: 0.003000, 5.14s
2024-09-02 15:34:37 INFO     epoch complete!
2024-09-02 15:34:37 INFO     evaluating now!
2024-09-02 15:34:37 INFO     Epoch [47/200] train_loss: 3.6935, val_loss: 5.0549, lr: 0.003000, 5.20s
2024-09-02 15:34:42 INFO     epoch complete!
2024-09-02 15:34:42 INFO     evaluating now!
2024-09-02 15:34:42 INFO     Epoch [48/200] train_loss: 3.6742, val_loss: 4.9546, lr: 0.003000, 5.13s
2024-09-02 15:34:47 INFO     epoch complete!
2024-09-02 15:34:47 INFO     evaluating now!
2024-09-02 15:34:48 INFO     Epoch [49/200] train_loss: 3.6992, val_loss: 5.0006, lr: 0.003000, 5.12s
2024-09-02 15:34:52 INFO     epoch complete!
2024-09-02 15:34:52 INFO     evaluating now!
2024-09-02 15:34:53 INFO     Epoch [50/200] train_loss: 3.6399, val_loss: 5.0357, lr: 0.003000, 5.17s
2024-09-02 15:34:58 INFO     epoch complete!
2024-09-02 15:34:58 INFO     evaluating now!
2024-09-02 15:34:58 INFO     Epoch [51/200] train_loss: 3.6235, val_loss: 5.0064, lr: 0.003000, 5.24s
2024-09-02 15:35:03 INFO     epoch complete!
2024-09-02 15:35:03 INFO     evaluating now!
2024-09-02 15:35:03 INFO     Epoch [52/200] train_loss: 3.6300, val_loss: 4.9327, lr: 0.003000, 5.30s
2024-09-02 15:35:03 WARNING  Early stopping at epoch: 52
2024-09-02 15:35:03 INFO     Trained totally 53 epochs, average train time is 4.828s, average eval time is 0.313s
2024-09-02 15:35:03 INFO     Loaded model at 37
2024-09-02 15:35:03 INFO     Saved model at ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 15:35:03 INFO     Start evaluating ...
2024-09-02 15:35:04 INFO     Note that you select the single mode to evaluate!
2024-09-02 15:35:04 INFO     Evaluate result is saved at ./libcity/cache/70/evaluate_cache\2024_09_02_15_35_04_AGCRN_CHITaxi20190406.csv
2024-09-02 15:35:04 INFO     
         MAE       RMSE
1   2.448946   7.595737
2   2.515836   7.945284
3   2.619676   8.737576
4   2.776695   9.575550
5   2.954102  10.656073
6   3.034344  11.557261
7   3.077549  12.225058
8   3.166508  12.608821
9   3.211663  12.821565
10  3.281921  12.927453
11  3.331500  13.206635
12  3.468664  13.864743
2024-09-02 15:35:04 INFO     ----------------------------------------------------------------------------
2024-09-02 15:35:04 INFO     # 2, Kownledge Graph Embedding: ComplEx, Experiment ids: 72
2024-09-02 15:35:04 INFO     ----------------------------------------------------------------------------
2024-09-02 15:35:04 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=70
2024-09-02 15:35:04 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 70, 'embedding_model': 'ComplEx', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 15:35:04 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 15:35:04 INFO     set_weight_link_or_dist: dist
2024-09-02 15:35:04 INFO     init_weight_inf_or_zero: inf
2024-09-02 15:35:04 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 15:35:04 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 15:35:04 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 15:35:04 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 15:35:06 INFO     Dataset created
2024-09-02 15:35:06 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 15:35:06 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 15:35:06 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 15:35:06 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 15:35:06 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 15:35:06 INFO     NormalScaler max: 3.0343689918518066
2024-09-02 15:35:08 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 15:35:08 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 15:35:08 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 15:35:08 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:35:08 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 15:35:08 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:35:08 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 15:35:08 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:35:08 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 15:35:08 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:35:08 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 15:35:08 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 15:35:08 INFO     Total parameter numbers: 874010
2024-09-02 15:35:08 INFO     You select `adam` optimizer.
2024-09-02 15:35:08 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 15:35:08 INFO     Start training ...
2024-09-02 15:35:08 INFO     num_batches:48
2024-09-02 15:35:13 INFO     epoch complete!
2024-09-02 15:35:13 INFO     evaluating now!
2024-09-02 15:35:14 INFO     Epoch [0/200] train_loss: 23.6864, val_loss: 17.1939, lr: 0.003000, 5.49s
2024-09-02 15:35:14 INFO     Saved model at 0
2024-09-02 15:35:14 INFO     Val loss decrease from inf to 17.1939, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 15:35:18 INFO     epoch complete!
2024-09-02 15:35:18 INFO     evaluating now!
2024-09-02 15:35:19 INFO     Epoch [1/200] train_loss: 13.6446, val_loss: 12.7408, lr: 0.003000, 5.13s
2024-09-02 15:35:19 INFO     Saved model at 1
2024-09-02 15:35:19 INFO     Val loss decrease from 17.1939 to 12.7408, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 15:35:24 INFO     epoch complete!
2024-09-02 15:35:24 INFO     evaluating now!
2024-09-02 15:35:24 INFO     Epoch [2/200] train_loss: 10.3832, val_loss: 9.5634, lr: 0.003000, 5.39s
2024-09-02 15:35:24 INFO     Saved model at 2
2024-09-02 15:35:24 INFO     Val loss decrease from 12.7408 to 9.5634, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 15:35:29 INFO     epoch complete!
2024-09-02 15:35:29 INFO     evaluating now!
2024-09-02 15:35:29 INFO     Epoch [3/200] train_loss: 8.5062, val_loss: 8.1385, lr: 0.003000, 5.21s
2024-09-02 15:35:29 INFO     Saved model at 3
2024-09-02 15:35:29 INFO     Val loss decrease from 9.5634 to 8.1385, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 15:35:34 INFO     epoch complete!
2024-09-02 15:35:34 INFO     evaluating now!
2024-09-02 15:35:35 INFO     Epoch [4/200] train_loss: 7.4638, val_loss: 7.6622, lr: 0.003000, 5.23s
2024-09-02 15:35:35 INFO     Saved model at 4
2024-09-02 15:35:35 INFO     Val loss decrease from 8.1385 to 7.6622, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 15:35:40 INFO     epoch complete!
2024-09-02 15:35:40 INFO     evaluating now!
2024-09-02 15:35:40 INFO     Epoch [5/200] train_loss: 6.8242, val_loss: 6.6879, lr: 0.003000, 5.24s
2024-09-02 15:35:40 INFO     Saved model at 5
2024-09-02 15:35:40 INFO     Val loss decrease from 7.6622 to 6.6879, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 15:35:45 INFO     epoch complete!
2024-09-02 15:35:45 INFO     evaluating now!
2024-09-02 15:35:45 INFO     Epoch [6/200] train_loss: 6.3781, val_loss: 6.5282, lr: 0.003000, 5.09s
2024-09-02 15:35:45 INFO     Saved model at 6
2024-09-02 15:35:45 INFO     Val loss decrease from 6.6879 to 6.5282, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 15:35:50 INFO     epoch complete!
2024-09-02 15:35:50 INFO     evaluating now!
2024-09-02 15:35:50 INFO     Epoch [7/200] train_loss: 6.0559, val_loss: 6.1717, lr: 0.003000, 5.08s
2024-09-02 15:35:50 INFO     Saved model at 7
2024-09-02 15:35:50 INFO     Val loss decrease from 6.5282 to 6.1717, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 15:35:55 INFO     epoch complete!
2024-09-02 15:35:55 INFO     evaluating now!
2024-09-02 15:35:55 INFO     Epoch [8/200] train_loss: 5.8624, val_loss: 6.1401, lr: 0.003000, 5.12s
2024-09-02 15:35:55 INFO     Saved model at 8
2024-09-02 15:35:55 INFO     Val loss decrease from 6.1717 to 6.1401, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 15:36:00 INFO     epoch complete!
2024-09-02 15:36:00 INFO     evaluating now!
2024-09-02 15:36:00 INFO     Epoch [9/200] train_loss: 5.8411, val_loss: 5.9388, lr: 0.003000, 5.10s
2024-09-02 15:36:00 INFO     Saved model at 9
2024-09-02 15:36:00 INFO     Val loss decrease from 6.1401 to 5.9388, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 15:36:05 INFO     epoch complete!
2024-09-02 15:36:05 INFO     evaluating now!
2024-09-02 15:36:05 INFO     Epoch [10/200] train_loss: 5.4956, val_loss: 5.7948, lr: 0.003000, 5.09s
2024-09-02 15:36:05 INFO     Saved model at 10
2024-09-02 15:36:05 INFO     Val loss decrease from 5.9388 to 5.7948, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 15:36:10 INFO     epoch complete!
2024-09-02 15:36:10 INFO     evaluating now!
2024-09-02 15:36:11 INFO     Epoch [11/200] train_loss: 5.4438, val_loss: 5.7430, lr: 0.003000, 5.14s
2024-09-02 15:36:11 INFO     Saved model at 11
2024-09-02 15:36:11 INFO     Val loss decrease from 5.7948 to 5.7430, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 15:36:16 INFO     epoch complete!
2024-09-02 15:36:16 INFO     evaluating now!
2024-09-02 15:36:16 INFO     Epoch [12/200] train_loss: 5.2778, val_loss: 5.7912, lr: 0.003000, 5.27s
2024-09-02 15:36:21 INFO     epoch complete!
2024-09-02 15:36:21 INFO     evaluating now!
2024-09-02 15:36:21 INFO     Epoch [13/200] train_loss: 5.1664, val_loss: 5.4548, lr: 0.003000, 5.11s
2024-09-02 15:36:21 INFO     Saved model at 13
2024-09-02 15:36:21 INFO     Val loss decrease from 5.7430 to 5.4548, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 15:36:26 INFO     epoch complete!
2024-09-02 15:36:26 INFO     evaluating now!
2024-09-02 15:36:26 INFO     Epoch [14/200] train_loss: 5.0753, val_loss: 5.4693, lr: 0.003000, 5.17s
2024-09-02 15:36:31 INFO     epoch complete!
2024-09-02 15:36:31 INFO     evaluating now!
2024-09-02 15:36:31 INFO     Epoch [15/200] train_loss: 5.0222, val_loss: 5.4392, lr: 0.003000, 5.11s
2024-09-02 15:36:31 INFO     Saved model at 15
2024-09-02 15:36:31 INFO     Val loss decrease from 5.4548 to 5.4392, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 15:36:36 INFO     epoch complete!
2024-09-02 15:36:36 INFO     evaluating now!
2024-09-02 15:36:36 INFO     Epoch [16/200] train_loss: 4.8833, val_loss: 5.3884, lr: 0.003000, 5.11s
2024-09-02 15:36:36 INFO     Saved model at 16
2024-09-02 15:36:36 INFO     Val loss decrease from 5.4392 to 5.3884, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 15:36:41 INFO     epoch complete!
2024-09-02 15:36:41 INFO     evaluating now!
2024-09-02 15:36:42 INFO     Epoch [17/200] train_loss: 4.8678, val_loss: 5.2707, lr: 0.003000, 5.15s
2024-09-02 15:36:42 INFO     Saved model at 17
2024-09-02 15:36:42 INFO     Val loss decrease from 5.3884 to 5.2707, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-02 15:36:46 INFO     epoch complete!
2024-09-02 15:36:46 INFO     evaluating now!
2024-09-02 15:36:47 INFO     Epoch [18/200] train_loss: 4.7669, val_loss: 5.4912, lr: 0.003000, 5.08s
2024-09-02 15:36:51 INFO     epoch complete!
2024-09-02 15:36:51 INFO     evaluating now!
2024-09-02 15:36:52 INFO     Epoch [19/200] train_loss: 4.6806, val_loss: 5.1698, lr: 0.003000, 5.12s
2024-09-02 15:36:52 INFO     Saved model at 19
2024-09-02 15:36:52 INFO     Val loss decrease from 5.2707 to 5.1698, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-02 15:36:57 INFO     epoch complete!
2024-09-02 15:36:57 INFO     evaluating now!
2024-09-02 15:36:57 INFO     Epoch [20/200] train_loss: 4.6211, val_loss: 5.1634, lr: 0.003000, 5.14s
2024-09-02 15:36:57 INFO     Saved model at 20
2024-09-02 15:36:57 INFO     Val loss decrease from 5.1698 to 5.1634, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-02 15:37:02 INFO     epoch complete!
2024-09-02 15:37:02 INFO     evaluating now!
2024-09-02 15:37:02 INFO     Epoch [21/200] train_loss: 4.5466, val_loss: 5.1145, lr: 0.003000, 5.10s
2024-09-02 15:37:02 INFO     Saved model at 21
2024-09-02 15:37:02 INFO     Val loss decrease from 5.1634 to 5.1145, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-02 15:37:07 INFO     epoch complete!
2024-09-02 15:37:07 INFO     evaluating now!
2024-09-02 15:37:07 INFO     Epoch [22/200] train_loss: 4.4557, val_loss: 5.0960, lr: 0.003000, 5.16s
2024-09-02 15:37:07 INFO     Saved model at 22
2024-09-02 15:37:07 INFO     Val loss decrease from 5.1145 to 5.0960, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-02 15:37:12 INFO     epoch complete!
2024-09-02 15:37:12 INFO     evaluating now!
2024-09-02 15:37:12 INFO     Epoch [23/200] train_loss: 4.4243, val_loss: 5.2376, lr: 0.003000, 5.10s
2024-09-02 15:37:17 INFO     epoch complete!
2024-09-02 15:37:17 INFO     evaluating now!
2024-09-02 15:37:17 INFO     Epoch [24/200] train_loss: 4.3633, val_loss: 5.1538, lr: 0.003000, 5.09s
2024-09-02 15:37:22 INFO     epoch complete!
2024-09-02 15:37:22 INFO     evaluating now!
2024-09-02 15:37:23 INFO     Epoch [25/200] train_loss: 4.3252, val_loss: 5.1990, lr: 0.003000, 5.18s
2024-09-02 15:37:27 INFO     epoch complete!
2024-09-02 15:37:27 INFO     evaluating now!
2024-09-02 15:37:28 INFO     Epoch [26/200] train_loss: 4.2849, val_loss: 5.2154, lr: 0.003000, 5.09s
2024-09-02 15:37:33 INFO     epoch complete!
2024-09-02 15:37:33 INFO     evaluating now!
2024-09-02 15:37:33 INFO     Epoch [27/200] train_loss: 4.2264, val_loss: 5.1020, lr: 0.003000, 5.27s
2024-09-02 15:37:38 INFO     epoch complete!
2024-09-02 15:37:38 INFO     evaluating now!
2024-09-02 15:37:38 INFO     Epoch [28/200] train_loss: 4.2007, val_loss: 4.9366, lr: 0.003000, 5.25s
2024-09-02 15:37:38 INFO     Saved model at 28
2024-09-02 15:37:38 INFO     Val loss decrease from 5.0960 to 4.9366, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-02 15:37:43 INFO     epoch complete!
2024-09-02 15:37:43 INFO     evaluating now!
2024-09-02 15:37:43 INFO     Epoch [29/200] train_loss: 4.1651, val_loss: 5.1952, lr: 0.003000, 5.06s
2024-09-02 15:37:48 INFO     epoch complete!
2024-09-02 15:37:48 INFO     evaluating now!
2024-09-02 15:37:48 INFO     Epoch [30/200] train_loss: 4.1295, val_loss: 5.0543, lr: 0.003000, 5.08s
2024-09-02 15:37:53 INFO     epoch complete!
2024-09-02 15:37:53 INFO     evaluating now!
2024-09-02 15:37:54 INFO     Epoch [31/200] train_loss: 4.0428, val_loss: 5.0087, lr: 0.003000, 5.17s
2024-09-02 15:37:58 INFO     epoch complete!
2024-09-02 15:37:58 INFO     evaluating now!
2024-09-02 15:37:59 INFO     Epoch [32/200] train_loss: 4.0410, val_loss: 5.1574, lr: 0.003000, 5.08s
2024-09-02 15:38:03 INFO     epoch complete!
2024-09-02 15:38:03 INFO     evaluating now!
2024-09-02 15:38:04 INFO     Epoch [33/200] train_loss: 3.9929, val_loss: 5.0505, lr: 0.003000, 5.08s
2024-09-02 15:38:09 INFO     epoch complete!
2024-09-02 15:38:09 INFO     evaluating now!
2024-09-02 15:38:09 INFO     Epoch [34/200] train_loss: 4.0345, val_loss: 5.0335, lr: 0.003000, 5.13s
2024-09-02 15:38:14 INFO     epoch complete!
2024-09-02 15:38:14 INFO     evaluating now!
2024-09-02 15:38:14 INFO     Epoch [35/200] train_loss: 3.9911, val_loss: 5.0874, lr: 0.003000, 5.09s
2024-09-02 15:38:19 INFO     epoch complete!
2024-09-02 15:38:19 INFO     evaluating now!
2024-09-02 15:38:19 INFO     Epoch [36/200] train_loss: 3.8997, val_loss: 5.2161, lr: 0.003000, 5.12s
2024-09-02 15:38:24 INFO     epoch complete!
2024-09-02 15:38:24 INFO     evaluating now!
2024-09-02 15:38:24 INFO     Epoch [37/200] train_loss: 3.8757, val_loss: 5.0381, lr: 0.003000, 5.14s
2024-09-02 15:38:29 INFO     epoch complete!
2024-09-02 15:38:29 INFO     evaluating now!
2024-09-02 15:38:29 INFO     Epoch [38/200] train_loss: 3.8594, val_loss: 5.0532, lr: 0.003000, 5.09s
2024-09-02 15:38:34 INFO     epoch complete!
2024-09-02 15:38:34 INFO     evaluating now!
2024-09-02 15:38:34 INFO     Epoch [39/200] train_loss: 3.7962, val_loss: 5.0450, lr: 0.003000, 5.09s
2024-09-02 15:38:39 INFO     epoch complete!
2024-09-02 15:38:39 INFO     evaluating now!
2024-09-02 15:38:40 INFO     Epoch [40/200] train_loss: 3.8158, val_loss: 4.9498, lr: 0.003000, 5.14s
2024-09-02 15:38:44 INFO     epoch complete!
2024-09-02 15:38:44 INFO     evaluating now!
2024-09-02 15:38:45 INFO     Epoch [41/200] train_loss: 3.8611, val_loss: 5.1439, lr: 0.003000, 5.08s
2024-09-02 15:38:49 INFO     epoch complete!
2024-09-02 15:38:49 INFO     evaluating now!
2024-09-02 15:38:50 INFO     Epoch [42/200] train_loss: 3.8539, val_loss: 5.0820, lr: 0.003000, 5.08s
2024-09-02 15:38:55 INFO     epoch complete!
2024-09-02 15:38:55 INFO     evaluating now!
2024-09-02 15:38:55 INFO     Epoch [43/200] train_loss: 3.7212, val_loss: 5.0034, lr: 0.003000, 5.16s
2024-09-02 15:38:55 WARNING  Early stopping at epoch: 43
2024-09-02 15:38:55 INFO     Trained totally 44 epochs, average train time is 4.835s, average eval time is 0.310s
2024-09-02 15:38:55 INFO     Loaded model at 28
2024-09-02 15:38:55 INFO     Saved model at ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 15:38:55 INFO     Start evaluating ...
2024-09-02 15:38:56 INFO     Note that you select the single mode to evaluate!
2024-09-02 15:38:56 INFO     Evaluate result is saved at ./libcity/cache/70/evaluate_cache\2024_09_02_15_38_56_AGCRN_CHITaxi20190406.csv
2024-09-02 15:38:56 INFO     
         MAE       RMSE
1   2.395737   7.849781
2   2.460206   7.980369
3   2.568288   8.762819
4   2.684705   9.440886
5   2.819327  10.001618
6   2.892419  10.404131
7   2.986529  10.760711
8   3.065000  11.293801
9   3.162506  11.752190
10  3.288866  12.382270
11  3.439943  13.040342
12  3.581790  13.781668
2024-09-02 15:38:56 INFO     ----------------------------------------------------------------------------
2024-09-02 15:38:56 INFO     # 3, Kownledge Graph Embedding: ComplEx, Experiment ids: 73
2024-09-02 15:38:56 INFO     ----------------------------------------------------------------------------
2024-09-02 15:38:56 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=70
2024-09-02 15:38:56 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 70, 'embedding_model': 'ComplEx', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 15:38:56 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 15:38:56 INFO     set_weight_link_or_dist: dist
2024-09-02 15:38:56 INFO     init_weight_inf_or_zero: inf
2024-09-02 15:38:56 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 15:38:56 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 15:38:56 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 15:38:56 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 15:38:58 INFO     Dataset created
2024-09-02 15:38:58 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 15:38:58 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 15:38:58 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 15:38:58 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 15:38:58 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 15:38:58 INFO     NormalScaler max: 3.0343689918518066
2024-09-02 15:39:00 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 15:39:00 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 15:39:00 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 15:39:00 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:39:00 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 15:39:00 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:39:00 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 15:39:00 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:39:00 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 15:39:00 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:39:00 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 15:39:00 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 15:39:00 INFO     Total parameter numbers: 874010
2024-09-02 15:39:00 INFO     You select `adam` optimizer.
2024-09-02 15:39:00 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 15:39:00 INFO     Start training ...
2024-09-02 15:39:00 INFO     num_batches:48
2024-09-02 15:39:05 INFO     epoch complete!
2024-09-02 15:39:05 INFO     evaluating now!
2024-09-02 15:39:05 INFO     Epoch [0/200] train_loss: 24.8862, val_loss: 17.6357, lr: 0.003000, 5.34s
2024-09-02 15:39:05 INFO     Saved model at 0
2024-09-02 15:39:05 INFO     Val loss decrease from inf to 17.6357, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 15:39:10 INFO     epoch complete!
2024-09-02 15:39:10 INFO     evaluating now!
2024-09-02 15:39:10 INFO     Epoch [1/200] train_loss: 14.5147, val_loss: 13.7988, lr: 0.003000, 5.15s
2024-09-02 15:39:10 INFO     Saved model at 1
2024-09-02 15:39:10 INFO     Val loss decrease from 17.6357 to 13.7988, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 15:39:15 INFO     epoch complete!
2024-09-02 15:39:15 INFO     evaluating now!
2024-09-02 15:39:15 INFO     Epoch [2/200] train_loss: 11.2117, val_loss: 10.4268, lr: 0.003000, 5.08s
2024-09-02 15:39:15 INFO     Saved model at 2
2024-09-02 15:39:15 INFO     Val loss decrease from 13.7988 to 10.4268, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 15:39:20 INFO     epoch complete!
2024-09-02 15:39:20 INFO     evaluating now!
2024-09-02 15:39:20 INFO     Epoch [3/200] train_loss: 8.9812, val_loss: 8.4773, lr: 0.003000, 5.09s
2024-09-02 15:39:20 INFO     Saved model at 3
2024-09-02 15:39:20 INFO     Val loss decrease from 10.4268 to 8.4773, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 15:39:25 INFO     epoch complete!
2024-09-02 15:39:25 INFO     evaluating now!
2024-09-02 15:39:25 INFO     Epoch [4/200] train_loss: 7.6722, val_loss: 7.3831, lr: 0.003000, 5.15s
2024-09-02 15:39:26 INFO     Saved model at 4
2024-09-02 15:39:26 INFO     Val loss decrease from 8.4773 to 7.3831, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 15:39:30 INFO     epoch complete!
2024-09-02 15:39:30 INFO     evaluating now!
2024-09-02 15:39:31 INFO     Epoch [5/200] train_loss: 6.9939, val_loss: 6.9001, lr: 0.003000, 5.11s
2024-09-02 15:39:31 INFO     Saved model at 5
2024-09-02 15:39:31 INFO     Val loss decrease from 7.3831 to 6.9001, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 15:39:35 INFO     epoch complete!
2024-09-02 15:39:35 INFO     evaluating now!
2024-09-02 15:39:36 INFO     Epoch [6/200] train_loss: 6.5727, val_loss: 6.4092, lr: 0.003000, 5.09s
2024-09-02 15:39:36 INFO     Saved model at 6
2024-09-02 15:39:36 INFO     Val loss decrease from 6.9001 to 6.4092, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 15:39:41 INFO     epoch complete!
2024-09-02 15:39:41 INFO     evaluating now!
2024-09-02 15:39:41 INFO     Epoch [7/200] train_loss: 6.1641, val_loss: 6.1783, lr: 0.003000, 5.13s
2024-09-02 15:39:41 INFO     Saved model at 7
2024-09-02 15:39:41 INFO     Val loss decrease from 6.4092 to 6.1783, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-02 15:39:46 INFO     epoch complete!
2024-09-02 15:39:46 INFO     evaluating now!
2024-09-02 15:39:46 INFO     Epoch [8/200] train_loss: 5.9341, val_loss: 6.1892, lr: 0.003000, 5.08s
2024-09-02 15:39:51 INFO     epoch complete!
2024-09-02 15:39:51 INFO     evaluating now!
2024-09-02 15:39:51 INFO     Epoch [9/200] train_loss: 5.7453, val_loss: 6.0623, lr: 0.003000, 5.07s
2024-09-02 15:39:51 INFO     Saved model at 9
2024-09-02 15:39:51 INFO     Val loss decrease from 6.1783 to 6.0623, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 15:39:56 INFO     epoch complete!
2024-09-02 15:39:56 INFO     evaluating now!
2024-09-02 15:39:56 INFO     Epoch [10/200] train_loss: 5.5900, val_loss: 5.7894, lr: 0.003000, 5.13s
2024-09-02 15:39:56 INFO     Saved model at 10
2024-09-02 15:39:56 INFO     Val loss decrease from 6.0623 to 5.7894, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 15:40:01 INFO     epoch complete!
2024-09-02 15:40:01 INFO     evaluating now!
2024-09-02 15:40:01 INFO     Epoch [11/200] train_loss: 5.3874, val_loss: 5.8981, lr: 0.003000, 5.14s
2024-09-02 15:40:06 INFO     epoch complete!
2024-09-02 15:40:06 INFO     evaluating now!
2024-09-02 15:40:06 INFO     Epoch [12/200] train_loss: 5.2831, val_loss: 5.6027, lr: 0.003000, 5.10s
2024-09-02 15:40:06 INFO     Saved model at 12
2024-09-02 15:40:06 INFO     Val loss decrease from 5.7894 to 5.6027, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-02 15:40:11 INFO     epoch complete!
2024-09-02 15:40:11 INFO     evaluating now!
2024-09-02 15:40:12 INFO     Epoch [13/200] train_loss: 5.2001, val_loss: 5.5895, lr: 0.003000, 5.13s
2024-09-02 15:40:12 INFO     Saved model at 13
2024-09-02 15:40:12 INFO     Val loss decrease from 5.6027 to 5.5895, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 15:40:16 INFO     epoch complete!
2024-09-02 15:40:16 INFO     evaluating now!
2024-09-02 15:40:17 INFO     Epoch [14/200] train_loss: 5.1082, val_loss: 5.5627, lr: 0.003000, 5.09s
2024-09-02 15:40:17 INFO     Saved model at 14
2024-09-02 15:40:17 INFO     Val loss decrease from 5.5895 to 5.5627, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-02 15:40:21 INFO     epoch complete!
2024-09-02 15:40:21 INFO     evaluating now!
2024-09-02 15:40:22 INFO     Epoch [15/200] train_loss: 4.9392, val_loss: 5.2704, lr: 0.003000, 5.10s
2024-09-02 15:40:22 INFO     Saved model at 15
2024-09-02 15:40:22 INFO     Val loss decrease from 5.5627 to 5.2704, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 15:40:27 INFO     epoch complete!
2024-09-02 15:40:27 INFO     evaluating now!
2024-09-02 15:40:27 INFO     Epoch [16/200] train_loss: 4.8588, val_loss: 5.2533, lr: 0.003000, 5.12s
2024-09-02 15:40:27 INFO     Saved model at 16
2024-09-02 15:40:27 INFO     Val loss decrease from 5.2704 to 5.2533, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 15:40:32 INFO     epoch complete!
2024-09-02 15:40:32 INFO     evaluating now!
2024-09-02 15:40:32 INFO     Epoch [17/200] train_loss: 4.8084, val_loss: 5.3144, lr: 0.003000, 5.08s
2024-09-02 15:40:37 INFO     epoch complete!
2024-09-02 15:40:37 INFO     evaluating now!
2024-09-02 15:40:37 INFO     Epoch [18/200] train_loss: 4.7181, val_loss: 5.4431, lr: 0.003000, 5.11s
2024-09-02 15:40:42 INFO     epoch complete!
2024-09-02 15:40:42 INFO     evaluating now!
2024-09-02 15:40:42 INFO     Epoch [19/200] train_loss: 4.6864, val_loss: 5.3340, lr: 0.003000, 5.14s
2024-09-02 15:40:47 INFO     epoch complete!
2024-09-02 15:40:47 INFO     evaluating now!
2024-09-02 15:40:47 INFO     Epoch [20/200] train_loss: 4.5719, val_loss: 5.2874, lr: 0.003000, 5.08s
2024-09-02 15:40:52 INFO     epoch complete!
2024-09-02 15:40:52 INFO     evaluating now!
2024-09-02 15:40:52 INFO     Epoch [21/200] train_loss: 4.6426, val_loss: 5.2472, lr: 0.003000, 5.14s
2024-09-02 15:40:53 INFO     Saved model at 21
2024-09-02 15:40:53 INFO     Val loss decrease from 5.2533 to 5.2472, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-02 15:40:57 INFO     epoch complete!
2024-09-02 15:40:57 INFO     evaluating now!
2024-09-02 15:40:58 INFO     Epoch [22/200] train_loss: 4.5208, val_loss: 5.1799, lr: 0.003000, 5.13s
2024-09-02 15:40:58 INFO     Saved model at 22
2024-09-02 15:40:58 INFO     Val loss decrease from 5.2472 to 5.1799, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-02 15:41:02 INFO     epoch complete!
2024-09-02 15:41:02 INFO     evaluating now!
2024-09-02 15:41:03 INFO     Epoch [23/200] train_loss: 4.4381, val_loss: 5.1454, lr: 0.003000, 5.09s
2024-09-02 15:41:03 INFO     Saved model at 23
2024-09-02 15:41:03 INFO     Val loss decrease from 5.1799 to 5.1454, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-02 15:41:08 INFO     epoch complete!
2024-09-02 15:41:08 INFO     evaluating now!
2024-09-02 15:41:08 INFO     Epoch [24/200] train_loss: 4.4038, val_loss: 5.2102, lr: 0.003000, 5.13s
2024-09-02 15:41:13 INFO     epoch complete!
2024-09-02 15:41:13 INFO     evaluating now!
2024-09-02 15:41:13 INFO     Epoch [25/200] train_loss: 4.3686, val_loss: 5.3665, lr: 0.003000, 5.10s
2024-09-02 15:41:18 INFO     epoch complete!
2024-09-02 15:41:18 INFO     evaluating now!
2024-09-02 15:41:18 INFO     Epoch [26/200] train_loss: 4.2756, val_loss: 5.1511, lr: 0.003000, 5.11s
2024-09-02 15:41:23 INFO     epoch complete!
2024-09-02 15:41:23 INFO     evaluating now!
2024-09-02 15:41:23 INFO     Epoch [27/200] train_loss: 4.2622, val_loss: 5.2984, lr: 0.003000, 5.17s
2024-09-02 15:41:28 INFO     epoch complete!
2024-09-02 15:41:28 INFO     evaluating now!
2024-09-02 15:41:28 INFO     Epoch [28/200] train_loss: 4.2303, val_loss: 5.1569, lr: 0.003000, 5.11s
2024-09-02 15:41:33 INFO     epoch complete!
2024-09-02 15:41:33 INFO     evaluating now!
2024-09-02 15:41:33 INFO     Epoch [29/200] train_loss: 4.2016, val_loss: 5.1220, lr: 0.003000, 5.09s
2024-09-02 15:41:33 INFO     Saved model at 29
2024-09-02 15:41:33 INFO     Val loss decrease from 5.1454 to 5.1220, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-02 15:41:38 INFO     epoch complete!
2024-09-02 15:41:38 INFO     evaluating now!
2024-09-02 15:41:39 INFO     Epoch [30/200] train_loss: 4.1529, val_loss: 5.1153, lr: 0.003000, 5.17s
2024-09-02 15:41:39 INFO     Saved model at 30
2024-09-02 15:41:39 INFO     Val loss decrease from 5.1220 to 5.1153, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-09-02 15:41:43 INFO     epoch complete!
2024-09-02 15:41:43 INFO     evaluating now!
2024-09-02 15:41:44 INFO     Epoch [31/200] train_loss: 4.1323, val_loss: 5.2686, lr: 0.003000, 5.10s
2024-09-02 15:41:49 INFO     epoch complete!
2024-09-02 15:41:49 INFO     evaluating now!
2024-09-02 15:41:49 INFO     Epoch [32/200] train_loss: 4.0802, val_loss: 5.1564, lr: 0.003000, 5.09s
2024-09-02 15:41:54 INFO     epoch complete!
2024-09-02 15:41:54 INFO     evaluating now!
2024-09-02 15:41:54 INFO     Epoch [33/200] train_loss: 4.0711, val_loss: 5.3243, lr: 0.003000, 5.23s
2024-09-02 15:41:59 INFO     epoch complete!
2024-09-02 15:41:59 INFO     evaluating now!
2024-09-02 15:41:59 INFO     Epoch [34/200] train_loss: 4.0469, val_loss: 5.0468, lr: 0.003000, 5.11s
2024-09-02 15:41:59 INFO     Saved model at 34
2024-09-02 15:41:59 INFO     Val loss decrease from 5.1153 to 5.0468, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-09-02 15:42:04 INFO     epoch complete!
2024-09-02 15:42:04 INFO     evaluating now!
2024-09-02 15:42:04 INFO     Epoch [35/200] train_loss: 3.9468, val_loss: 5.2222, lr: 0.003000, 5.11s
2024-09-02 15:42:09 INFO     epoch complete!
2024-09-02 15:42:09 INFO     evaluating now!
2024-09-02 15:42:09 INFO     Epoch [36/200] train_loss: 3.9581, val_loss: 5.2497, lr: 0.003000, 5.15s
2024-09-02 15:42:14 INFO     epoch complete!
2024-09-02 15:42:14 INFO     evaluating now!
2024-09-02 15:42:15 INFO     Epoch [37/200] train_loss: 3.9494, val_loss: 5.2177, lr: 0.003000, 5.12s
2024-09-02 15:42:19 INFO     epoch complete!
2024-09-02 15:42:19 INFO     evaluating now!
2024-09-02 15:42:20 INFO     Epoch [38/200] train_loss: 3.8925, val_loss: 5.1569, lr: 0.003000, 5.11s
2024-09-02 15:42:25 INFO     epoch complete!
2024-09-02 15:42:25 INFO     evaluating now!
2024-09-02 15:42:25 INFO     Epoch [39/200] train_loss: 3.8560, val_loss: 5.1683, lr: 0.003000, 5.15s
2024-09-02 15:42:30 INFO     epoch complete!
2024-09-02 15:42:30 INFO     evaluating now!
2024-09-02 15:42:30 INFO     Epoch [40/200] train_loss: 3.8384, val_loss: 5.1750, lr: 0.003000, 5.10s
2024-09-02 15:42:35 INFO     epoch complete!
2024-09-02 15:42:35 INFO     evaluating now!
2024-09-02 15:42:35 INFO     Epoch [41/200] train_loss: 3.8415, val_loss: 5.0576, lr: 0.003000, 5.16s
2024-09-02 15:42:40 INFO     epoch complete!
2024-09-02 15:42:40 INFO     evaluating now!
2024-09-02 15:42:40 INFO     Epoch [42/200] train_loss: 3.8185, val_loss: 5.0488, lr: 0.003000, 5.16s
2024-09-02 15:42:45 INFO     epoch complete!
2024-09-02 15:42:45 INFO     evaluating now!
2024-09-02 15:42:45 INFO     Epoch [43/200] train_loss: 3.7410, val_loss: 5.0907, lr: 0.003000, 5.09s
2024-09-02 15:42:50 INFO     epoch complete!
2024-09-02 15:42:50 INFO     evaluating now!
2024-09-02 15:42:50 INFO     Epoch [44/200] train_loss: 3.7318, val_loss: 5.1186, lr: 0.003000, 5.11s
2024-09-02 15:42:55 INFO     epoch complete!
2024-09-02 15:42:55 INFO     evaluating now!
2024-09-02 15:42:56 INFO     Epoch [45/200] train_loss: 3.7097, val_loss: 5.0689, lr: 0.003000, 5.17s
2024-09-02 15:43:00 INFO     epoch complete!
2024-09-02 15:43:00 INFO     evaluating now!
2024-09-02 15:43:01 INFO     Epoch [46/200] train_loss: 3.7163, val_loss: 5.0905, lr: 0.003000, 5.09s
2024-09-02 15:43:06 INFO     epoch complete!
2024-09-02 15:43:06 INFO     evaluating now!
2024-09-02 15:43:06 INFO     Epoch [47/200] train_loss: 3.6510, val_loss: 5.0391, lr: 0.003000, 5.10s
2024-09-02 15:43:06 INFO     Saved model at 47
2024-09-02 15:43:06 INFO     Val loss decrease from 5.0468 to 5.0391, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch47.tar
2024-09-02 15:43:11 INFO     epoch complete!
2024-09-02 15:43:11 INFO     evaluating now!
2024-09-02 15:43:11 INFO     Epoch [48/200] train_loss: 3.6069, val_loss: 5.1516, lr: 0.003000, 5.17s
2024-09-02 15:43:16 INFO     epoch complete!
2024-09-02 15:43:16 INFO     evaluating now!
2024-09-02 15:43:16 INFO     Epoch [49/200] train_loss: 3.6755, val_loss: 4.9897, lr: 0.003000, 5.10s
2024-09-02 15:43:16 INFO     Saved model at 49
2024-09-02 15:43:16 INFO     Val loss decrease from 5.0391 to 4.9897, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-09-02 15:43:21 INFO     epoch complete!
2024-09-02 15:43:21 INFO     evaluating now!
2024-09-02 15:43:21 INFO     Epoch [50/200] train_loss: 3.6433, val_loss: 5.1522, lr: 0.003000, 5.09s
2024-09-02 15:43:26 INFO     epoch complete!
2024-09-02 15:43:26 INFO     evaluating now!
2024-09-02 15:43:26 INFO     Epoch [51/200] train_loss: 3.6535, val_loss: 5.1592, lr: 0.003000, 5.12s
2024-09-02 15:43:31 INFO     epoch complete!
2024-09-02 15:43:31 INFO     evaluating now!
2024-09-02 15:43:31 INFO     Epoch [52/200] train_loss: 3.5731, val_loss: 5.1769, lr: 0.003000, 5.09s
2024-09-02 15:43:36 INFO     epoch complete!
2024-09-02 15:43:36 INFO     evaluating now!
2024-09-02 15:43:37 INFO     Epoch [53/200] train_loss: 3.5281, val_loss: 5.0548, lr: 0.003000, 5.09s
2024-09-02 15:43:41 INFO     epoch complete!
2024-09-02 15:43:41 INFO     evaluating now!
2024-09-02 15:43:42 INFO     Epoch [54/200] train_loss: 3.5425, val_loss: 5.0633, lr: 0.003000, 5.16s
2024-09-02 15:43:46 INFO     epoch complete!
2024-09-02 15:43:46 INFO     evaluating now!
2024-09-02 15:43:47 INFO     Epoch [55/200] train_loss: 3.5616, val_loss: 5.1119, lr: 0.003000, 5.09s
2024-09-02 15:43:52 INFO     epoch complete!
2024-09-02 15:43:52 INFO     evaluating now!
2024-09-02 15:43:52 INFO     Epoch [56/200] train_loss: 3.5061, val_loss: 5.0598, lr: 0.003000, 5.08s
2024-09-02 15:43:57 INFO     epoch complete!
2024-09-02 15:43:57 INFO     evaluating now!
2024-09-02 15:43:57 INFO     Epoch [57/200] train_loss: 3.4841, val_loss: 4.9221, lr: 0.003000, 5.14s
2024-09-02 15:43:57 INFO     Saved model at 57
2024-09-02 15:43:57 INFO     Val loss decrease from 4.9897 to 4.9221, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch57.tar
2024-09-02 15:44:02 INFO     epoch complete!
2024-09-02 15:44:02 INFO     evaluating now!
2024-09-02 15:44:02 INFO     Epoch [58/200] train_loss: 3.5104, val_loss: 5.0808, lr: 0.003000, 5.09s
2024-09-02 15:44:07 INFO     epoch complete!
2024-09-02 15:44:07 INFO     evaluating now!
2024-09-02 15:44:07 INFO     Epoch [59/200] train_loss: 3.4773, val_loss: 5.0421, lr: 0.003000, 5.09s
2024-09-02 15:44:12 INFO     epoch complete!
2024-09-02 15:44:12 INFO     evaluating now!
2024-09-02 15:44:12 INFO     Epoch [60/200] train_loss: 3.4784, val_loss: 5.0687, lr: 0.003000, 5.13s
2024-09-02 15:44:17 INFO     epoch complete!
2024-09-02 15:44:17 INFO     evaluating now!
2024-09-02 15:44:17 INFO     Epoch [61/200] train_loss: 3.4719, val_loss: 4.9516, lr: 0.003000, 5.09s
2024-09-02 15:44:22 INFO     epoch complete!
2024-09-02 15:44:22 INFO     evaluating now!
2024-09-02 15:44:23 INFO     Epoch [62/200] train_loss: 3.4775, val_loss: 5.0846, lr: 0.003000, 5.09s
2024-09-02 15:44:27 INFO     epoch complete!
2024-09-02 15:44:27 INFO     evaluating now!
2024-09-02 15:44:28 INFO     Epoch [63/200] train_loss: 3.4900, val_loss: 5.0542, lr: 0.003000, 5.12s
2024-09-02 15:44:32 INFO     epoch complete!
2024-09-02 15:44:32 INFO     evaluating now!
2024-09-02 15:44:33 INFO     Epoch [64/200] train_loss: 3.4241, val_loss: 5.0657, lr: 0.003000, 5.09s
2024-09-02 15:44:38 INFO     epoch complete!
2024-09-02 15:44:38 INFO     evaluating now!
2024-09-02 15:44:38 INFO     Epoch [65/200] train_loss: 3.4395, val_loss: 5.0213, lr: 0.003000, 5.18s
2024-09-02 15:44:43 INFO     epoch complete!
2024-09-02 15:44:43 INFO     evaluating now!
2024-09-02 15:44:43 INFO     Epoch [66/200] train_loss: 3.4060, val_loss: 5.0801, lr: 0.003000, 5.11s
2024-09-02 15:44:48 INFO     epoch complete!
2024-09-02 15:44:48 INFO     evaluating now!
2024-09-02 15:44:48 INFO     Epoch [67/200] train_loss: 3.3859, val_loss: 4.9769, lr: 0.003000, 5.10s
2024-09-02 15:44:53 INFO     epoch complete!
2024-09-02 15:44:53 INFO     evaluating now!
2024-09-02 15:44:53 INFO     Epoch [68/200] train_loss: 3.3560, val_loss: 5.0203, lr: 0.003000, 5.17s
2024-09-02 15:44:58 INFO     epoch complete!
2024-09-02 15:44:58 INFO     evaluating now!
2024-09-02 15:44:58 INFO     Epoch [69/200] train_loss: 3.3342, val_loss: 5.0997, lr: 0.003000, 5.10s
2024-09-02 15:45:03 INFO     epoch complete!
2024-09-02 15:45:03 INFO     evaluating now!
2024-09-02 15:45:03 INFO     Epoch [70/200] train_loss: 3.3428, val_loss: 5.0376, lr: 0.003000, 5.10s
2024-09-02 15:45:08 INFO     epoch complete!
2024-09-02 15:45:08 INFO     evaluating now!
2024-09-02 15:45:09 INFO     Epoch [71/200] train_loss: 3.3283, val_loss: 5.0885, lr: 0.003000, 5.14s
2024-09-02 15:45:13 INFO     epoch complete!
2024-09-02 15:45:13 INFO     evaluating now!
2024-09-02 15:45:14 INFO     Epoch [72/200] train_loss: 3.3057, val_loss: 5.0118, lr: 0.003000, 5.09s
2024-09-02 15:45:14 WARNING  Early stopping at epoch: 72
2024-09-02 15:45:14 INFO     Trained totally 73 epochs, average train time is 4.810s, average eval time is 0.310s
2024-09-02 15:45:14 INFO     Loaded model at 57
2024-09-02 15:45:14 INFO     Saved model at ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 15:45:14 INFO     Start evaluating ...
2024-09-02 15:45:15 INFO     Note that you select the single mode to evaluate!
2024-09-02 15:45:15 INFO     Evaluate result is saved at ./libcity/cache/70/evaluate_cache\2024_09_02_15_45_15_AGCRN_CHITaxi20190406.csv
2024-09-02 15:45:15 INFO     
         MAE       RMSE
1   2.374729   7.049155
2   2.433782   7.675719
3   2.635047   8.771739
4   2.812361   9.695663
5   2.908476  10.522235
6   3.032722  11.449414
7   3.171265  12.418072
8   3.231204  12.952462
9   3.284702  13.225967
10  3.318583  13.177562
11  3.397110  13.462541
12  3.548103  13.898153
2024-09-02 15:45:15 INFO     ----------------------------------------------------------------------------
2024-09-02 15:45:15 INFO     # 4, Kownledge Graph Embedding: ComplEx, Experiment ids: 74
2024-09-02 15:45:15 INFO     ----------------------------------------------------------------------------
2024-09-02 15:45:15 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=70
2024-09-02 15:45:15 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 70, 'embedding_model': 'ComplEx', 'load_external': True, 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-02 15:45:15 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-02 15:45:15 INFO     set_weight_link_or_dist: dist
2024-09-02 15:45:15 INFO     init_weight_inf_or_zero: inf
2024-09-02 15:45:15 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-02 15:45:15 INFO     Start Calculate the weight by Gauss kernel!
2024-09-02 15:45:15 INFO     Loading file CHITaxi20190406.dyna
2024-09-02 15:45:15 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-02 15:45:17 INFO     Dataset created
2024-09-02 15:45:17 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-02 15:45:17 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-02 15:45:17 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-02 15:45:17 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-02 15:45:17 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-02 15:45:17 INFO     NormalScaler max: 3.0343689918518066
2024-09-02 15:45:19 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-02 15:45:19 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-02 15:45:19 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-02 15:45:19 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:45:19 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-02 15:45:19 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:45:19 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-02 15:45:19 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-02 15:45:19 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-02 15:45:19 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-02 15:45:19 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-02 15:45:19 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-02 15:45:19 INFO     Total parameter numbers: 874010
2024-09-02 15:45:19 INFO     You select `adam` optimizer.
2024-09-02 15:45:19 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-02 15:45:19 INFO     Start training ...
2024-09-02 15:45:19 INFO     num_batches:48
2024-09-02 15:45:24 INFO     epoch complete!
2024-09-02 15:45:24 INFO     evaluating now!
2024-09-02 15:45:24 INFO     Epoch [0/200] train_loss: 24.3412, val_loss: 17.8231, lr: 0.003000, 5.39s
2024-09-02 15:45:24 INFO     Saved model at 0
2024-09-02 15:45:24 INFO     Val loss decrease from inf to 17.8231, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-02 15:45:29 INFO     epoch complete!
2024-09-02 15:45:29 INFO     evaluating now!
2024-09-02 15:45:30 INFO     Epoch [1/200] train_loss: 14.5705, val_loss: 13.8507, lr: 0.003000, 5.25s
2024-09-02 15:45:30 INFO     Saved model at 1
2024-09-02 15:45:30 INFO     Val loss decrease from 17.8231 to 13.8507, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-02 15:45:34 INFO     epoch complete!
2024-09-02 15:45:34 INFO     evaluating now!
2024-09-02 15:45:35 INFO     Epoch [2/200] train_loss: 11.3512, val_loss: 10.5080, lr: 0.003000, 5.17s
2024-09-02 15:45:35 INFO     Saved model at 2
2024-09-02 15:45:35 INFO     Val loss decrease from 13.8507 to 10.5080, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-02 15:45:40 INFO     epoch complete!
2024-09-02 15:45:40 INFO     evaluating now!
2024-09-02 15:45:40 INFO     Epoch [3/200] train_loss: 9.1869, val_loss: 8.7174, lr: 0.003000, 5.44s
2024-09-02 15:45:40 INFO     Saved model at 3
2024-09-02 15:45:40 INFO     Val loss decrease from 10.5080 to 8.7174, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-02 15:45:45 INFO     epoch complete!
2024-09-02 15:45:45 INFO     evaluating now!
2024-09-02 15:45:46 INFO     Epoch [4/200] train_loss: 7.8886, val_loss: 7.4883, lr: 0.003000, 5.65s
2024-09-02 15:45:46 INFO     Saved model at 4
2024-09-02 15:45:46 INFO     Val loss decrease from 8.7174 to 7.4883, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-02 15:45:51 INFO     epoch complete!
2024-09-02 15:45:51 INFO     evaluating now!
2024-09-02 15:45:51 INFO     Epoch [5/200] train_loss: 7.2034, val_loss: 7.2307, lr: 0.003000, 5.62s
2024-09-02 15:45:52 INFO     Saved model at 5
2024-09-02 15:45:52 INFO     Val loss decrease from 7.4883 to 7.2307, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-02 15:45:56 INFO     epoch complete!
2024-09-02 15:45:56 INFO     evaluating now!
2024-09-02 15:45:57 INFO     Epoch [6/200] train_loss: 6.6285, val_loss: 6.5237, lr: 0.003000, 5.22s
2024-09-02 15:45:57 INFO     Saved model at 6
2024-09-02 15:45:57 INFO     Val loss decrease from 7.2307 to 6.5237, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-02 15:46:02 INFO     epoch complete!
2024-09-02 15:46:02 INFO     evaluating now!
2024-09-02 15:46:02 INFO     Epoch [7/200] train_loss: 6.3229, val_loss: 6.5380, lr: 0.003000, 5.08s
2024-09-02 15:46:07 INFO     epoch complete!
2024-09-02 15:46:07 INFO     evaluating now!
2024-09-02 15:46:08 INFO     Epoch [8/200] train_loss: 6.0686, val_loss: 6.2045, lr: 0.003000, 5.75s
2024-09-02 15:46:08 INFO     Saved model at 8
2024-09-02 15:46:08 INFO     Val loss decrease from 6.5237 to 6.2045, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-02 15:46:12 INFO     epoch complete!
2024-09-02 15:46:12 INFO     evaluating now!
2024-09-02 15:46:13 INFO     Epoch [9/200] train_loss: 5.8090, val_loss: 5.9858, lr: 0.003000, 5.17s
2024-09-02 15:46:13 INFO     Saved model at 9
2024-09-02 15:46:13 INFO     Val loss decrease from 6.2045 to 5.9858, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-02 15:46:18 INFO     epoch complete!
2024-09-02 15:46:18 INFO     evaluating now!
2024-09-02 15:46:18 INFO     Epoch [10/200] train_loss: 5.6712, val_loss: 5.8842, lr: 0.003000, 5.19s
2024-09-02 15:46:18 INFO     Saved model at 10
2024-09-02 15:46:18 INFO     Val loss decrease from 5.9858 to 5.8842, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-02 15:46:23 INFO     epoch complete!
2024-09-02 15:46:23 INFO     evaluating now!
2024-09-02 15:46:23 INFO     Epoch [11/200] train_loss: 5.5698, val_loss: 5.8132, lr: 0.003000, 5.12s
2024-09-02 15:46:23 INFO     Saved model at 11
2024-09-02 15:46:23 INFO     Val loss decrease from 5.8842 to 5.8132, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-02 15:46:28 INFO     epoch complete!
2024-09-02 15:46:28 INFO     evaluating now!
2024-09-02 15:46:28 INFO     Epoch [12/200] train_loss: 5.3845, val_loss: 5.8294, lr: 0.003000, 5.10s
2024-09-02 15:46:33 INFO     epoch complete!
2024-09-02 15:46:33 INFO     evaluating now!
2024-09-02 15:46:33 INFO     Epoch [13/200] train_loss: 5.3374, val_loss: 5.7433, lr: 0.003000, 5.22s
2024-09-02 15:46:33 INFO     Saved model at 13
2024-09-02 15:46:33 INFO     Val loss decrease from 5.8132 to 5.7433, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-02 15:46:38 INFO     epoch complete!
2024-09-02 15:46:38 INFO     evaluating now!
2024-09-02 15:46:39 INFO     Epoch [14/200] train_loss: 5.1873, val_loss: 5.6758, lr: 0.003000, 5.33s
2024-09-02 15:46:39 INFO     Saved model at 14
2024-09-02 15:46:39 INFO     Val loss decrease from 5.7433 to 5.6758, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-02 15:46:44 INFO     epoch complete!
2024-09-02 15:46:44 INFO     evaluating now!
2024-09-02 15:46:44 INFO     Epoch [15/200] train_loss: 5.1012, val_loss: 5.6102, lr: 0.003000, 5.30s
2024-09-02 15:46:44 INFO     Saved model at 15
2024-09-02 15:46:44 INFO     Val loss decrease from 5.6758 to 5.6102, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-02 15:46:49 INFO     epoch complete!
2024-09-02 15:46:49 INFO     evaluating now!
2024-09-02 15:46:49 INFO     Epoch [16/200] train_loss: 4.9919, val_loss: 5.4393, lr: 0.003000, 5.31s
2024-09-02 15:46:49 INFO     Saved model at 16
2024-09-02 15:46:49 INFO     Val loss decrease from 5.6102 to 5.4393, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-02 15:46:54 INFO     epoch complete!
2024-09-02 15:46:54 INFO     evaluating now!
2024-09-02 15:46:55 INFO     Epoch [17/200] train_loss: 4.9388, val_loss: 5.4653, lr: 0.003000, 5.24s
2024-09-02 15:47:00 INFO     epoch complete!
2024-09-02 15:47:00 INFO     evaluating now!
2024-09-02 15:47:00 INFO     Epoch [18/200] train_loss: 4.9082, val_loss: 5.3441, lr: 0.003000, 5.48s
2024-09-02 15:47:00 INFO     Saved model at 18
2024-09-02 15:47:00 INFO     Val loss decrease from 5.4393 to 5.3441, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-02 15:47:05 INFO     epoch complete!
2024-09-02 15:47:05 INFO     evaluating now!
2024-09-02 15:47:06 INFO     Epoch [19/200] train_loss: 4.8058, val_loss: 5.2782, lr: 0.003000, 5.35s
2024-09-02 15:47:06 INFO     Saved model at 19
2024-09-02 15:47:06 INFO     Val loss decrease from 5.3441 to 5.2782, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-02 15:47:10 INFO     epoch complete!
2024-09-02 15:47:10 INFO     evaluating now!
2024-09-02 15:47:11 INFO     Epoch [20/200] train_loss: 4.7324, val_loss: 5.3351, lr: 0.003000, 5.11s
2024-09-02 15:47:16 INFO     epoch complete!
2024-09-02 15:47:16 INFO     evaluating now!
2024-09-02 15:47:16 INFO     Epoch [21/200] train_loss: 4.6517, val_loss: 5.4224, lr: 0.003000, 5.23s
2024-09-02 15:47:21 INFO     epoch complete!
2024-09-02 15:47:21 INFO     evaluating now!
2024-09-02 15:47:21 INFO     Epoch [22/200] train_loss: 4.6401, val_loss: 5.4341, lr: 0.003000, 5.28s
2024-09-02 15:47:26 INFO     epoch complete!
2024-09-02 15:47:26 INFO     evaluating now!
2024-09-02 15:47:26 INFO     Epoch [23/200] train_loss: 4.6542, val_loss: 5.5936, lr: 0.003000, 5.29s
2024-09-02 15:47:31 INFO     epoch complete!
2024-09-02 15:47:31 INFO     evaluating now!
2024-09-02 15:47:32 INFO     Epoch [24/200] train_loss: 4.6225, val_loss: 5.0694, lr: 0.003000, 5.33s
2024-09-02 15:47:32 INFO     Saved model at 24
2024-09-02 15:47:32 INFO     Val loss decrease from 5.2782 to 5.0694, saving to ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-02 15:47:37 INFO     epoch complete!
2024-09-02 15:47:37 INFO     evaluating now!
2024-09-02 15:47:37 INFO     Epoch [25/200] train_loss: 4.4642, val_loss: 5.1636, lr: 0.003000, 5.25s
2024-09-02 15:47:42 INFO     epoch complete!
2024-09-02 15:47:42 INFO     evaluating now!
2024-09-02 15:47:42 INFO     Epoch [26/200] train_loss: 4.4803, val_loss: 5.1668, lr: 0.003000, 5.21s
2024-09-02 15:47:47 INFO     epoch complete!
2024-09-02 15:47:47 INFO     evaluating now!
2024-09-02 15:47:47 INFO     Epoch [27/200] train_loss: 4.3935, val_loss: 5.3186, lr: 0.003000, 5.21s
2024-09-02 15:47:52 INFO     epoch complete!
2024-09-02 15:47:52 INFO     evaluating now!
2024-09-02 15:47:53 INFO     Epoch [28/200] train_loss: 4.4521, val_loss: 5.1170, lr: 0.003000, 5.37s
2024-09-02 15:47:58 INFO     epoch complete!
2024-09-02 15:47:58 INFO     evaluating now!
2024-09-02 15:47:58 INFO     Epoch [29/200] train_loss: 4.3538, val_loss: 5.1991, lr: 0.003000, 5.27s
2024-09-02 15:48:03 INFO     epoch complete!
2024-09-02 15:48:03 INFO     evaluating now!
2024-09-02 15:48:03 INFO     Epoch [30/200] train_loss: 4.3310, val_loss: 5.3871, lr: 0.003000, 5.28s
2024-09-02 15:48:08 INFO     epoch complete!
2024-09-02 15:48:08 INFO     evaluating now!
2024-09-02 15:48:09 INFO     Epoch [31/200] train_loss: 4.2202, val_loss: 5.1311, lr: 0.003000, 5.33s
2024-09-02 15:48:14 INFO     epoch complete!
2024-09-02 15:48:14 INFO     evaluating now!
2024-09-02 15:48:14 INFO     Epoch [32/200] train_loss: 4.2071, val_loss: 5.1295, lr: 0.003000, 5.27s
2024-09-02 15:48:19 INFO     epoch complete!
2024-09-02 15:48:19 INFO     evaluating now!
2024-09-02 15:48:19 INFO     Epoch [33/200] train_loss: 4.2143, val_loss: 5.1925, lr: 0.003000, 5.19s
2024-09-02 15:48:24 INFO     epoch complete!
2024-09-02 15:48:24 INFO     evaluating now!
2024-09-02 15:48:24 INFO     Epoch [34/200] train_loss: 4.1503, val_loss: 5.1129, lr: 0.003000, 5.09s
2024-09-02 15:48:29 INFO     epoch complete!
2024-09-02 15:48:29 INFO     evaluating now!
2024-09-02 15:48:29 INFO     Epoch [35/200] train_loss: 4.1169, val_loss: 5.2040, lr: 0.003000, 5.09s
2024-09-02 15:48:34 INFO     epoch complete!
2024-09-02 15:48:34 INFO     evaluating now!
2024-09-02 15:48:34 INFO     Epoch [36/200] train_loss: 4.1197, val_loss: 5.1696, lr: 0.003000, 5.13s
2024-09-02 15:48:39 INFO     epoch complete!
2024-09-02 15:48:39 INFO     evaluating now!
2024-09-02 15:48:40 INFO     Epoch [37/200] train_loss: 4.1032, val_loss: 5.2778, lr: 0.003000, 5.15s
2024-09-02 15:48:44 INFO     epoch complete!
2024-09-02 15:48:44 INFO     evaluating now!
2024-09-02 15:48:45 INFO     Epoch [38/200] train_loss: 4.0333, val_loss: 5.0970, lr: 0.003000, 5.15s
2024-09-02 15:48:50 INFO     epoch complete!
2024-09-02 15:48:50 INFO     evaluating now!
2024-09-02 15:48:50 INFO     Epoch [39/200] train_loss: 4.0125, val_loss: 5.1414, lr: 0.003000, 5.28s
2024-09-02 15:48:50 WARNING  Early stopping at epoch: 39
2024-09-02 15:48:50 INFO     Trained totally 40 epochs, average train time is 4.951s, average eval time is 0.320s
2024-09-02 15:48:50 INFO     Loaded model at 24
2024-09-02 15:48:50 INFO     Saved model at ./libcity/cache/70/model_cache/AGCRN_CHITaxi20190406.m
2024-09-02 15:48:50 INFO     Start evaluating ...
2024-09-02 15:48:51 INFO     Note that you select the single mode to evaluate!
2024-09-02 15:48:51 INFO     Evaluate result is saved at ./libcity/cache/70/evaluate_cache\2024_09_02_15_48_51_AGCRN_CHITaxi20190406.csv
2024-09-02 15:48:51 INFO     
         MAE       RMSE
1   2.419829   7.393961
2   2.533976   8.030760
3   2.792524   9.325226
4   2.992939  10.353888
5   3.153651  11.190335
6   3.244423  11.911154
7   3.320238  12.557759
8   3.334412  12.979951
9   3.389632  13.134362
10  3.484747  13.322946
11  3.512491  13.629621
12  3.670114  14.303334
2024-09-02 15:48:51 INFO     ----------------------------------------------------------------------------
2024-09-02 15:48:51 INFO     Kownledge Graph Embedding: ComplEx, Experiment ids: [70, 71, 72, 73, 74]
2024-09-02 15:48:51 INFO     ----------------------------------------------------------------------------
2024-09-02 15:48:51 INFO     Average: 
         MAE       RMSE
0   2.401273   7.391861
1   2.481983   7.846153
2   2.658192   8.833811
3   2.824650   9.676805
4   2.977924  10.510621
5   3.066035  11.260463
6   3.151535  11.940474
7   3.212234  12.422928
8   3.269343  12.698405
9   3.347464  12.899986
10  3.402897  13.240603
11  3.547246  13.826119 
2024-09-02 15:48:51 INFO     Standard deviation: 
         MAE      RMSE
0   0.030061  0.307204
1   0.037145  0.174490
2   0.075424  0.256261
3   0.101364  0.361503
4   0.115948  0.412268
5   0.116368  0.521336
6   0.113231  0.651437
7   0.091368  0.619791
8   0.077820  0.528886
9   0.074375  0.337327
10  0.068321  0.277046
11  0.075915  0.326098
2024-09-02 15:48:51 INFO     ----------------------------------------------------------------------------
2024-09-02 15:48:51 INFO     12 steps Average: 
        MAE       RMSE
0  3.028398  11.045686
2024-09-02 15:48:51 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.081445  0.397804
