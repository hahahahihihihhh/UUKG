2024-05-01 23:44:18 INFO     Saving logs in: ./logs/CHITaxi20190406/AGCRN/Scaler/normal/RandomE
2024-05-01 23:44:18 INFO     ----------------------------------------------------------------------------
2024-05-01 23:44:18 INFO     # 0, Kownledge Graph Embedding: RandomE, Experiment ids: 60
2024-05-01 23:44:18 INFO     ----------------------------------------------------------------------------
2024-05-01 23:44:18 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=60
2024-05-01 23:44:18 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 60, 'load_external': True, 'embedding_model': 'RandomE', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 23:44:18 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 23:44:18 INFO     set_weight_link_or_dist: dist
2024-05-01 23:44:18 INFO     init_weight_inf_or_zero: inf
2024-05-01 23:44:18 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 23:44:18 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 23:44:18 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 23:44:18 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 23:44:21 INFO     Dataset created
2024-05-01 23:44:21 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 23:44:21 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 23:44:21 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 23:44:21 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 23:44:21 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 23:44:21 INFO     NormalScaler max: 0.0028067830852947636
2024-05-01 23:44:27 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 23:44:27 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 23:44:27 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 23:44:27 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 23:44:27 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 23:44:27 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 23:44:27 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 23:44:27 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 23:44:27 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 23:44:27 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 23:44:27 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 23:44:27 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 23:44:27 INFO     Total parameter numbers: 874010
2024-05-01 23:44:27 INFO     You select `adam` optimizer.
2024-05-01 23:44:27 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 23:44:27 INFO     Start training ...
2024-05-01 23:44:27 INFO     num_batches:48
2024-05-01 23:44:34 INFO     epoch complete!
2024-05-01 23:44:34 INFO     evaluating now!
2024-05-01 23:44:34 INFO     Epoch [0/200] train_loss: 23.2859, val_loss: 17.2519, lr: 0.003000, 7.62s
2024-05-01 23:44:34 INFO     Saved model at 0
2024-05-01 23:44:34 INFO     Val loss decrease from inf to 17.2519, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 23:44:41 INFO     epoch complete!
2024-05-01 23:44:41 INFO     evaluating now!
2024-05-01 23:44:41 INFO     Epoch [1/200] train_loss: 13.8980, val_loss: 13.0995, lr: 0.003000, 7.05s
2024-05-01 23:44:42 INFO     Saved model at 1
2024-05-01 23:44:42 INFO     Val loss decrease from 17.2519 to 13.0995, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 23:44:48 INFO     epoch complete!
2024-05-01 23:44:48 INFO     evaluating now!
2024-05-01 23:44:49 INFO     Epoch [2/200] train_loss: 10.6573, val_loss: 9.6837, lr: 0.003000, 7.30s
2024-05-01 23:44:49 INFO     Saved model at 2
2024-05-01 23:44:49 INFO     Val loss decrease from 13.0995 to 9.6837, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 23:44:55 INFO     epoch complete!
2024-05-01 23:44:55 INFO     evaluating now!
2024-05-01 23:44:56 INFO     Epoch [3/200] train_loss: 8.6849, val_loss: 8.4846, lr: 0.003000, 6.98s
2024-05-01 23:44:56 INFO     Saved model at 3
2024-05-01 23:44:56 INFO     Val loss decrease from 9.6837 to 8.4846, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 23:45:03 INFO     epoch complete!
2024-05-01 23:45:03 INFO     evaluating now!
2024-05-01 23:45:03 INFO     Epoch [4/200] train_loss: 7.6451, val_loss: 7.2724, lr: 0.003000, 7.29s
2024-05-01 23:45:03 INFO     Saved model at 4
2024-05-01 23:45:03 INFO     Val loss decrease from 8.4846 to 7.2724, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 23:45:10 INFO     epoch complete!
2024-05-01 23:45:10 INFO     evaluating now!
2024-05-01 23:45:10 INFO     Epoch [5/200] train_loss: 6.9358, val_loss: 6.7684, lr: 0.003000, 7.19s
2024-05-01 23:45:11 INFO     Saved model at 5
2024-05-01 23:45:11 INFO     Val loss decrease from 7.2724 to 6.7684, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 23:45:17 INFO     epoch complete!
2024-05-01 23:45:17 INFO     evaluating now!
2024-05-01 23:45:18 INFO     Epoch [6/200] train_loss: 6.4930, val_loss: 6.5943, lr: 0.003000, 7.29s
2024-05-01 23:45:18 INFO     Saved model at 6
2024-05-01 23:45:18 INFO     Val loss decrease from 6.7684 to 6.5943, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 23:45:25 INFO     epoch complete!
2024-05-01 23:45:25 INFO     evaluating now!
2024-05-01 23:45:25 INFO     Epoch [7/200] train_loss: 6.2458, val_loss: 6.1007, lr: 0.003000, 7.39s
2024-05-01 23:45:25 INFO     Saved model at 7
2024-05-01 23:45:25 INFO     Val loss decrease from 6.5943 to 6.1007, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 23:45:32 INFO     epoch complete!
2024-05-01 23:45:32 INFO     evaluating now!
2024-05-01 23:45:33 INFO     Epoch [8/200] train_loss: 5.9575, val_loss: 6.0217, lr: 0.003000, 7.38s
2024-05-01 23:45:33 INFO     Saved model at 8
2024-05-01 23:45:33 INFO     Val loss decrease from 6.1007 to 6.0217, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-01 23:45:40 INFO     epoch complete!
2024-05-01 23:45:40 INFO     evaluating now!
2024-05-01 23:45:40 INFO     Epoch [9/200] train_loss: 5.7020, val_loss: 5.7548, lr: 0.003000, 7.29s
2024-05-01 23:45:40 INFO     Saved model at 9
2024-05-01 23:45:40 INFO     Val loss decrease from 6.0217 to 5.7548, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-01 23:45:47 INFO     epoch complete!
2024-05-01 23:45:47 INFO     evaluating now!
2024-05-01 23:45:47 INFO     Epoch [10/200] train_loss: 5.5469, val_loss: 5.6987, lr: 0.003000, 7.32s
2024-05-01 23:45:47 INFO     Saved model at 10
2024-05-01 23:45:47 INFO     Val loss decrease from 5.7548 to 5.6987, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-01 23:45:54 INFO     epoch complete!
2024-05-01 23:45:54 INFO     evaluating now!
2024-05-01 23:45:55 INFO     Epoch [11/200] train_loss: 5.5004, val_loss: 5.9283, lr: 0.003000, 7.52s
2024-05-01 23:46:02 INFO     epoch complete!
2024-05-01 23:46:02 INFO     evaluating now!
2024-05-01 23:46:03 INFO     Epoch [12/200] train_loss: 5.2997, val_loss: 5.7049, lr: 0.003000, 8.02s
2024-05-01 23:46:10 INFO     epoch complete!
2024-05-01 23:46:10 INFO     evaluating now!
2024-05-01 23:46:10 INFO     Epoch [13/200] train_loss: 5.2115, val_loss: 5.6459, lr: 0.003000, 7.40s
2024-05-01 23:46:10 INFO     Saved model at 13
2024-05-01 23:46:10 INFO     Val loss decrease from 5.6987 to 5.6459, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-01 23:46:17 INFO     epoch complete!
2024-05-01 23:46:17 INFO     evaluating now!
2024-05-01 23:46:18 INFO     Epoch [14/200] train_loss: 5.0911, val_loss: 5.4900, lr: 0.003000, 7.46s
2024-05-01 23:46:18 INFO     Saved model at 14
2024-05-01 23:46:18 INFO     Val loss decrease from 5.6459 to 5.4900, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-01 23:46:25 INFO     epoch complete!
2024-05-01 23:46:25 INFO     evaluating now!
2024-05-01 23:46:25 INFO     Epoch [15/200] train_loss: 5.0151, val_loss: 5.3907, lr: 0.003000, 7.24s
2024-05-01 23:46:25 INFO     Saved model at 15
2024-05-01 23:46:25 INFO     Val loss decrease from 5.4900 to 5.3907, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-01 23:46:32 INFO     epoch complete!
2024-05-01 23:46:32 INFO     evaluating now!
2024-05-01 23:46:33 INFO     Epoch [16/200] train_loss: 4.9753, val_loss: 5.3155, lr: 0.003000, 7.29s
2024-05-01 23:46:33 INFO     Saved model at 16
2024-05-01 23:46:33 INFO     Val loss decrease from 5.3907 to 5.3155, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-01 23:46:39 INFO     epoch complete!
2024-05-01 23:46:39 INFO     evaluating now!
2024-05-01 23:46:40 INFO     Epoch [17/200] train_loss: 4.8907, val_loss: 5.5724, lr: 0.003000, 7.19s
2024-05-01 23:46:46 INFO     epoch complete!
2024-05-01 23:46:46 INFO     evaluating now!
2024-05-01 23:46:47 INFO     Epoch [18/200] train_loss: 4.8750, val_loss: 5.4932, lr: 0.003000, 7.22s
2024-05-01 23:46:54 INFO     epoch complete!
2024-05-01 23:46:54 INFO     evaluating now!
2024-05-01 23:46:54 INFO     Epoch [19/200] train_loss: 4.7237, val_loss: 5.3517, lr: 0.003000, 7.17s
2024-05-01 23:47:01 INFO     epoch complete!
2024-05-01 23:47:01 INFO     evaluating now!
2024-05-01 23:47:02 INFO     Epoch [20/200] train_loss: 4.7000, val_loss: 5.3147, lr: 0.003000, 7.82s
2024-05-01 23:47:02 INFO     Saved model at 20
2024-05-01 23:47:02 INFO     Val loss decrease from 5.3155 to 5.3147, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-01 23:47:09 INFO     epoch complete!
2024-05-01 23:47:09 INFO     evaluating now!
2024-05-01 23:47:09 INFO     Epoch [21/200] train_loss: 4.6136, val_loss: 5.1686, lr: 0.003000, 7.34s
2024-05-01 23:47:09 INFO     Saved model at 21
2024-05-01 23:47:09 INFO     Val loss decrease from 5.3147 to 5.1686, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-01 23:47:16 INFO     epoch complete!
2024-05-01 23:47:16 INFO     evaluating now!
2024-05-01 23:47:17 INFO     Epoch [22/200] train_loss: 4.5685, val_loss: 5.1595, lr: 0.003000, 7.45s
2024-05-01 23:47:17 INFO     Saved model at 22
2024-05-01 23:47:17 INFO     Val loss decrease from 5.1686 to 5.1595, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-01 23:47:24 INFO     epoch complete!
2024-05-01 23:47:24 INFO     evaluating now!
2024-05-01 23:47:24 INFO     Epoch [23/200] train_loss: 4.4834, val_loss: 5.5481, lr: 0.003000, 7.37s
2024-05-01 23:47:31 INFO     epoch complete!
2024-05-01 23:47:31 INFO     evaluating now!
2024-05-01 23:47:32 INFO     Epoch [24/200] train_loss: 4.4767, val_loss: 5.2401, lr: 0.003000, 7.44s
2024-05-01 23:47:39 INFO     epoch complete!
2024-05-01 23:47:39 INFO     evaluating now!
2024-05-01 23:47:39 INFO     Epoch [25/200] train_loss: 4.4275, val_loss: 5.1354, lr: 0.003000, 7.30s
2024-05-01 23:47:39 INFO     Saved model at 25
2024-05-01 23:47:39 INFO     Val loss decrease from 5.1595 to 5.1354, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-01 23:47:46 INFO     epoch complete!
2024-05-01 23:47:46 INFO     evaluating now!
2024-05-01 23:47:46 INFO     Epoch [26/200] train_loss: 4.3743, val_loss: 5.1400, lr: 0.003000, 7.41s
2024-05-01 23:47:53 INFO     epoch complete!
2024-05-01 23:47:53 INFO     evaluating now!
2024-05-01 23:47:53 INFO     Epoch [27/200] train_loss: 4.3001, val_loss: 5.0302, lr: 0.003000, 7.00s
2024-05-01 23:47:54 INFO     Saved model at 27
2024-05-01 23:47:54 INFO     Val loss decrease from 5.1354 to 5.0302, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-05-01 23:48:00 INFO     epoch complete!
2024-05-01 23:48:00 INFO     evaluating now!
2024-05-01 23:48:01 INFO     Epoch [28/200] train_loss: 4.2600, val_loss: 5.0467, lr: 0.003000, 7.07s
2024-05-01 23:48:07 INFO     epoch complete!
2024-05-01 23:48:07 INFO     evaluating now!
2024-05-01 23:48:08 INFO     Epoch [29/200] train_loss: 4.2171, val_loss: 5.2894, lr: 0.003000, 7.20s
2024-05-01 23:48:15 INFO     epoch complete!
2024-05-01 23:48:15 INFO     evaluating now!
2024-05-01 23:48:15 INFO     Epoch [30/200] train_loss: 4.2423, val_loss: 5.1569, lr: 0.003000, 7.71s
2024-05-01 23:48:23 INFO     epoch complete!
2024-05-01 23:48:23 INFO     evaluating now!
2024-05-01 23:48:23 INFO     Epoch [31/200] train_loss: 4.1825, val_loss: 5.1958, lr: 0.003000, 7.70s
2024-05-01 23:48:30 INFO     epoch complete!
2024-05-01 23:48:30 INFO     evaluating now!
2024-05-01 23:48:30 INFO     Epoch [32/200] train_loss: 4.1106, val_loss: 5.1521, lr: 0.003000, 7.06s
2024-05-01 23:48:37 INFO     epoch complete!
2024-05-01 23:48:37 INFO     evaluating now!
2024-05-01 23:48:38 INFO     Epoch [33/200] train_loss: 4.0958, val_loss: 5.1326, lr: 0.003000, 7.54s
2024-05-01 23:48:45 INFO     epoch complete!
2024-05-01 23:48:45 INFO     evaluating now!
2024-05-01 23:48:45 INFO     Epoch [34/200] train_loss: 4.0794, val_loss: 5.1992, lr: 0.003000, 7.34s
2024-05-01 23:48:52 INFO     epoch complete!
2024-05-01 23:48:52 INFO     evaluating now!
2024-05-01 23:48:53 INFO     Epoch [35/200] train_loss: 4.0343, val_loss: 5.1727, lr: 0.003000, 7.39s
2024-05-01 23:48:59 INFO     epoch complete!
2024-05-01 23:48:59 INFO     evaluating now!
2024-05-01 23:49:00 INFO     Epoch [36/200] train_loss: 4.0142, val_loss: 5.0490, lr: 0.003000, 7.41s
2024-05-01 23:49:07 INFO     epoch complete!
2024-05-01 23:49:07 INFO     evaluating now!
2024-05-01 23:49:07 INFO     Epoch [37/200] train_loss: 4.0138, val_loss: 5.0940, lr: 0.003000, 7.32s
2024-05-01 23:49:14 INFO     epoch complete!
2024-05-01 23:49:14 INFO     evaluating now!
2024-05-01 23:49:14 INFO     Epoch [38/200] train_loss: 3.9321, val_loss: 5.0324, lr: 0.003000, 7.20s
2024-05-01 23:49:21 INFO     epoch complete!
2024-05-01 23:49:21 INFO     evaluating now!
2024-05-01 23:49:22 INFO     Epoch [39/200] train_loss: 3.9882, val_loss: 5.3323, lr: 0.003000, 7.33s
2024-05-01 23:49:29 INFO     epoch complete!
2024-05-01 23:49:29 INFO     evaluating now!
2024-05-01 23:49:29 INFO     Epoch [40/200] train_loss: 3.9343, val_loss: 5.1209, lr: 0.003000, 7.53s
2024-05-01 23:49:36 INFO     epoch complete!
2024-05-01 23:49:36 INFO     evaluating now!
2024-05-01 23:49:36 INFO     Epoch [41/200] train_loss: 3.8668, val_loss: 5.1917, lr: 0.003000, 6.87s
2024-05-01 23:49:43 INFO     epoch complete!
2024-05-01 23:49:43 INFO     evaluating now!
2024-05-01 23:49:43 INFO     Epoch [42/200] train_loss: 3.8183, val_loss: 4.8519, lr: 0.003000, 7.01s
2024-05-01 23:49:43 INFO     Saved model at 42
2024-05-01 23:49:43 INFO     Val loss decrease from 5.0302 to 4.8519, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-05-01 23:49:50 INFO     epoch complete!
2024-05-01 23:49:50 INFO     evaluating now!
2024-05-01 23:49:50 INFO     Epoch [43/200] train_loss: 3.8066, val_loss: 4.9953, lr: 0.003000, 6.82s
2024-05-01 23:49:56 INFO     epoch complete!
2024-05-01 23:49:56 INFO     evaluating now!
2024-05-01 23:49:57 INFO     Epoch [44/200] train_loss: 3.7910, val_loss: 4.9545, lr: 0.003000, 6.79s
2024-05-01 23:50:03 INFO     epoch complete!
2024-05-01 23:50:03 INFO     evaluating now!
2024-05-01 23:50:04 INFO     Epoch [45/200] train_loss: 3.7724, val_loss: 5.1035, lr: 0.003000, 7.00s
2024-05-01 23:50:10 INFO     epoch complete!
2024-05-01 23:50:10 INFO     evaluating now!
2024-05-01 23:50:11 INFO     Epoch [46/200] train_loss: 3.7792, val_loss: 5.0063, lr: 0.003000, 6.84s
2024-05-01 23:50:17 INFO     epoch complete!
2024-05-01 23:50:17 INFO     evaluating now!
2024-05-01 23:50:18 INFO     Epoch [47/200] train_loss: 3.7085, val_loss: 4.9823, lr: 0.003000, 6.89s
2024-05-01 23:50:24 INFO     epoch complete!
2024-05-01 23:50:24 INFO     evaluating now!
2024-05-01 23:50:24 INFO     Epoch [48/200] train_loss: 3.7527, val_loss: 4.9796, lr: 0.003000, 6.85s
2024-05-01 23:50:31 INFO     epoch complete!
2024-05-01 23:50:31 INFO     evaluating now!
2024-05-01 23:50:32 INFO     Epoch [49/200] train_loss: 3.6969, val_loss: 5.0176, lr: 0.003000, 7.25s
2024-05-01 23:50:38 INFO     epoch complete!
2024-05-01 23:50:38 INFO     evaluating now!
2024-05-01 23:50:39 INFO     Epoch [50/200] train_loss: 3.7073, val_loss: 5.0713, lr: 0.003000, 6.90s
2024-05-01 23:50:45 INFO     epoch complete!
2024-05-01 23:50:45 INFO     evaluating now!
2024-05-01 23:50:45 INFO     Epoch [51/200] train_loss: 3.6703, val_loss: 5.1080, lr: 0.003000, 6.77s
2024-05-01 23:50:52 INFO     epoch complete!
2024-05-01 23:50:52 INFO     evaluating now!
2024-05-01 23:50:52 INFO     Epoch [52/200] train_loss: 3.7591, val_loss: 5.0250, lr: 0.003000, 6.77s
2024-05-01 23:50:58 INFO     epoch complete!
2024-05-01 23:50:58 INFO     evaluating now!
2024-05-01 23:50:59 INFO     Epoch [53/200] train_loss: 3.6225, val_loss: 4.8655, lr: 0.003000, 6.73s
2024-05-01 23:51:05 INFO     epoch complete!
2024-05-01 23:51:05 INFO     evaluating now!
2024-05-01 23:51:06 INFO     Epoch [54/200] train_loss: 3.6183, val_loss: 4.9908, lr: 0.003000, 6.82s
2024-05-01 23:51:12 INFO     epoch complete!
2024-05-01 23:51:12 INFO     evaluating now!
2024-05-01 23:51:12 INFO     Epoch [55/200] train_loss: 3.5881, val_loss: 5.0642, lr: 0.003000, 6.64s
2024-05-01 23:51:19 INFO     epoch complete!
2024-05-01 23:51:19 INFO     evaluating now!
2024-05-01 23:51:19 INFO     Epoch [56/200] train_loss: 3.5561, val_loss: 5.0233, lr: 0.003000, 6.68s
2024-05-01 23:51:25 INFO     epoch complete!
2024-05-01 23:51:25 INFO     evaluating now!
2024-05-01 23:51:26 INFO     Epoch [57/200] train_loss: 3.5393, val_loss: 4.9114, lr: 0.003000, 6.67s
2024-05-01 23:51:26 WARNING  Early stopping at epoch: 57
2024-05-01 23:51:26 INFO     Trained totally 58 epochs, average train time is 6.693s, average eval time is 0.510s
2024-05-01 23:51:26 INFO     Loaded model at 42
2024-05-01 23:51:26 INFO     Saved model at ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 23:51:26 INFO     Start evaluating ...
2024-05-01 23:51:27 INFO     Note that you select the single mode to evaluate!
2024-05-01 23:51:28 INFO     Evaluate result is saved at ./libcity/cache/60/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 23:51:28 INFO     
         MAE       RMSE
1   2.389359   7.071159
2   2.493353   7.577831
3   2.694671   8.638006
4   2.853938   9.473960
5   2.991481  10.253319
6   3.086300  10.818260
7   3.129804  11.328704
8   3.171487  11.704783
9   3.144933  12.030260
10  3.229425  12.449532
11  3.375974  13.017320
12  3.530067  13.956199
2024-05-01 23:51:28 INFO     ----------------------------------------------------------------------------
2024-05-01 23:51:28 INFO     # 1, Kownledge Graph Embedding: RandomE, Experiment ids: 61
2024-05-01 23:51:28 INFO     ----------------------------------------------------------------------------
2024-05-01 23:51:28 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=60
2024-05-01 23:51:28 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 60, 'load_external': True, 'embedding_model': 'RandomE', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 23:51:28 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 23:51:28 INFO     set_weight_link_or_dist: dist
2024-05-01 23:51:28 INFO     init_weight_inf_or_zero: inf
2024-05-01 23:51:28 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 23:51:28 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 23:51:28 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 23:51:28 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 23:51:31 INFO     Dataset created
2024-05-01 23:51:31 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 23:51:31 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 23:51:31 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 23:51:31 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 23:51:31 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 23:51:31 INFO     NormalScaler max: 0.0028067830852947636
2024-05-01 23:51:34 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 23:51:34 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 23:51:34 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 23:51:34 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 23:51:34 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 23:51:34 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 23:51:34 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 23:51:34 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 23:51:34 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 23:51:34 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 23:51:34 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 23:51:34 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 23:51:34 INFO     Total parameter numbers: 874010
2024-05-01 23:51:34 INFO     You select `adam` optimizer.
2024-05-01 23:51:34 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 23:51:34 INFO     Start training ...
2024-05-01 23:51:34 INFO     num_batches:48
2024-05-01 23:51:40 INFO     epoch complete!
2024-05-01 23:51:40 INFO     evaluating now!
2024-05-01 23:51:41 INFO     Epoch [0/200] train_loss: 24.6200, val_loss: 17.3264, lr: 0.003000, 6.40s
2024-05-01 23:51:41 INFO     Saved model at 0
2024-05-01 23:51:41 INFO     Val loss decrease from inf to 17.3264, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 23:51:47 INFO     epoch complete!
2024-05-01 23:51:47 INFO     evaluating now!
2024-05-01 23:51:47 INFO     Epoch [1/200] train_loss: 14.1426, val_loss: 13.3513, lr: 0.003000, 6.46s
2024-05-01 23:51:47 INFO     Saved model at 1
2024-05-01 23:51:47 INFO     Val loss decrease from 17.3264 to 13.3513, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 23:51:54 INFO     epoch complete!
2024-05-01 23:51:54 INFO     evaluating now!
2024-05-01 23:51:54 INFO     Epoch [2/200] train_loss: 11.0088, val_loss: 10.4417, lr: 0.003000, 6.60s
2024-05-01 23:51:54 INFO     Saved model at 2
2024-05-01 23:51:54 INFO     Val loss decrease from 13.3513 to 10.4417, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 23:52:00 INFO     epoch complete!
2024-05-01 23:52:00 INFO     evaluating now!
2024-05-01 23:52:01 INFO     Epoch [3/200] train_loss: 9.1122, val_loss: 8.5196, lr: 0.003000, 6.51s
2024-05-01 23:52:01 INFO     Saved model at 3
2024-05-01 23:52:01 INFO     Val loss decrease from 10.4417 to 8.5196, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 23:52:07 INFO     epoch complete!
2024-05-01 23:52:07 INFO     evaluating now!
2024-05-01 23:52:08 INFO     Epoch [4/200] train_loss: 7.9280, val_loss: 7.6907, lr: 0.003000, 7.34s
2024-05-01 23:52:08 INFO     Saved model at 4
2024-05-01 23:52:08 INFO     Val loss decrease from 8.5196 to 7.6907, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 23:52:15 INFO     epoch complete!
2024-05-01 23:52:15 INFO     evaluating now!
2024-05-01 23:52:15 INFO     Epoch [5/200] train_loss: 7.2690, val_loss: 6.9607, lr: 0.003000, 7.35s
2024-05-01 23:52:15 INFO     Saved model at 5
2024-05-01 23:52:15 INFO     Val loss decrease from 7.6907 to 6.9607, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 23:52:22 INFO     epoch complete!
2024-05-01 23:52:22 INFO     evaluating now!
2024-05-01 23:52:22 INFO     Epoch [6/200] train_loss: 6.6683, val_loss: 6.5908, lr: 0.003000, 6.63s
2024-05-01 23:52:24 INFO     Saved model at 6
2024-05-01 23:52:24 INFO     Val loss decrease from 6.9607 to 6.5908, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 23:52:31 INFO     epoch complete!
2024-05-01 23:52:31 INFO     evaluating now!
2024-05-01 23:52:32 INFO     Epoch [7/200] train_loss: 6.3453, val_loss: 6.4594, lr: 0.003000, 7.48s
2024-05-01 23:52:32 INFO     Saved model at 7
2024-05-01 23:52:32 INFO     Val loss decrease from 6.5908 to 6.4594, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 23:52:39 INFO     epoch complete!
2024-05-01 23:52:39 INFO     evaluating now!
2024-05-01 23:52:39 INFO     Epoch [8/200] train_loss: 6.1082, val_loss: 6.1267, lr: 0.003000, 7.53s
2024-05-01 23:52:39 INFO     Saved model at 8
2024-05-01 23:52:39 INFO     Val loss decrease from 6.4594 to 6.1267, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-01 23:52:46 INFO     epoch complete!
2024-05-01 23:52:46 INFO     evaluating now!
2024-05-01 23:52:47 INFO     Epoch [9/200] train_loss: 5.9417, val_loss: 6.0254, lr: 0.003000, 7.34s
2024-05-01 23:52:47 INFO     Saved model at 9
2024-05-01 23:52:47 INFO     Val loss decrease from 6.1267 to 6.0254, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-01 23:52:54 INFO     epoch complete!
2024-05-01 23:52:54 INFO     evaluating now!
2024-05-01 23:52:54 INFO     Epoch [10/200] train_loss: 5.7963, val_loss: 6.0378, lr: 0.003000, 7.34s
2024-05-01 23:53:01 INFO     epoch complete!
2024-05-01 23:53:01 INFO     evaluating now!
2024-05-01 23:53:01 INFO     Epoch [11/200] train_loss: 5.5837, val_loss: 5.8107, lr: 0.003000, 7.40s
2024-05-01 23:53:01 INFO     Saved model at 11
2024-05-01 23:53:01 INFO     Val loss decrease from 6.0254 to 5.8107, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-01 23:53:08 INFO     epoch complete!
2024-05-01 23:53:08 INFO     evaluating now!
2024-05-01 23:53:09 INFO     Epoch [12/200] train_loss: 5.4104, val_loss: 5.9414, lr: 0.003000, 7.35s
2024-05-01 23:53:16 INFO     epoch complete!
2024-05-01 23:53:16 INFO     evaluating now!
2024-05-01 23:53:16 INFO     Epoch [13/200] train_loss: 5.3245, val_loss: 5.5352, lr: 0.003000, 7.48s
2024-05-01 23:53:16 INFO     Saved model at 13
2024-05-01 23:53:16 INFO     Val loss decrease from 5.8107 to 5.5352, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-01 23:53:23 INFO     epoch complete!
2024-05-01 23:53:23 INFO     evaluating now!
2024-05-01 23:53:24 INFO     Epoch [14/200] train_loss: 5.1799, val_loss: 5.4899, lr: 0.003000, 7.61s
2024-05-01 23:53:24 INFO     Saved model at 14
2024-05-01 23:53:24 INFO     Val loss decrease from 5.5352 to 5.4899, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-01 23:53:31 INFO     epoch complete!
2024-05-01 23:53:31 INFO     evaluating now!
2024-05-01 23:53:32 INFO     Epoch [15/200] train_loss: 5.1148, val_loss: 5.6651, lr: 0.003000, 7.48s
2024-05-01 23:53:38 INFO     epoch complete!
2024-05-01 23:53:38 INFO     evaluating now!
2024-05-01 23:53:38 INFO     Epoch [16/200] train_loss: 5.0279, val_loss: 5.3662, lr: 0.003000, 6.97s
2024-05-01 23:53:39 INFO     Saved model at 16
2024-05-01 23:53:39 INFO     Val loss decrease from 5.4899 to 5.3662, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-01 23:53:45 INFO     epoch complete!
2024-05-01 23:53:45 INFO     evaluating now!
2024-05-01 23:53:45 INFO     Epoch [17/200] train_loss: 4.9754, val_loss: 5.3760, lr: 0.003000, 6.84s
2024-05-01 23:53:52 INFO     epoch complete!
2024-05-01 23:53:52 INFO     evaluating now!
2024-05-01 23:53:52 INFO     Epoch [18/200] train_loss: 4.8479, val_loss: 5.4092, lr: 0.003000, 6.75s
2024-05-01 23:53:59 INFO     epoch complete!
2024-05-01 23:53:59 INFO     evaluating now!
2024-05-01 23:53:59 INFO     Epoch [19/200] train_loss: 4.8748, val_loss: 5.2676, lr: 0.003000, 6.89s
2024-05-01 23:53:59 INFO     Saved model at 19
2024-05-01 23:53:59 INFO     Val loss decrease from 5.3662 to 5.2676, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-01 23:54:06 INFO     epoch complete!
2024-05-01 23:54:06 INFO     evaluating now!
2024-05-01 23:54:06 INFO     Epoch [20/200] train_loss: 4.7910, val_loss: 5.3460, lr: 0.003000, 6.96s
2024-05-01 23:54:12 INFO     epoch complete!
2024-05-01 23:54:12 INFO     evaluating now!
2024-05-01 23:54:13 INFO     Epoch [21/200] train_loss: 4.6515, val_loss: 5.1928, lr: 0.003000, 6.92s
2024-05-01 23:54:13 INFO     Saved model at 21
2024-05-01 23:54:13 INFO     Val loss decrease from 5.2676 to 5.1928, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-01 23:54:20 INFO     epoch complete!
2024-05-01 23:54:20 INFO     evaluating now!
2024-05-01 23:54:21 INFO     Epoch [22/200] train_loss: 4.5650, val_loss: 5.0841, lr: 0.003000, 7.68s
2024-05-01 23:54:21 INFO     Saved model at 22
2024-05-01 23:54:21 INFO     Val loss decrease from 5.1928 to 5.0841, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-01 23:54:28 INFO     epoch complete!
2024-05-01 23:54:28 INFO     evaluating now!
2024-05-01 23:54:28 INFO     Epoch [23/200] train_loss: 4.5712, val_loss: 5.4136, lr: 0.003000, 7.38s
2024-05-01 23:54:35 INFO     epoch complete!
2024-05-01 23:54:35 INFO     evaluating now!
2024-05-01 23:54:36 INFO     Epoch [24/200] train_loss: 4.5891, val_loss: 5.3485, lr: 0.003000, 7.43s
2024-05-01 23:54:42 INFO     epoch complete!
2024-05-01 23:54:42 INFO     evaluating now!
2024-05-01 23:54:43 INFO     Epoch [25/200] train_loss: 4.5028, val_loss: 5.1521, lr: 0.003000, 7.45s
2024-05-01 23:54:50 INFO     epoch complete!
2024-05-01 23:54:50 INFO     evaluating now!
2024-05-01 23:54:51 INFO     Epoch [26/200] train_loss: 4.5122, val_loss: 5.0264, lr: 0.003000, 7.67s
2024-05-01 23:54:51 INFO     Saved model at 26
2024-05-01 23:54:51 INFO     Val loss decrease from 5.0841 to 5.0264, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-05-01 23:54:58 INFO     epoch complete!
2024-05-01 23:54:58 INFO     evaluating now!
2024-05-01 23:54:58 INFO     Epoch [27/200] train_loss: 4.3631, val_loss: 5.1400, lr: 0.003000, 7.40s
2024-05-01 23:55:05 INFO     epoch complete!
2024-05-01 23:55:05 INFO     evaluating now!
2024-05-01 23:55:06 INFO     Epoch [28/200] train_loss: 4.3699, val_loss: 5.1723, lr: 0.003000, 7.45s
2024-05-01 23:55:12 INFO     epoch complete!
2024-05-01 23:55:12 INFO     evaluating now!
2024-05-01 23:55:13 INFO     Epoch [29/200] train_loss: 4.2595, val_loss: 5.1466, lr: 0.003000, 7.27s
2024-05-01 23:55:20 INFO     epoch complete!
2024-05-01 23:55:20 INFO     evaluating now!
2024-05-01 23:55:20 INFO     Epoch [30/200] train_loss: 4.2758, val_loss: 5.1373, lr: 0.003000, 7.30s
2024-05-01 23:55:27 INFO     epoch complete!
2024-05-01 23:55:27 INFO     evaluating now!
2024-05-01 23:55:28 INFO     Epoch [31/200] train_loss: 4.3148, val_loss: 5.0963, lr: 0.003000, 7.44s
2024-05-01 23:55:34 INFO     epoch complete!
2024-05-01 23:55:34 INFO     evaluating now!
2024-05-01 23:55:35 INFO     Epoch [32/200] train_loss: 4.1524, val_loss: 5.0184, lr: 0.003000, 7.39s
2024-05-01 23:55:35 INFO     Saved model at 32
2024-05-01 23:55:35 INFO     Val loss decrease from 5.0264 to 5.0184, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-05-01 23:55:42 INFO     epoch complete!
2024-05-01 23:55:42 INFO     evaluating now!
2024-05-01 23:55:42 INFO     Epoch [33/200] train_loss: 4.1625, val_loss: 5.1268, lr: 0.003000, 7.37s
2024-05-01 23:55:49 INFO     epoch complete!
2024-05-01 23:55:49 INFO     evaluating now!
2024-05-01 23:55:50 INFO     Epoch [34/200] train_loss: 4.1913, val_loss: 5.1322, lr: 0.003000, 7.29s
2024-05-01 23:55:57 INFO     epoch complete!
2024-05-01 23:55:57 INFO     evaluating now!
2024-05-01 23:55:57 INFO     Epoch [35/200] train_loss: 4.0763, val_loss: 5.0846, lr: 0.003000, 7.42s
2024-05-01 23:56:04 INFO     epoch complete!
2024-05-01 23:56:04 INFO     evaluating now!
2024-05-01 23:56:04 INFO     Epoch [36/200] train_loss: 4.0637, val_loss: 5.1041, lr: 0.003000, 7.36s
2024-05-01 23:56:11 INFO     epoch complete!
2024-05-01 23:56:11 INFO     evaluating now!
2024-05-01 23:56:12 INFO     Epoch [37/200] train_loss: 3.9934, val_loss: 5.0460, lr: 0.003000, 7.46s
2024-05-01 23:56:19 INFO     epoch complete!
2024-05-01 23:56:19 INFO     evaluating now!
2024-05-01 23:56:19 INFO     Epoch [38/200] train_loss: 3.9290, val_loss: 4.9979, lr: 0.003000, 7.37s
2024-05-01 23:56:19 INFO     Saved model at 38
2024-05-01 23:56:19 INFO     Val loss decrease from 5.0184 to 4.9979, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-05-01 23:56:26 INFO     epoch complete!
2024-05-01 23:56:26 INFO     evaluating now!
2024-05-01 23:56:27 INFO     Epoch [39/200] train_loss: 3.9418, val_loss: 5.0562, lr: 0.003000, 7.44s
2024-05-01 23:56:34 INFO     epoch complete!
2024-05-01 23:56:34 INFO     evaluating now!
2024-05-01 23:56:34 INFO     Epoch [40/200] train_loss: 3.9342, val_loss: 4.9854, lr: 0.003000, 7.38s
2024-05-01 23:56:34 INFO     Saved model at 40
2024-05-01 23:56:34 INFO     Val loss decrease from 4.9979 to 4.9854, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-05-01 23:56:41 INFO     epoch complete!
2024-05-01 23:56:41 INFO     evaluating now!
2024-05-01 23:56:42 INFO     Epoch [41/200] train_loss: 3.9614, val_loss: 5.0766, lr: 0.003000, 7.42s
2024-05-01 23:56:48 INFO     epoch complete!
2024-05-01 23:56:48 INFO     evaluating now!
2024-05-01 23:56:49 INFO     Epoch [42/200] train_loss: 3.9316, val_loss: 5.1875, lr: 0.003000, 7.30s
2024-05-01 23:56:56 INFO     epoch complete!
2024-05-01 23:56:56 INFO     evaluating now!
2024-05-01 23:56:56 INFO     Epoch [43/200] train_loss: 3.8657, val_loss: 5.0671, lr: 0.003000, 7.32s
2024-05-01 23:57:03 INFO     epoch complete!
2024-05-01 23:57:03 INFO     evaluating now!
2024-05-01 23:57:04 INFO     Epoch [44/200] train_loss: 3.8980, val_loss: 4.9906, lr: 0.003000, 7.38s
2024-05-01 23:57:10 INFO     epoch complete!
2024-05-01 23:57:10 INFO     evaluating now!
2024-05-01 23:57:11 INFO     Epoch [45/200] train_loss: 3.8316, val_loss: 5.0855, lr: 0.003000, 7.33s
2024-05-01 23:57:18 INFO     epoch complete!
2024-05-01 23:57:18 INFO     evaluating now!
2024-05-01 23:57:18 INFO     Epoch [46/200] train_loss: 3.8390, val_loss: 5.0487, lr: 0.003000, 7.35s
2024-05-01 23:57:25 INFO     epoch complete!
2024-05-01 23:57:25 INFO     evaluating now!
2024-05-01 23:57:26 INFO     Epoch [47/200] train_loss: 3.7714, val_loss: 5.0691, lr: 0.003000, 7.28s
2024-05-01 23:57:32 INFO     epoch complete!
2024-05-01 23:57:32 INFO     evaluating now!
2024-05-01 23:57:33 INFO     Epoch [48/200] train_loss: 3.7396, val_loss: 4.9575, lr: 0.003000, 7.36s
2024-05-01 23:57:33 INFO     Saved model at 48
2024-05-01 23:57:33 INFO     Val loss decrease from 4.9854 to 4.9575, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-05-01 23:57:40 INFO     epoch complete!
2024-05-01 23:57:40 INFO     evaluating now!
2024-05-01 23:57:40 INFO     Epoch [49/200] train_loss: 3.7601, val_loss: 4.9884, lr: 0.003000, 7.46s
2024-05-01 23:57:47 INFO     epoch complete!
2024-05-01 23:57:47 INFO     evaluating now!
2024-05-01 23:57:48 INFO     Epoch [50/200] train_loss: 3.7591, val_loss: 4.9936, lr: 0.003000, 7.43s
2024-05-01 23:57:55 INFO     epoch complete!
2024-05-01 23:57:55 INFO     evaluating now!
2024-05-01 23:57:56 INFO     Epoch [51/200] train_loss: 3.7012, val_loss: 5.0088, lr: 0.003000, 8.14s
2024-05-01 23:58:03 INFO     epoch complete!
2024-05-01 23:58:03 INFO     evaluating now!
2024-05-01 23:58:04 INFO     Epoch [52/200] train_loss: 3.6967, val_loss: 5.0285, lr: 0.003000, 7.69s
2024-05-01 23:58:11 INFO     epoch complete!
2024-05-01 23:58:11 INFO     evaluating now!
2024-05-01 23:58:11 INFO     Epoch [53/200] train_loss: 3.6551, val_loss: 5.0422, lr: 0.003000, 7.40s
2024-05-01 23:58:18 INFO     epoch complete!
2024-05-01 23:58:18 INFO     evaluating now!
2024-05-01 23:58:18 INFO     Epoch [54/200] train_loss: 3.6411, val_loss: 4.9497, lr: 0.003000, 7.39s
2024-05-01 23:58:19 INFO     Saved model at 54
2024-05-01 23:58:19 INFO     Val loss decrease from 4.9575 to 4.9497, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch54.tar
2024-05-01 23:58:25 INFO     epoch complete!
2024-05-01 23:58:25 INFO     evaluating now!
2024-05-01 23:58:26 INFO     Epoch [55/200] train_loss: 3.6478, val_loss: 5.0260, lr: 0.003000, 7.44s
2024-05-01 23:58:33 INFO     epoch complete!
2024-05-01 23:58:33 INFO     evaluating now!
2024-05-01 23:58:33 INFO     Epoch [56/200] train_loss: 3.6649, val_loss: 5.0108, lr: 0.003000, 7.39s
2024-05-01 23:58:40 INFO     epoch complete!
2024-05-01 23:58:40 INFO     evaluating now!
2024-05-01 23:58:41 INFO     Epoch [57/200] train_loss: 3.6183, val_loss: 5.0822, lr: 0.003000, 7.42s
2024-05-01 23:58:48 INFO     epoch complete!
2024-05-01 23:58:48 INFO     evaluating now!
2024-05-01 23:58:48 INFO     Epoch [58/200] train_loss: 3.6027, val_loss: 4.9715, lr: 0.003000, 7.34s
2024-05-01 23:58:55 INFO     epoch complete!
2024-05-01 23:58:55 INFO     evaluating now!
2024-05-01 23:58:55 INFO     Epoch [59/200] train_loss: 3.5998, val_loss: 5.0355, lr: 0.003000, 7.08s
2024-05-01 23:59:01 INFO     epoch complete!
2024-05-01 23:59:01 INFO     evaluating now!
2024-05-01 23:59:02 INFO     Epoch [60/200] train_loss: 3.6013, val_loss: 4.9807, lr: 0.003000, 6.44s
2024-05-01 23:59:08 INFO     epoch complete!
2024-05-01 23:59:08 INFO     evaluating now!
2024-05-01 23:59:08 INFO     Epoch [61/200] train_loss: 3.5811, val_loss: 5.0623, lr: 0.003000, 6.71s
2024-05-01 23:59:14 INFO     epoch complete!
2024-05-01 23:59:14 INFO     evaluating now!
2024-05-01 23:59:14 INFO     Epoch [62/200] train_loss: 3.5220, val_loss: 5.0250, lr: 0.003000, 6.09s
2024-05-01 23:59:20 INFO     epoch complete!
2024-05-01 23:59:20 INFO     evaluating now!
2024-05-01 23:59:20 INFO     Epoch [63/200] train_loss: 3.5436, val_loss: 4.9705, lr: 0.003000, 5.93s
2024-05-01 23:59:26 INFO     epoch complete!
2024-05-01 23:59:26 INFO     evaluating now!
2024-05-01 23:59:26 INFO     Epoch [64/200] train_loss: 3.5123, val_loss: 4.9744, lr: 0.003000, 5.93s
2024-05-01 23:59:32 INFO     epoch complete!
2024-05-01 23:59:32 INFO     evaluating now!
2024-05-01 23:59:32 INFO     Epoch [65/200] train_loss: 3.5283, val_loss: 5.1541, lr: 0.003000, 5.95s
2024-05-01 23:59:38 INFO     epoch complete!
2024-05-01 23:59:38 INFO     evaluating now!
2024-05-01 23:59:38 INFO     Epoch [66/200] train_loss: 3.4925, val_loss: 5.0150, lr: 0.003000, 5.96s
2024-05-01 23:59:44 INFO     epoch complete!
2024-05-01 23:59:44 INFO     evaluating now!
2024-05-01 23:59:44 INFO     Epoch [67/200] train_loss: 3.4781, val_loss: 4.9440, lr: 0.003000, 6.09s
2024-05-01 23:59:44 INFO     Saved model at 67
2024-05-01 23:59:44 INFO     Val loss decrease from 4.9497 to 4.9440, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch67.tar
2024-05-01 23:59:50 INFO     epoch complete!
2024-05-01 23:59:50 INFO     evaluating now!
2024-05-01 23:59:50 INFO     Epoch [68/200] train_loss: 3.4874, val_loss: 5.0343, lr: 0.003000, 6.02s
2024-05-01 23:59:57 INFO     epoch complete!
2024-05-01 23:59:57 INFO     evaluating now!
2024-05-01 23:59:57 INFO     Epoch [69/200] train_loss: 3.4769, val_loss: 4.9700, lr: 0.003000, 6.83s
2024-05-02 00:00:03 INFO     epoch complete!
2024-05-02 00:00:03 INFO     evaluating now!
2024-05-02 00:00:04 INFO     Epoch [70/200] train_loss: 3.4212, val_loss: 5.0681, lr: 0.003000, 6.36s
2024-05-02 00:00:09 INFO     epoch complete!
2024-05-02 00:00:09 INFO     evaluating now!
2024-05-02 00:00:10 INFO     Epoch [71/200] train_loss: 3.4165, val_loss: 4.9066, lr: 0.003000, 6.32s
2024-05-02 00:00:10 INFO     Saved model at 71
2024-05-02 00:00:10 INFO     Val loss decrease from 4.9440 to 4.9066, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch71.tar
2024-05-02 00:00:16 INFO     epoch complete!
2024-05-02 00:00:16 INFO     evaluating now!
2024-05-02 00:00:16 INFO     Epoch [72/200] train_loss: 3.3984, val_loss: 4.9843, lr: 0.003000, 6.27s
2024-05-02 00:00:22 INFO     epoch complete!
2024-05-02 00:00:22 INFO     evaluating now!
2024-05-02 00:00:22 INFO     Epoch [73/200] train_loss: 3.4290, val_loss: 5.0097, lr: 0.003000, 6.31s
2024-05-02 00:00:28 INFO     epoch complete!
2024-05-02 00:00:28 INFO     evaluating now!
2024-05-02 00:00:29 INFO     Epoch [74/200] train_loss: 3.4139, val_loss: 5.0499, lr: 0.003000, 6.32s
2024-05-02 00:00:35 INFO     epoch complete!
2024-05-02 00:00:35 INFO     evaluating now!
2024-05-02 00:00:35 INFO     Epoch [75/200] train_loss: 3.3905, val_loss: 4.9449, lr: 0.003000, 6.26s
2024-05-02 00:00:41 INFO     epoch complete!
2024-05-02 00:00:41 INFO     evaluating now!
2024-05-02 00:00:41 INFO     Epoch [76/200] train_loss: 3.3980, val_loss: 5.0922, lr: 0.003000, 6.40s
2024-05-02 00:00:47 INFO     epoch complete!
2024-05-02 00:00:47 INFO     evaluating now!
2024-05-02 00:00:48 INFO     Epoch [77/200] train_loss: 3.3770, val_loss: 4.9564, lr: 0.003000, 6.30s
2024-05-02 00:00:54 INFO     epoch complete!
2024-05-02 00:00:54 INFO     evaluating now!
2024-05-02 00:00:54 INFO     Epoch [78/200] train_loss: 3.3111, val_loss: 4.9539, lr: 0.003000, 6.34s
2024-05-02 00:01:00 INFO     epoch complete!
2024-05-02 00:01:00 INFO     evaluating now!
2024-05-02 00:01:00 INFO     Epoch [79/200] train_loss: 3.3061, val_loss: 4.9829, lr: 0.003000, 6.26s
2024-05-02 00:01:06 INFO     epoch complete!
2024-05-02 00:01:06 INFO     evaluating now!
2024-05-02 00:01:07 INFO     Epoch [80/200] train_loss: 3.3114, val_loss: 4.9628, lr: 0.003000, 6.37s
2024-05-02 00:01:13 INFO     epoch complete!
2024-05-02 00:01:13 INFO     evaluating now!
2024-05-02 00:01:13 INFO     Epoch [81/200] train_loss: 3.2968, val_loss: 4.9976, lr: 0.003000, 6.40s
2024-05-02 00:01:19 INFO     epoch complete!
2024-05-02 00:01:19 INFO     evaluating now!
2024-05-02 00:01:19 INFO     Epoch [82/200] train_loss: 3.3009, val_loss: 5.0814, lr: 0.003000, 6.36s
2024-05-02 00:01:25 INFO     epoch complete!
2024-05-02 00:01:25 INFO     evaluating now!
2024-05-02 00:01:26 INFO     Epoch [83/200] train_loss: 3.3011, val_loss: 5.0533, lr: 0.003000, 6.44s
2024-05-02 00:01:32 INFO     epoch complete!
2024-05-02 00:01:32 INFO     evaluating now!
2024-05-02 00:01:32 INFO     Epoch [84/200] train_loss: 3.3046, val_loss: 5.0211, lr: 0.003000, 6.27s
2024-05-02 00:01:38 INFO     epoch complete!
2024-05-02 00:01:38 INFO     evaluating now!
2024-05-02 00:01:39 INFO     Epoch [85/200] train_loss: 3.2573, val_loss: 4.9998, lr: 0.003000, 6.38s
2024-05-02 00:01:44 INFO     epoch complete!
2024-05-02 00:01:44 INFO     evaluating now!
2024-05-02 00:01:45 INFO     Epoch [86/200] train_loss: 3.2746, val_loss: 5.1123, lr: 0.003000, 6.33s
2024-05-02 00:01:45 WARNING  Early stopping at epoch: 86
2024-05-02 00:01:45 INFO     Trained totally 87 epochs, average train time is 6.494s, average eval time is 0.484s
2024-05-02 00:01:45 INFO     Loaded model at 71
2024-05-02 00:01:45 INFO     Saved model at ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 00:01:45 INFO     Start evaluating ...
2024-05-02 00:01:47 INFO     Note that you select the single mode to evaluate!
2024-05-02 00:01:47 INFO     Evaluate result is saved at ./libcity/cache/60/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-02 00:01:47 INFO     
         MAE       RMSE
1   2.280859   6.829917
2   2.417201   7.581736
3   2.557793   8.682690
4   2.779860   9.658211
5   2.943765  10.746779
6   3.096883  11.911969
7   3.170661  12.881757
8   3.207834  13.253196
9   3.250781  13.337904
10  3.289225  13.193702
11  3.355692  13.417876
12  3.435543  13.944464
2024-05-02 00:01:47 INFO     ----------------------------------------------------------------------------
2024-05-02 00:01:47 INFO     # 2, Kownledge Graph Embedding: RandomE, Experiment ids: 62
2024-05-02 00:01:47 INFO     ----------------------------------------------------------------------------
2024-05-02 00:01:47 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=60
2024-05-02 00:01:47 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 60, 'load_external': True, 'embedding_model': 'RandomE', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 00:01:47 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 00:01:47 INFO     set_weight_link_or_dist: dist
2024-05-02 00:01:47 INFO     init_weight_inf_or_zero: inf
2024-05-02 00:01:47 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 00:01:47 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 00:01:47 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 00:01:47 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 00:01:50 INFO     Dataset created
2024-05-02 00:01:50 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-02 00:01:50 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-02 00:01:50 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-02 00:01:50 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-02 00:01:50 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 00:01:50 INFO     NormalScaler max: 0.0028067830852947636
2024-05-02 00:01:53 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 00:01:53 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 00:01:53 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-02 00:01:53 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 00:01:53 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-02 00:01:53 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 00:01:53 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 00:01:53 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 00:01:53 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 00:01:53 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 00:01:53 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 00:01:53 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 00:01:53 INFO     Total parameter numbers: 874010
2024-05-02 00:01:53 INFO     You select `adam` optimizer.
2024-05-02 00:01:53 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 00:01:53 INFO     Start training ...
2024-05-02 00:01:53 INFO     num_batches:48
2024-05-02 00:01:59 INFO     epoch complete!
2024-05-02 00:01:59 INFO     evaluating now!
2024-05-02 00:02:00 INFO     Epoch [0/200] train_loss: 23.6447, val_loss: 17.1847, lr: 0.003000, 6.36s
2024-05-02 00:02:00 INFO     Saved model at 0
2024-05-02 00:02:00 INFO     Val loss decrease from inf to 17.1847, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 00:02:06 INFO     epoch complete!
2024-05-02 00:02:06 INFO     evaluating now!
2024-05-02 00:02:06 INFO     Epoch [1/200] train_loss: 13.7910, val_loss: 13.0058, lr: 0.003000, 6.28s
2024-05-02 00:02:06 INFO     Saved model at 1
2024-05-02 00:02:06 INFO     Val loss decrease from 17.1847 to 13.0058, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 00:02:12 INFO     epoch complete!
2024-05-02 00:02:12 INFO     evaluating now!
2024-05-02 00:02:12 INFO     Epoch [2/200] train_loss: 10.5876, val_loss: 9.8319, lr: 0.003000, 6.21s
2024-05-02 00:02:12 INFO     Saved model at 2
2024-05-02 00:02:12 INFO     Val loss decrease from 13.0058 to 9.8319, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 00:02:18 INFO     epoch complete!
2024-05-02 00:02:18 INFO     evaluating now!
2024-05-02 00:02:19 INFO     Epoch [3/200] train_loss: 8.6809, val_loss: 8.2926, lr: 0.003000, 6.24s
2024-05-02 00:02:19 INFO     Saved model at 3
2024-05-02 00:02:19 INFO     Val loss decrease from 9.8319 to 8.2926, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 00:02:25 INFO     epoch complete!
2024-05-02 00:02:25 INFO     evaluating now!
2024-05-02 00:02:25 INFO     Epoch [4/200] train_loss: 7.6984, val_loss: 7.7649, lr: 0.003000, 6.33s
2024-05-02 00:02:25 INFO     Saved model at 4
2024-05-02 00:02:25 INFO     Val loss decrease from 8.2926 to 7.7649, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 00:02:31 INFO     epoch complete!
2024-05-02 00:02:31 INFO     evaluating now!
2024-05-02 00:02:31 INFO     Epoch [5/200] train_loss: 6.9412, val_loss: 6.7638, lr: 0.003000, 6.35s
2024-05-02 00:02:32 INFO     Saved model at 5
2024-05-02 00:02:32 INFO     Val loss decrease from 7.7649 to 6.7638, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 00:02:37 INFO     epoch complete!
2024-05-02 00:02:37 INFO     evaluating now!
2024-05-02 00:02:38 INFO     Epoch [6/200] train_loss: 6.4068, val_loss: 6.2876, lr: 0.003000, 6.35s
2024-05-02 00:02:38 INFO     Saved model at 6
2024-05-02 00:02:38 INFO     Val loss decrease from 6.7638 to 6.2876, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 00:02:44 INFO     epoch complete!
2024-05-02 00:02:44 INFO     evaluating now!
2024-05-02 00:02:44 INFO     Epoch [7/200] train_loss: 6.0877, val_loss: 6.2000, lr: 0.003000, 6.31s
2024-05-02 00:02:44 INFO     Saved model at 7
2024-05-02 00:02:44 INFO     Val loss decrease from 6.2876 to 6.2000, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 00:02:50 INFO     epoch complete!
2024-05-02 00:02:50 INFO     evaluating now!
2024-05-02 00:02:51 INFO     Epoch [8/200] train_loss: 5.8932, val_loss: 5.9912, lr: 0.003000, 6.30s
2024-05-02 00:02:51 INFO     Saved model at 8
2024-05-02 00:02:51 INFO     Val loss decrease from 6.2000 to 5.9912, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 00:02:56 INFO     epoch complete!
2024-05-02 00:02:56 INFO     evaluating now!
2024-05-02 00:02:57 INFO     Epoch [9/200] train_loss: 5.7016, val_loss: 5.9381, lr: 0.003000, 6.31s
2024-05-02 00:02:57 INFO     Saved model at 9
2024-05-02 00:02:57 INFO     Val loss decrease from 5.9912 to 5.9381, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 00:03:03 INFO     epoch complete!
2024-05-02 00:03:03 INFO     evaluating now!
2024-05-02 00:03:03 INFO     Epoch [10/200] train_loss: 5.5073, val_loss: 6.0124, lr: 0.003000, 6.29s
2024-05-02 00:03:09 INFO     epoch complete!
2024-05-02 00:03:09 INFO     evaluating now!
2024-05-02 00:03:10 INFO     Epoch [11/200] train_loss: 5.4772, val_loss: 5.9048, lr: 0.003000, 6.25s
2024-05-02 00:03:10 INFO     Saved model at 11
2024-05-02 00:03:10 INFO     Val loss decrease from 5.9381 to 5.9048, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 00:03:15 INFO     epoch complete!
2024-05-02 00:03:15 INFO     evaluating now!
2024-05-02 00:03:16 INFO     Epoch [12/200] train_loss: 5.2851, val_loss: 5.5899, lr: 0.003000, 6.25s
2024-05-02 00:03:16 INFO     Saved model at 12
2024-05-02 00:03:16 INFO     Val loss decrease from 5.9048 to 5.5899, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 00:03:22 INFO     epoch complete!
2024-05-02 00:03:22 INFO     evaluating now!
2024-05-02 00:03:22 INFO     Epoch [13/200] train_loss: 5.1628, val_loss: 5.6417, lr: 0.003000, 6.40s
2024-05-02 00:03:28 INFO     epoch complete!
2024-05-02 00:03:28 INFO     evaluating now!
2024-05-02 00:03:29 INFO     Epoch [14/200] train_loss: 5.1195, val_loss: 5.6318, lr: 0.003000, 6.30s
2024-05-02 00:03:34 INFO     epoch complete!
2024-05-02 00:03:34 INFO     evaluating now!
2024-05-02 00:03:35 INFO     Epoch [15/200] train_loss: 4.9298, val_loss: 5.2825, lr: 0.003000, 6.32s
2024-05-02 00:03:35 INFO     Saved model at 15
2024-05-02 00:03:35 INFO     Val loss decrease from 5.5899 to 5.2825, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-02 00:03:41 INFO     epoch complete!
2024-05-02 00:03:41 INFO     evaluating now!
2024-05-02 00:03:41 INFO     Epoch [16/200] train_loss: 4.9376, val_loss: 5.6047, lr: 0.003000, 6.27s
2024-05-02 00:03:47 INFO     epoch complete!
2024-05-02 00:03:47 INFO     evaluating now!
2024-05-02 00:03:48 INFO     Epoch [17/200] train_loss: 4.9030, val_loss: 5.4038, lr: 0.003000, 6.38s
2024-05-02 00:03:54 INFO     epoch complete!
2024-05-02 00:03:54 INFO     evaluating now!
2024-05-02 00:03:54 INFO     Epoch [18/200] train_loss: 4.7657, val_loss: 5.3073, lr: 0.003000, 6.42s
2024-05-02 00:04:00 INFO     epoch complete!
2024-05-02 00:04:00 INFO     evaluating now!
2024-05-02 00:04:00 INFO     Epoch [19/200] train_loss: 4.7047, val_loss: 5.1663, lr: 0.003000, 6.29s
2024-05-02 00:04:00 INFO     Saved model at 19
2024-05-02 00:04:00 INFO     Val loss decrease from 5.2825 to 5.1663, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-02 00:04:06 INFO     epoch complete!
2024-05-02 00:04:06 INFO     evaluating now!
2024-05-02 00:04:07 INFO     Epoch [20/200] train_loss: 4.6401, val_loss: 5.2553, lr: 0.003000, 6.43s
2024-05-02 00:04:13 INFO     epoch complete!
2024-05-02 00:04:13 INFO     evaluating now!
2024-05-02 00:04:13 INFO     Epoch [21/200] train_loss: 4.6004, val_loss: 5.1212, lr: 0.003000, 6.28s
2024-05-02 00:04:13 INFO     Saved model at 21
2024-05-02 00:04:13 INFO     Val loss decrease from 5.1663 to 5.1212, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-02 00:04:19 INFO     epoch complete!
2024-05-02 00:04:19 INFO     evaluating now!
2024-05-02 00:04:19 INFO     Epoch [22/200] train_loss: 4.4733, val_loss: 5.0886, lr: 0.003000, 6.41s
2024-05-02 00:04:20 INFO     Saved model at 22
2024-05-02 00:04:20 INFO     Val loss decrease from 5.1212 to 5.0886, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-02 00:04:25 INFO     epoch complete!
2024-05-02 00:04:25 INFO     evaluating now!
2024-05-02 00:04:26 INFO     Epoch [23/200] train_loss: 4.4123, val_loss: 5.0683, lr: 0.003000, 6.27s
2024-05-02 00:04:26 INFO     Saved model at 23
2024-05-02 00:04:26 INFO     Val loss decrease from 5.0886 to 5.0683, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-05-02 00:04:32 INFO     epoch complete!
2024-05-02 00:04:32 INFO     evaluating now!
2024-05-02 00:04:32 INFO     Epoch [24/200] train_loss: 4.3800, val_loss: 5.0170, lr: 0.003000, 6.32s
2024-05-02 00:04:32 INFO     Saved model at 24
2024-05-02 00:04:32 INFO     Val loss decrease from 5.0683 to 5.0170, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-02 00:04:38 INFO     epoch complete!
2024-05-02 00:04:38 INFO     evaluating now!
2024-05-02 00:04:39 INFO     Epoch [25/200] train_loss: 4.3701, val_loss: 5.1459, lr: 0.003000, 6.28s
2024-05-02 00:04:45 INFO     epoch complete!
2024-05-02 00:04:45 INFO     evaluating now!
2024-05-02 00:04:45 INFO     Epoch [26/200] train_loss: 4.3789, val_loss: 5.1638, lr: 0.003000, 6.58s
2024-05-02 00:04:51 INFO     epoch complete!
2024-05-02 00:04:51 INFO     evaluating now!
2024-05-02 00:04:52 INFO     Epoch [27/200] train_loss: 4.2964, val_loss: 5.1518, lr: 0.003000, 6.46s
2024-05-02 00:04:58 INFO     epoch complete!
2024-05-02 00:04:58 INFO     evaluating now!
2024-05-02 00:04:58 INFO     Epoch [28/200] train_loss: 4.2506, val_loss: 5.0545, lr: 0.003000, 6.50s
2024-05-02 00:05:04 INFO     epoch complete!
2024-05-02 00:05:04 INFO     evaluating now!
2024-05-02 00:05:05 INFO     Epoch [29/200] train_loss: 4.1617, val_loss: 5.1087, lr: 0.003000, 6.58s
2024-05-02 00:05:11 INFO     epoch complete!
2024-05-02 00:05:11 INFO     evaluating now!
2024-05-02 00:05:12 INFO     Epoch [30/200] train_loss: 4.1262, val_loss: 4.9907, lr: 0.003000, 6.95s
2024-05-02 00:05:12 INFO     Saved model at 30
2024-05-02 00:05:12 INFO     Val loss decrease from 5.0170 to 4.9907, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-05-02 00:05:18 INFO     epoch complete!
2024-05-02 00:05:18 INFO     evaluating now!
2024-05-02 00:05:18 INFO     Epoch [31/200] train_loss: 4.0794, val_loss: 5.1140, lr: 0.003000, 6.54s
2024-05-02 00:05:24 INFO     epoch complete!
2024-05-02 00:05:24 INFO     evaluating now!
2024-05-02 00:05:24 INFO     Epoch [32/200] train_loss: 4.1194, val_loss: 5.0225, lr: 0.003000, 6.32s
2024-05-02 00:05:31 INFO     epoch complete!
2024-05-02 00:05:31 INFO     evaluating now!
2024-05-02 00:05:31 INFO     Epoch [33/200] train_loss: 4.0630, val_loss: 5.1175, lr: 0.003000, 6.80s
2024-05-02 00:05:38 INFO     epoch complete!
2024-05-02 00:05:38 INFO     evaluating now!
2024-05-02 00:05:38 INFO     Epoch [34/200] train_loss: 3.9874, val_loss: 4.9958, lr: 0.003000, 6.94s
2024-05-02 00:05:45 INFO     epoch complete!
2024-05-02 00:05:45 INFO     evaluating now!
2024-05-02 00:05:45 INFO     Epoch [35/200] train_loss: 3.9728, val_loss: 5.1630, lr: 0.003000, 6.89s
2024-05-02 00:05:52 INFO     epoch complete!
2024-05-02 00:05:52 INFO     evaluating now!
2024-05-02 00:05:52 INFO     Epoch [36/200] train_loss: 3.9798, val_loss: 4.9275, lr: 0.003000, 6.86s
2024-05-02 00:05:52 INFO     Saved model at 36
2024-05-02 00:05:52 INFO     Val loss decrease from 4.9907 to 4.9275, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-05-02 00:05:58 INFO     epoch complete!
2024-05-02 00:05:58 INFO     evaluating now!
2024-05-02 00:05:59 INFO     Epoch [37/200] train_loss: 3.9723, val_loss: 5.0161, lr: 0.003000, 6.73s
2024-05-02 00:06:05 INFO     epoch complete!
2024-05-02 00:06:05 INFO     evaluating now!
2024-05-02 00:06:06 INFO     Epoch [38/200] train_loss: 3.9257, val_loss: 5.0357, lr: 0.003000, 6.88s
2024-05-02 00:06:12 INFO     epoch complete!
2024-05-02 00:06:12 INFO     evaluating now!
2024-05-02 00:06:12 INFO     Epoch [39/200] train_loss: 3.8575, val_loss: 5.0846, lr: 0.003000, 6.82s
2024-05-02 00:06:19 INFO     epoch complete!
2024-05-02 00:06:19 INFO     evaluating now!
2024-05-02 00:06:19 INFO     Epoch [40/200] train_loss: 3.8342, val_loss: 4.9526, lr: 0.003000, 6.80s
2024-05-02 00:06:26 INFO     epoch complete!
2024-05-02 00:06:26 INFO     evaluating now!
2024-05-02 00:06:26 INFO     Epoch [41/200] train_loss: 3.8318, val_loss: 5.0713, lr: 0.003000, 6.80s
2024-05-02 00:06:33 INFO     epoch complete!
2024-05-02 00:06:33 INFO     evaluating now!
2024-05-02 00:06:33 INFO     Epoch [42/200] train_loss: 3.8228, val_loss: 4.9755, lr: 0.003000, 6.89s
2024-05-02 00:06:39 INFO     epoch complete!
2024-05-02 00:06:39 INFO     evaluating now!
2024-05-02 00:06:40 INFO     Epoch [43/200] train_loss: 3.7772, val_loss: 4.9448, lr: 0.003000, 6.79s
2024-05-02 00:06:45 INFO     epoch complete!
2024-05-02 00:06:45 INFO     evaluating now!
2024-05-02 00:06:46 INFO     Epoch [44/200] train_loss: 3.7440, val_loss: 5.0400, lr: 0.003000, 6.01s
2024-05-02 00:06:52 INFO     epoch complete!
2024-05-02 00:06:52 INFO     evaluating now!
2024-05-02 00:06:52 INFO     Epoch [45/200] train_loss: 3.7378, val_loss: 5.1579, lr: 0.003000, 6.51s
2024-05-02 00:06:59 INFO     epoch complete!
2024-05-02 00:06:59 INFO     evaluating now!
2024-05-02 00:07:00 INFO     Epoch [46/200] train_loss: 3.7077, val_loss: 5.1213, lr: 0.003000, 7.43s
2024-05-02 00:07:06 INFO     epoch complete!
2024-05-02 00:07:06 INFO     evaluating now!
2024-05-02 00:07:07 INFO     Epoch [47/200] train_loss: 3.6803, val_loss: 5.0233, lr: 0.003000, 7.00s
2024-05-02 00:07:13 INFO     epoch complete!
2024-05-02 00:07:13 INFO     evaluating now!
2024-05-02 00:07:13 INFO     Epoch [48/200] train_loss: 3.7141, val_loss: 5.0632, lr: 0.003000, 6.76s
2024-05-02 00:07:20 INFO     epoch complete!
2024-05-02 00:07:20 INFO     evaluating now!
2024-05-02 00:07:20 INFO     Epoch [49/200] train_loss: 3.6820, val_loss: 4.9682, lr: 0.003000, 6.87s
2024-05-02 00:07:27 INFO     epoch complete!
2024-05-02 00:07:27 INFO     evaluating now!
2024-05-02 00:07:27 INFO     Epoch [50/200] train_loss: 3.6288, val_loss: 5.0151, lr: 0.003000, 6.88s
2024-05-02 00:07:34 INFO     epoch complete!
2024-05-02 00:07:34 INFO     evaluating now!
2024-05-02 00:07:34 INFO     Epoch [51/200] train_loss: 3.6265, val_loss: 4.9870, lr: 0.003000, 6.81s
2024-05-02 00:07:34 WARNING  Early stopping at epoch: 51
2024-05-02 00:07:34 INFO     Trained totally 52 epochs, average train time is 6.105s, average eval time is 0.424s
2024-05-02 00:07:34 INFO     Loaded model at 36
2024-05-02 00:07:34 INFO     Saved model at ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 00:07:34 INFO     Start evaluating ...
2024-05-02 00:07:36 INFO     Note that you select the single mode to evaluate!
2024-05-02 00:07:36 INFO     Evaluate result is saved at ./libcity/cache/60/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-02 00:07:36 INFO     
         MAE       RMSE
1   2.354921   6.820118
2   2.453490   7.657228
3   2.650039   8.709702
4   2.761646   9.354836
5   2.845640   9.949169
6   2.939039  10.586270
7   3.032142  11.280182
8   3.124652  11.902622
9   3.272969  12.411091
10  3.352658  12.835574
11  3.479038  13.442840
12  3.623807  14.190628
2024-05-02 00:07:36 INFO     ----------------------------------------------------------------------------
2024-05-02 00:07:36 INFO     # 3, Kownledge Graph Embedding: RandomE, Experiment ids: 63
2024-05-02 00:07:36 INFO     ----------------------------------------------------------------------------
2024-05-02 00:07:36 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=60
2024-05-02 00:07:36 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 60, 'load_external': True, 'embedding_model': 'RandomE', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 00:07:36 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 00:07:36 INFO     set_weight_link_or_dist: dist
2024-05-02 00:07:36 INFO     init_weight_inf_or_zero: inf
2024-05-02 00:07:36 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 00:07:36 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 00:07:36 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 00:07:36 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 00:07:39 INFO     Dataset created
2024-05-02 00:07:39 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-02 00:07:39 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-02 00:07:39 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-02 00:07:39 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-02 00:07:39 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 00:07:39 INFO     NormalScaler max: 0.0028067830852947636
2024-05-02 00:07:43 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 00:07:43 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 00:07:43 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-02 00:07:43 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 00:07:43 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-02 00:07:43 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 00:07:43 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 00:07:43 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 00:07:43 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 00:07:43 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 00:07:43 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 00:07:43 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 00:07:43 INFO     Total parameter numbers: 874010
2024-05-02 00:07:43 INFO     You select `adam` optimizer.
2024-05-02 00:07:43 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 00:07:43 INFO     Start training ...
2024-05-02 00:07:43 INFO     num_batches:48
2024-05-02 00:07:49 INFO     epoch complete!
2024-05-02 00:07:49 INFO     evaluating now!
2024-05-02 00:07:49 INFO     Epoch [0/200] train_loss: 25.7675, val_loss: 17.9830, lr: 0.003000, 6.78s
2024-05-02 00:07:49 INFO     Saved model at 0
2024-05-02 00:07:49 INFO     Val loss decrease from inf to 17.9830, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 00:07:56 INFO     epoch complete!
2024-05-02 00:07:56 INFO     evaluating now!
2024-05-02 00:07:56 INFO     Epoch [1/200] train_loss: 14.6795, val_loss: 14.1318, lr: 0.003000, 6.81s
2024-05-02 00:07:56 INFO     Saved model at 1
2024-05-02 00:07:56 INFO     Val loss decrease from 17.9830 to 14.1318, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 00:08:03 INFO     epoch complete!
2024-05-02 00:08:03 INFO     evaluating now!
2024-05-02 00:08:03 INFO     Epoch [2/200] train_loss: 11.9007, val_loss: 11.1707, lr: 0.003000, 6.92s
2024-05-02 00:08:03 INFO     Saved model at 2
2024-05-02 00:08:03 INFO     Val loss decrease from 14.1318 to 11.1707, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 00:08:10 INFO     epoch complete!
2024-05-02 00:08:10 INFO     evaluating now!
2024-05-02 00:08:10 INFO     Epoch [3/200] train_loss: 9.3638, val_loss: 8.6949, lr: 0.003000, 6.77s
2024-05-02 00:08:10 INFO     Saved model at 3
2024-05-02 00:08:10 INFO     Val loss decrease from 11.1707 to 8.6949, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 00:08:16 INFO     epoch complete!
2024-05-02 00:08:16 INFO     evaluating now!
2024-05-02 00:08:17 INFO     Epoch [4/200] train_loss: 7.9760, val_loss: 8.0615, lr: 0.003000, 6.91s
2024-05-02 00:08:17 INFO     Saved model at 4
2024-05-02 00:08:17 INFO     Val loss decrease from 8.6949 to 8.0615, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 00:08:23 INFO     epoch complete!
2024-05-02 00:08:24 INFO     evaluating now!
2024-05-02 00:08:24 INFO     Epoch [5/200] train_loss: 7.2295, val_loss: 6.9443, lr: 0.003000, 6.98s
2024-05-02 00:08:24 INFO     Saved model at 5
2024-05-02 00:08:24 INFO     Val loss decrease from 8.0615 to 6.9443, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 00:08:30 INFO     epoch complete!
2024-05-02 00:08:30 INFO     evaluating now!
2024-05-02 00:08:31 INFO     Epoch [6/200] train_loss: 6.7542, val_loss: 6.5258, lr: 0.003000, 6.88s
2024-05-02 00:08:31 INFO     Saved model at 6
2024-05-02 00:08:31 INFO     Val loss decrease from 6.9443 to 6.5258, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 00:08:37 INFO     epoch complete!
2024-05-02 00:08:37 INFO     evaluating now!
2024-05-02 00:08:38 INFO     Epoch [7/200] train_loss: 6.3937, val_loss: 6.4376, lr: 0.003000, 6.95s
2024-05-02 00:08:38 INFO     Saved model at 7
2024-05-02 00:08:38 INFO     Val loss decrease from 6.5258 to 6.4376, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 00:08:44 INFO     epoch complete!
2024-05-02 00:08:44 INFO     evaluating now!
2024-05-02 00:08:45 INFO     Epoch [8/200] train_loss: 5.9901, val_loss: 6.0928, lr: 0.003000, 6.88s
2024-05-02 00:08:45 INFO     Saved model at 8
2024-05-02 00:08:45 INFO     Val loss decrease from 6.4376 to 6.0928, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 00:08:51 INFO     epoch complete!
2024-05-02 00:08:51 INFO     evaluating now!
2024-05-02 00:08:52 INFO     Epoch [9/200] train_loss: 5.8521, val_loss: 6.0164, lr: 0.003000, 6.90s
2024-05-02 00:08:52 INFO     Saved model at 9
2024-05-02 00:08:52 INFO     Val loss decrease from 6.0928 to 6.0164, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 00:08:58 INFO     epoch complete!
2024-05-02 00:08:58 INFO     evaluating now!
2024-05-02 00:08:59 INFO     Epoch [10/200] train_loss: 5.7832, val_loss: 6.0190, lr: 0.003000, 6.76s
2024-05-02 00:09:05 INFO     epoch complete!
2024-05-02 00:09:05 INFO     evaluating now!
2024-05-02 00:09:05 INFO     Epoch [11/200] train_loss: 5.5266, val_loss: 5.9346, lr: 0.003000, 6.82s
2024-05-02 00:09:05 INFO     Saved model at 11
2024-05-02 00:09:05 INFO     Val loss decrease from 6.0164 to 5.9346, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 00:09:12 INFO     epoch complete!
2024-05-02 00:09:12 INFO     evaluating now!
2024-05-02 00:09:12 INFO     Epoch [12/200] train_loss: 5.4649, val_loss: 5.7101, lr: 0.003000, 6.88s
2024-05-02 00:09:12 INFO     Saved model at 12
2024-05-02 00:09:12 INFO     Val loss decrease from 5.9346 to 5.7101, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 00:09:19 INFO     epoch complete!
2024-05-02 00:09:19 INFO     evaluating now!
2024-05-02 00:09:19 INFO     Epoch [13/200] train_loss: 5.3200, val_loss: 5.9993, lr: 0.003000, 6.78s
2024-05-02 00:09:26 INFO     epoch complete!
2024-05-02 00:09:26 INFO     evaluating now!
2024-05-02 00:09:26 INFO     Epoch [14/200] train_loss: 5.1826, val_loss: 5.7256, lr: 0.003000, 7.00s
2024-05-02 00:09:33 INFO     epoch complete!
2024-05-02 00:09:33 INFO     evaluating now!
2024-05-02 00:09:33 INFO     Epoch [15/200] train_loss: 5.1408, val_loss: 5.4880, lr: 0.003000, 6.85s
2024-05-02 00:09:33 INFO     Saved model at 15
2024-05-02 00:09:33 INFO     Val loss decrease from 5.7101 to 5.4880, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-02 00:09:39 INFO     epoch complete!
2024-05-02 00:09:39 INFO     evaluating now!
2024-05-02 00:09:40 INFO     Epoch [16/200] train_loss: 5.0361, val_loss: 5.5174, lr: 0.003000, 6.75s
2024-05-02 00:09:46 INFO     epoch complete!
2024-05-02 00:09:46 INFO     evaluating now!
2024-05-02 00:09:47 INFO     Epoch [17/200] train_loss: 4.8899, val_loss: 5.2106, lr: 0.003000, 6.88s
2024-05-02 00:09:47 INFO     Saved model at 17
2024-05-02 00:09:47 INFO     Val loss decrease from 5.4880 to 5.2106, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-02 00:09:53 INFO     epoch complete!
2024-05-02 00:09:53 INFO     evaluating now!
2024-05-02 00:09:53 INFO     Epoch [18/200] train_loss: 4.8393, val_loss: 5.5986, lr: 0.003000, 6.78s
2024-05-02 00:10:00 INFO     epoch complete!
2024-05-02 00:10:00 INFO     evaluating now!
2024-05-02 00:10:00 INFO     Epoch [19/200] train_loss: 4.8744, val_loss: 5.4404, lr: 0.003000, 6.93s
2024-05-02 00:10:07 INFO     epoch complete!
2024-05-02 00:10:07 INFO     evaluating now!
2024-05-02 00:10:07 INFO     Epoch [20/200] train_loss: 4.7389, val_loss: 5.3891, lr: 0.003000, 6.87s
2024-05-02 00:10:14 INFO     epoch complete!
2024-05-02 00:10:14 INFO     evaluating now!
2024-05-02 00:10:14 INFO     Epoch [21/200] train_loss: 4.6685, val_loss: 5.2504, lr: 0.003000, 6.95s
2024-05-02 00:10:21 INFO     epoch complete!
2024-05-02 00:10:21 INFO     evaluating now!
2024-05-02 00:10:21 INFO     Epoch [22/200] train_loss: 4.6388, val_loss: 5.2771, lr: 0.003000, 6.82s
2024-05-02 00:10:28 INFO     epoch complete!
2024-05-02 00:10:28 INFO     evaluating now!
2024-05-02 00:10:28 INFO     Epoch [23/200] train_loss: 4.5203, val_loss: 5.2080, lr: 0.003000, 6.99s
2024-05-02 00:10:28 INFO     Saved model at 23
2024-05-02 00:10:28 INFO     Val loss decrease from 5.2106 to 5.2080, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-05-02 00:10:34 INFO     epoch complete!
2024-05-02 00:10:34 INFO     evaluating now!
2024-05-02 00:10:35 INFO     Epoch [24/200] train_loss: 4.4761, val_loss: 5.2709, lr: 0.003000, 6.65s
2024-05-02 00:10:41 INFO     epoch complete!
2024-05-02 00:10:41 INFO     evaluating now!
2024-05-02 00:10:41 INFO     Epoch [25/200] train_loss: 4.5011, val_loss: 5.1994, lr: 0.003000, 6.60s
2024-05-02 00:10:41 INFO     Saved model at 25
2024-05-02 00:10:41 INFO     Val loss decrease from 5.2080 to 5.1994, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-02 00:10:48 INFO     epoch complete!
2024-05-02 00:10:48 INFO     evaluating now!
2024-05-02 00:10:48 INFO     Epoch [26/200] train_loss: 4.4077, val_loss: 5.2124, lr: 0.003000, 6.90s
2024-05-02 00:10:55 INFO     epoch complete!
2024-05-02 00:10:55 INFO     evaluating now!
2024-05-02 00:10:55 INFO     Epoch [27/200] train_loss: 4.4042, val_loss: 5.2229, lr: 0.003000, 7.00s
2024-05-02 00:11:02 INFO     epoch complete!
2024-05-02 00:11:02 INFO     evaluating now!
2024-05-02 00:11:02 INFO     Epoch [28/200] train_loss: 4.4183, val_loss: 5.2688, lr: 0.003000, 6.95s
2024-05-02 00:11:09 INFO     epoch complete!
2024-05-02 00:11:09 INFO     evaluating now!
2024-05-02 00:11:09 INFO     Epoch [29/200] train_loss: 4.2985, val_loss: 5.2982, lr: 0.003000, 6.81s
2024-05-02 00:11:15 INFO     epoch complete!
2024-05-02 00:11:15 INFO     evaluating now!
2024-05-02 00:11:16 INFO     Epoch [30/200] train_loss: 4.2344, val_loss: 5.2975, lr: 0.003000, 6.89s
2024-05-02 00:11:23 INFO     epoch complete!
2024-05-02 00:11:23 INFO     evaluating now!
2024-05-02 00:11:23 INFO     Epoch [31/200] train_loss: 4.1399, val_loss: 5.1507, lr: 0.003000, 7.55s
2024-05-02 00:11:23 INFO     Saved model at 31
2024-05-02 00:11:23 INFO     Val loss decrease from 5.1994 to 5.1507, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-05-02 00:11:31 INFO     epoch complete!
2024-05-02 00:11:31 INFO     evaluating now!
2024-05-02 00:11:31 INFO     Epoch [32/200] train_loss: 4.1615, val_loss: 5.3552, lr: 0.003000, 7.56s
2024-05-02 00:11:38 INFO     epoch complete!
2024-05-02 00:11:38 INFO     evaluating now!
2024-05-02 00:11:39 INFO     Epoch [33/200] train_loss: 4.1210, val_loss: 5.2099, lr: 0.003000, 7.68s
2024-05-02 00:11:46 INFO     epoch complete!
2024-05-02 00:11:46 INFO     evaluating now!
2024-05-02 00:11:46 INFO     Epoch [34/200] train_loss: 4.0505, val_loss: 5.1941, lr: 0.003000, 7.69s
2024-05-02 00:11:53 INFO     epoch complete!
2024-05-02 00:11:53 INFO     evaluating now!
2024-05-02 00:11:54 INFO     Epoch [35/200] train_loss: 4.0488, val_loss: 5.3802, lr: 0.003000, 7.49s
2024-05-02 00:12:01 INFO     epoch complete!
2024-05-02 00:12:01 INFO     evaluating now!
2024-05-02 00:12:01 INFO     Epoch [36/200] train_loss: 3.9912, val_loss: 5.1814, lr: 0.003000, 7.29s
2024-05-02 00:12:08 INFO     epoch complete!
2024-05-02 00:12:08 INFO     evaluating now!
2024-05-02 00:12:09 INFO     Epoch [37/200] train_loss: 3.9587, val_loss: 5.2831, lr: 0.003000, 7.48s
2024-05-02 00:12:16 INFO     epoch complete!
2024-05-02 00:12:16 INFO     evaluating now!
2024-05-02 00:12:16 INFO     Epoch [38/200] train_loss: 3.9620, val_loss: 5.4363, lr: 0.003000, 7.50s
2024-05-02 00:12:23 INFO     epoch complete!
2024-05-02 00:12:23 INFO     evaluating now!
2024-05-02 00:12:24 INFO     Epoch [39/200] train_loss: 3.9890, val_loss: 5.2445, lr: 0.003000, 7.39s
2024-05-02 00:12:30 INFO     epoch complete!
2024-05-02 00:12:30 INFO     evaluating now!
2024-05-02 00:12:31 INFO     Epoch [40/200] train_loss: 3.9569, val_loss: 5.3455, lr: 0.003000, 7.33s
2024-05-02 00:12:38 INFO     epoch complete!
2024-05-02 00:12:38 INFO     evaluating now!
2024-05-02 00:12:38 INFO     Epoch [41/200] train_loss: 3.8208, val_loss: 5.1175, lr: 0.003000, 7.37s
2024-05-02 00:12:38 INFO     Saved model at 41
2024-05-02 00:12:38 INFO     Val loss decrease from 5.1507 to 5.1175, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-05-02 00:12:45 INFO     epoch complete!
2024-05-02 00:12:45 INFO     evaluating now!
2024-05-02 00:12:46 INFO     Epoch [42/200] train_loss: 3.8091, val_loss: 5.1611, lr: 0.003000, 7.42s
2024-05-02 00:12:53 INFO     epoch complete!
2024-05-02 00:12:53 INFO     evaluating now!
2024-05-02 00:12:53 INFO     Epoch [43/200] train_loss: 3.8219, val_loss: 5.0878, lr: 0.003000, 7.41s
2024-05-02 00:12:53 INFO     Saved model at 43
2024-05-02 00:12:53 INFO     Val loss decrease from 5.1175 to 5.0878, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-05-02 00:13:00 INFO     epoch complete!
2024-05-02 00:13:00 INFO     evaluating now!
2024-05-02 00:13:00 INFO     Epoch [44/200] train_loss: 3.7975, val_loss: 5.1817, lr: 0.003000, 7.19s
2024-05-02 00:13:07 INFO     epoch complete!
2024-05-02 00:13:07 INFO     evaluating now!
2024-05-02 00:13:08 INFO     Epoch [45/200] train_loss: 3.7812, val_loss: 5.2123, lr: 0.003000, 7.12s
2024-05-02 00:13:14 INFO     epoch complete!
2024-05-02 00:13:14 INFO     evaluating now!
2024-05-02 00:13:15 INFO     Epoch [46/200] train_loss: 3.7413, val_loss: 5.3354, lr: 0.003000, 7.26s
2024-05-02 00:13:22 INFO     epoch complete!
2024-05-02 00:13:22 INFO     evaluating now!
2024-05-02 00:13:22 INFO     Epoch [47/200] train_loss: 3.7139, val_loss: 5.2832, lr: 0.003000, 7.40s
2024-05-02 00:13:29 INFO     epoch complete!
2024-05-02 00:13:29 INFO     evaluating now!
2024-05-02 00:13:29 INFO     Epoch [48/200] train_loss: 3.7154, val_loss: 5.1874, lr: 0.003000, 7.21s
2024-05-02 00:13:36 INFO     epoch complete!
2024-05-02 00:13:36 INFO     evaluating now!
2024-05-02 00:13:37 INFO     Epoch [49/200] train_loss: 3.6588, val_loss: 5.3266, lr: 0.003000, 7.18s
2024-05-02 00:13:43 INFO     epoch complete!
2024-05-02 00:13:43 INFO     evaluating now!
2024-05-02 00:13:44 INFO     Epoch [50/200] train_loss: 3.6642, val_loss: 5.1261, lr: 0.003000, 7.16s
2024-05-02 00:13:50 INFO     epoch complete!
2024-05-02 00:13:50 INFO     evaluating now!
2024-05-02 00:13:51 INFO     Epoch [51/200] train_loss: 3.6076, val_loss: 5.2710, lr: 0.003000, 7.18s
2024-05-02 00:13:58 INFO     epoch complete!
2024-05-02 00:13:58 INFO     evaluating now!
2024-05-02 00:13:58 INFO     Epoch [52/200] train_loss: 3.6049, val_loss: 5.2457, lr: 0.003000, 7.21s
2024-05-02 00:14:05 INFO     epoch complete!
2024-05-02 00:14:05 INFO     evaluating now!
2024-05-02 00:14:05 INFO     Epoch [53/200] train_loss: 3.6052, val_loss: 5.1142, lr: 0.003000, 7.22s
2024-05-02 00:14:12 INFO     epoch complete!
2024-05-02 00:14:12 INFO     evaluating now!
2024-05-02 00:14:13 INFO     Epoch [54/200] train_loss: 3.5706, val_loss: 5.1704, lr: 0.003000, 7.30s
2024-05-02 00:14:19 INFO     epoch complete!
2024-05-02 00:14:19 INFO     evaluating now!
2024-05-02 00:14:20 INFO     Epoch [55/200] train_loss: 3.5627, val_loss: 5.2087, lr: 0.003000, 7.31s
2024-05-02 00:14:27 INFO     epoch complete!
2024-05-02 00:14:27 INFO     evaluating now!
2024-05-02 00:14:27 INFO     Epoch [56/200] train_loss: 3.5385, val_loss: 5.1207, lr: 0.003000, 7.32s
2024-05-02 00:14:34 INFO     epoch complete!
2024-05-02 00:14:34 INFO     evaluating now!
2024-05-02 00:14:35 INFO     Epoch [57/200] train_loss: 3.5260, val_loss: 5.2258, lr: 0.003000, 7.32s
2024-05-02 00:14:41 INFO     epoch complete!
2024-05-02 00:14:41 INFO     evaluating now!
2024-05-02 00:14:42 INFO     Epoch [58/200] train_loss: 3.5345, val_loss: 5.1245, lr: 0.003000, 7.28s
2024-05-02 00:14:42 WARNING  Early stopping at epoch: 58
2024-05-02 00:14:42 INFO     Trained totally 59 epochs, average train time is 6.625s, average eval time is 0.466s
2024-05-02 00:14:42 INFO     Loaded model at 43
2024-05-02 00:14:42 INFO     Saved model at ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 00:14:42 INFO     Start evaluating ...
2024-05-02 00:14:44 INFO     Note that you select the single mode to evaluate!
2024-05-02 00:14:44 INFO     Evaluate result is saved at ./libcity/cache/60/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-02 00:14:44 INFO     
         MAE       RMSE
1   2.407172   8.300695
2   2.475285   8.467342
3   2.617977   8.881260
4   2.717548   9.312589
5   2.855881  10.174745
6   3.087048  11.555281
7   3.179048  12.670991
8   3.290399  13.675656
9   3.331842  13.910076
10  3.396590  13.851747
11  3.406809  13.881999
12  3.456719  13.890291
2024-05-02 00:14:44 INFO     ----------------------------------------------------------------------------
2024-05-02 00:14:44 INFO     # 4, Kownledge Graph Embedding: RandomE, Experiment ids: 64
2024-05-02 00:14:44 INFO     ----------------------------------------------------------------------------
2024-05-02 00:14:44 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=60
2024-05-02 00:14:44 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 60, 'load_external': True, 'embedding_model': 'RandomE', 'normal_external': True, 'ext_scaler': 'normal', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 00:14:44 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 00:14:44 INFO     set_weight_link_or_dist: dist
2024-05-02 00:14:44 INFO     init_weight_inf_or_zero: inf
2024-05-02 00:14:44 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 00:14:44 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 00:14:44 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 00:14:44 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 00:14:47 INFO     Dataset created
2024-05-02 00:14:47 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-02 00:14:47 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-02 00:14:47 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-02 00:14:47 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-02 00:14:47 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 00:14:48 INFO     NormalScaler max: 0.0028067830852947636
2024-05-02 00:14:51 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 00:14:51 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 00:14:51 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-02 00:14:51 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 00:14:51 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-02 00:14:51 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 00:14:51 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 00:14:51 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 00:14:51 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 00:14:51 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 00:14:51 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 00:14:51 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 00:14:51 INFO     Total parameter numbers: 874010
2024-05-02 00:14:51 INFO     You select `adam` optimizer.
2024-05-02 00:14:51 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 00:14:51 INFO     Start training ...
2024-05-02 00:14:51 INFO     num_batches:48
2024-05-02 00:14:58 INFO     epoch complete!
2024-05-02 00:14:58 INFO     evaluating now!
2024-05-02 00:14:58 INFO     Epoch [0/200] train_loss: 23.8857, val_loss: 17.8157, lr: 0.003000, 7.42s
2024-05-02 00:14:58 INFO     Saved model at 0
2024-05-02 00:14:58 INFO     Val loss decrease from inf to 17.8157, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 00:15:05 INFO     epoch complete!
2024-05-02 00:15:05 INFO     evaluating now!
2024-05-02 00:15:06 INFO     Epoch [1/200] train_loss: 14.0696, val_loss: 12.7438, lr: 0.003000, 7.30s
2024-05-02 00:15:06 INFO     Saved model at 1
2024-05-02 00:15:06 INFO     Val loss decrease from 17.8157 to 12.7438, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 00:15:12 INFO     epoch complete!
2024-05-02 00:15:12 INFO     evaluating now!
2024-05-02 00:15:13 INFO     Epoch [2/200] train_loss: 10.5535, val_loss: 9.8804, lr: 0.003000, 7.24s
2024-05-02 00:15:13 INFO     Saved model at 2
2024-05-02 00:15:13 INFO     Val loss decrease from 12.7438 to 9.8804, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 00:15:20 INFO     epoch complete!
2024-05-02 00:15:20 INFO     evaluating now!
2024-05-02 00:15:20 INFO     Epoch [3/200] train_loss: 8.7369, val_loss: 8.3130, lr: 0.003000, 7.21s
2024-05-02 00:15:20 INFO     Saved model at 3
2024-05-02 00:15:20 INFO     Val loss decrease from 9.8804 to 8.3130, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 00:15:27 INFO     epoch complete!
2024-05-02 00:15:27 INFO     evaluating now!
2024-05-02 00:15:28 INFO     Epoch [4/200] train_loss: 7.5015, val_loss: 7.2905, lr: 0.003000, 7.37s
2024-05-02 00:15:28 INFO     Saved model at 4
2024-05-02 00:15:28 INFO     Val loss decrease from 8.3130 to 7.2905, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 00:15:35 INFO     epoch complete!
2024-05-02 00:15:35 INFO     evaluating now!
2024-05-02 00:15:35 INFO     Epoch [5/200] train_loss: 6.8888, val_loss: 6.6838, lr: 0.003000, 7.49s
2024-05-02 00:15:35 INFO     Saved model at 5
2024-05-02 00:15:35 INFO     Val loss decrease from 7.2905 to 6.6838, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 00:15:42 INFO     epoch complete!
2024-05-02 00:15:42 INFO     evaluating now!
2024-05-02 00:15:42 INFO     Epoch [6/200] train_loss: 6.4224, val_loss: 6.2454, lr: 0.003000, 7.28s
2024-05-02 00:15:42 INFO     Saved model at 6
2024-05-02 00:15:42 INFO     Val loss decrease from 6.6838 to 6.2454, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 00:15:49 INFO     epoch complete!
2024-05-02 00:15:49 INFO     evaluating now!
2024-05-02 00:15:50 INFO     Epoch [7/200] train_loss: 6.1072, val_loss: 6.2088, lr: 0.003000, 7.27s
2024-05-02 00:15:50 INFO     Saved model at 7
2024-05-02 00:15:50 INFO     Val loss decrease from 6.2454 to 6.2088, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 00:15:57 INFO     epoch complete!
2024-05-02 00:15:57 INFO     evaluating now!
2024-05-02 00:15:57 INFO     Epoch [8/200] train_loss: 5.9229, val_loss: 5.9519, lr: 0.003000, 7.31s
2024-05-02 00:15:57 INFO     Saved model at 8
2024-05-02 00:15:57 INFO     Val loss decrease from 6.2088 to 5.9519, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 00:16:04 INFO     epoch complete!
2024-05-02 00:16:04 INFO     evaluating now!
2024-05-02 00:16:05 INFO     Epoch [9/200] train_loss: 5.6655, val_loss: 5.7516, lr: 0.003000, 7.38s
2024-05-02 00:16:05 INFO     Saved model at 9
2024-05-02 00:16:05 INFO     Val loss decrease from 5.9519 to 5.7516, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 00:16:11 INFO     epoch complete!
2024-05-02 00:16:11 INFO     evaluating now!
2024-05-02 00:16:11 INFO     Epoch [10/200] train_loss: 5.5096, val_loss: 5.6949, lr: 0.003000, 6.80s
2024-05-02 00:16:11 INFO     Saved model at 10
2024-05-02 00:16:11 INFO     Val loss decrease from 5.7516 to 5.6949, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 00:16:18 INFO     epoch complete!
2024-05-02 00:16:18 INFO     evaluating now!
2024-05-02 00:16:18 INFO     Epoch [11/200] train_loss: 5.3108, val_loss: 5.7788, lr: 0.003000, 6.68s
2024-05-02 00:16:24 INFO     epoch complete!
2024-05-02 00:16:24 INFO     evaluating now!
2024-05-02 00:16:25 INFO     Epoch [12/200] train_loss: 5.2664, val_loss: 5.6352, lr: 0.003000, 6.82s
2024-05-02 00:16:25 INFO     Saved model at 12
2024-05-02 00:16:25 INFO     Val loss decrease from 5.6949 to 5.6352, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 00:16:31 INFO     epoch complete!
2024-05-02 00:16:31 INFO     evaluating now!
2024-05-02 00:16:32 INFO     Epoch [13/200] train_loss: 5.1973, val_loss: 5.4025, lr: 0.003000, 6.75s
2024-05-02 00:16:32 INFO     Saved model at 13
2024-05-02 00:16:32 INFO     Val loss decrease from 5.6352 to 5.4025, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-02 00:16:38 INFO     epoch complete!
2024-05-02 00:16:38 INFO     evaluating now!
2024-05-02 00:16:39 INFO     Epoch [14/200] train_loss: 5.0420, val_loss: 5.6287, lr: 0.003000, 6.76s
2024-05-02 00:16:45 INFO     epoch complete!
2024-05-02 00:16:45 INFO     evaluating now!
2024-05-02 00:16:45 INFO     Epoch [15/200] train_loss: 5.0042, val_loss: 5.6761, lr: 0.003000, 6.83s
2024-05-02 00:16:52 INFO     epoch complete!
2024-05-02 00:16:52 INFO     evaluating now!
2024-05-02 00:16:53 INFO     Epoch [16/200] train_loss: 4.9347, val_loss: 5.2914, lr: 0.003000, 7.30s
2024-05-02 00:16:53 INFO     Saved model at 16
2024-05-02 00:16:53 INFO     Val loss decrease from 5.4025 to 5.2914, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-02 00:17:00 INFO     epoch complete!
2024-05-02 00:17:00 INFO     evaluating now!
2024-05-02 00:17:00 INFO     Epoch [17/200] train_loss: 4.8556, val_loss: 5.3491, lr: 0.003000, 7.33s
2024-05-02 00:17:07 INFO     epoch complete!
2024-05-02 00:17:07 INFO     evaluating now!
2024-05-02 00:17:08 INFO     Epoch [18/200] train_loss: 4.7328, val_loss: 5.4271, lr: 0.003000, 7.56s
2024-05-02 00:17:14 INFO     epoch complete!
2024-05-02 00:17:14 INFO     evaluating now!
2024-05-02 00:17:15 INFO     Epoch [19/200] train_loss: 4.6186, val_loss: 5.4939, lr: 0.003000, 7.40s
2024-05-02 00:17:22 INFO     epoch complete!
2024-05-02 00:17:22 INFO     evaluating now!
2024-05-02 00:17:22 INFO     Epoch [20/200] train_loss: 4.6197, val_loss: 5.2349, lr: 0.003000, 7.40s
2024-05-02 00:17:22 INFO     Saved model at 20
2024-05-02 00:17:22 INFO     Val loss decrease from 5.2914 to 5.2349, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-02 00:17:29 INFO     epoch complete!
2024-05-02 00:17:29 INFO     evaluating now!
2024-05-02 00:17:30 INFO     Epoch [21/200] train_loss: 4.5641, val_loss: 5.3598, lr: 0.003000, 7.38s
2024-05-02 00:17:37 INFO     epoch complete!
2024-05-02 00:17:37 INFO     evaluating now!
2024-05-02 00:17:37 INFO     Epoch [22/200] train_loss: 4.4998, val_loss: 5.2263, lr: 0.003000, 7.28s
2024-05-02 00:17:37 INFO     Saved model at 22
2024-05-02 00:17:37 INFO     Val loss decrease from 5.2349 to 5.2263, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-02 00:17:44 INFO     epoch complete!
2024-05-02 00:17:44 INFO     evaluating now!
2024-05-02 00:17:44 INFO     Epoch [23/200] train_loss: 4.4312, val_loss: 5.3006, lr: 0.003000, 7.26s
2024-05-02 00:17:51 INFO     epoch complete!
2024-05-02 00:17:51 INFO     evaluating now!
2024-05-02 00:17:52 INFO     Epoch [24/200] train_loss: 4.4111, val_loss: 5.2399, lr: 0.003000, 7.30s
2024-05-02 00:17:58 INFO     epoch complete!
2024-05-02 00:17:58 INFO     evaluating now!
2024-05-02 00:17:59 INFO     Epoch [25/200] train_loss: 4.3859, val_loss: 5.0377, lr: 0.003000, 7.28s
2024-05-02 00:17:59 INFO     Saved model at 25
2024-05-02 00:17:59 INFO     Val loss decrease from 5.2263 to 5.0377, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-02 00:18:06 INFO     epoch complete!
2024-05-02 00:18:06 INFO     evaluating now!
2024-05-02 00:18:06 INFO     Epoch [26/200] train_loss: 4.3045, val_loss: 5.1492, lr: 0.003000, 7.33s
2024-05-02 00:18:13 INFO     epoch complete!
2024-05-02 00:18:13 INFO     evaluating now!
2024-05-02 00:18:14 INFO     Epoch [27/200] train_loss: 4.2319, val_loss: 5.1682, lr: 0.003000, 7.59s
2024-05-02 00:18:21 INFO     epoch complete!
2024-05-02 00:18:21 INFO     evaluating now!
2024-05-02 00:18:21 INFO     Epoch [28/200] train_loss: 4.1945, val_loss: 4.9953, lr: 0.003000, 7.35s
2024-05-02 00:18:21 INFO     Saved model at 28
2024-05-02 00:18:21 INFO     Val loss decrease from 5.0377 to 4.9953, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-05-02 00:18:28 INFO     epoch complete!
2024-05-02 00:18:28 INFO     evaluating now!
2024-05-02 00:18:29 INFO     Epoch [29/200] train_loss: 4.1283, val_loss: 5.1968, lr: 0.003000, 7.31s
2024-05-02 00:18:35 INFO     epoch complete!
2024-05-02 00:18:35 INFO     evaluating now!
2024-05-02 00:18:36 INFO     Epoch [30/200] train_loss: 4.0868, val_loss: 5.1053, lr: 0.003000, 7.33s
2024-05-02 00:18:43 INFO     epoch complete!
2024-05-02 00:18:43 INFO     evaluating now!
2024-05-02 00:18:43 INFO     Epoch [31/200] train_loss: 4.1481, val_loss: 5.1304, lr: 0.003000, 7.28s
2024-05-02 00:18:50 INFO     epoch complete!
2024-05-02 00:18:50 INFO     evaluating now!
2024-05-02 00:18:51 INFO     Epoch [32/200] train_loss: 4.0681, val_loss: 5.1469, lr: 0.003000, 7.50s
2024-05-02 00:18:58 INFO     epoch complete!
2024-05-02 00:18:58 INFO     evaluating now!
2024-05-02 00:18:58 INFO     Epoch [33/200] train_loss: 3.9876, val_loss: 5.1021, lr: 0.003000, 7.23s
2024-05-02 00:19:05 INFO     epoch complete!
2024-05-02 00:19:05 INFO     evaluating now!
2024-05-02 00:19:05 INFO     Epoch [34/200] train_loss: 3.9965, val_loss: 5.1955, lr: 0.003000, 7.33s
2024-05-02 00:19:12 INFO     epoch complete!
2024-05-02 00:19:12 INFO     evaluating now!
2024-05-02 00:19:13 INFO     Epoch [35/200] train_loss: 4.0008, val_loss: 4.9498, lr: 0.003000, 7.32s
2024-05-02 00:19:13 INFO     Saved model at 35
2024-05-02 00:19:13 INFO     Val loss decrease from 4.9953 to 4.9498, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-05-02 00:19:20 INFO     epoch complete!
2024-05-02 00:19:20 INFO     evaluating now!
2024-05-02 00:19:20 INFO     Epoch [36/200] train_loss: 3.9895, val_loss: 5.2878, lr: 0.003000, 7.33s
2024-05-02 00:19:27 INFO     epoch complete!
2024-05-02 00:19:27 INFO     evaluating now!
2024-05-02 00:19:27 INFO     Epoch [37/200] train_loss: 3.9041, val_loss: 5.1369, lr: 0.003000, 7.31s
2024-05-02 00:19:34 INFO     epoch complete!
2024-05-02 00:19:34 INFO     evaluating now!
2024-05-02 00:19:35 INFO     Epoch [38/200] train_loss: 3.8989, val_loss: 5.0045, lr: 0.003000, 7.26s
2024-05-02 00:19:42 INFO     epoch complete!
2024-05-02 00:19:42 INFO     evaluating now!
2024-05-02 00:19:42 INFO     Epoch [39/200] train_loss: 3.8455, val_loss: 4.9988, lr: 0.003000, 7.58s
2024-05-02 00:19:49 INFO     epoch complete!
2024-05-02 00:19:49 INFO     evaluating now!
2024-05-02 00:19:50 INFO     Epoch [40/200] train_loss: 3.7942, val_loss: 5.0558, lr: 0.003000, 7.49s
2024-05-02 00:19:57 INFO     epoch complete!
2024-05-02 00:19:57 INFO     evaluating now!
2024-05-02 00:19:57 INFO     Epoch [41/200] train_loss: 3.7934, val_loss: 5.1318, lr: 0.003000, 7.45s
2024-05-02 00:20:04 INFO     epoch complete!
2024-05-02 00:20:04 INFO     evaluating now!
2024-05-02 00:20:05 INFO     Epoch [42/200] train_loss: 3.7583, val_loss: 4.9827, lr: 0.003000, 7.65s
2024-05-02 00:20:12 INFO     epoch complete!
2024-05-02 00:20:12 INFO     evaluating now!
2024-05-02 00:20:12 INFO     Epoch [43/200] train_loss: 3.7437, val_loss: 5.0980, lr: 0.003000, 7.47s
2024-05-02 00:20:19 INFO     epoch complete!
2024-05-02 00:20:19 INFO     evaluating now!
2024-05-02 00:20:19 INFO     Epoch [44/200] train_loss: 3.6855, val_loss: 5.0877, lr: 0.003000, 7.28s
2024-05-02 00:20:26 INFO     epoch complete!
2024-05-02 00:20:26 INFO     evaluating now!
2024-05-02 00:20:27 INFO     Epoch [45/200] train_loss: 3.7104, val_loss: 5.0060, lr: 0.003000, 7.23s
2024-05-02 00:20:34 INFO     epoch complete!
2024-05-02 00:20:34 INFO     evaluating now!
2024-05-02 00:20:34 INFO     Epoch [46/200] train_loss: 3.6797, val_loss: 4.8967, lr: 0.003000, 7.40s
2024-05-02 00:20:34 INFO     Saved model at 46
2024-05-02 00:20:34 INFO     Val loss decrease from 4.9498 to 4.8967, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-05-02 00:20:41 INFO     epoch complete!
2024-05-02 00:20:41 INFO     evaluating now!
2024-05-02 00:20:42 INFO     Epoch [47/200] train_loss: 3.6719, val_loss: 5.0277, lr: 0.003000, 7.59s
2024-05-02 00:20:49 INFO     epoch complete!
2024-05-02 00:20:49 INFO     evaluating now!
2024-05-02 00:20:49 INFO     Epoch [48/200] train_loss: 3.6735, val_loss: 5.0768, lr: 0.003000, 7.34s
2024-05-02 00:20:56 INFO     epoch complete!
2024-05-02 00:20:56 INFO     evaluating now!
2024-05-02 00:20:56 INFO     Epoch [49/200] train_loss: 3.6164, val_loss: 5.1042, lr: 0.003000, 7.30s
2024-05-02 00:21:03 INFO     epoch complete!
2024-05-02 00:21:03 INFO     evaluating now!
2024-05-02 00:21:04 INFO     Epoch [50/200] train_loss: 3.6298, val_loss: 5.1225, lr: 0.003000, 7.41s
2024-05-02 00:21:11 INFO     epoch complete!
2024-05-02 00:21:11 INFO     evaluating now!
2024-05-02 00:21:11 INFO     Epoch [51/200] train_loss: 3.6016, val_loss: 5.1032, lr: 0.003000, 7.48s
2024-05-02 00:21:18 INFO     epoch complete!
2024-05-02 00:21:18 INFO     evaluating now!
2024-05-02 00:21:19 INFO     Epoch [52/200] train_loss: 3.5763, val_loss: 5.0330, lr: 0.003000, 7.50s
2024-05-02 00:21:26 INFO     epoch complete!
2024-05-02 00:21:26 INFO     evaluating now!
2024-05-02 00:21:26 INFO     Epoch [53/200] train_loss: 3.5436, val_loss: 5.2593, lr: 0.003000, 7.36s
2024-05-02 00:21:33 INFO     epoch complete!
2024-05-02 00:21:33 INFO     evaluating now!
2024-05-02 00:21:33 INFO     Epoch [54/200] train_loss: 3.5584, val_loss: 5.1497, lr: 0.003000, 7.27s
2024-05-02 00:21:40 INFO     epoch complete!
2024-05-02 00:21:40 INFO     evaluating now!
2024-05-02 00:21:41 INFO     Epoch [55/200] train_loss: 3.5520, val_loss: 4.9524, lr: 0.003000, 7.29s
2024-05-02 00:21:47 INFO     epoch complete!
2024-05-02 00:21:47 INFO     evaluating now!
2024-05-02 00:21:48 INFO     Epoch [56/200] train_loss: 3.5116, val_loss: 5.0023, lr: 0.003000, 6.87s
2024-05-02 00:21:54 INFO     epoch complete!
2024-05-02 00:21:54 INFO     evaluating now!
2024-05-02 00:21:54 INFO     Epoch [57/200] train_loss: 3.4700, val_loss: 4.8512, lr: 0.003000, 6.83s
2024-05-02 00:21:54 INFO     Saved model at 57
2024-05-02 00:21:54 INFO     Val loss decrease from 4.8967 to 4.8512, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch57.tar
2024-05-02 00:22:01 INFO     epoch complete!
2024-05-02 00:22:01 INFO     evaluating now!
2024-05-02 00:22:01 INFO     Epoch [58/200] train_loss: 3.4537, val_loss: 5.0191, lr: 0.003000, 6.78s
2024-05-02 00:22:08 INFO     epoch complete!
2024-05-02 00:22:08 INFO     evaluating now!
2024-05-02 00:22:08 INFO     Epoch [59/200] train_loss: 3.4402, val_loss: 4.9677, lr: 0.003000, 6.80s
2024-05-02 00:22:14 INFO     epoch complete!
2024-05-02 00:22:14 INFO     evaluating now!
2024-05-02 00:22:15 INFO     Epoch [60/200] train_loss: 3.4231, val_loss: 5.0672, lr: 0.003000, 6.76s
2024-05-02 00:22:21 INFO     epoch complete!
2024-05-02 00:22:21 INFO     evaluating now!
2024-05-02 00:22:22 INFO     Epoch [61/200] train_loss: 3.5105, val_loss: 5.0546, lr: 0.003000, 7.00s
2024-05-02 00:22:29 INFO     epoch complete!
2024-05-02 00:22:29 INFO     evaluating now!
2024-05-02 00:22:29 INFO     Epoch [62/200] train_loss: 3.4147, val_loss: 5.0695, lr: 0.003000, 7.60s
2024-05-02 00:22:36 INFO     epoch complete!
2024-05-02 00:22:36 INFO     evaluating now!
2024-05-02 00:22:37 INFO     Epoch [63/200] train_loss: 3.4129, val_loss: 5.1960, lr: 0.003000, 7.39s
2024-05-02 00:22:44 INFO     epoch complete!
2024-05-02 00:22:44 INFO     evaluating now!
2024-05-02 00:22:45 INFO     Epoch [64/200] train_loss: 3.4010, val_loss: 4.9444, lr: 0.003000, 7.82s
2024-05-02 00:22:52 INFO     epoch complete!
2024-05-02 00:22:52 INFO     evaluating now!
2024-05-02 00:22:52 INFO     Epoch [65/200] train_loss: 3.3852, val_loss: 4.8989, lr: 0.003000, 7.42s
2024-05-02 00:22:59 INFO     epoch complete!
2024-05-02 00:22:59 INFO     evaluating now!
2024-05-02 00:23:00 INFO     Epoch [66/200] train_loss: 3.3616, val_loss: 4.9691, lr: 0.003000, 7.52s
2024-05-02 00:23:07 INFO     epoch complete!
2024-05-02 00:23:07 INFO     evaluating now!
2024-05-02 00:23:07 INFO     Epoch [67/200] train_loss: 3.3582, val_loss: 5.0689, lr: 0.003000, 7.52s
2024-05-02 00:23:14 INFO     epoch complete!
2024-05-02 00:23:14 INFO     evaluating now!
2024-05-02 00:23:15 INFO     Epoch [68/200] train_loss: 3.3386, val_loss: 5.1059, lr: 0.003000, 7.67s
2024-05-02 00:23:22 INFO     epoch complete!
2024-05-02 00:23:22 INFO     evaluating now!
2024-05-02 00:23:22 INFO     Epoch [69/200] train_loss: 3.3067, val_loss: 5.0086, lr: 0.003000, 7.50s
2024-05-02 00:23:29 INFO     epoch complete!
2024-05-02 00:23:29 INFO     evaluating now!
2024-05-02 00:23:30 INFO     Epoch [70/200] train_loss: 3.3319, val_loss: 5.0894, lr: 0.003000, 7.35s
2024-05-02 00:23:36 INFO     epoch complete!
2024-05-02 00:23:36 INFO     evaluating now!
2024-05-02 00:23:37 INFO     Epoch [71/200] train_loss: 3.3021, val_loss: 5.0922, lr: 0.003000, 7.38s
2024-05-02 00:23:44 INFO     epoch complete!
2024-05-02 00:23:44 INFO     evaluating now!
2024-05-02 00:23:45 INFO     Epoch [72/200] train_loss: 3.3017, val_loss: 5.2913, lr: 0.003000, 7.60s
2024-05-02 00:23:45 WARNING  Early stopping at epoch: 72
2024-05-02 00:23:45 INFO     Trained totally 73 epochs, average train time is 6.804s, average eval time is 0.493s
2024-05-02 00:23:45 INFO     Loaded model at 57
2024-05-02 00:23:45 INFO     Saved model at ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 00:23:45 INFO     Start evaluating ...
2024-05-02 00:23:46 INFO     Note that you select the single mode to evaluate!
2024-05-02 00:23:46 INFO     Evaluate result is saved at ./libcity/cache/60/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-02 00:23:46 INFO     
         MAE       RMSE
1   2.387582   7.895208
2   2.473300   8.091456
3   2.578787   8.742308
4   2.702636   9.153078
5   2.777969   9.627862
6   2.851222  10.154593
7   2.943759  10.664216
8   2.950407  11.100335
9   2.994917  11.336179
10  3.079488  11.609784
11  3.175406  11.926525
12  3.269063  12.429926
2024-05-02 00:23:46 INFO     ----------------------------------------------------------------------------
2024-05-02 00:23:46 INFO     Kownledge Graph Embedding: RandomE, Experiment ids: [60, 61, 62, 63, 64]
2024-05-02 00:23:47 INFO     ----------------------------------------------------------------------------
2024-05-02 00:23:47 INFO     Average: 
         MAE       RMSE
0   2.363979   7.383420
1   2.462526   7.875119
2   2.619854   8.730793
3   2.763126   9.390535
4   2.882947  10.150375
5   3.012098  11.005275
6   3.091083  11.765170
7   3.148955  12.327319
8   3.199088  12.605102
9   3.269477  12.788068
10  3.358584  13.137312
11  3.463040  13.682302 
2024-05-02 00:23:47 INFO     Standard deviation: 
         MAE      RMSE
0   0.044850  0.604070
1   0.025943  0.351983
2   0.049092  0.082633
3   0.053414  0.168728
4   0.075661  0.368888
5   0.099530  0.641685
6   0.090275  0.860824
7   0.113131  0.974543
8   0.118636  0.918499
9   0.110605  0.748487
10  0.100697  0.664383
11  0.117270  0.634641
2024-05-02 00:23:47 INFO     ----------------------------------------------------------------------------
2024-05-02 00:23:47 INFO     12 steps Average: 
        MAE       RMSE
0  2.969563  10.903399
2024-05-02 00:23:47 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.083259  0.584947
