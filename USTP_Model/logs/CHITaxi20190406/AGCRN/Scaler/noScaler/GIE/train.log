2024-04-30 16:15:02 INFO     ----------------------------------------------------------------------------
2024-04-30 16:15:02 INFO     # 0, Kownledge Graph Embedding: GIE, Experiment ids: 15
2024-04-30 16:15:02 INFO     ----------------------------------------------------------------------------
2024-04-30 16:15:02 INFO     Log directory: ./libcity/log
2024-04-30 16:15:02 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=15
2024-04-30 16:15:02 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 112032163, 'exp_id': 15, 'load_external': True, 'embedding_model': 'GIE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 16:15:02 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 16:15:02 INFO     set_weight_link_or_dist: dist
2024-04-30 16:15:02 INFO     init_weight_inf_or_zero: inf
2024-04-30 16:15:02 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 16:15:02 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 16:15:02 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 16:15:03 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 16:15:06 INFO     Dataset created
2024-04-30 16:15:06 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 16:15:06 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 16:15:06 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 16:15:06 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 16:15:06 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 16:15:06 INFO     NoneScaler
2024-04-30 16:15:12 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 16:15:12 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 16:15:12 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 16:15:12 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 16:15:12 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 16:15:12 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 16:15:12 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 16:15:12 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 16:15:12 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 16:15:12 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 16:15:12 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 16:15:12 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 16:15:12 INFO     Total parameter numbers: 874010
2024-04-30 16:15:12 INFO     You select `adam` optimizer.
2024-04-30 16:15:12 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 16:15:12 INFO     Start training ...
2024-04-30 16:15:12 INFO     num_batches:48
2024-04-30 16:15:19 INFO     epoch complete!
2024-04-30 16:15:19 INFO     evaluating now!
2024-04-30 16:15:20 INFO     Epoch [0/200] train_loss: 25.0808, val_loss: 18.1415, lr: 0.003000, 7.35s
2024-04-30 16:15:20 INFO     Saved model at 0
2024-04-30 16:15:20 INFO     Val loss decrease from inf to 18.1415, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 16:15:26 INFO     epoch complete!
2024-04-30 16:15:26 INFO     evaluating now!
2024-04-30 16:15:27 INFO     Epoch [1/200] train_loss: 14.9761, val_loss: 14.4758, lr: 0.003000, 7.02s
2024-04-30 16:15:27 INFO     Saved model at 1
2024-04-30 16:15:27 INFO     Val loss decrease from 18.1415 to 14.4758, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 16:15:33 INFO     epoch complete!
2024-04-30 16:15:33 INFO     evaluating now!
2024-04-30 16:15:34 INFO     Epoch [2/200] train_loss: 12.3792, val_loss: 12.2343, lr: 0.003000, 7.02s
2024-04-30 16:15:34 INFO     Saved model at 2
2024-04-30 16:15:34 INFO     Val loss decrease from 14.4758 to 12.2343, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 16:15:41 INFO     epoch complete!
2024-04-30 16:15:41 INFO     evaluating now!
2024-04-30 16:15:41 INFO     Epoch [3/200] train_loss: 10.1914, val_loss: 10.0757, lr: 0.003000, 7.05s
2024-04-30 16:15:41 INFO     Saved model at 3
2024-04-30 16:15:41 INFO     Val loss decrease from 12.2343 to 10.0757, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 16:15:48 INFO     epoch complete!
2024-04-30 16:15:48 INFO     evaluating now!
2024-04-30 16:15:48 INFO     Epoch [4/200] train_loss: 8.6082, val_loss: 8.2091, lr: 0.003000, 7.11s
2024-04-30 16:15:48 INFO     Saved model at 4
2024-04-30 16:15:48 INFO     Val loss decrease from 10.0757 to 8.2091, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 16:15:55 INFO     epoch complete!
2024-04-30 16:15:55 INFO     evaluating now!
2024-04-30 16:15:55 INFO     Epoch [5/200] train_loss: 7.6535, val_loss: 7.4090, lr: 0.003000, 7.05s
2024-04-30 16:15:55 INFO     Saved model at 5
2024-04-30 16:15:55 INFO     Val loss decrease from 8.2091 to 7.4090, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 16:16:02 INFO     epoch complete!
2024-04-30 16:16:02 INFO     evaluating now!
2024-04-30 16:16:03 INFO     Epoch [6/200] train_loss: 7.1091, val_loss: 6.9557, lr: 0.003000, 7.12s
2024-04-30 16:16:03 INFO     Saved model at 6
2024-04-30 16:16:03 INFO     Val loss decrease from 7.4090 to 6.9557, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 16:16:09 INFO     epoch complete!
2024-04-30 16:16:09 INFO     evaluating now!
2024-04-30 16:16:10 INFO     Epoch [7/200] train_loss: 6.5600, val_loss: 6.6894, lr: 0.003000, 7.03s
2024-04-30 16:16:10 INFO     Saved model at 7
2024-04-30 16:16:10 INFO     Val loss decrease from 6.9557 to 6.6894, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 16:16:16 INFO     epoch complete!
2024-04-30 16:16:16 INFO     evaluating now!
2024-04-30 16:16:17 INFO     Epoch [8/200] train_loss: 6.2676, val_loss: 6.2604, lr: 0.003000, 6.99s
2024-04-30 16:16:17 INFO     Saved model at 8
2024-04-30 16:16:17 INFO     Val loss decrease from 6.6894 to 6.2604, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 16:16:24 INFO     epoch complete!
2024-04-30 16:16:24 INFO     evaluating now!
2024-04-30 16:16:24 INFO     Epoch [9/200] train_loss: 5.9702, val_loss: 6.1502, lr: 0.003000, 7.35s
2024-04-30 16:16:24 INFO     Saved model at 9
2024-04-30 16:16:24 INFO     Val loss decrease from 6.2604 to 6.1502, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 16:16:31 INFO     epoch complete!
2024-04-30 16:16:31 INFO     evaluating now!
2024-04-30 16:16:31 INFO     Epoch [10/200] train_loss: 5.7990, val_loss: 5.8361, lr: 0.003000, 7.31s
2024-04-30 16:16:31 INFO     Saved model at 10
2024-04-30 16:16:31 INFO     Val loss decrease from 6.1502 to 5.8361, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 16:16:38 INFO     epoch complete!
2024-04-30 16:16:38 INFO     evaluating now!
2024-04-30 16:16:39 INFO     Epoch [11/200] train_loss: 5.6664, val_loss: 5.9769, lr: 0.003000, 7.06s
2024-04-30 16:16:45 INFO     epoch complete!
2024-04-30 16:16:45 INFO     evaluating now!
2024-04-30 16:16:45 INFO     Epoch [12/200] train_loss: 5.5195, val_loss: 5.7640, lr: 0.003000, 6.95s
2024-04-30 16:16:46 INFO     Saved model at 12
2024-04-30 16:16:46 INFO     Val loss decrease from 5.8361 to 5.7640, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 16:16:52 INFO     epoch complete!
2024-04-30 16:16:52 INFO     evaluating now!
2024-04-30 16:16:52 INFO     Epoch [13/200] train_loss: 5.3303, val_loss: 5.5792, lr: 0.003000, 6.79s
2024-04-30 16:16:52 INFO     Saved model at 13
2024-04-30 16:16:52 INFO     Val loss decrease from 5.7640 to 5.5792, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 16:16:59 INFO     epoch complete!
2024-04-30 16:16:59 INFO     evaluating now!
2024-04-30 16:16:59 INFO     Epoch [14/200] train_loss: 5.3056, val_loss: 5.6325, lr: 0.003000, 6.80s
2024-04-30 16:17:06 INFO     epoch complete!
2024-04-30 16:17:06 INFO     evaluating now!
2024-04-30 16:17:06 INFO     Epoch [15/200] train_loss: 5.2111, val_loss: 5.4231, lr: 0.003000, 6.87s
2024-04-30 16:17:06 INFO     Saved model at 15
2024-04-30 16:17:06 INFO     Val loss decrease from 5.5792 to 5.4231, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 16:17:13 INFO     epoch complete!
2024-04-30 16:17:13 INFO     evaluating now!
2024-04-30 16:17:13 INFO     Epoch [16/200] train_loss: 5.0313, val_loss: 5.3924, lr: 0.003000, 7.18s
2024-04-30 16:17:13 INFO     Saved model at 16
2024-04-30 16:17:13 INFO     Val loss decrease from 5.4231 to 5.3924, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 16:17:20 INFO     epoch complete!
2024-04-30 16:17:20 INFO     evaluating now!
2024-04-30 16:17:20 INFO     Epoch [17/200] train_loss: 4.9608, val_loss: 5.5222, lr: 0.003000, 6.63s
2024-04-30 16:17:27 INFO     epoch complete!
2024-04-30 16:17:27 INFO     evaluating now!
2024-04-30 16:17:27 INFO     Epoch [18/200] train_loss: 4.8505, val_loss: 5.4616, lr: 0.003000, 7.08s
2024-04-30 16:17:34 INFO     epoch complete!
2024-04-30 16:17:34 INFO     evaluating now!
2024-04-30 16:17:34 INFO     Epoch [19/200] train_loss: 4.8158, val_loss: 5.3572, lr: 0.003000, 7.06s
2024-04-30 16:17:34 INFO     Saved model at 19
2024-04-30 16:17:34 INFO     Val loss decrease from 5.3924 to 5.3572, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 16:17:41 INFO     epoch complete!
2024-04-30 16:17:41 INFO     evaluating now!
2024-04-30 16:17:41 INFO     Epoch [20/200] train_loss: 4.7680, val_loss: 5.4387, lr: 0.003000, 7.21s
2024-04-30 16:17:48 INFO     epoch complete!
2024-04-30 16:17:48 INFO     evaluating now!
2024-04-30 16:17:49 INFO     Epoch [21/200] train_loss: 4.7549, val_loss: 5.2316, lr: 0.003000, 7.12s
2024-04-30 16:17:49 INFO     Saved model at 21
2024-04-30 16:17:49 INFO     Val loss decrease from 5.3572 to 5.2316, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-30 16:17:55 INFO     epoch complete!
2024-04-30 16:17:55 INFO     evaluating now!
2024-04-30 16:17:56 INFO     Epoch [22/200] train_loss: 4.6432, val_loss: 5.1928, lr: 0.003000, 7.09s
2024-04-30 16:17:56 INFO     Saved model at 22
2024-04-30 16:17:56 INFO     Val loss decrease from 5.2316 to 5.1928, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-30 16:18:02 INFO     epoch complete!
2024-04-30 16:18:02 INFO     evaluating now!
2024-04-30 16:18:03 INFO     Epoch [23/200] train_loss: 4.5621, val_loss: 5.1536, lr: 0.003000, 7.17s
2024-04-30 16:18:03 INFO     Saved model at 23
2024-04-30 16:18:03 INFO     Val loss decrease from 5.1928 to 5.1536, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-30 16:18:10 INFO     epoch complete!
2024-04-30 16:18:10 INFO     evaluating now!
2024-04-30 16:18:10 INFO     Epoch [24/200] train_loss: 4.5401, val_loss: 5.1117, lr: 0.003000, 7.15s
2024-04-30 16:18:10 INFO     Saved model at 24
2024-04-30 16:18:10 INFO     Val loss decrease from 5.1536 to 5.1117, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-04-30 16:18:17 INFO     epoch complete!
2024-04-30 16:18:17 INFO     evaluating now!
2024-04-30 16:18:17 INFO     Epoch [25/200] train_loss: 4.4845, val_loss: 5.1019, lr: 0.003000, 7.04s
2024-04-30 16:18:17 INFO     Saved model at 25
2024-04-30 16:18:17 INFO     Val loss decrease from 5.1117 to 5.1019, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-30 16:18:24 INFO     epoch complete!
2024-04-30 16:18:24 INFO     evaluating now!
2024-04-30 16:18:24 INFO     Epoch [26/200] train_loss: 4.4258, val_loss: 5.5181, lr: 0.003000, 7.28s
2024-04-30 16:18:31 INFO     epoch complete!
2024-04-30 16:18:31 INFO     evaluating now!
2024-04-30 16:18:32 INFO     Epoch [27/200] train_loss: 4.4445, val_loss: 5.2840, lr: 0.003000, 7.06s
2024-04-30 16:18:38 INFO     epoch complete!
2024-04-30 16:18:38 INFO     evaluating now!
2024-04-30 16:18:39 INFO     Epoch [28/200] train_loss: 4.3221, val_loss: 5.1049, lr: 0.003000, 7.23s
2024-04-30 16:18:45 INFO     epoch complete!
2024-04-30 16:18:45 INFO     evaluating now!
2024-04-30 16:18:46 INFO     Epoch [29/200] train_loss: 4.3097, val_loss: 5.3445, lr: 0.003000, 7.14s
2024-04-30 16:18:53 INFO     epoch complete!
2024-04-30 16:18:53 INFO     evaluating now!
2024-04-30 16:18:53 INFO     Epoch [30/200] train_loss: 4.3238, val_loss: 5.1979, lr: 0.003000, 7.18s
2024-04-30 16:19:00 INFO     epoch complete!
2024-04-30 16:19:00 INFO     evaluating now!
2024-04-30 16:19:00 INFO     Epoch [31/200] train_loss: 4.2458, val_loss: 5.1660, lr: 0.003000, 7.18s
2024-04-30 16:19:07 INFO     epoch complete!
2024-04-30 16:19:07 INFO     evaluating now!
2024-04-30 16:19:08 INFO     Epoch [32/200] train_loss: 4.2100, val_loss: 5.0474, lr: 0.003000, 7.31s
2024-04-30 16:19:08 INFO     Saved model at 32
2024-04-30 16:19:08 INFO     Val loss decrease from 5.1019 to 5.0474, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-04-30 16:19:14 INFO     epoch complete!
2024-04-30 16:19:14 INFO     evaluating now!
2024-04-30 16:19:15 INFO     Epoch [33/200] train_loss: 4.1412, val_loss: 5.1375, lr: 0.003000, 6.99s
2024-04-30 16:19:20 INFO     epoch complete!
2024-04-30 16:19:20 INFO     evaluating now!
2024-04-30 16:19:21 INFO     Epoch [34/200] train_loss: 4.1202, val_loss: 5.1080, lr: 0.003000, 6.25s
2024-04-30 16:19:27 INFO     epoch complete!
2024-04-30 16:19:27 INFO     evaluating now!
2024-04-30 16:19:28 INFO     Epoch [35/200] train_loss: 4.0776, val_loss: 5.2064, lr: 0.003000, 6.72s
2024-04-30 16:19:34 INFO     epoch complete!
2024-04-30 16:19:34 INFO     evaluating now!
2024-04-30 16:19:34 INFO     Epoch [36/200] train_loss: 4.0624, val_loss: 5.1668, lr: 0.003000, 6.89s
2024-04-30 16:19:41 INFO     epoch complete!
2024-04-30 16:19:41 INFO     evaluating now!
2024-04-30 16:19:41 INFO     Epoch [37/200] train_loss: 4.0232, val_loss: 5.1001, lr: 0.003000, 6.85s
2024-04-30 16:19:48 INFO     epoch complete!
2024-04-30 16:19:48 INFO     evaluating now!
2024-04-30 16:19:48 INFO     Epoch [38/200] train_loss: 4.0360, val_loss: 5.1705, lr: 0.003000, 6.83s
2024-04-30 16:19:54 INFO     epoch complete!
2024-04-30 16:19:54 INFO     evaluating now!
2024-04-30 16:19:54 INFO     Epoch [39/200] train_loss: 3.9957, val_loss: 4.9833, lr: 0.003000, 6.35s
2024-04-30 16:20:00 INFO     Saved model at 39
2024-04-30 16:20:00 INFO     Val loss decrease from 5.0474 to 4.9833, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-04-30 16:20:07 INFO     epoch complete!
2024-04-30 16:20:07 INFO     evaluating now!
2024-04-30 16:20:08 INFO     Epoch [40/200] train_loss: 3.9154, val_loss: 5.0013, lr: 0.003000, 7.26s
2024-04-30 16:20:14 INFO     epoch complete!
2024-04-30 16:20:14 INFO     evaluating now!
2024-04-30 16:20:14 INFO     Epoch [41/200] train_loss: 3.9396, val_loss: 5.1839, lr: 0.003000, 6.85s
2024-04-30 16:20:21 INFO     epoch complete!
2024-04-30 16:20:21 INFO     evaluating now!
2024-04-30 16:20:21 INFO     Epoch [42/200] train_loss: 3.9651, val_loss: 5.1279, lr: 0.003000, 6.73s
2024-04-30 16:20:28 INFO     epoch complete!
2024-04-30 16:20:28 INFO     evaluating now!
2024-04-30 16:20:28 INFO     Epoch [43/200] train_loss: 3.8615, val_loss: 5.0259, lr: 0.003000, 6.90s
2024-04-30 16:20:34 INFO     epoch complete!
2024-04-30 16:20:34 INFO     evaluating now!
2024-04-30 16:20:35 INFO     Epoch [44/200] train_loss: 3.8382, val_loss: 5.0782, lr: 0.003000, 6.62s
2024-04-30 16:20:41 INFO     epoch complete!
2024-04-30 16:20:41 INFO     evaluating now!
2024-04-30 16:20:41 INFO     Epoch [45/200] train_loss: 3.8371, val_loss: 5.2088, lr: 0.003000, 6.69s
2024-04-30 16:20:48 INFO     epoch complete!
2024-04-30 16:20:48 INFO     evaluating now!
2024-04-30 16:20:48 INFO     Epoch [46/200] train_loss: 3.8659, val_loss: 5.0084, lr: 0.003000, 6.88s
2024-04-30 16:20:56 INFO     epoch complete!
2024-04-30 16:20:56 INFO     evaluating now!
2024-04-30 16:20:56 INFO     Epoch [47/200] train_loss: 3.7545, val_loss: 5.2218, lr: 0.003000, 7.73s
2024-04-30 16:21:03 INFO     epoch complete!
2024-04-30 16:21:03 INFO     evaluating now!
2024-04-30 16:21:04 INFO     Epoch [48/200] train_loss: 3.7413, val_loss: 5.0388, lr: 0.003000, 7.52s
2024-04-30 16:21:11 INFO     epoch complete!
2024-04-30 16:21:11 INFO     evaluating now!
2024-04-30 16:21:11 INFO     Epoch [49/200] train_loss: 3.7718, val_loss: 5.1644, lr: 0.003000, 7.69s
2024-04-30 16:21:18 INFO     epoch complete!
2024-04-30 16:21:18 INFO     evaluating now!
2024-04-30 16:21:18 INFO     Epoch [50/200] train_loss: 3.7025, val_loss: 5.1701, lr: 0.003000, 6.94s
2024-04-30 16:21:25 INFO     epoch complete!
2024-04-30 16:21:25 INFO     evaluating now!
2024-04-30 16:21:25 INFO     Epoch [51/200] train_loss: 3.6743, val_loss: 5.1056, lr: 0.003000, 7.24s
2024-04-30 16:21:32 INFO     epoch complete!
2024-04-30 16:21:32 INFO     evaluating now!
2024-04-30 16:21:33 INFO     Epoch [52/200] train_loss: 3.6686, val_loss: 5.0365, lr: 0.003000, 7.35s
2024-04-30 16:21:40 INFO     epoch complete!
2024-04-30 16:21:40 INFO     evaluating now!
2024-04-30 16:21:40 INFO     Epoch [53/200] train_loss: 3.6457, val_loss: 5.2273, lr: 0.003000, 7.33s
2024-04-30 16:21:47 INFO     epoch complete!
2024-04-30 16:21:47 INFO     evaluating now!
2024-04-30 16:21:48 INFO     Epoch [54/200] train_loss: 3.6200, val_loss: 4.9938, lr: 0.003000, 7.40s
2024-04-30 16:21:48 WARNING  Early stopping at epoch: 54
2024-04-30 16:21:48 INFO     Trained totally 55 epochs, average train time is 6.572s, average eval time is 0.481s
2024-04-30 16:21:50 INFO     Loaded model at 39
2024-04-30 16:21:51 INFO     Saved model at ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 16:21:51 INFO     Start evaluating ...
2024-04-30 16:21:53 INFO     Note that you select the single mode to evaluate!
2024-04-30 16:21:53 INFO     Evaluate result is saved at ./libcity/cache/15/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 16:21:53 INFO     
         MAE       RMSE
1   2.266032   7.004719
2   2.417235   7.627569
3   2.622606   8.766056
4   2.874702   9.988295
5   3.052346  11.298568
6   3.159822  12.337523
7   3.198377  12.941907
8   3.292125  13.185102
9   3.277748  13.177418
10  3.297426  13.179013
11  3.375974  13.361691
12  3.554113  13.986913
2024-04-30 16:21:53 INFO     ----------------------------------------------------------------------------
2024-04-30 16:21:53 INFO     # 1, Kownledge Graph Embedding: GIE, Experiment ids: 16
2024-04-30 16:21:53 INFO     ----------------------------------------------------------------------------
2024-04-30 16:21:53 INFO     Log directory: ./libcity/log
2024-04-30 16:21:53 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=16
2024-04-30 16:21:53 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 101285847, 'exp_id': 16, 'load_external': True, 'embedding_model': 'GIE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 16:21:53 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 16:21:53 INFO     set_weight_link_or_dist: dist
2024-04-30 16:21:53 INFO     init_weight_inf_or_zero: inf
2024-04-30 16:21:53 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 16:21:53 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 16:21:53 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 16:21:54 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 16:21:57 INFO     Dataset created
2024-04-30 16:21:57 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 16:21:57 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 16:21:57 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 16:21:57 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 16:21:57 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 16:21:57 INFO     NoneScaler
2024-04-30 16:21:59 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 16:21:59 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 16:21:59 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 16:21:59 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 16:21:59 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 16:21:59 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 16:21:59 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 16:21:59 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 16:21:59 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 16:21:59 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 16:21:59 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 16:21:59 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 16:21:59 INFO     Total parameter numbers: 874010
2024-04-30 16:21:59 INFO     You select `adam` optimizer.
2024-04-30 16:21:59 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 16:21:59 INFO     Start training ...
2024-04-30 16:21:59 INFO     num_batches:48
2024-04-30 16:22:06 INFO     epoch complete!
2024-04-30 16:22:06 INFO     evaluating now!
2024-04-30 16:22:07 INFO     Epoch [0/200] train_loss: 23.4794, val_loss: 17.3433, lr: 0.003000, 7.59s
2024-04-30 16:22:13 INFO     Saved model at 0
2024-04-30 16:22:13 INFO     Val loss decrease from inf to 17.3433, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 16:22:20 INFO     epoch complete!
2024-04-30 16:22:20 INFO     evaluating now!
2024-04-30 16:22:21 INFO     Epoch [1/200] train_loss: 13.6470, val_loss: 12.7170, lr: 0.003000, 7.65s
2024-04-30 16:22:21 INFO     Saved model at 1
2024-04-30 16:22:21 INFO     Val loss decrease from 17.3433 to 12.7170, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 16:22:28 INFO     epoch complete!
2024-04-30 16:22:28 INFO     evaluating now!
2024-04-30 16:22:28 INFO     Epoch [2/200] train_loss: 10.5931, val_loss: 9.9130, lr: 0.003000, 7.17s
2024-04-30 16:22:28 INFO     Saved model at 2
2024-04-30 16:22:28 INFO     Val loss decrease from 12.7170 to 9.9130, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 16:22:35 INFO     epoch complete!
2024-04-30 16:22:35 INFO     evaluating now!
2024-04-30 16:22:36 INFO     Epoch [3/200] train_loss: 8.7366, val_loss: 8.2115, lr: 0.003000, 7.49s
2024-04-30 16:22:36 INFO     Saved model at 3
2024-04-30 16:22:36 INFO     Val loss decrease from 9.9130 to 8.2115, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 16:22:43 INFO     epoch complete!
2024-04-30 16:22:43 INFO     evaluating now!
2024-04-30 16:22:43 INFO     Epoch [4/200] train_loss: 7.6259, val_loss: 7.4548, lr: 0.003000, 7.76s
2024-04-30 16:22:44 INFO     Saved model at 4
2024-04-30 16:22:44 INFO     Val loss decrease from 8.2115 to 7.4548, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 16:22:51 INFO     epoch complete!
2024-04-30 16:22:51 INFO     evaluating now!
2024-04-30 16:22:51 INFO     Epoch [5/200] train_loss: 6.9838, val_loss: 6.7817, lr: 0.003000, 7.53s
2024-04-30 16:22:51 INFO     Saved model at 5
2024-04-30 16:22:51 INFO     Val loss decrease from 7.4548 to 6.7817, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 16:22:58 INFO     epoch complete!
2024-04-30 16:22:58 INFO     evaluating now!
2024-04-30 16:22:59 INFO     Epoch [6/200] train_loss: 6.4875, val_loss: 6.5835, lr: 0.003000, 7.62s
2024-04-30 16:22:59 INFO     Saved model at 6
2024-04-30 16:22:59 INFO     Val loss decrease from 6.7817 to 6.5835, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 16:23:06 INFO     epoch complete!
2024-04-30 16:23:06 INFO     evaluating now!
2024-04-30 16:23:06 INFO     Epoch [7/200] train_loss: 6.1712, val_loss: 6.2380, lr: 0.003000, 7.49s
2024-04-30 16:23:06 INFO     Saved model at 7
2024-04-30 16:23:06 INFO     Val loss decrease from 6.5835 to 6.2380, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 16:23:13 INFO     epoch complete!
2024-04-30 16:23:13 INFO     evaluating now!
2024-04-30 16:23:14 INFO     Epoch [8/200] train_loss: 5.9691, val_loss: 6.0649, lr: 0.003000, 7.59s
2024-04-30 16:23:14 INFO     Saved model at 8
2024-04-30 16:23:14 INFO     Val loss decrease from 6.2380 to 6.0649, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 16:23:21 INFO     epoch complete!
2024-04-30 16:23:21 INFO     evaluating now!
2024-04-30 16:23:21 INFO     Epoch [9/200] train_loss: 5.7623, val_loss: 5.7857, lr: 0.003000, 7.05s
2024-04-30 16:23:25 INFO     Saved model at 9
2024-04-30 16:23:25 INFO     Val loss decrease from 6.0649 to 5.7857, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 16:23:31 INFO     epoch complete!
2024-04-30 16:23:31 INFO     evaluating now!
2024-04-30 16:23:32 INFO     Epoch [10/200] train_loss: 5.6131, val_loss: 5.8665, lr: 0.003000, 6.58s
2024-04-30 16:23:38 INFO     epoch complete!
2024-04-30 16:23:38 INFO     evaluating now!
2024-04-30 16:23:38 INFO     Epoch [11/200] train_loss: 5.4867, val_loss: 5.6891, lr: 0.003000, 6.42s
2024-04-30 16:23:38 INFO     Saved model at 11
2024-04-30 16:23:38 INFO     Val loss decrease from 5.7857 to 5.6891, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 16:23:44 INFO     epoch complete!
2024-04-30 16:23:44 INFO     evaluating now!
2024-04-30 16:23:45 INFO     Epoch [12/200] train_loss: 5.3263, val_loss: 5.8361, lr: 0.003000, 6.78s
2024-04-30 16:23:52 INFO     epoch complete!
2024-04-30 16:23:52 INFO     evaluating now!
2024-04-30 16:23:52 INFO     Epoch [13/200] train_loss: 5.3536, val_loss: 5.7413, lr: 0.003000, 7.21s
2024-04-30 16:23:59 INFO     epoch complete!
2024-04-30 16:23:59 INFO     evaluating now!
2024-04-30 16:23:59 INFO     Epoch [14/200] train_loss: 5.2333, val_loss: 5.8200, lr: 0.003000, 7.42s
2024-04-30 16:24:07 INFO     epoch complete!
2024-04-30 16:24:07 INFO     evaluating now!
2024-04-30 16:24:07 INFO     Epoch [15/200] train_loss: 5.1212, val_loss: 5.5864, lr: 0.003000, 7.64s
2024-04-30 16:24:07 INFO     Saved model at 15
2024-04-30 16:24:07 INFO     Val loss decrease from 5.6891 to 5.5864, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 16:24:14 INFO     epoch complete!
2024-04-30 16:24:14 INFO     evaluating now!
2024-04-30 16:24:15 INFO     Epoch [16/200] train_loss: 5.0069, val_loss: 5.5611, lr: 0.003000, 7.59s
2024-04-30 16:24:15 INFO     Saved model at 16
2024-04-30 16:24:15 INFO     Val loss decrease from 5.5864 to 5.5611, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 16:24:22 INFO     epoch complete!
2024-04-30 16:24:22 INFO     evaluating now!
2024-04-30 16:24:22 INFO     Epoch [17/200] train_loss: 4.9236, val_loss: 5.5106, lr: 0.003000, 7.44s
2024-04-30 16:24:25 INFO     Saved model at 17
2024-04-30 16:24:25 INFO     Val loss decrease from 5.5611 to 5.5106, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 16:24:32 INFO     epoch complete!
2024-04-30 16:24:32 INFO     evaluating now!
2024-04-30 16:24:33 INFO     Epoch [18/200] train_loss: 4.8695, val_loss: 5.3291, lr: 0.003000, 7.48s
2024-04-30 16:24:33 INFO     Saved model at 18
2024-04-30 16:24:33 INFO     Val loss decrease from 5.5106 to 5.3291, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 16:24:40 INFO     epoch complete!
2024-04-30 16:24:40 INFO     evaluating now!
2024-04-30 16:24:40 INFO     Epoch [19/200] train_loss: 4.8053, val_loss: 5.2535, lr: 0.003000, 7.54s
2024-04-30 16:24:40 INFO     Saved model at 19
2024-04-30 16:24:40 INFO     Val loss decrease from 5.3291 to 5.2535, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 16:24:47 INFO     epoch complete!
2024-04-30 16:24:47 INFO     evaluating now!
2024-04-30 16:24:48 INFO     Epoch [20/200] train_loss: 4.7642, val_loss: 5.4106, lr: 0.003000, 7.42s
2024-04-30 16:24:55 INFO     epoch complete!
2024-04-30 16:24:55 INFO     evaluating now!
2024-04-30 16:24:55 INFO     Epoch [21/200] train_loss: 4.6114, val_loss: 5.2643, lr: 0.003000, 7.47s
2024-04-30 16:25:02 INFO     epoch complete!
2024-04-30 16:25:02 INFO     evaluating now!
2024-04-30 16:25:03 INFO     Epoch [22/200] train_loss: 4.6529, val_loss: 5.1269, lr: 0.003000, 7.74s
2024-04-30 16:25:03 INFO     Saved model at 22
2024-04-30 16:25:03 INFO     Val loss decrease from 5.2535 to 5.1269, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-30 16:25:10 INFO     epoch complete!
2024-04-30 16:25:10 INFO     evaluating now!
2024-04-30 16:25:11 INFO     Epoch [23/200] train_loss: 4.5660, val_loss: 5.1687, lr: 0.003000, 7.60s
2024-04-30 16:25:18 INFO     epoch complete!
2024-04-30 16:25:18 INFO     evaluating now!
2024-04-30 16:25:19 INFO     Epoch [24/200] train_loss: 4.5227, val_loss: 5.0645, lr: 0.003000, 8.15s
2024-04-30 16:25:19 INFO     Saved model at 24
2024-04-30 16:25:19 INFO     Val loss decrease from 5.1269 to 5.0645, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-04-30 16:25:26 INFO     epoch complete!
2024-04-30 16:25:26 INFO     evaluating now!
2024-04-30 16:25:27 INFO     Epoch [25/200] train_loss: 4.4776, val_loss: 5.2969, lr: 0.003000, 7.67s
2024-04-30 16:25:33 INFO     epoch complete!
2024-04-30 16:25:33 INFO     evaluating now!
2024-04-30 16:25:34 INFO     Epoch [26/200] train_loss: 4.4402, val_loss: 5.4787, lr: 0.003000, 7.25s
2024-04-30 16:25:41 INFO     epoch complete!
2024-04-30 16:25:41 INFO     evaluating now!
2024-04-30 16:25:41 INFO     Epoch [27/200] train_loss: 4.3646, val_loss: 4.9122, lr: 0.003000, 7.26s
2024-04-30 16:25:41 INFO     Saved model at 27
2024-04-30 16:25:41 INFO     Val loss decrease from 5.0645 to 4.9122, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-30 16:25:48 INFO     epoch complete!
2024-04-30 16:25:48 INFO     evaluating now!
2024-04-30 16:25:48 INFO     Epoch [28/200] train_loss: 4.3194, val_loss: 5.2905, lr: 0.003000, 7.32s
2024-04-30 16:25:55 INFO     epoch complete!
2024-04-30 16:25:55 INFO     evaluating now!
2024-04-30 16:25:56 INFO     Epoch [29/200] train_loss: 4.3527, val_loss: 5.1431, lr: 0.003000, 7.35s
2024-04-30 16:26:03 INFO     epoch complete!
2024-04-30 16:26:03 INFO     evaluating now!
2024-04-30 16:26:04 INFO     Epoch [30/200] train_loss: 4.2878, val_loss: 5.0886, lr: 0.003000, 7.76s
2024-04-30 16:26:11 INFO     epoch complete!
2024-04-30 16:26:11 INFO     evaluating now!
2024-04-30 16:26:12 INFO     Epoch [31/200] train_loss: 4.2004, val_loss: 5.0816, lr: 0.003000, 8.19s
2024-04-30 16:26:19 INFO     epoch complete!
2024-04-30 16:26:19 INFO     evaluating now!
2024-04-30 16:26:20 INFO     Epoch [32/200] train_loss: 4.1766, val_loss: 4.8951, lr: 0.003000, 7.87s
2024-04-30 16:26:20 INFO     Saved model at 32
2024-04-30 16:26:20 INFO     Val loss decrease from 4.9122 to 4.8951, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-04-30 16:26:27 INFO     epoch complete!
2024-04-30 16:26:27 INFO     evaluating now!
2024-04-30 16:26:27 INFO     Epoch [33/200] train_loss: 4.1460, val_loss: 5.0579, lr: 0.003000, 7.35s
2024-04-30 16:26:34 INFO     epoch complete!
2024-04-30 16:26:34 INFO     evaluating now!
2024-04-30 16:26:35 INFO     Epoch [34/200] train_loss: 4.0814, val_loss: 5.0436, lr: 0.003000, 7.49s
2024-04-30 16:26:41 INFO     epoch complete!
2024-04-30 16:26:41 INFO     evaluating now!
2024-04-30 16:26:42 INFO     Epoch [35/200] train_loss: 4.0623, val_loss: 5.0045, lr: 0.003000, 7.37s
2024-04-30 16:26:49 INFO     epoch complete!
2024-04-30 16:26:49 INFO     evaluating now!
2024-04-30 16:26:49 INFO     Epoch [36/200] train_loss: 4.0646, val_loss: 5.1718, lr: 0.003000, 7.50s
2024-04-30 16:26:56 INFO     epoch complete!
2024-04-30 16:26:56 INFO     evaluating now!
2024-04-30 16:26:56 INFO     Epoch [37/200] train_loss: 4.0409, val_loss: 5.2241, lr: 0.003000, 6.97s
2024-04-30 16:27:03 INFO     epoch complete!
2024-04-30 16:27:03 INFO     evaluating now!
2024-04-30 16:27:03 INFO     Epoch [38/200] train_loss: 4.0367, val_loss: 5.0882, lr: 0.003000, 6.85s
2024-04-30 16:27:10 INFO     epoch complete!
2024-04-30 16:27:10 INFO     evaluating now!
2024-04-30 16:27:10 INFO     Epoch [39/200] train_loss: 3.9403, val_loss: 5.0575, lr: 0.003000, 6.83s
2024-04-30 16:27:16 INFO     epoch complete!
2024-04-30 16:27:16 INFO     evaluating now!
2024-04-30 16:27:17 INFO     Epoch [40/200] train_loss: 3.9175, val_loss: 5.0326, lr: 0.003000, 6.71s
2024-04-30 16:27:23 INFO     epoch complete!
2024-04-30 16:27:23 INFO     evaluating now!
2024-04-30 16:27:23 INFO     Epoch [41/200] train_loss: 3.9055, val_loss: 5.0820, lr: 0.003000, 6.51s
2024-04-30 16:27:29 INFO     epoch complete!
2024-04-30 16:27:29 INFO     evaluating now!
2024-04-30 16:27:30 INFO     Epoch [42/200] train_loss: 3.8947, val_loss: 5.0867, lr: 0.003000, 6.64s
2024-04-30 16:27:37 INFO     epoch complete!
2024-04-30 16:27:37 INFO     evaluating now!
2024-04-30 16:27:37 INFO     Epoch [43/200] train_loss: 3.8970, val_loss: 5.1463, lr: 0.003000, 7.28s
2024-04-30 16:27:44 INFO     epoch complete!
2024-04-30 16:27:44 INFO     evaluating now!
2024-04-30 16:27:45 INFO     Epoch [44/200] train_loss: 3.8704, val_loss: 5.1774, lr: 0.003000, 7.34s
2024-04-30 16:27:51 INFO     epoch complete!
2024-04-30 16:27:51 INFO     evaluating now!
2024-04-30 16:27:52 INFO     Epoch [45/200] train_loss: 3.7936, val_loss: 5.0810, lr: 0.003000, 7.24s
2024-04-30 16:27:59 INFO     epoch complete!
2024-04-30 16:27:59 INFO     evaluating now!
2024-04-30 16:27:59 INFO     Epoch [46/200] train_loss: 3.7823, val_loss: 5.0070, lr: 0.003000, 7.25s
2024-04-30 16:28:06 INFO     epoch complete!
2024-04-30 16:28:06 INFO     evaluating now!
2024-04-30 16:28:06 INFO     Epoch [47/200] train_loss: 3.7359, val_loss: 5.0550, lr: 0.003000, 7.29s
2024-04-30 16:28:06 WARNING  Early stopping at epoch: 47
2024-04-30 16:28:06 INFO     Trained totally 48 epochs, average train time is 6.844s, average eval time is 0.501s
2024-04-30 16:28:06 INFO     Loaded model at 32
2024-04-30 16:28:06 INFO     Saved model at ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 16:28:06 INFO     Start evaluating ...
2024-04-30 16:28:08 INFO     Note that you select the single mode to evaluate!
2024-04-30 16:28:08 INFO     Evaluate result is saved at ./libcity/cache/16/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 16:28:08 INFO     
         MAE       RMSE
1   2.400579   7.188348
2   2.485997   7.766048
3   2.667275   8.947671
4   2.774184   9.695569
5   2.896132  10.474908
6   2.966049  11.024673
7   3.064680  11.576539
8   3.139374  12.061387
9   3.202124  12.423767
10  3.237757  12.745955
11  3.341325  13.208268
12  3.415715  13.794785
2024-04-30 16:28:08 INFO     ----------------------------------------------------------------------------
2024-04-30 16:28:08 INFO     # 2, Kownledge Graph Embedding: GIE, Experiment ids: 17
2024-04-30 16:28:08 INFO     ----------------------------------------------------------------------------
2024-04-30 16:28:08 INFO     Log directory: ./libcity/log
2024-04-30 16:28:08 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=17
2024-04-30 16:28:08 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 946972233, 'exp_id': 17, 'load_external': True, 'embedding_model': 'GIE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 16:28:08 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 16:28:08 INFO     set_weight_link_or_dist: dist
2024-04-30 16:28:08 INFO     init_weight_inf_or_zero: inf
2024-04-30 16:28:08 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 16:28:08 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 16:28:08 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 16:28:09 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 16:28:12 INFO     Dataset created
2024-04-30 16:28:12 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 16:28:12 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 16:28:12 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 16:28:12 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 16:28:12 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 16:28:12 INFO     NoneScaler
2024-04-30 16:28:14 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 16:28:14 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 16:28:14 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 16:28:14 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 16:28:14 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 16:28:14 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 16:28:14 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 16:28:14 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 16:28:14 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 16:28:14 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 16:28:14 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 16:28:14 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 16:28:14 INFO     Total parameter numbers: 874010
2024-04-30 16:28:14 INFO     You select `adam` optimizer.
2024-04-30 16:28:14 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 16:28:14 INFO     Start training ...
2024-04-30 16:28:14 INFO     num_batches:48
2024-04-30 16:28:21 INFO     epoch complete!
2024-04-30 16:28:21 INFO     evaluating now!
2024-04-30 16:28:21 INFO     Epoch [0/200] train_loss: 23.7831, val_loss: 17.5833, lr: 0.003000, 7.31s
2024-04-30 16:28:21 INFO     Saved model at 0
2024-04-30 16:28:21 INFO     Val loss decrease from inf to 17.5833, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 16:28:28 INFO     epoch complete!
2024-04-30 16:28:28 INFO     evaluating now!
2024-04-30 16:28:28 INFO     Epoch [1/200] train_loss: 14.1541, val_loss: 13.4070, lr: 0.003000, 7.24s
2024-04-30 16:28:29 INFO     Saved model at 1
2024-04-30 16:28:29 INFO     Val loss decrease from 17.5833 to 13.4070, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 16:28:35 INFO     epoch complete!
2024-04-30 16:28:35 INFO     evaluating now!
2024-04-30 16:28:36 INFO     Epoch [2/200] train_loss: 10.9255, val_loss: 10.2032, lr: 0.003000, 7.36s
2024-04-30 16:28:36 INFO     Saved model at 2
2024-04-30 16:28:36 INFO     Val loss decrease from 13.4070 to 10.2032, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 16:28:43 INFO     epoch complete!
2024-04-30 16:28:43 INFO     evaluating now!
2024-04-30 16:28:43 INFO     Epoch [3/200] train_loss: 8.8463, val_loss: 8.3722, lr: 0.003000, 7.28s
2024-04-30 16:28:43 INFO     Saved model at 3
2024-04-30 16:28:43 INFO     Val loss decrease from 10.2032 to 8.3722, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 16:28:50 INFO     epoch complete!
2024-04-30 16:28:50 INFO     evaluating now!
2024-04-30 16:28:51 INFO     Epoch [4/200] train_loss: 7.8180, val_loss: 7.5388, lr: 0.003000, 7.35s
2024-04-30 16:28:51 INFO     Saved model at 4
2024-04-30 16:28:51 INFO     Val loss decrease from 8.3722 to 7.5388, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 16:28:58 INFO     epoch complete!
2024-04-30 16:28:58 INFO     evaluating now!
2024-04-30 16:28:58 INFO     Epoch [5/200] train_loss: 7.1030, val_loss: 7.0537, lr: 0.003000, 7.36s
2024-04-30 16:28:58 INFO     Saved model at 5
2024-04-30 16:28:58 INFO     Val loss decrease from 7.5388 to 7.0537, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 16:29:05 INFO     epoch complete!
2024-04-30 16:29:05 INFO     evaluating now!
2024-04-30 16:29:06 INFO     Epoch [6/200] train_loss: 6.6217, val_loss: 6.6889, lr: 0.003000, 7.44s
2024-04-30 16:29:06 INFO     Saved model at 6
2024-04-30 16:29:06 INFO     Val loss decrease from 7.0537 to 6.6889, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 16:29:13 INFO     epoch complete!
2024-04-30 16:29:13 INFO     evaluating now!
2024-04-30 16:29:13 INFO     Epoch [7/200] train_loss: 6.2936, val_loss: 6.1439, lr: 0.003000, 7.39s
2024-04-30 16:29:13 INFO     Saved model at 7
2024-04-30 16:29:13 INFO     Val loss decrease from 6.6889 to 6.1439, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 16:29:20 INFO     epoch complete!
2024-04-30 16:29:20 INFO     evaluating now!
2024-04-30 16:29:21 INFO     Epoch [8/200] train_loss: 6.0768, val_loss: 6.3243, lr: 0.003000, 7.38s
2024-04-30 16:29:27 INFO     epoch complete!
2024-04-30 16:29:27 INFO     evaluating now!
2024-04-30 16:29:28 INFO     Epoch [9/200] train_loss: 5.8067, val_loss: 5.9645, lr: 0.003000, 7.28s
2024-04-30 16:29:28 INFO     Saved model at 9
2024-04-30 16:29:28 INFO     Val loss decrease from 6.1439 to 5.9645, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 16:29:35 INFO     epoch complete!
2024-04-30 16:29:35 INFO     evaluating now!
2024-04-30 16:29:35 INFO     Epoch [10/200] train_loss: 5.7395, val_loss: 5.8477, lr: 0.003000, 7.21s
2024-04-30 16:29:35 INFO     Saved model at 10
2024-04-30 16:29:35 INFO     Val loss decrease from 5.9645 to 5.8477, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 16:29:42 INFO     epoch complete!
2024-04-30 16:29:42 INFO     evaluating now!
2024-04-30 16:29:42 INFO     Epoch [11/200] train_loss: 5.4830, val_loss: 5.7803, lr: 0.003000, 7.27s
2024-04-30 16:29:42 INFO     Saved model at 11
2024-04-30 16:29:42 INFO     Val loss decrease from 5.8477 to 5.7803, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 16:29:49 INFO     epoch complete!
2024-04-30 16:29:49 INFO     evaluating now!
2024-04-30 16:29:50 INFO     Epoch [12/200] train_loss: 5.4616, val_loss: 5.4411, lr: 0.003000, 7.30s
2024-04-30 16:29:50 INFO     Saved model at 12
2024-04-30 16:29:50 INFO     Val loss decrease from 5.7803 to 5.4411, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 16:29:57 INFO     epoch complete!
2024-04-30 16:29:57 INFO     evaluating now!
2024-04-30 16:29:57 INFO     Epoch [13/200] train_loss: 5.2940, val_loss: 5.5214, lr: 0.003000, 7.21s
2024-04-30 16:30:04 INFO     epoch complete!
2024-04-30 16:30:04 INFO     evaluating now!
2024-04-30 16:30:04 INFO     Epoch [14/200] train_loss: 5.1711, val_loss: 5.6159, lr: 0.003000, 7.23s
2024-04-30 16:30:11 INFO     epoch complete!
2024-04-30 16:30:11 INFO     evaluating now!
2024-04-30 16:30:11 INFO     Epoch [15/200] train_loss: 5.1413, val_loss: 5.5372, lr: 0.003000, 7.09s
2024-04-30 16:30:18 INFO     epoch complete!
2024-04-30 16:30:18 INFO     evaluating now!
2024-04-30 16:30:19 INFO     Epoch [16/200] train_loss: 5.0124, val_loss: 5.6851, lr: 0.003000, 7.18s
2024-04-30 16:30:25 INFO     epoch complete!
2024-04-30 16:30:25 INFO     evaluating now!
2024-04-30 16:30:26 INFO     Epoch [17/200] train_loss: 4.9263, val_loss: 5.4364, lr: 0.003000, 7.29s
2024-04-30 16:30:26 INFO     Saved model at 17
2024-04-30 16:30:26 INFO     Val loss decrease from 5.4411 to 5.4364, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 16:30:32 INFO     epoch complete!
2024-04-30 16:30:32 INFO     evaluating now!
2024-04-30 16:30:33 INFO     Epoch [18/200] train_loss: 4.8734, val_loss: 5.3897, lr: 0.003000, 7.12s
2024-04-30 16:30:33 INFO     Saved model at 18
2024-04-30 16:30:33 INFO     Val loss decrease from 5.4364 to 5.3897, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 16:30:40 INFO     epoch complete!
2024-04-30 16:30:40 INFO     evaluating now!
2024-04-30 16:30:40 INFO     Epoch [19/200] train_loss: 4.7728, val_loss: 5.2441, lr: 0.003000, 7.20s
2024-04-30 16:30:40 INFO     Saved model at 19
2024-04-30 16:30:40 INFO     Val loss decrease from 5.3897 to 5.2441, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 16:30:47 INFO     epoch complete!
2024-04-30 16:30:47 INFO     evaluating now!
2024-04-30 16:30:47 INFO     Epoch [20/200] train_loss: 4.7841, val_loss: 5.4362, lr: 0.003000, 7.12s
2024-04-30 16:30:54 INFO     epoch complete!
2024-04-30 16:30:54 INFO     evaluating now!
2024-04-30 16:30:55 INFO     Epoch [21/200] train_loss: 4.6890, val_loss: 5.4344, lr: 0.003000, 7.13s
2024-04-30 16:31:01 INFO     epoch complete!
2024-04-30 16:31:01 INFO     evaluating now!
2024-04-30 16:31:02 INFO     Epoch [22/200] train_loss: 4.6121, val_loss: 5.3139, lr: 0.003000, 7.07s
2024-04-30 16:31:08 INFO     epoch complete!
2024-04-30 16:31:08 INFO     evaluating now!
2024-04-30 16:31:09 INFO     Epoch [23/200] train_loss: 4.6044, val_loss: 5.2471, lr: 0.003000, 7.16s
2024-04-30 16:31:15 INFO     epoch complete!
2024-04-30 16:31:15 INFO     evaluating now!
2024-04-30 16:31:16 INFO     Epoch [24/200] train_loss: 4.5178, val_loss: 5.5493, lr: 0.003000, 7.03s
2024-04-30 16:31:22 INFO     epoch complete!
2024-04-30 16:31:22 INFO     evaluating now!
2024-04-30 16:31:23 INFO     Epoch [25/200] train_loss: 4.5031, val_loss: 5.1343, lr: 0.003000, 7.06s
2024-04-30 16:31:23 INFO     Saved model at 25
2024-04-30 16:31:23 INFO     Val loss decrease from 5.2441 to 5.1343, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-30 16:31:30 INFO     epoch complete!
2024-04-30 16:31:30 INFO     evaluating now!
2024-04-30 16:31:30 INFO     Epoch [26/200] train_loss: 4.4068, val_loss: 5.3574, lr: 0.003000, 7.25s
2024-04-30 16:31:37 INFO     epoch complete!
2024-04-30 16:31:37 INFO     evaluating now!
2024-04-30 16:31:37 INFO     Epoch [27/200] train_loss: 4.4393, val_loss: 5.2550, lr: 0.003000, 7.31s
2024-04-30 16:31:44 INFO     epoch complete!
2024-04-30 16:31:44 INFO     evaluating now!
2024-04-30 16:31:45 INFO     Epoch [28/200] train_loss: 4.3400, val_loss: 5.1004, lr: 0.003000, 7.31s
2024-04-30 16:31:45 INFO     Saved model at 28
2024-04-30 16:31:45 INFO     Val loss decrease from 5.1343 to 5.1004, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-04-30 16:31:51 INFO     epoch complete!
2024-04-30 16:31:51 INFO     evaluating now!
2024-04-30 16:31:52 INFO     Epoch [29/200] train_loss: 4.3337, val_loss: 5.0557, lr: 0.003000, 7.22s
2024-04-30 16:31:52 INFO     Saved model at 29
2024-04-30 16:31:52 INFO     Val loss decrease from 5.1004 to 5.0557, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-04-30 16:31:59 INFO     epoch complete!
2024-04-30 16:31:59 INFO     evaluating now!
2024-04-30 16:31:59 INFO     Epoch [30/200] train_loss: 4.2507, val_loss: 5.2183, lr: 0.003000, 7.14s
2024-04-30 16:32:06 INFO     epoch complete!
2024-04-30 16:32:06 INFO     evaluating now!
2024-04-30 16:32:06 INFO     Epoch [31/200] train_loss: 4.2764, val_loss: 5.1015, lr: 0.003000, 7.24s
2024-04-30 16:32:13 INFO     epoch complete!
2024-04-30 16:32:13 INFO     evaluating now!
2024-04-30 16:32:14 INFO     Epoch [32/200] train_loss: 4.2432, val_loss: 5.1780, lr: 0.003000, 7.21s
2024-04-30 16:32:20 INFO     epoch complete!
2024-04-30 16:32:20 INFO     evaluating now!
2024-04-30 16:32:21 INFO     Epoch [33/200] train_loss: 4.2034, val_loss: 5.2672, lr: 0.003000, 7.07s
2024-04-30 16:32:27 INFO     epoch complete!
2024-04-30 16:32:27 INFO     evaluating now!
2024-04-30 16:32:28 INFO     Epoch [34/200] train_loss: 4.2317, val_loss: 5.0487, lr: 0.003000, 7.10s
2024-04-30 16:32:28 INFO     Saved model at 34
2024-04-30 16:32:28 INFO     Val loss decrease from 5.0557 to 5.0487, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-04-30 16:32:35 INFO     epoch complete!
2024-04-30 16:32:35 INFO     evaluating now!
2024-04-30 16:32:35 INFO     Epoch [35/200] train_loss: 4.1395, val_loss: 5.2372, lr: 0.003000, 7.15s
2024-04-30 16:32:42 INFO     epoch complete!
2024-04-30 16:32:42 INFO     evaluating now!
2024-04-30 16:32:42 INFO     Epoch [36/200] train_loss: 4.0528, val_loss: 5.0659, lr: 0.003000, 7.13s
2024-04-30 16:32:49 INFO     epoch complete!
2024-04-30 16:32:49 INFO     evaluating now!
2024-04-30 16:32:49 INFO     Epoch [37/200] train_loss: 4.0646, val_loss: 5.1254, lr: 0.003000, 7.14s
2024-04-30 16:32:56 INFO     epoch complete!
2024-04-30 16:32:56 INFO     evaluating now!
2024-04-30 16:32:56 INFO     Epoch [38/200] train_loss: 4.0278, val_loss: 5.2387, lr: 0.003000, 7.06s
2024-04-30 16:33:03 INFO     epoch complete!
2024-04-30 16:33:03 INFO     evaluating now!
2024-04-30 16:33:03 INFO     Epoch [39/200] train_loss: 4.0143, val_loss: 5.0139, lr: 0.003000, 7.10s
2024-04-30 16:33:04 INFO     Saved model at 39
2024-04-30 16:33:04 INFO     Val loss decrease from 5.0487 to 5.0139, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-04-30 16:33:10 INFO     epoch complete!
2024-04-30 16:33:10 INFO     evaluating now!
2024-04-30 16:33:11 INFO     Epoch [40/200] train_loss: 3.9970, val_loss: 5.1681, lr: 0.003000, 7.32s
2024-04-30 16:33:17 INFO     epoch complete!
2024-04-30 16:33:17 INFO     evaluating now!
2024-04-30 16:33:18 INFO     Epoch [41/200] train_loss: 3.9684, val_loss: 5.1147, lr: 0.003000, 6.96s
2024-04-30 16:33:24 INFO     epoch complete!
2024-04-30 16:33:24 INFO     evaluating now!
2024-04-30 16:33:25 INFO     Epoch [42/200] train_loss: 3.9302, val_loss: 5.1376, lr: 0.003000, 6.92s
2024-04-30 16:33:31 INFO     epoch complete!
2024-04-30 16:33:31 INFO     evaluating now!
2024-04-30 16:33:32 INFO     Epoch [43/200] train_loss: 3.9287, val_loss: 5.0158, lr: 0.003000, 6.93s
2024-04-30 16:33:38 INFO     epoch complete!
2024-04-30 16:33:38 INFO     evaluating now!
2024-04-30 16:33:39 INFO     Epoch [44/200] train_loss: 3.9229, val_loss: 5.0826, lr: 0.003000, 7.01s
2024-04-30 16:33:45 INFO     epoch complete!
2024-04-30 16:33:45 INFO     evaluating now!
2024-04-30 16:33:46 INFO     Epoch [45/200] train_loss: 3.8591, val_loss: 5.0802, lr: 0.003000, 7.02s
2024-04-30 16:33:52 INFO     epoch complete!
2024-04-30 16:33:52 INFO     evaluating now!
2024-04-30 16:33:53 INFO     Epoch [46/200] train_loss: 3.8151, val_loss: 5.1497, lr: 0.003000, 7.17s
2024-04-30 16:34:00 INFO     epoch complete!
2024-04-30 16:34:00 INFO     evaluating now!
2024-04-30 16:34:00 INFO     Epoch [47/200] train_loss: 3.7906, val_loss: 5.2399, lr: 0.003000, 7.41s
2024-04-30 16:34:07 INFO     epoch complete!
2024-04-30 16:34:07 INFO     evaluating now!
2024-04-30 16:34:07 INFO     Epoch [48/200] train_loss: 3.7659, val_loss: 5.0898, lr: 0.003000, 7.05s
2024-04-30 16:34:14 INFO     epoch complete!
2024-04-30 16:34:14 INFO     evaluating now!
2024-04-30 16:34:14 INFO     Epoch [49/200] train_loss: 3.7555, val_loss: 5.1269, lr: 0.003000, 7.06s
2024-04-30 16:34:21 INFO     epoch complete!
2024-04-30 16:34:21 INFO     evaluating now!
2024-04-30 16:34:21 INFO     Epoch [50/200] train_loss: 3.7122, val_loss: 5.0992, lr: 0.003000, 7.04s
2024-04-30 16:34:28 INFO     epoch complete!
2024-04-30 16:34:28 INFO     evaluating now!
2024-04-30 16:34:29 INFO     Epoch [51/200] train_loss: 3.7059, val_loss: 5.1701, lr: 0.003000, 7.09s
2024-04-30 16:34:35 INFO     epoch complete!
2024-04-30 16:34:35 INFO     evaluating now!
2024-04-30 16:34:36 INFO     Epoch [52/200] train_loss: 3.6944, val_loss: 5.1173, lr: 0.003000, 7.06s
2024-04-30 16:34:42 INFO     epoch complete!
2024-04-30 16:34:42 INFO     evaluating now!
2024-04-30 16:34:43 INFO     Epoch [53/200] train_loss: 3.6914, val_loss: 4.9867, lr: 0.003000, 7.12s
2024-04-30 16:34:43 INFO     Saved model at 53
2024-04-30 16:34:43 INFO     Val loss decrease from 5.0139 to 4.9867, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch53.tar
2024-04-30 16:34:49 INFO     epoch complete!
2024-04-30 16:34:49 INFO     evaluating now!
2024-04-30 16:34:50 INFO     Epoch [54/200] train_loss: 3.6766, val_loss: 5.1728, lr: 0.003000, 7.05s
2024-04-30 16:34:56 INFO     epoch complete!
2024-04-30 16:34:56 INFO     evaluating now!
2024-04-30 16:34:57 INFO     Epoch [55/200] train_loss: 3.6653, val_loss: 5.1461, lr: 0.003000, 7.13s
2024-04-30 16:35:04 INFO     epoch complete!
2024-04-30 16:35:04 INFO     evaluating now!
2024-04-30 16:35:04 INFO     Epoch [56/200] train_loss: 3.6355, val_loss: 5.0488, lr: 0.003000, 7.25s
2024-04-30 16:35:11 INFO     epoch complete!
2024-04-30 16:35:11 INFO     evaluating now!
2024-04-30 16:35:11 INFO     Epoch [57/200] train_loss: 3.5833, val_loss: 5.0253, lr: 0.003000, 7.13s
2024-04-30 16:35:18 INFO     epoch complete!
2024-04-30 16:35:18 INFO     evaluating now!
2024-04-30 16:35:18 INFO     Epoch [58/200] train_loss: 3.5820, val_loss: 5.0554, lr: 0.003000, 7.09s
2024-04-30 16:35:25 INFO     epoch complete!
2024-04-30 16:35:25 INFO     evaluating now!
2024-04-30 16:35:25 INFO     Epoch [59/200] train_loss: 3.5993, val_loss: 5.0718, lr: 0.003000, 7.08s
2024-04-30 16:35:32 INFO     epoch complete!
2024-04-30 16:35:32 INFO     evaluating now!
2024-04-30 16:35:33 INFO     Epoch [60/200] train_loss: 3.5527, val_loss: 5.0673, lr: 0.003000, 7.22s
2024-04-30 16:35:40 INFO     epoch complete!
2024-04-30 16:35:40 INFO     evaluating now!
2024-04-30 16:35:40 INFO     Epoch [61/200] train_loss: 3.5154, val_loss: 5.1862, lr: 0.003000, 7.38s
2024-04-30 16:35:47 INFO     epoch complete!
2024-04-30 16:35:47 INFO     evaluating now!
2024-04-30 16:35:47 INFO     Epoch [62/200] train_loss: 3.5215, val_loss: 5.0624, lr: 0.003000, 7.30s
2024-04-30 16:35:54 INFO     epoch complete!
2024-04-30 16:35:54 INFO     evaluating now!
2024-04-30 16:35:54 INFO     Epoch [63/200] train_loss: 3.5073, val_loss: 5.1776, lr: 0.003000, 7.11s
2024-04-30 16:36:01 INFO     epoch complete!
2024-04-30 16:36:01 INFO     evaluating now!
2024-04-30 16:36:01 INFO     Epoch [64/200] train_loss: 3.5188, val_loss: 5.1035, lr: 0.003000, 7.00s
2024-04-30 16:36:08 INFO     epoch complete!
2024-04-30 16:36:08 INFO     evaluating now!
2024-04-30 16:36:09 INFO     Epoch [65/200] train_loss: 3.5221, val_loss: 5.0130, lr: 0.003000, 7.08s
2024-04-30 16:36:15 INFO     epoch complete!
2024-04-30 16:36:15 INFO     evaluating now!
2024-04-30 16:36:16 INFO     Epoch [66/200] train_loss: 3.4660, val_loss: 4.8974, lr: 0.003000, 7.10s
2024-04-30 16:36:16 INFO     Saved model at 66
2024-04-30 16:36:16 INFO     Val loss decrease from 4.9867 to 4.8974, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch66.tar
2024-04-30 16:36:22 INFO     epoch complete!
2024-04-30 16:36:22 INFO     evaluating now!
2024-04-30 16:36:23 INFO     Epoch [67/200] train_loss: 3.4624, val_loss: 5.0635, lr: 0.003000, 7.11s
2024-04-30 16:36:30 INFO     epoch complete!
2024-04-30 16:36:30 INFO     evaluating now!
2024-04-30 16:36:30 INFO     Epoch [68/200] train_loss: 3.4657, val_loss: 5.0554, lr: 0.003000, 7.19s
2024-04-30 16:36:37 INFO     epoch complete!
2024-04-30 16:36:37 INFO     evaluating now!
2024-04-30 16:36:37 INFO     Epoch [69/200] train_loss: 3.4404, val_loss: 5.1699, lr: 0.003000, 7.26s
2024-04-30 16:36:44 INFO     epoch complete!
2024-04-30 16:36:44 INFO     evaluating now!
2024-04-30 16:36:45 INFO     Epoch [70/200] train_loss: 3.4093, val_loss: 5.0063, lr: 0.003000, 7.25s
2024-04-30 16:36:51 INFO     epoch complete!
2024-04-30 16:36:51 INFO     evaluating now!
2024-04-30 16:36:52 INFO     Epoch [71/200] train_loss: 3.4239, val_loss: 5.0290, lr: 0.003000, 7.16s
2024-04-30 16:36:58 INFO     epoch complete!
2024-04-30 16:36:58 INFO     evaluating now!
2024-04-30 16:36:59 INFO     Epoch [72/200] train_loss: 3.4672, val_loss: 5.1175, lr: 0.003000, 7.29s
2024-04-30 16:37:06 INFO     epoch complete!
2024-04-30 16:37:06 INFO     evaluating now!
2024-04-30 16:37:06 INFO     Epoch [73/200] train_loss: 3.4291, val_loss: 5.1544, lr: 0.003000, 7.17s
2024-04-30 16:37:13 INFO     epoch complete!
2024-04-30 16:37:13 INFO     evaluating now!
2024-04-30 16:37:14 INFO     Epoch [74/200] train_loss: 3.3745, val_loss: 5.0847, lr: 0.003000, 7.70s
2024-04-30 16:37:21 INFO     epoch complete!
2024-04-30 16:37:21 INFO     evaluating now!
2024-04-30 16:37:22 INFO     Epoch [75/200] train_loss: 3.3397, val_loss: 5.1157, lr: 0.003000, 7.96s
2024-04-30 16:37:29 INFO     epoch complete!
2024-04-30 16:37:29 INFO     evaluating now!
2024-04-30 16:37:30 INFO     Epoch [76/200] train_loss: 3.3213, val_loss: 5.1058, lr: 0.003000, 8.08s
2024-04-30 16:37:37 INFO     epoch complete!
2024-04-30 16:37:37 INFO     evaluating now!
2024-04-30 16:37:37 INFO     Epoch [77/200] train_loss: 3.3346, val_loss: 5.1125, lr: 0.003000, 7.57s
2024-04-30 16:37:44 INFO     epoch complete!
2024-04-30 16:37:44 INFO     evaluating now!
2024-04-30 16:37:45 INFO     Epoch [78/200] train_loss: 3.3171, val_loss: 5.1894, lr: 0.003000, 7.56s
2024-04-30 16:37:52 INFO     epoch complete!
2024-04-30 16:37:52 INFO     evaluating now!
2024-04-30 16:37:53 INFO     Epoch [79/200] train_loss: 3.3171, val_loss: 5.1405, lr: 0.003000, 7.58s
2024-04-30 16:38:00 INFO     epoch complete!
2024-04-30 16:38:00 INFO     evaluating now!
2024-04-30 16:38:00 INFO     Epoch [80/200] train_loss: 3.3091, val_loss: 5.1074, lr: 0.003000, 7.72s
2024-04-30 16:38:07 INFO     epoch complete!
2024-04-30 16:38:07 INFO     evaluating now!
2024-04-30 16:38:08 INFO     Epoch [81/200] train_loss: 3.2645, val_loss: 5.0719, lr: 0.003000, 7.54s
2024-04-30 16:38:08 WARNING  Early stopping at epoch: 81
2024-04-30 16:38:08 INFO     Trained totally 82 epochs, average train time is 6.719s, average eval time is 0.506s
2024-04-30 16:38:08 INFO     Loaded model at 66
2024-04-30 16:38:08 INFO     Saved model at ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 16:38:08 INFO     Start evaluating ...
2024-04-30 16:38:10 INFO     Note that you select the single mode to evaluate!
2024-04-30 16:38:10 INFO     Evaluate result is saved at ./libcity/cache/17/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 16:38:10 INFO     
         MAE       RMSE
1   2.202543   6.419216
2   2.342330   7.276064
3   2.567612   8.519386
4   2.703557   9.438991
5   2.880621  10.532191
6   3.012399  11.704130
7   3.118120  12.884867
8   3.203626  13.520767
9   3.236280  13.846212
10  3.264534  13.797303
11  3.292804  13.943483
12  3.369947  14.368953
2024-04-30 16:38:10 INFO     ----------------------------------------------------------------------------
2024-04-30 16:38:10 INFO     # 3, Kownledge Graph Embedding: GIE, Experiment ids: 18
2024-04-30 16:38:10 INFO     ----------------------------------------------------------------------------
2024-04-30 16:38:10 INFO     Log directory: ./libcity/log
2024-04-30 16:38:10 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=18
2024-04-30 16:38:10 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 859467155, 'exp_id': 18, 'load_external': True, 'embedding_model': 'GIE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 16:38:10 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 16:38:10 INFO     set_weight_link_or_dist: dist
2024-04-30 16:38:10 INFO     init_weight_inf_or_zero: inf
2024-04-30 16:38:10 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 16:38:10 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 16:38:10 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 16:38:10 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 16:38:13 INFO     Dataset created
2024-04-30 16:38:13 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 16:38:13 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 16:38:13 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 16:38:13 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 16:38:13 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 16:38:13 INFO     NoneScaler
2024-04-30 16:38:15 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 16:38:15 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 16:38:15 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 16:38:15 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 16:38:15 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 16:38:15 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 16:38:15 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 16:38:15 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 16:38:15 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 16:38:15 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 16:38:15 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 16:38:15 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 16:38:15 INFO     Total parameter numbers: 874010
2024-04-30 16:38:15 INFO     You select `adam` optimizer.
2024-04-30 16:38:15 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 16:38:15 INFO     Start training ...
2024-04-30 16:38:15 INFO     num_batches:48
2024-04-30 16:38:22 INFO     epoch complete!
2024-04-30 16:38:22 INFO     evaluating now!
2024-04-30 16:38:23 INFO     Epoch [0/200] train_loss: 24.1187, val_loss: 17.4932, lr: 0.003000, 7.13s
2024-04-30 16:38:23 INFO     Saved model at 0
2024-04-30 16:38:23 INFO     Val loss decrease from inf to 17.4932, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 16:38:29 INFO     epoch complete!
2024-04-30 16:38:29 INFO     evaluating now!
2024-04-30 16:38:30 INFO     Epoch [1/200] train_loss: 13.9878, val_loss: 13.1854, lr: 0.003000, 7.20s
2024-04-30 16:38:30 INFO     Saved model at 1
2024-04-30 16:38:30 INFO     Val loss decrease from 17.4932 to 13.1854, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 16:38:37 INFO     epoch complete!
2024-04-30 16:38:37 INFO     evaluating now!
2024-04-30 16:38:37 INFO     Epoch [2/200] train_loss: 10.9527, val_loss: 10.3946, lr: 0.003000, 7.23s
2024-04-30 16:38:37 INFO     Saved model at 2
2024-04-30 16:38:37 INFO     Val loss decrease from 13.1854 to 10.3946, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 16:38:44 INFO     epoch complete!
2024-04-30 16:38:44 INFO     evaluating now!
2024-04-30 16:38:44 INFO     Epoch [3/200] train_loss: 9.0525, val_loss: 8.4506, lr: 0.003000, 7.24s
2024-04-30 16:38:45 INFO     Saved model at 3
2024-04-30 16:38:45 INFO     Val loss decrease from 10.3946 to 8.4506, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 16:38:51 INFO     epoch complete!
2024-04-30 16:38:51 INFO     evaluating now!
2024-04-30 16:38:52 INFO     Epoch [4/200] train_loss: 7.8238, val_loss: 7.5930, lr: 0.003000, 7.37s
2024-04-30 16:38:52 INFO     Saved model at 4
2024-04-30 16:38:52 INFO     Val loss decrease from 8.4506 to 7.5930, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 16:38:59 INFO     epoch complete!
2024-04-30 16:38:59 INFO     evaluating now!
2024-04-30 16:38:59 INFO     Epoch [5/200] train_loss: 7.0551, val_loss: 6.9252, lr: 0.003000, 7.24s
2024-04-30 16:38:59 INFO     Saved model at 5
2024-04-30 16:38:59 INFO     Val loss decrease from 7.5930 to 6.9252, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 16:39:06 INFO     epoch complete!
2024-04-30 16:39:06 INFO     evaluating now!
2024-04-30 16:39:06 INFO     Epoch [6/200] train_loss: 6.5571, val_loss: 6.5378, lr: 0.003000, 7.23s
2024-04-30 16:39:07 INFO     Saved model at 6
2024-04-30 16:39:07 INFO     Val loss decrease from 6.9252 to 6.5378, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 16:39:13 INFO     epoch complete!
2024-04-30 16:39:13 INFO     evaluating now!
2024-04-30 16:39:14 INFO     Epoch [7/200] train_loss: 6.2236, val_loss: 6.1182, lr: 0.003000, 7.20s
2024-04-30 16:39:14 INFO     Saved model at 7
2024-04-30 16:39:14 INFO     Val loss decrease from 6.5378 to 6.1182, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 16:39:20 INFO     epoch complete!
2024-04-30 16:39:20 INFO     evaluating now!
2024-04-30 16:39:21 INFO     Epoch [8/200] train_loss: 5.9918, val_loss: 6.0631, lr: 0.003000, 7.07s
2024-04-30 16:39:24 INFO     Saved model at 8
2024-04-30 16:39:24 INFO     Val loss decrease from 6.1182 to 6.0631, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 16:39:31 INFO     epoch complete!
2024-04-30 16:39:31 INFO     evaluating now!
2024-04-30 16:39:32 INFO     Epoch [9/200] train_loss: 5.7944, val_loss: 5.9994, lr: 0.003000, 7.31s
2024-04-30 16:39:32 INFO     Saved model at 9
2024-04-30 16:39:32 INFO     Val loss decrease from 6.0631 to 5.9994, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 16:39:38 INFO     epoch complete!
2024-04-30 16:39:38 INFO     evaluating now!
2024-04-30 16:39:38 INFO     Epoch [10/200] train_loss: 5.6568, val_loss: 5.8169, lr: 0.003000, 6.76s
2024-04-30 16:39:38 INFO     Saved model at 10
2024-04-30 16:39:38 INFO     Val loss decrease from 5.9994 to 5.8169, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 16:39:45 INFO     epoch complete!
2024-04-30 16:39:45 INFO     evaluating now!
2024-04-30 16:39:45 INFO     Epoch [11/200] train_loss: 5.5137, val_loss: 5.8295, lr: 0.003000, 6.68s
2024-04-30 16:39:51 INFO     epoch complete!
2024-04-30 16:39:51 INFO     evaluating now!
2024-04-30 16:39:52 INFO     Epoch [12/200] train_loss: 5.3113, val_loss: 5.6759, lr: 0.003000, 6.64s
2024-04-30 16:39:52 INFO     Saved model at 12
2024-04-30 16:39:52 INFO     Val loss decrease from 5.8169 to 5.6759, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 16:39:58 INFO     epoch complete!
2024-04-30 16:39:58 INFO     evaluating now!
2024-04-30 16:39:59 INFO     Epoch [13/200] train_loss: 5.2461, val_loss: 5.6141, lr: 0.003000, 6.84s
2024-04-30 16:39:59 INFO     Saved model at 13
2024-04-30 16:39:59 INFO     Val loss decrease from 5.6759 to 5.6141, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 16:40:05 INFO     epoch complete!
2024-04-30 16:40:05 INFO     evaluating now!
2024-04-30 16:40:06 INFO     Epoch [14/200] train_loss: 5.1088, val_loss: 5.6104, lr: 0.003000, 6.90s
2024-04-30 16:40:06 INFO     Saved model at 14
2024-04-30 16:40:06 INFO     Val loss decrease from 5.6141 to 5.6104, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 16:40:12 INFO     epoch complete!
2024-04-30 16:40:12 INFO     evaluating now!
2024-04-30 16:40:12 INFO     Epoch [15/200] train_loss: 5.0969, val_loss: 5.5088, lr: 0.003000, 6.71s
2024-04-30 16:40:12 INFO     Saved model at 15
2024-04-30 16:40:12 INFO     Val loss decrease from 5.6104 to 5.5088, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 16:40:19 INFO     epoch complete!
2024-04-30 16:40:19 INFO     evaluating now!
2024-04-30 16:40:20 INFO     Epoch [16/200] train_loss: 4.9001, val_loss: 5.2964, lr: 0.003000, 7.59s
2024-04-30 16:40:20 INFO     Saved model at 16
2024-04-30 16:40:20 INFO     Val loss decrease from 5.5088 to 5.2964, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 16:40:27 INFO     epoch complete!
2024-04-30 16:40:27 INFO     evaluating now!
2024-04-30 16:40:27 INFO     Epoch [17/200] train_loss: 4.8256, val_loss: 5.1811, lr: 0.003000, 7.38s
2024-04-30 16:40:27 INFO     Saved model at 17
2024-04-30 16:40:27 INFO     Val loss decrease from 5.2964 to 5.1811, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 16:40:34 INFO     epoch complete!
2024-04-30 16:40:34 INFO     evaluating now!
2024-04-30 16:40:35 INFO     Epoch [18/200] train_loss: 4.8213, val_loss: 5.2814, lr: 0.003000, 7.33s
2024-04-30 16:40:42 INFO     epoch complete!
2024-04-30 16:40:42 INFO     evaluating now!
2024-04-30 16:40:43 INFO     Epoch [19/200] train_loss: 4.6987, val_loss: 5.0705, lr: 0.003000, 7.78s
2024-04-30 16:40:43 INFO     Saved model at 19
2024-04-30 16:40:43 INFO     Val loss decrease from 5.1811 to 5.0705, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 16:40:50 INFO     epoch complete!
2024-04-30 16:40:50 INFO     evaluating now!
2024-04-30 16:40:50 INFO     Epoch [20/200] train_loss: 4.6443, val_loss: 5.2439, lr: 0.003000, 7.52s
2024-04-30 16:40:57 INFO     epoch complete!
2024-04-30 16:40:57 INFO     evaluating now!
2024-04-30 16:40:58 INFO     Epoch [21/200] train_loss: 4.5579, val_loss: 5.3182, lr: 0.003000, 7.35s
2024-04-30 16:41:04 INFO     epoch complete!
2024-04-30 16:41:04 INFO     evaluating now!
2024-04-30 16:41:05 INFO     Epoch [22/200] train_loss: 4.5793, val_loss: 5.2497, lr: 0.003000, 7.47s
2024-04-30 16:41:12 INFO     epoch complete!
2024-04-30 16:41:12 INFO     evaluating now!
2024-04-30 16:41:12 INFO     Epoch [23/200] train_loss: 4.4781, val_loss: 5.4608, lr: 0.003000, 7.42s
2024-04-30 16:41:19 INFO     epoch complete!
2024-04-30 16:41:19 INFO     evaluating now!
2024-04-30 16:41:20 INFO     Epoch [24/200] train_loss: 4.4701, val_loss: 5.1503, lr: 0.003000, 7.27s
2024-04-30 16:41:26 INFO     epoch complete!
2024-04-30 16:41:26 INFO     evaluating now!
2024-04-30 16:41:27 INFO     Epoch [25/200] train_loss: 4.3841, val_loss: 5.1222, lr: 0.003000, 7.29s
2024-04-30 16:41:34 INFO     epoch complete!
2024-04-30 16:41:34 INFO     evaluating now!
2024-04-30 16:41:35 INFO     Epoch [26/200] train_loss: 4.3004, val_loss: 5.2805, lr: 0.003000, 7.54s
2024-04-30 16:41:41 INFO     epoch complete!
2024-04-30 16:41:41 INFO     evaluating now!
2024-04-30 16:41:42 INFO     Epoch [27/200] train_loss: 4.3519, val_loss: 5.3587, lr: 0.003000, 7.48s
2024-04-30 16:41:49 INFO     epoch complete!
2024-04-30 16:41:49 INFO     evaluating now!
2024-04-30 16:41:50 INFO     Epoch [28/200] train_loss: 4.3635, val_loss: 5.1609, lr: 0.003000, 7.60s
2024-04-30 16:41:56 INFO     epoch complete!
2024-04-30 16:41:56 INFO     evaluating now!
2024-04-30 16:41:57 INFO     Epoch [29/200] train_loss: 4.3051, val_loss: 5.1468, lr: 0.003000, 7.33s
2024-04-30 16:42:04 INFO     epoch complete!
2024-04-30 16:42:04 INFO     evaluating now!
2024-04-30 16:42:04 INFO     Epoch [30/200] train_loss: 4.1676, val_loss: 5.1109, lr: 0.003000, 7.30s
2024-04-30 16:42:11 INFO     epoch complete!
2024-04-30 16:42:11 INFO     evaluating now!
2024-04-30 16:42:11 INFO     Epoch [31/200] train_loss: 4.1537, val_loss: 5.1623, lr: 0.003000, 7.25s
2024-04-30 16:42:18 INFO     epoch complete!
2024-04-30 16:42:18 INFO     evaluating now!
2024-04-30 16:42:19 INFO     Epoch [32/200] train_loss: 4.1408, val_loss: 5.3674, lr: 0.003000, 7.30s
2024-04-30 16:42:26 INFO     epoch complete!
2024-04-30 16:42:26 INFO     evaluating now!
2024-04-30 16:42:26 INFO     Epoch [33/200] train_loss: 4.0869, val_loss: 5.0681, lr: 0.003000, 7.29s
2024-04-30 16:42:26 INFO     Saved model at 33
2024-04-30 16:42:26 INFO     Val loss decrease from 5.0705 to 5.0681, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-04-30 16:42:33 INFO     epoch complete!
2024-04-30 16:42:33 INFO     evaluating now!
2024-04-30 16:42:33 INFO     Epoch [34/200] train_loss: 4.0501, val_loss: 5.0177, lr: 0.003000, 7.17s
2024-04-30 16:42:33 INFO     Saved model at 34
2024-04-30 16:42:33 INFO     Val loss decrease from 5.0681 to 5.0177, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-04-30 16:42:40 INFO     epoch complete!
2024-04-30 16:42:40 INFO     evaluating now!
2024-04-30 16:42:40 INFO     Epoch [35/200] train_loss: 3.9966, val_loss: 5.0743, lr: 0.003000, 7.14s
2024-04-30 16:42:47 INFO     epoch complete!
2024-04-30 16:42:47 INFO     evaluating now!
2024-04-30 16:42:48 INFO     Epoch [36/200] train_loss: 4.0094, val_loss: 5.1064, lr: 0.003000, 7.32s
2024-04-30 16:42:55 INFO     epoch complete!
2024-04-30 16:42:55 INFO     evaluating now!
2024-04-30 16:42:55 INFO     Epoch [37/200] train_loss: 4.0080, val_loss: 5.2475, lr: 0.003000, 7.31s
2024-04-30 16:43:02 INFO     epoch complete!
2024-04-30 16:43:02 INFO     evaluating now!
2024-04-30 16:43:02 INFO     Epoch [38/200] train_loss: 3.9990, val_loss: 5.0038, lr: 0.003000, 7.31s
2024-04-30 16:43:02 INFO     Saved model at 38
2024-04-30 16:43:02 INFO     Val loss decrease from 5.0177 to 5.0038, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-04-30 16:43:09 INFO     epoch complete!
2024-04-30 16:43:09 INFO     evaluating now!
2024-04-30 16:43:10 INFO     Epoch [39/200] train_loss: 3.8860, val_loss: 5.0036, lr: 0.003000, 7.38s
2024-04-30 16:43:10 INFO     Saved model at 39
2024-04-30 16:43:10 INFO     Val loss decrease from 5.0038 to 5.0036, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-04-30 16:43:17 INFO     epoch complete!
2024-04-30 16:43:17 INFO     evaluating now!
2024-04-30 16:43:17 INFO     Epoch [40/200] train_loss: 3.8222, val_loss: 5.0961, lr: 0.003000, 7.25s
2024-04-30 16:43:24 INFO     epoch complete!
2024-04-30 16:43:24 INFO     evaluating now!
2024-04-30 16:43:24 INFO     Epoch [41/200] train_loss: 3.7914, val_loss: 5.0403, lr: 0.003000, 7.31s
2024-04-30 16:43:31 INFO     epoch complete!
2024-04-30 16:43:31 INFO     evaluating now!
2024-04-30 16:43:32 INFO     Epoch [42/200] train_loss: 3.7952, val_loss: 4.9555, lr: 0.003000, 7.40s
2024-04-30 16:43:32 INFO     Saved model at 42
2024-04-30 16:43:32 INFO     Val loss decrease from 5.0036 to 4.9555, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-04-30 16:43:39 INFO     epoch complete!
2024-04-30 16:43:39 INFO     evaluating now!
2024-04-30 16:43:39 INFO     Epoch [43/200] train_loss: 3.8176, val_loss: 5.2678, lr: 0.003000, 7.27s
2024-04-30 16:43:46 INFO     epoch complete!
2024-04-30 16:43:46 INFO     evaluating now!
2024-04-30 16:43:46 INFO     Epoch [44/200] train_loss: 3.7973, val_loss: 5.0555, lr: 0.003000, 7.29s
2024-04-30 16:43:53 INFO     epoch complete!
2024-04-30 16:43:53 INFO     evaluating now!
2024-04-30 16:43:54 INFO     Epoch [45/200] train_loss: 3.7970, val_loss: 5.2177, lr: 0.003000, 7.22s
2024-04-30 16:44:01 INFO     epoch complete!
2024-04-30 16:44:01 INFO     evaluating now!
2024-04-30 16:44:01 INFO     Epoch [46/200] train_loss: 3.8011, val_loss: 5.2120, lr: 0.003000, 7.37s
2024-04-30 16:44:08 INFO     epoch complete!
2024-04-30 16:44:08 INFO     evaluating now!
2024-04-30 16:44:08 INFO     Epoch [47/200] train_loss: 3.7434, val_loss: 5.0882, lr: 0.003000, 7.40s
2024-04-30 16:44:16 INFO     epoch complete!
2024-04-30 16:44:16 INFO     evaluating now!
2024-04-30 16:44:16 INFO     Epoch [48/200] train_loss: 3.7108, val_loss: 5.0465, lr: 0.003000, 7.59s
2024-04-30 16:44:23 INFO     epoch complete!
2024-04-30 16:44:23 INFO     evaluating now!
2024-04-30 16:44:24 INFO     Epoch [49/200] train_loss: 3.6600, val_loss: 5.0330, lr: 0.003000, 7.46s
2024-04-30 16:44:30 INFO     epoch complete!
2024-04-30 16:44:30 INFO     evaluating now!
2024-04-30 16:44:31 INFO     Epoch [50/200] train_loss: 3.6546, val_loss: 5.0196, lr: 0.003000, 7.26s
2024-04-30 16:44:38 INFO     epoch complete!
2024-04-30 16:44:38 INFO     evaluating now!
2024-04-30 16:44:38 INFO     Epoch [51/200] train_loss: 3.6616, val_loss: 5.0745, lr: 0.003000, 7.36s
2024-04-30 16:44:45 INFO     epoch complete!
2024-04-30 16:44:45 INFO     evaluating now!
2024-04-30 16:44:46 INFO     Epoch [52/200] train_loss: 3.6392, val_loss: 5.0899, lr: 0.003000, 7.40s
2024-04-30 16:44:52 INFO     epoch complete!
2024-04-30 16:44:52 INFO     evaluating now!
2024-04-30 16:44:53 INFO     Epoch [53/200] train_loss: 3.6417, val_loss: 5.1251, lr: 0.003000, 7.40s
2024-04-30 16:45:00 INFO     epoch complete!
2024-04-30 16:45:00 INFO     evaluating now!
2024-04-30 16:45:00 INFO     Epoch [54/200] train_loss: 3.6130, val_loss: 5.2079, lr: 0.003000, 7.54s
2024-04-30 16:45:07 INFO     epoch complete!
2024-04-30 16:45:07 INFO     evaluating now!
2024-04-30 16:45:08 INFO     Epoch [55/200] train_loss: 3.5860, val_loss: 5.0997, lr: 0.003000, 7.27s
2024-04-30 16:45:15 INFO     epoch complete!
2024-04-30 16:45:15 INFO     evaluating now!
2024-04-30 16:45:15 INFO     Epoch [56/200] train_loss: 3.5879, val_loss: 4.9280, lr: 0.003000, 7.35s
2024-04-30 16:45:15 INFO     Saved model at 56
2024-04-30 16:45:15 INFO     Val loss decrease from 4.9555 to 4.9280, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch56.tar
2024-04-30 16:45:22 INFO     epoch complete!
2024-04-30 16:45:22 INFO     evaluating now!
2024-04-30 16:45:23 INFO     Epoch [57/200] train_loss: 3.5435, val_loss: 4.9673, lr: 0.003000, 7.52s
2024-04-30 16:45:29 INFO     epoch complete!
2024-04-30 16:45:29 INFO     evaluating now!
2024-04-30 16:45:30 INFO     Epoch [58/200] train_loss: 3.5455, val_loss: 5.0637, lr: 0.003000, 7.29s
2024-04-30 16:45:37 INFO     epoch complete!
2024-04-30 16:45:37 INFO     evaluating now!
2024-04-30 16:45:37 INFO     Epoch [59/200] train_loss: 3.4854, val_loss: 5.1298, lr: 0.003000, 7.43s
2024-04-30 16:45:44 INFO     epoch complete!
2024-04-30 16:45:44 INFO     evaluating now!
2024-04-30 16:45:45 INFO     Epoch [60/200] train_loss: 3.5346, val_loss: 5.0457, lr: 0.003000, 7.38s
2024-04-30 16:45:51 INFO     epoch complete!
2024-04-30 16:45:51 INFO     evaluating now!
2024-04-30 16:45:51 INFO     Epoch [61/200] train_loss: 3.5207, val_loss: 5.0260, lr: 0.003000, 6.66s
2024-04-30 16:45:57 INFO     epoch complete!
2024-04-30 16:45:57 INFO     evaluating now!
2024-04-30 16:45:58 INFO     Epoch [62/200] train_loss: 3.4509, val_loss: 5.0350, lr: 0.003000, 6.38s
2024-04-30 16:46:04 INFO     epoch complete!
2024-04-30 16:46:04 INFO     evaluating now!
2024-04-30 16:46:04 INFO     Epoch [63/200] train_loss: 3.4631, val_loss: 5.0320, lr: 0.003000, 6.40s
2024-04-30 16:46:10 INFO     epoch complete!
2024-04-30 16:46:10 INFO     evaluating now!
2024-04-30 16:46:11 INFO     Epoch [64/200] train_loss: 3.4355, val_loss: 5.0313, lr: 0.003000, 6.41s
2024-04-30 16:46:17 INFO     epoch complete!
2024-04-30 16:46:17 INFO     evaluating now!
2024-04-30 16:46:17 INFO     Epoch [65/200] train_loss: 3.4605, val_loss: 5.1058, lr: 0.003000, 6.46s
2024-04-30 16:46:23 INFO     epoch complete!
2024-04-30 16:46:23 INFO     evaluating now!
2024-04-30 16:46:24 INFO     Epoch [66/200] train_loss: 3.5048, val_loss: 5.0116, lr: 0.003000, 6.52s
2024-04-30 16:46:30 INFO     epoch complete!
2024-04-30 16:46:30 INFO     evaluating now!
2024-04-30 16:46:30 INFO     Epoch [67/200] train_loss: 3.3979, val_loss: 5.0882, lr: 0.003000, 6.47s
2024-04-30 16:46:37 INFO     epoch complete!
2024-04-30 16:46:37 INFO     evaluating now!
2024-04-30 16:46:37 INFO     Epoch [68/200] train_loss: 3.3955, val_loss: 5.0559, lr: 0.003000, 6.89s
2024-04-30 16:46:43 INFO     epoch complete!
2024-04-30 16:46:43 INFO     evaluating now!
2024-04-30 16:46:44 INFO     Epoch [69/200] train_loss: 3.4084, val_loss: 4.9828, lr: 0.003000, 6.81s
2024-04-30 16:46:50 INFO     epoch complete!
2024-04-30 16:46:50 INFO     evaluating now!
2024-04-30 16:46:51 INFO     Epoch [70/200] train_loss: 3.3417, val_loss: 4.9877, lr: 0.003000, 6.82s
2024-04-30 16:46:57 INFO     epoch complete!
2024-04-30 16:46:57 INFO     evaluating now!
2024-04-30 16:46:58 INFO     Epoch [71/200] train_loss: 3.3583, val_loss: 5.0354, lr: 0.003000, 7.27s
2024-04-30 16:46:58 WARNING  Early stopping at epoch: 71
2024-04-30 16:46:58 INFO     Trained totally 72 epochs, average train time is 6.694s, average eval time is 0.494s
2024-04-30 16:46:58 INFO     Loaded model at 56
2024-04-30 16:46:58 INFO     Saved model at ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 16:46:58 INFO     Start evaluating ...
2024-04-30 16:47:00 INFO     Note that you select the single mode to evaluate!
2024-04-30 16:47:00 INFO     Evaluate result is saved at ./libcity/cache/18/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 16:47:00 INFO     
         MAE       RMSE
1   2.371235   7.420486
2   2.442565   7.813426
3   2.598954   8.635850
4   2.736491   9.497629
5   2.880161  10.361942
6   3.027685  11.192264
7   3.130164  12.085850
8   3.216075  12.701807
9   3.250882  13.053504
10  3.339050  13.279284
11  3.294923  13.356644
12  3.399271  13.708429
2024-04-30 16:47:00 INFO     ----------------------------------------------------------------------------
2024-04-30 16:47:00 INFO     # 4, Kownledge Graph Embedding: GIE, Experiment ids: 19
2024-04-30 16:47:00 INFO     ----------------------------------------------------------------------------
2024-04-30 16:47:00 INFO     Log directory: ./libcity/log
2024-04-30 16:47:00 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=19
2024-04-30 16:47:00 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 857592831, 'exp_id': 19, 'load_external': True, 'embedding_model': 'GIE', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 16:47:00 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 16:47:00 INFO     set_weight_link_or_dist: dist
2024-04-30 16:47:00 INFO     init_weight_inf_or_zero: inf
2024-04-30 16:47:00 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 16:47:00 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 16:47:00 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 16:47:00 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 16:47:03 INFO     Dataset created
2024-04-30 16:47:03 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 16:47:03 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 16:47:03 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 16:47:03 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 16:47:03 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 16:47:03 INFO     NoneScaler
2024-04-30 16:47:05 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 16:47:05 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 16:47:05 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 16:47:05 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 16:47:05 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 16:47:05 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 16:47:05 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 16:47:05 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 16:47:05 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 16:47:05 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 16:47:05 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 16:47:05 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 16:47:05 INFO     Total parameter numbers: 874010
2024-04-30 16:47:05 INFO     You select `adam` optimizer.
2024-04-30 16:47:05 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 16:47:05 INFO     Start training ...
2024-04-30 16:47:05 INFO     num_batches:48
2024-04-30 16:47:12 INFO     epoch complete!
2024-04-30 16:47:12 INFO     evaluating now!
2024-04-30 16:47:13 INFO     Epoch [0/200] train_loss: 23.7562, val_loss: 17.8179, lr: 0.003000, 7.25s
2024-04-30 16:47:13 INFO     Saved model at 0
2024-04-30 16:47:13 INFO     Val loss decrease from inf to 17.8179, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 16:47:20 INFO     epoch complete!
2024-04-30 16:47:20 INFO     evaluating now!
2024-04-30 16:47:20 INFO     Epoch [1/200] train_loss: 14.0233, val_loss: 13.2227, lr: 0.003000, 7.26s
2024-04-30 16:47:20 INFO     Saved model at 1
2024-04-30 16:47:20 INFO     Val loss decrease from 17.8179 to 13.2227, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 16:47:27 INFO     epoch complete!
2024-04-30 16:47:27 INFO     evaluating now!
2024-04-30 16:47:27 INFO     Epoch [2/200] train_loss: 10.8839, val_loss: 10.3563, lr: 0.003000, 6.94s
2024-04-30 16:47:27 INFO     Saved model at 2
2024-04-30 16:47:27 INFO     Val loss decrease from 13.2227 to 10.3563, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 16:47:33 INFO     epoch complete!
2024-04-30 16:47:33 INFO     evaluating now!
2024-04-30 16:47:33 INFO     Epoch [3/200] train_loss: 9.0922, val_loss: 8.6886, lr: 0.003000, 6.30s
2024-04-30 16:47:33 INFO     Saved model at 3
2024-04-30 16:47:33 INFO     Val loss decrease from 10.3563 to 8.6886, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 16:47:39 INFO     epoch complete!
2024-04-30 16:47:39 INFO     evaluating now!
2024-04-30 16:47:40 INFO     Epoch [4/200] train_loss: 7.8319, val_loss: 7.4422, lr: 0.003000, 6.20s
2024-04-30 16:47:40 INFO     Saved model at 4
2024-04-30 16:47:40 INFO     Val loss decrease from 8.6886 to 7.4422, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 16:47:46 INFO     epoch complete!
2024-04-30 16:47:46 INFO     evaluating now!
2024-04-30 16:47:46 INFO     Epoch [5/200] train_loss: 7.1424, val_loss: 6.7909, lr: 0.003000, 6.33s
2024-04-30 16:47:46 INFO     Saved model at 5
2024-04-30 16:47:46 INFO     Val loss decrease from 7.4422 to 6.7909, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 16:47:52 INFO     epoch complete!
2024-04-30 16:47:52 INFO     evaluating now!
2024-04-30 16:47:53 INFO     Epoch [6/200] train_loss: 6.5926, val_loss: 6.3820, lr: 0.003000, 6.46s
2024-04-30 16:47:53 INFO     Saved model at 6
2024-04-30 16:47:53 INFO     Val loss decrease from 6.7909 to 6.3820, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 16:47:59 INFO     epoch complete!
2024-04-30 16:47:59 INFO     evaluating now!
2024-04-30 16:47:59 INFO     Epoch [7/200] train_loss: 6.2148, val_loss: 6.2122, lr: 0.003000, 6.52s
2024-04-30 16:47:59 INFO     Saved model at 7
2024-04-30 16:47:59 INFO     Val loss decrease from 6.3820 to 6.2122, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 16:48:05 INFO     epoch complete!
2024-04-30 16:48:05 INFO     evaluating now!
2024-04-30 16:48:05 INFO     Epoch [8/200] train_loss: 5.8939, val_loss: 6.0775, lr: 0.003000, 6.31s
2024-04-30 16:48:06 INFO     Saved model at 8
2024-04-30 16:48:06 INFO     Val loss decrease from 6.2122 to 6.0775, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 16:48:11 INFO     epoch complete!
2024-04-30 16:48:11 INFO     evaluating now!
2024-04-30 16:48:12 INFO     Epoch [9/200] train_loss: 5.8646, val_loss: 5.8682, lr: 0.003000, 6.26s
2024-04-30 16:48:12 INFO     Saved model at 9
2024-04-30 16:48:12 INFO     Val loss decrease from 6.0775 to 5.8682, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 16:48:18 INFO     epoch complete!
2024-04-30 16:48:18 INFO     evaluating now!
2024-04-30 16:48:18 INFO     Epoch [10/200] train_loss: 5.5926, val_loss: 5.9355, lr: 0.003000, 6.27s
2024-04-30 16:48:24 INFO     epoch complete!
2024-04-30 16:48:24 INFO     evaluating now!
2024-04-30 16:48:24 INFO     Epoch [11/200] train_loss: 5.5080, val_loss: 6.0447, lr: 0.003000, 6.31s
2024-04-30 16:48:30 INFO     epoch complete!
2024-04-30 16:48:30 INFO     evaluating now!
2024-04-30 16:48:31 INFO     Epoch [12/200] train_loss: 5.3925, val_loss: 5.6121, lr: 0.003000, 6.46s
2024-04-30 16:48:31 INFO     Saved model at 12
2024-04-30 16:48:31 INFO     Val loss decrease from 5.8682 to 5.6121, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 16:48:37 INFO     epoch complete!
2024-04-30 16:48:37 INFO     evaluating now!
2024-04-30 16:48:38 INFO     Epoch [13/200] train_loss: 5.2520, val_loss: 5.6736, lr: 0.003000, 6.62s
2024-04-30 16:48:44 INFO     epoch complete!
2024-04-30 16:48:44 INFO     evaluating now!
2024-04-30 16:48:44 INFO     Epoch [14/200] train_loss: 5.1113, val_loss: 5.4890, lr: 0.003000, 6.56s
2024-04-30 16:48:44 INFO     Saved model at 14
2024-04-30 16:48:44 INFO     Val loss decrease from 5.6121 to 5.4890, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 16:48:50 INFO     epoch complete!
2024-04-30 16:48:50 INFO     evaluating now!
2024-04-30 16:48:51 INFO     Epoch [15/200] train_loss: 5.0422, val_loss: 5.3928, lr: 0.003000, 6.72s
2024-04-30 16:48:51 INFO     Saved model at 15
2024-04-30 16:48:51 INFO     Val loss decrease from 5.4890 to 5.3928, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 16:48:57 INFO     epoch complete!
2024-04-30 16:48:57 INFO     evaluating now!
2024-04-30 16:48:58 INFO     Epoch [16/200] train_loss: 4.9834, val_loss: 5.4914, lr: 0.003000, 6.75s
2024-04-30 16:49:04 INFO     epoch complete!
2024-04-30 16:49:04 INFO     evaluating now!
2024-04-30 16:49:05 INFO     Epoch [17/200] train_loss: 4.8636, val_loss: 5.6406, lr: 0.003000, 6.90s
2024-04-30 16:49:11 INFO     epoch complete!
2024-04-30 16:49:11 INFO     evaluating now!
2024-04-30 16:49:11 INFO     Epoch [18/200] train_loss: 4.8343, val_loss: 5.4571, lr: 0.003000, 6.78s
2024-04-30 16:49:18 INFO     epoch complete!
2024-04-30 16:49:18 INFO     evaluating now!
2024-04-30 16:49:18 INFO     Epoch [19/200] train_loss: 4.7264, val_loss: 5.1961, lr: 0.003000, 6.92s
2024-04-30 16:49:18 INFO     Saved model at 19
2024-04-30 16:49:18 INFO     Val loss decrease from 5.3928 to 5.1961, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 16:49:25 INFO     epoch complete!
2024-04-30 16:49:25 INFO     evaluating now!
2024-04-30 16:49:26 INFO     Epoch [20/200] train_loss: 4.6751, val_loss: 5.1983, lr: 0.003000, 7.33s
2024-04-30 16:49:33 INFO     epoch complete!
2024-04-30 16:49:33 INFO     evaluating now!
2024-04-30 16:49:33 INFO     Epoch [21/200] train_loss: 4.6162, val_loss: 5.2188, lr: 0.003000, 7.45s
2024-04-30 16:49:40 INFO     epoch complete!
2024-04-30 16:49:40 INFO     evaluating now!
2024-04-30 16:49:41 INFO     Epoch [22/200] train_loss: 4.6011, val_loss: 5.5363, lr: 0.003000, 7.44s
2024-04-30 16:49:47 INFO     epoch complete!
2024-04-30 16:49:47 INFO     evaluating now!
2024-04-30 16:49:48 INFO     Epoch [23/200] train_loss: 4.5503, val_loss: 5.0851, lr: 0.003000, 7.21s
2024-04-30 16:49:48 INFO     Saved model at 23
2024-04-30 16:49:48 INFO     Val loss decrease from 5.1961 to 5.0851, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-30 16:49:55 INFO     epoch complete!
2024-04-30 16:49:55 INFO     evaluating now!
2024-04-30 16:49:55 INFO     Epoch [24/200] train_loss: 4.4857, val_loss: 5.3037, lr: 0.003000, 7.25s
2024-04-30 16:50:02 INFO     epoch complete!
2024-04-30 16:50:02 INFO     evaluating now!
2024-04-30 16:50:03 INFO     Epoch [25/200] train_loss: 4.4379, val_loss: 5.1547, lr: 0.003000, 7.49s
2024-04-30 16:50:09 INFO     epoch complete!
2024-04-30 16:50:09 INFO     evaluating now!
2024-04-30 16:50:10 INFO     Epoch [26/200] train_loss: 4.3563, val_loss: 5.1966, lr: 0.003000, 7.14s
2024-04-30 16:50:16 INFO     epoch complete!
2024-04-30 16:50:16 INFO     evaluating now!
2024-04-30 16:50:17 INFO     Epoch [27/200] train_loss: 4.2914, val_loss: 5.3251, lr: 0.003000, 6.89s
2024-04-30 16:50:23 INFO     epoch complete!
2024-04-30 16:50:23 INFO     evaluating now!
2024-04-30 16:50:23 INFO     Epoch [28/200] train_loss: 4.2928, val_loss: 5.0866, lr: 0.003000, 6.77s
2024-04-30 16:50:30 INFO     epoch complete!
2024-04-30 16:50:30 INFO     evaluating now!
2024-04-30 16:50:30 INFO     Epoch [29/200] train_loss: 4.2110, val_loss: 5.2756, lr: 0.003000, 6.77s
2024-04-30 16:50:37 INFO     epoch complete!
2024-04-30 16:50:37 INFO     evaluating now!
2024-04-30 16:50:37 INFO     Epoch [30/200] train_loss: 4.2489, val_loss: 5.3521, lr: 0.003000, 6.85s
2024-04-30 16:50:43 INFO     epoch complete!
2024-04-30 16:50:43 INFO     evaluating now!
2024-04-30 16:50:44 INFO     Epoch [31/200] train_loss: 4.2262, val_loss: 5.1812, lr: 0.003000, 6.84s
2024-04-30 16:50:50 INFO     epoch complete!
2024-04-30 16:50:50 INFO     evaluating now!
2024-04-30 16:50:50 INFO     Epoch [32/200] train_loss: 4.1877, val_loss: 5.2148, lr: 0.003000, 6.51s
2024-04-30 16:50:56 INFO     epoch complete!
2024-04-30 16:50:56 INFO     evaluating now!
2024-04-30 16:50:56 INFO     Epoch [33/200] train_loss: 4.0669, val_loss: 5.2759, lr: 0.003000, 6.06s
2024-04-30 16:51:03 INFO     epoch complete!
2024-04-30 16:51:03 INFO     evaluating now!
2024-04-30 16:51:03 INFO     Epoch [34/200] train_loss: 4.0983, val_loss: 5.1734, lr: 0.003000, 6.72s
2024-04-30 16:51:09 INFO     epoch complete!
2024-04-30 16:51:09 INFO     evaluating now!
2024-04-30 16:51:10 INFO     Epoch [35/200] train_loss: 4.0302, val_loss: 5.0127, lr: 0.003000, 6.83s
2024-04-30 16:51:10 INFO     Saved model at 35
2024-04-30 16:51:10 INFO     Val loss decrease from 5.0851 to 5.0127, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-04-30 16:51:16 INFO     epoch complete!
2024-04-30 16:51:16 INFO     evaluating now!
2024-04-30 16:51:16 INFO     Epoch [36/200] train_loss: 4.0010, val_loss: 5.1269, lr: 0.003000, 6.46s
2024-04-30 16:51:22 INFO     epoch complete!
2024-04-30 16:51:22 INFO     evaluating now!
2024-04-30 16:51:23 INFO     Epoch [37/200] train_loss: 3.9801, val_loss: 5.0844, lr: 0.003000, 6.48s
2024-04-30 16:51:29 INFO     epoch complete!
2024-04-30 16:51:29 INFO     evaluating now!
2024-04-30 16:51:29 INFO     Epoch [38/200] train_loss: 3.9325, val_loss: 5.2516, lr: 0.003000, 6.55s
2024-04-30 16:51:36 INFO     epoch complete!
2024-04-30 16:51:36 INFO     evaluating now!
2024-04-30 16:51:36 INFO     Epoch [39/200] train_loss: 3.9420, val_loss: 4.9672, lr: 0.003000, 6.53s
2024-04-30 16:51:36 INFO     Saved model at 39
2024-04-30 16:51:36 INFO     Val loss decrease from 5.0127 to 4.9672, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-04-30 16:51:42 INFO     epoch complete!
2024-04-30 16:51:42 INFO     evaluating now!
2024-04-30 16:51:43 INFO     Epoch [40/200] train_loss: 3.9450, val_loss: 5.0314, lr: 0.003000, 6.62s
2024-04-30 16:51:49 INFO     epoch complete!
2024-04-30 16:51:49 INFO     evaluating now!
2024-04-30 16:51:49 INFO     Epoch [41/200] train_loss: 3.8435, val_loss: 5.2025, lr: 0.003000, 6.84s
2024-04-30 16:51:56 INFO     epoch complete!
2024-04-30 16:51:56 INFO     evaluating now!
2024-04-30 16:51:56 INFO     Epoch [42/200] train_loss: 3.8592, val_loss: 5.3328, lr: 0.003000, 6.76s
2024-04-30 16:52:03 INFO     epoch complete!
2024-04-30 16:52:03 INFO     evaluating now!
2024-04-30 16:52:03 INFO     Epoch [43/200] train_loss: 3.8952, val_loss: 5.0545, lr: 0.003000, 6.79s
2024-04-30 16:52:10 INFO     epoch complete!
2024-04-30 16:52:10 INFO     evaluating now!
2024-04-30 16:52:10 INFO     Epoch [44/200] train_loss: 3.8145, val_loss: 5.1419, lr: 0.003000, 6.92s
2024-04-30 16:52:16 INFO     epoch complete!
2024-04-30 16:52:16 INFO     evaluating now!
2024-04-30 16:52:16 INFO     Epoch [45/200] train_loss: 3.7676, val_loss: 5.2427, lr: 0.003000, 6.50s
2024-04-30 16:52:22 INFO     epoch complete!
2024-04-30 16:52:22 INFO     evaluating now!
2024-04-30 16:52:22 INFO     Epoch [46/200] train_loss: 3.7725, val_loss: 5.0461, lr: 0.003000, 5.97s
2024-04-30 16:52:28 INFO     epoch complete!
2024-04-30 16:52:28 INFO     evaluating now!
2024-04-30 16:52:29 INFO     Epoch [47/200] train_loss: 3.7691, val_loss: 5.0169, lr: 0.003000, 6.15s
2024-04-30 16:52:34 INFO     epoch complete!
2024-04-30 16:52:34 INFO     evaluating now!
2024-04-30 16:52:35 INFO     Epoch [48/200] train_loss: 3.6720, val_loss: 5.1946, lr: 0.003000, 6.16s
2024-04-30 16:52:40 INFO     epoch complete!
2024-04-30 16:52:40 INFO     evaluating now!
2024-04-30 16:52:41 INFO     Epoch [49/200] train_loss: 3.7037, val_loss: 5.1268, lr: 0.003000, 6.14s
2024-04-30 16:52:47 INFO     epoch complete!
2024-04-30 16:52:47 INFO     evaluating now!
2024-04-30 16:52:47 INFO     Epoch [50/200] train_loss: 3.6689, val_loss: 5.1504, lr: 0.003000, 6.02s
2024-04-30 16:52:53 INFO     epoch complete!
2024-04-30 16:52:53 INFO     evaluating now!
2024-04-30 16:52:53 INFO     Epoch [51/200] train_loss: 3.6300, val_loss: 5.0794, lr: 0.003000, 6.13s
2024-04-30 16:53:00 INFO     epoch complete!
2024-04-30 16:53:00 INFO     evaluating now!
2024-04-30 16:53:00 INFO     Epoch [52/200] train_loss: 3.5963, val_loss: 5.1183, lr: 0.003000, 7.05s
2024-04-30 16:53:06 INFO     epoch complete!
2024-04-30 16:53:06 INFO     evaluating now!
2024-04-30 16:53:07 INFO     Epoch [53/200] train_loss: 3.5864, val_loss: 5.0613, lr: 0.003000, 6.57s
2024-04-30 16:53:13 INFO     epoch complete!
2024-04-30 16:53:13 INFO     evaluating now!
2024-04-30 16:53:13 INFO     Epoch [54/200] train_loss: 3.5470, val_loss: 5.0504, lr: 0.003000, 6.71s
2024-04-30 16:53:13 WARNING  Early stopping at epoch: 54
2024-04-30 16:53:13 INFO     Trained totally 55 epochs, average train time is 6.235s, average eval time is 0.434s
2024-04-30 16:53:14 INFO     Loaded model at 39
2024-04-30 16:53:14 INFO     Saved model at ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 16:53:14 INFO     Start evaluating ...
2024-04-30 16:53:16 INFO     Note that you select the single mode to evaluate!
2024-04-30 16:53:16 INFO     Evaluate result is saved at ./libcity/cache/19/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 16:53:16 INFO     
         MAE       RMSE
1   2.377465   7.338022
2   2.410965   7.604680
3   2.618552   8.555649
4   2.768987   9.440316
5   2.944489  10.521563
6   3.101657  11.721628
7   3.230088  12.856877
8   3.308173  13.702728
9   3.405013  14.074450
10  3.411016  14.150680
11  3.440357  14.143691
12  3.492188  14.403461
2024-04-30 16:53:16 INFO     ----------------------------------------------------------------------------
2024-04-30 16:53:16 INFO     Kownledge Graph Embedding: GIE, Experiment ids: [15, 16, 17, 18, 19]
2024-04-30 16:53:16 INFO     ----------------------------------------------------------------------------
2024-04-30 16:53:16 INFO     Average: 
         MAE       RMSE
0   2.323571   7.074158
1   2.419818   7.617557
2   2.615000   8.684922
3   2.771584   9.612160
4   2.930750  10.637834
5   3.053522  11.596044
6   3.148286  12.469208
7   3.231875  13.034358
8   3.274409  13.315070
9   3.309957  13.430447
10  3.349077  13.602755
11  3.446247  14.052508 
2024-04-30 16:53:16 INFO     Standard deviation: 
         MAE      RMSE
0   0.076243  0.356757
1   0.046875  0.188307
2   0.032577  0.156296
3   0.057456  0.210271
4   0.065184  0.335830
5   0.068741  0.461898
6   0.059041  0.545953
7   0.061734  0.593852
8   0.069715  0.590009
9   0.060815  0.491511
10  0.055163  0.369597
11  0.067389  0.287200
2024-04-30 16:53:16 INFO     ----------------------------------------------------------------------------
2024-04-30 16:53:16 INFO     12 steps Average: 
        MAE       RMSE
0  2.989508  11.260585
2024-04-30 16:53:16 INFO     12 steps Standard deviation: 
        MAE     RMSE
0  0.060078  0.38229
