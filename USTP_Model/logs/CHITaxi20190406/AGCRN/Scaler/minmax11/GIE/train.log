2024-05-01 14:24:04 INFO     ----------------------------------------------------------------------------
2024-05-01 14:24:04 INFO     # 0, Kownledge Graph Embedding: GIE, Experiment ids: 15
2024-05-01 14:24:04 INFO     ----------------------------------------------------------------------------
2024-05-01 14:24:04 INFO     Log directory: ./libcity/log
2024-05-01 14:24:04 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=15
2024-05-01 14:24:04 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 156023898, 'exp_id': 15, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'minmax11', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 14:24:04 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 14:24:04 INFO     set_weight_link_or_dist: dist
2024-05-01 14:24:04 INFO     init_weight_inf_or_zero: inf
2024-05-01 14:24:04 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 14:24:04 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 14:24:04 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 14:24:04 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 14:24:07 INFO     Dataset created
2024-05-01 14:24:07 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 14:24:07 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 14:24:07 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 14:24:07 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 14:24:07 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 14:24:07 INFO     MinMax11Scaler max: 0.3243229993054587, min: -0.6629940242690735
2024-05-01 14:24:13 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 14:24:13 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 14:24:13 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 14:24:13 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 14:24:13 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 14:24:13 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 14:24:13 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 14:24:13 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 14:24:13 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 14:24:13 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 14:24:13 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 14:24:13 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 14:24:13 INFO     Total parameter numbers: 874010
2024-05-01 14:24:13 INFO     You select `adam` optimizer.
2024-05-01 14:24:13 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 14:24:13 INFO     Start training ...
2024-05-01 14:24:13 INFO     num_batches:48
2024-05-01 14:24:19 INFO     epoch complete!
2024-05-01 14:24:19 INFO     evaluating now!
2024-05-01 14:24:19 INFO     Epoch [0/200] train_loss: 24.2631, val_loss: 18.4077, lr: 0.003000, 6.10s
2024-05-01 14:24:19 INFO     Saved model at 0
2024-05-01 14:24:19 INFO     Val loss decrease from inf to 18.4077, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 14:24:24 INFO     epoch complete!
2024-05-01 14:24:24 INFO     evaluating now!
2024-05-01 14:24:25 INFO     Epoch [1/200] train_loss: 15.0518, val_loss: 14.4411, lr: 0.003000, 5.34s
2024-05-01 14:24:25 INFO     Saved model at 1
2024-05-01 14:24:25 INFO     Val loss decrease from 18.4077 to 14.4411, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 14:24:30 INFO     epoch complete!
2024-05-01 14:24:30 INFO     evaluating now!
2024-05-01 14:24:30 INFO     Epoch [2/200] train_loss: 11.8068, val_loss: 11.4250, lr: 0.003000, 5.51s
2024-05-01 14:24:30 INFO     Saved model at 2
2024-05-01 14:24:30 INFO     Val loss decrease from 14.4411 to 11.4250, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 14:24:35 INFO     epoch complete!
2024-05-01 14:24:35 INFO     evaluating now!
2024-05-01 14:24:36 INFO     Epoch [3/200] train_loss: 9.9142, val_loss: 9.5256, lr: 0.003000, 5.49s
2024-05-01 14:24:36 INFO     Saved model at 3
2024-05-01 14:24:36 INFO     Val loss decrease from 11.4250 to 9.5256, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 14:24:41 INFO     epoch complete!
2024-05-01 14:24:41 INFO     evaluating now!
2024-05-01 14:24:41 INFO     Epoch [4/200] train_loss: 8.5396, val_loss: 8.6779, lr: 0.003000, 5.40s
2024-05-01 14:24:41 INFO     Saved model at 4
2024-05-01 14:24:41 INFO     Val loss decrease from 9.5256 to 8.6779, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 14:24:46 INFO     epoch complete!
2024-05-01 14:24:46 INFO     evaluating now!
2024-05-01 14:24:47 INFO     Epoch [5/200] train_loss: 7.7757, val_loss: 7.4292, lr: 0.003000, 5.47s
2024-05-01 14:24:47 INFO     Saved model at 5
2024-05-01 14:24:47 INFO     Val loss decrease from 8.6779 to 7.4292, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 14:24:52 INFO     epoch complete!
2024-05-01 14:24:52 INFO     evaluating now!
2024-05-01 14:24:52 INFO     Epoch [6/200] train_loss: 7.1123, val_loss: 7.0175, lr: 0.003000, 5.46s
2024-05-01 14:24:52 INFO     Saved model at 6
2024-05-01 14:24:52 INFO     Val loss decrease from 7.4292 to 7.0175, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 14:24:57 INFO     epoch complete!
2024-05-01 14:24:57 INFO     evaluating now!
2024-05-01 14:24:58 INFO     Epoch [7/200] train_loss: 6.5657, val_loss: 6.4179, lr: 0.003000, 5.58s
2024-05-01 14:24:58 INFO     Saved model at 7
2024-05-01 14:24:58 INFO     Val loss decrease from 7.0175 to 6.4179, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 14:25:03 INFO     epoch complete!
2024-05-01 14:25:03 INFO     evaluating now!
2024-05-01 14:25:03 INFO     Epoch [8/200] train_loss: 6.2529, val_loss: 6.6438, lr: 0.003000, 5.65s
2024-05-01 14:25:08 INFO     epoch complete!
2024-05-01 14:25:08 INFO     evaluating now!
2024-05-01 14:25:09 INFO     Epoch [9/200] train_loss: 6.0215, val_loss: 6.1526, lr: 0.003000, 5.38s
2024-05-01 14:25:09 INFO     Saved model at 9
2024-05-01 14:25:09 INFO     Val loss decrease from 6.4179 to 6.1526, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-01 14:25:14 INFO     epoch complete!
2024-05-01 14:25:14 INFO     evaluating now!
2024-05-01 14:25:14 INFO     Epoch [10/200] train_loss: 5.8533, val_loss: 6.2660, lr: 0.003000, 5.56s
2024-05-01 14:25:20 INFO     epoch complete!
2024-05-01 14:25:20 INFO     evaluating now!
2024-05-01 14:25:20 INFO     Epoch [11/200] train_loss: 5.6927, val_loss: 5.9696, lr: 0.003000, 5.50s
2024-05-01 14:25:20 INFO     Saved model at 11
2024-05-01 14:25:20 INFO     Val loss decrease from 6.1526 to 5.9696, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-01 14:25:25 INFO     epoch complete!
2024-05-01 14:25:25 INFO     evaluating now!
2024-05-01 14:25:25 INFO     Epoch [12/200] train_loss: 5.5767, val_loss: 5.7753, lr: 0.003000, 5.51s
2024-05-01 14:25:25 INFO     Saved model at 12
2024-05-01 14:25:25 INFO     Val loss decrease from 5.9696 to 5.7753, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-01 14:25:31 INFO     epoch complete!
2024-05-01 14:25:31 INFO     evaluating now!
2024-05-01 14:25:31 INFO     Epoch [13/200] train_loss: 5.4205, val_loss: 5.6214, lr: 0.003000, 5.45s
2024-05-01 14:25:31 INFO     Saved model at 13
2024-05-01 14:25:31 INFO     Val loss decrease from 5.7753 to 5.6214, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-01 14:25:36 INFO     epoch complete!
2024-05-01 14:25:36 INFO     evaluating now!
2024-05-01 14:25:36 INFO     Epoch [14/200] train_loss: 5.3219, val_loss: 5.5977, lr: 0.003000, 5.45s
2024-05-01 14:25:36 INFO     Saved model at 14
2024-05-01 14:25:36 INFO     Val loss decrease from 5.6214 to 5.5977, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-01 14:25:42 INFO     epoch complete!
2024-05-01 14:25:42 INFO     evaluating now!
2024-05-01 14:25:42 INFO     Epoch [15/200] train_loss: 5.2212, val_loss: 5.4513, lr: 0.003000, 5.48s
2024-05-01 14:25:42 INFO     Saved model at 15
2024-05-01 14:25:42 INFO     Val loss decrease from 5.5977 to 5.4513, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-01 14:25:47 INFO     epoch complete!
2024-05-01 14:25:47 INFO     evaluating now!
2024-05-01 14:25:48 INFO     Epoch [16/200] train_loss: 5.1941, val_loss: 5.6455, lr: 0.003000, 5.54s
2024-05-01 14:25:52 INFO     epoch complete!
2024-05-01 14:25:52 INFO     evaluating now!
2024-05-01 14:25:53 INFO     Epoch [17/200] train_loss: 4.9878, val_loss: 5.4041, lr: 0.003000, 5.27s
2024-05-01 14:25:53 INFO     Saved model at 17
2024-05-01 14:25:53 INFO     Val loss decrease from 5.4513 to 5.4041, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-01 14:25:58 INFO     epoch complete!
2024-05-01 14:25:58 INFO     evaluating now!
2024-05-01 14:25:58 INFO     Epoch [18/200] train_loss: 4.9512, val_loss: 5.5005, lr: 0.003000, 5.44s
2024-05-01 14:26:03 INFO     epoch complete!
2024-05-01 14:26:03 INFO     evaluating now!
2024-05-01 14:26:04 INFO     Epoch [19/200] train_loss: 4.9509, val_loss: 5.4905, lr: 0.003000, 5.39s
2024-05-01 14:26:09 INFO     epoch complete!
2024-05-01 14:26:09 INFO     evaluating now!
2024-05-01 14:26:09 INFO     Epoch [20/200] train_loss: 4.8806, val_loss: 5.5313, lr: 0.003000, 5.33s
2024-05-01 14:26:14 INFO     epoch complete!
2024-05-01 14:26:14 INFO     evaluating now!
2024-05-01 14:26:14 INFO     Epoch [21/200] train_loss: 4.7067, val_loss: 5.2977, lr: 0.003000, 5.40s
2024-05-01 14:26:14 INFO     Saved model at 21
2024-05-01 14:26:14 INFO     Val loss decrease from 5.4041 to 5.2977, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-01 14:26:19 INFO     epoch complete!
2024-05-01 14:26:19 INFO     evaluating now!
2024-05-01 14:26:20 INFO     Epoch [22/200] train_loss: 4.6541, val_loss: 5.3472, lr: 0.003000, 5.32s
2024-05-01 14:26:25 INFO     epoch complete!
2024-05-01 14:26:25 INFO     evaluating now!
2024-05-01 14:26:25 INFO     Epoch [23/200] train_loss: 4.7113, val_loss: 5.2819, lr: 0.003000, 5.27s
2024-05-01 14:26:25 INFO     Saved model at 23
2024-05-01 14:26:25 INFO     Val loss decrease from 5.2977 to 5.2819, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-05-01 14:26:30 INFO     epoch complete!
2024-05-01 14:26:30 INFO     evaluating now!
2024-05-01 14:26:30 INFO     Epoch [24/200] train_loss: 4.6085, val_loss: 5.3216, lr: 0.003000, 5.36s
2024-05-01 14:26:36 INFO     epoch complete!
2024-05-01 14:26:36 INFO     evaluating now!
2024-05-01 14:26:36 INFO     Epoch [25/200] train_loss: 4.5343, val_loss: 5.2422, lr: 0.003000, 5.56s
2024-05-01 14:26:36 INFO     Saved model at 25
2024-05-01 14:26:36 INFO     Val loss decrease from 5.2819 to 5.2422, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-01 14:26:42 INFO     epoch complete!
2024-05-01 14:26:42 INFO     evaluating now!
2024-05-01 14:26:42 INFO     Epoch [26/200] train_loss: 4.4452, val_loss: 5.2403, lr: 0.003000, 5.95s
2024-05-01 14:26:42 INFO     Saved model at 26
2024-05-01 14:26:42 INFO     Val loss decrease from 5.2422 to 5.2403, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-05-01 14:26:47 INFO     epoch complete!
2024-05-01 14:26:47 INFO     evaluating now!
2024-05-01 14:26:48 INFO     Epoch [27/200] train_loss: 4.4273, val_loss: 5.2428, lr: 0.003000, 5.93s
2024-05-01 14:26:54 INFO     epoch complete!
2024-05-01 14:26:54 INFO     evaluating now!
2024-05-01 14:26:54 INFO     Epoch [28/200] train_loss: 4.4253, val_loss: 5.2304, lr: 0.003000, 6.13s
2024-05-01 14:26:54 INFO     Saved model at 28
2024-05-01 14:26:54 INFO     Val loss decrease from 5.2403 to 5.2304, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-05-01 14:27:00 INFO     epoch complete!
2024-05-01 14:27:00 INFO     evaluating now!
2024-05-01 14:27:00 INFO     Epoch [29/200] train_loss: 4.3358, val_loss: 5.5252, lr: 0.003000, 5.99s
2024-05-01 14:27:06 INFO     epoch complete!
2024-05-01 14:27:06 INFO     evaluating now!
2024-05-01 14:27:06 INFO     Epoch [30/200] train_loss: 4.3509, val_loss: 5.1926, lr: 0.003000, 5.94s
2024-05-01 14:27:06 INFO     Saved model at 30
2024-05-01 14:27:06 INFO     Val loss decrease from 5.2304 to 5.1926, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-05-01 14:27:12 INFO     epoch complete!
2024-05-01 14:27:12 INFO     evaluating now!
2024-05-01 14:27:12 INFO     Epoch [31/200] train_loss: 4.2855, val_loss: 5.0867, lr: 0.003000, 6.14s
2024-05-01 14:27:12 INFO     Saved model at 31
2024-05-01 14:27:12 INFO     Val loss decrease from 5.1926 to 5.0867, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-05-01 14:27:18 INFO     epoch complete!
2024-05-01 14:27:18 INFO     evaluating now!
2024-05-01 14:27:18 INFO     Epoch [32/200] train_loss: 4.2650, val_loss: 5.2326, lr: 0.003000, 6.02s
2024-05-01 14:27:24 INFO     epoch complete!
2024-05-01 14:27:24 INFO     evaluating now!
2024-05-01 14:27:24 INFO     Epoch [33/200] train_loss: 4.2006, val_loss: 5.2288, lr: 0.003000, 6.00s
2024-05-01 14:27:30 INFO     epoch complete!
2024-05-01 14:27:30 INFO     evaluating now!
2024-05-01 14:27:30 INFO     Epoch [34/200] train_loss: 4.1678, val_loss: 5.2323, lr: 0.003000, 5.92s
2024-05-01 14:27:36 INFO     epoch complete!
2024-05-01 14:27:36 INFO     evaluating now!
2024-05-01 14:27:36 INFO     Epoch [35/200] train_loss: 4.1367, val_loss: 5.1658, lr: 0.003000, 6.19s
2024-05-01 14:27:42 INFO     epoch complete!
2024-05-01 14:27:42 INFO     evaluating now!
2024-05-01 14:27:43 INFO     Epoch [36/200] train_loss: 4.1340, val_loss: 5.1867, lr: 0.003000, 6.21s
2024-05-01 14:27:48 INFO     epoch complete!
2024-05-01 14:27:48 INFO     evaluating now!
2024-05-01 14:27:49 INFO     Epoch [37/200] train_loss: 4.1088, val_loss: 5.1526, lr: 0.003000, 5.95s
2024-05-01 14:27:54 INFO     epoch complete!
2024-05-01 14:27:54 INFO     evaluating now!
2024-05-01 14:27:55 INFO     Epoch [38/200] train_loss: 4.0590, val_loss: 5.1369, lr: 0.003000, 6.00s
2024-05-01 14:28:00 INFO     epoch complete!
2024-05-01 14:28:00 INFO     evaluating now!
2024-05-01 14:28:00 INFO     Epoch [39/200] train_loss: 3.9961, val_loss: 5.4524, lr: 0.003000, 5.91s
2024-05-01 14:28:06 INFO     epoch complete!
2024-05-01 14:28:06 INFO     evaluating now!
2024-05-01 14:28:06 INFO     Epoch [40/200] train_loss: 4.0159, val_loss: 5.1533, lr: 0.003000, 6.01s
2024-05-01 14:28:12 INFO     epoch complete!
2024-05-01 14:28:12 INFO     evaluating now!
2024-05-01 14:28:12 INFO     Epoch [41/200] train_loss: 3.9810, val_loss: 5.0672, lr: 0.003000, 5.78s
2024-05-01 14:28:12 INFO     Saved model at 41
2024-05-01 14:28:12 INFO     Val loss decrease from 5.0867 to 5.0672, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-05-01 14:28:18 INFO     epoch complete!
2024-05-01 14:28:18 INFO     evaluating now!
2024-05-01 14:28:18 INFO     Epoch [42/200] train_loss: 4.0045, val_loss: 5.2679, lr: 0.003000, 6.08s
2024-05-01 14:28:24 INFO     epoch complete!
2024-05-01 14:28:24 INFO     evaluating now!
2024-05-01 14:28:24 INFO     Epoch [43/200] train_loss: 3.9136, val_loss: 5.1076, lr: 0.003000, 6.01s
2024-05-01 14:28:30 INFO     epoch complete!
2024-05-01 14:28:30 INFO     evaluating now!
2024-05-01 14:28:30 INFO     Epoch [44/200] train_loss: 3.8682, val_loss: 5.1907, lr: 0.003000, 5.83s
2024-05-01 14:28:36 INFO     epoch complete!
2024-05-01 14:28:36 INFO     evaluating now!
2024-05-01 14:28:36 INFO     Epoch [45/200] train_loss: 3.9504, val_loss: 5.0576, lr: 0.003000, 6.01s
2024-05-01 14:28:36 INFO     Saved model at 45
2024-05-01 14:28:36 INFO     Val loss decrease from 5.0672 to 5.0576, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-05-01 14:28:42 INFO     epoch complete!
2024-05-01 14:28:42 INFO     evaluating now!
2024-05-01 14:28:42 INFO     Epoch [46/200] train_loss: 3.9201, val_loss: 5.0222, lr: 0.003000, 6.18s
2024-05-01 14:28:42 INFO     Saved model at 46
2024-05-01 14:28:42 INFO     Val loss decrease from 5.0576 to 5.0222, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-05-01 14:28:48 INFO     epoch complete!
2024-05-01 14:28:48 INFO     evaluating now!
2024-05-01 14:28:49 INFO     Epoch [47/200] train_loss: 3.7911, val_loss: 5.1570, lr: 0.003000, 6.31s
2024-05-01 14:28:54 INFO     epoch complete!
2024-05-01 14:28:54 INFO     evaluating now!
2024-05-01 14:28:55 INFO     Epoch [48/200] train_loss: 3.7763, val_loss: 5.1046, lr: 0.003000, 6.15s
2024-05-01 14:29:00 INFO     epoch complete!
2024-05-01 14:29:00 INFO     evaluating now!
2024-05-01 14:29:01 INFO     Epoch [49/200] train_loss: 3.7858, val_loss: 5.1678, lr: 0.003000, 6.01s
2024-05-01 14:29:07 INFO     epoch complete!
2024-05-01 14:29:07 INFO     evaluating now!
2024-05-01 14:29:07 INFO     Epoch [50/200] train_loss: 3.7962, val_loss: 5.0330, lr: 0.003000, 6.13s
2024-05-01 14:29:13 INFO     epoch complete!
2024-05-01 14:29:13 INFO     evaluating now!
2024-05-01 14:29:13 INFO     Epoch [51/200] train_loss: 3.7839, val_loss: 5.2873, lr: 0.003000, 6.15s
2024-05-01 14:29:19 INFO     epoch complete!
2024-05-01 14:29:19 INFO     evaluating now!
2024-05-01 14:29:19 INFO     Epoch [52/200] train_loss: 3.7297, val_loss: 5.1249, lr: 0.003000, 6.02s
2024-05-01 14:29:25 INFO     epoch complete!
2024-05-01 14:29:25 INFO     evaluating now!
2024-05-01 14:29:25 INFO     Epoch [53/200] train_loss: 3.7305, val_loss: 5.2285, lr: 0.003000, 5.96s
2024-05-01 14:29:31 INFO     epoch complete!
2024-05-01 14:29:31 INFO     evaluating now!
2024-05-01 14:29:31 INFO     Epoch [54/200] train_loss: 3.7468, val_loss: 5.1226, lr: 0.003000, 5.87s
2024-05-01 14:29:36 INFO     epoch complete!
2024-05-01 14:29:36 INFO     evaluating now!
2024-05-01 14:29:37 INFO     Epoch [55/200] train_loss: 3.6425, val_loss: 5.1044, lr: 0.003000, 5.76s
2024-05-01 14:29:42 INFO     epoch complete!
2024-05-01 14:29:42 INFO     evaluating now!
2024-05-01 14:29:42 INFO     Epoch [56/200] train_loss: 3.5920, val_loss: 5.1306, lr: 0.003000, 5.39s
2024-05-01 14:29:47 INFO     epoch complete!
2024-05-01 14:29:47 INFO     evaluating now!
2024-05-01 14:29:48 INFO     Epoch [57/200] train_loss: 3.6763, val_loss: 5.0796, lr: 0.003000, 5.50s
2024-05-01 14:29:53 INFO     epoch complete!
2024-05-01 14:29:53 INFO     evaluating now!
2024-05-01 14:29:53 INFO     Epoch [58/200] train_loss: 3.6434, val_loss: 5.1833, lr: 0.003000, 5.46s
2024-05-01 14:29:59 INFO     epoch complete!
2024-05-01 14:29:59 INFO     evaluating now!
2024-05-01 14:29:59 INFO     Epoch [59/200] train_loss: 3.6257, val_loss: 5.1810, lr: 0.003000, 5.73s
2024-05-01 14:30:04 INFO     epoch complete!
2024-05-01 14:30:04 INFO     evaluating now!
2024-05-01 14:30:05 INFO     Epoch [60/200] train_loss: 3.6458, val_loss: 5.1554, lr: 0.003000, 5.60s
2024-05-01 14:30:10 INFO     epoch complete!
2024-05-01 14:30:10 INFO     evaluating now!
2024-05-01 14:30:11 INFO     Epoch [61/200] train_loss: 3.5411, val_loss: 5.0706, lr: 0.003000, 6.23s
2024-05-01 14:30:11 WARNING  Early stopping at epoch: 61
2024-05-01 14:30:11 INFO     Trained totally 62 epochs, average train time is 5.347s, average eval time is 0.404s
2024-05-01 14:30:11 INFO     Loaded model at 46
2024-05-01 14:30:11 INFO     Saved model at ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 14:30:11 INFO     Start evaluating ...
2024-05-01 14:30:12 INFO     Note that you select the single mode to evaluate!
2024-05-01 14:30:12 INFO     Evaluate result is saved at ./libcity/cache/15/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 14:30:12 INFO     
         MAE       RMSE
1   2.236579   7.052943
2   2.344422   7.705318
3   2.544315   8.750842
4   2.723926   9.653599
5   2.872810  10.792345
6   3.035943  11.896168
7   3.207389  12.703240
8   3.227632  13.308959
9   3.245679  13.577817
10  3.352257  13.732620
11  3.451432  13.983768
12  3.535582  14.517715
2024-05-01 14:30:12 INFO     ----------------------------------------------------------------------------
2024-05-01 14:30:12 INFO     # 1, Kownledge Graph Embedding: GIE, Experiment ids: 16
2024-05-01 14:30:12 INFO     ----------------------------------------------------------------------------
2024-05-01 14:30:13 INFO     Log directory: ./libcity/log
2024-05-01 14:30:13 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=16
2024-05-01 14:30:13 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 666171896, 'exp_id': 16, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'minmax11', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 14:30:13 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 14:30:13 INFO     set_weight_link_or_dist: dist
2024-05-01 14:30:13 INFO     init_weight_inf_or_zero: inf
2024-05-01 14:30:13 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 14:30:13 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 14:30:13 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 14:30:13 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 14:30:16 INFO     Dataset created
2024-05-01 14:30:16 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 14:30:16 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 14:30:16 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 14:30:16 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 14:30:16 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 14:30:16 INFO     MinMax11Scaler max: 0.3243229993054587, min: -0.6629940242690735
2024-05-01 14:30:21 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 14:30:21 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 14:30:21 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 14:30:21 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 14:30:21 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 14:30:21 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 14:30:21 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 14:30:21 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 14:30:21 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 14:30:21 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 14:30:21 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 14:30:21 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 14:30:21 INFO     Total parameter numbers: 874010
2024-05-01 14:30:21 INFO     You select `adam` optimizer.
2024-05-01 14:30:21 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 14:30:21 INFO     Start training ...
2024-05-01 14:30:21 INFO     num_batches:48
2024-05-01 14:30:27 INFO     epoch complete!
2024-05-01 14:30:27 INFO     evaluating now!
2024-05-01 14:30:27 INFO     Epoch [0/200] train_loss: 24.4214, val_loss: 18.7474, lr: 0.003000, 6.05s
2024-05-01 14:30:27 INFO     Saved model at 0
2024-05-01 14:30:27 INFO     Val loss decrease from inf to 18.7474, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 14:30:33 INFO     epoch complete!
2024-05-01 14:30:33 INFO     evaluating now!
2024-05-01 14:30:34 INFO     Epoch [1/200] train_loss: 15.5756, val_loss: 14.9747, lr: 0.003000, 6.11s
2024-05-01 14:30:34 INFO     Saved model at 1
2024-05-01 14:30:34 INFO     Val loss decrease from 18.7474 to 14.9747, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 14:30:39 INFO     epoch complete!
2024-05-01 14:30:39 INFO     evaluating now!
2024-05-01 14:30:40 INFO     Epoch [2/200] train_loss: 12.3261, val_loss: 11.8595, lr: 0.003000, 6.21s
2024-05-01 14:30:40 INFO     Saved model at 2
2024-05-01 14:30:40 INFO     Val loss decrease from 14.9747 to 11.8595, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 14:30:46 INFO     epoch complete!
2024-05-01 14:30:46 INFO     evaluating now!
2024-05-01 14:30:46 INFO     Epoch [3/200] train_loss: 10.2298, val_loss: 10.0070, lr: 0.003000, 6.20s
2024-05-01 14:30:46 INFO     Saved model at 3
2024-05-01 14:30:46 INFO     Val loss decrease from 11.8595 to 10.0070, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 14:30:52 INFO     epoch complete!
2024-05-01 14:30:52 INFO     evaluating now!
2024-05-01 14:30:52 INFO     Epoch [4/200] train_loss: 8.6405, val_loss: 8.1846, lr: 0.003000, 6.14s
2024-05-01 14:30:52 INFO     Saved model at 4
2024-05-01 14:30:52 INFO     Val loss decrease from 10.0070 to 8.1846, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 14:30:58 INFO     epoch complete!
2024-05-01 14:30:58 INFO     evaluating now!
2024-05-01 14:30:58 INFO     Epoch [5/200] train_loss: 7.7093, val_loss: 7.3788, lr: 0.003000, 6.16s
2024-05-01 14:30:58 INFO     Saved model at 5
2024-05-01 14:30:58 INFO     Val loss decrease from 8.1846 to 7.3788, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 14:31:04 INFO     epoch complete!
2024-05-01 14:31:04 INFO     evaluating now!
2024-05-01 14:31:05 INFO     Epoch [6/200] train_loss: 7.1753, val_loss: 7.1681, lr: 0.003000, 6.03s
2024-05-01 14:31:05 INFO     Saved model at 6
2024-05-01 14:31:05 INFO     Val loss decrease from 7.3788 to 7.1681, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 14:31:10 INFO     epoch complete!
2024-05-01 14:31:10 INFO     evaluating now!
2024-05-01 14:31:11 INFO     Epoch [7/200] train_loss: 6.6331, val_loss: 6.5923, lr: 0.003000, 6.12s
2024-05-01 14:31:11 INFO     Saved model at 7
2024-05-01 14:31:11 INFO     Val loss decrease from 7.1681 to 6.5923, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 14:31:16 INFO     epoch complete!
2024-05-01 14:31:16 INFO     evaluating now!
2024-05-01 14:31:17 INFO     Epoch [8/200] train_loss: 6.4957, val_loss: 6.3542, lr: 0.003000, 6.16s
2024-05-01 14:31:17 INFO     Saved model at 8
2024-05-01 14:31:17 INFO     Val loss decrease from 6.5923 to 6.3542, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-01 14:31:23 INFO     epoch complete!
2024-05-01 14:31:23 INFO     evaluating now!
2024-05-01 14:31:23 INFO     Epoch [9/200] train_loss: 6.1749, val_loss: 6.1375, lr: 0.003000, 6.07s
2024-05-01 14:31:23 INFO     Saved model at 9
2024-05-01 14:31:23 INFO     Val loss decrease from 6.3542 to 6.1375, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-01 14:31:29 INFO     epoch complete!
2024-05-01 14:31:29 INFO     evaluating now!
2024-05-01 14:31:29 INFO     Epoch [10/200] train_loss: 5.9583, val_loss: 6.2376, lr: 0.003000, 6.14s
2024-05-01 14:31:35 INFO     epoch complete!
2024-05-01 14:31:35 INFO     evaluating now!
2024-05-01 14:31:35 INFO     Epoch [11/200] train_loss: 5.9205, val_loss: 6.5644, lr: 0.003000, 6.18s
2024-05-01 14:31:41 INFO     epoch complete!
2024-05-01 14:31:41 INFO     evaluating now!
2024-05-01 14:31:42 INFO     Epoch [12/200] train_loss: 5.8028, val_loss: 5.8725, lr: 0.003000, 6.21s
2024-05-01 14:31:42 INFO     Saved model at 12
2024-05-01 14:31:42 INFO     Val loss decrease from 6.1375 to 5.8725, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-01 14:31:47 INFO     epoch complete!
2024-05-01 14:31:47 INFO     evaluating now!
2024-05-01 14:31:48 INFO     Epoch [13/200] train_loss: 5.5671, val_loss: 5.8023, lr: 0.003000, 6.04s
2024-05-01 14:31:48 INFO     Saved model at 13
2024-05-01 14:31:48 INFO     Val loss decrease from 5.8725 to 5.8023, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-01 14:31:53 INFO     epoch complete!
2024-05-01 14:31:53 INFO     evaluating now!
2024-05-01 14:31:54 INFO     Epoch [14/200] train_loss: 5.4564, val_loss: 5.7325, lr: 0.003000, 6.08s
2024-05-01 14:31:54 INFO     Saved model at 14
2024-05-01 14:31:54 INFO     Val loss decrease from 5.8023 to 5.7325, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-01 14:31:59 INFO     epoch complete!
2024-05-01 14:31:59 INFO     evaluating now!
2024-05-01 14:32:00 INFO     Epoch [15/200] train_loss: 5.3800, val_loss: 5.6275, lr: 0.003000, 6.11s
2024-05-01 14:32:00 INFO     Saved model at 15
2024-05-01 14:32:00 INFO     Val loss decrease from 5.7325 to 5.6275, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-01 14:32:06 INFO     epoch complete!
2024-05-01 14:32:06 INFO     evaluating now!
2024-05-01 14:32:06 INFO     Epoch [16/200] train_loss: 5.2186, val_loss: 5.8696, lr: 0.003000, 6.15s
2024-05-01 14:32:12 INFO     epoch complete!
2024-05-01 14:32:12 INFO     evaluating now!
2024-05-01 14:32:12 INFO     Epoch [17/200] train_loss: 5.2534, val_loss: 5.4652, lr: 0.003000, 6.08s
2024-05-01 14:32:12 INFO     Saved model at 17
2024-05-01 14:32:12 INFO     Val loss decrease from 5.6275 to 5.4652, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-01 14:32:18 INFO     epoch complete!
2024-05-01 14:32:18 INFO     evaluating now!
2024-05-01 14:32:18 INFO     Epoch [18/200] train_loss: 5.1862, val_loss: 5.6735, lr: 0.003000, 6.05s
2024-05-01 14:32:24 INFO     epoch complete!
2024-05-01 14:32:24 INFO     evaluating now!
2024-05-01 14:32:24 INFO     Epoch [19/200] train_loss: 5.1153, val_loss: 5.5212, lr: 0.003000, 5.93s
2024-05-01 14:32:30 INFO     epoch complete!
2024-05-01 14:32:30 INFO     evaluating now!
2024-05-01 14:32:30 INFO     Epoch [20/200] train_loss: 4.9834, val_loss: 5.4424, lr: 0.003000, 6.06s
2024-05-01 14:32:30 INFO     Saved model at 20
2024-05-01 14:32:30 INFO     Val loss decrease from 5.4652 to 5.4424, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-01 14:32:36 INFO     epoch complete!
2024-05-01 14:32:36 INFO     evaluating now!
2024-05-01 14:32:37 INFO     Epoch [21/200] train_loss: 4.8833, val_loss: 5.4320, lr: 0.003000, 6.18s
2024-05-01 14:32:37 INFO     Saved model at 21
2024-05-01 14:32:37 INFO     Val loss decrease from 5.4424 to 5.4320, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-01 14:32:42 INFO     epoch complete!
2024-05-01 14:32:42 INFO     evaluating now!
2024-05-01 14:32:43 INFO     Epoch [22/200] train_loss: 4.8888, val_loss: 5.3868, lr: 0.003000, 6.08s
2024-05-01 14:32:43 INFO     Saved model at 22
2024-05-01 14:32:43 INFO     Val loss decrease from 5.4320 to 5.3868, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-01 14:32:48 INFO     epoch complete!
2024-05-01 14:32:48 INFO     evaluating now!
2024-05-01 14:32:49 INFO     Epoch [23/200] train_loss: 4.8658, val_loss: 5.5008, lr: 0.003000, 6.04s
2024-05-01 14:32:54 INFO     epoch complete!
2024-05-01 14:32:54 INFO     evaluating now!
2024-05-01 14:32:55 INFO     Epoch [24/200] train_loss: 4.8612, val_loss: 5.3042, lr: 0.003000, 6.07s
2024-05-01 14:32:55 INFO     Saved model at 24
2024-05-01 14:32:55 INFO     Val loss decrease from 5.3868 to 5.3042, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-01 14:33:01 INFO     epoch complete!
2024-05-01 14:33:01 INFO     evaluating now!
2024-05-01 14:33:01 INFO     Epoch [25/200] train_loss: 4.6812, val_loss: 5.3024, lr: 0.003000, 6.03s
2024-05-01 14:33:01 INFO     Saved model at 25
2024-05-01 14:33:01 INFO     Val loss decrease from 5.3042 to 5.3024, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-01 14:33:07 INFO     epoch complete!
2024-05-01 14:33:07 INFO     evaluating now!
2024-05-01 14:33:07 INFO     Epoch [26/200] train_loss: 4.7468, val_loss: 5.3099, lr: 0.003000, 6.04s
2024-05-01 14:33:13 INFO     epoch complete!
2024-05-01 14:33:13 INFO     evaluating now!
2024-05-01 14:33:13 INFO     Epoch [27/200] train_loss: 4.6246, val_loss: 5.2734, lr: 0.003000, 6.23s
2024-05-01 14:33:13 INFO     Saved model at 27
2024-05-01 14:33:13 INFO     Val loss decrease from 5.3024 to 5.2734, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-05-01 14:33:19 INFO     epoch complete!
2024-05-01 14:33:19 INFO     evaluating now!
2024-05-01 14:33:20 INFO     Epoch [28/200] train_loss: 4.5398, val_loss: 5.3437, lr: 0.003000, 6.21s
2024-05-01 14:33:25 INFO     epoch complete!
2024-05-01 14:33:25 INFO     evaluating now!
2024-05-01 14:33:26 INFO     Epoch [29/200] train_loss: 4.5792, val_loss: 5.2224, lr: 0.003000, 6.28s
2024-05-01 14:33:26 INFO     Saved model at 29
2024-05-01 14:33:26 INFO     Val loss decrease from 5.2734 to 5.2224, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-05-01 14:33:32 INFO     epoch complete!
2024-05-01 14:33:32 INFO     evaluating now!
2024-05-01 14:33:32 INFO     Epoch [30/200] train_loss: 4.5067, val_loss: 5.2855, lr: 0.003000, 6.17s
2024-05-01 14:33:38 INFO     epoch complete!
2024-05-01 14:33:38 INFO     evaluating now!
2024-05-01 14:33:38 INFO     Epoch [31/200] train_loss: 4.4961, val_loss: 5.2711, lr: 0.003000, 6.19s
2024-05-01 14:33:44 INFO     epoch complete!
2024-05-01 14:33:44 INFO     evaluating now!
2024-05-01 14:33:44 INFO     Epoch [32/200] train_loss: 4.4508, val_loss: 5.1464, lr: 0.003000, 6.22s
2024-05-01 14:33:45 INFO     Saved model at 32
2024-05-01 14:33:45 INFO     Val loss decrease from 5.2224 to 5.1464, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-05-01 14:33:50 INFO     epoch complete!
2024-05-01 14:33:50 INFO     evaluating now!
2024-05-01 14:33:51 INFO     Epoch [33/200] train_loss: 4.4096, val_loss: 5.2418, lr: 0.003000, 6.18s
2024-05-01 14:33:57 INFO     epoch complete!
2024-05-01 14:33:57 INFO     evaluating now!
2024-05-01 14:33:57 INFO     Epoch [34/200] train_loss: 4.3022, val_loss: 5.3479, lr: 0.003000, 6.30s
2024-05-01 14:34:03 INFO     epoch complete!
2024-05-01 14:34:03 INFO     evaluating now!
2024-05-01 14:34:03 INFO     Epoch [35/200] train_loss: 4.2835, val_loss: 5.1132, lr: 0.003000, 6.17s
2024-05-01 14:34:03 INFO     Saved model at 35
2024-05-01 14:34:03 INFO     Val loss decrease from 5.1464 to 5.1132, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-05-01 14:34:09 INFO     epoch complete!
2024-05-01 14:34:09 INFO     evaluating now!
2024-05-01 14:34:09 INFO     Epoch [36/200] train_loss: 4.3105, val_loss: 5.1113, lr: 0.003000, 5.88s
2024-05-01 14:34:09 INFO     Saved model at 36
2024-05-01 14:34:09 INFO     Val loss decrease from 5.1132 to 5.1113, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-05-01 14:34:15 INFO     epoch complete!
2024-05-01 14:34:15 INFO     evaluating now!
2024-05-01 14:34:15 INFO     Epoch [37/200] train_loss: 4.2852, val_loss: 5.4110, lr: 0.003000, 5.75s
2024-05-01 14:34:20 INFO     epoch complete!
2024-05-01 14:34:20 INFO     evaluating now!
2024-05-01 14:34:21 INFO     Epoch [38/200] train_loss: 4.2541, val_loss: 5.2208, lr: 0.003000, 5.73s
2024-05-01 14:34:26 INFO     epoch complete!
2024-05-01 14:34:26 INFO     evaluating now!
2024-05-01 14:34:27 INFO     Epoch [39/200] train_loss: 4.1333, val_loss: 5.1066, lr: 0.003000, 6.11s
2024-05-01 14:34:27 INFO     Saved model at 39
2024-05-01 14:34:27 INFO     Val loss decrease from 5.1113 to 5.1066, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-05-01 14:34:33 INFO     epoch complete!
2024-05-01 14:34:33 INFO     evaluating now!
2024-05-01 14:34:33 INFO     Epoch [40/200] train_loss: 4.1447, val_loss: 5.2438, lr: 0.003000, 6.33s
2024-05-01 14:34:39 INFO     epoch complete!
2024-05-01 14:34:39 INFO     evaluating now!
2024-05-01 14:34:39 INFO     Epoch [41/200] train_loss: 4.1152, val_loss: 5.3130, lr: 0.003000, 6.27s
2024-05-01 14:34:45 INFO     epoch complete!
2024-05-01 14:34:45 INFO     evaluating now!
2024-05-01 14:34:45 INFO     Epoch [42/200] train_loss: 4.0916, val_loss: 5.2609, lr: 0.003000, 6.05s
2024-05-01 14:34:51 INFO     epoch complete!
2024-05-01 14:34:51 INFO     evaluating now!
2024-05-01 14:34:52 INFO     Epoch [43/200] train_loss: 4.0725, val_loss: 5.1209, lr: 0.003000, 6.36s
2024-05-01 14:34:58 INFO     epoch complete!
2024-05-01 14:34:58 INFO     evaluating now!
2024-05-01 14:34:58 INFO     Epoch [44/200] train_loss: 4.0263, val_loss: 5.1275, lr: 0.003000, 6.37s
2024-05-01 14:35:04 INFO     epoch complete!
2024-05-01 14:35:04 INFO     evaluating now!
2024-05-01 14:35:05 INFO     Epoch [45/200] train_loss: 3.9627, val_loss: 5.1486, lr: 0.003000, 6.33s
2024-05-01 14:35:10 INFO     epoch complete!
2024-05-01 14:35:10 INFO     evaluating now!
2024-05-01 14:35:10 INFO     Epoch [46/200] train_loss: 3.9274, val_loss: 5.1980, lr: 0.003000, 5.80s
2024-05-01 14:35:16 INFO     epoch complete!
2024-05-01 14:35:16 INFO     evaluating now!
2024-05-01 14:35:16 INFO     Epoch [47/200] train_loss: 3.9370, val_loss: 5.1800, lr: 0.003000, 5.80s
2024-05-01 14:35:21 INFO     epoch complete!
2024-05-01 14:35:21 INFO     evaluating now!
2024-05-01 14:35:22 INFO     Epoch [48/200] train_loss: 3.9017, val_loss: 5.0445, lr: 0.003000, 5.69s
2024-05-01 14:35:22 INFO     Saved model at 48
2024-05-01 14:35:22 INFO     Val loss decrease from 5.1066 to 5.0445, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-05-01 14:35:27 INFO     epoch complete!
2024-05-01 14:35:27 INFO     evaluating now!
2024-05-01 14:35:28 INFO     Epoch [49/200] train_loss: 3.8748, val_loss: 5.0465, lr: 0.003000, 5.71s
2024-05-01 14:35:33 INFO     epoch complete!
2024-05-01 14:35:33 INFO     evaluating now!
2024-05-01 14:35:33 INFO     Epoch [50/200] train_loss: 3.8647, val_loss: 5.1706, lr: 0.003000, 5.72s
2024-05-01 14:35:39 INFO     epoch complete!
2024-05-01 14:35:39 INFO     evaluating now!
2024-05-01 14:35:39 INFO     Epoch [51/200] train_loss: 3.8672, val_loss: 5.2071, lr: 0.003000, 5.71s
2024-05-01 14:35:44 INFO     epoch complete!
2024-05-01 14:35:44 INFO     evaluating now!
2024-05-01 14:35:45 INFO     Epoch [52/200] train_loss: 3.8912, val_loss: 5.3180, lr: 0.003000, 5.72s
2024-05-01 14:35:50 INFO     epoch complete!
2024-05-01 14:35:50 INFO     evaluating now!
2024-05-01 14:35:50 INFO     Epoch [53/200] train_loss: 3.8517, val_loss: 5.0706, lr: 0.003000, 5.66s
2024-05-01 14:35:56 INFO     epoch complete!
2024-05-01 14:35:56 INFO     evaluating now!
2024-05-01 14:35:56 INFO     Epoch [54/200] train_loss: 3.8113, val_loss: 5.2860, lr: 0.003000, 5.57s
2024-05-01 14:36:01 INFO     epoch complete!
2024-05-01 14:36:01 INFO     evaluating now!
2024-05-01 14:36:02 INFO     Epoch [55/200] train_loss: 3.7420, val_loss: 5.1422, lr: 0.003000, 5.62s
2024-05-01 14:36:07 INFO     epoch complete!
2024-05-01 14:36:07 INFO     evaluating now!
2024-05-01 14:36:07 INFO     Epoch [56/200] train_loss: 3.7243, val_loss: 5.1736, lr: 0.003000, 5.61s
2024-05-01 14:36:12 INFO     epoch complete!
2024-05-01 14:36:12 INFO     evaluating now!
2024-05-01 14:36:13 INFO     Epoch [57/200] train_loss: 3.6755, val_loss: 5.1544, lr: 0.003000, 5.58s
2024-05-01 14:36:18 INFO     epoch complete!
2024-05-01 14:36:18 INFO     evaluating now!
2024-05-01 14:36:18 INFO     Epoch [58/200] train_loss: 3.7826, val_loss: 5.1165, lr: 0.003000, 5.56s
2024-05-01 14:36:24 INFO     epoch complete!
2024-05-01 14:36:24 INFO     evaluating now!
2024-05-01 14:36:24 INFO     Epoch [59/200] train_loss: 3.6931, val_loss: 5.1093, lr: 0.003000, 5.56s
2024-05-01 14:36:29 INFO     epoch complete!
2024-05-01 14:36:29 INFO     evaluating now!
2024-05-01 14:36:30 INFO     Epoch [60/200] train_loss: 3.6824, val_loss: 5.1629, lr: 0.003000, 5.66s
2024-05-01 14:36:35 INFO     epoch complete!
2024-05-01 14:36:35 INFO     evaluating now!
2024-05-01 14:36:35 INFO     Epoch [61/200] train_loss: 3.6398, val_loss: 5.0925, lr: 0.003000, 5.61s
2024-05-01 14:36:40 INFO     epoch complete!
2024-05-01 14:36:40 INFO     evaluating now!
2024-05-01 14:36:41 INFO     Epoch [62/200] train_loss: 3.6077, val_loss: 5.1498, lr: 0.003000, 5.61s
2024-05-01 14:36:46 INFO     epoch complete!
2024-05-01 14:36:46 INFO     evaluating now!
2024-05-01 14:36:47 INFO     Epoch [63/200] train_loss: 3.6335, val_loss: 5.1203, lr: 0.003000, 5.75s
2024-05-01 14:36:47 WARNING  Early stopping at epoch: 63
2024-05-01 14:36:47 INFO     Trained totally 64 epochs, average train time is 5.586s, average eval time is 0.408s
2024-05-01 14:36:47 INFO     Loaded model at 48
2024-05-01 14:36:47 INFO     Saved model at ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 14:36:47 INFO     Start evaluating ...
2024-05-01 14:36:48 INFO     Note that you select the single mode to evaluate!
2024-05-01 14:36:48 INFO     Evaluate result is saved at ./libcity/cache/16/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 14:36:48 INFO     
         MAE       RMSE
1   2.319838   6.926822
2   2.559992   7.618341
3   2.738702   8.790538
4   2.933887   9.740132
5   3.143676  10.745172
6   3.254700  11.632576
7   3.303953  12.287712
8   3.301401  12.607757
9   3.264090  12.938414
10  3.284265  13.174573
11  3.495075  13.833151
12  3.517332  14.650948
2024-05-01 14:36:48 INFO     ----------------------------------------------------------------------------
2024-05-01 14:36:48 INFO     # 2, Kownledge Graph Embedding: GIE, Experiment ids: 17
2024-05-01 14:36:48 INFO     ----------------------------------------------------------------------------
2024-05-01 14:36:48 INFO     Log directory: ./libcity/log
2024-05-01 14:36:48 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=17
2024-05-01 14:36:48 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 703718618, 'exp_id': 17, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'minmax11', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 14:36:48 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 14:36:48 INFO     set_weight_link_or_dist: dist
2024-05-01 14:36:48 INFO     init_weight_inf_or_zero: inf
2024-05-01 14:36:48 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 14:36:48 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 14:36:48 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 14:36:48 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 14:36:51 INFO     Dataset created
2024-05-01 14:36:51 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 14:36:51 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 14:36:51 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 14:36:51 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 14:36:51 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 14:36:52 INFO     MinMax11Scaler max: 0.3243229993054587, min: -0.6629940242690735
2024-05-01 14:36:55 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 14:36:55 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 14:36:55 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 14:36:55 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 14:36:55 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 14:36:55 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 14:36:55 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 14:36:55 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 14:36:55 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 14:36:55 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 14:36:55 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 14:36:55 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 14:36:55 INFO     Total parameter numbers: 874010
2024-05-01 14:36:55 INFO     You select `adam` optimizer.
2024-05-01 14:36:55 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 14:36:55 INFO     Start training ...
2024-05-01 14:36:55 INFO     num_batches:48
2024-05-01 14:37:01 INFO     epoch complete!
2024-05-01 14:37:01 INFO     evaluating now!
2024-05-01 14:37:01 INFO     Epoch [0/200] train_loss: 23.4480, val_loss: 18.2367, lr: 0.003000, 5.71s
2024-05-01 14:37:01 INFO     Saved model at 0
2024-05-01 14:37:01 INFO     Val loss decrease from inf to 18.2367, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 14:37:06 INFO     epoch complete!
2024-05-01 14:37:06 INFO     evaluating now!
2024-05-01 14:37:07 INFO     Epoch [1/200] train_loss: 14.5528, val_loss: 13.8126, lr: 0.003000, 5.65s
2024-05-01 14:37:07 INFO     Saved model at 1
2024-05-01 14:37:07 INFO     Val loss decrease from 18.2367 to 13.8126, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 14:37:12 INFO     epoch complete!
2024-05-01 14:37:12 INFO     evaluating now!
2024-05-01 14:37:12 INFO     Epoch [2/200] train_loss: 11.4360, val_loss: 10.9725, lr: 0.003000, 5.58s
2024-05-01 14:37:12 INFO     Saved model at 2
2024-05-01 14:37:12 INFO     Val loss decrease from 13.8126 to 10.9725, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 14:37:18 INFO     epoch complete!
2024-05-01 14:37:18 INFO     evaluating now!
2024-05-01 14:37:18 INFO     Epoch [3/200] train_loss: 9.3439, val_loss: 9.1904, lr: 0.003000, 5.53s
2024-05-01 14:37:18 INFO     Saved model at 3
2024-05-01 14:37:18 INFO     Val loss decrease from 10.9725 to 9.1904, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 14:37:23 INFO     epoch complete!
2024-05-01 14:37:23 INFO     evaluating now!
2024-05-01 14:37:24 INFO     Epoch [4/200] train_loss: 8.1095, val_loss: 8.1375, lr: 0.003000, 5.52s
2024-05-01 14:37:24 INFO     Saved model at 4
2024-05-01 14:37:24 INFO     Val loss decrease from 9.1904 to 8.1375, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 14:37:29 INFO     epoch complete!
2024-05-01 14:37:29 INFO     evaluating now!
2024-05-01 14:37:29 INFO     Epoch [5/200] train_loss: 7.3582, val_loss: 7.1890, lr: 0.003000, 5.58s
2024-05-01 14:37:29 INFO     Saved model at 5
2024-05-01 14:37:29 INFO     Val loss decrease from 8.1375 to 7.1890, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 14:37:34 INFO     epoch complete!
2024-05-01 14:37:34 INFO     evaluating now!
2024-05-01 14:37:35 INFO     Epoch [6/200] train_loss: 6.7607, val_loss: 6.4878, lr: 0.003000, 5.55s
2024-05-01 14:37:35 INFO     Saved model at 6
2024-05-01 14:37:35 INFO     Val loss decrease from 7.1890 to 6.4878, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 14:37:40 INFO     epoch complete!
2024-05-01 14:37:40 INFO     evaluating now!
2024-05-01 14:37:40 INFO     Epoch [7/200] train_loss: 6.3885, val_loss: 6.3160, lr: 0.003000, 5.69s
2024-05-01 14:37:41 INFO     Saved model at 7
2024-05-01 14:37:41 INFO     Val loss decrease from 6.4878 to 6.3160, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 14:37:46 INFO     epoch complete!
2024-05-01 14:37:46 INFO     evaluating now!
2024-05-01 14:37:46 INFO     Epoch [8/200] train_loss: 6.1299, val_loss: 6.3452, lr: 0.003000, 5.66s
2024-05-01 14:37:52 INFO     epoch complete!
2024-05-01 14:37:52 INFO     evaluating now!
2024-05-01 14:37:52 INFO     Epoch [9/200] train_loss: 5.9085, val_loss: 6.0264, lr: 0.003000, 5.69s
2024-05-01 14:37:52 INFO     Saved model at 9
2024-05-01 14:37:52 INFO     Val loss decrease from 6.3160 to 6.0264, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-01 14:37:57 INFO     epoch complete!
2024-05-01 14:37:57 INFO     evaluating now!
2024-05-01 14:37:58 INFO     Epoch [10/200] train_loss: 5.7129, val_loss: 5.8527, lr: 0.003000, 5.61s
2024-05-01 14:37:58 INFO     Saved model at 10
2024-05-01 14:37:58 INFO     Val loss decrease from 6.0264 to 5.8527, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-01 14:38:03 INFO     epoch complete!
2024-05-01 14:38:03 INFO     evaluating now!
2024-05-01 14:38:03 INFO     Epoch [11/200] train_loss: 5.5270, val_loss: 5.8442, lr: 0.003000, 5.65s
2024-05-01 14:38:03 INFO     Saved model at 11
2024-05-01 14:38:03 INFO     Val loss decrease from 5.8527 to 5.8442, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-01 14:38:09 INFO     epoch complete!
2024-05-01 14:38:09 INFO     evaluating now!
2024-05-01 14:38:09 INFO     Epoch [12/200] train_loss: 5.4343, val_loss: 5.7983, lr: 0.003000, 5.67s
2024-05-01 14:38:09 INFO     Saved model at 12
2024-05-01 14:38:09 INFO     Val loss decrease from 5.8442 to 5.7983, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-01 14:38:14 INFO     epoch complete!
2024-05-01 14:38:14 INFO     evaluating now!
2024-05-01 14:38:15 INFO     Epoch [13/200] train_loss: 5.4654, val_loss: 5.5825, lr: 0.003000, 5.72s
2024-05-01 14:38:15 INFO     Saved model at 13
2024-05-01 14:38:15 INFO     Val loss decrease from 5.7983 to 5.5825, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-01 14:38:20 INFO     epoch complete!
2024-05-01 14:38:20 INFO     evaluating now!
2024-05-01 14:38:20 INFO     Epoch [14/200] train_loss: 5.2751, val_loss: 5.6869, lr: 0.003000, 5.73s
2024-05-01 14:38:26 INFO     epoch complete!
2024-05-01 14:38:26 INFO     evaluating now!
2024-05-01 14:38:26 INFO     Epoch [15/200] train_loss: 5.1889, val_loss: 5.7733, lr: 0.003000, 5.76s
2024-05-01 14:38:32 INFO     epoch complete!
2024-05-01 14:38:32 INFO     evaluating now!
2024-05-01 14:38:32 INFO     Epoch [16/200] train_loss: 5.1095, val_loss: 5.4910, lr: 0.003000, 5.69s
2024-05-01 14:38:32 INFO     Saved model at 16
2024-05-01 14:38:32 INFO     Val loss decrease from 5.5825 to 5.4910, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-01 14:38:37 INFO     epoch complete!
2024-05-01 14:38:37 INFO     evaluating now!
2024-05-01 14:38:38 INFO     Epoch [17/200] train_loss: 4.9926, val_loss: 5.6392, lr: 0.003000, 5.60s
2024-05-01 14:38:43 INFO     epoch complete!
2024-05-01 14:38:43 INFO     evaluating now!
2024-05-01 14:38:43 INFO     Epoch [18/200] train_loss: 4.9635, val_loss: 5.4694, lr: 0.003000, 5.49s
2024-05-01 14:38:43 INFO     Saved model at 18
2024-05-01 14:38:43 INFO     Val loss decrease from 5.4910 to 5.4694, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-01 14:38:48 INFO     epoch complete!
2024-05-01 14:38:48 INFO     evaluating now!
2024-05-01 14:38:49 INFO     Epoch [19/200] train_loss: 4.7994, val_loss: 5.6451, lr: 0.003000, 5.51s
2024-05-01 14:38:54 INFO     epoch complete!
2024-05-01 14:38:54 INFO     evaluating now!
2024-05-01 14:38:54 INFO     Epoch [20/200] train_loss: 4.8126, val_loss: 5.3396, lr: 0.003000, 5.42s
2024-05-01 14:38:54 INFO     Saved model at 20
2024-05-01 14:38:54 INFO     Val loss decrease from 5.4694 to 5.3396, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-01 14:38:59 INFO     epoch complete!
2024-05-01 14:38:59 INFO     evaluating now!
2024-05-01 14:38:59 INFO     Epoch [21/200] train_loss: 4.7215, val_loss: 5.5530, lr: 0.003000, 5.16s
2024-05-01 14:39:04 INFO     epoch complete!
2024-05-01 14:39:04 INFO     evaluating now!
2024-05-01 14:39:04 INFO     Epoch [22/200] train_loss: 4.6976, val_loss: 5.2827, lr: 0.003000, 5.09s
2024-05-01 14:39:04 INFO     Saved model at 22
2024-05-01 14:39:04 INFO     Val loss decrease from 5.3396 to 5.2827, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-01 14:39:09 INFO     epoch complete!
2024-05-01 14:39:09 INFO     evaluating now!
2024-05-01 14:39:09 INFO     Epoch [23/200] train_loss: 4.6205, val_loss: 5.5368, lr: 0.003000, 5.06s
2024-05-01 14:39:14 INFO     epoch complete!
2024-05-01 14:39:14 INFO     evaluating now!
2024-05-01 14:39:15 INFO     Epoch [24/200] train_loss: 4.6468, val_loss: 5.3378, lr: 0.003000, 5.18s
2024-05-01 14:39:19 INFO     epoch complete!
2024-05-01 14:39:19 INFO     evaluating now!
2024-05-01 14:39:19 INFO     Epoch [25/200] train_loss: 4.4992, val_loss: 5.2662, lr: 0.003000, 4.87s
2024-05-01 14:39:20 INFO     Saved model at 25
2024-05-01 14:39:20 INFO     Val loss decrease from 5.2827 to 5.2662, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-01 14:39:24 INFO     epoch complete!
2024-05-01 14:39:24 INFO     evaluating now!
2024-05-01 14:39:25 INFO     Epoch [26/200] train_loss: 4.5197, val_loss: 5.5710, lr: 0.003000, 5.12s
2024-05-01 14:39:29 INFO     epoch complete!
2024-05-01 14:39:29 INFO     evaluating now!
2024-05-01 14:39:30 INFO     Epoch [27/200] train_loss: 4.5436, val_loss: 5.4402, lr: 0.003000, 5.20s
2024-05-01 14:39:35 INFO     epoch complete!
2024-05-01 14:39:35 INFO     evaluating now!
2024-05-01 14:39:35 INFO     Epoch [28/200] train_loss: 4.4611, val_loss: 5.1798, lr: 0.003000, 5.33s
2024-05-01 14:39:35 INFO     Saved model at 28
2024-05-01 14:39:35 INFO     Val loss decrease from 5.2662 to 5.1798, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-05-01 14:39:40 INFO     epoch complete!
2024-05-01 14:39:40 INFO     evaluating now!
2024-05-01 14:39:40 INFO     Epoch [29/200] train_loss: 4.3264, val_loss: 5.4213, lr: 0.003000, 5.14s
2024-05-01 14:39:45 INFO     epoch complete!
2024-05-01 14:39:45 INFO     evaluating now!
2024-05-01 14:39:45 INFO     Epoch [30/200] train_loss: 4.3024, val_loss: 5.1678, lr: 0.003000, 5.05s
2024-05-01 14:39:45 INFO     Saved model at 30
2024-05-01 14:39:45 INFO     Val loss decrease from 5.1798 to 5.1678, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-05-01 14:39:50 INFO     epoch complete!
2024-05-01 14:39:50 INFO     evaluating now!
2024-05-01 14:39:51 INFO     Epoch [31/200] train_loss: 4.3397, val_loss: 5.1689, lr: 0.003000, 5.18s
2024-05-01 14:39:55 INFO     epoch complete!
2024-05-01 14:39:55 INFO     evaluating now!
2024-05-01 14:39:56 INFO     Epoch [32/200] train_loss: 4.2493, val_loss: 5.2207, lr: 0.003000, 5.16s
2024-05-01 14:40:01 INFO     epoch complete!
2024-05-01 14:40:01 INFO     evaluating now!
2024-05-01 14:40:01 INFO     Epoch [33/200] train_loss: 4.2200, val_loss: 5.1671, lr: 0.003000, 5.58s
2024-05-01 14:40:01 INFO     Saved model at 33
2024-05-01 14:40:01 INFO     Val loss decrease from 5.1678 to 5.1671, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-05-01 14:40:06 INFO     epoch complete!
2024-05-01 14:40:06 INFO     evaluating now!
2024-05-01 14:40:07 INFO     Epoch [34/200] train_loss: 4.1825, val_loss: 5.2006, lr: 0.003000, 5.30s
2024-05-01 14:40:12 INFO     epoch complete!
2024-05-01 14:40:12 INFO     evaluating now!
2024-05-01 14:40:12 INFO     Epoch [35/200] train_loss: 4.2125, val_loss: 5.1624, lr: 0.003000, 5.22s
2024-05-01 14:40:12 INFO     Saved model at 35
2024-05-01 14:40:12 INFO     Val loss decrease from 5.1671 to 5.1624, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-05-01 14:40:17 INFO     epoch complete!
2024-05-01 14:40:17 INFO     evaluating now!
2024-05-01 14:40:17 INFO     Epoch [36/200] train_loss: 4.2073, val_loss: 5.1076, lr: 0.003000, 5.22s
2024-05-01 14:40:17 INFO     Saved model at 36
2024-05-01 14:40:17 INFO     Val loss decrease from 5.1624 to 5.1076, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-05-01 14:40:22 INFO     epoch complete!
2024-05-01 14:40:22 INFO     evaluating now!
2024-05-01 14:40:23 INFO     Epoch [37/200] train_loss: 4.1579, val_loss: 5.2196, lr: 0.003000, 5.27s
2024-05-01 14:40:27 INFO     epoch complete!
2024-05-01 14:40:27 INFO     evaluating now!
2024-05-01 14:40:28 INFO     Epoch [38/200] train_loss: 4.1273, val_loss: 5.3297, lr: 0.003000, 5.34s
2024-05-01 14:40:33 INFO     epoch complete!
2024-05-01 14:40:33 INFO     evaluating now!
2024-05-01 14:40:33 INFO     Epoch [39/200] train_loss: 4.0716, val_loss: 5.1831, lr: 0.003000, 5.04s
2024-05-01 14:40:37 INFO     epoch complete!
2024-05-01 14:40:37 INFO     evaluating now!
2024-05-01 14:40:38 INFO     Epoch [40/200] train_loss: 4.0758, val_loss: 5.2063, lr: 0.003000, 4.98s
2024-05-01 14:40:43 INFO     epoch complete!
2024-05-01 14:40:43 INFO     evaluating now!
2024-05-01 14:40:43 INFO     Epoch [41/200] train_loss: 4.0894, val_loss: 5.0463, lr: 0.003000, 5.42s
2024-05-01 14:40:43 INFO     Saved model at 41
2024-05-01 14:40:43 INFO     Val loss decrease from 5.1076 to 5.0463, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-05-01 14:40:49 INFO     epoch complete!
2024-05-01 14:40:49 INFO     evaluating now!
2024-05-01 14:40:49 INFO     Epoch [42/200] train_loss: 3.9933, val_loss: 5.2869, lr: 0.003000, 5.57s
2024-05-01 14:40:54 INFO     epoch complete!
2024-05-01 14:40:54 INFO     evaluating now!
2024-05-01 14:40:54 INFO     Epoch [43/200] train_loss: 3.9436, val_loss: 5.2052, lr: 0.003000, 5.39s
2024-05-01 14:40:59 INFO     epoch complete!
2024-05-01 14:40:59 INFO     evaluating now!
2024-05-01 14:41:00 INFO     Epoch [44/200] train_loss: 3.9656, val_loss: 5.1801, lr: 0.003000, 5.40s
2024-05-01 14:41:05 INFO     epoch complete!
2024-05-01 14:41:05 INFO     evaluating now!
2024-05-01 14:41:05 INFO     Epoch [45/200] train_loss: 3.9394, val_loss: 5.1649, lr: 0.003000, 5.41s
2024-05-01 14:41:10 INFO     epoch complete!
2024-05-01 14:41:10 INFO     evaluating now!
2024-05-01 14:41:10 INFO     Epoch [46/200] train_loss: 3.9279, val_loss: 5.2616, lr: 0.003000, 5.36s
2024-05-01 14:41:16 INFO     epoch complete!
2024-05-01 14:41:16 INFO     evaluating now!
2024-05-01 14:41:16 INFO     Epoch [47/200] train_loss: 3.8713, val_loss: 5.1169, lr: 0.003000, 5.43s
2024-05-01 14:41:21 INFO     epoch complete!
2024-05-01 14:41:21 INFO     evaluating now!
2024-05-01 14:41:21 INFO     Epoch [48/200] train_loss: 3.8315, val_loss: 5.2346, lr: 0.003000, 5.42s
2024-05-01 14:41:27 INFO     epoch complete!
2024-05-01 14:41:27 INFO     evaluating now!
2024-05-01 14:41:27 INFO     Epoch [49/200] train_loss: 3.8294, val_loss: 5.0391, lr: 0.003000, 5.83s
2024-05-01 14:41:27 INFO     Saved model at 49
2024-05-01 14:41:27 INFO     Val loss decrease from 5.0463 to 5.0391, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-05-01 14:41:32 INFO     epoch complete!
2024-05-01 14:41:32 INFO     evaluating now!
2024-05-01 14:41:33 INFO     Epoch [50/200] train_loss: 3.8425, val_loss: 5.0629, lr: 0.003000, 5.63s
2024-05-01 14:41:38 INFO     epoch complete!
2024-05-01 14:41:38 INFO     evaluating now!
2024-05-01 14:41:38 INFO     Epoch [51/200] train_loss: 3.7693, val_loss: 5.2187, lr: 0.003000, 5.47s
2024-05-01 14:41:43 INFO     epoch complete!
2024-05-01 14:41:43 INFO     evaluating now!
2024-05-01 14:41:43 INFO     Epoch [52/200] train_loss: 3.7698, val_loss: 4.9958, lr: 0.003000, 5.12s
2024-05-01 14:41:43 INFO     Saved model at 52
2024-05-01 14:41:43 INFO     Val loss decrease from 5.0391 to 4.9958, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch52.tar
2024-05-01 14:41:48 INFO     epoch complete!
2024-05-01 14:41:48 INFO     evaluating now!
2024-05-01 14:41:48 INFO     Epoch [53/200] train_loss: 3.7078, val_loss: 5.0352, lr: 0.003000, 4.95s
2024-05-01 14:41:53 INFO     epoch complete!
2024-05-01 14:41:53 INFO     evaluating now!
2024-05-01 14:41:53 INFO     Epoch [54/200] train_loss: 3.7306, val_loss: 5.1721, lr: 0.003000, 4.92s
2024-05-01 14:41:58 INFO     epoch complete!
2024-05-01 14:41:58 INFO     evaluating now!
2024-05-01 14:41:58 INFO     Epoch [55/200] train_loss: 3.7335, val_loss: 5.0365, lr: 0.003000, 4.94s
2024-05-01 14:42:03 INFO     epoch complete!
2024-05-01 14:42:03 INFO     evaluating now!
2024-05-01 14:42:03 INFO     Epoch [56/200] train_loss: 3.7341, val_loss: 5.0909, lr: 0.003000, 4.97s
2024-05-01 14:42:08 INFO     epoch complete!
2024-05-01 14:42:08 INFO     evaluating now!
2024-05-01 14:42:08 INFO     Epoch [57/200] train_loss: 3.7262, val_loss: 5.0928, lr: 0.003000, 5.20s
2024-05-01 14:42:13 INFO     epoch complete!
2024-05-01 14:42:13 INFO     evaluating now!
2024-05-01 14:42:14 INFO     Epoch [58/200] train_loss: 3.7022, val_loss: 5.1935, lr: 0.003000, 5.14s
2024-05-01 14:42:18 INFO     epoch complete!
2024-05-01 14:42:18 INFO     evaluating now!
2024-05-01 14:42:19 INFO     Epoch [59/200] train_loss: 3.6526, val_loss: 5.1701, lr: 0.003000, 5.03s
2024-05-01 14:42:23 INFO     epoch complete!
2024-05-01 14:42:23 INFO     evaluating now!
2024-05-01 14:42:24 INFO     Epoch [60/200] train_loss: 3.6335, val_loss: 5.0658, lr: 0.003000, 4.95s
2024-05-01 14:42:29 INFO     epoch complete!
2024-05-01 14:42:29 INFO     evaluating now!
2024-05-01 14:42:29 INFO     Epoch [61/200] train_loss: 3.7155, val_loss: 5.1287, lr: 0.003000, 5.35s
2024-05-01 14:42:34 INFO     epoch complete!
2024-05-01 14:42:34 INFO     evaluating now!
2024-05-01 14:42:34 INFO     Epoch [62/200] train_loss: 3.6287, val_loss: 5.1229, lr: 0.003000, 5.09s
2024-05-01 14:42:39 INFO     epoch complete!
2024-05-01 14:42:39 INFO     evaluating now!
2024-05-01 14:42:39 INFO     Epoch [63/200] train_loss: 3.5962, val_loss: 5.1150, lr: 0.003000, 5.24s
2024-05-01 14:42:44 INFO     epoch complete!
2024-05-01 14:42:44 INFO     evaluating now!
2024-05-01 14:42:44 INFO     Epoch [64/200] train_loss: 3.5872, val_loss: 5.0525, lr: 0.003000, 5.16s
2024-05-01 14:42:49 INFO     epoch complete!
2024-05-01 14:42:49 INFO     evaluating now!
2024-05-01 14:42:49 INFO     Epoch [65/200] train_loss: 3.5981, val_loss: 5.0864, lr: 0.003000, 5.06s
2024-05-01 14:42:54 INFO     epoch complete!
2024-05-01 14:42:54 INFO     evaluating now!
2024-05-01 14:42:55 INFO     Epoch [66/200] train_loss: 3.5972, val_loss: 5.1776, lr: 0.003000, 5.14s
2024-05-01 14:42:59 INFO     epoch complete!
2024-05-01 14:42:59 INFO     evaluating now!
2024-05-01 14:43:00 INFO     Epoch [67/200] train_loss: 3.5737, val_loss: 5.1323, lr: 0.003000, 5.11s
2024-05-01 14:43:00 WARNING  Early stopping at epoch: 67
2024-05-01 14:43:00 INFO     Trained totally 68 epochs, average train time is 4.976s, average eval time is 0.364s
2024-05-01 14:43:00 INFO     Loaded model at 52
2024-05-01 14:43:00 INFO     Saved model at ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 14:43:00 INFO     Start evaluating ...
2024-05-01 14:43:01 INFO     Note that you select the single mode to evaluate!
2024-05-01 14:43:01 INFO     Evaluate result is saved at ./libcity/cache/17/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 14:43:01 INFO     
         MAE       RMSE
1   2.373224   7.339050
2   2.438220   7.851638
3   2.615814   8.734674
4   2.780271   9.548684
5   2.901204  10.343699
6   2.998221  11.134561
7   3.141430  11.909950
8   3.238700  12.419972
9   3.310687  12.721055
10  3.307606  12.779677
11  3.351836  12.991446
12  3.477849  13.486614
2024-05-01 14:43:01 INFO     ----------------------------------------------------------------------------
2024-05-01 14:43:01 INFO     # 3, Kownledge Graph Embedding: GIE, Experiment ids: 18
2024-05-01 14:43:01 INFO     ----------------------------------------------------------------------------
2024-05-01 14:43:01 INFO     Log directory: ./libcity/log
2024-05-01 14:43:01 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=18
2024-05-01 14:43:01 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 936202653, 'exp_id': 18, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'minmax11', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 14:43:01 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 14:43:01 INFO     set_weight_link_or_dist: dist
2024-05-01 14:43:01 INFO     init_weight_inf_or_zero: inf
2024-05-01 14:43:01 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 14:43:01 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 14:43:01 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 14:43:02 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 14:43:04 INFO     Dataset created
2024-05-01 14:43:04 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 14:43:04 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 14:43:04 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 14:43:04 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 14:43:05 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 14:43:05 INFO     MinMax11Scaler max: 0.3243229993054587, min: -0.6629940242690735
2024-05-01 14:43:09 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 14:43:09 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 14:43:09 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 14:43:09 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 14:43:09 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 14:43:09 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 14:43:09 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 14:43:09 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 14:43:09 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 14:43:09 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 14:43:09 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 14:43:09 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 14:43:09 INFO     Total parameter numbers: 874010
2024-05-01 14:43:09 INFO     You select `adam` optimizer.
2024-05-01 14:43:09 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 14:43:09 INFO     Start training ...
2024-05-01 14:43:09 INFO     num_batches:48
2024-05-01 14:43:13 INFO     epoch complete!
2024-05-01 14:43:13 INFO     evaluating now!
2024-05-01 14:43:14 INFO     Epoch [0/200] train_loss: 24.8321, val_loss: 18.7703, lr: 0.003000, 5.17s
2024-05-01 14:43:14 INFO     Saved model at 0
2024-05-01 14:43:14 INFO     Val loss decrease from inf to 18.7703, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 14:43:19 INFO     epoch complete!
2024-05-01 14:43:19 INFO     evaluating now!
2024-05-01 14:43:19 INFO     Epoch [1/200] train_loss: 15.5577, val_loss: 15.2592, lr: 0.003000, 5.12s
2024-05-01 14:43:19 INFO     Saved model at 1
2024-05-01 14:43:19 INFO     Val loss decrease from 18.7703 to 15.2592, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 14:43:24 INFO     epoch complete!
2024-05-01 14:43:24 INFO     evaluating now!
2024-05-01 14:43:24 INFO     Epoch [2/200] train_loss: 12.6534, val_loss: 12.3884, lr: 0.003000, 5.26s
2024-05-01 14:43:24 INFO     Saved model at 2
2024-05-01 14:43:24 INFO     Val loss decrease from 15.2592 to 12.3884, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 14:43:29 INFO     epoch complete!
2024-05-01 14:43:29 INFO     evaluating now!
2024-05-01 14:43:29 INFO     Epoch [3/200] train_loss: 10.1835, val_loss: 9.8402, lr: 0.003000, 5.12s
2024-05-01 14:43:29 INFO     Saved model at 3
2024-05-01 14:43:29 INFO     Val loss decrease from 12.3884 to 9.8402, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 14:43:35 INFO     epoch complete!
2024-05-01 14:43:35 INFO     evaluating now!
2024-05-01 14:43:35 INFO     Epoch [4/200] train_loss: 8.5716, val_loss: 8.1678, lr: 0.003000, 5.41s
2024-05-01 14:43:35 INFO     Saved model at 4
2024-05-01 14:43:35 INFO     Val loss decrease from 9.8402 to 8.1678, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 14:43:40 INFO     epoch complete!
2024-05-01 14:43:40 INFO     evaluating now!
2024-05-01 14:43:40 INFO     Epoch [5/200] train_loss: 7.7497, val_loss: 7.8046, lr: 0.003000, 4.94s
2024-05-01 14:43:40 INFO     Saved model at 5
2024-05-01 14:43:40 INFO     Val loss decrease from 8.1678 to 7.8046, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 14:43:45 INFO     epoch complete!
2024-05-01 14:43:45 INFO     evaluating now!
2024-05-01 14:43:45 INFO     Epoch [6/200] train_loss: 7.0307, val_loss: 6.9163, lr: 0.003000, 5.04s
2024-05-01 14:43:45 INFO     Saved model at 6
2024-05-01 14:43:45 INFO     Val loss decrease from 7.8046 to 6.9163, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 14:43:50 INFO     epoch complete!
2024-05-01 14:43:50 INFO     evaluating now!
2024-05-01 14:43:50 INFO     Epoch [7/200] train_loss: 6.5739, val_loss: 6.3932, lr: 0.003000, 4.89s
2024-05-01 14:43:50 INFO     Saved model at 7
2024-05-01 14:43:50 INFO     Val loss decrease from 6.9163 to 6.3932, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 14:43:55 INFO     epoch complete!
2024-05-01 14:43:55 INFO     evaluating now!
2024-05-01 14:43:55 INFO     Epoch [8/200] train_loss: 6.2508, val_loss: 6.3057, lr: 0.003000, 4.99s
2024-05-01 14:43:55 INFO     Saved model at 8
2024-05-01 14:43:55 INFO     Val loss decrease from 6.3932 to 6.3057, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-01 14:44:00 INFO     epoch complete!
2024-05-01 14:44:00 INFO     evaluating now!
2024-05-01 14:44:00 INFO     Epoch [9/200] train_loss: 5.9941, val_loss: 6.0648, lr: 0.003000, 5.10s
2024-05-01 14:44:00 INFO     Saved model at 9
2024-05-01 14:44:00 INFO     Val loss decrease from 6.3057 to 6.0648, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-01 14:44:05 INFO     epoch complete!
2024-05-01 14:44:05 INFO     evaluating now!
2024-05-01 14:44:05 INFO     Epoch [10/200] train_loss: 5.8186, val_loss: 6.0346, lr: 0.003000, 5.07s
2024-05-01 14:44:05 INFO     Saved model at 10
2024-05-01 14:44:05 INFO     Val loss decrease from 6.0648 to 6.0346, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-01 14:44:10 INFO     epoch complete!
2024-05-01 14:44:10 INFO     evaluating now!
2024-05-01 14:44:10 INFO     Epoch [11/200] train_loss: 5.7361, val_loss: 6.2292, lr: 0.003000, 4.87s
2024-05-01 14:44:15 INFO     epoch complete!
2024-05-01 14:44:15 INFO     evaluating now!
2024-05-01 14:44:15 INFO     Epoch [12/200] train_loss: 5.5843, val_loss: 5.8674, lr: 0.003000, 5.03s
2024-05-01 14:44:15 INFO     Saved model at 12
2024-05-01 14:44:15 INFO     Val loss decrease from 6.0346 to 5.8674, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-01 14:44:20 INFO     epoch complete!
2024-05-01 14:44:20 INFO     evaluating now!
2024-05-01 14:44:20 INFO     Epoch [13/200] train_loss: 5.4289, val_loss: 5.7351, lr: 0.003000, 4.87s
2024-05-01 14:44:20 INFO     Saved model at 13
2024-05-01 14:44:20 INFO     Val loss decrease from 5.8674 to 5.7351, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-01 14:44:25 INFO     epoch complete!
2024-05-01 14:44:25 INFO     evaluating now!
2024-05-01 14:44:25 INFO     Epoch [14/200] train_loss: 5.3265, val_loss: 5.7193, lr: 0.003000, 5.01s
2024-05-01 14:44:25 INFO     Saved model at 14
2024-05-01 14:44:25 INFO     Val loss decrease from 5.7351 to 5.7193, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-01 14:44:30 INFO     epoch complete!
2024-05-01 14:44:30 INFO     evaluating now!
2024-05-01 14:44:30 INFO     Epoch [15/200] train_loss: 5.2496, val_loss: 5.7195, lr: 0.003000, 5.01s
2024-05-01 14:44:35 INFO     epoch complete!
2024-05-01 14:44:35 INFO     evaluating now!
2024-05-01 14:44:35 INFO     Epoch [16/200] train_loss: 5.1540, val_loss: 5.6635, lr: 0.003000, 5.03s
2024-05-01 14:44:35 INFO     Saved model at 16
2024-05-01 14:44:35 INFO     Val loss decrease from 5.7193 to 5.6635, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-01 14:44:40 INFO     epoch complete!
2024-05-01 14:44:40 INFO     evaluating now!
2024-05-01 14:44:40 INFO     Epoch [17/200] train_loss: 5.0719, val_loss: 5.4995, lr: 0.003000, 4.99s
2024-05-01 14:44:40 INFO     Saved model at 17
2024-05-01 14:44:40 INFO     Val loss decrease from 5.6635 to 5.4995, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-01 14:44:45 INFO     epoch complete!
2024-05-01 14:44:45 INFO     evaluating now!
2024-05-01 14:44:46 INFO     Epoch [18/200] train_loss: 5.0238, val_loss: 5.5409, lr: 0.003000, 5.28s
2024-05-01 14:44:50 INFO     epoch complete!
2024-05-01 14:44:50 INFO     evaluating now!
2024-05-01 14:44:51 INFO     Epoch [19/200] train_loss: 4.8426, val_loss: 5.2689, lr: 0.003000, 5.24s
2024-05-01 14:44:51 INFO     Saved model at 19
2024-05-01 14:44:51 INFO     Val loss decrease from 5.4995 to 5.2689, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-01 14:44:56 INFO     epoch complete!
2024-05-01 14:44:56 INFO     evaluating now!
2024-05-01 14:44:56 INFO     Epoch [20/200] train_loss: 4.8344, val_loss: 5.4292, lr: 0.003000, 5.20s
2024-05-01 14:45:01 INFO     epoch complete!
2024-05-01 14:45:01 INFO     evaluating now!
2024-05-01 14:45:01 INFO     Epoch [21/200] train_loss: 4.8250, val_loss: 5.5857, lr: 0.003000, 5.42s
2024-05-01 14:45:07 INFO     epoch complete!
2024-05-01 14:45:07 INFO     evaluating now!
2024-05-01 14:45:07 INFO     Epoch [22/200] train_loss: 4.6927, val_loss: 5.2483, lr: 0.003000, 5.48s
2024-05-01 14:45:07 INFO     Saved model at 22
2024-05-01 14:45:07 INFO     Val loss decrease from 5.2689 to 5.2483, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-01 14:45:12 INFO     epoch complete!
2024-05-01 14:45:12 INFO     evaluating now!
2024-05-01 14:45:13 INFO     Epoch [23/200] train_loss: 4.6512, val_loss: 5.3663, lr: 0.003000, 5.74s
2024-05-01 14:45:18 INFO     epoch complete!
2024-05-01 14:45:18 INFO     evaluating now!
2024-05-01 14:45:18 INFO     Epoch [24/200] train_loss: 4.6850, val_loss: 5.5914, lr: 0.003000, 5.66s
2024-05-01 14:45:24 INFO     epoch complete!
2024-05-01 14:45:24 INFO     evaluating now!
2024-05-01 14:45:24 INFO     Epoch [25/200] train_loss: 4.6666, val_loss: 5.2567, lr: 0.003000, 5.75s
2024-05-01 14:45:29 INFO     epoch complete!
2024-05-01 14:45:29 INFO     evaluating now!
2024-05-01 14:45:30 INFO     Epoch [26/200] train_loss: 4.4793, val_loss: 5.4451, lr: 0.003000, 5.57s
2024-05-01 14:45:35 INFO     epoch complete!
2024-05-01 14:45:35 INFO     evaluating now!
2024-05-01 14:45:35 INFO     Epoch [27/200] train_loss: 4.5009, val_loss: 5.2823, lr: 0.003000, 5.25s
2024-05-01 14:45:40 INFO     epoch complete!
2024-05-01 14:45:40 INFO     evaluating now!
2024-05-01 14:45:40 INFO     Epoch [28/200] train_loss: 4.4244, val_loss: 5.4419, lr: 0.003000, 5.28s
2024-05-01 14:45:45 INFO     epoch complete!
2024-05-01 14:45:45 INFO     evaluating now!
2024-05-01 14:45:45 INFO     Epoch [29/200] train_loss: 4.3535, val_loss: 5.3861, lr: 0.003000, 5.13s
2024-05-01 14:45:50 INFO     epoch complete!
2024-05-01 14:45:50 INFO     evaluating now!
2024-05-01 14:45:50 INFO     Epoch [30/200] train_loss: 4.3075, val_loss: 5.1954, lr: 0.003000, 5.11s
2024-05-01 14:45:51 INFO     Saved model at 30
2024-05-01 14:45:51 INFO     Val loss decrease from 5.2483 to 5.1954, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-05-01 14:45:55 INFO     epoch complete!
2024-05-01 14:45:55 INFO     evaluating now!
2024-05-01 14:45:56 INFO     Epoch [31/200] train_loss: 4.3014, val_loss: 5.3221, lr: 0.003000, 5.28s
2024-05-01 14:46:01 INFO     epoch complete!
2024-05-01 14:46:01 INFO     evaluating now!
2024-05-01 14:46:01 INFO     Epoch [32/200] train_loss: 4.2911, val_loss: 5.3626, lr: 0.003000, 5.32s
2024-05-01 14:46:06 INFO     epoch complete!
2024-05-01 14:46:06 INFO     evaluating now!
2024-05-01 14:46:07 INFO     Epoch [33/200] train_loss: 4.2365, val_loss: 5.3633, lr: 0.003000, 5.46s
2024-05-01 14:46:11 INFO     epoch complete!
2024-05-01 14:46:11 INFO     evaluating now!
2024-05-01 14:46:12 INFO     Epoch [34/200] train_loss: 4.2404, val_loss: 5.2061, lr: 0.003000, 5.11s
2024-05-01 14:46:17 INFO     epoch complete!
2024-05-01 14:46:17 INFO     evaluating now!
2024-05-01 14:46:17 INFO     Epoch [35/200] train_loss: 4.1924, val_loss: 5.2139, lr: 0.003000, 5.37s
2024-05-01 14:46:22 INFO     epoch complete!
2024-05-01 14:46:22 INFO     evaluating now!
2024-05-01 14:46:22 INFO     Epoch [36/200] train_loss: 4.1748, val_loss: 5.2157, lr: 0.003000, 5.13s
2024-05-01 14:46:27 INFO     epoch complete!
2024-05-01 14:46:27 INFO     evaluating now!
2024-05-01 14:46:27 INFO     Epoch [37/200] train_loss: 4.0585, val_loss: 5.3255, lr: 0.003000, 5.20s
2024-05-01 14:46:32 INFO     epoch complete!
2024-05-01 14:46:32 INFO     evaluating now!
2024-05-01 14:46:33 INFO     Epoch [38/200] train_loss: 4.0410, val_loss: 5.3004, lr: 0.003000, 5.16s
2024-05-01 14:46:38 INFO     epoch complete!
2024-05-01 14:46:38 INFO     evaluating now!
2024-05-01 14:46:38 INFO     Epoch [39/200] train_loss: 4.0195, val_loss: 5.2591, lr: 0.003000, 5.80s
2024-05-01 14:46:44 INFO     epoch complete!
2024-05-01 14:46:44 INFO     evaluating now!
2024-05-01 14:46:44 INFO     Epoch [40/200] train_loss: 4.0651, val_loss: 5.2054, lr: 0.003000, 6.05s
2024-05-01 14:46:50 INFO     epoch complete!
2024-05-01 14:46:50 INFO     evaluating now!
2024-05-01 14:46:50 INFO     Epoch [41/200] train_loss: 3.9493, val_loss: 5.1740, lr: 0.003000, 5.82s
2024-05-01 14:46:50 INFO     Saved model at 41
2024-05-01 14:46:50 INFO     Val loss decrease from 5.1954 to 5.1740, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-05-01 14:46:56 INFO     epoch complete!
2024-05-01 14:46:56 INFO     evaluating now!
2024-05-01 14:46:56 INFO     Epoch [42/200] train_loss: 3.9554, val_loss: 5.1494, lr: 0.003000, 5.84s
2024-05-01 14:46:56 INFO     Saved model at 42
2024-05-01 14:46:56 INFO     Val loss decrease from 5.1740 to 5.1494, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-05-01 14:47:01 INFO     epoch complete!
2024-05-01 14:47:01 INFO     evaluating now!
2024-05-01 14:47:02 INFO     Epoch [43/200] train_loss: 3.9578, val_loss: 5.2130, lr: 0.003000, 5.65s
2024-05-01 14:47:07 INFO     epoch complete!
2024-05-01 14:47:07 INFO     evaluating now!
2024-05-01 14:47:07 INFO     Epoch [44/200] train_loss: 3.9648, val_loss: 5.1832, lr: 0.003000, 5.64s
2024-05-01 14:47:13 INFO     epoch complete!
2024-05-01 14:47:13 INFO     evaluating now!
2024-05-01 14:47:13 INFO     Epoch [45/200] train_loss: 3.8941, val_loss: 5.2018, lr: 0.003000, 5.54s
2024-05-01 14:47:18 INFO     epoch complete!
2024-05-01 14:47:18 INFO     evaluating now!
2024-05-01 14:47:19 INFO     Epoch [46/200] train_loss: 3.8882, val_loss: 5.1318, lr: 0.003000, 5.57s
2024-05-01 14:47:19 INFO     Saved model at 46
2024-05-01 14:47:19 INFO     Val loss decrease from 5.1494 to 5.1318, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-05-01 14:47:24 INFO     epoch complete!
2024-05-01 14:47:24 INFO     evaluating now!
2024-05-01 14:47:25 INFO     Epoch [47/200] train_loss: 3.8337, val_loss: 5.2751, lr: 0.003000, 5.91s
2024-05-01 14:47:30 INFO     epoch complete!
2024-05-01 14:47:30 INFO     evaluating now!
2024-05-01 14:47:30 INFO     Epoch [48/200] train_loss: 3.8092, val_loss: 5.1561, lr: 0.003000, 5.55s
2024-05-01 14:47:35 INFO     epoch complete!
2024-05-01 14:47:35 INFO     evaluating now!
2024-05-01 14:47:36 INFO     Epoch [49/200] train_loss: 3.8262, val_loss: 5.2136, lr: 0.003000, 5.51s
2024-05-01 14:47:41 INFO     epoch complete!
2024-05-01 14:47:41 INFO     evaluating now!
2024-05-01 14:47:41 INFO     Epoch [50/200] train_loss: 3.8360, val_loss: 5.1373, lr: 0.003000, 5.75s
2024-05-01 14:47:47 INFO     epoch complete!
2024-05-01 14:47:47 INFO     evaluating now!
2024-05-01 14:47:47 INFO     Epoch [51/200] train_loss: 3.7927, val_loss: 4.9742, lr: 0.003000, 5.62s
2024-05-01 14:47:47 INFO     Saved model at 51
2024-05-01 14:47:47 INFO     Val loss decrease from 5.1318 to 4.9742, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-05-01 14:47:52 INFO     epoch complete!
2024-05-01 14:47:52 INFO     evaluating now!
2024-05-01 14:47:53 INFO     Epoch [52/200] train_loss: 3.8406, val_loss: 5.2759, lr: 0.003000, 5.65s
2024-05-01 14:47:58 INFO     epoch complete!
2024-05-01 14:47:58 INFO     evaluating now!
2024-05-01 14:47:58 INFO     Epoch [53/200] train_loss: 3.8022, val_loss: 5.1874, lr: 0.003000, 5.56s
2024-05-01 14:48:04 INFO     epoch complete!
2024-05-01 14:48:04 INFO     evaluating now!
2024-05-01 14:48:04 INFO     Epoch [54/200] train_loss: 3.7335, val_loss: 5.2013, lr: 0.003000, 5.62s
2024-05-01 14:48:09 INFO     epoch complete!
2024-05-01 14:48:09 INFO     evaluating now!
2024-05-01 14:48:09 INFO     Epoch [55/200] train_loss: 3.6589, val_loss: 5.2219, lr: 0.003000, 5.59s
2024-05-01 14:48:15 INFO     epoch complete!
2024-05-01 14:48:15 INFO     evaluating now!
2024-05-01 14:48:15 INFO     Epoch [56/200] train_loss: 3.7075, val_loss: 5.0872, lr: 0.003000, 5.67s
2024-05-01 14:48:20 INFO     epoch complete!
2024-05-01 14:48:20 INFO     evaluating now!
2024-05-01 14:48:21 INFO     Epoch [57/200] train_loss: 3.6642, val_loss: 5.2506, lr: 0.003000, 5.44s
2024-05-01 14:48:26 INFO     epoch complete!
2024-05-01 14:48:26 INFO     evaluating now!
2024-05-01 14:48:26 INFO     Epoch [58/200] train_loss: 3.6713, val_loss: 5.1402, lr: 0.003000, 5.71s
2024-05-01 14:48:31 INFO     epoch complete!
2024-05-01 14:48:31 INFO     evaluating now!
2024-05-01 14:48:32 INFO     Epoch [59/200] train_loss: 3.6688, val_loss: 5.1346, lr: 0.003000, 5.54s
2024-05-01 14:48:37 INFO     epoch complete!
2024-05-01 14:48:37 INFO     evaluating now!
2024-05-01 14:48:37 INFO     Epoch [60/200] train_loss: 3.6418, val_loss: 5.1724, lr: 0.003000, 5.59s
2024-05-01 14:48:43 INFO     epoch complete!
2024-05-01 14:48:43 INFO     evaluating now!
2024-05-01 14:48:43 INFO     Epoch [61/200] train_loss: 3.5912, val_loss: 5.2365, lr: 0.003000, 5.48s
2024-05-01 14:48:48 INFO     epoch complete!
2024-05-01 14:48:48 INFO     evaluating now!
2024-05-01 14:48:48 INFO     Epoch [62/200] train_loss: 3.6727, val_loss: 5.0814, lr: 0.003000, 5.56s
2024-05-01 14:48:54 INFO     epoch complete!
2024-05-01 14:48:54 INFO     evaluating now!
2024-05-01 14:48:54 INFO     Epoch [63/200] train_loss: 3.6141, val_loss: 5.0633, lr: 0.003000, 5.54s
2024-05-01 14:48:59 INFO     epoch complete!
2024-05-01 14:48:59 INFO     evaluating now!
2024-05-01 14:49:00 INFO     Epoch [64/200] train_loss: 3.5741, val_loss: 5.0428, lr: 0.003000, 5.86s
2024-05-01 14:49:05 INFO     epoch complete!
2024-05-01 14:49:05 INFO     evaluating now!
2024-05-01 14:49:05 INFO     Epoch [65/200] train_loss: 3.5484, val_loss: 5.1746, lr: 0.003000, 5.52s
2024-05-01 14:49:11 INFO     epoch complete!
2024-05-01 14:49:11 INFO     evaluating now!
2024-05-01 14:49:11 INFO     Epoch [66/200] train_loss: 3.5142, val_loss: 5.2454, lr: 0.003000, 5.52s
2024-05-01 14:49:11 WARNING  Early stopping at epoch: 66
2024-05-01 14:49:11 INFO     Trained totally 67 epochs, average train time is 5.032s, average eval time is 0.356s
2024-05-01 14:49:11 INFO     Loaded model at 51
2024-05-01 14:49:11 INFO     Saved model at ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 14:49:11 INFO     Start evaluating ...
2024-05-01 14:49:12 INFO     Note that you select the single mode to evaluate!
2024-05-01 14:49:12 INFO     Evaluate result is saved at ./libcity/cache/18/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 14:49:12 INFO     
         MAE       RMSE
1   2.480014   7.230897
2   2.514845   7.784313
3   2.582070   8.625850
4   2.747290   9.303840
5   2.857235   9.954903
6   2.990472  10.606281
7   3.067119  11.101427
8   3.217019  11.566891
9   3.216487  11.989882
10  3.259326  12.339470
11  3.343413  12.760212
12  3.405433  13.406107
2024-05-01 14:49:12 INFO     ----------------------------------------------------------------------------
2024-05-01 14:49:12 INFO     # 4, Kownledge Graph Embedding: GIE, Experiment ids: 19
2024-05-01 14:49:12 INFO     ----------------------------------------------------------------------------
2024-05-01 14:49:12 INFO     Log directory: ./libcity/log
2024-05-01 14:49:12 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=19
2024-05-01 14:49:12 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 184218539, 'exp_id': 19, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'minmax11', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-01 14:49:12 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-01 14:49:12 INFO     set_weight_link_or_dist: dist
2024-05-01 14:49:12 INFO     init_weight_inf_or_zero: inf
2024-05-01 14:49:13 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-01 14:49:13 INFO     Start Calculate the weight by Gauss kernel!
2024-05-01 14:49:13 INFO     Loading file CHITaxi20190406.dyna
2024-05-01 14:49:13 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-01 14:49:15 INFO     Dataset created
2024-05-01 14:49:15 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-05-01 14:49:15 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-05-01 14:49:15 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-05-01 14:49:15 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-05-01 14:49:16 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-01 14:49:16 INFO     MinMax11Scaler max: 0.3243229993054587, min: -0.6629940242690735
2024-05-01 14:49:20 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-01 14:49:20 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-01 14:49:20 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-05-01 14:49:20 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 14:49:20 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-05-01 14:49:20 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 14:49:20 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-01 14:49:20 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-01 14:49:20 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-01 14:49:20 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-01 14:49:20 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-01 14:49:20 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-01 14:49:20 INFO     Total parameter numbers: 874010
2024-05-01 14:49:20 INFO     You select `adam` optimizer.
2024-05-01 14:49:20 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-01 14:49:20 INFO     Start training ...
2024-05-01 14:49:20 INFO     num_batches:48
2024-05-01 14:49:25 INFO     epoch complete!
2024-05-01 14:49:25 INFO     evaluating now!
2024-05-01 14:49:25 INFO     Epoch [0/200] train_loss: 24.9281, val_loss: 18.4778, lr: 0.003000, 5.61s
2024-05-01 14:49:25 INFO     Saved model at 0
2024-05-01 14:49:25 INFO     Val loss decrease from inf to 18.4778, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-01 14:49:31 INFO     epoch complete!
2024-05-01 14:49:31 INFO     evaluating now!
2024-05-01 14:49:31 INFO     Epoch [1/200] train_loss: 15.3467, val_loss: 14.9216, lr: 0.003000, 5.63s
2024-05-01 14:49:31 INFO     Saved model at 1
2024-05-01 14:49:31 INFO     Val loss decrease from 18.4778 to 14.9216, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-01 14:49:36 INFO     epoch complete!
2024-05-01 14:49:36 INFO     evaluating now!
2024-05-01 14:49:37 INFO     Epoch [2/200] train_loss: 12.3317, val_loss: 12.3898, lr: 0.003000, 5.56s
2024-05-01 14:49:37 INFO     Saved model at 2
2024-05-01 14:49:37 INFO     Val loss decrease from 14.9216 to 12.3898, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-01 14:49:42 INFO     epoch complete!
2024-05-01 14:49:42 INFO     evaluating now!
2024-05-01 14:49:42 INFO     Epoch [3/200] train_loss: 10.2091, val_loss: 10.1891, lr: 0.003000, 5.61s
2024-05-01 14:49:42 INFO     Saved model at 3
2024-05-01 14:49:42 INFO     Val loss decrease from 12.3898 to 10.1891, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-01 14:49:47 INFO     epoch complete!
2024-05-01 14:49:47 INFO     evaluating now!
2024-05-01 14:49:48 INFO     Epoch [4/200] train_loss: 9.0149, val_loss: 8.7117, lr: 0.003000, 5.63s
2024-05-01 14:49:48 INFO     Saved model at 4
2024-05-01 14:49:48 INFO     Val loss decrease from 10.1891 to 8.7117, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-01 14:49:53 INFO     epoch complete!
2024-05-01 14:49:53 INFO     evaluating now!
2024-05-01 14:49:53 INFO     Epoch [5/200] train_loss: 8.1307, val_loss: 7.9271, lr: 0.003000, 5.54s
2024-05-01 14:49:53 INFO     Saved model at 5
2024-05-01 14:49:53 INFO     Val loss decrease from 8.7117 to 7.9271, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-01 14:49:59 INFO     epoch complete!
2024-05-01 14:49:59 INFO     evaluating now!
2024-05-01 14:49:59 INFO     Epoch [6/200] train_loss: 7.5273, val_loss: 7.4602, lr: 0.003000, 5.89s
2024-05-01 14:49:59 INFO     Saved model at 6
2024-05-01 14:49:59 INFO     Val loss decrease from 7.9271 to 7.4602, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-01 14:50:05 INFO     epoch complete!
2024-05-01 14:50:05 INFO     evaluating now!
2024-05-01 14:50:05 INFO     Epoch [7/200] train_loss: 6.9180, val_loss: 7.0394, lr: 0.003000, 5.70s
2024-05-01 14:50:05 INFO     Saved model at 7
2024-05-01 14:50:05 INFO     Val loss decrease from 7.4602 to 7.0394, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-01 14:50:10 INFO     epoch complete!
2024-05-01 14:50:10 INFO     evaluating now!
2024-05-01 14:50:11 INFO     Epoch [8/200] train_loss: 6.6363, val_loss: 6.5586, lr: 0.003000, 5.61s
2024-05-01 14:50:11 INFO     Saved model at 8
2024-05-01 14:50:11 INFO     Val loss decrease from 7.0394 to 6.5586, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-01 14:50:16 INFO     epoch complete!
2024-05-01 14:50:16 INFO     evaluating now!
2024-05-01 14:50:17 INFO     Epoch [9/200] train_loss: 6.4199, val_loss: 6.6278, lr: 0.003000, 5.73s
2024-05-01 14:50:22 INFO     epoch complete!
2024-05-01 14:50:22 INFO     evaluating now!
2024-05-01 14:50:22 INFO     Epoch [10/200] train_loss: 6.2097, val_loss: 6.2692, lr: 0.003000, 5.48s
2024-05-01 14:50:22 INFO     Saved model at 10
2024-05-01 14:50:22 INFO     Val loss decrease from 6.5586 to 6.2692, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-01 14:50:27 INFO     epoch complete!
2024-05-01 14:50:27 INFO     evaluating now!
2024-05-01 14:50:28 INFO     Epoch [11/200] train_loss: 5.8174, val_loss: 5.9861, lr: 0.003000, 5.62s
2024-05-01 14:50:28 INFO     Saved model at 11
2024-05-01 14:50:28 INFO     Val loss decrease from 6.2692 to 5.9861, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-01 14:50:33 INFO     epoch complete!
2024-05-01 14:50:33 INFO     evaluating now!
2024-05-01 14:50:34 INFO     Epoch [12/200] train_loss: 5.7736, val_loss: 6.1247, lr: 0.003000, 5.79s
2024-05-01 14:50:39 INFO     epoch complete!
2024-05-01 14:50:39 INFO     evaluating now!
2024-05-01 14:50:39 INFO     Epoch [13/200] train_loss: 5.6101, val_loss: 5.8061, lr: 0.003000, 5.50s
2024-05-01 14:50:39 INFO     Saved model at 13
2024-05-01 14:50:39 INFO     Val loss decrease from 5.9861 to 5.8061, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-01 14:50:44 INFO     epoch complete!
2024-05-01 14:50:44 INFO     evaluating now!
2024-05-01 14:50:45 INFO     Epoch [14/200] train_loss: 5.5532, val_loss: 5.8255, lr: 0.003000, 5.49s
2024-05-01 14:50:50 INFO     epoch complete!
2024-05-01 14:50:50 INFO     evaluating now!
2024-05-01 14:50:50 INFO     Epoch [15/200] train_loss: 5.3570, val_loss: 6.0519, lr: 0.003000, 5.58s
2024-05-01 14:50:55 INFO     epoch complete!
2024-05-01 14:50:55 INFO     evaluating now!
2024-05-01 14:50:56 INFO     Epoch [16/200] train_loss: 5.3633, val_loss: 5.8115, lr: 0.003000, 5.47s
2024-05-01 14:51:01 INFO     epoch complete!
2024-05-01 14:51:01 INFO     evaluating now!
2024-05-01 14:51:01 INFO     Epoch [17/200] train_loss: 5.2751, val_loss: 5.5051, lr: 0.003000, 5.65s
2024-05-01 14:51:01 INFO     Saved model at 17
2024-05-01 14:51:01 INFO     Val loss decrease from 5.8061 to 5.5051, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-01 14:51:07 INFO     epoch complete!
2024-05-01 14:51:07 INFO     evaluating now!
2024-05-01 14:51:07 INFO     Epoch [18/200] train_loss: 5.1176, val_loss: 5.7340, lr: 0.003000, 5.79s
2024-05-01 14:51:12 INFO     epoch complete!
2024-05-01 14:51:12 INFO     evaluating now!
2024-05-01 14:51:13 INFO     Epoch [19/200] train_loss: 5.0352, val_loss: 5.5807, lr: 0.003000, 5.68s
2024-05-01 14:51:18 INFO     epoch complete!
2024-05-01 14:51:18 INFO     evaluating now!
2024-05-01 14:51:18 INFO     Epoch [20/200] train_loss: 4.9519, val_loss: 5.4943, lr: 0.003000, 5.72s
2024-05-01 14:51:19 INFO     Saved model at 20
2024-05-01 14:51:19 INFO     Val loss decrease from 5.5051 to 5.4943, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-01 14:51:24 INFO     epoch complete!
2024-05-01 14:51:24 INFO     evaluating now!
2024-05-01 14:51:24 INFO     Epoch [21/200] train_loss: 4.9802, val_loss: 5.4255, lr: 0.003000, 5.72s
2024-05-01 14:51:24 INFO     Saved model at 21
2024-05-01 14:51:24 INFO     Val loss decrease from 5.4943 to 5.4255, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-01 14:51:30 INFO     epoch complete!
2024-05-01 14:51:30 INFO     evaluating now!
2024-05-01 14:51:30 INFO     Epoch [22/200] train_loss: 4.8856, val_loss: 5.6052, lr: 0.003000, 5.75s
2024-05-01 14:51:35 INFO     epoch complete!
2024-05-01 14:51:35 INFO     evaluating now!
2024-05-01 14:51:36 INFO     Epoch [23/200] train_loss: 4.8573, val_loss: 5.4653, lr: 0.003000, 5.59s
2024-05-01 14:51:41 INFO     epoch complete!
2024-05-01 14:51:41 INFO     evaluating now!
2024-05-01 14:51:41 INFO     Epoch [24/200] train_loss: 4.8212, val_loss: 5.3155, lr: 0.003000, 5.73s
2024-05-01 14:51:41 INFO     Saved model at 24
2024-05-01 14:51:41 INFO     Val loss decrease from 5.4255 to 5.3155, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-01 14:51:47 INFO     epoch complete!
2024-05-01 14:51:47 INFO     evaluating now!
2024-05-01 14:51:47 INFO     Epoch [25/200] train_loss: 4.6983, val_loss: 5.5428, lr: 0.003000, 5.81s
2024-05-01 14:51:52 INFO     epoch complete!
2024-05-01 14:51:52 INFO     evaluating now!
2024-05-01 14:51:53 INFO     Epoch [26/200] train_loss: 4.6647, val_loss: 5.2996, lr: 0.003000, 5.53s
2024-05-01 14:51:53 INFO     Saved model at 26
2024-05-01 14:51:53 INFO     Val loss decrease from 5.3155 to 5.2996, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-05-01 14:51:58 INFO     epoch complete!
2024-05-01 14:51:58 INFO     evaluating now!
2024-05-01 14:51:58 INFO     Epoch [27/200] train_loss: 4.6030, val_loss: 5.1387, lr: 0.003000, 5.60s
2024-05-01 14:51:58 INFO     Saved model at 27
2024-05-01 14:51:58 INFO     Val loss decrease from 5.2996 to 5.1387, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-05-01 14:52:04 INFO     epoch complete!
2024-05-01 14:52:04 INFO     evaluating now!
2024-05-01 14:52:04 INFO     Epoch [28/200] train_loss: 4.5391, val_loss: 5.2103, lr: 0.003000, 5.55s
2024-05-01 14:52:09 INFO     epoch complete!
2024-05-01 14:52:09 INFO     evaluating now!
2024-05-01 14:52:10 INFO     Epoch [29/200] train_loss: 4.4871, val_loss: 5.2277, lr: 0.003000, 5.67s
2024-05-01 14:52:15 INFO     epoch complete!
2024-05-01 14:52:15 INFO     evaluating now!
2024-05-01 14:52:15 INFO     Epoch [30/200] train_loss: 4.4148, val_loss: 5.3361, lr: 0.003000, 5.72s
2024-05-01 14:52:21 INFO     epoch complete!
2024-05-01 14:52:21 INFO     evaluating now!
2024-05-01 14:52:21 INFO     Epoch [31/200] train_loss: 4.4507, val_loss: 5.4922, lr: 0.003000, 5.55s
2024-05-01 14:52:26 INFO     epoch complete!
2024-05-01 14:52:26 INFO     evaluating now!
2024-05-01 14:52:27 INFO     Epoch [32/200] train_loss: 4.4085, val_loss: 5.3975, lr: 0.003000, 5.68s
2024-05-01 14:52:32 INFO     epoch complete!
2024-05-01 14:52:32 INFO     evaluating now!
2024-05-01 14:52:32 INFO     Epoch [33/200] train_loss: 4.3679, val_loss: 5.3191, lr: 0.003000, 5.70s
2024-05-01 14:52:38 INFO     epoch complete!
2024-05-01 14:52:38 INFO     evaluating now!
2024-05-01 14:52:38 INFO     Epoch [34/200] train_loss: 4.3225, val_loss: 5.1809, lr: 0.003000, 5.71s
2024-05-01 14:52:43 INFO     epoch complete!
2024-05-01 14:52:43 INFO     evaluating now!
2024-05-01 14:52:44 INFO     Epoch [35/200] train_loss: 4.3178, val_loss: 5.2599, lr: 0.003000, 5.71s
2024-05-01 14:52:49 INFO     epoch complete!
2024-05-01 14:52:49 INFO     evaluating now!
2024-05-01 14:52:49 INFO     Epoch [36/200] train_loss: 4.2501, val_loss: 5.1968, lr: 0.003000, 5.74s
2024-05-01 14:52:55 INFO     epoch complete!
2024-05-01 14:52:55 INFO     evaluating now!
2024-05-01 14:52:56 INFO     Epoch [37/200] train_loss: 4.2743, val_loss: 5.2745, lr: 0.003000, 6.26s
2024-05-01 14:53:02 INFO     epoch complete!
2024-05-01 14:53:02 INFO     evaluating now!
2024-05-01 14:53:02 INFO     Epoch [38/200] train_loss: 4.1554, val_loss: 5.1148, lr: 0.003000, 6.28s
2024-05-01 14:53:02 INFO     Saved model at 38
2024-05-01 14:53:02 INFO     Val loss decrease from 5.1387 to 5.1148, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-05-01 14:53:07 INFO     epoch complete!
2024-05-01 14:53:07 INFO     evaluating now!
2024-05-01 14:53:08 INFO     Epoch [39/200] train_loss: 4.1161, val_loss: 5.0640, lr: 0.003000, 5.65s
2024-05-01 14:53:08 INFO     Saved model at 39
2024-05-01 14:53:08 INFO     Val loss decrease from 5.1148 to 5.0640, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-05-01 14:53:13 INFO     epoch complete!
2024-05-01 14:53:13 INFO     evaluating now!
2024-05-01 14:53:13 INFO     Epoch [40/200] train_loss: 4.0606, val_loss: 5.4511, lr: 0.003000, 5.54s
2024-05-01 14:53:18 INFO     epoch complete!
2024-05-01 14:53:18 INFO     evaluating now!
2024-05-01 14:53:19 INFO     Epoch [41/200] train_loss: 4.0841, val_loss: 5.1969, lr: 0.003000, 5.49s
2024-05-01 14:53:24 INFO     epoch complete!
2024-05-01 14:53:24 INFO     evaluating now!
2024-05-01 14:53:24 INFO     Epoch [42/200] train_loss: 4.1075, val_loss: 5.1677, lr: 0.003000, 5.65s
2024-05-01 14:53:30 INFO     epoch complete!
2024-05-01 14:53:30 INFO     evaluating now!
2024-05-01 14:53:30 INFO     Epoch [43/200] train_loss: 3.9980, val_loss: 5.2567, lr: 0.003000, 5.63s
2024-05-01 14:53:35 INFO     epoch complete!
2024-05-01 14:53:35 INFO     evaluating now!
2024-05-01 14:53:36 INFO     Epoch [44/200] train_loss: 3.9718, val_loss: 5.1275, lr: 0.003000, 5.63s
2024-05-01 14:53:41 INFO     epoch complete!
2024-05-01 14:53:41 INFO     evaluating now!
2024-05-01 14:53:41 INFO     Epoch [45/200] train_loss: 3.9755, val_loss: 5.1013, lr: 0.003000, 5.71s
2024-05-01 14:53:47 INFO     epoch complete!
2024-05-01 14:53:47 INFO     evaluating now!
2024-05-01 14:53:47 INFO     Epoch [46/200] train_loss: 3.9441, val_loss: 5.3137, lr: 0.003000, 5.66s
2024-05-01 14:53:52 INFO     epoch complete!
2024-05-01 14:53:52 INFO     evaluating now!
2024-05-01 14:53:53 INFO     Epoch [47/200] train_loss: 4.0642, val_loss: 5.2014, lr: 0.003000, 5.50s
2024-05-01 14:53:58 INFO     epoch complete!
2024-05-01 14:53:58 INFO     evaluating now!
2024-05-01 14:53:58 INFO     Epoch [48/200] train_loss: 3.8923, val_loss: 5.1718, lr: 0.003000, 5.59s
2024-05-01 14:54:03 INFO     epoch complete!
2024-05-01 14:54:03 INFO     evaluating now!
2024-05-01 14:54:04 INFO     Epoch [49/200] train_loss: 3.9031, val_loss: 5.3537, lr: 0.003000, 5.62s
2024-05-01 14:54:09 INFO     epoch complete!
2024-05-01 14:54:09 INFO     evaluating now!
2024-05-01 14:54:09 INFO     Epoch [50/200] train_loss: 3.9442, val_loss: 5.1345, lr: 0.003000, 5.54s
2024-05-01 14:54:15 INFO     epoch complete!
2024-05-01 14:54:15 INFO     evaluating now!
2024-05-01 14:54:15 INFO     Epoch [51/200] train_loss: 3.9230, val_loss: 5.1125, lr: 0.003000, 5.84s
2024-05-01 14:54:20 INFO     epoch complete!
2024-05-01 14:54:20 INFO     evaluating now!
2024-05-01 14:54:21 INFO     Epoch [52/200] train_loss: 3.8486, val_loss: 5.1831, lr: 0.003000, 5.65s
2024-05-01 14:54:26 INFO     epoch complete!
2024-05-01 14:54:26 INFO     evaluating now!
2024-05-01 14:54:26 INFO     Epoch [53/200] train_loss: 3.7717, val_loss: 5.0275, lr: 0.003000, 5.63s
2024-05-01 14:54:27 INFO     Saved model at 53
2024-05-01 14:54:27 INFO     Val loss decrease from 5.0640 to 5.0275, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch53.tar
2024-05-01 14:54:32 INFO     epoch complete!
2024-05-01 14:54:32 INFO     evaluating now!
2024-05-01 14:54:32 INFO     Epoch [54/200] train_loss: 3.7562, val_loss: 5.2380, lr: 0.003000, 5.73s
2024-05-01 14:54:37 INFO     epoch complete!
2024-05-01 14:54:37 INFO     evaluating now!
2024-05-01 14:54:38 INFO     Epoch [55/200] train_loss: 3.7768, val_loss: 5.0690, lr: 0.003000, 5.63s
2024-05-01 14:54:43 INFO     epoch complete!
2024-05-01 14:54:43 INFO     evaluating now!
2024-05-01 14:54:44 INFO     Epoch [56/200] train_loss: 3.8001, val_loss: 5.1386, lr: 0.003000, 5.82s
2024-05-01 14:54:49 INFO     epoch complete!
2024-05-01 14:54:49 INFO     evaluating now!
2024-05-01 14:54:50 INFO     Epoch [57/200] train_loss: 3.7514, val_loss: 5.0911, lr: 0.003000, 5.84s
2024-05-01 14:54:55 INFO     epoch complete!
2024-05-01 14:54:55 INFO     evaluating now!
2024-05-01 14:54:55 INFO     Epoch [58/200] train_loss: 3.6958, val_loss: 5.1278, lr: 0.003000, 5.74s
2024-05-01 14:55:00 INFO     epoch complete!
2024-05-01 14:55:00 INFO     evaluating now!
2024-05-01 14:55:01 INFO     Epoch [59/200] train_loss: 3.6754, val_loss: 5.1328, lr: 0.003000, 5.57s
2024-05-01 14:55:06 INFO     epoch complete!
2024-05-01 14:55:06 INFO     evaluating now!
2024-05-01 14:55:07 INFO     Epoch [60/200] train_loss: 3.6545, val_loss: 5.0188, lr: 0.003000, 5.77s
2024-05-01 14:55:07 INFO     Saved model at 60
2024-05-01 14:55:07 INFO     Val loss decrease from 5.0275 to 5.0188, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch60.tar
2024-05-01 14:55:12 INFO     epoch complete!
2024-05-01 14:55:12 INFO     evaluating now!
2024-05-01 14:55:12 INFO     Epoch [61/200] train_loss: 3.6974, val_loss: 5.1156, lr: 0.003000, 5.66s
2024-05-01 14:55:18 INFO     epoch complete!
2024-05-01 14:55:18 INFO     evaluating now!
2024-05-01 14:55:18 INFO     Epoch [62/200] train_loss: 3.6995, val_loss: 5.3072, lr: 0.003000, 5.63s
2024-05-01 14:55:23 INFO     epoch complete!
2024-05-01 14:55:23 INFO     evaluating now!
2024-05-01 14:55:24 INFO     Epoch [63/200] train_loss: 3.6316, val_loss: 5.1378, lr: 0.003000, 5.63s
2024-05-01 14:55:29 INFO     epoch complete!
2024-05-01 14:55:29 INFO     evaluating now!
2024-05-01 14:55:29 INFO     Epoch [64/200] train_loss: 3.6044, val_loss: 5.0479, lr: 0.003000, 5.51s
2024-05-01 14:55:34 INFO     epoch complete!
2024-05-01 14:55:34 INFO     evaluating now!
2024-05-01 14:55:35 INFO     Epoch [65/200] train_loss: 3.5558, val_loss: 5.0812, lr: 0.003000, 5.77s
2024-05-01 14:55:40 INFO     epoch complete!
2024-05-01 14:55:40 INFO     evaluating now!
2024-05-01 14:55:41 INFO     Epoch [66/200] train_loss: 3.5879, val_loss: 5.2588, lr: 0.003000, 5.88s
2024-05-01 14:55:46 INFO     epoch complete!
2024-05-01 14:55:46 INFO     evaluating now!
2024-05-01 14:55:46 INFO     Epoch [67/200] train_loss: 3.5872, val_loss: 5.1844, lr: 0.003000, 5.72s
2024-05-01 14:55:52 INFO     epoch complete!
2024-05-01 14:55:52 INFO     evaluating now!
2024-05-01 14:55:52 INFO     Epoch [68/200] train_loss: 3.5549, val_loss: 5.0622, lr: 0.003000, 5.92s
2024-05-01 14:55:58 INFO     epoch complete!
2024-05-01 14:55:58 INFO     evaluating now!
2024-05-01 14:55:59 INFO     Epoch [69/200] train_loss: 3.5790, val_loss: 5.1778, lr: 0.003000, 6.11s
2024-05-01 14:56:04 INFO     epoch complete!
2024-05-01 14:56:04 INFO     evaluating now!
2024-05-01 14:56:04 INFO     Epoch [70/200] train_loss: 3.5407, val_loss: 5.0934, lr: 0.003000, 5.81s
2024-05-01 14:56:10 INFO     epoch complete!
2024-05-01 14:56:10 INFO     evaluating now!
2024-05-01 14:56:10 INFO     Epoch [71/200] train_loss: 3.4872, val_loss: 5.1222, lr: 0.003000, 5.70s
2024-05-01 14:56:15 INFO     epoch complete!
2024-05-01 14:56:15 INFO     evaluating now!
2024-05-01 14:56:15 INFO     Epoch [72/200] train_loss: 3.5069, val_loss: 5.1498, lr: 0.003000, 5.42s
2024-05-01 14:56:21 INFO     epoch complete!
2024-05-01 14:56:21 INFO     evaluating now!
2024-05-01 14:56:21 INFO     Epoch [73/200] train_loss: 3.4573, val_loss: 5.1338, lr: 0.003000, 5.45s
2024-05-01 14:56:26 INFO     epoch complete!
2024-05-01 14:56:26 INFO     evaluating now!
2024-05-01 14:56:27 INFO     Epoch [74/200] train_loss: 3.4552, val_loss: 5.1581, lr: 0.003000, 5.70s
2024-05-01 14:56:32 INFO     epoch complete!
2024-05-01 14:56:32 INFO     evaluating now!
2024-05-01 14:56:32 INFO     Epoch [75/200] train_loss: 3.4340, val_loss: 5.1309, lr: 0.003000, 5.61s
2024-05-01 14:56:32 WARNING  Early stopping at epoch: 75
2024-05-01 14:56:32 INFO     Trained totally 76 epochs, average train time is 5.306s, average eval time is 0.369s
2024-05-01 14:56:32 INFO     Loaded model at 60
2024-05-01 14:56:32 INFO     Saved model at ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406.m
2024-05-01 14:56:32 INFO     Start evaluating ...
2024-05-01 14:56:34 INFO     Note that you select the single mode to evaluate!
2024-05-01 14:56:34 INFO     Evaluate result is saved at ./libcity/cache/19/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-05-01 14:56:34 INFO     
         MAE       RMSE
1   2.410403   7.077951
2   2.468051   7.687672
3   2.636554   8.821804
4   2.792618   9.515006
5   2.918010  10.441222
6   3.073080  11.119098
7   3.165467  11.775049
8   3.233586  12.215870
9   3.265465  12.529058
10  3.296862  12.683839
11  3.299062  12.967448
12  3.384206  13.435404
2024-05-01 14:56:34 INFO     ----------------------------------------------------------------------------
2024-05-01 14:56:34 INFO     Kownledge Graph Embedding: GIE, Experiment ids: [15, 16, 17, 18, 19]
2024-05-01 14:56:34 INFO     ----------------------------------------------------------------------------
2024-05-01 14:56:34 INFO     Average: 
         MAE       RMSE
0   2.364012   7.125533
1   2.465106   7.729456
2   2.623491   8.744741
3   2.795598   9.552252
4   2.938587  10.455468
5   3.070483  11.277737
6   3.177072  11.955476
7   3.243668  12.423890
8   3.260482  12.751245
9   3.300064  12.942036
10  3.388163  13.307205
11  3.464080  13.899357 
2024-05-01 14:56:34 INFO     Standard deviation: 
         MAE      RMSE
0   0.082321  0.144021
1   0.073176  0.080762
2   0.065555  0.066798
3   0.073264  0.147431
4   0.104716  0.303538
5   0.096705  0.448305
6   0.078119  0.535455
7   0.029755  0.564781
8   0.030702  0.519270
9   0.030661  0.476489
10  0.073067  0.499739
11  0.059929  0.561455
2024-05-01 14:56:34 INFO     ----------------------------------------------------------------------------
2024-05-01 14:56:34 INFO     12 steps Average: 
        MAE     RMSE
0  3.007567  11.0137
2024-05-01 14:56:34 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.066497  0.362337
