2024-04-30 23:02:24 INFO     ----------------------------------------------------------------------------
2024-04-30 23:02:24 INFO     # 0, Kownledge Graph Embedding: AttH, Experiment ids: 50
2024-04-30 23:02:24 INFO     ----------------------------------------------------------------------------
2024-04-30 23:02:24 INFO     Log directory: ./libcity/log
2024-04-30 23:02:24 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=50
2024-04-30 23:02:24 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 561554450, 'exp_id': 50, 'load_external': True, 'embedding_model': 'AttH', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 23:02:25 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 23:02:25 INFO     set_weight_link_or_dist: dist
2024-04-30 23:02:25 INFO     init_weight_inf_or_zero: inf
2024-04-30 23:02:25 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 23:02:25 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 23:02:25 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 23:02:25 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 23:02:28 INFO     Dataset created
2024-04-30 23:02:28 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 23:02:28 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 23:02:28 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 23:02:28 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 23:02:28 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 23:02:28 INFO     NoneScaler
2024-04-30 23:02:33 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 23:02:33 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 23:02:33 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 23:02:33 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 23:02:33 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 23:02:33 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 23:02:33 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 23:02:33 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 23:02:33 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 23:02:33 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 23:02:33 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 23:02:33 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 23:02:33 INFO     Total parameter numbers: 874010
2024-04-30 23:02:33 INFO     You select `adam` optimizer.
2024-04-30 23:02:33 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 23:02:33 INFO     Start training ...
2024-04-30 23:02:33 INFO     num_batches:48
2024-04-30 23:02:39 INFO     epoch complete!
2024-04-30 23:02:39 INFO     evaluating now!
2024-04-30 23:02:40 INFO     Epoch [0/200] train_loss: 24.3142, val_loss: 17.9207, lr: 0.003000, 7.27s
2024-04-30 23:02:40 INFO     Saved model at 0
2024-04-30 23:02:40 INFO     Val loss decrease from inf to 17.9207, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 23:02:46 INFO     epoch complete!
2024-04-30 23:02:46 INFO     evaluating now!
2024-04-30 23:02:47 INFO     Epoch [1/200] train_loss: 14.6419, val_loss: 14.1915, lr: 0.003000, 6.75s
2024-04-30 23:02:47 INFO     Saved model at 1
2024-04-30 23:02:47 INFO     Val loss decrease from 17.9207 to 14.1915, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 23:02:53 INFO     epoch complete!
2024-04-30 23:02:53 INFO     evaluating now!
2024-04-30 23:02:53 INFO     Epoch [2/200] train_loss: 11.7042, val_loss: 11.0824, lr: 0.003000, 6.74s
2024-04-30 23:02:53 INFO     Saved model at 2
2024-04-30 23:02:53 INFO     Val loss decrease from 14.1915 to 11.0824, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 23:03:00 INFO     epoch complete!
2024-04-30 23:03:00 INFO     evaluating now!
2024-04-30 23:03:00 INFO     Epoch [3/200] train_loss: 9.5041, val_loss: 9.3463, lr: 0.003000, 6.72s
2024-04-30 23:03:00 INFO     Saved model at 3
2024-04-30 23:03:00 INFO     Val loss decrease from 11.0824 to 9.3463, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 23:03:06 INFO     epoch complete!
2024-04-30 23:03:06 INFO     evaluating now!
2024-04-30 23:03:07 INFO     Epoch [4/200] train_loss: 8.1812, val_loss: 7.8095, lr: 0.003000, 6.71s
2024-04-30 23:03:07 INFO     Saved model at 4
2024-04-30 23:03:07 INFO     Val loss decrease from 9.3463 to 7.8095, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 23:03:13 INFO     epoch complete!
2024-04-30 23:03:13 INFO     evaluating now!
2024-04-30 23:03:14 INFO     Epoch [5/200] train_loss: 7.4273, val_loss: 7.2613, lr: 0.003000, 6.69s
2024-04-30 23:03:14 INFO     Saved model at 5
2024-04-30 23:03:14 INFO     Val loss decrease from 7.8095 to 7.2613, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 23:03:20 INFO     epoch complete!
2024-04-30 23:03:20 INFO     evaluating now!
2024-04-30 23:03:20 INFO     Epoch [6/200] train_loss: 6.8612, val_loss: 6.8390, lr: 0.003000, 6.73s
2024-04-30 23:03:20 INFO     Saved model at 6
2024-04-30 23:03:20 INFO     Val loss decrease from 7.2613 to 6.8390, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 23:03:27 INFO     epoch complete!
2024-04-30 23:03:27 INFO     evaluating now!
2024-04-30 23:03:27 INFO     Epoch [7/200] train_loss: 6.4269, val_loss: 6.5877, lr: 0.003000, 6.78s
2024-04-30 23:03:27 INFO     Saved model at 7
2024-04-30 23:03:27 INFO     Val loss decrease from 6.8390 to 6.5877, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 23:03:34 INFO     epoch complete!
2024-04-30 23:03:34 INFO     evaluating now!
2024-04-30 23:03:34 INFO     Epoch [8/200] train_loss: 6.1898, val_loss: 6.2290, lr: 0.003000, 6.71s
2024-04-30 23:03:34 INFO     Saved model at 8
2024-04-30 23:03:34 INFO     Val loss decrease from 6.5877 to 6.2290, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 23:03:40 INFO     epoch complete!
2024-04-30 23:03:40 INFO     evaluating now!
2024-04-30 23:03:41 INFO     Epoch [9/200] train_loss: 5.9566, val_loss: 6.1447, lr: 0.003000, 6.70s
2024-04-30 23:03:41 INFO     Saved model at 9
2024-04-30 23:03:41 INFO     Val loss decrease from 6.2290 to 6.1447, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 23:03:47 INFO     epoch complete!
2024-04-30 23:03:47 INFO     evaluating now!
2024-04-30 23:03:47 INFO     Epoch [10/200] train_loss: 5.7903, val_loss: 5.8917, lr: 0.003000, 6.72s
2024-04-30 23:03:48 INFO     Saved model at 10
2024-04-30 23:03:48 INFO     Val loss decrease from 6.1447 to 5.8917, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 23:03:54 INFO     epoch complete!
2024-04-30 23:03:54 INFO     evaluating now!
2024-04-30 23:03:54 INFO     Epoch [11/200] train_loss: 5.5944, val_loss: 6.0253, lr: 0.003000, 6.75s
2024-04-30 23:04:01 INFO     epoch complete!
2024-04-30 23:04:01 INFO     evaluating now!
2024-04-30 23:04:01 INFO     Epoch [12/200] train_loss: 5.4899, val_loss: 5.8883, lr: 0.003000, 6.76s
2024-04-30 23:04:01 INFO     Saved model at 12
2024-04-30 23:04:01 INFO     Val loss decrease from 5.8917 to 5.8883, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 23:04:07 INFO     epoch complete!
2024-04-30 23:04:07 INFO     evaluating now!
2024-04-30 23:04:08 INFO     Epoch [13/200] train_loss: 5.3783, val_loss: 5.5472, lr: 0.003000, 6.85s
2024-04-30 23:04:08 INFO     Saved model at 13
2024-04-30 23:04:08 INFO     Val loss decrease from 5.8883 to 5.5472, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 23:04:14 INFO     epoch complete!
2024-04-30 23:04:14 INFO     evaluating now!
2024-04-30 23:04:15 INFO     Epoch [14/200] train_loss: 5.2676, val_loss: 5.5930, lr: 0.003000, 6.73s
2024-04-30 23:04:21 INFO     epoch complete!
2024-04-30 23:04:21 INFO     evaluating now!
2024-04-30 23:04:21 INFO     Epoch [15/200] train_loss: 5.1722, val_loss: 5.5250, lr: 0.003000, 6.75s
2024-04-30 23:04:21 INFO     Saved model at 15
2024-04-30 23:04:21 INFO     Val loss decrease from 5.5472 to 5.5250, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 23:04:28 INFO     epoch complete!
2024-04-30 23:04:28 INFO     evaluating now!
2024-04-30 23:04:28 INFO     Epoch [16/200] train_loss: 5.1043, val_loss: 5.2664, lr: 0.003000, 6.89s
2024-04-30 23:04:28 INFO     Saved model at 16
2024-04-30 23:04:28 INFO     Val loss decrease from 5.5250 to 5.2664, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 23:04:35 INFO     epoch complete!
2024-04-30 23:04:35 INFO     evaluating now!
2024-04-30 23:04:36 INFO     Epoch [17/200] train_loss: 4.9807, val_loss: 5.4691, lr: 0.003000, 7.37s
2024-04-30 23:04:42 INFO     epoch complete!
2024-04-30 23:04:42 INFO     evaluating now!
2024-04-30 23:04:43 INFO     Epoch [18/200] train_loss: 4.9500, val_loss: 5.3501, lr: 0.003000, 6.91s
2024-04-30 23:04:48 INFO     epoch complete!
2024-04-30 23:04:48 INFO     evaluating now!
2024-04-30 23:04:49 INFO     Epoch [19/200] train_loss: 4.8353, val_loss: 5.6173, lr: 0.003000, 6.06s
2024-04-30 23:04:54 INFO     epoch complete!
2024-04-30 23:04:54 INFO     evaluating now!
2024-04-30 23:04:55 INFO     Epoch [20/200] train_loss: 4.8894, val_loss: 5.3647, lr: 0.003000, 6.01s
2024-04-30 23:05:00 INFO     epoch complete!
2024-04-30 23:05:00 INFO     evaluating now!
2024-04-30 23:05:01 INFO     Epoch [21/200] train_loss: 4.8346, val_loss: 5.1754, lr: 0.003000, 6.13s
2024-04-30 23:05:01 INFO     Saved model at 21
2024-04-30 23:05:01 INFO     Val loss decrease from 5.2664 to 5.1754, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-30 23:05:07 INFO     epoch complete!
2024-04-30 23:05:07 INFO     evaluating now!
2024-04-30 23:05:07 INFO     Epoch [22/200] train_loss: 4.7349, val_loss: 5.3722, lr: 0.003000, 6.28s
2024-04-30 23:05:13 INFO     epoch complete!
2024-04-30 23:05:13 INFO     evaluating now!
2024-04-30 23:05:13 INFO     Epoch [23/200] train_loss: 4.6588, val_loss: 5.1969, lr: 0.003000, 6.22s
2024-04-30 23:05:19 INFO     epoch complete!
2024-04-30 23:05:19 INFO     evaluating now!
2024-04-30 23:05:20 INFO     Epoch [24/200] train_loss: 4.5406, val_loss: 5.2351, lr: 0.003000, 6.25s
2024-04-30 23:05:26 INFO     epoch complete!
2024-04-30 23:05:26 INFO     evaluating now!
2024-04-30 23:05:26 INFO     Epoch [25/200] train_loss: 4.5269, val_loss: 5.4120, lr: 0.003000, 6.39s
2024-04-30 23:05:32 INFO     epoch complete!
2024-04-30 23:05:32 INFO     evaluating now!
2024-04-30 23:05:33 INFO     Epoch [26/200] train_loss: 4.5356, val_loss: 5.0791, lr: 0.003000, 6.64s
2024-04-30 23:05:33 INFO     Saved model at 26
2024-04-30 23:05:33 INFO     Val loss decrease from 5.1754 to 5.0791, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-04-30 23:05:39 INFO     epoch complete!
2024-04-30 23:05:39 INFO     evaluating now!
2024-04-30 23:05:39 INFO     Epoch [27/200] train_loss: 4.4665, val_loss: 5.1257, lr: 0.003000, 6.29s
2024-04-30 23:05:45 INFO     epoch complete!
2024-04-30 23:05:45 INFO     evaluating now!
2024-04-30 23:05:45 INFO     Epoch [28/200] train_loss: 4.4104, val_loss: 5.1520, lr: 0.003000, 6.29s
2024-04-30 23:05:51 INFO     epoch complete!
2024-04-30 23:05:51 INFO     evaluating now!
2024-04-30 23:05:52 INFO     Epoch [29/200] train_loss: 4.3645, val_loss: 5.2072, lr: 0.003000, 6.53s
2024-04-30 23:05:58 INFO     epoch complete!
2024-04-30 23:05:58 INFO     evaluating now!
2024-04-30 23:05:58 INFO     Epoch [30/200] train_loss: 4.2940, val_loss: 4.9898, lr: 0.003000, 6.29s
2024-04-30 23:05:58 INFO     Saved model at 30
2024-04-30 23:05:58 INFO     Val loss decrease from 5.0791 to 4.9898, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-04-30 23:06:04 INFO     epoch complete!
2024-04-30 23:06:04 INFO     evaluating now!
2024-04-30 23:06:04 INFO     Epoch [31/200] train_loss: 4.2843, val_loss: 5.0463, lr: 0.003000, 6.26s
2024-04-30 23:06:11 INFO     epoch complete!
2024-04-30 23:06:11 INFO     evaluating now!
2024-04-30 23:06:11 INFO     Epoch [32/200] train_loss: 4.2441, val_loss: 5.2553, lr: 0.003000, 6.74s
2024-04-30 23:06:17 INFO     epoch complete!
2024-04-30 23:06:17 INFO     evaluating now!
2024-04-30 23:06:18 INFO     Epoch [33/200] train_loss: 4.2594, val_loss: 5.0289, lr: 0.003000, 6.37s
2024-04-30 23:06:24 INFO     epoch complete!
2024-04-30 23:06:24 INFO     evaluating now!
2024-04-30 23:06:24 INFO     Epoch [34/200] train_loss: 4.1636, val_loss: 5.0460, lr: 0.003000, 6.47s
2024-04-30 23:06:31 INFO     epoch complete!
2024-04-30 23:06:31 INFO     evaluating now!
2024-04-30 23:06:31 INFO     Epoch [35/200] train_loss: 4.1502, val_loss: 5.1906, lr: 0.003000, 7.12s
2024-04-30 23:06:38 INFO     epoch complete!
2024-04-30 23:06:38 INFO     evaluating now!
2024-04-30 23:06:39 INFO     Epoch [36/200] train_loss: 4.1450, val_loss: 5.2348, lr: 0.003000, 7.48s
2024-04-30 23:06:46 INFO     epoch complete!
2024-04-30 23:06:46 INFO     evaluating now!
2024-04-30 23:06:46 INFO     Epoch [37/200] train_loss: 4.0918, val_loss: 5.0316, lr: 0.003000, 7.53s
2024-04-30 23:06:53 INFO     epoch complete!
2024-04-30 23:06:53 INFO     evaluating now!
2024-04-30 23:06:54 INFO     Epoch [38/200] train_loss: 4.0339, val_loss: 5.1201, lr: 0.003000, 7.50s
2024-04-30 23:07:01 INFO     epoch complete!
2024-04-30 23:07:01 INFO     evaluating now!
2024-04-30 23:07:01 INFO     Epoch [39/200] train_loss: 4.0256, val_loss: 4.9679, lr: 0.003000, 7.41s
2024-04-30 23:07:01 INFO     Saved model at 39
2024-04-30 23:07:01 INFO     Val loss decrease from 4.9898 to 4.9679, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-04-30 23:07:08 INFO     epoch complete!
2024-04-30 23:07:08 INFO     evaluating now!
2024-04-30 23:07:08 INFO     Epoch [40/200] train_loss: 4.0076, val_loss: 5.0902, lr: 0.003000, 7.31s
2024-04-30 23:07:15 INFO     epoch complete!
2024-04-30 23:07:15 INFO     evaluating now!
2024-04-30 23:07:16 INFO     Epoch [41/200] train_loss: 3.9869, val_loss: 5.1187, lr: 0.003000, 7.37s
2024-04-30 23:07:23 INFO     epoch complete!
2024-04-30 23:07:23 INFO     evaluating now!
2024-04-30 23:07:23 INFO     Epoch [42/200] train_loss: 3.9801, val_loss: 5.0751, lr: 0.003000, 7.29s
2024-04-30 23:07:30 INFO     epoch complete!
2024-04-30 23:07:30 INFO     evaluating now!
2024-04-30 23:07:31 INFO     Epoch [43/200] train_loss: 3.9669, val_loss: 5.0622, lr: 0.003000, 7.41s
2024-04-30 23:07:37 INFO     epoch complete!
2024-04-30 23:07:37 INFO     evaluating now!
2024-04-30 23:07:38 INFO     Epoch [44/200] train_loss: 3.8869, val_loss: 5.0473, lr: 0.003000, 7.35s
2024-04-30 23:07:45 INFO     epoch complete!
2024-04-30 23:07:45 INFO     evaluating now!
2024-04-30 23:07:45 INFO     Epoch [45/200] train_loss: 3.9310, val_loss: 5.1207, lr: 0.003000, 7.34s
2024-04-30 23:07:52 INFO     epoch complete!
2024-04-30 23:07:52 INFO     evaluating now!
2024-04-30 23:07:53 INFO     Epoch [46/200] train_loss: 3.8734, val_loss: 5.0071, lr: 0.003000, 7.32s
2024-04-30 23:07:59 INFO     epoch complete!
2024-04-30 23:07:59 INFO     evaluating now!
2024-04-30 23:08:00 INFO     Epoch [47/200] train_loss: 3.8286, val_loss: 5.2085, lr: 0.003000, 7.39s
2024-04-30 23:08:06 INFO     epoch complete!
2024-04-30 23:08:06 INFO     evaluating now!
2024-04-30 23:08:07 INFO     Epoch [48/200] train_loss: 3.8598, val_loss: 4.9582, lr: 0.003000, 6.85s
2024-04-30 23:08:10 INFO     Saved model at 48
2024-04-30 23:08:10 INFO     Val loss decrease from 4.9679 to 4.9582, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-04-30 23:08:17 INFO     epoch complete!
2024-04-30 23:08:17 INFO     evaluating now!
2024-04-30 23:08:17 INFO     Epoch [49/200] train_loss: 3.8032, val_loss: 4.9472, lr: 0.003000, 7.27s
2024-04-30 23:08:17 INFO     Saved model at 49
2024-04-30 23:08:17 INFO     Val loss decrease from 4.9582 to 4.9472, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-04-30 23:08:24 INFO     epoch complete!
2024-04-30 23:08:24 INFO     evaluating now!
2024-04-30 23:08:25 INFO     Epoch [50/200] train_loss: 3.8271, val_loss: 5.1102, lr: 0.003000, 7.30s
2024-04-30 23:08:32 INFO     epoch complete!
2024-04-30 23:08:32 INFO     evaluating now!
2024-04-30 23:08:32 INFO     Epoch [51/200] train_loss: 3.7531, val_loss: 4.8885, lr: 0.003000, 7.49s
2024-04-30 23:08:32 INFO     Saved model at 51
2024-04-30 23:08:32 INFO     Val loss decrease from 4.9472 to 4.8885, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch51.tar
2024-04-30 23:08:39 INFO     epoch complete!
2024-04-30 23:08:39 INFO     evaluating now!
2024-04-30 23:08:39 INFO     Epoch [52/200] train_loss: 3.7335, val_loss: 5.0698, lr: 0.003000, 7.35s
2024-04-30 23:08:46 INFO     epoch complete!
2024-04-30 23:08:46 INFO     evaluating now!
2024-04-30 23:08:47 INFO     Epoch [53/200] train_loss: 3.7564, val_loss: 4.8800, lr: 0.003000, 7.25s
2024-04-30 23:08:47 INFO     Saved model at 53
2024-04-30 23:08:47 INFO     Val loss decrease from 4.8885 to 4.8800, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch53.tar
2024-04-30 23:08:54 INFO     epoch complete!
2024-04-30 23:08:54 INFO     evaluating now!
2024-04-30 23:08:54 INFO     Epoch [54/200] train_loss: 3.6788, val_loss: 4.9314, lr: 0.003000, 7.44s
2024-04-30 23:09:01 INFO     epoch complete!
2024-04-30 23:09:01 INFO     evaluating now!
2024-04-30 23:09:02 INFO     Epoch [55/200] train_loss: 3.6693, val_loss: 4.8688, lr: 0.003000, 7.30s
2024-04-30 23:09:02 INFO     Saved model at 55
2024-04-30 23:09:02 INFO     Val loss decrease from 4.8800 to 4.8688, saving to ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406_epoch55.tar
2024-04-30 23:09:08 INFO     epoch complete!
2024-04-30 23:09:08 INFO     evaluating now!
2024-04-30 23:09:09 INFO     Epoch [56/200] train_loss: 3.6391, val_loss: 4.9903, lr: 0.003000, 7.40s
2024-04-30 23:09:16 INFO     epoch complete!
2024-04-30 23:09:16 INFO     evaluating now!
2024-04-30 23:09:16 INFO     Epoch [57/200] train_loss: 3.6266, val_loss: 5.0506, lr: 0.003000, 7.35s
2024-04-30 23:09:23 INFO     epoch complete!
2024-04-30 23:09:23 INFO     evaluating now!
2024-04-30 23:09:24 INFO     Epoch [58/200] train_loss: 3.6167, val_loss: 5.0296, lr: 0.003000, 7.32s
2024-04-30 23:09:30 INFO     epoch complete!
2024-04-30 23:09:30 INFO     evaluating now!
2024-04-30 23:09:31 INFO     Epoch [59/200] train_loss: 3.6145, val_loss: 5.0435, lr: 0.003000, 7.39s
2024-04-30 23:09:38 INFO     epoch complete!
2024-04-30 23:09:38 INFO     evaluating now!
2024-04-30 23:09:39 INFO     Epoch [60/200] train_loss: 3.5605, val_loss: 4.8792, lr: 0.003000, 7.50s
2024-04-30 23:09:45 INFO     epoch complete!
2024-04-30 23:09:45 INFO     evaluating now!
2024-04-30 23:09:46 INFO     Epoch [61/200] train_loss: 3.5741, val_loss: 4.9079, lr: 0.003000, 7.32s
2024-04-30 23:09:53 INFO     epoch complete!
2024-04-30 23:09:53 INFO     evaluating now!
2024-04-30 23:09:53 INFO     Epoch [62/200] train_loss: 3.5861, val_loss: 4.9610, lr: 0.003000, 7.31s
2024-04-30 23:10:00 INFO     epoch complete!
2024-04-30 23:10:00 INFO     evaluating now!
2024-04-30 23:10:01 INFO     Epoch [63/200] train_loss: 3.5160, val_loss: 4.9305, lr: 0.003000, 7.35s
2024-04-30 23:10:07 INFO     epoch complete!
2024-04-30 23:10:07 INFO     evaluating now!
2024-04-30 23:10:08 INFO     Epoch [64/200] train_loss: 3.5507, val_loss: 4.9638, lr: 0.003000, 7.48s
2024-04-30 23:10:15 INFO     epoch complete!
2024-04-30 23:10:15 INFO     evaluating now!
2024-04-30 23:10:15 INFO     Epoch [65/200] train_loss: 3.5798, val_loss: 5.0438, lr: 0.003000, 7.30s
2024-04-30 23:10:22 INFO     epoch complete!
2024-04-30 23:10:22 INFO     evaluating now!
2024-04-30 23:10:23 INFO     Epoch [66/200] train_loss: 3.5774, val_loss: 4.9927, lr: 0.003000, 7.21s
2024-04-30 23:10:29 INFO     epoch complete!
2024-04-30 23:10:29 INFO     evaluating now!
2024-04-30 23:10:30 INFO     Epoch [67/200] train_loss: 3.5189, val_loss: 4.9628, lr: 0.003000, 7.33s
2024-04-30 23:10:37 INFO     epoch complete!
2024-04-30 23:10:37 INFO     evaluating now!
2024-04-30 23:10:37 INFO     Epoch [68/200] train_loss: 3.5282, val_loss: 5.0544, lr: 0.003000, 7.38s
2024-04-30 23:10:44 INFO     epoch complete!
2024-04-30 23:10:44 INFO     evaluating now!
2024-04-30 23:10:45 INFO     Epoch [69/200] train_loss: 3.4401, val_loss: 4.9418, lr: 0.003000, 7.30s
2024-04-30 23:10:52 INFO     epoch complete!
2024-04-30 23:10:52 INFO     evaluating now!
2024-04-30 23:10:52 INFO     Epoch [70/200] train_loss: 3.4835, val_loss: 4.9549, lr: 0.003000, 7.85s
2024-04-30 23:10:52 WARNING  Early stopping at epoch: 70
2024-04-30 23:10:52 INFO     Trained totally 71 epochs, average train time is 6.501s, average eval time is 0.478s
2024-04-30 23:10:52 INFO     Loaded model at 55
2024-04-30 23:10:52 INFO     Saved model at ./libcity/cache/50/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 23:10:52 INFO     Start evaluating ...
2024-04-30 23:10:54 INFO     Note that you select the single mode to evaluate!
2024-04-30 23:10:54 INFO     Evaluate result is saved at ./libcity/cache/50/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 23:10:54 INFO     
         MAE       RMSE
1   2.445912   7.898490
2   2.573001   8.158762
3   2.664712   8.709254
4   2.857024   9.313018
5   3.019617  10.196138
6   3.073117  11.180167
7   3.262402  12.119557
8   3.277073  12.671382
9   3.318181  12.977026
10  3.371814  13.292348
11  3.483089  13.740843
12  3.636805  14.633424
2024-04-30 23:10:54 INFO     ----------------------------------------------------------------------------
2024-04-30 23:10:54 INFO     # 1, Kownledge Graph Embedding: AttH, Experiment ids: 51
2024-04-30 23:10:54 INFO     ----------------------------------------------------------------------------
2024-04-30 23:10:54 INFO     Log directory: ./libcity/log
2024-04-30 23:10:54 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=51
2024-04-30 23:10:54 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 936240420, 'exp_id': 51, 'load_external': True, 'embedding_model': 'AttH', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 23:10:54 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 23:10:54 INFO     set_weight_link_or_dist: dist
2024-04-30 23:10:54 INFO     init_weight_inf_or_zero: inf
2024-04-30 23:10:54 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 23:10:54 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 23:10:54 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 23:10:55 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 23:10:58 INFO     Dataset created
2024-04-30 23:10:58 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 23:10:58 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 23:10:58 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 23:10:58 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 23:10:58 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 23:10:58 INFO     NoneScaler
2024-04-30 23:11:00 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 23:11:00 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 23:11:00 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 23:11:00 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 23:11:00 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 23:11:00 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 23:11:00 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 23:11:00 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 23:11:00 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 23:11:00 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 23:11:00 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 23:11:00 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 23:11:00 INFO     Total parameter numbers: 874010
2024-04-30 23:11:00 INFO     You select `adam` optimizer.
2024-04-30 23:11:00 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 23:11:00 INFO     Start training ...
2024-04-30 23:11:00 INFO     num_batches:48
2024-04-30 23:11:07 INFO     epoch complete!
2024-04-30 23:11:07 INFO     evaluating now!
2024-04-30 23:11:07 INFO     Epoch [0/200] train_loss: 24.9986, val_loss: 17.9072, lr: 0.003000, 7.39s
2024-04-30 23:11:07 INFO     Saved model at 0
2024-04-30 23:11:07 INFO     Val loss decrease from inf to 17.9072, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 23:11:14 INFO     epoch complete!
2024-04-30 23:11:14 INFO     evaluating now!
2024-04-30 23:11:15 INFO     Epoch [1/200] train_loss: 14.6791, val_loss: 14.0298, lr: 0.003000, 7.09s
2024-04-30 23:11:15 INFO     Saved model at 1
2024-04-30 23:11:15 INFO     Val loss decrease from 17.9072 to 14.0298, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 23:11:21 INFO     epoch complete!
2024-04-30 23:11:21 INFO     evaluating now!
2024-04-30 23:11:22 INFO     Epoch [2/200] train_loss: 11.5946, val_loss: 11.1105, lr: 0.003000, 7.09s
2024-04-30 23:11:22 INFO     Saved model at 2
2024-04-30 23:11:22 INFO     Val loss decrease from 14.0298 to 11.1105, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 23:11:28 INFO     epoch complete!
2024-04-30 23:11:28 INFO     evaluating now!
2024-04-30 23:11:29 INFO     Epoch [3/200] train_loss: 9.4851, val_loss: 9.0019, lr: 0.003000, 7.00s
2024-04-30 23:11:29 INFO     Saved model at 3
2024-04-30 23:11:29 INFO     Val loss decrease from 11.1105 to 9.0019, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 23:11:35 INFO     epoch complete!
2024-04-30 23:11:35 INFO     evaluating now!
2024-04-30 23:11:36 INFO     Epoch [4/200] train_loss: 8.3008, val_loss: 7.7906, lr: 0.003000, 6.99s
2024-04-30 23:11:36 INFO     Saved model at 4
2024-04-30 23:11:36 INFO     Val loss decrease from 9.0019 to 7.7906, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 23:11:42 INFO     epoch complete!
2024-04-30 23:11:42 INFO     evaluating now!
2024-04-30 23:11:43 INFO     Epoch [5/200] train_loss: 7.6022, val_loss: 7.4545, lr: 0.003000, 7.09s
2024-04-30 23:11:43 INFO     Saved model at 5
2024-04-30 23:11:43 INFO     Val loss decrease from 7.7906 to 7.4545, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 23:11:50 INFO     epoch complete!
2024-04-30 23:11:50 INFO     evaluating now!
2024-04-30 23:11:50 INFO     Epoch [6/200] train_loss: 6.9267, val_loss: 6.9493, lr: 0.003000, 7.55s
2024-04-30 23:11:51 INFO     Saved model at 6
2024-04-30 23:11:51 INFO     Val loss decrease from 7.4545 to 6.9493, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 23:11:58 INFO     epoch complete!
2024-04-30 23:11:58 INFO     evaluating now!
2024-04-30 23:11:58 INFO     Epoch [7/200] train_loss: 6.4497, val_loss: 6.5766, lr: 0.003000, 7.56s
2024-04-30 23:11:58 INFO     Saved model at 7
2024-04-30 23:11:58 INFO     Val loss decrease from 6.9493 to 6.5766, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 23:12:05 INFO     epoch complete!
2024-04-30 23:12:05 INFO     evaluating now!
2024-04-30 23:12:05 INFO     Epoch [8/200] train_loss: 6.2277, val_loss: 6.4138, lr: 0.003000, 7.25s
2024-04-30 23:12:05 INFO     Saved model at 8
2024-04-30 23:12:05 INFO     Val loss decrease from 6.5766 to 6.4138, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 23:12:12 INFO     epoch complete!
2024-04-30 23:12:12 INFO     evaluating now!
2024-04-30 23:12:13 INFO     Epoch [9/200] train_loss: 5.9448, val_loss: 6.1553, lr: 0.003000, 7.34s
2024-04-30 23:12:13 INFO     Saved model at 9
2024-04-30 23:12:13 INFO     Val loss decrease from 6.4138 to 6.1553, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 23:12:20 INFO     epoch complete!
2024-04-30 23:12:20 INFO     evaluating now!
2024-04-30 23:12:20 INFO     Epoch [10/200] train_loss: 5.7939, val_loss: 6.0373, lr: 0.003000, 7.40s
2024-04-30 23:12:20 INFO     Saved model at 10
2024-04-30 23:12:20 INFO     Val loss decrease from 6.1553 to 6.0373, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 23:12:27 INFO     epoch complete!
2024-04-30 23:12:27 INFO     evaluating now!
2024-04-30 23:12:28 INFO     Epoch [11/200] train_loss: 5.6579, val_loss: 5.8728, lr: 0.003000, 7.63s
2024-04-30 23:12:28 INFO     Saved model at 11
2024-04-30 23:12:28 INFO     Val loss decrease from 6.0373 to 5.8728, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 23:12:35 INFO     epoch complete!
2024-04-30 23:12:35 INFO     evaluating now!
2024-04-30 23:12:35 INFO     Epoch [12/200] train_loss: 5.4855, val_loss: 6.0871, lr: 0.003000, 7.51s
2024-04-30 23:12:42 INFO     epoch complete!
2024-04-30 23:12:42 INFO     evaluating now!
2024-04-30 23:12:43 INFO     Epoch [13/200] train_loss: 5.4100, val_loss: 5.8743, lr: 0.003000, 7.38s
2024-04-30 23:12:50 INFO     epoch complete!
2024-04-30 23:12:50 INFO     evaluating now!
2024-04-30 23:12:50 INFO     Epoch [14/200] train_loss: 5.2958, val_loss: 5.6908, lr: 0.003000, 7.35s
2024-04-30 23:12:50 INFO     Saved model at 14
2024-04-30 23:12:50 INFO     Val loss decrease from 5.8728 to 5.6908, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 23:12:57 INFO     epoch complete!
2024-04-30 23:12:57 INFO     evaluating now!
2024-04-30 23:12:58 INFO     Epoch [15/200] train_loss: 5.2686, val_loss: 5.7868, lr: 0.003000, 7.40s
2024-04-30 23:13:04 INFO     epoch complete!
2024-04-30 23:13:04 INFO     evaluating now!
2024-04-30 23:13:05 INFO     Epoch [16/200] train_loss: 5.0881, val_loss: 5.4525, lr: 0.003000, 7.38s
2024-04-30 23:13:05 INFO     Saved model at 16
2024-04-30 23:13:05 INFO     Val loss decrease from 5.6908 to 5.4525, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-30 23:13:12 INFO     epoch complete!
2024-04-30 23:13:12 INFO     evaluating now!
2024-04-30 23:13:12 INFO     Epoch [17/200] train_loss: 4.9926, val_loss: 5.5524, lr: 0.003000, 7.36s
2024-04-30 23:13:19 INFO     epoch complete!
2024-04-30 23:13:19 INFO     evaluating now!
2024-04-30 23:13:20 INFO     Epoch [18/200] train_loss: 4.9605, val_loss: 5.4852, lr: 0.003000, 7.49s
2024-04-30 23:13:27 INFO     epoch complete!
2024-04-30 23:13:27 INFO     evaluating now!
2024-04-30 23:13:27 INFO     Epoch [19/200] train_loss: 4.8468, val_loss: 5.4707, lr: 0.003000, 7.36s
2024-04-30 23:13:34 INFO     epoch complete!
2024-04-30 23:13:34 INFO     evaluating now!
2024-04-30 23:13:35 INFO     Epoch [20/200] train_loss: 4.7741, val_loss: 5.3472, lr: 0.003000, 7.39s
2024-04-30 23:13:35 INFO     Saved model at 20
2024-04-30 23:13:35 INFO     Val loss decrease from 5.4525 to 5.3472, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-30 23:13:42 INFO     epoch complete!
2024-04-30 23:13:42 INFO     evaluating now!
2024-04-30 23:13:42 INFO     Epoch [21/200] train_loss: 4.7538, val_loss: 5.5199, lr: 0.003000, 7.33s
2024-04-30 23:13:49 INFO     epoch complete!
2024-04-30 23:13:49 INFO     evaluating now!
2024-04-30 23:13:49 INFO     Epoch [22/200] train_loss: 4.6881, val_loss: 5.4216, lr: 0.003000, 7.30s
2024-04-30 23:13:56 INFO     epoch complete!
2024-04-30 23:13:56 INFO     evaluating now!
2024-04-30 23:13:57 INFO     Epoch [23/200] train_loss: 4.6692, val_loss: 5.2321, lr: 0.003000, 7.54s
2024-04-30 23:13:57 INFO     Saved model at 23
2024-04-30 23:13:57 INFO     Val loss decrease from 5.3472 to 5.2321, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-30 23:14:04 INFO     epoch complete!
2024-04-30 23:14:04 INFO     evaluating now!
2024-04-30 23:14:04 INFO     Epoch [24/200] train_loss: 4.6206, val_loss: 5.4036, lr: 0.003000, 7.43s
2024-04-30 23:14:11 INFO     epoch complete!
2024-04-30 23:14:11 INFO     evaluating now!
2024-04-30 23:14:12 INFO     Epoch [25/200] train_loss: 4.4938, val_loss: 5.1776, lr: 0.003000, 7.52s
2024-04-30 23:14:12 INFO     Saved model at 25
2024-04-30 23:14:12 INFO     Val loss decrease from 5.2321 to 5.1776, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-30 23:14:19 INFO     epoch complete!
2024-04-30 23:14:19 INFO     evaluating now!
2024-04-30 23:14:19 INFO     Epoch [26/200] train_loss: 4.4899, val_loss: 5.2366, lr: 0.003000, 7.49s
2024-04-30 23:14:26 INFO     epoch complete!
2024-04-30 23:14:26 INFO     evaluating now!
2024-04-30 23:14:27 INFO     Epoch [27/200] train_loss: 4.4578, val_loss: 5.1142, lr: 0.003000, 7.39s
2024-04-30 23:14:27 INFO     Saved model at 27
2024-04-30 23:14:27 INFO     Val loss decrease from 5.1776 to 5.1142, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-30 23:14:34 INFO     epoch complete!
2024-04-30 23:14:34 INFO     evaluating now!
2024-04-30 23:14:34 INFO     Epoch [28/200] train_loss: 4.4022, val_loss: 5.2648, lr: 0.003000, 7.56s
2024-04-30 23:14:41 INFO     epoch complete!
2024-04-30 23:14:41 INFO     evaluating now!
2024-04-30 23:14:42 INFO     Epoch [29/200] train_loss: 4.3011, val_loss: 5.1960, lr: 0.003000, 7.40s
2024-04-30 23:14:49 INFO     epoch complete!
2024-04-30 23:14:49 INFO     evaluating now!
2024-04-30 23:14:49 INFO     Epoch [30/200] train_loss: 4.3083, val_loss: 5.3731, lr: 0.003000, 7.40s
2024-04-30 23:14:56 INFO     epoch complete!
2024-04-30 23:14:56 INFO     evaluating now!
2024-04-30 23:14:57 INFO     Epoch [31/200] train_loss: 4.2735, val_loss: 5.1377, lr: 0.003000, 7.74s
2024-04-30 23:15:05 INFO     epoch complete!
2024-04-30 23:15:05 INFO     evaluating now!
2024-04-30 23:15:05 INFO     Epoch [32/200] train_loss: 4.2295, val_loss: 5.5620, lr: 0.003000, 8.20s
2024-04-30 23:15:13 INFO     epoch complete!
2024-04-30 23:15:13 INFO     evaluating now!
2024-04-30 23:15:13 INFO     Epoch [33/200] train_loss: 4.2323, val_loss: 5.1381, lr: 0.003000, 8.11s
2024-04-30 23:15:21 INFO     epoch complete!
2024-04-30 23:15:21 INFO     evaluating now!
2024-04-30 23:15:21 INFO     Epoch [34/200] train_loss: 4.1408, val_loss: 5.1342, lr: 0.003000, 8.10s
2024-04-30 23:15:29 INFO     epoch complete!
2024-04-30 23:15:29 INFO     evaluating now!
2024-04-30 23:15:29 INFO     Epoch [35/200] train_loss: 4.0709, val_loss: 5.1527, lr: 0.003000, 7.74s
2024-04-30 23:15:36 INFO     epoch complete!
2024-04-30 23:15:36 INFO     evaluating now!
2024-04-30 23:15:36 INFO     Epoch [36/200] train_loss: 4.1362, val_loss: 5.1908, lr: 0.003000, 7.32s
2024-04-30 23:15:43 INFO     epoch complete!
2024-04-30 23:15:43 INFO     evaluating now!
2024-04-30 23:15:44 INFO     Epoch [37/200] train_loss: 4.1323, val_loss: 5.1949, lr: 0.003000, 7.28s
2024-04-30 23:15:51 INFO     epoch complete!
2024-04-30 23:15:51 INFO     evaluating now!
2024-04-30 23:15:51 INFO     Epoch [38/200] train_loss: 4.0191, val_loss: 5.1587, lr: 0.003000, 7.33s
2024-04-30 23:15:58 INFO     epoch complete!
2024-04-30 23:15:58 INFO     evaluating now!
2024-04-30 23:15:58 INFO     Epoch [39/200] train_loss: 4.0246, val_loss: 5.1133, lr: 0.003000, 7.41s
2024-04-30 23:15:58 INFO     Saved model at 39
2024-04-30 23:15:58 INFO     Val loss decrease from 5.1142 to 5.1133, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-04-30 23:16:05 INFO     epoch complete!
2024-04-30 23:16:05 INFO     evaluating now!
2024-04-30 23:16:06 INFO     Epoch [40/200] train_loss: 3.9818, val_loss: 5.1078, lr: 0.003000, 7.29s
2024-04-30 23:16:06 INFO     Saved model at 40
2024-04-30 23:16:06 INFO     Val loss decrease from 5.1133 to 5.1078, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-04-30 23:16:13 INFO     epoch complete!
2024-04-30 23:16:13 INFO     evaluating now!
2024-04-30 23:16:13 INFO     Epoch [41/200] train_loss: 3.9612, val_loss: 5.0350, lr: 0.003000, 7.52s
2024-04-30 23:16:13 INFO     Saved model at 41
2024-04-30 23:16:13 INFO     Val loss decrease from 5.1078 to 5.0350, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-04-30 23:16:20 INFO     epoch complete!
2024-04-30 23:16:20 INFO     evaluating now!
2024-04-30 23:16:21 INFO     Epoch [42/200] train_loss: 3.9537, val_loss: 5.0525, lr: 0.003000, 7.44s
2024-04-30 23:16:28 INFO     epoch complete!
2024-04-30 23:16:28 INFO     evaluating now!
2024-04-30 23:16:28 INFO     Epoch [43/200] train_loss: 3.8943, val_loss: 5.0952, lr: 0.003000, 7.42s
2024-04-30 23:16:35 INFO     epoch complete!
2024-04-30 23:16:35 INFO     evaluating now!
2024-04-30 23:16:36 INFO     Epoch [44/200] train_loss: 3.9163, val_loss: 5.0671, lr: 0.003000, 7.46s
2024-04-30 23:16:43 INFO     epoch complete!
2024-04-30 23:16:43 INFO     evaluating now!
2024-04-30 23:16:44 INFO     Epoch [45/200] train_loss: 3.8460, val_loss: 5.0932, lr: 0.003000, 7.98s
2024-04-30 23:16:51 INFO     epoch complete!
2024-04-30 23:16:51 INFO     evaluating now!
2024-04-30 23:16:51 INFO     Epoch [46/200] train_loss: 3.8283, val_loss: 4.9224, lr: 0.003000, 7.72s
2024-04-30 23:16:51 INFO     Saved model at 46
2024-04-30 23:16:51 INFO     Val loss decrease from 5.0350 to 4.9224, saving to ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-04-30 23:16:59 INFO     epoch complete!
2024-04-30 23:16:59 INFO     evaluating now!
2024-04-30 23:16:59 INFO     Epoch [47/200] train_loss: 3.8010, val_loss: 5.0841, lr: 0.003000, 7.74s
2024-04-30 23:17:06 INFO     epoch complete!
2024-04-30 23:17:06 INFO     evaluating now!
2024-04-30 23:17:07 INFO     Epoch [48/200] train_loss: 3.7567, val_loss: 5.0897, lr: 0.003000, 7.42s
2024-04-30 23:17:14 INFO     epoch complete!
2024-04-30 23:17:14 INFO     evaluating now!
2024-04-30 23:17:14 INFO     Epoch [49/200] train_loss: 3.8094, val_loss: 5.0568, lr: 0.003000, 7.80s
2024-04-30 23:17:22 INFO     epoch complete!
2024-04-30 23:17:22 INFO     evaluating now!
2024-04-30 23:17:22 INFO     Epoch [50/200] train_loss: 3.8494, val_loss: 5.0715, lr: 0.003000, 7.86s
2024-04-30 23:17:29 INFO     epoch complete!
2024-04-30 23:17:29 INFO     evaluating now!
2024-04-30 23:17:29 INFO     Epoch [51/200] train_loss: 3.7549, val_loss: 5.1273, lr: 0.003000, 7.23s
2024-04-30 23:17:36 INFO     epoch complete!
2024-04-30 23:17:36 INFO     evaluating now!
2024-04-30 23:17:37 INFO     Epoch [52/200] train_loss: 3.6865, val_loss: 5.1036, lr: 0.003000, 7.04s
2024-04-30 23:17:43 INFO     epoch complete!
2024-04-30 23:17:43 INFO     evaluating now!
2024-04-30 23:17:44 INFO     Epoch [53/200] train_loss: 3.6924, val_loss: 5.1256, lr: 0.003000, 7.08s
2024-04-30 23:17:50 INFO     epoch complete!
2024-04-30 23:17:50 INFO     evaluating now!
2024-04-30 23:17:51 INFO     Epoch [54/200] train_loss: 3.6940, val_loss: 5.0469, lr: 0.003000, 7.01s
2024-04-30 23:17:57 INFO     epoch complete!
2024-04-30 23:17:57 INFO     evaluating now!
2024-04-30 23:17:58 INFO     Epoch [55/200] train_loss: 3.6684, val_loss: 5.0644, lr: 0.003000, 7.11s
2024-04-30 23:18:04 INFO     epoch complete!
2024-04-30 23:18:04 INFO     evaluating now!
2024-04-30 23:18:05 INFO     Epoch [56/200] train_loss: 3.6245, val_loss: 5.1259, lr: 0.003000, 7.14s
2024-04-30 23:18:12 INFO     epoch complete!
2024-04-30 23:18:12 INFO     evaluating now!
2024-04-30 23:18:12 INFO     Epoch [57/200] train_loss: 3.5960, val_loss: 5.1810, lr: 0.003000, 7.48s
2024-04-30 23:18:19 INFO     epoch complete!
2024-04-30 23:18:19 INFO     evaluating now!
2024-04-30 23:18:20 INFO     Epoch [58/200] train_loss: 3.6343, val_loss: 4.9888, lr: 0.003000, 7.61s
2024-04-30 23:18:27 INFO     epoch complete!
2024-04-30 23:18:27 INFO     evaluating now!
2024-04-30 23:18:27 INFO     Epoch [59/200] train_loss: 3.5636, val_loss: 5.1552, lr: 0.003000, 7.40s
2024-04-30 23:18:34 INFO     epoch complete!
2024-04-30 23:18:34 INFO     evaluating now!
2024-04-30 23:18:35 INFO     Epoch [60/200] train_loss: 3.5571, val_loss: 5.0819, lr: 0.003000, 7.19s
2024-04-30 23:18:41 INFO     epoch complete!
2024-04-30 23:18:41 INFO     evaluating now!
2024-04-30 23:18:42 INFO     Epoch [61/200] train_loss: 3.5696, val_loss: 5.0733, lr: 0.003000, 7.24s
2024-04-30 23:18:42 WARNING  Early stopping at epoch: 61
2024-04-30 23:18:42 INFO     Trained totally 62 epochs, average train time is 6.926s, average eval time is 0.503s
2024-04-30 23:18:42 INFO     Loaded model at 46
2024-04-30 23:18:42 INFO     Saved model at ./libcity/cache/51/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 23:18:42 INFO     Start evaluating ...
2024-04-30 23:18:44 INFO     Note that you select the single mode to evaluate!
2024-04-30 23:18:44 INFO     Evaluate result is saved at ./libcity/cache/51/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 23:18:44 INFO     
         MAE       RMSE
1   2.291949   6.888960
2   2.365841   7.633106
3   2.546123   8.588831
4   2.763465   9.564383
5   3.004211  10.923389
6   3.147738  12.367972
7   3.226972  13.624855
8   3.322298  14.533466
9   3.277227  14.482803
10  3.348103  14.395521
11  3.407911  14.265923
12  3.502334  14.540122
2024-04-30 23:18:44 INFO     ----------------------------------------------------------------------------
2024-04-30 23:18:44 INFO     # 2, Kownledge Graph Embedding: AttH, Experiment ids: 52
2024-04-30 23:18:44 INFO     ----------------------------------------------------------------------------
2024-04-30 23:18:44 INFO     Log directory: ./libcity/log
2024-04-30 23:18:44 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=52
2024-04-30 23:18:44 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 1039873948, 'exp_id': 52, 'load_external': True, 'embedding_model': 'AttH', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 23:18:44 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 23:18:44 INFO     set_weight_link_or_dist: dist
2024-04-30 23:18:44 INFO     init_weight_inf_or_zero: inf
2024-04-30 23:18:44 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 23:18:44 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 23:18:44 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 23:18:44 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 23:18:47 INFO     Dataset created
2024-04-30 23:18:47 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 23:18:47 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 23:18:47 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 23:18:47 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 23:18:47 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 23:18:47 INFO     NoneScaler
2024-04-30 23:18:49 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 23:18:49 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 23:18:49 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 23:18:49 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 23:18:49 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 23:18:49 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 23:18:49 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 23:18:49 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 23:18:49 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 23:18:49 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 23:18:49 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 23:18:49 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 23:18:49 INFO     Total parameter numbers: 874010
2024-04-30 23:18:49 INFO     You select `adam` optimizer.
2024-04-30 23:18:49 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 23:18:49 INFO     Start training ...
2024-04-30 23:18:49 INFO     num_batches:48
2024-04-30 23:18:56 INFO     epoch complete!
2024-04-30 23:18:56 INFO     evaluating now!
2024-04-30 23:18:57 INFO     Epoch [0/200] train_loss: 24.8710, val_loss: 18.2961, lr: 0.003000, 7.38s
2024-04-30 23:18:57 INFO     Saved model at 0
2024-04-30 23:18:57 INFO     Val loss decrease from inf to 18.2961, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 23:19:04 INFO     epoch complete!
2024-04-30 23:19:04 INFO     evaluating now!
2024-04-30 23:19:04 INFO     Epoch [1/200] train_loss: 15.1023, val_loss: 14.6195, lr: 0.003000, 7.33s
2024-04-30 23:19:04 INFO     Saved model at 1
2024-04-30 23:19:04 INFO     Val loss decrease from 18.2961 to 14.6195, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 23:19:11 INFO     epoch complete!
2024-04-30 23:19:11 INFO     evaluating now!
2024-04-30 23:19:11 INFO     Epoch [2/200] train_loss: 12.5441, val_loss: 12.3844, lr: 0.003000, 7.29s
2024-04-30 23:19:11 INFO     Saved model at 2
2024-04-30 23:19:11 INFO     Val loss decrease from 14.6195 to 12.3844, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 23:19:18 INFO     epoch complete!
2024-04-30 23:19:18 INFO     evaluating now!
2024-04-30 23:19:19 INFO     Epoch [3/200] train_loss: 10.2118, val_loss: 9.7260, lr: 0.003000, 7.29s
2024-04-30 23:19:19 INFO     Saved model at 3
2024-04-30 23:19:19 INFO     Val loss decrease from 12.3844 to 9.7260, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 23:19:26 INFO     epoch complete!
2024-04-30 23:19:26 INFO     evaluating now!
2024-04-30 23:19:26 INFO     Epoch [4/200] train_loss: 8.7415, val_loss: 8.4789, lr: 0.003000, 7.27s
2024-04-30 23:19:26 INFO     Saved model at 4
2024-04-30 23:19:26 INFO     Val loss decrease from 9.7260 to 8.4789, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 23:19:33 INFO     epoch complete!
2024-04-30 23:19:33 INFO     evaluating now!
2024-04-30 23:19:33 INFO     Epoch [5/200] train_loss: 7.7254, val_loss: 7.5156, lr: 0.003000, 7.38s
2024-04-30 23:19:34 INFO     Saved model at 5
2024-04-30 23:19:34 INFO     Val loss decrease from 8.4789 to 7.5156, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 23:19:41 INFO     epoch complete!
2024-04-30 23:19:41 INFO     evaluating now!
2024-04-30 23:19:41 INFO     Epoch [6/200] train_loss: 7.1244, val_loss: 6.9826, lr: 0.003000, 7.51s
2024-04-30 23:19:41 INFO     Saved model at 6
2024-04-30 23:19:41 INFO     Val loss decrease from 7.5156 to 6.9826, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 23:19:48 INFO     epoch complete!
2024-04-30 23:19:48 INFO     evaluating now!
2024-04-30 23:19:48 INFO     Epoch [7/200] train_loss: 6.6907, val_loss: 6.7234, lr: 0.003000, 7.37s
2024-04-30 23:19:49 INFO     Saved model at 7
2024-04-30 23:19:49 INFO     Val loss decrease from 6.9826 to 6.7234, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 23:19:55 INFO     epoch complete!
2024-04-30 23:19:55 INFO     evaluating now!
2024-04-30 23:19:56 INFO     Epoch [8/200] train_loss: 6.3965, val_loss: 6.4481, lr: 0.003000, 7.32s
2024-04-30 23:19:56 INFO     Saved model at 8
2024-04-30 23:19:56 INFO     Val loss decrease from 6.7234 to 6.4481, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 23:20:03 INFO     epoch complete!
2024-04-30 23:20:03 INFO     evaluating now!
2024-04-30 23:20:04 INFO     Epoch [9/200] train_loss: 6.1212, val_loss: 6.2318, lr: 0.003000, 7.62s
2024-04-30 23:20:04 INFO     Saved model at 9
2024-04-30 23:20:04 INFO     Val loss decrease from 6.4481 to 6.2318, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 23:20:10 INFO     epoch complete!
2024-04-30 23:20:10 INFO     evaluating now!
2024-04-30 23:20:11 INFO     Epoch [10/200] train_loss: 5.9252, val_loss: 6.1124, lr: 0.003000, 7.36s
2024-04-30 23:20:11 INFO     Saved model at 10
2024-04-30 23:20:11 INFO     Val loss decrease from 6.2318 to 6.1124, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 23:20:18 INFO     epoch complete!
2024-04-30 23:20:18 INFO     evaluating now!
2024-04-30 23:20:18 INFO     Epoch [11/200] train_loss: 5.7932, val_loss: 5.9352, lr: 0.003000, 7.19s
2024-04-30 23:20:18 INFO     Saved model at 11
2024-04-30 23:20:18 INFO     Val loss decrease from 6.1124 to 5.9352, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 23:20:25 INFO     epoch complete!
2024-04-30 23:20:25 INFO     evaluating now!
2024-04-30 23:20:25 INFO     Epoch [12/200] train_loss: 5.5623, val_loss: 5.7589, lr: 0.003000, 7.14s
2024-04-30 23:20:25 INFO     Saved model at 12
2024-04-30 23:20:25 INFO     Val loss decrease from 5.9352 to 5.7589, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 23:20:32 INFO     epoch complete!
2024-04-30 23:20:32 INFO     evaluating now!
2024-04-30 23:20:33 INFO     Epoch [13/200] train_loss: 5.5121, val_loss: 6.1817, lr: 0.003000, 7.24s
2024-04-30 23:20:39 INFO     epoch complete!
2024-04-30 23:20:39 INFO     evaluating now!
2024-04-30 23:20:40 INFO     Epoch [14/200] train_loss: 5.3400, val_loss: 5.7833, lr: 0.003000, 7.27s
2024-04-30 23:20:47 INFO     epoch complete!
2024-04-30 23:20:47 INFO     evaluating now!
2024-04-30 23:20:47 INFO     Epoch [15/200] train_loss: 5.1862, val_loss: 5.4568, lr: 0.003000, 7.12s
2024-04-30 23:20:47 INFO     Saved model at 15
2024-04-30 23:20:47 INFO     Val loss decrease from 5.7589 to 5.4568, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-30 23:20:54 INFO     epoch complete!
2024-04-30 23:20:54 INFO     evaluating now!
2024-04-30 23:20:54 INFO     Epoch [16/200] train_loss: 5.1740, val_loss: 5.5112, lr: 0.003000, 7.18s
2024-04-30 23:21:01 INFO     epoch complete!
2024-04-30 23:21:01 INFO     evaluating now!
2024-04-30 23:21:01 INFO     Epoch [17/200] train_loss: 5.1255, val_loss: 5.4499, lr: 0.003000, 7.19s
2024-04-30 23:21:02 INFO     Saved model at 17
2024-04-30 23:21:02 INFO     Val loss decrease from 5.4568 to 5.4499, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-30 23:21:08 INFO     epoch complete!
2024-04-30 23:21:08 INFO     evaluating now!
2024-04-30 23:21:09 INFO     Epoch [18/200] train_loss: 5.0682, val_loss: 5.3942, lr: 0.003000, 7.23s
2024-04-30 23:21:09 INFO     Saved model at 18
2024-04-30 23:21:09 INFO     Val loss decrease from 5.4499 to 5.3942, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 23:21:15 INFO     epoch complete!
2024-04-30 23:21:15 INFO     evaluating now!
2024-04-30 23:21:16 INFO     Epoch [19/200] train_loss: 4.9689, val_loss: 5.5024, lr: 0.003000, 7.19s
2024-04-30 23:21:23 INFO     epoch complete!
2024-04-30 23:21:23 INFO     evaluating now!
2024-04-30 23:21:23 INFO     Epoch [20/200] train_loss: 4.9413, val_loss: 5.3962, lr: 0.003000, 7.18s
2024-04-30 23:21:30 INFO     epoch complete!
2024-04-30 23:21:30 INFO     evaluating now!
2024-04-30 23:21:30 INFO     Epoch [21/200] train_loss: 4.8051, val_loss: 5.3041, lr: 0.003000, 7.34s
2024-04-30 23:21:31 INFO     Saved model at 21
2024-04-30 23:21:31 INFO     Val loss decrease from 5.3942 to 5.3041, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-30 23:21:37 INFO     epoch complete!
2024-04-30 23:21:37 INFO     evaluating now!
2024-04-30 23:21:37 INFO     Epoch [22/200] train_loss: 4.7770, val_loss: 5.2271, lr: 0.003000, 6.94s
2024-04-30 23:21:44 INFO     Saved model at 22
2024-04-30 23:21:44 INFO     Val loss decrease from 5.3041 to 5.2271, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-30 23:21:50 INFO     epoch complete!
2024-04-30 23:21:50 INFO     evaluating now!
2024-04-30 23:21:51 INFO     Epoch [23/200] train_loss: 4.6865, val_loss: 5.2239, lr: 0.003000, 7.19s
2024-04-30 23:21:51 INFO     Saved model at 23
2024-04-30 23:21:51 INFO     Val loss decrease from 5.2271 to 5.2239, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-04-30 23:21:58 INFO     epoch complete!
2024-04-30 23:21:58 INFO     evaluating now!
2024-04-30 23:21:58 INFO     Epoch [24/200] train_loss: 4.6400, val_loss: 5.2186, lr: 0.003000, 7.25s
2024-04-30 23:21:58 INFO     Saved model at 24
2024-04-30 23:21:58 INFO     Val loss decrease from 5.2239 to 5.2186, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-04-30 23:22:05 INFO     epoch complete!
2024-04-30 23:22:05 INFO     evaluating now!
2024-04-30 23:22:05 INFO     Epoch [25/200] train_loss: 4.6783, val_loss: 5.2250, lr: 0.003000, 7.20s
2024-04-30 23:22:12 INFO     epoch complete!
2024-04-30 23:22:12 INFO     evaluating now!
2024-04-30 23:22:13 INFO     Epoch [26/200] train_loss: 4.5724, val_loss: 5.4030, lr: 0.003000, 7.22s
2024-04-30 23:22:19 INFO     epoch complete!
2024-04-30 23:22:19 INFO     evaluating now!
2024-04-30 23:22:20 INFO     Epoch [27/200] train_loss: 4.4903, val_loss: 5.1323, lr: 0.003000, 7.18s
2024-04-30 23:22:20 INFO     Saved model at 27
2024-04-30 23:22:20 INFO     Val loss decrease from 5.2186 to 5.1323, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-30 23:22:27 INFO     epoch complete!
2024-04-30 23:22:27 INFO     evaluating now!
2024-04-30 23:22:27 INFO     Epoch [28/200] train_loss: 4.4555, val_loss: 5.1871, lr: 0.003000, 7.19s
2024-04-30 23:22:34 INFO     epoch complete!
2024-04-30 23:22:34 INFO     evaluating now!
2024-04-30 23:22:34 INFO     Epoch [29/200] train_loss: 4.4877, val_loss: 5.1813, lr: 0.003000, 7.18s
2024-04-30 23:22:41 INFO     epoch complete!
2024-04-30 23:22:41 INFO     evaluating now!
2024-04-30 23:22:42 INFO     Epoch [30/200] train_loss: 4.4017, val_loss: 5.1685, lr: 0.003000, 7.32s
2024-04-30 23:22:48 INFO     epoch complete!
2024-04-30 23:22:48 INFO     evaluating now!
2024-04-30 23:22:49 INFO     Epoch [31/200] train_loss: 4.3760, val_loss: 5.3002, lr: 0.003000, 7.29s
2024-04-30 23:22:56 INFO     epoch complete!
2024-04-30 23:22:56 INFO     evaluating now!
2024-04-30 23:22:56 INFO     Epoch [32/200] train_loss: 4.3768, val_loss: 5.1180, lr: 0.003000, 7.28s
2024-04-30 23:22:56 INFO     Saved model at 32
2024-04-30 23:22:56 INFO     Val loss decrease from 5.1323 to 5.1180, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-04-30 23:23:03 INFO     epoch complete!
2024-04-30 23:23:03 INFO     evaluating now!
2024-04-30 23:23:03 INFO     Epoch [33/200] train_loss: 4.2587, val_loss: 5.0387, lr: 0.003000, 7.17s
2024-04-30 23:23:03 INFO     Saved model at 33
2024-04-30 23:23:03 INFO     Val loss decrease from 5.1180 to 5.0387, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-04-30 23:23:10 INFO     epoch complete!
2024-04-30 23:23:10 INFO     evaluating now!
2024-04-30 23:23:11 INFO     Epoch [34/200] train_loss: 4.2577, val_loss: 5.2015, lr: 0.003000, 7.25s
2024-04-30 23:23:17 INFO     epoch complete!
2024-04-30 23:23:17 INFO     evaluating now!
2024-04-30 23:23:18 INFO     Epoch [35/200] train_loss: 4.2075, val_loss: 5.0436, lr: 0.003000, 7.20s
2024-04-30 23:23:25 INFO     epoch complete!
2024-04-30 23:23:25 INFO     evaluating now!
2024-04-30 23:23:25 INFO     Epoch [36/200] train_loss: 4.1952, val_loss: 5.1107, lr: 0.003000, 7.28s
2024-04-30 23:23:32 INFO     epoch complete!
2024-04-30 23:23:32 INFO     evaluating now!
2024-04-30 23:23:32 INFO     Epoch [37/200] train_loss: 4.1827, val_loss: 5.0788, lr: 0.003000, 7.21s
2024-04-30 23:23:39 INFO     epoch complete!
2024-04-30 23:23:39 INFO     evaluating now!
2024-04-30 23:23:40 INFO     Epoch [38/200] train_loss: 4.1236, val_loss: 4.9831, lr: 0.003000, 7.29s
2024-04-30 23:23:40 INFO     Saved model at 38
2024-04-30 23:23:40 INFO     Val loss decrease from 5.0387 to 4.9831, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-04-30 23:23:46 INFO     epoch complete!
2024-04-30 23:23:46 INFO     evaluating now!
2024-04-30 23:23:47 INFO     Epoch [39/200] train_loss: 4.1081, val_loss: 5.1158, lr: 0.003000, 7.14s
2024-04-30 23:23:54 INFO     epoch complete!
2024-04-30 23:23:54 INFO     evaluating now!
2024-04-30 23:23:54 INFO     Epoch [40/200] train_loss: 4.0561, val_loss: 5.0973, lr: 0.003000, 7.52s
2024-04-30 23:24:01 INFO     epoch complete!
2024-04-30 23:24:01 INFO     evaluating now!
2024-04-30 23:24:01 INFO     Epoch [41/200] train_loss: 4.0880, val_loss: 5.0855, lr: 0.003000, 6.98s
2024-04-30 23:24:08 INFO     epoch complete!
2024-04-30 23:24:08 INFO     evaluating now!
2024-04-30 23:24:08 INFO     Epoch [42/200] train_loss: 4.0193, val_loss: 5.0886, lr: 0.003000, 6.93s
2024-04-30 23:24:15 INFO     epoch complete!
2024-04-30 23:24:15 INFO     evaluating now!
2024-04-30 23:24:15 INFO     Epoch [43/200] train_loss: 4.0379, val_loss: 5.0454, lr: 0.003000, 6.98s
2024-04-30 23:24:22 INFO     epoch complete!
2024-04-30 23:24:22 INFO     evaluating now!
2024-04-30 23:24:22 INFO     Epoch [44/200] train_loss: 3.9964, val_loss: 5.1349, lr: 0.003000, 6.85s
2024-04-30 23:24:29 INFO     epoch complete!
2024-04-30 23:24:29 INFO     evaluating now!
2024-04-30 23:24:29 INFO     Epoch [45/200] train_loss: 3.9895, val_loss: 5.0694, lr: 0.003000, 6.94s
2024-04-30 23:24:36 INFO     epoch complete!
2024-04-30 23:24:36 INFO     evaluating now!
2024-04-30 23:24:36 INFO     Epoch [46/200] train_loss: 3.8991, val_loss: 4.9327, lr: 0.003000, 7.15s
2024-04-30 23:24:36 INFO     Saved model at 46
2024-04-30 23:24:36 INFO     Val loss decrease from 4.9831 to 4.9327, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-04-30 23:24:44 INFO     epoch complete!
2024-04-30 23:24:44 INFO     evaluating now!
2024-04-30 23:24:44 INFO     Epoch [47/200] train_loss: 3.8477, val_loss: 4.9873, lr: 0.003000, 7.78s
2024-04-30 23:24:51 INFO     epoch complete!
2024-04-30 23:24:51 INFO     evaluating now!
2024-04-30 23:24:51 INFO     Epoch [48/200] train_loss: 3.8225, val_loss: 5.0612, lr: 0.003000, 7.15s
2024-04-30 23:24:58 INFO     epoch complete!
2024-04-30 23:24:58 INFO     evaluating now!
2024-04-30 23:24:59 INFO     Epoch [49/200] train_loss: 3.8010, val_loss: 5.0155, lr: 0.003000, 7.31s
2024-04-30 23:25:05 INFO     epoch complete!
2024-04-30 23:25:05 INFO     evaluating now!
2024-04-30 23:25:06 INFO     Epoch [50/200] train_loss: 3.7585, val_loss: 4.9733, lr: 0.003000, 7.29s
2024-04-30 23:25:12 INFO     epoch complete!
2024-04-30 23:25:12 INFO     evaluating now!
2024-04-30 23:25:13 INFO     Epoch [51/200] train_loss: 3.7438, val_loss: 5.0010, lr: 0.003000, 7.17s
2024-04-30 23:25:20 INFO     epoch complete!
2024-04-30 23:25:20 INFO     evaluating now!
2024-04-30 23:25:21 INFO     Epoch [52/200] train_loss: 3.7455, val_loss: 5.0219, lr: 0.003000, 7.53s
2024-04-30 23:25:27 INFO     epoch complete!
2024-04-30 23:25:27 INFO     evaluating now!
2024-04-30 23:25:28 INFO     Epoch [53/200] train_loss: 3.7323, val_loss: 4.9911, lr: 0.003000, 7.38s
2024-04-30 23:25:35 INFO     epoch complete!
2024-04-30 23:25:35 INFO     evaluating now!
2024-04-30 23:25:35 INFO     Epoch [54/200] train_loss: 3.7926, val_loss: 5.0694, lr: 0.003000, 7.50s
2024-04-30 23:25:42 INFO     epoch complete!
2024-04-30 23:25:42 INFO     evaluating now!
2024-04-30 23:25:43 INFO     Epoch [55/200] train_loss: 3.6998, val_loss: 4.9328, lr: 0.003000, 7.56s
2024-04-30 23:25:50 INFO     epoch complete!
2024-04-30 23:25:50 INFO     evaluating now!
2024-04-30 23:25:51 INFO     Epoch [56/200] train_loss: 3.6748, val_loss: 4.8207, lr: 0.003000, 7.65s
2024-04-30 23:25:51 INFO     Saved model at 56
2024-04-30 23:25:51 INFO     Val loss decrease from 4.9327 to 4.8207, saving to ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406_epoch56.tar
2024-04-30 23:25:58 INFO     epoch complete!
2024-04-30 23:25:58 INFO     evaluating now!
2024-04-30 23:25:58 INFO     Epoch [57/200] train_loss: 3.6699, val_loss: 4.9586, lr: 0.003000, 7.67s
2024-04-30 23:26:05 INFO     epoch complete!
2024-04-30 23:26:05 INFO     evaluating now!
2024-04-30 23:26:06 INFO     Epoch [58/200] train_loss: 3.6860, val_loss: 4.9577, lr: 0.003000, 7.64s
2024-04-30 23:26:13 INFO     epoch complete!
2024-04-30 23:26:13 INFO     evaluating now!
2024-04-30 23:26:14 INFO     Epoch [59/200] train_loss: 3.6287, val_loss: 5.0358, lr: 0.003000, 7.57s
2024-04-30 23:26:21 INFO     epoch complete!
2024-04-30 23:26:21 INFO     evaluating now!
2024-04-30 23:26:21 INFO     Epoch [60/200] train_loss: 3.6765, val_loss: 5.2261, lr: 0.003000, 7.57s
2024-04-30 23:26:28 INFO     epoch complete!
2024-04-30 23:26:28 INFO     evaluating now!
2024-04-30 23:26:29 INFO     Epoch [61/200] train_loss: 3.6185, val_loss: 5.0288, lr: 0.003000, 7.50s
2024-04-30 23:26:35 INFO     epoch complete!
2024-04-30 23:26:35 INFO     evaluating now!
2024-04-30 23:26:36 INFO     Epoch [62/200] train_loss: 3.6376, val_loss: 4.9692, lr: 0.003000, 7.35s
2024-04-30 23:26:43 INFO     epoch complete!
2024-04-30 23:26:43 INFO     evaluating now!
2024-04-30 23:26:43 INFO     Epoch [63/200] train_loss: 3.5941, val_loss: 4.9256, lr: 0.003000, 7.38s
2024-04-30 23:26:50 INFO     epoch complete!
2024-04-30 23:26:50 INFO     evaluating now!
2024-04-30 23:26:51 INFO     Epoch [64/200] train_loss: 3.5374, val_loss: 4.9650, lr: 0.003000, 7.29s
2024-04-30 23:26:58 INFO     epoch complete!
2024-04-30 23:26:58 INFO     evaluating now!
2024-04-30 23:26:58 INFO     Epoch [65/200] train_loss: 3.5186, val_loss: 5.0738, lr: 0.003000, 7.39s
2024-04-30 23:27:05 INFO     epoch complete!
2024-04-30 23:27:05 INFO     evaluating now!
2024-04-30 23:27:06 INFO     Epoch [66/200] train_loss: 3.4977, val_loss: 4.9054, lr: 0.003000, 7.50s
2024-04-30 23:27:12 INFO     epoch complete!
2024-04-30 23:27:12 INFO     evaluating now!
2024-04-30 23:27:13 INFO     Epoch [67/200] train_loss: 3.5130, val_loss: 5.0140, lr: 0.003000, 7.44s
2024-04-30 23:27:20 INFO     epoch complete!
2024-04-30 23:27:20 INFO     evaluating now!
2024-04-30 23:27:20 INFO     Epoch [68/200] train_loss: 3.5202, val_loss: 4.9128, lr: 0.003000, 7.39s
2024-04-30 23:27:27 INFO     epoch complete!
2024-04-30 23:27:27 INFO     evaluating now!
2024-04-30 23:27:28 INFO     Epoch [69/200] train_loss: 3.5107, val_loss: 4.9664, lr: 0.003000, 7.45s
2024-04-30 23:27:35 INFO     epoch complete!
2024-04-30 23:27:35 INFO     evaluating now!
2024-04-30 23:27:35 INFO     Epoch [70/200] train_loss: 3.4903, val_loss: 5.0134, lr: 0.003000, 7.48s
2024-04-30 23:27:42 INFO     epoch complete!
2024-04-30 23:27:42 INFO     evaluating now!
2024-04-30 23:27:43 INFO     Epoch [71/200] train_loss: 3.4877, val_loss: 4.9762, lr: 0.003000, 7.32s
2024-04-30 23:27:43 WARNING  Early stopping at epoch: 71
2024-04-30 23:27:43 INFO     Trained totally 72 epochs, average train time is 6.796s, average eval time is 0.503s
2024-04-30 23:27:43 INFO     Loaded model at 56
2024-04-30 23:27:43 INFO     Saved model at ./libcity/cache/52/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 23:27:43 INFO     Start evaluating ...
2024-04-30 23:27:44 INFO     Note that you select the single mode to evaluate!
2024-04-30 23:27:45 INFO     Evaluate result is saved at ./libcity/cache/52/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 23:27:45 INFO     
         MAE       RMSE
1   2.354474   7.276923
2   2.442900   7.800240
3   2.632648   8.648450
4   2.794602   9.379007
5   2.919265  10.169564
6   3.105815  11.051455
7   3.154851  11.906901
8   3.226889  12.482129
9   3.252110  12.691927
10  3.261700  12.754651
11  3.305728  12.897947
12  3.445586  13.375153
2024-04-30 23:27:45 INFO     ----------------------------------------------------------------------------
2024-04-30 23:27:45 INFO     # 3, Kownledge Graph Embedding: AttH, Experiment ids: 53
2024-04-30 23:27:45 INFO     ----------------------------------------------------------------------------
2024-04-30 23:27:45 INFO     Log directory: ./libcity/log
2024-04-30 23:27:45 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=53
2024-04-30 23:27:45 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 601545124, 'exp_id': 53, 'load_external': True, 'embedding_model': 'AttH', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 23:27:45 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 23:27:45 INFO     set_weight_link_or_dist: dist
2024-04-30 23:27:45 INFO     init_weight_inf_or_zero: inf
2024-04-30 23:27:45 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 23:27:45 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 23:27:45 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 23:27:45 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 23:27:48 INFO     Dataset created
2024-04-30 23:27:48 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 23:27:48 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 23:27:48 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 23:27:48 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 23:27:48 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 23:27:48 INFO     NoneScaler
2024-04-30 23:27:50 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 23:27:50 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 23:27:50 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 23:27:50 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 23:27:50 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 23:27:50 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 23:27:50 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 23:27:50 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 23:27:50 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 23:27:50 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 23:27:50 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 23:27:50 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 23:27:50 INFO     Total parameter numbers: 874010
2024-04-30 23:27:50 INFO     You select `adam` optimizer.
2024-04-30 23:27:50 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 23:27:50 INFO     Start training ...
2024-04-30 23:27:50 INFO     num_batches:48
2024-04-30 23:27:57 INFO     epoch complete!
2024-04-30 23:27:57 INFO     evaluating now!
2024-04-30 23:27:58 INFO     Epoch [0/200] train_loss: 24.1178, val_loss: 17.7457, lr: 0.003000, 7.45s
2024-04-30 23:27:58 INFO     Saved model at 0
2024-04-30 23:27:58 INFO     Val loss decrease from inf to 17.7457, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 23:28:05 INFO     epoch complete!
2024-04-30 23:28:05 INFO     evaluating now!
2024-04-30 23:28:05 INFO     Epoch [1/200] train_loss: 14.5447, val_loss: 13.9395, lr: 0.003000, 7.47s
2024-04-30 23:28:05 INFO     Saved model at 1
2024-04-30 23:28:05 INFO     Val loss decrease from 17.7457 to 13.9395, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 23:28:12 INFO     epoch complete!
2024-04-30 23:28:12 INFO     evaluating now!
2024-04-30 23:28:13 INFO     Epoch [2/200] train_loss: 11.5146, val_loss: 11.1144, lr: 0.003000, 7.47s
2024-04-30 23:28:13 INFO     Saved model at 2
2024-04-30 23:28:13 INFO     Val loss decrease from 13.9395 to 11.1144, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 23:28:20 INFO     epoch complete!
2024-04-30 23:28:20 INFO     evaluating now!
2024-04-30 23:28:20 INFO     Epoch [3/200] train_loss: 9.4925, val_loss: 9.2230, lr: 0.003000, 7.31s
2024-04-30 23:28:20 INFO     Saved model at 3
2024-04-30 23:28:20 INFO     Val loss decrease from 11.1144 to 9.2230, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 23:28:27 INFO     epoch complete!
2024-04-30 23:28:27 INFO     evaluating now!
2024-04-30 23:28:27 INFO     Epoch [4/200] train_loss: 8.2287, val_loss: 7.9649, lr: 0.003000, 7.33s
2024-04-30 23:28:27 INFO     Saved model at 4
2024-04-30 23:28:27 INFO     Val loss decrease from 9.2230 to 7.9649, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 23:28:34 INFO     epoch complete!
2024-04-30 23:28:34 INFO     evaluating now!
2024-04-30 23:28:35 INFO     Epoch [5/200] train_loss: 7.4049, val_loss: 7.3962, lr: 0.003000, 7.39s
2024-04-30 23:28:35 INFO     Saved model at 5
2024-04-30 23:28:35 INFO     Val loss decrease from 7.9649 to 7.3962, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 23:28:42 INFO     epoch complete!
2024-04-30 23:28:42 INFO     evaluating now!
2024-04-30 23:28:42 INFO     Epoch [6/200] train_loss: 6.8216, val_loss: 6.6467, lr: 0.003000, 7.42s
2024-04-30 23:28:42 INFO     Saved model at 6
2024-04-30 23:28:42 INFO     Val loss decrease from 7.3962 to 6.6467, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 23:28:49 INFO     epoch complete!
2024-04-30 23:28:49 INFO     evaluating now!
2024-04-30 23:28:50 INFO     Epoch [7/200] train_loss: 6.3863, val_loss: 6.3447, lr: 0.003000, 7.41s
2024-04-30 23:28:50 INFO     Saved model at 7
2024-04-30 23:28:50 INFO     Val loss decrease from 6.6467 to 6.3447, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-30 23:28:57 INFO     epoch complete!
2024-04-30 23:28:57 INFO     evaluating now!
2024-04-30 23:28:57 INFO     Epoch [8/200] train_loss: 6.1902, val_loss: 6.3076, lr: 0.003000, 7.38s
2024-04-30 23:28:57 INFO     Saved model at 8
2024-04-30 23:28:57 INFO     Val loss decrease from 6.3447 to 6.3076, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 23:29:04 INFO     epoch complete!
2024-04-30 23:29:04 INFO     evaluating now!
2024-04-30 23:29:05 INFO     Epoch [9/200] train_loss: 6.0233, val_loss: 6.0092, lr: 0.003000, 7.47s
2024-04-30 23:29:05 INFO     Saved model at 9
2024-04-30 23:29:05 INFO     Val loss decrease from 6.3076 to 6.0092, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-30 23:29:12 INFO     epoch complete!
2024-04-30 23:29:12 INFO     evaluating now!
2024-04-30 23:29:12 INFO     Epoch [10/200] train_loss: 5.7226, val_loss: 5.8746, lr: 0.003000, 7.36s
2024-04-30 23:29:12 INFO     Saved model at 10
2024-04-30 23:29:12 INFO     Val loss decrease from 6.0092 to 5.8746, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 23:29:19 INFO     epoch complete!
2024-04-30 23:29:19 INFO     evaluating now!
2024-04-30 23:29:19 INFO     Epoch [11/200] train_loss: 5.5568, val_loss: 5.8385, lr: 0.003000, 7.32s
2024-04-30 23:29:19 INFO     Saved model at 11
2024-04-30 23:29:19 INFO     Val loss decrease from 5.8746 to 5.8385, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 23:29:26 INFO     epoch complete!
2024-04-30 23:29:26 INFO     evaluating now!
2024-04-30 23:29:27 INFO     Epoch [12/200] train_loss: 5.5170, val_loss: 5.8219, lr: 0.003000, 7.45s
2024-04-30 23:29:27 INFO     Saved model at 12
2024-04-30 23:29:27 INFO     Val loss decrease from 5.8385 to 5.8219, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 23:29:34 INFO     epoch complete!
2024-04-30 23:29:34 INFO     evaluating now!
2024-04-30 23:29:34 INFO     Epoch [13/200] train_loss: 5.3452, val_loss: 5.5740, lr: 0.003000, 7.41s
2024-04-30 23:29:34 INFO     Saved model at 13
2024-04-30 23:29:34 INFO     Val loss decrease from 5.8219 to 5.5740, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-30 23:29:41 INFO     epoch complete!
2024-04-30 23:29:41 INFO     evaluating now!
2024-04-30 23:29:42 INFO     Epoch [14/200] train_loss: 5.2504, val_loss: 5.4740, lr: 0.003000, 7.25s
2024-04-30 23:29:42 INFO     Saved model at 14
2024-04-30 23:29:42 INFO     Val loss decrease from 5.5740 to 5.4740, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 23:29:49 INFO     epoch complete!
2024-04-30 23:29:49 INFO     evaluating now!
2024-04-30 23:29:49 INFO     Epoch [15/200] train_loss: 5.1176, val_loss: 5.5166, lr: 0.003000, 7.43s
2024-04-30 23:29:56 INFO     epoch complete!
2024-04-30 23:29:56 INFO     evaluating now!
2024-04-30 23:29:57 INFO     Epoch [16/200] train_loss: 5.0917, val_loss: 5.5636, lr: 0.003000, 7.45s
2024-04-30 23:30:04 INFO     epoch complete!
2024-04-30 23:30:04 INFO     evaluating now!
2024-04-30 23:30:04 INFO     Epoch [17/200] train_loss: 4.9899, val_loss: 5.5442, lr: 0.003000, 7.42s
2024-04-30 23:30:11 INFO     epoch complete!
2024-04-30 23:30:11 INFO     evaluating now!
2024-04-30 23:30:12 INFO     Epoch [18/200] train_loss: 4.9271, val_loss: 5.3476, lr: 0.003000, 7.53s
2024-04-30 23:30:12 INFO     Saved model at 18
2024-04-30 23:30:12 INFO     Val loss decrease from 5.4740 to 5.3476, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 23:30:18 INFO     epoch complete!
2024-04-30 23:30:18 INFO     evaluating now!
2024-04-30 23:30:19 INFO     Epoch [19/200] train_loss: 4.7882, val_loss: 5.3609, lr: 0.003000, 7.16s
2024-04-30 23:30:25 INFO     epoch complete!
2024-04-30 23:30:25 INFO     evaluating now!
2024-04-30 23:30:26 INFO     Epoch [20/200] train_loss: 4.7604, val_loss: 5.5177, lr: 0.003000, 7.09s
2024-04-30 23:30:32 INFO     epoch complete!
2024-04-30 23:30:32 INFO     evaluating now!
2024-04-30 23:30:33 INFO     Epoch [21/200] train_loss: 4.7154, val_loss: 5.3010, lr: 0.003000, 7.00s
2024-04-30 23:30:33 INFO     Saved model at 21
2024-04-30 23:30:33 INFO     Val loss decrease from 5.3476 to 5.3010, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-30 23:30:39 INFO     epoch complete!
2024-04-30 23:30:39 INFO     evaluating now!
2024-04-30 23:30:40 INFO     Epoch [22/200] train_loss: 4.7128, val_loss: 5.2269, lr: 0.003000, 6.96s
2024-04-30 23:30:40 INFO     Saved model at 22
2024-04-30 23:30:40 INFO     Val loss decrease from 5.3010 to 5.2269, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-30 23:30:46 INFO     epoch complete!
2024-04-30 23:30:46 INFO     evaluating now!
2024-04-30 23:30:47 INFO     Epoch [23/200] train_loss: 4.6841, val_loss: 5.2374, lr: 0.003000, 7.05s
2024-04-30 23:30:54 INFO     epoch complete!
2024-04-30 23:30:54 INFO     evaluating now!
2024-04-30 23:30:54 INFO     Epoch [24/200] train_loss: 4.5347, val_loss: 5.0727, lr: 0.003000, 7.14s
2024-04-30 23:30:54 INFO     Saved model at 24
2024-04-30 23:30:54 INFO     Val loss decrease from 5.2269 to 5.0727, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-04-30 23:31:01 INFO     epoch complete!
2024-04-30 23:31:01 INFO     evaluating now!
2024-04-30 23:31:02 INFO     Epoch [25/200] train_loss: 4.5654, val_loss: 5.2173, lr: 0.003000, 7.77s
2024-04-30 23:31:09 INFO     epoch complete!
2024-04-30 23:31:09 INFO     evaluating now!
2024-04-30 23:31:09 INFO     Epoch [26/200] train_loss: 4.4836, val_loss: 5.0801, lr: 0.003000, 7.42s
2024-04-30 23:31:16 INFO     epoch complete!
2024-04-30 23:31:16 INFO     evaluating now!
2024-04-30 23:31:17 INFO     Epoch [27/200] train_loss: 4.3914, val_loss: 5.0181, lr: 0.003000, 7.41s
2024-04-30 23:31:17 INFO     Saved model at 27
2024-04-30 23:31:17 INFO     Val loss decrease from 5.0727 to 5.0181, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-04-30 23:31:24 INFO     epoch complete!
2024-04-30 23:31:24 INFO     evaluating now!
2024-04-30 23:31:24 INFO     Epoch [28/200] train_loss: 4.3564, val_loss: 5.2866, lr: 0.003000, 7.39s
2024-04-30 23:31:31 INFO     epoch complete!
2024-04-30 23:31:31 INFO     evaluating now!
2024-04-30 23:31:32 INFO     Epoch [29/200] train_loss: 4.3894, val_loss: 5.0877, lr: 0.003000, 7.50s
2024-04-30 23:31:39 INFO     epoch complete!
2024-04-30 23:31:39 INFO     evaluating now!
2024-04-30 23:31:39 INFO     Epoch [30/200] train_loss: 4.3335, val_loss: 5.2365, lr: 0.003000, 7.28s
2024-04-30 23:31:45 INFO     epoch complete!
2024-04-30 23:31:45 INFO     evaluating now!
2024-04-30 23:31:46 INFO     Epoch [31/200] train_loss: 4.2987, val_loss: 5.0293, lr: 0.003000, 6.85s
2024-04-30 23:31:52 INFO     epoch complete!
2024-04-30 23:31:52 INFO     evaluating now!
2024-04-30 23:31:53 INFO     Epoch [32/200] train_loss: 4.1852, val_loss: 5.1301, lr: 0.003000, 6.83s
2024-04-30 23:31:59 INFO     epoch complete!
2024-04-30 23:31:59 INFO     evaluating now!
2024-04-30 23:32:00 INFO     Epoch [33/200] train_loss: 4.1668, val_loss: 5.0591, lr: 0.003000, 6.89s
2024-04-30 23:32:06 INFO     epoch complete!
2024-04-30 23:32:06 INFO     evaluating now!
2024-04-30 23:32:06 INFO     Epoch [34/200] train_loss: 4.2027, val_loss: 5.1557, lr: 0.003000, 6.88s
2024-04-30 23:32:13 INFO     epoch complete!
2024-04-30 23:32:13 INFO     evaluating now!
2024-04-30 23:32:13 INFO     Epoch [35/200] train_loss: 4.1814, val_loss: 5.1205, lr: 0.003000, 6.90s
2024-04-30 23:32:20 INFO     epoch complete!
2024-04-30 23:32:20 INFO     evaluating now!
2024-04-30 23:32:21 INFO     Epoch [36/200] train_loss: 4.0616, val_loss: 5.1097, lr: 0.003000, 7.37s
2024-04-30 23:32:27 INFO     epoch complete!
2024-04-30 23:32:27 INFO     evaluating now!
2024-04-30 23:32:28 INFO     Epoch [37/200] train_loss: 4.0602, val_loss: 5.1007, lr: 0.003000, 7.22s
2024-04-30 23:32:35 INFO     epoch complete!
2024-04-30 23:32:35 INFO     evaluating now!
2024-04-30 23:32:35 INFO     Epoch [38/200] train_loss: 4.0054, val_loss: 5.1682, lr: 0.003000, 7.28s
2024-04-30 23:32:42 INFO     epoch complete!
2024-04-30 23:32:42 INFO     evaluating now!
2024-04-30 23:32:43 INFO     Epoch [39/200] train_loss: 3.9569, val_loss: 4.9815, lr: 0.003000, 7.35s
2024-04-30 23:32:43 INFO     Saved model at 39
2024-04-30 23:32:43 INFO     Val loss decrease from 5.0181 to 4.9815, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-04-30 23:32:50 INFO     epoch complete!
2024-04-30 23:32:50 INFO     evaluating now!
2024-04-30 23:32:50 INFO     Epoch [40/200] train_loss: 3.9606, val_loss: 5.0947, lr: 0.003000, 7.42s
2024-04-30 23:32:57 INFO     epoch complete!
2024-04-30 23:32:57 INFO     evaluating now!
2024-04-30 23:32:57 INFO     Epoch [41/200] train_loss: 3.9696, val_loss: 5.1222, lr: 0.003000, 7.31s
2024-04-30 23:33:04 INFO     epoch complete!
2024-04-30 23:33:04 INFO     evaluating now!
2024-04-30 23:33:05 INFO     Epoch [42/200] train_loss: 3.8949, val_loss: 4.9805, lr: 0.003000, 7.28s
2024-04-30 23:33:05 INFO     Saved model at 42
2024-04-30 23:33:05 INFO     Val loss decrease from 4.9815 to 4.9805, saving to ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-04-30 23:33:11 INFO     epoch complete!
2024-04-30 23:33:11 INFO     evaluating now!
2024-04-30 23:33:12 INFO     Epoch [43/200] train_loss: 3.8640, val_loss: 5.2065, lr: 0.003000, 7.19s
2024-04-30 23:33:19 INFO     epoch complete!
2024-04-30 23:33:19 INFO     evaluating now!
2024-04-30 23:33:19 INFO     Epoch [44/200] train_loss: 3.8507, val_loss: 5.0496, lr: 0.003000, 7.16s
2024-04-30 23:33:26 INFO     epoch complete!
2024-04-30 23:33:26 INFO     evaluating now!
2024-04-30 23:33:26 INFO     Epoch [45/200] train_loss: 3.8369, val_loss: 5.2545, lr: 0.003000, 7.23s
2024-04-30 23:33:33 INFO     epoch complete!
2024-04-30 23:33:33 INFO     evaluating now!
2024-04-30 23:33:34 INFO     Epoch [46/200] train_loss: 3.7923, val_loss: 5.0552, lr: 0.003000, 7.25s
2024-04-30 23:33:40 INFO     epoch complete!
2024-04-30 23:33:40 INFO     evaluating now!
2024-04-30 23:33:41 INFO     Epoch [47/200] train_loss: 3.8061, val_loss: 5.0467, lr: 0.003000, 7.22s
2024-04-30 23:33:47 INFO     epoch complete!
2024-04-30 23:33:47 INFO     evaluating now!
2024-04-30 23:33:48 INFO     Epoch [48/200] train_loss: 3.7511, val_loss: 5.0781, lr: 0.003000, 7.20s
2024-04-30 23:33:55 INFO     epoch complete!
2024-04-30 23:33:55 INFO     evaluating now!
2024-04-30 23:33:55 INFO     Epoch [49/200] train_loss: 3.7168, val_loss: 5.1222, lr: 0.003000, 7.24s
2024-04-30 23:34:02 INFO     epoch complete!
2024-04-30 23:34:02 INFO     evaluating now!
2024-04-30 23:34:02 INFO     Epoch [50/200] train_loss: 3.7054, val_loss: 5.0589, lr: 0.003000, 7.27s
2024-04-30 23:34:09 INFO     epoch complete!
2024-04-30 23:34:09 INFO     evaluating now!
2024-04-30 23:34:10 INFO     Epoch [51/200] train_loss: 3.7029, val_loss: 5.0191, lr: 0.003000, 7.13s
2024-04-30 23:34:16 INFO     epoch complete!
2024-04-30 23:34:16 INFO     evaluating now!
2024-04-30 23:34:17 INFO     Epoch [52/200] train_loss: 3.6683, val_loss: 5.0881, lr: 0.003000, 7.18s
2024-04-30 23:34:23 INFO     epoch complete!
2024-04-30 23:34:23 INFO     evaluating now!
2024-04-30 23:34:24 INFO     Epoch [53/200] train_loss: 3.6482, val_loss: 5.0703, lr: 0.003000, 7.18s
2024-04-30 23:34:31 INFO     epoch complete!
2024-04-30 23:34:31 INFO     evaluating now!
2024-04-30 23:34:31 INFO     Epoch [54/200] train_loss: 3.6929, val_loss: 5.0302, lr: 0.003000, 7.15s
2024-04-30 23:34:38 INFO     epoch complete!
2024-04-30 23:34:38 INFO     evaluating now!
2024-04-30 23:34:38 INFO     Epoch [55/200] train_loss: 3.6584, val_loss: 4.9915, lr: 0.003000, 7.28s
2024-04-30 23:34:45 INFO     epoch complete!
2024-04-30 23:34:45 INFO     evaluating now!
2024-04-30 23:34:46 INFO     Epoch [56/200] train_loss: 3.6273, val_loss: 5.0343, lr: 0.003000, 7.17s
2024-04-30 23:34:52 INFO     epoch complete!
2024-04-30 23:34:52 INFO     evaluating now!
2024-04-30 23:34:53 INFO     Epoch [57/200] train_loss: 3.5804, val_loss: 5.0808, lr: 0.003000, 7.15s
2024-04-30 23:34:53 WARNING  Early stopping at epoch: 57
2024-04-30 23:34:53 INFO     Trained totally 58 epochs, average train time is 6.765s, average eval time is 0.498s
2024-04-30 23:34:53 INFO     Loaded model at 42
2024-04-30 23:34:53 INFO     Saved model at ./libcity/cache/53/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 23:34:53 INFO     Start evaluating ...
2024-04-30 23:34:54 INFO     Note that you select the single mode to evaluate!
2024-04-30 23:34:54 INFO     Evaluate result is saved at ./libcity/cache/53/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 23:34:55 INFO     
         MAE       RMSE
1   2.223070   6.905012
2   2.322457   7.571081
3   2.535943   8.592595
4   2.663518   9.246670
5   2.804276   9.912017
6   2.875583  10.554673
7   2.943329  11.225852
8   2.982025  11.672651
9   3.008405  11.990690
10  3.119385  12.381595
11  3.201464  12.811686
12  3.297616  13.612906
2024-04-30 23:34:55 INFO     ----------------------------------------------------------------------------
2024-04-30 23:34:55 INFO     # 4, Kownledge Graph Embedding: AttH, Experiment ids: 54
2024-04-30 23:34:55 INFO     ----------------------------------------------------------------------------
2024-04-30 23:34:55 INFO     Log directory: ./libcity/log
2024-04-30 23:34:55 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=54
2024-04-30 23:34:55 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 308137050, 'exp_id': 54, 'load_external': True, 'embedding_model': 'AttH', 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-30 23:34:55 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-30 23:34:55 INFO     set_weight_link_or_dist: dist
2024-04-30 23:34:55 INFO     init_weight_inf_or_zero: inf
2024-04-30 23:34:55 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-30 23:34:55 INFO     Start Calculate the weight by Gauss kernel!
2024-04-30 23:34:55 INFO     Loading file CHITaxi20190406.dyna
2024-04-30 23:34:55 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-30 23:34:58 INFO     Dataset created
2024-04-30 23:34:58 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-04-30 23:34:58 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-04-30 23:34:58 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-04-30 23:34:58 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-04-30 23:34:58 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-30 23:34:58 INFO     NoneScaler
2024-04-30 23:35:00 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-30 23:35:00 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-30 23:35:00 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-04-30 23:35:00 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 23:35:00 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-04-30 23:35:00 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 23:35:00 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-30 23:35:00 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-30 23:35:00 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-30 23:35:00 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-30 23:35:00 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-30 23:35:00 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-30 23:35:00 INFO     Total parameter numbers: 874010
2024-04-30 23:35:00 INFO     You select `adam` optimizer.
2024-04-30 23:35:00 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-30 23:35:00 INFO     Start training ...
2024-04-30 23:35:00 INFO     num_batches:48
2024-04-30 23:35:07 INFO     epoch complete!
2024-04-30 23:35:07 INFO     evaluating now!
2024-04-30 23:35:07 INFO     Epoch [0/200] train_loss: 24.0066, val_loss: 17.5968, lr: 0.003000, 7.27s
2024-04-30 23:35:07 INFO     Saved model at 0
2024-04-30 23:35:07 INFO     Val loss decrease from inf to 17.5968, saving to ./libcity/cache/54/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-30 23:35:14 INFO     epoch complete!
2024-04-30 23:35:14 INFO     evaluating now!
2024-04-30 23:35:15 INFO     Epoch [1/200] train_loss: 14.1006, val_loss: 13.1980, lr: 0.003000, 7.28s
2024-04-30 23:35:15 INFO     Saved model at 1
2024-04-30 23:35:15 INFO     Val loss decrease from 17.5968 to 13.1980, saving to ./libcity/cache/54/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-30 23:35:22 INFO     epoch complete!
2024-04-30 23:35:22 INFO     evaluating now!
2024-04-30 23:35:22 INFO     Epoch [2/200] train_loss: 11.0155, val_loss: 10.7547, lr: 0.003000, 7.29s
2024-04-30 23:35:22 INFO     Saved model at 2
2024-04-30 23:35:22 INFO     Val loss decrease from 13.1980 to 10.7547, saving to ./libcity/cache/54/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-30 23:35:29 INFO     epoch complete!
2024-04-30 23:35:29 INFO     evaluating now!
2024-04-30 23:35:29 INFO     Epoch [3/200] train_loss: 9.2063, val_loss: 8.7465, lr: 0.003000, 7.34s
2024-04-30 23:35:29 INFO     Saved model at 3
2024-04-30 23:35:29 INFO     Val loss decrease from 10.7547 to 8.7465, saving to ./libcity/cache/54/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-30 23:35:36 INFO     epoch complete!
2024-04-30 23:35:36 INFO     evaluating now!
2024-04-30 23:35:37 INFO     Epoch [4/200] train_loss: 7.9926, val_loss: 7.6260, lr: 0.003000, 7.32s
2024-04-30 23:35:37 INFO     Saved model at 4
2024-04-30 23:35:37 INFO     Val loss decrease from 8.7465 to 7.6260, saving to ./libcity/cache/54/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-30 23:35:44 INFO     epoch complete!
2024-04-30 23:35:44 INFO     evaluating now!
2024-04-30 23:35:44 INFO     Epoch [5/200] train_loss: 7.1470, val_loss: 7.1755, lr: 0.003000, 7.34s
2024-04-30 23:35:44 INFO     Saved model at 5
2024-04-30 23:35:44 INFO     Val loss decrease from 7.6260 to 7.1755, saving to ./libcity/cache/54/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-30 23:35:51 INFO     epoch complete!
2024-04-30 23:35:51 INFO     evaluating now!
2024-04-30 23:35:52 INFO     Epoch [6/200] train_loss: 6.5826, val_loss: 6.6745, lr: 0.003000, 7.36s
2024-04-30 23:35:52 INFO     Saved model at 6
2024-04-30 23:35:52 INFO     Val loss decrease from 7.1755 to 6.6745, saving to ./libcity/cache/54/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-30 23:35:59 INFO     epoch complete!
2024-04-30 23:35:59 INFO     evaluating now!
2024-04-30 23:35:59 INFO     Epoch [7/200] train_loss: 6.4311, val_loss: 6.6939, lr: 0.003000, 7.38s
2024-04-30 23:36:06 INFO     epoch complete!
2024-04-30 23:36:06 INFO     evaluating now!
2024-04-30 23:36:06 INFO     Epoch [8/200] train_loss: 6.1114, val_loss: 6.0293, lr: 0.003000, 7.24s
2024-04-30 23:36:06 INFO     Saved model at 8
2024-04-30 23:36:06 INFO     Val loss decrease from 6.6745 to 6.0293, saving to ./libcity/cache/54/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-30 23:36:13 INFO     epoch complete!
2024-04-30 23:36:13 INFO     evaluating now!
2024-04-30 23:36:14 INFO     Epoch [9/200] train_loss: 5.8604, val_loss: 6.1108, lr: 0.003000, 7.37s
2024-04-30 23:36:21 INFO     epoch complete!
2024-04-30 23:36:21 INFO     evaluating now!
2024-04-30 23:36:21 INFO     Epoch [10/200] train_loss: 5.6087, val_loss: 5.7996, lr: 0.003000, 7.38s
2024-04-30 23:36:21 INFO     Saved model at 10
2024-04-30 23:36:21 INFO     Val loss decrease from 6.0293 to 5.7996, saving to ./libcity/cache/54/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-30 23:36:28 INFO     epoch complete!
2024-04-30 23:36:28 INFO     evaluating now!
2024-04-30 23:36:29 INFO     Epoch [11/200] train_loss: 5.4805, val_loss: 5.6890, lr: 0.003000, 7.61s
2024-04-30 23:36:29 INFO     Saved model at 11
2024-04-30 23:36:29 INFO     Val loss decrease from 5.7996 to 5.6890, saving to ./libcity/cache/54/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-30 23:36:35 INFO     epoch complete!
2024-04-30 23:36:35 INFO     evaluating now!
2024-04-30 23:36:36 INFO     Epoch [12/200] train_loss: 5.5056, val_loss: 5.6830, lr: 0.003000, 6.94s
2024-04-30 23:36:36 INFO     Saved model at 12
2024-04-30 23:36:36 INFO     Val loss decrease from 5.6890 to 5.6830, saving to ./libcity/cache/54/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-30 23:36:42 INFO     epoch complete!
2024-04-30 23:36:42 INFO     evaluating now!
2024-04-30 23:36:43 INFO     Epoch [13/200] train_loss: 5.2853, val_loss: 5.7664, lr: 0.003000, 6.91s
2024-04-30 23:36:49 INFO     epoch complete!
2024-04-30 23:36:49 INFO     evaluating now!
2024-04-30 23:36:49 INFO     Epoch [14/200] train_loss: 5.1368, val_loss: 5.4062, lr: 0.003000, 6.80s
2024-04-30 23:36:50 INFO     Saved model at 14
2024-04-30 23:36:50 INFO     Val loss decrease from 5.6830 to 5.4062, saving to ./libcity/cache/54/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-30 23:36:56 INFO     epoch complete!
2024-04-30 23:36:56 INFO     evaluating now!
2024-04-30 23:36:56 INFO     Epoch [15/200] train_loss: 5.0126, val_loss: 5.4141, lr: 0.003000, 6.85s
2024-04-30 23:37:03 INFO     epoch complete!
2024-04-30 23:37:03 INFO     evaluating now!
2024-04-30 23:37:03 INFO     Epoch [16/200] train_loss: 4.9631, val_loss: 5.5159, lr: 0.003000, 6.88s
2024-04-30 23:37:10 INFO     epoch complete!
2024-04-30 23:37:10 INFO     evaluating now!
2024-04-30 23:37:10 INFO     Epoch [17/200] train_loss: 4.9143, val_loss: 5.4831, lr: 0.003000, 6.91s
2024-04-30 23:37:17 INFO     epoch complete!
2024-04-30 23:37:17 INFO     evaluating now!
2024-04-30 23:37:18 INFO     Epoch [18/200] train_loss: 4.7895, val_loss: 5.2698, lr: 0.003000, 7.40s
2024-04-30 23:37:18 INFO     Saved model at 18
2024-04-30 23:37:18 INFO     Val loss decrease from 5.4062 to 5.2698, saving to ./libcity/cache/54/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-30 23:37:24 INFO     epoch complete!
2024-04-30 23:37:24 INFO     evaluating now!
2024-04-30 23:37:25 INFO     Epoch [19/200] train_loss: 4.6720, val_loss: 5.0837, lr: 0.003000, 7.35s
2024-04-30 23:37:25 INFO     Saved model at 19
2024-04-30 23:37:25 INFO     Val loss decrease from 5.2698 to 5.0837, saving to ./libcity/cache/54/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-04-30 23:37:32 INFO     epoch complete!
2024-04-30 23:37:32 INFO     evaluating now!
2024-04-30 23:37:32 INFO     Epoch [20/200] train_loss: 4.6847, val_loss: 5.2293, lr: 0.003000, 7.11s
2024-04-30 23:37:39 INFO     epoch complete!
2024-04-30 23:37:39 INFO     evaluating now!
2024-04-30 23:37:39 INFO     Epoch [21/200] train_loss: 4.5820, val_loss: 5.2428, lr: 0.003000, 7.30s
2024-04-30 23:37:46 INFO     epoch complete!
2024-04-30 23:37:46 INFO     evaluating now!
2024-04-30 23:37:47 INFO     Epoch [22/200] train_loss: 4.5751, val_loss: 5.4586, lr: 0.003000, 7.24s
2024-04-30 23:37:53 INFO     epoch complete!
2024-04-30 23:37:53 INFO     evaluating now!
2024-04-30 23:37:54 INFO     Epoch [23/200] train_loss: 4.5479, val_loss: 5.4031, lr: 0.003000, 7.36s
2024-04-30 23:38:01 INFO     epoch complete!
2024-04-30 23:38:01 INFO     evaluating now!
2024-04-30 23:38:02 INFO     Epoch [24/200] train_loss: 4.5132, val_loss: 5.1898, lr: 0.003000, 7.51s
2024-04-30 23:38:08 INFO     epoch complete!
2024-04-30 23:38:08 INFO     evaluating now!
2024-04-30 23:38:09 INFO     Epoch [25/200] train_loss: 4.3894, val_loss: 5.2539, lr: 0.003000, 7.49s
2024-04-30 23:38:16 INFO     epoch complete!
2024-04-30 23:38:16 INFO     evaluating now!
2024-04-30 23:38:17 INFO     Epoch [26/200] train_loss: 4.3398, val_loss: 5.2188, lr: 0.003000, 7.67s
2024-04-30 23:38:24 INFO     epoch complete!
2024-04-30 23:38:24 INFO     evaluating now!
2024-04-30 23:38:24 INFO     Epoch [27/200] train_loss: 4.2962, val_loss: 5.2506, lr: 0.003000, 7.58s
2024-04-30 23:38:31 INFO     epoch complete!
2024-04-30 23:38:31 INFO     evaluating now!
2024-04-30 23:38:32 INFO     Epoch [28/200] train_loss: 4.2549, val_loss: 5.2435, lr: 0.003000, 7.55s
2024-04-30 23:38:39 INFO     epoch complete!
2024-04-30 23:38:39 INFO     evaluating now!
2024-04-30 23:38:40 INFO     Epoch [29/200] train_loss: 4.2148, val_loss: 5.2034, lr: 0.003000, 7.80s
2024-04-30 23:38:47 INFO     epoch complete!
2024-04-30 23:38:47 INFO     evaluating now!
2024-04-30 23:38:47 INFO     Epoch [30/200] train_loss: 4.2025, val_loss: 5.0973, lr: 0.003000, 7.68s
2024-04-30 23:38:55 INFO     epoch complete!
2024-04-30 23:38:55 INFO     evaluating now!
2024-04-30 23:38:55 INFO     Epoch [31/200] train_loss: 4.1431, val_loss: 5.0762, lr: 0.003000, 7.77s
2024-04-30 23:38:55 INFO     Saved model at 31
2024-04-30 23:38:55 INFO     Val loss decrease from 5.0837 to 5.0762, saving to ./libcity/cache/54/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-04-30 23:39:02 INFO     epoch complete!
2024-04-30 23:39:02 INFO     evaluating now!
2024-04-30 23:39:03 INFO     Epoch [32/200] train_loss: 4.1027, val_loss: 5.1618, lr: 0.003000, 7.70s
2024-04-30 23:39:10 INFO     epoch complete!
2024-04-30 23:39:10 INFO     evaluating now!
2024-04-30 23:39:10 INFO     Epoch [33/200] train_loss: 4.1224, val_loss: 5.0729, lr: 0.003000, 7.64s
2024-04-30 23:39:11 INFO     Saved model at 33
2024-04-30 23:39:11 INFO     Val loss decrease from 5.0762 to 5.0729, saving to ./libcity/cache/54/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-04-30 23:39:18 INFO     epoch complete!
2024-04-30 23:39:18 INFO     evaluating now!
2024-04-30 23:39:18 INFO     Epoch [34/200] train_loss: 4.0383, val_loss: 5.1572, lr: 0.003000, 7.62s
2024-04-30 23:39:25 INFO     epoch complete!
2024-04-30 23:39:25 INFO     evaluating now!
2024-04-30 23:39:26 INFO     Epoch [35/200] train_loss: 4.0435, val_loss: 5.2043, lr: 0.003000, 7.62s
2024-04-30 23:39:33 INFO     epoch complete!
2024-04-30 23:39:33 INFO     evaluating now!
2024-04-30 23:39:33 INFO     Epoch [36/200] train_loss: 4.0429, val_loss: 5.3328, lr: 0.003000, 7.52s
2024-04-30 23:39:40 INFO     epoch complete!
2024-04-30 23:39:40 INFO     evaluating now!
2024-04-30 23:39:41 INFO     Epoch [37/200] train_loss: 4.0792, val_loss: 5.1593, lr: 0.003000, 7.68s
2024-04-30 23:39:48 INFO     epoch complete!
2024-04-30 23:39:48 INFO     evaluating now!
2024-04-30 23:39:49 INFO     Epoch [38/200] train_loss: 3.9481, val_loss: 5.1325, lr: 0.003000, 7.61s
2024-04-30 23:39:56 INFO     epoch complete!
2024-04-30 23:39:56 INFO     evaluating now!
2024-04-30 23:39:56 INFO     Epoch [39/200] train_loss: 3.9097, val_loss: 5.0665, lr: 0.003000, 7.54s
2024-04-30 23:39:56 INFO     Saved model at 39
2024-04-30 23:39:56 INFO     Val loss decrease from 5.0729 to 5.0665, saving to ./libcity/cache/54/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-04-30 23:40:03 INFO     epoch complete!
2024-04-30 23:40:03 INFO     evaluating now!
2024-04-30 23:40:04 INFO     Epoch [40/200] train_loss: 3.8937, val_loss: 5.1673, lr: 0.003000, 7.76s
2024-04-30 23:40:11 INFO     epoch complete!
2024-04-30 23:40:11 INFO     evaluating now!
2024-04-30 23:40:12 INFO     Epoch [41/200] train_loss: 3.8345, val_loss: 5.2090, lr: 0.003000, 7.66s
2024-04-30 23:40:19 INFO     epoch complete!
2024-04-30 23:40:19 INFO     evaluating now!
2024-04-30 23:40:19 INFO     Epoch [42/200] train_loss: 3.8688, val_loss: 5.2385, lr: 0.003000, 7.49s
2024-04-30 23:40:26 INFO     epoch complete!
2024-04-30 23:40:26 INFO     evaluating now!
2024-04-30 23:40:27 INFO     Epoch [43/200] train_loss: 3.8262, val_loss: 4.9646, lr: 0.003000, 7.46s
2024-04-30 23:40:27 INFO     Saved model at 43
2024-04-30 23:40:27 INFO     Val loss decrease from 5.0665 to 4.9646, saving to ./libcity/cache/54/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-04-30 23:40:34 INFO     epoch complete!
2024-04-30 23:40:34 INFO     evaluating now!
2024-04-30 23:40:34 INFO     Epoch [44/200] train_loss: 3.7580, val_loss: 5.1895, lr: 0.003000, 7.50s
2024-04-30 23:40:41 INFO     epoch complete!
2024-04-30 23:40:41 INFO     evaluating now!
2024-04-30 23:40:42 INFO     Epoch [45/200] train_loss: 3.7360, val_loss: 5.0706, lr: 0.003000, 7.50s
2024-04-30 23:40:49 INFO     epoch complete!
2024-04-30 23:40:49 INFO     evaluating now!
2024-04-30 23:40:49 INFO     Epoch [46/200] train_loss: 3.8008, val_loss: 5.0842, lr: 0.003000, 7.57s
2024-04-30 23:40:56 INFO     epoch complete!
2024-04-30 23:40:56 INFO     evaluating now!
2024-04-30 23:40:57 INFO     Epoch [47/200] train_loss: 3.8688, val_loss: 5.1044, lr: 0.003000, 7.55s
2024-04-30 23:41:04 INFO     epoch complete!
2024-04-30 23:41:04 INFO     evaluating now!
2024-04-30 23:41:04 INFO     Epoch [48/200] train_loss: 3.8416, val_loss: 4.9783, lr: 0.003000, 7.34s
2024-04-30 23:41:10 INFO     epoch complete!
2024-04-30 23:41:10 INFO     evaluating now!
2024-04-30 23:41:11 INFO     Epoch [49/200] train_loss: 3.6630, val_loss: 5.1516, lr: 0.003000, 6.56s
2024-04-30 23:41:17 INFO     epoch complete!
2024-04-30 23:41:17 INFO     evaluating now!
2024-04-30 23:41:17 INFO     Epoch [50/200] train_loss: 3.6378, val_loss: 5.0389, lr: 0.003000, 6.56s
2024-04-30 23:41:23 INFO     epoch complete!
2024-04-30 23:41:23 INFO     evaluating now!
2024-04-30 23:41:24 INFO     Epoch [51/200] train_loss: 3.6938, val_loss: 5.1948, lr: 0.003000, 6.51s
2024-04-30 23:41:30 INFO     epoch complete!
2024-04-30 23:41:30 INFO     evaluating now!
2024-04-30 23:41:30 INFO     Epoch [52/200] train_loss: 3.6138, val_loss: 5.0538, lr: 0.003000, 6.54s
2024-04-30 23:41:36 INFO     epoch complete!
2024-04-30 23:41:36 INFO     evaluating now!
2024-04-30 23:41:37 INFO     Epoch [53/200] train_loss: 3.6281, val_loss: 5.0940, lr: 0.003000, 6.50s
2024-04-30 23:41:43 INFO     epoch complete!
2024-04-30 23:41:43 INFO     evaluating now!
2024-04-30 23:41:43 INFO     Epoch [54/200] train_loss: 3.5988, val_loss: 5.1750, lr: 0.003000, 6.54s
2024-04-30 23:41:49 INFO     epoch complete!
2024-04-30 23:41:49 INFO     evaluating now!
2024-04-30 23:41:50 INFO     Epoch [55/200] train_loss: 3.6069, val_loss: 5.0692, lr: 0.003000, 6.69s
2024-04-30 23:41:56 INFO     epoch complete!
2024-04-30 23:41:56 INFO     evaluating now!
2024-04-30 23:41:57 INFO     Epoch [56/200] train_loss: 3.6045, val_loss: 5.0722, lr: 0.003000, 6.56s
2024-04-30 23:42:03 INFO     epoch complete!
2024-04-30 23:42:03 INFO     evaluating now!
2024-04-30 23:42:03 INFO     Epoch [57/200] train_loss: 3.5510, val_loss: 5.1095, lr: 0.003000, 6.61s
2024-04-30 23:42:09 INFO     epoch complete!
2024-04-30 23:42:09 INFO     evaluating now!
2024-04-30 23:42:10 INFO     Epoch [58/200] train_loss: 3.5156, val_loss: 5.0301, lr: 0.003000, 6.58s
2024-04-30 23:42:10 WARNING  Early stopping at epoch: 58
2024-04-30 23:42:10 INFO     Trained totally 59 epochs, average train time is 6.764s, average eval time is 0.498s
2024-04-30 23:42:10 INFO     Loaded model at 43
2024-04-30 23:42:10 INFO     Saved model at ./libcity/cache/54/model_cache/AGCRN_CHITaxi20190406.m
2024-04-30 23:42:10 INFO     Start evaluating ...
2024-04-30 23:42:11 INFO     Note that you select the single mode to evaluate!
2024-04-30 23:42:11 INFO     Evaluate result is saved at ./libcity/cache/54/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-30 23:42:11 INFO     
         MAE       RMSE
1   2.436033   7.564979
2   2.530359   8.153515
3   2.675845   8.881872
4   2.737652   9.325113
5   2.833435   9.998899
6   3.006320  10.983059
7   3.080025  11.979236
8   3.188196  12.539822
9   3.232924  12.772102
10  3.253022  12.960331
11  3.257806  13.001451
12  3.377190  13.459512
2024-04-30 23:42:11 INFO     ----------------------------------------------------------------------------
2024-04-30 23:42:11 INFO     Kownledge Graph Embedding: AttH, Experiment ids: [50, 51, 52, 53, 54]
2024-04-30 23:42:12 INFO     ----------------------------------------------------------------------------
2024-04-30 23:42:12 INFO     Average: 
         MAE       RMSE
0   2.350287   7.306873
1   2.446912   7.863341
2   2.611054   8.684200
3   2.763252   9.365638
4   2.916161  10.240002
5   3.041715  11.227465
6   3.133516  12.171280
7   3.199296  12.779890
8   3.217769  12.982910
9   3.270805  13.156889
10  3.331200  13.343570
11  3.451906  13.924223 
2024-04-30 23:42:12 INFO     Standard deviation: 
         MAE      RMSE
0   0.084972  0.388245
1   0.094804  0.250551
2   0.058993  0.108136
3   0.063841  0.107928
4   0.086980  0.357661
5   0.095067  0.607677
6   0.113871  0.789451
7   0.117703  0.944360
8   0.108499  0.820162
9   0.088887  0.686159
10  0.101806  0.566937
11  0.115029  0.547111
2024-04-30 23:42:12 INFO     ----------------------------------------------------------------------------
2024-04-30 23:42:12 INFO     12 steps Average: 
        MAE      RMSE
0  2.977823  11.08719
2024-04-30 23:42:12 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.094204  0.514531
