2024-09-03 11:07:28 INFO     Saving logs in: ./logs/CHITaxi20190406\AGCRN\ExtTime\
2024-09-03 11:07:28 INFO     ----------------------------------------------------------------------------
2024-09-03 11:07:28 INFO     # 0, Kownledge Graph Embedding: Normal, Experiment ids: 100
2024-09-03 11:07:28 INFO     ----------------------------------------------------------------------------
2024-09-03 11:07:28 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=100
2024-09-03 11:07:28 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 100, 'add_time_in_day': True, 'add_day_in_week': True, 'load_external': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-03 11:07:28 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-03 11:07:28 INFO     set_weight_link_or_dist: dist
2024-09-03 11:07:28 INFO     init_weight_inf_or_zero: inf
2024-09-03 11:07:28 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-03 11:07:28 INFO     Start Calculate the weight by Gauss kernel!
2024-09-03 11:07:28 INFO     Loading file CHITaxi20190406.dyna
2024-09-03 11:07:28 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-03 11:07:29 INFO     Dataset created
2024-09-03 11:07:29 INFO     x shape: (4345, 12, 77, 10), y shape: (4345, 12, 77, 10)
2024-09-03 11:07:29 INFO     train	x: (3042, 12, 77, 10), y: (3042, 12, 77, 10)
2024-09-03 11:07:29 INFO     eval	x: (434, 12, 77, 10), y: (434, 12, 77, 10)
2024-09-03 11:07:29 INFO     test	x: (869, 12, 77, 10), y: (869, 12, 77, 10)
2024-09-03 11:07:29 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-03 11:07:29 INFO     NoneScaler
2024-09-03 11:07:30 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-03 11:07:30 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-03 11:07:30 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 74, 128])	cuda:0	True
2024-09-03 11:07:30 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 11:07:30 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 74, 64])	cuda:0	True
2024-09-03 11:07:30 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 11:07:30 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-03 11:07:30 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 11:07:30 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-03 11:07:30 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 11:07:30 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-03 11:07:30 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-03 11:07:30 INFO     Total parameter numbers: 781850
2024-09-03 11:07:30 INFO     You select `adam` optimizer.
2024-09-03 11:07:30 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-03 11:07:30 INFO     Start training ...
2024-09-03 11:07:30 INFO     num_batches:48
2024-09-03 11:07:36 INFO     epoch complete!
2024-09-03 11:07:36 INFO     evaluating now!
2024-09-03 11:07:37 INFO     Epoch [0/200] train_loss: 23.2790, val_loss: 17.0305, lr: 0.003000, 6.26s
2024-09-03 11:07:37 INFO     Saved model at 0
2024-09-03 11:07:37 INFO     Val loss decrease from inf to 17.0305, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-03 11:07:41 INFO     epoch complete!
2024-09-03 11:07:41 INFO     evaluating now!
2024-09-03 11:07:41 INFO     Epoch [1/200] train_loss: 13.6341, val_loss: 12.9126, lr: 0.003000, 4.70s
2024-09-03 11:07:41 INFO     Saved model at 1
2024-09-03 11:07:41 INFO     Val loss decrease from 17.0305 to 12.9126, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-03 11:07:46 INFO     epoch complete!
2024-09-03 11:07:46 INFO     evaluating now!
2024-09-03 11:07:46 INFO     Epoch [2/200] train_loss: 11.3072, val_loss: 10.5331, lr: 0.003000, 4.63s
2024-09-03 11:07:46 INFO     Saved model at 2
2024-09-03 11:07:46 INFO     Val loss decrease from 12.9126 to 10.5331, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-03 11:07:50 INFO     epoch complete!
2024-09-03 11:07:50 INFO     evaluating now!
2024-09-03 11:07:51 INFO     Epoch [3/200] train_loss: 8.7394, val_loss: 8.3105, lr: 0.003000, 4.62s
2024-09-03 11:07:51 INFO     Saved model at 3
2024-09-03 11:07:51 INFO     Val loss decrease from 10.5331 to 8.3105, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-03 11:07:55 INFO     epoch complete!
2024-09-03 11:07:55 INFO     evaluating now!
2024-09-03 11:07:55 INFO     Epoch [4/200] train_loss: 7.4014, val_loss: 7.2846, lr: 0.003000, 4.73s
2024-09-03 11:07:55 INFO     Saved model at 4
2024-09-03 11:07:55 INFO     Val loss decrease from 8.3105 to 7.2846, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-03 11:08:00 INFO     epoch complete!
2024-09-03 11:08:00 INFO     evaluating now!
2024-09-03 11:08:00 INFO     Epoch [5/200] train_loss: 6.5368, val_loss: 6.2690, lr: 0.003000, 4.76s
2024-09-03 11:08:00 INFO     Saved model at 5
2024-09-03 11:08:00 INFO     Val loss decrease from 7.2846 to 6.2690, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-03 11:08:05 INFO     epoch complete!
2024-09-03 11:08:05 INFO     evaluating now!
2024-09-03 11:08:05 INFO     Epoch [6/200] train_loss: 6.0338, val_loss: 6.1203, lr: 0.003000, 4.70s
2024-09-03 11:08:05 INFO     Saved model at 6
2024-09-03 11:08:05 INFO     Val loss decrease from 6.2690 to 6.1203, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-03 11:08:10 INFO     epoch complete!
2024-09-03 11:08:10 INFO     evaluating now!
2024-09-03 11:08:10 INFO     Epoch [7/200] train_loss: 5.7622, val_loss: 5.8595, lr: 0.003000, 4.82s
2024-09-03 11:08:10 INFO     Saved model at 7
2024-09-03 11:08:10 INFO     Val loss decrease from 6.1203 to 5.8595, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-03 11:08:14 INFO     epoch complete!
2024-09-03 11:08:14 INFO     evaluating now!
2024-09-03 11:08:15 INFO     Epoch [8/200] train_loss: 5.5022, val_loss: 5.5901, lr: 0.003000, 4.85s
2024-09-03 11:08:15 INFO     Saved model at 8
2024-09-03 11:08:15 INFO     Val loss decrease from 5.8595 to 5.5901, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-03 11:08:19 INFO     epoch complete!
2024-09-03 11:08:19 INFO     evaluating now!
2024-09-03 11:08:19 INFO     Epoch [9/200] train_loss: 5.3764, val_loss: 5.5782, lr: 0.003000, 4.79s
2024-09-03 11:08:19 INFO     Saved model at 9
2024-09-03 11:08:19 INFO     Val loss decrease from 5.5901 to 5.5782, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-03 11:08:24 INFO     epoch complete!
2024-09-03 11:08:24 INFO     evaluating now!
2024-09-03 11:08:24 INFO     Epoch [10/200] train_loss: 5.1295, val_loss: 5.3592, lr: 0.003000, 4.72s
2024-09-03 11:08:24 INFO     Saved model at 10
2024-09-03 11:08:24 INFO     Val loss decrease from 5.5782 to 5.3592, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-03 11:08:29 INFO     epoch complete!
2024-09-03 11:08:29 INFO     evaluating now!
2024-09-03 11:08:29 INFO     Epoch [11/200] train_loss: 5.0364, val_loss: 5.2378, lr: 0.003000, 4.69s
2024-09-03 11:08:29 INFO     Saved model at 11
2024-09-03 11:08:29 INFO     Val loss decrease from 5.3592 to 5.2378, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-03 11:08:33 INFO     epoch complete!
2024-09-03 11:08:33 INFO     evaluating now!
2024-09-03 11:08:34 INFO     Epoch [12/200] train_loss: 4.8526, val_loss: 5.2170, lr: 0.003000, 4.81s
2024-09-03 11:08:34 INFO     Saved model at 12
2024-09-03 11:08:34 INFO     Val loss decrease from 5.2378 to 5.2170, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-03 11:08:38 INFO     epoch complete!
2024-09-03 11:08:38 INFO     evaluating now!
2024-09-03 11:08:39 INFO     Epoch [13/200] train_loss: 4.7366, val_loss: 4.9470, lr: 0.003000, 4.80s
2024-09-03 11:08:39 INFO     Saved model at 13
2024-09-03 11:08:39 INFO     Val loss decrease from 5.2170 to 4.9470, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-03 11:08:43 INFO     epoch complete!
2024-09-03 11:08:43 INFO     evaluating now!
2024-09-03 11:08:43 INFO     Epoch [14/200] train_loss: 4.6906, val_loss: 5.2774, lr: 0.003000, 4.79s
2024-09-03 11:08:48 INFO     epoch complete!
2024-09-03 11:08:48 INFO     evaluating now!
2024-09-03 11:08:48 INFO     Epoch [15/200] train_loss: 4.6168, val_loss: 4.8892, lr: 0.003000, 4.68s
2024-09-03 11:08:48 INFO     Saved model at 15
2024-09-03 11:08:48 INFO     Val loss decrease from 4.9470 to 4.8892, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-03 11:08:52 INFO     epoch complete!
2024-09-03 11:08:52 INFO     evaluating now!
2024-09-03 11:08:53 INFO     Epoch [16/200] train_loss: 4.5459, val_loss: 4.9011, lr: 0.003000, 4.71s
2024-09-03 11:08:57 INFO     epoch complete!
2024-09-03 11:08:57 INFO     evaluating now!
2024-09-03 11:08:57 INFO     Epoch [17/200] train_loss: 4.4854, val_loss: 4.8730, lr: 0.003000, 4.68s
2024-09-03 11:08:57 INFO     Saved model at 17
2024-09-03 11:08:57 INFO     Val loss decrease from 4.8892 to 4.8730, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-03 11:09:02 INFO     epoch complete!
2024-09-03 11:09:02 INFO     evaluating now!
2024-09-03 11:09:02 INFO     Epoch [18/200] train_loss: 4.4447, val_loss: 4.7699, lr: 0.003000, 4.70s
2024-09-03 11:09:02 INFO     Saved model at 18
2024-09-03 11:09:02 INFO     Val loss decrease from 4.8730 to 4.7699, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-03 11:09:07 INFO     epoch complete!
2024-09-03 11:09:07 INFO     evaluating now!
2024-09-03 11:09:07 INFO     Epoch [19/200] train_loss: 4.3352, val_loss: 4.7451, lr: 0.003000, 4.75s
2024-09-03 11:09:07 INFO     Saved model at 19
2024-09-03 11:09:07 INFO     Val loss decrease from 4.7699 to 4.7451, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-03 11:09:11 INFO     epoch complete!
2024-09-03 11:09:11 INFO     evaluating now!
2024-09-03 11:09:12 INFO     Epoch [20/200] train_loss: 4.2636, val_loss: 4.7728, lr: 0.003000, 4.67s
2024-09-03 11:09:16 INFO     epoch complete!
2024-09-03 11:09:16 INFO     evaluating now!
2024-09-03 11:09:16 INFO     Epoch [21/200] train_loss: 4.1642, val_loss: 4.7901, lr: 0.003000, 4.65s
2024-09-03 11:09:21 INFO     epoch complete!
2024-09-03 11:09:21 INFO     evaluating now!
2024-09-03 11:09:21 INFO     Epoch [22/200] train_loss: 4.2090, val_loss: 4.7739, lr: 0.003000, 4.74s
2024-09-03 11:09:25 INFO     epoch complete!
2024-09-03 11:09:25 INFO     evaluating now!
2024-09-03 11:09:26 INFO     Epoch [23/200] train_loss: 4.1400, val_loss: 4.7304, lr: 0.003000, 4.70s
2024-09-03 11:09:26 INFO     Saved model at 23
2024-09-03 11:09:26 INFO     Val loss decrease from 4.7451 to 4.7304, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-03 11:09:30 INFO     epoch complete!
2024-09-03 11:09:30 INFO     evaluating now!
2024-09-03 11:09:30 INFO     Epoch [24/200] train_loss: 4.0927, val_loss: 4.8663, lr: 0.003000, 4.78s
2024-09-03 11:09:35 INFO     epoch complete!
2024-09-03 11:09:35 INFO     evaluating now!
2024-09-03 11:09:35 INFO     Epoch [25/200] train_loss: 4.0177, val_loss: 4.7132, lr: 0.003000, 4.71s
2024-09-03 11:09:35 INFO     Saved model at 25
2024-09-03 11:09:35 INFO     Val loss decrease from 4.7304 to 4.7132, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-03 11:09:40 INFO     epoch complete!
2024-09-03 11:09:40 INFO     evaluating now!
2024-09-03 11:09:40 INFO     Epoch [26/200] train_loss: 3.9638, val_loss: 4.7306, lr: 0.003000, 4.69s
2024-09-03 11:09:44 INFO     epoch complete!
2024-09-03 11:09:44 INFO     evaluating now!
2024-09-03 11:09:45 INFO     Epoch [27/200] train_loss: 3.9622, val_loss: 4.7237, lr: 0.003000, 4.73s
2024-09-03 11:09:49 INFO     epoch complete!
2024-09-03 11:09:49 INFO     evaluating now!
2024-09-03 11:09:49 INFO     Epoch [28/200] train_loss: 3.9687, val_loss: 4.7548, lr: 0.003000, 4.67s
2024-09-03 11:09:54 INFO     epoch complete!
2024-09-03 11:09:54 INFO     evaluating now!
2024-09-03 11:09:54 INFO     Epoch [29/200] train_loss: 3.9024, val_loss: 4.6950, lr: 0.003000, 4.70s
2024-09-03 11:09:54 INFO     Saved model at 29
2024-09-03 11:09:54 INFO     Val loss decrease from 4.7132 to 4.6950, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-03 11:09:58 INFO     epoch complete!
2024-09-03 11:09:58 INFO     evaluating now!
2024-09-03 11:09:59 INFO     Epoch [30/200] train_loss: 3.8695, val_loss: 4.6363, lr: 0.003000, 4.70s
2024-09-03 11:09:59 INFO     Saved model at 30
2024-09-03 11:09:59 INFO     Val loss decrease from 4.6950 to 4.6363, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-09-03 11:10:03 INFO     epoch complete!
2024-09-03 11:10:03 INFO     evaluating now!
2024-09-03 11:10:03 INFO     Epoch [31/200] train_loss: 3.8223, val_loss: 4.9305, lr: 0.003000, 4.70s
2024-09-03 11:10:08 INFO     epoch complete!
2024-09-03 11:10:08 INFO     evaluating now!
2024-09-03 11:10:08 INFO     Epoch [32/200] train_loss: 3.8097, val_loss: 4.6511, lr: 0.003000, 4.69s
2024-09-03 11:10:13 INFO     epoch complete!
2024-09-03 11:10:13 INFO     evaluating now!
2024-09-03 11:10:13 INFO     Epoch [33/200] train_loss: 3.7976, val_loss: 4.6614, lr: 0.003000, 4.75s
2024-09-03 11:10:17 INFO     epoch complete!
2024-09-03 11:10:17 INFO     evaluating now!
2024-09-03 11:10:18 INFO     Epoch [34/200] train_loss: 3.7766, val_loss: 4.6431, lr: 0.003000, 4.81s
2024-09-03 11:10:22 INFO     epoch complete!
2024-09-03 11:10:22 INFO     evaluating now!
2024-09-03 11:10:22 INFO     Epoch [35/200] train_loss: 3.7560, val_loss: 4.6425, lr: 0.003000, 4.78s
2024-09-03 11:10:27 INFO     epoch complete!
2024-09-03 11:10:27 INFO     evaluating now!
2024-09-03 11:10:27 INFO     Epoch [36/200] train_loss: 3.7318, val_loss: 4.8066, lr: 0.003000, 4.72s
2024-09-03 11:10:32 INFO     epoch complete!
2024-09-03 11:10:32 INFO     evaluating now!
2024-09-03 11:10:32 INFO     Epoch [37/200] train_loss: 3.6890, val_loss: 4.6196, lr: 0.003000, 4.70s
2024-09-03 11:10:32 INFO     Saved model at 37
2024-09-03 11:10:32 INFO     Val loss decrease from 4.6363 to 4.6196, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-09-03 11:10:36 INFO     epoch complete!
2024-09-03 11:10:36 INFO     evaluating now!
2024-09-03 11:10:37 INFO     Epoch [38/200] train_loss: 3.6472, val_loss: 4.6810, lr: 0.003000, 4.68s
2024-09-03 11:10:41 INFO     epoch complete!
2024-09-03 11:10:41 INFO     evaluating now!
2024-09-03 11:10:41 INFO     Epoch [39/200] train_loss: 3.6483, val_loss: 4.7201, lr: 0.003000, 4.68s
2024-09-03 11:10:46 INFO     epoch complete!
2024-09-03 11:10:46 INFO     evaluating now!
2024-09-03 11:10:46 INFO     Epoch [40/200] train_loss: 3.6221, val_loss: 4.7053, lr: 0.003000, 4.67s
2024-09-03 11:10:50 INFO     epoch complete!
2024-09-03 11:10:50 INFO     evaluating now!
2024-09-03 11:10:51 INFO     Epoch [41/200] train_loss: 3.5829, val_loss: 4.5609, lr: 0.003000, 4.67s
2024-09-03 11:10:51 INFO     Saved model at 41
2024-09-03 11:10:51 INFO     Val loss decrease from 4.6196 to 4.5609, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-09-03 11:10:55 INFO     epoch complete!
2024-09-03 11:10:55 INFO     evaluating now!
2024-09-03 11:10:55 INFO     Epoch [42/200] train_loss: 3.5799, val_loss: 4.7995, lr: 0.003000, 4.67s
2024-09-03 11:11:00 INFO     epoch complete!
2024-09-03 11:11:00 INFO     evaluating now!
2024-09-03 11:11:00 INFO     Epoch [43/200] train_loss: 3.5783, val_loss: 4.6190, lr: 0.003000, 4.66s
2024-09-03 11:11:04 INFO     epoch complete!
2024-09-03 11:11:04 INFO     evaluating now!
2024-09-03 11:11:05 INFO     Epoch [44/200] train_loss: 3.5621, val_loss: 4.6375, lr: 0.003000, 4.68s
2024-09-03 11:11:09 INFO     epoch complete!
2024-09-03 11:11:09 INFO     evaluating now!
2024-09-03 11:11:09 INFO     Epoch [45/200] train_loss: 3.5470, val_loss: 4.6978, lr: 0.003000, 4.68s
2024-09-03 11:11:14 INFO     epoch complete!
2024-09-03 11:11:14 INFO     evaluating now!
2024-09-03 11:11:14 INFO     Epoch [46/200] train_loss: 3.4994, val_loss: 4.6173, lr: 0.003000, 4.67s
2024-09-03 11:11:18 INFO     epoch complete!
2024-09-03 11:11:18 INFO     evaluating now!
2024-09-03 11:11:19 INFO     Epoch [47/200] train_loss: 3.4880, val_loss: 4.6688, lr: 0.003000, 4.67s
2024-09-03 11:11:23 INFO     epoch complete!
2024-09-03 11:11:23 INFO     evaluating now!
2024-09-03 11:11:23 INFO     Epoch [48/200] train_loss: 3.4635, val_loss: 4.6872, lr: 0.003000, 4.67s
2024-09-03 11:11:28 INFO     epoch complete!
2024-09-03 11:11:28 INFO     evaluating now!
2024-09-03 11:11:28 INFO     Epoch [49/200] train_loss: 3.5083, val_loss: 4.5992, lr: 0.003000, 4.68s
2024-09-03 11:11:32 INFO     epoch complete!
2024-09-03 11:11:32 INFO     evaluating now!
2024-09-03 11:11:33 INFO     Epoch [50/200] train_loss: 3.4737, val_loss: 4.6591, lr: 0.003000, 4.68s
2024-09-03 11:11:37 INFO     epoch complete!
2024-09-03 11:11:37 INFO     evaluating now!
2024-09-03 11:11:37 INFO     Epoch [51/200] train_loss: 3.4134, val_loss: 4.6552, lr: 0.003000, 4.66s
2024-09-03 11:11:42 INFO     epoch complete!
2024-09-03 11:11:42 INFO     evaluating now!
2024-09-03 11:11:42 INFO     Epoch [52/200] train_loss: 3.4187, val_loss: 4.6599, lr: 0.003000, 4.68s
2024-09-03 11:11:46 INFO     epoch complete!
2024-09-03 11:11:46 INFO     evaluating now!
2024-09-03 11:11:47 INFO     Epoch [53/200] train_loss: 3.3987, val_loss: 4.7748, lr: 0.003000, 4.67s
2024-09-03 11:11:51 INFO     epoch complete!
2024-09-03 11:11:51 INFO     evaluating now!
2024-09-03 11:11:51 INFO     Epoch [54/200] train_loss: 3.3763, val_loss: 4.6689, lr: 0.003000, 4.69s
2024-09-03 11:11:56 INFO     epoch complete!
2024-09-03 11:11:56 INFO     evaluating now!
2024-09-03 11:11:56 INFO     Epoch [55/200] train_loss: 3.3689, val_loss: 4.6958, lr: 0.003000, 4.68s
2024-09-03 11:12:00 INFO     epoch complete!
2024-09-03 11:12:00 INFO     evaluating now!
2024-09-03 11:12:01 INFO     Epoch [56/200] train_loss: 3.3419, val_loss: 4.7246, lr: 0.003000, 4.67s
2024-09-03 11:12:01 WARNING  Early stopping at epoch: 56
2024-09-03 11:12:01 INFO     Trained totally 57 epochs, average train time is 4.485s, average eval time is 0.250s
2024-09-03 11:12:01 INFO     Loaded model at 41
2024-09-03 11:12:01 INFO     Saved model at ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406.m
2024-09-03 11:12:01 INFO     Start evaluating ...
2024-09-03 11:12:02 INFO     Note that you select the single mode to evaluate!
2024-09-03 11:12:02 INFO     Evaluate result is saved at ./libcity/cache/100/evaluate_cache\2024_09_03_11_12_02_AGCRN_CHITaxi20190406.csv
2024-09-03 11:12:02 INFO     
         MAE       RMSE
1   2.487137   7.710840
2   2.530560   8.394050
3   2.641030   9.135141
4   2.723725   9.464593
5   2.755433   9.677829
6   2.789922   9.690487
7   2.842256   9.770857
8   2.859252   9.876903
9   2.914517  10.071144
10  2.938045  10.280336
11  2.964923  10.445092
12  2.973023  10.774804
2024-09-03 11:12:02 INFO     ----------------------------------------------------------------------------
2024-09-03 11:12:02 INFO     # 1, Kownledge Graph Embedding: Normal, Experiment ids: 101
2024-09-03 11:12:02 INFO     ----------------------------------------------------------------------------
2024-09-03 11:12:02 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=100
2024-09-03 11:12:02 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 100, 'add_time_in_day': True, 'add_day_in_week': True, 'load_external': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-03 11:12:02 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-03 11:12:02 INFO     set_weight_link_or_dist: dist
2024-09-03 11:12:02 INFO     init_weight_inf_or_zero: inf
2024-09-03 11:12:02 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-03 11:12:02 INFO     Start Calculate the weight by Gauss kernel!
2024-09-03 11:12:02 INFO     Loading file CHITaxi20190406.dyna
2024-09-03 11:12:02 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-03 11:12:02 INFO     Dataset created
2024-09-03 11:12:02 INFO     x shape: (4345, 12, 77, 10), y shape: (4345, 12, 77, 10)
2024-09-03 11:12:02 INFO     train	x: (3042, 12, 77, 10), y: (3042, 12, 77, 10)
2024-09-03 11:12:02 INFO     eval	x: (434, 12, 77, 10), y: (434, 12, 77, 10)
2024-09-03 11:12:02 INFO     test	x: (869, 12, 77, 10), y: (869, 12, 77, 10)
2024-09-03 11:12:03 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-03 11:12:03 INFO     NoneScaler
2024-09-03 11:12:03 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-03 11:12:03 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-03 11:12:03 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 74, 128])	cuda:0	True
2024-09-03 11:12:03 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 11:12:03 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 74, 64])	cuda:0	True
2024-09-03 11:12:03 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 11:12:03 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-03 11:12:03 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 11:12:03 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-03 11:12:03 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 11:12:03 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-03 11:12:03 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-03 11:12:03 INFO     Total parameter numbers: 781850
2024-09-03 11:12:03 INFO     You select `adam` optimizer.
2024-09-03 11:12:03 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-03 11:12:03 INFO     Start training ...
2024-09-03 11:12:03 INFO     num_batches:48
2024-09-03 11:12:08 INFO     epoch complete!
2024-09-03 11:12:08 INFO     evaluating now!
2024-09-03 11:12:08 INFO     Epoch [0/200] train_loss: 24.5410, val_loss: 17.4591, lr: 0.003000, 4.88s
2024-09-03 11:12:08 INFO     Saved model at 0
2024-09-03 11:12:08 INFO     Val loss decrease from inf to 17.4591, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-03 11:12:12 INFO     epoch complete!
2024-09-03 11:12:12 INFO     evaluating now!
2024-09-03 11:12:13 INFO     Epoch [1/200] train_loss: 13.6473, val_loss: 12.4989, lr: 0.003000, 4.68s
2024-09-03 11:12:13 INFO     Saved model at 1
2024-09-03 11:12:13 INFO     Val loss decrease from 17.4591 to 12.4989, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-03 11:12:17 INFO     epoch complete!
2024-09-03 11:12:17 INFO     evaluating now!
2024-09-03 11:12:17 INFO     Epoch [2/200] train_loss: 10.1802, val_loss: 9.9209, lr: 0.003000, 4.67s
2024-09-03 11:12:17 INFO     Saved model at 2
2024-09-03 11:12:17 INFO     Val loss decrease from 12.4989 to 9.9209, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-03 11:12:22 INFO     epoch complete!
2024-09-03 11:12:22 INFO     evaluating now!
2024-09-03 11:12:22 INFO     Epoch [3/200] train_loss: 8.2756, val_loss: 7.6349, lr: 0.003000, 4.69s
2024-09-03 11:12:22 INFO     Saved model at 3
2024-09-03 11:12:22 INFO     Val loss decrease from 9.9209 to 7.6349, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-03 11:12:26 INFO     epoch complete!
2024-09-03 11:12:26 INFO     evaluating now!
2024-09-03 11:12:27 INFO     Epoch [4/200] train_loss: 7.1724, val_loss: 6.8301, lr: 0.003000, 4.68s
2024-09-03 11:12:27 INFO     Saved model at 4
2024-09-03 11:12:27 INFO     Val loss decrease from 7.6349 to 6.8301, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-03 11:12:31 INFO     epoch complete!
2024-09-03 11:12:31 INFO     evaluating now!
2024-09-03 11:12:31 INFO     Epoch [5/200] train_loss: 6.4129, val_loss: 6.1695, lr: 0.003000, 4.65s
2024-09-03 11:12:31 INFO     Saved model at 5
2024-09-03 11:12:31 INFO     Val loss decrease from 6.8301 to 6.1695, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-03 11:12:36 INFO     epoch complete!
2024-09-03 11:12:36 INFO     evaluating now!
2024-09-03 11:12:36 INFO     Epoch [6/200] train_loss: 6.0221, val_loss: 6.2846, lr: 0.003000, 4.68s
2024-09-03 11:12:40 INFO     epoch complete!
2024-09-03 11:12:40 INFO     evaluating now!
2024-09-03 11:12:41 INFO     Epoch [7/200] train_loss: 5.7299, val_loss: 5.7239, lr: 0.003000, 4.66s
2024-09-03 11:12:41 INFO     Saved model at 7
2024-09-03 11:12:41 INFO     Val loss decrease from 6.1695 to 5.7239, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-03 11:12:45 INFO     epoch complete!
2024-09-03 11:12:45 INFO     evaluating now!
2024-09-03 11:12:45 INFO     Epoch [8/200] train_loss: 5.3980, val_loss: 5.5117, lr: 0.003000, 4.65s
2024-09-03 11:12:45 INFO     Saved model at 8
2024-09-03 11:12:45 INFO     Val loss decrease from 5.7239 to 5.5117, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-03 11:12:50 INFO     epoch complete!
2024-09-03 11:12:50 INFO     evaluating now!
2024-09-03 11:12:50 INFO     Epoch [9/200] train_loss: 5.1702, val_loss: 5.6034, lr: 0.003000, 4.65s
2024-09-03 11:12:54 INFO     epoch complete!
2024-09-03 11:12:54 INFO     evaluating now!
2024-09-03 11:12:55 INFO     Epoch [10/200] train_loss: 5.0979, val_loss: 5.3181, lr: 0.003000, 4.65s
2024-09-03 11:12:55 INFO     Saved model at 10
2024-09-03 11:12:55 INFO     Val loss decrease from 5.5117 to 5.3181, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-03 11:12:59 INFO     epoch complete!
2024-09-03 11:12:59 INFO     evaluating now!
2024-09-03 11:12:59 INFO     Epoch [11/200] train_loss: 4.8848, val_loss: 5.1553, lr: 0.003000, 4.66s
2024-09-03 11:12:59 INFO     Saved model at 11
2024-09-03 11:12:59 INFO     Val loss decrease from 5.3181 to 5.1553, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-03 11:13:04 INFO     epoch complete!
2024-09-03 11:13:04 INFO     evaluating now!
2024-09-03 11:13:04 INFO     Epoch [12/200] train_loss: 4.7941, val_loss: 5.0811, lr: 0.003000, 4.66s
2024-09-03 11:13:04 INFO     Saved model at 12
2024-09-03 11:13:04 INFO     Val loss decrease from 5.1553 to 5.0811, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-03 11:13:08 INFO     epoch complete!
2024-09-03 11:13:08 INFO     evaluating now!
2024-09-03 11:13:09 INFO     Epoch [13/200] train_loss: 4.6987, val_loss: 5.2100, lr: 0.003000, 4.65s
2024-09-03 11:13:13 INFO     epoch complete!
2024-09-03 11:13:13 INFO     evaluating now!
2024-09-03 11:13:13 INFO     Epoch [14/200] train_loss: 4.5639, val_loss: 4.8819, lr: 0.003000, 4.65s
2024-09-03 11:13:13 INFO     Saved model at 14
2024-09-03 11:13:13 INFO     Val loss decrease from 5.0811 to 4.8819, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-03 11:13:18 INFO     epoch complete!
2024-09-03 11:13:18 INFO     evaluating now!
2024-09-03 11:13:18 INFO     Epoch [15/200] train_loss: 4.4644, val_loss: 4.9237, lr: 0.003000, 4.64s
2024-09-03 11:13:22 INFO     epoch complete!
2024-09-03 11:13:22 INFO     evaluating now!
2024-09-03 11:13:23 INFO     Epoch [16/200] train_loss: 4.4501, val_loss: 4.8436, lr: 0.003000, 4.68s
2024-09-03 11:13:23 INFO     Saved model at 16
2024-09-03 11:13:23 INFO     Val loss decrease from 4.8819 to 4.8436, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-03 11:13:27 INFO     epoch complete!
2024-09-03 11:13:27 INFO     evaluating now!
2024-09-03 11:13:27 INFO     Epoch [17/200] train_loss: 4.4392, val_loss: 5.0405, lr: 0.003000, 4.65s
2024-09-03 11:13:32 INFO     epoch complete!
2024-09-03 11:13:32 INFO     evaluating now!
2024-09-03 11:13:32 INFO     Epoch [18/200] train_loss: 4.3001, val_loss: 4.9464, lr: 0.003000, 4.65s
2024-09-03 11:13:36 INFO     epoch complete!
2024-09-03 11:13:36 INFO     evaluating now!
2024-09-03 11:13:37 INFO     Epoch [19/200] train_loss: 4.2564, val_loss: 4.8402, lr: 0.003000, 4.66s
2024-09-03 11:13:37 INFO     Saved model at 19
2024-09-03 11:13:37 INFO     Val loss decrease from 4.8436 to 4.8402, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-03 11:13:41 INFO     epoch complete!
2024-09-03 11:13:41 INFO     evaluating now!
2024-09-03 11:13:41 INFO     Epoch [20/200] train_loss: 4.1596, val_loss: 4.8258, lr: 0.003000, 4.68s
2024-09-03 11:13:41 INFO     Saved model at 20
2024-09-03 11:13:41 INFO     Val loss decrease from 4.8402 to 4.8258, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-03 11:13:46 INFO     epoch complete!
2024-09-03 11:13:46 INFO     evaluating now!
2024-09-03 11:13:46 INFO     Epoch [21/200] train_loss: 4.1586, val_loss: 4.7563, lr: 0.003000, 4.68s
2024-09-03 11:13:46 INFO     Saved model at 21
2024-09-03 11:13:46 INFO     Val loss decrease from 4.8258 to 4.7563, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-03 11:13:51 INFO     epoch complete!
2024-09-03 11:13:51 INFO     evaluating now!
2024-09-03 11:13:51 INFO     Epoch [22/200] train_loss: 4.1147, val_loss: 4.9195, lr: 0.003000, 4.84s
2024-09-03 11:13:55 INFO     epoch complete!
2024-09-03 11:13:55 INFO     evaluating now!
2024-09-03 11:13:56 INFO     Epoch [23/200] train_loss: 4.0720, val_loss: 4.8722, lr: 0.003000, 4.76s
2024-09-03 11:14:00 INFO     epoch complete!
2024-09-03 11:14:00 INFO     evaluating now!
2024-09-03 11:14:00 INFO     Epoch [24/200] train_loss: 4.1038, val_loss: 4.8147, lr: 0.003000, 4.78s
2024-09-03 11:14:05 INFO     epoch complete!
2024-09-03 11:14:05 INFO     evaluating now!
2024-09-03 11:14:05 INFO     Epoch [25/200] train_loss: 3.9679, val_loss: 4.7900, lr: 0.003000, 4.89s
2024-09-03 11:14:10 INFO     epoch complete!
2024-09-03 11:14:10 INFO     evaluating now!
2024-09-03 11:14:10 INFO     Epoch [26/200] train_loss: 3.9558, val_loss: 4.7817, lr: 0.003000, 4.83s
2024-09-03 11:14:15 INFO     epoch complete!
2024-09-03 11:14:15 INFO     evaluating now!
2024-09-03 11:14:15 INFO     Epoch [27/200] train_loss: 3.9524, val_loss: 4.7358, lr: 0.003000, 4.79s
2024-09-03 11:14:15 INFO     Saved model at 27
2024-09-03 11:14:15 INFO     Val loss decrease from 4.7563 to 4.7358, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-03 11:14:19 INFO     epoch complete!
2024-09-03 11:14:19 INFO     evaluating now!
2024-09-03 11:14:20 INFO     Epoch [28/200] train_loss: 3.8630, val_loss: 4.7216, lr: 0.003000, 4.70s
2024-09-03 11:14:20 INFO     Saved model at 28
2024-09-03 11:14:20 INFO     Val loss decrease from 4.7358 to 4.7216, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-03 11:14:24 INFO     epoch complete!
2024-09-03 11:14:24 INFO     evaluating now!
2024-09-03 11:14:24 INFO     Epoch [29/200] train_loss: 3.8468, val_loss: 4.9116, lr: 0.003000, 4.72s
2024-09-03 11:14:29 INFO     epoch complete!
2024-09-03 11:14:29 INFO     evaluating now!
2024-09-03 11:14:29 INFO     Epoch [30/200] train_loss: 3.8307, val_loss: 4.7322, lr: 0.003000, 4.66s
2024-09-03 11:14:33 INFO     epoch complete!
2024-09-03 11:14:33 INFO     evaluating now!
2024-09-03 11:14:34 INFO     Epoch [31/200] train_loss: 3.8232, val_loss: 4.8922, lr: 0.003000, 4.71s
2024-09-03 11:14:38 INFO     epoch complete!
2024-09-03 11:14:38 INFO     evaluating now!
2024-09-03 11:14:38 INFO     Epoch [32/200] train_loss: 3.7988, val_loss: 4.8296, lr: 0.003000, 4.71s
2024-09-03 11:14:43 INFO     epoch complete!
2024-09-03 11:14:43 INFO     evaluating now!
2024-09-03 11:14:43 INFO     Epoch [33/200] train_loss: 3.7151, val_loss: 4.7194, lr: 0.003000, 4.81s
2024-09-03 11:14:43 INFO     Saved model at 33
2024-09-03 11:14:43 INFO     Val loss decrease from 4.7216 to 4.7194, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-09-03 11:14:48 INFO     epoch complete!
2024-09-03 11:14:48 INFO     evaluating now!
2024-09-03 11:14:48 INFO     Epoch [34/200] train_loss: 3.6808, val_loss: 4.7271, lr: 0.003000, 4.78s
2024-09-03 11:14:52 INFO     epoch complete!
2024-09-03 11:14:52 INFO     evaluating now!
2024-09-03 11:14:53 INFO     Epoch [35/200] train_loss: 3.6787, val_loss: 4.7156, lr: 0.003000, 4.76s
2024-09-03 11:14:53 INFO     Saved model at 35
2024-09-03 11:14:53 INFO     Val loss decrease from 4.7194 to 4.7156, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-03 11:14:57 INFO     epoch complete!
2024-09-03 11:14:57 INFO     evaluating now!
2024-09-03 11:14:58 INFO     Epoch [36/200] train_loss: 3.6168, val_loss: 4.7052, lr: 0.003000, 4.80s
2024-09-03 11:14:58 INFO     Saved model at 36
2024-09-03 11:14:58 INFO     Val loss decrease from 4.7156 to 4.7052, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-09-03 11:15:02 INFO     epoch complete!
2024-09-03 11:15:02 INFO     evaluating now!
2024-09-03 11:15:02 INFO     Epoch [37/200] train_loss: 3.6634, val_loss: 4.7347, lr: 0.003000, 4.72s
2024-09-03 11:15:07 INFO     epoch complete!
2024-09-03 11:15:07 INFO     evaluating now!
2024-09-03 11:15:07 INFO     Epoch [38/200] train_loss: 3.6190, val_loss: 4.6635, lr: 0.003000, 4.79s
2024-09-03 11:15:07 INFO     Saved model at 38
2024-09-03 11:15:07 INFO     Val loss decrease from 4.7052 to 4.6635, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-09-03 11:15:12 INFO     epoch complete!
2024-09-03 11:15:12 INFO     evaluating now!
2024-09-03 11:15:12 INFO     Epoch [39/200] train_loss: 3.5605, val_loss: 4.7143, lr: 0.003000, 4.69s
2024-09-03 11:15:16 INFO     epoch complete!
2024-09-03 11:15:16 INFO     evaluating now!
2024-09-03 11:15:16 INFO     Epoch [40/200] train_loss: 3.5363, val_loss: 4.7294, lr: 0.003000, 4.65s
2024-09-03 11:15:21 INFO     epoch complete!
2024-09-03 11:15:21 INFO     evaluating now!
2024-09-03 11:15:21 INFO     Epoch [41/200] train_loss: 3.5979, val_loss: 4.7191, lr: 0.003000, 4.72s
2024-09-03 11:15:26 INFO     epoch complete!
2024-09-03 11:15:26 INFO     evaluating now!
2024-09-03 11:15:26 INFO     Epoch [42/200] train_loss: 3.5588, val_loss: 4.6207, lr: 0.003000, 4.73s
2024-09-03 11:15:26 INFO     Saved model at 42
2024-09-03 11:15:26 INFO     Val loss decrease from 4.6635 to 4.6207, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-09-03 11:15:30 INFO     epoch complete!
2024-09-03 11:15:30 INFO     evaluating now!
2024-09-03 11:15:31 INFO     Epoch [43/200] train_loss: 3.4902, val_loss: 4.7167, lr: 0.003000, 4.74s
2024-09-03 11:15:35 INFO     epoch complete!
2024-09-03 11:15:35 INFO     evaluating now!
2024-09-03 11:15:35 INFO     Epoch [44/200] train_loss: 3.4692, val_loss: 4.7481, lr: 0.003000, 4.73s
2024-09-03 11:15:40 INFO     epoch complete!
2024-09-03 11:15:40 INFO     evaluating now!
2024-09-03 11:15:40 INFO     Epoch [45/200] train_loss: 3.4673, val_loss: 4.7923, lr: 0.003000, 4.90s
2024-09-03 11:15:45 INFO     epoch complete!
2024-09-03 11:15:45 INFO     evaluating now!
2024-09-03 11:15:45 INFO     Epoch [46/200] train_loss: 3.4275, val_loss: 4.7636, lr: 0.003000, 4.74s
2024-09-03 11:15:49 INFO     epoch complete!
2024-09-03 11:15:49 INFO     evaluating now!
2024-09-03 11:15:50 INFO     Epoch [47/200] train_loss: 3.4592, val_loss: 4.7576, lr: 0.003000, 4.74s
2024-09-03 11:15:54 INFO     epoch complete!
2024-09-03 11:15:54 INFO     evaluating now!
2024-09-03 11:15:54 INFO     Epoch [48/200] train_loss: 3.4433, val_loss: 4.7133, lr: 0.003000, 4.68s
2024-09-03 11:15:59 INFO     epoch complete!
2024-09-03 11:15:59 INFO     evaluating now!
2024-09-03 11:15:59 INFO     Epoch [49/200] train_loss: 3.4055, val_loss: 4.7020, lr: 0.003000, 4.69s
2024-09-03 11:16:04 INFO     epoch complete!
2024-09-03 11:16:04 INFO     evaluating now!
2024-09-03 11:16:04 INFO     Epoch [50/200] train_loss: 3.4078, val_loss: 4.6673, lr: 0.003000, 4.66s
2024-09-03 11:16:08 INFO     epoch complete!
2024-09-03 11:16:08 INFO     evaluating now!
2024-09-03 11:16:08 INFO     Epoch [51/200] train_loss: 3.3919, val_loss: 4.6956, lr: 0.003000, 4.66s
2024-09-03 11:16:13 INFO     epoch complete!
2024-09-03 11:16:13 INFO     evaluating now!
2024-09-03 11:16:13 INFO     Epoch [52/200] train_loss: 3.3604, val_loss: 4.6581, lr: 0.003000, 4.66s
2024-09-03 11:16:17 INFO     epoch complete!
2024-09-03 11:16:17 INFO     evaluating now!
2024-09-03 11:16:18 INFO     Epoch [53/200] train_loss: 3.3425, val_loss: 4.7367, lr: 0.003000, 4.64s
2024-09-03 11:16:22 INFO     epoch complete!
2024-09-03 11:16:22 INFO     evaluating now!
2024-09-03 11:16:22 INFO     Epoch [54/200] train_loss: 3.3584, val_loss: 4.7528, lr: 0.003000, 4.66s
2024-09-03 11:16:27 INFO     epoch complete!
2024-09-03 11:16:27 INFO     evaluating now!
2024-09-03 11:16:27 INFO     Epoch [55/200] train_loss: 3.3138, val_loss: 4.7424, lr: 0.003000, 4.69s
2024-09-03 11:16:31 INFO     epoch complete!
2024-09-03 11:16:31 INFO     evaluating now!
2024-09-03 11:16:32 INFO     Epoch [56/200] train_loss: 3.3131, val_loss: 4.6953, lr: 0.003000, 4.65s
2024-09-03 11:16:36 INFO     epoch complete!
2024-09-03 11:16:36 INFO     evaluating now!
2024-09-03 11:16:36 INFO     Epoch [57/200] train_loss: 3.2907, val_loss: 4.7910, lr: 0.003000, 4.65s
2024-09-03 11:16:36 WARNING  Early stopping at epoch: 57
2024-09-03 11:16:36 INFO     Trained totally 58 epochs, average train time is 4.459s, average eval time is 0.249s
2024-09-03 11:16:36 INFO     Loaded model at 42
2024-09-03 11:16:36 INFO     Saved model at ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406.m
2024-09-03 11:16:36 INFO     Start evaluating ...
2024-09-03 11:16:37 INFO     Note that you select the single mode to evaluate!
2024-09-03 11:16:37 INFO     Evaluate result is saved at ./libcity/cache/100/evaluate_cache\2024_09_03_11_16_37_AGCRN_CHITaxi20190406.csv
2024-09-03 11:16:37 INFO     
         MAE       RMSE
1   2.366856   7.574290
2   2.447427   8.083392
3   2.550571   8.675470
4   2.628726   8.909719
5   2.707439   9.221010
6   2.704247   9.285240
7   2.718224   9.406712
8   2.740810   9.523230
9   2.747024   9.585147
10  2.739182   9.638772
11  2.775386   9.948631
12  2.861599  10.257642
2024-09-03 11:16:37 INFO     ----------------------------------------------------------------------------
2024-09-03 11:16:37 INFO     # 2, Kownledge Graph Embedding: Normal, Experiment ids: 102
2024-09-03 11:16:37 INFO     ----------------------------------------------------------------------------
2024-09-03 11:16:37 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=100
2024-09-03 11:16:37 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 100, 'add_time_in_day': True, 'add_day_in_week': True, 'load_external': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-03 11:16:37 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-03 11:16:37 INFO     set_weight_link_or_dist: dist
2024-09-03 11:16:37 INFO     init_weight_inf_or_zero: inf
2024-09-03 11:16:37 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-03 11:16:37 INFO     Start Calculate the weight by Gauss kernel!
2024-09-03 11:16:37 INFO     Loading file CHITaxi20190406.dyna
2024-09-03 11:16:37 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-03 11:16:38 INFO     Dataset created
2024-09-03 11:16:38 INFO     x shape: (4345, 12, 77, 10), y shape: (4345, 12, 77, 10)
2024-09-03 11:16:38 INFO     train	x: (3042, 12, 77, 10), y: (3042, 12, 77, 10)
2024-09-03 11:16:38 INFO     eval	x: (434, 12, 77, 10), y: (434, 12, 77, 10)
2024-09-03 11:16:38 INFO     test	x: (869, 12, 77, 10), y: (869, 12, 77, 10)
2024-09-03 11:16:38 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-03 11:16:38 INFO     NoneScaler
2024-09-03 11:16:39 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-03 11:16:39 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-03 11:16:39 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 74, 128])	cuda:0	True
2024-09-03 11:16:39 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 11:16:39 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 74, 64])	cuda:0	True
2024-09-03 11:16:39 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 11:16:39 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-03 11:16:39 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 11:16:39 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-03 11:16:39 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 11:16:39 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-03 11:16:39 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-03 11:16:39 INFO     Total parameter numbers: 781850
2024-09-03 11:16:39 INFO     You select `adam` optimizer.
2024-09-03 11:16:39 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-03 11:16:39 INFO     Start training ...
2024-09-03 11:16:39 INFO     num_batches:48
2024-09-03 11:16:43 INFO     epoch complete!
2024-09-03 11:16:43 INFO     evaluating now!
2024-09-03 11:16:43 INFO     Epoch [0/200] train_loss: 22.6782, val_loss: 16.5468, lr: 0.003000, 4.87s
2024-09-03 11:16:43 INFO     Saved model at 0
2024-09-03 11:16:43 INFO     Val loss decrease from inf to 16.5468, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-03 11:16:48 INFO     epoch complete!
2024-09-03 11:16:48 INFO     evaluating now!
2024-09-03 11:16:48 INFO     Epoch [1/200] train_loss: 12.3361, val_loss: 11.1693, lr: 0.003000, 4.74s
2024-09-03 11:16:48 INFO     Saved model at 1
2024-09-03 11:16:48 INFO     Val loss decrease from 16.5468 to 11.1693, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-03 11:16:53 INFO     epoch complete!
2024-09-03 11:16:53 INFO     evaluating now!
2024-09-03 11:16:53 INFO     Epoch [2/200] train_loss: 9.1739, val_loss: 8.3982, lr: 0.003000, 4.84s
2024-09-03 11:16:53 INFO     Saved model at 2
2024-09-03 11:16:53 INFO     Val loss decrease from 11.1693 to 8.3982, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-03 11:16:57 INFO     epoch complete!
2024-09-03 11:16:57 INFO     evaluating now!
2024-09-03 11:16:58 INFO     Epoch [3/200] train_loss: 7.3919, val_loss: 7.2090, lr: 0.003000, 4.72s
2024-09-03 11:16:58 INFO     Saved model at 3
2024-09-03 11:16:58 INFO     Val loss decrease from 8.3982 to 7.2090, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-03 11:17:02 INFO     epoch complete!
2024-09-03 11:17:02 INFO     evaluating now!
2024-09-03 11:17:02 INFO     Epoch [4/200] train_loss: 6.5931, val_loss: 6.4894, lr: 0.003000, 4.75s
2024-09-03 11:17:02 INFO     Saved model at 4
2024-09-03 11:17:02 INFO     Val loss decrease from 7.2090 to 6.4894, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-03 11:17:07 INFO     epoch complete!
2024-09-03 11:17:07 INFO     evaluating now!
2024-09-03 11:17:07 INFO     Epoch [5/200] train_loss: 6.0177, val_loss: 5.9706, lr: 0.003000, 4.70s
2024-09-03 11:17:07 INFO     Saved model at 5
2024-09-03 11:17:07 INFO     Val loss decrease from 6.4894 to 5.9706, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-03 11:17:12 INFO     epoch complete!
2024-09-03 11:17:12 INFO     evaluating now!
2024-09-03 11:17:12 INFO     Epoch [6/200] train_loss: 5.6288, val_loss: 5.5548, lr: 0.003000, 4.70s
2024-09-03 11:17:12 INFO     Saved model at 6
2024-09-03 11:17:12 INFO     Val loss decrease from 5.9706 to 5.5548, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-03 11:17:16 INFO     epoch complete!
2024-09-03 11:17:16 INFO     evaluating now!
2024-09-03 11:17:17 INFO     Epoch [7/200] train_loss: 5.3954, val_loss: 5.4129, lr: 0.003000, 4.66s
2024-09-03 11:17:17 INFO     Saved model at 7
2024-09-03 11:17:17 INFO     Val loss decrease from 5.5548 to 5.4129, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-03 11:17:21 INFO     epoch complete!
2024-09-03 11:17:21 INFO     evaluating now!
2024-09-03 11:17:21 INFO     Epoch [8/200] train_loss: 5.2217, val_loss: 5.5594, lr: 0.003000, 4.72s
2024-09-03 11:17:26 INFO     epoch complete!
2024-09-03 11:17:26 INFO     evaluating now!
2024-09-03 11:17:26 INFO     Epoch [9/200] train_loss: 5.0399, val_loss: 5.3207, lr: 0.003000, 4.69s
2024-09-03 11:17:26 INFO     Saved model at 9
2024-09-03 11:17:26 INFO     Val loss decrease from 5.4129 to 5.3207, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-03 11:17:30 INFO     epoch complete!
2024-09-03 11:17:30 INFO     evaluating now!
2024-09-03 11:17:31 INFO     Epoch [10/200] train_loss: 4.9106, val_loss: 5.3340, lr: 0.003000, 4.67s
2024-09-03 11:17:35 INFO     epoch complete!
2024-09-03 11:17:35 INFO     evaluating now!
2024-09-03 11:17:35 INFO     Epoch [11/200] train_loss: 4.7741, val_loss: 5.0729, lr: 0.003000, 4.66s
2024-09-03 11:17:35 INFO     Saved model at 11
2024-09-03 11:17:35 INFO     Val loss decrease from 5.3207 to 5.0729, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-03 11:17:40 INFO     epoch complete!
2024-09-03 11:17:40 INFO     evaluating now!
2024-09-03 11:17:40 INFO     Epoch [12/200] train_loss: 4.6149, val_loss: 5.2844, lr: 0.003000, 4.65s
2024-09-03 11:17:44 INFO     epoch complete!
2024-09-03 11:17:44 INFO     evaluating now!
2024-09-03 11:17:45 INFO     Epoch [13/200] train_loss: 4.5667, val_loss: 5.1523, lr: 0.003000, 4.67s
2024-09-03 11:17:49 INFO     epoch complete!
2024-09-03 11:17:49 INFO     evaluating now!
2024-09-03 11:17:49 INFO     Epoch [14/200] train_loss: 4.4947, val_loss: 4.9434, lr: 0.003000, 4.65s
2024-09-03 11:17:49 INFO     Saved model at 14
2024-09-03 11:17:49 INFO     Val loss decrease from 5.0729 to 4.9434, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-03 11:17:54 INFO     epoch complete!
2024-09-03 11:17:54 INFO     evaluating now!
2024-09-03 11:17:54 INFO     Epoch [15/200] train_loss: 4.4328, val_loss: 4.8416, lr: 0.003000, 4.64s
2024-09-03 11:17:54 INFO     Saved model at 15
2024-09-03 11:17:54 INFO     Val loss decrease from 4.9434 to 4.8416, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-03 11:17:58 INFO     epoch complete!
2024-09-03 11:17:58 INFO     evaluating now!
2024-09-03 11:17:59 INFO     Epoch [16/200] train_loss: 4.3503, val_loss: 5.0921, lr: 0.003000, 4.65s
2024-09-03 11:18:03 INFO     epoch complete!
2024-09-03 11:18:03 INFO     evaluating now!
2024-09-03 11:18:03 INFO     Epoch [17/200] train_loss: 4.2653, val_loss: 4.7180, lr: 0.003000, 4.65s
2024-09-03 11:18:03 INFO     Saved model at 17
2024-09-03 11:18:03 INFO     Val loss decrease from 4.8416 to 4.7180, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-03 11:18:08 INFO     epoch complete!
2024-09-03 11:18:08 INFO     evaluating now!
2024-09-03 11:18:08 INFO     Epoch [18/200] train_loss: 4.2369, val_loss: 4.9301, lr: 0.003000, 4.64s
2024-09-03 11:18:12 INFO     epoch complete!
2024-09-03 11:18:12 INFO     evaluating now!
2024-09-03 11:18:13 INFO     Epoch [19/200] train_loss: 4.1570, val_loss: 4.8730, lr: 0.003000, 4.65s
2024-09-03 11:18:17 INFO     epoch complete!
2024-09-03 11:18:17 INFO     evaluating now!
2024-09-03 11:18:17 INFO     Epoch [20/200] train_loss: 4.1326, val_loss: 4.8386, lr: 0.003000, 4.66s
2024-09-03 11:18:22 INFO     epoch complete!
2024-09-03 11:18:22 INFO     evaluating now!
2024-09-03 11:18:22 INFO     Epoch [21/200] train_loss: 4.0512, val_loss: 4.7428, lr: 0.003000, 4.64s
2024-09-03 11:18:26 INFO     epoch complete!
2024-09-03 11:18:26 INFO     evaluating now!
2024-09-03 11:18:27 INFO     Epoch [22/200] train_loss: 4.0456, val_loss: 4.8114, lr: 0.003000, 4.66s
2024-09-03 11:18:31 INFO     epoch complete!
2024-09-03 11:18:31 INFO     evaluating now!
2024-09-03 11:18:31 INFO     Epoch [23/200] train_loss: 3.9867, val_loss: 4.9616, lr: 0.003000, 4.65s
2024-09-03 11:18:36 INFO     epoch complete!
2024-09-03 11:18:36 INFO     evaluating now!
2024-09-03 11:18:36 INFO     Epoch [24/200] train_loss: 4.0003, val_loss: 4.8071, lr: 0.003000, 4.66s
2024-09-03 11:18:40 INFO     epoch complete!
2024-09-03 11:18:40 INFO     evaluating now!
2024-09-03 11:18:41 INFO     Epoch [25/200] train_loss: 3.9095, val_loss: 4.6531, lr: 0.003000, 4.64s
2024-09-03 11:18:41 INFO     Saved model at 25
2024-09-03 11:18:41 INFO     Val loss decrease from 4.7180 to 4.6531, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-03 11:18:45 INFO     epoch complete!
2024-09-03 11:18:45 INFO     evaluating now!
2024-09-03 11:18:45 INFO     Epoch [26/200] train_loss: 3.9039, val_loss: 4.7846, lr: 0.003000, 4.68s
2024-09-03 11:18:50 INFO     epoch complete!
2024-09-03 11:18:50 INFO     evaluating now!
2024-09-03 11:18:50 INFO     Epoch [27/200] train_loss: 3.8508, val_loss: 4.8222, lr: 0.003000, 4.65s
2024-09-03 11:18:54 INFO     epoch complete!
2024-09-03 11:18:54 INFO     evaluating now!
2024-09-03 11:18:55 INFO     Epoch [28/200] train_loss: 3.7999, val_loss: 4.7746, lr: 0.003000, 4.65s
2024-09-03 11:18:59 INFO     epoch complete!
2024-09-03 11:18:59 INFO     evaluating now!
2024-09-03 11:18:59 INFO     Epoch [29/200] train_loss: 3.7421, val_loss: 4.6235, lr: 0.003000, 4.64s
2024-09-03 11:18:59 INFO     Saved model at 29
2024-09-03 11:18:59 INFO     Val loss decrease from 4.6531 to 4.6235, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-03 11:19:04 INFO     epoch complete!
2024-09-03 11:19:04 INFO     evaluating now!
2024-09-03 11:19:04 INFO     Epoch [30/200] train_loss: 3.7306, val_loss: 4.6830, lr: 0.003000, 4.63s
2024-09-03 11:19:08 INFO     epoch complete!
2024-09-03 11:19:08 INFO     evaluating now!
2024-09-03 11:19:08 INFO     Epoch [31/200] train_loss: 3.6808, val_loss: 4.6343, lr: 0.003000, 4.66s
2024-09-03 11:19:13 INFO     epoch complete!
2024-09-03 11:19:13 INFO     evaluating now!
2024-09-03 11:19:13 INFO     Epoch [32/200] train_loss: 3.6692, val_loss: 4.7149, lr: 0.003000, 4.65s
2024-09-03 11:19:18 INFO     epoch complete!
2024-09-03 11:19:18 INFO     evaluating now!
2024-09-03 11:19:18 INFO     Epoch [33/200] train_loss: 3.6701, val_loss: 4.6511, lr: 0.003000, 4.65s
2024-09-03 11:19:22 INFO     epoch complete!
2024-09-03 11:19:22 INFO     evaluating now!
2024-09-03 11:19:22 INFO     Epoch [34/200] train_loss: 3.6556, val_loss: 4.7321, lr: 0.003000, 4.64s
2024-09-03 11:19:27 INFO     epoch complete!
2024-09-03 11:19:27 INFO     evaluating now!
2024-09-03 11:19:27 INFO     Epoch [35/200] train_loss: 3.6040, val_loss: 4.7126, lr: 0.003000, 4.65s
2024-09-03 11:19:31 INFO     epoch complete!
2024-09-03 11:19:31 INFO     evaluating now!
2024-09-03 11:19:32 INFO     Epoch [36/200] train_loss: 3.5553, val_loss: 4.8395, lr: 0.003000, 4.66s
2024-09-03 11:19:36 INFO     epoch complete!
2024-09-03 11:19:36 INFO     evaluating now!
2024-09-03 11:19:36 INFO     Epoch [37/200] train_loss: 3.5723, val_loss: 4.6934, lr: 0.003000, 4.65s
2024-09-03 11:19:41 INFO     epoch complete!
2024-09-03 11:19:41 INFO     evaluating now!
2024-09-03 11:19:41 INFO     Epoch [38/200] train_loss: 3.4998, val_loss: 4.7406, lr: 0.003000, 4.68s
2024-09-03 11:19:45 INFO     epoch complete!
2024-09-03 11:19:45 INFO     evaluating now!
2024-09-03 11:19:46 INFO     Epoch [39/200] train_loss: 3.4953, val_loss: 4.7906, lr: 0.003000, 4.66s
2024-09-03 11:19:50 INFO     epoch complete!
2024-09-03 11:19:50 INFO     evaluating now!
2024-09-03 11:19:50 INFO     Epoch [40/200] train_loss: 3.5384, val_loss: 4.7594, lr: 0.003000, 4.66s
2024-09-03 11:19:55 INFO     epoch complete!
2024-09-03 11:19:55 INFO     evaluating now!
2024-09-03 11:19:55 INFO     Epoch [41/200] train_loss: 3.5060, val_loss: 4.7292, lr: 0.003000, 4.66s
2024-09-03 11:19:59 INFO     epoch complete!
2024-09-03 11:19:59 INFO     evaluating now!
2024-09-03 11:20:00 INFO     Epoch [42/200] train_loss: 3.4574, val_loss: 4.8412, lr: 0.003000, 4.65s
2024-09-03 11:20:04 INFO     epoch complete!
2024-09-03 11:20:04 INFO     evaluating now!
2024-09-03 11:20:04 INFO     Epoch [43/200] train_loss: 3.4664, val_loss: 4.7916, lr: 0.003000, 4.67s
2024-09-03 11:20:09 INFO     epoch complete!
2024-09-03 11:20:09 INFO     evaluating now!
2024-09-03 11:20:09 INFO     Epoch [44/200] train_loss: 3.4040, val_loss: 4.6990, lr: 0.003000, 4.75s
2024-09-03 11:20:09 WARNING  Early stopping at epoch: 44
2024-09-03 11:20:09 INFO     Trained totally 45 epochs, average train time is 4.429s, average eval time is 0.246s
2024-09-03 11:20:09 INFO     Loaded model at 29
2024-09-03 11:20:09 INFO     Saved model at ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406.m
2024-09-03 11:20:09 INFO     Start evaluating ...
2024-09-03 11:20:10 INFO     Note that you select the single mode to evaluate!
2024-09-03 11:20:10 INFO     Evaluate result is saved at ./libcity/cache/100/evaluate_cache\2024_09_03_11_20_10_AGCRN_CHITaxi20190406.csv
2024-09-03 11:20:10 INFO     
         MAE      RMSE
1   2.337141  6.824826
2   2.433953  7.309461
3   2.549273  8.280421
4   2.656051  8.673725
5   2.640450  8.922532
6   2.640124  8.925492
7   2.608243  9.022823
8   2.729213  9.114131
9   2.715654  9.268250
10  2.795821  9.365731
11  2.807639  9.561265
12  2.832454  9.786695
2024-09-03 11:20:10 INFO     ----------------------------------------------------------------------------
2024-09-03 11:20:10 INFO     # 3, Kownledge Graph Embedding: Normal, Experiment ids: 103
2024-09-03 11:20:10 INFO     ----------------------------------------------------------------------------
2024-09-03 11:20:10 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=100
2024-09-03 11:20:10 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 100, 'add_time_in_day': True, 'add_day_in_week': True, 'load_external': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-03 11:20:10 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-03 11:20:10 INFO     set_weight_link_or_dist: dist
2024-09-03 11:20:10 INFO     init_weight_inf_or_zero: inf
2024-09-03 11:20:10 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-03 11:20:10 INFO     Start Calculate the weight by Gauss kernel!
2024-09-03 11:20:10 INFO     Loading file CHITaxi20190406.dyna
2024-09-03 11:20:10 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-03 11:20:11 INFO     Dataset created
2024-09-03 11:20:11 INFO     x shape: (4345, 12, 77, 10), y shape: (4345, 12, 77, 10)
2024-09-03 11:20:11 INFO     train	x: (3042, 12, 77, 10), y: (3042, 12, 77, 10)
2024-09-03 11:20:11 INFO     eval	x: (434, 12, 77, 10), y: (434, 12, 77, 10)
2024-09-03 11:20:11 INFO     test	x: (869, 12, 77, 10), y: (869, 12, 77, 10)
2024-09-03 11:20:11 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-03 11:20:11 INFO     NoneScaler
2024-09-03 11:20:11 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-03 11:20:11 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-03 11:20:11 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 74, 128])	cuda:0	True
2024-09-03 11:20:11 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 11:20:11 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 74, 64])	cuda:0	True
2024-09-03 11:20:11 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 11:20:11 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-03 11:20:11 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 11:20:11 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-03 11:20:11 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 11:20:11 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-03 11:20:11 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-03 11:20:11 INFO     Total parameter numbers: 781850
2024-09-03 11:20:11 INFO     You select `adam` optimizer.
2024-09-03 11:20:11 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-03 11:20:11 INFO     Start training ...
2024-09-03 11:20:11 INFO     num_batches:48
2024-09-03 11:20:16 INFO     epoch complete!
2024-09-03 11:20:16 INFO     evaluating now!
2024-09-03 11:20:16 INFO     Epoch [0/200] train_loss: 25.0728, val_loss: 17.6922, lr: 0.003000, 4.76s
2024-09-03 11:20:16 INFO     Saved model at 0
2024-09-03 11:20:16 INFO     Val loss decrease from inf to 17.6922, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-03 11:20:20 INFO     epoch complete!
2024-09-03 11:20:20 INFO     evaluating now!
2024-09-03 11:20:21 INFO     Epoch [1/200] train_loss: 14.4571, val_loss: 13.5013, lr: 0.003000, 4.65s
2024-09-03 11:20:21 INFO     Saved model at 1
2024-09-03 11:20:21 INFO     Val loss decrease from 17.6922 to 13.5013, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-03 11:20:25 INFO     epoch complete!
2024-09-03 11:20:25 INFO     evaluating now!
2024-09-03 11:20:25 INFO     Epoch [2/200] train_loss: 10.8303, val_loss: 10.0887, lr: 0.003000, 4.74s
2024-09-03 11:20:25 INFO     Saved model at 2
2024-09-03 11:20:25 INFO     Val loss decrease from 13.5013 to 10.0887, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-03 11:20:30 INFO     epoch complete!
2024-09-03 11:20:30 INFO     evaluating now!
2024-09-03 11:20:30 INFO     Epoch [3/200] train_loss: 8.4623, val_loss: 7.9530, lr: 0.003000, 4.81s
2024-09-03 11:20:30 INFO     Saved model at 3
2024-09-03 11:20:30 INFO     Val loss decrease from 10.0887 to 7.9530, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-03 11:20:35 INFO     epoch complete!
2024-09-03 11:20:35 INFO     evaluating now!
2024-09-03 11:20:35 INFO     Epoch [4/200] train_loss: 7.2711, val_loss: 7.1124, lr: 0.003000, 4.69s
2024-09-03 11:20:35 INFO     Saved model at 4
2024-09-03 11:20:35 INFO     Val loss decrease from 7.9530 to 7.1124, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-03 11:20:39 INFO     epoch complete!
2024-09-03 11:20:39 INFO     evaluating now!
2024-09-03 11:20:40 INFO     Epoch [5/200] train_loss: 6.4515, val_loss: 6.2483, lr: 0.003000, 4.67s
2024-09-03 11:20:40 INFO     Saved model at 5
2024-09-03 11:20:40 INFO     Val loss decrease from 7.1124 to 6.2483, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-03 11:20:44 INFO     epoch complete!
2024-09-03 11:20:44 INFO     evaluating now!
2024-09-03 11:20:44 INFO     Epoch [6/200] train_loss: 6.0155, val_loss: 5.9102, lr: 0.003000, 4.68s
2024-09-03 11:20:44 INFO     Saved model at 6
2024-09-03 11:20:44 INFO     Val loss decrease from 6.2483 to 5.9102, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-03 11:20:49 INFO     epoch complete!
2024-09-03 11:20:49 INFO     evaluating now!
2024-09-03 11:20:49 INFO     Epoch [7/200] train_loss: 5.6808, val_loss: 5.9100, lr: 0.003000, 4.64s
2024-09-03 11:20:49 INFO     Saved model at 7
2024-09-03 11:20:49 INFO     Val loss decrease from 5.9102 to 5.9100, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-03 11:20:54 INFO     epoch complete!
2024-09-03 11:20:54 INFO     evaluating now!
2024-09-03 11:20:54 INFO     Epoch [8/200] train_loss: 5.4772, val_loss: 5.4570, lr: 0.003000, 4.76s
2024-09-03 11:20:54 INFO     Saved model at 8
2024-09-03 11:20:54 INFO     Val loss decrease from 5.9100 to 5.4570, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-03 11:20:58 INFO     epoch complete!
2024-09-03 11:20:58 INFO     evaluating now!
2024-09-03 11:20:59 INFO     Epoch [9/200] train_loss: 5.2421, val_loss: 5.4538, lr: 0.003000, 4.76s
2024-09-03 11:20:59 INFO     Saved model at 9
2024-09-03 11:20:59 INFO     Val loss decrease from 5.4570 to 5.4538, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-03 11:21:03 INFO     epoch complete!
2024-09-03 11:21:03 INFO     evaluating now!
2024-09-03 11:21:03 INFO     Epoch [10/200] train_loss: 5.1153, val_loss: 5.3571, lr: 0.003000, 4.70s
2024-09-03 11:21:03 INFO     Saved model at 10
2024-09-03 11:21:03 INFO     Val loss decrease from 5.4538 to 5.3571, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-03 11:21:08 INFO     epoch complete!
2024-09-03 11:21:08 INFO     evaluating now!
2024-09-03 11:21:08 INFO     Epoch [11/200] train_loss: 4.9350, val_loss: 5.1525, lr: 0.003000, 4.74s
2024-09-03 11:21:08 INFO     Saved model at 11
2024-09-03 11:21:08 INFO     Val loss decrease from 5.3571 to 5.1525, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-03 11:21:13 INFO     epoch complete!
2024-09-03 11:21:13 INFO     evaluating now!
2024-09-03 11:21:13 INFO     Epoch [12/200] train_loss: 4.8573, val_loss: 5.0811, lr: 0.003000, 4.73s
2024-09-03 11:21:13 INFO     Saved model at 12
2024-09-03 11:21:13 INFO     Val loss decrease from 5.1525 to 5.0811, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-03 11:21:17 INFO     epoch complete!
2024-09-03 11:21:17 INFO     evaluating now!
2024-09-03 11:21:17 INFO     Epoch [13/200] train_loss: 4.7153, val_loss: 4.9400, lr: 0.003000, 4.66s
2024-09-03 11:21:17 INFO     Saved model at 13
2024-09-03 11:21:17 INFO     Val loss decrease from 5.0811 to 4.9400, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-03 11:21:22 INFO     epoch complete!
2024-09-03 11:21:22 INFO     evaluating now!
2024-09-03 11:21:22 INFO     Epoch [14/200] train_loss: 4.6242, val_loss: 4.8994, lr: 0.003000, 4.63s
2024-09-03 11:21:22 INFO     Saved model at 14
2024-09-03 11:21:22 INFO     Val loss decrease from 4.9400 to 4.8994, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-03 11:21:26 INFO     epoch complete!
2024-09-03 11:21:26 INFO     evaluating now!
2024-09-03 11:21:27 INFO     Epoch [15/200] train_loss: 4.6066, val_loss: 4.8210, lr: 0.003000, 4.65s
2024-09-03 11:21:27 INFO     Saved model at 15
2024-09-03 11:21:27 INFO     Val loss decrease from 4.8994 to 4.8210, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-03 11:21:31 INFO     epoch complete!
2024-09-03 11:21:31 INFO     evaluating now!
2024-09-03 11:21:31 INFO     Epoch [16/200] train_loss: 4.4907, val_loss: 5.1278, lr: 0.003000, 4.68s
2024-09-03 11:21:36 INFO     epoch complete!
2024-09-03 11:21:36 INFO     evaluating now!
2024-09-03 11:21:36 INFO     Epoch [17/200] train_loss: 4.3578, val_loss: 4.8508, lr: 0.003000, 4.67s
2024-09-03 11:21:41 INFO     epoch complete!
2024-09-03 11:21:41 INFO     evaluating now!
2024-09-03 11:21:41 INFO     Epoch [18/200] train_loss: 4.3119, val_loss: 4.7909, lr: 0.003000, 4.66s
2024-09-03 11:21:41 INFO     Saved model at 18
2024-09-03 11:21:41 INFO     Val loss decrease from 4.8210 to 4.7909, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-03 11:21:45 INFO     epoch complete!
2024-09-03 11:21:45 INFO     evaluating now!
2024-09-03 11:21:45 INFO     Epoch [19/200] train_loss: 4.2794, val_loss: 4.8418, lr: 0.003000, 4.68s
2024-09-03 11:21:50 INFO     epoch complete!
2024-09-03 11:21:50 INFO     evaluating now!
2024-09-03 11:21:50 INFO     Epoch [20/200] train_loss: 4.2210, val_loss: 4.8351, lr: 0.003000, 4.72s
2024-09-03 11:21:55 INFO     epoch complete!
2024-09-03 11:21:55 INFO     evaluating now!
2024-09-03 11:21:55 INFO     Epoch [21/200] train_loss: 4.1607, val_loss: 4.7281, lr: 0.003000, 4.75s
2024-09-03 11:21:55 INFO     Saved model at 21
2024-09-03 11:21:55 INFO     Val loss decrease from 4.7909 to 4.7281, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-03 11:21:59 INFO     epoch complete!
2024-09-03 11:21:59 INFO     evaluating now!
2024-09-03 11:22:00 INFO     Epoch [22/200] train_loss: 4.1326, val_loss: 4.7171, lr: 0.003000, 4.69s
2024-09-03 11:22:00 INFO     Saved model at 22
2024-09-03 11:22:00 INFO     Val loss decrease from 4.7281 to 4.7171, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-03 11:22:04 INFO     epoch complete!
2024-09-03 11:22:04 INFO     evaluating now!
2024-09-03 11:22:04 INFO     Epoch [23/200] train_loss: 4.0822, val_loss: 4.7778, lr: 0.003000, 4.77s
2024-09-03 11:22:09 INFO     epoch complete!
2024-09-03 11:22:09 INFO     evaluating now!
2024-09-03 11:22:09 INFO     Epoch [24/200] train_loss: 4.0218, val_loss: 4.7834, lr: 0.003000, 4.74s
2024-09-03 11:22:14 INFO     epoch complete!
2024-09-03 11:22:14 INFO     evaluating now!
2024-09-03 11:22:14 INFO     Epoch [25/200] train_loss: 3.9768, val_loss: 4.8562, lr: 0.003000, 4.69s
2024-09-03 11:22:18 INFO     epoch complete!
2024-09-03 11:22:18 INFO     evaluating now!
2024-09-03 11:22:19 INFO     Epoch [26/200] train_loss: 3.9747, val_loss: 4.6906, lr: 0.003000, 4.73s
2024-09-03 11:22:19 INFO     Saved model at 26
2024-09-03 11:22:19 INFO     Val loss decrease from 4.7171 to 4.6906, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-03 11:22:23 INFO     epoch complete!
2024-09-03 11:22:23 INFO     evaluating now!
2024-09-03 11:22:23 INFO     Epoch [27/200] train_loss: 3.9137, val_loss: 4.6888, lr: 0.003000, 4.73s
2024-09-03 11:22:23 INFO     Saved model at 27
2024-09-03 11:22:23 INFO     Val loss decrease from 4.6906 to 4.6888, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-03 11:22:28 INFO     epoch complete!
2024-09-03 11:22:28 INFO     evaluating now!
2024-09-03 11:22:28 INFO     Epoch [28/200] train_loss: 3.8548, val_loss: 4.7577, lr: 0.003000, 4.66s
2024-09-03 11:22:32 INFO     epoch complete!
2024-09-03 11:22:32 INFO     evaluating now!
2024-09-03 11:22:33 INFO     Epoch [29/200] train_loss: 3.7869, val_loss: 4.7367, lr: 0.003000, 4.67s
2024-09-03 11:22:37 INFO     epoch complete!
2024-09-03 11:22:37 INFO     evaluating now!
2024-09-03 11:22:37 INFO     Epoch [30/200] train_loss: 3.8292, val_loss: 4.7192, lr: 0.003000, 4.69s
2024-09-03 11:22:42 INFO     epoch complete!
2024-09-03 11:22:42 INFO     evaluating now!
2024-09-03 11:22:42 INFO     Epoch [31/200] train_loss: 3.7941, val_loss: 4.6740, lr: 0.003000, 4.67s
2024-09-03 11:22:42 INFO     Saved model at 31
2024-09-03 11:22:42 INFO     Val loss decrease from 4.6888 to 4.6740, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-09-03 11:22:46 INFO     epoch complete!
2024-09-03 11:22:46 INFO     evaluating now!
2024-09-03 11:22:47 INFO     Epoch [32/200] train_loss: 3.7157, val_loss: 4.9082, lr: 0.003000, 4.67s
2024-09-03 11:22:51 INFO     epoch complete!
2024-09-03 11:22:51 INFO     evaluating now!
2024-09-03 11:22:51 INFO     Epoch [33/200] train_loss: 3.7001, val_loss: 4.6722, lr: 0.003000, 4.66s
2024-09-03 11:22:51 INFO     Saved model at 33
2024-09-03 11:22:51 INFO     Val loss decrease from 4.6740 to 4.6722, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-09-03 11:22:56 INFO     epoch complete!
2024-09-03 11:22:56 INFO     evaluating now!
2024-09-03 11:22:56 INFO     Epoch [34/200] train_loss: 3.6675, val_loss: 4.6128, lr: 0.003000, 4.68s
2024-09-03 11:22:56 INFO     Saved model at 34
2024-09-03 11:22:56 INFO     Val loss decrease from 4.6722 to 4.6128, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-09-03 11:23:01 INFO     epoch complete!
2024-09-03 11:23:01 INFO     evaluating now!
2024-09-03 11:23:01 INFO     Epoch [35/200] train_loss: 3.6666, val_loss: 4.6909, lr: 0.003000, 4.67s
2024-09-03 11:23:05 INFO     epoch complete!
2024-09-03 11:23:05 INFO     evaluating now!
2024-09-03 11:23:05 INFO     Epoch [36/200] train_loss: 3.6439, val_loss: 4.6841, lr: 0.003000, 4.67s
2024-09-03 11:23:10 INFO     epoch complete!
2024-09-03 11:23:10 INFO     evaluating now!
2024-09-03 11:23:10 INFO     Epoch [37/200] train_loss: 3.6166, val_loss: 4.7374, lr: 0.003000, 4.66s
2024-09-03 11:23:15 INFO     epoch complete!
2024-09-03 11:23:15 INFO     evaluating now!
2024-09-03 11:23:15 INFO     Epoch [38/200] train_loss: 3.6096, val_loss: 4.6841, lr: 0.003000, 4.67s
2024-09-03 11:23:19 INFO     epoch complete!
2024-09-03 11:23:19 INFO     evaluating now!
2024-09-03 11:23:19 INFO     Epoch [39/200] train_loss: 3.5966, val_loss: 4.6990, lr: 0.003000, 4.67s
2024-09-03 11:23:24 INFO     epoch complete!
2024-09-03 11:23:24 INFO     evaluating now!
2024-09-03 11:23:24 INFO     Epoch [40/200] train_loss: 3.5632, val_loss: 4.6587, lr: 0.003000, 4.69s
2024-09-03 11:23:29 INFO     epoch complete!
2024-09-03 11:23:29 INFO     evaluating now!
2024-09-03 11:23:29 INFO     Epoch [41/200] train_loss: 3.5497, val_loss: 4.6320, lr: 0.003000, 4.70s
2024-09-03 11:23:33 INFO     epoch complete!
2024-09-03 11:23:33 INFO     evaluating now!
2024-09-03 11:23:33 INFO     Epoch [42/200] train_loss: 3.5002, val_loss: 4.6307, lr: 0.003000, 4.67s
2024-09-03 11:23:38 INFO     epoch complete!
2024-09-03 11:23:38 INFO     evaluating now!
2024-09-03 11:23:38 INFO     Epoch [43/200] train_loss: 3.4712, val_loss: 4.7298, lr: 0.003000, 4.81s
2024-09-03 11:23:43 INFO     epoch complete!
2024-09-03 11:23:43 INFO     evaluating now!
2024-09-03 11:23:43 INFO     Epoch [44/200] train_loss: 3.5028, val_loss: 4.7942, lr: 0.003000, 4.71s
2024-09-03 11:23:47 INFO     epoch complete!
2024-09-03 11:23:47 INFO     evaluating now!
2024-09-03 11:23:48 INFO     Epoch [45/200] train_loss: 3.4749, val_loss: 4.7017, lr: 0.003000, 4.65s
2024-09-03 11:23:52 INFO     epoch complete!
2024-09-03 11:23:52 INFO     evaluating now!
2024-09-03 11:23:52 INFO     Epoch [46/200] train_loss: 3.4438, val_loss: 4.6536, lr: 0.003000, 4.70s
2024-09-03 11:23:57 INFO     epoch complete!
2024-09-03 11:23:57 INFO     evaluating now!
2024-09-03 11:23:57 INFO     Epoch [47/200] train_loss: 3.4705, val_loss: 4.6301, lr: 0.003000, 4.65s
2024-09-03 11:24:01 INFO     epoch complete!
2024-09-03 11:24:01 INFO     evaluating now!
2024-09-03 11:24:02 INFO     Epoch [48/200] train_loss: 3.4623, val_loss: 4.6492, lr: 0.003000, 4.67s
2024-09-03 11:24:06 INFO     epoch complete!
2024-09-03 11:24:06 INFO     evaluating now!
2024-09-03 11:24:06 INFO     Epoch [49/200] train_loss: 3.3795, val_loss: 4.6095, lr: 0.003000, 4.78s
2024-09-03 11:24:06 INFO     Saved model at 49
2024-09-03 11:24:06 INFO     Val loss decrease from 4.6128 to 4.6095, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch49.tar
2024-09-03 11:24:11 INFO     epoch complete!
2024-09-03 11:24:11 INFO     evaluating now!
2024-09-03 11:24:11 INFO     Epoch [50/200] train_loss: 3.3877, val_loss: 4.5957, lr: 0.003000, 4.81s
2024-09-03 11:24:11 INFO     Saved model at 50
2024-09-03 11:24:11 INFO     Val loss decrease from 4.6095 to 4.5957, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch50.tar
2024-09-03 11:24:16 INFO     epoch complete!
2024-09-03 11:24:16 INFO     evaluating now!
2024-09-03 11:24:16 INFO     Epoch [51/200] train_loss: 3.3493, val_loss: 4.7031, lr: 0.003000, 4.69s
2024-09-03 11:24:20 INFO     epoch complete!
2024-09-03 11:24:20 INFO     evaluating now!
2024-09-03 11:24:21 INFO     Epoch [52/200] train_loss: 3.3337, val_loss: 4.7020, lr: 0.003000, 4.65s
2024-09-03 11:24:25 INFO     epoch complete!
2024-09-03 11:24:25 INFO     evaluating now!
2024-09-03 11:24:25 INFO     Epoch [53/200] train_loss: 3.3144, val_loss: 4.7560, lr: 0.003000, 4.69s
2024-09-03 11:24:30 INFO     epoch complete!
2024-09-03 11:24:30 INFO     evaluating now!
2024-09-03 11:24:30 INFO     Epoch [54/200] train_loss: 3.3221, val_loss: 4.7367, lr: 0.003000, 4.69s
2024-09-03 11:24:34 INFO     epoch complete!
2024-09-03 11:24:34 INFO     evaluating now!
2024-09-03 11:24:35 INFO     Epoch [55/200] train_loss: 3.2829, val_loss: 4.6940, lr: 0.003000, 4.71s
2024-09-03 11:24:39 INFO     epoch complete!
2024-09-03 11:24:39 INFO     evaluating now!
2024-09-03 11:24:39 INFO     Epoch [56/200] train_loss: 3.3222, val_loss: 4.7470, lr: 0.003000, 4.68s
2024-09-03 11:24:44 INFO     epoch complete!
2024-09-03 11:24:44 INFO     evaluating now!
2024-09-03 11:24:44 INFO     Epoch [57/200] train_loss: 3.2777, val_loss: 4.7363, lr: 0.003000, 4.71s
2024-09-03 11:24:49 INFO     epoch complete!
2024-09-03 11:24:49 INFO     evaluating now!
2024-09-03 11:24:49 INFO     Epoch [58/200] train_loss: 3.2463, val_loss: 4.7152, lr: 0.003000, 4.73s
2024-09-03 11:24:53 INFO     epoch complete!
2024-09-03 11:24:53 INFO     evaluating now!
2024-09-03 11:24:54 INFO     Epoch [59/200] train_loss: 3.2552, val_loss: 4.6510, lr: 0.003000, 4.74s
2024-09-03 11:24:58 INFO     epoch complete!
2024-09-03 11:24:58 INFO     evaluating now!
2024-09-03 11:24:58 INFO     Epoch [60/200] train_loss: 3.2242, val_loss: 4.6432, lr: 0.003000, 4.75s
2024-09-03 11:25:03 INFO     epoch complete!
2024-09-03 11:25:03 INFO     evaluating now!
2024-09-03 11:25:03 INFO     Epoch [61/200] train_loss: 3.2225, val_loss: 4.7301, lr: 0.003000, 4.69s
2024-09-03 11:25:07 INFO     epoch complete!
2024-09-03 11:25:07 INFO     evaluating now!
2024-09-03 11:25:08 INFO     Epoch [62/200] train_loss: 3.2162, val_loss: 4.6639, lr: 0.003000, 4.66s
2024-09-03 11:25:12 INFO     epoch complete!
2024-09-03 11:25:12 INFO     evaluating now!
2024-09-03 11:25:12 INFO     Epoch [63/200] train_loss: 3.1688, val_loss: 4.6284, lr: 0.003000, 4.66s
2024-09-03 11:25:17 INFO     epoch complete!
2024-09-03 11:25:17 INFO     evaluating now!
2024-09-03 11:25:17 INFO     Epoch [64/200] train_loss: 3.1617, val_loss: 4.7331, lr: 0.003000, 4.67s
2024-09-03 11:25:21 INFO     epoch complete!
2024-09-03 11:25:21 INFO     evaluating now!
2024-09-03 11:25:22 INFO     Epoch [65/200] train_loss: 3.1610, val_loss: 4.6913, lr: 0.003000, 4.67s
2024-09-03 11:25:22 WARNING  Early stopping at epoch: 65
2024-09-03 11:25:22 INFO     Trained totally 66 epochs, average train time is 4.448s, average eval time is 0.249s
2024-09-03 11:25:22 INFO     Loaded model at 50
2024-09-03 11:25:22 INFO     Saved model at ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406.m
2024-09-03 11:25:22 INFO     Start evaluating ...
2024-09-03 11:25:23 INFO     Note that you select the single mode to evaluate!
2024-09-03 11:25:23 INFO     Evaluate result is saved at ./libcity/cache/100/evaluate_cache\2024_09_03_11_25_23_AGCRN_CHITaxi20190406.csv
2024-09-03 11:25:23 INFO     
         MAE      RMSE
1   2.356846  7.440224
2   2.401938  7.776732
3   2.595559  8.587818
4   2.657117  9.063801
5   2.682322  9.271439
6   2.730484  9.541403
7   2.718916  9.707092
8   2.763924  9.875645
9   2.724758  9.870946
10  2.762754  9.881651
11  2.737522  9.811417
12  2.837926  9.838426
2024-09-03 11:25:23 INFO     ----------------------------------------------------------------------------
2024-09-03 11:25:23 INFO     # 4, Kownledge Graph Embedding: Normal, Experiment ids: 104
2024-09-03 11:25:23 INFO     ----------------------------------------------------------------------------
2024-09-03 11:25:23 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=100
2024-09-03 11:25:23 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 100, 'add_time_in_day': True, 'add_day_in_week': True, 'load_external': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-03 11:25:23 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-03 11:25:23 INFO     set_weight_link_or_dist: dist
2024-09-03 11:25:23 INFO     init_weight_inf_or_zero: inf
2024-09-03 11:25:23 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-03 11:25:23 INFO     Start Calculate the weight by Gauss kernel!
2024-09-03 11:25:23 INFO     Loading file CHITaxi20190406.dyna
2024-09-03 11:25:23 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-03 11:25:23 INFO     Dataset created
2024-09-03 11:25:23 INFO     x shape: (4345, 12, 77, 10), y shape: (4345, 12, 77, 10)
2024-09-03 11:25:23 INFO     train	x: (3042, 12, 77, 10), y: (3042, 12, 77, 10)
2024-09-03 11:25:23 INFO     eval	x: (434, 12, 77, 10), y: (434, 12, 77, 10)
2024-09-03 11:25:23 INFO     test	x: (869, 12, 77, 10), y: (869, 12, 77, 10)
2024-09-03 11:25:23 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-03 11:25:23 INFO     NoneScaler
2024-09-03 11:25:24 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-03 11:25:24 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-03 11:25:24 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 74, 128])	cuda:0	True
2024-09-03 11:25:24 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 11:25:24 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 74, 64])	cuda:0	True
2024-09-03 11:25:24 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 11:25:24 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-03 11:25:24 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-03 11:25:24 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-03 11:25:24 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-03 11:25:24 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-03 11:25:24 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-03 11:25:24 INFO     Total parameter numbers: 781850
2024-09-03 11:25:24 INFO     You select `adam` optimizer.
2024-09-03 11:25:24 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-03 11:25:24 INFO     Start training ...
2024-09-03 11:25:24 INFO     num_batches:48
2024-09-03 11:25:28 INFO     epoch complete!
2024-09-03 11:25:28 INFO     evaluating now!
2024-09-03 11:25:29 INFO     Epoch [0/200] train_loss: 24.0249, val_loss: 17.8732, lr: 0.003000, 4.86s
2024-09-03 11:25:29 INFO     Saved model at 0
2024-09-03 11:25:29 INFO     Val loss decrease from inf to 17.8732, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-03 11:25:33 INFO     epoch complete!
2024-09-03 11:25:33 INFO     evaluating now!
2024-09-03 11:25:33 INFO     Epoch [1/200] train_loss: 13.8958, val_loss: 12.3806, lr: 0.003000, 4.76s
2024-09-03 11:25:33 INFO     Saved model at 1
2024-09-03 11:25:33 INFO     Val loss decrease from 17.8732 to 12.3806, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-03 11:25:38 INFO     epoch complete!
2024-09-03 11:25:38 INFO     evaluating now!
2024-09-03 11:25:38 INFO     Epoch [2/200] train_loss: 9.9802, val_loss: 8.9316, lr: 0.003000, 4.76s
2024-09-03 11:25:38 INFO     Saved model at 2
2024-09-03 11:25:38 INFO     Val loss decrease from 12.3806 to 8.9316, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-03 11:25:43 INFO     epoch complete!
2024-09-03 11:25:43 INFO     evaluating now!
2024-09-03 11:25:43 INFO     Epoch [3/200] train_loss: 7.9151, val_loss: 7.2886, lr: 0.003000, 4.84s
2024-09-03 11:25:43 INFO     Saved model at 3
2024-09-03 11:25:43 INFO     Val loss decrease from 8.9316 to 7.2886, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-03 11:25:48 INFO     epoch complete!
2024-09-03 11:25:48 INFO     evaluating now!
2024-09-03 11:25:48 INFO     Epoch [4/200] train_loss: 6.8197, val_loss: 6.7604, lr: 0.003000, 4.69s
2024-09-03 11:25:48 INFO     Saved model at 4
2024-09-03 11:25:48 INFO     Val loss decrease from 7.2886 to 6.7604, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-03 11:25:52 INFO     epoch complete!
2024-09-03 11:25:52 INFO     evaluating now!
2024-09-03 11:25:52 INFO     Epoch [5/200] train_loss: 6.2921, val_loss: 5.9914, lr: 0.003000, 4.68s
2024-09-03 11:25:52 INFO     Saved model at 5
2024-09-03 11:25:52 INFO     Val loss decrease from 6.7604 to 5.9914, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-03 11:25:57 INFO     epoch complete!
2024-09-03 11:25:57 INFO     evaluating now!
2024-09-03 11:25:57 INFO     Epoch [6/200] train_loss: 5.9112, val_loss: 5.6967, lr: 0.003000, 4.68s
2024-09-03 11:25:57 INFO     Saved model at 6
2024-09-03 11:25:57 INFO     Val loss decrease from 5.9914 to 5.6967, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-03 11:26:02 INFO     epoch complete!
2024-09-03 11:26:02 INFO     evaluating now!
2024-09-03 11:26:02 INFO     Epoch [7/200] train_loss: 5.5641, val_loss: 5.7483, lr: 0.003000, 4.68s
2024-09-03 11:26:06 INFO     epoch complete!
2024-09-03 11:26:06 INFO     evaluating now!
2024-09-03 11:26:07 INFO     Epoch [8/200] train_loss: 5.3380, val_loss: 5.3710, lr: 0.003000, 4.69s
2024-09-03 11:26:07 INFO     Saved model at 8
2024-09-03 11:26:07 INFO     Val loss decrease from 5.6967 to 5.3710, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-03 11:26:11 INFO     epoch complete!
2024-09-03 11:26:11 INFO     evaluating now!
2024-09-03 11:26:11 INFO     Epoch [9/200] train_loss: 5.1340, val_loss: 5.7401, lr: 0.003000, 4.70s
2024-09-03 11:26:16 INFO     epoch complete!
2024-09-03 11:26:16 INFO     evaluating now!
2024-09-03 11:26:16 INFO     Epoch [10/200] train_loss: 5.0360, val_loss: 5.3260, lr: 0.003000, 4.69s
2024-09-03 11:26:16 INFO     Saved model at 10
2024-09-03 11:26:16 INFO     Val loss decrease from 5.3710 to 5.3260, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-03 11:26:20 INFO     epoch complete!
2024-09-03 11:26:20 INFO     evaluating now!
2024-09-03 11:26:21 INFO     Epoch [11/200] train_loss: 4.9327, val_loss: 5.1217, lr: 0.003000, 4.69s
2024-09-03 11:26:21 INFO     Saved model at 11
2024-09-03 11:26:21 INFO     Val loss decrease from 5.3260 to 5.1217, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-03 11:26:25 INFO     epoch complete!
2024-09-03 11:26:25 INFO     evaluating now!
2024-09-03 11:26:25 INFO     Epoch [12/200] train_loss: 4.7932, val_loss: 4.9377, lr: 0.003000, 4.70s
2024-09-03 11:26:25 INFO     Saved model at 12
2024-09-03 11:26:25 INFO     Val loss decrease from 5.1217 to 4.9377, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-03 11:26:30 INFO     epoch complete!
2024-09-03 11:26:30 INFO     evaluating now!
2024-09-03 11:26:30 INFO     Epoch [13/200] train_loss: 4.6557, val_loss: 5.1074, lr: 0.003000, 4.68s
2024-09-03 11:26:35 INFO     epoch complete!
2024-09-03 11:26:35 INFO     evaluating now!
2024-09-03 11:26:35 INFO     Epoch [14/200] train_loss: 4.5464, val_loss: 4.9172, lr: 0.003000, 4.70s
2024-09-03 11:26:35 INFO     Saved model at 14
2024-09-03 11:26:35 INFO     Val loss decrease from 4.9377 to 4.9172, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-03 11:26:39 INFO     epoch complete!
2024-09-03 11:26:39 INFO     evaluating now!
2024-09-03 11:26:39 INFO     Epoch [15/200] train_loss: 4.5200, val_loss: 5.0986, lr: 0.003000, 4.67s
2024-09-03 11:26:44 INFO     epoch complete!
2024-09-03 11:26:44 INFO     evaluating now!
2024-09-03 11:26:44 INFO     Epoch [16/200] train_loss: 4.4928, val_loss: 4.9837, lr: 0.003000, 4.68s
2024-09-03 11:26:49 INFO     epoch complete!
2024-09-03 11:26:49 INFO     evaluating now!
2024-09-03 11:26:49 INFO     Epoch [17/200] train_loss: 4.3438, val_loss: 4.8953, lr: 0.003000, 4.68s
2024-09-03 11:26:49 INFO     Saved model at 17
2024-09-03 11:26:49 INFO     Val loss decrease from 4.9172 to 4.8953, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-03 11:26:53 INFO     epoch complete!
2024-09-03 11:26:53 INFO     evaluating now!
2024-09-03 11:26:53 INFO     Epoch [18/200] train_loss: 4.3146, val_loss: 4.9692, lr: 0.003000, 4.67s
2024-09-03 11:26:58 INFO     epoch complete!
2024-09-03 11:26:58 INFO     evaluating now!
2024-09-03 11:26:58 INFO     Epoch [19/200] train_loss: 4.2957, val_loss: 4.8342, lr: 0.003000, 4.70s
2024-09-03 11:26:58 INFO     Saved model at 19
2024-09-03 11:26:58 INFO     Val loss decrease from 4.8953 to 4.8342, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-03 11:27:03 INFO     epoch complete!
2024-09-03 11:27:03 INFO     evaluating now!
2024-09-03 11:27:03 INFO     Epoch [20/200] train_loss: 4.2483, val_loss: 4.9337, lr: 0.003000, 4.67s
2024-09-03 11:27:07 INFO     epoch complete!
2024-09-03 11:27:07 INFO     evaluating now!
2024-09-03 11:27:08 INFO     Epoch [21/200] train_loss: 4.1259, val_loss: 4.8045, lr: 0.003000, 4.67s
2024-09-03 11:27:08 INFO     Saved model at 21
2024-09-03 11:27:08 INFO     Val loss decrease from 4.8342 to 4.8045, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-03 11:27:12 INFO     epoch complete!
2024-09-03 11:27:12 INFO     evaluating now!
2024-09-03 11:27:12 INFO     Epoch [22/200] train_loss: 4.0634, val_loss: 4.8636, lr: 0.003000, 4.68s
2024-09-03 11:27:17 INFO     epoch complete!
2024-09-03 11:27:17 INFO     evaluating now!
2024-09-03 11:27:17 INFO     Epoch [23/200] train_loss: 4.0568, val_loss: 4.7946, lr: 0.003000, 4.66s
2024-09-03 11:27:17 INFO     Saved model at 23
2024-09-03 11:27:17 INFO     Val loss decrease from 4.8045 to 4.7946, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-03 11:27:21 INFO     epoch complete!
2024-09-03 11:27:21 INFO     evaluating now!
2024-09-03 11:27:22 INFO     Epoch [24/200] train_loss: 4.0153, val_loss: 4.7966, lr: 0.003000, 4.67s
2024-09-03 11:27:26 INFO     epoch complete!
2024-09-03 11:27:26 INFO     evaluating now!
2024-09-03 11:27:26 INFO     Epoch [25/200] train_loss: 3.9641, val_loss: 4.6894, lr: 0.003000, 4.68s
2024-09-03 11:27:26 INFO     Saved model at 25
2024-09-03 11:27:26 INFO     Val loss decrease from 4.7946 to 4.6894, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-03 11:27:31 INFO     epoch complete!
2024-09-03 11:27:31 INFO     evaluating now!
2024-09-03 11:27:31 INFO     Epoch [26/200] train_loss: 3.9836, val_loss: 4.7800, lr: 0.003000, 4.66s
2024-09-03 11:27:35 INFO     epoch complete!
2024-09-03 11:27:35 INFO     evaluating now!
2024-09-03 11:27:36 INFO     Epoch [27/200] train_loss: 3.8856, val_loss: 4.7702, lr: 0.003000, 4.66s
2024-09-03 11:27:40 INFO     epoch complete!
2024-09-03 11:27:40 INFO     evaluating now!
2024-09-03 11:27:40 INFO     Epoch [28/200] train_loss: 3.8523, val_loss: 4.6014, lr: 0.003000, 4.72s
2024-09-03 11:27:40 INFO     Saved model at 28
2024-09-03 11:27:40 INFO     Val loss decrease from 4.6894 to 4.6014, saving to ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-03 11:27:45 INFO     epoch complete!
2024-09-03 11:27:45 INFO     evaluating now!
2024-09-03 11:27:45 INFO     Epoch [29/200] train_loss: 3.8119, val_loss: 4.6821, lr: 0.003000, 4.71s
2024-09-03 11:27:49 INFO     epoch complete!
2024-09-03 11:27:49 INFO     evaluating now!
2024-09-03 11:27:50 INFO     Epoch [30/200] train_loss: 3.8188, val_loss: 4.7660, lr: 0.003000, 4.67s
2024-09-03 11:27:54 INFO     epoch complete!
2024-09-03 11:27:54 INFO     evaluating now!
2024-09-03 11:27:54 INFO     Epoch [31/200] train_loss: 3.7565, val_loss: 4.6842, lr: 0.003000, 4.67s
2024-09-03 11:27:59 INFO     epoch complete!
2024-09-03 11:27:59 INFO     evaluating now!
2024-09-03 11:27:59 INFO     Epoch [32/200] train_loss: 3.7134, val_loss: 4.7152, lr: 0.003000, 4.66s
2024-09-03 11:28:03 INFO     epoch complete!
2024-09-03 11:28:03 INFO     evaluating now!
2024-09-03 11:28:04 INFO     Epoch [33/200] train_loss: 3.7366, val_loss: 4.7386, lr: 0.003000, 4.66s
2024-09-03 11:28:08 INFO     epoch complete!
2024-09-03 11:28:08 INFO     evaluating now!
2024-09-03 11:28:08 INFO     Epoch [34/200] train_loss: 3.7069, val_loss: 4.6872, lr: 0.003000, 4.68s
2024-09-03 11:28:13 INFO     epoch complete!
2024-09-03 11:28:13 INFO     evaluating now!
2024-09-03 11:28:13 INFO     Epoch [35/200] train_loss: 3.6409, val_loss: 4.7643, lr: 0.003000, 4.68s
2024-09-03 11:28:17 INFO     epoch complete!
2024-09-03 11:28:17 INFO     evaluating now!
2024-09-03 11:28:18 INFO     Epoch [36/200] train_loss: 3.6343, val_loss: 4.7431, lr: 0.003000, 4.67s
2024-09-03 11:28:22 INFO     epoch complete!
2024-09-03 11:28:22 INFO     evaluating now!
2024-09-03 11:28:22 INFO     Epoch [37/200] train_loss: 3.6017, val_loss: 4.7526, lr: 0.003000, 4.65s
2024-09-03 11:28:27 INFO     epoch complete!
2024-09-03 11:28:27 INFO     evaluating now!
2024-09-03 11:28:27 INFO     Epoch [38/200] train_loss: 3.5833, val_loss: 4.7606, lr: 0.003000, 4.67s
2024-09-03 11:28:31 INFO     epoch complete!
2024-09-03 11:28:31 INFO     evaluating now!
2024-09-03 11:28:32 INFO     Epoch [39/200] train_loss: 3.5749, val_loss: 4.7727, lr: 0.003000, 4.67s
2024-09-03 11:28:36 INFO     epoch complete!
2024-09-03 11:28:36 INFO     evaluating now!
2024-09-03 11:28:36 INFO     Epoch [40/200] train_loss: 3.5654, val_loss: 4.7232, lr: 0.003000, 4.68s
2024-09-03 11:28:41 INFO     epoch complete!
2024-09-03 11:28:41 INFO     evaluating now!
2024-09-03 11:28:41 INFO     Epoch [41/200] train_loss: 3.5140, val_loss: 4.7306, lr: 0.003000, 4.70s
2024-09-03 11:28:46 INFO     epoch complete!
2024-09-03 11:28:46 INFO     evaluating now!
2024-09-03 11:28:46 INFO     Epoch [42/200] train_loss: 3.5192, val_loss: 4.7210, lr: 0.003000, 4.67s
2024-09-03 11:28:50 INFO     epoch complete!
2024-09-03 11:28:50 INFO     evaluating now!
2024-09-03 11:28:50 INFO     Epoch [43/200] train_loss: 3.4990, val_loss: 4.6655, lr: 0.003000, 4.67s
2024-09-03 11:28:50 WARNING  Early stopping at epoch: 43
2024-09-03 11:28:50 INFO     Trained totally 44 epochs, average train time is 4.444s, average eval time is 0.246s
2024-09-03 11:28:50 INFO     Loaded model at 28
2024-09-03 11:28:50 INFO     Saved model at ./libcity/cache/100/model_cache/AGCRN_CHITaxi20190406.m
2024-09-03 11:28:50 INFO     Start evaluating ...
2024-09-03 11:28:51 INFO     Note that you select the single mode to evaluate!
2024-09-03 11:28:51 INFO     Evaluate result is saved at ./libcity/cache/100/evaluate_cache\2024_09_03_11_28_51_AGCRN_CHITaxi20190406.csv
2024-09-03 11:28:51 INFO     
         MAE       RMSE
1   2.431729   7.273142
2   2.522230   7.845424
3   2.605989   8.623349
4   2.740952   8.932144
5   2.724102   9.042910
6   2.733618   8.995921
7   2.757455   9.232547
8   2.827483   9.459348
9   2.837319   9.637405
10  2.863119   9.739848
11  2.992690   9.961807
12  3.029814  10.396605
2024-09-03 11:28:51 INFO     ----------------------------------------------------------------------------
2024-09-03 11:28:51 INFO     Kownledge Graph Embedding: Normal, Experiment ids: [100, 101, 102, 103, 104]
2024-09-03 11:28:51 INFO     ----------------------------------------------------------------------------
2024-09-03 11:28:51 INFO     Average: 
         MAE       RMSE
0   2.395942   7.364664
1   2.467221   7.881812
2   2.588484   8.660440
3   2.681314   9.008797
4   2.701949   9.227144
5   2.719679   9.287709
6   2.729019   9.428006
7   2.784136   9.569851
8   2.787854   9.686579
9   2.819784   9.781268
10  2.855632   9.945642
11  2.906963  10.210834 
2024-09-03 11:28:51 INFO     Standard deviation: 
         MAE      RMSE
0   0.055551  0.306363
1   0.050593  0.358601
2   0.034907  0.274456
3   0.043231  0.260285
4   0.038855  0.257623
5   0.048605  0.297637
6   0.075414  0.282229
7   0.050643  0.286306
8   0.076618  0.271877
9   0.072370  0.301276
10  0.103365  0.288265
11  0.079789  0.366973
2024-09-03 11:28:51 INFO     ----------------------------------------------------------------------------
2024-09-03 11:28:51 INFO     12 steps Average: 
        MAE      RMSE
0  2.703165  9.171062
2024-09-03 11:28:51 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.060828  0.295991
