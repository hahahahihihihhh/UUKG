2024-09-28 12:49:41 INFO     Saving logs in: ./logs/CHITaxi20190406/AGCRN/Concat/GIE
2024-09-28 12:49:41 INFO     ----------------------------------------------------------------------------
2024-09-28 12:49:41 INFO     # 0, Kownledge Graph Embedding: GIE, Experiment ids: 15
2024-09-28 12:49:41 INFO     ----------------------------------------------------------------------------
2024-09-28 12:49:41 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=15
2024-09-28 12:49:41 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 15, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 12:49:41 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 12:49:41 INFO     set_weight_link_or_dist: dist
2024-09-28 12:49:41 INFO     init_weight_inf_or_zero: inf
2024-09-28 12:49:41 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 12:49:41 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 12:49:41 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 12:49:42 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 12:49:44 INFO     Dataset created
2024-09-28 12:49:44 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-28 12:49:44 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-28 12:49:44 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-28 12:49:44 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-28 12:49:44 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 12:49:44 INFO     NoneScaler
2024-09-28 12:49:49 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 12:49:49 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 12:49:49 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-28 12:49:49 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 12:49:49 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-28 12:49:49 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 12:49:49 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 12:49:49 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 12:49:49 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 12:49:49 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 12:49:49 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 12:49:49 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 12:49:49 INFO     Total parameter numbers: 874010
2024-09-28 12:49:49 INFO     You select `adam` optimizer.
2024-09-28 12:49:49 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 12:49:49 INFO     Start training ...
2024-09-28 12:49:49 INFO     num_batches:48
2024-09-28 12:49:55 INFO     epoch complete!
2024-09-28 12:49:55 INFO     evaluating now!
2024-09-28 12:49:55 INFO     Epoch [0/200] train_loss: 23.6999, val_loss: 17.6196, lr: 0.003000, 6.27s
2024-09-28 12:49:55 INFO     Saved model at 0
2024-09-28 12:49:55 INFO     Val loss decrease from inf to 17.6196, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 12:50:01 INFO     epoch complete!
2024-09-28 12:50:01 INFO     evaluating now!
2024-09-28 12:50:01 INFO     Epoch [1/200] train_loss: 14.0233, val_loss: 13.0026, lr: 0.003000, 5.75s
2024-09-28 12:50:01 INFO     Saved model at 1
2024-09-28 12:50:01 INFO     Val loss decrease from 17.6196 to 13.0026, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 12:50:07 INFO     epoch complete!
2024-09-28 12:50:07 INFO     evaluating now!
2024-09-28 12:50:07 INFO     Epoch [2/200] train_loss: 10.9486, val_loss: 10.5835, lr: 0.003000, 5.79s
2024-09-28 12:50:07 INFO     Saved model at 2
2024-09-28 12:50:07 INFO     Val loss decrease from 13.0026 to 10.5835, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 12:50:12 INFO     epoch complete!
2024-09-28 12:50:12 INFO     evaluating now!
2024-09-28 12:50:13 INFO     Epoch [3/200] train_loss: 9.1177, val_loss: 8.4365, lr: 0.003000, 5.55s
2024-09-28 12:50:13 INFO     Saved model at 3
2024-09-28 12:50:13 INFO     Val loss decrease from 10.5835 to 8.4365, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 12:50:18 INFO     epoch complete!
2024-09-28 12:50:18 INFO     evaluating now!
2024-09-28 12:50:19 INFO     Epoch [4/200] train_loss: 7.9504, val_loss: 7.5431, lr: 0.003000, 5.77s
2024-09-28 12:50:19 INFO     Saved model at 4
2024-09-28 12:50:19 INFO     Val loss decrease from 8.4365 to 7.5431, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 12:50:24 INFO     epoch complete!
2024-09-28 12:50:24 INFO     evaluating now!
2024-09-28 12:50:24 INFO     Epoch [5/200] train_loss: 7.2123, val_loss: 7.0602, lr: 0.003000, 5.68s
2024-09-28 12:50:24 INFO     Saved model at 5
2024-09-28 12:50:24 INFO     Val loss decrease from 7.5431 to 7.0602, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 12:50:30 INFO     epoch complete!
2024-09-28 12:50:30 INFO     evaluating now!
2024-09-28 12:50:30 INFO     Epoch [6/200] train_loss: 6.8188, val_loss: 6.9426, lr: 0.003000, 5.69s
2024-09-28 12:50:30 INFO     Saved model at 6
2024-09-28 12:50:30 INFO     Val loss decrease from 7.0602 to 6.9426, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-28 12:50:36 INFO     epoch complete!
2024-09-28 12:50:36 INFO     evaluating now!
2024-09-28 12:50:36 INFO     Epoch [7/200] train_loss: 6.3680, val_loss: 6.2293, lr: 0.003000, 5.95s
2024-09-28 12:50:36 INFO     Saved model at 7
2024-09-28 12:50:36 INFO     Val loss decrease from 6.9426 to 6.2293, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-28 12:50:41 INFO     epoch complete!
2024-09-28 12:50:41 INFO     evaluating now!
2024-09-28 12:50:42 INFO     Epoch [8/200] train_loss: 6.0686, val_loss: 6.2066, lr: 0.003000, 5.56s
2024-09-28 12:50:42 INFO     Saved model at 8
2024-09-28 12:50:42 INFO     Val loss decrease from 6.2293 to 6.2066, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-28 12:50:47 INFO     epoch complete!
2024-09-28 12:50:47 INFO     evaluating now!
2024-09-28 12:50:48 INFO     Epoch [9/200] train_loss: 5.9114, val_loss: 6.2049, lr: 0.003000, 5.79s
2024-09-28 12:50:48 INFO     Saved model at 9
2024-09-28 12:50:48 INFO     Val loss decrease from 6.2066 to 6.2049, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-28 12:50:53 INFO     epoch complete!
2024-09-28 12:50:53 INFO     evaluating now!
2024-09-28 12:50:54 INFO     Epoch [10/200] train_loss: 5.6944, val_loss: 6.0449, lr: 0.003000, 5.91s
2024-09-28 12:50:54 INFO     Saved model at 10
2024-09-28 12:50:54 INFO     Val loss decrease from 6.2049 to 6.0449, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-28 12:50:59 INFO     epoch complete!
2024-09-28 12:50:59 INFO     evaluating now!
2024-09-28 12:51:00 INFO     Epoch [11/200] train_loss: 5.5295, val_loss: 5.7556, lr: 0.003000, 6.01s
2024-09-28 12:51:00 INFO     Saved model at 11
2024-09-28 12:51:00 INFO     Val loss decrease from 6.0449 to 5.7556, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-28 12:51:05 INFO     epoch complete!
2024-09-28 12:51:05 INFO     evaluating now!
2024-09-28 12:51:06 INFO     Epoch [12/200] train_loss: 5.4092, val_loss: 5.7813, lr: 0.003000, 5.69s
2024-09-28 12:51:11 INFO     epoch complete!
2024-09-28 12:51:11 INFO     evaluating now!
2024-09-28 12:51:11 INFO     Epoch [13/200] train_loss: 5.4103, val_loss: 5.7992, lr: 0.003000, 5.78s
2024-09-28 12:51:17 INFO     epoch complete!
2024-09-28 12:51:17 INFO     evaluating now!
2024-09-28 12:51:17 INFO     Epoch [14/200] train_loss: 5.2625, val_loss: 5.4622, lr: 0.003000, 5.65s
2024-09-28 12:51:17 INFO     Saved model at 14
2024-09-28 12:51:17 INFO     Val loss decrease from 5.7556 to 5.4622, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-28 12:51:22 INFO     epoch complete!
2024-09-28 12:51:22 INFO     evaluating now!
2024-09-28 12:51:23 INFO     Epoch [15/200] train_loss: 5.0568, val_loss: 5.6071, lr: 0.003000, 5.67s
2024-09-28 12:51:28 INFO     epoch complete!
2024-09-28 12:51:28 INFO     evaluating now!
2024-09-28 12:51:29 INFO     Epoch [16/200] train_loss: 5.0891, val_loss: 5.5978, lr: 0.003000, 5.82s
2024-09-28 12:51:34 INFO     epoch complete!
2024-09-28 12:51:34 INFO     evaluating now!
2024-09-28 12:51:34 INFO     Epoch [17/200] train_loss: 5.0848, val_loss: 5.6444, lr: 0.003000, 5.59s
2024-09-28 12:51:40 INFO     epoch complete!
2024-09-28 12:51:40 INFO     evaluating now!
2024-09-28 12:51:40 INFO     Epoch [18/200] train_loss: 4.9500, val_loss: 5.4321, lr: 0.003000, 5.76s
2024-09-28 12:51:40 INFO     Saved model at 18
2024-09-28 12:51:40 INFO     Val loss decrease from 5.4622 to 5.4321, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-28 12:51:45 INFO     epoch complete!
2024-09-28 12:51:45 INFO     evaluating now!
2024-09-28 12:51:46 INFO     Epoch [19/200] train_loss: 4.8349, val_loss: 5.3148, lr: 0.003000, 5.52s
2024-09-28 12:51:46 INFO     Saved model at 19
2024-09-28 12:51:46 INFO     Val loss decrease from 5.4321 to 5.3148, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-28 12:51:51 INFO     epoch complete!
2024-09-28 12:51:51 INFO     evaluating now!
2024-09-28 12:51:51 INFO     Epoch [20/200] train_loss: 4.7373, val_loss: 5.2671, lr: 0.003000, 5.44s
2024-09-28 12:51:51 INFO     Saved model at 20
2024-09-28 12:51:51 INFO     Val loss decrease from 5.3148 to 5.2671, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-28 12:51:56 INFO     epoch complete!
2024-09-28 12:51:56 INFO     evaluating now!
2024-09-28 12:51:56 INFO     Epoch [21/200] train_loss: 4.7260, val_loss: 5.2487, lr: 0.003000, 5.34s
2024-09-28 12:51:57 INFO     Saved model at 21
2024-09-28 12:51:57 INFO     Val loss decrease from 5.2671 to 5.2487, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-28 12:52:01 INFO     epoch complete!
2024-09-28 12:52:01 INFO     evaluating now!
2024-09-28 12:52:02 INFO     Epoch [22/200] train_loss: 4.6694, val_loss: 5.2078, lr: 0.003000, 5.25s
2024-09-28 12:52:02 INFO     Saved model at 22
2024-09-28 12:52:02 INFO     Val loss decrease from 5.2487 to 5.2078, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-28 12:52:07 INFO     epoch complete!
2024-09-28 12:52:07 INFO     evaluating now!
2024-09-28 12:52:07 INFO     Epoch [23/200] train_loss: 4.5983, val_loss: 5.3677, lr: 0.003000, 5.15s
2024-09-28 12:52:12 INFO     epoch complete!
2024-09-28 12:52:12 INFO     evaluating now!
2024-09-28 12:52:12 INFO     Epoch [24/200] train_loss: 4.5167, val_loss: 5.3846, lr: 0.003000, 5.01s
2024-09-28 12:52:17 INFO     epoch complete!
2024-09-28 12:52:17 INFO     evaluating now!
2024-09-28 12:52:18 INFO     Epoch [25/200] train_loss: 4.4961, val_loss: 5.1350, lr: 0.003000, 5.50s
2024-09-28 12:52:18 INFO     Saved model at 25
2024-09-28 12:52:18 INFO     Val loss decrease from 5.2078 to 5.1350, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-28 12:52:22 INFO     epoch complete!
2024-09-28 12:52:22 INFO     evaluating now!
2024-09-28 12:52:23 INFO     Epoch [26/200] train_loss: 4.4306, val_loss: 5.2106, lr: 0.003000, 5.15s
2024-09-28 12:52:27 INFO     epoch complete!
2024-09-28 12:52:27 INFO     evaluating now!
2024-09-28 12:52:28 INFO     Epoch [27/200] train_loss: 4.4415, val_loss: 5.2135, lr: 0.003000, 4.94s
2024-09-28 12:52:32 INFO     epoch complete!
2024-09-28 12:52:32 INFO     evaluating now!
2024-09-28 12:52:33 INFO     Epoch [28/200] train_loss: 4.3570, val_loss: 5.1520, lr: 0.003000, 4.96s
2024-09-28 12:52:37 INFO     epoch complete!
2024-09-28 12:52:37 INFO     evaluating now!
2024-09-28 12:52:38 INFO     Epoch [29/200] train_loss: 4.2862, val_loss: 5.0798, lr: 0.003000, 5.04s
2024-09-28 12:52:38 INFO     Saved model at 29
2024-09-28 12:52:38 INFO     Val loss decrease from 5.1350 to 5.0798, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-28 12:52:42 INFO     epoch complete!
2024-09-28 12:52:42 INFO     evaluating now!
2024-09-28 12:52:43 INFO     Epoch [30/200] train_loss: 4.2482, val_loss: 5.2266, lr: 0.003000, 4.93s
2024-09-28 12:52:47 INFO     epoch complete!
2024-09-28 12:52:47 INFO     evaluating now!
2024-09-28 12:52:48 INFO     Epoch [31/200] train_loss: 4.2543, val_loss: 5.1128, lr: 0.003000, 4.97s
2024-09-28 12:52:52 INFO     epoch complete!
2024-09-28 12:52:52 INFO     evaluating now!
2024-09-28 12:52:53 INFO     Epoch [32/200] train_loss: 4.2547, val_loss: 5.1680, lr: 0.003000, 5.04s
2024-09-28 12:52:58 INFO     epoch complete!
2024-09-28 12:52:58 INFO     evaluating now!
2024-09-28 12:52:58 INFO     Epoch [33/200] train_loss: 4.1934, val_loss: 5.1434, lr: 0.003000, 5.23s
2024-09-28 12:53:03 INFO     epoch complete!
2024-09-28 12:53:03 INFO     evaluating now!
2024-09-28 12:53:03 INFO     Epoch [34/200] train_loss: 4.2324, val_loss: 5.0450, lr: 0.003000, 4.96s
2024-09-28 12:53:03 INFO     Saved model at 34
2024-09-28 12:53:03 INFO     Val loss decrease from 5.0798 to 5.0450, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-09-28 12:53:08 INFO     epoch complete!
2024-09-28 12:53:08 INFO     evaluating now!
2024-09-28 12:53:08 INFO     Epoch [35/200] train_loss: 4.1093, val_loss: 5.0399, lr: 0.003000, 5.06s
2024-09-28 12:53:08 INFO     Saved model at 35
2024-09-28 12:53:08 INFO     Val loss decrease from 5.0450 to 5.0399, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-28 12:53:13 INFO     epoch complete!
2024-09-28 12:53:13 INFO     evaluating now!
2024-09-28 12:53:13 INFO     Epoch [36/200] train_loss: 4.1009, val_loss: 5.1118, lr: 0.003000, 5.24s
2024-09-28 12:53:18 INFO     epoch complete!
2024-09-28 12:53:18 INFO     evaluating now!
2024-09-28 12:53:18 INFO     Epoch [37/200] train_loss: 4.0798, val_loss: 5.1170, lr: 0.003000, 5.13s
2024-09-28 12:53:23 INFO     epoch complete!
2024-09-28 12:53:23 INFO     evaluating now!
2024-09-28 12:53:24 INFO     Epoch [38/200] train_loss: 4.0544, val_loss: 5.1994, lr: 0.003000, 5.07s
2024-09-28 12:53:28 INFO     epoch complete!
2024-09-28 12:53:28 INFO     evaluating now!
2024-09-28 12:53:28 INFO     Epoch [39/200] train_loss: 4.0509, val_loss: 5.1671, lr: 0.003000, 4.95s
2024-09-28 12:53:33 INFO     epoch complete!
2024-09-28 12:53:33 INFO     evaluating now!
2024-09-28 12:53:33 INFO     Epoch [40/200] train_loss: 3.9700, val_loss: 5.1117, lr: 0.003000, 4.98s
2024-09-28 12:53:38 INFO     epoch complete!
2024-09-28 12:53:38 INFO     evaluating now!
2024-09-28 12:53:39 INFO     Epoch [41/200] train_loss: 3.9033, val_loss: 5.2181, lr: 0.003000, 5.16s
2024-09-28 12:53:43 INFO     epoch complete!
2024-09-28 12:53:43 INFO     evaluating now!
2024-09-28 12:53:44 INFO     Epoch [42/200] train_loss: 3.9106, val_loss: 5.1233, lr: 0.003000, 5.10s
2024-09-28 12:53:48 INFO     epoch complete!
2024-09-28 12:53:48 INFO     evaluating now!
2024-09-28 12:53:49 INFO     Epoch [43/200] train_loss: 3.8858, val_loss: 5.0915, lr: 0.003000, 5.02s
2024-09-28 12:53:53 INFO     epoch complete!
2024-09-28 12:53:53 INFO     evaluating now!
2024-09-28 12:53:54 INFO     Epoch [44/200] train_loss: 3.8354, val_loss: 5.1728, lr: 0.003000, 5.09s
2024-09-28 12:53:58 INFO     epoch complete!
2024-09-28 12:53:58 INFO     evaluating now!
2024-09-28 12:53:59 INFO     Epoch [45/200] train_loss: 3.8396, val_loss: 5.2557, lr: 0.003000, 4.92s
2024-09-28 12:54:03 INFO     epoch complete!
2024-09-28 12:54:03 INFO     evaluating now!
2024-09-28 12:54:04 INFO     Epoch [46/200] train_loss: 3.8757, val_loss: 5.1162, lr: 0.003000, 4.99s
2024-09-28 12:54:08 INFO     epoch complete!
2024-09-28 12:54:08 INFO     evaluating now!
2024-09-28 12:54:09 INFO     Epoch [47/200] train_loss: 3.7709, val_loss: 5.0775, lr: 0.003000, 5.09s
2024-09-28 12:54:13 INFO     epoch complete!
2024-09-28 12:54:13 INFO     evaluating now!
2024-09-28 12:54:14 INFO     Epoch [48/200] train_loss: 3.7719, val_loss: 5.0578, lr: 0.003000, 5.01s
2024-09-28 12:54:19 INFO     epoch complete!
2024-09-28 12:54:19 INFO     evaluating now!
2024-09-28 12:54:19 INFO     Epoch [49/200] train_loss: 3.7528, val_loss: 5.0520, lr: 0.003000, 5.07s
2024-09-28 12:54:24 INFO     epoch complete!
2024-09-28 12:54:24 INFO     evaluating now!
2024-09-28 12:54:24 INFO     Epoch [50/200] train_loss: 3.7184, val_loss: 5.1342, lr: 0.003000, 4.97s
2024-09-28 12:54:24 WARNING  Early stopping at epoch: 50
2024-09-28 12:54:24 INFO     Trained totally 51 epochs, average train time is 4.986s, average eval time is 0.366s
2024-09-28 12:54:24 INFO     Loaded model at 35
2024-09-28 12:54:24 INFO     Saved model at ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 12:54:24 INFO     Start evaluating ...
2024-09-28 12:54:25 INFO     Note that you select the single mode to evaluate!
2024-09-28 12:54:25 INFO     Evaluate result is saved at ./libcity/cache/15/evaluate_cache/2024_09_28_12_54_25_AGCRN_CHITaxi20190406.csv
2024-09-28 12:54:25 INFO     
         MAE       RMSE  masked_MAPE
1   2.350290   7.151368     0.404480
2   2.396898   7.620512     0.407906
3   2.610605   8.741709     0.426717
4   2.755533   9.515495     0.426208
5   2.891965  10.264732     0.434117
6   3.013925  10.941999     0.437083
7   3.106130  11.720862     0.441242
8   3.184842  12.156153     0.448904
9   3.219579  12.569524     0.445935
10  3.280398  12.853098     0.455183
11  3.328449  13.307127     0.458651
12  3.444039  13.945664     0.469261
2024-09-28 12:54:26 INFO     ----------------------------------------------------------------------------
2024-09-28 12:54:26 INFO     # 1, Kownledge Graph Embedding: GIE, Experiment ids: 16
2024-09-28 12:54:26 INFO     ----------------------------------------------------------------------------
2024-09-28 12:54:26 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=16
2024-09-28 12:54:26 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 16, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 12:54:26 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 12:54:26 INFO     set_weight_link_or_dist: dist
2024-09-28 12:54:26 INFO     init_weight_inf_or_zero: inf
2024-09-28 12:54:26 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 12:54:26 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 12:54:26 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 12:54:26 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 12:54:29 INFO     Dataset created
2024-09-28 12:54:29 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-28 12:54:29 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-28 12:54:29 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-28 12:54:29 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-28 12:54:29 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 12:54:29 INFO     NoneScaler
2024-09-28 12:54:31 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 12:54:31 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 12:54:31 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-28 12:54:31 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 12:54:31 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-28 12:54:31 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 12:54:31 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 12:54:31 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 12:54:31 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 12:54:31 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 12:54:31 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 12:54:31 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 12:54:31 INFO     Total parameter numbers: 874010
2024-09-28 12:54:31 INFO     You select `adam` optimizer.
2024-09-28 12:54:31 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 12:54:31 INFO     Start training ...
2024-09-28 12:54:31 INFO     num_batches:48
2024-09-28 12:54:35 INFO     epoch complete!
2024-09-28 12:54:35 INFO     evaluating now!
2024-09-28 12:54:36 INFO     Epoch [0/200] train_loss: 25.0844, val_loss: 18.0992, lr: 0.003000, 4.98s
2024-09-28 12:54:36 INFO     Saved model at 0
2024-09-28 12:54:36 INFO     Val loss decrease from inf to 18.0992, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 12:54:41 INFO     epoch complete!
2024-09-28 12:54:41 INFO     evaluating now!
2024-09-28 12:54:41 INFO     Epoch [1/200] train_loss: 14.4717, val_loss: 14.0019, lr: 0.003000, 5.16s
2024-09-28 12:54:41 INFO     Saved model at 1
2024-09-28 12:54:41 INFO     Val loss decrease from 18.0992 to 14.0019, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 12:54:46 INFO     epoch complete!
2024-09-28 12:54:46 INFO     evaluating now!
2024-09-28 12:54:46 INFO     Epoch [2/200] train_loss: 11.4839, val_loss: 11.2954, lr: 0.003000, 4.85s
2024-09-28 12:54:46 INFO     Saved model at 2
2024-09-28 12:54:46 INFO     Val loss decrease from 14.0019 to 11.2954, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 12:54:51 INFO     epoch complete!
2024-09-28 12:54:51 INFO     evaluating now!
2024-09-28 12:54:51 INFO     Epoch [3/200] train_loss: 9.6046, val_loss: 9.3316, lr: 0.003000, 4.82s
2024-09-28 12:54:51 INFO     Saved model at 3
2024-09-28 12:54:51 INFO     Val loss decrease from 11.2954 to 9.3316, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 12:54:56 INFO     epoch complete!
2024-09-28 12:54:56 INFO     evaluating now!
2024-09-28 12:54:56 INFO     Epoch [4/200] train_loss: 8.1208, val_loss: 7.7877, lr: 0.003000, 4.87s
2024-09-28 12:54:56 INFO     Saved model at 4
2024-09-28 12:54:56 INFO     Val loss decrease from 9.3316 to 7.7877, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 12:55:01 INFO     epoch complete!
2024-09-28 12:55:01 INFO     evaluating now!
2024-09-28 12:55:01 INFO     Epoch [5/200] train_loss: 7.3165, val_loss: 7.3961, lr: 0.003000, 4.83s
2024-09-28 12:55:01 INFO     Saved model at 5
2024-09-28 12:55:01 INFO     Val loss decrease from 7.7877 to 7.3961, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 12:55:06 INFO     epoch complete!
2024-09-28 12:55:06 INFO     evaluating now!
2024-09-28 12:55:06 INFO     Epoch [6/200] train_loss: 6.8081, val_loss: 6.7730, lr: 0.003000, 4.84s
2024-09-28 12:55:06 INFO     Saved model at 6
2024-09-28 12:55:06 INFO     Val loss decrease from 7.3961 to 6.7730, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-28 12:55:11 INFO     epoch complete!
2024-09-28 12:55:11 INFO     evaluating now!
2024-09-28 12:55:11 INFO     Epoch [7/200] train_loss: 6.3934, val_loss: 6.4198, lr: 0.003000, 4.84s
2024-09-28 12:55:11 INFO     Saved model at 7
2024-09-28 12:55:11 INFO     Val loss decrease from 6.7730 to 6.4198, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-28 12:55:16 INFO     epoch complete!
2024-09-28 12:55:16 INFO     evaluating now!
2024-09-28 12:55:16 INFO     Epoch [8/200] train_loss: 6.1237, val_loss: 6.3164, lr: 0.003000, 4.97s
2024-09-28 12:55:16 INFO     Saved model at 8
2024-09-28 12:55:16 INFO     Val loss decrease from 6.4198 to 6.3164, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-28 12:55:21 INFO     epoch complete!
2024-09-28 12:55:21 INFO     evaluating now!
2024-09-28 12:55:21 INFO     Epoch [9/200] train_loss: 5.9000, val_loss: 6.0096, lr: 0.003000, 4.83s
2024-09-28 12:55:21 INFO     Saved model at 9
2024-09-28 12:55:21 INFO     Val loss decrease from 6.3164 to 6.0096, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-28 12:55:26 INFO     epoch complete!
2024-09-28 12:55:26 INFO     evaluating now!
2024-09-28 12:55:26 INFO     Epoch [10/200] train_loss: 5.6305, val_loss: 5.9743, lr: 0.003000, 4.93s
2024-09-28 12:55:26 INFO     Saved model at 10
2024-09-28 12:55:26 INFO     Val loss decrease from 6.0096 to 5.9743, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-28 12:55:30 INFO     epoch complete!
2024-09-28 12:55:30 INFO     evaluating now!
2024-09-28 12:55:31 INFO     Epoch [11/200] train_loss: 5.5798, val_loss: 5.9253, lr: 0.003000, 4.88s
2024-09-28 12:55:31 INFO     Saved model at 11
2024-09-28 12:55:31 INFO     Val loss decrease from 5.9743 to 5.9253, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-28 12:55:35 INFO     epoch complete!
2024-09-28 12:55:35 INFO     evaluating now!
2024-09-28 12:55:36 INFO     Epoch [12/200] train_loss: 5.5526, val_loss: 5.9366, lr: 0.003000, 4.89s
2024-09-28 12:55:40 INFO     epoch complete!
2024-09-28 12:55:40 INFO     evaluating now!
2024-09-28 12:55:41 INFO     Epoch [13/200] train_loss: 5.2836, val_loss: 5.6177, lr: 0.003000, 4.87s
2024-09-28 12:55:41 INFO     Saved model at 13
2024-09-28 12:55:41 INFO     Val loss decrease from 5.9253 to 5.6177, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-28 12:55:46 INFO     epoch complete!
2024-09-28 12:55:46 INFO     evaluating now!
2024-09-28 12:55:46 INFO     Epoch [14/200] train_loss: 5.1786, val_loss: 5.8684, lr: 0.003000, 5.49s
2024-09-28 12:55:51 INFO     epoch complete!
2024-09-28 12:55:51 INFO     evaluating now!
2024-09-28 12:55:52 INFO     Epoch [15/200] train_loss: 5.1913, val_loss: 5.7472, lr: 0.003000, 5.42s
2024-09-28 12:55:57 INFO     epoch complete!
2024-09-28 12:55:57 INFO     evaluating now!
2024-09-28 12:55:58 INFO     Epoch [16/200] train_loss: 5.0892, val_loss: 5.6465, lr: 0.003000, 5.95s
2024-09-28 12:56:03 INFO     epoch complete!
2024-09-28 12:56:03 INFO     evaluating now!
2024-09-28 12:56:03 INFO     Epoch [17/200] train_loss: 5.0029, val_loss: 5.6012, lr: 0.003000, 5.67s
2024-09-28 12:56:03 INFO     Saved model at 17
2024-09-28 12:56:03 INFO     Val loss decrease from 5.6177 to 5.6012, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-28 12:56:08 INFO     epoch complete!
2024-09-28 12:56:08 INFO     evaluating now!
2024-09-28 12:56:09 INFO     Epoch [18/200] train_loss: 4.9798, val_loss: 5.6516, lr: 0.003000, 5.40s
2024-09-28 12:56:13 INFO     epoch complete!
2024-09-28 12:56:13 INFO     evaluating now!
2024-09-28 12:56:14 INFO     Epoch [19/200] train_loss: 4.8412, val_loss: 5.3786, lr: 0.003000, 4.81s
2024-09-28 12:56:14 INFO     Saved model at 19
2024-09-28 12:56:14 INFO     Val loss decrease from 5.6012 to 5.3786, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-28 12:56:18 INFO     epoch complete!
2024-09-28 12:56:18 INFO     evaluating now!
2024-09-28 12:56:19 INFO     Epoch [20/200] train_loss: 4.7497, val_loss: 5.3882, lr: 0.003000, 5.16s
2024-09-28 12:56:23 INFO     epoch complete!
2024-09-28 12:56:23 INFO     evaluating now!
2024-09-28 12:56:24 INFO     Epoch [21/200] train_loss: 4.6964, val_loss: 5.3321, lr: 0.003000, 5.02s
2024-09-28 12:56:24 INFO     Saved model at 21
2024-09-28 12:56:24 INFO     Val loss decrease from 5.3786 to 5.3321, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-28 12:56:29 INFO     epoch complete!
2024-09-28 12:56:29 INFO     evaluating now!
2024-09-28 12:56:29 INFO     Epoch [22/200] train_loss: 4.5896, val_loss: 5.3061, lr: 0.003000, 5.17s
2024-09-28 12:56:29 INFO     Saved model at 22
2024-09-28 12:56:29 INFO     Val loss decrease from 5.3321 to 5.3061, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-28 12:56:34 INFO     epoch complete!
2024-09-28 12:56:34 INFO     evaluating now!
2024-09-28 12:56:34 INFO     Epoch [23/200] train_loss: 4.6942, val_loss: 5.3133, lr: 0.003000, 4.95s
2024-09-28 12:56:39 INFO     epoch complete!
2024-09-28 12:56:39 INFO     evaluating now!
2024-09-28 12:56:39 INFO     Epoch [24/200] train_loss: 4.6535, val_loss: 5.2504, lr: 0.003000, 4.92s
2024-09-28 12:56:39 INFO     Saved model at 24
2024-09-28 12:56:39 INFO     Val loss decrease from 5.3061 to 5.2504, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-28 12:56:43 INFO     epoch complete!
2024-09-28 12:56:43 INFO     evaluating now!
2024-09-28 12:56:44 INFO     Epoch [25/200] train_loss: 4.5665, val_loss: 5.4763, lr: 0.003000, 4.78s
2024-09-28 12:56:48 INFO     epoch complete!
2024-09-28 12:56:48 INFO     evaluating now!
2024-09-28 12:56:49 INFO     Epoch [26/200] train_loss: 4.4673, val_loss: 5.3080, lr: 0.003000, 5.03s
2024-09-28 12:56:53 INFO     epoch complete!
2024-09-28 12:56:53 INFO     evaluating now!
2024-09-28 12:56:54 INFO     Epoch [27/200] train_loss: 4.5036, val_loss: 5.3255, lr: 0.003000, 4.88s
2024-09-28 12:56:58 INFO     epoch complete!
2024-09-28 12:56:58 INFO     evaluating now!
2024-09-28 12:56:58 INFO     Epoch [28/200] train_loss: 4.4573, val_loss: 5.3230, lr: 0.003000, 4.82s
2024-09-28 12:57:03 INFO     epoch complete!
2024-09-28 12:57:03 INFO     evaluating now!
2024-09-28 12:57:03 INFO     Epoch [29/200] train_loss: 4.3427, val_loss: 5.3452, lr: 0.003000, 4.76s
2024-09-28 12:57:08 INFO     epoch complete!
2024-09-28 12:57:08 INFO     evaluating now!
2024-09-28 12:57:08 INFO     Epoch [30/200] train_loss: 4.2990, val_loss: 5.3869, lr: 0.003000, 4.95s
2024-09-28 12:57:13 INFO     epoch complete!
2024-09-28 12:57:13 INFO     evaluating now!
2024-09-28 12:57:13 INFO     Epoch [31/200] train_loss: 4.2662, val_loss: 5.6211, lr: 0.003000, 4.97s
2024-09-28 12:57:18 INFO     epoch complete!
2024-09-28 12:57:18 INFO     evaluating now!
2024-09-28 12:57:18 INFO     Epoch [32/200] train_loss: 4.2256, val_loss: 5.3132, lr: 0.003000, 4.94s
2024-09-28 12:57:23 INFO     epoch complete!
2024-09-28 12:57:23 INFO     evaluating now!
2024-09-28 12:57:23 INFO     Epoch [33/200] train_loss: 4.1672, val_loss: 5.4186, lr: 0.003000, 4.92s
2024-09-28 12:57:28 INFO     epoch complete!
2024-09-28 12:57:28 INFO     evaluating now!
2024-09-28 12:57:28 INFO     Epoch [34/200] train_loss: 4.1410, val_loss: 5.1215, lr: 0.003000, 5.13s
2024-09-28 12:57:28 INFO     Saved model at 34
2024-09-28 12:57:28 INFO     Val loss decrease from 5.2504 to 5.1215, saving to ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-09-28 12:57:33 INFO     epoch complete!
2024-09-28 12:57:33 INFO     evaluating now!
2024-09-28 12:57:33 INFO     Epoch [35/200] train_loss: 4.1054, val_loss: 5.3061, lr: 0.003000, 4.95s
2024-09-28 12:57:38 INFO     epoch complete!
2024-09-28 12:57:38 INFO     evaluating now!
2024-09-28 12:57:38 INFO     Epoch [36/200] train_loss: 4.0524, val_loss: 5.3854, lr: 0.003000, 4.90s
2024-09-28 12:57:43 INFO     epoch complete!
2024-09-28 12:57:43 INFO     evaluating now!
2024-09-28 12:57:43 INFO     Epoch [37/200] train_loss: 4.0501, val_loss: 5.3388, lr: 0.003000, 4.95s
2024-09-28 12:57:48 INFO     epoch complete!
2024-09-28 12:57:48 INFO     evaluating now!
2024-09-28 12:57:48 INFO     Epoch [38/200] train_loss: 4.0428, val_loss: 5.1524, lr: 0.003000, 5.44s
2024-09-28 12:57:54 INFO     epoch complete!
2024-09-28 12:57:54 INFO     evaluating now!
2024-09-28 12:57:54 INFO     Epoch [39/200] train_loss: 3.9780, val_loss: 5.2429, lr: 0.003000, 5.99s
2024-09-28 12:58:00 INFO     epoch complete!
2024-09-28 12:58:00 INFO     evaluating now!
2024-09-28 12:58:00 INFO     Epoch [40/200] train_loss: 3.9611, val_loss: 5.2305, lr: 0.003000, 6.02s
2024-09-28 12:58:06 INFO     epoch complete!
2024-09-28 12:58:06 INFO     evaluating now!
2024-09-28 12:58:06 INFO     Epoch [41/200] train_loss: 3.9112, val_loss: 5.2306, lr: 0.003000, 5.80s
2024-09-28 12:58:11 INFO     epoch complete!
2024-09-28 12:58:11 INFO     evaluating now!
2024-09-28 12:58:12 INFO     Epoch [42/200] train_loss: 3.9039, val_loss: 5.2774, lr: 0.003000, 5.38s
2024-09-28 12:58:17 INFO     epoch complete!
2024-09-28 12:58:17 INFO     evaluating now!
2024-09-28 12:58:17 INFO     Epoch [43/200] train_loss: 3.9263, val_loss: 5.2729, lr: 0.003000, 5.68s
2024-09-28 12:58:22 INFO     epoch complete!
2024-09-28 12:58:22 INFO     evaluating now!
2024-09-28 12:58:23 INFO     Epoch [44/200] train_loss: 3.8971, val_loss: 5.1660, lr: 0.003000, 5.31s
2024-09-28 12:58:28 INFO     epoch complete!
2024-09-28 12:58:28 INFO     evaluating now!
2024-09-28 12:58:28 INFO     Epoch [45/200] train_loss: 3.8088, val_loss: 5.2373, lr: 0.003000, 5.36s
2024-09-28 12:58:33 INFO     epoch complete!
2024-09-28 12:58:33 INFO     evaluating now!
2024-09-28 12:58:33 INFO     Epoch [46/200] train_loss: 3.7721, val_loss: 5.1217, lr: 0.003000, 5.31s
2024-09-28 12:58:38 INFO     epoch complete!
2024-09-28 12:58:38 INFO     evaluating now!
2024-09-28 12:58:39 INFO     Epoch [47/200] train_loss: 3.7854, val_loss: 5.2424, lr: 0.003000, 5.42s
2024-09-28 12:58:44 INFO     epoch complete!
2024-09-28 12:58:44 INFO     evaluating now!
2024-09-28 12:58:44 INFO     Epoch [48/200] train_loss: 3.7578, val_loss: 5.1426, lr: 0.003000, 5.62s
2024-09-28 12:58:50 INFO     epoch complete!
2024-09-28 12:58:50 INFO     evaluating now!
2024-09-28 12:58:50 INFO     Epoch [49/200] train_loss: 3.7194, val_loss: 5.2127, lr: 0.003000, 5.73s
2024-09-28 12:58:50 WARNING  Early stopping at epoch: 49
2024-09-28 12:58:50 INFO     Trained totally 50 epochs, average train time is 4.791s, average eval time is 0.359s
2024-09-28 12:58:50 INFO     Loaded model at 34
2024-09-28 12:58:50 INFO     Saved model at ./libcity/cache/16/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 12:58:50 INFO     Start evaluating ...
2024-09-28 12:58:52 INFO     Note that you select the single mode to evaluate!
2024-09-28 12:58:52 INFO     Evaluate result is saved at ./libcity/cache/16/evaluate_cache/2024_09_28_12_58_52_AGCRN_CHITaxi20190406.csv
2024-09-28 12:58:52 INFO     
         MAE       RMSE  masked_MAPE
1   2.418350   7.363109     0.439103
2   2.461316   7.740201     0.435642
3   2.721619   8.969468     0.455821
4   2.976006  10.383094     0.454658
5   3.084075  11.261963     0.459385
6   3.212514  11.882919     0.465433
7   3.283336  12.298971     0.480265
8   3.302585  12.522967     0.472792
9   3.339027  12.930803     0.472471
10  3.392952  13.260413     0.475948
11  3.447793  13.881079     0.472231
12  3.682918  14.882575     0.502942
2024-09-28 12:58:52 INFO     ----------------------------------------------------------------------------
2024-09-28 12:58:52 INFO     # 2, Kownledge Graph Embedding: GIE, Experiment ids: 17
2024-09-28 12:58:52 INFO     ----------------------------------------------------------------------------
2024-09-28 12:58:52 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=17
2024-09-28 12:58:52 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 17, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 12:58:52 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 12:58:52 INFO     set_weight_link_or_dist: dist
2024-09-28 12:58:52 INFO     init_weight_inf_or_zero: inf
2024-09-28 12:58:52 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 12:58:52 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 12:58:52 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 12:58:52 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 12:58:55 INFO     Dataset created
2024-09-28 12:58:55 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-28 12:58:55 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-28 12:58:55 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-28 12:58:55 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-28 12:58:55 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 12:58:55 INFO     NoneScaler
2024-09-28 12:58:57 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 12:58:57 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 12:58:57 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-28 12:58:57 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 12:58:57 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-28 12:58:57 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 12:58:57 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 12:58:57 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 12:58:57 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 12:58:57 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 12:58:57 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 12:58:57 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 12:58:57 INFO     Total parameter numbers: 874010
2024-09-28 12:58:57 INFO     You select `adam` optimizer.
2024-09-28 12:58:57 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 12:58:57 INFO     Start training ...
2024-09-28 12:58:57 INFO     num_batches:48
2024-09-28 12:59:02 INFO     epoch complete!
2024-09-28 12:59:02 INFO     evaluating now!
2024-09-28 12:59:03 INFO     Epoch [0/200] train_loss: 24.2148, val_loss: 17.4728, lr: 0.003000, 5.48s
2024-09-28 12:59:03 INFO     Saved model at 0
2024-09-28 12:59:03 INFO     Val loss decrease from inf to 17.4728, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 12:59:08 INFO     epoch complete!
2024-09-28 12:59:08 INFO     evaluating now!
2024-09-28 12:59:08 INFO     Epoch [1/200] train_loss: 14.3318, val_loss: 13.6790, lr: 0.003000, 5.58s
2024-09-28 12:59:08 INFO     Saved model at 1
2024-09-28 12:59:08 INFO     Val loss decrease from 17.4728 to 13.6790, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 12:59:13 INFO     epoch complete!
2024-09-28 12:59:13 INFO     evaluating now!
2024-09-28 12:59:14 INFO     Epoch [2/200] train_loss: 11.0897, val_loss: 10.5021, lr: 0.003000, 5.34s
2024-09-28 12:59:14 INFO     Saved model at 2
2024-09-28 12:59:14 INFO     Val loss decrease from 13.6790 to 10.5021, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 12:59:19 INFO     epoch complete!
2024-09-28 12:59:19 INFO     evaluating now!
2024-09-28 12:59:19 INFO     Epoch [3/200] train_loss: 9.0032, val_loss: 8.7111, lr: 0.003000, 5.51s
2024-09-28 12:59:19 INFO     Saved model at 3
2024-09-28 12:59:19 INFO     Val loss decrease from 10.5021 to 8.7111, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 12:59:24 INFO     epoch complete!
2024-09-28 12:59:24 INFO     evaluating now!
2024-09-28 12:59:25 INFO     Epoch [4/200] train_loss: 7.8468, val_loss: 7.6770, lr: 0.003000, 5.36s
2024-09-28 12:59:25 INFO     Saved model at 4
2024-09-28 12:59:25 INFO     Val loss decrease from 8.7111 to 7.6770, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 12:59:30 INFO     epoch complete!
2024-09-28 12:59:30 INFO     evaluating now!
2024-09-28 12:59:30 INFO     Epoch [5/200] train_loss: 7.1301, val_loss: 6.9792, lr: 0.003000, 5.36s
2024-09-28 12:59:30 INFO     Saved model at 5
2024-09-28 12:59:30 INFO     Val loss decrease from 7.6770 to 6.9792, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 12:59:35 INFO     epoch complete!
2024-09-28 12:59:35 INFO     evaluating now!
2024-09-28 12:59:36 INFO     Epoch [6/200] train_loss: 6.6344, val_loss: 6.5848, lr: 0.003000, 5.54s
2024-09-28 12:59:36 INFO     Saved model at 6
2024-09-28 12:59:36 INFO     Val loss decrease from 6.9792 to 6.5848, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-28 12:59:41 INFO     epoch complete!
2024-09-28 12:59:41 INFO     evaluating now!
2024-09-28 12:59:41 INFO     Epoch [7/200] train_loss: 6.3149, val_loss: 6.4299, lr: 0.003000, 5.55s
2024-09-28 12:59:42 INFO     Saved model at 7
2024-09-28 12:59:42 INFO     Val loss decrease from 6.5848 to 6.4299, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-28 12:59:47 INFO     epoch complete!
2024-09-28 12:59:47 INFO     evaluating now!
2024-09-28 12:59:47 INFO     Epoch [8/200] train_loss: 6.0055, val_loss: 6.0025, lr: 0.003000, 5.40s
2024-09-28 12:59:47 INFO     Saved model at 8
2024-09-28 12:59:47 INFO     Val loss decrease from 6.4299 to 6.0025, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-28 12:59:52 INFO     epoch complete!
2024-09-28 12:59:52 INFO     evaluating now!
2024-09-28 12:59:52 INFO     Epoch [9/200] train_loss: 5.8363, val_loss: 5.7530, lr: 0.003000, 5.41s
2024-09-28 12:59:52 INFO     Saved model at 9
2024-09-28 12:59:52 INFO     Val loss decrease from 6.0025 to 5.7530, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-28 12:59:58 INFO     epoch complete!
2024-09-28 12:59:58 INFO     evaluating now!
2024-09-28 12:59:58 INFO     Epoch [10/200] train_loss: 5.6313, val_loss: 5.9523, lr: 0.003000, 5.47s
2024-09-28 13:00:03 INFO     epoch complete!
2024-09-28 13:00:03 INFO     evaluating now!
2024-09-28 13:00:03 INFO     Epoch [11/200] train_loss: 5.4728, val_loss: 5.7781, lr: 0.003000, 5.29s
2024-09-28 13:00:08 INFO     epoch complete!
2024-09-28 13:00:08 INFO     evaluating now!
2024-09-28 13:00:09 INFO     Epoch [12/200] train_loss: 5.4020, val_loss: 5.6480, lr: 0.003000, 5.42s
2024-09-28 13:00:09 INFO     Saved model at 12
2024-09-28 13:00:09 INFO     Val loss decrease from 5.7530 to 5.6480, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-28 13:00:14 INFO     epoch complete!
2024-09-28 13:00:14 INFO     evaluating now!
2024-09-28 13:00:14 INFO     Epoch [13/200] train_loss: 5.2941, val_loss: 5.6027, lr: 0.003000, 5.34s
2024-09-28 13:00:14 INFO     Saved model at 13
2024-09-28 13:00:14 INFO     Val loss decrease from 5.6480 to 5.6027, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-28 13:00:19 INFO     epoch complete!
2024-09-28 13:00:19 INFO     evaluating now!
2024-09-28 13:00:20 INFO     Epoch [14/200] train_loss: 5.1634, val_loss: 5.4760, lr: 0.003000, 5.48s
2024-09-28 13:00:20 INFO     Saved model at 14
2024-09-28 13:00:20 INFO     Val loss decrease from 5.6027 to 5.4760, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-28 13:00:25 INFO     epoch complete!
2024-09-28 13:00:25 INFO     evaluating now!
2024-09-28 13:00:25 INFO     Epoch [15/200] train_loss: 5.0505, val_loss: 5.5651, lr: 0.003000, 5.70s
2024-09-28 13:00:31 INFO     epoch complete!
2024-09-28 13:00:31 INFO     evaluating now!
2024-09-28 13:00:31 INFO     Epoch [16/200] train_loss: 4.9327, val_loss: 5.5691, lr: 0.003000, 6.10s
2024-09-28 13:00:37 INFO     epoch complete!
2024-09-28 13:00:37 INFO     evaluating now!
2024-09-28 13:00:38 INFO     Epoch [17/200] train_loss: 4.8798, val_loss: 5.4951, lr: 0.003000, 6.07s
2024-09-28 13:00:44 INFO     epoch complete!
2024-09-28 13:00:44 INFO     evaluating now!
2024-09-28 13:00:44 INFO     Epoch [18/200] train_loss: 4.7740, val_loss: 5.2783, lr: 0.003000, 6.34s
2024-09-28 13:00:44 INFO     Saved model at 18
2024-09-28 13:00:44 INFO     Val loss decrease from 5.4760 to 5.2783, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-28 13:00:50 INFO     epoch complete!
2024-09-28 13:00:50 INFO     evaluating now!
2024-09-28 13:00:50 INFO     Epoch [19/200] train_loss: 4.7045, val_loss: 5.1992, lr: 0.003000, 6.31s
2024-09-28 13:00:50 INFO     Saved model at 19
2024-09-28 13:00:50 INFO     Val loss decrease from 5.2783 to 5.1992, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-28 13:00:56 INFO     epoch complete!
2024-09-28 13:00:56 INFO     evaluating now!
2024-09-28 13:00:56 INFO     Epoch [20/200] train_loss: 4.6361, val_loss: 5.2768, lr: 0.003000, 6.04s
2024-09-28 13:01:01 INFO     epoch complete!
2024-09-28 13:01:01 INFO     evaluating now!
2024-09-28 13:01:01 INFO     Epoch [21/200] train_loss: 4.6279, val_loss: 5.2850, lr: 0.003000, 4.79s
2024-09-28 13:01:06 INFO     epoch complete!
2024-09-28 13:01:06 INFO     evaluating now!
2024-09-28 13:01:06 INFO     Epoch [22/200] train_loss: 4.5387, val_loss: 5.3172, lr: 0.003000, 4.82s
2024-09-28 13:01:10 INFO     epoch complete!
2024-09-28 13:01:10 INFO     evaluating now!
2024-09-28 13:01:11 INFO     Epoch [23/200] train_loss: 4.4584, val_loss: 5.3431, lr: 0.003000, 4.79s
2024-09-28 13:01:15 INFO     epoch complete!
2024-09-28 13:01:15 INFO     evaluating now!
2024-09-28 13:01:16 INFO     Epoch [24/200] train_loss: 4.4306, val_loss: 5.1466, lr: 0.003000, 4.85s
2024-09-28 13:01:16 INFO     Saved model at 24
2024-09-28 13:01:16 INFO     Val loss decrease from 5.1992 to 5.1466, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-28 13:01:20 INFO     epoch complete!
2024-09-28 13:01:20 INFO     evaluating now!
2024-09-28 13:01:20 INFO     Epoch [25/200] train_loss: 4.3957, val_loss: 5.2870, lr: 0.003000, 4.81s
2024-09-28 13:01:25 INFO     epoch complete!
2024-09-28 13:01:25 INFO     evaluating now!
2024-09-28 13:01:25 INFO     Epoch [26/200] train_loss: 4.3694, val_loss: 5.1868, lr: 0.003000, 4.80s
2024-09-28 13:01:30 INFO     epoch complete!
2024-09-28 13:01:30 INFO     evaluating now!
2024-09-28 13:01:30 INFO     Epoch [27/200] train_loss: 4.3159, val_loss: 5.4232, lr: 0.003000, 4.82s
2024-09-28 13:01:35 INFO     epoch complete!
2024-09-28 13:01:35 INFO     evaluating now!
2024-09-28 13:01:35 INFO     Epoch [28/200] train_loss: 4.3348, val_loss: 5.0990, lr: 0.003000, 4.80s
2024-09-28 13:01:35 INFO     Saved model at 28
2024-09-28 13:01:35 INFO     Val loss decrease from 5.1466 to 5.0990, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-28 13:01:39 INFO     epoch complete!
2024-09-28 13:01:39 INFO     evaluating now!
2024-09-28 13:01:40 INFO     Epoch [29/200] train_loss: 4.3197, val_loss: 5.1829, lr: 0.003000, 4.85s
2024-09-28 13:01:44 INFO     epoch complete!
2024-09-28 13:01:44 INFO     evaluating now!
2024-09-28 13:01:45 INFO     Epoch [30/200] train_loss: 4.2052, val_loss: 5.1655, lr: 0.003000, 4.80s
2024-09-28 13:01:49 INFO     epoch complete!
2024-09-28 13:01:49 INFO     evaluating now!
2024-09-28 13:01:49 INFO     Epoch [31/200] train_loss: 4.1103, val_loss: 5.0602, lr: 0.003000, 4.80s
2024-09-28 13:01:49 INFO     Saved model at 31
2024-09-28 13:01:49 INFO     Val loss decrease from 5.0990 to 5.0602, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-09-28 13:01:54 INFO     epoch complete!
2024-09-28 13:01:54 INFO     evaluating now!
2024-09-28 13:01:54 INFO     Epoch [32/200] train_loss: 4.0745, val_loss: 5.0425, lr: 0.003000, 4.85s
2024-09-28 13:01:54 INFO     Saved model at 32
2024-09-28 13:01:54 INFO     Val loss decrease from 5.0602 to 5.0425, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-09-28 13:01:59 INFO     epoch complete!
2024-09-28 13:01:59 INFO     evaluating now!
2024-09-28 13:01:59 INFO     Epoch [33/200] train_loss: 4.1080, val_loss: 5.1700, lr: 0.003000, 5.00s
2024-09-28 13:02:04 INFO     epoch complete!
2024-09-28 13:02:04 INFO     evaluating now!
2024-09-28 13:02:04 INFO     Epoch [34/200] train_loss: 4.0649, val_loss: 5.0973, lr: 0.003000, 4.85s
2024-09-28 13:02:09 INFO     epoch complete!
2024-09-28 13:02:09 INFO     evaluating now!
2024-09-28 13:02:09 INFO     Epoch [35/200] train_loss: 3.9620, val_loss: 5.0810, lr: 0.003000, 5.15s
2024-09-28 13:02:14 INFO     epoch complete!
2024-09-28 13:02:14 INFO     evaluating now!
2024-09-28 13:02:14 INFO     Epoch [36/200] train_loss: 3.9654, val_loss: 5.1202, lr: 0.003000, 4.92s
2024-09-28 13:02:19 INFO     epoch complete!
2024-09-28 13:02:19 INFO     evaluating now!
2024-09-28 13:02:19 INFO     Epoch [37/200] train_loss: 3.9689, val_loss: 5.2242, lr: 0.003000, 5.16s
2024-09-28 13:02:24 INFO     epoch complete!
2024-09-28 13:02:24 INFO     evaluating now!
2024-09-28 13:02:24 INFO     Epoch [38/200] train_loss: 3.8896, val_loss: 5.1222, lr: 0.003000, 4.77s
2024-09-28 13:02:29 INFO     epoch complete!
2024-09-28 13:02:29 INFO     evaluating now!
2024-09-28 13:02:29 INFO     Epoch [39/200] train_loss: 3.8560, val_loss: 4.9225, lr: 0.003000, 4.78s
2024-09-28 13:02:29 INFO     Saved model at 39
2024-09-28 13:02:29 INFO     Val loss decrease from 5.0425 to 4.9225, saving to ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-09-28 13:02:33 INFO     epoch complete!
2024-09-28 13:02:33 INFO     evaluating now!
2024-09-28 13:02:34 INFO     Epoch [40/200] train_loss: 3.8921, val_loss: 5.1307, lr: 0.003000, 4.81s
2024-09-28 13:02:39 INFO     epoch complete!
2024-09-28 13:02:39 INFO     evaluating now!
2024-09-28 13:02:39 INFO     Epoch [41/200] train_loss: 3.8345, val_loss: 5.0509, lr: 0.003000, 5.06s
2024-09-28 13:02:43 INFO     epoch complete!
2024-09-28 13:02:43 INFO     evaluating now!
2024-09-28 13:02:44 INFO     Epoch [42/200] train_loss: 3.8193, val_loss: 5.1674, lr: 0.003000, 4.79s
2024-09-28 13:02:49 INFO     epoch complete!
2024-09-28 13:02:49 INFO     evaluating now!
2024-09-28 13:02:49 INFO     Epoch [43/200] train_loss: 3.8614, val_loss: 5.1262, lr: 0.003000, 5.22s
2024-09-28 13:02:54 INFO     epoch complete!
2024-09-28 13:02:54 INFO     evaluating now!
2024-09-28 13:02:54 INFO     Epoch [44/200] train_loss: 3.8103, val_loss: 4.9482, lr: 0.003000, 5.32s
2024-09-28 13:02:59 INFO     epoch complete!
2024-09-28 13:02:59 INFO     evaluating now!
2024-09-28 13:03:00 INFO     Epoch [45/200] train_loss: 3.7642, val_loss: 5.1090, lr: 0.003000, 5.26s
2024-09-28 13:03:05 INFO     epoch complete!
2024-09-28 13:03:05 INFO     evaluating now!
2024-09-28 13:03:05 INFO     Epoch [46/200] train_loss: 3.7232, val_loss: 5.2252, lr: 0.003000, 5.40s
2024-09-28 13:03:10 INFO     epoch complete!
2024-09-28 13:03:10 INFO     evaluating now!
2024-09-28 13:03:10 INFO     Epoch [47/200] train_loss: 3.7130, val_loss: 5.1035, lr: 0.003000, 5.51s
2024-09-28 13:03:16 INFO     epoch complete!
2024-09-28 13:03:16 INFO     evaluating now!
2024-09-28 13:03:16 INFO     Epoch [48/200] train_loss: 3.6648, val_loss: 5.1206, lr: 0.003000, 5.52s
2024-09-28 13:03:21 INFO     epoch complete!
2024-09-28 13:03:21 INFO     evaluating now!
2024-09-28 13:03:22 INFO     Epoch [49/200] train_loss: 3.6923, val_loss: 5.1449, lr: 0.003000, 5.57s
2024-09-28 13:03:27 INFO     epoch complete!
2024-09-28 13:03:27 INFO     evaluating now!
2024-09-28 13:03:27 INFO     Epoch [50/200] train_loss: 3.6369, val_loss: 5.0679, lr: 0.003000, 5.54s
2024-09-28 13:03:32 INFO     epoch complete!
2024-09-28 13:03:32 INFO     evaluating now!
2024-09-28 13:03:32 INFO     Epoch [51/200] train_loss: 3.5892, val_loss: 5.0918, lr: 0.003000, 5.39s
2024-09-28 13:03:38 INFO     epoch complete!
2024-09-28 13:03:38 INFO     evaluating now!
2024-09-28 13:03:38 INFO     Epoch [52/200] train_loss: 3.5822, val_loss: 4.9822, lr: 0.003000, 5.68s
2024-09-28 13:03:43 INFO     epoch complete!
2024-09-28 13:03:43 INFO     evaluating now!
2024-09-28 13:03:44 INFO     Epoch [53/200] train_loss: 3.5704, val_loss: 5.0911, lr: 0.003000, 5.50s
2024-09-28 13:03:49 INFO     epoch complete!
2024-09-28 13:03:49 INFO     evaluating now!
2024-09-28 13:03:49 INFO     Epoch [54/200] train_loss: 3.5457, val_loss: 5.1199, lr: 0.003000, 5.70s
2024-09-28 13:03:49 WARNING  Early stopping at epoch: 54
2024-09-28 13:03:49 INFO     Trained totally 55 epochs, average train time is 4.918s, average eval time is 0.367s
2024-09-28 13:03:50 INFO     Loaded model at 39
2024-09-28 13:03:50 INFO     Saved model at ./libcity/cache/17/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 13:03:50 INFO     Start evaluating ...
2024-09-28 13:03:51 INFO     Note that you select the single mode to evaluate!
2024-09-28 13:03:51 INFO     Evaluate result is saved at ./libcity/cache/17/evaluate_cache/2024_09_28_13_03_51_AGCRN_CHITaxi20190406.csv
2024-09-28 13:03:51 INFO     
         MAE       RMSE  masked_MAPE
1   2.536242   7.192901     0.472133
2   2.619960   7.568963     0.476187
3   2.723130   8.546940     0.462824
4   2.873830   9.417468     0.465131
5   3.024219  10.247073     0.475010
6   3.070356  10.888246     0.461352
7   3.211044  11.481952     0.480465
8   3.288829  12.025146     0.487381
9   3.300287  12.434128     0.480856
10  3.413643  12.767340     0.508304
11  3.404993  13.035002     0.493541
12  3.572574  13.497860     0.532553
2024-09-28 13:03:52 INFO     ----------------------------------------------------------------------------
2024-09-28 13:03:52 INFO     # 3, Kownledge Graph Embedding: GIE, Experiment ids: 18
2024-09-28 13:03:52 INFO     ----------------------------------------------------------------------------
2024-09-28 13:03:52 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=18
2024-09-28 13:03:52 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 18, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 13:03:52 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 13:03:52 INFO     set_weight_link_or_dist: dist
2024-09-28 13:03:52 INFO     init_weight_inf_or_zero: inf
2024-09-28 13:03:52 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 13:03:52 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 13:03:52 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 13:03:52 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 13:03:55 INFO     Dataset created
2024-09-28 13:03:55 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-28 13:03:55 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-28 13:03:55 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-28 13:03:55 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-28 13:03:55 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 13:03:55 INFO     NoneScaler
2024-09-28 13:03:57 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 13:03:57 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 13:03:57 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-28 13:03:57 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 13:03:57 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-28 13:03:57 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 13:03:57 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 13:03:57 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 13:03:57 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 13:03:57 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 13:03:57 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 13:03:57 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 13:03:57 INFO     Total parameter numbers: 874010
2024-09-28 13:03:57 INFO     You select `adam` optimizer.
2024-09-28 13:03:57 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 13:03:57 INFO     Start training ...
2024-09-28 13:03:57 INFO     num_batches:48
2024-09-28 13:04:02 INFO     epoch complete!
2024-09-28 13:04:02 INFO     evaluating now!
2024-09-28 13:04:02 INFO     Epoch [0/200] train_loss: 23.4976, val_loss: 17.5081, lr: 0.003000, 5.43s
2024-09-28 13:04:03 INFO     Saved model at 0
2024-09-28 13:04:03 INFO     Val loss decrease from inf to 17.5081, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 13:04:08 INFO     epoch complete!
2024-09-28 13:04:08 INFO     evaluating now!
2024-09-28 13:04:08 INFO     Epoch [1/200] train_loss: 13.6600, val_loss: 12.5825, lr: 0.003000, 5.51s
2024-09-28 13:04:24 INFO     Saved model at 1
2024-09-28 13:04:24 INFO     Val loss decrease from 17.5081 to 12.5825, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 13:04:29 INFO     epoch complete!
2024-09-28 13:04:29 INFO     evaluating now!
2024-09-28 13:04:30 INFO     Epoch [2/200] train_loss: 10.3839, val_loss: 9.6234, lr: 0.003000, 6.11s
2024-09-28 13:04:30 INFO     Saved model at 2
2024-09-28 13:04:30 INFO     Val loss decrease from 12.5825 to 9.6234, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 13:04:36 INFO     epoch complete!
2024-09-28 13:04:36 INFO     evaluating now!
2024-09-28 13:04:36 INFO     Epoch [3/200] train_loss: 8.3074, val_loss: 7.9209, lr: 0.003000, 6.16s
2024-09-28 13:04:36 INFO     Saved model at 3
2024-09-28 13:04:36 INFO     Val loss decrease from 9.6234 to 7.9209, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 13:04:42 INFO     epoch complete!
2024-09-28 13:04:42 INFO     evaluating now!
2024-09-28 13:04:43 INFO     Epoch [4/200] train_loss: 7.3643, val_loss: 7.2873, lr: 0.003000, 6.37s
2024-09-28 13:04:43 INFO     Saved model at 4
2024-09-28 13:04:43 INFO     Val loss decrease from 7.9209 to 7.2873, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 13:04:48 INFO     epoch complete!
2024-09-28 13:04:48 INFO     evaluating now!
2024-09-28 13:04:49 INFO     Epoch [5/200] train_loss: 6.8146, val_loss: 6.8663, lr: 0.003000, 6.05s
2024-09-28 13:04:49 INFO     Saved model at 5
2024-09-28 13:04:49 INFO     Val loss decrease from 7.2873 to 6.8663, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 13:04:54 INFO     epoch complete!
2024-09-28 13:04:54 INFO     evaluating now!
2024-09-28 13:04:55 INFO     Epoch [6/200] train_loss: 6.3862, val_loss: 6.4875, lr: 0.003000, 6.13s
2024-09-28 13:04:55 INFO     Saved model at 6
2024-09-28 13:04:55 INFO     Val loss decrease from 6.8663 to 6.4875, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-28 13:05:01 INFO     epoch complete!
2024-09-28 13:05:01 INFO     evaluating now!
2024-09-28 13:05:01 INFO     Epoch [7/200] train_loss: 6.0788, val_loss: 5.9938, lr: 0.003000, 6.15s
2024-09-28 13:05:01 INFO     Saved model at 7
2024-09-28 13:05:01 INFO     Val loss decrease from 6.4875 to 5.9938, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-28 13:05:07 INFO     epoch complete!
2024-09-28 13:05:07 INFO     evaluating now!
2024-09-28 13:05:07 INFO     Epoch [8/200] train_loss: 5.8444, val_loss: 5.9874, lr: 0.003000, 5.93s
2024-09-28 13:05:07 INFO     Saved model at 8
2024-09-28 13:05:07 INFO     Val loss decrease from 5.9938 to 5.9874, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-28 13:05:13 INFO     epoch complete!
2024-09-28 13:05:13 INFO     evaluating now!
2024-09-28 13:05:13 INFO     Epoch [9/200] train_loss: 5.6122, val_loss: 5.6606, lr: 0.003000, 6.30s
2024-09-28 13:05:13 INFO     Saved model at 9
2024-09-28 13:05:13 INFO     Val loss decrease from 5.9874 to 5.6606, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-28 13:05:19 INFO     epoch complete!
2024-09-28 13:05:19 INFO     evaluating now!
2024-09-28 13:05:20 INFO     Epoch [10/200] train_loss: 5.5273, val_loss: 5.8394, lr: 0.003000, 6.26s
2024-09-28 13:05:26 INFO     epoch complete!
2024-09-28 13:05:26 INFO     evaluating now!
2024-09-28 13:05:26 INFO     Epoch [11/200] train_loss: 5.3276, val_loss: 5.5238, lr: 0.003000, 6.23s
2024-09-28 13:05:26 INFO     Saved model at 11
2024-09-28 13:05:26 INFO     Val loss decrease from 5.6606 to 5.5238, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-28 13:05:32 INFO     epoch complete!
2024-09-28 13:05:32 INFO     evaluating now!
2024-09-28 13:05:32 INFO     Epoch [12/200] train_loss: 5.1868, val_loss: 5.5200, lr: 0.003000, 6.07s
2024-09-28 13:05:32 INFO     Saved model at 12
2024-09-28 13:05:32 INFO     Val loss decrease from 5.5238 to 5.5200, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-28 13:05:38 INFO     epoch complete!
2024-09-28 13:05:38 INFO     evaluating now!
2024-09-28 13:05:38 INFO     Epoch [13/200] train_loss: 5.1217, val_loss: 5.5703, lr: 0.003000, 6.18s
2024-09-28 13:05:44 INFO     epoch complete!
2024-09-28 13:05:44 INFO     evaluating now!
2024-09-28 13:05:45 INFO     Epoch [14/200] train_loss: 4.9911, val_loss: 5.4447, lr: 0.003000, 6.16s
2024-09-28 13:05:45 INFO     Saved model at 14
2024-09-28 13:05:45 INFO     Val loss decrease from 5.5200 to 5.4447, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-28 13:05:50 INFO     epoch complete!
2024-09-28 13:05:50 INFO     evaluating now!
2024-09-28 13:05:51 INFO     Epoch [15/200] train_loss: 4.9181, val_loss: 5.3593, lr: 0.003000, 6.23s
2024-09-28 13:05:51 INFO     Saved model at 15
2024-09-28 13:05:51 INFO     Val loss decrease from 5.4447 to 5.3593, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-28 13:05:57 INFO     epoch complete!
2024-09-28 13:05:57 INFO     evaluating now!
2024-09-28 13:05:57 INFO     Epoch [16/200] train_loss: 4.8821, val_loss: 5.3136, lr: 0.003000, 6.48s
2024-09-28 13:05:58 INFO     Saved model at 16
2024-09-28 13:05:58 INFO     Val loss decrease from 5.3593 to 5.3136, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-28 13:06:03 INFO     epoch complete!
2024-09-28 13:06:03 INFO     evaluating now!
2024-09-28 13:06:04 INFO     Epoch [17/200] train_loss: 4.7575, val_loss: 5.1245, lr: 0.003000, 6.13s
2024-09-28 13:06:04 INFO     Saved model at 17
2024-09-28 13:06:04 INFO     Val loss decrease from 5.3136 to 5.1245, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-28 13:06:09 INFO     epoch complete!
2024-09-28 13:06:09 INFO     evaluating now!
2024-09-28 13:06:10 INFO     Epoch [18/200] train_loss: 4.7116, val_loss: 5.3284, lr: 0.003000, 5.97s
2024-09-28 13:06:15 INFO     epoch complete!
2024-09-28 13:06:15 INFO     evaluating now!
2024-09-28 13:06:16 INFO     Epoch [19/200] train_loss: 4.6545, val_loss: 5.2112, lr: 0.003000, 6.12s
2024-09-28 13:06:21 INFO     epoch complete!
2024-09-28 13:06:21 INFO     evaluating now!
2024-09-28 13:06:22 INFO     Epoch [20/200] train_loss: 4.5988, val_loss: 5.2062, lr: 0.003000, 6.12s
2024-09-28 13:06:28 INFO     epoch complete!
2024-09-28 13:06:28 INFO     evaluating now!
2024-09-28 13:06:28 INFO     Epoch [21/200] train_loss: 4.5548, val_loss: 5.2939, lr: 0.003000, 6.09s
2024-09-28 13:06:34 INFO     epoch complete!
2024-09-28 13:06:34 INFO     evaluating now!
2024-09-28 13:06:34 INFO     Epoch [22/200] train_loss: 4.4989, val_loss: 5.1917, lr: 0.003000, 6.30s
2024-09-28 13:06:40 INFO     epoch complete!
2024-09-28 13:06:40 INFO     evaluating now!
2024-09-28 13:06:40 INFO     Epoch [23/200] train_loss: 4.4216, val_loss: 5.0695, lr: 0.003000, 6.13s
2024-09-28 13:06:40 INFO     Saved model at 23
2024-09-28 13:06:40 INFO     Val loss decrease from 5.1245 to 5.0695, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-28 13:06:46 INFO     epoch complete!
2024-09-28 13:06:46 INFO     evaluating now!
2024-09-28 13:06:47 INFO     Epoch [24/200] train_loss: 4.3625, val_loss: 5.3540, lr: 0.003000, 6.28s
2024-09-28 13:06:52 INFO     epoch complete!
2024-09-28 13:06:52 INFO     evaluating now!
2024-09-28 13:06:53 INFO     Epoch [25/200] train_loss: 4.3607, val_loss: 5.1951, lr: 0.003000, 6.17s
2024-09-28 13:06:59 INFO     epoch complete!
2024-09-28 13:06:59 INFO     evaluating now!
2024-09-28 13:06:59 INFO     Epoch [26/200] train_loss: 4.3366, val_loss: 5.1375, lr: 0.003000, 6.16s
2024-09-28 13:07:05 INFO     epoch complete!
2024-09-28 13:07:05 INFO     evaluating now!
2024-09-28 13:07:05 INFO     Epoch [27/200] train_loss: 4.2523, val_loss: 5.0391, lr: 0.003000, 6.08s
2024-09-28 13:07:05 INFO     Saved model at 27
2024-09-28 13:07:05 INFO     Val loss decrease from 5.0695 to 5.0391, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-09-28 13:07:11 INFO     epoch complete!
2024-09-28 13:07:11 INFO     evaluating now!
2024-09-28 13:07:12 INFO     Epoch [28/200] train_loss: 4.2593, val_loss: 5.1404, lr: 0.003000, 6.27s
2024-09-28 13:07:17 INFO     epoch complete!
2024-09-28 13:07:17 INFO     evaluating now!
2024-09-28 13:07:18 INFO     Epoch [29/200] train_loss: 4.2569, val_loss: 5.1865, lr: 0.003000, 6.23s
2024-09-28 13:07:24 INFO     epoch complete!
2024-09-28 13:07:24 INFO     evaluating now!
2024-09-28 13:07:24 INFO     Epoch [30/200] train_loss: 4.1234, val_loss: 5.1482, lr: 0.003000, 6.23s
2024-09-28 13:07:30 INFO     epoch complete!
2024-09-28 13:07:30 INFO     evaluating now!
2024-09-28 13:07:30 INFO     Epoch [31/200] train_loss: 4.1270, val_loss: 5.3339, lr: 0.003000, 6.10s
2024-09-28 13:07:36 INFO     epoch complete!
2024-09-28 13:07:36 INFO     evaluating now!
2024-09-28 13:07:36 INFO     Epoch [32/200] train_loss: 4.1326, val_loss: 5.1517, lr: 0.003000, 6.26s
2024-09-28 13:07:42 INFO     epoch complete!
2024-09-28 13:07:42 INFO     evaluating now!
2024-09-28 13:07:43 INFO     Epoch [33/200] train_loss: 4.0397, val_loss: 5.1875, lr: 0.003000, 6.37s
2024-09-28 13:07:49 INFO     epoch complete!
2024-09-28 13:07:49 INFO     evaluating now!
2024-09-28 13:07:49 INFO     Epoch [34/200] train_loss: 4.0286, val_loss: 4.9946, lr: 0.003000, 6.28s
2024-09-28 13:07:49 INFO     Saved model at 34
2024-09-28 13:07:49 INFO     Val loss decrease from 5.0391 to 4.9946, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-09-28 13:07:54 INFO     epoch complete!
2024-09-28 13:07:54 INFO     evaluating now!
2024-09-28 13:07:55 INFO     Epoch [35/200] train_loss: 4.0444, val_loss: 5.2069, lr: 0.003000, 5.81s
2024-09-28 13:08:00 INFO     epoch complete!
2024-09-28 13:08:00 INFO     evaluating now!
2024-09-28 13:08:00 INFO     Epoch [36/200] train_loss: 3.9990, val_loss: 5.0765, lr: 0.003000, 5.61s
2024-09-28 13:08:05 INFO     epoch complete!
2024-09-28 13:08:05 INFO     evaluating now!
2024-09-28 13:08:06 INFO     Epoch [37/200] train_loss: 3.9495, val_loss: 5.0815, lr: 0.003000, 5.37s
2024-09-28 13:08:11 INFO     epoch complete!
2024-09-28 13:08:11 INFO     evaluating now!
2024-09-28 13:08:11 INFO     Epoch [38/200] train_loss: 3.8820, val_loss: 5.0922, lr: 0.003000, 5.38s
2024-09-28 13:08:16 INFO     epoch complete!
2024-09-28 13:08:16 INFO     evaluating now!
2024-09-28 13:08:17 INFO     Epoch [39/200] train_loss: 3.9760, val_loss: 5.1137, lr: 0.003000, 5.34s
2024-09-28 13:08:22 INFO     epoch complete!
2024-09-28 13:08:22 INFO     evaluating now!
2024-09-28 13:08:22 INFO     Epoch [40/200] train_loss: 3.8409, val_loss: 4.9811, lr: 0.003000, 5.55s
2024-09-28 13:08:22 INFO     Saved model at 40
2024-09-28 13:08:22 INFO     Val loss decrease from 4.9946 to 4.9811, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-09-28 13:08:28 INFO     epoch complete!
2024-09-28 13:08:28 INFO     evaluating now!
2024-09-28 13:08:28 INFO     Epoch [41/200] train_loss: 3.8531, val_loss: 5.1296, lr: 0.003000, 5.60s
2024-09-28 13:08:33 INFO     epoch complete!
2024-09-28 13:08:33 INFO     evaluating now!
2024-09-28 13:08:33 INFO     Epoch [42/200] train_loss: 3.8138, val_loss: 5.0733, lr: 0.003000, 5.51s
2024-09-28 13:08:39 INFO     epoch complete!
2024-09-28 13:08:39 INFO     evaluating now!
2024-09-28 13:08:39 INFO     Epoch [43/200] train_loss: 3.7560, val_loss: 5.0566, lr: 0.003000, 5.59s
2024-09-28 13:08:44 INFO     epoch complete!
2024-09-28 13:08:44 INFO     evaluating now!
2024-09-28 13:08:45 INFO     Epoch [44/200] train_loss: 3.7644, val_loss: 5.0871, lr: 0.003000, 5.56s
2024-09-28 13:08:50 INFO     epoch complete!
2024-09-28 13:08:50 INFO     evaluating now!
2024-09-28 13:08:50 INFO     Epoch [45/200] train_loss: 3.9120, val_loss: 4.9813, lr: 0.003000, 5.78s
2024-09-28 13:08:56 INFO     epoch complete!
2024-09-28 13:08:56 INFO     evaluating now!
2024-09-28 13:08:56 INFO     Epoch [46/200] train_loss: 3.7393, val_loss: 4.9703, lr: 0.003000, 5.80s
2024-09-28 13:08:56 INFO     Saved model at 46
2024-09-28 13:08:56 INFO     Val loss decrease from 4.9811 to 4.9703, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-09-28 13:09:02 INFO     epoch complete!
2024-09-28 13:09:02 INFO     evaluating now!
2024-09-28 13:09:02 INFO     Epoch [47/200] train_loss: 3.7166, val_loss: 5.0521, lr: 0.003000, 5.76s
2024-09-28 13:09:07 INFO     epoch complete!
2024-09-28 13:09:07 INFO     evaluating now!
2024-09-28 13:09:08 INFO     Epoch [48/200] train_loss: 3.7240, val_loss: 4.9858, lr: 0.003000, 5.42s
2024-09-28 13:09:13 INFO     epoch complete!
2024-09-28 13:09:13 INFO     evaluating now!
2024-09-28 13:09:13 INFO     Epoch [49/200] train_loss: 3.7203, val_loss: 5.0032, lr: 0.003000, 5.58s
2024-09-28 13:09:18 INFO     epoch complete!
2024-09-28 13:09:18 INFO     evaluating now!
2024-09-28 13:09:19 INFO     Epoch [50/200] train_loss: 3.7143, val_loss: 5.0127, lr: 0.003000, 5.48s
2024-09-28 13:09:23 INFO     epoch complete!
2024-09-28 13:09:24 INFO     evaluating now!
2024-09-28 13:09:24 INFO     Epoch [51/200] train_loss: 3.6684, val_loss: 5.0193, lr: 0.003000, 5.31s
2024-09-28 13:09:29 INFO     epoch complete!
2024-09-28 13:09:29 INFO     evaluating now!
2024-09-28 13:09:29 INFO     Epoch [52/200] train_loss: 3.6193, val_loss: 5.1733, lr: 0.003000, 5.59s
2024-09-28 13:09:35 INFO     epoch complete!
2024-09-28 13:09:35 INFO     evaluating now!
2024-09-28 13:09:35 INFO     Epoch [53/200] train_loss: 3.6021, val_loss: 5.0696, lr: 0.003000, 5.43s
2024-09-28 13:09:40 INFO     epoch complete!
2024-09-28 13:09:40 INFO     evaluating now!
2024-09-28 13:09:40 INFO     Epoch [54/200] train_loss: 3.5907, val_loss: 5.0144, lr: 0.003000, 5.46s
2024-09-28 13:09:45 INFO     epoch complete!
2024-09-28 13:09:45 INFO     evaluating now!
2024-09-28 13:09:46 INFO     Epoch [55/200] train_loss: 3.6047, val_loss: 5.0967, lr: 0.003000, 5.28s
2024-09-28 13:09:51 INFO     epoch complete!
2024-09-28 13:09:51 INFO     evaluating now!
2024-09-28 13:09:51 INFO     Epoch [56/200] train_loss: 3.5591, val_loss: 5.0575, lr: 0.003000, 5.57s
2024-09-28 13:09:56 INFO     epoch complete!
2024-09-28 13:09:56 INFO     evaluating now!
2024-09-28 13:09:57 INFO     Epoch [57/200] train_loss: 3.5684, val_loss: 4.9963, lr: 0.003000, 5.62s
2024-09-28 13:10:02 INFO     epoch complete!
2024-09-28 13:10:02 INFO     evaluating now!
2024-09-28 13:10:02 INFO     Epoch [58/200] train_loss: 3.5876, val_loss: 5.0847, lr: 0.003000, 5.36s
2024-09-28 13:10:07 INFO     epoch complete!
2024-09-28 13:10:07 INFO     evaluating now!
2024-09-28 13:10:08 INFO     Epoch [59/200] train_loss: 3.5277, val_loss: 4.9450, lr: 0.003000, 5.46s
2024-09-28 13:10:08 INFO     Saved model at 59
2024-09-28 13:10:08 INFO     Val loss decrease from 4.9703 to 4.9450, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch59.tar
2024-09-28 13:10:13 INFO     epoch complete!
2024-09-28 13:10:13 INFO     evaluating now!
2024-09-28 13:10:13 INFO     Epoch [60/200] train_loss: 3.5070, val_loss: 4.9872, lr: 0.003000, 5.68s
2024-09-28 13:10:18 INFO     epoch complete!
2024-09-28 13:10:18 INFO     evaluating now!
2024-09-28 13:10:19 INFO     Epoch [61/200] train_loss: 3.4955, val_loss: 5.0324, lr: 0.003000, 5.47s
2024-09-28 13:10:24 INFO     epoch complete!
2024-09-28 13:10:24 INFO     evaluating now!
2024-09-28 13:10:24 INFO     Epoch [62/200] train_loss: 3.4768, val_loss: 5.0558, lr: 0.003000, 5.52s
2024-09-28 13:10:29 INFO     epoch complete!
2024-09-28 13:10:29 INFO     evaluating now!
2024-09-28 13:10:30 INFO     Epoch [63/200] train_loss: 3.4603, val_loss: 5.0731, lr: 0.003000, 5.42s
2024-09-28 13:10:35 INFO     epoch complete!
2024-09-28 13:10:35 INFO     evaluating now!
2024-09-28 13:10:36 INFO     Epoch [64/200] train_loss: 3.4228, val_loss: 4.9273, lr: 0.003000, 5.72s
2024-09-28 13:10:36 INFO     Saved model at 64
2024-09-28 13:10:36 INFO     Val loss decrease from 4.9450 to 4.9273, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch64.tar
2024-09-28 13:10:41 INFO     epoch complete!
2024-09-28 13:10:41 INFO     evaluating now!
2024-09-28 13:10:41 INFO     Epoch [65/200] train_loss: 3.4614, val_loss: 5.0079, lr: 0.003000, 5.58s
2024-09-28 13:10:46 INFO     epoch complete!
2024-09-28 13:10:46 INFO     evaluating now!
2024-09-28 13:10:47 INFO     Epoch [66/200] train_loss: 3.4323, val_loss: 5.0953, lr: 0.003000, 5.42s
2024-09-28 13:10:52 INFO     epoch complete!
2024-09-28 13:10:52 INFO     evaluating now!
2024-09-28 13:10:52 INFO     Epoch [67/200] train_loss: 3.4517, val_loss: 5.0664, lr: 0.003000, 5.37s
2024-09-28 13:10:57 INFO     epoch complete!
2024-09-28 13:10:57 INFO     evaluating now!
2024-09-28 13:10:58 INFO     Epoch [68/200] train_loss: 3.4408, val_loss: 5.0150, lr: 0.003000, 5.79s
2024-09-28 13:11:03 INFO     epoch complete!
2024-09-28 13:11:03 INFO     evaluating now!
2024-09-28 13:11:04 INFO     Epoch [69/200] train_loss: 3.4449, val_loss: 5.0779, lr: 0.003000, 5.86s
2024-09-28 13:11:09 INFO     epoch complete!
2024-09-28 13:11:09 INFO     evaluating now!
2024-09-28 13:11:09 INFO     Epoch [70/200] train_loss: 3.4298, val_loss: 4.9523, lr: 0.003000, 5.59s
2024-09-28 13:11:14 INFO     epoch complete!
2024-09-28 13:11:14 INFO     evaluating now!
2024-09-28 13:11:15 INFO     Epoch [71/200] train_loss: 3.4215, val_loss: 5.1143, lr: 0.003000, 5.47s
2024-09-28 13:11:20 INFO     epoch complete!
2024-09-28 13:11:20 INFO     evaluating now!
2024-09-28 13:11:20 INFO     Epoch [72/200] train_loss: 3.3662, val_loss: 4.9607, lr: 0.003000, 5.43s
2024-09-28 13:11:25 INFO     epoch complete!
2024-09-28 13:11:25 INFO     evaluating now!
2024-09-28 13:11:25 INFO     Epoch [73/200] train_loss: 3.3618, val_loss: 4.9805, lr: 0.003000, 5.31s
2024-09-28 13:11:30 INFO     epoch complete!
2024-09-28 13:11:30 INFO     evaluating now!
2024-09-28 13:11:31 INFO     Epoch [74/200] train_loss: 3.3263, val_loss: 5.1619, lr: 0.003000, 5.33s
2024-09-28 13:11:36 INFO     epoch complete!
2024-09-28 13:11:36 INFO     evaluating now!
2024-09-28 13:11:36 INFO     Epoch [75/200] train_loss: 3.2997, val_loss: 4.9158, lr: 0.003000, 5.49s
2024-09-28 13:11:36 INFO     Saved model at 75
2024-09-28 13:11:36 INFO     Val loss decrease from 4.9273 to 4.9158, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch75.tar
2024-09-28 13:11:41 INFO     epoch complete!
2024-09-28 13:11:41 INFO     evaluating now!
2024-09-28 13:11:41 INFO     Epoch [76/200] train_loss: 3.3095, val_loss: 5.0288, lr: 0.003000, 5.00s
2024-09-28 13:11:46 INFO     epoch complete!
2024-09-28 13:11:46 INFO     evaluating now!
2024-09-28 13:11:46 INFO     Epoch [77/200] train_loss: 3.2913, val_loss: 4.9703, lr: 0.003000, 4.94s
2024-09-28 13:11:51 INFO     epoch complete!
2024-09-28 13:11:51 INFO     evaluating now!
2024-09-28 13:11:51 INFO     Epoch [78/200] train_loss: 3.2768, val_loss: 4.9570, lr: 0.003000, 4.90s
2024-09-28 13:11:56 INFO     epoch complete!
2024-09-28 13:11:56 INFO     evaluating now!
2024-09-28 13:11:57 INFO     Epoch [79/200] train_loss: 3.3024, val_loss: 4.9852, lr: 0.003000, 5.37s
2024-09-28 13:12:02 INFO     epoch complete!
2024-09-28 13:12:02 INFO     evaluating now!
2024-09-28 13:12:02 INFO     Epoch [80/200] train_loss: 3.2916, val_loss: 4.8782, lr: 0.003000, 5.79s
2024-09-28 13:12:02 INFO     Saved model at 80
2024-09-28 13:12:02 INFO     Val loss decrease from 4.9158 to 4.8782, saving to ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406_epoch80.tar
2024-09-28 13:12:08 INFO     epoch complete!
2024-09-28 13:12:08 INFO     evaluating now!
2024-09-28 13:12:09 INFO     Epoch [81/200] train_loss: 3.2560, val_loss: 5.0223, lr: 0.003000, 6.15s
2024-09-28 13:12:14 INFO     epoch complete!
2024-09-28 13:12:14 INFO     evaluating now!
2024-09-28 13:12:15 INFO     Epoch [82/200] train_loss: 3.2656, val_loss: 4.9817, lr: 0.003000, 6.26s
2024-09-28 13:12:20 INFO     epoch complete!
2024-09-28 13:12:20 INFO     evaluating now!
2024-09-28 13:12:21 INFO     Epoch [83/200] train_loss: 3.2683, val_loss: 5.0171, lr: 0.003000, 6.15s
2024-09-28 13:12:27 INFO     epoch complete!
2024-09-28 13:12:27 INFO     evaluating now!
2024-09-28 13:12:27 INFO     Epoch [84/200] train_loss: 3.2409, val_loss: 5.0037, lr: 0.003000, 6.36s
2024-09-28 13:12:33 INFO     epoch complete!
2024-09-28 13:12:33 INFO     evaluating now!
2024-09-28 13:12:34 INFO     Epoch [85/200] train_loss: 3.2113, val_loss: 5.0245, lr: 0.003000, 6.27s
2024-09-28 13:12:39 INFO     epoch complete!
2024-09-28 13:12:39 INFO     evaluating now!
2024-09-28 13:12:40 INFO     Epoch [86/200] train_loss: 3.2416, val_loss: 5.0749, lr: 0.003000, 6.26s
2024-09-28 13:12:46 INFO     epoch complete!
2024-09-28 13:12:46 INFO     evaluating now!
2024-09-28 13:12:46 INFO     Epoch [87/200] train_loss: 3.2687, val_loss: 5.0386, lr: 0.003000, 6.25s
2024-09-28 13:12:52 INFO     epoch complete!
2024-09-28 13:12:52 INFO     evaluating now!
2024-09-28 13:12:52 INFO     Epoch [88/200] train_loss: 3.2683, val_loss: 5.0975, lr: 0.003000, 6.24s
2024-09-28 13:12:58 INFO     epoch complete!
2024-09-28 13:12:58 INFO     evaluating now!
2024-09-28 13:12:59 INFO     Epoch [89/200] train_loss: 3.2277, val_loss: 5.1653, lr: 0.003000, 6.16s
2024-09-28 13:13:04 INFO     epoch complete!
2024-09-28 13:13:04 INFO     evaluating now!
2024-09-28 13:13:05 INFO     Epoch [90/200] train_loss: 3.2213, val_loss: 5.1557, lr: 0.003000, 6.22s
2024-09-28 13:13:10 INFO     epoch complete!
2024-09-28 13:13:10 INFO     evaluating now!
2024-09-28 13:13:11 INFO     Epoch [91/200] train_loss: 3.2198, val_loss: 4.9729, lr: 0.003000, 6.07s
2024-09-28 13:13:17 INFO     epoch complete!
2024-09-28 13:13:17 INFO     evaluating now!
2024-09-28 13:13:17 INFO     Epoch [92/200] train_loss: 3.1765, val_loss: 5.0363, lr: 0.003000, 6.17s
2024-09-28 13:13:23 INFO     epoch complete!
2024-09-28 13:13:23 INFO     evaluating now!
2024-09-28 13:13:23 INFO     Epoch [93/200] train_loss: 3.1557, val_loss: 5.0425, lr: 0.003000, 6.03s
2024-09-28 13:13:29 INFO     epoch complete!
2024-09-28 13:13:29 INFO     evaluating now!
2024-09-28 13:13:29 INFO     Epoch [94/200] train_loss: 3.1405, val_loss: 5.0430, lr: 0.003000, 6.06s
2024-09-28 13:13:35 INFO     epoch complete!
2024-09-28 13:13:35 INFO     evaluating now!
2024-09-28 13:13:35 INFO     Epoch [95/200] train_loss: 3.1126, val_loss: 4.9668, lr: 0.003000, 6.18s
2024-09-28 13:13:35 WARNING  Early stopping at epoch: 95
2024-09-28 13:13:35 INFO     Trained totally 96 epochs, average train time is 5.411s, average eval time is 0.427s
2024-09-28 13:13:35 INFO     Loaded model at 80
2024-09-28 13:13:35 INFO     Saved model at ./libcity/cache/18/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 13:13:35 INFO     Start evaluating ...
2024-09-28 13:13:37 INFO     Note that you select the single mode to evaluate!
2024-09-28 13:13:37 INFO     Evaluate result is saved at ./libcity/cache/18/evaluate_cache/2024_09_28_13_13_37_AGCRN_CHITaxi20190406.csv
2024-09-28 13:13:37 INFO     
         MAE       RMSE  masked_MAPE
1   2.247273   6.698780     0.392951
2   2.376373   7.507875     0.388183
3   2.534681   8.620428     0.390185
4   2.745680   9.563281     0.399697
5   2.852761  10.407009     0.397490
6   3.050618  11.629031     0.403334
7   3.207138  12.745448     0.415663
8   3.275067  13.457520     0.418556
9   3.321923  13.878038     0.416480
10  3.363154  14.055656     0.416503
11  3.383369  14.220748     0.421067
12  3.468972  14.691235     0.434270
2024-09-28 13:13:37 INFO     ----------------------------------------------------------------------------
2024-09-28 13:13:37 INFO     # 4, Kownledge Graph Embedding: GIE, Experiment ids: 19
2024-09-28 13:13:37 INFO     ----------------------------------------------------------------------------
2024-09-28 13:13:37 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=19
2024-09-28 13:13:37 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 19, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 13:13:37 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 13:13:37 INFO     set_weight_link_or_dist: dist
2024-09-28 13:13:37 INFO     init_weight_inf_or_zero: inf
2024-09-28 13:13:37 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 13:13:37 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 13:13:37 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 13:13:37 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 13:13:40 INFO     Dataset created
2024-09-28 13:13:40 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-28 13:13:40 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-28 13:13:40 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-28 13:13:40 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-28 13:13:41 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 13:13:41 INFO     NoneScaler
2024-09-28 13:13:43 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 13:13:43 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 13:13:43 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-28 13:13:43 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 13:13:43 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-28 13:13:43 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 13:13:43 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 13:13:43 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 13:13:43 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 13:13:43 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 13:13:43 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 13:13:43 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 13:13:43 INFO     Total parameter numbers: 874010
2024-09-28 13:13:43 INFO     You select `adam` optimizer.
2024-09-28 13:13:43 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 13:13:43 INFO     Start training ...
2024-09-28 13:13:43 INFO     num_batches:48
2024-09-28 13:13:48 INFO     epoch complete!
2024-09-28 13:13:48 INFO     evaluating now!
2024-09-28 13:13:49 INFO     Epoch [0/200] train_loss: 24.0904, val_loss: 17.7951, lr: 0.003000, 5.96s
2024-09-28 13:13:49 INFO     Saved model at 0
2024-09-28 13:13:49 INFO     Val loss decrease from inf to 17.7951, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 13:13:54 INFO     epoch complete!
2024-09-28 13:13:54 INFO     evaluating now!
2024-09-28 13:13:55 INFO     Epoch [1/200] train_loss: 14.3147, val_loss: 13.6499, lr: 0.003000, 5.99s
2024-09-28 13:13:55 INFO     Saved model at 1
2024-09-28 13:13:55 INFO     Val loss decrease from 17.7951 to 13.6499, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 13:14:00 INFO     epoch complete!
2024-09-28 13:14:00 INFO     evaluating now!
2024-09-28 13:14:01 INFO     Epoch [2/200] train_loss: 11.1964, val_loss: 10.7301, lr: 0.003000, 6.07s
2024-09-28 13:14:01 INFO     Saved model at 2
2024-09-28 13:14:01 INFO     Val loss decrease from 13.6499 to 10.7301, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 13:14:06 INFO     epoch complete!
2024-09-28 13:14:06 INFO     evaluating now!
2024-09-28 13:14:07 INFO     Epoch [3/200] train_loss: 9.1956, val_loss: 8.7298, lr: 0.003000, 5.89s
2024-09-28 13:14:07 INFO     Saved model at 3
2024-09-28 13:14:07 INFO     Val loss decrease from 10.7301 to 8.7298, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 13:14:12 INFO     epoch complete!
2024-09-28 13:14:12 INFO     evaluating now!
2024-09-28 13:14:13 INFO     Epoch [4/200] train_loss: 8.0351, val_loss: 7.6937, lr: 0.003000, 6.19s
2024-09-28 13:14:13 INFO     Saved model at 4
2024-09-28 13:14:13 INFO     Val loss decrease from 8.7298 to 7.6937, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 13:14:18 INFO     epoch complete!
2024-09-28 13:14:18 INFO     evaluating now!
2024-09-28 13:14:19 INFO     Epoch [5/200] train_loss: 7.3754, val_loss: 7.0489, lr: 0.003000, 5.97s
2024-09-28 13:14:19 INFO     Saved model at 5
2024-09-28 13:14:19 INFO     Val loss decrease from 7.6937 to 7.0489, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 13:14:25 INFO     epoch complete!
2024-09-28 13:14:25 INFO     evaluating now!
2024-09-28 13:14:25 INFO     Epoch [6/200] train_loss: 6.7779, val_loss: 6.7490, lr: 0.003000, 6.23s
2024-09-28 13:14:25 INFO     Saved model at 6
2024-09-28 13:14:25 INFO     Val loss decrease from 7.0489 to 6.7490, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-28 13:14:31 INFO     epoch complete!
2024-09-28 13:14:31 INFO     evaluating now!
2024-09-28 13:14:31 INFO     Epoch [7/200] train_loss: 6.3973, val_loss: 6.3966, lr: 0.003000, 5.90s
2024-09-28 13:14:31 INFO     Saved model at 7
2024-09-28 13:14:31 INFO     Val loss decrease from 6.7490 to 6.3966, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-28 13:14:37 INFO     epoch complete!
2024-09-28 13:14:37 INFO     evaluating now!
2024-09-28 13:14:37 INFO     Epoch [8/200] train_loss: 6.1469, val_loss: 6.2675, lr: 0.003000, 6.21s
2024-09-28 13:14:38 INFO     Saved model at 8
2024-09-28 13:14:38 INFO     Val loss decrease from 6.3966 to 6.2675, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-28 13:14:43 INFO     epoch complete!
2024-09-28 13:14:43 INFO     evaluating now!
2024-09-28 13:14:44 INFO     Epoch [9/200] train_loss: 5.8936, val_loss: 5.8283, lr: 0.003000, 6.07s
2024-09-28 13:14:44 INFO     Saved model at 9
2024-09-28 13:14:44 INFO     Val loss decrease from 6.2675 to 5.8283, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-28 13:14:49 INFO     epoch complete!
2024-09-28 13:14:49 INFO     evaluating now!
2024-09-28 13:14:50 INFO     Epoch [10/200] train_loss: 5.7828, val_loss: 6.0697, lr: 0.003000, 6.22s
2024-09-28 13:14:56 INFO     epoch complete!
2024-09-28 13:14:56 INFO     evaluating now!
2024-09-28 13:14:56 INFO     Epoch [11/200] train_loss: 5.5277, val_loss: 5.6918, lr: 0.003000, 6.16s
2024-09-28 13:14:56 INFO     Saved model at 11
2024-09-28 13:14:56 INFO     Val loss decrease from 5.8283 to 5.6918, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-28 13:15:02 INFO     epoch complete!
2024-09-28 13:15:02 INFO     evaluating now!
2024-09-28 13:15:02 INFO     Epoch [12/200] train_loss: 5.4069, val_loss: 5.6903, lr: 0.003000, 6.23s
2024-09-28 13:15:02 INFO     Saved model at 12
2024-09-28 13:15:02 INFO     Val loss decrease from 5.6918 to 5.6903, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-28 13:15:08 INFO     epoch complete!
2024-09-28 13:15:08 INFO     evaluating now!
2024-09-28 13:15:08 INFO     Epoch [13/200] train_loss: 5.3048, val_loss: 5.7393, lr: 0.003000, 6.00s
2024-09-28 13:15:14 INFO     epoch complete!
2024-09-28 13:15:14 INFO     evaluating now!
2024-09-28 13:15:15 INFO     Epoch [14/200] train_loss: 5.2440, val_loss: 5.4098, lr: 0.003000, 6.32s
2024-09-28 13:15:15 INFO     Saved model at 14
2024-09-28 13:15:15 INFO     Val loss decrease from 5.6903 to 5.4098, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-28 13:15:21 INFO     epoch complete!
2024-09-28 13:15:21 INFO     evaluating now!
2024-09-28 13:15:21 INFO     Epoch [15/200] train_loss: 5.1956, val_loss: 5.4263, lr: 0.003000, 6.39s
2024-09-28 13:15:27 INFO     epoch complete!
2024-09-28 13:15:27 INFO     evaluating now!
2024-09-28 13:15:27 INFO     Epoch [16/200] train_loss: 5.0634, val_loss: 5.5628, lr: 0.003000, 6.16s
2024-09-28 13:15:33 INFO     epoch complete!
2024-09-28 13:15:33 INFO     evaluating now!
2024-09-28 13:15:34 INFO     Epoch [17/200] train_loss: 4.9315, val_loss: 5.3315, lr: 0.003000, 6.27s
2024-09-28 13:15:34 INFO     Saved model at 17
2024-09-28 13:15:34 INFO     Val loss decrease from 5.4098 to 5.3315, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-28 13:15:39 INFO     epoch complete!
2024-09-28 13:15:39 INFO     evaluating now!
2024-09-28 13:15:40 INFO     Epoch [18/200] train_loss: 4.8456, val_loss: 5.2512, lr: 0.003000, 6.36s
2024-09-28 13:15:40 INFO     Saved model at 18
2024-09-28 13:15:40 INFO     Val loss decrease from 5.3315 to 5.2512, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-28 13:15:46 INFO     epoch complete!
2024-09-28 13:15:46 INFO     evaluating now!
2024-09-28 13:15:46 INFO     Epoch [19/200] train_loss: 4.8029, val_loss: 5.4066, lr: 0.003000, 6.14s
2024-09-28 13:15:52 INFO     epoch complete!
2024-09-28 13:15:52 INFO     evaluating now!
2024-09-28 13:15:52 INFO     Epoch [20/200] train_loss: 4.7411, val_loss: 5.2328, lr: 0.003000, 6.24s
2024-09-28 13:15:52 INFO     Saved model at 20
2024-09-28 13:15:52 INFO     Val loss decrease from 5.2512 to 5.2328, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-28 13:15:58 INFO     epoch complete!
2024-09-28 13:15:58 INFO     evaluating now!
2024-09-28 13:15:59 INFO     Epoch [21/200] train_loss: 4.6595, val_loss: 5.3226, lr: 0.003000, 6.34s
2024-09-28 13:16:04 INFO     epoch complete!
2024-09-28 13:16:04 INFO     evaluating now!
2024-09-28 13:16:05 INFO     Epoch [22/200] train_loss: 4.6639, val_loss: 5.2910, lr: 0.003000, 6.12s
2024-09-28 13:16:11 INFO     epoch complete!
2024-09-28 13:16:11 INFO     evaluating now!
2024-09-28 13:16:11 INFO     Epoch [23/200] train_loss: 4.5916, val_loss: 5.1342, lr: 0.003000, 6.27s
2024-09-28 13:16:11 INFO     Saved model at 23
2024-09-28 13:16:11 INFO     Val loss decrease from 5.2328 to 5.1342, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-28 13:16:17 INFO     epoch complete!
2024-09-28 13:16:17 INFO     evaluating now!
2024-09-28 13:16:17 INFO     Epoch [24/200] train_loss: 4.4815, val_loss: 5.2493, lr: 0.003000, 6.24s
2024-09-28 13:16:23 INFO     epoch complete!
2024-09-28 13:16:23 INFO     evaluating now!
2024-09-28 13:16:24 INFO     Epoch [25/200] train_loss: 4.4719, val_loss: 5.0706, lr: 0.003000, 6.30s
2024-09-28 13:16:24 INFO     Saved model at 25
2024-09-28 13:16:24 INFO     Val loss decrease from 5.1342 to 5.0706, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-28 13:16:29 INFO     epoch complete!
2024-09-28 13:16:29 INFO     evaluating now!
2024-09-28 13:16:30 INFO     Epoch [26/200] train_loss: 4.3907, val_loss: 5.0569, lr: 0.003000, 6.04s
2024-09-28 13:16:30 INFO     Saved model at 26
2024-09-28 13:16:30 INFO     Val loss decrease from 5.0706 to 5.0569, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-09-28 13:16:36 INFO     epoch complete!
2024-09-28 13:16:36 INFO     evaluating now!
2024-09-28 13:16:36 INFO     Epoch [27/200] train_loss: 4.3965, val_loss: 5.1849, lr: 0.003000, 6.46s
2024-09-28 13:16:42 INFO     epoch complete!
2024-09-28 13:16:42 INFO     evaluating now!
2024-09-28 13:16:42 INFO     Epoch [28/200] train_loss: 4.3718, val_loss: 5.0187, lr: 0.003000, 6.04s
2024-09-28 13:16:43 INFO     Saved model at 28
2024-09-28 13:16:43 INFO     Val loss decrease from 5.0569 to 5.0187, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-28 13:16:48 INFO     epoch complete!
2024-09-28 13:16:48 INFO     evaluating now!
2024-09-28 13:16:49 INFO     Epoch [29/200] train_loss: 4.3265, val_loss: 5.2758, lr: 0.003000, 6.10s
2024-09-28 13:16:54 INFO     epoch complete!
2024-09-28 13:16:54 INFO     evaluating now!
2024-09-28 13:16:55 INFO     Epoch [30/200] train_loss: 4.3067, val_loss: 5.0586, lr: 0.003000, 6.24s
2024-09-28 13:17:01 INFO     epoch complete!
2024-09-28 13:17:01 INFO     evaluating now!
2024-09-28 13:17:01 INFO     Epoch [31/200] train_loss: 4.2582, val_loss: 5.0769, lr: 0.003000, 6.39s
2024-09-28 13:17:07 INFO     epoch complete!
2024-09-28 13:17:07 INFO     evaluating now!
2024-09-28 13:17:07 INFO     Epoch [32/200] train_loss: 4.2232, val_loss: 5.0217, lr: 0.003000, 6.02s
2024-09-28 13:17:13 INFO     epoch complete!
2024-09-28 13:17:13 INFO     evaluating now!
2024-09-28 13:17:13 INFO     Epoch [33/200] train_loss: 4.1251, val_loss: 5.0233, lr: 0.003000, 6.07s
2024-09-28 13:17:19 INFO     epoch complete!
2024-09-28 13:17:19 INFO     evaluating now!
2024-09-28 13:17:19 INFO     Epoch [34/200] train_loss: 4.1064, val_loss: 5.1803, lr: 0.003000, 6.13s
2024-09-28 13:17:25 INFO     epoch complete!
2024-09-28 13:17:25 INFO     evaluating now!
2024-09-28 13:17:26 INFO     Epoch [35/200] train_loss: 4.0753, val_loss: 5.0569, lr: 0.003000, 6.28s
2024-09-28 13:17:32 INFO     epoch complete!
2024-09-28 13:17:32 INFO     evaluating now!
2024-09-28 13:17:32 INFO     Epoch [36/200] train_loss: 4.1162, val_loss: 5.0439, lr: 0.003000, 6.24s
2024-09-28 13:17:38 INFO     epoch complete!
2024-09-28 13:17:38 INFO     evaluating now!
2024-09-28 13:17:38 INFO     Epoch [37/200] train_loss: 4.0771, val_loss: 5.0419, lr: 0.003000, 6.10s
2024-09-28 13:17:44 INFO     epoch complete!
2024-09-28 13:17:44 INFO     evaluating now!
2024-09-28 13:17:44 INFO     Epoch [38/200] train_loss: 4.0715, val_loss: 4.9710, lr: 0.003000, 6.02s
2024-09-28 13:17:44 INFO     Saved model at 38
2024-09-28 13:17:44 INFO     Val loss decrease from 5.0187 to 4.9710, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-09-28 13:17:50 INFO     epoch complete!
2024-09-28 13:17:50 INFO     evaluating now!
2024-09-28 13:17:50 INFO     Epoch [39/200] train_loss: 3.9854, val_loss: 5.0487, lr: 0.003000, 6.09s
2024-09-28 13:17:56 INFO     epoch complete!
2024-09-28 13:17:56 INFO     evaluating now!
2024-09-28 13:17:57 INFO     Epoch [40/200] train_loss: 3.9445, val_loss: 5.0884, lr: 0.003000, 6.26s
2024-09-28 13:18:02 INFO     epoch complete!
2024-09-28 13:18:02 INFO     evaluating now!
2024-09-28 13:18:03 INFO     Epoch [41/200] train_loss: 3.9978, val_loss: 5.1082, lr: 0.003000, 6.25s
2024-09-28 13:18:09 INFO     epoch complete!
2024-09-28 13:18:09 INFO     evaluating now!
2024-09-28 13:18:09 INFO     Epoch [42/200] train_loss: 3.9148, val_loss: 5.0347, lr: 0.003000, 6.28s
2024-09-28 13:18:15 INFO     epoch complete!
2024-09-28 13:18:15 INFO     evaluating now!
2024-09-28 13:18:15 INFO     Epoch [43/200] train_loss: 3.8972, val_loss: 4.9837, lr: 0.003000, 6.06s
2024-09-28 13:18:21 INFO     epoch complete!
2024-09-28 13:18:21 INFO     evaluating now!
2024-09-28 13:18:21 INFO     Epoch [44/200] train_loss: 3.9142, val_loss: 4.9424, lr: 0.003000, 6.29s
2024-09-28 13:18:21 INFO     Saved model at 44
2024-09-28 13:18:21 INFO     Val loss decrease from 4.9710 to 4.9424, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-09-28 13:18:27 INFO     epoch complete!
2024-09-28 13:18:27 INFO     evaluating now!
2024-09-28 13:18:27 INFO     Epoch [45/200] train_loss: 3.8206, val_loss: 4.9193, lr: 0.003000, 5.99s
2024-09-28 13:18:28 INFO     Saved model at 45
2024-09-28 13:18:28 INFO     Val loss decrease from 4.9424 to 4.9193, saving to ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-09-28 13:18:33 INFO     epoch complete!
2024-09-28 13:18:33 INFO     evaluating now!
2024-09-28 13:18:34 INFO     Epoch [46/200] train_loss: 3.7970, val_loss: 4.9622, lr: 0.003000, 6.13s
2024-09-28 13:18:39 INFO     epoch complete!
2024-09-28 13:18:39 INFO     evaluating now!
2024-09-28 13:18:40 INFO     Epoch [47/200] train_loss: 3.7688, val_loss: 5.0668, lr: 0.003000, 6.07s
2024-09-28 13:18:45 INFO     epoch complete!
2024-09-28 13:18:45 INFO     evaluating now!
2024-09-28 13:18:46 INFO     Epoch [48/200] train_loss: 3.7695, val_loss: 4.9695, lr: 0.003000, 6.03s
2024-09-28 13:18:51 INFO     epoch complete!
2024-09-28 13:18:51 INFO     evaluating now!
2024-09-28 13:18:52 INFO     Epoch [49/200] train_loss: 3.7393, val_loss: 5.0085, lr: 0.003000, 6.01s
2024-09-28 13:18:57 INFO     epoch complete!
2024-09-28 13:18:57 INFO     evaluating now!
2024-09-28 13:18:58 INFO     Epoch [50/200] train_loss: 3.7008, val_loss: 5.0347, lr: 0.003000, 6.16s
2024-09-28 13:19:03 INFO     epoch complete!
2024-09-28 13:19:03 INFO     evaluating now!
2024-09-28 13:19:04 INFO     Epoch [51/200] train_loss: 3.7266, val_loss: 5.1337, lr: 0.003000, 5.92s
2024-09-28 13:19:10 INFO     epoch complete!
2024-09-28 13:19:10 INFO     evaluating now!
2024-09-28 13:19:10 INFO     Epoch [52/200] train_loss: 3.7723, val_loss: 4.9800, lr: 0.003000, 6.16s
2024-09-28 13:19:16 INFO     epoch complete!
2024-09-28 13:19:16 INFO     evaluating now!
2024-09-28 13:19:16 INFO     Epoch [53/200] train_loss: 3.6758, val_loss: 4.9843, lr: 0.003000, 6.11s
2024-09-28 13:19:22 INFO     epoch complete!
2024-09-28 13:19:22 INFO     evaluating now!
2024-09-28 13:19:22 INFO     Epoch [54/200] train_loss: 3.6228, val_loss: 5.0227, lr: 0.003000, 6.14s
2024-09-28 13:19:28 INFO     epoch complete!
2024-09-28 13:19:28 INFO     evaluating now!
2024-09-28 13:19:28 INFO     Epoch [55/200] train_loss: 3.6533, val_loss: 4.9605, lr: 0.003000, 6.06s
2024-09-28 13:19:34 INFO     epoch complete!
2024-09-28 13:19:34 INFO     evaluating now!
2024-09-28 13:19:34 INFO     Epoch [56/200] train_loss: 3.6367, val_loss: 5.0520, lr: 0.003000, 5.81s
2024-09-28 13:19:40 INFO     epoch complete!
2024-09-28 13:19:40 INFO     evaluating now!
2024-09-28 13:19:40 INFO     Epoch [57/200] train_loss: 3.5688, val_loss: 4.9732, lr: 0.003000, 6.08s
2024-09-28 13:19:46 INFO     epoch complete!
2024-09-28 13:19:46 INFO     evaluating now!
2024-09-28 13:19:46 INFO     Epoch [58/200] train_loss: 3.5935, val_loss: 5.0078, lr: 0.003000, 6.14s
2024-09-28 13:19:52 INFO     epoch complete!
2024-09-28 13:19:52 INFO     evaluating now!
2024-09-28 13:19:52 INFO     Epoch [59/200] train_loss: 3.6172, val_loss: 4.9950, lr: 0.003000, 6.08s
2024-09-28 13:19:58 INFO     epoch complete!
2024-09-28 13:19:58 INFO     evaluating now!
2024-09-28 13:19:58 INFO     Epoch [60/200] train_loss: 3.5128, val_loss: 5.0084, lr: 0.003000, 6.00s
2024-09-28 13:19:58 WARNING  Early stopping at epoch: 60
2024-09-28 13:19:58 INFO     Trained totally 61 epochs, average train time is 5.699s, average eval time is 0.439s
2024-09-28 13:19:59 INFO     Loaded model at 45
2024-09-28 13:19:59 INFO     Saved model at ./libcity/cache/19/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 13:19:59 INFO     Start evaluating ...
2024-09-28 13:20:00 INFO     Note that you select the single mode to evaluate!
2024-09-28 13:20:00 INFO     Evaluate result is saved at ./libcity/cache/19/evaluate_cache/2024_09_28_13_20_00_AGCRN_CHITaxi20190406.csv
2024-09-28 13:20:00 INFO     
         MAE       RMSE  masked_MAPE
1   2.437557   7.796893     0.427770
2   2.579995   8.188018     0.434156
3   2.721251   8.905066     0.443418
4   2.923289   9.736113     0.463628
5   3.111757  10.831309     0.473800
6   3.283322  11.977225     0.498490
7   3.325481  12.928662     0.484251
8   3.366623  13.538537     0.487346
9   3.401640  13.750084     0.495478
10  3.447147  13.782028     0.493761
11  3.523919  14.072481     0.491099
12  3.648649  14.523860     0.498639
2024-09-28 13:20:00 INFO     ----------------------------------------------------------------------------
2024-09-28 13:20:00 INFO     Kownledge Graph Embedding: GIE, Experiment ids: [15, 16, 17, 18, 19]
2024-09-28 13:20:00 INFO     ----------------------------------------------------------------------------
2024-09-28 13:20:00 INFO     Average: 
         MAE       RMSE  masked_MAPE
0   2.397942   7.240610     0.427287
1   2.486908   7.725114     0.428415
2   2.662257   8.756722     0.435793
3   2.854867   9.723090     0.441864
4   2.992955  10.602417     0.447960
5   3.126147  11.463884     0.453138
6   3.226626  12.235179     0.460377
7   3.283589  12.740065     0.462996
8   3.316491  13.112515     0.462244
9   3.379459  13.343707     0.469940
10  3.417705  13.703287     0.467318
11  3.563430  14.308239     0.487533 
2024-09-28 13:20:00 INFO     Standard deviation: 
         MAE      RMSE  masked_MAPE
0   0.096005  0.354479     0.027750
1   0.097307  0.243731     0.029687
2   0.077011  0.161293     0.025894
3   0.091110  0.345779     0.025305
4   0.103196  0.391376     0.029219
5   0.103512  0.462624     0.031666
6   0.075007  0.561647     0.027329
7   0.058492  0.640546     0.026295
8   0.059063  0.596756     0.027985
9   0.056588  0.505733     0.032089
10  0.065565  0.455901     0.026426
11  0.094657  0.512097     0.033342
2024-09-28 13:20:00 INFO     ----------------------------------------------------------------------------
2024-09-28 13:20:00 INFO     12 steps Average: 
        MAE       RMSE  masked_MAPE
0  3.059031  11.246236     0.453739
2024-09-28 13:20:00 INFO     12 steps Standard deviation: 
        MAE      RMSE  masked_MAPE
0  0.081459  0.435997     0.028582
