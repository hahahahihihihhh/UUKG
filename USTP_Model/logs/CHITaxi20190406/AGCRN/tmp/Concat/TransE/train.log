2024-09-28 14:19:34 INFO     Saving logs in: ./logs/CHITaxi20190406/AGCRN/Concat/TransE
2024-09-28 14:19:35 INFO     ----------------------------------------------------------------------------
2024-09-28 14:19:35 INFO     # 0, Kownledge Graph Embedding: TransE, Experiment ids: 20
2024-09-28 14:19:35 INFO     ----------------------------------------------------------------------------
2024-09-28 14:19:35 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=20
2024-09-28 14:19:35 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 20, 'ke_model': 'TransE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 14:19:35 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 14:19:35 INFO     set_weight_link_or_dist: dist
2024-09-28 14:19:35 INFO     init_weight_inf_or_zero: inf
2024-09-28 14:19:35 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 14:19:35 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 14:19:35 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 14:19:36 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 14:19:38 INFO     Dataset created
2024-09-28 14:19:38 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-28 14:19:38 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-28 14:19:38 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-28 14:19:38 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-28 14:19:39 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 14:19:39 INFO     NoneScaler
2024-09-28 14:19:45 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 14:19:45 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 14:19:45 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-28 14:19:45 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 14:19:45 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-28 14:19:45 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 14:19:45 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 14:19:45 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 14:19:45 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 14:19:45 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 14:19:45 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 14:19:45 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 14:19:45 INFO     Total parameter numbers: 874010
2024-09-28 14:19:45 INFO     You select `adam` optimizer.
2024-09-28 14:19:45 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 14:19:45 INFO     Start training ...
2024-09-28 14:19:45 INFO     num_batches:48
2024-09-28 14:19:51 INFO     epoch complete!
2024-09-28 14:19:51 INFO     evaluating now!
2024-09-28 14:19:51 INFO     Epoch [0/200] train_loss: 23.9232, val_loss: 18.4773, lr: 0.003000, 6.15s
2024-09-28 14:19:51 INFO     Saved model at 0
2024-09-28 14:19:51 INFO     Val loss decrease from inf to 18.4773, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 14:19:56 INFO     epoch complete!
2024-09-28 14:19:56 INFO     evaluating now!
2024-09-28 14:19:57 INFO     Epoch [1/200] train_loss: 14.9447, val_loss: 14.4897, lr: 0.003000, 5.59s
2024-09-28 14:19:57 INFO     Saved model at 1
2024-09-28 14:19:57 INFO     Val loss decrease from 18.4773 to 14.4897, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 14:20:02 INFO     epoch complete!
2024-09-28 14:20:02 INFO     evaluating now!
2024-09-28 14:20:02 INFO     Epoch [2/200] train_loss: 12.1310, val_loss: 11.7913, lr: 0.003000, 5.65s
2024-09-28 14:20:02 INFO     Saved model at 2
2024-09-28 14:20:02 INFO     Val loss decrease from 14.4897 to 11.7913, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 14:20:08 INFO     epoch complete!
2024-09-28 14:20:08 INFO     evaluating now!
2024-09-28 14:20:08 INFO     Epoch [3/200] train_loss: 10.0403, val_loss: 9.8827, lr: 0.003000, 5.55s
2024-09-28 14:20:08 INFO     Saved model at 3
2024-09-28 14:20:08 INFO     Val loss decrease from 11.7913 to 9.8827, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 14:20:13 INFO     epoch complete!
2024-09-28 14:20:13 INFO     evaluating now!
2024-09-28 14:20:13 INFO     Epoch [4/200] train_loss: 8.6715, val_loss: 8.3272, lr: 0.003000, 5.44s
2024-09-28 14:20:14 INFO     Saved model at 4
2024-09-28 14:20:14 INFO     Val loss decrease from 9.8827 to 8.3272, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 14:20:19 INFO     epoch complete!
2024-09-28 14:20:19 INFO     evaluating now!
2024-09-28 14:20:19 INFO     Epoch [5/200] train_loss: 7.8321, val_loss: 7.7758, lr: 0.003000, 5.61s
2024-09-28 14:20:19 INFO     Saved model at 5
2024-09-28 14:20:19 INFO     Val loss decrease from 8.3272 to 7.7758, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 14:20:24 INFO     epoch complete!
2024-09-28 14:20:24 INFO     evaluating now!
2024-09-28 14:20:25 INFO     Epoch [6/200] train_loss: 7.4058, val_loss: 7.4642, lr: 0.003000, 5.45s
2024-09-28 14:20:25 INFO     Saved model at 6
2024-09-28 14:20:25 INFO     Val loss decrease from 7.7758 to 7.4642, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-28 14:20:30 INFO     epoch complete!
2024-09-28 14:20:30 INFO     evaluating now!
2024-09-28 14:20:30 INFO     Epoch [7/200] train_loss: 6.9378, val_loss: 6.9676, lr: 0.003000, 5.54s
2024-09-28 14:20:30 INFO     Saved model at 7
2024-09-28 14:20:30 INFO     Val loss decrease from 7.4642 to 6.9676, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-28 14:20:35 INFO     epoch complete!
2024-09-28 14:20:35 INFO     evaluating now!
2024-09-28 14:20:36 INFO     Epoch [8/200] train_loss: 6.4979, val_loss: 6.6008, lr: 0.003000, 5.42s
2024-09-28 14:20:36 INFO     Saved model at 8
2024-09-28 14:20:36 INFO     Val loss decrease from 6.9676 to 6.6008, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-28 14:20:41 INFO     epoch complete!
2024-09-28 14:20:41 INFO     evaluating now!
2024-09-28 14:20:42 INFO     Epoch [9/200] train_loss: 6.3490, val_loss: 6.2102, lr: 0.003000, 5.62s
2024-09-28 14:20:42 INFO     Saved model at 9
2024-09-28 14:20:42 INFO     Val loss decrease from 6.6008 to 6.2102, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-28 14:20:47 INFO     epoch complete!
2024-09-28 14:20:47 INFO     evaluating now!
2024-09-28 14:20:47 INFO     Epoch [10/200] train_loss: 6.0400, val_loss: 6.2354, lr: 0.003000, 5.60s
2024-09-28 14:20:52 INFO     epoch complete!
2024-09-28 14:20:52 INFO     evaluating now!
2024-09-28 14:20:53 INFO     Epoch [11/200] train_loss: 5.8276, val_loss: 6.2667, lr: 0.003000, 5.70s
2024-09-28 14:20:59 INFO     epoch complete!
2024-09-28 14:20:59 INFO     evaluating now!
2024-09-28 14:20:59 INFO     Epoch [12/200] train_loss: 5.8510, val_loss: 6.1594, lr: 0.003000, 6.07s
2024-09-28 14:20:59 INFO     Saved model at 12
2024-09-28 14:20:59 INFO     Val loss decrease from 6.2102 to 6.1594, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-28 14:21:04 INFO     epoch complete!
2024-09-28 14:21:04 INFO     evaluating now!
2024-09-28 14:21:04 INFO     Epoch [13/200] train_loss: 5.6498, val_loss: 5.9277, lr: 0.003000, 5.52s
2024-09-28 14:21:05 INFO     Saved model at 13
2024-09-28 14:21:05 INFO     Val loss decrease from 6.1594 to 5.9277, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-28 14:21:10 INFO     epoch complete!
2024-09-28 14:21:10 INFO     evaluating now!
2024-09-28 14:21:10 INFO     Epoch [14/200] train_loss: 5.5902, val_loss: 5.8074, lr: 0.003000, 5.50s
2024-09-28 14:21:10 INFO     Saved model at 14
2024-09-28 14:21:10 INFO     Val loss decrease from 5.9277 to 5.8074, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-28 14:21:15 INFO     epoch complete!
2024-09-28 14:21:15 INFO     evaluating now!
2024-09-28 14:21:16 INFO     Epoch [15/200] train_loss: 5.4687, val_loss: 5.9545, lr: 0.003000, 5.65s
2024-09-28 14:21:21 INFO     epoch complete!
2024-09-28 14:21:21 INFO     evaluating now!
2024-09-28 14:21:22 INFO     Epoch [16/200] train_loss: 5.3001, val_loss: 5.7829, lr: 0.003000, 5.74s
2024-09-28 14:21:22 INFO     Saved model at 16
2024-09-28 14:21:22 INFO     Val loss decrease from 5.8074 to 5.7829, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-28 14:21:27 INFO     epoch complete!
2024-09-28 14:21:27 INFO     evaluating now!
2024-09-28 14:21:27 INFO     Epoch [17/200] train_loss: 5.2034, val_loss: 5.5964, lr: 0.003000, 5.69s
2024-09-28 14:21:27 INFO     Saved model at 17
2024-09-28 14:21:27 INFO     Val loss decrease from 5.7829 to 5.5964, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-28 14:21:32 INFO     epoch complete!
2024-09-28 14:21:32 INFO     evaluating now!
2024-09-28 14:21:33 INFO     Epoch [18/200] train_loss: 5.0797, val_loss: 5.5289, lr: 0.003000, 5.52s
2024-09-28 14:21:33 INFO     Saved model at 18
2024-09-28 14:21:33 INFO     Val loss decrease from 5.5964 to 5.5289, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-28 14:21:38 INFO     epoch complete!
2024-09-28 14:21:38 INFO     evaluating now!
2024-09-28 14:21:39 INFO     Epoch [19/200] train_loss: 5.0086, val_loss: 5.4867, lr: 0.003000, 5.69s
2024-09-28 14:21:39 INFO     Saved model at 19
2024-09-28 14:21:39 INFO     Val loss decrease from 5.5289 to 5.4867, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-09-28 14:21:44 INFO     epoch complete!
2024-09-28 14:21:44 INFO     evaluating now!
2024-09-28 14:21:44 INFO     Epoch [20/200] train_loss: 4.9659, val_loss: 5.4367, lr: 0.003000, 5.61s
2024-09-28 14:21:44 INFO     Saved model at 20
2024-09-28 14:21:44 INFO     Val loss decrease from 5.4867 to 5.4367, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-28 14:21:50 INFO     epoch complete!
2024-09-28 14:21:50 INFO     evaluating now!
2024-09-28 14:21:50 INFO     Epoch [21/200] train_loss: 4.8842, val_loss: 5.5452, lr: 0.003000, 5.71s
2024-09-28 14:21:55 INFO     epoch complete!
2024-09-28 14:21:55 INFO     evaluating now!
2024-09-28 14:21:56 INFO     Epoch [22/200] train_loss: 4.8229, val_loss: 5.4141, lr: 0.003000, 5.59s
2024-09-28 14:21:56 INFO     Saved model at 22
2024-09-28 14:21:56 INFO     Val loss decrease from 5.4367 to 5.4141, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-28 14:22:01 INFO     epoch complete!
2024-09-28 14:22:01 INFO     evaluating now!
2024-09-28 14:22:01 INFO     Epoch [23/200] train_loss: 4.8187, val_loss: 5.4762, lr: 0.003000, 5.48s
2024-09-28 14:22:06 INFO     epoch complete!
2024-09-28 14:22:06 INFO     evaluating now!
2024-09-28 14:22:07 INFO     Epoch [24/200] train_loss: 4.6391, val_loss: 5.3841, lr: 0.003000, 5.58s
2024-09-28 14:22:07 INFO     Saved model at 24
2024-09-28 14:22:07 INFO     Val loss decrease from 5.4141 to 5.3841, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-09-28 14:22:12 INFO     epoch complete!
2024-09-28 14:22:12 INFO     evaluating now!
2024-09-28 14:22:12 INFO     Epoch [25/200] train_loss: 4.6453, val_loss: 5.2985, lr: 0.003000, 5.57s
2024-09-28 14:22:12 INFO     Saved model at 25
2024-09-28 14:22:12 INFO     Val loss decrease from 5.3841 to 5.2985, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-28 14:22:18 INFO     epoch complete!
2024-09-28 14:22:18 INFO     evaluating now!
2024-09-28 14:22:18 INFO     Epoch [26/200] train_loss: 4.6184, val_loss: 5.3021, lr: 0.003000, 5.54s
2024-09-28 14:22:23 INFO     epoch complete!
2024-09-28 14:22:23 INFO     evaluating now!
2024-09-28 14:22:23 INFO     Epoch [27/200] train_loss: 4.5544, val_loss: 5.3780, lr: 0.003000, 5.52s
2024-09-28 14:22:29 INFO     epoch complete!
2024-09-28 14:22:29 INFO     evaluating now!
2024-09-28 14:22:29 INFO     Epoch [28/200] train_loss: 4.4995, val_loss: 5.3438, lr: 0.003000, 5.56s
2024-09-28 14:22:34 INFO     epoch complete!
2024-09-28 14:22:34 INFO     evaluating now!
2024-09-28 14:22:35 INFO     Epoch [29/200] train_loss: 4.3849, val_loss: 5.4870, lr: 0.003000, 5.55s
2024-09-28 14:22:40 INFO     epoch complete!
2024-09-28 14:22:40 INFO     evaluating now!
2024-09-28 14:22:40 INFO     Epoch [30/200] train_loss: 4.4059, val_loss: 5.2010, lr: 0.003000, 5.62s
2024-09-28 14:22:40 INFO     Saved model at 30
2024-09-28 14:22:40 INFO     Val loss decrease from 5.2985 to 5.2010, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-09-28 14:22:45 INFO     epoch complete!
2024-09-28 14:22:45 INFO     evaluating now!
2024-09-28 14:22:46 INFO     Epoch [31/200] train_loss: 4.4156, val_loss: 5.3361, lr: 0.003000, 5.52s
2024-09-28 14:22:51 INFO     epoch complete!
2024-09-28 14:22:51 INFO     evaluating now!
2024-09-28 14:22:51 INFO     Epoch [32/200] train_loss: 4.3464, val_loss: 5.1227, lr: 0.003000, 5.36s
2024-09-28 14:22:51 INFO     Saved model at 32
2024-09-28 14:22:51 INFO     Val loss decrease from 5.2010 to 5.1227, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-09-28 14:22:57 INFO     epoch complete!
2024-09-28 14:22:57 INFO     evaluating now!
2024-09-28 14:22:57 INFO     Epoch [33/200] train_loss: 4.3122, val_loss: 5.3894, lr: 0.003000, 5.58s
2024-09-28 14:23:02 INFO     epoch complete!
2024-09-28 14:23:02 INFO     evaluating now!
2024-09-28 14:23:02 INFO     Epoch [34/200] train_loss: 4.2445, val_loss: 5.2448, lr: 0.003000, 5.47s
2024-09-28 14:23:08 INFO     epoch complete!
2024-09-28 14:23:08 INFO     evaluating now!
2024-09-28 14:23:08 INFO     Epoch [35/200] train_loss: 4.2041, val_loss: 5.4917, lr: 0.003000, 5.60s
2024-09-28 14:23:13 INFO     epoch complete!
2024-09-28 14:23:13 INFO     evaluating now!
2024-09-28 14:23:14 INFO     Epoch [36/200] train_loss: 4.2315, val_loss: 5.0453, lr: 0.003000, 5.63s
2024-09-28 14:23:14 INFO     Saved model at 36
2024-09-28 14:23:14 INFO     Val loss decrease from 5.1227 to 5.0453, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-09-28 14:23:19 INFO     epoch complete!
2024-09-28 14:23:19 INFO     evaluating now!
2024-09-28 14:23:19 INFO     Epoch [37/200] train_loss: 4.1652, val_loss: 5.0736, lr: 0.003000, 5.53s
2024-09-28 14:23:24 INFO     epoch complete!
2024-09-28 14:23:24 INFO     evaluating now!
2024-09-28 14:23:25 INFO     Epoch [38/200] train_loss: 4.0998, val_loss: 5.0604, lr: 0.003000, 5.56s
2024-09-28 14:23:30 INFO     epoch complete!
2024-09-28 14:23:30 INFO     evaluating now!
2024-09-28 14:23:30 INFO     Epoch [39/200] train_loss: 4.0558, val_loss: 5.0661, lr: 0.003000, 5.53s
2024-09-28 14:23:36 INFO     epoch complete!
2024-09-28 14:23:36 INFO     evaluating now!
2024-09-28 14:23:36 INFO     Epoch [40/200] train_loss: 4.0621, val_loss: 5.0304, lr: 0.003000, 5.71s
2024-09-28 14:23:36 INFO     Saved model at 40
2024-09-28 14:23:36 INFO     Val loss decrease from 5.0453 to 5.0304, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-09-28 14:23:41 INFO     epoch complete!
2024-09-28 14:23:41 INFO     evaluating now!
2024-09-28 14:23:42 INFO     Epoch [41/200] train_loss: 4.0688, val_loss: 5.2072, lr: 0.003000, 5.49s
2024-09-28 14:23:47 INFO     epoch complete!
2024-09-28 14:23:47 INFO     evaluating now!
2024-09-28 14:23:47 INFO     Epoch [42/200] train_loss: 3.9769, val_loss: 5.3550, lr: 0.003000, 5.61s
2024-09-28 14:23:52 INFO     epoch complete!
2024-09-28 14:23:52 INFO     evaluating now!
2024-09-28 14:23:53 INFO     Epoch [43/200] train_loss: 4.0332, val_loss: 5.3378, lr: 0.003000, 5.67s
2024-09-28 14:23:58 INFO     epoch complete!
2024-09-28 14:23:58 INFO     evaluating now!
2024-09-28 14:23:58 INFO     Epoch [44/200] train_loss: 3.9379, val_loss: 5.1561, lr: 0.003000, 5.62s
2024-09-28 14:24:04 INFO     epoch complete!
2024-09-28 14:24:04 INFO     evaluating now!
2024-09-28 14:24:04 INFO     Epoch [45/200] train_loss: 3.9181, val_loss: 4.9323, lr: 0.003000, 5.52s
2024-09-28 14:24:04 INFO     Saved model at 45
2024-09-28 14:24:04 INFO     Val loss decrease from 5.0304 to 4.9323, saving to ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-09-28 14:24:09 INFO     epoch complete!
2024-09-28 14:24:09 INFO     evaluating now!
2024-09-28 14:24:09 INFO     Epoch [46/200] train_loss: 3.9348, val_loss: 5.0477, lr: 0.003000, 5.43s
2024-09-28 14:24:15 INFO     epoch complete!
2024-09-28 14:24:15 INFO     evaluating now!
2024-09-28 14:24:15 INFO     Epoch [47/200] train_loss: 3.8032, val_loss: 4.9380, lr: 0.003000, 5.63s
2024-09-28 14:24:20 INFO     epoch complete!
2024-09-28 14:24:20 INFO     evaluating now!
2024-09-28 14:24:21 INFO     Epoch [48/200] train_loss: 3.7889, val_loss: 5.0163, lr: 0.003000, 5.52s
2024-09-28 14:24:26 INFO     epoch complete!
2024-09-28 14:24:26 INFO     evaluating now!
2024-09-28 14:24:26 INFO     Epoch [49/200] train_loss: 3.8323, val_loss: 5.2302, lr: 0.003000, 5.64s
2024-09-28 14:24:32 INFO     epoch complete!
2024-09-28 14:24:32 INFO     evaluating now!
2024-09-28 14:24:32 INFO     Epoch [50/200] train_loss: 3.8226, val_loss: 5.1065, lr: 0.003000, 5.84s
2024-09-28 14:24:37 INFO     epoch complete!
2024-09-28 14:24:37 INFO     evaluating now!
2024-09-28 14:24:38 INFO     Epoch [51/200] train_loss: 3.7985, val_loss: 5.1940, lr: 0.003000, 5.56s
2024-09-28 14:24:43 INFO     epoch complete!
2024-09-28 14:24:43 INFO     evaluating now!
2024-09-28 14:24:43 INFO     Epoch [52/200] train_loss: 3.7495, val_loss: 5.1339, lr: 0.003000, 5.73s
2024-09-28 14:24:49 INFO     epoch complete!
2024-09-28 14:24:49 INFO     evaluating now!
2024-09-28 14:24:49 INFO     Epoch [53/200] train_loss: 3.7375, val_loss: 5.1745, lr: 0.003000, 5.56s
2024-09-28 14:24:54 INFO     epoch complete!
2024-09-28 14:24:54 INFO     evaluating now!
2024-09-28 14:24:55 INFO     Epoch [54/200] train_loss: 3.7479, val_loss: 5.0348, lr: 0.003000, 5.68s
2024-09-28 14:25:00 INFO     epoch complete!
2024-09-28 14:25:00 INFO     evaluating now!
2024-09-28 14:25:00 INFO     Epoch [55/200] train_loss: 3.6872, val_loss: 5.0021, lr: 0.003000, 5.63s
2024-09-28 14:25:06 INFO     epoch complete!
2024-09-28 14:25:06 INFO     evaluating now!
2024-09-28 14:25:06 INFO     Epoch [56/200] train_loss: 3.6766, val_loss: 5.0755, lr: 0.003000, 5.63s
2024-09-28 14:25:11 INFO     epoch complete!
2024-09-28 14:25:11 INFO     evaluating now!
2024-09-28 14:25:12 INFO     Epoch [57/200] train_loss: 3.6779, val_loss: 5.0234, lr: 0.003000, 5.63s
2024-09-28 14:25:17 INFO     epoch complete!
2024-09-28 14:25:17 INFO     evaluating now!
2024-09-28 14:25:17 INFO     Epoch [58/200] train_loss: 3.6561, val_loss: 5.0486, lr: 0.003000, 5.50s
2024-09-28 14:25:22 INFO     epoch complete!
2024-09-28 14:25:22 INFO     evaluating now!
2024-09-28 14:25:23 INFO     Epoch [59/200] train_loss: 3.6417, val_loss: 5.1164, lr: 0.003000, 5.63s
2024-09-28 14:25:28 INFO     epoch complete!
2024-09-28 14:25:28 INFO     evaluating now!
2024-09-28 14:25:28 INFO     Epoch [60/200] train_loss: 3.6154, val_loss: 5.0509, lr: 0.003000, 5.35s
2024-09-28 14:25:28 WARNING  Early stopping at epoch: 60
2024-09-28 14:25:28 INFO     Trained totally 61 epochs, average train time is 5.231s, average eval time is 0.364s
2024-09-28 14:25:28 INFO     Loaded model at 45
2024-09-28 14:25:28 INFO     Saved model at ./libcity/cache/20/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 14:25:28 INFO     Start evaluating ...
2024-09-28 14:25:30 INFO     Note that you select the single mode to evaluate!
2024-09-28 14:25:30 INFO     Evaluate result is saved at ./libcity/cache/20/evaluate_cache/2024_09_28_14_25_30_AGCRN_CHITaxi20190406.csv
2024-09-28 14:25:30 INFO     
         MAE       RMSE  masked_MAPE
1   2.482494   7.600178     0.453594
2   2.520747   7.895798     0.442530
3   2.671905   8.659124     0.446780
4   2.822195   9.307787     0.443491
5   2.956779  10.258034     0.440702
6   3.107370  11.258940     0.447368
7   3.238362  12.035463     0.459994
8   3.353284  12.647873     0.472124
9   3.455404  12.908292     0.500819
10  3.437191  13.157483     0.474867
11  3.523785  13.352555     0.503418
12  3.687562  13.860400     0.545967
2024-09-28 14:25:30 INFO     ----------------------------------------------------------------------------
2024-09-28 14:25:30 INFO     # 1, Kownledge Graph Embedding: TransE, Experiment ids: 21
2024-09-28 14:25:30 INFO     ----------------------------------------------------------------------------
2024-09-28 14:25:30 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=21
2024-09-28 14:25:30 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 21, 'ke_model': 'TransE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 14:25:30 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 14:25:30 INFO     set_weight_link_or_dist: dist
2024-09-28 14:25:30 INFO     init_weight_inf_or_zero: inf
2024-09-28 14:25:30 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 14:25:30 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 14:25:30 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 14:25:30 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 14:25:33 INFO     Dataset created
2024-09-28 14:25:33 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-28 14:25:33 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-28 14:25:33 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-28 14:25:33 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-28 14:25:33 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 14:25:33 INFO     NoneScaler
2024-09-28 14:25:35 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 14:25:35 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 14:25:35 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-28 14:25:35 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 14:25:35 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-28 14:25:35 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 14:25:35 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 14:25:35 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 14:25:35 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 14:25:35 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 14:25:35 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 14:25:35 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 14:25:35 INFO     Total parameter numbers: 874010
2024-09-28 14:25:35 INFO     You select `adam` optimizer.
2024-09-28 14:25:35 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 14:25:35 INFO     Start training ...
2024-09-28 14:25:35 INFO     num_batches:48
2024-09-28 14:25:40 INFO     epoch complete!
2024-09-28 14:25:40 INFO     evaluating now!
2024-09-28 14:25:41 INFO     Epoch [0/200] train_loss: 25.1245, val_loss: 18.7687, lr: 0.003000, 5.67s
2024-09-28 14:25:41 INFO     Saved model at 0
2024-09-28 14:25:41 INFO     Val loss decrease from inf to 18.7687, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 14:25:46 INFO     epoch complete!
2024-09-28 14:25:46 INFO     evaluating now!
2024-09-28 14:25:46 INFO     Epoch [1/200] train_loss: 15.7314, val_loss: 15.4700, lr: 0.003000, 5.68s
2024-09-28 14:25:46 INFO     Saved model at 1
2024-09-28 14:25:46 INFO     Val loss decrease from 18.7687 to 15.4700, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 14:25:52 INFO     epoch complete!
2024-09-28 14:25:52 INFO     evaluating now!
2024-09-28 14:25:52 INFO     Epoch [2/200] train_loss: 13.3762, val_loss: 13.5850, lr: 0.003000, 5.91s
2024-09-28 14:25:52 INFO     Saved model at 2
2024-09-28 14:25:52 INFO     Val loss decrease from 15.4700 to 13.5850, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 14:25:58 INFO     epoch complete!
2024-09-28 14:25:58 INFO     evaluating now!
2024-09-28 14:25:58 INFO     Epoch [3/200] train_loss: 11.3840, val_loss: 11.0721, lr: 0.003000, 5.90s
2024-09-28 14:25:58 INFO     Saved model at 3
2024-09-28 14:25:58 INFO     Val loss decrease from 13.5850 to 11.0721, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 14:26:04 INFO     epoch complete!
2024-09-28 14:26:04 INFO     evaluating now!
2024-09-28 14:26:04 INFO     Epoch [4/200] train_loss: 9.6299, val_loss: 9.4547, lr: 0.003000, 5.73s
2024-09-28 14:26:04 INFO     Saved model at 4
2024-09-28 14:26:04 INFO     Val loss decrease from 11.0721 to 9.4547, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 14:26:09 INFO     epoch complete!
2024-09-28 14:26:09 INFO     evaluating now!
2024-09-28 14:26:10 INFO     Epoch [5/200] train_loss: 8.5387, val_loss: 8.2122, lr: 0.003000, 5.57s
2024-09-28 14:26:10 INFO     Saved model at 5
2024-09-28 14:26:10 INFO     Val loss decrease from 9.4547 to 8.2122, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 14:26:15 INFO     epoch complete!
2024-09-28 14:26:15 INFO     evaluating now!
2024-09-28 14:26:16 INFO     Epoch [6/200] train_loss: 7.8089, val_loss: 8.6706, lr: 0.003000, 5.96s
2024-09-28 14:26:21 INFO     epoch complete!
2024-09-28 14:26:21 INFO     evaluating now!
2024-09-28 14:26:21 INFO     Epoch [7/200] train_loss: 7.4056, val_loss: 7.2823, lr: 0.003000, 5.67s
2024-09-28 14:26:22 INFO     Saved model at 7
2024-09-28 14:26:22 INFO     Val loss decrease from 8.2122 to 7.2823, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-28 14:26:27 INFO     epoch complete!
2024-09-28 14:26:27 INFO     evaluating now!
2024-09-28 14:26:27 INFO     Epoch [8/200] train_loss: 6.8333, val_loss: 6.7559, lr: 0.003000, 5.76s
2024-09-28 14:26:27 INFO     Saved model at 8
2024-09-28 14:26:27 INFO     Val loss decrease from 7.2823 to 6.7559, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-28 14:26:33 INFO     epoch complete!
2024-09-28 14:26:33 INFO     evaluating now!
2024-09-28 14:26:33 INFO     Epoch [9/200] train_loss: 6.6215, val_loss: 6.9497, lr: 0.003000, 5.61s
2024-09-28 14:26:38 INFO     epoch complete!
2024-09-28 14:26:38 INFO     evaluating now!
2024-09-28 14:26:39 INFO     Epoch [10/200] train_loss: 6.3877, val_loss: 6.4255, lr: 0.003000, 5.74s
2024-09-28 14:26:39 INFO     Saved model at 10
2024-09-28 14:26:39 INFO     Val loss decrease from 6.7559 to 6.4255, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-28 14:26:44 INFO     epoch complete!
2024-09-28 14:26:44 INFO     evaluating now!
2024-09-28 14:26:45 INFO     Epoch [11/200] train_loss: 6.2349, val_loss: 6.3594, lr: 0.003000, 5.78s
2024-09-28 14:26:45 INFO     Saved model at 11
2024-09-28 14:26:45 INFO     Val loss decrease from 6.4255 to 6.3594, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-28 14:26:51 INFO     epoch complete!
2024-09-28 14:26:51 INFO     evaluating now!
2024-09-28 14:26:51 INFO     Epoch [12/200] train_loss: 6.0530, val_loss: 6.3045, lr: 0.003000, 6.00s
2024-09-28 14:26:51 INFO     Saved model at 12
2024-09-28 14:26:51 INFO     Val loss decrease from 6.3594 to 6.3045, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-28 14:26:56 INFO     epoch complete!
2024-09-28 14:26:56 INFO     evaluating now!
2024-09-28 14:26:57 INFO     Epoch [13/200] train_loss: 5.9539, val_loss: 6.0284, lr: 0.003000, 5.70s
2024-09-28 14:26:57 INFO     Saved model at 13
2024-09-28 14:26:57 INFO     Val loss decrease from 6.3045 to 6.0284, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-09-28 14:27:02 INFO     epoch complete!
2024-09-28 14:27:02 INFO     evaluating now!
2024-09-28 14:27:03 INFO     Epoch [14/200] train_loss: 5.7296, val_loss: 5.8543, lr: 0.003000, 5.94s
2024-09-28 14:27:03 INFO     Saved model at 14
2024-09-28 14:27:03 INFO     Val loss decrease from 6.0284 to 5.8543, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-28 14:27:08 INFO     epoch complete!
2024-09-28 14:27:08 INFO     evaluating now!
2024-09-28 14:27:09 INFO     Epoch [15/200] train_loss: 5.6151, val_loss: 5.9653, lr: 0.003000, 5.73s
2024-09-28 14:27:14 INFO     epoch complete!
2024-09-28 14:27:14 INFO     evaluating now!
2024-09-28 14:27:14 INFO     Epoch [16/200] train_loss: 5.6128, val_loss: 5.6500, lr: 0.003000, 5.80s
2024-09-28 14:27:14 INFO     Saved model at 16
2024-09-28 14:27:14 INFO     Val loss decrease from 5.8543 to 5.6500, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-28 14:27:20 INFO     epoch complete!
2024-09-28 14:27:20 INFO     evaluating now!
2024-09-28 14:27:20 INFO     Epoch [17/200] train_loss: 5.4573, val_loss: 5.6752, lr: 0.003000, 6.00s
2024-09-28 14:27:26 INFO     epoch complete!
2024-09-28 14:27:26 INFO     evaluating now!
2024-09-28 14:27:26 INFO     Epoch [18/200] train_loss: 5.3542, val_loss: 5.6169, lr: 0.003000, 5.74s
2024-09-28 14:27:26 INFO     Saved model at 18
2024-09-28 14:27:26 INFO     Val loss decrease from 5.6500 to 5.6169, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-28 14:27:31 INFO     epoch complete!
2024-09-28 14:27:31 INFO     evaluating now!
2024-09-28 14:27:32 INFO     Epoch [19/200] train_loss: 5.3140, val_loss: 5.6515, lr: 0.003000, 5.39s
2024-09-28 14:27:37 INFO     epoch complete!
2024-09-28 14:27:37 INFO     evaluating now!
2024-09-28 14:27:37 INFO     Epoch [20/200] train_loss: 5.3109, val_loss: 5.6049, lr: 0.003000, 5.32s
2024-09-28 14:27:37 INFO     Saved model at 20
2024-09-28 14:27:37 INFO     Val loss decrease from 5.6169 to 5.6049, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-09-28 14:27:42 INFO     epoch complete!
2024-09-28 14:27:42 INFO     evaluating now!
2024-09-28 14:27:42 INFO     Epoch [21/200] train_loss: 5.2543, val_loss: 5.4911, lr: 0.003000, 5.28s
2024-09-28 14:27:42 INFO     Saved model at 21
2024-09-28 14:27:42 INFO     Val loss decrease from 5.6049 to 5.4911, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-28 14:27:47 INFO     epoch complete!
2024-09-28 14:27:47 INFO     evaluating now!
2024-09-28 14:27:48 INFO     Epoch [22/200] train_loss: 5.0932, val_loss: 5.4700, lr: 0.003000, 5.40s
2024-09-28 14:27:55 INFO     Saved model at 22
2024-09-28 14:27:55 INFO     Val loss decrease from 5.4911 to 5.4700, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-09-28 14:28:00 INFO     epoch complete!
2024-09-28 14:28:00 INFO     evaluating now!
2024-09-28 14:28:00 INFO     Epoch [23/200] train_loss: 5.0303, val_loss: 5.2889, lr: 0.003000, 5.05s
2024-09-28 14:28:00 INFO     Saved model at 23
2024-09-28 14:28:00 INFO     Val loss decrease from 5.4700 to 5.2889, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-28 14:28:05 INFO     epoch complete!
2024-09-28 14:28:05 INFO     evaluating now!
2024-09-28 14:28:06 INFO     Epoch [24/200] train_loss: 4.9879, val_loss: 5.4943, lr: 0.003000, 5.15s
2024-09-28 14:28:10 INFO     epoch complete!
2024-09-28 14:28:10 INFO     evaluating now!
2024-09-28 14:28:11 INFO     Epoch [25/200] train_loss: 4.9485, val_loss: 5.3016, lr: 0.003000, 5.02s
2024-09-28 14:28:15 INFO     epoch complete!
2024-09-28 14:28:15 INFO     evaluating now!
2024-09-28 14:28:16 INFO     Epoch [26/200] train_loss: 4.8939, val_loss: 5.3493, lr: 0.003000, 4.96s
2024-09-28 14:28:20 INFO     epoch complete!
2024-09-28 14:28:20 INFO     evaluating now!
2024-09-28 14:28:21 INFO     Epoch [27/200] train_loss: 4.8637, val_loss: 5.4881, lr: 0.003000, 4.90s
2024-09-28 14:28:25 INFO     epoch complete!
2024-09-28 14:28:25 INFO     evaluating now!
2024-09-28 14:28:25 INFO     Epoch [28/200] train_loss: 4.7761, val_loss: 5.2670, lr: 0.003000, 4.94s
2024-09-28 14:28:26 INFO     Saved model at 28
2024-09-28 14:28:26 INFO     Val loss decrease from 5.2889 to 5.2670, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-28 14:28:30 INFO     epoch complete!
2024-09-28 14:28:30 INFO     evaluating now!
2024-09-28 14:28:31 INFO     Epoch [29/200] train_loss: 4.7213, val_loss: 5.2889, lr: 0.003000, 5.01s
2024-09-28 14:28:35 INFO     epoch complete!
2024-09-28 14:28:35 INFO     evaluating now!
2024-09-28 14:28:36 INFO     Epoch [30/200] train_loss: 4.6690, val_loss: 5.2232, lr: 0.003000, 5.07s
2024-09-28 14:28:36 INFO     Saved model at 30
2024-09-28 14:28:36 INFO     Val loss decrease from 5.2670 to 5.2232, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-09-28 14:28:41 INFO     epoch complete!
2024-09-28 14:28:41 INFO     evaluating now!
2024-09-28 14:28:41 INFO     Epoch [31/200] train_loss: 4.6119, val_loss: 5.2372, lr: 0.003000, 5.40s
2024-09-28 14:28:46 INFO     epoch complete!
2024-09-28 14:28:46 INFO     evaluating now!
2024-09-28 14:28:46 INFO     Epoch [32/200] train_loss: 4.5933, val_loss: 5.2241, lr: 0.003000, 5.01s
2024-09-28 14:28:51 INFO     epoch complete!
2024-09-28 14:28:51 INFO     evaluating now!
2024-09-28 14:28:51 INFO     Epoch [33/200] train_loss: 4.5380, val_loss: 5.3465, lr: 0.003000, 5.08s
2024-09-28 14:28:56 INFO     epoch complete!
2024-09-28 14:28:56 INFO     evaluating now!
2024-09-28 14:28:57 INFO     Epoch [34/200] train_loss: 4.5176, val_loss: 5.3739, lr: 0.003000, 5.36s
2024-09-28 14:29:01 INFO     epoch complete!
2024-09-28 14:29:01 INFO     evaluating now!
2024-09-28 14:29:02 INFO     Epoch [35/200] train_loss: 4.5167, val_loss: 5.0659, lr: 0.003000, 5.22s
2024-09-28 14:29:02 INFO     Saved model at 35
2024-09-28 14:29:02 INFO     Val loss decrease from 5.2232 to 5.0659, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-28 14:29:07 INFO     epoch complete!
2024-09-28 14:29:07 INFO     evaluating now!
2024-09-28 14:29:07 INFO     Epoch [36/200] train_loss: 4.4179, val_loss: 5.1555, lr: 0.003000, 5.28s
2024-09-28 14:29:12 INFO     epoch complete!
2024-09-28 14:29:12 INFO     evaluating now!
2024-09-28 14:29:12 INFO     Epoch [37/200] train_loss: 4.3967, val_loss: 5.1686, lr: 0.003000, 5.14s
2024-09-28 14:29:17 INFO     epoch complete!
2024-09-28 14:29:17 INFO     evaluating now!
2024-09-28 14:29:17 INFO     Epoch [38/200] train_loss: 4.3412, val_loss: 5.0940, lr: 0.003000, 5.22s
2024-09-28 14:29:22 INFO     epoch complete!
2024-09-28 14:29:22 INFO     evaluating now!
2024-09-28 14:29:23 INFO     Epoch [39/200] train_loss: 4.3390, val_loss: 5.0593, lr: 0.003000, 5.17s
2024-09-28 14:29:23 INFO     Saved model at 39
2024-09-28 14:29:23 INFO     Val loss decrease from 5.0659 to 5.0593, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-09-28 14:29:27 INFO     epoch complete!
2024-09-28 14:29:27 INFO     evaluating now!
2024-09-28 14:29:28 INFO     Epoch [40/200] train_loss: 4.3014, val_loss: 5.1737, lr: 0.003000, 4.95s
2024-09-28 14:29:32 INFO     epoch complete!
2024-09-28 14:29:32 INFO     evaluating now!
2024-09-28 14:29:33 INFO     Epoch [41/200] train_loss: 4.2520, val_loss: 5.1286, lr: 0.003000, 4.98s
2024-09-28 14:29:37 INFO     epoch complete!
2024-09-28 14:29:37 INFO     evaluating now!
2024-09-28 14:29:38 INFO     Epoch [42/200] train_loss: 4.2963, val_loss: 5.1944, lr: 0.003000, 5.15s
2024-09-28 14:29:43 INFO     epoch complete!
2024-09-28 14:29:43 INFO     evaluating now!
2024-09-28 14:29:43 INFO     Epoch [43/200] train_loss: 4.2682, val_loss: 5.0893, lr: 0.003000, 5.18s
2024-09-28 14:29:48 INFO     epoch complete!
2024-09-28 14:29:48 INFO     evaluating now!
2024-09-28 14:29:48 INFO     Epoch [44/200] train_loss: 4.1877, val_loss: 5.2565, lr: 0.003000, 4.93s
2024-09-28 14:29:52 INFO     epoch complete!
2024-09-28 14:29:52 INFO     evaluating now!
2024-09-28 14:29:53 INFO     Epoch [45/200] train_loss: 4.1566, val_loss: 5.0947, lr: 0.003000, 4.90s
2024-09-28 14:29:57 INFO     epoch complete!
2024-09-28 14:29:57 INFO     evaluating now!
2024-09-28 14:29:58 INFO     Epoch [46/200] train_loss: 4.1448, val_loss: 5.0836, lr: 0.003000, 4.94s
2024-09-28 14:30:02 INFO     epoch complete!
2024-09-28 14:30:02 INFO     evaluating now!
2024-09-28 14:30:03 INFO     Epoch [47/200] train_loss: 4.0990, val_loss: 5.0787, lr: 0.003000, 4.90s
2024-09-28 14:30:07 INFO     epoch complete!
2024-09-28 14:30:07 INFO     evaluating now!
2024-09-28 14:30:08 INFO     Epoch [48/200] train_loss: 4.1142, val_loss: 5.1211, lr: 0.003000, 4.94s
2024-09-28 14:30:13 INFO     epoch complete!
2024-09-28 14:30:13 INFO     evaluating now!
2024-09-28 14:30:13 INFO     Epoch [49/200] train_loss: 4.1045, val_loss: 5.1082, lr: 0.003000, 5.35s
2024-09-28 14:30:18 INFO     epoch complete!
2024-09-28 14:30:18 INFO     evaluating now!
2024-09-28 14:30:18 INFO     Epoch [50/200] train_loss: 4.0266, val_loss: 5.0182, lr: 0.003000, 5.42s
2024-09-28 14:30:18 INFO     Saved model at 50
2024-09-28 14:30:18 INFO     Val loss decrease from 5.0593 to 5.0182, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch50.tar
2024-09-28 14:30:23 INFO     epoch complete!
2024-09-28 14:30:23 INFO     evaluating now!
2024-09-28 14:30:24 INFO     Epoch [51/200] train_loss: 4.0086, val_loss: 5.1660, lr: 0.003000, 5.46s
2024-09-28 14:30:29 INFO     epoch complete!
2024-09-28 14:30:29 INFO     evaluating now!
2024-09-28 14:30:30 INFO     Epoch [52/200] train_loss: 4.0401, val_loss: 4.9977, lr: 0.003000, 5.68s
2024-09-28 14:30:30 INFO     Saved model at 52
2024-09-28 14:30:30 INFO     Val loss decrease from 5.0182 to 4.9977, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch52.tar
2024-09-28 14:30:35 INFO     epoch complete!
2024-09-28 14:30:35 INFO     evaluating now!
2024-09-28 14:30:35 INFO     Epoch [53/200] train_loss: 3.9470, val_loss: 4.9930, lr: 0.003000, 5.46s
2024-09-28 14:30:35 INFO     Saved model at 53
2024-09-28 14:30:35 INFO     Val loss decrease from 4.9977 to 4.9930, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch53.tar
2024-09-28 14:30:40 INFO     epoch complete!
2024-09-28 14:30:40 INFO     evaluating now!
2024-09-28 14:30:41 INFO     Epoch [54/200] train_loss: 3.9253, val_loss: 5.0422, lr: 0.003000, 5.58s
2024-09-28 14:30:46 INFO     epoch complete!
2024-09-28 14:30:46 INFO     evaluating now!
2024-09-28 14:30:46 INFO     Epoch [55/200] train_loss: 3.9799, val_loss: 4.9226, lr: 0.003000, 5.50s
2024-09-28 14:30:46 INFO     Saved model at 55
2024-09-28 14:30:46 INFO     Val loss decrease from 4.9930 to 4.9226, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch55.tar
2024-09-28 14:30:52 INFO     epoch complete!
2024-09-28 14:30:52 INFO     evaluating now!
2024-09-28 14:30:52 INFO     Epoch [56/200] train_loss: 3.9683, val_loss: 4.9570, lr: 0.003000, 5.71s
2024-09-28 14:30:57 INFO     epoch complete!
2024-09-28 14:30:57 INFO     evaluating now!
2024-09-28 14:30:58 INFO     Epoch [57/200] train_loss: 3.8799, val_loss: 5.1014, lr: 0.003000, 5.93s
2024-09-28 14:31:03 INFO     epoch complete!
2024-09-28 14:31:03 INFO     evaluating now!
2024-09-28 14:31:04 INFO     Epoch [58/200] train_loss: 3.9112, val_loss: 4.9574, lr: 0.003000, 5.90s
2024-09-28 14:31:09 INFO     epoch complete!
2024-09-28 14:31:09 INFO     evaluating now!
2024-09-28 14:31:10 INFO     Epoch [59/200] train_loss: 3.9086, val_loss: 5.0291, lr: 0.003000, 5.87s
2024-09-28 14:31:15 INFO     epoch complete!
2024-09-28 14:31:15 INFO     evaluating now!
2024-09-28 14:31:16 INFO     Epoch [60/200] train_loss: 3.8489, val_loss: 4.9489, lr: 0.003000, 5.90s
2024-09-28 14:31:21 INFO     epoch complete!
2024-09-28 14:31:21 INFO     evaluating now!
2024-09-28 14:31:21 INFO     Epoch [61/200] train_loss: 3.8581, val_loss: 4.9889, lr: 0.003000, 5.97s
2024-09-28 14:31:27 INFO     epoch complete!
2024-09-28 14:31:27 INFO     evaluating now!
2024-09-28 14:31:27 INFO     Epoch [62/200] train_loss: 3.8220, val_loss: 5.0284, lr: 0.003000, 5.88s
2024-09-28 14:31:33 INFO     epoch complete!
2024-09-28 14:31:33 INFO     evaluating now!
2024-09-28 14:31:33 INFO     Epoch [63/200] train_loss: 3.7990, val_loss: 4.9241, lr: 0.003000, 6.02s
2024-09-28 14:31:39 INFO     epoch complete!
2024-09-28 14:31:39 INFO     evaluating now!
2024-09-28 14:31:39 INFO     Epoch [64/200] train_loss: 3.7477, val_loss: 5.0470, lr: 0.003000, 5.69s
2024-09-28 14:31:44 INFO     epoch complete!
2024-09-28 14:31:44 INFO     evaluating now!
2024-09-28 14:31:45 INFO     Epoch [65/200] train_loss: 3.7405, val_loss: 5.0281, lr: 0.003000, 5.70s
2024-09-28 14:31:50 INFO     epoch complete!
2024-09-28 14:31:50 INFO     evaluating now!
2024-09-28 14:31:51 INFO     Epoch [66/200] train_loss: 3.7334, val_loss: 5.0883, lr: 0.003000, 6.02s
2024-09-28 14:31:56 INFO     epoch complete!
2024-09-28 14:31:56 INFO     evaluating now!
2024-09-28 14:31:56 INFO     Epoch [67/200] train_loss: 3.7765, val_loss: 5.1103, lr: 0.003000, 5.61s
2024-09-28 14:32:02 INFO     epoch complete!
2024-09-28 14:32:02 INFO     evaluating now!
2024-09-28 14:32:02 INFO     Epoch [68/200] train_loss: 3.7518, val_loss: 4.8561, lr: 0.003000, 5.94s
2024-09-28 14:32:02 INFO     Saved model at 68
2024-09-28 14:32:02 INFO     Val loss decrease from 4.9226 to 4.8561, saving to ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406_epoch68.tar
2024-09-28 14:32:08 INFO     epoch complete!
2024-09-28 14:32:08 INFO     evaluating now!
2024-09-28 14:32:08 INFO     Epoch [69/200] train_loss: 3.7135, val_loss: 4.8886, lr: 0.003000, 5.70s
2024-09-28 14:32:14 INFO     epoch complete!
2024-09-28 14:32:14 INFO     evaluating now!
2024-09-28 14:32:14 INFO     Epoch [70/200] train_loss: 3.7020, val_loss: 4.9874, lr: 0.003000, 5.83s
2024-09-28 14:32:19 INFO     epoch complete!
2024-09-28 14:32:19 INFO     evaluating now!
2024-09-28 14:32:20 INFO     Epoch [71/200] train_loss: 3.6808, val_loss: 5.0523, lr: 0.003000, 5.61s
2024-09-28 14:32:25 INFO     epoch complete!
2024-09-28 14:32:25 INFO     evaluating now!
2024-09-28 14:32:25 INFO     Epoch [72/200] train_loss: 3.6759, val_loss: 5.0089, lr: 0.003000, 5.58s
2024-09-28 14:32:30 INFO     epoch complete!
2024-09-28 14:32:30 INFO     evaluating now!
2024-09-28 14:32:31 INFO     Epoch [73/200] train_loss: 3.6478, val_loss: 4.9232, lr: 0.003000, 5.60s
2024-09-28 14:32:36 INFO     epoch complete!
2024-09-28 14:32:36 INFO     evaluating now!
2024-09-28 14:32:36 INFO     Epoch [74/200] train_loss: 3.6435, val_loss: 5.0126, lr: 0.003000, 5.78s
2024-09-28 14:32:42 INFO     epoch complete!
2024-09-28 14:32:42 INFO     evaluating now!
2024-09-28 14:32:42 INFO     Epoch [75/200] train_loss: 3.6176, val_loss: 5.0109, lr: 0.003000, 5.49s
2024-09-28 14:32:47 INFO     epoch complete!
2024-09-28 14:32:47 INFO     evaluating now!
2024-09-28 14:32:47 INFO     Epoch [76/200] train_loss: 3.6228, val_loss: 4.9098, lr: 0.003000, 5.50s
2024-09-28 14:32:53 INFO     epoch complete!
2024-09-28 14:32:53 INFO     evaluating now!
2024-09-28 14:32:53 INFO     Epoch [77/200] train_loss: 3.5786, val_loss: 4.9273, lr: 0.003000, 5.69s
2024-09-28 14:32:58 INFO     epoch complete!
2024-09-28 14:32:58 INFO     evaluating now!
2024-09-28 14:32:59 INFO     Epoch [78/200] train_loss: 3.5784, val_loss: 5.0484, lr: 0.003000, 5.58s
2024-09-28 14:33:04 INFO     epoch complete!
2024-09-28 14:33:04 INFO     evaluating now!
2024-09-28 14:33:04 INFO     Epoch [79/200] train_loss: 3.5949, val_loss: 4.9967, lr: 0.003000, 5.48s
2024-09-28 14:33:09 INFO     epoch complete!
2024-09-28 14:33:09 INFO     evaluating now!
2024-09-28 14:33:10 INFO     Epoch [80/200] train_loss: 3.5258, val_loss: 5.0080, lr: 0.003000, 5.43s
2024-09-28 14:33:15 INFO     epoch complete!
2024-09-28 14:33:15 INFO     evaluating now!
2024-09-28 14:33:15 INFO     Epoch [81/200] train_loss: 3.5070, val_loss: 5.0328, lr: 0.003000, 5.52s
2024-09-28 14:33:20 INFO     epoch complete!
2024-09-28 14:33:20 INFO     evaluating now!
2024-09-28 14:33:21 INFO     Epoch [82/200] train_loss: 3.5401, val_loss: 4.9437, lr: 0.003000, 5.50s
2024-09-28 14:33:26 INFO     epoch complete!
2024-09-28 14:33:26 INFO     evaluating now!
2024-09-28 14:33:26 INFO     Epoch [83/200] train_loss: 3.5045, val_loss: 4.8952, lr: 0.003000, 5.49s
2024-09-28 14:33:26 WARNING  Early stopping at epoch: 83
2024-09-28 14:33:26 INFO     Trained totally 84 epochs, average train time is 5.131s, average eval time is 0.362s
2024-09-28 14:33:26 INFO     Loaded model at 68
2024-09-28 14:33:26 INFO     Saved model at ./libcity/cache/21/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 14:33:26 INFO     Start evaluating ...
2024-09-28 14:33:28 INFO     Note that you select the single mode to evaluate!
2024-09-28 14:33:28 INFO     Evaluate result is saved at ./libcity/cache/21/evaluate_cache/2024_09_28_14_33_28_AGCRN_CHITaxi20190406.csv
2024-09-28 14:33:28 INFO     
         MAE       RMSE  masked_MAPE
1   2.419977   7.501163     0.445625
2   2.609751   8.172830     0.456899
3   2.711080   8.995852     0.440680
4   2.815705   9.620200     0.435288
5   2.859941  10.205202     0.421092
6   2.992641  11.004107     0.429223
7   3.127562  11.862690     0.435999
8   3.197444  12.625519     0.444447
9   3.260905  12.956035     0.460987
10  3.258013  12.981775     0.455527
11  3.270208  12.965963     0.464725
12  3.300822  13.096955     0.472395
2024-09-28 14:33:28 INFO     ----------------------------------------------------------------------------
2024-09-28 14:33:28 INFO     # 2, Kownledge Graph Embedding: TransE, Experiment ids: 22
2024-09-28 14:33:28 INFO     ----------------------------------------------------------------------------
2024-09-28 14:33:28 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=22
2024-09-28 14:33:28 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 22, 'ke_model': 'TransE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 14:33:28 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 14:33:28 INFO     set_weight_link_or_dist: dist
2024-09-28 14:33:28 INFO     init_weight_inf_or_zero: inf
2024-09-28 14:33:28 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 14:33:28 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 14:33:28 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 14:33:28 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 14:33:31 INFO     Dataset created
2024-09-28 14:33:31 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-28 14:33:31 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-28 14:33:31 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-28 14:33:31 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-28 14:33:31 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 14:33:31 INFO     NoneScaler
2024-09-28 14:33:33 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 14:33:33 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 14:33:33 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-28 14:33:33 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 14:33:33 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-28 14:33:33 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 14:33:33 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 14:33:33 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 14:33:33 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 14:33:33 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 14:33:33 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 14:33:33 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 14:33:33 INFO     Total parameter numbers: 874010
2024-09-28 14:33:33 INFO     You select `adam` optimizer.
2024-09-28 14:33:33 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 14:33:33 INFO     Start training ...
2024-09-28 14:33:33 INFO     num_batches:48
2024-09-28 14:33:38 INFO     epoch complete!
2024-09-28 14:33:38 INFO     evaluating now!
2024-09-28 14:33:39 INFO     Epoch [0/200] train_loss: 23.8628, val_loss: 18.9018, lr: 0.003000, 5.56s
2024-09-28 14:33:39 INFO     Saved model at 0
2024-09-28 14:33:39 INFO     Val loss decrease from inf to 18.9018, saving to ./libcity/cache/22/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 14:33:44 INFO     epoch complete!
2024-09-28 14:33:44 INFO     evaluating now!
2024-09-28 14:33:44 INFO     Epoch [1/200] train_loss: 15.6510, val_loss: 15.2478, lr: 0.003000, 5.56s
2024-09-28 14:33:44 INFO     Saved model at 1
2024-09-28 14:33:44 INFO     Val loss decrease from 18.9018 to 15.2478, saving to ./libcity/cache/22/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 14:33:49 INFO     epoch complete!
2024-09-28 14:33:49 INFO     evaluating now!
2024-09-28 14:33:50 INFO     Epoch [2/200] train_loss: 12.6928, val_loss: 12.4119, lr: 0.003000, 5.56s
2024-09-28 14:33:50 INFO     Saved model at 2
2024-09-28 14:33:50 INFO     Val loss decrease from 15.2478 to 12.4119, saving to ./libcity/cache/22/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 14:33:55 INFO     epoch complete!
2024-09-28 14:33:55 INFO     evaluating now!
2024-09-28 14:33:55 INFO     Epoch [3/200] train_loss: 10.4764, val_loss: 10.1091, lr: 0.003000, 5.22s
2024-09-28 14:33:55 INFO     Saved model at 3
2024-09-28 14:33:55 INFO     Val loss decrease from 12.4119 to 10.1091, saving to ./libcity/cache/22/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 14:34:00 INFO     epoch complete!
2024-09-28 14:34:00 INFO     evaluating now!
2024-09-28 14:34:00 INFO     Epoch [4/200] train_loss: 8.7843, val_loss: 8.4329, lr: 0.003000, 5.17s
2024-09-28 14:34:00 INFO     Saved model at 4
2024-09-28 14:34:00 INFO     Val loss decrease from 10.1091 to 8.4329, saving to ./libcity/cache/22/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 14:34:05 INFO     epoch complete!
2024-09-28 14:34:05 INFO     evaluating now!
2024-09-28 14:34:05 INFO     Epoch [5/200] train_loss: 7.6766, val_loss: 7.5121, lr: 0.003000, 4.95s
2024-09-28 14:34:05 INFO     Saved model at 5
2024-09-28 14:34:05 INFO     Val loss decrease from 8.4329 to 7.5121, saving to ./libcity/cache/22/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 14:34:10 INFO     epoch complete!
2024-09-28 14:34:10 INFO     evaluating now!
2024-09-28 14:34:11 INFO     Epoch [6/200] train_loss: 7.0279, val_loss: 6.8996, lr: 0.003000, 5.30s
2024-09-28 14:34:11 INFO     Saved model at 6
2024-09-28 14:34:11 INFO     Val loss decrease from 7.5121 to 6.8996, saving to ./libcity/cache/22/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-28 14:34:15 INFO     epoch complete!
2024-09-28 14:34:15 INFO     evaluating now!
2024-09-28 14:34:16 INFO     Epoch [7/200] train_loss: 6.6340, val_loss: 6.9316, lr: 0.003000, 5.16s
2024-09-28 14:34:21 INFO     epoch complete!
2024-09-28 14:34:21 INFO     evaluating now!
2024-09-28 14:34:22 INFO     Epoch [8/200] train_loss: 6.4371, val_loss: 7.1351, lr: 0.003000, 5.66s
2024-09-28 14:34:27 INFO     epoch complete!
2024-09-28 14:34:27 INFO     evaluating now!
2024-09-28 14:34:27 INFO     Epoch [9/200] train_loss: 6.1138, val_loss: 6.2279, lr: 0.003000, 5.66s
2024-09-28 14:34:27 INFO     Saved model at 9
2024-09-28 14:34:27 INFO     Val loss decrease from 6.8996 to 6.2279, saving to ./libcity/cache/22/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-28 14:34:33 INFO     epoch complete!
2024-09-28 14:34:33 INFO     evaluating now!
2024-09-28 14:34:33 INFO     Epoch [10/200] train_loss: 5.9024, val_loss: 6.0047, lr: 0.003000, 5.67s
2024-09-28 14:34:33 INFO     Saved model at 10
2024-09-28 14:34:33 INFO     Val loss decrease from 6.2279 to 6.0047, saving to ./libcity/cache/22/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-28 14:34:38 INFO     epoch complete!
2024-09-28 14:34:38 INFO     evaluating now!
2024-09-28 14:34:39 INFO     Epoch [11/200] train_loss: 5.6717, val_loss: 5.8962, lr: 0.003000, 5.63s
2024-09-28 14:34:39 INFO     Saved model at 11
2024-09-28 14:34:39 INFO     Val loss decrease from 6.0047 to 5.8962, saving to ./libcity/cache/22/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-28 14:34:44 INFO     epoch complete!
2024-09-28 14:34:44 INFO     evaluating now!
2024-09-28 14:34:44 INFO     Epoch [12/200] train_loss: 5.6203, val_loss: 5.9608, lr: 0.003000, 5.76s
2024-09-28 14:34:50 INFO     epoch complete!
2024-09-28 14:34:50 INFO     evaluating now!
2024-09-28 14:34:50 INFO     Epoch [13/200] train_loss: 5.4571, val_loss: 6.0152, lr: 0.003000, 5.53s
2024-09-28 14:34:55 INFO     epoch complete!
2024-09-28 14:34:55 INFO     evaluating now!
2024-09-28 14:34:56 INFO     Epoch [14/200] train_loss: 5.3288, val_loss: 5.6114, lr: 0.003000, 5.63s
2024-09-28 14:34:56 INFO     Saved model at 14
2024-09-28 14:34:56 INFO     Val loss decrease from 5.8962 to 5.6114, saving to ./libcity/cache/22/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-28 14:35:01 INFO     epoch complete!
2024-09-28 14:35:01 INFO     evaluating now!
2024-09-28 14:35:01 INFO     Epoch [15/200] train_loss: 5.2437, val_loss: 5.6413, lr: 0.003000, 5.61s
2024-09-28 14:35:07 INFO     epoch complete!
2024-09-28 14:35:07 INFO     evaluating now!
2024-09-28 14:35:07 INFO     Epoch [16/200] train_loss: 5.2102, val_loss: 5.7919, lr: 0.003000, 5.59s
2024-09-28 14:35:12 INFO     epoch complete!
2024-09-28 14:35:12 INFO     evaluating now!
2024-09-28 14:35:13 INFO     Epoch [17/200] train_loss: 5.1611, val_loss: 5.7022, lr: 0.003000, 5.71s
2024-09-28 14:35:18 INFO     epoch complete!
2024-09-28 14:35:18 INFO     evaluating now!
2024-09-28 14:35:18 INFO     Epoch [18/200] train_loss: 5.1022, val_loss: 5.3621, lr: 0.003000, 5.74s
2024-09-28 14:35:18 INFO     Saved model at 18
2024-09-28 14:35:18 INFO     Val loss decrease from 5.6114 to 5.3621, saving to ./libcity/cache/22/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-28 14:35:24 INFO     epoch complete!
2024-09-28 14:35:24 INFO     evaluating now!
2024-09-28 14:35:24 INFO     Epoch [19/200] train_loss: 4.9380, val_loss: 5.5534, lr: 0.003000, 5.90s
2024-09-28 14:35:29 INFO     epoch complete!
2024-09-28 14:35:29 INFO     evaluating now!
2024-09-28 14:35:30 INFO     Epoch [20/200] train_loss: 4.8702, val_loss: 5.4889, lr: 0.003000, 5.45s
2024-09-28 14:35:35 INFO     epoch complete!
2024-09-28 14:35:35 INFO     evaluating now!
2024-09-28 14:35:35 INFO     Epoch [21/200] train_loss: 4.7859, val_loss: 5.3863, lr: 0.003000, 5.58s
2024-09-28 14:35:41 INFO     epoch complete!
2024-09-28 14:35:41 INFO     evaluating now!
2024-09-28 14:35:41 INFO     Epoch [22/200] train_loss: 4.8859, val_loss: 5.5975, lr: 0.003000, 5.65s
2024-09-28 14:35:46 INFO     epoch complete!
2024-09-28 14:35:46 INFO     evaluating now!
2024-09-28 14:35:47 INFO     Epoch [23/200] train_loss: 4.7040, val_loss: 5.4869, lr: 0.003000, 5.80s
2024-09-28 14:35:52 INFO     epoch complete!
2024-09-28 14:35:52 INFO     evaluating now!
2024-09-28 14:35:52 INFO     Epoch [24/200] train_loss: 4.6301, val_loss: 5.3835, lr: 0.003000, 5.64s
2024-09-28 14:35:58 INFO     epoch complete!
2024-09-28 14:35:58 INFO     evaluating now!
2024-09-28 14:35:58 INFO     Epoch [25/200] train_loss: 4.5902, val_loss: 5.2304, lr: 0.003000, 5.87s
2024-09-28 14:35:58 INFO     Saved model at 25
2024-09-28 14:35:58 INFO     Val loss decrease from 5.3621 to 5.2304, saving to ./libcity/cache/22/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-28 14:36:04 INFO     epoch complete!
2024-09-28 14:36:04 INFO     evaluating now!
2024-09-28 14:36:04 INFO     Epoch [26/200] train_loss: 4.5949, val_loss: 5.5284, lr: 0.003000, 5.93s
2024-09-28 14:36:10 INFO     epoch complete!
2024-09-28 14:36:10 INFO     evaluating now!
2024-09-28 14:36:10 INFO     Epoch [27/200] train_loss: 4.5742, val_loss: 5.2635, lr: 0.003000, 5.78s
2024-09-28 14:36:16 INFO     epoch complete!
2024-09-28 14:36:16 INFO     evaluating now!
2024-09-28 14:36:16 INFO     Epoch [28/200] train_loss: 4.4658, val_loss: 5.2407, lr: 0.003000, 5.86s
2024-09-28 14:36:21 INFO     epoch complete!
2024-09-28 14:36:21 INFO     evaluating now!
2024-09-28 14:36:22 INFO     Epoch [29/200] train_loss: 4.4344, val_loss: 5.3614, lr: 0.003000, 5.58s
2024-09-28 14:36:27 INFO     epoch complete!
2024-09-28 14:36:27 INFO     evaluating now!
2024-09-28 14:36:27 INFO     Epoch [30/200] train_loss: 4.3741, val_loss: 5.3421, lr: 0.003000, 5.63s
2024-09-28 14:36:33 INFO     epoch complete!
2024-09-28 14:36:33 INFO     evaluating now!
2024-09-28 14:36:33 INFO     Epoch [31/200] train_loss: 4.3250, val_loss: 5.2535, lr: 0.003000, 5.72s
2024-09-28 14:36:38 INFO     epoch complete!
2024-09-28 14:36:38 INFO     evaluating now!
2024-09-28 14:36:39 INFO     Epoch [32/200] train_loss: 4.2936, val_loss: 5.2963, lr: 0.003000, 5.87s
2024-09-28 14:36:44 INFO     epoch complete!
2024-09-28 14:36:44 INFO     evaluating now!
2024-09-28 14:36:45 INFO     Epoch [33/200] train_loss: 4.3603, val_loss: 5.2343, lr: 0.003000, 5.89s
2024-09-28 14:36:50 INFO     epoch complete!
2024-09-28 14:36:50 INFO     evaluating now!
2024-09-28 14:36:50 INFO     Epoch [34/200] train_loss: 4.3863, val_loss: 5.2869, lr: 0.003000, 5.73s
2024-09-28 14:36:56 INFO     epoch complete!
2024-09-28 14:36:56 INFO     evaluating now!
2024-09-28 14:36:56 INFO     Epoch [35/200] train_loss: 4.2597, val_loss: 5.0675, lr: 0.003000, 5.85s
2024-09-28 14:36:56 INFO     Saved model at 35
2024-09-28 14:36:56 INFO     Val loss decrease from 5.2304 to 5.0675, saving to ./libcity/cache/22/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-09-28 14:37:02 INFO     epoch complete!
2024-09-28 14:37:02 INFO     evaluating now!
2024-09-28 14:37:02 INFO     Epoch [36/200] train_loss: 4.1225, val_loss: 5.2436, lr: 0.003000, 5.71s
2024-09-28 14:37:07 INFO     epoch complete!
2024-09-28 14:37:07 INFO     evaluating now!
2024-09-28 14:37:08 INFO     Epoch [37/200] train_loss: 4.1063, val_loss: 5.2055, lr: 0.003000, 5.56s
2024-09-28 14:37:13 INFO     epoch complete!
2024-09-28 14:37:13 INFO     evaluating now!
2024-09-28 14:37:13 INFO     Epoch [38/200] train_loss: 4.1118, val_loss: 5.3079, lr: 0.003000, 5.73s
2024-09-28 14:37:18 INFO     epoch complete!
2024-09-28 14:37:18 INFO     evaluating now!
2024-09-28 14:37:19 INFO     Epoch [39/200] train_loss: 4.0789, val_loss: 5.1524, lr: 0.003000, 5.53s
2024-09-28 14:37:24 INFO     epoch complete!
2024-09-28 14:37:24 INFO     evaluating now!
2024-09-28 14:37:24 INFO     Epoch [40/200] train_loss: 4.0773, val_loss: 5.2269, lr: 0.003000, 5.66s
2024-09-28 14:37:30 INFO     epoch complete!
2024-09-28 14:37:30 INFO     evaluating now!
2024-09-28 14:37:30 INFO     Epoch [41/200] train_loss: 4.0627, val_loss: 5.0474, lr: 0.003000, 5.79s
2024-09-28 14:37:30 INFO     Saved model at 41
2024-09-28 14:37:30 INFO     Val loss decrease from 5.0675 to 5.0474, saving to ./libcity/cache/22/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-09-28 14:37:36 INFO     epoch complete!
2024-09-28 14:37:36 INFO     evaluating now!
2024-09-28 14:37:36 INFO     Epoch [42/200] train_loss: 4.0058, val_loss: 5.0528, lr: 0.003000, 5.88s
2024-09-28 14:37:42 INFO     epoch complete!
2024-09-28 14:37:42 INFO     evaluating now!
2024-09-28 14:37:42 INFO     Epoch [43/200] train_loss: 3.9757, val_loss: 5.1958, lr: 0.003000, 5.70s
2024-09-28 14:37:47 INFO     epoch complete!
2024-09-28 14:37:47 INFO     evaluating now!
2024-09-28 14:37:48 INFO     Epoch [44/200] train_loss: 3.9321, val_loss: 5.1737, lr: 0.003000, 5.65s
2024-09-28 14:37:53 INFO     epoch complete!
2024-09-28 14:37:53 INFO     evaluating now!
2024-09-28 14:37:53 INFO     Epoch [45/200] train_loss: 3.9352, val_loss: 5.0744, lr: 0.003000, 5.81s
2024-09-28 14:37:59 INFO     epoch complete!
2024-09-28 14:37:59 INFO     evaluating now!
2024-09-28 14:37:59 INFO     Epoch [46/200] train_loss: 3.8957, val_loss: 5.1569, lr: 0.003000, 5.69s
2024-09-28 14:38:05 INFO     epoch complete!
2024-09-28 14:38:05 INFO     evaluating now!
2024-09-28 14:38:05 INFO     Epoch [47/200] train_loss: 3.9651, val_loss: 5.0995, lr: 0.003000, 6.05s
2024-09-28 14:38:10 INFO     epoch complete!
2024-09-28 14:38:10 INFO     evaluating now!
2024-09-28 14:38:11 INFO     Epoch [48/200] train_loss: 3.8981, val_loss: 5.2621, lr: 0.003000, 5.50s
2024-09-28 14:38:16 INFO     epoch complete!
2024-09-28 14:38:16 INFO     evaluating now!
2024-09-28 14:38:16 INFO     Epoch [49/200] train_loss: 3.8569, val_loss: 5.1950, lr: 0.003000, 5.72s
2024-09-28 14:38:22 INFO     epoch complete!
2024-09-28 14:38:22 INFO     evaluating now!
2024-09-28 14:38:22 INFO     Epoch [50/200] train_loss: 3.9047, val_loss: 5.3002, lr: 0.003000, 5.75s
2024-09-28 14:38:27 INFO     epoch complete!
2024-09-28 14:38:27 INFO     evaluating now!
2024-09-28 14:38:28 INFO     Epoch [51/200] train_loss: 3.7938, val_loss: 5.2564, lr: 0.003000, 5.76s
2024-09-28 14:38:33 INFO     epoch complete!
2024-09-28 14:38:33 INFO     evaluating now!
2024-09-28 14:38:33 INFO     Epoch [52/200] train_loss: 3.7758, val_loss: 5.1018, lr: 0.003000, 5.62s
2024-09-28 14:38:39 INFO     epoch complete!
2024-09-28 14:38:39 INFO     evaluating now!
2024-09-28 14:38:39 INFO     Epoch [53/200] train_loss: 3.7681, val_loss: 5.1388, lr: 0.003000, 5.98s
2024-09-28 14:38:45 INFO     epoch complete!
2024-09-28 14:38:45 INFO     evaluating now!
2024-09-28 14:38:45 INFO     Epoch [54/200] train_loss: 3.7876, val_loss: 5.0103, lr: 0.003000, 5.80s
2024-09-28 14:38:45 INFO     Saved model at 54
2024-09-28 14:38:45 INFO     Val loss decrease from 5.0474 to 5.0103, saving to ./libcity/cache/22/model_cache/AGCRN_CHITaxi20190406_epoch54.tar
2024-09-28 14:38:51 INFO     epoch complete!
2024-09-28 14:38:51 INFO     evaluating now!
2024-09-28 14:38:51 INFO     Epoch [55/200] train_loss: 3.7642, val_loss: 5.1118, lr: 0.003000, 5.78s
2024-09-28 14:38:56 INFO     epoch complete!
2024-09-28 14:38:56 INFO     evaluating now!
2024-09-28 14:38:57 INFO     Epoch [56/200] train_loss: 3.7261, val_loss: 5.1400, lr: 0.003000, 5.66s
2024-09-28 14:39:02 INFO     epoch complete!
2024-09-28 14:39:02 INFO     evaluating now!
2024-09-28 14:39:02 INFO     Epoch [57/200] train_loss: 3.7267, val_loss: 5.1671, lr: 0.003000, 5.61s
2024-09-28 14:39:08 INFO     epoch complete!
2024-09-28 14:39:08 INFO     evaluating now!
2024-09-28 14:39:08 INFO     Epoch [58/200] train_loss: 3.6869, val_loss: 5.1220, lr: 0.003000, 6.03s
2024-09-28 14:39:14 INFO     epoch complete!
2024-09-28 14:39:14 INFO     evaluating now!
2024-09-28 14:39:14 INFO     Epoch [59/200] train_loss: 3.6687, val_loss: 5.1360, lr: 0.003000, 5.82s
2024-09-28 14:39:20 INFO     epoch complete!
2024-09-28 14:39:20 INFO     evaluating now!
2024-09-28 14:39:20 INFO     Epoch [60/200] train_loss: 3.6439, val_loss: 5.0788, lr: 0.003000, 5.94s
2024-09-28 14:39:26 INFO     epoch complete!
2024-09-28 14:39:26 INFO     evaluating now!
2024-09-28 14:39:26 INFO     Epoch [61/200] train_loss: 3.6362, val_loss: 5.0593, lr: 0.003000, 5.73s
2024-09-28 14:39:31 INFO     epoch complete!
2024-09-28 14:39:31 INFO     evaluating now!
2024-09-28 14:39:32 INFO     Epoch [62/200] train_loss: 3.6043, val_loss: 5.2086, lr: 0.003000, 5.97s
2024-09-28 14:39:37 INFO     epoch complete!
2024-09-28 14:39:37 INFO     evaluating now!
2024-09-28 14:39:38 INFO     Epoch [63/200] train_loss: 3.6524, val_loss: 5.2744, lr: 0.003000, 5.68s
2024-09-28 14:39:43 INFO     epoch complete!
2024-09-28 14:39:43 INFO     evaluating now!
2024-09-28 14:39:43 INFO     Epoch [64/200] train_loss: 3.5975, val_loss: 5.0861, lr: 0.003000, 5.67s
2024-09-28 14:39:49 INFO     epoch complete!
2024-09-28 14:39:49 INFO     evaluating now!
2024-09-28 14:39:49 INFO     Epoch [65/200] train_loss: 3.5334, val_loss: 5.2448, lr: 0.003000, 5.83s
2024-09-28 14:39:54 INFO     epoch complete!
2024-09-28 14:39:54 INFO     evaluating now!
2024-09-28 14:39:55 INFO     Epoch [66/200] train_loss: 3.6380, val_loss: 5.1984, lr: 0.003000, 5.84s
2024-09-28 14:40:00 INFO     epoch complete!
2024-09-28 14:40:00 INFO     evaluating now!
2024-09-28 14:40:01 INFO     Epoch [67/200] train_loss: 3.5629, val_loss: 5.0823, lr: 0.003000, 5.86s
2024-09-28 14:40:06 INFO     epoch complete!
2024-09-28 14:40:06 INFO     evaluating now!
2024-09-28 14:40:06 INFO     Epoch [68/200] train_loss: 3.5295, val_loss: 5.0596, lr: 0.003000, 5.63s
2024-09-28 14:40:12 INFO     epoch complete!
2024-09-28 14:40:12 INFO     evaluating now!
2024-09-28 14:40:12 INFO     Epoch [69/200] train_loss: 3.5420, val_loss: 5.1567, lr: 0.003000, 5.86s
2024-09-28 14:40:12 WARNING  Early stopping at epoch: 69
2024-09-28 14:40:12 INFO     Trained totally 70 epochs, average train time is 5.321s, average eval time is 0.366s
2024-09-28 14:40:12 INFO     Loaded model at 54
2024-09-28 14:40:12 INFO     Saved model at ./libcity/cache/22/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 14:40:12 INFO     Start evaluating ...
2024-09-28 14:40:14 INFO     Note that you select the single mode to evaluate!
2024-09-28 14:40:14 INFO     Evaluate result is saved at ./libcity/cache/22/evaluate_cache/2024_09_28_14_40_14_AGCRN_CHITaxi20190406.csv
2024-09-28 14:40:14 INFO     
         MAE       RMSE  masked_MAPE
1   2.368998   6.788997     0.439253
2   2.542581   7.500872     0.463434
3   2.709476   8.660526     0.459083
4   2.911624   9.589651     0.471658
5   3.052716  10.474810     0.468318
6   3.153435  11.075607     0.474361
7   3.285482  11.711466     0.493677
8   3.292701  12.101035     0.486153
9   3.362014  12.545248     0.500704
10  3.425413  12.911434     0.517193
11  3.338930  13.170897     0.486475
12  3.466464  13.709760     0.508468
2024-09-28 14:40:14 INFO     ----------------------------------------------------------------------------
2024-09-28 14:40:14 INFO     # 3, Kownledge Graph Embedding: TransE, Experiment ids: 23
2024-09-28 14:40:14 INFO     ----------------------------------------------------------------------------
2024-09-28 14:40:14 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=23
2024-09-28 14:40:14 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 23, 'ke_model': 'TransE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 14:40:14 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 14:40:14 INFO     set_weight_link_or_dist: dist
2024-09-28 14:40:14 INFO     init_weight_inf_or_zero: inf
2024-09-28 14:40:14 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 14:40:14 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 14:40:14 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 14:40:14 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 14:40:17 INFO     Dataset created
2024-09-28 14:40:17 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-28 14:40:17 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-28 14:40:17 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-28 14:40:17 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-28 14:40:17 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 14:40:17 INFO     NoneScaler
2024-09-28 14:40:19 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 14:40:19 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 14:40:19 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-28 14:40:19 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 14:40:19 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-28 14:40:19 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 14:40:19 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 14:40:19 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 14:40:19 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 14:40:19 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 14:40:19 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 14:40:19 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 14:40:19 INFO     Total parameter numbers: 874010
2024-09-28 14:40:19 INFO     You select `adam` optimizer.
2024-09-28 14:40:19 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 14:40:19 INFO     Start training ...
2024-09-28 14:40:19 INFO     num_batches:48
2024-09-28 14:40:25 INFO     epoch complete!
2024-09-28 14:40:25 INFO     evaluating now!
2024-09-28 14:40:25 INFO     Epoch [0/200] train_loss: 24.2363, val_loss: 18.7331, lr: 0.003000, 5.98s
2024-09-28 14:40:25 INFO     Saved model at 0
2024-09-28 14:40:25 INFO     Val loss decrease from inf to 18.7331, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 14:40:31 INFO     epoch complete!
2024-09-28 14:40:31 INFO     evaluating now!
2024-09-28 14:40:31 INFO     Epoch [1/200] train_loss: 15.2249, val_loss: 14.6666, lr: 0.003000, 5.83s
2024-09-28 14:40:31 INFO     Saved model at 1
2024-09-28 14:40:31 INFO     Val loss decrease from 18.7331 to 14.6666, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 14:40:37 INFO     epoch complete!
2024-09-28 14:40:37 INFO     evaluating now!
2024-09-28 14:40:37 INFO     Epoch [2/200] train_loss: 12.8369, val_loss: 12.7081, lr: 0.003000, 5.71s
2024-09-28 14:40:37 INFO     Saved model at 2
2024-09-28 14:40:37 INFO     Val loss decrease from 14.6666 to 12.7081, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 14:40:42 INFO     epoch complete!
2024-09-28 14:40:42 INFO     evaluating now!
2024-09-28 14:40:43 INFO     Epoch [3/200] train_loss: 11.3358, val_loss: 11.3300, lr: 0.003000, 5.75s
2024-09-28 14:40:43 INFO     Saved model at 3
2024-09-28 14:40:43 INFO     Val loss decrease from 12.7081 to 11.3300, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 14:40:48 INFO     epoch complete!
2024-09-28 14:40:48 INFO     evaluating now!
2024-09-28 14:40:49 INFO     Epoch [4/200] train_loss: 9.4513, val_loss: 9.1544, lr: 0.003000, 5.68s
2024-09-28 14:40:49 INFO     Saved model at 4
2024-09-28 14:40:49 INFO     Val loss decrease from 11.3300 to 9.1544, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 14:40:54 INFO     epoch complete!
2024-09-28 14:40:54 INFO     evaluating now!
2024-09-28 14:40:55 INFO     Epoch [5/200] train_loss: 8.1411, val_loss: 7.6780, lr: 0.003000, 6.07s
2024-09-28 14:40:55 INFO     Saved model at 5
2024-09-28 14:40:55 INFO     Val loss decrease from 9.1544 to 7.6780, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 14:41:00 INFO     epoch complete!
2024-09-28 14:41:00 INFO     evaluating now!
2024-09-28 14:41:01 INFO     Epoch [6/200] train_loss: 7.3100, val_loss: 7.1794, lr: 0.003000, 5.83s
2024-09-28 14:41:01 INFO     Saved model at 6
2024-09-28 14:41:01 INFO     Val loss decrease from 7.6780 to 7.1794, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-28 14:41:06 INFO     epoch complete!
2024-09-28 14:41:06 INFO     evaluating now!
2024-09-28 14:41:07 INFO     Epoch [7/200] train_loss: 6.7732, val_loss: 7.1352, lr: 0.003000, 5.94s
2024-09-28 14:41:07 INFO     Saved model at 7
2024-09-28 14:41:07 INFO     Val loss decrease from 7.1794 to 7.1352, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-09-28 14:41:12 INFO     epoch complete!
2024-09-28 14:41:12 INFO     evaluating now!
2024-09-28 14:41:13 INFO     Epoch [8/200] train_loss: 6.3989, val_loss: 6.4674, lr: 0.003000, 5.93s
2024-09-28 14:41:13 INFO     Saved model at 8
2024-09-28 14:41:13 INFO     Val loss decrease from 7.1352 to 6.4674, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-28 14:41:18 INFO     epoch complete!
2024-09-28 14:41:18 INFO     evaluating now!
2024-09-28 14:41:19 INFO     Epoch [9/200] train_loss: 6.2592, val_loss: 6.4610, lr: 0.003000, 6.05s
2024-09-28 14:41:19 INFO     Saved model at 9
2024-09-28 14:41:19 INFO     Val loss decrease from 6.4674 to 6.4610, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-28 14:41:24 INFO     epoch complete!
2024-09-28 14:41:24 INFO     evaluating now!
2024-09-28 14:41:25 INFO     Epoch [10/200] train_loss: 5.9689, val_loss: 5.9285, lr: 0.003000, 5.85s
2024-09-28 14:41:25 INFO     Saved model at 10
2024-09-28 14:41:25 INFO     Val loss decrease from 6.4610 to 5.9285, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-09-28 14:41:30 INFO     epoch complete!
2024-09-28 14:41:30 INFO     evaluating now!
2024-09-28 14:41:31 INFO     Epoch [11/200] train_loss: 5.8243, val_loss: 5.9836, lr: 0.003000, 6.00s
2024-09-28 14:41:36 INFO     epoch complete!
2024-09-28 14:41:36 INFO     evaluating now!
2024-09-28 14:41:37 INFO     Epoch [12/200] train_loss: 5.6788, val_loss: 5.7506, lr: 0.003000, 5.77s
2024-09-28 14:41:37 INFO     Saved model at 12
2024-09-28 14:41:37 INFO     Val loss decrease from 5.9285 to 5.7506, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-09-28 14:41:42 INFO     epoch complete!
2024-09-28 14:41:42 INFO     evaluating now!
2024-09-28 14:41:43 INFO     Epoch [13/200] train_loss: 5.4996, val_loss: 5.7653, lr: 0.003000, 6.24s
2024-09-28 14:41:49 INFO     epoch complete!
2024-09-28 14:41:49 INFO     evaluating now!
2024-09-28 14:41:49 INFO     Epoch [14/200] train_loss: 5.4402, val_loss: 5.5578, lr: 0.003000, 6.40s
2024-09-28 14:41:49 INFO     Saved model at 14
2024-09-28 14:41:49 INFO     Val loss decrease from 5.7506 to 5.5578, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-28 14:41:55 INFO     epoch complete!
2024-09-28 14:41:55 INFO     evaluating now!
2024-09-28 14:41:56 INFO     Epoch [15/200] train_loss: 5.3252, val_loss: 5.5687, lr: 0.003000, 6.43s
2024-09-28 14:42:01 INFO     epoch complete!
2024-09-28 14:42:01 INFO     evaluating now!
2024-09-28 14:42:02 INFO     Epoch [16/200] train_loss: 5.1768, val_loss: 5.6458, lr: 0.003000, 6.23s
2024-09-28 14:42:08 INFO     epoch complete!
2024-09-28 14:42:08 INFO     evaluating now!
2024-09-28 14:42:08 INFO     Epoch [17/200] train_loss: 5.1621, val_loss: 5.5201, lr: 0.003000, 6.20s
2024-09-28 14:42:08 INFO     Saved model at 17
2024-09-28 14:42:08 INFO     Val loss decrease from 5.5578 to 5.5201, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-09-28 14:42:14 INFO     epoch complete!
2024-09-28 14:42:14 INFO     evaluating now!
2024-09-28 14:42:15 INFO     Epoch [18/200] train_loss: 5.1313, val_loss: 5.3704, lr: 0.003000, 6.36s
2024-09-28 14:42:15 INFO     Saved model at 18
2024-09-28 14:42:15 INFO     Val loss decrease from 5.5201 to 5.3704, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-28 14:42:20 INFO     epoch complete!
2024-09-28 14:42:20 INFO     evaluating now!
2024-09-28 14:42:21 INFO     Epoch [19/200] train_loss: 4.9842, val_loss: 5.4596, lr: 0.003000, 6.22s
2024-09-28 14:42:27 INFO     epoch complete!
2024-09-28 14:42:27 INFO     evaluating now!
2024-09-28 14:42:27 INFO     Epoch [20/200] train_loss: 4.8318, val_loss: 5.4712, lr: 0.003000, 6.34s
2024-09-28 14:42:33 INFO     epoch complete!
2024-09-28 14:42:33 INFO     evaluating now!
2024-09-28 14:42:33 INFO     Epoch [21/200] train_loss: 4.8224, val_loss: 5.2233, lr: 0.003000, 6.26s
2024-09-28 14:42:33 INFO     Saved model at 21
2024-09-28 14:42:33 INFO     Val loss decrease from 5.3704 to 5.2233, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-09-28 14:42:39 INFO     epoch complete!
2024-09-28 14:42:39 INFO     evaluating now!
2024-09-28 14:42:40 INFO     Epoch [22/200] train_loss: 4.7760, val_loss: 5.5327, lr: 0.003000, 6.48s
2024-09-28 14:42:46 INFO     epoch complete!
2024-09-28 14:42:46 INFO     evaluating now!
2024-09-28 14:42:46 INFO     Epoch [23/200] train_loss: 4.7566, val_loss: 5.2511, lr: 0.003000, 6.21s
2024-09-28 14:42:52 INFO     epoch complete!
2024-09-28 14:42:52 INFO     evaluating now!
2024-09-28 14:42:53 INFO     Epoch [24/200] train_loss: 4.6469, val_loss: 5.4584, lr: 0.003000, 6.48s
2024-09-28 14:42:59 INFO     epoch complete!
2024-09-28 14:42:59 INFO     evaluating now!
2024-09-28 14:42:59 INFO     Epoch [25/200] train_loss: 4.6164, val_loss: 5.2137, lr: 0.003000, 6.34s
2024-09-28 14:42:59 INFO     Saved model at 25
2024-09-28 14:42:59 INFO     Val loss decrease from 5.2233 to 5.2137, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-09-28 14:43:05 INFO     epoch complete!
2024-09-28 14:43:05 INFO     evaluating now!
2024-09-28 14:43:06 INFO     Epoch [26/200] train_loss: 4.5830, val_loss: 5.3790, lr: 0.003000, 6.51s
2024-09-28 14:43:11 INFO     epoch complete!
2024-09-28 14:43:11 INFO     evaluating now!
2024-09-28 14:43:12 INFO     Epoch [27/200] train_loss: 4.5215, val_loss: 5.2779, lr: 0.003000, 6.31s
2024-09-28 14:43:18 INFO     epoch complete!
2024-09-28 14:43:18 INFO     evaluating now!
2024-09-28 14:43:18 INFO     Epoch [28/200] train_loss: 4.4654, val_loss: 5.2215, lr: 0.003000, 6.36s
2024-09-28 14:43:24 INFO     epoch complete!
2024-09-28 14:43:24 INFO     evaluating now!
2024-09-28 14:43:24 INFO     Epoch [29/200] train_loss: 4.4121, val_loss: 5.0859, lr: 0.003000, 6.27s
2024-09-28 14:43:25 INFO     Saved model at 29
2024-09-28 14:43:25 INFO     Val loss decrease from 5.2137 to 5.0859, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-09-28 14:43:31 INFO     epoch complete!
2024-09-28 14:43:31 INFO     evaluating now!
2024-09-28 14:43:31 INFO     Epoch [30/200] train_loss: 4.3896, val_loss: 4.9826, lr: 0.003000, 6.46s
2024-09-28 14:43:31 INFO     Saved model at 30
2024-09-28 14:43:31 INFO     Val loss decrease from 5.0859 to 4.9826, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-09-28 14:43:36 INFO     epoch complete!
2024-09-28 14:43:36 INFO     evaluating now!
2024-09-28 14:43:37 INFO     Epoch [31/200] train_loss: 4.3661, val_loss: 5.1742, lr: 0.003000, 5.81s
2024-09-28 14:43:42 INFO     epoch complete!
2024-09-28 14:43:42 INFO     evaluating now!
2024-09-28 14:43:43 INFO     Epoch [32/200] train_loss: 4.3731, val_loss: 5.1055, lr: 0.003000, 5.67s
2024-09-28 14:43:48 INFO     epoch complete!
2024-09-28 14:43:48 INFO     evaluating now!
2024-09-28 14:43:48 INFO     Epoch [33/200] train_loss: 4.3141, val_loss: 5.2153, lr: 0.003000, 5.69s
2024-09-28 14:43:54 INFO     epoch complete!
2024-09-28 14:43:54 INFO     evaluating now!
2024-09-28 14:43:54 INFO     Epoch [34/200] train_loss: 4.2800, val_loss: 5.1751, lr: 0.003000, 5.88s
2024-09-28 14:44:00 INFO     epoch complete!
2024-09-28 14:44:00 INFO     evaluating now!
2024-09-28 14:44:00 INFO     Epoch [35/200] train_loss: 4.2228, val_loss: 5.2085, lr: 0.003000, 5.85s
2024-09-28 14:44:05 INFO     epoch complete!
2024-09-28 14:44:05 INFO     evaluating now!
2024-09-28 14:44:06 INFO     Epoch [36/200] train_loss: 4.2306, val_loss: 5.2941, lr: 0.003000, 5.78s
2024-09-28 14:44:11 INFO     epoch complete!
2024-09-28 14:44:11 INFO     evaluating now!
2024-09-28 14:44:11 INFO     Epoch [37/200] train_loss: 4.2619, val_loss: 5.2150, lr: 0.003000, 5.73s
2024-09-28 14:44:17 INFO     epoch complete!
2024-09-28 14:44:17 INFO     evaluating now!
2024-09-28 14:44:17 INFO     Epoch [38/200] train_loss: 4.1473, val_loss: 4.9724, lr: 0.003000, 5.76s
2024-09-28 14:44:17 INFO     Saved model at 38
2024-09-28 14:44:17 INFO     Val loss decrease from 4.9826 to 4.9724, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-09-28 14:44:23 INFO     epoch complete!
2024-09-28 14:44:23 INFO     evaluating now!
2024-09-28 14:44:23 INFO     Epoch [39/200] train_loss: 4.1108, val_loss: 5.1002, lr: 0.003000, 5.90s
2024-09-28 14:44:29 INFO     epoch complete!
2024-09-28 14:44:29 INFO     evaluating now!
2024-09-28 14:44:29 INFO     Epoch [40/200] train_loss: 4.0662, val_loss: 5.1253, lr: 0.003000, 5.71s
2024-09-28 14:44:35 INFO     epoch complete!
2024-09-28 14:44:35 INFO     evaluating now!
2024-09-28 14:44:35 INFO     Epoch [41/200] train_loss: 4.1469, val_loss: 5.0108, lr: 0.003000, 5.94s
2024-09-28 14:44:40 INFO     epoch complete!
2024-09-28 14:44:40 INFO     evaluating now!
2024-09-28 14:44:41 INFO     Epoch [42/200] train_loss: 4.0343, val_loss: 4.9052, lr: 0.003000, 5.66s
2024-09-28 14:44:41 INFO     Saved model at 42
2024-09-28 14:44:41 INFO     Val loss decrease from 4.9724 to 4.9052, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-09-28 14:44:46 INFO     epoch complete!
2024-09-28 14:44:46 INFO     evaluating now!
2024-09-28 14:44:47 INFO     Epoch [43/200] train_loss: 4.0267, val_loss: 4.9762, lr: 0.003000, 5.85s
2024-09-28 14:44:52 INFO     epoch complete!
2024-09-28 14:44:52 INFO     evaluating now!
2024-09-28 14:44:52 INFO     Epoch [44/200] train_loss: 3.9907, val_loss: 4.8930, lr: 0.003000, 5.90s
2024-09-28 14:44:53 INFO     Saved model at 44
2024-09-28 14:44:53 INFO     Val loss decrease from 4.9052 to 4.8930, saving to ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-09-28 14:44:58 INFO     epoch complete!
2024-09-28 14:44:58 INFO     evaluating now!
2024-09-28 14:44:58 INFO     Epoch [45/200] train_loss: 4.0008, val_loss: 5.0450, lr: 0.003000, 5.74s
2024-09-28 14:45:04 INFO     epoch complete!
2024-09-28 14:45:04 INFO     evaluating now!
2024-09-28 14:45:04 INFO     Epoch [46/200] train_loss: 3.9977, val_loss: 5.0851, lr: 0.003000, 5.94s
2024-09-28 14:45:10 INFO     epoch complete!
2024-09-28 14:45:10 INFO     evaluating now!
2024-09-28 14:45:10 INFO     Epoch [47/200] train_loss: 3.9069, val_loss: 4.9503, lr: 0.003000, 5.68s
2024-09-28 14:45:15 INFO     epoch complete!
2024-09-28 14:45:15 INFO     evaluating now!
2024-09-28 14:45:16 INFO     Epoch [48/200] train_loss: 3.9494, val_loss: 5.0232, lr: 0.003000, 5.79s
2024-09-28 14:45:21 INFO     epoch complete!
2024-09-28 14:45:21 INFO     evaluating now!
2024-09-28 14:45:22 INFO     Epoch [49/200] train_loss: 3.9120, val_loss: 5.1011, lr: 0.003000, 5.85s
2024-09-28 14:45:27 INFO     epoch complete!
2024-09-28 14:45:27 INFO     evaluating now!
2024-09-28 14:45:27 INFO     Epoch [50/200] train_loss: 3.9170, val_loss: 5.1216, lr: 0.003000, 5.67s
2024-09-28 14:45:33 INFO     epoch complete!
2024-09-28 14:45:33 INFO     evaluating now!
2024-09-28 14:45:33 INFO     Epoch [51/200] train_loss: 3.8557, val_loss: 5.1498, lr: 0.003000, 5.68s
2024-09-28 14:45:38 INFO     epoch complete!
2024-09-28 14:45:38 INFO     evaluating now!
2024-09-28 14:45:39 INFO     Epoch [52/200] train_loss: 3.8895, val_loss: 5.2211, lr: 0.003000, 5.73s
2024-09-28 14:45:44 INFO     epoch complete!
2024-09-28 14:45:44 INFO     evaluating now!
2024-09-28 14:45:44 INFO     Epoch [53/200] train_loss: 3.8051, val_loss: 4.9701, lr: 0.003000, 5.72s
2024-09-28 14:45:50 INFO     epoch complete!
2024-09-28 14:45:50 INFO     evaluating now!
2024-09-28 14:45:50 INFO     Epoch [54/200] train_loss: 3.8145, val_loss: 5.0170, lr: 0.003000, 6.03s
2024-09-28 14:45:56 INFO     epoch complete!
2024-09-28 14:45:56 INFO     evaluating now!
2024-09-28 14:45:56 INFO     Epoch [55/200] train_loss: 3.7600, val_loss: 4.9264, lr: 0.003000, 6.02s
2024-09-28 14:46:02 INFO     epoch complete!
2024-09-28 14:46:02 INFO     evaluating now!
2024-09-28 14:46:02 INFO     Epoch [56/200] train_loss: 3.7432, val_loss: 4.9749, lr: 0.003000, 5.60s
2024-09-28 14:46:07 INFO     epoch complete!
2024-09-28 14:46:07 INFO     evaluating now!
2024-09-28 14:46:08 INFO     Epoch [57/200] train_loss: 3.7361, val_loss: 4.9960, lr: 0.003000, 5.86s
2024-09-28 14:46:13 INFO     epoch complete!
2024-09-28 14:46:13 INFO     evaluating now!
2024-09-28 14:46:14 INFO     Epoch [58/200] train_loss: 3.7251, val_loss: 5.0563, lr: 0.003000, 5.72s
2024-09-28 14:46:19 INFO     epoch complete!
2024-09-28 14:46:19 INFO     evaluating now!
2024-09-28 14:46:19 INFO     Epoch [59/200] train_loss: 3.7392, val_loss: 5.0262, lr: 0.003000, 5.86s
2024-09-28 14:46:19 WARNING  Early stopping at epoch: 59
2024-09-28 14:46:19 INFO     Trained totally 60 epochs, average train time is 5.570s, average eval time is 0.403s
2024-09-28 14:46:20 INFO     Loaded model at 44
2024-09-28 14:46:20 INFO     Saved model at ./libcity/cache/23/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 14:46:20 INFO     Start evaluating ...
2024-09-28 14:46:21 INFO     Note that you select the single mode to evaluate!
2024-09-28 14:46:21 INFO     Evaluate result is saved at ./libcity/cache/23/evaluate_cache/2024_09_28_14_46_21_AGCRN_CHITaxi20190406.csv
2024-09-28 14:46:21 INFO     
         MAE       RMSE  masked_MAPE
1   2.437780   7.950643     0.437814
2   2.550525   8.147787     0.440138
3   2.768726   8.865554     0.460017
4   2.859860   9.515624     0.457181
5   2.860405  10.239422     0.436278
6   3.063042  10.837775     0.455173
7   2.998075  11.207932     0.435815
8   2.976336  11.493803     0.442076
9   2.985856  11.763804     0.456577
10  3.056257  12.116961     0.471002
11  3.167254  12.458709     0.482889
12  3.362267  13.205195     0.513375
2024-09-28 14:46:22 INFO     ----------------------------------------------------------------------------
2024-09-28 14:46:22 INFO     # 4, Kownledge Graph Embedding: TransE, Experiment ids: 24
2024-09-28 14:46:22 INFO     ----------------------------------------------------------------------------
2024-09-28 14:46:22 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=24
2024-09-28 14:46:22 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 24, 'ke_model': 'TransE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-28 14:46:22 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-28 14:46:22 INFO     set_weight_link_or_dist: dist
2024-09-28 14:46:22 INFO     init_weight_inf_or_zero: inf
2024-09-28 14:46:22 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-28 14:46:22 INFO     Start Calculate the weight by Gauss kernel!
2024-09-28 14:46:22 INFO     Loading file CHITaxi20190406.dyna
2024-09-28 14:46:22 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-28 14:46:25 INFO     Dataset created
2024-09-28 14:46:25 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-28 14:46:25 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-28 14:46:25 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-28 14:46:25 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-28 14:46:25 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-28 14:46:25 INFO     NoneScaler
2024-09-28 14:46:27 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-09-28 14:46:27 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-09-28 14:46:27 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 98, 128])	cuda:0	True
2024-09-28 14:46:27 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 14:46:27 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 98, 64])	cuda:0	True
2024-09-28 14:46:27 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 14:46:27 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-09-28 14:46:27 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-09-28 14:46:27 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-09-28 14:46:27 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-09-28 14:46:27 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-09-28 14:46:27 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-09-28 14:46:27 INFO     Total parameter numbers: 874010
2024-09-28 14:46:27 INFO     You select `adam` optimizer.
2024-09-28 14:46:27 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-28 14:46:27 INFO     Start training ...
2024-09-28 14:46:27 INFO     num_batches:48
2024-09-28 14:46:32 INFO     epoch complete!
2024-09-28 14:46:32 INFO     evaluating now!
2024-09-28 14:46:33 INFO     Epoch [0/200] train_loss: 23.3093, val_loss: 18.6676, lr: 0.003000, 5.78s
2024-09-28 14:46:33 INFO     Saved model at 0
2024-09-28 14:46:33 INFO     Val loss decrease from inf to 18.6676, saving to ./libcity/cache/24/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-09-28 14:46:38 INFO     epoch complete!
2024-09-28 14:46:38 INFO     evaluating now!
2024-09-28 14:46:39 INFO     Epoch [1/200] train_loss: 15.1065, val_loss: 14.4565, lr: 0.003000, 5.89s
2024-09-28 14:46:39 INFO     Saved model at 1
2024-09-28 14:46:39 INFO     Val loss decrease from 18.6676 to 14.4565, saving to ./libcity/cache/24/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-09-28 14:46:44 INFO     epoch complete!
2024-09-28 14:46:44 INFO     evaluating now!
2024-09-28 14:46:44 INFO     Epoch [2/200] train_loss: 12.4145, val_loss: 11.9201, lr: 0.003000, 5.74s
2024-09-28 14:46:45 INFO     Saved model at 2
2024-09-28 14:46:45 INFO     Val loss decrease from 14.4565 to 11.9201, saving to ./libcity/cache/24/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-09-28 14:46:50 INFO     epoch complete!
2024-09-28 14:46:50 INFO     evaluating now!
2024-09-28 14:46:50 INFO     Epoch [3/200] train_loss: 10.0042, val_loss: 9.6863, lr: 0.003000, 5.93s
2024-09-28 14:46:51 INFO     Saved model at 3
2024-09-28 14:46:51 INFO     Val loss decrease from 11.9201 to 9.6863, saving to ./libcity/cache/24/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-09-28 14:46:56 INFO     epoch complete!
2024-09-28 14:46:56 INFO     evaluating now!
2024-09-28 14:46:57 INFO     Epoch [4/200] train_loss: 8.4616, val_loss: 8.1683, lr: 0.003000, 6.06s
2024-09-28 14:46:57 INFO     Saved model at 4
2024-09-28 14:46:57 INFO     Val loss decrease from 9.6863 to 8.1683, saving to ./libcity/cache/24/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-09-28 14:47:02 INFO     epoch complete!
2024-09-28 14:47:02 INFO     evaluating now!
2024-09-28 14:47:03 INFO     Epoch [5/200] train_loss: 7.6986, val_loss: 7.3401, lr: 0.003000, 5.92s
2024-09-28 14:47:03 INFO     Saved model at 5
2024-09-28 14:47:03 INFO     Val loss decrease from 8.1683 to 7.3401, saving to ./libcity/cache/24/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-09-28 14:47:08 INFO     epoch complete!
2024-09-28 14:47:08 INFO     evaluating now!
2024-09-28 14:47:08 INFO     Epoch [6/200] train_loss: 7.0390, val_loss: 7.0250, lr: 0.003000, 5.70s
2024-09-28 14:47:08 INFO     Saved model at 6
2024-09-28 14:47:08 INFO     Val loss decrease from 7.3401 to 7.0250, saving to ./libcity/cache/24/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-09-28 14:47:14 INFO     epoch complete!
2024-09-28 14:47:14 INFO     evaluating now!
2024-09-28 14:47:14 INFO     Epoch [7/200] train_loss: 6.7369, val_loss: 7.1400, lr: 0.003000, 5.94s
2024-09-28 14:47:20 INFO     epoch complete!
2024-09-28 14:47:20 INFO     evaluating now!
2024-09-28 14:47:20 INFO     Epoch [8/200] train_loss: 6.4623, val_loss: 6.9793, lr: 0.003000, 5.80s
2024-09-28 14:47:20 INFO     Saved model at 8
2024-09-28 14:47:20 INFO     Val loss decrease from 7.0250 to 6.9793, saving to ./libcity/cache/24/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-09-28 14:47:26 INFO     epoch complete!
2024-09-28 14:47:26 INFO     evaluating now!
2024-09-28 14:47:26 INFO     Epoch [9/200] train_loss: 6.0866, val_loss: 6.0959, lr: 0.003000, 5.95s
2024-09-28 14:47:26 INFO     Saved model at 9
2024-09-28 14:47:26 INFO     Val loss decrease from 6.9793 to 6.0959, saving to ./libcity/cache/24/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-09-28 14:47:32 INFO     epoch complete!
2024-09-28 14:47:32 INFO     evaluating now!
2024-09-28 14:47:32 INFO     Epoch [10/200] train_loss: 5.8717, val_loss: 6.2986, lr: 0.003000, 5.86s
2024-09-28 14:47:37 INFO     epoch complete!
2024-09-28 14:47:37 INFO     evaluating now!
2024-09-28 14:47:38 INFO     Epoch [11/200] train_loss: 5.7747, val_loss: 6.0094, lr: 0.003000, 5.86s
2024-09-28 14:47:38 INFO     Saved model at 11
2024-09-28 14:47:38 INFO     Val loss decrease from 6.0959 to 6.0094, saving to ./libcity/cache/24/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-09-28 14:47:43 INFO     epoch complete!
2024-09-28 14:47:43 INFO     evaluating now!
2024-09-28 14:47:44 INFO     Epoch [12/200] train_loss: 5.6111, val_loss: 6.0531, lr: 0.003000, 5.79s
2024-09-28 14:47:49 INFO     epoch complete!
2024-09-28 14:47:49 INFO     evaluating now!
2024-09-28 14:47:49 INFO     Epoch [13/200] train_loss: 5.4964, val_loss: 6.0341, lr: 0.003000, 5.76s
2024-09-28 14:47:55 INFO     epoch complete!
2024-09-28 14:47:55 INFO     evaluating now!
2024-09-28 14:47:55 INFO     Epoch [14/200] train_loss: 5.4309, val_loss: 5.7328, lr: 0.003000, 5.90s
2024-09-28 14:47:55 INFO     Saved model at 14
2024-09-28 14:47:55 INFO     Val loss decrease from 6.0094 to 5.7328, saving to ./libcity/cache/24/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-09-28 14:48:01 INFO     epoch complete!
2024-09-28 14:48:01 INFO     evaluating now!
2024-09-28 14:48:01 INFO     Epoch [15/200] train_loss: 5.3511, val_loss: 5.6219, lr: 0.003000, 5.86s
2024-09-28 14:48:01 INFO     Saved model at 15
2024-09-28 14:48:01 INFO     Val loss decrease from 5.7328 to 5.6219, saving to ./libcity/cache/24/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-09-28 14:48:07 INFO     epoch complete!
2024-09-28 14:48:07 INFO     evaluating now!
2024-09-28 14:48:07 INFO     Epoch [16/200] train_loss: 5.1535, val_loss: 5.4080, lr: 0.003000, 5.94s
2024-09-28 14:48:07 INFO     Saved model at 16
2024-09-28 14:48:07 INFO     Val loss decrease from 5.6219 to 5.4080, saving to ./libcity/cache/24/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-09-28 14:48:13 INFO     epoch complete!
2024-09-28 14:48:13 INFO     evaluating now!
2024-09-28 14:48:13 INFO     Epoch [17/200] train_loss: 5.0648, val_loss: 5.6050, lr: 0.003000, 5.72s
2024-09-28 14:48:19 INFO     epoch complete!
2024-09-28 14:48:19 INFO     evaluating now!
2024-09-28 14:48:19 INFO     Epoch [18/200] train_loss: 4.9833, val_loss: 5.4017, lr: 0.003000, 5.84s
2024-09-28 14:48:19 INFO     Saved model at 18
2024-09-28 14:48:19 INFO     Val loss decrease from 5.4080 to 5.4017, saving to ./libcity/cache/24/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-09-28 14:48:24 INFO     epoch complete!
2024-09-28 14:48:24 INFO     evaluating now!
2024-09-28 14:48:25 INFO     Epoch [19/200] train_loss: 4.9193, val_loss: 5.5076, lr: 0.003000, 5.69s
2024-09-28 14:48:30 INFO     epoch complete!
2024-09-28 14:48:30 INFO     evaluating now!
2024-09-28 14:48:31 INFO     Epoch [20/200] train_loss: 4.8951, val_loss: 5.4229, lr: 0.003000, 5.92s
2024-09-28 14:48:36 INFO     epoch complete!
2024-09-28 14:48:36 INFO     evaluating now!
2024-09-28 14:48:36 INFO     Epoch [21/200] train_loss: 4.6889, val_loss: 5.4132, lr: 0.003000, 5.71s
2024-09-28 14:48:42 INFO     epoch complete!
2024-09-28 14:48:42 INFO     evaluating now!
2024-09-28 14:48:42 INFO     Epoch [22/200] train_loss: 4.8490, val_loss: 5.5728, lr: 0.003000, 5.84s
2024-09-28 14:48:48 INFO     epoch complete!
2024-09-28 14:48:48 INFO     evaluating now!
2024-09-28 14:48:48 INFO     Epoch [23/200] train_loss: 4.7814, val_loss: 5.2549, lr: 0.003000, 5.94s
2024-09-28 14:48:48 INFO     Saved model at 23
2024-09-28 14:48:48 INFO     Val loss decrease from 5.4017 to 5.2549, saving to ./libcity/cache/24/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-09-28 14:48:54 INFO     epoch complete!
2024-09-28 14:48:54 INFO     evaluating now!
2024-09-28 14:48:54 INFO     Epoch [24/200] train_loss: 4.6576, val_loss: 5.3282, lr: 0.003000, 5.73s
2024-09-28 14:48:59 INFO     epoch complete!
2024-09-28 14:48:59 INFO     evaluating now!
2024-09-28 14:49:00 INFO     Epoch [25/200] train_loss: 4.5112, val_loss: 5.3365, lr: 0.003000, 5.75s
2024-09-28 14:49:05 INFO     epoch complete!
2024-09-28 14:49:05 INFO     evaluating now!
2024-09-28 14:49:06 INFO     Epoch [26/200] train_loss: 4.4757, val_loss: 5.4916, lr: 0.003000, 5.81s
2024-09-28 14:49:11 INFO     epoch complete!
2024-09-28 14:49:11 INFO     evaluating now!
2024-09-28 14:49:11 INFO     Epoch [27/200] train_loss: 4.4570, val_loss: 5.3340, lr: 0.003000, 5.96s
2024-09-28 14:49:17 INFO     epoch complete!
2024-09-28 14:49:17 INFO     evaluating now!
2024-09-28 14:49:17 INFO     Epoch [28/200] train_loss: 4.4116, val_loss: 5.0870, lr: 0.003000, 5.82s
2024-09-28 14:49:17 INFO     Saved model at 28
2024-09-28 14:49:17 INFO     Val loss decrease from 5.2549 to 5.0870, saving to ./libcity/cache/24/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-09-28 14:49:23 INFO     epoch complete!
2024-09-28 14:49:23 INFO     evaluating now!
2024-09-28 14:49:23 INFO     Epoch [29/200] train_loss: 4.3399, val_loss: 5.1717, lr: 0.003000, 5.96s
2024-09-28 14:49:29 INFO     epoch complete!
2024-09-28 14:49:29 INFO     evaluating now!
2024-09-28 14:49:29 INFO     Epoch [30/200] train_loss: 4.4725, val_loss: 5.2267, lr: 0.003000, 5.70s
2024-09-28 14:49:34 INFO     epoch complete!
2024-09-28 14:49:34 INFO     evaluating now!
2024-09-28 14:49:35 INFO     Epoch [31/200] train_loss: 4.3095, val_loss: 5.1103, lr: 0.003000, 5.72s
2024-09-28 14:49:40 INFO     epoch complete!
2024-09-28 14:49:40 INFO     evaluating now!
2024-09-28 14:49:41 INFO     Epoch [32/200] train_loss: 4.2406, val_loss: 5.1332, lr: 0.003000, 5.88s
2024-09-28 14:49:46 INFO     epoch complete!
2024-09-28 14:49:46 INFO     evaluating now!
2024-09-28 14:49:46 INFO     Epoch [33/200] train_loss: 4.2265, val_loss: 4.9732, lr: 0.003000, 5.58s
2024-09-28 14:49:46 INFO     Saved model at 33
2024-09-28 14:49:46 INFO     Val loss decrease from 5.0870 to 4.9732, saving to ./libcity/cache/24/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-09-28 14:49:52 INFO     epoch complete!
2024-09-28 14:49:52 INFO     evaluating now!
2024-09-28 14:49:52 INFO     Epoch [34/200] train_loss: 4.1739, val_loss: 5.2847, lr: 0.003000, 5.89s
2024-09-28 14:49:58 INFO     epoch complete!
2024-09-28 14:49:58 INFO     evaluating now!
2024-09-28 14:49:58 INFO     Epoch [35/200] train_loss: 4.1919, val_loss: 5.1189, lr: 0.003000, 5.86s
2024-09-28 14:50:04 INFO     epoch complete!
2024-09-28 14:50:04 INFO     evaluating now!
2024-09-28 14:50:04 INFO     Epoch [36/200] train_loss: 4.1771, val_loss: 5.3109, lr: 0.003000, 5.90s
2024-09-28 14:50:09 INFO     epoch complete!
2024-09-28 14:50:09 INFO     evaluating now!
2024-09-28 14:50:10 INFO     Epoch [37/200] train_loss: 4.1593, val_loss: 5.2707, lr: 0.003000, 5.73s
2024-09-28 14:50:15 INFO     epoch complete!
2024-09-28 14:50:15 INFO     evaluating now!
2024-09-28 14:50:16 INFO     Epoch [38/200] train_loss: 4.1520, val_loss: 5.1193, lr: 0.003000, 6.01s
2024-09-28 14:50:21 INFO     epoch complete!
2024-09-28 14:50:21 INFO     evaluating now!
2024-09-28 14:50:21 INFO     Epoch [39/200] train_loss: 4.0490, val_loss: 5.1755, lr: 0.003000, 5.73s
2024-09-28 14:50:27 INFO     epoch complete!
2024-09-28 14:50:27 INFO     evaluating now!
2024-09-28 14:50:27 INFO     Epoch [40/200] train_loss: 4.0386, val_loss: 4.9957, lr: 0.003000, 5.94s
2024-09-28 14:50:33 INFO     epoch complete!
2024-09-28 14:50:33 INFO     evaluating now!
2024-09-28 14:50:33 INFO     Epoch [41/200] train_loss: 3.9904, val_loss: 5.0763, lr: 0.003000, 5.67s
2024-09-28 14:50:38 INFO     epoch complete!
2024-09-28 14:50:38 INFO     evaluating now!
2024-09-28 14:50:39 INFO     Epoch [42/200] train_loss: 4.1336, val_loss: 5.1228, lr: 0.003000, 5.68s
2024-09-28 14:50:44 INFO     epoch complete!
2024-09-28 14:50:44 INFO     evaluating now!
2024-09-28 14:50:44 INFO     Epoch [43/200] train_loss: 3.9967, val_loss: 4.9901, lr: 0.003000, 5.79s
2024-09-28 14:50:50 INFO     epoch complete!
2024-09-28 14:50:50 INFO     evaluating now!
2024-09-28 14:50:50 INFO     Epoch [44/200] train_loss: 3.8826, val_loss: 5.0918, lr: 0.003000, 5.74s
2024-09-28 14:50:56 INFO     epoch complete!
2024-09-28 14:50:56 INFO     evaluating now!
2024-09-28 14:50:56 INFO     Epoch [45/200] train_loss: 3.8937, val_loss: 5.0162, lr: 0.003000, 6.05s
2024-09-28 14:51:02 INFO     epoch complete!
2024-09-28 14:51:02 INFO     evaluating now!
2024-09-28 14:51:02 INFO     Epoch [46/200] train_loss: 3.8424, val_loss: 5.0384, lr: 0.003000, 5.91s
2024-09-28 14:51:08 INFO     epoch complete!
2024-09-28 14:51:08 INFO     evaluating now!
2024-09-28 14:51:08 INFO     Epoch [47/200] train_loss: 3.8560, val_loss: 5.0197, lr: 0.003000, 5.91s
2024-09-28 14:51:13 INFO     epoch complete!
2024-09-28 14:51:13 INFO     evaluating now!
2024-09-28 14:51:14 INFO     Epoch [48/200] train_loss: 3.8594, val_loss: 5.0924, lr: 0.003000, 5.70s
2024-09-28 14:51:14 WARNING  Early stopping at epoch: 48
2024-09-28 14:51:14 INFO     Trained totally 49 epochs, average train time is 5.444s, average eval time is 0.387s
2024-09-28 14:51:14 INFO     Loaded model at 33
2024-09-28 14:51:14 INFO     Saved model at ./libcity/cache/24/model_cache/AGCRN_CHITaxi20190406.m
2024-09-28 14:51:14 INFO     Start evaluating ...
2024-09-28 14:51:15 INFO     Note that you select the single mode to evaluate!
2024-09-28 14:51:15 INFO     Evaluate result is saved at ./libcity/cache/24/evaluate_cache/2024_09_28_14_51_15_AGCRN_CHITaxi20190406.csv
2024-09-28 14:51:15 INFO     
         MAE       RMSE  masked_MAPE
1   2.324968   6.910562     0.425084
2   2.403100   7.457548     0.424698
3   2.595900   8.612639     0.429427
4   2.714766   9.301780     0.430506
5   2.809264   9.949088     0.434815
6   2.897870  10.564175     0.434869
7   2.992988  11.268169     0.442887
8   3.073844  11.956208     0.457692
9   3.174417  12.493789     0.461615
10  3.212724  12.898167     0.458890
11  3.328692  13.418833     0.464519
12  3.372826  14.067688     0.457500
2024-09-28 14:51:15 INFO     ----------------------------------------------------------------------------
2024-09-28 14:51:15 INFO     Kownledge Graph Embedding: TransE, Experiment ids: [20, 21, 22, 23, 24]
2024-09-28 14:51:16 INFO     ----------------------------------------------------------------------------
2024-09-28 14:51:16 INFO     Average: 
         MAE       RMSE  masked_MAPE
0   2.406843   7.350308     0.440274
1   2.525341   7.834967     0.445540
2   2.691417   8.758739     0.447198
3   2.824830   9.467008     0.447625
4   2.907821  10.225311     0.440241
5   3.042871  10.948121     0.448199
6   3.128494  11.617144     0.453674
7   3.178722  12.164888     0.460498
8   3.247719  12.533434     0.476140
9   3.277920  12.813164     0.475496
10  3.325774  13.073391     0.480405
11  3.437988  13.588000     0.499541 
2024-09-28 14:51:16 INFO     Standard deviation: 
         MAE      RMSE  masked_MAPE
0   0.054751  0.436816     0.009422
1   0.067853  0.306520     0.013578
2   0.056910  0.147340     0.011524
3   0.064753  0.136766     0.015042
4   0.086771  0.167465     0.015494
5   0.089822  0.234771     0.015947
6   0.120074  0.326625     0.021854
7   0.138400  0.434381     0.016722
8   0.161441  0.427352     0.020178
9   0.142058  0.360158     0.022062
10  0.116281  0.345296     0.014634
11  0.135567  0.375977     0.031403
2024-09-28 14:51:16 INFO     ----------------------------------------------------------------------------
2024-09-28 14:51:16 INFO     12 steps Average: 
        MAE      RMSE  masked_MAPE
0  2.999645  10.86454     0.459569
2024-09-28 14:51:16 INFO     12 steps Standard deviation: 
       MAE      RMSE  masked_MAPE
0  0.10289  0.308289     0.017322
