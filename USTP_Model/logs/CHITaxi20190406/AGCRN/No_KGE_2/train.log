2024-04-25 21:32:09 INFO     ----------------------------------------------------------------------------
2024-04-25 21:32:09 INFO     # 0, Kownledge Graph Embedding: None, Experiment ids: 0
2024-04-25 21:32:09 INFO     ----------------------------------------------------------------------------
2024-04-25 21:32:10 INFO     Log directory: ./libcity/log
2024-04-25 21:32:10 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=0
2024-04-25 21:32:10 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 15285024, 'exp_id': 0, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-25 21:32:12 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-25 21:32:12 INFO     set_weight_link_or_dist: dist
2024-04-25 21:32:12 INFO     init_weight_inf_or_zero: inf
2024-04-25 21:32:12 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-25 21:32:12 INFO     Start Calculate the weight by Gauss kernel!
2024-04-25 21:32:12 INFO     Loading file CHITaxi20190406.dyna
2024-04-25 21:32:13 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-25 21:32:13 INFO     Dataset created
2024-04-25 21:32:13 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-04-25 21:32:13 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-04-25 21:32:13 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-04-25 21:32:13 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-04-25 21:32:13 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-25 21:32:13 INFO     NoneScaler
2024-04-25 21:32:21 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-25 21:32:21 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-25 21:32:21 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-04-25 21:32:21 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 21:32:21 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-04-25 21:32:21 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 21:32:21 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-25 21:32:21 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 21:32:21 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-25 21:32:21 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 21:32:21 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-25 21:32:21 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-25 21:32:21 INFO     Total parameter numbers: 751130
2024-04-25 21:32:21 INFO     You select `adam` optimizer.
2024-04-25 21:32:21 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-25 21:32:21 INFO     Start training ...
2024-04-25 21:32:21 INFO     num_batches:48
2024-04-25 21:32:27 INFO     epoch complete!
2024-04-25 21:32:27 INFO     evaluating now!
2024-04-25 21:32:27 INFO     Epoch [0/200] train_loss: 24.8112, val_loss: 17.5990, lr: 0.003000, 5.63s
2024-04-25 21:32:27 INFO     Saved model at 0
2024-04-25 21:32:27 INFO     Val loss decrease from inf to 17.5990, saving to ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-25 21:32:32 INFO     epoch complete!
2024-04-25 21:32:32 INFO     evaluating now!
2024-04-25 21:32:32 INFO     Epoch [1/200] train_loss: 13.8523, val_loss: 12.6088, lr: 0.003000, 5.04s
2024-04-25 21:32:33 INFO     Saved model at 1
2024-04-25 21:32:33 INFO     Val loss decrease from 17.5990 to 12.6088, saving to ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-25 21:32:37 INFO     epoch complete!
2024-04-25 21:32:37 INFO     evaluating now!
2024-04-25 21:32:38 INFO     Epoch [2/200] train_loss: 10.3914, val_loss: 9.4315, lr: 0.003000, 5.15s
2024-04-25 21:32:38 INFO     Saved model at 2
2024-04-25 21:32:38 INFO     Val loss decrease from 12.6088 to 9.4315, saving to ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-25 21:32:43 INFO     epoch complete!
2024-04-25 21:32:43 INFO     evaluating now!
2024-04-25 21:32:43 INFO     Epoch [3/200] train_loss: 8.5039, val_loss: 8.1244, lr: 0.003000, 5.03s
2024-04-25 21:32:43 INFO     Saved model at 3
2024-04-25 21:32:43 INFO     Val loss decrease from 9.4315 to 8.1244, saving to ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-25 21:32:48 INFO     epoch complete!
2024-04-25 21:32:48 INFO     evaluating now!
2024-04-25 21:32:48 INFO     Epoch [4/200] train_loss: 7.4365, val_loss: 7.2526, lr: 0.003000, 5.15s
2024-04-25 21:32:48 INFO     Saved model at 4
2024-04-25 21:32:48 INFO     Val loss decrease from 8.1244 to 7.2526, saving to ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-25 21:32:53 INFO     epoch complete!
2024-04-25 21:32:53 INFO     evaluating now!
2024-04-25 21:32:54 INFO     Epoch [5/200] train_loss: 6.8227, val_loss: 6.6264, lr: 0.003000, 5.16s
2024-04-25 21:32:54 INFO     Saved model at 5
2024-04-25 21:32:54 INFO     Val loss decrease from 7.2526 to 6.6264, saving to ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-25 21:32:59 INFO     epoch complete!
2024-04-25 21:32:59 INFO     evaluating now!
2024-04-25 21:32:59 INFO     Epoch [6/200] train_loss: 6.4434, val_loss: 6.2337, lr: 0.003000, 5.05s
2024-04-25 21:32:59 INFO     Saved model at 6
2024-04-25 21:32:59 INFO     Val loss decrease from 6.6264 to 6.2337, saving to ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-25 21:33:04 INFO     epoch complete!
2024-04-25 21:33:04 INFO     evaluating now!
2024-04-25 21:33:04 INFO     Epoch [7/200] train_loss: 6.0075, val_loss: 6.0102, lr: 0.003000, 5.11s
2024-04-25 21:33:05 INFO     Saved model at 7
2024-04-25 21:33:05 INFO     Val loss decrease from 6.2337 to 6.0102, saving to ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-25 21:33:09 INFO     epoch complete!
2024-04-25 21:33:09 INFO     evaluating now!
2024-04-25 21:33:10 INFO     Epoch [8/200] train_loss: 5.7830, val_loss: 5.8975, lr: 0.003000, 5.06s
2024-04-25 21:33:10 INFO     Saved model at 8
2024-04-25 21:33:10 INFO     Val loss decrease from 6.0102 to 5.8975, saving to ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-25 21:33:15 INFO     epoch complete!
2024-04-25 21:33:15 INFO     evaluating now!
2024-04-25 21:33:15 INFO     Epoch [9/200] train_loss: 5.5917, val_loss: 5.6211, lr: 0.003000, 5.15s
2024-04-25 21:33:15 INFO     Saved model at 9
2024-04-25 21:33:15 INFO     Val loss decrease from 5.8975 to 5.6211, saving to ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-25 21:33:20 INFO     epoch complete!
2024-04-25 21:33:20 INFO     evaluating now!
2024-04-25 21:33:20 INFO     Epoch [10/200] train_loss: 5.4184, val_loss: 5.7917, lr: 0.003000, 5.06s
2024-04-25 21:33:26 INFO     epoch complete!
2024-04-25 21:33:26 INFO     evaluating now!
2024-04-25 21:33:26 INFO     Epoch [11/200] train_loss: 5.3822, val_loss: 5.9251, lr: 0.003000, 5.35s
2024-04-25 21:33:31 INFO     epoch complete!
2024-04-25 21:33:31 INFO     evaluating now!
2024-04-25 21:33:31 INFO     Epoch [12/200] train_loss: 5.2634, val_loss: 5.4165, lr: 0.003000, 5.27s
2024-04-25 21:33:31 INFO     Saved model at 12
2024-04-25 21:33:31 INFO     Val loss decrease from 5.6211 to 5.4165, saving to ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-25 21:33:36 INFO     epoch complete!
2024-04-25 21:33:36 INFO     evaluating now!
2024-04-25 21:33:36 INFO     Epoch [13/200] train_loss: 5.1090, val_loss: 5.5546, lr: 0.003000, 5.22s
2024-04-25 21:33:41 INFO     epoch complete!
2024-04-25 21:33:41 INFO     evaluating now!
2024-04-25 21:33:42 INFO     Epoch [14/200] train_loss: 5.0213, val_loss: 5.3748, lr: 0.003000, 5.15s
2024-04-25 21:33:42 INFO     Saved model at 14
2024-04-25 21:33:42 INFO     Val loss decrease from 5.4165 to 5.3748, saving to ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-25 21:33:47 INFO     epoch complete!
2024-04-25 21:33:47 INFO     evaluating now!
2024-04-25 21:33:47 INFO     Epoch [15/200] train_loss: 4.9609, val_loss: 5.3630, lr: 0.003000, 5.26s
2024-04-25 21:33:47 INFO     Saved model at 15
2024-04-25 21:33:47 INFO     Val loss decrease from 5.3748 to 5.3630, saving to ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-25 21:33:52 INFO     epoch complete!
2024-04-25 21:33:52 INFO     evaluating now!
2024-04-25 21:33:53 INFO     Epoch [16/200] train_loss: 4.8341, val_loss: 5.5742, lr: 0.003000, 5.08s
2024-04-25 21:33:57 INFO     epoch complete!
2024-04-25 21:33:57 INFO     evaluating now!
2024-04-25 21:33:57 INFO     Epoch [17/200] train_loss: 4.8212, val_loss: 5.4804, lr: 0.003000, 4.93s
2024-04-25 21:34:02 INFO     epoch complete!
2024-04-25 21:34:02 INFO     evaluating now!
2024-04-25 21:34:02 INFO     Epoch [18/200] train_loss: 4.7572, val_loss: 5.2765, lr: 0.003000, 5.02s
2024-04-25 21:34:03 INFO     Saved model at 18
2024-04-25 21:34:03 INFO     Val loss decrease from 5.3630 to 5.2765, saving to ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-25 21:34:08 INFO     epoch complete!
2024-04-25 21:34:08 INFO     evaluating now!
2024-04-25 21:34:08 INFO     Epoch [19/200] train_loss: 4.6430, val_loss: 5.2968, lr: 0.003000, 5.06s
2024-04-25 21:34:13 INFO     epoch complete!
2024-04-25 21:34:13 INFO     evaluating now!
2024-04-25 21:34:13 INFO     Epoch [20/200] train_loss: 4.6678, val_loss: 5.3345, lr: 0.003000, 5.01s
2024-04-25 21:34:18 INFO     epoch complete!
2024-04-25 21:34:18 INFO     evaluating now!
2024-04-25 21:34:18 INFO     Epoch [21/200] train_loss: 4.6051, val_loss: 5.1688, lr: 0.003000, 5.14s
2024-04-25 21:34:18 INFO     Saved model at 21
2024-04-25 21:34:18 INFO     Val loss decrease from 5.2765 to 5.1688, saving to ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-25 21:34:23 INFO     epoch complete!
2024-04-25 21:34:23 INFO     evaluating now!
2024-04-25 21:34:23 INFO     Epoch [22/200] train_loss: 4.4762, val_loss: 5.3311, lr: 0.003000, 4.89s
2024-04-25 21:34:28 INFO     epoch complete!
2024-04-25 21:34:28 INFO     evaluating now!
2024-04-25 21:34:28 INFO     Epoch [23/200] train_loss: 4.4348, val_loss: 5.3658, lr: 0.003000, 5.01s
2024-04-25 21:34:33 INFO     epoch complete!
2024-04-25 21:34:33 INFO     evaluating now!
2024-04-25 21:34:33 INFO     Epoch [24/200] train_loss: 4.4063, val_loss: 5.2642, lr: 0.003000, 5.01s
2024-04-25 21:34:38 INFO     epoch complete!
2024-04-25 21:34:38 INFO     evaluating now!
2024-04-25 21:34:38 INFO     Epoch [25/200] train_loss: 4.3914, val_loss: 5.2479, lr: 0.003000, 5.07s
2024-04-25 21:34:43 INFO     epoch complete!
2024-04-25 21:34:43 INFO     evaluating now!
2024-04-25 21:34:43 INFO     Epoch [26/200] train_loss: 4.3185, val_loss: 5.2135, lr: 0.003000, 5.09s
2024-04-25 21:34:48 INFO     epoch complete!
2024-04-25 21:34:48 INFO     evaluating now!
2024-04-25 21:34:48 INFO     Epoch [27/200] train_loss: 4.2503, val_loss: 5.2817, lr: 0.003000, 4.95s
2024-04-25 21:34:53 INFO     epoch complete!
2024-04-25 21:34:53 INFO     evaluating now!
2024-04-25 21:34:53 INFO     Epoch [28/200] train_loss: 4.1980, val_loss: 5.1787, lr: 0.003000, 4.95s
2024-04-25 21:34:58 INFO     epoch complete!
2024-04-25 21:34:58 INFO     evaluating now!
2024-04-25 21:34:58 INFO     Epoch [29/200] train_loss: 4.2010, val_loss: 5.2248, lr: 0.003000, 4.96s
2024-04-25 21:35:03 INFO     epoch complete!
2024-04-25 21:35:03 INFO     evaluating now!
2024-04-25 21:35:03 INFO     Epoch [30/200] train_loss: 4.1364, val_loss: 5.0844, lr: 0.003000, 5.34s
2024-04-25 21:35:04 INFO     Saved model at 30
2024-04-25 21:35:04 INFO     Val loss decrease from 5.1688 to 5.0844, saving to ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-04-25 21:35:08 INFO     epoch complete!
2024-04-25 21:35:08 INFO     evaluating now!
2024-04-25 21:35:09 INFO     Epoch [31/200] train_loss: 4.0940, val_loss: 5.2639, lr: 0.003000, 4.91s
2024-04-25 21:35:13 INFO     epoch complete!
2024-04-25 21:35:13 INFO     evaluating now!
2024-04-25 21:35:14 INFO     Epoch [32/200] train_loss: 4.0434, val_loss: 5.2749, lr: 0.003000, 5.13s
2024-04-25 21:35:18 INFO     epoch complete!
2024-04-25 21:35:18 INFO     evaluating now!
2024-04-25 21:35:19 INFO     Epoch [33/200] train_loss: 3.9997, val_loss: 5.0428, lr: 0.003000, 5.01s
2024-04-25 21:35:19 INFO     Saved model at 33
2024-04-25 21:35:19 INFO     Val loss decrease from 5.0844 to 5.0428, saving to ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-04-25 21:35:24 INFO     epoch complete!
2024-04-25 21:35:24 INFO     evaluating now!
2024-04-25 21:35:25 INFO     Epoch [34/200] train_loss: 3.9329, val_loss: 5.1101, lr: 0.003000, 5.59s
2024-04-25 21:35:30 INFO     epoch complete!
2024-04-25 21:35:30 INFO     evaluating now!
2024-04-25 21:35:30 INFO     Epoch [35/200] train_loss: 3.9811, val_loss: 5.0913, lr: 0.003000, 5.42s
2024-04-25 21:35:35 INFO     epoch complete!
2024-04-25 21:35:35 INFO     evaluating now!
2024-04-25 21:35:36 INFO     Epoch [36/200] train_loss: 3.9535, val_loss: 5.1032, lr: 0.003000, 5.52s
2024-04-25 21:35:41 INFO     epoch complete!
2024-04-25 21:35:41 INFO     evaluating now!
2024-04-25 21:35:41 INFO     Epoch [37/200] train_loss: 3.8941, val_loss: 5.0305, lr: 0.003000, 5.34s
2024-04-25 21:35:41 INFO     Saved model at 37
2024-04-25 21:35:41 INFO     Val loss decrease from 5.0428 to 5.0305, saving to ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-04-25 21:35:46 INFO     epoch complete!
2024-04-25 21:35:46 INFO     evaluating now!
2024-04-25 21:35:47 INFO     Epoch [38/200] train_loss: 3.8649, val_loss: 5.1419, lr: 0.003000, 5.41s
2024-04-25 21:35:51 INFO     epoch complete!
2024-04-25 21:35:51 INFO     evaluating now!
2024-04-25 21:35:52 INFO     Epoch [39/200] train_loss: 3.8456, val_loss: 5.1728, lr: 0.003000, 5.04s
2024-04-25 21:35:56 INFO     epoch complete!
2024-04-25 21:35:56 INFO     evaluating now!
2024-04-25 21:35:57 INFO     Epoch [40/200] train_loss: 3.7892, val_loss: 5.0439, lr: 0.003000, 4.90s
2024-04-25 21:36:01 INFO     epoch complete!
2024-04-25 21:36:01 INFO     evaluating now!
2024-04-25 21:36:02 INFO     Epoch [41/200] train_loss: 3.7941, val_loss: 5.1137, lr: 0.003000, 5.09s
2024-04-25 21:36:06 INFO     epoch complete!
2024-04-25 21:36:06 INFO     evaluating now!
2024-04-25 21:36:07 INFO     Epoch [42/200] train_loss: 3.7757, val_loss: 5.0636, lr: 0.003000, 4.92s
2024-04-25 21:36:11 INFO     epoch complete!
2024-04-25 21:36:11 INFO     evaluating now!
2024-04-25 21:36:12 INFO     Epoch [43/200] train_loss: 3.7103, val_loss: 5.0162, lr: 0.003000, 5.05s
2024-04-25 21:36:12 INFO     Saved model at 43
2024-04-25 21:36:12 INFO     Val loss decrease from 5.0305 to 5.0162, saving to ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-04-25 21:36:17 INFO     epoch complete!
2024-04-25 21:36:17 INFO     evaluating now!
2024-04-25 21:36:17 INFO     Epoch [44/200] train_loss: 3.7054, val_loss: 5.1090, lr: 0.003000, 5.60s
2024-04-25 21:36:23 INFO     epoch complete!
2024-04-25 21:36:23 INFO     evaluating now!
2024-04-25 21:36:23 INFO     Epoch [45/200] train_loss: 3.6991, val_loss: 5.1158, lr: 0.003000, 5.68s
2024-04-25 21:36:28 INFO     epoch complete!
2024-04-25 21:36:28 INFO     evaluating now!
2024-04-25 21:36:29 INFO     Epoch [46/200] train_loss: 3.6925, val_loss: 5.0390, lr: 0.003000, 5.54s
2024-04-25 21:36:34 INFO     epoch complete!
2024-04-25 21:36:34 INFO     evaluating now!
2024-04-25 21:36:34 INFO     Epoch [47/200] train_loss: 3.7068, val_loss: 5.1134, lr: 0.003000, 5.31s
2024-04-25 21:36:39 INFO     epoch complete!
2024-04-25 21:36:39 INFO     evaluating now!
2024-04-25 21:36:39 INFO     Epoch [48/200] train_loss: 3.6108, val_loss: 5.2069, lr: 0.003000, 5.01s
2024-04-25 21:36:43 INFO     epoch complete!
2024-04-25 21:36:43 INFO     evaluating now!
2024-04-25 21:36:44 INFO     Epoch [49/200] train_loss: 3.6331, val_loss: 5.1980, lr: 0.003000, 4.81s
2024-04-25 21:36:48 INFO     epoch complete!
2024-04-25 21:36:48 INFO     evaluating now!
2024-04-25 21:36:49 INFO     Epoch [50/200] train_loss: 3.6577, val_loss: 5.1119, lr: 0.003000, 4.94s
2024-04-25 21:36:53 INFO     epoch complete!
2024-04-25 21:36:53 INFO     evaluating now!
2024-04-25 21:36:54 INFO     Epoch [51/200] train_loss: 3.6036, val_loss: 5.0951, lr: 0.003000, 5.03s
2024-04-25 21:36:58 INFO     epoch complete!
2024-04-25 21:36:58 INFO     evaluating now!
2024-04-25 21:36:59 INFO     Epoch [52/200] train_loss: 3.5611, val_loss: 5.0695, lr: 0.003000, 4.85s
2024-04-25 21:37:03 INFO     epoch complete!
2024-04-25 21:37:03 INFO     evaluating now!
2024-04-25 21:37:03 INFO     Epoch [53/200] train_loss: 3.5694, val_loss: 5.1871, lr: 0.003000, 4.84s
2024-04-25 21:37:08 INFO     epoch complete!
2024-04-25 21:37:08 INFO     evaluating now!
2024-04-25 21:37:08 INFO     Epoch [54/200] train_loss: 3.5687, val_loss: 5.1189, lr: 0.003000, 4.86s
2024-04-25 21:37:13 INFO     epoch complete!
2024-04-25 21:37:13 INFO     evaluating now!
2024-04-25 21:37:13 INFO     Epoch [55/200] train_loss: 3.5584, val_loss: 5.1280, lr: 0.003000, 4.71s
2024-04-25 21:37:17 INFO     epoch complete!
2024-04-25 21:37:17 INFO     evaluating now!
2024-04-25 21:37:18 INFO     Epoch [56/200] train_loss: 3.5188, val_loss: 5.3550, lr: 0.003000, 4.76s
2024-04-25 21:37:22 INFO     epoch complete!
2024-04-25 21:37:22 INFO     evaluating now!
2024-04-25 21:37:23 INFO     Epoch [57/200] train_loss: 3.5018, val_loss: 5.0563, lr: 0.003000, 4.83s
2024-04-25 21:37:27 INFO     epoch complete!
2024-04-25 21:37:27 INFO     evaluating now!
2024-04-25 21:37:27 INFO     Epoch [58/200] train_loss: 3.4642, val_loss: 5.0934, lr: 0.003000, 4.82s
2024-04-25 21:37:27 WARNING  Early stopping at epoch: 58
2024-04-25 21:37:27 INFO     Trained totally 59 epochs, average train time is 4.820s, average eval time is 0.285s
2024-04-25 21:37:28 INFO     Loaded model at 43
2024-04-25 21:37:28 INFO     Saved model at ./libcity/cache/0/model_cache/AGCRN_CHITaxi20190406.m
2024-04-25 21:37:28 INFO     Start evaluating ...
2024-04-25 21:37:30 INFO     Note that you select the single mode to evaluate!
2024-04-25 21:37:30 INFO     Evaluate result is saved at ./libcity/cache/0/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-25 21:37:30 INFO     
         MAE       RMSE
1   2.385122   7.147704
2   2.484993   7.629741
3   2.602876   8.561806
4   2.707775   9.354741
5   2.928938  10.249114
6   3.006851  11.053066
7   3.064904  11.784029
8   3.119812  12.342689
9   3.138944  12.600263
10  3.209283  12.780849
11  3.238673  12.986001
12  3.358760  13.390712
2024-04-25 21:37:30 INFO     ----------------------------------------------------------------------------
2024-04-25 21:37:30 INFO     # 1, Kownledge Graph Embedding: None, Experiment ids: 1
2024-04-25 21:37:30 INFO     ----------------------------------------------------------------------------
2024-04-25 21:37:31 INFO     Log directory: ./libcity/log
2024-04-25 21:37:31 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=1
2024-04-25 21:37:31 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 366046530, 'exp_id': 1, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-25 21:37:32 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-25 21:37:32 INFO     set_weight_link_or_dist: dist
2024-04-25 21:37:32 INFO     init_weight_inf_or_zero: inf
2024-04-25 21:37:32 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-25 21:37:32 INFO     Start Calculate the weight by Gauss kernel!
2024-04-25 21:37:32 INFO     Loading file CHITaxi20190406.dyna
2024-04-25 21:37:32 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-25 21:37:32 INFO     Dataset created
2024-04-25 21:37:32 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-04-25 21:37:32 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-04-25 21:37:32 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-04-25 21:37:32 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-04-25 21:37:32 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-25 21:37:32 INFO     NoneScaler
2024-04-25 21:37:33 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-25 21:37:33 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-25 21:37:33 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-04-25 21:37:33 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 21:37:33 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-04-25 21:37:33 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 21:37:33 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-25 21:37:33 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 21:37:33 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-25 21:37:33 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 21:37:33 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-25 21:37:33 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-25 21:37:33 INFO     Total parameter numbers: 751130
2024-04-25 21:37:33 INFO     You select `adam` optimizer.
2024-04-25 21:37:33 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-25 21:37:33 INFO     Start training ...
2024-04-25 21:37:33 INFO     num_batches:48
2024-04-25 21:37:38 INFO     epoch complete!
2024-04-25 21:37:38 INFO     evaluating now!
2024-04-25 21:37:39 INFO     Epoch [0/200] train_loss: 25.2036, val_loss: 16.9349, lr: 0.003000, 5.33s
2024-04-25 21:37:39 INFO     Saved model at 0
2024-04-25 21:37:39 INFO     Val loss decrease from inf to 16.9349, saving to ./libcity/cache/1/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-25 21:37:44 INFO     epoch complete!
2024-04-25 21:37:44 INFO     evaluating now!
2024-04-25 21:37:44 INFO     Epoch [1/200] train_loss: 13.3040, val_loss: 12.3737, lr: 0.003000, 5.38s
2024-04-25 21:37:44 INFO     Saved model at 1
2024-04-25 21:37:44 INFO     Val loss decrease from 16.9349 to 12.3737, saving to ./libcity/cache/1/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-25 21:37:50 INFO     epoch complete!
2024-04-25 21:37:50 INFO     evaluating now!
2024-04-25 21:37:50 INFO     Epoch [2/200] train_loss: 10.2846, val_loss: 9.5790, lr: 0.003000, 5.44s
2024-04-25 21:37:50 INFO     Saved model at 2
2024-04-25 21:37:50 INFO     Val loss decrease from 12.3737 to 9.5790, saving to ./libcity/cache/1/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-25 21:37:55 INFO     epoch complete!
2024-04-25 21:37:55 INFO     evaluating now!
2024-04-25 21:37:56 INFO     Epoch [3/200] train_loss: 8.4270, val_loss: 7.8054, lr: 0.003000, 5.58s
2024-04-25 21:37:56 INFO     Saved model at 3
2024-04-25 21:37:56 INFO     Val loss decrease from 9.5790 to 7.8054, saving to ./libcity/cache/1/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-25 21:38:01 INFO     epoch complete!
2024-04-25 21:38:01 INFO     evaluating now!
2024-04-25 21:38:01 INFO     Epoch [4/200] train_loss: 7.3568, val_loss: 6.9988, lr: 0.003000, 5.39s
2024-04-25 21:38:02 INFO     Saved model at 4
2024-04-25 21:38:02 INFO     Val loss decrease from 7.8054 to 6.9988, saving to ./libcity/cache/1/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-25 21:38:07 INFO     epoch complete!
2024-04-25 21:38:07 INFO     evaluating now!
2024-04-25 21:38:07 INFO     Epoch [5/200] train_loss: 6.6966, val_loss: 6.7459, lr: 0.003000, 5.40s
2024-04-25 21:38:07 INFO     Saved model at 5
2024-04-25 21:38:07 INFO     Val loss decrease from 6.9988 to 6.7459, saving to ./libcity/cache/1/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-25 21:38:12 INFO     epoch complete!
2024-04-25 21:38:12 INFO     evaluating now!
2024-04-25 21:38:13 INFO     Epoch [6/200] train_loss: 6.2970, val_loss: 6.2911, lr: 0.003000, 5.25s
2024-04-25 21:38:13 INFO     Saved model at 6
2024-04-25 21:38:13 INFO     Val loss decrease from 6.7459 to 6.2911, saving to ./libcity/cache/1/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-25 21:38:18 INFO     epoch complete!
2024-04-25 21:38:18 INFO     evaluating now!
2024-04-25 21:38:18 INFO     Epoch [7/200] train_loss: 5.9399, val_loss: 6.1632, lr: 0.003000, 5.46s
2024-04-25 21:38:18 INFO     Saved model at 7
2024-04-25 21:38:18 INFO     Val loss decrease from 6.2911 to 6.1632, saving to ./libcity/cache/1/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-25 21:38:23 INFO     epoch complete!
2024-04-25 21:38:23 INFO     evaluating now!
2024-04-25 21:38:24 INFO     Epoch [8/200] train_loss: 5.7058, val_loss: 5.8728, lr: 0.003000, 5.32s
2024-04-25 21:38:24 INFO     Saved model at 8
2024-04-25 21:38:24 INFO     Val loss decrease from 6.1632 to 5.8728, saving to ./libcity/cache/1/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-25 21:38:29 INFO     epoch complete!
2024-04-25 21:38:29 INFO     evaluating now!
2024-04-25 21:38:30 INFO     Epoch [9/200] train_loss: 5.5836, val_loss: 5.6681, lr: 0.003000, 5.56s
2024-04-25 21:38:30 INFO     Saved model at 9
2024-04-25 21:38:30 INFO     Val loss decrease from 5.8728 to 5.6681, saving to ./libcity/cache/1/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-25 21:38:35 INFO     epoch complete!
2024-04-25 21:38:35 INFO     evaluating now!
2024-04-25 21:38:35 INFO     Epoch [10/200] train_loss: 5.3429, val_loss: 5.4363, lr: 0.003000, 5.36s
2024-04-25 21:38:35 INFO     Saved model at 10
2024-04-25 21:38:35 INFO     Val loss decrease from 5.6681 to 5.4363, saving to ./libcity/cache/1/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-25 21:38:40 INFO     epoch complete!
2024-04-25 21:38:40 INFO     evaluating now!
2024-04-25 21:38:41 INFO     Epoch [11/200] train_loss: 5.2241, val_loss: 5.6146, lr: 0.003000, 5.18s
2024-04-25 21:38:46 INFO     epoch complete!
2024-04-25 21:38:46 INFO     evaluating now!
2024-04-25 21:38:46 INFO     Epoch [12/200] train_loss: 5.1651, val_loss: 5.6751, lr: 0.003000, 5.20s
2024-04-25 21:38:51 INFO     epoch complete!
2024-04-25 21:38:51 INFO     evaluating now!
2024-04-25 21:38:51 INFO     Epoch [13/200] train_loss: 5.0408, val_loss: 5.2855, lr: 0.003000, 5.30s
2024-04-25 21:38:51 INFO     Saved model at 13
2024-04-25 21:38:51 INFO     Val loss decrease from 5.4363 to 5.2855, saving to ./libcity/cache/1/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-25 21:38:56 INFO     epoch complete!
2024-04-25 21:38:56 INFO     evaluating now!
2024-04-25 21:38:57 INFO     Epoch [14/200] train_loss: 4.8979, val_loss: 5.2828, lr: 0.003000, 5.31s
2024-04-25 21:38:57 INFO     Saved model at 14
2024-04-25 21:38:57 INFO     Val loss decrease from 5.2855 to 5.2828, saving to ./libcity/cache/1/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-25 21:39:02 INFO     epoch complete!
2024-04-25 21:39:02 INFO     evaluating now!
2024-04-25 21:39:02 INFO     Epoch [15/200] train_loss: 4.7885, val_loss: 5.2565, lr: 0.003000, 5.38s
2024-04-25 21:39:02 INFO     Saved model at 15
2024-04-25 21:39:02 INFO     Val loss decrease from 5.2828 to 5.2565, saving to ./libcity/cache/1/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-04-25 21:39:08 INFO     epoch complete!
2024-04-25 21:39:08 INFO     evaluating now!
2024-04-25 21:39:08 INFO     Epoch [16/200] train_loss: 4.8166, val_loss: 5.4572, lr: 0.003000, 5.42s
2024-04-25 21:39:13 INFO     epoch complete!
2024-04-25 21:39:13 INFO     evaluating now!
2024-04-25 21:39:13 INFO     Epoch [17/200] train_loss: 4.7281, val_loss: 5.4214, lr: 0.003000, 5.32s
2024-04-25 21:39:18 INFO     epoch complete!
2024-04-25 21:39:18 INFO     evaluating now!
2024-04-25 21:39:18 INFO     Epoch [18/200] train_loss: 4.6334, val_loss: 5.2138, lr: 0.003000, 5.22s
2024-04-25 21:39:19 INFO     Saved model at 18
2024-04-25 21:39:19 INFO     Val loss decrease from 5.2565 to 5.2138, saving to ./libcity/cache/1/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-25 21:39:24 INFO     epoch complete!
2024-04-25 21:39:24 INFO     evaluating now!
2024-04-25 21:39:24 INFO     Epoch [19/200] train_loss: 4.6099, val_loss: 5.2190, lr: 0.003000, 5.16s
2024-04-25 21:39:29 INFO     epoch complete!
2024-04-25 21:39:29 INFO     evaluating now!
2024-04-25 21:39:29 INFO     Epoch [20/200] train_loss: 4.4879, val_loss: 5.0675, lr: 0.003000, 5.18s
2024-04-25 21:39:29 INFO     Saved model at 20
2024-04-25 21:39:29 INFO     Val loss decrease from 5.2138 to 5.0675, saving to ./libcity/cache/1/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-04-25 21:39:34 INFO     epoch complete!
2024-04-25 21:39:34 INFO     evaluating now!
2024-04-25 21:39:35 INFO     Epoch [21/200] train_loss: 4.4971, val_loss: 5.2179, lr: 0.003000, 5.29s
2024-04-25 21:39:39 INFO     epoch complete!
2024-04-25 21:39:39 INFO     evaluating now!
2024-04-25 21:39:40 INFO     Epoch [22/200] train_loss: 4.4036, val_loss: 5.1877, lr: 0.003000, 5.21s
2024-04-25 21:39:45 INFO     epoch complete!
2024-04-25 21:39:45 INFO     evaluating now!
2024-04-25 21:39:45 INFO     Epoch [23/200] train_loss: 4.3522, val_loss: 5.3231, lr: 0.003000, 5.35s
2024-04-25 21:39:50 INFO     epoch complete!
2024-04-25 21:39:50 INFO     evaluating now!
2024-04-25 21:39:51 INFO     Epoch [24/200] train_loss: 4.3080, val_loss: 5.2543, lr: 0.003000, 5.43s
2024-04-25 21:39:56 INFO     epoch complete!
2024-04-25 21:39:56 INFO     evaluating now!
2024-04-25 21:39:56 INFO     Epoch [25/200] train_loss: 4.2888, val_loss: 5.2840, lr: 0.003000, 5.45s
2024-04-25 21:40:01 INFO     epoch complete!
2024-04-25 21:40:01 INFO     evaluating now!
2024-04-25 21:40:01 INFO     Epoch [26/200] train_loss: 4.2582, val_loss: 5.1091, lr: 0.003000, 5.46s
2024-04-25 21:40:06 INFO     epoch complete!
2024-04-25 21:40:06 INFO     evaluating now!
2024-04-25 21:40:07 INFO     Epoch [27/200] train_loss: 4.2252, val_loss: 5.1571, lr: 0.003000, 5.26s
2024-04-25 21:40:12 INFO     epoch complete!
2024-04-25 21:40:12 INFO     evaluating now!
2024-04-25 21:40:12 INFO     Epoch [28/200] train_loss: 4.1120, val_loss: 5.1165, lr: 0.003000, 5.65s
2024-04-25 21:40:18 INFO     epoch complete!
2024-04-25 21:40:18 INFO     evaluating now!
2024-04-25 21:40:18 INFO     Epoch [29/200] train_loss: 4.0866, val_loss: 5.0938, lr: 0.003000, 5.55s
2024-04-25 21:40:23 INFO     epoch complete!
2024-04-25 21:40:23 INFO     evaluating now!
2024-04-25 21:40:24 INFO     Epoch [30/200] train_loss: 4.0928, val_loss: 5.1270, lr: 0.003000, 5.73s
2024-04-25 21:40:29 INFO     epoch complete!
2024-04-25 21:40:29 INFO     evaluating now!
2024-04-25 21:40:29 INFO     Epoch [31/200] train_loss: 4.0877, val_loss: 5.2629, lr: 0.003000, 5.47s
2024-04-25 21:40:35 INFO     epoch complete!
2024-04-25 21:40:35 INFO     evaluating now!
2024-04-25 21:40:35 INFO     Epoch [32/200] train_loss: 4.0018, val_loss: 5.0571, lr: 0.003000, 5.73s
2024-04-25 21:40:35 INFO     Saved model at 32
2024-04-25 21:40:35 INFO     Val loss decrease from 5.0675 to 5.0571, saving to ./libcity/cache/1/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-04-25 21:40:40 INFO     epoch complete!
2024-04-25 21:40:40 INFO     evaluating now!
2024-04-25 21:40:41 INFO     Epoch [33/200] train_loss: 3.9670, val_loss: 5.0424, lr: 0.003000, 5.49s
2024-04-25 21:40:41 INFO     Saved model at 33
2024-04-25 21:40:41 INFO     Val loss decrease from 5.0571 to 5.0424, saving to ./libcity/cache/1/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-04-25 21:40:46 INFO     epoch complete!
2024-04-25 21:40:46 INFO     evaluating now!
2024-04-25 21:40:46 INFO     Epoch [34/200] train_loss: 3.9364, val_loss: 5.2449, lr: 0.003000, 5.58s
2024-04-25 21:40:52 INFO     epoch complete!
2024-04-25 21:40:52 INFO     evaluating now!
2024-04-25 21:40:52 INFO     Epoch [35/200] train_loss: 3.9575, val_loss: 5.2670, lr: 0.003000, 5.58s
2024-04-25 21:40:57 INFO     epoch complete!
2024-04-25 21:40:57 INFO     evaluating now!
2024-04-25 21:40:58 INFO     Epoch [36/200] train_loss: 3.8905, val_loss: 5.2009, lr: 0.003000, 5.59s
2024-04-25 21:41:03 INFO     epoch complete!
2024-04-25 21:41:03 INFO     evaluating now!
2024-04-25 21:41:03 INFO     Epoch [37/200] train_loss: 3.8697, val_loss: 5.1803, lr: 0.003000, 5.51s
2024-04-25 21:41:08 INFO     epoch complete!
2024-04-25 21:41:08 INFO     evaluating now!
2024-04-25 21:41:09 INFO     Epoch [38/200] train_loss: 3.8581, val_loss: 5.1635, lr: 0.003000, 5.48s
2024-04-25 21:41:14 INFO     epoch complete!
2024-04-25 21:41:14 INFO     evaluating now!
2024-04-25 21:41:14 INFO     Epoch [39/200] train_loss: 3.8734, val_loss: 5.3521, lr: 0.003000, 5.54s
2024-04-25 21:41:19 INFO     epoch complete!
2024-04-25 21:41:19 INFO     evaluating now!
2024-04-25 21:41:19 INFO     Epoch [40/200] train_loss: 3.8524, val_loss: 5.1533, lr: 0.003000, 5.37s
2024-04-25 21:41:24 INFO     epoch complete!
2024-04-25 21:41:24 INFO     evaluating now!
2024-04-25 21:41:25 INFO     Epoch [41/200] train_loss: 3.7443, val_loss: 5.1005, lr: 0.003000, 5.36s
2024-04-25 21:41:30 INFO     epoch complete!
2024-04-25 21:41:30 INFO     evaluating now!
2024-04-25 21:41:30 INFO     Epoch [42/200] train_loss: 3.7626, val_loss: 5.2972, lr: 0.003000, 5.41s
2024-04-25 21:41:35 INFO     epoch complete!
2024-04-25 21:41:35 INFO     evaluating now!
2024-04-25 21:41:35 INFO     Epoch [43/200] train_loss: 3.7356, val_loss: 5.2784, lr: 0.003000, 5.22s
2024-04-25 21:41:40 INFO     epoch complete!
2024-04-25 21:41:40 INFO     evaluating now!
2024-04-25 21:41:41 INFO     Epoch [44/200] train_loss: 3.7742, val_loss: 5.1926, lr: 0.003000, 5.27s
2024-04-25 21:41:46 INFO     epoch complete!
2024-04-25 21:41:46 INFO     evaluating now!
2024-04-25 21:41:46 INFO     Epoch [45/200] train_loss: 3.6805, val_loss: 5.1163, lr: 0.003000, 5.30s
2024-04-25 21:41:51 INFO     epoch complete!
2024-04-25 21:41:51 INFO     evaluating now!
2024-04-25 21:41:51 INFO     Epoch [46/200] train_loss: 3.6340, val_loss: 5.0487, lr: 0.003000, 5.24s
2024-04-25 21:41:56 INFO     epoch complete!
2024-04-25 21:41:56 INFO     evaluating now!
2024-04-25 21:41:57 INFO     Epoch [47/200] train_loss: 3.6743, val_loss: 5.0966, lr: 0.003000, 5.39s
2024-04-25 21:42:02 INFO     epoch complete!
2024-04-25 21:42:02 INFO     evaluating now!
2024-04-25 21:42:02 INFO     Epoch [48/200] train_loss: 3.6667, val_loss: 5.3378, lr: 0.003000, 5.44s
2024-04-25 21:42:02 WARNING  Early stopping at epoch: 48
2024-04-25 21:42:02 INFO     Trained totally 49 epochs, average train time is 5.110s, average eval time is 0.286s
2024-04-25 21:42:02 INFO     Loaded model at 33
2024-04-25 21:42:02 INFO     Saved model at ./libcity/cache/1/model_cache/AGCRN_CHITaxi20190406.m
2024-04-25 21:42:02 INFO     Start evaluating ...
2024-04-25 21:42:04 INFO     Note that you select the single mode to evaluate!
2024-04-25 21:42:04 INFO     Evaluate result is saved at ./libcity/cache/1/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-25 21:42:04 INFO     
         MAE       RMSE
1   2.347394   7.116907
2   2.509230   7.884543
3   2.799341   9.740430
4   3.054708  11.573451
5   3.210553  12.951366
6   3.349180  13.639627
7   3.379188  13.590089
8   3.350291  13.386375
9   3.356879  13.024035
10  3.297792  12.742961
11  3.400984  12.915261
12  3.501217  13.282269
2024-04-25 21:42:04 INFO     ----------------------------------------------------------------------------
2024-04-25 21:42:04 INFO     # 2, Kownledge Graph Embedding: None, Experiment ids: 2
2024-04-25 21:42:04 INFO     ----------------------------------------------------------------------------
2024-04-25 21:42:05 INFO     Log directory: ./libcity/log
2024-04-25 21:42:05 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=2
2024-04-25 21:42:05 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 659813631, 'exp_id': 2, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-25 21:42:06 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-25 21:42:06 INFO     set_weight_link_or_dist: dist
2024-04-25 21:42:06 INFO     init_weight_inf_or_zero: inf
2024-04-25 21:42:06 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-25 21:42:06 INFO     Start Calculate the weight by Gauss kernel!
2024-04-25 21:42:06 INFO     Loading file CHITaxi20190406.dyna
2024-04-25 21:42:06 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-25 21:42:06 INFO     Dataset created
2024-04-25 21:42:06 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-04-25 21:42:06 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-04-25 21:42:06 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-04-25 21:42:06 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-04-25 21:42:06 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-25 21:42:06 INFO     NoneScaler
2024-04-25 21:42:07 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-25 21:42:07 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-25 21:42:07 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-04-25 21:42:07 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 21:42:07 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-04-25 21:42:07 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 21:42:07 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-25 21:42:07 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 21:42:07 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-25 21:42:07 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 21:42:07 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-25 21:42:07 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-25 21:42:07 INFO     Total parameter numbers: 751130
2024-04-25 21:42:07 INFO     You select `adam` optimizer.
2024-04-25 21:42:07 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-25 21:42:07 INFO     Start training ...
2024-04-25 21:42:07 INFO     num_batches:48
2024-04-25 21:42:12 INFO     epoch complete!
2024-04-25 21:42:12 INFO     evaluating now!
2024-04-25 21:42:12 INFO     Epoch [0/200] train_loss: 24.3886, val_loss: 16.8801, lr: 0.003000, 5.32s
2024-04-25 21:42:13 INFO     Saved model at 0
2024-04-25 21:42:13 INFO     Val loss decrease from inf to 16.8801, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-25 21:42:18 INFO     epoch complete!
2024-04-25 21:42:18 INFO     evaluating now!
2024-04-25 21:42:18 INFO     Epoch [1/200] train_loss: 13.1245, val_loss: 11.9393, lr: 0.003000, 5.48s
2024-04-25 21:42:18 INFO     Saved model at 1
2024-04-25 21:42:18 INFO     Val loss decrease from 16.8801 to 11.9393, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-25 21:42:24 INFO     epoch complete!
2024-04-25 21:42:24 INFO     evaluating now!
2024-04-25 21:42:24 INFO     Epoch [2/200] train_loss: 9.8150, val_loss: 8.8355, lr: 0.003000, 5.74s
2024-04-25 21:42:24 INFO     Saved model at 2
2024-04-25 21:42:24 INFO     Val loss decrease from 11.9393 to 8.8355, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-25 21:42:30 INFO     epoch complete!
2024-04-25 21:42:30 INFO     evaluating now!
2024-04-25 21:42:30 INFO     Epoch [3/200] train_loss: 8.1422, val_loss: 7.8524, lr: 0.003000, 5.67s
2024-04-25 21:42:30 INFO     Saved model at 3
2024-04-25 21:42:30 INFO     Val loss decrease from 8.8355 to 7.8524, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-25 21:42:35 INFO     epoch complete!
2024-04-25 21:42:35 INFO     evaluating now!
2024-04-25 21:42:36 INFO     Epoch [4/200] train_loss: 7.2713, val_loss: 6.9966, lr: 0.003000, 5.41s
2024-04-25 21:42:36 INFO     Saved model at 4
2024-04-25 21:42:36 INFO     Val loss decrease from 7.8524 to 6.9966, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-25 21:42:41 INFO     epoch complete!
2024-04-25 21:42:41 INFO     evaluating now!
2024-04-25 21:42:42 INFO     Epoch [5/200] train_loss: 6.7447, val_loss: 6.7437, lr: 0.003000, 5.42s
2024-04-25 21:42:42 INFO     Saved model at 5
2024-04-25 21:42:42 INFO     Val loss decrease from 6.9966 to 6.7437, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-25 21:42:47 INFO     epoch complete!
2024-04-25 21:42:47 INFO     evaluating now!
2024-04-25 21:42:47 INFO     Epoch [6/200] train_loss: 6.3532, val_loss: 6.3091, lr: 0.003000, 5.41s
2024-04-25 21:42:47 INFO     Saved model at 6
2024-04-25 21:42:47 INFO     Val loss decrease from 6.7437 to 6.3091, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-25 21:42:52 INFO     epoch complete!
2024-04-25 21:42:52 INFO     evaluating now!
2024-04-25 21:42:53 INFO     Epoch [7/200] train_loss: 6.0221, val_loss: 6.1328, lr: 0.003000, 5.29s
2024-04-25 21:42:53 INFO     Saved model at 7
2024-04-25 21:42:53 INFO     Val loss decrease from 6.3091 to 6.1328, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-25 21:42:58 INFO     epoch complete!
2024-04-25 21:42:58 INFO     evaluating now!
2024-04-25 21:42:58 INFO     Epoch [8/200] train_loss: 5.7889, val_loss: 5.8381, lr: 0.003000, 5.40s
2024-04-25 21:42:59 INFO     Saved model at 8
2024-04-25 21:42:59 INFO     Val loss decrease from 6.1328 to 5.8381, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-25 21:43:04 INFO     epoch complete!
2024-04-25 21:43:04 INFO     evaluating now!
2024-04-25 21:43:04 INFO     Epoch [9/200] train_loss: 5.6118, val_loss: 5.8968, lr: 0.003000, 5.36s
2024-04-25 21:43:09 INFO     epoch complete!
2024-04-25 21:43:09 INFO     evaluating now!
2024-04-25 21:43:09 INFO     Epoch [10/200] train_loss: 5.4552, val_loss: 5.8984, lr: 0.003000, 5.25s
2024-04-25 21:43:14 INFO     epoch complete!
2024-04-25 21:43:14 INFO     evaluating now!
2024-04-25 21:43:15 INFO     Epoch [11/200] train_loss: 5.3272, val_loss: 5.6519, lr: 0.003000, 5.42s
2024-04-25 21:43:15 INFO     Saved model at 11
2024-04-25 21:43:15 INFO     Val loss decrease from 5.8381 to 5.6519, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-25 21:43:20 INFO     epoch complete!
2024-04-25 21:43:20 INFO     evaluating now!
2024-04-25 21:43:20 INFO     Epoch [12/200] train_loss: 5.1850, val_loss: 5.4326, lr: 0.003000, 5.39s
2024-04-25 21:43:20 INFO     Saved model at 12
2024-04-25 21:43:20 INFO     Val loss decrease from 5.6519 to 5.4326, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-25 21:43:26 INFO     epoch complete!
2024-04-25 21:43:26 INFO     evaluating now!
2024-04-25 21:43:26 INFO     Epoch [13/200] train_loss: 5.0647, val_loss: 5.4092, lr: 0.003000, 5.46s
2024-04-25 21:43:26 INFO     Saved model at 13
2024-04-25 21:43:26 INFO     Val loss decrease from 5.4326 to 5.4092, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-25 21:43:31 INFO     epoch complete!
2024-04-25 21:43:31 INFO     evaluating now!
2024-04-25 21:43:32 INFO     Epoch [14/200] train_loss: 4.9290, val_loss: 5.4034, lr: 0.003000, 5.54s
2024-04-25 21:43:32 INFO     Saved model at 14
2024-04-25 21:43:32 INFO     Val loss decrease from 5.4092 to 5.4034, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-25 21:43:37 INFO     epoch complete!
2024-04-25 21:43:37 INFO     evaluating now!
2024-04-25 21:43:37 INFO     Epoch [15/200] train_loss: 4.9271, val_loss: 5.6829, lr: 0.003000, 5.50s
2024-04-25 21:43:43 INFO     epoch complete!
2024-04-25 21:43:43 INFO     evaluating now!
2024-04-25 21:43:43 INFO     Epoch [16/200] train_loss: 4.8277, val_loss: 5.3172, lr: 0.003000, 5.42s
2024-04-25 21:43:43 INFO     Saved model at 16
2024-04-25 21:43:43 INFO     Val loss decrease from 5.4034 to 5.3172, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-25 21:43:49 INFO     epoch complete!
2024-04-25 21:43:49 INFO     evaluating now!
2024-04-25 21:43:49 INFO     Epoch [17/200] train_loss: 4.7330, val_loss: 5.4272, lr: 0.003000, 5.89s
2024-04-25 21:43:55 INFO     epoch complete!
2024-04-25 21:43:55 INFO     evaluating now!
2024-04-25 21:43:55 INFO     Epoch [18/200] train_loss: 4.6408, val_loss: 5.2057, lr: 0.003000, 6.14s
2024-04-25 21:43:55 INFO     Saved model at 18
2024-04-25 21:43:55 INFO     Val loss decrease from 5.3172 to 5.2057, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-25 21:44:01 INFO     epoch complete!
2024-04-25 21:44:01 INFO     evaluating now!
2024-04-25 21:44:02 INFO     Epoch [19/200] train_loss: 4.5601, val_loss: 5.3589, lr: 0.003000, 6.12s
2024-04-25 21:44:07 INFO     epoch complete!
2024-04-25 21:44:07 INFO     evaluating now!
2024-04-25 21:44:07 INFO     Epoch [20/200] train_loss: 4.4949, val_loss: 5.2722, lr: 0.003000, 5.82s
2024-04-25 21:44:13 INFO     epoch complete!
2024-04-25 21:44:13 INFO     evaluating now!
2024-04-25 21:44:13 INFO     Epoch [21/200] train_loss: 4.5458, val_loss: 5.3947, lr: 0.003000, 5.43s
2024-04-25 21:44:18 INFO     epoch complete!
2024-04-25 21:44:18 INFO     evaluating now!
2024-04-25 21:44:18 INFO     Epoch [22/200] train_loss: 4.4575, val_loss: 5.1759, lr: 0.003000, 5.41s
2024-04-25 21:44:18 INFO     Saved model at 22
2024-04-25 21:44:18 INFO     Val loss decrease from 5.2057 to 5.1759, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-04-25 21:44:24 INFO     epoch complete!
2024-04-25 21:44:24 INFO     evaluating now!
2024-04-25 21:44:24 INFO     Epoch [23/200] train_loss: 4.3345, val_loss: 5.3401, lr: 0.003000, 5.54s
2024-04-25 21:44:29 INFO     epoch complete!
2024-04-25 21:44:29 INFO     evaluating now!
2024-04-25 21:44:29 INFO     Epoch [24/200] train_loss: 4.3680, val_loss: 5.2708, lr: 0.003000, 5.43s
2024-04-25 21:44:34 INFO     epoch complete!
2024-04-25 21:44:34 INFO     evaluating now!
2024-04-25 21:44:34 INFO     Epoch [25/200] train_loss: 4.2735, val_loss: 5.0623, lr: 0.003000, 5.14s
2024-04-25 21:44:35 INFO     Saved model at 25
2024-04-25 21:44:35 INFO     Val loss decrease from 5.1759 to 5.0623, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-25 21:44:39 INFO     epoch complete!
2024-04-25 21:44:39 INFO     evaluating now!
2024-04-25 21:44:40 INFO     Epoch [26/200] train_loss: 4.2260, val_loss: 5.2005, lr: 0.003000, 4.95s
2024-04-25 21:44:45 INFO     epoch complete!
2024-04-25 21:44:45 INFO     evaluating now!
2024-04-25 21:44:45 INFO     Epoch [27/200] train_loss: 4.1717, val_loss: 5.1732, lr: 0.003000, 5.29s
2024-04-25 21:44:50 INFO     epoch complete!
2024-04-25 21:44:50 INFO     evaluating now!
2024-04-25 21:44:51 INFO     Epoch [28/200] train_loss: 4.1550, val_loss: 5.2181, lr: 0.003000, 5.70s
2024-04-25 21:44:56 INFO     epoch complete!
2024-04-25 21:44:56 INFO     evaluating now!
2024-04-25 21:44:56 INFO     Epoch [29/200] train_loss: 4.1060, val_loss: 5.2383, lr: 0.003000, 5.76s
2024-04-25 21:45:01 INFO     epoch complete!
2024-04-25 21:45:01 INFO     evaluating now!
2024-04-25 21:45:02 INFO     Epoch [30/200] train_loss: 4.0623, val_loss: 5.1934, lr: 0.003000, 5.24s
2024-04-25 21:45:06 INFO     epoch complete!
2024-04-25 21:45:06 INFO     evaluating now!
2024-04-25 21:45:07 INFO     Epoch [31/200] train_loss: 4.0799, val_loss: 5.0373, lr: 0.003000, 5.11s
2024-04-25 21:45:07 INFO     Saved model at 31
2024-04-25 21:45:07 INFO     Val loss decrease from 5.0623 to 5.0373, saving to ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-04-25 21:45:11 INFO     epoch complete!
2024-04-25 21:45:12 INFO     evaluating now!
2024-04-25 21:45:12 INFO     Epoch [32/200] train_loss: 3.9800, val_loss: 5.1088, lr: 0.003000, 4.89s
2024-04-25 21:45:16 INFO     epoch complete!
2024-04-25 21:45:16 INFO     evaluating now!
2024-04-25 21:45:17 INFO     Epoch [33/200] train_loss: 3.9451, val_loss: 5.2028, lr: 0.003000, 4.98s
2024-04-25 21:45:21 INFO     epoch complete!
2024-04-25 21:45:21 INFO     evaluating now!
2024-04-25 21:45:22 INFO     Epoch [34/200] train_loss: 3.9349, val_loss: 5.1583, lr: 0.003000, 4.93s
2024-04-25 21:45:26 INFO     epoch complete!
2024-04-25 21:45:26 INFO     evaluating now!
2024-04-25 21:45:27 INFO     Epoch [35/200] train_loss: 3.8919, val_loss: 5.1525, lr: 0.003000, 4.88s
2024-04-25 21:45:31 INFO     epoch complete!
2024-04-25 21:45:31 INFO     evaluating now!
2024-04-25 21:45:31 INFO     Epoch [36/200] train_loss: 3.8625, val_loss: 5.2352, lr: 0.003000, 4.88s
2024-04-25 21:45:36 INFO     epoch complete!
2024-04-25 21:45:36 INFO     evaluating now!
2024-04-25 21:45:36 INFO     Epoch [37/200] train_loss: 3.8801, val_loss: 5.1352, lr: 0.003000, 4.90s
2024-04-25 21:45:41 INFO     epoch complete!
2024-04-25 21:45:41 INFO     evaluating now!
2024-04-25 21:45:41 INFO     Epoch [38/200] train_loss: 3.7944, val_loss: 5.2971, lr: 0.003000, 5.04s
2024-04-25 21:45:46 INFO     epoch complete!
2024-04-25 21:45:46 INFO     evaluating now!
2024-04-25 21:45:47 INFO     Epoch [39/200] train_loss: 3.8445, val_loss: 5.2378, lr: 0.003000, 5.17s
2024-04-25 21:45:51 INFO     epoch complete!
2024-04-25 21:45:51 INFO     evaluating now!
2024-04-25 21:45:52 INFO     Epoch [40/200] train_loss: 3.7906, val_loss: 5.1941, lr: 0.003000, 5.08s
2024-04-25 21:45:56 INFO     epoch complete!
2024-04-25 21:45:56 INFO     evaluating now!
2024-04-25 21:45:57 INFO     Epoch [41/200] train_loss: 3.7926, val_loss: 5.0518, lr: 0.003000, 5.01s
2024-04-25 21:46:01 INFO     epoch complete!
2024-04-25 21:46:01 INFO     evaluating now!
2024-04-25 21:46:02 INFO     Epoch [42/200] train_loss: 3.7469, val_loss: 5.2039, lr: 0.003000, 4.97s
2024-04-25 21:46:07 INFO     epoch complete!
2024-04-25 21:46:07 INFO     evaluating now!
2024-04-25 21:46:07 INFO     Epoch [43/200] train_loss: 3.7060, val_loss: 5.3248, lr: 0.003000, 5.28s
2024-04-25 21:46:12 INFO     epoch complete!
2024-04-25 21:46:12 INFO     evaluating now!
2024-04-25 21:46:13 INFO     Epoch [44/200] train_loss: 3.6941, val_loss: 5.1535, lr: 0.003000, 5.65s
2024-04-25 21:46:18 INFO     epoch complete!
2024-04-25 21:46:18 INFO     evaluating now!
2024-04-25 21:46:18 INFO     Epoch [45/200] train_loss: 3.6503, val_loss: 5.1187, lr: 0.003000, 5.76s
2024-04-25 21:46:24 INFO     epoch complete!
2024-04-25 21:46:24 INFO     evaluating now!
2024-04-25 21:46:24 INFO     Epoch [46/200] train_loss: 3.6636, val_loss: 5.1306, lr: 0.003000, 5.65s
2024-04-25 21:46:24 WARNING  Early stopping at epoch: 46
2024-04-25 21:46:24 INFO     Trained totally 47 epochs, average train time is 5.081s, average eval time is 0.290s
2024-04-25 21:46:24 INFO     Loaded model at 31
2024-04-25 21:46:24 INFO     Saved model at ./libcity/cache/2/model_cache/AGCRN_CHITaxi20190406.m
2024-04-25 21:46:25 INFO     Start evaluating ...
2024-04-25 21:46:26 INFO     Note that you select the single mode to evaluate!
2024-04-25 21:46:27 INFO     Evaluate result is saved at ./libcity/cache/2/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-25 21:46:27 INFO     
         MAE       RMSE
1   2.321579   7.148730
2   2.472503   7.892766
3   2.704643   9.110244
4   2.843674  10.141672
5   3.036447  11.148573
6   3.112984  11.990793
7   3.223541  12.682798
8   3.309210  13.424557
9   3.415259  13.743627
10  3.421756  14.067099
11  3.521841  14.125339
12  3.619710  14.597765
2024-04-25 21:46:27 INFO     ----------------------------------------------------------------------------
2024-04-25 21:46:27 INFO     # 3, Kownledge Graph Embedding: None, Experiment ids: 3
2024-04-25 21:46:27 INFO     ----------------------------------------------------------------------------
2024-04-25 21:46:28 INFO     Log directory: ./libcity/log
2024-04-25 21:46:28 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=3
2024-04-25 21:46:28 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 777429556, 'exp_id': 3, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-25 21:46:28 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-25 21:46:28 INFO     set_weight_link_or_dist: dist
2024-04-25 21:46:28 INFO     init_weight_inf_or_zero: inf
2024-04-25 21:46:28 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-25 21:46:28 INFO     Start Calculate the weight by Gauss kernel!
2024-04-25 21:46:28 INFO     Loading file CHITaxi20190406.dyna
2024-04-25 21:46:28 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-25 21:46:29 INFO     Dataset created
2024-04-25 21:46:29 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-04-25 21:46:29 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-04-25 21:46:29 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-04-25 21:46:29 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-04-25 21:46:29 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-25 21:46:29 INFO     NoneScaler
2024-04-25 21:46:29 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-25 21:46:29 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-25 21:46:29 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-04-25 21:46:29 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 21:46:29 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-04-25 21:46:29 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 21:46:29 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-25 21:46:29 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 21:46:29 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-25 21:46:29 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 21:46:29 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-25 21:46:29 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-25 21:46:29 INFO     Total parameter numbers: 751130
2024-04-25 21:46:29 INFO     You select `adam` optimizer.
2024-04-25 21:46:29 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-25 21:46:29 INFO     Start training ...
2024-04-25 21:46:29 INFO     num_batches:48
2024-04-25 21:46:35 INFO     epoch complete!
2024-04-25 21:46:35 INFO     evaluating now!
2024-04-25 21:46:35 INFO     Epoch [0/200] train_loss: 25.1544, val_loss: 17.4063, lr: 0.003000, 6.08s
2024-04-25 21:46:36 INFO     Saved model at 0
2024-04-25 21:46:36 INFO     Val loss decrease from inf to 17.4063, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-25 21:46:41 INFO     epoch complete!
2024-04-25 21:46:41 INFO     evaluating now!
2024-04-25 21:46:42 INFO     Epoch [1/200] train_loss: 13.7989, val_loss: 12.6873, lr: 0.003000, 6.15s
2024-04-25 21:46:42 INFO     Saved model at 1
2024-04-25 21:46:42 INFO     Val loss decrease from 17.4063 to 12.6873, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-25 21:46:48 INFO     epoch complete!
2024-04-25 21:46:48 INFO     evaluating now!
2024-04-25 21:46:48 INFO     Epoch [2/200] train_loss: 10.3937, val_loss: 9.6533, lr: 0.003000, 6.00s
2024-04-25 21:46:48 INFO     Saved model at 2
2024-04-25 21:46:48 INFO     Val loss decrease from 12.6873 to 9.6533, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-25 21:46:53 INFO     epoch complete!
2024-04-25 21:46:53 INFO     evaluating now!
2024-04-25 21:46:54 INFO     Epoch [3/200] train_loss: 8.4234, val_loss: 8.0639, lr: 0.003000, 5.51s
2024-04-25 21:46:54 INFO     Saved model at 3
2024-04-25 21:46:54 INFO     Val loss decrease from 9.6533 to 8.0639, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-25 21:46:59 INFO     epoch complete!
2024-04-25 21:46:59 INFO     evaluating now!
2024-04-25 21:46:59 INFO     Epoch [4/200] train_loss: 7.4446, val_loss: 7.1955, lr: 0.003000, 5.33s
2024-04-25 21:47:00 INFO     Saved model at 4
2024-04-25 21:47:00 INFO     Val loss decrease from 8.0639 to 7.1955, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-25 21:47:05 INFO     epoch complete!
2024-04-25 21:47:05 INFO     evaluating now!
2024-04-25 21:47:06 INFO     Epoch [5/200] train_loss: 6.8897, val_loss: 6.7768, lr: 0.003000, 5.65s
2024-04-25 21:47:06 INFO     Saved model at 5
2024-04-25 21:47:06 INFO     Val loss decrease from 7.1955 to 6.7768, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-25 21:47:11 INFO     epoch complete!
2024-04-25 21:47:11 INFO     evaluating now!
2024-04-25 21:47:11 INFO     Epoch [6/200] train_loss: 6.4691, val_loss: 6.5865, lr: 0.003000, 5.05s
2024-04-25 21:47:11 INFO     Saved model at 6
2024-04-25 21:47:11 INFO     Val loss decrease from 6.7768 to 6.5865, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-25 21:47:16 INFO     epoch complete!
2024-04-25 21:47:16 INFO     evaluating now!
2024-04-25 21:47:16 INFO     Epoch [7/200] train_loss: 6.1174, val_loss: 6.2366, lr: 0.003000, 5.07s
2024-04-25 21:47:16 INFO     Saved model at 7
2024-04-25 21:47:16 INFO     Val loss decrease from 6.5865 to 6.2366, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-04-25 21:47:21 INFO     epoch complete!
2024-04-25 21:47:21 INFO     evaluating now!
2024-04-25 21:47:21 INFO     Epoch [8/200] train_loss: 5.8598, val_loss: 5.9817, lr: 0.003000, 5.02s
2024-04-25 21:47:21 INFO     Saved model at 8
2024-04-25 21:47:21 INFO     Val loss decrease from 6.2366 to 5.9817, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-25 21:47:26 INFO     epoch complete!
2024-04-25 21:47:26 INFO     evaluating now!
2024-04-25 21:47:27 INFO     Epoch [9/200] train_loss: 5.6148, val_loss: 5.8032, lr: 0.003000, 5.07s
2024-04-25 21:47:27 INFO     Saved model at 9
2024-04-25 21:47:27 INFO     Val loss decrease from 5.9817 to 5.8032, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-25 21:47:31 INFO     epoch complete!
2024-04-25 21:47:31 INFO     evaluating now!
2024-04-25 21:47:32 INFO     Epoch [10/200] train_loss: 5.4850, val_loss: 5.8044, lr: 0.003000, 4.95s
2024-04-25 21:47:37 INFO     epoch complete!
2024-04-25 21:47:37 INFO     evaluating now!
2024-04-25 21:47:37 INFO     Epoch [11/200] train_loss: 5.5243, val_loss: 5.6914, lr: 0.003000, 5.12s
2024-04-25 21:47:37 INFO     Saved model at 11
2024-04-25 21:47:37 INFO     Val loss decrease from 5.8032 to 5.6914, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-04-25 21:47:42 INFO     epoch complete!
2024-04-25 21:47:42 INFO     evaluating now!
2024-04-25 21:47:42 INFO     Epoch [12/200] train_loss: 5.2417, val_loss: 5.5172, lr: 0.003000, 5.11s
2024-04-25 21:47:42 INFO     Saved model at 12
2024-04-25 21:47:42 INFO     Val loss decrease from 5.6914 to 5.5172, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-25 21:47:47 INFO     epoch complete!
2024-04-25 21:47:47 INFO     evaluating now!
2024-04-25 21:47:47 INFO     Epoch [13/200] train_loss: 5.1580, val_loss: 5.4717, lr: 0.003000, 4.94s
2024-04-25 21:47:47 INFO     Saved model at 13
2024-04-25 21:47:47 INFO     Val loss decrease from 5.5172 to 5.4717, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-04-25 21:47:52 INFO     epoch complete!
2024-04-25 21:47:52 INFO     evaluating now!
2024-04-25 21:47:52 INFO     Epoch [14/200] train_loss: 5.0413, val_loss: 5.3772, lr: 0.003000, 5.03s
2024-04-25 21:47:53 INFO     Saved model at 14
2024-04-25 21:47:53 INFO     Val loss decrease from 5.4717 to 5.3772, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-25 21:47:58 INFO     epoch complete!
2024-04-25 21:47:58 INFO     evaluating now!
2024-04-25 21:47:58 INFO     Epoch [15/200] train_loss: 4.9375, val_loss: 5.5899, lr: 0.003000, 5.38s
2024-04-25 21:48:03 INFO     epoch complete!
2024-04-25 21:48:03 INFO     evaluating now!
2024-04-25 21:48:03 INFO     Epoch [16/200] train_loss: 4.8864, val_loss: 5.2940, lr: 0.003000, 5.14s
2024-04-25 21:48:03 INFO     Saved model at 16
2024-04-25 21:48:03 INFO     Val loss decrease from 5.3772 to 5.2940, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-04-25 21:48:08 INFO     epoch complete!
2024-04-25 21:48:08 INFO     evaluating now!
2024-04-25 21:48:09 INFO     Epoch [17/200] train_loss: 4.8230, val_loss: 5.3944, lr: 0.003000, 5.23s
2024-04-25 21:48:13 INFO     epoch complete!
2024-04-25 21:48:13 INFO     evaluating now!
2024-04-25 21:48:14 INFO     Epoch [18/200] train_loss: 4.7615, val_loss: 5.4602, lr: 0.003000, 5.18s
2024-04-25 21:48:19 INFO     epoch complete!
2024-04-25 21:48:19 INFO     evaluating now!
2024-04-25 21:48:19 INFO     Epoch [19/200] train_loss: 4.6652, val_loss: 5.4217, lr: 0.003000, 5.11s
2024-04-25 21:48:24 INFO     epoch complete!
2024-04-25 21:48:24 INFO     evaluating now!
2024-04-25 21:48:24 INFO     Epoch [20/200] train_loss: 4.6336, val_loss: 5.3923, lr: 0.003000, 5.25s
2024-04-25 21:48:29 INFO     epoch complete!
2024-04-25 21:48:29 INFO     evaluating now!
2024-04-25 21:48:29 INFO     Epoch [21/200] train_loss: 4.5277, val_loss: 5.2322, lr: 0.003000, 4.96s
2024-04-25 21:48:29 INFO     Saved model at 21
2024-04-25 21:48:29 INFO     Val loss decrease from 5.2940 to 5.2322, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-25 21:48:34 INFO     epoch complete!
2024-04-25 21:48:34 INFO     evaluating now!
2024-04-25 21:48:34 INFO     Epoch [22/200] train_loss: 4.4843, val_loss: 5.3045, lr: 0.003000, 5.13s
2024-04-25 21:48:39 INFO     epoch complete!
2024-04-25 21:48:39 INFO     evaluating now!
2024-04-25 21:48:39 INFO     Epoch [23/200] train_loss: 4.4723, val_loss: 5.3388, lr: 0.003000, 5.00s
2024-04-25 21:48:44 INFO     epoch complete!
2024-04-25 21:48:44 INFO     evaluating now!
2024-04-25 21:48:45 INFO     Epoch [24/200] train_loss: 4.3702, val_loss: 5.3591, lr: 0.003000, 5.00s
2024-04-25 21:48:49 INFO     epoch complete!
2024-04-25 21:48:49 INFO     evaluating now!
2024-04-25 21:48:49 INFO     Epoch [25/200] train_loss: 4.3364, val_loss: 5.1729, lr: 0.003000, 4.93s
2024-04-25 21:48:50 INFO     Saved model at 25
2024-04-25 21:48:50 INFO     Val loss decrease from 5.2322 to 5.1729, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-25 21:48:54 INFO     epoch complete!
2024-04-25 21:48:54 INFO     evaluating now!
2024-04-25 21:48:55 INFO     Epoch [26/200] train_loss: 4.3031, val_loss: 5.1130, lr: 0.003000, 5.03s
2024-04-25 21:48:55 INFO     Saved model at 26
2024-04-25 21:48:55 INFO     Val loss decrease from 5.1729 to 5.1130, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-04-25 21:49:00 INFO     epoch complete!
2024-04-25 21:49:00 INFO     evaluating now!
2024-04-25 21:49:00 INFO     Epoch [27/200] train_loss: 4.2663, val_loss: 5.1973, lr: 0.003000, 5.05s
2024-04-25 21:49:05 INFO     epoch complete!
2024-04-25 21:49:05 INFO     evaluating now!
2024-04-25 21:49:05 INFO     Epoch [28/200] train_loss: 4.2223, val_loss: 5.0548, lr: 0.003000, 5.02s
2024-04-25 21:49:05 INFO     Saved model at 28
2024-04-25 21:49:05 INFO     Val loss decrease from 5.1130 to 5.0548, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-04-25 21:49:10 INFO     epoch complete!
2024-04-25 21:49:10 INFO     evaluating now!
2024-04-25 21:49:10 INFO     Epoch [29/200] train_loss: 4.2017, val_loss: 5.3176, lr: 0.003000, 5.05s
2024-04-25 21:49:15 INFO     epoch complete!
2024-04-25 21:49:15 INFO     evaluating now!
2024-04-25 21:49:15 INFO     Epoch [30/200] train_loss: 4.1812, val_loss: 5.1322, lr: 0.003000, 5.01s
2024-04-25 21:49:20 INFO     epoch complete!
2024-04-25 21:49:20 INFO     evaluating now!
2024-04-25 21:49:20 INFO     Epoch [31/200] train_loss: 4.1005, val_loss: 5.3530, lr: 0.003000, 5.10s
2024-04-25 21:49:25 INFO     epoch complete!
2024-04-25 21:49:25 INFO     evaluating now!
2024-04-25 21:49:25 INFO     Epoch [32/200] train_loss: 4.0807, val_loss: 5.0663, lr: 0.003000, 5.05s
2024-04-25 21:49:30 INFO     epoch complete!
2024-04-25 21:49:30 INFO     evaluating now!
2024-04-25 21:49:30 INFO     Epoch [33/200] train_loss: 4.0741, val_loss: 5.1439, lr: 0.003000, 4.95s
2024-04-25 21:49:35 INFO     epoch complete!
2024-04-25 21:49:35 INFO     evaluating now!
2024-04-25 21:49:35 INFO     Epoch [34/200] train_loss: 4.0692, val_loss: 5.1123, lr: 0.003000, 4.95s
2024-04-25 21:49:40 INFO     epoch complete!
2024-04-25 21:49:40 INFO     evaluating now!
2024-04-25 21:49:40 INFO     Epoch [35/200] train_loss: 4.0290, val_loss: 5.0979, lr: 0.003000, 4.92s
2024-04-25 21:49:45 INFO     epoch complete!
2024-04-25 21:49:45 INFO     evaluating now!
2024-04-25 21:49:45 INFO     Epoch [36/200] train_loss: 3.9727, val_loss: 5.0297, lr: 0.003000, 4.92s
2024-04-25 21:49:45 INFO     Saved model at 36
2024-04-25 21:49:45 INFO     Val loss decrease from 5.0548 to 5.0297, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-04-25 21:49:50 INFO     epoch complete!
2024-04-25 21:49:50 INFO     evaluating now!
2024-04-25 21:49:50 INFO     Epoch [37/200] train_loss: 3.9172, val_loss: 5.0485, lr: 0.003000, 5.03s
2024-04-25 21:49:55 INFO     epoch complete!
2024-04-25 21:49:55 INFO     evaluating now!
2024-04-25 21:49:55 INFO     Epoch [38/200] train_loss: 3.9942, val_loss: 5.3235, lr: 0.003000, 5.22s
2024-04-25 21:50:00 INFO     epoch complete!
2024-04-25 21:50:00 INFO     evaluating now!
2024-04-25 21:50:01 INFO     Epoch [39/200] train_loss: 3.9153, val_loss: 5.0985, lr: 0.003000, 5.36s
2024-04-25 21:50:05 INFO     epoch complete!
2024-04-25 21:50:05 INFO     evaluating now!
2024-04-25 21:50:06 INFO     Epoch [40/200] train_loss: 3.8398, val_loss: 5.1586, lr: 0.003000, 4.88s
2024-04-25 21:50:10 INFO     epoch complete!
2024-04-25 21:50:10 INFO     evaluating now!
2024-04-25 21:50:11 INFO     Epoch [41/200] train_loss: 3.8219, val_loss: 5.1025, lr: 0.003000, 5.01s
2024-04-25 21:50:16 INFO     epoch complete!
2024-04-25 21:50:16 INFO     evaluating now!
2024-04-25 21:50:16 INFO     Epoch [42/200] train_loss: 3.7909, val_loss: 5.2715, lr: 0.003000, 5.29s
2024-04-25 21:50:21 INFO     epoch complete!
2024-04-25 21:50:21 INFO     evaluating now!
2024-04-25 21:50:21 INFO     Epoch [43/200] train_loss: 3.8758, val_loss: 5.2316, lr: 0.003000, 5.25s
2024-04-25 21:50:26 INFO     epoch complete!
2024-04-25 21:50:26 INFO     evaluating now!
2024-04-25 21:50:27 INFO     Epoch [44/200] train_loss: 3.8028, val_loss: 5.0643, lr: 0.003000, 5.37s
2024-04-25 21:50:31 INFO     epoch complete!
2024-04-25 21:50:31 INFO     evaluating now!
2024-04-25 21:50:32 INFO     Epoch [45/200] train_loss: 3.7261, val_loss: 5.1910, lr: 0.003000, 5.14s
2024-04-25 21:50:37 INFO     epoch complete!
2024-04-25 21:50:37 INFO     evaluating now!
2024-04-25 21:50:37 INFO     Epoch [46/200] train_loss: 3.7411, val_loss: 5.1397, lr: 0.003000, 5.18s
2024-04-25 21:50:42 INFO     epoch complete!
2024-04-25 21:50:42 INFO     evaluating now!
2024-04-25 21:50:42 INFO     Epoch [47/200] train_loss: 3.7168, val_loss: 5.2351, lr: 0.003000, 5.25s
2024-04-25 21:50:47 INFO     epoch complete!
2024-04-25 21:50:47 INFO     evaluating now!
2024-04-25 21:50:47 INFO     Epoch [48/200] train_loss: 3.7007, val_loss: 4.9469, lr: 0.003000, 5.18s
2024-04-25 21:50:47 INFO     Saved model at 48
2024-04-25 21:50:47 INFO     Val loss decrease from 5.0297 to 4.9469, saving to ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-04-25 21:50:52 INFO     epoch complete!
2024-04-25 21:50:52 INFO     evaluating now!
2024-04-25 21:50:53 INFO     Epoch [49/200] train_loss: 3.6733, val_loss: 5.0338, lr: 0.003000, 5.22s
2024-04-25 21:50:58 INFO     epoch complete!
2024-04-25 21:50:58 INFO     evaluating now!
2024-04-25 21:50:58 INFO     Epoch [50/200] train_loss: 3.6922, val_loss: 5.3352, lr: 0.003000, 5.20s
2024-04-25 21:51:03 INFO     epoch complete!
2024-04-25 21:51:03 INFO     evaluating now!
2024-04-25 21:51:03 INFO     Epoch [51/200] train_loss: 3.6791, val_loss: 5.1599, lr: 0.003000, 5.40s
2024-04-25 21:51:08 INFO     epoch complete!
2024-04-25 21:51:08 INFO     evaluating now!
2024-04-25 21:51:08 INFO     Epoch [52/200] train_loss: 3.5986, val_loss: 5.0766, lr: 0.003000, 5.07s
2024-04-25 21:51:13 INFO     epoch complete!
2024-04-25 21:51:13 INFO     evaluating now!
2024-04-25 21:51:13 INFO     Epoch [53/200] train_loss: 3.5758, val_loss: 5.1278, lr: 0.003000, 5.12s
2024-04-25 21:51:18 INFO     epoch complete!
2024-04-25 21:51:18 INFO     evaluating now!
2024-04-25 21:51:19 INFO     Epoch [54/200] train_loss: 3.5875, val_loss: 4.9572, lr: 0.003000, 5.29s
2024-04-25 21:51:24 INFO     epoch complete!
2024-04-25 21:51:24 INFO     evaluating now!
2024-04-25 21:51:24 INFO     Epoch [55/200] train_loss: 3.5740, val_loss: 5.1516, lr: 0.003000, 5.21s
2024-04-25 21:51:29 INFO     epoch complete!
2024-04-25 21:51:29 INFO     evaluating now!
2024-04-25 21:51:29 INFO     Epoch [56/200] train_loss: 3.5506, val_loss: 5.2990, lr: 0.003000, 5.03s
2024-04-25 21:51:34 INFO     epoch complete!
2024-04-25 21:51:34 INFO     evaluating now!
2024-04-25 21:51:34 INFO     Epoch [57/200] train_loss: 3.5548, val_loss: 5.0422, lr: 0.003000, 5.07s
2024-04-25 21:51:39 INFO     epoch complete!
2024-04-25 21:51:39 INFO     evaluating now!
2024-04-25 21:51:39 INFO     Epoch [58/200] train_loss: 3.5260, val_loss: 5.1101, lr: 0.003000, 5.11s
2024-04-25 21:51:44 INFO     epoch complete!
2024-04-25 21:51:44 INFO     evaluating now!
2024-04-25 21:51:44 INFO     Epoch [59/200] train_loss: 3.5185, val_loss: 5.0881, lr: 0.003000, 5.04s
2024-04-25 21:51:49 INFO     epoch complete!
2024-04-25 21:51:49 INFO     evaluating now!
2024-04-25 21:51:49 INFO     Epoch [60/200] train_loss: 3.4902, val_loss: 5.2454, lr: 0.003000, 5.15s
2024-04-25 21:51:54 INFO     epoch complete!
2024-04-25 21:51:54 INFO     evaluating now!
2024-04-25 21:51:55 INFO     Epoch [61/200] train_loss: 3.4711, val_loss: 5.1564, lr: 0.003000, 5.14s
2024-04-25 21:52:00 INFO     epoch complete!
2024-04-25 21:52:00 INFO     evaluating now!
2024-04-25 21:52:00 INFO     Epoch [62/200] train_loss: 3.4578, val_loss: 5.0691, lr: 0.003000, 5.27s
2024-04-25 21:52:05 INFO     epoch complete!
2024-04-25 21:52:05 INFO     evaluating now!
2024-04-25 21:52:05 INFO     Epoch [63/200] train_loss: 3.4476, val_loss: 5.1098, lr: 0.003000, 5.40s
2024-04-25 21:52:05 WARNING  Early stopping at epoch: 63
2024-04-25 21:52:05 INFO     Trained totally 64 epochs, average train time is 4.892s, average eval time is 0.283s
2024-04-25 21:52:06 INFO     Loaded model at 48
2024-04-25 21:52:06 INFO     Saved model at ./libcity/cache/3/model_cache/AGCRN_CHITaxi20190406.m
2024-04-25 21:52:06 INFO     Start evaluating ...
2024-04-25 21:52:08 INFO     Note that you select the single mode to evaluate!
2024-04-25 21:52:08 INFO     Evaluate result is saved at ./libcity/cache/3/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-25 21:52:08 INFO     
         MAE       RMSE
1   2.320905   6.926181
2   2.444859   7.488918
3   2.653323   8.891569
4   2.866229  10.390957
5   3.053760  11.813397
6   3.138764  12.831558
7   3.201036  13.368087
8   3.249264  13.489428
9   3.270156  13.546730
10  3.332877  13.707331
11  3.404118  14.262300
12  3.547451  15.208019
2024-04-25 21:52:08 INFO     ----------------------------------------------------------------------------
2024-04-25 21:52:08 INFO     # 4, Kownledge Graph Embedding: None, Experiment ids: 4
2024-04-25 21:52:08 INFO     ----------------------------------------------------------------------------
2024-04-25 21:52:09 INFO     Log directory: ./libcity/log
2024-04-25 21:52:09 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=4
2024-04-25 21:52:09 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'seed': 790874125, 'exp_id': 4, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-04-25 21:52:10 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-04-25 21:52:10 INFO     set_weight_link_or_dist: dist
2024-04-25 21:52:10 INFO     init_weight_inf_or_zero: inf
2024-04-25 21:52:10 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-04-25 21:52:10 INFO     Start Calculate the weight by Gauss kernel!
2024-04-25 21:52:10 INFO     Loading file CHITaxi20190406.dyna
2024-04-25 21:52:10 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-04-25 21:52:10 INFO     Dataset created
2024-04-25 21:52:10 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-04-25 21:52:10 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-04-25 21:52:10 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-04-25 21:52:10 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-04-25 21:52:10 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-04-25 21:52:10 INFO     NoneScaler
2024-04-25 21:52:11 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-04-25 21:52:11 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-04-25 21:52:11 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 66, 128])	cuda:0	True
2024-04-25 21:52:11 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 21:52:11 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 66, 64])	cuda:0	True
2024-04-25 21:52:11 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 21:52:11 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-04-25 21:52:11 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-04-25 21:52:11 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-04-25 21:52:11 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-04-25 21:52:11 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-04-25 21:52:11 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-04-25 21:52:11 INFO     Total parameter numbers: 751130
2024-04-25 21:52:11 INFO     You select `adam` optimizer.
2024-04-25 21:52:11 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-04-25 21:52:11 INFO     Start training ...
2024-04-25 21:52:11 INFO     num_batches:48
2024-04-25 21:52:17 INFO     epoch complete!
2024-04-25 21:52:17 INFO     evaluating now!
2024-04-25 21:52:17 INFO     Epoch [0/200] train_loss: 23.8848, val_loss: 17.2634, lr: 0.003000, 5.42s
2024-04-25 21:52:17 INFO     Saved model at 0
2024-04-25 21:52:17 INFO     Val loss decrease from inf to 17.2634, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-04-25 21:52:22 INFO     epoch complete!
2024-04-25 21:52:22 INFO     evaluating now!
2024-04-25 21:52:22 INFO     Epoch [1/200] train_loss: 13.6673, val_loss: 12.5689, lr: 0.003000, 5.38s
2024-04-25 21:52:23 INFO     Saved model at 1
2024-04-25 21:52:23 INFO     Val loss decrease from 17.2634 to 12.5689, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-04-25 21:52:28 INFO     epoch complete!
2024-04-25 21:52:28 INFO     evaluating now!
2024-04-25 21:52:28 INFO     Epoch [2/200] train_loss: 10.3075, val_loss: 9.4339, lr: 0.003000, 5.47s
2024-04-25 21:52:28 INFO     Saved model at 2
2024-04-25 21:52:28 INFO     Val loss decrease from 12.5689 to 9.4339, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-04-25 21:52:34 INFO     epoch complete!
2024-04-25 21:52:34 INFO     evaluating now!
2024-04-25 21:52:34 INFO     Epoch [3/200] train_loss: 8.5426, val_loss: 8.0928, lr: 0.003000, 5.44s
2024-04-25 21:52:34 INFO     Saved model at 3
2024-04-25 21:52:34 INFO     Val loss decrease from 9.4339 to 8.0928, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-04-25 21:52:39 INFO     epoch complete!
2024-04-25 21:52:39 INFO     evaluating now!
2024-04-25 21:52:39 INFO     Epoch [4/200] train_loss: 7.4531, val_loss: 7.7688, lr: 0.003000, 5.33s
2024-04-25 21:52:40 INFO     Saved model at 4
2024-04-25 21:52:40 INFO     Val loss decrease from 8.0928 to 7.7688, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-04-25 21:52:45 INFO     epoch complete!
2024-04-25 21:52:45 INFO     evaluating now!
2024-04-25 21:52:45 INFO     Epoch [5/200] train_loss: 6.9640, val_loss: 6.6462, lr: 0.003000, 5.33s
2024-04-25 21:52:45 INFO     Saved model at 5
2024-04-25 21:52:45 INFO     Val loss decrease from 7.7688 to 6.6462, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-04-25 21:52:50 INFO     epoch complete!
2024-04-25 21:52:50 INFO     evaluating now!
2024-04-25 21:52:50 INFO     Epoch [6/200] train_loss: 6.4354, val_loss: 6.3257, lr: 0.003000, 5.14s
2024-04-25 21:52:51 INFO     Saved model at 6
2024-04-25 21:52:51 INFO     Val loss decrease from 6.6462 to 6.3257, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-04-25 21:52:56 INFO     epoch complete!
2024-04-25 21:52:56 INFO     evaluating now!
2024-04-25 21:52:56 INFO     Epoch [7/200] train_loss: 6.1367, val_loss: 6.3488, lr: 0.003000, 5.33s
2024-04-25 21:53:01 INFO     epoch complete!
2024-04-25 21:53:01 INFO     evaluating now!
2024-04-25 21:53:01 INFO     Epoch [8/200] train_loss: 5.9482, val_loss: 6.0499, lr: 0.003000, 5.21s
2024-04-25 21:53:02 INFO     Saved model at 8
2024-04-25 21:53:02 INFO     Val loss decrease from 6.3257 to 6.0499, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-04-25 21:53:06 INFO     epoch complete!
2024-04-25 21:53:06 INFO     evaluating now!
2024-04-25 21:53:07 INFO     Epoch [9/200] train_loss: 5.7067, val_loss: 5.9185, lr: 0.003000, 5.13s
2024-04-25 21:53:07 INFO     Saved model at 9
2024-04-25 21:53:07 INFO     Val loss decrease from 6.0499 to 5.9185, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-04-25 21:53:12 INFO     epoch complete!
2024-04-25 21:53:12 INFO     evaluating now!
2024-04-25 21:53:12 INFO     Epoch [10/200] train_loss: 5.5393, val_loss: 5.6646, lr: 0.003000, 5.04s
2024-04-25 21:53:12 INFO     Saved model at 10
2024-04-25 21:53:12 INFO     Val loss decrease from 5.9185 to 5.6646, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-04-25 21:53:17 INFO     epoch complete!
2024-04-25 21:53:17 INFO     evaluating now!
2024-04-25 21:53:18 INFO     Epoch [11/200] train_loss: 5.4144, val_loss: 5.7242, lr: 0.003000, 5.33s
2024-04-25 21:53:23 INFO     epoch complete!
2024-04-25 21:53:23 INFO     evaluating now!
2024-04-25 21:53:23 INFO     Epoch [12/200] train_loss: 5.3139, val_loss: 5.4864, lr: 0.003000, 5.34s
2024-04-25 21:53:23 INFO     Saved model at 12
2024-04-25 21:53:23 INFO     Val loss decrease from 5.6646 to 5.4864, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-04-25 21:53:28 INFO     epoch complete!
2024-04-25 21:53:28 INFO     evaluating now!
2024-04-25 21:53:28 INFO     Epoch [13/200] train_loss: 5.1494, val_loss: 5.4881, lr: 0.003000, 5.22s
2024-04-25 21:53:33 INFO     epoch complete!
2024-04-25 21:53:33 INFO     evaluating now!
2024-04-25 21:53:34 INFO     Epoch [14/200] train_loss: 5.0465, val_loss: 5.4191, lr: 0.003000, 5.24s
2024-04-25 21:53:34 INFO     Saved model at 14
2024-04-25 21:53:34 INFO     Val loss decrease from 5.4864 to 5.4191, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-04-25 21:53:39 INFO     epoch complete!
2024-04-25 21:53:39 INFO     evaluating now!
2024-04-25 21:53:39 INFO     Epoch [15/200] train_loss: 5.0125, val_loss: 5.4841, lr: 0.003000, 5.27s
2024-04-25 21:53:44 INFO     epoch complete!
2024-04-25 21:53:44 INFO     evaluating now!
2024-04-25 21:53:44 INFO     Epoch [16/200] train_loss: 4.8874, val_loss: 5.4556, lr: 0.003000, 5.19s
2024-04-25 21:53:49 INFO     epoch complete!
2024-04-25 21:53:49 INFO     evaluating now!
2024-04-25 21:53:49 INFO     Epoch [17/200] train_loss: 4.8120, val_loss: 5.2699, lr: 0.003000, 5.22s
2024-04-25 21:53:50 INFO     Saved model at 17
2024-04-25 21:53:50 INFO     Val loss decrease from 5.4191 to 5.2699, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-04-25 21:53:55 INFO     epoch complete!
2024-04-25 21:53:55 INFO     evaluating now!
2024-04-25 21:53:55 INFO     Epoch [18/200] train_loss: 4.7487, val_loss: 5.1659, lr: 0.003000, 5.28s
2024-04-25 21:53:55 INFO     Saved model at 18
2024-04-25 21:53:55 INFO     Val loss decrease from 5.2699 to 5.1659, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-04-25 21:54:00 INFO     epoch complete!
2024-04-25 21:54:00 INFO     evaluating now!
2024-04-25 21:54:00 INFO     Epoch [19/200] train_loss: 4.6786, val_loss: 5.3834, lr: 0.003000, 5.25s
2024-04-25 21:54:05 INFO     epoch complete!
2024-04-25 21:54:05 INFO     evaluating now!
2024-04-25 21:54:06 INFO     Epoch [20/200] train_loss: 4.6733, val_loss: 5.2984, lr: 0.003000, 5.33s
2024-04-25 21:54:11 INFO     epoch complete!
2024-04-25 21:54:11 INFO     evaluating now!
2024-04-25 21:54:11 INFO     Epoch [21/200] train_loss: 4.5970, val_loss: 5.1156, lr: 0.003000, 5.17s
2024-04-25 21:54:11 INFO     Saved model at 21
2024-04-25 21:54:11 INFO     Val loss decrease from 5.1659 to 5.1156, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-04-25 21:54:16 INFO     epoch complete!
2024-04-25 21:54:16 INFO     evaluating now!
2024-04-25 21:54:17 INFO     Epoch [22/200] train_loss: 4.5321, val_loss: 5.3244, lr: 0.003000, 5.15s
2024-04-25 21:54:22 INFO     epoch complete!
2024-04-25 21:54:22 INFO     evaluating now!
2024-04-25 21:54:22 INFO     Epoch [23/200] train_loss: 4.4757, val_loss: 5.2063, lr: 0.003000, 5.46s
2024-04-25 21:54:27 INFO     epoch complete!
2024-04-25 21:54:27 INFO     evaluating now!
2024-04-25 21:54:27 INFO     Epoch [24/200] train_loss: 4.4510, val_loss: 5.1614, lr: 0.003000, 5.39s
2024-04-25 21:54:33 INFO     epoch complete!
2024-04-25 21:54:33 INFO     evaluating now!
2024-04-25 21:54:33 INFO     Epoch [25/200] train_loss: 4.4627, val_loss: 5.0112, lr: 0.003000, 5.33s
2024-04-25 21:54:33 INFO     Saved model at 25
2024-04-25 21:54:33 INFO     Val loss decrease from 5.1156 to 5.0112, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-04-25 21:54:38 INFO     epoch complete!
2024-04-25 21:54:38 INFO     evaluating now!
2024-04-25 21:54:38 INFO     Epoch [26/200] train_loss: 4.3742, val_loss: 5.1271, lr: 0.003000, 5.23s
2024-04-25 21:54:43 INFO     epoch complete!
2024-04-25 21:54:43 INFO     evaluating now!
2024-04-25 21:54:44 INFO     Epoch [27/200] train_loss: 4.2835, val_loss: 5.0533, lr: 0.003000, 5.25s
2024-04-25 21:54:49 INFO     epoch complete!
2024-04-25 21:54:49 INFO     evaluating now!
2024-04-25 21:54:49 INFO     Epoch [28/200] train_loss: 4.2423, val_loss: 5.0529, lr: 0.003000, 5.40s
2024-04-25 21:54:54 INFO     epoch complete!
2024-04-25 21:54:54 INFO     evaluating now!
2024-04-25 21:54:54 INFO     Epoch [29/200] train_loss: 4.2636, val_loss: 4.9893, lr: 0.003000, 5.09s
2024-04-25 21:54:54 INFO     Saved model at 29
2024-04-25 21:54:54 INFO     Val loss decrease from 5.0112 to 4.9893, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-04-25 21:54:59 INFO     epoch complete!
2024-04-25 21:54:59 INFO     evaluating now!
2024-04-25 21:55:00 INFO     Epoch [30/200] train_loss: 4.2333, val_loss: 5.0590, lr: 0.003000, 5.45s
2024-04-25 21:55:05 INFO     epoch complete!
2024-04-25 21:55:05 INFO     evaluating now!
2024-04-25 21:55:05 INFO     Epoch [31/200] train_loss: 4.1484, val_loss: 5.1747, lr: 0.003000, 5.35s
2024-04-25 21:55:10 INFO     epoch complete!
2024-04-25 21:55:10 INFO     evaluating now!
2024-04-25 21:55:10 INFO     Epoch [32/200] train_loss: 4.1504, val_loss: 5.1250, lr: 0.003000, 5.24s
2024-04-25 21:55:15 INFO     epoch complete!
2024-04-25 21:55:15 INFO     evaluating now!
2024-04-25 21:55:16 INFO     Epoch [33/200] train_loss: 4.0751, val_loss: 5.0726, lr: 0.003000, 5.39s
2024-04-25 21:55:21 INFO     epoch complete!
2024-04-25 21:55:21 INFO     evaluating now!
2024-04-25 21:55:21 INFO     Epoch [34/200] train_loss: 4.0404, val_loss: 4.9469, lr: 0.003000, 5.33s
2024-04-25 21:55:21 INFO     Saved model at 34
2024-04-25 21:55:21 INFO     Val loss decrease from 4.9893 to 4.9469, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-04-25 21:55:26 INFO     epoch complete!
2024-04-25 21:55:26 INFO     evaluating now!
2024-04-25 21:55:27 INFO     Epoch [35/200] train_loss: 4.0244, val_loss: 5.0157, lr: 0.003000, 5.29s
2024-04-25 21:55:31 INFO     epoch complete!
2024-04-25 21:55:31 INFO     evaluating now!
2024-04-25 21:55:32 INFO     Epoch [36/200] train_loss: 4.0035, val_loss: 5.0764, lr: 0.003000, 5.24s
2024-04-25 21:55:37 INFO     epoch complete!
2024-04-25 21:55:37 INFO     evaluating now!
2024-04-25 21:55:37 INFO     Epoch [37/200] train_loss: 4.0337, val_loss: 5.0552, lr: 0.003000, 5.27s
2024-04-25 21:55:43 INFO     epoch complete!
2024-04-25 21:55:43 INFO     evaluating now!
2024-04-25 21:55:43 INFO     Epoch [38/200] train_loss: 3.9941, val_loss: 5.0694, lr: 0.003000, 5.85s
2024-04-25 21:55:48 INFO     epoch complete!
2024-04-25 21:55:48 INFO     evaluating now!
2024-04-25 21:55:49 INFO     Epoch [39/200] train_loss: 3.9173, val_loss: 4.9474, lr: 0.003000, 5.69s
2024-04-25 21:55:54 INFO     epoch complete!
2024-04-25 21:55:54 INFO     evaluating now!
2024-04-25 21:55:54 INFO     Epoch [40/200] train_loss: 3.8644, val_loss: 5.0036, lr: 0.003000, 5.65s
2024-04-25 21:56:00 INFO     epoch complete!
2024-04-25 21:56:00 INFO     evaluating now!
2024-04-25 21:56:00 INFO     Epoch [41/200] train_loss: 3.8547, val_loss: 4.9972, lr: 0.003000, 5.75s
2024-04-25 21:56:06 INFO     epoch complete!
2024-04-25 21:56:06 INFO     evaluating now!
2024-04-25 21:56:06 INFO     Epoch [42/200] train_loss: 3.8342, val_loss: 4.9192, lr: 0.003000, 5.84s
2024-04-25 21:56:06 INFO     Saved model at 42
2024-04-25 21:56:06 INFO     Val loss decrease from 4.9469 to 4.9192, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch42.tar
2024-04-25 21:56:12 INFO     epoch complete!
2024-04-25 21:56:12 INFO     evaluating now!
2024-04-25 21:56:12 INFO     Epoch [43/200] train_loss: 3.8035, val_loss: 4.9535, lr: 0.003000, 5.94s
2024-04-25 21:56:18 INFO     epoch complete!
2024-04-25 21:56:18 INFO     evaluating now!
2024-04-25 21:56:18 INFO     Epoch [44/200] train_loss: 3.7660, val_loss: 5.0758, lr: 0.003000, 6.02s
2024-04-25 21:56:23 INFO     epoch complete!
2024-04-25 21:56:23 INFO     evaluating now!
2024-04-25 21:56:23 INFO     Epoch [45/200] train_loss: 3.7959, val_loss: 5.0019, lr: 0.003000, 5.26s
2024-04-25 21:56:28 INFO     epoch complete!
2024-04-25 21:56:28 INFO     evaluating now!
2024-04-25 21:56:29 INFO     Epoch [46/200] train_loss: 3.7937, val_loss: 4.9749, lr: 0.003000, 5.19s
2024-04-25 21:56:34 INFO     epoch complete!
2024-04-25 21:56:34 INFO     evaluating now!
2024-04-25 21:56:34 INFO     Epoch [47/200] train_loss: 3.7436, val_loss: 4.9562, lr: 0.003000, 5.28s
2024-04-25 21:56:39 INFO     epoch complete!
2024-04-25 21:56:39 INFO     evaluating now!
2024-04-25 21:56:39 INFO     Epoch [48/200] train_loss: 3.7161, val_loss: 4.9707, lr: 0.003000, 5.16s
2024-04-25 21:56:44 INFO     epoch complete!
2024-04-25 21:56:44 INFO     evaluating now!
2024-04-25 21:56:44 INFO     Epoch [49/200] train_loss: 3.7261, val_loss: 5.0344, lr: 0.003000, 5.17s
2024-04-25 21:56:49 INFO     epoch complete!
2024-04-25 21:56:49 INFO     evaluating now!
2024-04-25 21:56:49 INFO     Epoch [50/200] train_loss: 3.6592, val_loss: 4.9485, lr: 0.003000, 5.25s
2024-04-25 21:56:54 INFO     epoch complete!
2024-04-25 21:56:54 INFO     evaluating now!
2024-04-25 21:56:55 INFO     Epoch [51/200] train_loss: 3.6744, val_loss: 4.9320, lr: 0.003000, 5.07s
2024-04-25 21:57:00 INFO     epoch complete!
2024-04-25 21:57:00 INFO     evaluating now!
2024-04-25 21:57:00 INFO     Epoch [52/200] train_loss: 3.6887, val_loss: 5.0200, lr: 0.003000, 5.28s
2024-04-25 21:57:05 INFO     epoch complete!
2024-04-25 21:57:05 INFO     evaluating now!
2024-04-25 21:57:05 INFO     Epoch [53/200] train_loss: 3.6773, val_loss: 4.9106, lr: 0.003000, 5.16s
2024-04-25 21:57:05 INFO     Saved model at 53
2024-04-25 21:57:05 INFO     Val loss decrease from 4.9192 to 4.9106, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch53.tar
2024-04-25 21:57:10 INFO     epoch complete!
2024-04-25 21:57:10 INFO     evaluating now!
2024-04-25 21:57:10 INFO     Epoch [54/200] train_loss: 3.6055, val_loss: 4.8616, lr: 0.003000, 5.18s
2024-04-25 21:57:10 INFO     Saved model at 54
2024-04-25 21:57:10 INFO     Val loss decrease from 4.9106 to 4.8616, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch54.tar
2024-04-25 21:57:16 INFO     epoch complete!
2024-04-25 21:57:16 INFO     evaluating now!
2024-04-25 21:57:16 INFO     Epoch [55/200] train_loss: 3.5860, val_loss: 4.9730, lr: 0.003000, 5.40s
2024-04-25 21:57:21 INFO     epoch complete!
2024-04-25 21:57:21 INFO     evaluating now!
2024-04-25 21:57:21 INFO     Epoch [56/200] train_loss: 3.5772, val_loss: 4.8526, lr: 0.003000, 5.25s
2024-04-25 21:57:21 INFO     Saved model at 56
2024-04-25 21:57:21 INFO     Val loss decrease from 4.8616 to 4.8526, saving to ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406_epoch56.tar
2024-04-25 21:57:26 INFO     epoch complete!
2024-04-25 21:57:26 INFO     evaluating now!
2024-04-25 21:57:27 INFO     Epoch [57/200] train_loss: 3.5772, val_loss: 4.9945, lr: 0.003000, 5.36s
2024-04-25 21:57:32 INFO     epoch complete!
2024-04-25 21:57:32 INFO     evaluating now!
2024-04-25 21:57:32 INFO     Epoch [58/200] train_loss: 3.5224, val_loss: 5.0701, lr: 0.003000, 5.47s
2024-04-25 21:57:37 INFO     epoch complete!
2024-04-25 21:57:37 INFO     evaluating now!
2024-04-25 21:57:38 INFO     Epoch [59/200] train_loss: 3.5165, val_loss: 4.9452, lr: 0.003000, 5.33s
2024-04-25 21:57:42 INFO     epoch complete!
2024-04-25 21:57:42 INFO     evaluating now!
2024-04-25 21:57:43 INFO     Epoch [60/200] train_loss: 3.5111, val_loss: 4.8825, lr: 0.003000, 5.18s
2024-04-25 21:57:48 INFO     epoch complete!
2024-04-25 21:57:48 INFO     evaluating now!
2024-04-25 21:57:48 INFO     Epoch [61/200] train_loss: 3.5140, val_loss: 4.9858, lr: 0.003000, 5.20s
2024-04-25 21:57:53 INFO     epoch complete!
2024-04-25 21:57:53 INFO     evaluating now!
2024-04-25 21:57:53 INFO     Epoch [62/200] train_loss: 3.4840, val_loss: 5.1334, lr: 0.003000, 5.14s
2024-04-25 21:57:58 INFO     epoch complete!
2024-04-25 21:57:58 INFO     evaluating now!
2024-04-25 21:57:58 INFO     Epoch [63/200] train_loss: 3.4936, val_loss: 4.9458, lr: 0.003000, 5.19s
2024-04-25 21:58:03 INFO     epoch complete!
2024-04-25 21:58:03 INFO     evaluating now!
2024-04-25 21:58:03 INFO     Epoch [64/200] train_loss: 3.4579, val_loss: 4.9728, lr: 0.003000, 5.22s
2024-04-25 21:58:08 INFO     epoch complete!
2024-04-25 21:58:08 INFO     evaluating now!
2024-04-25 21:58:09 INFO     Epoch [65/200] train_loss: 3.4984, val_loss: 4.9119, lr: 0.003000, 5.05s
2024-04-25 21:58:13 INFO     epoch complete!
2024-04-25 21:58:13 INFO     evaluating now!
2024-04-25 21:58:14 INFO     Epoch [66/200] train_loss: 3.4466, val_loss: 5.0092, lr: 0.003000, 5.16s
2024-04-25 21:58:19 INFO     epoch complete!
2024-04-25 21:58:19 INFO     evaluating now!
2024-04-25 21:58:19 INFO     Epoch [67/200] train_loss: 3.4110, val_loss: 4.9265, lr: 0.003000, 5.14s
2024-04-25 21:58:24 INFO     epoch complete!
2024-04-25 21:58:24 INFO     evaluating now!
2024-04-25 21:58:24 INFO     Epoch [68/200] train_loss: 3.4496, val_loss: 4.9028, lr: 0.003000, 5.15s
2024-04-25 21:58:29 INFO     epoch complete!
2024-04-25 21:58:29 INFO     evaluating now!
2024-04-25 21:58:29 INFO     Epoch [69/200] train_loss: 3.3997, val_loss: 4.9463, lr: 0.003000, 5.11s
2024-04-25 21:58:34 INFO     epoch complete!
2024-04-25 21:58:34 INFO     evaluating now!
2024-04-25 21:58:34 INFO     Epoch [70/200] train_loss: 3.3896, val_loss: 5.0141, lr: 0.003000, 5.26s
2024-04-25 21:58:39 INFO     epoch complete!
2024-04-25 21:58:39 INFO     evaluating now!
2024-04-25 21:58:40 INFO     Epoch [71/200] train_loss: 3.3636, val_loss: 5.0146, lr: 0.003000, 5.31s
2024-04-25 21:58:40 WARNING  Early stopping at epoch: 71
2024-04-25 21:58:40 INFO     Trained totally 72 epochs, average train time is 5.034s, average eval time is 0.277s
2024-04-25 21:58:40 INFO     Loaded model at 56
2024-04-25 21:58:40 INFO     Saved model at ./libcity/cache/4/model_cache/AGCRN_CHITaxi20190406.m
2024-04-25 21:58:40 INFO     Start evaluating ...
2024-04-25 21:58:42 INFO     Note that you select the single mode to evaluate!
2024-04-25 21:58:42 INFO     Evaluate result is saved at ./libcity/cache/4/evaluate_cache/AGCRN_CHITaxi20190406.csv
2024-04-25 21:58:42 INFO     
         MAE       RMSE
1   2.421698   7.506308
2   2.534648   8.150301
3   2.688648   9.096974
4   2.798310   9.572005
5   2.851613  10.133173
6   3.020105  11.067553
7   3.066282  11.855223
8   3.177130  12.416092
9   3.235284  12.741332
10  3.280556  12.930002
11  3.269901  13.036387
12  3.329136  13.410503
2024-04-25 21:58:42 INFO     ----------------------------------------------------------------------------
2024-04-25 21:58:42 INFO     Kownledge Graph Embedding: None, Experiment ids: [0, 1, 2, 3, 4]
2024-04-25 21:58:43 INFO     ----------------------------------------------------------------------------
2024-04-25 21:58:43 INFO     Average: 
         MAE       RMSE
0   2.359339   7.169166
1   2.489247   7.809254
2   2.689766   9.080205
3   2.854139  10.206565
4   3.016262  11.259125
5   3.125577  12.116519
6   3.186990  12.656045
7   3.241141  13.011828
8   3.283304  13.131197
9   3.308453  13.245648
10  3.367103  13.465058
11  3.471255  13.977854 
2024-04-25 21:58:43 INFO     Standard deviation: 
         MAE      RMSE
0   0.038985  0.187785
1   0.030755  0.229694
2   0.064973  0.385072
3   0.114038  0.779084
4   0.121899  1.046041
5   0.122924  1.007790
6   0.116575  0.745907
7   0.084180  0.517954
8   0.096067  0.445670
9   0.069514  0.539684
10  0.102376  0.597845
11  0.110991  0.780776
2024-04-25 21:58:43 INFO     ----------------------------------------------------------------------------
2024-04-25 21:58:43 INFO     12 steps Average: 
        MAE       RMSE
0  3.032715  11.427372
2024-04-25 21:58:43 INFO     12 steps Standard deviation: 
       MAE      RMSE
0  0.08944  0.605275
