2024-05-02 11:58:16 INFO     Saving logs in: ./logs/CHITaxi20190406/AGCRN/ExtTime/
2024-05-02 11:58:16 INFO     ----------------------------------------------------------------------------
2024-05-02 11:58:16 INFO     # 0, Kownledge Graph Embedding: Normal, Experiment ids: 15
2024-05-02 11:58:16 INFO     ----------------------------------------------------------------------------
2024-05-02 11:58:16 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=15
2024-05-02 11:58:16 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 15, 'load_external': True, 'normal_external': True, 'ext_scaler': 'none', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 11:58:16 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 11:58:16 INFO     set_weight_link_or_dist: dist
2024-05-02 11:58:16 INFO     init_weight_inf_or_zero: inf
2024-05-02 11:58:16 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 11:58:16 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 11:58:16 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 11:58:17 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 11:58:17 INFO     Dataset created
2024-05-02 11:58:17 INFO     x shape: (4345, 12, 77, 4), y shape: (4345, 12, 77, 4)
2024-05-02 11:58:17 INFO     train	x: (3042, 12, 77, 4), y: (3042, 12, 77, 4)
2024-05-02 11:58:17 INFO     eval	x: (434, 12, 77, 4), y: (434, 12, 77, 4)
2024-05-02 11:58:17 INFO     test	x: (869, 12, 77, 4), y: (869, 12, 77, 4)
2024-05-02 11:58:17 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 11:58:17 INFO     NoneScaler
2024-05-02 11:58:21 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 11:58:21 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 11:58:21 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 68, 128])	cuda:0	True
2024-05-02 11:58:21 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 11:58:21 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 68, 64])	cuda:0	True
2024-05-02 11:58:21 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 11:58:21 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 11:58:21 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 11:58:21 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 11:58:21 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 11:58:21 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 11:58:21 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 11:58:21 INFO     Total parameter numbers: 758810
2024-05-02 11:58:21 INFO     You select `adam` optimizer.
2024-05-02 11:58:21 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 11:58:21 INFO     Start training ...
2024-05-02 11:58:21 INFO     num_batches:48
2024-05-02 11:58:27 INFO     epoch complete!
2024-05-02 11:58:27 INFO     evaluating now!
2024-05-02 11:58:27 INFO     Epoch [0/200] train_loss: 24.7130, val_loss: 17.3817, lr: 0.003000, 6.14s
2024-05-02 11:58:27 INFO     Saved model at 0
2024-05-02 11:58:27 INFO     Val loss decrease from inf to 17.3817, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 11:58:32 INFO     epoch complete!
2024-05-02 11:58:32 INFO     evaluating now!
2024-05-02 11:58:32 INFO     Epoch [1/200] train_loss: 13.7007, val_loss: 12.6539, lr: 0.003000, 5.30s
2024-05-02 11:58:32 INFO     Saved model at 1
2024-05-02 11:58:32 INFO     Val loss decrease from 17.3817 to 12.6539, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 11:58:37 INFO     epoch complete!
2024-05-02 11:58:37 INFO     evaluating now!
2024-05-02 11:58:38 INFO     Epoch [2/200] train_loss: 10.2821, val_loss: 9.3075, lr: 0.003000, 5.36s
2024-05-02 11:58:38 INFO     Saved model at 2
2024-05-02 11:58:38 INFO     Val loss decrease from 12.6539 to 9.3075, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 11:58:43 INFO     epoch complete!
2024-05-02 11:58:43 INFO     evaluating now!
2024-05-02 11:58:43 INFO     Epoch [3/200] train_loss: 8.2000, val_loss: 7.6736, lr: 0.003000, 5.21s
2024-05-02 11:58:43 INFO     Saved model at 3
2024-05-02 11:58:43 INFO     Val loss decrease from 9.3075 to 7.6736, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 11:58:48 INFO     epoch complete!
2024-05-02 11:58:48 INFO     evaluating now!
2024-05-02 11:58:48 INFO     Epoch [4/200] train_loss: 7.1857, val_loss: 6.9249, lr: 0.003000, 5.33s
2024-05-02 11:58:48 INFO     Saved model at 4
2024-05-02 11:58:48 INFO     Val loss decrease from 7.6736 to 6.9249, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 11:58:53 INFO     epoch complete!
2024-05-02 11:58:53 INFO     evaluating now!
2024-05-02 11:58:54 INFO     Epoch [5/200] train_loss: 6.5638, val_loss: 6.3949, lr: 0.003000, 5.22s
2024-05-02 11:58:54 INFO     Saved model at 5
2024-05-02 11:58:54 INFO     Val loss decrease from 6.9249 to 6.3949, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 11:58:59 INFO     epoch complete!
2024-05-02 11:58:59 INFO     evaluating now!
2024-05-02 11:58:59 INFO     Epoch [6/200] train_loss: 6.1475, val_loss: 6.2669, lr: 0.003000, 5.33s
2024-05-02 11:58:59 INFO     Saved model at 6
2024-05-02 11:58:59 INFO     Val loss decrease from 6.3949 to 6.2669, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 11:59:04 INFO     epoch complete!
2024-05-02 11:59:04 INFO     evaluating now!
2024-05-02 11:59:04 INFO     Epoch [7/200] train_loss: 5.7971, val_loss: 5.8801, lr: 0.003000, 5.35s
2024-05-02 11:59:04 INFO     Saved model at 7
2024-05-02 11:59:04 INFO     Val loss decrease from 6.2669 to 5.8801, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 11:59:10 INFO     epoch complete!
2024-05-02 11:59:10 INFO     evaluating now!
2024-05-02 11:59:11 INFO     Epoch [8/200] train_loss: 5.5158, val_loss: 5.6541, lr: 0.003000, 6.13s
2024-05-02 11:59:11 INFO     Saved model at 8
2024-05-02 11:59:11 INFO     Val loss decrease from 5.8801 to 5.6541, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 11:59:16 INFO     epoch complete!
2024-05-02 11:59:16 INFO     evaluating now!
2024-05-02 11:59:17 INFO     Epoch [9/200] train_loss: 5.3350, val_loss: 5.7123, lr: 0.003000, 6.09s
2024-05-02 11:59:22 INFO     epoch complete!
2024-05-02 11:59:22 INFO     evaluating now!
2024-05-02 11:59:23 INFO     Epoch [10/200] train_loss: 5.1879, val_loss: 5.2959, lr: 0.003000, 6.05s
2024-05-02 11:59:23 INFO     Saved model at 10
2024-05-02 11:59:23 INFO     Val loss decrease from 5.6541 to 5.2959, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 11:59:28 INFO     epoch complete!
2024-05-02 11:59:28 INFO     evaluating now!
2024-05-02 11:59:28 INFO     Epoch [11/200] train_loss: 5.0587, val_loss: 5.5191, lr: 0.003000, 5.41s
2024-05-02 11:59:33 INFO     epoch complete!
2024-05-02 11:59:33 INFO     evaluating now!
2024-05-02 11:59:33 INFO     Epoch [12/200] train_loss: 4.9251, val_loss: 5.2443, lr: 0.003000, 5.30s
2024-05-02 11:59:33 INFO     Saved model at 12
2024-05-02 11:59:33 INFO     Val loss decrease from 5.2959 to 5.2443, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 11:59:39 INFO     epoch complete!
2024-05-02 11:59:39 INFO     evaluating now!
2024-05-02 11:59:39 INFO     Epoch [13/200] train_loss: 4.8544, val_loss: 5.1497, lr: 0.003000, 5.35s
2024-05-02 11:59:39 INFO     Saved model at 13
2024-05-02 11:59:39 INFO     Val loss decrease from 5.2443 to 5.1497, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-02 11:59:44 INFO     epoch complete!
2024-05-02 11:59:44 INFO     evaluating now!
2024-05-02 11:59:44 INFO     Epoch [14/200] train_loss: 4.7886, val_loss: 5.2196, lr: 0.003000, 5.40s
2024-05-02 11:59:50 INFO     epoch complete!
2024-05-02 11:59:50 INFO     evaluating now!
2024-05-02 11:59:50 INFO     Epoch [15/200] train_loss: 4.6330, val_loss: 5.0153, lr: 0.003000, 5.55s
2024-05-02 11:59:50 INFO     Saved model at 15
2024-05-02 11:59:50 INFO     Val loss decrease from 5.1497 to 5.0153, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-02 11:59:55 INFO     epoch complete!
2024-05-02 11:59:55 INFO     evaluating now!
2024-05-02 11:59:55 INFO     Epoch [16/200] train_loss: 4.6723, val_loss: 5.0710, lr: 0.003000, 5.50s
2024-05-02 12:00:01 INFO     epoch complete!
2024-05-02 12:00:01 INFO     evaluating now!
2024-05-02 12:00:01 INFO     Epoch [17/200] train_loss: 4.5648, val_loss: 5.1704, lr: 0.003000, 5.59s
2024-05-02 12:00:06 INFO     epoch complete!
2024-05-02 12:00:06 INFO     evaluating now!
2024-05-02 12:00:07 INFO     Epoch [18/200] train_loss: 4.4878, val_loss: 5.1012, lr: 0.003000, 5.64s
2024-05-02 12:00:12 INFO     epoch complete!
2024-05-02 12:00:12 INFO     evaluating now!
2024-05-02 12:00:12 INFO     Epoch [19/200] train_loss: 4.4621, val_loss: 4.9280, lr: 0.003000, 5.88s
2024-05-02 12:00:13 INFO     Saved model at 19
2024-05-02 12:00:13 INFO     Val loss decrease from 5.0153 to 4.9280, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-02 12:00:18 INFO     epoch complete!
2024-05-02 12:00:18 INFO     evaluating now!
2024-05-02 12:00:18 INFO     Epoch [20/200] train_loss: 4.4101, val_loss: 4.8456, lr: 0.003000, 5.85s
2024-05-02 12:00:18 INFO     Saved model at 20
2024-05-02 12:00:18 INFO     Val loss decrease from 4.9280 to 4.8456, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-02 12:00:25 INFO     epoch complete!
2024-05-02 12:00:25 INFO     evaluating now!
2024-05-02 12:00:25 INFO     Epoch [21/200] train_loss: 4.3347, val_loss: 4.9011, lr: 0.003000, 6.55s
2024-05-02 12:00:31 INFO     epoch complete!
2024-05-02 12:00:31 INFO     evaluating now!
2024-05-02 12:00:31 INFO     Epoch [22/200] train_loss: 4.2946, val_loss: 4.8324, lr: 0.003000, 6.23s
2024-05-02 12:00:31 INFO     Saved model at 22
2024-05-02 12:00:31 INFO     Val loss decrease from 4.8456 to 4.8324, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-02 12:00:37 INFO     epoch complete!
2024-05-02 12:00:37 INFO     evaluating now!
2024-05-02 12:00:37 INFO     Epoch [23/200] train_loss: 4.2044, val_loss: 4.9451, lr: 0.003000, 5.78s
2024-05-02 12:00:42 INFO     epoch complete!
2024-05-02 12:00:42 INFO     evaluating now!
2024-05-02 12:00:43 INFO     Epoch [24/200] train_loss: 4.2078, val_loss: 4.8899, lr: 0.003000, 5.61s
2024-05-02 12:00:48 INFO     epoch complete!
2024-05-02 12:00:48 INFO     evaluating now!
2024-05-02 12:00:48 INFO     Epoch [25/200] train_loss: 4.1037, val_loss: 4.7449, lr: 0.003000, 5.73s
2024-05-02 12:00:48 INFO     Saved model at 25
2024-05-02 12:00:48 INFO     Val loss decrease from 4.8324 to 4.7449, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-02 12:00:54 INFO     epoch complete!
2024-05-02 12:00:54 INFO     evaluating now!
2024-05-02 12:00:54 INFO     Epoch [26/200] train_loss: 4.0525, val_loss: 4.7461, lr: 0.003000, 5.71s
2024-05-02 12:01:00 INFO     epoch complete!
2024-05-02 12:01:00 INFO     evaluating now!
2024-05-02 12:01:00 INFO     Epoch [27/200] train_loss: 4.0534, val_loss: 4.7155, lr: 0.003000, 5.80s
2024-05-02 12:01:00 INFO     Saved model at 27
2024-05-02 12:01:00 INFO     Val loss decrease from 4.7449 to 4.7155, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-05-02 12:01:05 INFO     epoch complete!
2024-05-02 12:01:05 INFO     evaluating now!
2024-05-02 12:01:06 INFO     Epoch [28/200] train_loss: 4.0737, val_loss: 4.8365, lr: 0.003000, 5.70s
2024-05-02 12:01:11 INFO     epoch complete!
2024-05-02 12:01:11 INFO     evaluating now!
2024-05-02 12:01:11 INFO     Epoch [29/200] train_loss: 3.9928, val_loss: 4.6723, lr: 0.003000, 5.67s
2024-05-02 12:01:11 INFO     Saved model at 29
2024-05-02 12:01:11 INFO     Val loss decrease from 4.7155 to 4.6723, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-05-02 12:01:17 INFO     epoch complete!
2024-05-02 12:01:17 INFO     evaluating now!
2024-05-02 12:01:17 INFO     Epoch [30/200] train_loss: 3.9174, val_loss: 4.7732, lr: 0.003000, 5.82s
2024-05-02 12:01:23 INFO     epoch complete!
2024-05-02 12:01:23 INFO     evaluating now!
2024-05-02 12:01:23 INFO     Epoch [31/200] train_loss: 3.8994, val_loss: 4.7140, lr: 0.003000, 6.20s
2024-05-02 12:01:29 INFO     epoch complete!
2024-05-02 12:01:29 INFO     evaluating now!
2024-05-02 12:01:29 INFO     Epoch [32/200] train_loss: 3.9282, val_loss: 4.8669, lr: 0.003000, 5.77s
2024-05-02 12:01:35 INFO     epoch complete!
2024-05-02 12:01:35 INFO     evaluating now!
2024-05-02 12:01:35 INFO     Epoch [33/200] train_loss: 3.8704, val_loss: 4.7695, lr: 0.003000, 5.69s
2024-05-02 12:01:40 INFO     epoch complete!
2024-05-02 12:01:40 INFO     evaluating now!
2024-05-02 12:01:41 INFO     Epoch [34/200] train_loss: 3.8337, val_loss: 4.6947, lr: 0.003000, 5.83s
2024-05-02 12:01:46 INFO     epoch complete!
2024-05-02 12:01:46 INFO     evaluating now!
2024-05-02 12:01:47 INFO     Epoch [35/200] train_loss: 3.8030, val_loss: 4.7069, lr: 0.003000, 5.89s
2024-05-02 12:01:52 INFO     epoch complete!
2024-05-02 12:01:52 INFO     evaluating now!
2024-05-02 12:01:52 INFO     Epoch [36/200] train_loss: 3.7932, val_loss: 4.7733, lr: 0.003000, 5.68s
2024-05-02 12:01:58 INFO     epoch complete!
2024-05-02 12:01:58 INFO     evaluating now!
2024-05-02 12:01:58 INFO     Epoch [37/200] train_loss: 3.7763, val_loss: 4.6508, lr: 0.003000, 5.66s
2024-05-02 12:01:58 INFO     Saved model at 37
2024-05-02 12:01:58 INFO     Val loss decrease from 4.6723 to 4.6508, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-05-02 12:02:03 INFO     epoch complete!
2024-05-02 12:02:03 INFO     evaluating now!
2024-05-02 12:02:04 INFO     Epoch [38/200] train_loss: 3.7347, val_loss: 4.7131, lr: 0.003000, 5.82s
2024-05-02 12:02:09 INFO     epoch complete!
2024-05-02 12:02:09 INFO     evaluating now!
2024-05-02 12:02:10 INFO     Epoch [39/200] train_loss: 3.7141, val_loss: 4.6703, lr: 0.003000, 5.90s
2024-05-02 12:02:15 INFO     epoch complete!
2024-05-02 12:02:15 INFO     evaluating now!
2024-05-02 12:02:15 INFO     Epoch [40/200] train_loss: 3.6713, val_loss: 4.7747, lr: 0.003000, 5.72s
2024-05-02 12:02:21 INFO     epoch complete!
2024-05-02 12:02:21 INFO     evaluating now!
2024-05-02 12:02:21 INFO     Epoch [41/200] train_loss: 3.6913, val_loss: 4.6486, lr: 0.003000, 5.82s
2024-05-02 12:02:21 INFO     Saved model at 41
2024-05-02 12:02:21 INFO     Val loss decrease from 4.6508 to 4.6486, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-05-02 12:02:27 INFO     epoch complete!
2024-05-02 12:02:27 INFO     evaluating now!
2024-05-02 12:02:27 INFO     Epoch [42/200] train_loss: 3.6219, val_loss: 4.7072, lr: 0.003000, 5.87s
2024-05-02 12:02:33 INFO     epoch complete!
2024-05-02 12:02:33 INFO     evaluating now!
2024-05-02 12:02:33 INFO     Epoch [43/200] train_loss: 3.6019, val_loss: 4.7238, lr: 0.003000, 5.75s
2024-05-02 12:02:38 INFO     epoch complete!
2024-05-02 12:02:38 INFO     evaluating now!
2024-05-02 12:02:39 INFO     Epoch [44/200] train_loss: 3.6003, val_loss: 4.7014, lr: 0.003000, 5.79s
2024-05-02 12:02:44 INFO     epoch complete!
2024-05-02 12:02:44 INFO     evaluating now!
2024-05-02 12:02:44 INFO     Epoch [45/200] train_loss: 3.5577, val_loss: 4.7816, lr: 0.003000, 5.71s
2024-05-02 12:02:50 INFO     epoch complete!
2024-05-02 12:02:50 INFO     evaluating now!
2024-05-02 12:02:50 INFO     Epoch [46/200] train_loss: 3.5910, val_loss: 4.8445, lr: 0.003000, 5.67s
2024-05-02 12:02:56 INFO     epoch complete!
2024-05-02 12:02:56 INFO     evaluating now!
2024-05-02 12:02:56 INFO     Epoch [47/200] train_loss: 3.6003, val_loss: 4.7429, lr: 0.003000, 5.77s
2024-05-02 12:03:01 INFO     epoch complete!
2024-05-02 12:03:01 INFO     evaluating now!
2024-05-02 12:03:02 INFO     Epoch [48/200] train_loss: 3.5745, val_loss: 4.7847, lr: 0.003000, 5.83s
2024-05-02 12:03:08 INFO     epoch complete!
2024-05-02 12:03:08 INFO     evaluating now!
2024-05-02 12:03:08 INFO     Epoch [49/200] train_loss: 3.5187, val_loss: 4.7405, lr: 0.003000, 6.38s
2024-05-02 12:03:14 INFO     epoch complete!
2024-05-02 12:03:14 INFO     evaluating now!
2024-05-02 12:03:14 INFO     Epoch [50/200] train_loss: 3.5182, val_loss: 4.7120, lr: 0.003000, 6.09s
2024-05-02 12:03:20 INFO     epoch complete!
2024-05-02 12:03:20 INFO     evaluating now!
2024-05-02 12:03:20 INFO     Epoch [51/200] train_loss: 3.4537, val_loss: 4.6781, lr: 0.003000, 5.77s
2024-05-02 12:03:25 INFO     epoch complete!
2024-05-02 12:03:25 INFO     evaluating now!
2024-05-02 12:03:26 INFO     Epoch [52/200] train_loss: 3.4597, val_loss: 4.7130, lr: 0.003000, 5.68s
2024-05-02 12:03:32 INFO     epoch complete!
2024-05-02 12:03:32 INFO     evaluating now!
2024-05-02 12:03:32 INFO     Epoch [53/200] train_loss: 3.4430, val_loss: 4.7037, lr: 0.003000, 6.38s
2024-05-02 12:03:37 INFO     epoch complete!
2024-05-02 12:03:37 INFO     evaluating now!
2024-05-02 12:03:38 INFO     Epoch [54/200] train_loss: 3.4067, val_loss: 4.6983, lr: 0.003000, 5.65s
2024-05-02 12:03:43 INFO     epoch complete!
2024-05-02 12:03:43 INFO     evaluating now!
2024-05-02 12:03:43 INFO     Epoch [55/200] train_loss: 3.4094, val_loss: 4.7627, lr: 0.003000, 5.73s
2024-05-02 12:03:49 INFO     epoch complete!
2024-05-02 12:03:49 INFO     evaluating now!
2024-05-02 12:03:49 INFO     Epoch [56/200] train_loss: 3.4187, val_loss: 4.6892, lr: 0.003000, 5.73s
2024-05-02 12:03:49 WARNING  Early stopping at epoch: 56
2024-05-02 12:03:49 INFO     Trained totally 57 epochs, average train time is 5.430s, average eval time is 0.311s
2024-05-02 12:03:49 INFO     Loaded model at 41
2024-05-02 12:03:49 INFO     Saved model at ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 12:03:49 INFO     Start evaluating ...
2024-05-02 12:03:51 INFO     Note that you select the single mode to evaluate!
2024-05-02 12:03:51 INFO     Evaluate result is saved at ./libcity/cache/15/evaluate_cache/2024_05_02_12_03_51_AGCRN_CHITaxi20190406.csv
2024-05-02 12:03:51 INFO     
         MAE       RMSE
1   2.419795   7.241198
2   2.506820   7.830500
3   2.680064   8.752944
4   2.711543   9.210475
5   2.767954   9.724902
6   2.773917   9.586654
7   2.795711   9.765453
8   2.842313   9.806578
9   2.813884   9.787716
10  2.863906   9.881921
11  2.829660   9.862320
12  2.861707  10.085526
2024-05-02 12:03:51 INFO     ----------------------------------------------------------------------------
2024-05-02 12:03:51 INFO     # 1, Kownledge Graph Embedding: Normal, Experiment ids: 16
2024-05-02 12:03:51 INFO     ----------------------------------------------------------------------------
2024-05-02 12:03:51 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=15
2024-05-02 12:03:51 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 15, 'load_external': True, 'normal_external': True, 'ext_scaler': 'none', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 12:03:51 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 12:03:51 INFO     set_weight_link_or_dist: dist
2024-05-02 12:03:51 INFO     init_weight_inf_or_zero: inf
2024-05-02 12:03:51 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 12:03:51 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 12:03:51 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 12:03:51 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 12:03:51 INFO     Dataset created
2024-05-02 12:03:51 INFO     x shape: (4345, 12, 77, 4), y shape: (4345, 12, 77, 4)
2024-05-02 12:03:51 INFO     train	x: (3042, 12, 77, 4), y: (3042, 12, 77, 4)
2024-05-02 12:03:51 INFO     eval	x: (434, 12, 77, 4), y: (434, 12, 77, 4)
2024-05-02 12:03:51 INFO     test	x: (869, 12, 77, 4), y: (869, 12, 77, 4)
2024-05-02 12:03:52 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 12:03:52 INFO     NoneScaler
2024-05-02 12:03:52 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 12:03:52 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 12:03:52 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 68, 128])	cuda:0	True
2024-05-02 12:03:52 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 12:03:52 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 68, 64])	cuda:0	True
2024-05-02 12:03:52 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 12:03:52 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 12:03:52 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 12:03:52 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 12:03:52 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 12:03:52 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 12:03:52 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 12:03:52 INFO     Total parameter numbers: 758810
2024-05-02 12:03:52 INFO     You select `adam` optimizer.
2024-05-02 12:03:52 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 12:03:52 INFO     Start training ...
2024-05-02 12:03:52 INFO     num_batches:48
2024-05-02 12:03:58 INFO     epoch complete!
2024-05-02 12:03:58 INFO     evaluating now!
2024-05-02 12:03:58 INFO     Epoch [0/200] train_loss: 24.3864, val_loss: 17.0679, lr: 0.003000, 5.85s
2024-05-02 12:03:58 INFO     Saved model at 0
2024-05-02 12:03:58 INFO     Val loss decrease from inf to 17.0679, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 12:04:03 INFO     epoch complete!
2024-05-02 12:04:03 INFO     evaluating now!
2024-05-02 12:04:03 INFO     Epoch [1/200] train_loss: 13.4106, val_loss: 12.4963, lr: 0.003000, 5.45s
2024-05-02 12:04:03 INFO     Saved model at 1
2024-05-02 12:04:03 INFO     Val loss decrease from 17.0679 to 12.4963, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 12:04:08 INFO     epoch complete!
2024-05-02 12:04:08 INFO     evaluating now!
2024-05-02 12:04:08 INFO     Epoch [2/200] train_loss: 10.2063, val_loss: 9.4727, lr: 0.003000, 5.15s
2024-05-02 12:04:09 INFO     Saved model at 2
2024-05-02 12:04:09 INFO     Val loss decrease from 12.4963 to 9.4727, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 12:04:13 INFO     epoch complete!
2024-05-02 12:04:13 INFO     evaluating now!
2024-05-02 12:04:14 INFO     Epoch [3/200] train_loss: 8.2762, val_loss: 8.0471, lr: 0.003000, 5.00s
2024-05-02 12:04:14 INFO     Saved model at 3
2024-05-02 12:04:14 INFO     Val loss decrease from 9.4727 to 8.0471, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 12:04:18 INFO     epoch complete!
2024-05-02 12:04:18 INFO     evaluating now!
2024-05-02 12:04:19 INFO     Epoch [4/200] train_loss: 7.2236, val_loss: 6.9632, lr: 0.003000, 5.00s
2024-05-02 12:04:19 INFO     Saved model at 4
2024-05-02 12:04:19 INFO     Val loss decrease from 8.0471 to 6.9632, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 12:04:23 INFO     epoch complete!
2024-05-02 12:04:23 INFO     evaluating now!
2024-05-02 12:04:24 INFO     Epoch [5/200] train_loss: 6.5969, val_loss: 6.5497, lr: 0.003000, 5.05s
2024-05-02 12:04:24 INFO     Saved model at 5
2024-05-02 12:04:24 INFO     Val loss decrease from 6.9632 to 6.5497, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 12:04:29 INFO     epoch complete!
2024-05-02 12:04:29 INFO     evaluating now!
2024-05-02 12:04:29 INFO     Epoch [6/200] train_loss: 6.1517, val_loss: 6.1256, lr: 0.003000, 5.12s
2024-05-02 12:04:29 INFO     Saved model at 6
2024-05-02 12:04:29 INFO     Val loss decrease from 6.5497 to 6.1256, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 12:04:34 INFO     epoch complete!
2024-05-02 12:04:34 INFO     evaluating now!
2024-05-02 12:04:34 INFO     Epoch [7/200] train_loss: 5.8214, val_loss: 5.8209, lr: 0.003000, 5.17s
2024-05-02 12:04:34 INFO     Saved model at 7
2024-05-02 12:04:34 INFO     Val loss decrease from 6.1256 to 5.8209, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 12:04:39 INFO     epoch complete!
2024-05-02 12:04:39 INFO     evaluating now!
2024-05-02 12:04:39 INFO     Epoch [8/200] train_loss: 5.5525, val_loss: 5.9063, lr: 0.003000, 5.10s
2024-05-02 12:04:45 INFO     epoch complete!
2024-05-02 12:04:45 INFO     evaluating now!
2024-05-02 12:04:45 INFO     Epoch [9/200] train_loss: 5.3790, val_loss: 5.4805, lr: 0.003000, 5.75s
2024-05-02 12:04:45 INFO     Saved model at 9
2024-05-02 12:04:45 INFO     Val loss decrease from 5.8209 to 5.4805, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 12:04:50 INFO     epoch complete!
2024-05-02 12:04:50 INFO     evaluating now!
2024-05-02 12:04:50 INFO     Epoch [10/200] train_loss: 5.1847, val_loss: 5.4099, lr: 0.003000, 5.47s
2024-05-02 12:04:50 INFO     Saved model at 10
2024-05-02 12:04:50 INFO     Val loss decrease from 5.4805 to 5.4099, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 12:04:56 INFO     epoch complete!
2024-05-02 12:04:56 INFO     evaluating now!
2024-05-02 12:04:56 INFO     Epoch [11/200] train_loss: 5.0232, val_loss: 5.4548, lr: 0.003000, 5.50s
2024-05-02 12:05:01 INFO     epoch complete!
2024-05-02 12:05:01 INFO     evaluating now!
2024-05-02 12:05:02 INFO     Epoch [12/200] train_loss: 4.9762, val_loss: 5.2701, lr: 0.003000, 5.81s
2024-05-02 12:05:02 INFO     Saved model at 12
2024-05-02 12:05:02 INFO     Val loss decrease from 5.4099 to 5.2701, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 12:05:07 INFO     epoch complete!
2024-05-02 12:05:07 INFO     evaluating now!
2024-05-02 12:05:07 INFO     Epoch [13/200] train_loss: 4.8562, val_loss: 5.1649, lr: 0.003000, 5.51s
2024-05-02 12:05:07 INFO     Saved model at 13
2024-05-02 12:05:07 INFO     Val loss decrease from 5.2701 to 5.1649, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-02 12:05:13 INFO     epoch complete!
2024-05-02 12:05:13 INFO     evaluating now!
2024-05-02 12:05:13 INFO     Epoch [14/200] train_loss: 4.6974, val_loss: 5.0716, lr: 0.003000, 5.43s
2024-05-02 12:05:13 INFO     Saved model at 14
2024-05-02 12:05:13 INFO     Val loss decrease from 5.1649 to 5.0716, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-02 12:05:18 INFO     epoch complete!
2024-05-02 12:05:18 INFO     evaluating now!
2024-05-02 12:05:18 INFO     Epoch [15/200] train_loss: 4.7004, val_loss: 5.0967, lr: 0.003000, 5.52s
2024-05-02 12:05:23 INFO     epoch complete!
2024-05-02 12:05:23 INFO     evaluating now!
2024-05-02 12:05:24 INFO     Epoch [16/200] train_loss: 4.5818, val_loss: 5.0290, lr: 0.003000, 5.23s
2024-05-02 12:05:24 INFO     Saved model at 16
2024-05-02 12:05:24 INFO     Val loss decrease from 5.0716 to 5.0290, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-02 12:05:29 INFO     epoch complete!
2024-05-02 12:05:29 INFO     evaluating now!
2024-05-02 12:05:29 INFO     Epoch [17/200] train_loss: 4.5136, val_loss: 5.0501, lr: 0.003000, 5.45s
2024-05-02 12:05:34 INFO     epoch complete!
2024-05-02 12:05:34 INFO     evaluating now!
2024-05-02 12:05:35 INFO     Epoch [18/200] train_loss: 4.4097, val_loss: 5.0300, lr: 0.003000, 5.48s
2024-05-02 12:05:40 INFO     epoch complete!
2024-05-02 12:05:40 INFO     evaluating now!
2024-05-02 12:05:40 INFO     Epoch [19/200] train_loss: 4.3533, val_loss: 4.8017, lr: 0.003000, 5.52s
2024-05-02 12:05:40 INFO     Saved model at 19
2024-05-02 12:05:40 INFO     Val loss decrease from 5.0290 to 4.8017, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-02 12:05:45 INFO     epoch complete!
2024-05-02 12:05:45 INFO     evaluating now!
2024-05-02 12:05:45 INFO     Epoch [20/200] train_loss: 4.2679, val_loss: 4.9745, lr: 0.003000, 5.33s
2024-05-02 12:05:51 INFO     epoch complete!
2024-05-02 12:05:51 INFO     evaluating now!
2024-05-02 12:05:51 INFO     Epoch [21/200] train_loss: 4.2584, val_loss: 4.9102, lr: 0.003000, 5.43s
2024-05-02 12:05:56 INFO     epoch complete!
2024-05-02 12:05:56 INFO     evaluating now!
2024-05-02 12:05:56 INFO     Epoch [22/200] train_loss: 4.1896, val_loss: 4.8065, lr: 0.003000, 5.43s
2024-05-02 12:06:01 INFO     epoch complete!
2024-05-02 12:06:01 INFO     evaluating now!
2024-05-02 12:06:02 INFO     Epoch [23/200] train_loss: 4.1633, val_loss: 4.9023, lr: 0.003000, 5.41s
2024-05-02 12:06:07 INFO     epoch complete!
2024-05-02 12:06:07 INFO     evaluating now!
2024-05-02 12:06:07 INFO     Epoch [24/200] train_loss: 4.1877, val_loss: 4.8586, lr: 0.003000, 5.64s
2024-05-02 12:06:13 INFO     epoch complete!
2024-05-02 12:06:13 INFO     evaluating now!
2024-05-02 12:06:13 INFO     Epoch [25/200] train_loss: 4.1536, val_loss: 4.8067, lr: 0.003000, 5.61s
2024-05-02 12:06:18 INFO     epoch complete!
2024-05-02 12:06:18 INFO     evaluating now!
2024-05-02 12:06:19 INFO     Epoch [26/200] train_loss: 4.0532, val_loss: 4.8244, lr: 0.003000, 5.50s
2024-05-02 12:06:24 INFO     epoch complete!
2024-05-02 12:06:24 INFO     evaluating now!
2024-05-02 12:06:24 INFO     Epoch [27/200] train_loss: 4.0100, val_loss: 4.8689, lr: 0.003000, 5.67s
2024-05-02 12:06:30 INFO     epoch complete!
2024-05-02 12:06:30 INFO     evaluating now!
2024-05-02 12:06:30 INFO     Epoch [28/200] train_loss: 3.9547, val_loss: 4.7410, lr: 0.003000, 5.71s
2024-05-02 12:06:30 INFO     Saved model at 28
2024-05-02 12:06:30 INFO     Val loss decrease from 4.8017 to 4.7410, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-05-02 12:06:35 INFO     epoch complete!
2024-05-02 12:06:35 INFO     evaluating now!
2024-05-02 12:06:35 INFO     Epoch [29/200] train_loss: 3.8861, val_loss: 4.8043, lr: 0.003000, 5.53s
2024-05-02 12:06:41 INFO     epoch complete!
2024-05-02 12:06:41 INFO     evaluating now!
2024-05-02 12:06:41 INFO     Epoch [30/200] train_loss: 3.8928, val_loss: 4.7414, lr: 0.003000, 5.98s
2024-05-02 12:06:47 INFO     epoch complete!
2024-05-02 12:06:47 INFO     evaluating now!
2024-05-02 12:06:47 INFO     Epoch [31/200] train_loss: 3.8535, val_loss: 4.7467, lr: 0.003000, 6.05s
2024-05-02 12:06:54 INFO     epoch complete!
2024-05-02 12:06:54 INFO     evaluating now!
2024-05-02 12:06:54 INFO     Epoch [32/200] train_loss: 3.8430, val_loss: 4.8085, lr: 0.003000, 6.47s
2024-05-02 12:07:00 INFO     epoch complete!
2024-05-02 12:07:00 INFO     evaluating now!
2024-05-02 12:07:00 INFO     Epoch [33/200] train_loss: 3.8397, val_loss: 4.9559, lr: 0.003000, 6.37s
2024-05-02 12:07:06 INFO     epoch complete!
2024-05-02 12:07:06 INFO     evaluating now!
2024-05-02 12:07:06 INFO     Epoch [34/200] train_loss: 3.8829, val_loss: 4.7579, lr: 0.003000, 6.14s
2024-05-02 12:07:12 INFO     epoch complete!
2024-05-02 12:07:12 INFO     evaluating now!
2024-05-02 12:07:12 INFO     Epoch [35/200] train_loss: 3.7591, val_loss: 4.8052, lr: 0.003000, 5.67s
2024-05-02 12:07:17 INFO     epoch complete!
2024-05-02 12:07:17 INFO     evaluating now!
2024-05-02 12:07:18 INFO     Epoch [36/200] train_loss: 3.8016, val_loss: 4.7988, lr: 0.003000, 5.46s
2024-05-02 12:07:23 INFO     epoch complete!
2024-05-02 12:07:23 INFO     evaluating now!
2024-05-02 12:07:23 INFO     Epoch [37/200] train_loss: 3.7268, val_loss: 4.7402, lr: 0.003000, 5.46s
2024-05-02 12:07:23 INFO     Saved model at 37
2024-05-02 12:07:23 INFO     Val loss decrease from 4.7410 to 4.7402, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-05-02 12:07:28 INFO     epoch complete!
2024-05-02 12:07:28 INFO     evaluating now!
2024-05-02 12:07:29 INFO     Epoch [38/200] train_loss: 3.7326, val_loss: 4.8116, lr: 0.003000, 5.57s
2024-05-02 12:07:34 INFO     epoch complete!
2024-05-02 12:07:34 INFO     evaluating now!
2024-05-02 12:07:34 INFO     Epoch [39/200] train_loss: 3.6646, val_loss: 4.7529, lr: 0.003000, 5.61s
2024-05-02 12:07:40 INFO     epoch complete!
2024-05-02 12:07:40 INFO     evaluating now!
2024-05-02 12:07:40 INFO     Epoch [40/200] train_loss: 3.6590, val_loss: 4.6783, lr: 0.003000, 5.53s
2024-05-02 12:07:40 INFO     Saved model at 40
2024-05-02 12:07:40 INFO     Val loss decrease from 4.7402 to 4.6783, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch40.tar
2024-05-02 12:07:45 INFO     epoch complete!
2024-05-02 12:07:45 INFO     evaluating now!
2024-05-02 12:07:46 INFO     Epoch [41/200] train_loss: 3.7022, val_loss: 4.7924, lr: 0.003000, 5.65s
2024-05-02 12:07:51 INFO     epoch complete!
2024-05-02 12:07:51 INFO     evaluating now!
2024-05-02 12:07:51 INFO     Epoch [42/200] train_loss: 3.5972, val_loss: 4.6862, lr: 0.003000, 5.36s
2024-05-02 12:07:56 INFO     epoch complete!
2024-05-02 12:07:56 INFO     evaluating now!
2024-05-02 12:07:56 INFO     Epoch [43/200] train_loss: 3.5657, val_loss: 4.7227, lr: 0.003000, 5.43s
2024-05-02 12:08:02 INFO     epoch complete!
2024-05-02 12:08:02 INFO     evaluating now!
2024-05-02 12:08:02 INFO     Epoch [44/200] train_loss: 3.5768, val_loss: 4.8194, lr: 0.003000, 5.59s
2024-05-02 12:08:07 INFO     epoch complete!
2024-05-02 12:08:07 INFO     evaluating now!
2024-05-02 12:08:07 INFO     Epoch [45/200] train_loss: 3.5599, val_loss: 4.8073, lr: 0.003000, 5.34s
2024-05-02 12:08:12 INFO     epoch complete!
2024-05-02 12:08:12 INFO     evaluating now!
2024-05-02 12:08:13 INFO     Epoch [46/200] train_loss: 3.5246, val_loss: 4.7344, lr: 0.003000, 5.46s
2024-05-02 12:08:18 INFO     epoch complete!
2024-05-02 12:08:18 INFO     evaluating now!
2024-05-02 12:08:18 INFO     Epoch [47/200] train_loss: 3.5429, val_loss: 4.7365, lr: 0.003000, 5.28s
2024-05-02 12:08:24 INFO     epoch complete!
2024-05-02 12:08:24 INFO     evaluating now!
2024-05-02 12:08:24 INFO     Epoch [48/200] train_loss: 3.5344, val_loss: 4.6366, lr: 0.003000, 6.06s
2024-05-02 12:08:24 INFO     Saved model at 48
2024-05-02 12:08:24 INFO     Val loss decrease from 4.6783 to 4.6366, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch48.tar
2024-05-02 12:08:30 INFO     epoch complete!
2024-05-02 12:08:30 INFO     evaluating now!
2024-05-02 12:08:30 INFO     Epoch [49/200] train_loss: 3.5036, val_loss: 4.6738, lr: 0.003000, 6.11s
2024-05-02 12:08:36 INFO     epoch complete!
2024-05-02 12:08:36 INFO     evaluating now!
2024-05-02 12:08:36 INFO     Epoch [50/200] train_loss: 3.4802, val_loss: 4.7522, lr: 0.003000, 6.08s
2024-05-02 12:08:41 INFO     epoch complete!
2024-05-02 12:08:41 INFO     evaluating now!
2024-05-02 12:08:42 INFO     Epoch [51/200] train_loss: 3.4697, val_loss: 4.8122, lr: 0.003000, 5.42s
2024-05-02 12:08:47 INFO     epoch complete!
2024-05-02 12:08:47 INFO     evaluating now!
2024-05-02 12:08:47 INFO     Epoch [52/200] train_loss: 3.4638, val_loss: 4.7115, lr: 0.003000, 5.42s
2024-05-02 12:08:52 INFO     epoch complete!
2024-05-02 12:08:52 INFO     evaluating now!
2024-05-02 12:08:53 INFO     Epoch [53/200] train_loss: 3.4421, val_loss: 4.7447, lr: 0.003000, 5.57s
2024-05-02 12:08:58 INFO     epoch complete!
2024-05-02 12:08:58 INFO     evaluating now!
2024-05-02 12:08:58 INFO     Epoch [54/200] train_loss: 3.4160, val_loss: 4.7381, lr: 0.003000, 5.43s
2024-05-02 12:09:03 INFO     epoch complete!
2024-05-02 12:09:03 INFO     evaluating now!
2024-05-02 12:09:04 INFO     Epoch [55/200] train_loss: 3.3943, val_loss: 4.6565, lr: 0.003000, 5.50s
2024-05-02 12:09:09 INFO     epoch complete!
2024-05-02 12:09:09 INFO     evaluating now!
2024-05-02 12:09:09 INFO     Epoch [56/200] train_loss: 3.4381, val_loss: 4.7754, lr: 0.003000, 5.47s
2024-05-02 12:09:14 INFO     epoch complete!
2024-05-02 12:09:14 INFO     evaluating now!
2024-05-02 12:09:15 INFO     Epoch [57/200] train_loss: 3.4016, val_loss: 4.6980, lr: 0.003000, 5.70s
2024-05-02 12:09:20 INFO     epoch complete!
2024-05-02 12:09:20 INFO     evaluating now!
2024-05-02 12:09:20 INFO     Epoch [58/200] train_loss: 3.3729, val_loss: 4.7501, lr: 0.003000, 5.66s
2024-05-02 12:09:26 INFO     epoch complete!
2024-05-02 12:09:26 INFO     evaluating now!
2024-05-02 12:09:26 INFO     Epoch [59/200] train_loss: 3.3726, val_loss: 4.7781, lr: 0.003000, 6.03s
2024-05-02 12:09:31 INFO     epoch complete!
2024-05-02 12:09:31 INFO     evaluating now!
2024-05-02 12:09:32 INFO     Epoch [60/200] train_loss: 3.3396, val_loss: 4.6924, lr: 0.003000, 5.07s
2024-05-02 12:09:36 INFO     epoch complete!
2024-05-02 12:09:36 INFO     evaluating now!
2024-05-02 12:09:37 INFO     Epoch [61/200] train_loss: 3.3451, val_loss: 4.7586, lr: 0.003000, 5.03s
2024-05-02 12:09:41 INFO     epoch complete!
2024-05-02 12:09:41 INFO     evaluating now!
2024-05-02 12:09:42 INFO     Epoch [62/200] train_loss: 3.3318, val_loss: 4.6998, lr: 0.003000, 4.97s
2024-05-02 12:09:46 INFO     epoch complete!
2024-05-02 12:09:46 INFO     evaluating now!
2024-05-02 12:09:46 INFO     Epoch [63/200] train_loss: 3.3440, val_loss: 4.7431, lr: 0.003000, 4.97s
2024-05-02 12:09:46 WARNING  Early stopping at epoch: 63
2024-05-02 12:09:46 INFO     Trained totally 64 epochs, average train time is 5.219s, average eval time is 0.306s
2024-05-02 12:09:47 INFO     Loaded model at 48
2024-05-02 12:09:47 INFO     Saved model at ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 12:09:47 INFO     Start evaluating ...
2024-05-02 12:09:48 INFO     Note that you select the single mode to evaluate!
2024-05-02 12:09:48 INFO     Evaluate result is saved at ./libcity/cache/15/evaluate_cache/2024_05_02_12_09_48_AGCRN_CHITaxi20190406.csv
2024-05-02 12:09:48 INFO     
         MAE      RMSE
1   2.261096  6.892554
2   2.327767  7.335799
3   2.464821  8.168828
4   2.565684  8.773149
5   2.653621  9.167923
6   2.727832  9.368927
7   2.729450  9.488904
8   2.736191  9.567234
9   2.772935  9.620867
10  2.800930  9.663566
11  2.787539  9.680488
12  2.834531  9.798236
2024-05-02 12:09:48 INFO     ----------------------------------------------------------------------------
2024-05-02 12:09:48 INFO     # 2, Kownledge Graph Embedding: Normal, Experiment ids: 17
2024-05-02 12:09:48 INFO     ----------------------------------------------------------------------------
2024-05-02 12:09:48 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=15
2024-05-02 12:09:48 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 15, 'load_external': True, 'normal_external': True, 'ext_scaler': 'none', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 12:09:48 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 12:09:48 INFO     set_weight_link_or_dist: dist
2024-05-02 12:09:48 INFO     init_weight_inf_or_zero: inf
2024-05-02 12:09:48 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 12:09:48 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 12:09:48 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 12:09:48 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 12:09:49 INFO     Dataset created
2024-05-02 12:09:49 INFO     x shape: (4345, 12, 77, 4), y shape: (4345, 12, 77, 4)
2024-05-02 12:09:49 INFO     train	x: (3042, 12, 77, 4), y: (3042, 12, 77, 4)
2024-05-02 12:09:49 INFO     eval	x: (434, 12, 77, 4), y: (434, 12, 77, 4)
2024-05-02 12:09:49 INFO     test	x: (869, 12, 77, 4), y: (869, 12, 77, 4)
2024-05-02 12:09:49 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 12:09:49 INFO     NoneScaler
2024-05-02 12:09:49 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 12:09:49 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 12:09:49 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 68, 128])	cuda:0	True
2024-05-02 12:09:49 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 12:09:49 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 68, 64])	cuda:0	True
2024-05-02 12:09:49 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 12:09:49 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 12:09:49 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 12:09:49 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 12:09:49 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 12:09:49 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 12:09:49 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 12:09:49 INFO     Total parameter numbers: 758810
2024-05-02 12:09:49 INFO     You select `adam` optimizer.
2024-05-02 12:09:49 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 12:09:49 INFO     Start training ...
2024-05-02 12:09:49 INFO     num_batches:48
2024-05-02 12:09:54 INFO     epoch complete!
2024-05-02 12:09:54 INFO     evaluating now!
2024-05-02 12:09:54 INFO     Epoch [0/200] train_loss: 24.8056, val_loss: 17.6308, lr: 0.003000, 4.98s
2024-05-02 12:09:54 INFO     Saved model at 0
2024-05-02 12:09:54 INFO     Val loss decrease from inf to 17.6308, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 12:09:59 INFO     epoch complete!
2024-05-02 12:09:59 INFO     evaluating now!
2024-05-02 12:09:59 INFO     Epoch [1/200] train_loss: 14.1646, val_loss: 13.3432, lr: 0.003000, 5.08s
2024-05-02 12:09:59 INFO     Saved model at 1
2024-05-02 12:09:59 INFO     Val loss decrease from 17.6308 to 13.3432, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 12:10:04 INFO     epoch complete!
2024-05-02 12:10:04 INFO     evaluating now!
2024-05-02 12:10:05 INFO     Epoch [2/200] train_loss: 10.6421, val_loss: 9.8380, lr: 0.003000, 5.08s
2024-05-02 12:10:05 INFO     Saved model at 2
2024-05-02 12:10:05 INFO     Val loss decrease from 13.3432 to 9.8380, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 12:10:09 INFO     epoch complete!
2024-05-02 12:10:09 INFO     evaluating now!
2024-05-02 12:10:10 INFO     Epoch [3/200] train_loss: 8.5704, val_loss: 7.9404, lr: 0.003000, 4.99s
2024-05-02 12:10:10 INFO     Saved model at 3
2024-05-02 12:10:10 INFO     Val loss decrease from 9.8380 to 7.9404, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 12:10:15 INFO     epoch complete!
2024-05-02 12:10:15 INFO     evaluating now!
2024-05-02 12:10:15 INFO     Epoch [4/200] train_loss: 7.4067, val_loss: 7.2213, lr: 0.003000, 5.71s
2024-05-02 12:10:15 INFO     Saved model at 4
2024-05-02 12:10:15 INFO     Val loss decrease from 7.9404 to 7.2213, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 12:10:20 INFO     epoch complete!
2024-05-02 12:10:20 INFO     evaluating now!
2024-05-02 12:10:21 INFO     Epoch [5/200] train_loss: 6.7084, val_loss: 6.5061, lr: 0.003000, 5.37s
2024-05-02 12:10:21 INFO     Saved model at 5
2024-05-02 12:10:21 INFO     Val loss decrease from 7.2213 to 6.5061, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 12:10:26 INFO     epoch complete!
2024-05-02 12:10:26 INFO     evaluating now!
2024-05-02 12:10:26 INFO     Epoch [6/200] train_loss: 6.2744, val_loss: 6.1857, lr: 0.003000, 5.39s
2024-05-02 12:10:26 INFO     Saved model at 6
2024-05-02 12:10:26 INFO     Val loss decrease from 6.5061 to 6.1857, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 12:10:31 INFO     epoch complete!
2024-05-02 12:10:31 INFO     evaluating now!
2024-05-02 12:10:31 INFO     Epoch [7/200] train_loss: 5.9035, val_loss: 5.9990, lr: 0.003000, 5.11s
2024-05-02 12:10:31 INFO     Saved model at 7
2024-05-02 12:10:31 INFO     Val loss decrease from 6.1857 to 5.9990, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 12:10:36 INFO     epoch complete!
2024-05-02 12:10:36 INFO     evaluating now!
2024-05-02 12:10:37 INFO     Epoch [8/200] train_loss: 5.6733, val_loss: 5.8920, lr: 0.003000, 5.37s
2024-05-02 12:10:37 INFO     Saved model at 8
2024-05-02 12:10:37 INFO     Val loss decrease from 5.9990 to 5.8920, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 12:10:42 INFO     epoch complete!
2024-05-02 12:10:42 INFO     evaluating now!
2024-05-02 12:10:42 INFO     Epoch [9/200] train_loss: 5.4479, val_loss: 5.7218, lr: 0.003000, 5.39s
2024-05-02 12:10:42 INFO     Saved model at 9
2024-05-02 12:10:42 INFO     Val loss decrease from 5.8920 to 5.7218, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 12:10:47 INFO     epoch complete!
2024-05-02 12:10:47 INFO     evaluating now!
2024-05-02 12:10:48 INFO     Epoch [10/200] train_loss: 5.3025, val_loss: 5.5219, lr: 0.003000, 5.38s
2024-05-02 12:10:48 INFO     Saved model at 10
2024-05-02 12:10:48 INFO     Val loss decrease from 5.7218 to 5.5219, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 12:10:53 INFO     epoch complete!
2024-05-02 12:10:53 INFO     evaluating now!
2024-05-02 12:10:53 INFO     Epoch [11/200] train_loss: 5.0965, val_loss: 5.1974, lr: 0.003000, 5.48s
2024-05-02 12:10:53 INFO     Saved model at 11
2024-05-02 12:10:53 INFO     Val loss decrease from 5.5219 to 5.1974, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 12:10:58 INFO     epoch complete!
2024-05-02 12:10:58 INFO     evaluating now!
2024-05-02 12:10:59 INFO     Epoch [12/200] train_loss: 5.0085, val_loss: 5.2101, lr: 0.003000, 5.44s
2024-05-02 12:11:04 INFO     epoch complete!
2024-05-02 12:11:04 INFO     evaluating now!
2024-05-02 12:11:04 INFO     Epoch [13/200] train_loss: 4.8723, val_loss: 5.2501, lr: 0.003000, 5.62s
2024-05-02 12:11:09 INFO     epoch complete!
2024-05-02 12:11:09 INFO     evaluating now!
2024-05-02 12:11:10 INFO     Epoch [14/200] train_loss: 4.7923, val_loss: 5.2293, lr: 0.003000, 5.38s
2024-05-02 12:11:15 INFO     epoch complete!
2024-05-02 12:11:15 INFO     evaluating now!
2024-05-02 12:11:15 INFO     Epoch [15/200] train_loss: 4.7210, val_loss: 5.1797, lr: 0.003000, 5.29s
2024-05-02 12:11:15 INFO     Saved model at 15
2024-05-02 12:11:15 INFO     Val loss decrease from 5.1974 to 5.1797, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-02 12:11:20 INFO     epoch complete!
2024-05-02 12:11:20 INFO     evaluating now!
2024-05-02 12:11:21 INFO     Epoch [16/200] train_loss: 4.6809, val_loss: 5.1634, lr: 0.003000, 5.82s
2024-05-02 12:11:21 INFO     Saved model at 16
2024-05-02 12:11:21 INFO     Val loss decrease from 5.1797 to 5.1634, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-02 12:11:26 INFO     epoch complete!
2024-05-02 12:11:26 INFO     evaluating now!
2024-05-02 12:11:26 INFO     Epoch [17/200] train_loss: 4.5162, val_loss: 5.0202, lr: 0.003000, 5.52s
2024-05-02 12:11:26 INFO     Saved model at 17
2024-05-02 12:11:26 INFO     Val loss decrease from 5.1634 to 5.0202, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-02 12:11:31 INFO     epoch complete!
2024-05-02 12:11:31 INFO     evaluating now!
2024-05-02 12:11:32 INFO     Epoch [18/200] train_loss: 4.5498, val_loss: 5.0922, lr: 0.003000, 5.38s
2024-05-02 12:11:37 INFO     epoch complete!
2024-05-02 12:11:37 INFO     evaluating now!
2024-05-02 12:11:37 INFO     Epoch [19/200] train_loss: 4.4629, val_loss: 5.1140, lr: 0.003000, 5.36s
2024-05-02 12:11:42 INFO     epoch complete!
2024-05-02 12:11:42 INFO     evaluating now!
2024-05-02 12:11:42 INFO     Epoch [20/200] train_loss: 4.3537, val_loss: 4.8996, lr: 0.003000, 5.39s
2024-05-02 12:11:43 INFO     Saved model at 20
2024-05-02 12:11:43 INFO     Val loss decrease from 5.0202 to 4.8996, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-02 12:11:48 INFO     epoch complete!
2024-05-02 12:11:48 INFO     evaluating now!
2024-05-02 12:11:48 INFO     Epoch [21/200] train_loss: 4.2957, val_loss: 4.9422, lr: 0.003000, 5.73s
2024-05-02 12:11:54 INFO     epoch complete!
2024-05-02 12:11:54 INFO     evaluating now!
2024-05-02 12:11:54 INFO     Epoch [22/200] train_loss: 4.3361, val_loss: 4.8656, lr: 0.003000, 5.90s
2024-05-02 12:11:54 INFO     Saved model at 22
2024-05-02 12:11:54 INFO     Val loss decrease from 4.8996 to 4.8656, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-02 12:11:59 INFO     epoch complete!
2024-05-02 12:11:59 INFO     evaluating now!
2024-05-02 12:12:00 INFO     Epoch [23/200] train_loss: 4.2268, val_loss: 5.0317, lr: 0.003000, 5.52s
2024-05-02 12:12:05 INFO     epoch complete!
2024-05-02 12:12:05 INFO     evaluating now!
2024-05-02 12:12:05 INFO     Epoch [24/200] train_loss: 4.2005, val_loss: 4.9100, lr: 0.003000, 5.49s
2024-05-02 12:12:10 INFO     epoch complete!
2024-05-02 12:12:10 INFO     evaluating now!
2024-05-02 12:12:11 INFO     Epoch [25/200] train_loss: 4.1222, val_loss: 4.8801, lr: 0.003000, 5.44s
2024-05-02 12:12:16 INFO     epoch complete!
2024-05-02 12:12:16 INFO     evaluating now!
2024-05-02 12:12:16 INFO     Epoch [26/200] train_loss: 4.0974, val_loss: 4.9687, lr: 0.003000, 5.53s
2024-05-02 12:12:21 INFO     epoch complete!
2024-05-02 12:12:21 INFO     evaluating now!
2024-05-02 12:12:22 INFO     Epoch [27/200] train_loss: 4.0223, val_loss: 4.7366, lr: 0.003000, 5.63s
2024-05-02 12:12:22 INFO     Saved model at 27
2024-05-02 12:12:22 INFO     Val loss decrease from 4.8656 to 4.7366, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-05-02 12:12:27 INFO     epoch complete!
2024-05-02 12:12:27 INFO     evaluating now!
2024-05-02 12:12:27 INFO     Epoch [28/200] train_loss: 4.0411, val_loss: 4.7987, lr: 0.003000, 5.56s
2024-05-02 12:12:33 INFO     epoch complete!
2024-05-02 12:12:33 INFO     evaluating now!
2024-05-02 12:12:33 INFO     Epoch [29/200] train_loss: 4.0473, val_loss: 4.8024, lr: 0.003000, 5.49s
2024-05-02 12:12:38 INFO     epoch complete!
2024-05-02 12:12:38 INFO     evaluating now!
2024-05-02 12:12:38 INFO     Epoch [30/200] train_loss: 3.9408, val_loss: 4.7565, lr: 0.003000, 5.46s
2024-05-02 12:12:43 INFO     epoch complete!
2024-05-02 12:12:43 INFO     evaluating now!
2024-05-02 12:12:44 INFO     Epoch [31/200] train_loss: 3.9415, val_loss: 4.7785, lr: 0.003000, 5.42s
2024-05-02 12:12:49 INFO     epoch complete!
2024-05-02 12:12:49 INFO     evaluating now!
2024-05-02 12:12:49 INFO     Epoch [32/200] train_loss: 3.8698, val_loss: 4.8179, lr: 0.003000, 5.32s
2024-05-02 12:12:54 INFO     epoch complete!
2024-05-02 12:12:54 INFO     evaluating now!
2024-05-02 12:12:54 INFO     Epoch [33/200] train_loss: 3.8610, val_loss: 4.7857, lr: 0.003000, 5.42s
2024-05-02 12:13:00 INFO     epoch complete!
2024-05-02 12:13:00 INFO     evaluating now!
2024-05-02 12:13:00 INFO     Epoch [34/200] train_loss: 3.8844, val_loss: 4.7689, lr: 0.003000, 5.38s
2024-05-02 12:13:05 INFO     epoch complete!
2024-05-02 12:13:05 INFO     evaluating now!
2024-05-02 12:13:05 INFO     Epoch [35/200] train_loss: 3.8346, val_loss: 4.9747, lr: 0.003000, 5.42s
2024-05-02 12:13:10 INFO     epoch complete!
2024-05-02 12:13:10 INFO     evaluating now!
2024-05-02 12:13:11 INFO     Epoch [36/200] train_loss: 3.8084, val_loss: 4.7175, lr: 0.003000, 5.37s
2024-05-02 12:13:11 INFO     Saved model at 36
2024-05-02 12:13:11 INFO     Val loss decrease from 4.7366 to 4.7175, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-05-02 12:13:16 INFO     epoch complete!
2024-05-02 12:13:16 INFO     evaluating now!
2024-05-02 12:13:16 INFO     Epoch [37/200] train_loss: 3.7670, val_loss: 4.7911, lr: 0.003000, 5.41s
2024-05-02 12:13:21 INFO     epoch complete!
2024-05-02 12:13:21 INFO     evaluating now!
2024-05-02 12:13:21 INFO     Epoch [38/200] train_loss: 3.7405, val_loss: 4.8344, lr: 0.003000, 5.37s
2024-05-02 12:13:27 INFO     epoch complete!
2024-05-02 12:13:27 INFO     evaluating now!
2024-05-02 12:13:27 INFO     Epoch [39/200] train_loss: 3.7102, val_loss: 4.7324, lr: 0.003000, 5.45s
2024-05-02 12:13:32 INFO     epoch complete!
2024-05-02 12:13:32 INFO     evaluating now!
2024-05-02 12:13:33 INFO     Epoch [40/200] train_loss: 3.6701, val_loss: 4.8550, lr: 0.003000, 5.80s
2024-05-02 12:13:38 INFO     epoch complete!
2024-05-02 12:13:38 INFO     evaluating now!
2024-05-02 12:13:39 INFO     Epoch [41/200] train_loss: 3.6997, val_loss: 4.6603, lr: 0.003000, 5.99s
2024-05-02 12:13:39 INFO     Saved model at 41
2024-05-02 12:13:39 INFO     Val loss decrease from 4.7175 to 4.6603, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-05-02 12:13:44 INFO     epoch complete!
2024-05-02 12:13:44 INFO     evaluating now!
2024-05-02 12:13:45 INFO     Epoch [42/200] train_loss: 3.6281, val_loss: 4.7592, lr: 0.003000, 5.88s
2024-05-02 12:13:50 INFO     epoch complete!
2024-05-02 12:13:50 INFO     evaluating now!
2024-05-02 12:13:51 INFO     Epoch [43/200] train_loss: 3.6113, val_loss: 4.6574, lr: 0.003000, 5.99s
2024-05-02 12:13:51 INFO     Saved model at 43
2024-05-02 12:13:51 INFO     Val loss decrease from 4.6603 to 4.6574, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-05-02 12:13:57 INFO     epoch complete!
2024-05-02 12:13:57 INFO     evaluating now!
2024-05-02 12:13:57 INFO     Epoch [44/200] train_loss: 3.6179, val_loss: 4.8333, lr: 0.003000, 6.35s
2024-05-02 12:14:03 INFO     epoch complete!
2024-05-02 12:14:03 INFO     evaluating now!
2024-05-02 12:14:03 INFO     Epoch [45/200] train_loss: 3.6061, val_loss: 4.6832, lr: 0.003000, 5.87s
2024-05-02 12:14:08 INFO     epoch complete!
2024-05-02 12:14:08 INFO     evaluating now!
2024-05-02 12:14:09 INFO     Epoch [46/200] train_loss: 3.5718, val_loss: 4.7311, lr: 0.003000, 5.92s
2024-05-02 12:14:15 INFO     epoch complete!
2024-05-02 12:14:15 INFO     evaluating now!
2024-05-02 12:14:15 INFO     Epoch [47/200] train_loss: 3.5680, val_loss: 4.6847, lr: 0.003000, 6.04s
2024-05-02 12:14:20 INFO     epoch complete!
2024-05-02 12:14:20 INFO     evaluating now!
2024-05-02 12:14:21 INFO     Epoch [48/200] train_loss: 3.5667, val_loss: 4.6597, lr: 0.003000, 5.93s
2024-05-02 12:14:26 INFO     epoch complete!
2024-05-02 12:14:26 INFO     evaluating now!
2024-05-02 12:14:27 INFO     Epoch [49/200] train_loss: 3.5376, val_loss: 4.8138, lr: 0.003000, 5.95s
2024-05-02 12:14:32 INFO     epoch complete!
2024-05-02 12:14:32 INFO     evaluating now!
2024-05-02 12:14:33 INFO     Epoch [50/200] train_loss: 3.5300, val_loss: 4.8122, lr: 0.003000, 5.94s
2024-05-02 12:14:38 INFO     epoch complete!
2024-05-02 12:14:38 INFO     evaluating now!
2024-05-02 12:14:39 INFO     Epoch [51/200] train_loss: 3.5117, val_loss: 4.7927, lr: 0.003000, 5.85s
2024-05-02 12:14:44 INFO     epoch complete!
2024-05-02 12:14:44 INFO     evaluating now!
2024-05-02 12:14:44 INFO     Epoch [52/200] train_loss: 3.4781, val_loss: 4.6676, lr: 0.003000, 5.81s
2024-05-02 12:14:50 INFO     epoch complete!
2024-05-02 12:14:50 INFO     evaluating now!
2024-05-02 12:14:50 INFO     Epoch [53/200] train_loss: 3.4860, val_loss: 4.7616, lr: 0.003000, 5.82s
2024-05-02 12:14:56 INFO     epoch complete!
2024-05-02 12:14:56 INFO     evaluating now!
2024-05-02 12:14:56 INFO     Epoch [54/200] train_loss: 3.4637, val_loss: 4.6933, lr: 0.003000, 6.26s
2024-05-02 12:15:02 INFO     epoch complete!
2024-05-02 12:15:02 INFO     evaluating now!
2024-05-02 12:15:02 INFO     Epoch [55/200] train_loss: 3.4344, val_loss: 4.6950, lr: 0.003000, 5.74s
2024-05-02 12:15:07 INFO     epoch complete!
2024-05-02 12:15:07 INFO     evaluating now!
2024-05-02 12:15:07 INFO     Epoch [56/200] train_loss: 3.4007, val_loss: 4.7129, lr: 0.003000, 5.36s
2024-05-02 12:15:13 INFO     epoch complete!
2024-05-02 12:15:13 INFO     evaluating now!
2024-05-02 12:15:13 INFO     Epoch [57/200] train_loss: 3.4066, val_loss: 4.6670, lr: 0.003000, 5.33s
2024-05-02 12:15:18 INFO     epoch complete!
2024-05-02 12:15:18 INFO     evaluating now!
2024-05-02 12:15:18 INFO     Epoch [58/200] train_loss: 3.3993, val_loss: 4.7008, lr: 0.003000, 5.29s
2024-05-02 12:15:18 WARNING  Early stopping at epoch: 58
2024-05-02 12:15:18 INFO     Trained totally 59 epochs, average train time is 5.254s, average eval time is 0.303s
2024-05-02 12:15:18 INFO     Loaded model at 43
2024-05-02 12:15:18 INFO     Saved model at ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 12:15:18 INFO     Start evaluating ...
2024-05-02 12:15:19 INFO     Note that you select the single mode to evaluate!
2024-05-02 12:15:19 INFO     Evaluate result is saved at ./libcity/cache/15/evaluate_cache/2024_05_02_12_15_19_AGCRN_CHITaxi20190406.csv
2024-05-02 12:15:19 INFO     
         MAE       RMSE
1   2.300504   6.802310
2   2.404485   7.537923
3   2.515851   8.484238
4   2.613612   8.911255
5   2.615750   9.063661
6   2.666241   9.222795
7   2.683776   9.353666
8   2.715207   9.510642
9   2.720597   9.547131
10  2.758067   9.612967
11  2.794767   9.769184
12  2.915164  10.081221
2024-05-02 12:15:20 INFO     ----------------------------------------------------------------------------
2024-05-02 12:15:20 INFO     # 3, Kownledge Graph Embedding: Normal, Experiment ids: 18
2024-05-02 12:15:20 INFO     ----------------------------------------------------------------------------
2024-05-02 12:15:20 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=15
2024-05-02 12:15:20 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 15, 'load_external': True, 'normal_external': True, 'ext_scaler': 'none', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 12:15:20 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 12:15:20 INFO     set_weight_link_or_dist: dist
2024-05-02 12:15:20 INFO     init_weight_inf_or_zero: inf
2024-05-02 12:15:20 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 12:15:20 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 12:15:20 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 12:15:20 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 12:15:20 INFO     Dataset created
2024-05-02 12:15:20 INFO     x shape: (4345, 12, 77, 4), y shape: (4345, 12, 77, 4)
2024-05-02 12:15:20 INFO     train	x: (3042, 12, 77, 4), y: (3042, 12, 77, 4)
2024-05-02 12:15:20 INFO     eval	x: (434, 12, 77, 4), y: (434, 12, 77, 4)
2024-05-02 12:15:20 INFO     test	x: (869, 12, 77, 4), y: (869, 12, 77, 4)
2024-05-02 12:15:20 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 12:15:20 INFO     NoneScaler
2024-05-02 12:15:21 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 12:15:21 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 12:15:21 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 68, 128])	cuda:0	True
2024-05-02 12:15:21 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 12:15:21 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 68, 64])	cuda:0	True
2024-05-02 12:15:21 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 12:15:21 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 12:15:21 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 12:15:21 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 12:15:21 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 12:15:21 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 12:15:21 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 12:15:21 INFO     Total parameter numbers: 758810
2024-05-02 12:15:21 INFO     You select `adam` optimizer.
2024-05-02 12:15:21 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 12:15:21 INFO     Start training ...
2024-05-02 12:15:21 INFO     num_batches:48
2024-05-02 12:15:26 INFO     epoch complete!
2024-05-02 12:15:26 INFO     evaluating now!
2024-05-02 12:15:27 INFO     Epoch [0/200] train_loss: 24.5953, val_loss: 16.9622, lr: 0.003000, 5.92s
2024-05-02 12:15:27 INFO     Saved model at 0
2024-05-02 12:15:27 INFO     Val loss decrease from inf to 16.9622, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 12:15:33 INFO     epoch complete!
2024-05-02 12:15:33 INFO     evaluating now!
2024-05-02 12:15:33 INFO     Epoch [1/200] train_loss: 13.7312, val_loss: 12.4965, lr: 0.003000, 6.02s
2024-05-02 12:15:33 INFO     Saved model at 1
2024-05-02 12:15:33 INFO     Val loss decrease from 16.9622 to 12.4965, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 12:15:38 INFO     epoch complete!
2024-05-02 12:15:38 INFO     evaluating now!
2024-05-02 12:15:39 INFO     Epoch [2/200] train_loss: 10.1420, val_loss: 9.2251, lr: 0.003000, 5.88s
2024-05-02 12:15:39 INFO     Saved model at 2
2024-05-02 12:15:39 INFO     Val loss decrease from 12.4965 to 9.2251, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 12:15:44 INFO     epoch complete!
2024-05-02 12:15:44 INFO     evaluating now!
2024-05-02 12:15:45 INFO     Epoch [3/200] train_loss: 8.1699, val_loss: 7.6098, lr: 0.003000, 5.74s
2024-05-02 12:15:45 INFO     Saved model at 3
2024-05-02 12:15:45 INFO     Val loss decrease from 9.2251 to 7.6098, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 12:15:50 INFO     epoch complete!
2024-05-02 12:15:50 INFO     evaluating now!
2024-05-02 12:15:51 INFO     Epoch [4/200] train_loss: 7.1631, val_loss: 6.9594, lr: 0.003000, 6.02s
2024-05-02 12:15:51 INFO     Saved model at 4
2024-05-02 12:15:51 INFO     Val loss decrease from 7.6098 to 6.9594, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 12:15:56 INFO     epoch complete!
2024-05-02 12:15:56 INFO     evaluating now!
2024-05-02 12:15:57 INFO     Epoch [5/200] train_loss: 6.5922, val_loss: 6.3887, lr: 0.003000, 5.91s
2024-05-02 12:15:57 INFO     Saved model at 5
2024-05-02 12:15:57 INFO     Val loss decrease from 6.9594 to 6.3887, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 12:16:02 INFO     epoch complete!
2024-05-02 12:16:02 INFO     evaluating now!
2024-05-02 12:16:02 INFO     Epoch [6/200] train_loss: 6.0608, val_loss: 6.1476, lr: 0.003000, 5.80s
2024-05-02 12:16:02 INFO     Saved model at 6
2024-05-02 12:16:02 INFO     Val loss decrease from 6.3887 to 6.1476, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 12:16:08 INFO     epoch complete!
2024-05-02 12:16:08 INFO     evaluating now!
2024-05-02 12:16:08 INFO     Epoch [7/200] train_loss: 5.7629, val_loss: 5.9085, lr: 0.003000, 5.75s
2024-05-02 12:16:08 INFO     Saved model at 7
2024-05-02 12:16:08 INFO     Val loss decrease from 6.1476 to 5.9085, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 12:16:14 INFO     epoch complete!
2024-05-02 12:16:14 INFO     evaluating now!
2024-05-02 12:16:14 INFO     Epoch [8/200] train_loss: 5.5694, val_loss: 5.4851, lr: 0.003000, 5.74s
2024-05-02 12:16:14 INFO     Saved model at 8
2024-05-02 12:16:14 INFO     Val loss decrease from 5.9085 to 5.4851, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 12:16:20 INFO     epoch complete!
2024-05-02 12:16:20 INFO     evaluating now!
2024-05-02 12:16:20 INFO     Epoch [9/200] train_loss: 5.3291, val_loss: 5.5646, lr: 0.003000, 5.89s
2024-05-02 12:16:25 INFO     epoch complete!
2024-05-02 12:16:25 INFO     evaluating now!
2024-05-02 12:16:26 INFO     Epoch [10/200] train_loss: 5.1497, val_loss: 5.4202, lr: 0.003000, 5.83s
2024-05-02 12:16:26 INFO     Saved model at 10
2024-05-02 12:16:26 INFO     Val loss decrease from 5.4851 to 5.4202, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 12:16:31 INFO     epoch complete!
2024-05-02 12:16:31 INFO     evaluating now!
2024-05-02 12:16:32 INFO     Epoch [11/200] train_loss: 5.0968, val_loss: 5.3588, lr: 0.003000, 5.84s
2024-05-02 12:16:32 INFO     Saved model at 11
2024-05-02 12:16:32 INFO     Val loss decrease from 5.4202 to 5.3588, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 12:16:37 INFO     epoch complete!
2024-05-02 12:16:37 INFO     evaluating now!
2024-05-02 12:16:38 INFO     Epoch [12/200] train_loss: 4.8955, val_loss: 5.2463, lr: 0.003000, 5.94s
2024-05-02 12:16:38 INFO     Saved model at 12
2024-05-02 12:16:38 INFO     Val loss decrease from 5.3588 to 5.2463, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 12:16:43 INFO     epoch complete!
2024-05-02 12:16:43 INFO     evaluating now!
2024-05-02 12:16:44 INFO     Epoch [13/200] train_loss: 4.9080, val_loss: 5.2502, lr: 0.003000, 5.90s
2024-05-02 12:16:49 INFO     epoch complete!
2024-05-02 12:16:49 INFO     evaluating now!
2024-05-02 12:16:50 INFO     Epoch [14/200] train_loss: 4.7477, val_loss: 4.9953, lr: 0.003000, 6.19s
2024-05-02 12:16:50 INFO     Saved model at 14
2024-05-02 12:16:50 INFO     Val loss decrease from 5.2463 to 4.9953, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-02 12:16:55 INFO     epoch complete!
2024-05-02 12:16:55 INFO     evaluating now!
2024-05-02 12:16:56 INFO     Epoch [15/200] train_loss: 4.6425, val_loss: 4.9533, lr: 0.003000, 5.82s
2024-05-02 12:16:56 INFO     Saved model at 15
2024-05-02 12:16:56 INFO     Val loss decrease from 4.9953 to 4.9533, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-02 12:17:01 INFO     epoch complete!
2024-05-02 12:17:01 INFO     evaluating now!
2024-05-02 12:17:01 INFO     Epoch [16/200] train_loss: 4.5772, val_loss: 4.9849, lr: 0.003000, 5.81s
2024-05-02 12:17:07 INFO     epoch complete!
2024-05-02 12:17:07 INFO     evaluating now!
2024-05-02 12:17:08 INFO     Epoch [17/200] train_loss: 4.5276, val_loss: 5.0150, lr: 0.003000, 6.09s
2024-05-02 12:17:13 INFO     epoch complete!
2024-05-02 12:17:13 INFO     evaluating now!
2024-05-02 12:17:14 INFO     Epoch [18/200] train_loss: 4.5317, val_loss: 5.0262, lr: 0.003000, 5.99s
2024-05-02 12:17:19 INFO     epoch complete!
2024-05-02 12:17:19 INFO     evaluating now!
2024-05-02 12:17:20 INFO     Epoch [19/200] train_loss: 4.4179, val_loss: 4.9444, lr: 0.003000, 5.97s
2024-05-02 12:17:20 INFO     Saved model at 19
2024-05-02 12:17:20 INFO     Val loss decrease from 4.9533 to 4.9444, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-02 12:17:25 INFO     epoch complete!
2024-05-02 12:17:25 INFO     evaluating now!
2024-05-02 12:17:25 INFO     Epoch [20/200] train_loss: 4.3984, val_loss: 5.0130, lr: 0.003000, 5.85s
2024-05-02 12:17:31 INFO     epoch complete!
2024-05-02 12:17:31 INFO     evaluating now!
2024-05-02 12:17:31 INFO     Epoch [21/200] train_loss: 4.3254, val_loss: 4.7403, lr: 0.003000, 5.78s
2024-05-02 12:17:31 INFO     Saved model at 21
2024-05-02 12:17:31 INFO     Val loss decrease from 4.9444 to 4.7403, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-02 12:17:37 INFO     epoch complete!
2024-05-02 12:17:37 INFO     evaluating now!
2024-05-02 12:17:37 INFO     Epoch [22/200] train_loss: 4.2483, val_loss: 4.8973, lr: 0.003000, 5.85s
2024-05-02 12:17:43 INFO     epoch complete!
2024-05-02 12:17:43 INFO     evaluating now!
2024-05-02 12:17:43 INFO     Epoch [23/200] train_loss: 4.2516, val_loss: 4.9123, lr: 0.003000, 5.85s
2024-05-02 12:17:49 INFO     epoch complete!
2024-05-02 12:17:49 INFO     evaluating now!
2024-05-02 12:17:49 INFO     Epoch [24/200] train_loss: 4.2196, val_loss: 4.7868, lr: 0.003000, 5.96s
2024-05-02 12:17:55 INFO     epoch complete!
2024-05-02 12:17:55 INFO     evaluating now!
2024-05-02 12:17:55 INFO     Epoch [25/200] train_loss: 4.1409, val_loss: 4.8133, lr: 0.003000, 5.97s
2024-05-02 12:18:01 INFO     epoch complete!
2024-05-02 12:18:01 INFO     evaluating now!
2024-05-02 12:18:01 INFO     Epoch [26/200] train_loss: 4.1210, val_loss: 4.8635, lr: 0.003000, 5.96s
2024-05-02 12:18:07 INFO     epoch complete!
2024-05-02 12:18:07 INFO     evaluating now!
2024-05-02 12:18:07 INFO     Epoch [27/200] train_loss: 4.1032, val_loss: 4.7607, lr: 0.003000, 6.06s
2024-05-02 12:18:13 INFO     epoch complete!
2024-05-02 12:18:13 INFO     evaluating now!
2024-05-02 12:18:13 INFO     Epoch [28/200] train_loss: 4.0763, val_loss: 4.9518, lr: 0.003000, 6.05s
2024-05-02 12:18:19 INFO     epoch complete!
2024-05-02 12:18:19 INFO     evaluating now!
2024-05-02 12:18:19 INFO     Epoch [29/200] train_loss: 4.0344, val_loss: 4.7468, lr: 0.003000, 5.92s
2024-05-02 12:18:24 INFO     epoch complete!
2024-05-02 12:18:24 INFO     evaluating now!
2024-05-02 12:18:25 INFO     Epoch [30/200] train_loss: 3.9862, val_loss: 4.9023, lr: 0.003000, 5.67s
2024-05-02 12:18:30 INFO     epoch complete!
2024-05-02 12:18:30 INFO     evaluating now!
2024-05-02 12:18:30 INFO     Epoch [31/200] train_loss: 3.9484, val_loss: 4.8567, lr: 0.003000, 5.45s
2024-05-02 12:18:35 INFO     epoch complete!
2024-05-02 12:18:35 INFO     evaluating now!
2024-05-02 12:18:35 INFO     Epoch [32/200] train_loss: 3.9230, val_loss: 4.8076, lr: 0.003000, 5.09s
2024-05-02 12:18:40 INFO     epoch complete!
2024-05-02 12:18:40 INFO     evaluating now!
2024-05-02 12:18:40 INFO     Epoch [33/200] train_loss: 3.8956, val_loss: 4.7065, lr: 0.003000, 5.18s
2024-05-02 12:18:40 INFO     Saved model at 33
2024-05-02 12:18:40 INFO     Val loss decrease from 4.7403 to 4.7065, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-05-02 12:18:45 INFO     epoch complete!
2024-05-02 12:18:45 INFO     evaluating now!
2024-05-02 12:18:46 INFO     Epoch [34/200] train_loss: 3.8773, val_loss: 4.7003, lr: 0.003000, 5.20s
2024-05-02 12:18:46 INFO     Saved model at 34
2024-05-02 12:18:46 INFO     Val loss decrease from 4.7065 to 4.7003, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-05-02 12:18:50 INFO     epoch complete!
2024-05-02 12:18:50 INFO     evaluating now!
2024-05-02 12:18:51 INFO     Epoch [35/200] train_loss: 3.8437, val_loss: 4.7544, lr: 0.003000, 5.22s
2024-05-02 12:18:56 INFO     epoch complete!
2024-05-02 12:18:56 INFO     evaluating now!
2024-05-02 12:18:56 INFO     Epoch [36/200] train_loss: 3.8097, val_loss: 4.7264, lr: 0.003000, 5.26s
2024-05-02 12:19:01 INFO     epoch complete!
2024-05-02 12:19:01 INFO     evaluating now!
2024-05-02 12:19:01 INFO     Epoch [37/200] train_loss: 3.7803, val_loss: 4.6754, lr: 0.003000, 5.28s
2024-05-02 12:19:01 INFO     Saved model at 37
2024-05-02 12:19:01 INFO     Val loss decrease from 4.7003 to 4.6754, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-05-02 12:19:06 INFO     epoch complete!
2024-05-02 12:19:06 INFO     evaluating now!
2024-05-02 12:19:07 INFO     Epoch [38/200] train_loss: 3.7622, val_loss: 4.6940, lr: 0.003000, 5.35s
2024-05-02 12:19:12 INFO     epoch complete!
2024-05-02 12:19:12 INFO     evaluating now!
2024-05-02 12:19:12 INFO     Epoch [39/200] train_loss: 3.7541, val_loss: 4.7233, lr: 0.003000, 5.31s
2024-05-02 12:19:17 INFO     epoch complete!
2024-05-02 12:19:17 INFO     evaluating now!
2024-05-02 12:19:17 INFO     Epoch [40/200] train_loss: 3.7729, val_loss: 4.7303, lr: 0.003000, 5.35s
2024-05-02 12:19:22 INFO     epoch complete!
2024-05-02 12:19:22 INFO     evaluating now!
2024-05-02 12:19:23 INFO     Epoch [41/200] train_loss: 3.7276, val_loss: 4.7784, lr: 0.003000, 5.39s
2024-05-02 12:19:28 INFO     epoch complete!
2024-05-02 12:19:28 INFO     evaluating now!
2024-05-02 12:19:28 INFO     Epoch [42/200] train_loss: 3.6896, val_loss: 4.7090, lr: 0.003000, 5.30s
2024-05-02 12:19:33 INFO     epoch complete!
2024-05-02 12:19:33 INFO     evaluating now!
2024-05-02 12:19:33 INFO     Epoch [43/200] train_loss: 3.6539, val_loss: 4.7100, lr: 0.003000, 5.24s
2024-05-02 12:19:38 INFO     epoch complete!
2024-05-02 12:19:38 INFO     evaluating now!
2024-05-02 12:19:39 INFO     Epoch [44/200] train_loss: 3.6259, val_loss: 4.7993, lr: 0.003000, 5.28s
2024-05-02 12:19:43 INFO     epoch complete!
2024-05-02 12:19:43 INFO     evaluating now!
2024-05-02 12:19:44 INFO     Epoch [45/200] train_loss: 3.6426, val_loss: 4.7280, lr: 0.003000, 5.21s
2024-05-02 12:19:49 INFO     epoch complete!
2024-05-02 12:19:49 INFO     evaluating now!
2024-05-02 12:19:49 INFO     Epoch [46/200] train_loss: 3.6188, val_loss: 4.7239, lr: 0.003000, 5.36s
2024-05-02 12:19:54 INFO     epoch complete!
2024-05-02 12:19:54 INFO     evaluating now!
2024-05-02 12:19:55 INFO     Epoch [47/200] train_loss: 3.6202, val_loss: 4.7852, lr: 0.003000, 5.42s
2024-05-02 12:20:00 INFO     epoch complete!
2024-05-02 12:20:00 INFO     evaluating now!
2024-05-02 12:20:00 INFO     Epoch [48/200] train_loss: 3.5527, val_loss: 4.7463, lr: 0.003000, 5.39s
2024-05-02 12:20:05 INFO     epoch complete!
2024-05-02 12:20:05 INFO     evaluating now!
2024-05-02 12:20:05 INFO     Epoch [49/200] train_loss: 3.5684, val_loss: 4.7588, lr: 0.003000, 5.46s
2024-05-02 12:20:10 INFO     epoch complete!
2024-05-02 12:20:10 INFO     evaluating now!
2024-05-02 12:20:11 INFO     Epoch [50/200] train_loss: 3.5636, val_loss: 4.6536, lr: 0.003000, 5.34s
2024-05-02 12:20:11 INFO     Saved model at 50
2024-05-02 12:20:11 INFO     Val loss decrease from 4.6754 to 4.6536, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch50.tar
2024-05-02 12:20:16 INFO     epoch complete!
2024-05-02 12:20:16 INFO     evaluating now!
2024-05-02 12:20:16 INFO     Epoch [51/200] train_loss: 3.5738, val_loss: 4.7721, lr: 0.003000, 5.45s
2024-05-02 12:20:21 INFO     epoch complete!
2024-05-02 12:20:21 INFO     evaluating now!
2024-05-02 12:20:22 INFO     Epoch [52/200] train_loss: 3.5113, val_loss: 4.6313, lr: 0.003000, 5.43s
2024-05-02 12:20:22 INFO     Saved model at 52
2024-05-02 12:20:22 INFO     Val loss decrease from 4.6536 to 4.6313, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch52.tar
2024-05-02 12:20:27 INFO     epoch complete!
2024-05-02 12:20:27 INFO     evaluating now!
2024-05-02 12:20:27 INFO     Epoch [53/200] train_loss: 3.4937, val_loss: 4.7411, lr: 0.003000, 5.40s
2024-05-02 12:20:33 INFO     epoch complete!
2024-05-02 12:20:33 INFO     evaluating now!
2024-05-02 12:20:33 INFO     Epoch [54/200] train_loss: 3.5130, val_loss: 4.7024, lr: 0.003000, 5.78s
2024-05-02 12:20:38 INFO     epoch complete!
2024-05-02 12:20:38 INFO     evaluating now!
2024-05-02 12:20:38 INFO     Epoch [55/200] train_loss: 3.4752, val_loss: 4.7127, lr: 0.003000, 5.23s
2024-05-02 12:20:43 INFO     epoch complete!
2024-05-02 12:20:43 INFO     evaluating now!
2024-05-02 12:20:44 INFO     Epoch [56/200] train_loss: 3.4817, val_loss: 4.7604, lr: 0.003000, 5.55s
2024-05-02 12:20:49 INFO     epoch complete!
2024-05-02 12:20:49 INFO     evaluating now!
2024-05-02 12:20:49 INFO     Epoch [57/200] train_loss: 3.4707, val_loss: 4.8179, lr: 0.003000, 5.55s
2024-05-02 12:20:54 INFO     epoch complete!
2024-05-02 12:20:54 INFO     evaluating now!
2024-05-02 12:20:54 INFO     Epoch [58/200] train_loss: 3.4734, val_loss: 4.6388, lr: 0.003000, 5.06s
2024-05-02 12:20:59 INFO     epoch complete!
2024-05-02 12:20:59 INFO     evaluating now!
2024-05-02 12:20:59 INFO     Epoch [59/200] train_loss: 3.4362, val_loss: 4.6392, lr: 0.003000, 5.10s
2024-05-02 12:21:04 INFO     epoch complete!
2024-05-02 12:21:04 INFO     evaluating now!
2024-05-02 12:21:04 INFO     Epoch [60/200] train_loss: 3.3757, val_loss: 4.7241, lr: 0.003000, 5.02s
2024-05-02 12:21:09 INFO     epoch complete!
2024-05-02 12:21:09 INFO     evaluating now!
2024-05-02 12:21:09 INFO     Epoch [61/200] train_loss: 3.3762, val_loss: 4.7721, lr: 0.003000, 4.84s
2024-05-02 12:21:14 INFO     epoch complete!
2024-05-02 12:21:14 INFO     evaluating now!
2024-05-02 12:21:14 INFO     Epoch [62/200] train_loss: 3.3954, val_loss: 4.7547, lr: 0.003000, 5.11s
2024-05-02 12:21:20 INFO     epoch complete!
2024-05-02 12:21:20 INFO     evaluating now!
2024-05-02 12:21:20 INFO     Epoch [63/200] train_loss: 3.3924, val_loss: 4.6818, lr: 0.003000, 5.82s
2024-05-02 12:21:25 INFO     epoch complete!
2024-05-02 12:21:25 INFO     evaluating now!
2024-05-02 12:21:26 INFO     Epoch [64/200] train_loss: 3.3743, val_loss: 4.6463, lr: 0.003000, 5.48s
2024-05-02 12:21:31 INFO     epoch complete!
2024-05-02 12:21:31 INFO     evaluating now!
2024-05-02 12:21:31 INFO     Epoch [65/200] train_loss: 3.3590, val_loss: 4.7161, lr: 0.003000, 5.21s
2024-05-02 12:21:36 INFO     epoch complete!
2024-05-02 12:21:36 INFO     evaluating now!
2024-05-02 12:21:37 INFO     Epoch [66/200] train_loss: 3.3496, val_loss: 4.7836, lr: 0.003000, 5.62s
2024-05-02 12:21:41 INFO     epoch complete!
2024-05-02 12:21:41 INFO     evaluating now!
2024-05-02 12:21:42 INFO     Epoch [67/200] train_loss: 3.3926, val_loss: 4.7022, lr: 0.003000, 5.15s
2024-05-02 12:21:42 WARNING  Early stopping at epoch: 67
2024-05-02 12:21:42 INFO     Trained totally 68 epochs, average train time is 5.283s, average eval time is 0.302s
2024-05-02 12:21:42 INFO     Loaded model at 52
2024-05-02 12:21:42 INFO     Saved model at ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 12:21:42 INFO     Start evaluating ...
2024-05-02 12:21:43 INFO     Note that you select the single mode to evaluate!
2024-05-02 12:21:43 INFO     Evaluate result is saved at ./libcity/cache/15/evaluate_cache/2024_05_02_12_21_43_AGCRN_CHITaxi20190406.csv
2024-05-02 12:21:43 INFO     
         MAE       RMSE
1   2.285967   6.790977
2   2.400993   7.410449
3   2.539260   8.352761
4   2.702236   9.034578
5   2.748286   9.547736
6   2.828475   9.852316
7   2.862452   9.986463
8   2.850873   9.946748
9   2.795763   9.807908
10  2.844439   9.807955
11  2.888610   9.944937
12  2.980182  10.291584
2024-05-02 12:21:43 INFO     ----------------------------------------------------------------------------
2024-05-02 12:21:43 INFO     # 4, Kownledge Graph Embedding: Normal, Experiment ids: 19
2024-05-02 12:21:43 INFO     ----------------------------------------------------------------------------
2024-05-02 12:21:43 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=15
2024-05-02 12:21:43 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 15, 'load_external': True, 'normal_external': True, 'ext_scaler': 'none', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 12:21:43 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 12:21:43 INFO     set_weight_link_or_dist: dist
2024-05-02 12:21:43 INFO     init_weight_inf_or_zero: inf
2024-05-02 12:21:43 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 12:21:43 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 12:21:43 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 12:21:43 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 12:21:44 INFO     Dataset created
2024-05-02 12:21:44 INFO     x shape: (4345, 12, 77, 4), y shape: (4345, 12, 77, 4)
2024-05-02 12:21:44 INFO     train	x: (3042, 12, 77, 4), y: (3042, 12, 77, 4)
2024-05-02 12:21:44 INFO     eval	x: (434, 12, 77, 4), y: (434, 12, 77, 4)
2024-05-02 12:21:44 INFO     test	x: (869, 12, 77, 4), y: (869, 12, 77, 4)
2024-05-02 12:21:44 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 12:21:44 INFO     NoneScaler
2024-05-02 12:21:44 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 12:21:44 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 12:21:44 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 68, 128])	cuda:0	True
2024-05-02 12:21:44 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 12:21:44 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 68, 64])	cuda:0	True
2024-05-02 12:21:44 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 12:21:44 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 12:21:44 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 12:21:44 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 12:21:44 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 12:21:44 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 12:21:44 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 12:21:44 INFO     Total parameter numbers: 758810
2024-05-02 12:21:44 INFO     You select `adam` optimizer.
2024-05-02 12:21:44 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 12:21:44 INFO     Start training ...
2024-05-02 12:21:44 INFO     num_batches:48
2024-05-02 12:21:49 INFO     epoch complete!
2024-05-02 12:21:49 INFO     evaluating now!
2024-05-02 12:21:49 INFO     Epoch [0/200] train_loss: 23.9674, val_loss: 16.5958, lr: 0.003000, 5.05s
2024-05-02 12:21:50 INFO     Saved model at 0
2024-05-02 12:21:50 INFO     Val loss decrease from inf to 16.5958, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 12:21:54 INFO     epoch complete!
2024-05-02 12:21:54 INFO     evaluating now!
2024-05-02 12:21:55 INFO     Epoch [1/200] train_loss: 13.0030, val_loss: 11.8983, lr: 0.003000, 5.12s
2024-05-02 12:21:55 INFO     Saved model at 1
2024-05-02 12:21:55 INFO     Val loss decrease from 16.5958 to 11.8983, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 12:22:00 INFO     epoch complete!
2024-05-02 12:22:00 INFO     evaluating now!
2024-05-02 12:22:00 INFO     Epoch [2/200] train_loss: 9.7988, val_loss: 8.9435, lr: 0.003000, 5.15s
2024-05-02 12:22:00 INFO     Saved model at 2
2024-05-02 12:22:00 INFO     Val loss decrease from 11.8983 to 8.9435, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 12:22:05 INFO     epoch complete!
2024-05-02 12:22:05 INFO     evaluating now!
2024-05-02 12:22:05 INFO     Epoch [3/200] train_loss: 7.9194, val_loss: 7.3323, lr: 0.003000, 5.19s
2024-05-02 12:22:05 INFO     Saved model at 3
2024-05-02 12:22:05 INFO     Val loss decrease from 8.9435 to 7.3323, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 12:22:10 INFO     epoch complete!
2024-05-02 12:22:10 INFO     evaluating now!
2024-05-02 12:22:10 INFO     Epoch [4/200] train_loss: 6.9544, val_loss: 6.8043, lr: 0.003000, 5.17s
2024-05-02 12:22:10 INFO     Saved model at 4
2024-05-02 12:22:10 INFO     Val loss decrease from 7.3323 to 6.8043, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 12:22:15 INFO     epoch complete!
2024-05-02 12:22:15 INFO     evaluating now!
2024-05-02 12:22:16 INFO     Epoch [5/200] train_loss: 6.3751, val_loss: 6.2162, lr: 0.003000, 5.25s
2024-05-02 12:22:16 INFO     Saved model at 5
2024-05-02 12:22:16 INFO     Val loss decrease from 6.8043 to 6.2162, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 12:22:20 INFO     epoch complete!
2024-05-02 12:22:20 INFO     evaluating now!
2024-05-02 12:22:21 INFO     Epoch [6/200] train_loss: 5.9022, val_loss: 6.2121, lr: 0.003000, 5.17s
2024-05-02 12:22:21 INFO     Saved model at 6
2024-05-02 12:22:21 INFO     Val loss decrease from 6.2162 to 6.2121, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 12:22:26 INFO     epoch complete!
2024-05-02 12:22:26 INFO     evaluating now!
2024-05-02 12:22:26 INFO     Epoch [7/200] train_loss: 5.6527, val_loss: 5.8111, lr: 0.003000, 5.31s
2024-05-02 12:22:26 INFO     Saved model at 7
2024-05-02 12:22:26 INFO     Val loss decrease from 6.2121 to 5.8111, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 12:22:31 INFO     epoch complete!
2024-05-02 12:22:31 INFO     evaluating now!
2024-05-02 12:22:31 INFO     Epoch [8/200] train_loss: 5.4344, val_loss: 6.0612, lr: 0.003000, 5.16s
2024-05-02 12:22:36 INFO     epoch complete!
2024-05-02 12:22:36 INFO     evaluating now!
2024-05-02 12:22:37 INFO     Epoch [9/200] train_loss: 5.3045, val_loss: 5.4996, lr: 0.003000, 5.27s
2024-05-02 12:22:37 INFO     Saved model at 9
2024-05-02 12:22:37 INFO     Val loss decrease from 5.8111 to 5.4996, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 12:22:42 INFO     epoch complete!
2024-05-02 12:22:42 INFO     evaluating now!
2024-05-02 12:22:42 INFO     Epoch [10/200] train_loss: 5.1542, val_loss: 5.5267, lr: 0.003000, 5.22s
2024-05-02 12:22:47 INFO     epoch complete!
2024-05-02 12:22:47 INFO     evaluating now!
2024-05-02 12:22:47 INFO     Epoch [11/200] train_loss: 4.9999, val_loss: 5.3684, lr: 0.003000, 5.31s
2024-05-02 12:22:47 INFO     Saved model at 11
2024-05-02 12:22:47 INFO     Val loss decrease from 5.4996 to 5.3684, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 12:22:53 INFO     epoch complete!
2024-05-02 12:22:53 INFO     evaluating now!
2024-05-02 12:22:53 INFO     Epoch [12/200] train_loss: 4.8985, val_loss: 5.2660, lr: 0.003000, 5.95s
2024-05-02 12:22:53 INFO     Saved model at 12
2024-05-02 12:22:53 INFO     Val loss decrease from 5.3684 to 5.2660, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 12:22:59 INFO     epoch complete!
2024-05-02 12:22:59 INFO     evaluating now!
2024-05-02 12:22:59 INFO     Epoch [13/200] train_loss: 4.7531, val_loss: 5.0788, lr: 0.003000, 5.58s
2024-05-02 12:22:59 INFO     Saved model at 13
2024-05-02 12:22:59 INFO     Val loss decrease from 5.2660 to 5.0788, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-02 12:23:04 INFO     epoch complete!
2024-05-02 12:23:04 INFO     evaluating now!
2024-05-02 12:23:04 INFO     Epoch [14/200] train_loss: 4.7829, val_loss: 5.1596, lr: 0.003000, 5.42s
2024-05-02 12:23:09 INFO     epoch complete!
2024-05-02 12:23:09 INFO     evaluating now!
2024-05-02 12:23:10 INFO     Epoch [15/200] train_loss: 4.6692, val_loss: 5.0594, lr: 0.003000, 5.41s
2024-05-02 12:23:10 INFO     Saved model at 15
2024-05-02 12:23:10 INFO     Val loss decrease from 5.0788 to 5.0594, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-02 12:23:15 INFO     epoch complete!
2024-05-02 12:23:15 INFO     evaluating now!
2024-05-02 12:23:15 INFO     Epoch [16/200] train_loss: 4.5075, val_loss: 5.1725, lr: 0.003000, 5.32s
2024-05-02 12:23:20 INFO     epoch complete!
2024-05-02 12:23:20 INFO     evaluating now!
2024-05-02 12:23:20 INFO     Epoch [17/200] train_loss: 4.4804, val_loss: 5.0548, lr: 0.003000, 5.36s
2024-05-02 12:23:20 INFO     Saved model at 17
2024-05-02 12:23:20 INFO     Val loss decrease from 5.0594 to 5.0548, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-02 12:23:26 INFO     epoch complete!
2024-05-02 12:23:26 INFO     evaluating now!
2024-05-02 12:23:26 INFO     Epoch [18/200] train_loss: 4.4432, val_loss: 5.0340, lr: 0.003000, 5.46s
2024-05-02 12:23:26 INFO     Saved model at 18
2024-05-02 12:23:26 INFO     Val loss decrease from 5.0548 to 5.0340, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-02 12:23:31 INFO     epoch complete!
2024-05-02 12:23:31 INFO     evaluating now!
2024-05-02 12:23:31 INFO     Epoch [19/200] train_loss: 4.3717, val_loss: 4.9914, lr: 0.003000, 5.24s
2024-05-02 12:23:31 INFO     Saved model at 19
2024-05-02 12:23:31 INFO     Val loss decrease from 5.0340 to 4.9914, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-02 12:23:36 INFO     epoch complete!
2024-05-02 12:23:36 INFO     evaluating now!
2024-05-02 12:23:37 INFO     Epoch [20/200] train_loss: 4.3279, val_loss: 4.8906, lr: 0.003000, 5.43s
2024-05-02 12:23:37 INFO     Saved model at 20
2024-05-02 12:23:37 INFO     Val loss decrease from 4.9914 to 4.8906, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-02 12:23:42 INFO     epoch complete!
2024-05-02 12:23:42 INFO     evaluating now!
2024-05-02 12:23:42 INFO     Epoch [21/200] train_loss: 4.2695, val_loss: 4.9200, lr: 0.003000, 5.15s
2024-05-02 12:23:47 INFO     epoch complete!
2024-05-02 12:23:47 INFO     evaluating now!
2024-05-02 12:23:47 INFO     Epoch [22/200] train_loss: 4.2375, val_loss: 4.7945, lr: 0.003000, 5.21s
2024-05-02 12:23:47 INFO     Saved model at 22
2024-05-02 12:23:47 INFO     Val loss decrease from 4.8906 to 4.7945, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-02 12:23:52 INFO     epoch complete!
2024-05-02 12:23:52 INFO     evaluating now!
2024-05-02 12:23:52 INFO     Epoch [23/200] train_loss: 4.1998, val_loss: 4.9373, lr: 0.003000, 5.16s
2024-05-02 12:23:57 INFO     epoch complete!
2024-05-02 12:23:57 INFO     evaluating now!
2024-05-02 12:23:57 INFO     Epoch [24/200] train_loss: 4.1755, val_loss: 4.9394, lr: 0.003000, 5.22s
2024-05-02 12:24:03 INFO     epoch complete!
2024-05-02 12:24:03 INFO     evaluating now!
2024-05-02 12:24:03 INFO     Epoch [25/200] train_loss: 4.1507, val_loss: 4.9883, lr: 0.003000, 5.33s
2024-05-02 12:24:08 INFO     epoch complete!
2024-05-02 12:24:08 INFO     evaluating now!
2024-05-02 12:24:08 INFO     Epoch [26/200] train_loss: 4.0375, val_loss: 4.8770, lr: 0.003000, 5.23s
2024-05-02 12:24:13 INFO     epoch complete!
2024-05-02 12:24:13 INFO     evaluating now!
2024-05-02 12:24:13 INFO     Epoch [27/200] train_loss: 4.0023, val_loss: 4.8379, lr: 0.003000, 5.27s
2024-05-02 12:24:18 INFO     epoch complete!
2024-05-02 12:24:18 INFO     evaluating now!
2024-05-02 12:24:19 INFO     Epoch [28/200] train_loss: 3.9703, val_loss: 4.7383, lr: 0.003000, 5.40s
2024-05-02 12:24:19 INFO     Saved model at 28
2024-05-02 12:24:19 INFO     Val loss decrease from 4.7945 to 4.7383, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-05-02 12:24:24 INFO     epoch complete!
2024-05-02 12:24:24 INFO     evaluating now!
2024-05-02 12:24:24 INFO     Epoch [29/200] train_loss: 3.9247, val_loss: 4.7949, lr: 0.003000, 5.21s
2024-05-02 12:24:29 INFO     epoch complete!
2024-05-02 12:24:29 INFO     evaluating now!
2024-05-02 12:24:29 INFO     Epoch [30/200] train_loss: 3.8980, val_loss: 4.7657, lr: 0.003000, 5.15s
2024-05-02 12:24:34 INFO     epoch complete!
2024-05-02 12:24:34 INFO     evaluating now!
2024-05-02 12:24:34 INFO     Epoch [31/200] train_loss: 3.8839, val_loss: 4.7634, lr: 0.003000, 5.32s
2024-05-02 12:24:39 INFO     epoch complete!
2024-05-02 12:24:39 INFO     evaluating now!
2024-05-02 12:24:40 INFO     Epoch [32/200] train_loss: 3.8451, val_loss: 4.8074, lr: 0.003000, 5.22s
2024-05-02 12:24:45 INFO     epoch complete!
2024-05-02 12:24:45 INFO     evaluating now!
2024-05-02 12:24:45 INFO     Epoch [33/200] train_loss: 3.8042, val_loss: 4.7946, lr: 0.003000, 5.28s
2024-05-02 12:24:50 INFO     epoch complete!
2024-05-02 12:24:50 INFO     evaluating now!
2024-05-02 12:24:50 INFO     Epoch [34/200] train_loss: 3.7817, val_loss: 4.7746, lr: 0.003000, 5.22s
2024-05-02 12:24:55 INFO     epoch complete!
2024-05-02 12:24:55 INFO     evaluating now!
2024-05-02 12:24:55 INFO     Epoch [35/200] train_loss: 3.7637, val_loss: 4.7210, lr: 0.003000, 5.31s
2024-05-02 12:24:56 INFO     Saved model at 35
2024-05-02 12:24:56 INFO     Val loss decrease from 4.7383 to 4.7210, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-05-02 12:25:01 INFO     epoch complete!
2024-05-02 12:25:01 INFO     evaluating now!
2024-05-02 12:25:01 INFO     Epoch [36/200] train_loss: 3.7431, val_loss: 4.6323, lr: 0.003000, 5.77s
2024-05-02 12:25:01 INFO     Saved model at 36
2024-05-02 12:25:01 INFO     Val loss decrease from 4.7210 to 4.6323, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-05-02 12:25:06 INFO     epoch complete!
2024-05-02 12:25:06 INFO     evaluating now!
2024-05-02 12:25:07 INFO     Epoch [37/200] train_loss: 3.7271, val_loss: 4.7333, lr: 0.003000, 5.28s
2024-05-02 12:25:12 INFO     epoch complete!
2024-05-02 12:25:12 INFO     evaluating now!
2024-05-02 12:25:12 INFO     Epoch [38/200] train_loss: 3.7162, val_loss: 4.7585, lr: 0.003000, 5.23s
2024-05-02 12:25:17 INFO     epoch complete!
2024-05-02 12:25:17 INFO     evaluating now!
2024-05-02 12:25:17 INFO     Epoch [39/200] train_loss: 3.6591, val_loss: 4.8053, lr: 0.003000, 5.25s
2024-05-02 12:25:22 INFO     epoch complete!
2024-05-02 12:25:22 INFO     evaluating now!
2024-05-02 12:25:22 INFO     Epoch [40/200] train_loss: 3.6271, val_loss: 4.7101, lr: 0.003000, 5.30s
2024-05-02 12:25:27 INFO     epoch complete!
2024-05-02 12:25:27 INFO     evaluating now!
2024-05-02 12:25:28 INFO     Epoch [41/200] train_loss: 3.6280, val_loss: 4.8580, lr: 0.003000, 5.30s
2024-05-02 12:25:33 INFO     epoch complete!
2024-05-02 12:25:33 INFO     evaluating now!
2024-05-02 12:25:33 INFO     Epoch [42/200] train_loss: 3.6442, val_loss: 4.6678, lr: 0.003000, 5.20s
2024-05-02 12:25:38 INFO     epoch complete!
2024-05-02 12:25:38 INFO     evaluating now!
2024-05-02 12:25:38 INFO     Epoch [43/200] train_loss: 3.5813, val_loss: 4.7124, lr: 0.003000, 5.34s
2024-05-02 12:25:43 INFO     epoch complete!
2024-05-02 12:25:43 INFO     evaluating now!
2024-05-02 12:25:43 INFO     Epoch [44/200] train_loss: 3.5807, val_loss: 4.7829, lr: 0.003000, 5.20s
2024-05-02 12:25:48 INFO     epoch complete!
2024-05-02 12:25:48 INFO     evaluating now!
2024-05-02 12:25:49 INFO     Epoch [45/200] train_loss: 3.5509, val_loss: 4.7430, lr: 0.003000, 5.25s
2024-05-02 12:25:54 INFO     epoch complete!
2024-05-02 12:25:54 INFO     evaluating now!
2024-05-02 12:25:54 INFO     Epoch [46/200] train_loss: 3.5206, val_loss: 4.6024, lr: 0.003000, 5.28s
2024-05-02 12:25:54 INFO     Saved model at 46
2024-05-02 12:25:54 INFO     Val loss decrease from 4.6323 to 4.6024, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-05-02 12:25:59 INFO     epoch complete!
2024-05-02 12:25:59 INFO     evaluating now!
2024-05-02 12:25:59 INFO     Epoch [47/200] train_loss: 3.5361, val_loss: 4.8083, lr: 0.003000, 5.35s
2024-05-02 12:26:05 INFO     epoch complete!
2024-05-02 12:26:05 INFO     evaluating now!
2024-05-02 12:26:05 INFO     Epoch [48/200] train_loss: 3.4994, val_loss: 4.6296, lr: 0.003000, 5.52s
2024-05-02 12:26:10 INFO     epoch complete!
2024-05-02 12:26:10 INFO     evaluating now!
2024-05-02 12:26:11 INFO     Epoch [49/200] train_loss: 3.4885, val_loss: 4.7610, lr: 0.003000, 5.65s
2024-05-02 12:26:16 INFO     epoch complete!
2024-05-02 12:26:16 INFO     evaluating now!
2024-05-02 12:26:16 INFO     Epoch [50/200] train_loss: 3.4990, val_loss: 4.6583, lr: 0.003000, 5.43s
2024-05-02 12:26:21 INFO     epoch complete!
2024-05-02 12:26:21 INFO     evaluating now!
2024-05-02 12:26:21 INFO     Epoch [51/200] train_loss: 3.4736, val_loss: 4.6570, lr: 0.003000, 5.33s
2024-05-02 12:26:27 INFO     epoch complete!
2024-05-02 12:26:27 INFO     evaluating now!
2024-05-02 12:26:27 INFO     Epoch [52/200] train_loss: 3.5075, val_loss: 4.6605, lr: 0.003000, 5.56s
2024-05-02 12:26:32 INFO     epoch complete!
2024-05-02 12:26:32 INFO     evaluating now!
2024-05-02 12:26:32 INFO     Epoch [53/200] train_loss: 3.4356, val_loss: 4.7408, lr: 0.003000, 5.40s
2024-05-02 12:26:37 INFO     epoch complete!
2024-05-02 12:26:37 INFO     evaluating now!
2024-05-02 12:26:38 INFO     Epoch [54/200] train_loss: 3.4195, val_loss: 4.7927, lr: 0.003000, 5.44s
2024-05-02 12:26:43 INFO     epoch complete!
2024-05-02 12:26:43 INFO     evaluating now!
2024-05-02 12:26:43 INFO     Epoch [55/200] train_loss: 3.4256, val_loss: 4.7759, lr: 0.003000, 5.40s
2024-05-02 12:26:48 INFO     epoch complete!
2024-05-02 12:26:48 INFO     evaluating now!
2024-05-02 12:26:49 INFO     Epoch [56/200] train_loss: 3.4072, val_loss: 4.7213, lr: 0.003000, 5.44s
2024-05-02 12:26:54 INFO     epoch complete!
2024-05-02 12:26:54 INFO     evaluating now!
2024-05-02 12:26:55 INFO     Epoch [57/200] train_loss: 3.4026, val_loss: 4.6371, lr: 0.003000, 6.18s
2024-05-02 12:27:01 INFO     epoch complete!
2024-05-02 12:27:01 INFO     evaluating now!
2024-05-02 12:27:01 INFO     Epoch [58/200] train_loss: 3.3731, val_loss: 4.7443, lr: 0.003000, 6.09s
2024-05-02 12:27:07 INFO     epoch complete!
2024-05-02 12:27:07 INFO     evaluating now!
2024-05-02 12:27:07 INFO     Epoch [59/200] train_loss: 3.3436, val_loss: 4.7009, lr: 0.003000, 6.14s
2024-05-02 12:27:13 INFO     epoch complete!
2024-05-02 12:27:13 INFO     evaluating now!
2024-05-02 12:27:13 INFO     Epoch [60/200] train_loss: 3.3214, val_loss: 4.7518, lr: 0.003000, 6.13s
2024-05-02 12:27:19 INFO     epoch complete!
2024-05-02 12:27:19 INFO     evaluating now!
2024-05-02 12:27:19 INFO     Epoch [61/200] train_loss: 3.3204, val_loss: 4.7639, lr: 0.003000, 6.12s
2024-05-02 12:27:19 WARNING  Early stopping at epoch: 61
2024-05-02 12:27:19 INFO     Trained totally 62 epochs, average train time is 5.087s, average eval time is 0.296s
2024-05-02 12:27:19 INFO     Loaded model at 46
2024-05-02 12:27:19 INFO     Saved model at ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 12:27:19 INFO     Start evaluating ...
2024-05-02 12:27:21 INFO     Note that you select the single mode to evaluate!
2024-05-02 12:27:21 INFO     Evaluate result is saved at ./libcity/cache/15/evaluate_cache/2024_05_02_12_27_21_AGCRN_CHITaxi20190406.csv
2024-05-02 12:27:21 INFO     
         MAE       RMSE
1   2.353245   6.714465
2   2.386522   7.223127
3   2.505424   8.088395
4   2.580854   8.582124
5   2.621310   9.044012
6   2.672032   9.371156
7   2.708796   9.597657
8   2.760261   9.705628
9   2.776051   9.765136
10  2.846179   9.798276
11  2.920588   9.922302
12  3.005068  10.104544
2024-05-02 12:27:21 INFO     ----------------------------------------------------------------------------
2024-05-02 12:27:21 INFO     Kownledge Graph Embedding: Normal, Experiment ids: [15, 16, 17, 18, 19]
2024-05-02 12:27:21 INFO     ----------------------------------------------------------------------------
2024-05-02 12:27:21 INFO     Average: 
         MAE       RMSE
0   2.324121   6.888301
1   2.405317   7.467560
2   2.541084   8.369433
3   2.634786   8.902316
4   2.681384   9.309647
5   2.733699   9.480370
6   2.756037   9.638429
7   2.780969   9.707366
8   2.775846   9.705751
9   2.822704   9.752937
10  2.844233   9.835846
11  2.919330  10.072222 
2024-05-02 12:27:21 INFO     Standard deviation: 
         MAE      RMSE
0   0.056546  0.185278
1   0.057775  0.208349
2   0.073544  0.236543
3   0.060948  0.215287
4   0.064277  0.275783
5   0.061625  0.219240
6   0.064897  0.220169
7   0.055512  0.158422
8   0.031320  0.103002
9   0.038401  0.099296
10  0.052293  0.098647
11  0.065700  0.157791
2024-05-02 12:27:21 INFO     ----------------------------------------------------------------------------
2024-05-02 12:27:21 INFO     12 steps Average: 
        MAE      RMSE
0  2.684959  9.094181
2024-05-02 12:27:21 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.056903  0.181484
