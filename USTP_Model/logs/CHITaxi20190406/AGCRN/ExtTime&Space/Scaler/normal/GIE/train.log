2024-05-02 14:05:41 INFO     Saving logs in: ./logs/CHITaxi20190406/AGCRN/ExtTime&Space/Scaler/normal/GIE
2024-05-02 14:05:41 INFO     ----------------------------------------------------------------------------
2024-05-02 14:05:41 INFO     # 0, Kownledge Graph Embedding: GIE, Experiment ids: 15
2024-05-02 14:05:41 INFO     ----------------------------------------------------------------------------
2024-05-02 14:05:41 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=15
2024-05-02 14:05:41 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 15, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'normal', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 14:05:42 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 14:05:42 INFO     set_weight_link_or_dist: dist
2024-05-02 14:05:42 INFO     init_weight_inf_or_zero: inf
2024-05-02 14:05:42 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 14:05:42 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 14:05:42 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 14:05:42 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 14:05:45 INFO     Dataset created
2024-05-02 14:05:45 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-05-02 14:05:45 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-05-02 14:05:45 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-05-02 14:05:45 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-05-02 14:05:45 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 14:05:46 INFO     NormalScaler max: 1.0
2024-05-02 14:05:51 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 14:05:51 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 14:05:51 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-05-02 14:05:51 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 14:05:51 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-05-02 14:05:51 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 14:05:51 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 14:05:51 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 14:05:51 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 14:05:51 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 14:05:51 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 14:05:51 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 14:05:51 INFO     Total parameter numbers: 904730
2024-05-02 14:05:51 INFO     You select `adam` optimizer.
2024-05-02 14:05:51 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 14:05:51 INFO     Start training ...
2024-05-02 14:05:51 INFO     num_batches:48
2024-05-02 14:05:58 INFO     epoch complete!
2024-05-02 14:05:58 INFO     evaluating now!
2024-05-02 14:05:59 INFO     Epoch [0/200] train_loss: 24.6484, val_loss: 18.2431, lr: 0.003000, 7.31s
2024-05-02 14:05:59 INFO     Saved model at 0
2024-05-02 14:05:59 INFO     Val loss decrease from inf to 18.2431, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 14:06:05 INFO     epoch complete!
2024-05-02 14:06:05 INFO     evaluating now!
2024-05-02 14:06:06 INFO     Epoch [1/200] train_loss: 14.9806, val_loss: 14.4684, lr: 0.003000, 6.88s
2024-05-02 14:06:06 INFO     Saved model at 1
2024-05-02 14:06:06 INFO     Val loss decrease from 18.2431 to 14.4684, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 14:06:12 INFO     epoch complete!
2024-05-02 14:06:12 INFO     evaluating now!
2024-05-02 14:06:13 INFO     Epoch [2/200] train_loss: 11.6958, val_loss: 11.1482, lr: 0.003000, 6.82s
2024-05-02 14:06:13 INFO     Saved model at 2
2024-05-02 14:06:13 INFO     Val loss decrease from 14.4684 to 11.1482, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 14:06:19 INFO     epoch complete!
2024-05-02 14:06:19 INFO     evaluating now!
2024-05-02 14:06:19 INFO     Epoch [3/200] train_loss: 9.2786, val_loss: 8.9759, lr: 0.003000, 6.81s
2024-05-02 14:06:19 INFO     Saved model at 3
2024-05-02 14:06:19 INFO     Val loss decrease from 11.1482 to 8.9759, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 14:06:26 INFO     epoch complete!
2024-05-02 14:06:26 INFO     evaluating now!
2024-05-02 14:06:26 INFO     Epoch [4/200] train_loss: 7.8160, val_loss: 7.6938, lr: 0.003000, 6.81s
2024-05-02 14:06:26 INFO     Saved model at 4
2024-05-02 14:06:26 INFO     Val loss decrease from 8.9759 to 7.6938, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 14:06:33 INFO     epoch complete!
2024-05-02 14:06:33 INFO     evaluating now!
2024-05-02 14:06:33 INFO     Epoch [5/200] train_loss: 7.1523, val_loss: 7.0217, lr: 0.003000, 6.77s
2024-05-02 14:06:33 INFO     Saved model at 5
2024-05-02 14:06:33 INFO     Val loss decrease from 7.6938 to 7.0217, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 14:06:40 INFO     epoch complete!
2024-05-02 14:06:40 INFO     evaluating now!
2024-05-02 14:06:40 INFO     Epoch [6/200] train_loss: 6.4807, val_loss: 6.2957, lr: 0.003000, 7.03s
2024-05-02 14:06:40 INFO     Saved model at 6
2024-05-02 14:06:40 INFO     Val loss decrease from 7.0217 to 6.2957, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 14:06:47 INFO     epoch complete!
2024-05-02 14:06:47 INFO     evaluating now!
2024-05-02 14:06:47 INFO     Epoch [7/200] train_loss: 6.0230, val_loss: 6.1068, lr: 0.003000, 7.02s
2024-05-02 14:06:47 INFO     Saved model at 7
2024-05-02 14:06:47 INFO     Val loss decrease from 6.2957 to 6.1068, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 14:06:54 INFO     epoch complete!
2024-05-02 14:06:54 INFO     evaluating now!
2024-05-02 14:06:54 INFO     Epoch [8/200] train_loss: 5.7383, val_loss: 6.3086, lr: 0.003000, 6.89s
2024-05-02 14:07:00 INFO     epoch complete!
2024-05-02 14:07:00 INFO     evaluating now!
2024-05-02 14:07:01 INFO     Epoch [9/200] train_loss: 5.5524, val_loss: 5.8283, lr: 0.003000, 6.37s
2024-05-02 14:07:01 INFO     Saved model at 9
2024-05-02 14:07:01 INFO     Val loss decrease from 6.1068 to 5.8283, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 14:07:07 INFO     epoch complete!
2024-05-02 14:07:07 INFO     evaluating now!
2024-05-02 14:07:07 INFO     Epoch [10/200] train_loss: 5.4082, val_loss: 5.6176, lr: 0.003000, 6.67s
2024-05-02 14:07:07 INFO     Saved model at 10
2024-05-02 14:07:07 INFO     Val loss decrease from 5.8283 to 5.6176, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 14:07:13 INFO     epoch complete!
2024-05-02 14:07:13 INFO     evaluating now!
2024-05-02 14:07:14 INFO     Epoch [11/200] train_loss: 5.2251, val_loss: 5.4721, lr: 0.003000, 6.47s
2024-05-02 14:07:14 INFO     Saved model at 11
2024-05-02 14:07:14 INFO     Val loss decrease from 5.6176 to 5.4721, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 14:07:20 INFO     epoch complete!
2024-05-02 14:07:20 INFO     evaluating now!
2024-05-02 14:07:20 INFO     Epoch [12/200] train_loss: 5.1022, val_loss: 5.3741, lr: 0.003000, 6.43s
2024-05-02 14:07:20 INFO     Saved model at 12
2024-05-02 14:07:20 INFO     Val loss decrease from 5.4721 to 5.3741, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 14:07:26 INFO     epoch complete!
2024-05-02 14:07:26 INFO     evaluating now!
2024-05-02 14:07:27 INFO     Epoch [13/200] train_loss: 4.9881, val_loss: 5.2407, lr: 0.003000, 6.44s
2024-05-02 14:07:27 INFO     Saved model at 13
2024-05-02 14:07:27 INFO     Val loss decrease from 5.3741 to 5.2407, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-02 14:07:33 INFO     epoch complete!
2024-05-02 14:07:33 INFO     evaluating now!
2024-05-02 14:07:33 INFO     Epoch [14/200] train_loss: 4.7992, val_loss: 5.1807, lr: 0.003000, 6.31s
2024-05-02 14:07:33 INFO     Saved model at 14
2024-05-02 14:07:33 INFO     Val loss decrease from 5.2407 to 5.1807, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-02 14:07:39 INFO     epoch complete!
2024-05-02 14:07:39 INFO     evaluating now!
2024-05-02 14:07:40 INFO     Epoch [15/200] train_loss: 4.7237, val_loss: 5.0835, lr: 0.003000, 6.45s
2024-05-02 14:07:40 INFO     Saved model at 15
2024-05-02 14:07:40 INFO     Val loss decrease from 5.1807 to 5.0835, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-02 14:07:46 INFO     epoch complete!
2024-05-02 14:07:46 INFO     evaluating now!
2024-05-02 14:07:46 INFO     Epoch [16/200] train_loss: 4.6713, val_loss: 5.0694, lr: 0.003000, 6.49s
2024-05-02 14:07:46 INFO     Saved model at 16
2024-05-02 14:07:46 INFO     Val loss decrease from 5.0835 to 5.0694, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-02 14:07:52 INFO     epoch complete!
2024-05-02 14:07:52 INFO     evaluating now!
2024-05-02 14:07:53 INFO     Epoch [17/200] train_loss: 4.6011, val_loss: 4.9998, lr: 0.003000, 6.44s
2024-05-02 14:07:53 INFO     Saved model at 17
2024-05-02 14:07:53 INFO     Val loss decrease from 5.0694 to 4.9998, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-02 14:07:59 INFO     epoch complete!
2024-05-02 14:07:59 INFO     evaluating now!
2024-05-02 14:07:59 INFO     Epoch [18/200] train_loss: 4.5821, val_loss: 4.9792, lr: 0.003000, 6.47s
2024-05-02 14:07:59 INFO     Saved model at 18
2024-05-02 14:07:59 INFO     Val loss decrease from 4.9998 to 4.9792, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-02 14:08:05 INFO     epoch complete!
2024-05-02 14:08:05 INFO     evaluating now!
2024-05-02 14:08:06 INFO     Epoch [19/200] train_loss: 4.4496, val_loss: 4.8702, lr: 0.003000, 6.47s
2024-05-02 14:08:06 INFO     Saved model at 19
2024-05-02 14:08:06 INFO     Val loss decrease from 4.9792 to 4.8702, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-02 14:08:12 INFO     epoch complete!
2024-05-02 14:08:12 INFO     evaluating now!
2024-05-02 14:08:12 INFO     Epoch [20/200] train_loss: 4.4258, val_loss: 4.8727, lr: 0.003000, 6.50s
2024-05-02 14:08:18 INFO     epoch complete!
2024-05-02 14:08:18 INFO     evaluating now!
2024-05-02 14:08:19 INFO     Epoch [21/200] train_loss: 4.4052, val_loss: 4.9845, lr: 0.003000, 6.55s
2024-05-02 14:08:25 INFO     epoch complete!
2024-05-02 14:08:25 INFO     evaluating now!
2024-05-02 14:08:25 INFO     Epoch [22/200] train_loss: 4.2974, val_loss: 4.8438, lr: 0.003000, 6.43s
2024-05-02 14:08:25 INFO     Saved model at 22
2024-05-02 14:08:25 INFO     Val loss decrease from 4.8702 to 4.8438, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-02 14:08:31 INFO     epoch complete!
2024-05-02 14:08:31 INFO     evaluating now!
2024-05-02 14:08:32 INFO     Epoch [23/200] train_loss: 4.2927, val_loss: 4.9772, lr: 0.003000, 6.58s
2024-05-02 14:08:39 INFO     epoch complete!
2024-05-02 14:08:39 INFO     evaluating now!
2024-05-02 14:08:39 INFO     Epoch [24/200] train_loss: 4.2339, val_loss: 4.8257, lr: 0.003000, 7.67s
2024-05-02 14:08:40 INFO     Saved model at 24
2024-05-02 14:08:40 INFO     Val loss decrease from 4.8438 to 4.8257, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-02 14:08:47 INFO     epoch complete!
2024-05-02 14:08:47 INFO     evaluating now!
2024-05-02 14:08:47 INFO     Epoch [25/200] train_loss: 4.1868, val_loss: 4.9164, lr: 0.003000, 7.64s
2024-05-02 14:08:54 INFO     epoch complete!
2024-05-02 14:08:54 INFO     evaluating now!
2024-05-02 14:08:55 INFO     Epoch [26/200] train_loss: 4.1245, val_loss: 4.7785, lr: 0.003000, 7.72s
2024-05-02 14:08:55 INFO     Saved model at 26
2024-05-02 14:08:55 INFO     Val loss decrease from 4.8257 to 4.7785, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-05-02 14:09:02 INFO     epoch complete!
2024-05-02 14:09:02 INFO     evaluating now!
2024-05-02 14:09:03 INFO     Epoch [27/200] train_loss: 4.0800, val_loss: 4.8830, lr: 0.003000, 7.66s
2024-05-02 14:09:10 INFO     epoch complete!
2024-05-02 14:09:10 INFO     evaluating now!
2024-05-02 14:09:10 INFO     Epoch [28/200] train_loss: 4.0075, val_loss: 4.7786, lr: 0.003000, 7.79s
2024-05-02 14:09:17 INFO     epoch complete!
2024-05-02 14:09:17 INFO     evaluating now!
2024-05-02 14:09:18 INFO     Epoch [29/200] train_loss: 4.0251, val_loss: 4.7653, lr: 0.003000, 7.60s
2024-05-02 14:09:18 INFO     Saved model at 29
2024-05-02 14:09:18 INFO     Val loss decrease from 4.7785 to 4.7653, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-05-02 14:09:25 INFO     epoch complete!
2024-05-02 14:09:25 INFO     evaluating now!
2024-05-02 14:09:26 INFO     Epoch [30/200] train_loss: 3.9660, val_loss: 4.7647, lr: 0.003000, 7.56s
2024-05-02 14:09:26 INFO     Saved model at 30
2024-05-02 14:09:26 INFO     Val loss decrease from 4.7653 to 4.7647, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-05-02 14:09:33 INFO     epoch complete!
2024-05-02 14:09:33 INFO     evaluating now!
2024-05-02 14:09:34 INFO     Epoch [31/200] train_loss: 3.9949, val_loss: 4.9525, lr: 0.003000, 7.95s
2024-05-02 14:09:42 INFO     epoch complete!
2024-05-02 14:09:42 INFO     evaluating now!
2024-05-02 14:09:42 INFO     Epoch [32/200] train_loss: 3.9496, val_loss: 4.8070, lr: 0.003000, 8.34s
2024-05-02 14:09:50 INFO     epoch complete!
2024-05-02 14:09:50 INFO     evaluating now!
2024-05-02 14:09:51 INFO     Epoch [33/200] train_loss: 3.8993, val_loss: 4.8323, lr: 0.003000, 8.38s
2024-05-02 14:09:58 INFO     epoch complete!
2024-05-02 14:09:58 INFO     evaluating now!
2024-05-02 14:09:59 INFO     Epoch [34/200] train_loss: 3.9032, val_loss: 4.9161, lr: 0.003000, 8.16s
2024-05-02 14:10:05 INFO     epoch complete!
2024-05-02 14:10:05 INFO     evaluating now!
2024-05-02 14:10:06 INFO     Epoch [35/200] train_loss: 3.8345, val_loss: 4.7254, lr: 0.003000, 7.24s
2024-05-02 14:10:06 INFO     Saved model at 35
2024-05-02 14:10:06 INFO     Val loss decrease from 4.7647 to 4.7254, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-05-02 14:10:13 INFO     epoch complete!
2024-05-02 14:10:13 INFO     evaluating now!
2024-05-02 14:10:13 INFO     Epoch [36/200] train_loss: 3.8050, val_loss: 4.8843, lr: 0.003000, 7.07s
2024-05-02 14:10:20 INFO     epoch complete!
2024-05-02 14:10:20 INFO     evaluating now!
2024-05-02 14:10:20 INFO     Epoch [37/200] train_loss: 3.8406, val_loss: 4.8600, lr: 0.003000, 7.10s
2024-05-02 14:10:27 INFO     epoch complete!
2024-05-02 14:10:27 INFO     evaluating now!
2024-05-02 14:10:27 INFO     Epoch [38/200] train_loss: 3.7653, val_loss: 4.7529, lr: 0.003000, 7.15s
2024-05-02 14:10:34 INFO     epoch complete!
2024-05-02 14:10:34 INFO     evaluating now!
2024-05-02 14:10:35 INFO     Epoch [39/200] train_loss: 3.7226, val_loss: 4.7115, lr: 0.003000, 7.18s
2024-05-02 14:10:35 INFO     Saved model at 39
2024-05-02 14:10:35 INFO     Val loss decrease from 4.7254 to 4.7115, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch39.tar
2024-05-02 14:10:41 INFO     epoch complete!
2024-05-02 14:10:41 INFO     evaluating now!
2024-05-02 14:10:42 INFO     Epoch [40/200] train_loss: 3.6897, val_loss: 4.7461, lr: 0.003000, 7.32s
2024-05-02 14:10:50 INFO     epoch complete!
2024-05-02 14:10:50 INFO     evaluating now!
2024-05-02 14:10:50 INFO     Epoch [41/200] train_loss: 3.6522, val_loss: 4.7966, lr: 0.003000, 8.17s
2024-05-02 14:10:57 INFO     epoch complete!
2024-05-02 14:10:57 INFO     evaluating now!
2024-05-02 14:10:58 INFO     Epoch [42/200] train_loss: 3.6895, val_loss: 5.0211, lr: 0.003000, 7.82s
2024-05-02 14:11:05 INFO     epoch complete!
2024-05-02 14:11:05 INFO     evaluating now!
2024-05-02 14:11:06 INFO     Epoch [43/200] train_loss: 3.7217, val_loss: 4.7842, lr: 0.003000, 7.66s
2024-05-02 14:11:13 INFO     epoch complete!
2024-05-02 14:11:13 INFO     evaluating now!
2024-05-02 14:11:13 INFO     Epoch [44/200] train_loss: 3.7082, val_loss: 4.7976, lr: 0.003000, 7.62s
2024-05-02 14:11:20 INFO     epoch complete!
2024-05-02 14:11:20 INFO     evaluating now!
2024-05-02 14:11:21 INFO     Epoch [45/200] train_loss: 3.6562, val_loss: 4.5595, lr: 0.003000, 7.79s
2024-05-02 14:11:21 INFO     Saved model at 45
2024-05-02 14:11:21 INFO     Val loss decrease from 4.7115 to 4.5595, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-05-02 14:11:28 INFO     epoch complete!
2024-05-02 14:11:28 INFO     evaluating now!
2024-05-02 14:11:29 INFO     Epoch [46/200] train_loss: 3.5794, val_loss: 4.7187, lr: 0.003000, 7.78s
2024-05-02 14:11:36 INFO     epoch complete!
2024-05-02 14:11:36 INFO     evaluating now!
2024-05-02 14:11:37 INFO     Epoch [47/200] train_loss: 3.5528, val_loss: 4.6699, lr: 0.003000, 7.79s
2024-05-02 14:11:44 INFO     epoch complete!
2024-05-02 14:11:44 INFO     evaluating now!
2024-05-02 14:11:44 INFO     Epoch [48/200] train_loss: 3.5510, val_loss: 4.7145, lr: 0.003000, 7.71s
2024-05-02 14:11:52 INFO     epoch complete!
2024-05-02 14:11:52 INFO     evaluating now!
2024-05-02 14:11:52 INFO     Epoch [49/200] train_loss: 3.6179, val_loss: 4.6356, lr: 0.003000, 7.80s
2024-05-02 14:11:59 INFO     epoch complete!
2024-05-02 14:11:59 INFO     evaluating now!
2024-05-02 14:12:00 INFO     Epoch [50/200] train_loss: 3.5661, val_loss: 4.8462, lr: 0.003000, 7.86s
2024-05-02 14:12:07 INFO     epoch complete!
2024-05-02 14:12:07 INFO     evaluating now!
2024-05-02 14:12:08 INFO     Epoch [51/200] train_loss: 3.5096, val_loss: 4.7455, lr: 0.003000, 7.74s
2024-05-02 14:12:15 INFO     epoch complete!
2024-05-02 14:12:15 INFO     evaluating now!
2024-05-02 14:12:15 INFO     Epoch [52/200] train_loss: 3.4455, val_loss: 4.7021, lr: 0.003000, 7.64s
2024-05-02 14:12:22 INFO     epoch complete!
2024-05-02 14:12:22 INFO     evaluating now!
2024-05-02 14:12:23 INFO     Epoch [53/200] train_loss: 3.4173, val_loss: 4.6512, lr: 0.003000, 7.63s
2024-05-02 14:12:30 INFO     epoch complete!
2024-05-02 14:12:30 INFO     evaluating now!
2024-05-02 14:12:31 INFO     Epoch [54/200] train_loss: 3.4482, val_loss: 4.7536, lr: 0.003000, 7.71s
2024-05-02 14:12:38 INFO     epoch complete!
2024-05-02 14:12:38 INFO     evaluating now!
2024-05-02 14:12:38 INFO     Epoch [55/200] train_loss: 3.4083, val_loss: 4.6559, lr: 0.003000, 7.76s
2024-05-02 14:12:45 INFO     epoch complete!
2024-05-02 14:12:45 INFO     evaluating now!
2024-05-02 14:12:46 INFO     Epoch [56/200] train_loss: 3.4069, val_loss: 4.8214, lr: 0.003000, 7.34s
2024-05-02 14:12:52 INFO     epoch complete!
2024-05-02 14:12:52 INFO     evaluating now!
2024-05-02 14:12:53 INFO     Epoch [57/200] train_loss: 3.4038, val_loss: 4.7750, lr: 0.003000, 6.69s
2024-05-02 14:12:59 INFO     epoch complete!
2024-05-02 14:12:59 INFO     evaluating now!
2024-05-02 14:12:59 INFO     Epoch [58/200] train_loss: 3.3776, val_loss: 4.7434, lr: 0.003000, 6.65s
2024-05-02 14:13:05 INFO     epoch complete!
2024-05-02 14:13:05 INFO     evaluating now!
2024-05-02 14:13:06 INFO     Epoch [59/200] train_loss: 3.3647, val_loss: 4.7244, lr: 0.003000, 6.57s
2024-05-02 14:13:12 INFO     epoch complete!
2024-05-02 14:13:12 INFO     evaluating now!
2024-05-02 14:13:12 INFO     Epoch [60/200] train_loss: 3.3699, val_loss: 4.6107, lr: 0.003000, 6.51s
2024-05-02 14:13:12 WARNING  Early stopping at epoch: 60
2024-05-02 14:13:12 INFO     Trained totally 61 epochs, average train time is 6.683s, average eval time is 0.515s
2024-05-02 14:13:12 INFO     Loaded model at 45
2024-05-02 14:13:12 INFO     Saved model at ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 14:13:12 INFO     Start evaluating ...
2024-05-02 14:13:20 INFO     Note that you select the single mode to evaluate!
2024-05-02 14:13:20 INFO     Evaluate result is saved at ./libcity/cache/15/evaluate_cache/2024_05_02_14_13_20_AGCRN_CHITaxi20190406.csv
2024-05-02 14:13:20 INFO     
         MAE      RMSE
1   2.122271  6.679417
2   2.234107  7.263140
3   2.375732  8.108192
4   2.483306  8.516031
5   2.551115  8.771505
6   2.544832  8.805706
7   2.552960  8.915104
8   2.577741  9.055145
9   2.595584  9.266208
10  2.628850  9.351174
11  2.693460  9.544831
12  2.763054  9.748861
2024-05-02 14:13:20 INFO     ----------------------------------------------------------------------------
2024-05-02 14:13:20 INFO     # 1, Kownledge Graph Embedding: GIE, Experiment ids: 16
2024-05-02 14:13:20 INFO     ----------------------------------------------------------------------------
2024-05-02 14:13:20 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=15
2024-05-02 14:13:20 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 15, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'normal', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 14:13:20 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 14:13:20 INFO     set_weight_link_or_dist: dist
2024-05-02 14:13:20 INFO     init_weight_inf_or_zero: inf
2024-05-02 14:13:20 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 14:13:20 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 14:13:20 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 14:13:20 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 14:13:24 INFO     Dataset created
2024-05-02 14:13:24 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-05-02 14:13:24 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-05-02 14:13:24 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-05-02 14:13:24 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-05-02 14:13:24 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 14:13:24 INFO     NormalScaler max: 1.0
2024-05-02 14:13:28 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 14:13:28 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 14:13:28 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-05-02 14:13:28 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 14:13:28 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-05-02 14:13:28 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 14:13:28 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 14:13:28 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 14:13:28 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 14:13:28 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 14:13:28 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 14:13:28 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 14:13:28 INFO     Total parameter numbers: 904730
2024-05-02 14:13:28 INFO     You select `adam` optimizer.
2024-05-02 14:13:28 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 14:13:28 INFO     Start training ...
2024-05-02 14:13:28 INFO     num_batches:48
2024-05-02 14:13:34 INFO     epoch complete!
2024-05-02 14:13:34 INFO     evaluating now!
2024-05-02 14:13:35 INFO     Epoch [0/200] train_loss: 23.6827, val_loss: 17.5940, lr: 0.003000, 6.70s
2024-05-02 14:13:35 INFO     Saved model at 0
2024-05-02 14:13:35 INFO     Val loss decrease from inf to 17.5940, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 14:13:41 INFO     epoch complete!
2024-05-02 14:13:41 INFO     evaluating now!
2024-05-02 14:13:41 INFO     Epoch [1/200] train_loss: 14.0892, val_loss: 13.1768, lr: 0.003000, 6.67s
2024-05-02 14:13:41 INFO     Saved model at 1
2024-05-02 14:13:41 INFO     Val loss decrease from 17.5940 to 13.1768, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 14:13:48 INFO     epoch complete!
2024-05-02 14:13:48 INFO     evaluating now!
2024-05-02 14:13:48 INFO     Epoch [2/200] train_loss: 10.6453, val_loss: 9.8073, lr: 0.003000, 6.73s
2024-05-02 14:13:48 INFO     Saved model at 2
2024-05-02 14:13:48 INFO     Val loss decrease from 13.1768 to 9.8073, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 14:13:54 INFO     epoch complete!
2024-05-02 14:13:54 INFO     evaluating now!
2024-05-02 14:13:55 INFO     Epoch [3/200] train_loss: 8.5131, val_loss: 7.9360, lr: 0.003000, 6.71s
2024-05-02 14:13:55 INFO     Saved model at 3
2024-05-02 14:13:55 INFO     Val loss decrease from 9.8073 to 7.9360, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 14:14:01 INFO     epoch complete!
2024-05-02 14:14:01 INFO     evaluating now!
2024-05-02 14:14:01 INFO     Epoch [4/200] train_loss: 7.2274, val_loss: 6.9957, lr: 0.003000, 6.59s
2024-05-02 14:14:01 INFO     Saved model at 4
2024-05-02 14:14:01 INFO     Val loss decrease from 7.9360 to 6.9957, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 14:14:08 INFO     epoch complete!
2024-05-02 14:14:08 INFO     evaluating now!
2024-05-02 14:14:08 INFO     Epoch [5/200] train_loss: 6.7189, val_loss: 6.4696, lr: 0.003000, 6.60s
2024-05-02 14:14:08 INFO     Saved model at 5
2024-05-02 14:14:08 INFO     Val loss decrease from 6.9957 to 6.4696, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 14:14:14 INFO     epoch complete!
2024-05-02 14:14:14 INFO     evaluating now!
2024-05-02 14:14:15 INFO     Epoch [6/200] train_loss: 6.1293, val_loss: 6.1091, lr: 0.003000, 6.65s
2024-05-02 14:14:15 INFO     Saved model at 6
2024-05-02 14:14:15 INFO     Val loss decrease from 6.4696 to 6.1091, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 14:14:21 INFO     epoch complete!
2024-05-02 14:14:21 INFO     evaluating now!
2024-05-02 14:14:21 INFO     Epoch [7/200] train_loss: 5.8236, val_loss: 6.1651, lr: 0.003000, 6.57s
2024-05-02 14:14:28 INFO     epoch complete!
2024-05-02 14:14:28 INFO     evaluating now!
2024-05-02 14:14:28 INFO     Epoch [8/200] train_loss: 5.5767, val_loss: 5.7212, lr: 0.003000, 6.66s
2024-05-02 14:14:28 INFO     Saved model at 8
2024-05-02 14:14:28 INFO     Val loss decrease from 6.1091 to 5.7212, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 14:14:34 INFO     epoch complete!
2024-05-02 14:14:34 INFO     evaluating now!
2024-05-02 14:14:35 INFO     Epoch [9/200] train_loss: 5.4125, val_loss: 5.7748, lr: 0.003000, 6.53s
2024-05-02 14:14:41 INFO     epoch complete!
2024-05-02 14:14:41 INFO     evaluating now!
2024-05-02 14:14:41 INFO     Epoch [10/200] train_loss: 5.2506, val_loss: 5.4365, lr: 0.003000, 6.63s
2024-05-02 14:14:41 INFO     Saved model at 10
2024-05-02 14:14:41 INFO     Val loss decrease from 5.7212 to 5.4365, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 14:14:48 INFO     epoch complete!
2024-05-02 14:14:48 INFO     evaluating now!
2024-05-02 14:14:48 INFO     Epoch [11/200] train_loss: 5.0979, val_loss: 5.3563, lr: 0.003000, 6.67s
2024-05-02 14:14:48 INFO     Saved model at 11
2024-05-02 14:14:48 INFO     Val loss decrease from 5.4365 to 5.3563, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 14:14:54 INFO     epoch complete!
2024-05-02 14:14:54 INFO     evaluating now!
2024-05-02 14:14:55 INFO     Epoch [12/200] train_loss: 4.9322, val_loss: 5.2678, lr: 0.003000, 6.50s
2024-05-02 14:14:55 INFO     Saved model at 12
2024-05-02 14:14:55 INFO     Val loss decrease from 5.3563 to 5.2678, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 14:15:01 INFO     epoch complete!
2024-05-02 14:15:01 INFO     evaluating now!
2024-05-02 14:15:01 INFO     Epoch [13/200] train_loss: 4.8621, val_loss: 5.1606, lr: 0.003000, 6.76s
2024-05-02 14:15:01 INFO     Saved model at 13
2024-05-02 14:15:01 INFO     Val loss decrease from 5.2678 to 5.1606, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-02 14:15:08 INFO     epoch complete!
2024-05-02 14:15:08 INFO     evaluating now!
2024-05-02 14:15:08 INFO     Epoch [14/200] train_loss: 4.8170, val_loss: 5.0177, lr: 0.003000, 6.64s
2024-05-02 14:15:08 INFO     Saved model at 14
2024-05-02 14:15:08 INFO     Val loss decrease from 5.1606 to 5.0177, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-02 14:15:14 INFO     epoch complete!
2024-05-02 14:15:14 INFO     evaluating now!
2024-05-02 14:15:15 INFO     Epoch [15/200] train_loss: 4.6243, val_loss: 5.0916, lr: 0.003000, 6.52s
2024-05-02 14:15:21 INFO     epoch complete!
2024-05-02 14:15:21 INFO     evaluating now!
2024-05-02 14:15:21 INFO     Epoch [16/200] train_loss: 4.6251, val_loss: 4.9805, lr: 0.003000, 6.61s
2024-05-02 14:15:21 INFO     Saved model at 16
2024-05-02 14:15:21 INFO     Val loss decrease from 5.0177 to 4.9805, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-02 14:15:28 INFO     epoch complete!
2024-05-02 14:15:28 INFO     evaluating now!
2024-05-02 14:15:28 INFO     Epoch [17/200] train_loss: 4.5542, val_loss: 4.9213, lr: 0.003000, 6.86s
2024-05-02 14:15:28 INFO     Saved model at 17
2024-05-02 14:15:28 INFO     Val loss decrease from 4.9805 to 4.9213, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-02 14:15:34 INFO     epoch complete!
2024-05-02 14:15:34 INFO     evaluating now!
2024-05-02 14:15:34 INFO     Epoch [18/200] train_loss: 4.4452, val_loss: 4.8457, lr: 0.003000, 6.30s
2024-05-02 14:15:34 INFO     Saved model at 18
2024-05-02 14:15:34 INFO     Val loss decrease from 4.9213 to 4.8457, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-02 14:15:40 INFO     epoch complete!
2024-05-02 14:15:40 INFO     evaluating now!
2024-05-02 14:15:41 INFO     Epoch [19/200] train_loss: 4.3694, val_loss: 5.0552, lr: 0.003000, 6.15s
2024-05-02 14:15:46 INFO     epoch complete!
2024-05-02 14:15:46 INFO     evaluating now!
2024-05-02 14:15:47 INFO     Epoch [20/200] train_loss: 4.3264, val_loss: 4.9225, lr: 0.003000, 6.01s
2024-05-02 14:15:52 INFO     epoch complete!
2024-05-02 14:15:52 INFO     evaluating now!
2024-05-02 14:15:53 INFO     Epoch [21/200] train_loss: 4.2992, val_loss: 4.8883, lr: 0.003000, 5.95s
2024-05-02 14:15:58 INFO     epoch complete!
2024-05-02 14:15:58 INFO     evaluating now!
2024-05-02 14:15:59 INFO     Epoch [22/200] train_loss: 4.3251, val_loss: 4.8438, lr: 0.003000, 6.05s
2024-05-02 14:15:59 INFO     Saved model at 22
2024-05-02 14:15:59 INFO     Val loss decrease from 4.8457 to 4.8438, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-02 14:16:04 INFO     epoch complete!
2024-05-02 14:16:04 INFO     evaluating now!
2024-05-02 14:16:05 INFO     Epoch [23/200] train_loss: 4.1628, val_loss: 4.9088, lr: 0.003000, 6.03s
2024-05-02 14:16:11 INFO     epoch complete!
2024-05-02 14:16:11 INFO     evaluating now!
2024-05-02 14:16:11 INFO     Epoch [24/200] train_loss: 4.1312, val_loss: 4.8384, lr: 0.003000, 6.26s
2024-05-02 14:16:11 INFO     Saved model at 24
2024-05-02 14:16:11 INFO     Val loss decrease from 4.8438 to 4.8384, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-02 14:16:18 INFO     epoch complete!
2024-05-02 14:16:18 INFO     evaluating now!
2024-05-02 14:16:19 INFO     Epoch [25/200] train_loss: 4.1368, val_loss: 4.7847, lr: 0.003000, 7.62s
2024-05-02 14:16:19 INFO     Saved model at 25
2024-05-02 14:16:19 INFO     Val loss decrease from 4.8384 to 4.7847, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-02 14:16:25 INFO     epoch complete!
2024-05-02 14:16:25 INFO     evaluating now!
2024-05-02 14:16:25 INFO     Epoch [26/200] train_loss: 4.0519, val_loss: 4.7599, lr: 0.003000, 6.59s
2024-05-02 14:16:25 INFO     Saved model at 26
2024-05-02 14:16:25 INFO     Val loss decrease from 4.7847 to 4.7599, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-05-02 14:16:32 INFO     epoch complete!
2024-05-02 14:16:32 INFO     evaluating now!
2024-05-02 14:16:32 INFO     Epoch [27/200] train_loss: 4.0126, val_loss: 4.9182, lr: 0.003000, 6.59s
2024-05-02 14:16:38 INFO     epoch complete!
2024-05-02 14:16:38 INFO     evaluating now!
2024-05-02 14:16:39 INFO     Epoch [28/200] train_loss: 3.9903, val_loss: 4.8323, lr: 0.003000, 6.70s
2024-05-02 14:16:45 INFO     epoch complete!
2024-05-02 14:16:45 INFO     evaluating now!
2024-05-02 14:16:45 INFO     Epoch [29/200] train_loss: 3.9312, val_loss: 4.6031, lr: 0.003000, 6.63s
2024-05-02 14:16:45 INFO     Saved model at 29
2024-05-02 14:16:45 INFO     Val loss decrease from 4.7599 to 4.6031, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-05-02 14:16:52 INFO     epoch complete!
2024-05-02 14:16:52 INFO     evaluating now!
2024-05-02 14:16:52 INFO     Epoch [30/200] train_loss: 3.8695, val_loss: 4.6700, lr: 0.003000, 6.70s
2024-05-02 14:16:58 INFO     epoch complete!
2024-05-02 14:16:58 INFO     evaluating now!
2024-05-02 14:16:59 INFO     Epoch [31/200] train_loss: 3.8301, val_loss: 4.6744, lr: 0.003000, 6.68s
2024-05-02 14:17:05 INFO     epoch complete!
2024-05-02 14:17:05 INFO     evaluating now!
2024-05-02 14:17:06 INFO     Epoch [32/200] train_loss: 3.8424, val_loss: 4.6888, lr: 0.003000, 6.84s
2024-05-02 14:17:12 INFO     epoch complete!
2024-05-02 14:17:12 INFO     evaluating now!
2024-05-02 14:17:12 INFO     Epoch [33/200] train_loss: 3.8450, val_loss: 4.7581, lr: 0.003000, 6.88s
2024-05-02 14:17:19 INFO     epoch complete!
2024-05-02 14:17:19 INFO     evaluating now!
2024-05-02 14:17:19 INFO     Epoch [34/200] train_loss: 3.8310, val_loss: 4.6102, lr: 0.003000, 6.88s
2024-05-02 14:17:26 INFO     epoch complete!
2024-05-02 14:17:26 INFO     evaluating now!
2024-05-02 14:17:26 INFO     Epoch [35/200] train_loss: 3.7348, val_loss: 4.6175, lr: 0.003000, 6.81s
2024-05-02 14:17:32 INFO     epoch complete!
2024-05-02 14:17:32 INFO     evaluating now!
2024-05-02 14:17:33 INFO     Epoch [36/200] train_loss: 3.7314, val_loss: 4.8584, lr: 0.003000, 6.72s
2024-05-02 14:17:39 INFO     epoch complete!
2024-05-02 14:17:39 INFO     evaluating now!
2024-05-02 14:17:40 INFO     Epoch [37/200] train_loss: 3.7201, val_loss: 4.7143, lr: 0.003000, 6.74s
2024-05-02 14:17:46 INFO     epoch complete!
2024-05-02 14:17:46 INFO     evaluating now!
2024-05-02 14:17:46 INFO     Epoch [38/200] train_loss: 3.6781, val_loss: 4.6656, lr: 0.003000, 6.70s
2024-05-02 14:17:52 INFO     epoch complete!
2024-05-02 14:17:52 INFO     evaluating now!
2024-05-02 14:17:53 INFO     Epoch [39/200] train_loss: 3.6750, val_loss: 4.7917, lr: 0.003000, 6.57s
2024-05-02 14:17:59 INFO     epoch complete!
2024-05-02 14:17:59 INFO     evaluating now!
2024-05-02 14:17:59 INFO     Epoch [40/200] train_loss: 3.6675, val_loss: 4.7175, lr: 0.003000, 6.62s
2024-05-02 14:18:06 INFO     epoch complete!
2024-05-02 14:18:06 INFO     evaluating now!
2024-05-02 14:18:06 INFO     Epoch [41/200] train_loss: 3.5893, val_loss: 4.7498, lr: 0.003000, 6.62s
2024-05-02 14:18:12 INFO     epoch complete!
2024-05-02 14:18:12 INFO     evaluating now!
2024-05-02 14:18:13 INFO     Epoch [42/200] train_loss: 3.5550, val_loss: 4.6742, lr: 0.003000, 6.67s
2024-05-02 14:18:19 INFO     epoch complete!
2024-05-02 14:18:19 INFO     evaluating now!
2024-05-02 14:18:20 INFO     Epoch [43/200] train_loss: 3.5471, val_loss: 4.7375, lr: 0.003000, 6.73s
2024-05-02 14:18:26 INFO     epoch complete!
2024-05-02 14:18:26 INFO     evaluating now!
2024-05-02 14:18:26 INFO     Epoch [44/200] train_loss: 3.5485, val_loss: 4.6634, lr: 0.003000, 6.77s
2024-05-02 14:18:26 WARNING  Early stopping at epoch: 44
2024-05-02 14:18:26 INFO     Trained totally 45 epochs, average train time is 6.153s, average eval time is 0.455s
2024-05-02 14:18:26 INFO     Loaded model at 29
2024-05-02 14:18:26 INFO     Saved model at ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 14:18:26 INFO     Start evaluating ...
2024-05-02 14:18:28 INFO     Note that you select the single mode to evaluate!
2024-05-02 14:18:28 INFO     Evaluate result is saved at ./libcity/cache/15/evaluate_cache/2024_05_02_14_18_28_AGCRN_CHITaxi20190406.csv
2024-05-02 14:18:28 INFO     
         MAE      RMSE
1   2.207299  7.032519
2   2.244536  7.291273
3   2.413813  8.088804
4   2.499553  8.445044
5   2.557731  8.750945
6   2.587132  8.929384
7   2.558433  9.105537
8   2.561818  9.166857
9   2.546120  9.216485
10  2.607130  9.356276
11  2.678968  9.478050
12  2.760111  9.820342
2024-05-02 14:18:28 INFO     ----------------------------------------------------------------------------
2024-05-02 14:18:28 INFO     # 2, Kownledge Graph Embedding: GIE, Experiment ids: 17
2024-05-02 14:18:28 INFO     ----------------------------------------------------------------------------
2024-05-02 14:18:28 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=15
2024-05-02 14:18:28 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 15, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'normal', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 14:18:28 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 14:18:28 INFO     set_weight_link_or_dist: dist
2024-05-02 14:18:28 INFO     init_weight_inf_or_zero: inf
2024-05-02 14:18:28 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 14:18:28 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 14:18:28 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 14:18:28 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 14:18:32 INFO     Dataset created
2024-05-02 14:18:32 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-05-02 14:18:32 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-05-02 14:18:32 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-05-02 14:18:32 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-05-02 14:18:32 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 14:18:32 INFO     NormalScaler max: 1.0
2024-05-02 14:18:36 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 14:18:36 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 14:18:36 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-05-02 14:18:36 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 14:18:36 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-05-02 14:18:36 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 14:18:36 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 14:18:36 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 14:18:36 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 14:18:36 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 14:18:36 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 14:18:36 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 14:18:36 INFO     Total parameter numbers: 904730
2024-05-02 14:18:36 INFO     You select `adam` optimizer.
2024-05-02 14:18:36 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 14:18:36 INFO     Start training ...
2024-05-02 14:18:36 INFO     num_batches:48
2024-05-02 14:18:42 INFO     epoch complete!
2024-05-02 14:18:42 INFO     evaluating now!
2024-05-02 14:18:42 INFO     Epoch [0/200] train_loss: 24.9164, val_loss: 19.2616, lr: 0.003000, 6.46s
2024-05-02 14:18:42 INFO     Saved model at 0
2024-05-02 14:18:42 INFO     Val loss decrease from inf to 19.2616, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 14:18:48 INFO     epoch complete!
2024-05-02 14:18:48 INFO     evaluating now!
2024-05-02 14:18:49 INFO     Epoch [1/200] train_loss: 15.5576, val_loss: 15.0054, lr: 0.003000, 6.51s
2024-05-02 14:18:49 INFO     Saved model at 1
2024-05-02 14:18:49 INFO     Val loss decrease from 19.2616 to 15.0054, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 14:18:55 INFO     epoch complete!
2024-05-02 14:18:55 INFO     evaluating now!
2024-05-02 14:18:56 INFO     Epoch [2/200] train_loss: 12.2971, val_loss: 11.7209, lr: 0.003000, 6.65s
2024-05-02 14:18:56 INFO     Saved model at 2
2024-05-02 14:18:56 INFO     Val loss decrease from 15.0054 to 11.7209, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 14:19:02 INFO     epoch complete!
2024-05-02 14:19:02 INFO     evaluating now!
2024-05-02 14:19:02 INFO     Epoch [3/200] train_loss: 9.8923, val_loss: 9.5554, lr: 0.003000, 6.55s
2024-05-02 14:19:02 INFO     Saved model at 3
2024-05-02 14:19:02 INFO     Val loss decrease from 11.7209 to 9.5554, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 14:19:08 INFO     epoch complete!
2024-05-02 14:19:08 INFO     evaluating now!
2024-05-02 14:19:09 INFO     Epoch [4/200] train_loss: 8.2252, val_loss: 8.0535, lr: 0.003000, 6.62s
2024-05-02 14:19:09 INFO     Saved model at 4
2024-05-02 14:19:09 INFO     Val loss decrease from 9.5554 to 8.0535, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 14:19:15 INFO     epoch complete!
2024-05-02 14:19:15 INFO     evaluating now!
2024-05-02 14:19:16 INFO     Epoch [5/200] train_loss: 7.3209, val_loss: 7.3615, lr: 0.003000, 6.65s
2024-05-02 14:19:16 INFO     Saved model at 5
2024-05-02 14:19:16 INFO     Val loss decrease from 8.0535 to 7.3615, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 14:19:22 INFO     epoch complete!
2024-05-02 14:19:22 INFO     evaluating now!
2024-05-02 14:19:22 INFO     Epoch [6/200] train_loss: 6.6519, val_loss: 6.5751, lr: 0.003000, 6.52s
2024-05-02 14:19:22 INFO     Saved model at 6
2024-05-02 14:19:22 INFO     Val loss decrease from 7.3615 to 6.5751, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 14:19:28 INFO     epoch complete!
2024-05-02 14:19:28 INFO     evaluating now!
2024-05-02 14:19:29 INFO     Epoch [7/200] train_loss: 6.2479, val_loss: 6.3120, lr: 0.003000, 6.71s
2024-05-02 14:19:29 INFO     Saved model at 7
2024-05-02 14:19:29 INFO     Val loss decrease from 6.5751 to 6.3120, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 14:19:35 INFO     epoch complete!
2024-05-02 14:19:35 INFO     evaluating now!
2024-05-02 14:19:35 INFO     Epoch [8/200] train_loss: 6.0784, val_loss: 6.1695, lr: 0.003000, 6.53s
2024-05-02 14:19:35 INFO     Saved model at 8
2024-05-02 14:19:35 INFO     Val loss decrease from 6.3120 to 6.1695, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 14:19:42 INFO     epoch complete!
2024-05-02 14:19:42 INFO     evaluating now!
2024-05-02 14:19:42 INFO     Epoch [9/200] train_loss: 5.8363, val_loss: 5.8382, lr: 0.003000, 6.59s
2024-05-02 14:19:42 INFO     Saved model at 9
2024-05-02 14:19:42 INFO     Val loss decrease from 6.1695 to 5.8382, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 14:19:48 INFO     epoch complete!
2024-05-02 14:19:48 INFO     evaluating now!
2024-05-02 14:19:49 INFO     Epoch [10/200] train_loss: 5.5757, val_loss: 5.5968, lr: 0.003000, 6.64s
2024-05-02 14:19:49 INFO     Saved model at 10
2024-05-02 14:19:49 INFO     Val loss decrease from 5.8382 to 5.5968, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 14:19:55 INFO     epoch complete!
2024-05-02 14:19:55 INFO     evaluating now!
2024-05-02 14:19:56 INFO     Epoch [11/200] train_loss: 5.3029, val_loss: 5.5086, lr: 0.003000, 7.13s
2024-05-02 14:19:56 INFO     Saved model at 11
2024-05-02 14:19:56 INFO     Val loss decrease from 5.5968 to 5.5086, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 14:20:03 INFO     epoch complete!
2024-05-02 14:20:03 INFO     evaluating now!
2024-05-02 14:20:03 INFO     Epoch [12/200] train_loss: 5.3223, val_loss: 5.6544, lr: 0.003000, 7.02s
2024-05-02 14:20:09 INFO     epoch complete!
2024-05-02 14:20:09 INFO     evaluating now!
2024-05-02 14:20:10 INFO     Epoch [13/200] train_loss: 5.1375, val_loss: 5.5528, lr: 0.003000, 6.51s
2024-05-02 14:20:15 INFO     epoch complete!
2024-05-02 14:20:15 INFO     evaluating now!
2024-05-02 14:20:16 INFO     Epoch [14/200] train_loss: 5.0271, val_loss: 5.2441, lr: 0.003000, 6.41s
2024-05-02 14:20:16 INFO     Saved model at 14
2024-05-02 14:20:16 INFO     Val loss decrease from 5.5086 to 5.2441, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-02 14:20:22 INFO     epoch complete!
2024-05-02 14:20:22 INFO     evaluating now!
2024-05-02 14:20:22 INFO     Epoch [15/200] train_loss: 4.8874, val_loss: 5.1826, lr: 0.003000, 6.46s
2024-05-02 14:20:22 INFO     Saved model at 15
2024-05-02 14:20:22 INFO     Val loss decrease from 5.2441 to 5.1826, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-02 14:20:28 INFO     epoch complete!
2024-05-02 14:20:28 INFO     evaluating now!
2024-05-02 14:20:29 INFO     Epoch [16/200] train_loss: 4.8045, val_loss: 5.3723, lr: 0.003000, 6.45s
2024-05-02 14:20:35 INFO     epoch complete!
2024-05-02 14:20:35 INFO     evaluating now!
2024-05-02 14:20:35 INFO     Epoch [17/200] train_loss: 4.7785, val_loss: 5.1200, lr: 0.003000, 6.49s
2024-05-02 14:20:35 INFO     Saved model at 17
2024-05-02 14:20:35 INFO     Val loss decrease from 5.1826 to 5.1200, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-02 14:20:42 INFO     epoch complete!
2024-05-02 14:20:42 INFO     evaluating now!
2024-05-02 14:20:42 INFO     Epoch [18/200] train_loss: 4.6196, val_loss: 4.9817, lr: 0.003000, 6.53s
2024-05-02 14:20:42 INFO     Saved model at 18
2024-05-02 14:20:42 INFO     Val loss decrease from 5.1200 to 4.9817, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-02 14:20:48 INFO     epoch complete!
2024-05-02 14:20:48 INFO     evaluating now!
2024-05-02 14:20:49 INFO     Epoch [19/200] train_loss: 4.6231, val_loss: 5.0939, lr: 0.003000, 6.50s
2024-05-02 14:20:55 INFO     epoch complete!
2024-05-02 14:20:55 INFO     evaluating now!
2024-05-02 14:20:55 INFO     Epoch [20/200] train_loss: 4.5300, val_loss: 5.0380, lr: 0.003000, 6.76s
2024-05-02 14:21:01 INFO     epoch complete!
2024-05-02 14:21:01 INFO     evaluating now!
2024-05-02 14:21:01 INFO     Epoch [21/200] train_loss: 4.4737, val_loss: 5.0349, lr: 0.003000, 6.11s
2024-05-02 14:21:07 INFO     epoch complete!
2024-05-02 14:21:07 INFO     evaluating now!
2024-05-02 14:21:07 INFO     Epoch [22/200] train_loss: 4.4692, val_loss: 4.9409, lr: 0.003000, 5.93s
2024-05-02 14:21:07 INFO     Saved model at 22
2024-05-02 14:21:07 INFO     Val loss decrease from 4.9817 to 4.9409, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-02 14:21:13 INFO     epoch complete!
2024-05-02 14:21:13 INFO     evaluating now!
2024-05-02 14:21:13 INFO     Epoch [23/200] train_loss: 4.3476, val_loss: 4.9578, lr: 0.003000, 6.00s
2024-05-02 14:21:19 INFO     epoch complete!
2024-05-02 14:21:19 INFO     evaluating now!
2024-05-02 14:21:19 INFO     Epoch [24/200] train_loss: 4.3289, val_loss: 4.7574, lr: 0.003000, 5.95s
2024-05-02 14:21:19 INFO     Saved model at 24
2024-05-02 14:21:19 INFO     Val loss decrease from 4.9409 to 4.7574, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-02 14:21:25 INFO     epoch complete!
2024-05-02 14:21:25 INFO     evaluating now!
2024-05-02 14:21:26 INFO     Epoch [25/200] train_loss: 4.2885, val_loss: 4.8594, lr: 0.003000, 6.18s
2024-05-02 14:21:31 INFO     epoch complete!
2024-05-02 14:21:31 INFO     evaluating now!
2024-05-02 14:21:32 INFO     Epoch [26/200] train_loss: 4.2503, val_loss: 4.9250, lr: 0.003000, 6.04s
2024-05-02 14:21:37 INFO     epoch complete!
2024-05-02 14:21:37 INFO     evaluating now!
2024-05-02 14:21:38 INFO     Epoch [27/200] train_loss: 4.1616, val_loss: 4.8985, lr: 0.003000, 6.24s
2024-05-02 14:21:44 INFO     epoch complete!
2024-05-02 14:21:44 INFO     evaluating now!
2024-05-02 14:21:45 INFO     Epoch [28/200] train_loss: 4.1556, val_loss: 4.8028, lr: 0.003000, 7.05s
2024-05-02 14:21:51 INFO     epoch complete!
2024-05-02 14:21:51 INFO     evaluating now!
2024-05-02 14:21:51 INFO     Epoch [29/200] train_loss: 4.0620, val_loss: 4.6991, lr: 0.003000, 6.49s
2024-05-02 14:21:51 INFO     Saved model at 29
2024-05-02 14:21:51 INFO     Val loss decrease from 4.7574 to 4.6991, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-05-02 14:21:58 INFO     epoch complete!
2024-05-02 14:21:58 INFO     evaluating now!
2024-05-02 14:21:58 INFO     Epoch [30/200] train_loss: 4.0527, val_loss: 4.7225, lr: 0.003000, 6.65s
2024-05-02 14:22:04 INFO     epoch complete!
2024-05-02 14:22:04 INFO     evaluating now!
2024-05-02 14:22:05 INFO     Epoch [31/200] train_loss: 4.0794, val_loss: 4.6885, lr: 0.003000, 6.49s
2024-05-02 14:22:05 INFO     Saved model at 31
2024-05-02 14:22:05 INFO     Val loss decrease from 4.6991 to 4.6885, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-05-02 14:22:11 INFO     epoch complete!
2024-05-02 14:22:11 INFO     evaluating now!
2024-05-02 14:22:11 INFO     Epoch [32/200] train_loss: 4.0374, val_loss: 4.7986, lr: 0.003000, 6.38s
2024-05-02 14:22:17 INFO     epoch complete!
2024-05-02 14:22:17 INFO     evaluating now!
2024-05-02 14:22:17 INFO     Epoch [33/200] train_loss: 3.9917, val_loss: 4.7179, lr: 0.003000, 6.35s
2024-05-02 14:22:24 INFO     epoch complete!
2024-05-02 14:22:24 INFO     evaluating now!
2024-05-02 14:22:25 INFO     Epoch [34/200] train_loss: 3.9768, val_loss: 4.6697, lr: 0.003000, 7.34s
2024-05-02 14:22:25 INFO     Saved model at 34
2024-05-02 14:22:25 INFO     Val loss decrease from 4.6885 to 4.6697, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch34.tar
2024-05-02 14:22:32 INFO     epoch complete!
2024-05-02 14:22:32 INFO     evaluating now!
2024-05-02 14:22:32 INFO     Epoch [35/200] train_loss: 3.8803, val_loss: 4.8439, lr: 0.003000, 7.33s
2024-05-02 14:22:39 INFO     epoch complete!
2024-05-02 14:22:39 INFO     evaluating now!
2024-05-02 14:22:39 INFO     Epoch [36/200] train_loss: 3.9396, val_loss: 4.7853, lr: 0.003000, 7.28s
2024-05-02 14:22:46 INFO     epoch complete!
2024-05-02 14:22:46 INFO     evaluating now!
2024-05-02 14:22:46 INFO     Epoch [37/200] train_loss: 3.8416, val_loss: 4.7973, lr: 0.003000, 6.65s
2024-05-02 14:22:52 INFO     epoch complete!
2024-05-02 14:22:52 INFO     evaluating now!
2024-05-02 14:22:53 INFO     Epoch [38/200] train_loss: 3.8092, val_loss: 4.8254, lr: 0.003000, 6.57s
2024-05-02 14:22:59 INFO     epoch complete!
2024-05-02 14:22:59 INFO     evaluating now!
2024-05-02 14:22:59 INFO     Epoch [39/200] train_loss: 3.8129, val_loss: 4.7314, lr: 0.003000, 6.42s
2024-05-02 14:23:05 INFO     epoch complete!
2024-05-02 14:23:05 INFO     evaluating now!
2024-05-02 14:23:06 INFO     Epoch [40/200] train_loss: 3.8255, val_loss: 4.7201, lr: 0.003000, 6.70s
2024-05-02 14:23:12 INFO     epoch complete!
2024-05-02 14:23:12 INFO     evaluating now!
2024-05-02 14:23:12 INFO     Epoch [41/200] train_loss: 3.7153, val_loss: 4.6676, lr: 0.003000, 6.60s
2024-05-02 14:23:12 INFO     Saved model at 41
2024-05-02 14:23:12 INFO     Val loss decrease from 4.6697 to 4.6676, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-05-02 14:23:18 INFO     epoch complete!
2024-05-02 14:23:18 INFO     evaluating now!
2024-05-02 14:23:19 INFO     Epoch [42/200] train_loss: 3.7591, val_loss: 4.8308, lr: 0.003000, 6.56s
2024-05-02 14:23:25 INFO     epoch complete!
2024-05-02 14:23:25 INFO     evaluating now!
2024-05-02 14:23:26 INFO     Epoch [43/200] train_loss: 3.6605, val_loss: 4.7166, lr: 0.003000, 6.68s
2024-05-02 14:23:32 INFO     epoch complete!
2024-05-02 14:23:32 INFO     evaluating now!
2024-05-02 14:23:32 INFO     Epoch [44/200] train_loss: 3.6612, val_loss: 4.6918, lr: 0.003000, 6.58s
2024-05-02 14:23:38 INFO     epoch complete!
2024-05-02 14:23:38 INFO     evaluating now!
2024-05-02 14:23:39 INFO     Epoch [45/200] train_loss: 3.6457, val_loss: 4.6242, lr: 0.003000, 6.67s
2024-05-02 14:23:39 INFO     Saved model at 45
2024-05-02 14:23:39 INFO     Val loss decrease from 4.6676 to 4.6242, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch45.tar
2024-05-02 14:23:45 INFO     epoch complete!
2024-05-02 14:23:45 INFO     evaluating now!
2024-05-02 14:23:45 INFO     Epoch [46/200] train_loss: 3.6136, val_loss: 4.7402, lr: 0.003000, 6.48s
2024-05-02 14:23:51 INFO     epoch complete!
2024-05-02 14:23:51 INFO     evaluating now!
2024-05-02 14:23:52 INFO     Epoch [47/200] train_loss: 3.6371, val_loss: 4.7545, lr: 0.003000, 6.41s
2024-05-02 14:23:58 INFO     epoch complete!
2024-05-02 14:23:58 INFO     evaluating now!
2024-05-02 14:23:58 INFO     Epoch [48/200] train_loss: 3.6364, val_loss: 4.6362, lr: 0.003000, 6.50s
2024-05-02 14:24:04 INFO     epoch complete!
2024-05-02 14:24:04 INFO     evaluating now!
2024-05-02 14:24:05 INFO     Epoch [49/200] train_loss: 3.5726, val_loss: 4.8302, lr: 0.003000, 6.58s
2024-05-02 14:24:11 INFO     epoch complete!
2024-05-02 14:24:11 INFO     evaluating now!
2024-05-02 14:24:11 INFO     Epoch [50/200] train_loss: 3.5162, val_loss: 4.6744, lr: 0.003000, 6.56s
2024-05-02 14:24:18 INFO     epoch complete!
2024-05-02 14:24:18 INFO     evaluating now!
2024-05-02 14:24:18 INFO     Epoch [51/200] train_loss: 3.5402, val_loss: 4.6823, lr: 0.003000, 6.58s
2024-05-02 14:24:24 INFO     epoch complete!
2024-05-02 14:24:24 INFO     evaluating now!
2024-05-02 14:24:25 INFO     Epoch [52/200] train_loss: 3.5224, val_loss: 4.6753, lr: 0.003000, 6.55s
2024-05-02 14:24:31 INFO     epoch complete!
2024-05-02 14:24:31 INFO     evaluating now!
2024-05-02 14:24:31 INFO     Epoch [53/200] train_loss: 3.4545, val_loss: 4.6997, lr: 0.003000, 6.46s
2024-05-02 14:24:37 INFO     epoch complete!
2024-05-02 14:24:37 INFO     evaluating now!
2024-05-02 14:24:37 INFO     Epoch [54/200] train_loss: 3.4555, val_loss: 4.6349, lr: 0.003000, 6.35s
2024-05-02 14:24:44 INFO     epoch complete!
2024-05-02 14:24:44 INFO     evaluating now!
2024-05-02 14:24:44 INFO     Epoch [55/200] train_loss: 3.4280, val_loss: 4.8997, lr: 0.003000, 6.66s
2024-05-02 14:24:50 INFO     epoch complete!
2024-05-02 14:24:50 INFO     evaluating now!
2024-05-02 14:24:51 INFO     Epoch [56/200] train_loss: 3.4696, val_loss: 4.6992, lr: 0.003000, 6.56s
2024-05-02 14:24:57 INFO     epoch complete!
2024-05-02 14:24:57 INFO     evaluating now!
2024-05-02 14:24:57 INFO     Epoch [57/200] train_loss: 3.4127, val_loss: 4.6923, lr: 0.003000, 6.53s
2024-05-02 14:25:03 INFO     epoch complete!
2024-05-02 14:25:03 INFO     evaluating now!
2024-05-02 14:25:04 INFO     Epoch [58/200] train_loss: 3.4193, val_loss: 4.6793, lr: 0.003000, 6.70s
2024-05-02 14:25:10 INFO     epoch complete!
2024-05-02 14:25:10 INFO     evaluating now!
2024-05-02 14:25:10 INFO     Epoch [59/200] train_loss: 3.4214, val_loss: 4.7212, lr: 0.003000, 6.65s
2024-05-02 14:25:17 INFO     epoch complete!
2024-05-02 14:25:17 INFO     evaluating now!
2024-05-02 14:25:17 INFO     Epoch [60/200] train_loss: 3.3819, val_loss: 4.6144, lr: 0.003000, 6.66s
2024-05-02 14:25:17 INFO     Saved model at 60
2024-05-02 14:25:17 INFO     Val loss decrease from 4.6242 to 4.6144, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch60.tar
2024-05-02 14:25:23 INFO     epoch complete!
2024-05-02 14:25:23 INFO     evaluating now!
2024-05-02 14:25:24 INFO     Epoch [61/200] train_loss: 3.3583, val_loss: 4.6053, lr: 0.003000, 6.68s
2024-05-02 14:25:24 INFO     Saved model at 61
2024-05-02 14:25:24 INFO     Val loss decrease from 4.6144 to 4.6053, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch61.tar
2024-05-02 14:25:30 INFO     epoch complete!
2024-05-02 14:25:30 INFO     evaluating now!
2024-05-02 14:25:31 INFO     Epoch [62/200] train_loss: 3.3236, val_loss: 4.6716, lr: 0.003000, 6.69s
2024-05-02 14:25:37 INFO     epoch complete!
2024-05-02 14:25:37 INFO     evaluating now!
2024-05-02 14:25:37 INFO     Epoch [63/200] train_loss: 3.3663, val_loss: 4.6950, lr: 0.003000, 6.75s
2024-05-02 14:25:43 INFO     epoch complete!
2024-05-02 14:25:43 INFO     evaluating now!
2024-05-02 14:25:44 INFO     Epoch [64/200] train_loss: 3.3072, val_loss: 4.7944, lr: 0.003000, 6.55s
2024-05-02 14:25:50 INFO     epoch complete!
2024-05-02 14:25:50 INFO     evaluating now!
2024-05-02 14:25:50 INFO     Epoch [65/200] train_loss: 3.3135, val_loss: 4.7267, lr: 0.003000, 6.53s
2024-05-02 14:25:56 INFO     epoch complete!
2024-05-02 14:25:56 INFO     evaluating now!
2024-05-02 14:25:57 INFO     Epoch [66/200] train_loss: 3.2831, val_loss: 4.6690, lr: 0.003000, 6.40s
2024-05-02 14:26:03 INFO     epoch complete!
2024-05-02 14:26:03 INFO     evaluating now!
2024-05-02 14:26:03 INFO     Epoch [67/200] train_loss: 3.2595, val_loss: 4.6520, lr: 0.003000, 6.58s
2024-05-02 14:26:09 INFO     epoch complete!
2024-05-02 14:26:09 INFO     evaluating now!
2024-05-02 14:26:10 INFO     Epoch [68/200] train_loss: 3.2987, val_loss: 4.8144, lr: 0.003000, 6.35s
2024-05-02 14:26:16 INFO     epoch complete!
2024-05-02 14:26:16 INFO     evaluating now!
2024-05-02 14:26:16 INFO     Epoch [69/200] train_loss: 3.3444, val_loss: 4.6962, lr: 0.003000, 6.44s
2024-05-02 14:26:22 INFO     epoch complete!
2024-05-02 14:26:22 INFO     evaluating now!
2024-05-02 14:26:23 INFO     Epoch [70/200] train_loss: 3.2730, val_loss: 4.6274, lr: 0.003000, 6.52s
2024-05-02 14:26:29 INFO     epoch complete!
2024-05-02 14:26:29 INFO     evaluating now!
2024-05-02 14:26:29 INFO     Epoch [71/200] train_loss: 3.2428, val_loss: 4.6477, lr: 0.003000, 6.41s
2024-05-02 14:26:35 INFO     epoch complete!
2024-05-02 14:26:35 INFO     evaluating now!
2024-05-02 14:26:35 INFO     Epoch [72/200] train_loss: 3.2252, val_loss: 4.6271, lr: 0.003000, 6.03s
2024-05-02 14:26:41 INFO     epoch complete!
2024-05-02 14:26:41 INFO     evaluating now!
2024-05-02 14:26:41 INFO     Epoch [73/200] train_loss: 3.2704, val_loss: 4.7159, lr: 0.003000, 5.92s
2024-05-02 14:26:47 INFO     epoch complete!
2024-05-02 14:26:47 INFO     evaluating now!
2024-05-02 14:26:47 INFO     Epoch [74/200] train_loss: 3.2346, val_loss: 4.6918, lr: 0.003000, 5.96s
2024-05-02 14:26:53 INFO     epoch complete!
2024-05-02 14:26:53 INFO     evaluating now!
2024-05-02 14:26:53 INFO     Epoch [75/200] train_loss: 3.2000, val_loss: 4.6346, lr: 0.003000, 6.14s
2024-05-02 14:26:59 INFO     epoch complete!
2024-05-02 14:26:59 INFO     evaluating now!
2024-05-02 14:27:00 INFO     Epoch [76/200] train_loss: 3.2068, val_loss: 4.7924, lr: 0.003000, 6.41s
2024-05-02 14:27:00 WARNING  Early stopping at epoch: 76
2024-05-02 14:27:00 INFO     Trained totally 77 epochs, average train time is 6.068s, average eval time is 0.456s
2024-05-02 14:27:00 INFO     Loaded model at 61
2024-05-02 14:27:00 INFO     Saved model at ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 14:27:00 INFO     Start evaluating ...
2024-05-02 14:27:01 INFO     Note that you select the single mode to evaluate!
2024-05-02 14:27:01 INFO     Evaluate result is saved at ./libcity/cache/15/evaluate_cache/2024_05_02_14_27_01_AGCRN_CHITaxi20190406.csv
2024-05-02 14:27:01 INFO     
         MAE       RMSE
1   2.248611   6.856056
2   2.290636   7.317843
3   2.394398   7.917523
4   2.519738   8.313657
5   2.587785   8.710553
6   2.582808   8.960632
7   2.679677   9.229209
8   2.702999   9.352234
9   2.736578   9.550467
10  2.756405   9.744845
11  2.788293  10.048488
12  2.859723  10.362849
2024-05-02 14:27:01 INFO     ----------------------------------------------------------------------------
2024-05-02 14:27:01 INFO     # 3, Kownledge Graph Embedding: GIE, Experiment ids: 18
2024-05-02 14:27:01 INFO     ----------------------------------------------------------------------------
2024-05-02 14:27:01 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=15
2024-05-02 14:27:01 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 15, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'normal', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 14:27:01 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 14:27:01 INFO     set_weight_link_or_dist: dist
2024-05-02 14:27:01 INFO     init_weight_inf_or_zero: inf
2024-05-02 14:27:02 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 14:27:02 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 14:27:02 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 14:27:02 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 14:27:05 INFO     Dataset created
2024-05-02 14:27:05 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-05-02 14:27:05 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-05-02 14:27:05 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-05-02 14:27:05 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-05-02 14:27:05 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 14:27:06 INFO     NormalScaler max: 1.0
2024-05-02 14:27:09 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 14:27:09 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 14:27:09 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-05-02 14:27:09 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 14:27:09 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-05-02 14:27:09 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 14:27:09 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 14:27:09 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 14:27:09 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 14:27:09 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 14:27:09 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 14:27:09 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 14:27:09 INFO     Total parameter numbers: 904730
2024-05-02 14:27:09 INFO     You select `adam` optimizer.
2024-05-02 14:27:09 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 14:27:09 INFO     Start training ...
2024-05-02 14:27:09 INFO     num_batches:48
2024-05-02 14:27:16 INFO     epoch complete!
2024-05-02 14:27:16 INFO     evaluating now!
2024-05-02 14:27:16 INFO     Epoch [0/200] train_loss: 25.1899, val_loss: 18.5596, lr: 0.003000, 6.93s
2024-05-02 14:27:16 INFO     Saved model at 0
2024-05-02 14:27:16 INFO     Val loss decrease from inf to 18.5596, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 14:27:22 INFO     epoch complete!
2024-05-02 14:27:22 INFO     evaluating now!
2024-05-02 14:27:23 INFO     Epoch [1/200] train_loss: 15.3262, val_loss: 14.8873, lr: 0.003000, 6.48s
2024-05-02 14:27:23 INFO     Saved model at 1
2024-05-02 14:27:23 INFO     Val loss decrease from 18.5596 to 14.8873, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 14:27:29 INFO     epoch complete!
2024-05-02 14:27:29 INFO     evaluating now!
2024-05-02 14:27:29 INFO     Epoch [2/200] train_loss: 12.1485, val_loss: 11.5057, lr: 0.003000, 6.47s
2024-05-02 14:27:29 INFO     Saved model at 2
2024-05-02 14:27:29 INFO     Val loss decrease from 14.8873 to 11.5057, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 14:27:35 INFO     epoch complete!
2024-05-02 14:27:35 INFO     evaluating now!
2024-05-02 14:27:36 INFO     Epoch [3/200] train_loss: 9.4793, val_loss: 8.9990, lr: 0.003000, 6.43s
2024-05-02 14:27:36 INFO     Saved model at 3
2024-05-02 14:27:36 INFO     Val loss decrease from 11.5057 to 8.9990, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 14:27:42 INFO     epoch complete!
2024-05-02 14:27:42 INFO     evaluating now!
2024-05-02 14:27:42 INFO     Epoch [4/200] train_loss: 8.1076, val_loss: 7.9568, lr: 0.003000, 6.43s
2024-05-02 14:27:42 INFO     Saved model at 4
2024-05-02 14:27:42 INFO     Val loss decrease from 8.9990 to 7.9568, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 14:27:49 INFO     epoch complete!
2024-05-02 14:27:49 INFO     evaluating now!
2024-05-02 14:27:49 INFO     Epoch [5/200] train_loss: 7.1015, val_loss: 6.9807, lr: 0.003000, 6.97s
2024-05-02 14:27:49 INFO     Saved model at 5
2024-05-02 14:27:49 INFO     Val loss decrease from 7.9568 to 6.9807, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 14:27:56 INFO     epoch complete!
2024-05-02 14:27:56 INFO     evaluating now!
2024-05-02 14:27:56 INFO     Epoch [6/200] train_loss: 6.5205, val_loss: 6.5988, lr: 0.003000, 7.03s
2024-05-02 14:27:56 INFO     Saved model at 6
2024-05-02 14:27:56 INFO     Val loss decrease from 6.9807 to 6.5988, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 14:28:03 INFO     epoch complete!
2024-05-02 14:28:03 INFO     evaluating now!
2024-05-02 14:28:03 INFO     Epoch [7/200] train_loss: 6.1481, val_loss: 6.1369, lr: 0.003000, 7.07s
2024-05-02 14:28:03 INFO     Saved model at 7
2024-05-02 14:28:03 INFO     Val loss decrease from 6.5988 to 6.1369, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 14:28:10 INFO     epoch complete!
2024-05-02 14:28:10 INFO     evaluating now!
2024-05-02 14:28:10 INFO     Epoch [8/200] train_loss: 5.8066, val_loss: 6.0294, lr: 0.003000, 6.92s
2024-05-02 14:28:10 INFO     Saved model at 8
2024-05-02 14:28:10 INFO     Val loss decrease from 6.1369 to 6.0294, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 14:28:17 INFO     epoch complete!
2024-05-02 14:28:17 INFO     evaluating now!
2024-05-02 14:28:17 INFO     Epoch [9/200] train_loss: 5.6088, val_loss: 5.7513, lr: 0.003000, 6.73s
2024-05-02 14:28:17 INFO     Saved model at 9
2024-05-02 14:28:17 INFO     Val loss decrease from 6.0294 to 5.7513, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 14:28:23 INFO     epoch complete!
2024-05-02 14:28:23 INFO     evaluating now!
2024-05-02 14:28:24 INFO     Epoch [10/200] train_loss: 5.4779, val_loss: 5.6563, lr: 0.003000, 6.56s
2024-05-02 14:28:24 INFO     Saved model at 10
2024-05-02 14:28:24 INFO     Val loss decrease from 5.7513 to 5.6563, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 14:28:30 INFO     epoch complete!
2024-05-02 14:28:30 INFO     evaluating now!
2024-05-02 14:28:30 INFO     Epoch [11/200] train_loss: 5.3185, val_loss: 5.7480, lr: 0.003000, 6.35s
2024-05-02 14:28:36 INFO     epoch complete!
2024-05-02 14:28:36 INFO     evaluating now!
2024-05-02 14:28:36 INFO     Epoch [12/200] train_loss: 5.1892, val_loss: 5.3815, lr: 0.003000, 6.38s
2024-05-02 14:28:36 INFO     Saved model at 12
2024-05-02 14:28:36 INFO     Val loss decrease from 5.6563 to 5.3815, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 14:28:42 INFO     epoch complete!
2024-05-02 14:28:42 INFO     evaluating now!
2024-05-02 14:28:43 INFO     Epoch [13/200] train_loss: 5.0381, val_loss: 5.5367, lr: 0.003000, 6.32s
2024-05-02 14:28:49 INFO     epoch complete!
2024-05-02 14:28:49 INFO     evaluating now!
2024-05-02 14:28:49 INFO     Epoch [14/200] train_loss: 4.9118, val_loss: 5.1818, lr: 0.003000, 6.31s
2024-05-02 14:28:49 INFO     Saved model at 14
2024-05-02 14:28:49 INFO     Val loss decrease from 5.3815 to 5.1818, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-02 14:28:55 INFO     epoch complete!
2024-05-02 14:28:55 INFO     evaluating now!
2024-05-02 14:28:55 INFO     Epoch [15/200] train_loss: 4.8428, val_loss: 5.1473, lr: 0.003000, 6.34s
2024-05-02 14:28:56 INFO     Saved model at 15
2024-05-02 14:28:56 INFO     Val loss decrease from 5.1818 to 5.1473, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-02 14:29:01 INFO     epoch complete!
2024-05-02 14:29:01 INFO     evaluating now!
2024-05-02 14:29:02 INFO     Epoch [16/200] train_loss: 4.6923, val_loss: 5.1930, lr: 0.003000, 6.38s
2024-05-02 14:29:08 INFO     epoch complete!
2024-05-02 14:29:08 INFO     evaluating now!
2024-05-02 14:29:08 INFO     Epoch [17/200] train_loss: 4.6927, val_loss: 5.2635, lr: 0.003000, 6.38s
2024-05-02 14:29:15 INFO     epoch complete!
2024-05-02 14:29:15 INFO     evaluating now!
2024-05-02 14:29:15 INFO     Epoch [18/200] train_loss: 4.5310, val_loss: 5.0544, lr: 0.003000, 6.82s
2024-05-02 14:29:15 INFO     Saved model at 18
2024-05-02 14:29:15 INFO     Val loss decrease from 5.1473 to 5.0544, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-02 14:29:21 INFO     epoch complete!
2024-05-02 14:29:21 INFO     evaluating now!
2024-05-02 14:29:22 INFO     Epoch [19/200] train_loss: 4.4809, val_loss: 4.9811, lr: 0.003000, 6.44s
2024-05-02 14:29:22 INFO     Saved model at 19
2024-05-02 14:29:22 INFO     Val loss decrease from 5.0544 to 4.9811, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-02 14:29:28 INFO     epoch complete!
2024-05-02 14:29:28 INFO     evaluating now!
2024-05-02 14:29:28 INFO     Epoch [20/200] train_loss: 4.4120, val_loss: 4.9951, lr: 0.003000, 6.41s
2024-05-02 14:29:34 INFO     epoch complete!
2024-05-02 14:29:34 INFO     evaluating now!
2024-05-02 14:29:35 INFO     Epoch [21/200] train_loss: 4.3508, val_loss: 5.0662, lr: 0.003000, 6.58s
2024-05-02 14:29:41 INFO     epoch complete!
2024-05-02 14:29:41 INFO     evaluating now!
2024-05-02 14:29:41 INFO     Epoch [22/200] train_loss: 4.3154, val_loss: 4.9360, lr: 0.003000, 6.66s
2024-05-02 14:29:41 INFO     Saved model at 22
2024-05-02 14:29:41 INFO     Val loss decrease from 4.9811 to 4.9360, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-02 14:29:48 INFO     epoch complete!
2024-05-02 14:29:48 INFO     evaluating now!
2024-05-02 14:29:48 INFO     Epoch [23/200] train_loss: 4.2690, val_loss: 4.9989, lr: 0.003000, 6.75s
2024-05-02 14:29:54 INFO     epoch complete!
2024-05-02 14:29:54 INFO     evaluating now!
2024-05-02 14:29:55 INFO     Epoch [24/200] train_loss: 4.2761, val_loss: 4.9899, lr: 0.003000, 6.56s
2024-05-02 14:30:01 INFO     epoch complete!
2024-05-02 14:30:01 INFO     evaluating now!
2024-05-02 14:30:01 INFO     Epoch [25/200] train_loss: 4.2402, val_loss: 4.8432, lr: 0.003000, 6.78s
2024-05-02 14:30:01 INFO     Saved model at 25
2024-05-02 14:30:01 INFO     Val loss decrease from 4.9360 to 4.8432, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-02 14:30:08 INFO     epoch complete!
2024-05-02 14:30:08 INFO     evaluating now!
2024-05-02 14:30:08 INFO     Epoch [26/200] train_loss: 4.0925, val_loss: 4.7701, lr: 0.003000, 6.74s
2024-05-02 14:30:08 INFO     Saved model at 26
2024-05-02 14:30:08 INFO     Val loss decrease from 4.8432 to 4.7701, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-05-02 14:30:14 INFO     epoch complete!
2024-05-02 14:30:14 INFO     evaluating now!
2024-05-02 14:30:15 INFO     Epoch [27/200] train_loss: 4.1175, val_loss: 4.9721, lr: 0.003000, 6.65s
2024-05-02 14:30:21 INFO     epoch complete!
2024-05-02 14:30:21 INFO     evaluating now!
2024-05-02 14:30:22 INFO     Epoch [28/200] train_loss: 4.0368, val_loss: 4.9051, lr: 0.003000, 6.63s
2024-05-02 14:30:28 INFO     epoch complete!
2024-05-02 14:30:28 INFO     evaluating now!
2024-05-02 14:30:28 INFO     Epoch [29/200] train_loss: 3.9630, val_loss: 4.8405, lr: 0.003000, 6.58s
2024-05-02 14:30:34 INFO     epoch complete!
2024-05-02 14:30:34 INFO     evaluating now!
2024-05-02 14:30:35 INFO     Epoch [30/200] train_loss: 3.9736, val_loss: 4.7663, lr: 0.003000, 6.42s
2024-05-02 14:30:35 INFO     Saved model at 30
2024-05-02 14:30:35 INFO     Val loss decrease from 4.7701 to 4.7663, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-05-02 14:30:41 INFO     epoch complete!
2024-05-02 14:30:41 INFO     evaluating now!
2024-05-02 14:30:41 INFO     Epoch [31/200] train_loss: 3.9950, val_loss: 4.8669, lr: 0.003000, 6.43s
2024-05-02 14:30:47 INFO     epoch complete!
2024-05-02 14:30:47 INFO     evaluating now!
2024-05-02 14:30:47 INFO     Epoch [32/200] train_loss: 3.8994, val_loss: 4.8701, lr: 0.003000, 6.37s
2024-05-02 14:30:53 INFO     epoch complete!
2024-05-02 14:30:53 INFO     evaluating now!
2024-05-02 14:30:54 INFO     Epoch [33/200] train_loss: 3.9046, val_loss: 4.6463, lr: 0.003000, 6.46s
2024-05-02 14:30:54 INFO     Saved model at 33
2024-05-02 14:30:54 INFO     Val loss decrease from 4.7663 to 4.6463, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-05-02 14:31:00 INFO     epoch complete!
2024-05-02 14:31:00 INFO     evaluating now!
2024-05-02 14:31:00 INFO     Epoch [34/200] train_loss: 3.8288, val_loss: 4.8991, lr: 0.003000, 6.49s
2024-05-02 14:31:07 INFO     epoch complete!
2024-05-02 14:31:07 INFO     evaluating now!
2024-05-02 14:31:07 INFO     Epoch [35/200] train_loss: 3.8355, val_loss: 4.7395, lr: 0.003000, 6.95s
2024-05-02 14:31:14 INFO     epoch complete!
2024-05-02 14:31:14 INFO     evaluating now!
2024-05-02 14:31:15 INFO     Epoch [36/200] train_loss: 3.7962, val_loss: 4.7072, lr: 0.003000, 7.31s
2024-05-02 14:31:22 INFO     epoch complete!
2024-05-02 14:31:22 INFO     evaluating now!
2024-05-02 14:31:22 INFO     Epoch [37/200] train_loss: 3.7119, val_loss: 4.7569, lr: 0.003000, 7.47s
2024-05-02 14:31:29 INFO     epoch complete!
2024-05-02 14:31:29 INFO     evaluating now!
2024-05-02 14:31:29 INFO     Epoch [38/200] train_loss: 3.6804, val_loss: 4.7476, lr: 0.003000, 7.10s
2024-05-02 14:31:35 INFO     epoch complete!
2024-05-02 14:31:35 INFO     evaluating now!
2024-05-02 14:31:36 INFO     Epoch [39/200] train_loss: 3.7299, val_loss: 4.6793, lr: 0.003000, 6.68s
2024-05-02 14:31:42 INFO     epoch complete!
2024-05-02 14:31:42 INFO     evaluating now!
2024-05-02 14:31:43 INFO     Epoch [40/200] train_loss: 3.7031, val_loss: 4.7893, lr: 0.003000, 6.85s
2024-05-02 14:31:49 INFO     epoch complete!
2024-05-02 14:31:49 INFO     evaluating now!
2024-05-02 14:31:49 INFO     Epoch [41/200] train_loss: 3.6732, val_loss: 4.7661, lr: 0.003000, 6.74s
2024-05-02 14:31:56 INFO     epoch complete!
2024-05-02 14:31:56 INFO     evaluating now!
2024-05-02 14:31:56 INFO     Epoch [42/200] train_loss: 3.6109, val_loss: 4.7188, lr: 0.003000, 6.86s
2024-05-02 14:32:02 INFO     epoch complete!
2024-05-02 14:32:02 INFO     evaluating now!
2024-05-02 14:32:03 INFO     Epoch [43/200] train_loss: 3.6137, val_loss: 4.6700, lr: 0.003000, 6.21s
2024-05-02 14:32:08 INFO     epoch complete!
2024-05-02 14:32:08 INFO     evaluating now!
2024-05-02 14:32:09 INFO     Epoch [44/200] train_loss: 3.5919, val_loss: 4.7189, lr: 0.003000, 6.00s
2024-05-02 14:32:14 INFO     epoch complete!
2024-05-02 14:32:14 INFO     evaluating now!
2024-05-02 14:32:14 INFO     Epoch [45/200] train_loss: 3.6083, val_loss: 4.6520, lr: 0.003000, 5.91s
2024-05-02 14:32:20 INFO     epoch complete!
2024-05-02 14:32:20 INFO     evaluating now!
2024-05-02 14:32:20 INFO     Epoch [46/200] train_loss: 3.5565, val_loss: 4.6722, lr: 0.003000, 6.03s
2024-05-02 14:32:26 INFO     epoch complete!
2024-05-02 14:32:26 INFO     evaluating now!
2024-05-02 14:32:27 INFO     Epoch [47/200] train_loss: 3.5196, val_loss: 4.6875, lr: 0.003000, 6.30s
2024-05-02 14:32:33 INFO     epoch complete!
2024-05-02 14:32:33 INFO     evaluating now!
2024-05-02 14:32:33 INFO     Epoch [48/200] train_loss: 3.4867, val_loss: 4.7453, lr: 0.003000, 6.56s
2024-05-02 14:32:33 WARNING  Early stopping at epoch: 48
2024-05-02 14:32:33 INFO     Trained totally 49 epochs, average train time is 6.145s, average eval time is 0.451s
2024-05-02 14:32:33 INFO     Loaded model at 33
2024-05-02 14:32:33 INFO     Saved model at ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 14:32:33 INFO     Start evaluating ...
2024-05-02 14:32:35 INFO     Note that you select the single mode to evaluate!
2024-05-02 14:32:35 INFO     Evaluate result is saved at ./libcity/cache/15/evaluate_cache/2024_05_02_14_32_35_AGCRN_CHITaxi20190406.csv
2024-05-02 14:32:35 INFO     
         MAE      RMSE
1   2.445522  7.164180
2   2.520685  7.468990
3   2.630206  8.238447
4   2.739292  8.632247
5   2.757096  8.931762
6   2.767981  9.051346
7   2.829396  9.208154
8   2.826759  9.309216
9   2.849298  9.385084
10  2.868943  9.297301
11  2.851730  9.436828
12  2.883155  9.840598
2024-05-02 14:32:35 INFO     ----------------------------------------------------------------------------
2024-05-02 14:32:35 INFO     # 4, Kownledge Graph Embedding: GIE, Experiment ids: 19
2024-05-02 14:32:35 INFO     ----------------------------------------------------------------------------
2024-05-02 14:32:35 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=15
2024-05-02 14:32:35 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 15, 'load_external': True, 'embedding_model': 'GIE', 'normal_external': True, 'ext_scaler': 'normal', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 14:32:35 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 14:32:35 INFO     set_weight_link_or_dist: dist
2024-05-02 14:32:35 INFO     init_weight_inf_or_zero: inf
2024-05-02 14:32:35 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 14:32:35 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 14:32:35 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 14:32:36 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 14:32:39 INFO     Dataset created
2024-05-02 14:32:39 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-05-02 14:32:39 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-05-02 14:32:39 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-05-02 14:32:39 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-05-02 14:32:39 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 14:32:39 INFO     NormalScaler max: 1.0
2024-05-02 14:32:43 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 14:32:43 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 14:32:43 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-05-02 14:32:43 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 14:32:43 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-05-02 14:32:43 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 14:32:43 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 14:32:43 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 14:32:43 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 14:32:43 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 14:32:43 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 14:32:43 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 14:32:43 INFO     Total parameter numbers: 904730
2024-05-02 14:32:43 INFO     You select `adam` optimizer.
2024-05-02 14:32:43 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 14:32:43 INFO     Start training ...
2024-05-02 14:32:43 INFO     num_batches:48
2024-05-02 14:32:49 INFO     epoch complete!
2024-05-02 14:32:49 INFO     evaluating now!
2024-05-02 14:32:50 INFO     Epoch [0/200] train_loss: 24.3139, val_loss: 17.7391, lr: 0.003000, 6.78s
2024-05-02 14:32:50 INFO     Saved model at 0
2024-05-02 14:32:50 INFO     Val loss decrease from inf to 17.7391, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 14:32:56 INFO     epoch complete!
2024-05-02 14:32:56 INFO     evaluating now!
2024-05-02 14:32:56 INFO     Epoch [1/200] train_loss: 14.1122, val_loss: 13.3989, lr: 0.003000, 6.69s
2024-05-02 14:32:57 INFO     Saved model at 1
2024-05-02 14:32:57 INFO     Val loss decrease from 17.7391 to 13.3989, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 14:33:03 INFO     epoch complete!
2024-05-02 14:33:03 INFO     evaluating now!
2024-05-02 14:33:03 INFO     Epoch [2/200] train_loss: 10.6757, val_loss: 10.1477, lr: 0.003000, 6.54s
2024-05-02 14:33:03 INFO     Saved model at 2
2024-05-02 14:33:03 INFO     Val loss decrease from 13.3989 to 10.1477, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 14:33:09 INFO     epoch complete!
2024-05-02 14:33:09 INFO     evaluating now!
2024-05-02 14:33:10 INFO     Epoch [3/200] train_loss: 8.5088, val_loss: 8.0757, lr: 0.003000, 6.55s
2024-05-02 14:33:10 INFO     Saved model at 3
2024-05-02 14:33:10 INFO     Val loss decrease from 10.1477 to 8.0757, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 14:33:16 INFO     epoch complete!
2024-05-02 14:33:16 INFO     evaluating now!
2024-05-02 14:33:16 INFO     Epoch [4/200] train_loss: 7.3162, val_loss: 7.0988, lr: 0.003000, 6.56s
2024-05-02 14:33:16 INFO     Saved model at 4
2024-05-02 14:33:16 INFO     Val loss decrease from 8.0757 to 7.0988, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 14:33:22 INFO     epoch complete!
2024-05-02 14:33:22 INFO     evaluating now!
2024-05-02 14:33:23 INFO     Epoch [5/200] train_loss: 6.6068, val_loss: 6.3790, lr: 0.003000, 6.56s
2024-05-02 14:33:23 INFO     Saved model at 5
2024-05-02 14:33:23 INFO     Val loss decrease from 7.0988 to 6.3790, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 14:33:29 INFO     epoch complete!
2024-05-02 14:33:29 INFO     evaluating now!
2024-05-02 14:33:29 INFO     Epoch [6/200] train_loss: 6.1557, val_loss: 5.9983, lr: 0.003000, 6.53s
2024-05-02 14:33:29 INFO     Saved model at 6
2024-05-02 14:33:29 INFO     Val loss decrease from 6.3790 to 5.9983, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 14:33:36 INFO     epoch complete!
2024-05-02 14:33:36 INFO     evaluating now!
2024-05-02 14:33:36 INFO     Epoch [7/200] train_loss: 5.7493, val_loss: 5.8671, lr: 0.003000, 6.55s
2024-05-02 14:33:36 INFO     Saved model at 7
2024-05-02 14:33:36 INFO     Val loss decrease from 5.9983 to 5.8671, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 14:33:42 INFO     epoch complete!
2024-05-02 14:33:42 INFO     evaluating now!
2024-05-02 14:33:43 INFO     Epoch [8/200] train_loss: 5.5193, val_loss: 5.5620, lr: 0.003000, 6.53s
2024-05-02 14:33:43 INFO     Saved model at 8
2024-05-02 14:33:43 INFO     Val loss decrease from 5.8671 to 5.5620, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 14:33:49 INFO     epoch complete!
2024-05-02 14:33:49 INFO     evaluating now!
2024-05-02 14:33:49 INFO     Epoch [9/200] train_loss: 5.4673, val_loss: 5.5087, lr: 0.003000, 6.53s
2024-05-02 14:33:49 INFO     Saved model at 9
2024-05-02 14:33:49 INFO     Val loss decrease from 5.5620 to 5.5087, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 14:33:55 INFO     epoch complete!
2024-05-02 14:33:55 INFO     evaluating now!
2024-05-02 14:33:56 INFO     Epoch [10/200] train_loss: 5.1591, val_loss: 5.3432, lr: 0.003000, 6.53s
2024-05-02 14:33:56 INFO     Saved model at 10
2024-05-02 14:33:56 INFO     Val loss decrease from 5.5087 to 5.3432, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 14:34:02 INFO     epoch complete!
2024-05-02 14:34:02 INFO     evaluating now!
2024-05-02 14:34:02 INFO     Epoch [11/200] train_loss: 4.9788, val_loss: 5.2607, lr: 0.003000, 6.60s
2024-05-02 14:34:02 INFO     Saved model at 11
2024-05-02 14:34:02 INFO     Val loss decrease from 5.3432 to 5.2607, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 14:34:08 INFO     epoch complete!
2024-05-02 14:34:08 INFO     evaluating now!
2024-05-02 14:34:09 INFO     Epoch [12/200] train_loss: 4.8900, val_loss: 5.4018, lr: 0.003000, 6.48s
2024-05-02 14:34:15 INFO     epoch complete!
2024-05-02 14:34:15 INFO     evaluating now!
2024-05-02 14:34:16 INFO     Epoch [13/200] train_loss: 4.8128, val_loss: 5.1600, lr: 0.003000, 6.58s
2024-05-02 14:34:16 INFO     Saved model at 13
2024-05-02 14:34:16 INFO     Val loss decrease from 5.2607 to 5.1600, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-02 14:34:22 INFO     epoch complete!
2024-05-02 14:34:22 INFO     evaluating now!
2024-05-02 14:34:22 INFO     Epoch [14/200] train_loss: 4.6995, val_loss: 5.1115, lr: 0.003000, 6.44s
2024-05-02 14:34:22 INFO     Saved model at 14
2024-05-02 14:34:22 INFO     Val loss decrease from 5.1600 to 5.1115, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-02 14:34:28 INFO     epoch complete!
2024-05-02 14:34:28 INFO     evaluating now!
2024-05-02 14:34:29 INFO     Epoch [15/200] train_loss: 4.6705, val_loss: 5.2433, lr: 0.003000, 6.49s
2024-05-02 14:34:35 INFO     epoch complete!
2024-05-02 14:34:35 INFO     evaluating now!
2024-05-02 14:34:35 INFO     Epoch [16/200] train_loss: 4.5910, val_loss: 5.0895, lr: 0.003000, 6.53s
2024-05-02 14:34:35 INFO     Saved model at 16
2024-05-02 14:34:35 INFO     Val loss decrease from 5.1115 to 5.0895, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-02 14:34:41 INFO     epoch complete!
2024-05-02 14:34:41 INFO     evaluating now!
2024-05-02 14:34:42 INFO     Epoch [17/200] train_loss: 4.4890, val_loss: 4.9876, lr: 0.003000, 6.43s
2024-05-02 14:34:42 INFO     Saved model at 17
2024-05-02 14:34:42 INFO     Val loss decrease from 5.0895 to 4.9876, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-02 14:34:48 INFO     epoch complete!
2024-05-02 14:34:48 INFO     evaluating now!
2024-05-02 14:34:48 INFO     Epoch [18/200] train_loss: 4.4331, val_loss: 4.9656, lr: 0.003000, 6.47s
2024-05-02 14:34:48 INFO     Saved model at 18
2024-05-02 14:34:48 INFO     Val loss decrease from 4.9876 to 4.9656, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-02 14:34:55 INFO     epoch complete!
2024-05-02 14:34:55 INFO     evaluating now!
2024-05-02 14:34:55 INFO     Epoch [19/200] train_loss: 4.4045, val_loss: 4.9472, lr: 0.003000, 7.14s
2024-05-02 14:34:55 INFO     Saved model at 19
2024-05-02 14:34:55 INFO     Val loss decrease from 4.9656 to 4.9472, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-02 14:35:02 INFO     epoch complete!
2024-05-02 14:35:02 INFO     evaluating now!
2024-05-02 14:35:02 INFO     Epoch [20/200] train_loss: 4.3048, val_loss: 4.9341, lr: 0.003000, 6.87s
2024-05-02 14:35:02 INFO     Saved model at 20
2024-05-02 14:35:02 INFO     Val loss decrease from 4.9472 to 4.9341, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-02 14:35:09 INFO     epoch complete!
2024-05-02 14:35:09 INFO     evaluating now!
2024-05-02 14:35:09 INFO     Epoch [21/200] train_loss: 4.2980, val_loss: 4.8862, lr: 0.003000, 7.07s
2024-05-02 14:35:09 INFO     Saved model at 21
2024-05-02 14:35:09 INFO     Val loss decrease from 4.9341 to 4.8862, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-02 14:35:16 INFO     epoch complete!
2024-05-02 14:35:16 INFO     evaluating now!
2024-05-02 14:35:16 INFO     Epoch [22/200] train_loss: 4.3072, val_loss: 4.8428, lr: 0.003000, 7.09s
2024-05-02 14:35:16 INFO     Saved model at 22
2024-05-02 14:35:16 INFO     Val loss decrease from 4.8862 to 4.8428, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-02 14:35:23 INFO     epoch complete!
2024-05-02 14:35:23 INFO     evaluating now!
2024-05-02 14:35:24 INFO     Epoch [23/200] train_loss: 4.2785, val_loss: 4.8767, lr: 0.003000, 7.11s
2024-05-02 14:35:30 INFO     epoch complete!
2024-05-02 14:35:30 INFO     evaluating now!
2024-05-02 14:35:31 INFO     Epoch [24/200] train_loss: 4.1459, val_loss: 4.9289, lr: 0.003000, 7.16s
2024-05-02 14:35:37 INFO     epoch complete!
2024-05-02 14:35:37 INFO     evaluating now!
2024-05-02 14:35:38 INFO     Epoch [25/200] train_loss: 4.1118, val_loss: 4.9288, lr: 0.003000, 7.13s
2024-05-02 14:35:45 INFO     epoch complete!
2024-05-02 14:35:45 INFO     evaluating now!
2024-05-02 14:35:45 INFO     Epoch [26/200] train_loss: 4.0240, val_loss: 4.8378, lr: 0.003000, 7.11s
2024-05-02 14:35:45 INFO     Saved model at 26
2024-05-02 14:35:45 INFO     Val loss decrease from 4.8428 to 4.8378, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-05-02 14:35:52 INFO     epoch complete!
2024-05-02 14:35:52 INFO     evaluating now!
2024-05-02 14:35:52 INFO     Epoch [27/200] train_loss: 4.0120, val_loss: 4.9126, lr: 0.003000, 7.09s
2024-05-02 14:35:59 INFO     epoch complete!
2024-05-02 14:35:59 INFO     evaluating now!
2024-05-02 14:35:59 INFO     Epoch [28/200] train_loss: 4.0149, val_loss: 4.9377, lr: 0.003000, 7.08s
2024-05-02 14:36:06 INFO     epoch complete!
2024-05-02 14:36:06 INFO     evaluating now!
2024-05-02 14:36:06 INFO     Epoch [29/200] train_loss: 4.0332, val_loss: 4.8815, lr: 0.003000, 7.20s
2024-05-02 14:36:13 INFO     epoch complete!
2024-05-02 14:36:13 INFO     evaluating now!
2024-05-02 14:36:13 INFO     Epoch [30/200] train_loss: 4.0847, val_loss: 4.8154, lr: 0.003000, 7.02s
2024-05-02 14:36:13 INFO     Saved model at 30
2024-05-02 14:36:13 INFO     Val loss decrease from 4.8378 to 4.8154, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-05-02 14:36:20 INFO     epoch complete!
2024-05-02 14:36:20 INFO     evaluating now!
2024-05-02 14:36:20 INFO     Epoch [31/200] train_loss: 3.8842, val_loss: 4.9328, lr: 0.003000, 6.95s
2024-05-02 14:36:27 INFO     epoch complete!
2024-05-02 14:36:27 INFO     evaluating now!
2024-05-02 14:36:28 INFO     Epoch [32/200] train_loss: 3.8625, val_loss: 4.8012, lr: 0.003000, 7.09s
2024-05-02 14:36:28 INFO     Saved model at 32
2024-05-02 14:36:28 INFO     Val loss decrease from 4.8154 to 4.8012, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-05-02 14:36:34 INFO     epoch complete!
2024-05-02 14:36:34 INFO     evaluating now!
2024-05-02 14:36:35 INFO     Epoch [33/200] train_loss: 3.8892, val_loss: 4.7512, lr: 0.003000, 7.17s
2024-05-02 14:36:35 INFO     Saved model at 33
2024-05-02 14:36:35 INFO     Val loss decrease from 4.8012 to 4.7512, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch33.tar
2024-05-02 14:36:41 INFO     epoch complete!
2024-05-02 14:36:41 INFO     evaluating now!
2024-05-02 14:36:42 INFO     Epoch [34/200] train_loss: 3.8335, val_loss: 4.9859, lr: 0.003000, 7.10s
2024-05-02 14:36:48 INFO     epoch complete!
2024-05-02 14:36:48 INFO     evaluating now!
2024-05-02 14:36:49 INFO     Epoch [35/200] train_loss: 3.8033, val_loss: 4.7372, lr: 0.003000, 7.07s
2024-05-02 14:36:49 INFO     Saved model at 35
2024-05-02 14:36:49 INFO     Val loss decrease from 4.7512 to 4.7372, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch35.tar
2024-05-02 14:36:56 INFO     epoch complete!
2024-05-02 14:36:56 INFO     evaluating now!
2024-05-02 14:36:56 INFO     Epoch [36/200] train_loss: 3.7368, val_loss: 4.6867, lr: 0.003000, 7.01s
2024-05-02 14:36:56 INFO     Saved model at 36
2024-05-02 14:36:56 INFO     Val loss decrease from 4.7372 to 4.6867, saving to ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406_epoch36.tar
2024-05-02 14:37:03 INFO     epoch complete!
2024-05-02 14:37:03 INFO     evaluating now!
2024-05-02 14:37:03 INFO     Epoch [37/200] train_loss: 3.7026, val_loss: 4.7157, lr: 0.003000, 7.18s
2024-05-02 14:37:10 INFO     epoch complete!
2024-05-02 14:37:10 INFO     evaluating now!
2024-05-02 14:37:10 INFO     Epoch [38/200] train_loss: 3.6786, val_loss: 4.8651, lr: 0.003000, 7.07s
2024-05-02 14:37:17 INFO     epoch complete!
2024-05-02 14:37:17 INFO     evaluating now!
2024-05-02 14:37:18 INFO     Epoch [39/200] train_loss: 3.7292, val_loss: 4.7208, lr: 0.003000, 7.42s
2024-05-02 14:37:25 INFO     epoch complete!
2024-05-02 14:37:25 INFO     evaluating now!
2024-05-02 14:37:26 INFO     Epoch [40/200] train_loss: 3.6473, val_loss: 4.7657, lr: 0.003000, 7.96s
2024-05-02 14:37:32 INFO     epoch complete!
2024-05-02 14:37:32 INFO     evaluating now!
2024-05-02 14:37:33 INFO     Epoch [41/200] train_loss: 3.6583, val_loss: 4.7153, lr: 0.003000, 6.90s
2024-05-02 14:37:39 INFO     epoch complete!
2024-05-02 14:37:39 INFO     evaluating now!
2024-05-02 14:37:39 INFO     Epoch [42/200] train_loss: 3.5655, val_loss: 4.7578, lr: 0.003000, 6.64s
2024-05-02 14:37:46 INFO     epoch complete!
2024-05-02 14:37:46 INFO     evaluating now!
2024-05-02 14:37:46 INFO     Epoch [43/200] train_loss: 3.5690, val_loss: 4.7008, lr: 0.003000, 7.02s
2024-05-02 14:37:53 INFO     epoch complete!
2024-05-02 14:37:53 INFO     evaluating now!
2024-05-02 14:37:53 INFO     Epoch [44/200] train_loss: 3.5525, val_loss: 4.6985, lr: 0.003000, 7.06s
2024-05-02 14:37:59 INFO     epoch complete!
2024-05-02 14:37:59 INFO     evaluating now!
2024-05-02 14:38:00 INFO     Epoch [45/200] train_loss: 3.5176, val_loss: 4.7201, lr: 0.003000, 6.40s
2024-05-02 14:38:06 INFO     epoch complete!
2024-05-02 14:38:06 INFO     evaluating now!
2024-05-02 14:38:06 INFO     Epoch [46/200] train_loss: 3.5099, val_loss: 4.7267, lr: 0.003000, 6.50s
2024-05-02 14:38:13 INFO     epoch complete!
2024-05-02 14:38:13 INFO     evaluating now!
2024-05-02 14:38:13 INFO     Epoch [47/200] train_loss: 3.4861, val_loss: 4.7005, lr: 0.003000, 6.79s
2024-05-02 14:38:20 INFO     epoch complete!
2024-05-02 14:38:20 INFO     evaluating now!
2024-05-02 14:38:20 INFO     Epoch [48/200] train_loss: 3.4792, val_loss: 4.8985, lr: 0.003000, 7.30s
2024-05-02 14:38:27 INFO     epoch complete!
2024-05-02 14:38:27 INFO     evaluating now!
2024-05-02 14:38:27 INFO     Epoch [49/200] train_loss: 3.4438, val_loss: 4.7977, lr: 0.003000, 7.18s
2024-05-02 14:38:34 INFO     epoch complete!
2024-05-02 14:38:34 INFO     evaluating now!
2024-05-02 14:38:35 INFO     Epoch [50/200] train_loss: 3.4375, val_loss: 4.7543, lr: 0.003000, 7.16s
2024-05-02 14:38:41 INFO     epoch complete!
2024-05-02 14:38:41 INFO     evaluating now!
2024-05-02 14:38:42 INFO     Epoch [51/200] train_loss: 3.4601, val_loss: 4.8953, lr: 0.003000, 7.24s
2024-05-02 14:38:42 WARNING  Early stopping at epoch: 51
2024-05-02 14:38:42 INFO     Trained totally 52 epochs, average train time is 6.412s, average eval time is 0.464s
2024-05-02 14:38:42 INFO     Loaded model at 36
2024-05-02 14:38:42 INFO     Saved model at ./libcity/cache/15/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 14:38:42 INFO     Start evaluating ...
2024-05-02 14:38:44 INFO     Note that you select the single mode to evaluate!
2024-05-02 14:38:44 INFO     Evaluate result is saved at ./libcity/cache/15/evaluate_cache/2024_05_02_14_38_44_AGCRN_CHITaxi20190406.csv
2024-05-02 14:38:44 INFO     
         MAE      RMSE
1   2.444839  6.803729
2   2.515683  7.316536
3   2.575455  8.236703
4   2.643390  8.728344
5   2.735039  9.011811
6   2.827979  9.195340
7   2.814539  9.282581
8   2.848213  9.439719
9   2.798740  9.501504
10  2.785153  9.570717
11  2.804520  9.645148
12  2.876869  9.906430
2024-05-02 14:38:44 INFO     ----------------------------------------------------------------------------
2024-05-02 14:38:44 INFO     Kownledge Graph Embedding: GIE, Experiment ids: [15, 16, 17, 18, 19]
2024-05-02 14:38:44 INFO     ----------------------------------------------------------------------------
2024-05-02 14:38:44 INFO     Average: 
         MAE      RMSE
0   2.293709  6.907180
1   2.361130  7.331557
2   2.477921  8.117934
3   2.577056  8.527065
4   2.637753  8.835315
5   2.662146  8.988482
6   2.687001  9.148117
7   2.703506  9.264634
8   2.705264  9.383950
9   2.729296  9.464063
10  2.763394  9.630669
11  2.828582  9.935816 
2024-05-02 14:38:44 INFO     Standard deviation: 
         MAE      RMSE
0   0.130215  0.171436
1   0.129648  0.071562
2   0.104146  0.118100
3   0.098794  0.144200
4   0.089570  0.115938
5   0.113478  0.129936
6   0.119242  0.129899
7   0.120020  0.136939
8   0.116465  0.129194
9   0.098356  0.168751
10  0.066533  0.220462
11  0.055248  0.219351
2024-05-02 14:38:44 INFO     ----------------------------------------------------------------------------
2024-05-02 14:38:44 INFO     12 steps Average: 
        MAE      RMSE
0  2.618897  8.794565
2024-05-02 14:38:44 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.103476  0.146314
