2024-05-02 15:19:40 INFO     Saving logs in: ./logs/CHITaxi20190406/AGCRN/ExtTime&Space/Scaler/normal/RandomE
2024-05-02 15:19:40 INFO     ----------------------------------------------------------------------------
2024-05-02 15:19:40 INFO     # 0, Kownledge Graph Embedding: RandomE, Experiment ids: 60
2024-05-02 15:19:40 INFO     ----------------------------------------------------------------------------
2024-05-02 15:19:40 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=60
2024-05-02 15:19:40 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 60, 'load_external': True, 'embedding_model': 'RandomE', 'normal_external': True, 'ext_scaler': 'normal', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 15:19:41 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 15:19:41 INFO     set_weight_link_or_dist: dist
2024-05-02 15:19:41 INFO     init_weight_inf_or_zero: inf
2024-05-02 15:19:41 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 15:19:41 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 15:19:41 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 15:19:41 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 15:19:44 INFO     Dataset created
2024-05-02 15:19:44 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-05-02 15:19:44 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-05-02 15:19:44 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-05-02 15:19:44 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-05-02 15:19:44 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 15:19:45 INFO     NormalScaler max: 1.0
2024-05-02 15:19:50 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 15:19:50 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 15:19:50 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-05-02 15:19:50 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 15:19:50 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-05-02 15:19:50 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 15:19:50 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 15:19:50 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 15:19:50 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 15:19:50 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 15:19:50 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 15:19:50 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 15:19:50 INFO     Total parameter numbers: 904730
2024-05-02 15:19:50 INFO     You select `adam` optimizer.
2024-05-02 15:19:50 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 15:19:50 INFO     Start training ...
2024-05-02 15:19:50 INFO     num_batches:48
2024-05-02 15:19:57 INFO     epoch complete!
2024-05-02 15:19:57 INFO     evaluating now!
2024-05-02 15:19:58 INFO     Epoch [0/200] train_loss: 23.3076, val_loss: 16.9555, lr: 0.003000, 7.53s
2024-05-02 15:19:58 INFO     Saved model at 0
2024-05-02 15:19:58 INFO     Val loss decrease from inf to 16.9555, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 15:20:05 INFO     epoch complete!
2024-05-02 15:20:05 INFO     evaluating now!
2024-05-02 15:20:05 INFO     Epoch [1/200] train_loss: 13.4454, val_loss: 12.1956, lr: 0.003000, 7.01s
2024-05-02 15:20:05 INFO     Saved model at 1
2024-05-02 15:20:05 INFO     Val loss decrease from 16.9555 to 12.1956, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 15:20:12 INFO     epoch complete!
2024-05-02 15:20:12 INFO     evaluating now!
2024-05-02 15:20:12 INFO     Epoch [2/200] train_loss: 10.0797, val_loss: 9.4260, lr: 0.003000, 7.00s
2024-05-02 15:20:12 INFO     Saved model at 2
2024-05-02 15:20:12 INFO     Val loss decrease from 12.1956 to 9.4260, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 15:20:19 INFO     epoch complete!
2024-05-02 15:20:19 INFO     evaluating now!
2024-05-02 15:20:19 INFO     Epoch [3/200] train_loss: 8.1172, val_loss: 7.6423, lr: 0.003000, 6.95s
2024-05-02 15:20:19 INFO     Saved model at 3
2024-05-02 15:20:19 INFO     Val loss decrease from 9.4260 to 7.6423, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 15:20:26 INFO     epoch complete!
2024-05-02 15:20:26 INFO     evaluating now!
2024-05-02 15:20:26 INFO     Epoch [4/200] train_loss: 6.9835, val_loss: 6.7141, lr: 0.003000, 6.96s
2024-05-02 15:20:26 INFO     Saved model at 4
2024-05-02 15:20:26 INFO     Val loss decrease from 7.6423 to 6.7141, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 15:20:33 INFO     epoch complete!
2024-05-02 15:20:33 INFO     evaluating now!
2024-05-02 15:20:33 INFO     Epoch [5/200] train_loss: 6.2871, val_loss: 6.2373, lr: 0.003000, 6.97s
2024-05-02 15:20:33 INFO     Saved model at 5
2024-05-02 15:20:33 INFO     Val loss decrease from 6.7141 to 6.2373, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 15:20:40 INFO     epoch complete!
2024-05-02 15:20:40 INFO     evaluating now!
2024-05-02 15:20:40 INFO     Epoch [6/200] train_loss: 5.9030, val_loss: 6.0366, lr: 0.003000, 7.09s
2024-05-02 15:20:40 INFO     Saved model at 6
2024-05-02 15:20:40 INFO     Val loss decrease from 6.2373 to 6.0366, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 15:20:47 INFO     epoch complete!
2024-05-02 15:20:47 INFO     evaluating now!
2024-05-02 15:20:47 INFO     Epoch [7/200] train_loss: 5.6431, val_loss: 5.6596, lr: 0.003000, 6.98s
2024-05-02 15:20:47 INFO     Saved model at 7
2024-05-02 15:20:47 INFO     Val loss decrease from 6.0366 to 5.6596, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 15:20:54 INFO     epoch complete!
2024-05-02 15:20:54 INFO     evaluating now!
2024-05-02 15:20:54 INFO     Epoch [8/200] train_loss: 5.4188, val_loss: 5.8394, lr: 0.003000, 6.97s
2024-05-02 15:21:01 INFO     epoch complete!
2024-05-02 15:21:01 INFO     evaluating now!
2024-05-02 15:21:01 INFO     Epoch [9/200] train_loss: 5.2164, val_loss: 5.4447, lr: 0.003000, 7.05s
2024-05-02 15:21:01 INFO     Saved model at 9
2024-05-02 15:21:01 INFO     Val loss decrease from 5.6596 to 5.4447, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 15:21:08 INFO     epoch complete!
2024-05-02 15:21:08 INFO     evaluating now!
2024-05-02 15:21:08 INFO     Epoch [10/200] train_loss: 5.0790, val_loss: 5.2305, lr: 0.003000, 7.09s
2024-05-02 15:21:08 INFO     Saved model at 10
2024-05-02 15:21:08 INFO     Val loss decrease from 5.4447 to 5.2305, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 15:21:15 INFO     epoch complete!
2024-05-02 15:21:15 INFO     evaluating now!
2024-05-02 15:21:16 INFO     Epoch [11/200] train_loss: 4.8881, val_loss: 5.2599, lr: 0.003000, 7.04s
2024-05-02 15:21:22 INFO     epoch complete!
2024-05-02 15:21:22 INFO     evaluating now!
2024-05-02 15:21:23 INFO     Epoch [12/200] train_loss: 4.8053, val_loss: 5.1108, lr: 0.003000, 7.29s
2024-05-02 15:21:23 INFO     Saved model at 12
2024-05-02 15:21:23 INFO     Val loss decrease from 5.2305 to 5.1108, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 15:21:29 INFO     epoch complete!
2024-05-02 15:21:29 INFO     evaluating now!
2024-05-02 15:21:30 INFO     Epoch [13/200] train_loss: 4.6890, val_loss: 5.1885, lr: 0.003000, 6.69s
2024-05-02 15:21:36 INFO     epoch complete!
2024-05-02 15:21:36 INFO     evaluating now!
2024-05-02 15:21:36 INFO     Epoch [14/200] train_loss: 4.5672, val_loss: 5.0228, lr: 0.003000, 6.59s
2024-05-02 15:21:36 INFO     Saved model at 14
2024-05-02 15:21:36 INFO     Val loss decrease from 5.1108 to 5.0228, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-02 15:21:42 INFO     epoch complete!
2024-05-02 15:21:42 INFO     evaluating now!
2024-05-02 15:21:43 INFO     Epoch [15/200] train_loss: 4.4742, val_loss: 4.9381, lr: 0.003000, 6.50s
2024-05-02 15:21:43 INFO     Saved model at 15
2024-05-02 15:21:43 INFO     Val loss decrease from 5.0228 to 4.9381, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-02 15:21:49 INFO     epoch complete!
2024-05-02 15:21:49 INFO     evaluating now!
2024-05-02 15:21:49 INFO     Epoch [16/200] train_loss: 4.4420, val_loss: 4.8035, lr: 0.003000, 6.48s
2024-05-02 15:21:49 INFO     Saved model at 16
2024-05-02 15:21:49 INFO     Val loss decrease from 4.9381 to 4.8035, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-02 15:21:55 INFO     epoch complete!
2024-05-02 15:21:55 INFO     evaluating now!
2024-05-02 15:21:56 INFO     Epoch [17/200] train_loss: 4.3717, val_loss: 4.8825, lr: 0.003000, 6.45s
2024-05-02 15:22:02 INFO     epoch complete!
2024-05-02 15:22:02 INFO     evaluating now!
2024-05-02 15:22:02 INFO     Epoch [18/200] train_loss: 4.2662, val_loss: 4.8779, lr: 0.003000, 6.39s
2024-05-02 15:22:08 INFO     epoch complete!
2024-05-02 15:22:08 INFO     evaluating now!
2024-05-02 15:22:08 INFO     Epoch [19/200] train_loss: 4.2599, val_loss: 5.0338, lr: 0.003000, 6.39s
2024-05-02 15:22:15 INFO     epoch complete!
2024-05-02 15:22:15 INFO     evaluating now!
2024-05-02 15:22:16 INFO     Epoch [20/200] train_loss: 4.2369, val_loss: 4.8939, lr: 0.003000, 7.28s
2024-05-02 15:22:22 INFO     epoch complete!
2024-05-02 15:22:22 INFO     evaluating now!
2024-05-02 15:22:23 INFO     Epoch [21/200] train_loss: 4.1675, val_loss: 4.8043, lr: 0.003000, 7.03s
2024-05-02 15:22:29 INFO     epoch complete!
2024-05-02 15:22:29 INFO     evaluating now!
2024-05-02 15:22:30 INFO     Epoch [22/200] train_loss: 4.1378, val_loss: 4.8210, lr: 0.003000, 7.02s
2024-05-02 15:22:36 INFO     epoch complete!
2024-05-02 15:22:36 INFO     evaluating now!
2024-05-02 15:22:37 INFO     Epoch [23/200] train_loss: 4.1230, val_loss: 4.7550, lr: 0.003000, 6.99s
2024-05-02 15:22:37 INFO     Saved model at 23
2024-05-02 15:22:37 INFO     Val loss decrease from 4.8035 to 4.7550, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-05-02 15:22:43 INFO     epoch complete!
2024-05-02 15:22:43 INFO     evaluating now!
2024-05-02 15:22:44 INFO     Epoch [24/200] train_loss: 4.0939, val_loss: 4.7538, lr: 0.003000, 7.09s
2024-05-02 15:22:44 INFO     Saved model at 24
2024-05-02 15:22:44 INFO     Val loss decrease from 4.7550 to 4.7538, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-02 15:22:51 INFO     epoch complete!
2024-05-02 15:22:51 INFO     evaluating now!
2024-05-02 15:22:51 INFO     Epoch [25/200] train_loss: 3.9455, val_loss: 4.6759, lr: 0.003000, 7.00s
2024-05-02 15:22:51 INFO     Saved model at 25
2024-05-02 15:22:51 INFO     Val loss decrease from 4.7538 to 4.6759, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-02 15:22:58 INFO     epoch complete!
2024-05-02 15:22:58 INFO     evaluating now!
2024-05-02 15:22:58 INFO     Epoch [26/200] train_loss: 3.9061, val_loss: 4.7188, lr: 0.003000, 6.99s
2024-05-02 15:23:05 INFO     epoch complete!
2024-05-02 15:23:05 INFO     evaluating now!
2024-05-02 15:23:05 INFO     Epoch [27/200] train_loss: 3.8850, val_loss: 4.6515, lr: 0.003000, 6.97s
2024-05-02 15:23:05 INFO     Saved model at 27
2024-05-02 15:23:05 INFO     Val loss decrease from 4.6759 to 4.6515, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-05-02 15:23:12 INFO     epoch complete!
2024-05-02 15:23:12 INFO     evaluating now!
2024-05-02 15:23:12 INFO     Epoch [28/200] train_loss: 3.8600, val_loss: 4.7956, lr: 0.003000, 7.00s
2024-05-02 15:23:19 INFO     epoch complete!
2024-05-02 15:23:19 INFO     evaluating now!
2024-05-02 15:23:19 INFO     Epoch [29/200] train_loss: 3.8399, val_loss: 5.0677, lr: 0.003000, 7.04s
2024-05-02 15:23:26 INFO     epoch complete!
2024-05-02 15:23:26 INFO     evaluating now!
2024-05-02 15:23:26 INFO     Epoch [30/200] train_loss: 3.8287, val_loss: 4.5706, lr: 0.003000, 7.02s
2024-05-02 15:23:26 INFO     Saved model at 30
2024-05-02 15:23:26 INFO     Val loss decrease from 4.6515 to 4.5706, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-05-02 15:23:33 INFO     epoch complete!
2024-05-02 15:23:33 INFO     evaluating now!
2024-05-02 15:23:33 INFO     Epoch [31/200] train_loss: 3.7576, val_loss: 4.6346, lr: 0.003000, 7.14s
2024-05-02 15:23:40 INFO     epoch complete!
2024-05-02 15:23:40 INFO     evaluating now!
2024-05-02 15:23:40 INFO     Epoch [32/200] train_loss: 3.7601, val_loss: 4.6573, lr: 0.003000, 7.01s
2024-05-02 15:23:47 INFO     epoch complete!
2024-05-02 15:23:47 INFO     evaluating now!
2024-05-02 15:23:47 INFO     Epoch [33/200] train_loss: 3.7157, val_loss: 4.6535, lr: 0.003000, 6.89s
2024-05-02 15:23:54 INFO     epoch complete!
2024-05-02 15:23:54 INFO     evaluating now!
2024-05-02 15:23:54 INFO     Epoch [34/200] train_loss: 3.7033, val_loss: 4.7116, lr: 0.003000, 6.89s
2024-05-02 15:24:01 INFO     epoch complete!
2024-05-02 15:24:01 INFO     evaluating now!
2024-05-02 15:24:01 INFO     Epoch [35/200] train_loss: 3.6381, val_loss: 4.6967, lr: 0.003000, 7.36s
2024-05-02 15:24:09 INFO     epoch complete!
2024-05-02 15:24:09 INFO     evaluating now!
2024-05-02 15:24:09 INFO     Epoch [36/200] train_loss: 3.6253, val_loss: 4.7988, lr: 0.003000, 7.94s
2024-05-02 15:24:17 INFO     epoch complete!
2024-05-02 15:24:17 INFO     evaluating now!
2024-05-02 15:24:17 INFO     Epoch [37/200] train_loss: 3.6044, val_loss: 4.8449, lr: 0.003000, 7.92s
2024-05-02 15:24:25 INFO     epoch complete!
2024-05-02 15:24:25 INFO     evaluating now!
2024-05-02 15:24:25 INFO     Epoch [38/200] train_loss: 3.5818, val_loss: 4.7969, lr: 0.003000, 7.80s
2024-05-02 15:24:32 INFO     epoch complete!
2024-05-02 15:24:32 INFO     evaluating now!
2024-05-02 15:24:32 INFO     Epoch [39/200] train_loss: 3.5827, val_loss: 4.6981, lr: 0.003000, 7.19s
2024-05-02 15:24:39 INFO     epoch complete!
2024-05-02 15:24:39 INFO     evaluating now!
2024-05-02 15:24:39 INFO     Epoch [40/200] train_loss: 3.5586, val_loss: 4.7028, lr: 0.003000, 7.19s
2024-05-02 15:24:46 INFO     epoch complete!
2024-05-02 15:24:46 INFO     evaluating now!
2024-05-02 15:24:46 INFO     Epoch [41/200] train_loss: 3.5506, val_loss: 4.8188, lr: 0.003000, 7.03s
2024-05-02 15:24:53 INFO     epoch complete!
2024-05-02 15:24:53 INFO     evaluating now!
2024-05-02 15:24:53 INFO     Epoch [42/200] train_loss: 3.4952, val_loss: 4.8350, lr: 0.003000, 6.94s
2024-05-02 15:25:00 INFO     epoch complete!
2024-05-02 15:25:00 INFO     evaluating now!
2024-05-02 15:25:01 INFO     Epoch [43/200] train_loss: 3.4935, val_loss: 4.7564, lr: 0.003000, 7.10s
2024-05-02 15:25:07 INFO     epoch complete!
2024-05-02 15:25:07 INFO     evaluating now!
2024-05-02 15:25:07 INFO     Epoch [44/200] train_loss: 3.4656, val_loss: 4.6747, lr: 0.003000, 6.87s
2024-05-02 15:25:14 INFO     epoch complete!
2024-05-02 15:25:14 INFO     evaluating now!
2024-05-02 15:25:14 INFO     Epoch [45/200] train_loss: 3.4637, val_loss: 4.7092, lr: 0.003000, 6.94s
2024-05-02 15:25:14 WARNING  Early stopping at epoch: 45
2024-05-02 15:25:14 INFO     Trained totally 46 epochs, average train time is 6.545s, average eval time is 0.477s
2024-05-02 15:25:14 INFO     Loaded model at 30
2024-05-02 15:25:14 INFO     Saved model at ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 15:25:14 INFO     Start evaluating ...
2024-05-02 15:25:16 INFO     Note that you select the single mode to evaluate!
2024-05-02 15:25:16 INFO     Evaluate result is saved at ./libcity/cache/60/evaluate_cache/2024_05_02_15_25_16_AGCRN_CHITaxi20190406.csv
2024-05-02 15:25:16 INFO     
         MAE      RMSE
1   2.287244  7.164540
2   2.398903  7.786039
3   2.545562  8.486053
4   2.615668  8.865242
5   2.646621  9.123329
6   2.656347  9.205608
7   2.688384  9.325083
8   2.675374  9.435910
9   2.708537  9.527736
10  2.738366  9.602507
11  2.727514  9.741611
12  2.770825  9.998516
2024-05-02 15:25:16 INFO     ----------------------------------------------------------------------------
2024-05-02 15:25:16 INFO     # 1, Kownledge Graph Embedding: RandomE, Experiment ids: 61
2024-05-02 15:25:16 INFO     ----------------------------------------------------------------------------
2024-05-02 15:25:16 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=60
2024-05-02 15:25:16 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 60, 'load_external': True, 'embedding_model': 'RandomE', 'normal_external': True, 'ext_scaler': 'normal', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 15:25:16 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 15:25:16 INFO     set_weight_link_or_dist: dist
2024-05-02 15:25:16 INFO     init_weight_inf_or_zero: inf
2024-05-02 15:25:16 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 15:25:16 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 15:25:16 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 15:25:17 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 15:25:20 INFO     Dataset created
2024-05-02 15:25:20 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-05-02 15:25:20 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-05-02 15:25:20 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-05-02 15:25:20 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-05-02 15:25:20 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 15:25:20 INFO     NormalScaler max: 1.0
2024-05-02 15:25:24 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 15:25:24 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 15:25:24 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-05-02 15:25:24 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 15:25:24 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-05-02 15:25:24 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 15:25:24 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 15:25:24 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 15:25:24 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 15:25:24 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 15:25:24 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 15:25:24 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 15:25:24 INFO     Total parameter numbers: 904730
2024-05-02 15:25:24 INFO     You select `adam` optimizer.
2024-05-02 15:25:24 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 15:25:24 INFO     Start training ...
2024-05-02 15:25:24 INFO     num_batches:48
2024-05-02 15:25:31 INFO     epoch complete!
2024-05-02 15:25:31 INFO     evaluating now!
2024-05-02 15:25:32 INFO     Epoch [0/200] train_loss: 24.0030, val_loss: 17.5114, lr: 0.003000, 7.71s
2024-05-02 15:25:32 INFO     Saved model at 0
2024-05-02 15:25:32 INFO     Val loss decrease from inf to 17.5114, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 15:25:39 INFO     epoch complete!
2024-05-02 15:25:39 INFO     evaluating now!
2024-05-02 15:25:39 INFO     Epoch [1/200] train_loss: 13.9702, val_loss: 12.8480, lr: 0.003000, 7.66s
2024-05-02 15:25:40 INFO     Saved model at 1
2024-05-02 15:25:40 INFO     Val loss decrease from 17.5114 to 12.8480, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 15:25:46 INFO     epoch complete!
2024-05-02 15:25:46 INFO     evaluating now!
2024-05-02 15:25:47 INFO     Epoch [2/200] train_loss: 10.2808, val_loss: 9.3751, lr: 0.003000, 7.28s
2024-05-02 15:25:47 INFO     Saved model at 2
2024-05-02 15:25:47 INFO     Val loss decrease from 12.8480 to 9.3751, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 15:25:54 INFO     epoch complete!
2024-05-02 15:25:54 INFO     evaluating now!
2024-05-02 15:25:54 INFO     Epoch [3/200] train_loss: 8.2499, val_loss: 7.8392, lr: 0.003000, 7.15s
2024-05-02 15:25:54 INFO     Saved model at 3
2024-05-02 15:25:54 INFO     Val loss decrease from 9.3751 to 7.8392, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 15:26:01 INFO     epoch complete!
2024-05-02 15:26:01 INFO     evaluating now!
2024-05-02 15:26:01 INFO     Epoch [4/200] train_loss: 7.0733, val_loss: 6.7351, lr: 0.003000, 7.24s
2024-05-02 15:26:01 INFO     Saved model at 4
2024-05-02 15:26:01 INFO     Val loss decrease from 7.8392 to 6.7351, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 15:26:08 INFO     epoch complete!
2024-05-02 15:26:08 INFO     evaluating now!
2024-05-02 15:26:08 INFO     Epoch [5/200] train_loss: 6.3489, val_loss: 6.3384, lr: 0.003000, 7.10s
2024-05-02 15:26:08 INFO     Saved model at 5
2024-05-02 15:26:08 INFO     Val loss decrease from 6.7351 to 6.3384, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 15:26:15 INFO     epoch complete!
2024-05-02 15:26:15 INFO     evaluating now!
2024-05-02 15:26:16 INFO     Epoch [6/200] train_loss: 6.0306, val_loss: 5.9608, lr: 0.003000, 7.11s
2024-05-02 15:26:16 INFO     Saved model at 6
2024-05-02 15:26:16 INFO     Val loss decrease from 6.3384 to 5.9608, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 15:26:22 INFO     epoch complete!
2024-05-02 15:26:22 INFO     evaluating now!
2024-05-02 15:26:23 INFO     Epoch [7/200] train_loss: 5.6044, val_loss: 5.5130, lr: 0.003000, 7.14s
2024-05-02 15:26:23 INFO     Saved model at 7
2024-05-02 15:26:23 INFO     Val loss decrease from 5.9608 to 5.5130, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 15:26:30 INFO     epoch complete!
2024-05-02 15:26:30 INFO     evaluating now!
2024-05-02 15:26:30 INFO     Epoch [8/200] train_loss: 5.3652, val_loss: 5.4803, lr: 0.003000, 7.26s
2024-05-02 15:26:30 INFO     Saved model at 8
2024-05-02 15:26:30 INFO     Val loss decrease from 5.5130 to 5.4803, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 15:26:37 INFO     epoch complete!
2024-05-02 15:26:37 INFO     evaluating now!
2024-05-02 15:26:37 INFO     Epoch [9/200] train_loss: 5.2481, val_loss: 5.4067, lr: 0.003000, 7.20s
2024-05-02 15:26:37 INFO     Saved model at 9
2024-05-02 15:26:37 INFO     Val loss decrease from 5.4803 to 5.4067, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 15:26:44 INFO     epoch complete!
2024-05-02 15:26:44 INFO     evaluating now!
2024-05-02 15:26:44 INFO     Epoch [10/200] train_loss: 5.1036, val_loss: 5.1744, lr: 0.003000, 7.02s
2024-05-02 15:26:44 INFO     Saved model at 10
2024-05-02 15:26:44 INFO     Val loss decrease from 5.4067 to 5.1744, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 15:26:51 INFO     epoch complete!
2024-05-02 15:26:51 INFO     evaluating now!
2024-05-02 15:26:52 INFO     Epoch [11/200] train_loss: 4.9221, val_loss: 5.1346, lr: 0.003000, 7.23s
2024-05-02 15:26:52 INFO     Saved model at 11
2024-05-02 15:26:52 INFO     Val loss decrease from 5.1744 to 5.1346, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 15:26:59 INFO     epoch complete!
2024-05-02 15:26:59 INFO     evaluating now!
2024-05-02 15:26:59 INFO     Epoch [12/200] train_loss: 4.8243, val_loss: 5.1428, lr: 0.003000, 7.37s
2024-05-02 15:27:05 INFO     epoch complete!
2024-05-02 15:27:05 INFO     evaluating now!
2024-05-02 15:27:06 INFO     Epoch [13/200] train_loss: 4.6727, val_loss: 4.9530, lr: 0.003000, 6.82s
2024-05-02 15:27:06 INFO     Saved model at 13
2024-05-02 15:27:06 INFO     Val loss decrease from 5.1346 to 4.9530, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-02 15:27:13 INFO     epoch complete!
2024-05-02 15:27:13 INFO     evaluating now!
2024-05-02 15:27:13 INFO     Epoch [14/200] train_loss: 4.6331, val_loss: 4.9537, lr: 0.003000, 7.16s
2024-05-02 15:27:20 INFO     epoch complete!
2024-05-02 15:27:20 INFO     evaluating now!
2024-05-02 15:27:21 INFO     Epoch [15/200] train_loss: 4.5725, val_loss: 4.8777, lr: 0.003000, 7.44s
2024-05-02 15:27:21 INFO     Saved model at 15
2024-05-02 15:27:21 INFO     Val loss decrease from 4.9530 to 4.8777, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-02 15:27:28 INFO     epoch complete!
2024-05-02 15:27:28 INFO     evaluating now!
2024-05-02 15:27:28 INFO     Epoch [16/200] train_loss: 4.4626, val_loss: 5.0056, lr: 0.003000, 7.45s
2024-05-02 15:27:35 INFO     epoch complete!
2024-05-02 15:27:35 INFO     evaluating now!
2024-05-02 15:27:36 INFO     Epoch [17/200] train_loss: 4.3840, val_loss: 4.8174, lr: 0.003000, 7.51s
2024-05-02 15:27:36 INFO     Saved model at 17
2024-05-02 15:27:36 INFO     Val loss decrease from 4.8777 to 4.8174, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-02 15:27:43 INFO     epoch complete!
2024-05-02 15:27:43 INFO     evaluating now!
2024-05-02 15:27:43 INFO     Epoch [18/200] train_loss: 4.3602, val_loss: 4.8357, lr: 0.003000, 7.63s
2024-05-02 15:27:51 INFO     epoch complete!
2024-05-02 15:27:51 INFO     evaluating now!
2024-05-02 15:27:51 INFO     Epoch [19/200] train_loss: 4.2644, val_loss: 4.8151, lr: 0.003000, 8.07s
2024-05-02 15:27:51 INFO     Saved model at 19
2024-05-02 15:27:51 INFO     Val loss decrease from 4.8174 to 4.8151, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-02 15:27:59 INFO     epoch complete!
2024-05-02 15:27:59 INFO     evaluating now!
2024-05-02 15:27:59 INFO     Epoch [20/200] train_loss: 4.2240, val_loss: 4.6839, lr: 0.003000, 7.86s
2024-05-02 15:27:59 INFO     Saved model at 20
2024-05-02 15:27:59 INFO     Val loss decrease from 4.8151 to 4.6839, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-02 15:28:07 INFO     epoch complete!
2024-05-02 15:28:07 INFO     evaluating now!
2024-05-02 15:28:07 INFO     Epoch [21/200] train_loss: 4.1530, val_loss: 4.8359, lr: 0.003000, 7.89s
2024-05-02 15:28:15 INFO     epoch complete!
2024-05-02 15:28:15 INFO     evaluating now!
2024-05-02 15:28:15 INFO     Epoch [22/200] train_loss: 4.1678, val_loss: 4.7884, lr: 0.003000, 8.01s
2024-05-02 15:28:23 INFO     epoch complete!
2024-05-02 15:28:23 INFO     evaluating now!
2024-05-02 15:28:23 INFO     Epoch [23/200] train_loss: 4.1151, val_loss: 4.9895, lr: 0.003000, 8.04s
2024-05-02 15:28:31 INFO     epoch complete!
2024-05-02 15:28:31 INFO     evaluating now!
2024-05-02 15:28:31 INFO     Epoch [24/200] train_loss: 4.0281, val_loss: 4.7349, lr: 0.003000, 7.85s
2024-05-02 15:28:38 INFO     epoch complete!
2024-05-02 15:28:38 INFO     evaluating now!
2024-05-02 15:28:39 INFO     Epoch [25/200] train_loss: 3.9893, val_loss: 4.7183, lr: 0.003000, 7.67s
2024-05-02 15:28:46 INFO     epoch complete!
2024-05-02 15:28:46 INFO     evaluating now!
2024-05-02 15:28:47 INFO     Epoch [26/200] train_loss: 3.9588, val_loss: 4.8111, lr: 0.003000, 7.77s
2024-05-02 15:28:54 INFO     epoch complete!
2024-05-02 15:28:54 INFO     evaluating now!
2024-05-02 15:28:54 INFO     Epoch [27/200] train_loss: 3.8942, val_loss: 4.7541, lr: 0.003000, 7.81s
2024-05-02 15:29:02 INFO     epoch complete!
2024-05-02 15:29:02 INFO     evaluating now!
2024-05-02 15:29:02 INFO     Epoch [28/200] train_loss: 3.8615, val_loss: 4.5999, lr: 0.003000, 7.76s
2024-05-02 15:29:02 INFO     Saved model at 28
2024-05-02 15:29:02 INFO     Val loss decrease from 4.6839 to 4.5999, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-05-02 15:29:09 INFO     epoch complete!
2024-05-02 15:29:09 INFO     evaluating now!
2024-05-02 15:29:10 INFO     Epoch [29/200] train_loss: 3.8642, val_loss: 4.6680, lr: 0.003000, 7.75s
2024-05-02 15:29:17 INFO     epoch complete!
2024-05-02 15:29:17 INFO     evaluating now!
2024-05-02 15:29:18 INFO     Epoch [30/200] train_loss: 3.8227, val_loss: 4.7171, lr: 0.003000, 7.79s
2024-05-02 15:29:25 INFO     epoch complete!
2024-05-02 15:29:25 INFO     evaluating now!
2024-05-02 15:29:26 INFO     Epoch [31/200] train_loss: 3.7641, val_loss: 4.7354, lr: 0.003000, 7.98s
2024-05-02 15:29:33 INFO     epoch complete!
2024-05-02 15:29:33 INFO     evaluating now!
2024-05-02 15:29:34 INFO     Epoch [32/200] train_loss: 3.8095, val_loss: 4.7573, lr: 0.003000, 8.12s
2024-05-02 15:29:41 INFO     epoch complete!
2024-05-02 15:29:41 INFO     evaluating now!
2024-05-02 15:29:42 INFO     Epoch [33/200] train_loss: 3.7649, val_loss: 4.6620, lr: 0.003000, 8.10s
2024-05-02 15:29:49 INFO     epoch complete!
2024-05-02 15:29:49 INFO     evaluating now!
2024-05-02 15:29:50 INFO     Epoch [34/200] train_loss: 3.7322, val_loss: 4.6528, lr: 0.003000, 8.08s
2024-05-02 15:29:57 INFO     epoch complete!
2024-05-02 15:29:57 INFO     evaluating now!
2024-05-02 15:29:58 INFO     Epoch [35/200] train_loss: 3.7478, val_loss: 4.7522, lr: 0.003000, 8.01s
2024-05-02 15:30:06 INFO     epoch complete!
2024-05-02 15:30:06 INFO     evaluating now!
2024-05-02 15:30:06 INFO     Epoch [36/200] train_loss: 3.6570, val_loss: 4.7324, lr: 0.003000, 8.19s
2024-05-02 15:30:14 INFO     epoch complete!
2024-05-02 15:30:14 INFO     evaluating now!
2024-05-02 15:30:14 INFO     Epoch [37/200] train_loss: 3.6287, val_loss: 4.6967, lr: 0.003000, 8.14s
2024-05-02 15:30:21 INFO     epoch complete!
2024-05-02 15:30:21 INFO     evaluating now!
2024-05-02 15:30:22 INFO     Epoch [38/200] train_loss: 3.6123, val_loss: 4.7935, lr: 0.003000, 7.62s
2024-05-02 15:30:29 INFO     epoch complete!
2024-05-02 15:30:29 INFO     evaluating now!
2024-05-02 15:30:29 INFO     Epoch [39/200] train_loss: 3.6212, val_loss: 4.7512, lr: 0.003000, 7.08s
2024-05-02 15:30:36 INFO     epoch complete!
2024-05-02 15:30:36 INFO     evaluating now!
2024-05-02 15:30:36 INFO     Epoch [40/200] train_loss: 3.6129, val_loss: 4.6725, lr: 0.003000, 7.04s
2024-05-02 15:30:43 INFO     epoch complete!
2024-05-02 15:30:43 INFO     evaluating now!
2024-05-02 15:30:43 INFO     Epoch [41/200] train_loss: 3.5683, val_loss: 4.8448, lr: 0.003000, 7.13s
2024-05-02 15:30:50 INFO     epoch complete!
2024-05-02 15:30:50 INFO     evaluating now!
2024-05-02 15:30:50 INFO     Epoch [42/200] train_loss: 3.5528, val_loss: 4.6996, lr: 0.003000, 7.16s
2024-05-02 15:30:57 INFO     epoch complete!
2024-05-02 15:30:57 INFO     evaluating now!
2024-05-02 15:30:58 INFO     Epoch [43/200] train_loss: 3.5183, val_loss: 4.6675, lr: 0.003000, 7.21s
2024-05-02 15:30:58 WARNING  Early stopping at epoch: 43
2024-05-02 15:30:58 INFO     Trained totally 44 epochs, average train time is 7.032s, average eval time is 0.526s
2024-05-02 15:30:58 INFO     Loaded model at 28
2024-05-02 15:30:58 INFO     Saved model at ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 15:30:58 INFO     Start evaluating ...
2024-05-02 15:30:59 INFO     Note that you select the single mode to evaluate!
2024-05-02 15:30:59 INFO     Evaluate result is saved at ./libcity/cache/60/evaluate_cache/2024_05_02_15_30_59_AGCRN_CHITaxi20190406.csv
2024-05-02 15:30:59 INFO     
         MAE       RMSE
1   2.419673   7.138599
2   2.489502   7.495762
3   2.554011   8.266980
4   2.683568   8.688959
5   2.745897   9.035890
6   2.789661   9.115561
7   2.758514   9.301212
8   2.768317   9.394315
9   2.788548   9.460736
10  2.829626   9.509804
11  2.849410   9.641392
12  2.923862  10.062147
2024-05-02 15:30:59 INFO     ----------------------------------------------------------------------------
2024-05-02 15:30:59 INFO     # 2, Kownledge Graph Embedding: RandomE, Experiment ids: 62
2024-05-02 15:30:59 INFO     ----------------------------------------------------------------------------
2024-05-02 15:30:59 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=60
2024-05-02 15:30:59 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 60, 'load_external': True, 'embedding_model': 'RandomE', 'normal_external': True, 'ext_scaler': 'normal', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 15:31:00 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 15:31:00 INFO     set_weight_link_or_dist: dist
2024-05-02 15:31:00 INFO     init_weight_inf_or_zero: inf
2024-05-02 15:31:00 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 15:31:00 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 15:31:00 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 15:31:00 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 15:31:03 INFO     Dataset created
2024-05-02 15:31:03 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-05-02 15:31:03 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-05-02 15:31:03 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-05-02 15:31:03 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-05-02 15:31:03 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 15:31:04 INFO     NormalScaler max: 1.0
2024-05-02 15:31:07 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 15:31:07 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 15:31:07 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-05-02 15:31:07 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 15:31:07 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-05-02 15:31:07 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 15:31:07 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 15:31:07 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 15:31:07 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 15:31:07 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 15:31:07 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 15:31:07 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 15:31:07 INFO     Total parameter numbers: 904730
2024-05-02 15:31:07 INFO     You select `adam` optimizer.
2024-05-02 15:31:07 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 15:31:07 INFO     Start training ...
2024-05-02 15:31:07 INFO     num_batches:48
2024-05-02 15:31:14 INFO     epoch complete!
2024-05-02 15:31:14 INFO     evaluating now!
2024-05-02 15:31:15 INFO     Epoch [0/200] train_loss: 25.1496, val_loss: 17.5750, lr: 0.003000, 7.19s
2024-05-02 15:31:15 INFO     Saved model at 0
2024-05-02 15:31:15 INFO     Val loss decrease from inf to 17.5750, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 15:31:22 INFO     epoch complete!
2024-05-02 15:31:22 INFO     evaluating now!
2024-05-02 15:31:22 INFO     Epoch [1/200] train_loss: 13.9395, val_loss: 13.1172, lr: 0.003000, 7.84s
2024-05-02 15:31:22 INFO     Saved model at 1
2024-05-02 15:31:22 INFO     Val loss decrease from 17.5750 to 13.1172, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 15:31:29 INFO     epoch complete!
2024-05-02 15:31:29 INFO     evaluating now!
2024-05-02 15:31:30 INFO     Epoch [2/200] train_loss: 10.4515, val_loss: 9.6107, lr: 0.003000, 7.29s
2024-05-02 15:31:30 INFO     Saved model at 2
2024-05-02 15:31:30 INFO     Val loss decrease from 13.1172 to 9.6107, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 15:31:36 INFO     epoch complete!
2024-05-02 15:31:36 INFO     evaluating now!
2024-05-02 15:31:37 INFO     Epoch [3/200] train_loss: 8.1830, val_loss: 7.7653, lr: 0.003000, 7.13s
2024-05-02 15:31:37 INFO     Saved model at 3
2024-05-02 15:31:37 INFO     Val loss decrease from 9.6107 to 7.7653, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 15:31:44 INFO     epoch complete!
2024-05-02 15:31:44 INFO     evaluating now!
2024-05-02 15:31:44 INFO     Epoch [4/200] train_loss: 7.1326, val_loss: 6.8021, lr: 0.003000, 7.10s
2024-05-02 15:31:44 INFO     Saved model at 4
2024-05-02 15:31:44 INFO     Val loss decrease from 7.7653 to 6.8021, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 15:31:51 INFO     epoch complete!
2024-05-02 15:31:51 INFO     evaluating now!
2024-05-02 15:31:51 INFO     Epoch [5/200] train_loss: 6.4217, val_loss: 6.5020, lr: 0.003000, 7.12s
2024-05-02 15:31:51 INFO     Saved model at 5
2024-05-02 15:31:51 INFO     Val loss decrease from 6.8021 to 6.5020, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 15:31:58 INFO     epoch complete!
2024-05-02 15:31:58 INFO     evaluating now!
2024-05-02 15:31:58 INFO     Epoch [6/200] train_loss: 5.9634, val_loss: 6.0024, lr: 0.003000, 7.19s
2024-05-02 15:31:59 INFO     Saved model at 6
2024-05-02 15:31:59 INFO     Val loss decrease from 6.5020 to 6.0024, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 15:32:05 INFO     epoch complete!
2024-05-02 15:32:05 INFO     evaluating now!
2024-05-02 15:32:06 INFO     Epoch [7/200] train_loss: 5.6469, val_loss: 5.7757, lr: 0.003000, 7.36s
2024-05-02 15:32:06 INFO     Saved model at 7
2024-05-02 15:32:06 INFO     Val loss decrease from 6.0024 to 5.7757, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 15:32:13 INFO     epoch complete!
2024-05-02 15:32:13 INFO     evaluating now!
2024-05-02 15:32:13 INFO     Epoch [8/200] train_loss: 5.4650, val_loss: 5.6506, lr: 0.003000, 7.22s
2024-05-02 15:32:13 INFO     Saved model at 8
2024-05-02 15:32:13 INFO     Val loss decrease from 5.7757 to 5.6506, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 15:32:20 INFO     epoch complete!
2024-05-02 15:32:20 INFO     evaluating now!
2024-05-02 15:32:21 INFO     Epoch [9/200] train_loss: 5.2422, val_loss: 5.5345, lr: 0.003000, 7.29s
2024-05-02 15:32:21 INFO     Saved model at 9
2024-05-02 15:32:21 INFO     Val loss decrease from 5.6506 to 5.5345, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 15:32:27 INFO     epoch complete!
2024-05-02 15:32:27 INFO     evaluating now!
2024-05-02 15:32:28 INFO     Epoch [10/200] train_loss: 5.0748, val_loss: 5.2966, lr: 0.003000, 7.17s
2024-05-02 15:32:28 INFO     Saved model at 10
2024-05-02 15:32:28 INFO     Val loss decrease from 5.5345 to 5.2966, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 15:32:34 INFO     epoch complete!
2024-05-02 15:32:34 INFO     evaluating now!
2024-05-02 15:32:35 INFO     Epoch [11/200] train_loss: 4.9049, val_loss: 5.2829, lr: 0.003000, 7.17s
2024-05-02 15:32:35 INFO     Saved model at 11
2024-05-02 15:32:35 INFO     Val loss decrease from 5.2966 to 5.2829, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 15:32:41 INFO     epoch complete!
2024-05-02 15:32:41 INFO     evaluating now!
2024-05-02 15:32:42 INFO     Epoch [12/200] train_loss: 4.8183, val_loss: 5.1722, lr: 0.003000, 6.74s
2024-05-02 15:32:42 INFO     Saved model at 12
2024-05-02 15:32:42 INFO     Val loss decrease from 5.2829 to 5.1722, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 15:32:48 INFO     epoch complete!
2024-05-02 15:32:48 INFO     evaluating now!
2024-05-02 15:32:48 INFO     Epoch [13/200] train_loss: 4.7060, val_loss: 5.1432, lr: 0.003000, 6.62s
2024-05-02 15:32:48 INFO     Saved model at 13
2024-05-02 15:32:48 INFO     Val loss decrease from 5.1722 to 5.1432, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-02 15:32:55 INFO     epoch complete!
2024-05-02 15:32:55 INFO     evaluating now!
2024-05-02 15:32:55 INFO     Epoch [14/200] train_loss: 4.6333, val_loss: 4.9061, lr: 0.003000, 6.66s
2024-05-02 15:32:55 INFO     Saved model at 14
2024-05-02 15:32:55 INFO     Val loss decrease from 5.1432 to 4.9061, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-02 15:33:01 INFO     epoch complete!
2024-05-02 15:33:01 INFO     evaluating now!
2024-05-02 15:33:02 INFO     Epoch [15/200] train_loss: 4.5495, val_loss: 4.9516, lr: 0.003000, 6.66s
2024-05-02 15:33:08 INFO     epoch complete!
2024-05-02 15:33:08 INFO     evaluating now!
2024-05-02 15:33:08 INFO     Epoch [16/200] train_loss: 4.4972, val_loss: 4.9466, lr: 0.003000, 6.25s
2024-05-02 15:33:14 INFO     epoch complete!
2024-05-02 15:33:14 INFO     evaluating now!
2024-05-02 15:33:14 INFO     Epoch [17/200] train_loss: 4.4003, val_loss: 4.9993, lr: 0.003000, 6.37s
2024-05-02 15:33:21 INFO     epoch complete!
2024-05-02 15:33:21 INFO     evaluating now!
2024-05-02 15:33:21 INFO     Epoch [18/200] train_loss: 4.3665, val_loss: 4.8614, lr: 0.003000, 7.00s
2024-05-02 15:33:21 INFO     Saved model at 18
2024-05-02 15:33:21 INFO     Val loss decrease from 4.9061 to 4.8614, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-02 15:33:28 INFO     epoch complete!
2024-05-02 15:33:28 INFO     evaluating now!
2024-05-02 15:33:28 INFO     Epoch [19/200] train_loss: 4.2741, val_loss: 4.9034, lr: 0.003000, 6.75s
2024-05-02 15:33:35 INFO     epoch complete!
2024-05-02 15:33:35 INFO     evaluating now!
2024-05-02 15:33:35 INFO     Epoch [20/200] train_loss: 4.2289, val_loss: 4.8755, lr: 0.003000, 6.80s
2024-05-02 15:33:41 INFO     epoch complete!
2024-05-02 15:33:41 INFO     evaluating now!
2024-05-02 15:33:42 INFO     Epoch [21/200] train_loss: 4.2126, val_loss: 5.0130, lr: 0.003000, 6.74s
2024-05-02 15:33:48 INFO     epoch complete!
2024-05-02 15:33:48 INFO     evaluating now!
2024-05-02 15:33:48 INFO     Epoch [22/200] train_loss: 4.1641, val_loss: 4.7643, lr: 0.003000, 6.69s
2024-05-02 15:33:59 INFO     Saved model at 22
2024-05-02 15:33:59 INFO     Val loss decrease from 4.8614 to 4.7643, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-02 15:34:06 INFO     epoch complete!
2024-05-02 15:34:06 INFO     evaluating now!
2024-05-02 15:34:06 INFO     Epoch [23/200] train_loss: 4.1195, val_loss: 4.8701, lr: 0.003000, 6.86s
2024-05-02 15:34:13 INFO     epoch complete!
2024-05-02 15:34:13 INFO     evaluating now!
2024-05-02 15:34:13 INFO     Epoch [24/200] train_loss: 4.0952, val_loss: 4.9097, lr: 0.003000, 7.06s
2024-05-02 15:34:20 INFO     epoch complete!
2024-05-02 15:34:20 INFO     evaluating now!
2024-05-02 15:34:20 INFO     Epoch [25/200] train_loss: 4.0240, val_loss: 4.8216, lr: 0.003000, 7.03s
2024-05-02 15:34:27 INFO     epoch complete!
2024-05-02 15:34:27 INFO     evaluating now!
2024-05-02 15:34:27 INFO     Epoch [26/200] train_loss: 4.0100, val_loss: 4.7404, lr: 0.003000, 7.09s
2024-05-02 15:34:27 INFO     Saved model at 26
2024-05-02 15:34:27 INFO     Val loss decrease from 4.7643 to 4.7404, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch26.tar
2024-05-02 15:34:34 INFO     epoch complete!
2024-05-02 15:34:34 INFO     evaluating now!
2024-05-02 15:34:34 INFO     Epoch [27/200] train_loss: 3.9750, val_loss: 4.6950, lr: 0.003000, 7.03s
2024-05-02 15:34:34 INFO     Saved model at 27
2024-05-02 15:34:34 INFO     Val loss decrease from 4.7404 to 4.6950, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch27.tar
2024-05-02 15:34:41 INFO     epoch complete!
2024-05-02 15:34:41 INFO     evaluating now!
2024-05-02 15:34:42 INFO     Epoch [28/200] train_loss: 3.9510, val_loss: 4.7322, lr: 0.003000, 7.12s
2024-05-02 15:34:48 INFO     epoch complete!
2024-05-02 15:34:48 INFO     evaluating now!
2024-05-02 15:34:49 INFO     Epoch [29/200] train_loss: 3.9670, val_loss: 4.6484, lr: 0.003000, 7.00s
2024-05-02 15:34:49 INFO     Saved model at 29
2024-05-02 15:34:49 INFO     Val loss decrease from 4.6950 to 4.6484, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch29.tar
2024-05-02 15:34:55 INFO     epoch complete!
2024-05-02 15:34:55 INFO     evaluating now!
2024-05-02 15:34:56 INFO     Epoch [30/200] train_loss: 3.8816, val_loss: 4.6405, lr: 0.003000, 6.96s
2024-05-02 15:34:56 INFO     Saved model at 30
2024-05-02 15:34:56 INFO     Val loss decrease from 4.6484 to 4.6405, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-05-02 15:35:02 INFO     epoch complete!
2024-05-02 15:35:02 INFO     evaluating now!
2024-05-02 15:35:03 INFO     Epoch [31/200] train_loss: 3.8063, val_loss: 4.6271, lr: 0.003000, 7.15s
2024-05-02 15:35:03 INFO     Saved model at 31
2024-05-02 15:35:03 INFO     Val loss decrease from 4.6405 to 4.6271, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-05-02 15:35:09 INFO     epoch complete!
2024-05-02 15:35:09 INFO     evaluating now!
2024-05-02 15:35:10 INFO     Epoch [32/200] train_loss: 3.7964, val_loss: 4.7076, lr: 0.003000, 6.98s
2024-05-02 15:35:16 INFO     epoch complete!
2024-05-02 15:35:16 INFO     evaluating now!
2024-05-02 15:35:17 INFO     Epoch [33/200] train_loss: 3.7981, val_loss: 4.7377, lr: 0.003000, 6.81s
2024-05-02 15:35:23 INFO     epoch complete!
2024-05-02 15:35:23 INFO     evaluating now!
2024-05-02 15:35:23 INFO     Epoch [34/200] train_loss: 3.7259, val_loss: 4.7486, lr: 0.003000, 6.79s
2024-05-02 15:35:30 INFO     epoch complete!
2024-05-02 15:35:30 INFO     evaluating now!
2024-05-02 15:35:30 INFO     Epoch [35/200] train_loss: 3.7426, val_loss: 4.7165, lr: 0.003000, 6.81s
2024-05-02 15:35:36 INFO     epoch complete!
2024-05-02 15:35:36 INFO     evaluating now!
2024-05-02 15:35:37 INFO     Epoch [36/200] train_loss: 3.6797, val_loss: 4.7086, lr: 0.003000, 6.70s
2024-05-02 15:35:43 INFO     epoch complete!
2024-05-02 15:35:43 INFO     evaluating now!
2024-05-02 15:35:43 INFO     Epoch [37/200] train_loss: 3.6755, val_loss: 4.7117, lr: 0.003000, 6.43s
2024-05-02 15:35:50 INFO     epoch complete!
2024-05-02 15:35:50 INFO     evaluating now!
2024-05-02 15:35:50 INFO     Epoch [38/200] train_loss: 3.6610, val_loss: 4.7105, lr: 0.003000, 6.91s
2024-05-02 15:35:56 INFO     epoch complete!
2024-05-02 15:35:56 INFO     evaluating now!
2024-05-02 15:35:57 INFO     Epoch [39/200] train_loss: 3.5988, val_loss: 4.7865, lr: 0.003000, 6.62s
2024-05-02 15:36:03 INFO     epoch complete!
2024-05-02 15:36:03 INFO     evaluating now!
2024-05-02 15:36:03 INFO     Epoch [40/200] train_loss: 3.6149, val_loss: 4.8189, lr: 0.003000, 6.50s
2024-05-02 15:36:10 INFO     epoch complete!
2024-05-02 15:36:10 INFO     evaluating now!
2024-05-02 15:36:10 INFO     Epoch [41/200] train_loss: 3.5752, val_loss: 4.6947, lr: 0.003000, 6.64s
2024-05-02 15:36:16 INFO     epoch complete!
2024-05-02 15:36:16 INFO     evaluating now!
2024-05-02 15:36:17 INFO     Epoch [42/200] train_loss: 3.5320, val_loss: 4.8145, lr: 0.003000, 6.50s
2024-05-02 15:36:23 INFO     epoch complete!
2024-05-02 15:36:23 INFO     evaluating now!
2024-05-02 15:36:23 INFO     Epoch [43/200] train_loss: 3.5430, val_loss: 4.7899, lr: 0.003000, 6.61s
2024-05-02 15:36:29 INFO     epoch complete!
2024-05-02 15:36:29 INFO     evaluating now!
2024-05-02 15:36:30 INFO     Epoch [44/200] train_loss: 3.5125, val_loss: 4.9627, lr: 0.003000, 6.59s
2024-05-02 15:36:36 INFO     epoch complete!
2024-05-02 15:36:36 INFO     evaluating now!
2024-05-02 15:36:36 INFO     Epoch [45/200] train_loss: 3.4958, val_loss: 4.6966, lr: 0.003000, 6.60s
2024-05-02 15:36:42 INFO     epoch complete!
2024-05-02 15:36:42 INFO     evaluating now!
2024-05-02 15:36:43 INFO     Epoch [46/200] train_loss: 3.4855, val_loss: 4.7123, lr: 0.003000, 6.55s
2024-05-02 15:36:43 WARNING  Early stopping at epoch: 46
2024-05-02 15:36:43 INFO     Trained totally 47 epochs, average train time is 6.421s, average eval time is 0.465s
2024-05-02 15:36:43 INFO     Loaded model at 31
2024-05-02 15:36:43 INFO     Saved model at ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 15:36:43 INFO     Start evaluating ...
2024-05-02 15:36:45 INFO     Note that you select the single mode to evaluate!
2024-05-02 15:36:45 INFO     Evaluate result is saved at ./libcity/cache/60/evaluate_cache/2024_05_02_15_36_45_AGCRN_CHITaxi20190406.csv
2024-05-02 15:36:45 INFO     
         MAE      RMSE
1   2.250015  6.883070
2   2.356427  7.397295
3   2.458888  8.201736
4   2.507065  8.587827
5   2.585625  8.803978
6   2.622914  8.913163
7   2.621126  9.075123
8   2.644440  9.177328
9   2.661039  9.217190
10  2.683910  9.287466
11  2.754746  9.457484
12  2.850070  9.909594
2024-05-02 15:36:45 INFO     ----------------------------------------------------------------------------
2024-05-02 15:36:45 INFO     # 3, Kownledge Graph Embedding: RandomE, Experiment ids: 63
2024-05-02 15:36:45 INFO     ----------------------------------------------------------------------------
2024-05-02 15:36:45 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=60
2024-05-02 15:36:45 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 60, 'load_external': True, 'embedding_model': 'RandomE', 'normal_external': True, 'ext_scaler': 'normal', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 15:36:45 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 15:36:45 INFO     set_weight_link_or_dist: dist
2024-05-02 15:36:45 INFO     init_weight_inf_or_zero: inf
2024-05-02 15:36:45 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 15:36:45 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 15:36:45 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 15:36:45 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 15:36:48 INFO     Dataset created
2024-05-02 15:36:48 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-05-02 15:36:48 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-05-02 15:36:48 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-05-02 15:36:48 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-05-02 15:36:49 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 15:36:49 INFO     NormalScaler max: 1.0
2024-05-02 15:36:52 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 15:36:52 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 15:36:52 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-05-02 15:36:52 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 15:36:52 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-05-02 15:36:52 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 15:36:52 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 15:36:52 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 15:36:52 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 15:36:52 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 15:36:52 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 15:36:52 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 15:36:52 INFO     Total parameter numbers: 904730
2024-05-02 15:36:52 INFO     You select `adam` optimizer.
2024-05-02 15:36:52 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 15:36:52 INFO     Start training ...
2024-05-02 15:36:52 INFO     num_batches:48
2024-05-02 15:36:59 INFO     epoch complete!
2024-05-02 15:36:59 INFO     evaluating now!
2024-05-02 15:36:59 INFO     Epoch [0/200] train_loss: 25.4922, val_loss: 17.5685, lr: 0.003000, 6.55s
2024-05-02 15:36:59 INFO     Saved model at 0
2024-05-02 15:36:59 INFO     Val loss decrease from inf to 17.5685, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 15:37:05 INFO     epoch complete!
2024-05-02 15:37:05 INFO     evaluating now!
2024-05-02 15:37:06 INFO     Epoch [1/200] train_loss: 14.5152, val_loss: 13.7037, lr: 0.003000, 6.75s
2024-05-02 15:37:06 INFO     Saved model at 1
2024-05-02 15:37:06 INFO     Val loss decrease from 17.5685 to 13.7037, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 15:37:12 INFO     epoch complete!
2024-05-02 15:37:12 INFO     evaluating now!
2024-05-02 15:37:13 INFO     Epoch [2/200] train_loss: 11.1633, val_loss: 10.5455, lr: 0.003000, 6.76s
2024-05-02 15:37:13 INFO     Saved model at 2
2024-05-02 15:37:13 INFO     Val loss decrease from 13.7037 to 10.5455, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 15:37:19 INFO     epoch complete!
2024-05-02 15:37:19 INFO     evaluating now!
2024-05-02 15:37:20 INFO     Epoch [3/200] train_loss: 8.9598, val_loss: 8.4967, lr: 0.003000, 6.90s
2024-05-02 15:37:20 INFO     Saved model at 3
2024-05-02 15:37:20 INFO     Val loss decrease from 10.5455 to 8.4967, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 15:37:26 INFO     epoch complete!
2024-05-02 15:37:26 INFO     evaluating now!
2024-05-02 15:37:27 INFO     Epoch [4/200] train_loss: 7.5770, val_loss: 7.3973, lr: 0.003000, 7.15s
2024-05-02 15:37:27 INFO     Saved model at 4
2024-05-02 15:37:27 INFO     Val loss decrease from 8.4967 to 7.3973, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 15:37:34 INFO     epoch complete!
2024-05-02 15:37:34 INFO     evaluating now!
2024-05-02 15:37:35 INFO     Epoch [5/200] train_loss: 6.6946, val_loss: 6.5616, lr: 0.003000, 7.85s
2024-05-02 15:37:35 INFO     Saved model at 5
2024-05-02 15:37:35 INFO     Val loss decrease from 7.3973 to 6.5616, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 15:37:42 INFO     epoch complete!
2024-05-02 15:37:42 INFO     evaluating now!
2024-05-02 15:37:43 INFO     Epoch [6/200] train_loss: 6.2528, val_loss: 6.0996, lr: 0.003000, 8.01s
2024-05-02 15:37:43 INFO     Saved model at 6
2024-05-02 15:37:43 INFO     Val loss decrease from 6.5616 to 6.0996, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 15:37:50 INFO     epoch complete!
2024-05-02 15:37:50 INFO     evaluating now!
2024-05-02 15:37:51 INFO     Epoch [7/200] train_loss: 5.8542, val_loss: 5.8068, lr: 0.003000, 7.92s
2024-05-02 15:37:51 INFO     Saved model at 7
2024-05-02 15:37:51 INFO     Val loss decrease from 6.0996 to 5.8068, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 15:37:58 INFO     epoch complete!
2024-05-02 15:37:58 INFO     evaluating now!
2024-05-02 15:37:59 INFO     Epoch [8/200] train_loss: 5.6324, val_loss: 5.6469, lr: 0.003000, 8.00s
2024-05-02 15:37:59 INFO     Saved model at 8
2024-05-02 15:37:59 INFO     Val loss decrease from 5.8068 to 5.6469, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 15:38:06 INFO     epoch complete!
2024-05-02 15:38:06 INFO     evaluating now!
2024-05-02 15:38:07 INFO     Epoch [9/200] train_loss: 5.3879, val_loss: 5.4507, lr: 0.003000, 8.06s
2024-05-02 15:38:07 INFO     Saved model at 9
2024-05-02 15:38:07 INFO     Val loss decrease from 5.6469 to 5.4507, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 15:38:14 INFO     epoch complete!
2024-05-02 15:38:14 INFO     evaluating now!
2024-05-02 15:38:15 INFO     Epoch [10/200] train_loss: 5.2134, val_loss: 5.2773, lr: 0.003000, 8.15s
2024-05-02 15:38:15 INFO     Saved model at 10
2024-05-02 15:38:15 INFO     Val loss decrease from 5.4507 to 5.2773, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 15:38:22 INFO     epoch complete!
2024-05-02 15:38:22 INFO     evaluating now!
2024-05-02 15:38:23 INFO     Epoch [11/200] train_loss: 5.0495, val_loss: 5.2043, lr: 0.003000, 7.53s
2024-05-02 15:38:23 INFO     Saved model at 11
2024-05-02 15:38:23 INFO     Val loss decrease from 5.2773 to 5.2043, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 15:38:30 INFO     epoch complete!
2024-05-02 15:38:30 INFO     evaluating now!
2024-05-02 15:38:30 INFO     Epoch [12/200] train_loss: 5.0100, val_loss: 5.2929, lr: 0.003000, 7.45s
2024-05-02 15:38:37 INFO     epoch complete!
2024-05-02 15:38:37 INFO     evaluating now!
2024-05-02 15:38:38 INFO     Epoch [13/200] train_loss: 4.8152, val_loss: 5.1487, lr: 0.003000, 7.39s
2024-05-02 15:38:38 INFO     Saved model at 13
2024-05-02 15:38:38 INFO     Val loss decrease from 5.2043 to 5.1487, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-02 15:38:44 INFO     epoch complete!
2024-05-02 15:38:44 INFO     evaluating now!
2024-05-02 15:38:45 INFO     Epoch [14/200] train_loss: 4.7581, val_loss: 5.1088, lr: 0.003000, 7.46s
2024-05-02 15:38:45 INFO     Saved model at 14
2024-05-02 15:38:45 INFO     Val loss decrease from 5.1487 to 5.1088, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-02 15:38:52 INFO     epoch complete!
2024-05-02 15:38:52 INFO     evaluating now!
2024-05-02 15:38:52 INFO     Epoch [15/200] train_loss: 4.6842, val_loss: 5.0788, lr: 0.003000, 7.29s
2024-05-02 15:38:52 INFO     Saved model at 15
2024-05-02 15:38:52 INFO     Val loss decrease from 5.1088 to 5.0788, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-02 15:38:59 INFO     epoch complete!
2024-05-02 15:38:59 INFO     evaluating now!
2024-05-02 15:39:00 INFO     Epoch [16/200] train_loss: 4.6368, val_loss: 4.9587, lr: 0.003000, 7.46s
2024-05-02 15:39:00 INFO     Saved model at 16
2024-05-02 15:39:00 INFO     Val loss decrease from 5.0788 to 4.9587, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-02 15:39:08 INFO     epoch complete!
2024-05-02 15:39:08 INFO     evaluating now!
2024-05-02 15:39:08 INFO     Epoch [17/200] train_loss: 4.5147, val_loss: 4.9433, lr: 0.003000, 8.29s
2024-05-02 15:39:08 INFO     Saved model at 17
2024-05-02 15:39:08 INFO     Val loss decrease from 4.9587 to 4.9433, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-02 15:39:16 INFO     epoch complete!
2024-05-02 15:39:16 INFO     evaluating now!
2024-05-02 15:39:16 INFO     Epoch [18/200] train_loss: 4.4752, val_loss: 4.9296, lr: 0.003000, 7.89s
2024-05-02 15:39:16 INFO     Saved model at 18
2024-05-02 15:39:16 INFO     Val loss decrease from 4.9433 to 4.9296, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-02 15:39:24 INFO     epoch complete!
2024-05-02 15:39:24 INFO     evaluating now!
2024-05-02 15:39:24 INFO     Epoch [19/200] train_loss: 4.4001, val_loss: 4.8988, lr: 0.003000, 7.95s
2024-05-02 15:39:24 INFO     Saved model at 19
2024-05-02 15:39:24 INFO     Val loss decrease from 4.9296 to 4.8988, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-02 15:39:32 INFO     epoch complete!
2024-05-02 15:39:32 INFO     evaluating now!
2024-05-02 15:39:32 INFO     Epoch [20/200] train_loss: 4.3126, val_loss: 4.8581, lr: 0.003000, 8.14s
2024-05-02 15:39:32 INFO     Saved model at 20
2024-05-02 15:39:32 INFO     Val loss decrease from 4.8988 to 4.8581, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-02 15:39:40 INFO     epoch complete!
2024-05-02 15:39:40 INFO     evaluating now!
2024-05-02 15:39:41 INFO     Epoch [21/200] train_loss: 4.2701, val_loss: 4.8494, lr: 0.003000, 8.11s
2024-05-02 15:39:41 INFO     Saved model at 21
2024-05-02 15:39:41 INFO     Val loss decrease from 4.8581 to 4.8494, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-02 15:39:48 INFO     epoch complete!
2024-05-02 15:39:48 INFO     evaluating now!
2024-05-02 15:39:49 INFO     Epoch [22/200] train_loss: 4.2024, val_loss: 4.8958, lr: 0.003000, 8.02s
2024-05-02 15:39:56 INFO     epoch complete!
2024-05-02 15:39:56 INFO     evaluating now!
2024-05-02 15:39:56 INFO     Epoch [23/200] train_loss: 4.1255, val_loss: 4.8446, lr: 0.003000, 7.89s
2024-05-02 15:39:57 INFO     Saved model at 23
2024-05-02 15:39:57 INFO     Val loss decrease from 4.8494 to 4.8446, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-05-02 15:40:04 INFO     epoch complete!
2024-05-02 15:40:04 INFO     evaluating now!
2024-05-02 15:40:05 INFO     Epoch [24/200] train_loss: 4.1267, val_loss: 4.7248, lr: 0.003000, 8.44s
2024-05-02 15:40:05 INFO     Saved model at 24
2024-05-02 15:40:05 INFO     Val loss decrease from 4.8446 to 4.7248, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-02 15:40:13 INFO     epoch complete!
2024-05-02 15:40:13 INFO     evaluating now!
2024-05-02 15:40:13 INFO     Epoch [25/200] train_loss: 4.0343, val_loss: 4.8295, lr: 0.003000, 8.44s
2024-05-02 15:40:21 INFO     epoch complete!
2024-05-02 15:40:21 INFO     evaluating now!
2024-05-02 15:40:21 INFO     Epoch [26/200] train_loss: 3.9932, val_loss: 4.7508, lr: 0.003000, 7.70s
2024-05-02 15:40:28 INFO     epoch complete!
2024-05-02 15:40:28 INFO     evaluating now!
2024-05-02 15:40:29 INFO     Epoch [27/200] train_loss: 3.9932, val_loss: 4.7743, lr: 0.003000, 7.34s
2024-05-02 15:40:35 INFO     epoch complete!
2024-05-02 15:40:35 INFO     evaluating now!
2024-05-02 15:40:36 INFO     Epoch [28/200] train_loss: 3.9661, val_loss: 4.6149, lr: 0.003000, 7.37s
2024-05-02 15:40:36 INFO     Saved model at 28
2024-05-02 15:40:36 INFO     Val loss decrease from 4.7248 to 4.6149, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-05-02 15:40:43 INFO     epoch complete!
2024-05-02 15:40:43 INFO     evaluating now!
2024-05-02 15:40:44 INFO     Epoch [29/200] train_loss: 3.9197, val_loss: 4.7056, lr: 0.003000, 8.12s
2024-05-02 15:40:51 INFO     epoch complete!
2024-05-02 15:40:51 INFO     evaluating now!
2024-05-02 15:40:52 INFO     Epoch [30/200] train_loss: 3.8529, val_loss: 4.7931, lr: 0.003000, 8.00s
2024-05-02 15:40:59 INFO     epoch complete!
2024-05-02 15:40:59 INFO     evaluating now!
2024-05-02 15:41:00 INFO     Epoch [31/200] train_loss: 3.8709, val_loss: 4.8125, lr: 0.003000, 7.87s
2024-05-02 15:41:07 INFO     epoch complete!
2024-05-02 15:41:07 INFO     evaluating now!
2024-05-02 15:41:08 INFO     Epoch [32/200] train_loss: 3.8562, val_loss: 4.8222, lr: 0.003000, 7.93s
2024-05-02 15:41:15 INFO     epoch complete!
2024-05-02 15:41:15 INFO     evaluating now!
2024-05-02 15:41:16 INFO     Epoch [33/200] train_loss: 3.8082, val_loss: 4.6763, lr: 0.003000, 7.82s
2024-05-02 15:41:23 INFO     epoch complete!
2024-05-02 15:41:23 INFO     evaluating now!
2024-05-02 15:41:24 INFO     Epoch [34/200] train_loss: 3.7344, val_loss: 4.7271, lr: 0.003000, 7.85s
2024-05-02 15:41:31 INFO     epoch complete!
2024-05-02 15:41:31 INFO     evaluating now!
2024-05-02 15:41:31 INFO     Epoch [35/200] train_loss: 3.7115, val_loss: 4.7765, lr: 0.003000, 7.80s
2024-05-02 15:41:39 INFO     epoch complete!
2024-05-02 15:41:39 INFO     evaluating now!
2024-05-02 15:41:39 INFO     Epoch [36/200] train_loss: 3.7326, val_loss: 4.7416, lr: 0.003000, 7.96s
2024-05-02 15:41:47 INFO     epoch complete!
2024-05-02 15:41:47 INFO     evaluating now!
2024-05-02 15:41:47 INFO     Epoch [37/200] train_loss: 3.6743, val_loss: 4.8276, lr: 0.003000, 7.77s
2024-05-02 15:41:54 INFO     epoch complete!
2024-05-02 15:41:54 INFO     evaluating now!
2024-05-02 15:41:55 INFO     Epoch [38/200] train_loss: 3.6730, val_loss: 4.8598, lr: 0.003000, 7.98s
2024-05-02 15:42:02 INFO     epoch complete!
2024-05-02 15:42:02 INFO     evaluating now!
2024-05-02 15:42:03 INFO     Epoch [39/200] train_loss: 3.6421, val_loss: 4.8154, lr: 0.003000, 7.84s
2024-05-02 15:42:10 INFO     epoch complete!
2024-05-02 15:42:10 INFO     evaluating now!
2024-05-02 15:42:11 INFO     Epoch [40/200] train_loss: 3.5978, val_loss: 4.6636, lr: 0.003000, 7.97s
2024-05-02 15:42:18 INFO     epoch complete!
2024-05-02 15:42:18 INFO     evaluating now!
2024-05-02 15:42:19 INFO     Epoch [41/200] train_loss: 3.5535, val_loss: 4.7095, lr: 0.003000, 7.81s
2024-05-02 15:42:26 INFO     epoch complete!
2024-05-02 15:42:26 INFO     evaluating now!
2024-05-02 15:42:27 INFO     Epoch [42/200] train_loss: 3.5692, val_loss: 4.7486, lr: 0.003000, 8.15s
2024-05-02 15:42:35 INFO     epoch complete!
2024-05-02 15:42:35 INFO     evaluating now!
2024-05-02 15:42:35 INFO     Epoch [43/200] train_loss: 3.5619, val_loss: 4.7672, lr: 0.003000, 8.55s
2024-05-02 15:42:35 WARNING  Early stopping at epoch: 43
2024-05-02 15:42:35 INFO     Trained totally 44 epochs, average train time is 7.212s, average eval time is 0.552s
2024-05-02 15:42:35 INFO     Loaded model at 28
2024-05-02 15:42:35 INFO     Saved model at ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 15:42:36 INFO     Start evaluating ...
2024-05-02 15:42:37 INFO     Note that you select the single mode to evaluate!
2024-05-02 15:42:37 INFO     Evaluate result is saved at ./libcity/cache/60/evaluate_cache/2024_05_02_15_42_37_AGCRN_CHITaxi20190406.csv
2024-05-02 15:42:37 INFO     
         MAE       RMSE
1   2.372257   7.292675
2   2.424832   7.822574
3   2.572602   8.573607
4   2.649443   8.959263
5   2.696799   9.255016
6   2.691386   9.461197
7   2.757334   9.650053
8   2.801537   9.821440
9   2.838321   9.940520
10  2.852914   9.995447
11  2.950404  10.309321
12  2.990326  10.685179
2024-05-02 15:42:37 INFO     ----------------------------------------------------------------------------
2024-05-02 15:42:37 INFO     # 4, Kownledge Graph Embedding: RandomE, Experiment ids: 64
2024-05-02 15:42:37 INFO     ----------------------------------------------------------------------------
2024-05-02 15:42:37 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=60
2024-05-02 15:42:37 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 60, 'load_external': True, 'embedding_model': 'RandomE', 'normal_external': True, 'ext_scaler': 'normal', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 15:42:38 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 15:42:38 INFO     set_weight_link_or_dist: dist
2024-05-02 15:42:38 INFO     init_weight_inf_or_zero: inf
2024-05-02 15:42:38 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 15:42:38 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 15:42:38 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 15:42:38 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 15:42:41 INFO     Dataset created
2024-05-02 15:42:41 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-05-02 15:42:41 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-05-02 15:42:41 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-05-02 15:42:41 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-05-02 15:42:42 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 15:42:42 INFO     NormalScaler max: 1.0
2024-05-02 15:42:46 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 15:42:46 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 15:42:46 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-05-02 15:42:46 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 15:42:46 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-05-02 15:42:46 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 15:42:46 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 15:42:46 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 15:42:46 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 15:42:46 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 15:42:46 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 15:42:46 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 15:42:46 INFO     Total parameter numbers: 904730
2024-05-02 15:42:46 INFO     You select `adam` optimizer.
2024-05-02 15:42:46 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 15:42:46 INFO     Start training ...
2024-05-02 15:42:46 INFO     num_batches:48
2024-05-02 15:42:53 INFO     epoch complete!
2024-05-02 15:42:53 INFO     evaluating now!
2024-05-02 15:42:54 INFO     Epoch [0/200] train_loss: 25.0803, val_loss: 17.4253, lr: 0.003000, 7.96s
2024-05-02 15:42:54 INFO     Saved model at 0
2024-05-02 15:42:54 INFO     Val loss decrease from inf to 17.4253, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 15:43:01 INFO     epoch complete!
2024-05-02 15:43:01 INFO     evaluating now!
2024-05-02 15:43:02 INFO     Epoch [1/200] train_loss: 14.2968, val_loss: 13.6719, lr: 0.003000, 7.91s
2024-05-02 15:43:02 INFO     Saved model at 1
2024-05-02 15:43:02 INFO     Val loss decrease from 17.4253 to 13.6719, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 15:43:09 INFO     epoch complete!
2024-05-02 15:43:09 INFO     evaluating now!
2024-05-02 15:43:10 INFO     Epoch [2/200] train_loss: 10.8067, val_loss: 10.0215, lr: 0.003000, 8.03s
2024-05-02 15:43:10 INFO     Saved model at 2
2024-05-02 15:43:10 INFO     Val loss decrease from 13.6719 to 10.0215, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 15:43:17 INFO     epoch complete!
2024-05-02 15:43:17 INFO     evaluating now!
2024-05-02 15:43:18 INFO     Epoch [3/200] train_loss: 8.5233, val_loss: 7.9682, lr: 0.003000, 7.85s
2024-05-02 15:43:18 INFO     Saved model at 3
2024-05-02 15:43:18 INFO     Val loss decrease from 10.0215 to 7.9682, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 15:43:25 INFO     epoch complete!
2024-05-02 15:43:25 INFO     evaluating now!
2024-05-02 15:43:26 INFO     Epoch [4/200] train_loss: 7.2531, val_loss: 6.8524, lr: 0.003000, 7.82s
2024-05-02 15:43:26 INFO     Saved model at 4
2024-05-02 15:43:26 INFO     Val loss decrease from 7.9682 to 6.8524, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 15:43:33 INFO     epoch complete!
2024-05-02 15:43:33 INFO     evaluating now!
2024-05-02 15:43:34 INFO     Epoch [5/200] train_loss: 6.4506, val_loss: 6.3616, lr: 0.003000, 7.92s
2024-05-02 15:43:34 INFO     Saved model at 5
2024-05-02 15:43:34 INFO     Val loss decrease from 6.8524 to 6.3616, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 15:43:41 INFO     epoch complete!
2024-05-02 15:43:41 INFO     evaluating now!
2024-05-02 15:43:42 INFO     Epoch [6/200] train_loss: 6.0952, val_loss: 6.0824, lr: 0.003000, 7.94s
2024-05-02 15:43:42 INFO     Saved model at 6
2024-05-02 15:43:42 INFO     Val loss decrease from 6.3616 to 6.0824, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 15:43:49 INFO     epoch complete!
2024-05-02 15:43:49 INFO     evaluating now!
2024-05-02 15:43:50 INFO     Epoch [7/200] train_loss: 5.7859, val_loss: 5.7951, lr: 0.003000, 7.93s
2024-05-02 15:43:50 INFO     Saved model at 7
2024-05-02 15:43:50 INFO     Val loss decrease from 6.0824 to 5.7951, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 15:43:57 INFO     epoch complete!
2024-05-02 15:43:57 INFO     evaluating now!
2024-05-02 15:43:57 INFO     Epoch [8/200] train_loss: 5.5557, val_loss: 5.5809, lr: 0.003000, 7.50s
2024-05-02 15:43:57 INFO     Saved model at 8
2024-05-02 15:43:57 INFO     Val loss decrease from 5.7951 to 5.5809, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 15:44:04 INFO     epoch complete!
2024-05-02 15:44:04 INFO     evaluating now!
2024-05-02 15:44:04 INFO     Epoch [9/200] train_loss: 5.3723, val_loss: 5.4419, lr: 0.003000, 7.37s
2024-05-02 15:44:05 INFO     Saved model at 9
2024-05-02 15:44:05 INFO     Val loss decrease from 5.5809 to 5.4419, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 15:44:11 INFO     epoch complete!
2024-05-02 15:44:11 INFO     evaluating now!
2024-05-02 15:44:12 INFO     Epoch [10/200] train_loss: 5.1978, val_loss: 5.2904, lr: 0.003000, 7.41s
2024-05-02 15:44:12 INFO     Saved model at 10
2024-05-02 15:44:12 INFO     Val loss decrease from 5.4419 to 5.2904, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 15:44:19 INFO     epoch complete!
2024-05-02 15:44:19 INFO     evaluating now!
2024-05-02 15:44:19 INFO     Epoch [11/200] train_loss: 5.0532, val_loss: 5.1594, lr: 0.003000, 7.32s
2024-05-02 15:44:19 INFO     Saved model at 11
2024-05-02 15:44:19 INFO     Val loss decrease from 5.2904 to 5.1594, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 15:44:26 INFO     epoch complete!
2024-05-02 15:44:26 INFO     evaluating now!
2024-05-02 15:44:27 INFO     Epoch [12/200] train_loss: 4.9113, val_loss: 5.1195, lr: 0.003000, 7.46s
2024-05-02 15:44:27 INFO     Saved model at 12
2024-05-02 15:44:27 INFO     Val loss decrease from 5.1594 to 5.1195, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 15:44:34 INFO     epoch complete!
2024-05-02 15:44:34 INFO     evaluating now!
2024-05-02 15:44:35 INFO     Epoch [13/200] train_loss: 4.7880, val_loss: 5.0235, lr: 0.003000, 7.93s
2024-05-02 15:44:35 INFO     Saved model at 13
2024-05-02 15:44:35 INFO     Val loss decrease from 5.1195 to 5.0235, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-02 15:44:42 INFO     epoch complete!
2024-05-02 15:44:42 INFO     evaluating now!
2024-05-02 15:44:43 INFO     Epoch [14/200] train_loss: 4.6885, val_loss: 5.0995, lr: 0.003000, 8.04s
2024-05-02 15:44:50 INFO     epoch complete!
2024-05-02 15:44:50 INFO     evaluating now!
2024-05-02 15:44:51 INFO     Epoch [15/200] train_loss: 4.6035, val_loss: 4.9754, lr: 0.003000, 7.78s
2024-05-02 15:44:51 INFO     Saved model at 15
2024-05-02 15:44:51 INFO     Val loss decrease from 5.0235 to 4.9754, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-02 15:44:58 INFO     epoch complete!
2024-05-02 15:44:58 INFO     evaluating now!
2024-05-02 15:44:59 INFO     Epoch [16/200] train_loss: 4.5177, val_loss: 4.8725, lr: 0.003000, 7.83s
2024-05-02 15:44:59 INFO     Saved model at 16
2024-05-02 15:44:59 INFO     Val loss decrease from 4.9754 to 4.8725, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-02 15:45:06 INFO     epoch complete!
2024-05-02 15:45:06 INFO     evaluating now!
2024-05-02 15:45:06 INFO     Epoch [17/200] train_loss: 4.4201, val_loss: 4.8888, lr: 0.003000, 7.80s
2024-05-02 15:45:14 INFO     epoch complete!
2024-05-02 15:45:14 INFO     evaluating now!
2024-05-02 15:45:14 INFO     Epoch [18/200] train_loss: 4.3565, val_loss: 4.7945, lr: 0.003000, 7.78s
2024-05-02 15:45:14 INFO     Saved model at 18
2024-05-02 15:45:14 INFO     Val loss decrease from 4.8725 to 4.7945, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-02 15:45:21 INFO     epoch complete!
2024-05-02 15:45:21 INFO     evaluating now!
2024-05-02 15:45:22 INFO     Epoch [19/200] train_loss: 4.3127, val_loss: 4.7754, lr: 0.003000, 7.74s
2024-05-02 15:45:22 INFO     Saved model at 19
2024-05-02 15:45:22 INFO     Val loss decrease from 4.7945 to 4.7754, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-02 15:45:29 INFO     epoch complete!
2024-05-02 15:45:29 INFO     evaluating now!
2024-05-02 15:45:30 INFO     Epoch [20/200] train_loss: 4.2549, val_loss: 4.8491, lr: 0.003000, 7.93s
2024-05-02 15:45:38 INFO     epoch complete!
2024-05-02 15:45:38 INFO     evaluating now!
2024-05-02 15:45:38 INFO     Epoch [21/200] train_loss: 4.2148, val_loss: 4.7979, lr: 0.003000, 8.17s
2024-05-02 15:45:46 INFO     epoch complete!
2024-05-02 15:45:46 INFO     evaluating now!
2024-05-02 15:45:46 INFO     Epoch [22/200] train_loss: 4.1594, val_loss: 4.7643, lr: 0.003000, 7.99s
2024-05-02 15:45:46 INFO     Saved model at 22
2024-05-02 15:45:46 INFO     Val loss decrease from 4.7754 to 4.7643, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-02 15:45:53 INFO     epoch complete!
2024-05-02 15:45:53 INFO     evaluating now!
2024-05-02 15:45:54 INFO     Epoch [23/200] train_loss: 4.1092, val_loss: 4.8004, lr: 0.003000, 7.85s
2024-05-02 15:46:01 INFO     epoch complete!
2024-05-02 15:46:01 INFO     evaluating now!
2024-05-02 15:46:02 INFO     Epoch [24/200] train_loss: 4.0654, val_loss: 4.8247, lr: 0.003000, 7.84s
2024-05-02 15:46:09 INFO     epoch complete!
2024-05-02 15:46:09 INFO     evaluating now!
2024-05-02 15:46:10 INFO     Epoch [25/200] train_loss: 4.0276, val_loss: 4.7897, lr: 0.003000, 8.03s
2024-05-02 15:46:17 INFO     epoch complete!
2024-05-02 15:46:17 INFO     evaluating now!
2024-05-02 15:46:18 INFO     Epoch [26/200] train_loss: 3.9932, val_loss: 5.1253, lr: 0.003000, 7.73s
2024-05-02 15:46:25 INFO     epoch complete!
2024-05-02 15:46:25 INFO     evaluating now!
2024-05-02 15:46:25 INFO     Epoch [27/200] train_loss: 4.0562, val_loss: 4.8509, lr: 0.003000, 7.80s
2024-05-02 15:46:33 INFO     epoch complete!
2024-05-02 15:46:33 INFO     evaluating now!
2024-05-02 15:46:33 INFO     Epoch [28/200] train_loss: 3.9010, val_loss: 4.6889, lr: 0.003000, 8.01s
2024-05-02 15:46:33 INFO     Saved model at 28
2024-05-02 15:46:33 INFO     Val loss decrease from 4.7643 to 4.6889, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-05-02 15:46:41 INFO     epoch complete!
2024-05-02 15:46:41 INFO     evaluating now!
2024-05-02 15:46:41 INFO     Epoch [29/200] train_loss: 3.8726, val_loss: 4.8346, lr: 0.003000, 7.88s
2024-05-02 15:46:49 INFO     epoch complete!
2024-05-02 15:46:49 INFO     evaluating now!
2024-05-02 15:46:49 INFO     Epoch [30/200] train_loss: 3.9142, val_loss: 4.7440, lr: 0.003000, 7.90s
2024-05-02 15:46:56 INFO     epoch complete!
2024-05-02 15:46:57 INFO     evaluating now!
2024-05-02 15:46:57 INFO     Epoch [31/200] train_loss: 3.8391, val_loss: 4.7329, lr: 0.003000, 7.81s
2024-05-02 15:47:04 INFO     epoch complete!
2024-05-02 15:47:04 INFO     evaluating now!
2024-05-02 15:47:05 INFO     Epoch [32/200] train_loss: 3.7910, val_loss: 4.9370, lr: 0.003000, 7.75s
2024-05-02 15:47:12 INFO     epoch complete!
2024-05-02 15:47:12 INFO     evaluating now!
2024-05-02 15:47:13 INFO     Epoch [33/200] train_loss: 3.7686, val_loss: 4.7738, lr: 0.003000, 7.77s
2024-05-02 15:47:20 INFO     epoch complete!
2024-05-02 15:47:20 INFO     evaluating now!
2024-05-02 15:47:20 INFO     Epoch [34/200] train_loss: 3.7633, val_loss: 4.7186, lr: 0.003000, 7.85s
2024-05-02 15:47:28 INFO     epoch complete!
2024-05-02 15:47:28 INFO     evaluating now!
2024-05-02 15:47:28 INFO     Epoch [35/200] train_loss: 3.7061, val_loss: 4.8214, lr: 0.003000, 7.85s
2024-05-02 15:47:36 INFO     epoch complete!
2024-05-02 15:47:36 INFO     evaluating now!
2024-05-02 15:47:36 INFO     Epoch [36/200] train_loss: 3.6707, val_loss: 4.7856, lr: 0.003000, 7.89s
2024-05-02 15:47:43 INFO     epoch complete!
2024-05-02 15:47:43 INFO     evaluating now!
2024-05-02 15:47:44 INFO     Epoch [37/200] train_loss: 3.6554, val_loss: 4.8769, lr: 0.003000, 7.77s
2024-05-02 15:47:51 INFO     epoch complete!
2024-05-02 15:47:51 INFO     evaluating now!
2024-05-02 15:47:52 INFO     Epoch [38/200] train_loss: 3.6380, val_loss: 4.7323, lr: 0.003000, 7.75s
2024-05-02 15:47:59 INFO     epoch complete!
2024-05-02 15:47:59 INFO     evaluating now!
2024-05-02 15:48:00 INFO     Epoch [39/200] train_loss: 3.6059, val_loss: 4.7777, lr: 0.003000, 7.81s
2024-05-02 15:48:07 INFO     epoch complete!
2024-05-02 15:48:07 INFO     evaluating now!
2024-05-02 15:48:07 INFO     Epoch [40/200] train_loss: 3.6000, val_loss: 4.8247, lr: 0.003000, 7.85s
2024-05-02 15:48:15 INFO     epoch complete!
2024-05-02 15:48:15 INFO     evaluating now!
2024-05-02 15:48:16 INFO     Epoch [41/200] train_loss: 3.5755, val_loss: 4.7677, lr: 0.003000, 8.15s
2024-05-02 15:48:23 INFO     epoch complete!
2024-05-02 15:48:23 INFO     evaluating now!
2024-05-02 15:48:24 INFO     Epoch [42/200] train_loss: 3.5604, val_loss: 4.8129, lr: 0.003000, 8.21s
2024-05-02 15:48:31 INFO     epoch complete!
2024-05-02 15:48:31 INFO     evaluating now!
2024-05-02 15:48:32 INFO     Epoch [43/200] train_loss: 3.5378, val_loss: 4.7373, lr: 0.003000, 8.02s
2024-05-02 15:48:32 WARNING  Early stopping at epoch: 43
2024-05-02 15:48:32 INFO     Trained totally 44 epochs, average train time is 7.265s, average eval time is 0.572s
2024-05-02 15:48:32 INFO     Loaded model at 28
2024-05-02 15:48:32 INFO     Saved model at ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 15:48:32 INFO     Start evaluating ...
2024-05-02 15:48:34 INFO     Note that you select the single mode to evaluate!
2024-05-02 15:48:34 INFO     Evaluate result is saved at ./libcity/cache/60/evaluate_cache/2024_05_02_15_48_34_AGCRN_CHITaxi20190406.csv
2024-05-02 15:48:34 INFO     
         MAE       RMSE
1   2.315173   7.402531
2   2.339681   7.710884
3   2.514125   8.449123
4   2.568288   8.733598
5   2.667572   8.993108
6   2.702471   9.184765
7   2.710530   9.428457
8   2.813900   9.664587
9   2.786126   9.719779
10  2.834574   9.714463
11  2.828596   9.825343
12  2.950759  10.171091
2024-05-02 15:48:34 INFO     ----------------------------------------------------------------------------
2024-05-02 15:48:34 INFO     Kownledge Graph Embedding: RandomE, Experiment ids: [60, 61, 62, 63, 64]
2024-05-02 15:48:34 INFO     ----------------------------------------------------------------------------
2024-05-02 15:48:34 INFO     Average: 
         MAE       RMSE
0   2.328872   7.176283
1   2.401869   7.642511
2   2.529038   8.395500
3   2.604807   8.766978
4   2.668503   9.042264
5   2.692556   9.176059
6   2.707178   9.355986
7   2.740713   9.498716
8   2.756514   9.573192
9   2.787878   9.621937
10  2.822134   9.795030
11  2.897168  10.165305 
2024-05-02 15:48:34 INFO     Standard deviation: 
         MAE      RMSE
0   0.060442  0.174509
1   0.053194  0.166951
2   0.039845  0.139183
3   0.061969  0.131092
4   0.053177  0.149045
5   0.056018  0.176083
6   0.050834  0.186851
7   0.068346  0.223517
8   0.063266  0.244077
9   0.065443  0.233621
10  0.078400  0.284889
11  0.078031  0.273551
2024-05-02 15:48:34 INFO     ----------------------------------------------------------------------------
2024-05-02 15:48:34 INFO     12 steps Average: 
        MAE     RMSE
0  2.661436  9.01748
2024-05-02 15:48:34 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.060747  0.198614
