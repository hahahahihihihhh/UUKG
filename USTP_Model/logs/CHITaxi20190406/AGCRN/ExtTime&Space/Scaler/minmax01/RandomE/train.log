2024-05-02 21:57:02 INFO     Saving logs in: ./logs/CHITaxi20190406/AGCRN/ExtTime&Space/Scaler/minmax01/RandomE
2024-05-02 21:57:03 INFO     ----------------------------------------------------------------------------
2024-05-02 21:57:03 INFO     # 0, Kownledge Graph Embedding: RandomE, Experiment ids: 60
2024-05-02 21:57:03 INFO     ----------------------------------------------------------------------------
2024-05-02 21:57:03 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=60
2024-05-02 21:57:03 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 60, 'load_external': True, 'embedding_model': 'RandomE', 'normal_external': True, 'ext_scaler': 'minmax01', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 21:57:03 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 21:57:03 INFO     set_weight_link_or_dist: dist
2024-05-02 21:57:03 INFO     init_weight_inf_or_zero: inf
2024-05-02 21:57:03 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 21:57:03 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 21:57:03 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 21:57:03 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 21:57:07 INFO     Dataset created
2024-05-02 21:57:07 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-05-02 21:57:07 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-05-02 21:57:07 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-05-02 21:57:07 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-05-02 21:57:07 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 21:57:07 INFO     MinMax01Scaler max: 1.0, min: -0.0038399640234991045
2024-05-02 21:57:14 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 21:57:14 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 21:57:14 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-05-02 21:57:14 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 21:57:14 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-05-02 21:57:14 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 21:57:14 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 21:57:14 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 21:57:14 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 21:57:14 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 21:57:14 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 21:57:14 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 21:57:14 INFO     Total parameter numbers: 904730
2024-05-02 21:57:14 INFO     You select `adam` optimizer.
2024-05-02 21:57:14 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 21:57:14 INFO     Start training ...
2024-05-02 21:57:14 INFO     num_batches:48
2024-05-02 21:57:21 INFO     epoch complete!
2024-05-02 21:57:21 INFO     evaluating now!
2024-05-02 21:57:22 INFO     Epoch [0/200] train_loss: 24.1218, val_loss: 17.1021, lr: 0.003000, 8.02s
2024-05-02 21:57:22 INFO     Saved model at 0
2024-05-02 21:57:22 INFO     Val loss decrease from inf to 17.1021, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 21:57:28 INFO     epoch complete!
2024-05-02 21:57:28 INFO     evaluating now!
2024-05-02 21:57:29 INFO     Epoch [1/200] train_loss: 13.3616, val_loss: 12.3208, lr: 0.003000, 6.92s
2024-05-02 21:57:29 INFO     Saved model at 1
2024-05-02 21:57:29 INFO     Val loss decrease from 17.1021 to 12.3208, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 21:57:35 INFO     epoch complete!
2024-05-02 21:57:35 INFO     evaluating now!
2024-05-02 21:57:36 INFO     Epoch [2/200] train_loss: 9.8854, val_loss: 9.1357, lr: 0.003000, 6.81s
2024-05-02 21:57:36 INFO     Saved model at 2
2024-05-02 21:57:36 INFO     Val loss decrease from 12.3208 to 9.1357, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 21:57:43 INFO     epoch complete!
2024-05-02 21:57:43 INFO     evaluating now!
2024-05-02 21:57:43 INFO     Epoch [3/200] train_loss: 7.9604, val_loss: 7.5576, lr: 0.003000, 7.32s
2024-05-02 21:57:43 INFO     Saved model at 3
2024-05-02 21:57:43 INFO     Val loss decrease from 9.1357 to 7.5576, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 21:57:50 INFO     epoch complete!
2024-05-02 21:57:50 INFO     evaluating now!
2024-05-02 21:57:50 INFO     Epoch [4/200] train_loss: 6.8579, val_loss: 6.6827, lr: 0.003000, 7.08s
2024-05-02 21:57:50 INFO     Saved model at 4
2024-05-02 21:57:50 INFO     Val loss decrease from 7.5576 to 6.6827, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 21:57:57 INFO     epoch complete!
2024-05-02 21:57:57 INFO     evaluating now!
2024-05-02 21:57:57 INFO     Epoch [5/200] train_loss: 6.2514, val_loss: 6.1754, lr: 0.003000, 7.04s
2024-05-02 21:57:57 INFO     Saved model at 5
2024-05-02 21:57:57 INFO     Val loss decrease from 6.6827 to 6.1754, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 21:58:04 INFO     epoch complete!
2024-05-02 21:58:04 INFO     evaluating now!
2024-05-02 21:58:05 INFO     Epoch [6/200] train_loss: 5.8163, val_loss: 5.7895, lr: 0.003000, 7.44s
2024-05-02 21:58:05 INFO     Saved model at 6
2024-05-02 21:58:05 INFO     Val loss decrease from 6.1754 to 5.7895, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 21:58:11 INFO     epoch complete!
2024-05-02 21:58:11 INFO     evaluating now!
2024-05-02 21:58:12 INFO     Epoch [7/200] train_loss: 5.5981, val_loss: 5.5022, lr: 0.003000, 6.94s
2024-05-02 21:58:12 INFO     Saved model at 7
2024-05-02 21:58:12 INFO     Val loss decrease from 5.7895 to 5.5022, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 21:58:19 INFO     epoch complete!
2024-05-02 21:58:19 INFO     evaluating now!
2024-05-02 21:58:20 INFO     Epoch [8/200] train_loss: 5.4135, val_loss: 5.4488, lr: 0.003000, 7.92s
2024-05-02 21:58:20 INFO     Saved model at 8
2024-05-02 21:58:20 INFO     Val loss decrease from 5.5022 to 5.4488, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 21:58:27 INFO     epoch complete!
2024-05-02 21:58:27 INFO     evaluating now!
2024-05-02 21:58:28 INFO     Epoch [9/200] train_loss: 5.2059, val_loss: 5.3941, lr: 0.003000, 7.68s
2024-05-02 21:58:28 INFO     Saved model at 9
2024-05-02 21:58:28 INFO     Val loss decrease from 5.4488 to 5.3941, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 21:58:35 INFO     epoch complete!
2024-05-02 21:58:35 INFO     evaluating now!
2024-05-02 21:58:35 INFO     Epoch [10/200] train_loss: 5.0260, val_loss: 5.2125, lr: 0.003000, 7.68s
2024-05-02 21:58:35 INFO     Saved model at 10
2024-05-02 21:58:35 INFO     Val loss decrease from 5.3941 to 5.2125, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 21:58:42 INFO     epoch complete!
2024-05-02 21:58:42 INFO     evaluating now!
2024-05-02 21:58:43 INFO     Epoch [11/200] train_loss: 4.8915, val_loss: 5.1390, lr: 0.003000, 7.63s
2024-05-02 21:58:43 INFO     Saved model at 11
2024-05-02 21:58:43 INFO     Val loss decrease from 5.2125 to 5.1390, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 21:58:50 INFO     epoch complete!
2024-05-02 21:58:50 INFO     evaluating now!
2024-05-02 21:58:51 INFO     Epoch [12/200] train_loss: 4.7393, val_loss: 5.1407, lr: 0.003000, 7.59s
2024-05-02 21:58:57 INFO     epoch complete!
2024-05-02 21:58:57 INFO     evaluating now!
2024-05-02 21:58:58 INFO     Epoch [13/200] train_loss: 4.7103, val_loss: 5.2912, lr: 0.003000, 7.17s
2024-05-02 21:59:04 INFO     epoch complete!
2024-05-02 21:59:04 INFO     evaluating now!
2024-05-02 21:59:05 INFO     Epoch [14/200] train_loss: 4.6197, val_loss: 5.0637, lr: 0.003000, 7.06s
2024-05-02 21:59:05 INFO     Saved model at 14
2024-05-02 21:59:05 INFO     Val loss decrease from 5.1390 to 5.0637, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-02 21:59:12 INFO     epoch complete!
2024-05-02 21:59:12 INFO     evaluating now!
2024-05-02 21:59:12 INFO     Epoch [15/200] train_loss: 4.5155, val_loss: 4.9604, lr: 0.003000, 7.23s
2024-05-02 21:59:12 INFO     Saved model at 15
2024-05-02 21:59:12 INFO     Val loss decrease from 5.0637 to 4.9604, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-02 21:59:19 INFO     epoch complete!
2024-05-02 21:59:19 INFO     evaluating now!
2024-05-02 21:59:19 INFO     Epoch [16/200] train_loss: 4.4851, val_loss: 4.8593, lr: 0.003000, 7.00s
2024-05-02 21:59:19 INFO     Saved model at 16
2024-05-02 21:59:19 INFO     Val loss decrease from 4.9604 to 4.8593, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-02 21:59:26 INFO     epoch complete!
2024-05-02 21:59:26 INFO     evaluating now!
2024-05-02 21:59:26 INFO     Epoch [17/200] train_loss: 4.3549, val_loss: 4.8918, lr: 0.003000, 7.23s
2024-05-02 21:59:34 INFO     epoch complete!
2024-05-02 21:59:34 INFO     evaluating now!
2024-05-02 21:59:34 INFO     Epoch [18/200] train_loss: 4.3450, val_loss: 4.9856, lr: 0.003000, 7.85s
2024-05-02 21:59:41 INFO     epoch complete!
2024-05-02 21:59:41 INFO     evaluating now!
2024-05-02 21:59:42 INFO     Epoch [19/200] train_loss: 4.2719, val_loss: 4.9121, lr: 0.003000, 7.54s
2024-05-02 21:59:49 INFO     epoch complete!
2024-05-02 21:59:49 INFO     evaluating now!
2024-05-02 21:59:49 INFO     Epoch [20/200] train_loss: 4.1992, val_loss: 4.7511, lr: 0.003000, 7.56s
2024-05-02 21:59:49 INFO     Saved model at 20
2024-05-02 21:59:49 INFO     Val loss decrease from 4.8593 to 4.7511, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-02 21:59:56 INFO     epoch complete!
2024-05-02 21:59:56 INFO     evaluating now!
2024-05-02 21:59:57 INFO     Epoch [21/200] train_loss: 4.0999, val_loss: 4.7759, lr: 0.003000, 7.46s
2024-05-02 22:00:04 INFO     epoch complete!
2024-05-02 22:00:04 INFO     evaluating now!
2024-05-02 22:00:05 INFO     Epoch [22/200] train_loss: 4.1480, val_loss: 4.7539, lr: 0.003000, 7.67s
2024-05-02 22:00:12 INFO     epoch complete!
2024-05-02 22:00:12 INFO     evaluating now!
2024-05-02 22:00:12 INFO     Epoch [23/200] train_loss: 4.0771, val_loss: 4.7466, lr: 0.003000, 7.62s
2024-05-02 22:00:12 INFO     Saved model at 23
2024-05-02 22:00:12 INFO     Val loss decrease from 4.7511 to 4.7466, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-05-02 22:00:19 INFO     epoch complete!
2024-05-02 22:00:19 INFO     evaluating now!
2024-05-02 22:00:20 INFO     Epoch [24/200] train_loss: 4.0643, val_loss: 4.7838, lr: 0.003000, 7.70s
2024-05-02 22:00:27 INFO     epoch complete!
2024-05-02 22:00:27 INFO     evaluating now!
2024-05-02 22:00:28 INFO     Epoch [25/200] train_loss: 4.0183, val_loss: 4.7089, lr: 0.003000, 7.91s
2024-05-02 22:00:28 INFO     Saved model at 25
2024-05-02 22:00:28 INFO     Val loss decrease from 4.7466 to 4.7089, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-02 22:00:35 INFO     epoch complete!
2024-05-02 22:00:35 INFO     evaluating now!
2024-05-02 22:00:36 INFO     Epoch [26/200] train_loss: 3.9179, val_loss: 4.9875, lr: 0.003000, 7.71s
2024-05-02 22:00:43 INFO     epoch complete!
2024-05-02 22:00:43 INFO     evaluating now!
2024-05-02 22:00:43 INFO     Epoch [27/200] train_loss: 3.9163, val_loss: 4.7438, lr: 0.003000, 7.69s
2024-05-02 22:00:50 INFO     epoch complete!
2024-05-02 22:00:50 INFO     evaluating now!
2024-05-02 22:00:51 INFO     Epoch [28/200] train_loss: 3.9015, val_loss: 4.6406, lr: 0.003000, 7.65s
2024-05-02 22:00:51 INFO     Saved model at 28
2024-05-02 22:00:51 INFO     Val loss decrease from 4.7089 to 4.6406, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-05-02 22:00:58 INFO     epoch complete!
2024-05-02 22:00:58 INFO     evaluating now!
2024-05-02 22:00:59 INFO     Epoch [29/200] train_loss: 3.8221, val_loss: 4.7170, lr: 0.003000, 7.85s
2024-05-02 22:01:06 INFO     epoch complete!
2024-05-02 22:01:06 INFO     evaluating now!
2024-05-02 22:01:07 INFO     Epoch [30/200] train_loss: 3.8070, val_loss: 4.7403, lr: 0.003000, 7.74s
2024-05-02 22:01:14 INFO     epoch complete!
2024-05-02 22:01:14 INFO     evaluating now!
2024-05-02 22:01:14 INFO     Epoch [31/200] train_loss: 3.8181, val_loss: 4.7507, lr: 0.003000, 7.83s
2024-05-02 22:01:22 INFO     epoch complete!
2024-05-02 22:01:22 INFO     evaluating now!
2024-05-02 22:01:22 INFO     Epoch [32/200] train_loss: 3.7591, val_loss: 4.7893, lr: 0.003000, 7.95s
2024-05-02 22:01:30 INFO     epoch complete!
2024-05-02 22:01:30 INFO     evaluating now!
2024-05-02 22:01:31 INFO     Epoch [33/200] train_loss: 3.7257, val_loss: 4.8449, lr: 0.003000, 8.35s
2024-05-02 22:01:38 INFO     epoch complete!
2024-05-02 22:01:38 INFO     evaluating now!
2024-05-02 22:01:39 INFO     Epoch [34/200] train_loss: 3.7134, val_loss: 4.7731, lr: 0.003000, 8.30s
2024-05-02 22:01:46 INFO     epoch complete!
2024-05-02 22:01:46 INFO     evaluating now!
2024-05-02 22:01:47 INFO     Epoch [35/200] train_loss: 3.6442, val_loss: 4.6631, lr: 0.003000, 8.00s
2024-05-02 22:01:55 INFO     epoch complete!
2024-05-02 22:01:55 INFO     evaluating now!
2024-05-02 22:01:55 INFO     Epoch [36/200] train_loss: 3.6920, val_loss: 4.7722, lr: 0.003000, 8.19s
2024-05-02 22:02:03 INFO     epoch complete!
2024-05-02 22:02:03 INFO     evaluating now!
2024-05-02 22:02:03 INFO     Epoch [37/200] train_loss: 3.6137, val_loss: 4.6721, lr: 0.003000, 8.04s
2024-05-02 22:02:10 INFO     epoch complete!
2024-05-02 22:02:10 INFO     evaluating now!
2024-05-02 22:02:11 INFO     Epoch [38/200] train_loss: 3.6199, val_loss: 4.8663, lr: 0.003000, 7.68s
2024-05-02 22:02:18 INFO     epoch complete!
2024-05-02 22:02:18 INFO     evaluating now!
2024-05-02 22:02:19 INFO     Epoch [39/200] train_loss: 3.6315, val_loss: 4.7494, lr: 0.003000, 7.75s
2024-05-02 22:02:26 INFO     epoch complete!
2024-05-02 22:02:26 INFO     evaluating now!
2024-05-02 22:02:27 INFO     Epoch [40/200] train_loss: 3.5889, val_loss: 4.7438, lr: 0.003000, 7.93s
2024-05-02 22:02:34 INFO     epoch complete!
2024-05-02 22:02:34 INFO     evaluating now!
2024-05-02 22:02:35 INFO     Epoch [41/200] train_loss: 3.5446, val_loss: 4.7571, lr: 0.003000, 8.00s
2024-05-02 22:02:42 INFO     epoch complete!
2024-05-02 22:02:42 INFO     evaluating now!
2024-05-02 22:02:43 INFO     Epoch [42/200] train_loss: 3.5351, val_loss: 4.7934, lr: 0.003000, 8.28s
2024-05-02 22:02:51 INFO     epoch complete!
2024-05-02 22:02:51 INFO     evaluating now!
2024-05-02 22:02:51 INFO     Epoch [43/200] train_loss: 3.5352, val_loss: 4.7456, lr: 0.003000, 8.40s
2024-05-02 22:02:51 WARNING  Early stopping at epoch: 43
2024-05-02 22:02:51 INFO     Trained totally 44 epochs, average train time is 7.092s, average eval time is 0.552s
2024-05-02 22:02:51 INFO     Loaded model at 28
2024-05-02 22:02:51 INFO     Saved model at ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 22:02:51 INFO     Start evaluating ...
2024-05-02 22:02:53 INFO     Note that you select the single mode to evaluate!
2024-05-02 22:02:53 INFO     Evaluate result is saved at ./libcity/cache/60/evaluate_cache/2024_05_02_22_02_53_AGCRN_CHITaxi20190406.csv
2024-05-02 22:02:53 INFO     
         MAE       RMSE
1   2.366018   7.027938
2   2.419123   7.572436
3   2.542739   8.266425
4   2.635687   8.701555
5   2.695640   8.944011
6   2.681836   8.986344
7   2.707130   9.212636
8   2.715676   9.333400
9   2.696869   9.456538
10  2.662739   9.491318
11  2.665988   9.687582
12  2.750695  10.114529
2024-05-02 22:02:53 INFO     ----------------------------------------------------------------------------
2024-05-02 22:02:53 INFO     # 1, Kownledge Graph Embedding: RandomE, Experiment ids: 61
2024-05-02 22:02:53 INFO     ----------------------------------------------------------------------------
2024-05-02 22:02:53 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=60
2024-05-02 22:02:53 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 60, 'load_external': True, 'embedding_model': 'RandomE', 'normal_external': True, 'ext_scaler': 'minmax01', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 22:02:53 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 22:02:53 INFO     set_weight_link_or_dist: dist
2024-05-02 22:02:53 INFO     init_weight_inf_or_zero: inf
2024-05-02 22:02:53 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 22:02:53 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 22:02:53 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 22:02:54 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 22:02:57 INFO     Dataset created
2024-05-02 22:02:57 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-05-02 22:02:57 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-05-02 22:02:57 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-05-02 22:02:57 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-05-02 22:02:57 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 22:02:58 INFO     MinMax01Scaler max: 1.0, min: -0.0038399640234991045
2024-05-02 22:03:02 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 22:03:02 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 22:03:02 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-05-02 22:03:02 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 22:03:02 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-05-02 22:03:02 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 22:03:02 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 22:03:02 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 22:03:02 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 22:03:02 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 22:03:02 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 22:03:02 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 22:03:02 INFO     Total parameter numbers: 904730
2024-05-02 22:03:02 INFO     You select `adam` optimizer.
2024-05-02 22:03:02 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 22:03:02 INFO     Start training ...
2024-05-02 22:03:02 INFO     num_batches:48
2024-05-02 22:03:09 INFO     epoch complete!
2024-05-02 22:03:09 INFO     evaluating now!
2024-05-02 22:03:10 INFO     Epoch [0/200] train_loss: 25.4307, val_loss: 17.6880, lr: 0.003000, 7.85s
2024-05-02 22:03:10 INFO     Saved model at 0
2024-05-02 22:03:10 INFO     Val loss decrease from inf to 17.6880, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 22:03:17 INFO     epoch complete!
2024-05-02 22:03:17 INFO     evaluating now!
2024-05-02 22:03:18 INFO     Epoch [1/200] train_loss: 14.3044, val_loss: 13.1537, lr: 0.003000, 8.06s
2024-05-02 22:03:18 INFO     Saved model at 1
2024-05-02 22:03:18 INFO     Val loss decrease from 17.6880 to 13.1537, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 22:03:25 INFO     epoch complete!
2024-05-02 22:03:25 INFO     evaluating now!
2024-05-02 22:03:26 INFO     Epoch [2/200] train_loss: 10.8236, val_loss: 10.0853, lr: 0.003000, 7.88s
2024-05-02 22:03:26 INFO     Saved model at 2
2024-05-02 22:03:26 INFO     Val loss decrease from 13.1537 to 10.0853, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 22:03:33 INFO     epoch complete!
2024-05-02 22:03:33 INFO     evaluating now!
2024-05-02 22:03:34 INFO     Epoch [3/200] train_loss: 8.8455, val_loss: 8.3220, lr: 0.003000, 7.85s
2024-05-02 22:03:34 INFO     Saved model at 3
2024-05-02 22:03:34 INFO     Val loss decrease from 10.0853 to 8.3220, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 22:03:41 INFO     epoch complete!
2024-05-02 22:03:41 INFO     evaluating now!
2024-05-02 22:03:42 INFO     Epoch [4/200] train_loss: 7.6068, val_loss: 7.2270, lr: 0.003000, 7.89s
2024-05-02 22:03:42 INFO     Saved model at 4
2024-05-02 22:03:42 INFO     Val loss decrease from 8.3220 to 7.2270, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 22:03:49 INFO     epoch complete!
2024-05-02 22:03:49 INFO     evaluating now!
2024-05-02 22:03:50 INFO     Epoch [5/200] train_loss: 6.7574, val_loss: 6.9524, lr: 0.003000, 7.99s
2024-05-02 22:03:50 INFO     Saved model at 5
2024-05-02 22:03:50 INFO     Val loss decrease from 7.2270 to 6.9524, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 22:03:57 INFO     epoch complete!
2024-05-02 22:03:57 INFO     evaluating now!
2024-05-02 22:03:57 INFO     Epoch [6/200] train_loss: 6.3048, val_loss: 6.1199, lr: 0.003000, 7.72s
2024-05-02 22:03:58 INFO     Saved model at 6
2024-05-02 22:03:58 INFO     Val loss decrease from 6.9524 to 6.1199, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 22:04:05 INFO     epoch complete!
2024-05-02 22:04:05 INFO     evaluating now!
2024-05-02 22:04:05 INFO     Epoch [7/200] train_loss: 5.9021, val_loss: 5.8406, lr: 0.003000, 7.89s
2024-05-02 22:04:05 INFO     Saved model at 7
2024-05-02 22:04:05 INFO     Val loss decrease from 6.1199 to 5.8406, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 22:04:13 INFO     epoch complete!
2024-05-02 22:04:13 INFO     evaluating now!
2024-05-02 22:04:13 INFO     Epoch [8/200] train_loss: 5.7123, val_loss: 5.6691, lr: 0.003000, 8.04s
2024-05-02 22:04:14 INFO     Saved model at 8
2024-05-02 22:04:14 INFO     Val loss decrease from 5.8406 to 5.6691, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 22:04:20 INFO     epoch complete!
2024-05-02 22:04:20 INFO     evaluating now!
2024-05-02 22:04:21 INFO     Epoch [9/200] train_loss: 5.4366, val_loss: 5.4843, lr: 0.003000, 7.46s
2024-05-02 22:04:21 INFO     Saved model at 9
2024-05-02 22:04:21 INFO     Val loss decrease from 5.6691 to 5.4843, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 22:04:28 INFO     epoch complete!
2024-05-02 22:04:28 INFO     evaluating now!
2024-05-02 22:04:29 INFO     Epoch [10/200] train_loss: 5.2839, val_loss: 5.3956, lr: 0.003000, 7.52s
2024-05-02 22:04:29 INFO     Saved model at 10
2024-05-02 22:04:29 INFO     Val loss decrease from 5.4843 to 5.3956, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 22:04:35 INFO     epoch complete!
2024-05-02 22:04:35 INFO     evaluating now!
2024-05-02 22:04:36 INFO     Epoch [11/200] train_loss: 5.0692, val_loss: 5.1909, lr: 0.003000, 7.41s
2024-05-02 22:04:36 INFO     Saved model at 11
2024-05-02 22:04:36 INFO     Val loss decrease from 5.3956 to 5.1909, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 22:04:43 INFO     epoch complete!
2024-05-02 22:04:43 INFO     evaluating now!
2024-05-02 22:04:43 INFO     Epoch [12/200] train_loss: 4.9267, val_loss: 5.2066, lr: 0.003000, 7.37s
2024-05-02 22:04:50 INFO     epoch complete!
2024-05-02 22:04:50 INFO     evaluating now!
2024-05-02 22:04:51 INFO     Epoch [13/200] train_loss: 4.8535, val_loss: 5.1969, lr: 0.003000, 7.39s
2024-05-02 22:04:58 INFO     epoch complete!
2024-05-02 22:04:58 INFO     evaluating now!
2024-05-02 22:04:59 INFO     Epoch [14/200] train_loss: 4.7828, val_loss: 5.1849, lr: 0.003000, 7.83s
2024-05-02 22:04:59 INFO     Saved model at 14
2024-05-02 22:04:59 INFO     Val loss decrease from 5.1909 to 5.1849, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-02 22:05:06 INFO     epoch complete!
2024-05-02 22:05:06 INFO     evaluating now!
2024-05-02 22:05:07 INFO     Epoch [15/200] train_loss: 4.7148, val_loss: 5.0529, lr: 0.003000, 8.31s
2024-05-02 22:05:07 INFO     Saved model at 15
2024-05-02 22:05:07 INFO     Val loss decrease from 5.1849 to 5.0529, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-02 22:05:15 INFO     epoch complete!
2024-05-02 22:05:15 INFO     evaluating now!
2024-05-02 22:05:16 INFO     Epoch [16/200] train_loss: 4.6025, val_loss: 4.9184, lr: 0.003000, 8.83s
2024-05-02 22:05:16 INFO     Saved model at 16
2024-05-02 22:05:16 INFO     Val loss decrease from 5.0529 to 4.9184, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-02 22:05:24 INFO     epoch complete!
2024-05-02 22:05:24 INFO     evaluating now!
2024-05-02 22:05:24 INFO     Epoch [17/200] train_loss: 4.5477, val_loss: 4.8554, lr: 0.003000, 8.20s
2024-05-02 22:05:24 INFO     Saved model at 17
2024-05-02 22:05:24 INFO     Val loss decrease from 4.9184 to 4.8554, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-02 22:05:31 INFO     epoch complete!
2024-05-02 22:05:31 INFO     evaluating now!
2024-05-02 22:05:32 INFO     Epoch [18/200] train_loss: 4.4721, val_loss: 4.9318, lr: 0.003000, 7.72s
2024-05-02 22:05:39 INFO     epoch complete!
2024-05-02 22:05:39 INFO     evaluating now!
2024-05-02 22:05:40 INFO     Epoch [19/200] train_loss: 4.3783, val_loss: 4.9646, lr: 0.003000, 7.83s
2024-05-02 22:05:47 INFO     epoch complete!
2024-05-02 22:05:47 INFO     evaluating now!
2024-05-02 22:05:48 INFO     Epoch [20/200] train_loss: 4.3577, val_loss: 4.8687, lr: 0.003000, 7.91s
2024-05-02 22:05:55 INFO     epoch complete!
2024-05-02 22:05:55 INFO     evaluating now!
2024-05-02 22:05:55 INFO     Epoch [21/200] train_loss: 4.2641, val_loss: 4.8299, lr: 0.003000, 7.66s
2024-05-02 22:05:55 INFO     Saved model at 21
2024-05-02 22:05:55 INFO     Val loss decrease from 4.8554 to 4.8299, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-02 22:06:03 INFO     epoch complete!
2024-05-02 22:06:03 INFO     evaluating now!
2024-05-02 22:06:03 INFO     Epoch [22/200] train_loss: 4.2400, val_loss: 4.9327, lr: 0.003000, 7.78s
2024-05-02 22:06:11 INFO     epoch complete!
2024-05-02 22:06:11 INFO     evaluating now!
2024-05-02 22:06:11 INFO     Epoch [23/200] train_loss: 4.1547, val_loss: 4.7286, lr: 0.003000, 8.03s
2024-05-02 22:06:11 INFO     Saved model at 23
2024-05-02 22:06:11 INFO     Val loss decrease from 4.8299 to 4.7286, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch23.tar
2024-05-02 22:06:18 INFO     epoch complete!
2024-05-02 22:06:18 INFO     evaluating now!
2024-05-02 22:06:19 INFO     Epoch [24/200] train_loss: 4.1389, val_loss: 4.7503, lr: 0.003000, 7.75s
2024-05-02 22:06:26 INFO     epoch complete!
2024-05-02 22:06:26 INFO     evaluating now!
2024-05-02 22:06:27 INFO     Epoch [25/200] train_loss: 4.1035, val_loss: 4.8729, lr: 0.003000, 7.76s
2024-05-02 22:06:34 INFO     epoch complete!
2024-05-02 22:06:34 INFO     evaluating now!
2024-05-02 22:06:34 INFO     Epoch [26/200] train_loss: 4.0398, val_loss: 4.9464, lr: 0.003000, 7.70s
2024-05-02 22:06:42 INFO     epoch complete!
2024-05-02 22:06:42 INFO     evaluating now!
2024-05-02 22:06:42 INFO     Epoch [27/200] train_loss: 4.0233, val_loss: 4.8727, lr: 0.003000, 7.77s
2024-05-02 22:06:49 INFO     epoch complete!
2024-05-02 22:06:49 INFO     evaluating now!
2024-05-02 22:06:50 INFO     Epoch [28/200] train_loss: 3.9661, val_loss: 4.6605, lr: 0.003000, 7.78s
2024-05-02 22:06:50 INFO     Saved model at 28
2024-05-02 22:06:50 INFO     Val loss decrease from 4.7286 to 4.6605, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-05-02 22:06:57 INFO     epoch complete!
2024-05-02 22:06:57 INFO     evaluating now!
2024-05-02 22:06:58 INFO     Epoch [29/200] train_loss: 3.9213, val_loss: 4.7539, lr: 0.003000, 7.77s
2024-05-02 22:07:05 INFO     epoch complete!
2024-05-02 22:07:05 INFO     evaluating now!
2024-05-02 22:07:05 INFO     Epoch [30/200] train_loss: 3.9118, val_loss: 4.7885, lr: 0.003000, 7.57s
2024-05-02 22:07:13 INFO     epoch complete!
2024-05-02 22:07:13 INFO     evaluating now!
2024-05-02 22:07:13 INFO     Epoch [31/200] train_loss: 3.9166, val_loss: 4.8294, lr: 0.003000, 7.82s
2024-05-02 22:07:20 INFO     epoch complete!
2024-05-02 22:07:20 INFO     evaluating now!
2024-05-02 22:07:21 INFO     Epoch [32/200] train_loss: 3.8283, val_loss: 4.7249, lr: 0.003000, 7.75s
2024-05-02 22:07:28 INFO     epoch complete!
2024-05-02 22:07:28 INFO     evaluating now!
2024-05-02 22:07:29 INFO     Epoch [33/200] train_loss: 3.7679, val_loss: 4.8866, lr: 0.003000, 7.76s
2024-05-02 22:07:36 INFO     epoch complete!
2024-05-02 22:07:36 INFO     evaluating now!
2024-05-02 22:07:37 INFO     Epoch [34/200] train_loss: 3.7941, val_loss: 4.7392, lr: 0.003000, 7.96s
2024-05-02 22:07:44 INFO     epoch complete!
2024-05-02 22:07:44 INFO     evaluating now!
2024-05-02 22:07:45 INFO     Epoch [35/200] train_loss: 3.7457, val_loss: 4.9026, lr: 0.003000, 7.85s
2024-05-02 22:07:52 INFO     epoch complete!
2024-05-02 22:07:52 INFO     evaluating now!
2024-05-02 22:07:52 INFO     Epoch [36/200] train_loss: 3.7388, val_loss: 4.8206, lr: 0.003000, 7.86s
2024-05-02 22:08:00 INFO     epoch complete!
2024-05-02 22:08:00 INFO     evaluating now!
2024-05-02 22:08:00 INFO     Epoch [37/200] train_loss: 3.6997, val_loss: 4.8156, lr: 0.003000, 7.87s
2024-05-02 22:08:08 INFO     epoch complete!
2024-05-02 22:08:08 INFO     evaluating now!
2024-05-02 22:08:08 INFO     Epoch [38/200] train_loss: 3.6928, val_loss: 4.7969, lr: 0.003000, 7.78s
2024-05-02 22:08:15 INFO     epoch complete!
2024-05-02 22:08:15 INFO     evaluating now!
2024-05-02 22:08:16 INFO     Epoch [39/200] train_loss: 3.6953, val_loss: 4.7148, lr: 0.003000, 7.69s
2024-05-02 22:08:23 INFO     epoch complete!
2024-05-02 22:08:23 INFO     evaluating now!
2024-05-02 22:08:24 INFO     Epoch [40/200] train_loss: 3.6187, val_loss: 4.7731, lr: 0.003000, 7.77s
2024-05-02 22:08:31 INFO     epoch complete!
2024-05-02 22:08:31 INFO     evaluating now!
2024-05-02 22:08:31 INFO     Epoch [41/200] train_loss: 3.6821, val_loss: 4.7532, lr: 0.003000, 7.80s
2024-05-02 22:08:39 INFO     epoch complete!
2024-05-02 22:08:39 INFO     evaluating now!
2024-05-02 22:08:39 INFO     Epoch [42/200] train_loss: 3.5709, val_loss: 4.6801, lr: 0.003000, 7.78s
2024-05-02 22:08:46 INFO     epoch complete!
2024-05-02 22:08:46 INFO     evaluating now!
2024-05-02 22:08:47 INFO     Epoch [43/200] train_loss: 3.5355, val_loss: 4.6663, lr: 0.003000, 8.01s
2024-05-02 22:08:47 WARNING  Early stopping at epoch: 43
2024-05-02 22:08:47 INFO     Trained totally 44 epochs, average train time is 7.246s, average eval time is 0.576s
2024-05-02 22:08:47 INFO     Loaded model at 28
2024-05-02 22:08:47 INFO     Saved model at ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 22:08:47 INFO     Start evaluating ...
2024-05-02 22:08:49 INFO     Note that you select the single mode to evaluate!
2024-05-02 22:08:49 INFO     Evaluate result is saved at ./libcity/cache/60/evaluate_cache/2024_05_02_22_08_49_AGCRN_CHITaxi20190406.csv
2024-05-02 22:08:49 INFO     
         MAE       RMSE
1   2.391272   7.282355
2   2.566200   7.877312
3   2.668334   8.904080
4   2.778471   9.303406
5   2.818728   9.647158
6   2.787089   9.550714
7   2.830997   9.754245
8   2.826216   9.836722
9   2.880795   9.929395
10  2.890338  10.204649
11  2.960143  10.482990
12  3.031523  11.170248
2024-05-02 22:08:49 INFO     ----------------------------------------------------------------------------
2024-05-02 22:08:49 INFO     # 2, Kownledge Graph Embedding: RandomE, Experiment ids: 62
2024-05-02 22:08:49 INFO     ----------------------------------------------------------------------------
2024-05-02 22:08:49 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=60
2024-05-02 22:08:49 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 60, 'load_external': True, 'embedding_model': 'RandomE', 'normal_external': True, 'ext_scaler': 'minmax01', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 22:08:49 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 22:08:49 INFO     set_weight_link_or_dist: dist
2024-05-02 22:08:49 INFO     init_weight_inf_or_zero: inf
2024-05-02 22:08:49 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 22:08:49 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 22:08:49 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 22:08:50 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 22:08:53 INFO     Dataset created
2024-05-02 22:08:53 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-05-02 22:08:53 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-05-02 22:08:53 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-05-02 22:08:53 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-05-02 22:08:53 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 22:08:54 INFO     MinMax01Scaler max: 1.0, min: -0.0038399640234991045
2024-05-02 22:08:58 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 22:08:58 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 22:08:58 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-05-02 22:08:58 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 22:08:58 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-05-02 22:08:58 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 22:08:58 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 22:08:58 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 22:08:58 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 22:08:58 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 22:08:58 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 22:08:58 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 22:08:58 INFO     Total parameter numbers: 904730
2024-05-02 22:08:58 INFO     You select `adam` optimizer.
2024-05-02 22:08:58 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 22:08:58 INFO     Start training ...
2024-05-02 22:08:58 INFO     num_batches:48
2024-05-02 22:09:05 INFO     epoch complete!
2024-05-02 22:09:05 INFO     evaluating now!
2024-05-02 22:09:06 INFO     Epoch [0/200] train_loss: 23.6877, val_loss: 17.0908, lr: 0.003000, 7.71s
2024-05-02 22:09:06 INFO     Saved model at 0
2024-05-02 22:09:06 INFO     Val loss decrease from inf to 17.0908, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 22:09:13 INFO     epoch complete!
2024-05-02 22:09:13 INFO     evaluating now!
2024-05-02 22:09:13 INFO     Epoch [1/200] train_loss: 13.1336, val_loss: 12.1735, lr: 0.003000, 7.61s
2024-05-02 22:09:13 INFO     Saved model at 1
2024-05-02 22:09:13 INFO     Val loss decrease from 17.0908 to 12.1735, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 22:09:21 INFO     epoch complete!
2024-05-02 22:09:21 INFO     evaluating now!
2024-05-02 22:09:21 INFO     Epoch [2/200] train_loss: 9.7963, val_loss: 9.2301, lr: 0.003000, 8.16s
2024-05-02 22:09:22 INFO     Saved model at 2
2024-05-02 22:09:22 INFO     Val loss decrease from 12.1735 to 9.2301, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 22:09:29 INFO     epoch complete!
2024-05-02 22:09:29 INFO     evaluating now!
2024-05-02 22:09:29 INFO     Epoch [3/200] train_loss: 7.9591, val_loss: 7.6148, lr: 0.003000, 7.80s
2024-05-02 22:09:29 INFO     Saved model at 3
2024-05-02 22:09:29 INFO     Val loss decrease from 9.2301 to 7.6148, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 22:09:37 INFO     epoch complete!
2024-05-02 22:09:37 INFO     evaluating now!
2024-05-02 22:09:37 INFO     Epoch [4/200] train_loss: 6.9795, val_loss: 6.8726, lr: 0.003000, 7.75s
2024-05-02 22:09:38 INFO     Saved model at 4
2024-05-02 22:09:38 INFO     Val loss decrease from 7.6148 to 6.8726, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 22:09:44 INFO     epoch complete!
2024-05-02 22:09:44 INFO     evaluating now!
2024-05-02 22:09:45 INFO     Epoch [5/200] train_loss: 6.3601, val_loss: 6.4374, lr: 0.003000, 6.94s
2024-05-02 22:09:45 INFO     Saved model at 5
2024-05-02 22:09:45 INFO     Val loss decrease from 6.8726 to 6.4374, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 22:09:52 INFO     epoch complete!
2024-05-02 22:09:52 INFO     evaluating now!
2024-05-02 22:09:52 INFO     Epoch [6/200] train_loss: 6.0301, val_loss: 5.8892, lr: 0.003000, 7.36s
2024-05-02 22:09:52 INFO     Saved model at 6
2024-05-02 22:09:52 INFO     Val loss decrease from 6.4374 to 5.8892, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 22:09:59 INFO     epoch complete!
2024-05-02 22:09:59 INFO     evaluating now!
2024-05-02 22:09:59 INFO     Epoch [7/200] train_loss: 5.7480, val_loss: 5.7952, lr: 0.003000, 7.17s
2024-05-02 22:10:00 INFO     Saved model at 7
2024-05-02 22:10:00 INFO     Val loss decrease from 5.8892 to 5.7952, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 22:10:06 INFO     epoch complete!
2024-05-02 22:10:06 INFO     evaluating now!
2024-05-02 22:10:07 INFO     Epoch [8/200] train_loss: 5.4766, val_loss: 5.8936, lr: 0.003000, 7.10s
2024-05-02 22:10:14 INFO     epoch complete!
2024-05-02 22:10:14 INFO     evaluating now!
2024-05-02 22:10:14 INFO     Epoch [9/200] train_loss: 5.3230, val_loss: 5.4796, lr: 0.003000, 7.59s
2024-05-02 22:10:14 INFO     Saved model at 9
2024-05-02 22:10:14 INFO     Val loss decrease from 5.7952 to 5.4796, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 22:10:21 INFO     epoch complete!
2024-05-02 22:10:21 INFO     evaluating now!
2024-05-02 22:10:21 INFO     Epoch [10/200] train_loss: 5.2059, val_loss: 5.2803, lr: 0.003000, 7.06s
2024-05-02 22:10:21 INFO     Saved model at 10
2024-05-02 22:10:21 INFO     Val loss decrease from 5.4796 to 5.2803, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 22:10:28 INFO     epoch complete!
2024-05-02 22:10:28 INFO     evaluating now!
2024-05-02 22:10:28 INFO     Epoch [11/200] train_loss: 4.9886, val_loss: 5.3822, lr: 0.003000, 6.82s
2024-05-02 22:10:35 INFO     epoch complete!
2024-05-02 22:10:35 INFO     evaluating now!
2024-05-02 22:10:35 INFO     Epoch [12/200] train_loss: 4.8649, val_loss: 5.1891, lr: 0.003000, 7.00s
2024-05-02 22:10:35 INFO     Saved model at 12
2024-05-02 22:10:35 INFO     Val loss decrease from 5.2803 to 5.1891, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 22:10:42 INFO     epoch complete!
2024-05-02 22:10:42 INFO     evaluating now!
2024-05-02 22:10:43 INFO     Epoch [13/200] train_loss: 4.7916, val_loss: 5.0691, lr: 0.003000, 7.55s
2024-05-02 22:10:43 INFO     Saved model at 13
2024-05-02 22:10:43 INFO     Val loss decrease from 5.1891 to 5.0691, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch13.tar
2024-05-02 22:10:50 INFO     epoch complete!
2024-05-02 22:10:50 INFO     evaluating now!
2024-05-02 22:10:50 INFO     Epoch [14/200] train_loss: 4.7185, val_loss: 4.9267, lr: 0.003000, 7.63s
2024-05-02 22:10:51 INFO     Saved model at 14
2024-05-02 22:10:51 INFO     Val loss decrease from 5.0691 to 4.9267, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-02 22:10:58 INFO     epoch complete!
2024-05-02 22:10:58 INFO     evaluating now!
2024-05-02 22:10:58 INFO     Epoch [15/200] train_loss: 4.5675, val_loss: 5.0486, lr: 0.003000, 7.67s
2024-05-02 22:11:05 INFO     epoch complete!
2024-05-02 22:11:05 INFO     evaluating now!
2024-05-02 22:11:06 INFO     Epoch [16/200] train_loss: 4.4903, val_loss: 4.9213, lr: 0.003000, 7.59s
2024-05-02 22:11:06 INFO     Saved model at 16
2024-05-02 22:11:06 INFO     Val loss decrease from 4.9267 to 4.9213, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-02 22:11:13 INFO     epoch complete!
2024-05-02 22:11:13 INFO     evaluating now!
2024-05-02 22:11:13 INFO     Epoch [17/200] train_loss: 4.4514, val_loss: 4.9289, lr: 0.003000, 7.59s
2024-05-02 22:11:20 INFO     epoch complete!
2024-05-02 22:11:20 INFO     evaluating now!
2024-05-02 22:11:21 INFO     Epoch [18/200] train_loss: 4.5261, val_loss: 4.8873, lr: 0.003000, 7.61s
2024-05-02 22:11:21 INFO     Saved model at 18
2024-05-02 22:11:21 INFO     Val loss decrease from 4.9213 to 4.8873, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-02 22:11:28 INFO     epoch complete!
2024-05-02 22:11:28 INFO     evaluating now!
2024-05-02 22:11:29 INFO     Epoch [19/200] train_loss: 4.3468, val_loss: 4.9392, lr: 0.003000, 7.67s
2024-05-02 22:11:36 INFO     epoch complete!
2024-05-02 22:11:36 INFO     evaluating now!
2024-05-02 22:11:36 INFO     Epoch [20/200] train_loss: 4.2885, val_loss: 4.8310, lr: 0.003000, 7.58s
2024-05-02 22:11:36 INFO     Saved model at 20
2024-05-02 22:11:36 INFO     Val loss decrease from 4.8873 to 4.8310, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-02 22:11:43 INFO     epoch complete!
2024-05-02 22:11:43 INFO     evaluating now!
2024-05-02 22:11:44 INFO     Epoch [21/200] train_loss: 4.2791, val_loss: 4.8235, lr: 0.003000, 7.57s
2024-05-02 22:11:44 INFO     Saved model at 21
2024-05-02 22:11:44 INFO     Val loss decrease from 4.8310 to 4.8235, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-02 22:11:51 INFO     epoch complete!
2024-05-02 22:11:51 INFO     evaluating now!
2024-05-02 22:11:52 INFO     Epoch [22/200] train_loss: 4.2043, val_loss: 4.8397, lr: 0.003000, 7.54s
2024-05-02 22:11:59 INFO     epoch complete!
2024-05-02 22:11:59 INFO     evaluating now!
2024-05-02 22:11:59 INFO     Epoch [23/200] train_loss: 4.1579, val_loss: 4.8747, lr: 0.003000, 7.64s
2024-05-02 22:12:06 INFO     epoch complete!
2024-05-02 22:12:06 INFO     evaluating now!
2024-05-02 22:12:07 INFO     Epoch [24/200] train_loss: 4.1098, val_loss: 4.6709, lr: 0.003000, 7.66s
2024-05-02 22:12:07 INFO     Saved model at 24
2024-05-02 22:12:07 INFO     Val loss decrease from 4.8235 to 4.6709, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-02 22:12:14 INFO     epoch complete!
2024-05-02 22:12:14 INFO     evaluating now!
2024-05-02 22:12:14 INFO     Epoch [25/200] train_loss: 4.0695, val_loss: 4.7480, lr: 0.003000, 7.59s
2024-05-02 22:12:21 INFO     epoch complete!
2024-05-02 22:12:21 INFO     evaluating now!
2024-05-02 22:12:22 INFO     Epoch [26/200] train_loss: 4.0248, val_loss: 4.7488, lr: 0.003000, 7.42s
2024-05-02 22:12:29 INFO     epoch complete!
2024-05-02 22:12:29 INFO     evaluating now!
2024-05-02 22:12:29 INFO     Epoch [27/200] train_loss: 4.0145, val_loss: 4.7813, lr: 0.003000, 7.57s
2024-05-02 22:12:37 INFO     epoch complete!
2024-05-02 22:12:37 INFO     evaluating now!
2024-05-02 22:12:37 INFO     Epoch [28/200] train_loss: 3.9899, val_loss: 4.6597, lr: 0.003000, 7.64s
2024-05-02 22:12:37 INFO     Saved model at 28
2024-05-02 22:12:37 INFO     Val loss decrease from 4.6709 to 4.6597, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-05-02 22:12:44 INFO     epoch complete!
2024-05-02 22:12:44 INFO     evaluating now!
2024-05-02 22:12:45 INFO     Epoch [29/200] train_loss: 3.9561, val_loss: 4.6961, lr: 0.003000, 7.68s
2024-05-02 22:12:52 INFO     epoch complete!
2024-05-02 22:12:52 INFO     evaluating now!
2024-05-02 22:12:52 INFO     Epoch [30/200] train_loss: 3.8904, val_loss: 4.6787, lr: 0.003000, 7.61s
2024-05-02 22:12:59 INFO     epoch complete!
2024-05-02 22:12:59 INFO     evaluating now!
2024-05-02 22:13:00 INFO     Epoch [31/200] train_loss: 3.8469, val_loss: 4.6447, lr: 0.003000, 7.60s
2024-05-02 22:13:00 INFO     Saved model at 31
2024-05-02 22:13:00 INFO     Val loss decrease from 4.6597 to 4.6447, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch31.tar
2024-05-02 22:13:07 INFO     epoch complete!
2024-05-02 22:13:07 INFO     evaluating now!
2024-05-02 22:13:08 INFO     Epoch [32/200] train_loss: 3.8221, val_loss: 4.7597, lr: 0.003000, 7.53s
2024-05-02 22:13:15 INFO     epoch complete!
2024-05-02 22:13:15 INFO     evaluating now!
2024-05-02 22:13:15 INFO     Epoch [33/200] train_loss: 3.8397, val_loss: 4.6935, lr: 0.003000, 7.43s
2024-05-02 22:13:22 INFO     epoch complete!
2024-05-02 22:13:22 INFO     evaluating now!
2024-05-02 22:13:23 INFO     Epoch [34/200] train_loss: 3.7905, val_loss: 4.6593, lr: 0.003000, 7.75s
2024-05-02 22:13:30 INFO     epoch complete!
2024-05-02 22:13:30 INFO     evaluating now!
2024-05-02 22:13:30 INFO     Epoch [35/200] train_loss: 3.7644, val_loss: 4.7065, lr: 0.003000, 7.69s
2024-05-02 22:13:38 INFO     epoch complete!
2024-05-02 22:13:38 INFO     evaluating now!
2024-05-02 22:13:38 INFO     Epoch [36/200] train_loss: 3.7945, val_loss: 4.8637, lr: 0.003000, 7.67s
2024-05-02 22:13:45 INFO     epoch complete!
2024-05-02 22:13:45 INFO     evaluating now!
2024-05-02 22:13:46 INFO     Epoch [37/200] train_loss: 3.7352, val_loss: 4.6891, lr: 0.003000, 7.61s
2024-05-02 22:13:53 INFO     epoch complete!
2024-05-02 22:13:53 INFO     evaluating now!
2024-05-02 22:13:53 INFO     Epoch [38/200] train_loss: 3.6681, val_loss: 4.6363, lr: 0.003000, 7.67s
2024-05-02 22:13:53 INFO     Saved model at 38
2024-05-02 22:13:53 INFO     Val loss decrease from 4.6447 to 4.6363, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-05-02 22:14:01 INFO     epoch complete!
2024-05-02 22:14:01 INFO     evaluating now!
2024-05-02 22:14:01 INFO     Epoch [39/200] train_loss: 3.7055, val_loss: 4.6852, lr: 0.003000, 7.75s
2024-05-02 22:14:08 INFO     epoch complete!
2024-05-02 22:14:08 INFO     evaluating now!
2024-05-02 22:14:09 INFO     Epoch [40/200] train_loss: 3.6314, val_loss: 4.7660, lr: 0.003000, 7.66s
2024-05-02 22:14:16 INFO     epoch complete!
2024-05-02 22:14:16 INFO     evaluating now!
2024-05-02 22:14:17 INFO     Epoch [41/200] train_loss: 3.6750, val_loss: 4.7704, lr: 0.003000, 7.68s
2024-05-02 22:14:24 INFO     epoch complete!
2024-05-02 22:14:24 INFO     evaluating now!
2024-05-02 22:14:24 INFO     Epoch [42/200] train_loss: 3.6522, val_loss: 4.7478, lr: 0.003000, 7.66s
2024-05-02 22:14:31 INFO     epoch complete!
2024-05-02 22:14:31 INFO     evaluating now!
2024-05-02 22:14:32 INFO     Epoch [43/200] train_loss: 3.6279, val_loss: 4.6659, lr: 0.003000, 7.62s
2024-05-02 22:14:39 INFO     epoch complete!
2024-05-02 22:14:39 INFO     evaluating now!
2024-05-02 22:14:40 INFO     Epoch [44/200] train_loss: 3.5825, val_loss: 4.7971, lr: 0.003000, 7.74s
2024-05-02 22:14:47 INFO     epoch complete!
2024-05-02 22:14:47 INFO     evaluating now!
2024-05-02 22:14:47 INFO     Epoch [45/200] train_loss: 3.5617, val_loss: 4.7335, lr: 0.003000, 7.70s
2024-05-02 22:14:54 INFO     epoch complete!
2024-05-02 22:14:54 INFO     evaluating now!
2024-05-02 22:14:55 INFO     Epoch [46/200] train_loss: 3.5220, val_loss: 4.6107, lr: 0.003000, 7.65s
2024-05-02 22:14:55 INFO     Saved model at 46
2024-05-02 22:14:55 INFO     Val loss decrease from 4.6363 to 4.6107, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch46.tar
2024-05-02 22:15:02 INFO     epoch complete!
2024-05-02 22:15:02 INFO     evaluating now!
2024-05-02 22:15:03 INFO     Epoch [47/200] train_loss: 3.5154, val_loss: 4.6645, lr: 0.003000, 7.95s
2024-05-02 22:15:10 INFO     epoch complete!
2024-05-02 22:15:10 INFO     evaluating now!
2024-05-02 22:15:11 INFO     Epoch [48/200] train_loss: 3.5083, val_loss: 4.6111, lr: 0.003000, 7.71s
2024-05-02 22:15:18 INFO     epoch complete!
2024-05-02 22:15:18 INFO     evaluating now!
2024-05-02 22:15:18 INFO     Epoch [49/200] train_loss: 3.5203, val_loss: 4.6521, lr: 0.003000, 7.73s
2024-05-02 22:15:26 INFO     epoch complete!
2024-05-02 22:15:26 INFO     evaluating now!
2024-05-02 22:15:26 INFO     Epoch [50/200] train_loss: 3.4548, val_loss: 4.5952, lr: 0.003000, 8.02s
2024-05-02 22:15:26 INFO     Saved model at 50
2024-05-02 22:15:26 INFO     Val loss decrease from 4.6107 to 4.5952, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch50.tar
2024-05-02 22:15:33 INFO     epoch complete!
2024-05-02 22:15:33 INFO     evaluating now!
2024-05-02 22:15:34 INFO     Epoch [51/200] train_loss: 3.4653, val_loss: 4.7657, lr: 0.003000, 7.52s
2024-05-02 22:15:41 INFO     epoch complete!
2024-05-02 22:15:41 INFO     evaluating now!
2024-05-02 22:15:41 INFO     Epoch [52/200] train_loss: 3.4302, val_loss: 4.7447, lr: 0.003000, 7.47s
2024-05-02 22:15:48 INFO     epoch complete!
2024-05-02 22:15:48 INFO     evaluating now!
2024-05-02 22:15:49 INFO     Epoch [53/200] train_loss: 3.4214, val_loss: 4.6711, lr: 0.003000, 7.38s
2024-05-02 22:15:56 INFO     epoch complete!
2024-05-02 22:15:56 INFO     evaluating now!
2024-05-02 22:15:56 INFO     Epoch [54/200] train_loss: 3.4495, val_loss: 4.8032, lr: 0.003000, 7.42s
2024-05-02 22:16:03 INFO     epoch complete!
2024-05-02 22:16:03 INFO     evaluating now!
2024-05-02 22:16:04 INFO     Epoch [55/200] train_loss: 3.3996, val_loss: 4.6780, lr: 0.003000, 7.44s
2024-05-02 22:16:11 INFO     epoch complete!
2024-05-02 22:16:11 INFO     evaluating now!
2024-05-02 22:16:12 INFO     Epoch [56/200] train_loss: 3.4190, val_loss: 4.6381, lr: 0.003000, 7.84s
2024-05-02 22:16:19 INFO     epoch complete!
2024-05-02 22:16:19 INFO     evaluating now!
2024-05-02 22:16:20 INFO     Epoch [57/200] train_loss: 3.3931, val_loss: 4.6556, lr: 0.003000, 8.10s
2024-05-02 22:16:27 INFO     epoch complete!
2024-05-02 22:16:27 INFO     evaluating now!
2024-05-02 22:16:27 INFO     Epoch [58/200] train_loss: 3.3559, val_loss: 4.7942, lr: 0.003000, 7.83s
2024-05-02 22:16:35 INFO     epoch complete!
2024-05-02 22:16:35 INFO     evaluating now!
2024-05-02 22:16:35 INFO     Epoch [59/200] train_loss: 3.3431, val_loss: 4.7442, lr: 0.003000, 7.81s
2024-05-02 22:16:43 INFO     epoch complete!
2024-05-02 22:16:43 INFO     evaluating now!
2024-05-02 22:16:43 INFO     Epoch [60/200] train_loss: 3.3164, val_loss: 4.6938, lr: 0.003000, 7.86s
2024-05-02 22:16:51 INFO     epoch complete!
2024-05-02 22:16:51 INFO     evaluating now!
2024-05-02 22:16:51 INFO     Epoch [61/200] train_loss: 3.3354, val_loss: 4.6631, lr: 0.003000, 8.06s
2024-05-02 22:16:58 INFO     epoch complete!
2024-05-02 22:16:58 INFO     evaluating now!
2024-05-02 22:16:59 INFO     Epoch [62/200] train_loss: 3.3041, val_loss: 4.7560, lr: 0.003000, 7.85s
2024-05-02 22:17:06 INFO     epoch complete!
2024-05-02 22:17:06 INFO     evaluating now!
2024-05-02 22:17:07 INFO     Epoch [63/200] train_loss: 3.2633, val_loss: 4.6455, lr: 0.003000, 7.97s
2024-05-02 22:17:14 INFO     epoch complete!
2024-05-02 22:17:14 INFO     evaluating now!
2024-05-02 22:17:15 INFO     Epoch [64/200] train_loss: 3.2501, val_loss: 4.7303, lr: 0.003000, 7.60s
2024-05-02 22:17:22 INFO     epoch complete!
2024-05-02 22:17:22 INFO     evaluating now!
2024-05-02 22:17:22 INFO     Epoch [65/200] train_loss: 3.2914, val_loss: 4.7536, lr: 0.003000, 7.61s
2024-05-02 22:17:22 WARNING  Early stopping at epoch: 65
2024-05-02 22:17:22 INFO     Trained totally 66 epochs, average train time is 7.058s, average eval time is 0.553s
2024-05-02 22:17:22 INFO     Loaded model at 50
2024-05-02 22:17:22 INFO     Saved model at ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 22:17:22 INFO     Start evaluating ...
2024-05-02 22:17:24 INFO     Note that you select the single mode to evaluate!
2024-05-02 22:17:24 INFO     Evaluate result is saved at ./libcity/cache/60/evaluate_cache/2024_05_02_22_17_24_AGCRN_CHITaxi20190406.csv
2024-05-02 22:17:24 INFO     
         MAE      RMSE
1   2.315506  6.797129
2   2.333892  7.252987
3   2.432300  7.966206
4   2.507488  8.408040
5   2.580652  8.711362
6   2.590708  8.904442
7   2.668453  9.188844
8   2.675651  9.349542
9   2.691760  9.470076
10  2.686835  9.512965
11  2.761413  9.652156
12  2.785291  9.971472
2024-05-02 22:17:24 INFO     ----------------------------------------------------------------------------
2024-05-02 22:17:24 INFO     # 3, Kownledge Graph Embedding: RandomE, Experiment ids: 63
2024-05-02 22:17:24 INFO     ----------------------------------------------------------------------------
2024-05-02 22:17:24 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=60
2024-05-02 22:17:24 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 60, 'load_external': True, 'embedding_model': 'RandomE', 'normal_external': True, 'ext_scaler': 'minmax01', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 22:17:24 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 22:17:24 INFO     set_weight_link_or_dist: dist
2024-05-02 22:17:24 INFO     init_weight_inf_or_zero: inf
2024-05-02 22:17:24 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 22:17:24 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 22:17:24 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 22:17:25 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 22:17:28 INFO     Dataset created
2024-05-02 22:17:28 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-05-02 22:17:28 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-05-02 22:17:28 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-05-02 22:17:28 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-05-02 22:17:28 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 22:17:29 INFO     MinMax01Scaler max: 1.0, min: -0.0038399640234991045
2024-05-02 22:17:33 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 22:17:33 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 22:17:33 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-05-02 22:17:33 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 22:17:33 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-05-02 22:17:33 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 22:17:33 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 22:17:33 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 22:17:33 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 22:17:33 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 22:17:33 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 22:17:33 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 22:17:33 INFO     Total parameter numbers: 904730
2024-05-02 22:17:33 INFO     You select `adam` optimizer.
2024-05-02 22:17:33 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 22:17:33 INFO     Start training ...
2024-05-02 22:17:33 INFO     num_batches:48
2024-05-02 22:17:40 INFO     epoch complete!
2024-05-02 22:17:40 INFO     evaluating now!
2024-05-02 22:17:40 INFO     Epoch [0/200] train_loss: 25.4870, val_loss: 18.0887, lr: 0.003000, 7.62s
2024-05-02 22:17:40 INFO     Saved model at 0
2024-05-02 22:17:40 INFO     Val loss decrease from inf to 18.0887, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 22:17:47 INFO     epoch complete!
2024-05-02 22:17:47 INFO     evaluating now!
2024-05-02 22:17:48 INFO     Epoch [1/200] train_loss: 14.8855, val_loss: 14.2815, lr: 0.003000, 7.54s
2024-05-02 22:17:48 INFO     Saved model at 1
2024-05-02 22:17:48 INFO     Val loss decrease from 18.0887 to 14.2815, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 22:17:55 INFO     epoch complete!
2024-05-02 22:17:55 INFO     evaluating now!
2024-05-02 22:17:55 INFO     Epoch [2/200] train_loss: 11.8147, val_loss: 11.3148, lr: 0.003000, 7.36s
2024-05-02 22:17:55 INFO     Saved model at 2
2024-05-02 22:17:55 INFO     Val loss decrease from 14.2815 to 11.3148, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 22:18:03 INFO     epoch complete!
2024-05-02 22:18:03 INFO     evaluating now!
2024-05-02 22:18:03 INFO     Epoch [3/200] train_loss: 9.5010, val_loss: 9.1410, lr: 0.003000, 7.66s
2024-05-02 22:18:03 INFO     Saved model at 3
2024-05-02 22:18:03 INFO     Val loss decrease from 11.3148 to 9.1410, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 22:18:10 INFO     epoch complete!
2024-05-02 22:18:10 INFO     evaluating now!
2024-05-02 22:18:11 INFO     Epoch [4/200] train_loss: 8.1100, val_loss: 7.6967, lr: 0.003000, 7.71s
2024-05-02 22:18:11 INFO     Saved model at 4
2024-05-02 22:18:11 INFO     Val loss decrease from 9.1410 to 7.6967, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 22:18:18 INFO     epoch complete!
2024-05-02 22:18:18 INFO     evaluating now!
2024-05-02 22:18:19 INFO     Epoch [5/200] train_loss: 7.0958, val_loss: 6.6858, lr: 0.003000, 7.67s
2024-05-02 22:18:19 INFO     Saved model at 5
2024-05-02 22:18:19 INFO     Val loss decrease from 7.6967 to 6.6858, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 22:18:26 INFO     epoch complete!
2024-05-02 22:18:26 INFO     evaluating now!
2024-05-02 22:18:26 INFO     Epoch [6/200] train_loss: 6.3254, val_loss: 6.3723, lr: 0.003000, 7.53s
2024-05-02 22:18:26 INFO     Saved model at 6
2024-05-02 22:18:26 INFO     Val loss decrease from 6.6858 to 6.3723, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 22:18:33 INFO     epoch complete!
2024-05-02 22:18:33 INFO     evaluating now!
2024-05-02 22:18:34 INFO     Epoch [7/200] train_loss: 5.9914, val_loss: 5.8382, lr: 0.003000, 7.72s
2024-05-02 22:18:34 INFO     Saved model at 7
2024-05-02 22:18:34 INFO     Val loss decrease from 6.3723 to 5.8382, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 22:18:41 INFO     epoch complete!
2024-05-02 22:18:41 INFO     evaluating now!
2024-05-02 22:18:41 INFO     Epoch [8/200] train_loss: 5.6908, val_loss: 5.8207, lr: 0.003000, 7.51s
2024-05-02 22:18:42 INFO     Saved model at 8
2024-05-02 22:18:42 INFO     Val loss decrease from 5.8382 to 5.8207, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 22:18:49 INFO     epoch complete!
2024-05-02 22:18:49 INFO     evaluating now!
2024-05-02 22:18:49 INFO     Epoch [9/200] train_loss: 5.5103, val_loss: 5.7089, lr: 0.003000, 7.69s
2024-05-02 22:18:49 INFO     Saved model at 9
2024-05-02 22:18:49 INFO     Val loss decrease from 5.8207 to 5.7089, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 22:18:56 INFO     epoch complete!
2024-05-02 22:18:56 INFO     evaluating now!
2024-05-02 22:18:57 INFO     Epoch [10/200] train_loss: 5.2841, val_loss: 5.3084, lr: 0.003000, 7.69s
2024-05-02 22:18:57 INFO     Saved model at 10
2024-05-02 22:18:57 INFO     Val loss decrease from 5.7089 to 5.3084, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch10.tar
2024-05-02 22:19:04 INFO     epoch complete!
2024-05-02 22:19:04 INFO     evaluating now!
2024-05-02 22:19:05 INFO     Epoch [11/200] train_loss: 5.1222, val_loss: 5.3064, lr: 0.003000, 7.66s
2024-05-02 22:19:05 INFO     Saved model at 11
2024-05-02 22:19:05 INFO     Val loss decrease from 5.3084 to 5.3064, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 22:19:12 INFO     epoch complete!
2024-05-02 22:19:12 INFO     evaluating now!
2024-05-02 22:19:12 INFO     Epoch [12/200] train_loss: 4.9316, val_loss: 5.1408, lr: 0.003000, 7.64s
2024-05-02 22:19:12 INFO     Saved model at 12
2024-05-02 22:19:12 INFO     Val loss decrease from 5.3064 to 5.1408, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 22:19:19 INFO     epoch complete!
2024-05-02 22:19:19 INFO     evaluating now!
2024-05-02 22:19:20 INFO     Epoch [13/200] train_loss: 4.8386, val_loss: 5.1878, lr: 0.003000, 7.65s
2024-05-02 22:19:27 INFO     epoch complete!
2024-05-02 22:19:27 INFO     evaluating now!
2024-05-02 22:19:28 INFO     Epoch [14/200] train_loss: 4.7522, val_loss: 5.0808, lr: 0.003000, 7.68s
2024-05-02 22:19:28 INFO     Saved model at 14
2024-05-02 22:19:28 INFO     Val loss decrease from 5.1408 to 5.0808, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-02 22:19:35 INFO     epoch complete!
2024-05-02 22:19:35 INFO     evaluating now!
2024-05-02 22:19:36 INFO     Epoch [15/200] train_loss: 4.6562, val_loss: 5.1374, lr: 0.003000, 7.78s
2024-05-02 22:19:43 INFO     epoch complete!
2024-05-02 22:19:43 INFO     evaluating now!
2024-05-02 22:19:43 INFO     Epoch [16/200] train_loss: 4.5731, val_loss: 4.8993, lr: 0.003000, 7.72s
2024-05-02 22:19:43 INFO     Saved model at 16
2024-05-02 22:19:43 INFO     Val loss decrease from 5.0808 to 4.8993, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-02 22:19:50 INFO     epoch complete!
2024-05-02 22:19:50 INFO     evaluating now!
2024-05-02 22:19:51 INFO     Epoch [17/200] train_loss: 4.4999, val_loss: 5.0134, lr: 0.003000, 7.69s
2024-05-02 22:19:58 INFO     epoch complete!
2024-05-02 22:19:58 INFO     evaluating now!
2024-05-02 22:19:59 INFO     Epoch [18/200] train_loss: 4.3783, val_loss: 4.8707, lr: 0.003000, 7.82s
2024-05-02 22:19:59 INFO     Saved model at 18
2024-05-02 22:19:59 INFO     Val loss decrease from 4.8993 to 4.8707, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-02 22:20:06 INFO     epoch complete!
2024-05-02 22:20:06 INFO     evaluating now!
2024-05-02 22:20:07 INFO     Epoch [19/200] train_loss: 4.3423, val_loss: 4.8549, lr: 0.003000, 7.89s
2024-05-02 22:20:07 INFO     Saved model at 19
2024-05-02 22:20:07 INFO     Val loss decrease from 4.8707 to 4.8549, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch19.tar
2024-05-02 22:20:14 INFO     epoch complete!
2024-05-02 22:20:14 INFO     evaluating now!
2024-05-02 22:20:14 INFO     Epoch [20/200] train_loss: 4.2990, val_loss: 4.9242, lr: 0.003000, 7.62s
2024-05-02 22:20:21 INFO     epoch complete!
2024-05-02 22:20:21 INFO     evaluating now!
2024-05-02 22:20:22 INFO     Epoch [21/200] train_loss: 4.2282, val_loss: 4.7823, lr: 0.003000, 7.62s
2024-05-02 22:20:22 INFO     Saved model at 21
2024-05-02 22:20:22 INFO     Val loss decrease from 4.8549 to 4.7823, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch21.tar
2024-05-02 22:20:29 INFO     epoch complete!
2024-05-02 22:20:29 INFO     evaluating now!
2024-05-02 22:20:30 INFO     Epoch [22/200] train_loss: 4.1986, val_loss: 4.7080, lr: 0.003000, 7.73s
2024-05-02 22:20:30 INFO     Saved model at 22
2024-05-02 22:20:30 INFO     Val loss decrease from 4.7823 to 4.7080, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-02 22:20:37 INFO     epoch complete!
2024-05-02 22:20:37 INFO     evaluating now!
2024-05-02 22:20:38 INFO     Epoch [23/200] train_loss: 4.1471, val_loss: 4.9309, lr: 0.003000, 7.69s
2024-05-02 22:20:45 INFO     epoch complete!
2024-05-02 22:20:45 INFO     evaluating now!
2024-05-02 22:20:45 INFO     Epoch [24/200] train_loss: 4.0783, val_loss: 4.7101, lr: 0.003000, 7.71s
2024-05-02 22:20:53 INFO     epoch complete!
2024-05-02 22:20:53 INFO     evaluating now!
2024-05-02 22:20:53 INFO     Epoch [25/200] train_loss: 4.0881, val_loss: 4.7517, lr: 0.003000, 7.95s
2024-05-02 22:21:01 INFO     epoch complete!
2024-05-02 22:21:01 INFO     evaluating now!
2024-05-02 22:21:01 INFO     Epoch [26/200] train_loss: 4.0177, val_loss: 4.7139, lr: 0.003000, 8.09s
2024-05-02 22:21:08 INFO     epoch complete!
2024-05-02 22:21:08 INFO     evaluating now!
2024-05-02 22:21:09 INFO     Epoch [27/200] train_loss: 4.0102, val_loss: 4.9727, lr: 0.003000, 7.40s
2024-05-02 22:21:16 INFO     epoch complete!
2024-05-02 22:21:16 INFO     evaluating now!
2024-05-02 22:21:16 INFO     Epoch [28/200] train_loss: 3.9871, val_loss: 4.6713, lr: 0.003000, 7.40s
2024-05-02 22:21:16 INFO     Saved model at 28
2024-05-02 22:21:16 INFO     Val loss decrease from 4.7080 to 4.6713, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-05-02 22:21:23 INFO     epoch complete!
2024-05-02 22:21:23 INFO     evaluating now!
2024-05-02 22:21:24 INFO     Epoch [29/200] train_loss: 3.9607, val_loss: 4.7066, lr: 0.003000, 7.37s
2024-05-02 22:21:31 INFO     epoch complete!
2024-05-02 22:21:31 INFO     evaluating now!
2024-05-02 22:21:31 INFO     Epoch [30/200] train_loss: 3.9014, val_loss: 4.6433, lr: 0.003000, 7.58s
2024-05-02 22:21:31 INFO     Saved model at 30
2024-05-02 22:21:31 INFO     Val loss decrease from 4.6713 to 4.6433, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch30.tar
2024-05-02 22:21:38 INFO     epoch complete!
2024-05-02 22:21:38 INFO     evaluating now!
2024-05-02 22:21:39 INFO     Epoch [31/200] train_loss: 3.8072, val_loss: 4.7707, lr: 0.003000, 7.53s
2024-05-02 22:21:46 INFO     epoch complete!
2024-05-02 22:21:46 INFO     evaluating now!
2024-05-02 22:21:47 INFO     Epoch [32/200] train_loss: 3.8106, val_loss: 4.6000, lr: 0.003000, 7.97s
2024-05-02 22:21:47 INFO     Saved model at 32
2024-05-02 22:21:47 INFO     Val loss decrease from 4.6433 to 4.6000, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch32.tar
2024-05-02 22:21:54 INFO     epoch complete!
2024-05-02 22:21:54 INFO     evaluating now!
2024-05-02 22:21:55 INFO     Epoch [33/200] train_loss: 3.7621, val_loss: 4.7304, lr: 0.003000, 7.92s
2024-05-02 22:22:02 INFO     epoch complete!
2024-05-02 22:22:02 INFO     evaluating now!
2024-05-02 22:22:03 INFO     Epoch [34/200] train_loss: 3.7498, val_loss: 4.7385, lr: 0.003000, 8.02s
2024-05-02 22:22:10 INFO     epoch complete!
2024-05-02 22:22:10 INFO     evaluating now!
2024-05-02 22:22:11 INFO     Epoch [35/200] train_loss: 3.6949, val_loss: 4.6216, lr: 0.003000, 7.76s
2024-05-02 22:22:18 INFO     epoch complete!
2024-05-02 22:22:18 INFO     evaluating now!
2024-05-02 22:22:18 INFO     Epoch [36/200] train_loss: 3.7045, val_loss: 4.6892, lr: 0.003000, 7.90s
2024-05-02 22:22:26 INFO     epoch complete!
2024-05-02 22:22:26 INFO     evaluating now!
2024-05-02 22:22:26 INFO     Epoch [37/200] train_loss: 3.6564, val_loss: 4.6894, lr: 0.003000, 7.81s
2024-05-02 22:22:33 INFO     epoch complete!
2024-05-02 22:22:33 INFO     evaluating now!
2024-05-02 22:22:34 INFO     Epoch [38/200] train_loss: 3.6433, val_loss: 4.7220, lr: 0.003000, 7.77s
2024-05-02 22:22:42 INFO     epoch complete!
2024-05-02 22:22:42 INFO     evaluating now!
2024-05-02 22:22:43 INFO     Epoch [39/200] train_loss: 3.6274, val_loss: 4.6894, lr: 0.003000, 8.55s
2024-05-02 22:22:50 INFO     epoch complete!
2024-05-02 22:22:50 INFO     evaluating now!
2024-05-02 22:22:51 INFO     Epoch [40/200] train_loss: 3.6129, val_loss: 4.7322, lr: 0.003000, 7.99s
2024-05-02 22:22:58 INFO     epoch complete!
2024-05-02 22:22:58 INFO     evaluating now!
2024-05-02 22:22:58 INFO     Epoch [41/200] train_loss: 3.6060, val_loss: 4.5731, lr: 0.003000, 7.90s
2024-05-02 22:22:59 INFO     Saved model at 41
2024-05-02 22:22:59 INFO     Val loss decrease from 4.6000 to 4.5731, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch41.tar
2024-05-02 22:23:06 INFO     epoch complete!
2024-05-02 22:23:06 INFO     evaluating now!
2024-05-02 22:23:06 INFO     Epoch [42/200] train_loss: 3.5674, val_loss: 4.7743, lr: 0.003000, 7.90s
2024-05-02 22:23:13 INFO     epoch complete!
2024-05-02 22:23:13 INFO     evaluating now!
2024-05-02 22:23:14 INFO     Epoch [43/200] train_loss: 3.5631, val_loss: 4.7279, lr: 0.003000, 7.45s
2024-05-02 22:23:20 INFO     epoch complete!
2024-05-02 22:23:20 INFO     evaluating now!
2024-05-02 22:23:21 INFO     Epoch [44/200] train_loss: 3.5417, val_loss: 4.7488, lr: 0.003000, 6.98s
2024-05-02 22:23:28 INFO     epoch complete!
2024-05-02 22:23:28 INFO     evaluating now!
2024-05-02 22:23:28 INFO     Epoch [45/200] train_loss: 3.5368, val_loss: 4.7879, lr: 0.003000, 7.60s
2024-05-02 22:23:35 INFO     epoch complete!
2024-05-02 22:23:35 INFO     evaluating now!
2024-05-02 22:23:36 INFO     Epoch [46/200] train_loss: 3.5034, val_loss: 4.6713, lr: 0.003000, 7.50s
2024-05-02 22:23:42 INFO     epoch complete!
2024-05-02 22:23:42 INFO     evaluating now!
2024-05-02 22:23:43 INFO     Epoch [47/200] train_loss: 3.4528, val_loss: 4.6263, lr: 0.003000, 6.73s
2024-05-02 22:23:49 INFO     epoch complete!
2024-05-02 22:23:49 INFO     evaluating now!
2024-05-02 22:23:49 INFO     Epoch [48/200] train_loss: 3.4443, val_loss: 4.6384, lr: 0.003000, 6.57s
2024-05-02 22:23:55 INFO     epoch complete!
2024-05-02 22:23:55 INFO     evaluating now!
2024-05-02 22:23:56 INFO     Epoch [49/200] train_loss: 3.4251, val_loss: 4.6385, lr: 0.003000, 6.67s
2024-05-02 22:24:02 INFO     epoch complete!
2024-05-02 22:24:02 INFO     evaluating now!
2024-05-02 22:24:03 INFO     Epoch [50/200] train_loss: 3.4160, val_loss: 4.6989, lr: 0.003000, 6.70s
2024-05-02 22:24:09 INFO     epoch complete!
2024-05-02 22:24:09 INFO     evaluating now!
2024-05-02 22:24:09 INFO     Epoch [51/200] train_loss: 3.4551, val_loss: 4.7050, lr: 0.003000, 6.62s
2024-05-02 22:24:15 INFO     epoch complete!
2024-05-02 22:24:15 INFO     evaluating now!
2024-05-02 22:24:16 INFO     Epoch [52/200] train_loss: 3.4274, val_loss: 4.7439, lr: 0.003000, 6.70s
2024-05-02 22:24:22 INFO     epoch complete!
2024-05-02 22:24:22 INFO     evaluating now!
2024-05-02 22:24:23 INFO     Epoch [53/200] train_loss: 3.3790, val_loss: 4.7572, lr: 0.003000, 6.85s
2024-05-02 22:24:29 INFO     epoch complete!
2024-05-02 22:24:29 INFO     evaluating now!
2024-05-02 22:24:30 INFO     Epoch [54/200] train_loss: 3.3465, val_loss: 4.7090, lr: 0.003000, 7.19s
2024-05-02 22:24:37 INFO     epoch complete!
2024-05-02 22:24:37 INFO     evaluating now!
2024-05-02 22:24:37 INFO     Epoch [55/200] train_loss: 3.3323, val_loss: 4.7146, lr: 0.003000, 7.17s
2024-05-02 22:24:44 INFO     epoch complete!
2024-05-02 22:24:44 INFO     evaluating now!
2024-05-02 22:24:44 INFO     Epoch [56/200] train_loss: 3.3360, val_loss: 4.7887, lr: 0.003000, 6.88s
2024-05-02 22:24:44 WARNING  Early stopping at epoch: 56
2024-05-02 22:24:44 INFO     Trained totally 57 epochs, average train time is 7.002s, average eval time is 0.540s
2024-05-02 22:24:44 INFO     Loaded model at 41
2024-05-02 22:24:44 INFO     Saved model at ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 22:24:44 INFO     Start evaluating ...
2024-05-02 22:24:46 INFO     Note that you select the single mode to evaluate!
2024-05-02 22:24:46 INFO     Evaluate result is saved at ./libcity/cache/60/evaluate_cache/2024_05_02_22_24_46_AGCRN_CHITaxi20190406.csv
2024-05-02 22:24:46 INFO     
         MAE       RMSE
1   2.294150   7.087386
2   2.385777   7.582665
3   2.511272   8.312377
4   2.609801   8.740510
5   2.606344   8.988383
6   2.629811   9.182772
7   2.720213   9.389603
8   2.720870   9.524055
9   2.733582   9.582515
10  2.752006   9.676576
11  2.823007   9.873661
12  2.867582  10.201526
2024-05-02 22:24:46 INFO     ----------------------------------------------------------------------------
2024-05-02 22:24:46 INFO     # 4, Kownledge Graph Embedding: RandomE, Experiment ids: 64
2024-05-02 22:24:46 INFO     ----------------------------------------------------------------------------
2024-05-02 22:24:46 INFO     Begin pipeline, task=traffic_state_pred, model_name=AGCRN, dataset_name=CHITaxi20190406, exp_id=60
2024-05-02 22:24:46 INFO     {'task': 'traffic_state_pred', 'model': 'AGCRN', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 60, 'load_external': True, 'embedding_model': 'RandomE', 'normal_external': True, 'ext_scaler': 'minmax01', 'add_time_in_day': True, 'add_day_in_week': True, 'max_epoch': 200, 'patience': 15, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'embed_dim': 10, 'rnn_units': 64, 'num_layers': 2, 'cheb_order': 2, 'bidir_adj_mx': True, 'scaler': 'standard', 'learner': 'adam', 'learning_rate': 0.003, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': True, 'batch_size': 64, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 4368, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'embedding_type': 'area', 'device': device(type='cuda', index=0)}
2024-05-02 22:24:46 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-05-02 22:24:46 INFO     set_weight_link_or_dist: dist
2024-05-02 22:24:46 INFO     init_weight_inf_or_zero: inf
2024-05-02 22:24:46 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-05-02 22:24:46 INFO     Start Calculate the weight by Gauss kernel!
2024-05-02 22:24:46 INFO     Loading file CHITaxi20190406.dyna
2024-05-02 22:24:46 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-05-02 22:24:50 INFO     Dataset created
2024-05-02 22:24:50 INFO     x shape: (4345, 12, 77, 42), y shape: (4345, 12, 77, 42)
2024-05-02 22:24:50 INFO     train	x: (3042, 12, 77, 42), y: (3042, 12, 77, 42)
2024-05-02 22:24:50 INFO     eval	x: (434, 12, 77, 42), y: (434, 12, 77, 42)
2024-05-02 22:24:50 INFO     test	x: (869, 12, 77, 42), y: (869, 12, 77, 42)
2024-05-02 22:24:50 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-05-02 22:24:51 INFO     MinMax01Scaler max: 1.0, min: -0.0038399640234991045
2024-05-02 22:24:56 INFO     AGCRN(
  (encoder): AVWDCRNN(
    (dcrnn_cells): ModuleList(
      (0): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
      (1): AGCRNCell(
        (gate): AVWGCN()
        (update): AVWGCN()
      )
    )
  )
  (end_conv): Conv2d(1, 24, kernel_size=(1, 64), stride=(1, 1))
)
2024-05-02 22:24:56 INFO     node_embeddings	torch.Size([77, 10])	cuda:0	True
2024-05-02 22:24:56 INFO     encoder.dcrnn_cells.0.gate.weights_pool	torch.Size([10, 2, 106, 128])	cuda:0	True
2024-05-02 22:24:56 INFO     encoder.dcrnn_cells.0.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 22:24:56 INFO     encoder.dcrnn_cells.0.update.weights_pool	torch.Size([10, 2, 106, 64])	cuda:0	True
2024-05-02 22:24:56 INFO     encoder.dcrnn_cells.0.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 22:24:56 INFO     encoder.dcrnn_cells.1.gate.weights_pool	torch.Size([10, 2, 128, 128])	cuda:0	True
2024-05-02 22:24:56 INFO     encoder.dcrnn_cells.1.gate.bias_pool	torch.Size([10, 128])	cuda:0	True
2024-05-02 22:24:56 INFO     encoder.dcrnn_cells.1.update.weights_pool	torch.Size([10, 2, 128, 64])	cuda:0	True
2024-05-02 22:24:56 INFO     encoder.dcrnn_cells.1.update.bias_pool	torch.Size([10, 64])	cuda:0	True
2024-05-02 22:24:56 INFO     end_conv.weight	torch.Size([24, 1, 1, 64])	cuda:0	True
2024-05-02 22:24:56 INFO     end_conv.bias	torch.Size([24])	cuda:0	True
2024-05-02 22:24:56 INFO     Total parameter numbers: 904730
2024-05-02 22:24:56 INFO     You select `adam` optimizer.
2024-05-02 22:24:56 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-05-02 22:24:56 INFO     Start training ...
2024-05-02 22:24:56 INFO     num_batches:48
2024-05-02 22:25:02 INFO     epoch complete!
2024-05-02 22:25:02 INFO     evaluating now!
2024-05-02 22:25:03 INFO     Epoch [0/200] train_loss: 24.7161, val_loss: 17.5325, lr: 0.003000, 7.13s
2024-05-02 22:25:03 INFO     Saved model at 0
2024-05-02 22:25:03 INFO     Val loss decrease from inf to 17.5325, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch0.tar
2024-05-02 22:25:10 INFO     epoch complete!
2024-05-02 22:25:10 INFO     evaluating now!
2024-05-02 22:25:10 INFO     Epoch [1/200] train_loss: 13.5873, val_loss: 12.3112, lr: 0.003000, 7.08s
2024-05-02 22:25:10 INFO     Saved model at 1
2024-05-02 22:25:10 INFO     Val loss decrease from 17.5325 to 12.3112, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch1.tar
2024-05-02 22:25:17 INFO     epoch complete!
2024-05-02 22:25:17 INFO     evaluating now!
2024-05-02 22:25:17 INFO     Epoch [2/200] train_loss: 10.0859, val_loss: 9.2009, lr: 0.003000, 6.95s
2024-05-02 22:25:17 INFO     Saved model at 2
2024-05-02 22:25:17 INFO     Val loss decrease from 12.3112 to 9.2009, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch2.tar
2024-05-02 22:25:24 INFO     epoch complete!
2024-05-02 22:25:24 INFO     evaluating now!
2024-05-02 22:25:24 INFO     Epoch [3/200] train_loss: 8.0277, val_loss: 7.5507, lr: 0.003000, 6.97s
2024-05-02 22:25:24 INFO     Saved model at 3
2024-05-02 22:25:24 INFO     Val loss decrease from 9.2009 to 7.5507, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch3.tar
2024-05-02 22:25:31 INFO     epoch complete!
2024-05-02 22:25:31 INFO     evaluating now!
2024-05-02 22:25:31 INFO     Epoch [4/200] train_loss: 6.9846, val_loss: 6.7511, lr: 0.003000, 7.00s
2024-05-02 22:25:31 INFO     Saved model at 4
2024-05-02 22:25:31 INFO     Val loss decrease from 7.5507 to 6.7511, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch4.tar
2024-05-02 22:25:38 INFO     epoch complete!
2024-05-02 22:25:38 INFO     evaluating now!
2024-05-02 22:25:38 INFO     Epoch [5/200] train_loss: 6.3404, val_loss: 6.3132, lr: 0.003000, 6.92s
2024-05-02 22:25:38 INFO     Saved model at 5
2024-05-02 22:25:38 INFO     Val loss decrease from 6.7511 to 6.3132, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch5.tar
2024-05-02 22:25:45 INFO     epoch complete!
2024-05-02 22:25:45 INFO     evaluating now!
2024-05-02 22:25:45 INFO     Epoch [6/200] train_loss: 5.9475, val_loss: 6.0854, lr: 0.003000, 6.87s
2024-05-02 22:25:45 INFO     Saved model at 6
2024-05-02 22:25:45 INFO     Val loss decrease from 6.3132 to 6.0854, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch6.tar
2024-05-02 22:25:52 INFO     epoch complete!
2024-05-02 22:25:52 INFO     evaluating now!
2024-05-02 22:25:52 INFO     Epoch [7/200] train_loss: 5.6984, val_loss: 5.7925, lr: 0.003000, 7.33s
2024-05-02 22:25:52 INFO     Saved model at 7
2024-05-02 22:25:52 INFO     Val loss decrease from 6.0854 to 5.7925, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch7.tar
2024-05-02 22:25:59 INFO     epoch complete!
2024-05-02 22:25:59 INFO     evaluating now!
2024-05-02 22:25:59 INFO     Epoch [8/200] train_loss: 5.4108, val_loss: 5.4621, lr: 0.003000, 7.09s
2024-05-02 22:26:00 INFO     Saved model at 8
2024-05-02 22:26:00 INFO     Val loss decrease from 5.7925 to 5.4621, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch8.tar
2024-05-02 22:26:06 INFO     epoch complete!
2024-05-02 22:26:06 INFO     evaluating now!
2024-05-02 22:26:06 INFO     Epoch [9/200] train_loss: 5.2964, val_loss: 5.3401, lr: 0.003000, 6.73s
2024-05-02 22:26:06 INFO     Saved model at 9
2024-05-02 22:26:06 INFO     Val loss decrease from 5.4621 to 5.3401, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch9.tar
2024-05-02 22:26:13 INFO     epoch complete!
2024-05-02 22:26:13 INFO     evaluating now!
2024-05-02 22:26:13 INFO     Epoch [10/200] train_loss: 5.1101, val_loss: 5.3775, lr: 0.003000, 6.66s
2024-05-02 22:26:19 INFO     epoch complete!
2024-05-02 22:26:19 INFO     evaluating now!
2024-05-02 22:26:20 INFO     Epoch [11/200] train_loss: 5.0027, val_loss: 5.2072, lr: 0.003000, 6.90s
2024-05-02 22:26:20 INFO     Saved model at 11
2024-05-02 22:26:20 INFO     Val loss decrease from 5.3401 to 5.2072, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch11.tar
2024-05-02 22:26:27 INFO     epoch complete!
2024-05-02 22:26:27 INFO     evaluating now!
2024-05-02 22:26:27 INFO     Epoch [12/200] train_loss: 4.8342, val_loss: 5.1616, lr: 0.003000, 7.50s
2024-05-02 22:26:27 INFO     Saved model at 12
2024-05-02 22:26:27 INFO     Val loss decrease from 5.2072 to 5.1616, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch12.tar
2024-05-02 22:26:33 INFO     epoch complete!
2024-05-02 22:26:33 INFO     evaluating now!
2024-05-02 22:26:34 INFO     Epoch [13/200] train_loss: 4.7592, val_loss: 5.1717, lr: 0.003000, 6.43s
2024-05-02 22:26:40 INFO     epoch complete!
2024-05-02 22:26:40 INFO     evaluating now!
2024-05-02 22:26:40 INFO     Epoch [14/200] train_loss: 4.6932, val_loss: 5.1499, lr: 0.003000, 6.19s
2024-05-02 22:26:40 INFO     Saved model at 14
2024-05-02 22:26:40 INFO     Val loss decrease from 5.1616 to 5.1499, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch14.tar
2024-05-02 22:26:46 INFO     epoch complete!
2024-05-02 22:26:46 INFO     evaluating now!
2024-05-02 22:26:46 INFO     Epoch [15/200] train_loss: 4.6209, val_loss: 5.0725, lr: 0.003000, 6.21s
2024-05-02 22:26:46 INFO     Saved model at 15
2024-05-02 22:26:46 INFO     Val loss decrease from 5.1499 to 5.0725, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch15.tar
2024-05-02 22:26:52 INFO     epoch complete!
2024-05-02 22:26:52 INFO     evaluating now!
2024-05-02 22:26:53 INFO     Epoch [16/200] train_loss: 4.5823, val_loss: 4.9988, lr: 0.003000, 6.30s
2024-05-02 22:26:53 INFO     Saved model at 16
2024-05-02 22:26:53 INFO     Val loss decrease from 5.0725 to 4.9988, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch16.tar
2024-05-02 22:26:59 INFO     epoch complete!
2024-05-02 22:26:59 INFO     evaluating now!
2024-05-02 22:26:59 INFO     Epoch [17/200] train_loss: 4.4558, val_loss: 4.9851, lr: 0.003000, 6.30s
2024-05-02 22:26:59 INFO     Saved model at 17
2024-05-02 22:26:59 INFO     Val loss decrease from 4.9988 to 4.9851, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch17.tar
2024-05-02 22:27:05 INFO     epoch complete!
2024-05-02 22:27:05 INFO     evaluating now!
2024-05-02 22:27:05 INFO     Epoch [18/200] train_loss: 4.4043, val_loss: 4.9668, lr: 0.003000, 6.27s
2024-05-02 22:27:05 INFO     Saved model at 18
2024-05-02 22:27:05 INFO     Val loss decrease from 4.9851 to 4.9668, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch18.tar
2024-05-02 22:27:12 INFO     epoch complete!
2024-05-02 22:27:12 INFO     evaluating now!
2024-05-02 22:27:12 INFO     Epoch [19/200] train_loss: 4.3446, val_loss: 5.0262, lr: 0.003000, 6.78s
2024-05-02 22:27:19 INFO     epoch complete!
2024-05-02 22:27:19 INFO     evaluating now!
2024-05-02 22:27:19 INFO     Epoch [20/200] train_loss: 4.3293, val_loss: 4.8761, lr: 0.003000, 7.01s
2024-05-02 22:27:19 INFO     Saved model at 20
2024-05-02 22:27:19 INFO     Val loss decrease from 4.9668 to 4.8761, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch20.tar
2024-05-02 22:27:25 INFO     epoch complete!
2024-05-02 22:27:25 INFO     evaluating now!
2024-05-02 22:27:26 INFO     Epoch [21/200] train_loss: 4.2965, val_loss: 4.9602, lr: 0.003000, 6.72s
2024-05-02 22:27:32 INFO     epoch complete!
2024-05-02 22:27:32 INFO     evaluating now!
2024-05-02 22:27:33 INFO     Epoch [22/200] train_loss: 4.2175, val_loss: 4.8285, lr: 0.003000, 6.72s
2024-05-02 22:27:33 INFO     Saved model at 22
2024-05-02 22:27:33 INFO     Val loss decrease from 4.8761 to 4.8285, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch22.tar
2024-05-02 22:27:38 INFO     epoch complete!
2024-05-02 22:27:38 INFO     evaluating now!
2024-05-02 22:27:39 INFO     Epoch [23/200] train_loss: 4.1774, val_loss: 4.8381, lr: 0.003000, 6.05s
2024-05-02 22:27:45 INFO     epoch complete!
2024-05-02 22:27:45 INFO     evaluating now!
2024-05-02 22:27:46 INFO     Epoch [24/200] train_loss: 4.1085, val_loss: 4.7367, lr: 0.003000, 6.75s
2024-05-02 22:27:46 INFO     Saved model at 24
2024-05-02 22:27:46 INFO     Val loss decrease from 4.8285 to 4.7367, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch24.tar
2024-05-02 22:27:52 INFO     epoch complete!
2024-05-02 22:27:52 INFO     evaluating now!
2024-05-02 22:27:53 INFO     Epoch [25/200] train_loss: 4.0507, val_loss: 4.7334, lr: 0.003000, 7.32s
2024-05-02 22:27:53 INFO     Saved model at 25
2024-05-02 22:27:53 INFO     Val loss decrease from 4.7367 to 4.7334, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch25.tar
2024-05-02 22:27:59 INFO     epoch complete!
2024-05-02 22:27:59 INFO     evaluating now!
2024-05-02 22:28:00 INFO     Epoch [26/200] train_loss: 4.0628, val_loss: 4.8055, lr: 0.003000, 6.60s
2024-05-02 22:28:06 INFO     epoch complete!
2024-05-02 22:28:06 INFO     evaluating now!
2024-05-02 22:28:06 INFO     Epoch [27/200] train_loss: 4.0271, val_loss: 4.7417, lr: 0.003000, 6.61s
2024-05-02 22:28:12 INFO     epoch complete!
2024-05-02 22:28:12 INFO     evaluating now!
2024-05-02 22:28:12 INFO     Epoch [28/200] train_loss: 3.9849, val_loss: 4.7299, lr: 0.003000, 6.15s
2024-05-02 22:28:12 INFO     Saved model at 28
2024-05-02 22:28:12 INFO     Val loss decrease from 4.7334 to 4.7299, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch28.tar
2024-05-02 22:28:19 INFO     epoch complete!
2024-05-02 22:28:19 INFO     evaluating now!
2024-05-02 22:28:19 INFO     Epoch [29/200] train_loss: 3.9159, val_loss: 4.7403, lr: 0.003000, 6.72s
2024-05-02 22:28:25 INFO     epoch complete!
2024-05-02 22:28:25 INFO     evaluating now!
2024-05-02 22:28:26 INFO     Epoch [30/200] train_loss: 3.8687, val_loss: 4.7389, lr: 0.003000, 6.59s
2024-05-02 22:28:31 INFO     epoch complete!
2024-05-02 22:28:31 INFO     evaluating now!
2024-05-02 22:28:31 INFO     Epoch [31/200] train_loss: 3.8470, val_loss: 4.7759, lr: 0.003000, 5.71s
2024-05-02 22:28:38 INFO     epoch complete!
2024-05-02 22:28:38 INFO     evaluating now!
2024-05-02 22:28:38 INFO     Epoch [32/200] train_loss: 3.8259, val_loss: 4.8489, lr: 0.003000, 6.63s
2024-05-02 22:28:44 INFO     epoch complete!
2024-05-02 22:28:44 INFO     evaluating now!
2024-05-02 22:28:45 INFO     Epoch [33/200] train_loss: 3.8091, val_loss: 4.8435, lr: 0.003000, 6.65s
2024-05-02 22:28:51 INFO     epoch complete!
2024-05-02 22:28:51 INFO     evaluating now!
2024-05-02 22:28:51 INFO     Epoch [34/200] train_loss: 3.8112, val_loss: 4.8105, lr: 0.003000, 6.74s
2024-05-02 22:28:58 INFO     epoch complete!
2024-05-02 22:28:58 INFO     evaluating now!
2024-05-02 22:28:58 INFO     Epoch [35/200] train_loss: 3.7867, val_loss: 4.8777, lr: 0.003000, 6.84s
2024-05-02 22:29:04 INFO     epoch complete!
2024-05-02 22:29:04 INFO     evaluating now!
2024-05-02 22:29:05 INFO     Epoch [36/200] train_loss: 3.7486, val_loss: 4.7750, lr: 0.003000, 6.71s
2024-05-02 22:29:11 INFO     epoch complete!
2024-05-02 22:29:11 INFO     evaluating now!
2024-05-02 22:29:11 INFO     Epoch [37/200] train_loss: 3.7177, val_loss: 4.7027, lr: 0.003000, 6.52s
2024-05-02 22:29:12 INFO     Saved model at 37
2024-05-02 22:29:12 INFO     Val loss decrease from 4.7299 to 4.7027, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch37.tar
2024-05-02 22:29:18 INFO     epoch complete!
2024-05-02 22:29:18 INFO     evaluating now!
2024-05-02 22:29:18 INFO     Epoch [38/200] train_loss: 3.7068, val_loss: 4.6866, lr: 0.003000, 6.57s
2024-05-02 22:29:18 INFO     Saved model at 38
2024-05-02 22:29:18 INFO     Val loss decrease from 4.7027 to 4.6866, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch38.tar
2024-05-02 22:29:25 INFO     epoch complete!
2024-05-02 22:29:25 INFO     evaluating now!
2024-05-02 22:29:25 INFO     Epoch [39/200] train_loss: 3.6584, val_loss: 4.7448, lr: 0.003000, 7.02s
2024-05-02 22:29:32 INFO     epoch complete!
2024-05-02 22:29:32 INFO     evaluating now!
2024-05-02 22:29:32 INFO     Epoch [40/200] train_loss: 3.6569, val_loss: 4.7160, lr: 0.003000, 7.11s
2024-05-02 22:29:39 INFO     epoch complete!
2024-05-02 22:29:39 INFO     evaluating now!
2024-05-02 22:29:39 INFO     Epoch [41/200] train_loss: 3.6100, val_loss: 4.8158, lr: 0.003000, 7.11s
2024-05-02 22:29:46 INFO     epoch complete!
2024-05-02 22:29:46 INFO     evaluating now!
2024-05-02 22:29:46 INFO     Epoch [42/200] train_loss: 3.5704, val_loss: 4.7870, lr: 0.003000, 7.12s
2024-05-02 22:29:53 INFO     epoch complete!
2024-05-02 22:29:53 INFO     evaluating now!
2024-05-02 22:29:53 INFO     Epoch [43/200] train_loss: 3.5812, val_loss: 4.6497, lr: 0.003000, 6.67s
2024-05-02 22:29:54 INFO     Saved model at 43
2024-05-02 22:29:54 INFO     Val loss decrease from 4.6866 to 4.6497, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch43.tar
2024-05-02 22:30:01 INFO     epoch complete!
2024-05-02 22:30:01 INFO     evaluating now!
2024-05-02 22:30:01 INFO     Epoch [44/200] train_loss: 3.5901, val_loss: 4.6485, lr: 0.003000, 7.49s
2024-05-02 22:30:01 INFO     Saved model at 44
2024-05-02 22:30:01 INFO     Val loss decrease from 4.6497 to 4.6485, saving to ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406_epoch44.tar
2024-05-02 22:30:08 INFO     epoch complete!
2024-05-02 22:30:08 INFO     evaluating now!
2024-05-02 22:30:09 INFO     Epoch [45/200] train_loss: 3.5684, val_loss: 4.6506, lr: 0.003000, 7.24s
2024-05-02 22:30:15 INFO     epoch complete!
2024-05-02 22:30:15 INFO     evaluating now!
2024-05-02 22:30:16 INFO     Epoch [46/200] train_loss: 3.4910, val_loss: 4.7995, lr: 0.003000, 7.24s
2024-05-02 22:30:22 INFO     epoch complete!
2024-05-02 22:30:22 INFO     evaluating now!
2024-05-02 22:30:22 INFO     Epoch [47/200] train_loss: 3.4873, val_loss: 4.7309, lr: 0.003000, 6.51s
2024-05-02 22:30:28 INFO     epoch complete!
2024-05-02 22:30:28 INFO     evaluating now!
2024-05-02 22:30:29 INFO     Epoch [48/200] train_loss: 3.4981, val_loss: 4.7779, lr: 0.003000, 6.13s
2024-05-02 22:30:35 INFO     epoch complete!
2024-05-02 22:30:35 INFO     evaluating now!
2024-05-02 22:30:36 INFO     Epoch [49/200] train_loss: 3.4773, val_loss: 4.7906, lr: 0.003000, 6.97s
2024-05-02 22:30:42 INFO     epoch complete!
2024-05-02 22:30:42 INFO     evaluating now!
2024-05-02 22:30:43 INFO     Epoch [50/200] train_loss: 3.4824, val_loss: 4.7082, lr: 0.003000, 7.16s
2024-05-02 22:30:50 INFO     epoch complete!
2024-05-02 22:30:50 INFO     evaluating now!
2024-05-02 22:30:50 INFO     Epoch [51/200] train_loss: 3.4237, val_loss: 4.7606, lr: 0.003000, 7.32s
2024-05-02 22:30:57 INFO     epoch complete!
2024-05-02 22:30:57 INFO     evaluating now!
2024-05-02 22:30:57 INFO     Epoch [52/200] train_loss: 3.4316, val_loss: 4.8397, lr: 0.003000, 7.22s
2024-05-02 22:31:04 INFO     epoch complete!
2024-05-02 22:31:04 INFO     evaluating now!
2024-05-02 22:31:04 INFO     Epoch [53/200] train_loss: 3.4321, val_loss: 4.7990, lr: 0.003000, 7.07s
2024-05-02 22:31:11 INFO     epoch complete!
2024-05-02 22:31:11 INFO     evaluating now!
2024-05-02 22:31:12 INFO     Epoch [54/200] train_loss: 3.3790, val_loss: 4.7141, lr: 0.003000, 7.22s
2024-05-02 22:31:19 INFO     epoch complete!
2024-05-02 22:31:19 INFO     evaluating now!
2024-05-02 22:31:19 INFO     Epoch [55/200] train_loss: 3.3920, val_loss: 4.8596, lr: 0.003000, 7.59s
2024-05-02 22:31:27 INFO     epoch complete!
2024-05-02 22:31:27 INFO     evaluating now!
2024-05-02 22:31:27 INFO     Epoch [56/200] train_loss: 3.3764, val_loss: 4.7888, lr: 0.003000, 7.89s
2024-05-02 22:31:34 INFO     epoch complete!
2024-05-02 22:31:34 INFO     evaluating now!
2024-05-02 22:31:35 INFO     Epoch [57/200] train_loss: 3.4127, val_loss: 4.7627, lr: 0.003000, 7.75s
2024-05-02 22:31:42 INFO     epoch complete!
2024-05-02 22:31:42 INFO     evaluating now!
2024-05-02 22:31:43 INFO     Epoch [58/200] train_loss: 3.4030, val_loss: 4.8351, lr: 0.003000, 7.75s
2024-05-02 22:31:50 INFO     epoch complete!
2024-05-02 22:31:50 INFO     evaluating now!
2024-05-02 22:31:50 INFO     Epoch [59/200] train_loss: 3.3339, val_loss: 4.8013, lr: 0.003000, 7.78s
2024-05-02 22:31:50 WARNING  Early stopping at epoch: 59
2024-05-02 22:31:50 INFO     Trained totally 60 epochs, average train time is 6.400s, average eval time is 0.474s
2024-05-02 22:31:50 INFO     Loaded model at 44
2024-05-02 22:31:50 INFO     Saved model at ./libcity/cache/60/model_cache/AGCRN_CHITaxi20190406.m
2024-05-02 22:31:50 INFO     Start evaluating ...
2024-05-02 22:31:52 INFO     Note that you select the single mode to evaluate!
2024-05-02 22:31:52 INFO     Evaluate result is saved at ./libcity/cache/60/evaluate_cache/2024_05_02_22_31_52_AGCRN_CHITaxi20190406.csv
2024-05-02 22:31:52 INFO     
         MAE       RMSE
1   2.141926   6.666955
2   2.242729   7.252644
3   2.322256   8.118271
4   2.461408   8.593795
5   2.547972   8.910217
6   2.635556   9.149125
7   2.613770   9.389926
8   2.641679   9.610628
9   2.686101   9.621577
10  2.704094   9.651538
11  2.731365   9.917036
12  2.773418  10.197594
2024-05-02 22:31:52 INFO     ----------------------------------------------------------------------------
2024-05-02 22:31:52 INFO     Kownledge Graph Embedding: RandomE, Experiment ids: [60, 61, 62, 63, 64]
2024-05-02 22:31:52 INFO     ----------------------------------------------------------------------------
2024-05-02 22:31:52 INFO     Average: 
         MAE       RMSE
0   2.301774   6.972353
1   2.389544   7.507609
2   2.495380   8.313472
3   2.598571   8.749461
4   2.649867   9.040226
5   2.665000   9.154679
6   2.708113   9.387051
7   2.716018   9.530869
8   2.737821   9.612020
9   2.739202   9.707409
10  2.788383   9.922685
11  2.841702  10.331074 
2024-05-02 22:31:52 INFO     Standard deviation: 
         MAE      RMSE
0   0.087104  0.217437
1   0.106535  0.235098
2   0.115204  0.319290
3   0.110433  0.300010
4   0.097649  0.317920
5   0.067548  0.222988
6   0.071724  0.202264
7   0.062166  0.185380
8   0.073394  0.170887
9   0.081028  0.259162
10  0.099659  0.298274
11  0.102790  0.427789
2024-05-02 22:31:52 INFO     ----------------------------------------------------------------------------
2024-05-02 22:31:52 INFO     12 steps Average: 
        MAE      RMSE
0  2.635948  9.019076
2024-05-02 22:31:52 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.089603  0.263042
