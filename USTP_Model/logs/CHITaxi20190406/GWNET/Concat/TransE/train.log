2024-09-26 08:55:52 INFO     Saving logs in: ./logs/CHITaxi20190406/GWNET/Concat/TransE
2024-09-26 08:55:53 INFO     ----------------------------------------------------------------------------
2024-09-26 08:55:53 INFO     # 0, Kownledge Graph Embedding: TransE, Experiment ids: 10020
2024-09-26 08:55:53 INFO     ----------------------------------------------------------------------------
2024-09-26 08:55:53 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=10020
2024-09-26 08:55:53 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10020, 'ke_model': 'TransE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-26 08:55:53 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-26 08:55:53 INFO     set_weight_link_or_dist: dist
2024-09-26 08:55:53 INFO     init_weight_inf_or_zero: inf
2024-09-26 08:55:53 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-26 08:55:53 INFO     Start Calculate the weight by Gauss kernel!
2024-09-26 08:55:53 INFO     Loading file CHITaxi20190406.dyna
2024-09-26 08:55:53 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-26 08:55:56 INFO     Dataset created
2024-09-26 08:55:56 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-26 08:55:56 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-26 08:55:56 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-26 08:55:56 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-26 08:55:56 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-26 08:55:56 INFO     NoneScaler
2024-09-26 08:56:03 INFO     add adj_mx to supports
2024-09-26 08:56:03 INFO     add apt_adj(v1 * v2) in forward process
2024-09-26 08:56:03 INFO     receptive_field: 14
2024-09-26 08:56:04 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(34, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-26 08:56:04 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-26 08:56:04 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-26 08:56:04 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 08:56:04 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 08:56:04 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 08:56:04 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 08:56:04 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 08:56:04 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 08:56:04 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 08:56:04 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 08:56:04 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 08:56:04 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 08:56:04 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 08:56:04 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 08:56:04 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 08:56:04 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 08:56:04 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 08:56:04 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 08:56:04 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-26 08:56:04 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-26 08:56:04 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-26 08:56:04 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-26 08:56:04 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-26 08:56:04 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-26 08:56:04 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-26 08:56:04 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-26 08:56:04 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     start_conv.weight	torch.Size([32, 34, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-26 08:56:04 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-26 08:56:04 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-26 08:56:04 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-26 08:56:04 INFO     Total parameter numbers: 307824
2024-09-26 08:56:04 INFO     You select `adam` optimizer.
2024-09-26 08:56:04 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-26 08:56:04 INFO     Start training ...
2024-09-26 08:56:04 INFO     num_batches:96
2024-09-26 08:56:25 INFO     epoch complete!
2024-09-26 08:56:25 INFO     evaluating now!
2024-09-26 08:56:28 INFO     Epoch [0/200] train_loss: 12.5566, val_loss: 14.4084, lr: 0.001000, 23.52s
2024-09-26 08:56:28 INFO     Saved model at 0
2024-09-26 08:56:28 INFO     Val loss decrease from inf to 14.4084, saving to ./libcity/cache/10020/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-26 08:56:49 INFO     epoch complete!
2024-09-26 08:56:49 INFO     evaluating now!
2024-09-26 08:56:51 INFO     Epoch [1/200] train_loss: 8.7328, val_loss: 8.9286, lr: 0.001000, 23.43s
2024-09-26 08:56:51 INFO     Saved model at 1
2024-09-26 08:56:51 INFO     Val loss decrease from 14.4084 to 8.9286, saving to ./libcity/cache/10020/model_cache/GWNET_CHITaxi20190406_epoch1.tar
2024-09-26 08:57:12 INFO     epoch complete!
2024-09-26 08:57:12 INFO     evaluating now!
2024-09-26 08:57:14 INFO     Epoch [2/200] train_loss: 8.1581, val_loss: 7.7375, lr: 0.001000, 23.31s
2024-09-26 08:57:15 INFO     Saved model at 2
2024-09-26 08:57:15 INFO     Val loss decrease from 8.9286 to 7.7375, saving to ./libcity/cache/10020/model_cache/GWNET_CHITaxi20190406_epoch2.tar
2024-09-26 08:57:36 INFO     epoch complete!
2024-09-26 08:57:36 INFO     evaluating now!
2024-09-26 08:57:38 INFO     Epoch [3/200] train_loss: 7.9685, val_loss: 8.7565, lr: 0.001000, 23.19s
2024-09-26 08:57:59 INFO     epoch complete!
2024-09-26 08:57:59 INFO     evaluating now!
2024-09-26 08:58:01 INFO     Epoch [4/200] train_loss: 7.9778, val_loss: 8.4679, lr: 0.001000, 23.43s
2024-09-26 08:58:23 INFO     epoch complete!
2024-09-26 08:58:23 INFO     evaluating now!
2024-09-26 08:58:25 INFO     Epoch [5/200] train_loss: 7.0474, val_loss: 6.1374, lr: 0.001000, 23.45s
2024-09-26 08:58:25 INFO     Saved model at 5
2024-09-26 08:58:25 INFO     Val loss decrease from 7.7375 to 6.1374, saving to ./libcity/cache/10020/model_cache/GWNET_CHITaxi20190406_epoch5.tar
2024-09-26 08:58:46 INFO     epoch complete!
2024-09-26 08:58:46 INFO     evaluating now!
2024-09-26 08:58:48 INFO     Epoch [6/200] train_loss: 6.4134, val_loss: 9.8594, lr: 0.001000, 23.32s
2024-09-26 08:59:10 INFO     epoch complete!
2024-09-26 08:59:10 INFO     evaluating now!
2024-09-26 08:59:12 INFO     Epoch [7/200] train_loss: 5.9552, val_loss: 8.6503, lr: 0.001000, 23.41s
2024-09-26 08:59:33 INFO     epoch complete!
2024-09-26 08:59:33 INFO     evaluating now!
2024-09-26 08:59:35 INFO     Epoch [8/200] train_loss: 5.6822, val_loss: 6.9889, lr: 0.001000, 23.43s
2024-09-26 08:59:57 INFO     epoch complete!
2024-09-26 08:59:57 INFO     evaluating now!
2024-09-26 08:59:59 INFO     Epoch [9/200] train_loss: 5.6695, val_loss: 10.4860, lr: 0.001000, 23.54s
2024-09-26 09:00:20 INFO     epoch complete!
2024-09-26 09:00:20 INFO     evaluating now!
2024-09-26 09:00:22 INFO     Epoch [10/200] train_loss: 5.4236, val_loss: 5.5569, lr: 0.001000, 23.50s
2024-09-26 09:00:23 INFO     Saved model at 10
2024-09-26 09:00:23 INFO     Val loss decrease from 6.1374 to 5.5569, saving to ./libcity/cache/10020/model_cache/GWNET_CHITaxi20190406_epoch10.tar
2024-09-26 09:00:44 INFO     epoch complete!
2024-09-26 09:00:44 INFO     evaluating now!
2024-09-26 09:00:46 INFO     Epoch [11/200] train_loss: 5.3036, val_loss: 6.0317, lr: 0.001000, 23.48s
2024-09-26 09:01:07 INFO     epoch complete!
2024-09-26 09:01:07 INFO     evaluating now!
2024-09-26 09:01:09 INFO     Epoch [12/200] train_loss: 5.2578, val_loss: 6.8400, lr: 0.001000, 23.42s
2024-09-26 09:01:31 INFO     epoch complete!
2024-09-26 09:01:31 INFO     evaluating now!
2024-09-26 09:01:33 INFO     Epoch [13/200] train_loss: 5.2140, val_loss: 6.6832, lr: 0.001000, 23.46s
2024-09-26 09:01:54 INFO     epoch complete!
2024-09-26 09:01:54 INFO     evaluating now!
2024-09-26 09:01:56 INFO     Epoch [14/200] train_loss: 5.0331, val_loss: 7.4900, lr: 0.001000, 23.46s
2024-09-26 09:02:18 INFO     epoch complete!
2024-09-26 09:02:18 INFO     evaluating now!
2024-09-26 09:02:20 INFO     Epoch [15/200] train_loss: 5.0937, val_loss: 6.9085, lr: 0.001000, 23.44s
2024-09-26 09:02:41 INFO     epoch complete!
2024-09-26 09:02:41 INFO     evaluating now!
2024-09-26 09:02:43 INFO     Epoch [16/200] train_loss: 4.9492, val_loss: 5.6090, lr: 0.001000, 23.40s
2024-09-26 09:03:04 INFO     epoch complete!
2024-09-26 09:03:04 INFO     evaluating now!
2024-09-26 09:03:07 INFO     Epoch [17/200] train_loss: 4.9225, val_loss: 5.8409, lr: 0.001000, 23.38s
2024-09-26 09:03:28 INFO     epoch complete!
2024-09-26 09:03:28 INFO     evaluating now!
2024-09-26 09:03:30 INFO     Epoch [18/200] train_loss: 4.8354, val_loss: 6.4466, lr: 0.001000, 23.53s
2024-09-26 09:03:51 INFO     epoch complete!
2024-09-26 09:03:51 INFO     evaluating now!
2024-09-26 09:03:54 INFO     Epoch [19/200] train_loss: 4.7881, val_loss: 5.8247, lr: 0.001000, 23.50s
2024-09-26 09:04:15 INFO     epoch complete!
2024-09-26 09:04:15 INFO     evaluating now!
2024-09-26 09:04:17 INFO     Epoch [20/200] train_loss: 4.7729, val_loss: 6.0936, lr: 0.001000, 23.38s
2024-09-26 09:04:38 INFO     epoch complete!
2024-09-26 09:04:38 INFO     evaluating now!
2024-09-26 09:04:40 INFO     Epoch [21/200] train_loss: 4.6196, val_loss: 5.7527, lr: 0.001000, 23.45s
2024-09-26 09:05:02 INFO     epoch complete!
2024-09-26 09:05:02 INFO     evaluating now!
2024-09-26 09:05:04 INFO     Epoch [22/200] train_loss: 4.6185, val_loss: 5.2415, lr: 0.001000, 23.38s
2024-09-26 09:05:04 INFO     Saved model at 22
2024-09-26 09:05:04 INFO     Val loss decrease from 5.5569 to 5.2415, saving to ./libcity/cache/10020/model_cache/GWNET_CHITaxi20190406_epoch22.tar
2024-09-26 09:05:25 INFO     epoch complete!
2024-09-26 09:05:25 INFO     evaluating now!
2024-09-26 09:05:27 INFO     Epoch [23/200] train_loss: 4.5643, val_loss: 6.1229, lr: 0.001000, 23.37s
2024-09-26 09:05:49 INFO     epoch complete!
2024-09-26 09:05:49 INFO     evaluating now!
2024-09-26 09:05:51 INFO     Epoch [24/200] train_loss: 4.5860, val_loss: 5.2236, lr: 0.001000, 23.46s
2024-09-26 09:05:51 INFO     Saved model at 24
2024-09-26 09:05:51 INFO     Val loss decrease from 5.2415 to 5.2236, saving to ./libcity/cache/10020/model_cache/GWNET_CHITaxi20190406_epoch24.tar
2024-09-26 09:06:12 INFO     epoch complete!
2024-09-26 09:06:12 INFO     evaluating now!
2024-09-26 09:06:14 INFO     Epoch [25/200] train_loss: 4.5456, val_loss: 6.9108, lr: 0.001000, 23.35s
2024-09-26 09:06:36 INFO     epoch complete!
2024-09-26 09:06:36 INFO     evaluating now!
2024-09-26 09:06:38 INFO     Epoch [26/200] train_loss: 4.4877, val_loss: 5.2305, lr: 0.001000, 23.37s
2024-09-26 09:06:59 INFO     epoch complete!
2024-09-26 09:06:59 INFO     evaluating now!
2024-09-26 09:07:01 INFO     Epoch [27/200] train_loss: 4.4573, val_loss: 5.2732, lr: 0.001000, 23.32s
2024-09-26 09:07:22 INFO     epoch complete!
2024-09-26 09:07:22 INFO     evaluating now!
2024-09-26 09:07:24 INFO     Epoch [28/200] train_loss: 4.4507, val_loss: 5.2385, lr: 0.001000, 23.42s
2024-09-26 09:07:46 INFO     epoch complete!
2024-09-26 09:07:46 INFO     evaluating now!
2024-09-26 09:07:48 INFO     Epoch [29/200] train_loss: 4.3684, val_loss: 6.4938, lr: 0.001000, 23.35s
2024-09-26 09:08:09 INFO     epoch complete!
2024-09-26 09:08:09 INFO     evaluating now!
2024-09-26 09:08:11 INFO     Epoch [30/200] train_loss: 4.4317, val_loss: 5.5042, lr: 0.001000, 23.29s
2024-09-26 09:08:32 INFO     epoch complete!
2024-09-26 09:08:32 INFO     evaluating now!
2024-09-26 09:08:35 INFO     Epoch [31/200] train_loss: 4.3178, val_loss: 5.9054, lr: 0.001000, 23.38s
2024-09-26 09:08:56 INFO     epoch complete!
2024-09-26 09:08:56 INFO     evaluating now!
2024-09-26 09:08:58 INFO     Epoch [32/200] train_loss: 4.3800, val_loss: 5.9012, lr: 0.001000, 23.40s
2024-09-26 09:09:19 INFO     epoch complete!
2024-09-26 09:09:19 INFO     evaluating now!
2024-09-26 09:09:21 INFO     Epoch [33/200] train_loss: 4.2334, val_loss: 5.1838, lr: 0.001000, 23.32s
2024-09-26 09:09:21 INFO     Saved model at 33
2024-09-26 09:09:21 INFO     Val loss decrease from 5.2236 to 5.1838, saving to ./libcity/cache/10020/model_cache/GWNET_CHITaxi20190406_epoch33.tar
2024-09-26 09:09:42 INFO     epoch complete!
2024-09-26 09:09:42 INFO     evaluating now!
2024-09-26 09:09:45 INFO     Epoch [34/200] train_loss: 4.2486, val_loss: 5.3699, lr: 0.001000, 23.20s
2024-09-26 09:10:06 INFO     epoch complete!
2024-09-26 09:10:06 INFO     evaluating now!
2024-09-26 09:10:08 INFO     Epoch [35/200] train_loss: 4.2179, val_loss: 5.9994, lr: 0.001000, 23.28s
2024-09-26 09:10:29 INFO     epoch complete!
2024-09-26 09:10:29 INFO     evaluating now!
2024-09-26 09:10:31 INFO     Epoch [36/200] train_loss: 4.2431, val_loss: 5.8430, lr: 0.001000, 23.40s
2024-09-26 09:10:52 INFO     epoch complete!
2024-09-26 09:10:52 INFO     evaluating now!
2024-09-26 09:10:55 INFO     Epoch [37/200] train_loss: 4.1724, val_loss: 4.9019, lr: 0.001000, 23.30s
2024-09-26 09:10:55 INFO     Saved model at 37
2024-09-26 09:10:55 INFO     Val loss decrease from 5.1838 to 4.9019, saving to ./libcity/cache/10020/model_cache/GWNET_CHITaxi20190406_epoch37.tar
2024-09-26 09:11:16 INFO     epoch complete!
2024-09-26 09:11:16 INFO     evaluating now!
2024-09-26 09:11:18 INFO     Epoch [38/200] train_loss: 4.1621, val_loss: 5.3936, lr: 0.001000, 23.30s
2024-09-26 09:11:39 INFO     epoch complete!
2024-09-26 09:11:39 INFO     evaluating now!
2024-09-26 09:11:41 INFO     Epoch [39/200] train_loss: 4.1599, val_loss: 5.4202, lr: 0.001000, 23.29s
2024-09-26 09:12:03 INFO     epoch complete!
2024-09-26 09:12:03 INFO     evaluating now!
2024-09-26 09:12:05 INFO     Epoch [40/200] train_loss: 4.1309, val_loss: 5.4287, lr: 0.001000, 23.46s
2024-09-26 09:12:26 INFO     epoch complete!
2024-09-26 09:12:26 INFO     evaluating now!
2024-09-26 09:12:28 INFO     Epoch [41/200] train_loss: 4.1311, val_loss: 5.5602, lr: 0.001000, 23.43s
2024-09-26 09:12:49 INFO     epoch complete!
2024-09-26 09:12:49 INFO     evaluating now!
2024-09-26 09:12:52 INFO     Epoch [42/200] train_loss: 4.0965, val_loss: 5.0821, lr: 0.001000, 23.49s
2024-09-26 09:13:13 INFO     epoch complete!
2024-09-26 09:13:13 INFO     evaluating now!
2024-09-26 09:13:15 INFO     Epoch [43/200] train_loss: 4.0693, val_loss: 5.3213, lr: 0.001000, 23.31s
2024-09-26 09:13:36 INFO     epoch complete!
2024-09-26 09:13:36 INFO     evaluating now!
2024-09-26 09:13:38 INFO     Epoch [44/200] train_loss: 4.0445, val_loss: 4.9504, lr: 0.001000, 23.29s
2024-09-26 09:13:59 INFO     epoch complete!
2024-09-26 09:13:59 INFO     evaluating now!
2024-09-26 09:14:02 INFO     Epoch [45/200] train_loss: 4.0544, val_loss: 8.1064, lr: 0.001000, 23.28s
2024-09-26 09:14:23 INFO     epoch complete!
2024-09-26 09:14:23 INFO     evaluating now!
2024-09-26 09:14:25 INFO     Epoch [46/200] train_loss: 4.0191, val_loss: 6.3251, lr: 0.001000, 23.36s
2024-09-26 09:14:46 INFO     epoch complete!
2024-09-26 09:14:46 INFO     evaluating now!
2024-09-26 09:14:48 INFO     Epoch [47/200] train_loss: 4.0046, val_loss: 4.9514, lr: 0.001000, 23.28s
2024-09-26 09:15:09 INFO     epoch complete!
2024-09-26 09:15:09 INFO     evaluating now!
2024-09-26 09:15:12 INFO     Epoch [48/200] train_loss: 3.9915, val_loss: 4.7602, lr: 0.001000, 23.34s
2024-09-26 09:15:12 INFO     Saved model at 48
2024-09-26 09:15:12 INFO     Val loss decrease from 4.9019 to 4.7602, saving to ./libcity/cache/10020/model_cache/GWNET_CHITaxi20190406_epoch48.tar
2024-09-26 09:15:33 INFO     epoch complete!
2024-09-26 09:15:33 INFO     evaluating now!
2024-09-26 09:15:35 INFO     Epoch [49/200] train_loss: 3.9898, val_loss: 5.0778, lr: 0.001000, 23.37s
2024-09-26 09:15:57 INFO     epoch complete!
2024-09-26 09:15:57 INFO     evaluating now!
2024-09-26 09:15:59 INFO     Epoch [50/200] train_loss: 3.9626, val_loss: 4.7726, lr: 0.001000, 23.41s
2024-09-26 09:16:20 INFO     epoch complete!
2024-09-26 09:16:20 INFO     evaluating now!
2024-09-26 09:16:22 INFO     Epoch [51/200] train_loss: 3.9590, val_loss: 5.3041, lr: 0.001000, 23.42s
2024-09-26 09:16:43 INFO     epoch complete!
2024-09-26 09:16:43 INFO     evaluating now!
2024-09-26 09:16:46 INFO     Epoch [52/200] train_loss: 3.9766, val_loss: 6.0061, lr: 0.001000, 23.43s
2024-09-26 09:17:07 INFO     epoch complete!
2024-09-26 09:17:07 INFO     evaluating now!
2024-09-26 09:17:09 INFO     Epoch [53/200] train_loss: 3.9551, val_loss: 5.9052, lr: 0.001000, 23.32s
2024-09-26 09:17:30 INFO     epoch complete!
2024-09-26 09:17:30 INFO     evaluating now!
2024-09-26 09:17:32 INFO     Epoch [54/200] train_loss: 3.9136, val_loss: 5.0622, lr: 0.001000, 23.36s
2024-09-26 09:17:53 INFO     epoch complete!
2024-09-26 09:17:53 INFO     evaluating now!
2024-09-26 09:17:56 INFO     Epoch [55/200] train_loss: 3.8884, val_loss: 5.2187, lr: 0.001000, 23.33s
2024-09-26 09:18:17 INFO     epoch complete!
2024-09-26 09:18:17 INFO     evaluating now!
2024-09-26 09:18:19 INFO     Epoch [56/200] train_loss: 3.9005, val_loss: 4.8032, lr: 0.001000, 23.33s
2024-09-26 09:18:40 INFO     epoch complete!
2024-09-26 09:18:40 INFO     evaluating now!
2024-09-26 09:18:42 INFO     Epoch [57/200] train_loss: 3.8548, val_loss: 4.7781, lr: 0.001000, 23.37s
2024-09-26 09:19:03 INFO     epoch complete!
2024-09-26 09:19:03 INFO     evaluating now!
2024-09-26 09:19:06 INFO     Epoch [58/200] train_loss: 3.8741, val_loss: 5.0983, lr: 0.001000, 23.37s
2024-09-26 09:19:27 INFO     epoch complete!
2024-09-26 09:19:27 INFO     evaluating now!
2024-09-26 09:19:29 INFO     Epoch [59/200] train_loss: 3.8467, val_loss: 6.1275, lr: 0.001000, 23.36s
2024-09-26 09:19:50 INFO     epoch complete!
2024-09-26 09:19:50 INFO     evaluating now!
2024-09-26 09:19:52 INFO     Epoch [60/200] train_loss: 3.8225, val_loss: 5.0021, lr: 0.001000, 23.24s
2024-09-26 09:20:13 INFO     epoch complete!
2024-09-26 09:20:13 INFO     evaluating now!
2024-09-26 09:20:15 INFO     Epoch [61/200] train_loss: 3.9195, val_loss: 5.1449, lr: 0.001000, 23.02s
2024-09-26 09:20:36 INFO     epoch complete!
2024-09-26 09:20:36 INFO     evaluating now!
2024-09-26 09:20:38 INFO     Epoch [62/200] train_loss: 3.7860, val_loss: 4.9037, lr: 0.001000, 22.75s
2024-09-26 09:20:58 INFO     epoch complete!
2024-09-26 09:20:58 INFO     evaluating now!
2024-09-26 09:21:00 INFO     Epoch [63/200] train_loss: 3.8713, val_loss: 5.1121, lr: 0.001000, 22.42s
2024-09-26 09:21:00 WARNING  Early stopping at epoch: 63
2024-09-26 09:21:00 INFO     Trained totally 64 epochs, average train time is 21.112s, average eval time is 2.236s
2024-09-26 09:21:01 INFO     Loaded model at 48
2024-09-26 09:21:01 INFO     Saved model at ./libcity/cache/10020/model_cache/GWNET_CHITaxi20190406.m
2024-09-26 09:21:01 INFO     Start evaluating ...
2024-09-26 09:21:07 INFO     Note that you select the single mode to evaluate!
2024-09-26 09:21:07 INFO     Evaluate result is saved at ./libcity/cache/10020/evaluate_cache/2024_09_26_09_21_07_GWNET_CHITaxi20190406.csv
2024-09-26 09:21:07 INFO     
         MAE       RMSE
1   2.396197   6.803961
2   2.629328   8.087411
3   2.848499   9.685910
4   3.101846  11.463628
5   3.336699  13.534354
6   3.555184  15.690263
7   3.657090  16.558115
8   3.666353  16.183620
9   3.690646  15.403605
10  3.623059  14.552066
11  3.651621  14.268269
12  3.760592  14.917896
2024-09-26 09:21:08 INFO     ----------------------------------------------------------------------------
2024-09-26 09:21:08 INFO     # 1, Kownledge Graph Embedding: TransE, Experiment ids: 10021
2024-09-26 09:21:08 INFO     ----------------------------------------------------------------------------
2024-09-26 09:21:08 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=10021
2024-09-26 09:21:08 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10021, 'ke_model': 'TransE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-26 09:21:08 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-26 09:21:08 INFO     set_weight_link_or_dist: dist
2024-09-26 09:21:08 INFO     init_weight_inf_or_zero: inf
2024-09-26 09:21:08 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-26 09:21:08 INFO     Start Calculate the weight by Gauss kernel!
2024-09-26 09:21:08 INFO     Loading file CHITaxi20190406.dyna
2024-09-26 09:21:08 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-26 09:21:11 INFO     Dataset created
2024-09-26 09:21:11 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-26 09:21:11 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-26 09:21:11 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-26 09:21:11 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-26 09:21:11 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-26 09:21:11 INFO     NoneScaler
2024-09-26 09:21:13 INFO     add adj_mx to supports
2024-09-26 09:21:13 INFO     add apt_adj(v1 * v2) in forward process
2024-09-26 09:21:13 INFO     receptive_field: 14
2024-09-26 09:21:13 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(34, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-26 09:21:13 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-26 09:21:13 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-26 09:21:13 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:21:13 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:21:13 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:21:13 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:21:13 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:21:13 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:21:13 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:21:13 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:21:13 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:21:13 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:21:13 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:21:13 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:21:13 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:21:13 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:21:13 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:21:13 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:21:13 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:21:13 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:21:13 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:21:13 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:21:13 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:21:13 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:21:13 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:21:13 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:21:13 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     start_conv.weight	torch.Size([32, 34, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:21:13 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-26 09:21:13 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-26 09:21:13 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-26 09:21:13 INFO     Total parameter numbers: 307824
2024-09-26 09:21:13 INFO     You select `adam` optimizer.
2024-09-26 09:21:13 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-26 09:21:13 INFO     Start training ...
2024-09-26 09:21:13 INFO     num_batches:96
2024-09-26 09:21:39 INFO     epoch complete!
2024-09-26 09:21:39 INFO     evaluating now!
2024-09-26 09:21:41 INFO     Epoch [0/200] train_loss: 11.9979, val_loss: 9.6644, lr: 0.001000, 28.00s
2024-09-26 09:21:42 INFO     Saved model at 0
2024-09-26 09:21:42 INFO     Val loss decrease from inf to 9.6644, saving to ./libcity/cache/10021/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-26 09:22:02 INFO     epoch complete!
2024-09-26 09:22:02 INFO     evaluating now!
2024-09-26 09:22:04 INFO     Epoch [1/200] train_loss: 8.5849, val_loss: 8.7321, lr: 0.001000, 22.52s
2024-09-26 09:22:04 INFO     Saved model at 1
2024-09-26 09:22:04 INFO     Val loss decrease from 9.6644 to 8.7321, saving to ./libcity/cache/10021/model_cache/GWNET_CHITaxi20190406_epoch1.tar
2024-09-26 09:22:25 INFO     epoch complete!
2024-09-26 09:22:25 INFO     evaluating now!
2024-09-26 09:22:27 INFO     Epoch [2/200] train_loss: 8.1234, val_loss: 7.6730, lr: 0.001000, 22.29s
2024-09-26 09:22:27 INFO     Saved model at 2
2024-09-26 09:22:27 INFO     Val loss decrease from 8.7321 to 7.6730, saving to ./libcity/cache/10021/model_cache/GWNET_CHITaxi20190406_epoch2.tar
2024-09-26 09:22:47 INFO     epoch complete!
2024-09-26 09:22:47 INFO     evaluating now!
2024-09-26 09:22:49 INFO     Epoch [3/200] train_loss: 8.0040, val_loss: 8.3105, lr: 0.001000, 22.49s
2024-09-26 09:23:10 INFO     epoch complete!
2024-09-26 09:23:10 INFO     evaluating now!
2024-09-26 09:23:12 INFO     Epoch [4/200] train_loss: 8.0435, val_loss: 8.4546, lr: 0.001000, 22.48s
2024-09-26 09:23:32 INFO     epoch complete!
2024-09-26 09:23:32 INFO     evaluating now!
2024-09-26 09:23:34 INFO     Epoch [5/200] train_loss: 7.6316, val_loss: 8.3385, lr: 0.001000, 22.50s
2024-09-26 09:23:55 INFO     epoch complete!
2024-09-26 09:23:55 INFO     evaluating now!
2024-09-26 09:23:57 INFO     Epoch [6/200] train_loss: 6.6819, val_loss: 5.9880, lr: 0.001000, 22.31s
2024-09-26 09:23:57 INFO     Saved model at 6
2024-09-26 09:23:57 INFO     Val loss decrease from 7.6730 to 5.9880, saving to ./libcity/cache/10021/model_cache/GWNET_CHITaxi20190406_epoch6.tar
2024-09-26 09:24:17 INFO     epoch complete!
2024-09-26 09:24:17 INFO     evaluating now!
2024-09-26 09:24:19 INFO     Epoch [7/200] train_loss: 6.1873, val_loss: 9.8397, lr: 0.001000, 22.61s
2024-09-26 09:24:40 INFO     epoch complete!
2024-09-26 09:24:40 INFO     evaluating now!
2024-09-26 09:24:42 INFO     Epoch [8/200] train_loss: 5.8913, val_loss: 6.7939, lr: 0.001000, 22.75s
2024-09-26 09:25:03 INFO     epoch complete!
2024-09-26 09:25:03 INFO     evaluating now!
2024-09-26 09:25:05 INFO     Epoch [9/200] train_loss: 5.5628, val_loss: 12.7564, lr: 0.001000, 23.16s
2024-09-26 09:25:26 INFO     epoch complete!
2024-09-26 09:25:26 INFO     evaluating now!
2024-09-26 09:25:28 INFO     Epoch [10/200] train_loss: 5.5546, val_loss: 6.2332, lr: 0.001000, 22.52s
2024-09-26 09:25:49 INFO     epoch complete!
2024-09-26 09:25:49 INFO     evaluating now!
2024-09-26 09:25:51 INFO     Epoch [11/200] train_loss: 5.5433, val_loss: 11.9086, lr: 0.001000, 23.22s
2024-09-26 09:26:12 INFO     epoch complete!
2024-09-26 09:26:12 INFO     evaluating now!
2024-09-26 09:26:14 INFO     Epoch [12/200] train_loss: 5.3137, val_loss: 7.4712, lr: 0.001000, 22.57s
2024-09-26 09:26:35 INFO     epoch complete!
2024-09-26 09:26:35 INFO     evaluating now!
2024-09-26 09:26:37 INFO     Epoch [13/200] train_loss: 5.2800, val_loss: 5.7510, lr: 0.001000, 22.95s
2024-09-26 09:26:37 INFO     Saved model at 13
2024-09-26 09:26:37 INFO     Val loss decrease from 5.9880 to 5.7510, saving to ./libcity/cache/10021/model_cache/GWNET_CHITaxi20190406_epoch13.tar
2024-09-26 09:26:57 INFO     epoch complete!
2024-09-26 09:26:57 INFO     evaluating now!
2024-09-26 09:26:59 INFO     Epoch [14/200] train_loss: 5.1838, val_loss: 5.2215, lr: 0.001000, 22.71s
2024-09-26 09:27:00 INFO     Saved model at 14
2024-09-26 09:27:00 INFO     Val loss decrease from 5.7510 to 5.2215, saving to ./libcity/cache/10021/model_cache/GWNET_CHITaxi20190406_epoch14.tar
2024-09-26 09:27:20 INFO     epoch complete!
2024-09-26 09:27:20 INFO     evaluating now!
2024-09-26 09:27:22 INFO     Epoch [15/200] train_loss: 5.0756, val_loss: 6.5604, lr: 0.001000, 22.87s
2024-09-26 09:27:43 INFO     epoch complete!
2024-09-26 09:27:43 INFO     evaluating now!
2024-09-26 09:27:45 INFO     Epoch [16/200] train_loss: 4.9216, val_loss: 5.6320, lr: 0.001000, 22.53s
2024-09-26 09:28:05 INFO     epoch complete!
2024-09-26 09:28:05 INFO     evaluating now!
2024-09-26 09:28:08 INFO     Epoch [17/200] train_loss: 4.9615, val_loss: 6.3420, lr: 0.001000, 22.56s
2024-09-26 09:28:28 INFO     epoch complete!
2024-09-26 09:28:28 INFO     evaluating now!
2024-09-26 09:28:30 INFO     Epoch [18/200] train_loss: 4.7802, val_loss: 5.7972, lr: 0.001000, 22.42s
2024-09-26 09:28:50 INFO     epoch complete!
2024-09-26 09:28:50 INFO     evaluating now!
2024-09-26 09:28:52 INFO     Epoch [19/200] train_loss: 4.8352, val_loss: 5.4824, lr: 0.001000, 22.50s
2024-09-26 09:29:13 INFO     epoch complete!
2024-09-26 09:29:13 INFO     evaluating now!
2024-09-26 09:29:15 INFO     Epoch [20/200] train_loss: 4.7503, val_loss: 5.4976, lr: 0.001000, 22.65s
2024-09-26 09:29:35 INFO     epoch complete!
2024-09-26 09:29:35 INFO     evaluating now!
2024-09-26 09:29:37 INFO     Epoch [21/200] train_loss: 4.7702, val_loss: 11.0414, lr: 0.001000, 22.36s
2024-09-26 09:29:58 INFO     epoch complete!
2024-09-26 09:29:58 INFO     evaluating now!
2024-09-26 09:30:00 INFO     Epoch [22/200] train_loss: 4.6016, val_loss: 5.3343, lr: 0.001000, 22.65s
2024-09-26 09:30:20 INFO     epoch complete!
2024-09-26 09:30:20 INFO     evaluating now!
2024-09-26 09:30:23 INFO     Epoch [23/200] train_loss: 4.5715, val_loss: 6.0175, lr: 0.001000, 22.51s
2024-09-26 09:30:43 INFO     epoch complete!
2024-09-26 09:30:43 INFO     evaluating now!
2024-09-26 09:30:45 INFO     Epoch [24/200] train_loss: 4.5421, val_loss: 6.3536, lr: 0.001000, 22.58s
2024-09-26 09:31:06 INFO     epoch complete!
2024-09-26 09:31:06 INFO     evaluating now!
2024-09-26 09:31:08 INFO     Epoch [25/200] train_loss: 4.5586, val_loss: 11.0241, lr: 0.001000, 22.70s
2024-09-26 09:31:28 INFO     epoch complete!
2024-09-26 09:31:28 INFO     evaluating now!
2024-09-26 09:31:31 INFO     Epoch [26/200] train_loss: 4.5036, val_loss: 6.3729, lr: 0.001000, 22.63s
2024-09-26 09:31:51 INFO     epoch complete!
2024-09-26 09:31:51 INFO     evaluating now!
2024-09-26 09:31:53 INFO     Epoch [27/200] train_loss: 4.4443, val_loss: 5.2380, lr: 0.001000, 22.69s
2024-09-26 09:32:14 INFO     epoch complete!
2024-09-26 09:32:14 INFO     evaluating now!
2024-09-26 09:32:16 INFO     Epoch [28/200] train_loss: 4.3960, val_loss: 5.4483, lr: 0.001000, 22.59s
2024-09-26 09:32:36 INFO     epoch complete!
2024-09-26 09:32:36 INFO     evaluating now!
2024-09-26 09:32:38 INFO     Epoch [29/200] train_loss: 4.4424, val_loss: 6.3257, lr: 0.001000, 22.58s
2024-09-26 09:32:38 WARNING  Early stopping at epoch: 29
2024-09-26 09:32:38 INFO     Trained totally 30 epochs, average train time is 20.655s, average eval time is 2.140s
2024-09-26 09:32:39 INFO     Loaded model at 14
2024-09-26 09:32:39 INFO     Saved model at ./libcity/cache/10021/model_cache/GWNET_CHITaxi20190406.m
2024-09-26 09:32:39 INFO     Start evaluating ...
2024-09-26 09:32:44 INFO     Note that you select the single mode to evaluate!
2024-09-26 09:32:44 INFO     Evaluate result is saved at ./libcity/cache/10021/evaluate_cache/2024_09_26_09_32_44_GWNET_CHITaxi20190406.csv
2024-09-26 09:32:44 INFO     
         MAE       RMSE
1   2.529592   7.009111
2   2.665615   8.008498
3   2.842746   9.303393
4   3.051721  10.310204
5   3.180041  11.093543
6   3.349416  12.016261
7   3.543873  12.910076
8   3.524873  13.188455
9   3.606514  13.520868
10  3.639596  13.510869
11  3.727668  13.843629
12  3.819547  14.414179
2024-09-26 09:32:44 INFO     ----------------------------------------------------------------------------
2024-09-26 09:32:44 INFO     # 2, Kownledge Graph Embedding: TransE, Experiment ids: 10022
2024-09-26 09:32:44 INFO     ----------------------------------------------------------------------------
2024-09-26 09:32:44 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=10022
2024-09-26 09:32:44 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10022, 'ke_model': 'TransE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-26 09:32:44 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-26 09:32:44 INFO     set_weight_link_or_dist: dist
2024-09-26 09:32:44 INFO     init_weight_inf_or_zero: inf
2024-09-26 09:32:44 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-26 09:32:44 INFO     Start Calculate the weight by Gauss kernel!
2024-09-26 09:32:44 INFO     Loading file CHITaxi20190406.dyna
2024-09-26 09:32:44 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-26 09:32:47 INFO     Dataset created
2024-09-26 09:32:47 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-26 09:32:47 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-26 09:32:47 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-26 09:32:47 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-26 09:32:48 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-26 09:32:48 INFO     NoneScaler
2024-09-26 09:32:50 INFO     add adj_mx to supports
2024-09-26 09:32:50 INFO     add apt_adj(v1 * v2) in forward process
2024-09-26 09:32:50 INFO     receptive_field: 14
2024-09-26 09:32:50 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(34, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-26 09:32:50 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-26 09:32:50 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-26 09:32:50 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:32:50 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:32:50 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:32:50 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:32:50 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:32:50 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:32:50 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:32:50 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:32:50 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:32:50 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:32:50 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:32:50 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:32:50 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:32:50 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:32:50 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:32:50 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:32:50 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:32:50 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:32:50 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:32:50 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:32:50 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:32:50 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:32:50 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:32:50 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:32:50 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     start_conv.weight	torch.Size([32, 34, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:32:50 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-26 09:32:50 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-26 09:32:50 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-26 09:32:50 INFO     Total parameter numbers: 307824
2024-09-26 09:32:50 INFO     You select `adam` optimizer.
2024-09-26 09:32:50 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-26 09:32:50 INFO     Start training ...
2024-09-26 09:32:50 INFO     num_batches:96
2024-09-26 09:33:10 INFO     epoch complete!
2024-09-26 09:33:10 INFO     evaluating now!
2024-09-26 09:33:12 INFO     Epoch [0/200] train_loss: 12.6681, val_loss: 9.3488, lr: 0.001000, 22.61s
2024-09-26 09:33:12 INFO     Saved model at 0
2024-09-26 09:33:12 INFO     Val loss decrease from inf to 9.3488, saving to ./libcity/cache/10022/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-26 09:33:33 INFO     epoch complete!
2024-09-26 09:33:33 INFO     evaluating now!
2024-09-26 09:33:35 INFO     Epoch [1/200] train_loss: 8.7441, val_loss: 9.1502, lr: 0.001000, 22.66s
2024-09-26 09:33:35 INFO     Saved model at 1
2024-09-26 09:33:35 INFO     Val loss decrease from 9.3488 to 9.1502, saving to ./libcity/cache/10022/model_cache/GWNET_CHITaxi20190406_epoch1.tar
2024-09-26 09:33:56 INFO     epoch complete!
2024-09-26 09:33:56 INFO     evaluating now!
2024-09-26 09:33:58 INFO     Epoch [2/200] train_loss: 8.3615, val_loss: 7.9338, lr: 0.001000, 22.72s
2024-09-26 09:33:58 INFO     Saved model at 2
2024-09-26 09:33:58 INFO     Val loss decrease from 9.1502 to 7.9338, saving to ./libcity/cache/10022/model_cache/GWNET_CHITaxi20190406_epoch2.tar
2024-09-26 09:34:19 INFO     epoch complete!
2024-09-26 09:34:19 INFO     evaluating now!
2024-09-26 09:34:21 INFO     Epoch [3/200] train_loss: 8.1936, val_loss: 7.9012, lr: 0.001000, 22.46s
2024-09-26 09:34:21 INFO     Saved model at 3
2024-09-26 09:34:21 INFO     Val loss decrease from 7.9338 to 7.9012, saving to ./libcity/cache/10022/model_cache/GWNET_CHITaxi20190406_epoch3.tar
2024-09-26 09:34:41 INFO     epoch complete!
2024-09-26 09:34:41 INFO     evaluating now!
2024-09-26 09:34:43 INFO     Epoch [4/200] train_loss: 7.8675, val_loss: 7.9991, lr: 0.001000, 22.34s
2024-09-26 09:35:04 INFO     epoch complete!
2024-09-26 09:35:04 INFO     evaluating now!
2024-09-26 09:35:06 INFO     Epoch [5/200] train_loss: 7.6844, val_loss: 8.0276, lr: 0.001000, 22.46s
2024-09-26 09:35:26 INFO     epoch complete!
2024-09-26 09:35:26 INFO     evaluating now!
2024-09-26 09:35:28 INFO     Epoch [6/200] train_loss: 7.3929, val_loss: 8.2913, lr: 0.001000, 22.41s
2024-09-26 09:35:48 INFO     epoch complete!
2024-09-26 09:35:48 INFO     evaluating now!
2024-09-26 09:35:50 INFO     Epoch [7/200] train_loss: 6.5053, val_loss: 7.0025, lr: 0.001000, 22.45s
2024-09-26 09:35:51 INFO     Saved model at 7
2024-09-26 09:35:51 INFO     Val loss decrease from 7.9012 to 7.0025, saving to ./libcity/cache/10022/model_cache/GWNET_CHITaxi20190406_epoch7.tar
2024-09-26 09:36:11 INFO     epoch complete!
2024-09-26 09:36:11 INFO     evaluating now!
2024-09-26 09:36:13 INFO     Epoch [8/200] train_loss: 6.0092, val_loss: 5.7218, lr: 0.001000, 22.14s
2024-09-26 09:36:13 INFO     Saved model at 8
2024-09-26 09:36:13 INFO     Val loss decrease from 7.0025 to 5.7218, saving to ./libcity/cache/10022/model_cache/GWNET_CHITaxi20190406_epoch8.tar
2024-09-26 09:36:39 INFO     epoch complete!
2024-09-26 09:36:39 INFO     evaluating now!
2024-09-26 09:36:42 INFO     Epoch [9/200] train_loss: 5.7230, val_loss: 6.2589, lr: 0.001000, 29.13s
2024-09-26 09:37:09 INFO     epoch complete!
2024-09-26 09:37:09 INFO     evaluating now!
2024-09-26 09:37:11 INFO     Epoch [10/200] train_loss: 5.5234, val_loss: 5.4947, lr: 0.001000, 28.69s
2024-09-26 09:37:11 INFO     Saved model at 10
2024-09-26 09:37:11 INFO     Val loss decrease from 5.7218 to 5.4947, saving to ./libcity/cache/10022/model_cache/GWNET_CHITaxi20190406_epoch10.tar
2024-09-26 09:37:32 INFO     epoch complete!
2024-09-26 09:37:32 INFO     evaluating now!
2024-09-26 09:37:35 INFO     Epoch [11/200] train_loss: 5.3746, val_loss: 5.7904, lr: 0.001000, 23.83s
2024-09-26 09:37:57 INFO     epoch complete!
2024-09-26 09:37:57 INFO     evaluating now!
2024-09-26 09:37:59 INFO     Epoch [12/200] train_loss: 5.2942, val_loss: 5.8603, lr: 0.001000, 24.51s
2024-09-26 09:38:21 INFO     epoch complete!
2024-09-26 09:38:21 INFO     evaluating now!
2024-09-26 09:38:24 INFO     Epoch [13/200] train_loss: 5.1978, val_loss: 5.6783, lr: 0.001000, 24.62s
2024-09-26 09:38:46 INFO     epoch complete!
2024-09-26 09:38:46 INFO     evaluating now!
2024-09-26 09:38:48 INFO     Epoch [14/200] train_loss: 5.1025, val_loss: 10.2787, lr: 0.001000, 24.49s
2024-09-26 09:39:10 INFO     epoch complete!
2024-09-26 09:39:10 INFO     evaluating now!
2024-09-26 09:39:13 INFO     Epoch [15/200] train_loss: 5.0302, val_loss: 5.3577, lr: 0.001000, 24.34s
2024-09-26 09:39:13 INFO     Saved model at 15
2024-09-26 09:39:13 INFO     Val loss decrease from 5.4947 to 5.3577, saving to ./libcity/cache/10022/model_cache/GWNET_CHITaxi20190406_epoch15.tar
2024-09-26 09:39:35 INFO     epoch complete!
2024-09-26 09:39:35 INFO     evaluating now!
2024-09-26 09:39:37 INFO     Epoch [16/200] train_loss: 5.0450, val_loss: 5.6900, lr: 0.001000, 23.98s
2024-09-26 09:39:59 INFO     epoch complete!
2024-09-26 09:39:59 INFO     evaluating now!
2024-09-26 09:40:01 INFO     Epoch [17/200] train_loss: 4.9352, val_loss: 6.9104, lr: 0.001000, 24.54s
2024-09-26 09:40:25 INFO     epoch complete!
2024-09-26 09:40:25 INFO     evaluating now!
2024-09-26 09:40:28 INFO     Epoch [18/200] train_loss: 4.9370, val_loss: 5.7549, lr: 0.001000, 26.06s
2024-09-26 09:40:48 INFO     epoch complete!
2024-09-26 09:40:48 INFO     evaluating now!
2024-09-26 09:40:50 INFO     Epoch [19/200] train_loss: 4.8812, val_loss: 5.6016, lr: 0.001000, 22.83s
2024-09-26 09:41:11 INFO     epoch complete!
2024-09-26 09:41:11 INFO     evaluating now!
2024-09-26 09:41:13 INFO     Epoch [20/200] train_loss: 4.8757, val_loss: 5.1322, lr: 0.001000, 22.97s
2024-09-26 09:41:14 INFO     Saved model at 20
2024-09-26 09:41:14 INFO     Val loss decrease from 5.3577 to 5.1322, saving to ./libcity/cache/10022/model_cache/GWNET_CHITaxi20190406_epoch20.tar
2024-09-26 09:41:34 INFO     epoch complete!
2024-09-26 09:41:34 INFO     evaluating now!
2024-09-26 09:41:36 INFO     Epoch [21/200] train_loss: 4.7163, val_loss: 5.1828, lr: 0.001000, 22.87s
2024-09-26 09:41:57 INFO     epoch complete!
2024-09-26 09:41:57 INFO     evaluating now!
2024-09-26 09:41:59 INFO     Epoch [22/200] train_loss: 4.7485, val_loss: 5.6491, lr: 0.001000, 22.81s
2024-09-26 09:42:20 INFO     epoch complete!
2024-09-26 09:42:20 INFO     evaluating now!
2024-09-26 09:42:22 INFO     Epoch [23/200] train_loss: 4.6710, val_loss: 5.6732, lr: 0.001000, 22.83s
2024-09-26 09:42:43 INFO     epoch complete!
2024-09-26 09:42:43 INFO     evaluating now!
2024-09-26 09:42:45 INFO     Epoch [24/200] train_loss: 4.6644, val_loss: 5.4631, lr: 0.001000, 23.05s
2024-09-26 09:43:06 INFO     epoch complete!
2024-09-26 09:43:06 INFO     evaluating now!
2024-09-26 09:43:08 INFO     Epoch [25/200] train_loss: 4.5332, val_loss: 5.1692, lr: 0.001000, 22.93s
2024-09-26 09:43:29 INFO     epoch complete!
2024-09-26 09:43:29 INFO     evaluating now!
2024-09-26 09:43:31 INFO     Epoch [26/200] train_loss: 4.5409, val_loss: 6.0130, lr: 0.001000, 23.02s
2024-09-26 09:43:52 INFO     epoch complete!
2024-09-26 09:43:52 INFO     evaluating now!
2024-09-26 09:43:54 INFO     Epoch [27/200] train_loss: 4.4754, val_loss: 5.4556, lr: 0.001000, 22.97s
2024-09-26 09:44:15 INFO     epoch complete!
2024-09-26 09:44:15 INFO     evaluating now!
2024-09-26 09:44:17 INFO     Epoch [28/200] train_loss: 4.5141, val_loss: 5.1231, lr: 0.001000, 23.20s
2024-09-26 09:44:17 INFO     Saved model at 28
2024-09-26 09:44:17 INFO     Val loss decrease from 5.1322 to 5.1231, saving to ./libcity/cache/10022/model_cache/GWNET_CHITaxi20190406_epoch28.tar
2024-09-26 09:44:38 INFO     epoch complete!
2024-09-26 09:44:38 INFO     evaluating now!
2024-09-26 09:44:40 INFO     Epoch [29/200] train_loss: 4.4822, val_loss: 5.4647, lr: 0.001000, 22.82s
2024-09-26 09:45:01 INFO     epoch complete!
2024-09-26 09:45:01 INFO     evaluating now!
2024-09-26 09:45:03 INFO     Epoch [30/200] train_loss: 4.3790, val_loss: 6.4776, lr: 0.001000, 22.81s
2024-09-26 09:45:24 INFO     epoch complete!
2024-09-26 09:45:24 INFO     evaluating now!
2024-09-26 09:45:26 INFO     Epoch [31/200] train_loss: 4.3815, val_loss: 5.2576, lr: 0.001000, 23.37s
2024-09-26 09:45:47 INFO     epoch complete!
2024-09-26 09:45:47 INFO     evaluating now!
2024-09-26 09:45:49 INFO     Epoch [32/200] train_loss: 4.3547, val_loss: 5.5471, lr: 0.001000, 22.79s
2024-09-26 09:46:10 INFO     epoch complete!
2024-09-26 09:46:10 INFO     evaluating now!
2024-09-26 09:46:12 INFO     Epoch [33/200] train_loss: 4.2960, val_loss: 6.4394, lr: 0.001000, 22.80s
2024-09-26 09:46:33 INFO     epoch complete!
2024-09-26 09:46:33 INFO     evaluating now!
2024-09-26 09:46:35 INFO     Epoch [34/200] train_loss: 4.3119, val_loss: 6.0838, lr: 0.001000, 22.87s
2024-09-26 09:46:55 INFO     epoch complete!
2024-09-26 09:46:55 INFO     evaluating now!
2024-09-26 09:46:58 INFO     Epoch [35/200] train_loss: 4.2869, val_loss: 6.2792, lr: 0.001000, 22.84s
2024-09-26 09:47:18 INFO     epoch complete!
2024-09-26 09:47:18 INFO     evaluating now!
2024-09-26 09:47:20 INFO     Epoch [36/200] train_loss: 4.2795, val_loss: 8.1800, lr: 0.001000, 22.87s
2024-09-26 09:47:41 INFO     epoch complete!
2024-09-26 09:47:41 INFO     evaluating now!
2024-09-26 09:47:43 INFO     Epoch [37/200] train_loss: 4.2401, val_loss: 5.4986, lr: 0.001000, 22.66s
2024-09-26 09:48:04 INFO     epoch complete!
2024-09-26 09:48:04 INFO     evaluating now!
2024-09-26 09:48:06 INFO     Epoch [38/200] train_loss: 4.2604, val_loss: 5.5647, lr: 0.001000, 22.79s
2024-09-26 09:48:27 INFO     epoch complete!
2024-09-26 09:48:27 INFO     evaluating now!
2024-09-26 09:48:29 INFO     Epoch [39/200] train_loss: 4.2162, val_loss: 5.3685, lr: 0.001000, 22.81s
2024-09-26 09:48:50 INFO     epoch complete!
2024-09-26 09:48:50 INFO     evaluating now!
2024-09-26 09:48:52 INFO     Epoch [40/200] train_loss: 4.2189, val_loss: 5.4786, lr: 0.001000, 22.95s
2024-09-26 09:49:12 INFO     epoch complete!
2024-09-26 09:49:12 INFO     evaluating now!
2024-09-26 09:49:15 INFO     Epoch [41/200] train_loss: 4.2853, val_loss: 4.8684, lr: 0.001000, 22.82s
2024-09-26 09:49:15 INFO     Saved model at 41
2024-09-26 09:49:15 INFO     Val loss decrease from 5.1231 to 4.8684, saving to ./libcity/cache/10022/model_cache/GWNET_CHITaxi20190406_epoch41.tar
2024-09-26 09:49:35 INFO     epoch complete!
2024-09-26 09:49:35 INFO     evaluating now!
2024-09-26 09:49:38 INFO     Epoch [42/200] train_loss: 4.1372, val_loss: 5.9998, lr: 0.001000, 22.86s
2024-09-26 09:49:58 INFO     epoch complete!
2024-09-26 09:49:58 INFO     evaluating now!
2024-09-26 09:50:01 INFO     Epoch [43/200] train_loss: 4.1131, val_loss: 6.0147, lr: 0.001000, 22.86s
2024-09-26 09:50:21 INFO     epoch complete!
2024-09-26 09:50:21 INFO     evaluating now!
2024-09-26 09:50:23 INFO     Epoch [44/200] train_loss: 4.1265, val_loss: 5.7718, lr: 0.001000, 22.77s
2024-09-26 09:50:44 INFO     epoch complete!
2024-09-26 09:50:44 INFO     evaluating now!
2024-09-26 09:50:46 INFO     Epoch [45/200] train_loss: 4.1250, val_loss: 5.3769, lr: 0.001000, 22.70s
2024-09-26 09:51:07 INFO     epoch complete!
2024-09-26 09:51:07 INFO     evaluating now!
2024-09-26 09:51:09 INFO     Epoch [46/200] train_loss: 4.1002, val_loss: 5.9083, lr: 0.001000, 22.76s
2024-09-26 09:51:29 INFO     epoch complete!
2024-09-26 09:51:29 INFO     evaluating now!
2024-09-26 09:51:32 INFO     Epoch [47/200] train_loss: 4.0742, val_loss: 6.0344, lr: 0.001000, 22.79s
2024-09-26 09:51:52 INFO     epoch complete!
2024-09-26 09:51:52 INFO     evaluating now!
2024-09-26 09:51:55 INFO     Epoch [48/200] train_loss: 4.0457, val_loss: 5.9023, lr: 0.001000, 23.01s
2024-09-26 09:52:15 INFO     epoch complete!
2024-09-26 09:52:15 INFO     evaluating now!
2024-09-26 09:52:17 INFO     Epoch [49/200] train_loss: 4.0625, val_loss: 5.6703, lr: 0.001000, 22.79s
2024-09-26 09:52:38 INFO     epoch complete!
2024-09-26 09:52:38 INFO     evaluating now!
2024-09-26 09:52:40 INFO     Epoch [50/200] train_loss: 3.9933, val_loss: 5.1971, lr: 0.001000, 22.80s
2024-09-26 09:53:01 INFO     epoch complete!
2024-09-26 09:53:01 INFO     evaluating now!
2024-09-26 09:53:03 INFO     Epoch [51/200] train_loss: 4.0523, val_loss: 5.1163, lr: 0.001000, 22.87s
2024-09-26 09:53:24 INFO     epoch complete!
2024-09-26 09:53:24 INFO     evaluating now!
2024-09-26 09:53:26 INFO     Epoch [52/200] train_loss: 4.0228, val_loss: 4.7768, lr: 0.001000, 23.14s
2024-09-26 09:53:26 INFO     Saved model at 52
2024-09-26 09:53:26 INFO     Val loss decrease from 4.8684 to 4.7768, saving to ./libcity/cache/10022/model_cache/GWNET_CHITaxi20190406_epoch52.tar
2024-09-26 09:53:47 INFO     epoch complete!
2024-09-26 09:53:47 INFO     evaluating now!
2024-09-26 09:53:49 INFO     Epoch [53/200] train_loss: 3.9542, val_loss: 5.0042, lr: 0.001000, 22.74s
2024-09-26 09:54:10 INFO     epoch complete!
2024-09-26 09:54:10 INFO     evaluating now!
2024-09-26 09:54:12 INFO     Epoch [54/200] train_loss: 3.9947, val_loss: 5.1788, lr: 0.001000, 23.06s
2024-09-26 09:54:33 INFO     epoch complete!
2024-09-26 09:54:33 INFO     evaluating now!
2024-09-26 09:54:35 INFO     Epoch [55/200] train_loss: 4.0025, val_loss: 4.9861, lr: 0.001000, 22.96s
2024-09-26 09:54:56 INFO     epoch complete!
2024-09-26 09:54:56 INFO     evaluating now!
2024-09-26 09:54:58 INFO     Epoch [56/200] train_loss: 3.9581, val_loss: 6.2555, lr: 0.001000, 22.88s
2024-09-26 09:55:19 INFO     epoch complete!
2024-09-26 09:55:19 INFO     evaluating now!
2024-09-26 09:55:21 INFO     Epoch [57/200] train_loss: 3.9534, val_loss: 5.3145, lr: 0.001000, 22.90s
2024-09-26 09:55:42 INFO     epoch complete!
2024-09-26 09:55:42 INFO     evaluating now!
2024-09-26 09:55:44 INFO     Epoch [58/200] train_loss: 3.9050, val_loss: 4.9916, lr: 0.001000, 22.88s
2024-09-26 09:56:04 INFO     epoch complete!
2024-09-26 09:56:04 INFO     evaluating now!
2024-09-26 09:56:07 INFO     Epoch [59/200] train_loss: 3.9238, val_loss: 5.4783, lr: 0.001000, 22.70s
2024-09-26 09:56:27 INFO     epoch complete!
2024-09-26 09:56:27 INFO     evaluating now!
2024-09-26 09:56:29 INFO     Epoch [60/200] train_loss: 3.8800, val_loss: 6.9925, lr: 0.001000, 22.74s
2024-09-26 09:56:49 INFO     epoch complete!
2024-09-26 09:56:49 INFO     evaluating now!
2024-09-26 09:56:52 INFO     Epoch [61/200] train_loss: 3.9340, val_loss: 6.0926, lr: 0.001000, 22.37s
2024-09-26 09:57:12 INFO     epoch complete!
2024-09-26 09:57:12 INFO     evaluating now!
2024-09-26 09:57:14 INFO     Epoch [62/200] train_loss: 3.8873, val_loss: 10.1394, lr: 0.001000, 22.41s
2024-09-26 09:57:34 INFO     epoch complete!
2024-09-26 09:57:34 INFO     evaluating now!
2024-09-26 09:57:36 INFO     Epoch [63/200] train_loss: 3.8887, val_loss: 5.0334, lr: 0.001000, 22.26s
2024-09-26 09:57:56 INFO     epoch complete!
2024-09-26 09:57:56 INFO     evaluating now!
2024-09-26 09:57:58 INFO     Epoch [64/200] train_loss: 3.8209, val_loss: 5.4380, lr: 0.001000, 22.14s
2024-09-26 09:58:19 INFO     epoch complete!
2024-09-26 09:58:19 INFO     evaluating now!
2024-09-26 09:58:21 INFO     Epoch [65/200] train_loss: 3.8282, val_loss: 7.7516, lr: 0.001000, 22.16s
2024-09-26 09:58:41 INFO     epoch complete!
2024-09-26 09:58:41 INFO     evaluating now!
2024-09-26 09:58:43 INFO     Epoch [66/200] train_loss: 3.8085, val_loss: 5.8916, lr: 0.001000, 22.35s
2024-09-26 09:59:03 INFO     epoch complete!
2024-09-26 09:59:03 INFO     evaluating now!
2024-09-26 09:59:06 INFO     Epoch [67/200] train_loss: 3.8220, val_loss: 6.6533, lr: 0.001000, 22.51s
2024-09-26 09:59:06 WARNING  Early stopping at epoch: 67
2024-09-26 09:59:06 INFO     Trained totally 68 epochs, average train time is 20.931s, average eval time is 2.207s
2024-09-26 09:59:06 INFO     Loaded model at 52
2024-09-26 09:59:06 INFO     Saved model at ./libcity/cache/10022/model_cache/GWNET_CHITaxi20190406.m
2024-09-26 09:59:06 INFO     Start evaluating ...
2024-09-26 09:59:11 INFO     Note that you select the single mode to evaluate!
2024-09-26 09:59:11 INFO     Evaluate result is saved at ./libcity/cache/10022/evaluate_cache/2024_09_26_09_59_11_GWNET_CHITaxi20190406.csv
2024-09-26 09:59:11 INFO     
         MAE       RMSE
1   2.239038   6.763211
2   2.429616   7.734330
3   2.716219   8.802124
4   2.870450   9.567998
5   3.064680  10.735733
6   3.190299  12.366061
7   3.368586  13.939526
8   3.434524  14.822189
9   3.479187  14.655694
10  3.505510  14.215808
11  3.489069  13.877504
12  3.590059  14.237491
2024-09-26 09:59:11 INFO     ----------------------------------------------------------------------------
2024-09-26 09:59:11 INFO     # 3, Kownledge Graph Embedding: TransE, Experiment ids: 10023
2024-09-26 09:59:11 INFO     ----------------------------------------------------------------------------
2024-09-26 09:59:11 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=10023
2024-09-26 09:59:11 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10023, 'ke_model': 'TransE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-26 09:59:11 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-26 09:59:11 INFO     set_weight_link_or_dist: dist
2024-09-26 09:59:11 INFO     init_weight_inf_or_zero: inf
2024-09-26 09:59:11 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-26 09:59:11 INFO     Start Calculate the weight by Gauss kernel!
2024-09-26 09:59:12 INFO     Loading file CHITaxi20190406.dyna
2024-09-26 09:59:12 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-26 09:59:15 INFO     Dataset created
2024-09-26 09:59:15 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-26 09:59:15 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-26 09:59:15 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-26 09:59:15 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-26 09:59:15 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-26 09:59:15 INFO     NoneScaler
2024-09-26 09:59:17 INFO     add adj_mx to supports
2024-09-26 09:59:17 INFO     add apt_adj(v1 * v2) in forward process
2024-09-26 09:59:17 INFO     receptive_field: 14
2024-09-26 09:59:17 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(34, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-26 09:59:17 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-26 09:59:17 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-26 09:59:17 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:59:17 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:59:17 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:59:17 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:59:17 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:59:17 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:59:17 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:59:17 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:59:17 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:59:17 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:59:17 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:59:17 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:59:17 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:59:17 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:59:17 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:59:17 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 09:59:17 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:59:17 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:59:17 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:59:17 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:59:17 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:59:17 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:59:17 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:59:17 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-26 09:59:17 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     start_conv.weight	torch.Size([32, 34, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-26 09:59:17 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-26 09:59:17 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-26 09:59:17 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-26 09:59:17 INFO     Total parameter numbers: 307824
2024-09-26 09:59:17 INFO     You select `adam` optimizer.
2024-09-26 09:59:17 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-26 09:59:17 INFO     Start training ...
2024-09-26 09:59:17 INFO     num_batches:96
2024-09-26 09:59:37 INFO     epoch complete!
2024-09-26 09:59:37 INFO     evaluating now!
2024-09-26 09:59:39 INFO     Epoch [0/200] train_loss: 12.6136, val_loss: 9.1316, lr: 0.001000, 22.27s
2024-09-26 09:59:40 INFO     Saved model at 0
2024-09-26 09:59:40 INFO     Val loss decrease from inf to 9.1316, saving to ./libcity/cache/10023/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-26 10:00:00 INFO     epoch complete!
2024-09-26 10:00:00 INFO     evaluating now!
2024-09-26 10:00:02 INFO     Epoch [1/200] train_loss: 8.7620, val_loss: 8.7228, lr: 0.001000, 22.35s
2024-09-26 10:00:02 INFO     Saved model at 1
2024-09-26 10:00:02 INFO     Val loss decrease from 9.1316 to 8.7228, saving to ./libcity/cache/10023/model_cache/GWNET_CHITaxi20190406_epoch1.tar
2024-09-26 10:00:22 INFO     epoch complete!
2024-09-26 10:00:22 INFO     evaluating now!
2024-09-26 10:00:25 INFO     Epoch [2/200] train_loss: 8.2552, val_loss: 8.1152, lr: 0.001000, 22.69s
2024-09-26 10:00:25 INFO     Saved model at 2
2024-09-26 10:00:25 INFO     Val loss decrease from 8.7228 to 8.1152, saving to ./libcity/cache/10023/model_cache/GWNET_CHITaxi20190406_epoch2.tar
2024-09-26 10:00:45 INFO     epoch complete!
2024-09-26 10:00:45 INFO     evaluating now!
2024-09-26 10:00:47 INFO     Epoch [3/200] train_loss: 8.2273, val_loss: 8.7254, lr: 0.001000, 22.47s
2024-09-26 10:01:07 INFO     epoch complete!
2024-09-26 10:01:07 INFO     evaluating now!
2024-09-26 10:01:09 INFO     Epoch [4/200] train_loss: 7.8779, val_loss: 10.8076, lr: 0.001000, 21.98s
2024-09-26 10:01:29 INFO     epoch complete!
2024-09-26 10:01:29 INFO     evaluating now!
2024-09-26 10:01:31 INFO     Epoch [5/200] train_loss: 7.6822, val_loss: 8.1182, lr: 0.001000, 21.95s
2024-09-26 10:01:51 INFO     epoch complete!
2024-09-26 10:01:51 INFO     evaluating now!
2024-09-26 10:01:53 INFO     Epoch [6/200] train_loss: 7.5536, val_loss: 7.4225, lr: 0.001000, 22.18s
2024-09-26 10:01:54 INFO     Saved model at 6
2024-09-26 10:01:54 INFO     Val loss decrease from 8.1152 to 7.4225, saving to ./libcity/cache/10023/model_cache/GWNET_CHITaxi20190406_epoch6.tar
2024-09-26 10:02:14 INFO     epoch complete!
2024-09-26 10:02:14 INFO     evaluating now!
2024-09-26 10:02:16 INFO     Epoch [7/200] train_loss: 7.5457, val_loss: 8.0652, lr: 0.001000, 22.65s
2024-09-26 10:02:37 INFO     epoch complete!
2024-09-26 10:02:37 INFO     evaluating now!
2024-09-26 10:02:39 INFO     Epoch [8/200] train_loss: 6.6629, val_loss: 5.7303, lr: 0.001000, 22.51s
2024-09-26 10:02:39 INFO     Saved model at 8
2024-09-26 10:02:39 INFO     Val loss decrease from 7.4225 to 5.7303, saving to ./libcity/cache/10023/model_cache/GWNET_CHITaxi20190406_epoch8.tar
2024-09-26 10:02:59 INFO     epoch complete!
2024-09-26 10:02:59 INFO     evaluating now!
2024-09-26 10:03:01 INFO     Epoch [9/200] train_loss: 5.9280, val_loss: 8.5734, lr: 0.001000, 22.28s
2024-09-26 10:03:22 INFO     epoch complete!
2024-09-26 10:03:22 INFO     evaluating now!
2024-09-26 10:03:24 INFO     Epoch [10/200] train_loss: 5.6748, val_loss: 6.5224, lr: 0.001000, 22.57s
2024-09-26 10:03:44 INFO     epoch complete!
2024-09-26 10:03:44 INFO     evaluating now!
2024-09-26 10:03:47 INFO     Epoch [11/200] train_loss: 5.4458, val_loss: 7.9401, lr: 0.001000, 22.62s
2024-09-26 10:04:07 INFO     epoch complete!
2024-09-26 10:04:07 INFO     evaluating now!
2024-09-26 10:04:09 INFO     Epoch [12/200] train_loss: 5.3975, val_loss: 7.3256, lr: 0.001000, 22.12s
2024-09-26 10:04:29 INFO     epoch complete!
2024-09-26 10:04:29 INFO     evaluating now!
2024-09-26 10:04:31 INFO     Epoch [13/200] train_loss: 5.2493, val_loss: 6.3694, lr: 0.001000, 22.12s
2024-09-26 10:04:51 INFO     epoch complete!
2024-09-26 10:04:51 INFO     evaluating now!
2024-09-26 10:04:53 INFO     Epoch [14/200] train_loss: 5.1835, val_loss: 5.4563, lr: 0.001000, 22.21s
2024-09-26 10:04:53 INFO     Saved model at 14
2024-09-26 10:04:53 INFO     Val loss decrease from 5.7303 to 5.4563, saving to ./libcity/cache/10023/model_cache/GWNET_CHITaxi20190406_epoch14.tar
2024-09-26 10:05:13 INFO     epoch complete!
2024-09-26 10:05:13 INFO     evaluating now!
2024-09-26 10:05:15 INFO     Epoch [15/200] train_loss: 5.0594, val_loss: 5.3917, lr: 0.001000, 22.12s
2024-09-26 10:05:15 INFO     Saved model at 15
2024-09-26 10:05:15 INFO     Val loss decrease from 5.4563 to 5.3917, saving to ./libcity/cache/10023/model_cache/GWNET_CHITaxi20190406_epoch15.tar
2024-09-26 10:05:36 INFO     epoch complete!
2024-09-26 10:05:36 INFO     evaluating now!
2024-09-26 10:05:38 INFO     Epoch [16/200] train_loss: 5.0199, val_loss: 5.4401, lr: 0.001000, 22.28s
2024-09-26 10:05:58 INFO     epoch complete!
2024-09-26 10:05:58 INFO     evaluating now!
2024-09-26 10:06:00 INFO     Epoch [17/200] train_loss: 4.9364, val_loss: 5.0977, lr: 0.001000, 22.26s
2024-09-26 10:06:00 INFO     Saved model at 17
2024-09-26 10:06:00 INFO     Val loss decrease from 5.3917 to 5.0977, saving to ./libcity/cache/10023/model_cache/GWNET_CHITaxi20190406_epoch17.tar
2024-09-26 10:06:20 INFO     epoch complete!
2024-09-26 10:06:20 INFO     evaluating now!
2024-09-26 10:06:22 INFO     Epoch [18/200] train_loss: 4.9937, val_loss: 5.3777, lr: 0.001000, 22.13s
2024-09-26 10:06:43 INFO     epoch complete!
2024-09-26 10:06:43 INFO     evaluating now!
2024-09-26 10:06:45 INFO     Epoch [19/200] train_loss: 4.8480, val_loss: 5.1650, lr: 0.001000, 22.46s
2024-09-26 10:07:05 INFO     epoch complete!
2024-09-26 10:07:05 INFO     evaluating now!
2024-09-26 10:07:07 INFO     Epoch [20/200] train_loss: 4.7920, val_loss: 7.1330, lr: 0.001000, 22.61s
2024-09-26 10:07:28 INFO     epoch complete!
2024-09-26 10:07:28 INFO     evaluating now!
2024-09-26 10:07:30 INFO     Epoch [21/200] train_loss: 4.7352, val_loss: 7.3430, lr: 0.001000, 22.40s
2024-09-26 10:07:50 INFO     epoch complete!
2024-09-26 10:07:50 INFO     evaluating now!
2024-09-26 10:07:52 INFO     Epoch [22/200] train_loss: 4.7442, val_loss: 9.0722, lr: 0.001000, 22.39s
2024-09-26 10:08:12 INFO     epoch complete!
2024-09-26 10:08:12 INFO     evaluating now!
2024-09-26 10:08:14 INFO     Epoch [23/200] train_loss: 4.6599, val_loss: 5.8088, lr: 0.001000, 22.18s
2024-09-26 10:08:34 INFO     epoch complete!
2024-09-26 10:08:34 INFO     evaluating now!
2024-09-26 10:08:36 INFO     Epoch [24/200] train_loss: 4.6032, val_loss: 6.1275, lr: 0.001000, 22.07s
2024-09-26 10:08:56 INFO     epoch complete!
2024-09-26 10:08:56 INFO     evaluating now!
2024-09-26 10:08:58 INFO     Epoch [25/200] train_loss: 4.5681, val_loss: 9.7705, lr: 0.001000, 22.09s
2024-09-26 10:09:19 INFO     epoch complete!
2024-09-26 10:09:19 INFO     evaluating now!
2024-09-26 10:09:21 INFO     Epoch [26/200] train_loss: 4.5586, val_loss: 5.4894, lr: 0.001000, 22.11s
2024-09-26 10:09:41 INFO     epoch complete!
2024-09-26 10:09:41 INFO     evaluating now!
2024-09-26 10:09:43 INFO     Epoch [27/200] train_loss: 4.5163, val_loss: 5.5687, lr: 0.001000, 22.39s
2024-09-26 10:10:03 INFO     epoch complete!
2024-09-26 10:10:03 INFO     evaluating now!
2024-09-26 10:10:05 INFO     Epoch [28/200] train_loss: 4.4607, val_loss: 5.4721, lr: 0.001000, 22.17s
2024-09-26 10:10:25 INFO     epoch complete!
2024-09-26 10:10:25 INFO     evaluating now!
2024-09-26 10:10:27 INFO     Epoch [29/200] train_loss: 4.4028, val_loss: 7.7516, lr: 0.001000, 22.12s
2024-09-26 10:10:47 INFO     epoch complete!
2024-09-26 10:10:47 INFO     evaluating now!
2024-09-26 10:10:49 INFO     Epoch [30/200] train_loss: 4.4601, val_loss: 5.2038, lr: 0.001000, 22.17s
2024-09-26 10:11:09 INFO     epoch complete!
2024-09-26 10:11:09 INFO     evaluating now!
2024-09-26 10:11:12 INFO     Epoch [31/200] train_loss: 4.3424, val_loss: 5.0204, lr: 0.001000, 22.05s
2024-09-26 10:11:12 INFO     Saved model at 31
2024-09-26 10:11:12 INFO     Val loss decrease from 5.0977 to 5.0204, saving to ./libcity/cache/10023/model_cache/GWNET_CHITaxi20190406_epoch31.tar
2024-09-26 10:11:32 INFO     epoch complete!
2024-09-26 10:11:32 INFO     evaluating now!
2024-09-26 10:11:34 INFO     Epoch [32/200] train_loss: 4.3882, val_loss: 5.2907, lr: 0.001000, 22.50s
2024-09-26 10:11:56 INFO     epoch complete!
2024-09-26 10:11:56 INFO     evaluating now!
2024-09-26 10:11:58 INFO     Epoch [33/200] train_loss: 4.2987, val_loss: 6.3622, lr: 0.001000, 23.87s
2024-09-26 10:12:20 INFO     epoch complete!
2024-09-26 10:12:20 INFO     evaluating now!
2024-09-26 10:12:23 INFO     Epoch [34/200] train_loss: 4.3328, val_loss: 6.5330, lr: 0.001000, 24.55s
2024-09-26 10:12:45 INFO     epoch complete!
2024-09-26 10:12:45 INFO     evaluating now!
2024-09-26 10:12:47 INFO     Epoch [35/200] train_loss: 4.2901, val_loss: 10.1731, lr: 0.001000, 24.44s
2024-09-26 10:13:10 INFO     epoch complete!
2024-09-26 10:13:10 INFO     evaluating now!
2024-09-26 10:13:12 INFO     Epoch [36/200] train_loss: 4.2524, val_loss: 5.3600, lr: 0.001000, 24.83s
2024-09-26 10:13:34 INFO     epoch complete!
2024-09-26 10:13:34 INFO     evaluating now!
2024-09-26 10:13:37 INFO     Epoch [37/200] train_loss: 4.3277, val_loss: 5.8632, lr: 0.001000, 24.54s
2024-09-26 10:13:59 INFO     epoch complete!
2024-09-26 10:13:59 INFO     evaluating now!
2024-09-26 10:14:01 INFO     Epoch [38/200] train_loss: 4.2896, val_loss: 6.0137, lr: 0.001000, 24.52s
2024-09-26 10:14:23 INFO     epoch complete!
2024-09-26 10:14:23 INFO     evaluating now!
2024-09-26 10:14:26 INFO     Epoch [39/200] train_loss: 4.1921, val_loss: 4.8248, lr: 0.001000, 24.43s
2024-09-26 10:14:26 INFO     Saved model at 39
2024-09-26 10:14:26 INFO     Val loss decrease from 5.0204 to 4.8248, saving to ./libcity/cache/10023/model_cache/GWNET_CHITaxi20190406_epoch39.tar
2024-09-26 10:14:47 INFO     epoch complete!
2024-09-26 10:14:47 INFO     evaluating now!
2024-09-26 10:14:49 INFO     Epoch [40/200] train_loss: 4.1966, val_loss: 5.4051, lr: 0.001000, 23.75s
2024-09-26 10:15:10 INFO     epoch complete!
2024-09-26 10:15:10 INFO     evaluating now!
2024-09-26 10:15:12 INFO     Epoch [41/200] train_loss: 4.2135, val_loss: 5.1002, lr: 0.001000, 22.55s
2024-09-26 10:15:32 INFO     epoch complete!
2024-09-26 10:15:32 INFO     evaluating now!
2024-09-26 10:15:34 INFO     Epoch [42/200] train_loss: 4.1276, val_loss: 7.3259, lr: 0.001000, 22.43s
2024-09-26 10:15:54 INFO     epoch complete!
2024-09-26 10:15:54 INFO     evaluating now!
2024-09-26 10:15:57 INFO     Epoch [43/200] train_loss: 4.1419, val_loss: 6.6369, lr: 0.001000, 22.17s
2024-09-26 10:16:17 INFO     epoch complete!
2024-09-26 10:16:17 INFO     evaluating now!
2024-09-26 10:16:19 INFO     Epoch [44/200] train_loss: 4.2094, val_loss: 5.2541, lr: 0.001000, 22.29s
2024-09-26 10:16:39 INFO     epoch complete!
2024-09-26 10:16:39 INFO     evaluating now!
2024-09-26 10:16:41 INFO     Epoch [45/200] train_loss: 4.1302, val_loss: 7.0802, lr: 0.001000, 22.48s
2024-09-26 10:17:02 INFO     epoch complete!
2024-09-26 10:17:02 INFO     evaluating now!
2024-09-26 10:17:04 INFO     Epoch [46/200] train_loss: 4.1094, val_loss: 4.7847, lr: 0.001000, 22.44s
2024-09-26 10:17:04 INFO     Saved model at 46
2024-09-26 10:17:04 INFO     Val loss decrease from 4.8248 to 4.7847, saving to ./libcity/cache/10023/model_cache/GWNET_CHITaxi20190406_epoch46.tar
2024-09-26 10:17:24 INFO     epoch complete!
2024-09-26 10:17:24 INFO     evaluating now!
2024-09-26 10:17:26 INFO     Epoch [47/200] train_loss: 4.0488, val_loss: 4.8331, lr: 0.001000, 22.20s
2024-09-26 10:17:46 INFO     epoch complete!
2024-09-26 10:17:46 INFO     evaluating now!
2024-09-26 10:17:48 INFO     Epoch [48/200] train_loss: 4.0331, val_loss: 10.6650, lr: 0.001000, 21.97s
2024-09-26 10:18:08 INFO     epoch complete!
2024-09-26 10:18:08 INFO     evaluating now!
2024-09-26 10:18:10 INFO     Epoch [49/200] train_loss: 4.0324, val_loss: 5.1219, lr: 0.001000, 22.10s
2024-09-26 10:18:30 INFO     epoch complete!
2024-09-26 10:18:30 INFO     evaluating now!
2024-09-26 10:18:32 INFO     Epoch [50/200] train_loss: 3.9565, val_loss: 5.0725, lr: 0.001000, 21.89s
2024-09-26 10:18:52 INFO     epoch complete!
2024-09-26 10:18:52 INFO     evaluating now!
2024-09-26 10:18:54 INFO     Epoch [51/200] train_loss: 3.9775, val_loss: 5.3597, lr: 0.001000, 22.18s
2024-09-26 10:19:15 INFO     epoch complete!
2024-09-26 10:19:15 INFO     evaluating now!
2024-09-26 10:19:17 INFO     Epoch [52/200] train_loss: 3.9877, val_loss: 4.8677, lr: 0.001000, 22.36s
2024-09-26 10:19:37 INFO     epoch complete!
2024-09-26 10:19:37 INFO     evaluating now!
2024-09-26 10:19:39 INFO     Epoch [53/200] train_loss: 4.0186, val_loss: 4.8071, lr: 0.001000, 22.36s
2024-09-26 10:19:59 INFO     epoch complete!
2024-09-26 10:19:59 INFO     evaluating now!
2024-09-26 10:20:01 INFO     Epoch [54/200] train_loss: 3.9314, val_loss: 6.2720, lr: 0.001000, 22.15s
2024-09-26 10:20:21 INFO     epoch complete!
2024-09-26 10:20:21 INFO     evaluating now!
2024-09-26 10:20:23 INFO     Epoch [55/200] train_loss: 3.9306, val_loss: 5.1066, lr: 0.001000, 22.18s
2024-09-26 10:20:44 INFO     epoch complete!
2024-09-26 10:20:44 INFO     evaluating now!
2024-09-26 10:20:46 INFO     Epoch [56/200] train_loss: 3.9026, val_loss: 4.9808, lr: 0.001000, 22.35s
2024-09-26 10:21:06 INFO     epoch complete!
2024-09-26 10:21:06 INFO     evaluating now!
2024-09-26 10:21:08 INFO     Epoch [57/200] train_loss: 3.9068, val_loss: 8.9783, lr: 0.001000, 22.65s
2024-09-26 10:21:29 INFO     epoch complete!
2024-09-26 10:21:29 INFO     evaluating now!
2024-09-26 10:21:31 INFO     Epoch [58/200] train_loss: 3.8925, val_loss: 4.9942, lr: 0.001000, 22.96s
2024-09-26 10:21:52 INFO     epoch complete!
2024-09-26 10:21:52 INFO     evaluating now!
2024-09-26 10:21:54 INFO     Epoch [59/200] train_loss: 3.8884, val_loss: 4.7743, lr: 0.001000, 22.85s
2024-09-26 10:21:54 INFO     Saved model at 59
2024-09-26 10:21:54 INFO     Val loss decrease from 4.7847 to 4.7743, saving to ./libcity/cache/10023/model_cache/GWNET_CHITaxi20190406_epoch59.tar
2024-09-26 10:22:15 INFO     epoch complete!
2024-09-26 10:22:15 INFO     evaluating now!
2024-09-26 10:22:17 INFO     Epoch [60/200] train_loss: 3.8728, val_loss: 7.0906, lr: 0.001000, 22.87s
2024-09-26 10:22:38 INFO     epoch complete!
2024-09-26 10:22:38 INFO     evaluating now!
2024-09-26 10:22:40 INFO     Epoch [61/200] train_loss: 3.8815, val_loss: 6.6939, lr: 0.001000, 22.90s
2024-09-26 10:23:01 INFO     epoch complete!
2024-09-26 10:23:01 INFO     evaluating now!
2024-09-26 10:23:03 INFO     Epoch [62/200] train_loss: 3.8299, val_loss: 4.7262, lr: 0.001000, 22.94s
2024-09-26 10:23:03 INFO     Saved model at 62
2024-09-26 10:23:03 INFO     Val loss decrease from 4.7743 to 4.7262, saving to ./libcity/cache/10023/model_cache/GWNET_CHITaxi20190406_epoch62.tar
2024-09-26 10:23:24 INFO     epoch complete!
2024-09-26 10:23:24 INFO     evaluating now!
2024-09-26 10:23:26 INFO     Epoch [63/200] train_loss: 3.8569, val_loss: 5.3129, lr: 0.001000, 22.92s
2024-09-26 10:23:47 INFO     epoch complete!
2024-09-26 10:23:47 INFO     evaluating now!
2024-09-26 10:23:49 INFO     Epoch [64/200] train_loss: 3.8159, val_loss: 5.2042, lr: 0.001000, 22.86s
2024-09-26 10:24:10 INFO     epoch complete!
2024-09-26 10:24:10 INFO     evaluating now!
2024-09-26 10:24:12 INFO     Epoch [65/200] train_loss: 3.8087, val_loss: 6.2745, lr: 0.001000, 22.99s
2024-09-26 10:24:33 INFO     epoch complete!
2024-09-26 10:24:33 INFO     evaluating now!
2024-09-26 10:24:35 INFO     Epoch [66/200] train_loss: 3.8046, val_loss: 4.6067, lr: 0.001000, 22.91s
2024-09-26 10:24:35 INFO     Saved model at 66
2024-09-26 10:24:35 INFO     Val loss decrease from 4.7262 to 4.6067, saving to ./libcity/cache/10023/model_cache/GWNET_CHITaxi20190406_epoch66.tar
2024-09-26 10:24:56 INFO     epoch complete!
2024-09-26 10:24:56 INFO     evaluating now!
2024-09-26 10:24:58 INFO     Epoch [67/200] train_loss: 3.7718, val_loss: 5.2553, lr: 0.001000, 23.07s
2024-09-26 10:25:19 INFO     epoch complete!
2024-09-26 10:25:19 INFO     evaluating now!
2024-09-26 10:25:21 INFO     Epoch [68/200] train_loss: 3.7524, val_loss: 4.9310, lr: 0.001000, 22.82s
2024-09-26 10:25:42 INFO     epoch complete!
2024-09-26 10:25:42 INFO     evaluating now!
2024-09-26 10:25:44 INFO     Epoch [69/200] train_loss: 3.7583, val_loss: 5.1220, lr: 0.001000, 22.85s
2024-09-26 10:26:05 INFO     epoch complete!
2024-09-26 10:26:05 INFO     evaluating now!
2024-09-26 10:26:08 INFO     Epoch [70/200] train_loss: 3.7484, val_loss: 4.7176, lr: 0.001000, 23.63s
2024-09-26 10:26:29 INFO     epoch complete!
2024-09-26 10:26:29 INFO     evaluating now!
2024-09-26 10:26:32 INFO     Epoch [71/200] train_loss: 3.7289, val_loss: 5.6532, lr: 0.001000, 24.02s
2024-09-26 10:26:53 INFO     epoch complete!
2024-09-26 10:26:53 INFO     evaluating now!
2024-09-26 10:26:56 INFO     Epoch [72/200] train_loss: 3.7346, val_loss: 5.0322, lr: 0.001000, 24.00s
2024-09-26 10:27:17 INFO     epoch complete!
2024-09-26 10:27:17 INFO     evaluating now!
2024-09-26 10:27:20 INFO     Epoch [73/200] train_loss: 3.7209, val_loss: 4.9313, lr: 0.001000, 24.12s
2024-09-26 10:27:41 INFO     epoch complete!
2024-09-26 10:27:41 INFO     evaluating now!
2024-09-26 10:27:44 INFO     Epoch [74/200] train_loss: 3.7226, val_loss: 6.8734, lr: 0.001000, 24.10s
2024-09-26 10:28:06 INFO     epoch complete!
2024-09-26 10:28:06 INFO     evaluating now!
2024-09-26 10:28:08 INFO     Epoch [75/200] train_loss: 3.6837, val_loss: 4.8760, lr: 0.001000, 24.18s
2024-09-26 10:28:29 INFO     epoch complete!
2024-09-26 10:28:29 INFO     evaluating now!
2024-09-26 10:28:32 INFO     Epoch [76/200] train_loss: 3.7045, val_loss: 4.7797, lr: 0.001000, 23.65s
2024-09-26 10:28:53 INFO     epoch complete!
2024-09-26 10:28:53 INFO     evaluating now!
2024-09-26 10:28:55 INFO     Epoch [77/200] train_loss: 3.6843, val_loss: 4.9435, lr: 0.001000, 23.69s
2024-09-26 10:29:17 INFO     epoch complete!
2024-09-26 10:29:17 INFO     evaluating now!
2024-09-26 10:29:19 INFO     Epoch [78/200] train_loss: 3.7015, val_loss: 4.7479, lr: 0.001000, 23.51s
2024-09-26 10:29:40 INFO     epoch complete!
2024-09-26 10:29:40 INFO     evaluating now!
2024-09-26 10:29:43 INFO     Epoch [79/200] train_loss: 3.6666, val_loss: 4.8257, lr: 0.001000, 23.78s
2024-09-26 10:30:04 INFO     epoch complete!
2024-09-26 10:30:04 INFO     evaluating now!
2024-09-26 10:30:06 INFO     Epoch [80/200] train_loss: 3.6513, val_loss: 4.8422, lr: 0.001000, 23.80s
2024-09-26 10:30:28 INFO     epoch complete!
2024-09-26 10:30:28 INFO     evaluating now!
2024-09-26 10:30:30 INFO     Epoch [81/200] train_loss: 3.6464, val_loss: 5.5069, lr: 0.001000, 24.00s
2024-09-26 10:30:30 WARNING  Early stopping at epoch: 81
2024-09-26 10:30:30 INFO     Trained totally 82 epochs, average train time is 20.628s, average eval time is 2.182s
2024-09-26 10:30:31 INFO     Loaded model at 66
2024-09-26 10:30:31 INFO     Saved model at ./libcity/cache/10023/model_cache/GWNET_CHITaxi20190406.m
2024-09-26 10:30:31 INFO     Start evaluating ...
2024-09-26 10:30:36 INFO     Note that you select the single mode to evaluate!
2024-09-26 10:30:36 INFO     Evaluate result is saved at ./libcity/cache/10023/evaluate_cache/2024_09_26_10_30_36_GWNET_CHITaxi20190406.csv
2024-09-26 10:30:36 INFO     
         MAE       RMSE
1   2.237830   6.675028
2   2.395590   7.708911
3   2.575177   8.565621
4   2.696936   9.249364
5   2.847409  10.011726
6   2.942841  10.836033
7   3.108631  11.767782
8   3.206287  12.432298
9   3.240282  12.715264
10  3.335652  13.110866
11  3.379418  13.102915
12  3.450928  13.231159
2024-09-26 10:30:37 INFO     ----------------------------------------------------------------------------
2024-09-26 10:30:37 INFO     # 4, Kownledge Graph Embedding: TransE, Experiment ids: 10024
2024-09-26 10:30:37 INFO     ----------------------------------------------------------------------------
2024-09-26 10:30:37 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=10024
2024-09-26 10:30:37 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10024, 'ke_model': 'TransE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-26 10:30:37 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-26 10:30:37 INFO     set_weight_link_or_dist: dist
2024-09-26 10:30:37 INFO     init_weight_inf_or_zero: inf
2024-09-26 10:30:37 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-26 10:30:37 INFO     Start Calculate the weight by Gauss kernel!
2024-09-26 10:30:37 INFO     Loading file CHITaxi20190406.dyna
2024-09-26 10:30:37 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-26 10:30:40 INFO     Dataset created
2024-09-26 10:30:40 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-26 10:30:40 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-26 10:30:40 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-26 10:30:40 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-26 10:30:40 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-26 10:30:40 INFO     NoneScaler
2024-09-26 10:30:42 INFO     add adj_mx to supports
2024-09-26 10:30:42 INFO     add apt_adj(v1 * v2) in forward process
2024-09-26 10:30:42 INFO     receptive_field: 14
2024-09-26 10:30:42 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(34, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-26 10:30:42 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-26 10:30:42 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-26 10:30:42 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 10:30:42 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 10:30:42 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 10:30:42 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 10:30:42 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 10:30:42 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 10:30:42 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 10:30:42 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 10:30:42 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 10:30:42 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 10:30:42 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 10:30:42 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 10:30:42 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 10:30:42 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 10:30:42 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 10:30:42 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-26 10:30:42 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-26 10:30:42 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-26 10:30:42 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-26 10:30:42 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-26 10:30:42 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-26 10:30:42 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-26 10:30:42 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-26 10:30:42 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-26 10:30:42 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     start_conv.weight	torch.Size([32, 34, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-26 10:30:42 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-26 10:30:42 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-26 10:30:42 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-26 10:30:42 INFO     Total parameter numbers: 307824
2024-09-26 10:30:42 INFO     You select `adam` optimizer.
2024-09-26 10:30:42 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-26 10:30:42 INFO     Start training ...
2024-09-26 10:30:42 INFO     num_batches:96
2024-09-26 10:31:03 INFO     epoch complete!
2024-09-26 10:31:03 INFO     evaluating now!
2024-09-26 10:31:06 INFO     Epoch [0/200] train_loss: 12.5838, val_loss: 10.7124, lr: 0.001000, 23.48s
2024-09-26 10:31:06 INFO     Saved model at 0
2024-09-26 10:31:06 INFO     Val loss decrease from inf to 10.7124, saving to ./libcity/cache/10024/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-26 10:31:27 INFO     epoch complete!
2024-09-26 10:31:27 INFO     evaluating now!
2024-09-26 10:31:30 INFO     Epoch [1/200] train_loss: 8.7341, val_loss: 11.4435, lr: 0.001000, 23.94s
2024-09-26 10:31:51 INFO     epoch complete!
2024-09-26 10:31:51 INFO     evaluating now!
2024-09-26 10:31:53 INFO     Epoch [2/200] train_loss: 8.0979, val_loss: 8.1159, lr: 0.001000, 23.59s
2024-09-26 10:31:53 INFO     Saved model at 2
2024-09-26 10:31:53 INFO     Val loss decrease from 10.7124 to 8.1159, saving to ./libcity/cache/10024/model_cache/GWNET_CHITaxi20190406_epoch2.tar
2024-09-26 10:32:15 INFO     epoch complete!
2024-09-26 10:32:15 INFO     evaluating now!
2024-09-26 10:32:17 INFO     Epoch [3/200] train_loss: 8.0263, val_loss: 7.9331, lr: 0.001000, 23.39s
2024-09-26 10:32:17 INFO     Saved model at 3
2024-09-26 10:32:17 INFO     Val loss decrease from 8.1159 to 7.9331, saving to ./libcity/cache/10024/model_cache/GWNET_CHITaxi20190406_epoch3.tar
2024-09-26 10:32:38 INFO     epoch complete!
2024-09-26 10:32:38 INFO     evaluating now!
2024-09-26 10:32:41 INFO     Epoch [4/200] train_loss: 7.8755, val_loss: 8.6290, lr: 0.001000, 23.52s
2024-09-26 10:33:03 INFO     epoch complete!
2024-09-26 10:33:03 INFO     evaluating now!
2024-09-26 10:33:05 INFO     Epoch [5/200] train_loss: 7.6547, val_loss: 8.0458, lr: 0.001000, 24.30s
2024-09-26 10:33:27 INFO     epoch complete!
2024-09-26 10:33:27 INFO     evaluating now!
2024-09-26 10:33:29 INFO     Epoch [6/200] train_loss: 7.6162, val_loss: 8.4165, lr: 0.001000, 23.98s
2024-09-26 10:33:51 INFO     epoch complete!
2024-09-26 10:33:51 INFO     evaluating now!
2024-09-26 10:33:53 INFO     Epoch [7/200] train_loss: 7.2238, val_loss: 6.3565, lr: 0.001000, 24.00s
2024-09-26 10:33:53 INFO     Saved model at 7
2024-09-26 10:33:53 INFO     Val loss decrease from 7.9331 to 6.3565, saving to ./libcity/cache/10024/model_cache/GWNET_CHITaxi20190406_epoch7.tar
2024-09-26 10:34:15 INFO     epoch complete!
2024-09-26 10:34:15 INFO     evaluating now!
2024-09-26 10:34:17 INFO     Epoch [8/200] train_loss: 6.2587, val_loss: 7.9848, lr: 0.001000, 23.94s
2024-09-26 10:34:39 INFO     epoch complete!
2024-09-26 10:34:39 INFO     evaluating now!
2024-09-26 10:34:41 INFO     Epoch [9/200] train_loss: 5.9443, val_loss: 7.3215, lr: 0.001000, 24.10s
2024-09-26 10:35:03 INFO     epoch complete!
2024-09-26 10:35:03 INFO     evaluating now!
2024-09-26 10:35:05 INFO     Epoch [10/200] train_loss: 5.8755, val_loss: 5.8219, lr: 0.001000, 24.09s
2024-09-26 10:35:06 INFO     Saved model at 10
2024-09-26 10:35:06 INFO     Val loss decrease from 6.3565 to 5.8219, saving to ./libcity/cache/10024/model_cache/GWNET_CHITaxi20190406_epoch10.tar
2024-09-26 10:35:27 INFO     epoch complete!
2024-09-26 10:35:27 INFO     evaluating now!
2024-09-26 10:35:30 INFO     Epoch [11/200] train_loss: 5.5481, val_loss: 5.8854, lr: 0.001000, 23.97s
2024-09-26 10:35:51 INFO     epoch complete!
2024-09-26 10:35:51 INFO     evaluating now!
2024-09-26 10:35:54 INFO     Epoch [12/200] train_loss: 5.2835, val_loss: 7.4561, lr: 0.001000, 23.99s
2024-09-26 10:36:15 INFO     epoch complete!
2024-09-26 10:36:15 INFO     evaluating now!
2024-09-26 10:36:18 INFO     Epoch [13/200] train_loss: 5.2640, val_loss: 5.6236, lr: 0.001000, 23.93s
2024-09-26 10:36:18 INFO     Saved model at 13
2024-09-26 10:36:18 INFO     Val loss decrease from 5.8219 to 5.6236, saving to ./libcity/cache/10024/model_cache/GWNET_CHITaxi20190406_epoch13.tar
2024-09-26 10:36:39 INFO     epoch complete!
2024-09-26 10:36:39 INFO     evaluating now!
2024-09-26 10:36:42 INFO     Epoch [14/200] train_loss: 5.1502, val_loss: 5.2804, lr: 0.001000, 24.10s
2024-09-26 10:36:42 INFO     Saved model at 14
2024-09-26 10:36:42 INFO     Val loss decrease from 5.6236 to 5.2804, saving to ./libcity/cache/10024/model_cache/GWNET_CHITaxi20190406_epoch14.tar
2024-09-26 10:37:04 INFO     epoch complete!
2024-09-26 10:37:04 INFO     evaluating now!
2024-09-26 10:37:06 INFO     Epoch [15/200] train_loss: 5.1131, val_loss: 7.4106, lr: 0.001000, 24.08s
2024-09-26 10:37:28 INFO     epoch complete!
2024-09-26 10:37:28 INFO     evaluating now!
2024-09-26 10:37:30 INFO     Epoch [16/200] train_loss: 5.0587, val_loss: 5.5352, lr: 0.001000, 24.19s
2024-09-26 10:37:52 INFO     epoch complete!
2024-09-26 10:37:52 INFO     evaluating now!
2024-09-26 10:37:54 INFO     Epoch [17/200] train_loss: 4.9307, val_loss: 5.2067, lr: 0.001000, 24.03s
2024-09-26 10:37:55 INFO     Saved model at 17
2024-09-26 10:37:55 INFO     Val loss decrease from 5.2804 to 5.2067, saving to ./libcity/cache/10024/model_cache/GWNET_CHITaxi20190406_epoch17.tar
2024-09-26 10:38:16 INFO     epoch complete!
2024-09-26 10:38:16 INFO     evaluating now!
2024-09-26 10:38:19 INFO     Epoch [18/200] train_loss: 4.8217, val_loss: 8.1586, lr: 0.001000, 24.04s
2024-09-26 10:38:41 INFO     epoch complete!
2024-09-26 10:38:41 INFO     evaluating now!
2024-09-26 10:38:43 INFO     Epoch [19/200] train_loss: 4.9199, val_loss: 6.8786, lr: 0.001000, 24.06s
2024-09-26 10:39:04 INFO     epoch complete!
2024-09-26 10:39:04 INFO     evaluating now!
2024-09-26 10:39:07 INFO     Epoch [20/200] train_loss: 4.7382, val_loss: 5.7853, lr: 0.001000, 23.90s
2024-09-26 10:39:28 INFO     epoch complete!
2024-09-26 10:39:28 INFO     evaluating now!
2024-09-26 10:39:31 INFO     Epoch [21/200] train_loss: 4.6655, val_loss: 5.1991, lr: 0.001000, 23.97s
2024-09-26 10:39:31 INFO     Saved model at 21
2024-09-26 10:39:31 INFO     Val loss decrease from 5.2067 to 5.1991, saving to ./libcity/cache/10024/model_cache/GWNET_CHITaxi20190406_epoch21.tar
2024-09-26 10:39:53 INFO     epoch complete!
2024-09-26 10:39:53 INFO     evaluating now!
2024-09-26 10:39:55 INFO     Epoch [22/200] train_loss: 4.6917, val_loss: 5.6083, lr: 0.001000, 24.25s
2024-09-26 10:40:17 INFO     epoch complete!
2024-09-26 10:40:17 INFO     evaluating now!
2024-09-26 10:40:19 INFO     Epoch [23/200] train_loss: 4.6709, val_loss: 5.2732, lr: 0.001000, 24.26s
2024-09-26 10:40:42 INFO     epoch complete!
2024-09-26 10:40:42 INFO     evaluating now!
2024-09-26 10:40:44 INFO     Epoch [24/200] train_loss: 4.6177, val_loss: 6.6725, lr: 0.001000, 24.39s
2024-09-26 10:41:06 INFO     epoch complete!
2024-09-26 10:41:06 INFO     evaluating now!
2024-09-26 10:41:08 INFO     Epoch [25/200] train_loss: 4.5364, val_loss: 5.5332, lr: 0.001000, 24.34s
2024-09-26 10:41:30 INFO     epoch complete!
2024-09-26 10:41:30 INFO     evaluating now!
2024-09-26 10:41:33 INFO     Epoch [26/200] train_loss: 4.5215, val_loss: 6.0380, lr: 0.001000, 24.33s
2024-09-26 10:41:54 INFO     epoch complete!
2024-09-26 10:41:54 INFO     evaluating now!
2024-09-26 10:41:57 INFO     Epoch [27/200] train_loss: 4.4845, val_loss: 5.1653, lr: 0.001000, 24.29s
2024-09-26 10:41:57 INFO     Saved model at 27
2024-09-26 10:41:57 INFO     Val loss decrease from 5.1991 to 5.1653, saving to ./libcity/cache/10024/model_cache/GWNET_CHITaxi20190406_epoch27.tar
2024-09-26 10:42:19 INFO     epoch complete!
2024-09-26 10:42:19 INFO     evaluating now!
2024-09-26 10:42:21 INFO     Epoch [28/200] train_loss: 4.4742, val_loss: 5.8798, lr: 0.001000, 24.14s
2024-09-26 10:42:43 INFO     epoch complete!
2024-09-26 10:42:43 INFO     evaluating now!
2024-09-26 10:42:46 INFO     Epoch [29/200] train_loss: 4.3840, val_loss: 5.6444, lr: 0.001000, 24.29s
2024-09-26 10:43:07 INFO     epoch complete!
2024-09-26 10:43:07 INFO     evaluating now!
2024-09-26 10:43:10 INFO     Epoch [30/200] train_loss: 4.3758, val_loss: 5.3802, lr: 0.001000, 24.23s
2024-09-26 10:43:32 INFO     epoch complete!
2024-09-26 10:43:32 INFO     evaluating now!
2024-09-26 10:43:34 INFO     Epoch [31/200] train_loss: 4.3384, val_loss: 5.3257, lr: 0.001000, 24.16s
2024-09-26 10:43:56 INFO     epoch complete!
2024-09-26 10:43:56 INFO     evaluating now!
2024-09-26 10:43:58 INFO     Epoch [32/200] train_loss: 4.3210, val_loss: 5.4249, lr: 0.001000, 24.25s
2024-09-26 10:44:20 INFO     epoch complete!
2024-09-26 10:44:20 INFO     evaluating now!
2024-09-26 10:44:22 INFO     Epoch [33/200] train_loss: 4.2820, val_loss: 5.2880, lr: 0.001000, 24.14s
2024-09-26 10:44:44 INFO     epoch complete!
2024-09-26 10:44:44 INFO     evaluating now!
2024-09-26 10:44:47 INFO     Epoch [34/200] train_loss: 4.2568, val_loss: 4.9282, lr: 0.001000, 24.18s
2024-09-26 10:44:47 INFO     Saved model at 34
2024-09-26 10:44:47 INFO     Val loss decrease from 5.1653 to 4.9282, saving to ./libcity/cache/10024/model_cache/GWNET_CHITaxi20190406_epoch34.tar
2024-09-26 10:45:08 INFO     epoch complete!
2024-09-26 10:45:08 INFO     evaluating now!
2024-09-26 10:45:11 INFO     Epoch [35/200] train_loss: 4.2301, val_loss: 4.8967, lr: 0.001000, 24.07s
2024-09-26 10:45:11 INFO     Saved model at 35
2024-09-26 10:45:11 INFO     Val loss decrease from 4.9282 to 4.8967, saving to ./libcity/cache/10024/model_cache/GWNET_CHITaxi20190406_epoch35.tar
2024-09-26 10:45:33 INFO     epoch complete!
2024-09-26 10:45:33 INFO     evaluating now!
2024-09-26 10:45:35 INFO     Epoch [36/200] train_loss: 4.2226, val_loss: 5.3350, lr: 0.001000, 24.17s
2024-09-26 10:45:57 INFO     epoch complete!
2024-09-26 10:45:57 INFO     evaluating now!
2024-09-26 10:45:59 INFO     Epoch [37/200] train_loss: 4.2290, val_loss: 7.3521, lr: 0.001000, 24.15s
2024-09-26 10:46:21 INFO     epoch complete!
2024-09-26 10:46:21 INFO     evaluating now!
2024-09-26 10:46:23 INFO     Epoch [38/200] train_loss: 4.1748, val_loss: 6.3605, lr: 0.001000, 23.98s
2024-09-26 10:46:45 INFO     epoch complete!
2024-09-26 10:46:45 INFO     evaluating now!
2024-09-26 10:46:47 INFO     Epoch [39/200] train_loss: 4.1226, val_loss: 6.1117, lr: 0.001000, 24.00s
2024-09-26 10:47:09 INFO     epoch complete!
2024-09-26 10:47:09 INFO     evaluating now!
2024-09-26 10:47:12 INFO     Epoch [40/200] train_loss: 4.1912, val_loss: 4.9664, lr: 0.001000, 24.22s
2024-09-26 10:47:33 INFO     epoch complete!
2024-09-26 10:47:33 INFO     evaluating now!
2024-09-26 10:47:36 INFO     Epoch [41/200] train_loss: 4.1300, val_loss: 6.7578, lr: 0.001000, 24.23s
2024-09-26 10:47:58 INFO     epoch complete!
2024-09-26 10:47:58 INFO     evaluating now!
2024-09-26 10:48:00 INFO     Epoch [42/200] train_loss: 4.1163, val_loss: 7.2994, lr: 0.001000, 24.27s
2024-09-26 10:48:22 INFO     epoch complete!
2024-09-26 10:48:22 INFO     evaluating now!
2024-09-26 10:48:24 INFO     Epoch [43/200] train_loss: 4.1399, val_loss: 6.7623, lr: 0.001000, 24.30s
2024-09-26 10:48:46 INFO     epoch complete!
2024-09-26 10:48:46 INFO     evaluating now!
2024-09-26 10:48:49 INFO     Epoch [44/200] train_loss: 4.0043, val_loss: 5.4917, lr: 0.001000, 24.33s
2024-09-26 10:49:11 INFO     epoch complete!
2024-09-26 10:49:11 INFO     evaluating now!
2024-09-26 10:49:13 INFO     Epoch [45/200] train_loss: 4.0071, val_loss: 4.9795, lr: 0.001000, 24.21s
2024-09-26 10:49:35 INFO     epoch complete!
2024-09-26 10:49:35 INFO     evaluating now!
2024-09-26 10:49:37 INFO     Epoch [46/200] train_loss: 4.0387, val_loss: 7.6849, lr: 0.001000, 24.25s
2024-09-26 10:49:59 INFO     epoch complete!
2024-09-26 10:49:59 INFO     evaluating now!
2024-09-26 10:50:01 INFO     Epoch [47/200] train_loss: 3.9973, val_loss: 5.0910, lr: 0.001000, 24.25s
2024-09-26 10:50:23 INFO     epoch complete!
2024-09-26 10:50:23 INFO     evaluating now!
2024-09-26 10:50:26 INFO     Epoch [48/200] train_loss: 3.9612, val_loss: 7.3470, lr: 0.001000, 24.22s
2024-09-26 10:50:48 INFO     epoch complete!
2024-09-26 10:50:48 INFO     evaluating now!
2024-09-26 10:50:50 INFO     Epoch [49/200] train_loss: 3.9672, val_loss: 7.1163, lr: 0.001000, 24.29s
2024-09-26 10:51:12 INFO     epoch complete!
2024-09-26 10:51:12 INFO     evaluating now!
2024-09-26 10:51:14 INFO     Epoch [50/200] train_loss: 3.9614, val_loss: 5.9034, lr: 0.001000, 24.21s
2024-09-26 10:51:14 WARNING  Early stopping at epoch: 50
2024-09-26 10:51:14 INFO     Trained totally 51 epochs, average train time is 21.757s, average eval time is 2.339s
2024-09-26 10:51:14 INFO     Loaded model at 35
2024-09-26 10:51:14 INFO     Saved model at ./libcity/cache/10024/model_cache/GWNET_CHITaxi20190406.m
2024-09-26 10:51:14 INFO     Start evaluating ...
2024-09-26 10:51:20 INFO     Note that you select the single mode to evaluate!
2024-09-26 10:51:20 INFO     Evaluate result is saved at ./libcity/cache/10024/evaluate_cache/2024_09_26_10_51_20_GWNET_CHITaxi20190406.csv
2024-09-26 10:51:20 INFO     
         MAE       RMSE
1   2.216208   6.698346
2   2.370097   7.719548
3   2.561307   8.926497
4   2.773904  10.024981
5   2.996857  11.461861
6   3.158745  12.572444
7   3.392564  13.845476
8   3.405496  14.391992
9   3.414057  14.555894
10  3.461050  14.746923
11  3.525424  14.867723
12  3.661417  15.191962
2024-09-26 10:51:20 INFO     ----------------------------------------------------------------------------
2024-09-26 10:51:20 INFO     Kownledge Graph Embedding: TransE, Experiment ids: [10020, 10021, 10022, 10023, 10024]
2024-09-26 10:51:20 INFO     ----------------------------------------------------------------------------
2024-09-26 10:51:20 INFO     Average: 
         MAE       RMSE
0   2.323773   6.789931
1   2.498049   7.851740
2   2.708790   9.056709
3   2.898971  10.123235
4   3.085137  11.367443
5   3.239297  12.696212
6   3.414149  13.804195
7   3.447506  14.203711
8   3.486137  14.170265
9   3.512973  14.027306
10  3.554640  13.992008
11  3.656508  14.398537 
2024-09-26 10:51:20 INFO     Standard deviation: 
         MAE      RMSE
0   0.121444  0.118778
1   0.123988  0.162341
2   0.124195  0.394888
3   0.156054  0.763309
4   0.165539  1.184607
5   0.204297  1.613150
6   0.185328  1.584331
7   0.150996  1.304351
8   0.156207  0.942786
9   0.111666  0.622146
10  0.122637  0.577721
11  0.129706  0.676492
2024-09-26 10:51:20 INFO     ----------------------------------------------------------------------------
2024-09-26 10:51:20 INFO     12 steps Average: 
        MAE       RMSE
0  3.152161  11.873441
2024-09-26 10:51:20 INFO     12 steps Standard deviation: 
        MAE      RMSE
0  0.146005  0.828742
