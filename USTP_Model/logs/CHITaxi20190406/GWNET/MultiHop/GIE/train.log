2024-09-25 20:00:16 INFO     Saving logs in: ./logs/CHITaxi20190406/GWNET/MultiHop/GIE
2024-09-25 20:00:17 INFO     ----------------------------------------------------------------------------
2024-09-25 20:00:17 INFO     # 0, Kownledge Graph Embedding: GIE, Experiment ids: 10000
2024-09-25 20:00:17 INFO     ----------------------------------------------------------------------------
2024-09-25 20:00:17 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=10000
2024-09-25 20:00:17 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10000, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'MultiHop', 'max_hop': 1, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-25 20:00:19 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-25 20:00:19 INFO     set_weight_link_or_dist: dist
2024-09-25 20:00:19 INFO     init_weight_inf_or_zero: inf
2024-09-25 20:00:19 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-25 20:00:19 INFO     Start Calculate the weight by Gauss kernel!
2024-09-25 20:00:19 INFO     Loading file CHITaxi20190406.dyna
2024-09-25 20:00:19 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-25 20:00:19 INFO     Dataset created
2024-09-25 20:00:19 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-25 20:00:19 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-25 20:00:19 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-25 20:00:19 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-25 20:00:19 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-25 20:00:19 INFO     NoneScaler
2024-09-25 20:00:26 INFO     add adj_mx to supports
2024-09-25 20:00:26 INFO     add apt_adj(v1 * v2) in forward process
2024-09-25 20:00:26 INFO     add multi hop score in forward process
2024-09-25 20:00:26 INFO     receptive_field: 14
2024-09-25 20:00:29 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(2, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-25 20:00:29 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-25 20:00:29 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-25 20:00:29 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:00:29 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:00:29 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:00:29 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:00:29 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:00:29 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:00:29 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:00:29 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:00:29 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:00:29 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:00:29 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:00:29 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:00:29 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:00:29 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:00:29 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:00:29 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:00:29 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:00:29 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:00:29 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:00:29 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:00:29 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:00:29 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:00:29 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:00:29 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:00:29 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     start_conv.weight	torch.Size([32, 2, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:00:29 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-25 20:00:29 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-25 20:00:29 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-25 20:00:29 INFO     Total parameter numbers: 323184
2024-09-25 20:00:29 INFO     You select `adam` optimizer.
2024-09-25 20:00:29 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-25 20:00:29 INFO     Start training ...
2024-09-25 20:00:29 INFO     num_batches:96
2024-09-25 20:00:50 INFO     epoch complete!
2024-09-25 20:00:50 INFO     evaluating now!
2024-09-25 20:00:52 INFO     Epoch [0/200] train_loss: 12.3792, val_loss: 11.3524, lr: 0.001000, 23.00s
2024-09-25 20:00:52 INFO     Saved model at 0
2024-09-25 20:00:52 INFO     Val loss decrease from inf to 11.3524, saving to ./libcity/cache/10000/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-25 20:01:13 INFO     epoch complete!
2024-09-25 20:01:13 INFO     evaluating now!
2024-09-25 20:01:15 INFO     Epoch [1/200] train_loss: 9.2138, val_loss: 11.1289, lr: 0.001000, 22.50s
2024-09-25 20:01:15 INFO     Saved model at 1
2024-09-25 20:01:15 INFO     Val loss decrease from 11.3524 to 11.1289, saving to ./libcity/cache/10000/model_cache/GWNET_CHITaxi20190406_epoch1.tar
2024-09-25 20:01:35 INFO     epoch complete!
2024-09-25 20:01:35 INFO     evaluating now!
2024-09-25 20:01:37 INFO     Epoch [2/200] train_loss: 8.4537, val_loss: 7.9483, lr: 0.001000, 22.37s
2024-09-25 20:01:38 INFO     Saved model at 2
2024-09-25 20:01:38 INFO     Val loss decrease from 11.1289 to 7.9483, saving to ./libcity/cache/10000/model_cache/GWNET_CHITaxi20190406_epoch2.tar
2024-09-25 20:01:58 INFO     epoch complete!
2024-09-25 20:01:58 INFO     evaluating now!
2024-09-25 20:02:00 INFO     Epoch [3/200] train_loss: 8.0856, val_loss: 10.8735, lr: 0.001000, 22.56s
2024-09-25 20:02:21 INFO     epoch complete!
2024-09-25 20:02:21 INFO     evaluating now!
2024-09-25 20:02:23 INFO     Epoch [4/200] train_loss: 7.7032, val_loss: 8.1632, lr: 0.001000, 23.03s
2024-09-25 20:02:44 INFO     epoch complete!
2024-09-25 20:02:44 INFO     evaluating now!
2024-09-25 20:02:47 INFO     Epoch [5/200] train_loss: 7.5146, val_loss: 9.1890, lr: 0.001000, 23.22s
2024-09-25 20:03:07 INFO     epoch complete!
2024-09-25 20:03:07 INFO     evaluating now!
2024-09-25 20:03:09 INFO     Epoch [6/200] train_loss: 7.0716, val_loss: 7.2917, lr: 0.001000, 22.71s
2024-09-25 20:03:09 INFO     Saved model at 6
2024-09-25 20:03:09 INFO     Val loss decrease from 7.9483 to 7.2917, saving to ./libcity/cache/10000/model_cache/GWNET_CHITaxi20190406_epoch6.tar
2024-09-25 20:03:30 INFO     epoch complete!
2024-09-25 20:03:30 INFO     evaluating now!
2024-09-25 20:03:32 INFO     Epoch [7/200] train_loss: 6.3991, val_loss: 6.2822, lr: 0.001000, 23.02s
2024-09-25 20:03:33 INFO     Saved model at 7
2024-09-25 20:03:33 INFO     Val loss decrease from 7.2917 to 6.2822, saving to ./libcity/cache/10000/model_cache/GWNET_CHITaxi20190406_epoch7.tar
2024-09-25 20:03:53 INFO     epoch complete!
2024-09-25 20:03:53 INFO     evaluating now!
2024-09-25 20:03:56 INFO     Epoch [8/200] train_loss: 5.8315, val_loss: 5.9849, lr: 0.001000, 22.80s
2024-09-25 20:03:56 INFO     Saved model at 8
2024-09-25 20:03:56 INFO     Val loss decrease from 6.2822 to 5.9849, saving to ./libcity/cache/10000/model_cache/GWNET_CHITaxi20190406_epoch8.tar
2024-09-25 20:04:16 INFO     epoch complete!
2024-09-25 20:04:16 INFO     evaluating now!
2024-09-25 20:04:18 INFO     Epoch [9/200] train_loss: 5.6723, val_loss: 5.9551, lr: 0.001000, 22.39s
2024-09-25 20:04:18 INFO     Saved model at 9
2024-09-25 20:04:18 INFO     Val loss decrease from 5.9849 to 5.9551, saving to ./libcity/cache/10000/model_cache/GWNET_CHITaxi20190406_epoch9.tar
2024-09-25 20:04:38 INFO     epoch complete!
2024-09-25 20:04:38 INFO     evaluating now!
2024-09-25 20:04:41 INFO     Epoch [10/200] train_loss: 5.6399, val_loss: 5.5474, lr: 0.001000, 22.14s
2024-09-25 20:04:41 INFO     Saved model at 10
2024-09-25 20:04:41 INFO     Val loss decrease from 5.9551 to 5.5474, saving to ./libcity/cache/10000/model_cache/GWNET_CHITaxi20190406_epoch10.tar
2024-09-25 20:05:01 INFO     epoch complete!
2024-09-25 20:05:01 INFO     evaluating now!
2024-09-25 20:05:03 INFO     Epoch [11/200] train_loss: 5.3850, val_loss: 5.5377, lr: 0.001000, 22.19s
2024-09-25 20:05:03 INFO     Saved model at 11
2024-09-25 20:05:03 INFO     Val loss decrease from 5.5474 to 5.5377, saving to ./libcity/cache/10000/model_cache/GWNET_CHITaxi20190406_epoch11.tar
2024-09-25 20:05:24 INFO     epoch complete!
2024-09-25 20:05:24 INFO     evaluating now!
2024-09-25 20:05:26 INFO     Epoch [12/200] train_loss: 5.2630, val_loss: 6.0156, lr: 0.001000, 22.30s
2024-09-25 20:05:46 INFO     epoch complete!
2024-09-25 20:05:46 INFO     evaluating now!
2024-09-25 20:05:48 INFO     Epoch [13/200] train_loss: 5.2853, val_loss: 6.8375, lr: 0.001000, 22.27s
2024-09-25 20:06:09 INFO     epoch complete!
2024-09-25 20:06:09 INFO     evaluating now!
2024-09-25 20:06:11 INFO     Epoch [14/200] train_loss: 5.1001, val_loss: 7.1305, lr: 0.001000, 22.71s
2024-09-25 20:06:31 INFO     epoch complete!
2024-09-25 20:06:31 INFO     evaluating now!
2024-09-25 20:06:33 INFO     Epoch [15/200] train_loss: 5.1257, val_loss: 5.3238, lr: 0.001000, 22.47s
2024-09-25 20:06:34 INFO     Saved model at 15
2024-09-25 20:06:34 INFO     Val loss decrease from 5.5377 to 5.3238, saving to ./libcity/cache/10000/model_cache/GWNET_CHITaxi20190406_epoch15.tar
2024-09-25 20:06:54 INFO     epoch complete!
2024-09-25 20:06:54 INFO     evaluating now!
2024-09-25 20:06:56 INFO     Epoch [16/200] train_loss: 4.9713, val_loss: 5.9374, lr: 0.001000, 22.50s
2024-09-25 20:07:16 INFO     epoch complete!
2024-09-25 20:07:16 INFO     evaluating now!
2024-09-25 20:07:18 INFO     Epoch [17/200] train_loss: 4.9851, val_loss: 6.0112, lr: 0.001000, 22.24s
2024-09-25 20:07:39 INFO     epoch complete!
2024-09-25 20:07:39 INFO     evaluating now!
2024-09-25 20:07:41 INFO     Epoch [18/200] train_loss: 4.8399, val_loss: 5.1662, lr: 0.001000, 22.35s
2024-09-25 20:07:41 INFO     Saved model at 18
2024-09-25 20:07:41 INFO     Val loss decrease from 5.3238 to 5.1662, saving to ./libcity/cache/10000/model_cache/GWNET_CHITaxi20190406_epoch18.tar
2024-09-25 20:08:07 INFO     epoch complete!
2024-09-25 20:08:07 INFO     evaluating now!
2024-09-25 20:08:10 INFO     Epoch [19/200] train_loss: 4.9064, val_loss: 5.2161, lr: 0.001000, 29.07s
2024-09-25 20:08:31 INFO     epoch complete!
2024-09-25 20:08:31 INFO     evaluating now!
2024-09-25 20:08:33 INFO     Epoch [20/200] train_loss: 4.8164, val_loss: 5.4093, lr: 0.001000, 22.82s
2024-09-25 20:08:53 INFO     epoch complete!
2024-09-25 20:08:53 INFO     evaluating now!
2024-09-25 20:08:55 INFO     Epoch [21/200] train_loss: 4.7930, val_loss: 5.5749, lr: 0.001000, 22.44s
2024-09-25 20:09:16 INFO     epoch complete!
2024-09-25 20:09:16 INFO     evaluating now!
2024-09-25 20:09:18 INFO     Epoch [22/200] train_loss: 4.7619, val_loss: 5.1716, lr: 0.001000, 22.59s
2024-09-25 20:09:38 INFO     epoch complete!
2024-09-25 20:09:38 INFO     evaluating now!
2024-09-25 20:09:41 INFO     Epoch [23/200] train_loss: 4.6949, val_loss: 5.4462, lr: 0.001000, 22.65s
2024-09-25 20:10:01 INFO     epoch complete!
2024-09-25 20:10:01 INFO     evaluating now!
2024-09-25 20:10:03 INFO     Epoch [24/200] train_loss: 4.6438, val_loss: 7.0002, lr: 0.001000, 22.63s
2024-09-25 20:10:24 INFO     epoch complete!
2024-09-25 20:10:24 INFO     evaluating now!
2024-09-25 20:10:26 INFO     Epoch [25/200] train_loss: 4.6574, val_loss: 5.2815, lr: 0.001000, 22.45s
2024-09-25 20:10:46 INFO     epoch complete!
2024-09-25 20:10:46 INFO     evaluating now!
2024-09-25 20:10:48 INFO     Epoch [26/200] train_loss: 4.6048, val_loss: 4.9986, lr: 0.001000, 22.40s
2024-09-25 20:10:49 INFO     Saved model at 26
2024-09-25 20:10:49 INFO     Val loss decrease from 5.1662 to 4.9986, saving to ./libcity/cache/10000/model_cache/GWNET_CHITaxi20190406_epoch26.tar
2024-09-25 20:11:09 INFO     epoch complete!
2024-09-25 20:11:09 INFO     evaluating now!
2024-09-25 20:11:11 INFO     Epoch [27/200] train_loss: 4.5918, val_loss: 5.0589, lr: 0.001000, 22.65s
2024-09-25 20:11:32 INFO     epoch complete!
2024-09-25 20:11:32 INFO     evaluating now!
2024-09-25 20:11:34 INFO     Epoch [28/200] train_loss: 4.5341, val_loss: 5.0721, lr: 0.001000, 22.64s
2024-09-25 20:11:54 INFO     epoch complete!
2024-09-25 20:11:54 INFO     evaluating now!
2024-09-25 20:11:57 INFO     Epoch [29/200] train_loss: 4.5253, val_loss: 4.8690, lr: 0.001000, 22.70s
2024-09-25 20:11:57 INFO     Saved model at 29
2024-09-25 20:11:57 INFO     Val loss decrease from 4.9986 to 4.8690, saving to ./libcity/cache/10000/model_cache/GWNET_CHITaxi20190406_epoch29.tar
2024-09-25 20:12:17 INFO     epoch complete!
2024-09-25 20:12:17 INFO     evaluating now!
2024-09-25 20:12:20 INFO     Epoch [30/200] train_loss: 4.5117, val_loss: 5.2672, lr: 0.001000, 22.77s
2024-09-25 20:12:40 INFO     epoch complete!
2024-09-25 20:12:40 INFO     evaluating now!
2024-09-25 20:12:42 INFO     Epoch [31/200] train_loss: 4.3947, val_loss: 5.5066, lr: 0.001000, 22.42s
2024-09-25 20:13:06 INFO     epoch complete!
2024-09-25 20:13:06 INFO     evaluating now!
2024-09-25 20:13:09 INFO     Epoch [32/200] train_loss: 4.3950, val_loss: 4.9178, lr: 0.001000, 27.12s
2024-09-25 20:13:35 INFO     epoch complete!
2024-09-25 20:13:35 INFO     evaluating now!
2024-09-25 20:13:38 INFO     Epoch [33/200] train_loss: 4.4509, val_loss: 5.3296, lr: 0.001000, 29.20s
2024-09-25 20:14:03 INFO     epoch complete!
2024-09-25 20:14:03 INFO     evaluating now!
2024-09-25 20:14:06 INFO     Epoch [34/200] train_loss: 4.4085, val_loss: 5.2403, lr: 0.001000, 27.83s
2024-09-25 20:14:32 INFO     epoch complete!
2024-09-25 20:14:32 INFO     evaluating now!
2024-09-25 20:14:35 INFO     Epoch [35/200] train_loss: 4.3624, val_loss: 5.3010, lr: 0.001000, 28.85s
2024-09-25 20:15:01 INFO     epoch complete!
2024-09-25 20:15:01 INFO     evaluating now!
2024-09-25 20:15:04 INFO     Epoch [36/200] train_loss: 4.2751, val_loss: 4.9578, lr: 0.001000, 29.13s
2024-09-25 20:15:25 INFO     epoch complete!
2024-09-25 20:15:25 INFO     evaluating now!
2024-09-25 20:15:28 INFO     Epoch [37/200] train_loss: 4.3960, val_loss: 5.1295, lr: 0.001000, 23.48s
2024-09-25 20:15:48 INFO     epoch complete!
2024-09-25 20:15:48 INFO     evaluating now!
2024-09-25 20:15:50 INFO     Epoch [38/200] train_loss: 4.2714, val_loss: 6.3735, lr: 0.001000, 22.32s
2024-09-25 20:16:10 INFO     epoch complete!
2024-09-25 20:16:10 INFO     evaluating now!
2024-09-25 20:16:12 INFO     Epoch [39/200] train_loss: 4.2189, val_loss: 5.8993, lr: 0.001000, 22.51s
2024-09-25 20:16:33 INFO     epoch complete!
2024-09-25 20:16:33 INFO     evaluating now!
2024-09-25 20:16:35 INFO     Epoch [40/200] train_loss: 4.2808, val_loss: 5.1032, lr: 0.001000, 22.44s
2024-09-25 20:16:55 INFO     epoch complete!
2024-09-25 20:16:55 INFO     evaluating now!
2024-09-25 20:16:57 INFO     Epoch [41/200] train_loss: 4.2091, val_loss: 4.8430, lr: 0.001000, 21.93s
2024-09-25 20:16:57 INFO     Saved model at 41
2024-09-25 20:16:57 INFO     Val loss decrease from 4.8690 to 4.8430, saving to ./libcity/cache/10000/model_cache/GWNET_CHITaxi20190406_epoch41.tar
2024-09-25 20:17:17 INFO     epoch complete!
2024-09-25 20:17:17 INFO     evaluating now!
2024-09-25 20:17:19 INFO     Epoch [42/200] train_loss: 4.2142, val_loss: 4.9770, lr: 0.001000, 22.07s
2024-09-25 20:17:39 INFO     epoch complete!
2024-09-25 20:17:39 INFO     evaluating now!
2024-09-25 20:17:41 INFO     Epoch [43/200] train_loss: 4.2178, val_loss: 5.3821, lr: 0.001000, 22.19s
2024-09-25 20:18:01 INFO     epoch complete!
2024-09-25 20:18:01 INFO     evaluating now!
2024-09-25 20:18:04 INFO     Epoch [44/200] train_loss: 4.2166, val_loss: 5.0818, lr: 0.001000, 22.19s
2024-09-25 20:18:24 INFO     epoch complete!
2024-09-25 20:18:24 INFO     evaluating now!
2024-09-25 20:18:26 INFO     Epoch [45/200] train_loss: 4.1325, val_loss: 5.3457, lr: 0.001000, 22.42s
2024-09-25 20:18:46 INFO     epoch complete!
2024-09-25 20:18:46 INFO     evaluating now!
2024-09-25 20:18:48 INFO     Epoch [46/200] train_loss: 4.1595, val_loss: 4.9991, lr: 0.001000, 22.45s
2024-09-25 20:19:09 INFO     epoch complete!
2024-09-25 20:19:09 INFO     evaluating now!
2024-09-25 20:19:11 INFO     Epoch [47/200] train_loss: 4.0693, val_loss: 6.0272, lr: 0.001000, 22.41s
2024-09-25 20:19:31 INFO     epoch complete!
2024-09-25 20:19:31 INFO     evaluating now!
2024-09-25 20:19:33 INFO     Epoch [48/200] train_loss: 4.0753, val_loss: 5.2483, lr: 0.001000, 22.54s
2024-09-25 20:19:54 INFO     epoch complete!
2024-09-25 20:19:54 INFO     evaluating now!
2024-09-25 20:19:56 INFO     Epoch [49/200] train_loss: 4.1016, val_loss: 4.9598, lr: 0.001000, 22.58s
2024-09-25 20:20:16 INFO     epoch complete!
2024-09-25 20:20:16 INFO     evaluating now!
2024-09-25 20:20:18 INFO     Epoch [50/200] train_loss: 4.1163, val_loss: 4.9348, lr: 0.001000, 22.40s
2024-09-25 20:20:39 INFO     epoch complete!
2024-09-25 20:20:39 INFO     evaluating now!
2024-09-25 20:20:41 INFO     Epoch [51/200] train_loss: 4.0250, val_loss: 5.2738, lr: 0.001000, 22.38s
2024-09-25 20:21:01 INFO     epoch complete!
2024-09-25 20:21:01 INFO     evaluating now!
2024-09-25 20:21:03 INFO     Epoch [52/200] train_loss: 4.0630, val_loss: 4.7679, lr: 0.001000, 22.42s
2024-09-25 20:21:03 INFO     Saved model at 52
2024-09-25 20:21:03 INFO     Val loss decrease from 4.8430 to 4.7679, saving to ./libcity/cache/10000/model_cache/GWNET_CHITaxi20190406_epoch52.tar
2024-09-25 20:21:23 INFO     epoch complete!
2024-09-25 20:21:23 INFO     evaluating now!
2024-09-25 20:21:26 INFO     Epoch [53/200] train_loss: 4.0295, val_loss: 4.9725, lr: 0.001000, 22.25s
2024-09-25 20:21:46 INFO     epoch complete!
2024-09-25 20:21:46 INFO     evaluating now!
2024-09-25 20:21:48 INFO     Epoch [54/200] train_loss: 4.0384, val_loss: 4.9661, lr: 0.001000, 22.36s
2024-09-25 20:22:08 INFO     epoch complete!
2024-09-25 20:22:08 INFO     evaluating now!
2024-09-25 20:22:11 INFO     Epoch [55/200] train_loss: 4.0698, val_loss: 4.7859, lr: 0.001000, 22.52s
2024-09-25 20:22:31 INFO     epoch complete!
2024-09-25 20:22:31 INFO     evaluating now!
2024-09-25 20:22:33 INFO     Epoch [56/200] train_loss: 3.9901, val_loss: 5.6756, lr: 0.001000, 22.46s
2024-09-25 20:22:53 INFO     epoch complete!
2024-09-25 20:22:53 INFO     evaluating now!
2024-09-25 20:22:55 INFO     Epoch [57/200] train_loss: 4.0085, val_loss: 5.4062, lr: 0.001000, 22.22s
2024-09-25 20:23:15 INFO     epoch complete!
2024-09-25 20:23:15 INFO     evaluating now!
2024-09-25 20:23:17 INFO     Epoch [58/200] train_loss: 3.9757, val_loss: 5.2062, lr: 0.001000, 22.03s
2024-09-25 20:23:37 INFO     epoch complete!
2024-09-25 20:23:37 INFO     evaluating now!
2024-09-25 20:23:39 INFO     Epoch [59/200] train_loss: 3.9758, val_loss: 5.9680, lr: 0.001000, 22.15s
2024-09-25 20:24:00 INFO     epoch complete!
2024-09-25 20:24:00 INFO     evaluating now!
2024-09-25 20:24:02 INFO     Epoch [60/200] train_loss: 3.9248, val_loss: 5.5704, lr: 0.001000, 22.32s
2024-09-25 20:24:22 INFO     epoch complete!
2024-09-25 20:24:22 INFO     evaluating now!
2024-09-25 20:24:24 INFO     Epoch [61/200] train_loss: 3.9105, val_loss: 4.8119, lr: 0.001000, 22.05s
2024-09-25 20:24:43 INFO     epoch complete!
2024-09-25 20:24:43 INFO     evaluating now!
2024-09-25 20:24:45 INFO     Epoch [62/200] train_loss: 3.8922, val_loss: 4.7745, lr: 0.001000, 21.69s
2024-09-25 20:25:05 INFO     epoch complete!
2024-09-25 20:25:05 INFO     evaluating now!
2024-09-25 20:25:07 INFO     Epoch [63/200] train_loss: 3.8945, val_loss: 5.1453, lr: 0.001000, 22.08s
2024-09-25 20:25:27 INFO     epoch complete!
2024-09-25 20:25:27 INFO     evaluating now!
2024-09-25 20:25:29 INFO     Epoch [64/200] train_loss: 3.8961, val_loss: 5.0828, lr: 0.001000, 21.90s
2024-09-25 20:25:50 INFO     epoch complete!
2024-09-25 20:25:50 INFO     evaluating now!
2024-09-25 20:25:52 INFO     Epoch [65/200] train_loss: 3.9303, val_loss: 4.8563, lr: 0.001000, 22.42s
2024-09-25 20:26:12 INFO     epoch complete!
2024-09-25 20:26:12 INFO     evaluating now!
2024-09-25 20:26:14 INFO     Epoch [66/200] train_loss: 3.8375, val_loss: 4.8369, lr: 0.001000, 22.51s
2024-09-25 20:26:34 INFO     epoch complete!
2024-09-25 20:26:34 INFO     evaluating now!
2024-09-25 20:26:37 INFO     Epoch [67/200] train_loss: 3.8663, val_loss: 4.9055, lr: 0.001000, 22.25s
2024-09-25 20:26:37 WARNING  Early stopping at epoch: 67
2024-09-25 20:26:37 INFO     Trained totally 68 epochs, average train time is 20.767s, average eval time is 2.218s
2024-09-25 20:26:37 INFO     Loaded model at 52
2024-09-25 20:26:37 INFO     Saved model at ./libcity/cache/10000/model_cache/GWNET_CHITaxi20190406.m
2024-09-25 20:26:37 INFO     Start evaluating ...
2024-09-25 20:26:44 INFO     Note that you select the single mode to evaluate!
2024-09-25 20:26:44 INFO     Evaluate result is saved at ./libcity/cache/10000/evaluate_cache/2024_09_25_20_26_44_GWNET_CHITaxi20190406.csv
2024-09-25 20:26:44 INFO     
         MAE       RMSE
1   2.216480   6.496537
2   2.324919   7.323319
3   2.494684   8.226869
4   2.589693   8.776093
5   2.693745   9.303754
6   2.803196   9.460402
7   2.904275   9.856035
8   2.981940  10.403291
9   3.117302  11.061862
10  3.192585  11.672032
11  3.341357  12.017973
12  3.397478  12.203672
2024-09-25 20:26:44 INFO     ----------------------------------------------------------------------------
2024-09-25 20:26:44 INFO     # 1, Kownledge Graph Embedding: GIE, Experiment ids: 10001
2024-09-25 20:26:44 INFO     ----------------------------------------------------------------------------
2024-09-25 20:26:44 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=10001
2024-09-25 20:26:44 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10001, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'MultiHop', 'max_hop': 1, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-25 20:26:44 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-25 20:26:45 INFO     set_weight_link_or_dist: dist
2024-09-25 20:26:45 INFO     init_weight_inf_or_zero: inf
2024-09-25 20:26:45 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-25 20:26:45 INFO     Start Calculate the weight by Gauss kernel!
2024-09-25 20:26:45 INFO     Loading file CHITaxi20190406.dyna
2024-09-25 20:26:45 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-25 20:26:45 INFO     Dataset created
2024-09-25 20:26:45 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-25 20:26:45 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-25 20:26:45 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-25 20:26:45 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-25 20:26:45 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-25 20:26:45 INFO     NoneScaler
2024-09-25 20:26:45 INFO     add adj_mx to supports
2024-09-25 20:26:45 INFO     add apt_adj(v1 * v2) in forward process
2024-09-25 20:26:46 INFO     add multi hop score in forward process
2024-09-25 20:26:46 INFO     receptive_field: 14
2024-09-25 20:26:46 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(2, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-25 20:26:46 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-25 20:26:46 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-25 20:26:46 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:26:46 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:26:46 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:26:46 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:26:46 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:26:46 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:26:46 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:26:46 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:26:46 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:26:46 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:26:46 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:26:46 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:26:46 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:26:46 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:26:46 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:26:46 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:26:46 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:26:46 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:26:46 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:26:46 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:26:46 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:26:46 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:26:46 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:26:46 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:26:46 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     start_conv.weight	torch.Size([32, 2, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:26:46 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-25 20:26:46 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-25 20:26:46 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-25 20:26:46 INFO     Total parameter numbers: 323184
2024-09-25 20:26:46 INFO     You select `adam` optimizer.
2024-09-25 20:26:46 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-25 20:26:46 INFO     Start training ...
2024-09-25 20:26:46 INFO     num_batches:96
2024-09-25 20:27:06 INFO     epoch complete!
2024-09-25 20:27:06 INFO     evaluating now!
2024-09-25 20:27:08 INFO     Epoch [0/200] train_loss: 11.8486, val_loss: 9.0361, lr: 0.001000, 22.34s
2024-09-25 20:27:09 INFO     Saved model at 0
2024-09-25 20:27:09 INFO     Val loss decrease from inf to 9.0361, saving to ./libcity/cache/10001/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-25 20:27:29 INFO     epoch complete!
2024-09-25 20:27:29 INFO     evaluating now!
2024-09-25 20:27:31 INFO     Epoch [1/200] train_loss: 8.7089, val_loss: 8.1800, lr: 0.001000, 22.42s
2024-09-25 20:27:31 INFO     Saved model at 1
2024-09-25 20:27:31 INFO     Val loss decrease from 9.0361 to 8.1800, saving to ./libcity/cache/10001/model_cache/GWNET_CHITaxi20190406_epoch1.tar
2024-09-25 20:27:51 INFO     epoch complete!
2024-09-25 20:27:51 INFO     evaluating now!
2024-09-25 20:27:53 INFO     Epoch [2/200] train_loss: 8.2078, val_loss: 8.4241, lr: 0.001000, 22.14s
2024-09-25 20:28:13 INFO     epoch complete!
2024-09-25 20:28:13 INFO     evaluating now!
2024-09-25 20:28:15 INFO     Epoch [3/200] train_loss: 7.9298, val_loss: 7.9467, lr: 0.001000, 21.79s
2024-09-25 20:28:16 INFO     Saved model at 3
2024-09-25 20:28:16 INFO     Val loss decrease from 8.1800 to 7.9467, saving to ./libcity/cache/10001/model_cache/GWNET_CHITaxi20190406_epoch3.tar
2024-09-25 20:28:36 INFO     epoch complete!
2024-09-25 20:28:36 INFO     evaluating now!
2024-09-25 20:28:38 INFO     Epoch [4/200] train_loss: 7.7614, val_loss: 9.5143, lr: 0.001000, 22.17s
2024-09-25 20:28:58 INFO     epoch complete!
2024-09-25 20:28:58 INFO     evaluating now!
2024-09-25 20:29:00 INFO     Epoch [5/200] train_loss: 7.4119, val_loss: 7.2088, lr: 0.001000, 22.19s
2024-09-25 20:29:00 INFO     Saved model at 5
2024-09-25 20:29:00 INFO     Val loss decrease from 7.9467 to 7.2088, saving to ./libcity/cache/10001/model_cache/GWNET_CHITaxi20190406_epoch5.tar
2024-09-25 20:29:20 INFO     epoch complete!
2024-09-25 20:29:20 INFO     evaluating now!
2024-09-25 20:29:22 INFO     Epoch [6/200] train_loss: 6.8427, val_loss: 9.4953, lr: 0.001000, 22.04s
2024-09-25 20:29:42 INFO     epoch complete!
2024-09-25 20:29:42 INFO     evaluating now!
2024-09-25 20:29:44 INFO     Epoch [7/200] train_loss: 6.0789, val_loss: 5.7580, lr: 0.001000, 21.98s
2024-09-25 20:29:45 INFO     Saved model at 7
2024-09-25 20:29:45 INFO     Val loss decrease from 7.2088 to 5.7580, saving to ./libcity/cache/10001/model_cache/GWNET_CHITaxi20190406_epoch7.tar
2024-09-25 20:30:05 INFO     epoch complete!
2024-09-25 20:30:05 INFO     evaluating now!
2024-09-25 20:30:07 INFO     Epoch [8/200] train_loss: 5.8700, val_loss: 6.3901, lr: 0.001000, 22.24s
2024-09-25 20:30:27 INFO     epoch complete!
2024-09-25 20:30:27 INFO     evaluating now!
2024-09-25 20:30:29 INFO     Epoch [9/200] train_loss: 5.5110, val_loss: 5.7533, lr: 0.001000, 22.33s
2024-09-25 20:30:29 INFO     Saved model at 9
2024-09-25 20:30:29 INFO     Val loss decrease from 5.7580 to 5.7533, saving to ./libcity/cache/10001/model_cache/GWNET_CHITaxi20190406_epoch9.tar
2024-09-25 20:30:49 INFO     epoch complete!
2024-09-25 20:30:49 INFO     evaluating now!
2024-09-25 20:30:51 INFO     Epoch [10/200] train_loss: 5.3803, val_loss: 6.3441, lr: 0.001000, 21.87s
2024-09-25 20:31:11 INFO     epoch complete!
2024-09-25 20:31:11 INFO     evaluating now!
2024-09-25 20:31:13 INFO     Epoch [11/200] train_loss: 5.3414, val_loss: 5.5930, lr: 0.001000, 21.97s
2024-09-25 20:31:13 INFO     Saved model at 11
2024-09-25 20:31:13 INFO     Val loss decrease from 5.7533 to 5.5930, saving to ./libcity/cache/10001/model_cache/GWNET_CHITaxi20190406_epoch11.tar
2024-09-25 20:31:33 INFO     epoch complete!
2024-09-25 20:31:33 INFO     evaluating now!
2024-09-25 20:31:35 INFO     Epoch [12/200] train_loss: 5.1802, val_loss: 5.3765, lr: 0.001000, 21.85s
2024-09-25 20:31:36 INFO     Saved model at 12
2024-09-25 20:31:36 INFO     Val loss decrease from 5.5930 to 5.3765, saving to ./libcity/cache/10001/model_cache/GWNET_CHITaxi20190406_epoch12.tar
2024-09-25 20:31:56 INFO     epoch complete!
2024-09-25 20:31:56 INFO     evaluating now!
2024-09-25 20:31:58 INFO     Epoch [13/200] train_loss: 5.1497, val_loss: 9.1007, lr: 0.001000, 21.95s
2024-09-25 20:32:18 INFO     epoch complete!
2024-09-25 20:32:18 INFO     evaluating now!
2024-09-25 20:32:20 INFO     Epoch [14/200] train_loss: 4.9966, val_loss: 6.4740, lr: 0.001000, 21.93s
2024-09-25 20:32:40 INFO     epoch complete!
2024-09-25 20:32:40 INFO     evaluating now!
2024-09-25 20:32:42 INFO     Epoch [15/200] train_loss: 5.0328, val_loss: 5.1834, lr: 0.001000, 22.38s
2024-09-25 20:32:42 INFO     Saved model at 15
2024-09-25 20:32:42 INFO     Val loss decrease from 5.3765 to 5.1834, saving to ./libcity/cache/10001/model_cache/GWNET_CHITaxi20190406_epoch15.tar
2024-09-25 20:33:02 INFO     epoch complete!
2024-09-25 20:33:02 INFO     evaluating now!
2024-09-25 20:33:04 INFO     Epoch [16/200] train_loss: 4.8597, val_loss: 5.7274, lr: 0.001000, 22.05s
2024-09-25 20:33:24 INFO     epoch complete!
2024-09-25 20:33:24 INFO     evaluating now!
2024-09-25 20:33:26 INFO     Epoch [17/200] train_loss: 4.8686, val_loss: 5.3126, lr: 0.001000, 21.95s
2024-09-25 20:33:46 INFO     epoch complete!
2024-09-25 20:33:46 INFO     evaluating now!
2024-09-25 20:33:48 INFO     Epoch [18/200] train_loss: 4.7868, val_loss: 6.1654, lr: 0.001000, 21.66s
2024-09-25 20:34:08 INFO     epoch complete!
2024-09-25 20:34:08 INFO     evaluating now!
2024-09-25 20:34:10 INFO     Epoch [19/200] train_loss: 4.7118, val_loss: 5.0659, lr: 0.001000, 22.11s
2024-09-25 20:34:10 INFO     Saved model at 19
2024-09-25 20:34:10 INFO     Val loss decrease from 5.1834 to 5.0659, saving to ./libcity/cache/10001/model_cache/GWNET_CHITaxi20190406_epoch19.tar
2024-09-25 20:34:30 INFO     epoch complete!
2024-09-25 20:34:30 INFO     evaluating now!
2024-09-25 20:34:32 INFO     Epoch [20/200] train_loss: 4.7103, val_loss: 4.9863, lr: 0.001000, 22.02s
2024-09-25 20:34:33 INFO     Saved model at 20
2024-09-25 20:34:33 INFO     Val loss decrease from 5.0659 to 4.9863, saving to ./libcity/cache/10001/model_cache/GWNET_CHITaxi20190406_epoch20.tar
2024-09-25 20:34:52 INFO     epoch complete!
2024-09-25 20:34:52 INFO     evaluating now!
2024-09-25 20:34:55 INFO     Epoch [21/200] train_loss: 4.6939, val_loss: 5.7506, lr: 0.001000, 21.93s
2024-09-25 20:35:15 INFO     epoch complete!
2024-09-25 20:35:15 INFO     evaluating now!
2024-09-25 20:35:17 INFO     Epoch [22/200] train_loss: 4.5863, val_loss: 5.5456, lr: 0.001000, 22.23s
2024-09-25 20:35:37 INFO     epoch complete!
2024-09-25 20:35:37 INFO     evaluating now!
2024-09-25 20:35:39 INFO     Epoch [23/200] train_loss: 4.5508, val_loss: 7.3608, lr: 0.001000, 21.99s
2024-09-25 20:35:59 INFO     epoch complete!
2024-09-25 20:35:59 INFO     evaluating now!
2024-09-25 20:36:01 INFO     Epoch [24/200] train_loss: 4.5561, val_loss: 6.5673, lr: 0.001000, 21.93s
2024-09-25 20:36:20 INFO     epoch complete!
2024-09-25 20:36:20 INFO     evaluating now!
2024-09-25 20:36:23 INFO     Epoch [25/200] train_loss: 4.4919, val_loss: 5.8369, lr: 0.001000, 21.90s
2024-09-25 20:36:42 INFO     epoch complete!
2024-09-25 20:36:42 INFO     evaluating now!
2024-09-25 20:36:45 INFO     Epoch [26/200] train_loss: 4.4369, val_loss: 5.2209, lr: 0.001000, 21.96s
2024-09-25 20:37:05 INFO     epoch complete!
2024-09-25 20:37:05 INFO     evaluating now!
2024-09-25 20:37:07 INFO     Epoch [27/200] train_loss: 4.4106, val_loss: 6.1024, lr: 0.001000, 22.73s
2024-09-25 20:37:28 INFO     epoch complete!
2024-09-25 20:37:28 INFO     evaluating now!
2024-09-25 20:37:30 INFO     Epoch [28/200] train_loss: 4.4462, val_loss: 7.1327, lr: 0.001000, 22.70s
2024-09-25 20:37:50 INFO     epoch complete!
2024-09-25 20:37:50 INFO     evaluating now!
2024-09-25 20:37:52 INFO     Epoch [29/200] train_loss: 4.4332, val_loss: 5.4559, lr: 0.001000, 21.96s
2024-09-25 20:38:12 INFO     epoch complete!
2024-09-25 20:38:12 INFO     evaluating now!
2024-09-25 20:38:14 INFO     Epoch [30/200] train_loss: 4.3312, val_loss: 5.2844, lr: 0.001000, 21.96s
2024-09-25 20:38:34 INFO     epoch complete!
2024-09-25 20:38:34 INFO     evaluating now!
2024-09-25 20:38:36 INFO     Epoch [31/200] train_loss: 4.2969, val_loss: 5.0514, lr: 0.001000, 21.79s
2024-09-25 20:38:56 INFO     epoch complete!
2024-09-25 20:38:56 INFO     evaluating now!
2024-09-25 20:38:58 INFO     Epoch [32/200] train_loss: 4.3363, val_loss: 5.4087, lr: 0.001000, 22.04s
2024-09-25 20:39:17 INFO     epoch complete!
2024-09-25 20:39:17 INFO     evaluating now!
2024-09-25 20:39:19 INFO     Epoch [33/200] train_loss: 4.2521, val_loss: 5.5182, lr: 0.001000, 21.55s
2024-09-25 20:39:39 INFO     epoch complete!
2024-09-25 20:39:39 INFO     evaluating now!
2024-09-25 20:39:41 INFO     Epoch [34/200] train_loss: 4.2503, val_loss: 5.0685, lr: 0.001000, 22.03s
2024-09-25 20:40:01 INFO     epoch complete!
2024-09-25 20:40:01 INFO     evaluating now!
2024-09-25 20:40:03 INFO     Epoch [35/200] train_loss: 4.2552, val_loss: 4.9311, lr: 0.001000, 22.12s
2024-09-25 20:40:04 INFO     Saved model at 35
2024-09-25 20:40:04 INFO     Val loss decrease from 4.9863 to 4.9311, saving to ./libcity/cache/10001/model_cache/GWNET_CHITaxi20190406_epoch35.tar
2024-09-25 20:40:24 INFO     epoch complete!
2024-09-25 20:40:24 INFO     evaluating now!
2024-09-25 20:40:26 INFO     Epoch [36/200] train_loss: 4.2781, val_loss: 5.0294, lr: 0.001000, 22.06s
2024-09-25 20:40:46 INFO     epoch complete!
2024-09-25 20:40:46 INFO     evaluating now!
2024-09-25 20:40:48 INFO     Epoch [37/200] train_loss: 4.2463, val_loss: 5.1059, lr: 0.001000, 22.18s
2024-09-25 20:41:08 INFO     epoch complete!
2024-09-25 20:41:08 INFO     evaluating now!
2024-09-25 20:41:10 INFO     Epoch [38/200] train_loss: 4.1719, val_loss: 5.3132, lr: 0.001000, 22.21s
2024-09-25 20:41:30 INFO     epoch complete!
2024-09-25 20:41:30 INFO     evaluating now!
2024-09-25 20:41:32 INFO     Epoch [39/200] train_loss: 4.2092, val_loss: 5.1988, lr: 0.001000, 21.87s
2024-09-25 20:41:52 INFO     epoch complete!
2024-09-25 20:41:52 INFO     evaluating now!
2024-09-25 20:41:54 INFO     Epoch [40/200] train_loss: 4.1756, val_loss: 4.9521, lr: 0.001000, 22.14s
2024-09-25 20:42:14 INFO     epoch complete!
2024-09-25 20:42:14 INFO     evaluating now!
2024-09-25 20:42:16 INFO     Epoch [41/200] train_loss: 4.1481, val_loss: 4.9479, lr: 0.001000, 22.07s
2024-09-25 20:42:36 INFO     epoch complete!
2024-09-25 20:42:36 INFO     evaluating now!
2024-09-25 20:42:39 INFO     Epoch [42/200] train_loss: 4.1712, val_loss: 5.5139, lr: 0.001000, 22.46s
2024-09-25 20:42:59 INFO     epoch complete!
2024-09-25 20:42:59 INFO     evaluating now!
2024-09-25 20:43:01 INFO     Epoch [43/200] train_loss: 4.0969, val_loss: 5.5091, lr: 0.001000, 22.54s
2024-09-25 20:43:22 INFO     epoch complete!
2024-09-25 20:43:22 INFO     evaluating now!
2024-09-25 20:43:24 INFO     Epoch [44/200] train_loss: 4.0457, val_loss: 5.8129, lr: 0.001000, 22.68s
2024-09-25 20:43:44 INFO     epoch complete!
2024-09-25 20:43:44 INFO     evaluating now!
2024-09-25 20:43:47 INFO     Epoch [45/200] train_loss: 4.0485, val_loss: 5.9476, lr: 0.001000, 22.71s
2024-09-25 20:44:07 INFO     epoch complete!
2024-09-25 20:44:07 INFO     evaluating now!
2024-09-25 20:44:10 INFO     Epoch [46/200] train_loss: 4.0852, val_loss: 4.9781, lr: 0.001000, 22.92s
2024-09-25 20:44:30 INFO     epoch complete!
2024-09-25 20:44:30 INFO     evaluating now!
2024-09-25 20:44:32 INFO     Epoch [47/200] train_loss: 3.9639, val_loss: 5.0791, lr: 0.001000, 22.93s
2024-09-25 20:44:53 INFO     epoch complete!
2024-09-25 20:44:53 INFO     evaluating now!
2024-09-25 20:44:55 INFO     Epoch [48/200] train_loss: 4.0390, val_loss: 5.1791, lr: 0.001000, 22.82s
2024-09-25 20:45:16 INFO     epoch complete!
2024-09-25 20:45:16 INFO     evaluating now!
2024-09-25 20:45:18 INFO     Epoch [49/200] train_loss: 4.0500, val_loss: 4.8175, lr: 0.001000, 22.45s
2024-09-25 20:45:18 INFO     Saved model at 49
2024-09-25 20:45:18 INFO     Val loss decrease from 4.9311 to 4.8175, saving to ./libcity/cache/10001/model_cache/GWNET_CHITaxi20190406_epoch49.tar
2024-09-25 20:45:38 INFO     epoch complete!
2024-09-25 20:45:38 INFO     evaluating now!
2024-09-25 20:45:41 INFO     Epoch [50/200] train_loss: 3.9561, val_loss: 5.4862, lr: 0.001000, 22.46s
2024-09-25 20:46:01 INFO     epoch complete!
2024-09-25 20:46:01 INFO     evaluating now!
2024-09-25 20:46:03 INFO     Epoch [51/200] train_loss: 3.9647, val_loss: 5.5769, lr: 0.001000, 21.98s
2024-09-25 20:46:22 INFO     epoch complete!
2024-09-25 20:46:22 INFO     evaluating now!
2024-09-25 20:46:24 INFO     Epoch [52/200] train_loss: 3.9578, val_loss: 4.7399, lr: 0.001000, 21.70s
2024-09-25 20:46:25 INFO     Saved model at 52
2024-09-25 20:46:25 INFO     Val loss decrease from 4.8175 to 4.7399, saving to ./libcity/cache/10001/model_cache/GWNET_CHITaxi20190406_epoch52.tar
2024-09-25 20:46:45 INFO     epoch complete!
2024-09-25 20:46:45 INFO     evaluating now!
2024-09-25 20:46:47 INFO     Epoch [53/200] train_loss: 3.9224, val_loss: 4.8462, lr: 0.001000, 22.08s
2024-09-25 20:47:07 INFO     epoch complete!
2024-09-25 20:47:07 INFO     evaluating now!
2024-09-25 20:47:09 INFO     Epoch [54/200] train_loss: 3.9626, val_loss: 7.4248, lr: 0.001000, 22.06s
2024-09-25 20:47:29 INFO     epoch complete!
2024-09-25 20:47:29 INFO     evaluating now!
2024-09-25 20:47:31 INFO     Epoch [55/200] train_loss: 3.9526, val_loss: 5.5349, lr: 0.001000, 22.06s
2024-09-25 20:47:51 INFO     epoch complete!
2024-09-25 20:47:51 INFO     evaluating now!
2024-09-25 20:47:53 INFO     Epoch [56/200] train_loss: 3.8952, val_loss: 6.6835, lr: 0.001000, 22.05s
2024-09-25 20:48:13 INFO     epoch complete!
2024-09-25 20:48:13 INFO     evaluating now!
2024-09-25 20:48:15 INFO     Epoch [57/200] train_loss: 3.9009, val_loss: 5.5311, lr: 0.001000, 22.18s
2024-09-25 20:48:35 INFO     epoch complete!
2024-09-25 20:48:35 INFO     evaluating now!
2024-09-25 20:48:37 INFO     Epoch [58/200] train_loss: 3.8777, val_loss: 4.9284, lr: 0.001000, 22.10s
2024-09-25 20:48:57 INFO     epoch complete!
2024-09-25 20:48:57 INFO     evaluating now!
2024-09-25 20:48:59 INFO     Epoch [59/200] train_loss: 3.9050, val_loss: 8.2320, lr: 0.001000, 22.12s
2024-09-25 20:49:19 INFO     epoch complete!
2024-09-25 20:49:19 INFO     evaluating now!
2024-09-25 20:49:22 INFO     Epoch [60/200] train_loss: 3.8473, val_loss: 4.8985, lr: 0.001000, 22.19s
2024-09-25 20:49:41 INFO     epoch complete!
2024-09-25 20:49:41 INFO     evaluating now!
2024-09-25 20:49:43 INFO     Epoch [61/200] train_loss: 3.8416, val_loss: 5.1021, lr: 0.001000, 21.92s
2024-09-25 20:50:04 INFO     epoch complete!
2024-09-25 20:50:04 INFO     evaluating now!
2024-09-25 20:50:06 INFO     Epoch [62/200] train_loss: 3.8542, val_loss: 4.8377, lr: 0.001000, 22.59s
2024-09-25 20:50:27 INFO     epoch complete!
2024-09-25 20:50:27 INFO     evaluating now!
2024-09-25 20:50:29 INFO     Epoch [63/200] train_loss: 3.8308, val_loss: 5.3821, lr: 0.001000, 22.82s
2024-09-25 20:50:49 INFO     epoch complete!
2024-09-25 20:50:49 INFO     evaluating now!
2024-09-25 20:50:51 INFO     Epoch [64/200] train_loss: 3.7620, val_loss: 5.0924, lr: 0.001000, 22.55s
2024-09-25 20:51:12 INFO     epoch complete!
2024-09-25 20:51:12 INFO     evaluating now!
2024-09-25 20:51:14 INFO     Epoch [65/200] train_loss: 3.7757, val_loss: 5.1330, lr: 0.001000, 22.85s
2024-09-25 20:51:35 INFO     epoch complete!
2024-09-25 20:51:35 INFO     evaluating now!
2024-09-25 20:51:37 INFO     Epoch [66/200] train_loss: 3.7834, val_loss: 4.8501, lr: 0.001000, 22.60s
2024-09-25 20:51:57 INFO     epoch complete!
2024-09-25 20:51:57 INFO     evaluating now!
2024-09-25 20:51:59 INFO     Epoch [67/200] train_loss: 3.7695, val_loss: 5.4442, lr: 0.001000, 22.34s
2024-09-25 20:51:59 WARNING  Early stopping at epoch: 67
2024-09-25 20:51:59 INFO     Trained totally 68 epochs, average train time is 20.068s, average eval time is 2.120s
2024-09-25 20:52:00 INFO     Loaded model at 52
2024-09-25 20:52:00 INFO     Saved model at ./libcity/cache/10001/model_cache/GWNET_CHITaxi20190406.m
2024-09-25 20:52:00 INFO     Start evaluating ...
2024-09-25 20:52:05 INFO     Note that you select the single mode to evaluate!
2024-09-25 20:52:05 INFO     Evaluate result is saved at ./libcity/cache/10001/evaluate_cache/2024_09_25_20_52_05_GWNET_CHITaxi20190406.csv
2024-09-25 20:52:05 INFO     
         MAE       RMSE
1   2.181690   6.510920
2   2.351752   7.537269
3   2.571397   8.633883
4   2.719123   9.461038
5   2.888065  10.536674
6   3.037317  11.758024
7   3.193120  13.352866
8   3.551240  14.603795
9   3.354321  14.781603
10  3.437813  14.468153
11  3.391162  14.031287
12  3.445858  13.997787
2024-09-25 20:52:05 INFO     ----------------------------------------------------------------------------
2024-09-25 20:52:05 INFO     # 2, Kownledge Graph Embedding: GIE, Experiment ids: 10002
2024-09-25 20:52:05 INFO     ----------------------------------------------------------------------------
2024-09-25 20:52:05 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=10002
2024-09-25 20:52:05 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10002, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'MultiHop', 'max_hop': 1, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-25 20:52:06 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-25 20:52:06 INFO     set_weight_link_or_dist: dist
2024-09-25 20:52:06 INFO     init_weight_inf_or_zero: inf
2024-09-25 20:52:06 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-25 20:52:06 INFO     Start Calculate the weight by Gauss kernel!
2024-09-25 20:52:06 INFO     Loading file CHITaxi20190406.dyna
2024-09-25 20:52:06 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-25 20:52:06 INFO     Dataset created
2024-09-25 20:52:06 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-25 20:52:06 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-25 20:52:06 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-25 20:52:06 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-25 20:52:06 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-25 20:52:06 INFO     NoneScaler
2024-09-25 20:52:06 INFO     add adj_mx to supports
2024-09-25 20:52:06 INFO     add apt_adj(v1 * v2) in forward process
2024-09-25 20:52:06 INFO     add multi hop score in forward process
2024-09-25 20:52:06 INFO     receptive_field: 14
2024-09-25 20:52:07 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(2, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-25 20:52:07 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-25 20:52:07 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-25 20:52:07 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:52:07 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:52:07 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:52:07 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:52:07 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:52:07 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:52:07 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:52:07 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:52:07 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:52:07 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:52:07 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:52:07 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:52:07 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:52:07 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:52:07 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:52:07 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 20:52:07 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:52:07 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:52:07 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:52:07 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:52:07 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:52:07 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:52:07 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:52:07 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-25 20:52:07 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     start_conv.weight	torch.Size([32, 2, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-25 20:52:07 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-25 20:52:07 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-25 20:52:07 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-25 20:52:07 INFO     Total parameter numbers: 323184
2024-09-25 20:52:07 INFO     You select `adam` optimizer.
2024-09-25 20:52:07 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-25 20:52:07 INFO     Start training ...
2024-09-25 20:52:07 INFO     num_batches:96
2024-09-25 20:52:30 INFO     epoch complete!
2024-09-25 20:52:30 INFO     evaluating now!
2024-09-25 20:52:32 INFO     Epoch [0/200] train_loss: 11.9485, val_loss: 12.4263, lr: 0.001000, 25.14s
2024-09-25 20:52:32 INFO     Saved model at 0
2024-09-25 20:52:32 INFO     Val loss decrease from inf to 12.4263, saving to ./libcity/cache/10002/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-25 20:52:52 INFO     epoch complete!
2024-09-25 20:52:52 INFO     evaluating now!
2024-09-25 20:52:54 INFO     Epoch [1/200] train_loss: 8.9904, val_loss: 8.1225, lr: 0.001000, 22.04s
2024-09-25 20:52:55 INFO     Saved model at 1
2024-09-25 20:52:55 INFO     Val loss decrease from 12.4263 to 8.1225, saving to ./libcity/cache/10002/model_cache/GWNET_CHITaxi20190406_epoch1.tar
2024-09-25 20:53:15 INFO     epoch complete!
2024-09-25 20:53:15 INFO     evaluating now!
2024-09-25 20:53:17 INFO     Epoch [2/200] train_loss: 8.4538, val_loss: 9.8830, lr: 0.001000, 22.26s
2024-09-25 20:53:37 INFO     epoch complete!
2024-09-25 20:53:37 INFO     evaluating now!
2024-09-25 20:53:39 INFO     Epoch [3/200] train_loss: 8.1836, val_loss: 8.2086, lr: 0.001000, 22.02s
2024-09-25 20:53:59 INFO     epoch complete!
2024-09-25 20:53:59 INFO     evaluating now!
2024-09-25 20:54:01 INFO     Epoch [4/200] train_loss: 7.8454, val_loss: 9.2279, lr: 0.001000, 22.04s
2024-09-25 20:54:21 INFO     epoch complete!
2024-09-25 20:54:21 INFO     evaluating now!
2024-09-25 20:54:23 INFO     Epoch [5/200] train_loss: 7.6456, val_loss: 7.9043, lr: 0.001000, 21.99s
2024-09-25 20:54:23 INFO     Saved model at 5
2024-09-25 20:54:23 INFO     Val loss decrease from 8.1225 to 7.9043, saving to ./libcity/cache/10002/model_cache/GWNET_CHITaxi20190406_epoch5.tar
2024-09-25 20:54:44 INFO     epoch complete!
2024-09-25 20:54:44 INFO     evaluating now!
2024-09-25 20:54:46 INFO     Epoch [6/200] train_loss: 7.3393, val_loss: 6.8337, lr: 0.001000, 22.94s
2024-09-25 20:54:47 INFO     Saved model at 6
2024-09-25 20:54:47 INFO     Val loss decrease from 7.9043 to 6.8337, saving to ./libcity/cache/10002/model_cache/GWNET_CHITaxi20190406_epoch6.tar
2024-09-25 20:55:07 INFO     epoch complete!
2024-09-25 20:55:07 INFO     evaluating now!
2024-09-25 20:55:09 INFO     Epoch [7/200] train_loss: 6.4831, val_loss: 6.1245, lr: 0.001000, 21.89s
2024-09-25 20:55:09 INFO     Saved model at 7
2024-09-25 20:55:09 INFO     Val loss decrease from 6.8337 to 6.1245, saving to ./libcity/cache/10002/model_cache/GWNET_CHITaxi20190406_epoch7.tar
2024-09-25 20:55:29 INFO     epoch complete!
2024-09-25 20:55:29 INFO     evaluating now!
2024-09-25 20:55:31 INFO     Epoch [8/200] train_loss: 5.9282, val_loss: 5.7449, lr: 0.001000, 22.04s
2024-09-25 20:55:31 INFO     Saved model at 8
2024-09-25 20:55:31 INFO     Val loss decrease from 6.1245 to 5.7449, saving to ./libcity/cache/10002/model_cache/GWNET_CHITaxi20190406_epoch8.tar
2024-09-25 20:55:53 INFO     epoch complete!
2024-09-25 20:55:53 INFO     evaluating now!
2024-09-25 20:55:56 INFO     Epoch [9/200] train_loss: 5.7344, val_loss: 7.0535, lr: 0.001000, 24.69s
2024-09-25 20:56:22 INFO     epoch complete!
2024-09-25 20:56:22 INFO     evaluating now!
2024-09-25 20:56:25 INFO     Epoch [10/200] train_loss: 5.6995, val_loss: 5.7690, lr: 0.001000, 28.47s
2024-09-25 20:56:50 INFO     epoch complete!
2024-09-25 20:56:50 INFO     evaluating now!
2024-09-25 20:56:53 INFO     Epoch [11/200] train_loss: 5.4137, val_loss: 5.7154, lr: 0.001000, 28.53s
2024-09-25 20:56:53 INFO     Saved model at 11
2024-09-25 20:56:53 INFO     Val loss decrease from 5.7449 to 5.7154, saving to ./libcity/cache/10002/model_cache/GWNET_CHITaxi20190406_epoch11.tar
2024-09-25 20:57:15 INFO     epoch complete!
2024-09-25 20:57:15 INFO     evaluating now!
2024-09-25 20:57:17 INFO     Epoch [12/200] train_loss: 5.4070, val_loss: 9.5797, lr: 0.001000, 23.48s
2024-09-25 20:57:37 INFO     epoch complete!
2024-09-25 20:57:37 INFO     evaluating now!
2024-09-25 20:57:39 INFO     Epoch [13/200] train_loss: 5.2887, val_loss: 5.6829, lr: 0.001000, 22.09s
2024-09-25 20:57:39 INFO     Saved model at 13
2024-09-25 20:57:39 INFO     Val loss decrease from 5.7154 to 5.6829, saving to ./libcity/cache/10002/model_cache/GWNET_CHITaxi20190406_epoch13.tar
2024-09-25 20:57:59 INFO     epoch complete!
2024-09-25 20:57:59 INFO     evaluating now!
2024-09-25 20:58:01 INFO     Epoch [14/200] train_loss: 5.0752, val_loss: 5.6477, lr: 0.001000, 22.34s
2024-09-25 20:58:02 INFO     Saved model at 14
2024-09-25 20:58:02 INFO     Val loss decrease from 5.6829 to 5.6477, saving to ./libcity/cache/10002/model_cache/GWNET_CHITaxi20190406_epoch14.tar
2024-09-25 20:58:22 INFO     epoch complete!
2024-09-25 20:58:22 INFO     evaluating now!
2024-09-25 20:58:24 INFO     Epoch [15/200] train_loss: 5.1380, val_loss: 8.1375, lr: 0.001000, 22.46s
2024-09-25 20:58:44 INFO     epoch complete!
2024-09-25 20:58:44 INFO     evaluating now!
2024-09-25 20:58:46 INFO     Epoch [16/200] train_loss: 5.0048, val_loss: 6.4682, lr: 0.001000, 22.49s
2024-09-25 20:59:07 INFO     epoch complete!
2024-09-25 20:59:07 INFO     evaluating now!
2024-09-25 20:59:09 INFO     Epoch [17/200] train_loss: 4.9898, val_loss: 6.9332, lr: 0.001000, 22.43s
2024-09-25 20:59:29 INFO     epoch complete!
2024-09-25 20:59:29 INFO     evaluating now!
2024-09-25 20:59:31 INFO     Epoch [18/200] train_loss: 4.9099, val_loss: 6.9477, lr: 0.001000, 22.29s
2024-09-25 20:59:52 INFO     epoch complete!
2024-09-25 20:59:52 INFO     evaluating now!
2024-09-25 20:59:54 INFO     Epoch [19/200] train_loss: 4.8856, val_loss: 5.1601, lr: 0.001000, 22.50s
2024-09-25 20:59:54 INFO     Saved model at 19
2024-09-25 20:59:54 INFO     Val loss decrease from 5.6477 to 5.1601, saving to ./libcity/cache/10002/model_cache/GWNET_CHITaxi20190406_epoch19.tar
2024-09-25 21:00:14 INFO     epoch complete!
2024-09-25 21:00:14 INFO     evaluating now!
2024-09-25 21:00:16 INFO     Epoch [20/200] train_loss: 4.8168, val_loss: 6.8117, lr: 0.001000, 22.14s
2024-09-25 21:00:36 INFO     epoch complete!
2024-09-25 21:00:36 INFO     evaluating now!
2024-09-25 21:00:38 INFO     Epoch [21/200] train_loss: 4.6887, val_loss: 5.7916, lr: 0.001000, 21.87s
2024-09-25 21:00:58 INFO     epoch complete!
2024-09-25 21:00:58 INFO     evaluating now!
2024-09-25 21:01:00 INFO     Epoch [22/200] train_loss: 4.7190, val_loss: 5.9467, lr: 0.001000, 21.88s
2024-09-25 21:01:20 INFO     epoch complete!
2024-09-25 21:01:20 INFO     evaluating now!
2024-09-25 21:01:22 INFO     Epoch [23/200] train_loss: 4.6741, val_loss: 5.7665, lr: 0.001000, 22.06s
2024-09-25 21:01:42 INFO     epoch complete!
2024-09-25 21:01:42 INFO     evaluating now!
2024-09-25 21:01:44 INFO     Epoch [24/200] train_loss: 4.5847, val_loss: 5.7700, lr: 0.001000, 22.10s
2024-09-25 21:02:04 INFO     epoch complete!
2024-09-25 21:02:04 INFO     evaluating now!
2024-09-25 21:02:06 INFO     Epoch [25/200] train_loss: 4.5748, val_loss: 5.2753, lr: 0.001000, 22.11s
2024-09-25 21:02:26 INFO     epoch complete!
2024-09-25 21:02:26 INFO     evaluating now!
2024-09-25 21:02:28 INFO     Epoch [26/200] train_loss: 4.6060, val_loss: 5.2249, lr: 0.001000, 21.63s
2024-09-25 21:02:47 INFO     epoch complete!
2024-09-25 21:02:47 INFO     evaluating now!
2024-09-25 21:02:49 INFO     Epoch [27/200] train_loss: 4.4931, val_loss: 5.2508, lr: 0.001000, 21.69s
2024-09-25 21:03:09 INFO     epoch complete!
2024-09-25 21:03:09 INFO     evaluating now!
2024-09-25 21:03:11 INFO     Epoch [28/200] train_loss: 4.4826, val_loss: 5.2603, lr: 0.001000, 21.84s
2024-09-25 21:03:31 INFO     epoch complete!
2024-09-25 21:03:31 INFO     evaluating now!
2024-09-25 21:03:33 INFO     Epoch [29/200] train_loss: 4.4455, val_loss: 6.3107, lr: 0.001000, 21.70s
2024-09-25 21:03:53 INFO     epoch complete!
2024-09-25 21:03:53 INFO     evaluating now!
2024-09-25 21:03:55 INFO     Epoch [30/200] train_loss: 4.4042, val_loss: 5.0918, lr: 0.001000, 21.94s
2024-09-25 21:03:55 INFO     Saved model at 30
2024-09-25 21:03:55 INFO     Val loss decrease from 5.1601 to 5.0918, saving to ./libcity/cache/10002/model_cache/GWNET_CHITaxi20190406_epoch30.tar
2024-09-25 21:04:15 INFO     epoch complete!
2024-09-25 21:04:15 INFO     evaluating now!
2024-09-25 21:04:17 INFO     Epoch [31/200] train_loss: 4.4287, val_loss: 5.2973, lr: 0.001000, 21.39s
2024-09-25 21:04:36 INFO     epoch complete!
2024-09-25 21:04:36 INFO     evaluating now!
2024-09-25 21:04:39 INFO     Epoch [32/200] train_loss: 4.4160, val_loss: 5.0339, lr: 0.001000, 21.74s
2024-09-25 21:04:39 INFO     Saved model at 32
2024-09-25 21:04:39 INFO     Val loss decrease from 5.0918 to 5.0339, saving to ./libcity/cache/10002/model_cache/GWNET_CHITaxi20190406_epoch32.tar
2024-09-25 21:04:59 INFO     epoch complete!
2024-09-25 21:04:59 INFO     evaluating now!
2024-09-25 21:05:01 INFO     Epoch [33/200] train_loss: 4.3770, val_loss: 5.4800, lr: 0.001000, 21.88s
2024-09-25 21:05:20 INFO     epoch complete!
2024-09-25 21:05:20 INFO     evaluating now!
2024-09-25 21:05:23 INFO     Epoch [34/200] train_loss: 4.3346, val_loss: 5.3332, lr: 0.001000, 21.62s
2024-09-25 21:05:42 INFO     epoch complete!
2024-09-25 21:05:42 INFO     evaluating now!
2024-09-25 21:05:44 INFO     Epoch [35/200] train_loss: 4.2990, val_loss: 5.3614, lr: 0.001000, 21.84s
2024-09-25 21:06:04 INFO     epoch complete!
2024-09-25 21:06:04 INFO     evaluating now!
2024-09-25 21:06:07 INFO     Epoch [36/200] train_loss: 4.2199, val_loss: 5.0552, lr: 0.001000, 22.20s
2024-09-25 21:06:27 INFO     epoch complete!
2024-09-25 21:06:27 INFO     evaluating now!
2024-09-25 21:06:29 INFO     Epoch [37/200] train_loss: 4.2356, val_loss: 5.3310, lr: 0.001000, 22.29s
2024-09-25 21:06:49 INFO     epoch complete!
2024-09-25 21:06:49 INFO     evaluating now!
2024-09-25 21:06:51 INFO     Epoch [38/200] train_loss: 4.2521, val_loss: 5.5839, lr: 0.001000, 22.02s
2024-09-25 21:07:11 INFO     epoch complete!
2024-09-25 21:07:11 INFO     evaluating now!
2024-09-25 21:07:13 INFO     Epoch [39/200] train_loss: 4.2111, val_loss: 5.2511, lr: 0.001000, 21.99s
2024-09-25 21:07:33 INFO     epoch complete!
2024-09-25 21:07:33 INFO     evaluating now!
2024-09-25 21:07:35 INFO     Epoch [40/200] train_loss: 4.2525, val_loss: 6.5776, lr: 0.001000, 21.99s
2024-09-25 21:07:55 INFO     epoch complete!
2024-09-25 21:07:55 INFO     evaluating now!
2024-09-25 21:07:57 INFO     Epoch [41/200] train_loss: 4.1777, val_loss: 6.4838, lr: 0.001000, 22.07s
2024-09-25 21:08:17 INFO     epoch complete!
2024-09-25 21:08:17 INFO     evaluating now!
2024-09-25 21:08:19 INFO     Epoch [42/200] train_loss: 4.1250, val_loss: 6.2241, lr: 0.001000, 21.77s
2024-09-25 21:08:38 INFO     epoch complete!
2024-09-25 21:08:38 INFO     evaluating now!
2024-09-25 21:08:40 INFO     Epoch [43/200] train_loss: 4.1385, val_loss: 5.0178, lr: 0.001000, 21.77s
2024-09-25 21:08:41 INFO     Saved model at 43
2024-09-25 21:08:41 INFO     Val loss decrease from 5.0339 to 5.0178, saving to ./libcity/cache/10002/model_cache/GWNET_CHITaxi20190406_epoch43.tar
2024-09-25 21:09:00 INFO     epoch complete!
2024-09-25 21:09:00 INFO     evaluating now!
2024-09-25 21:09:02 INFO     Epoch [44/200] train_loss: 4.1772, val_loss: 6.1844, lr: 0.001000, 21.78s
2024-09-25 21:09:22 INFO     epoch complete!
2024-09-25 21:09:22 INFO     evaluating now!
2024-09-25 21:09:24 INFO     Epoch [45/200] train_loss: 4.1289, val_loss: 5.7219, lr: 0.001000, 21.66s
2024-09-25 21:09:44 INFO     epoch complete!
2024-09-25 21:09:44 INFO     evaluating now!
2024-09-25 21:09:46 INFO     Epoch [46/200] train_loss: 4.1912, val_loss: 5.3195, lr: 0.001000, 21.65s
2024-09-25 21:10:05 INFO     epoch complete!
2024-09-25 21:10:05 INFO     evaluating now!
2024-09-25 21:10:07 INFO     Epoch [47/200] train_loss: 4.0850, val_loss: 4.9636, lr: 0.001000, 21.55s
2024-09-25 21:10:07 INFO     Saved model at 47
2024-09-25 21:10:07 INFO     Val loss decrease from 5.0178 to 4.9636, saving to ./libcity/cache/10002/model_cache/GWNET_CHITaxi20190406_epoch47.tar
2024-09-25 21:10:27 INFO     epoch complete!
2024-09-25 21:10:27 INFO     evaluating now!
2024-09-25 21:10:29 INFO     Epoch [48/200] train_loss: 4.0571, val_loss: 5.0125, lr: 0.001000, 21.82s
2024-09-25 21:10:49 INFO     epoch complete!
2024-09-25 21:10:49 INFO     evaluating now!
2024-09-25 21:10:51 INFO     Epoch [49/200] train_loss: 4.0848, val_loss: 5.8153, lr: 0.001000, 21.88s
2024-09-25 21:11:11 INFO     epoch complete!
2024-09-25 21:11:11 INFO     evaluating now!
2024-09-25 21:11:13 INFO     Epoch [50/200] train_loss: 4.0475, val_loss: 4.9265, lr: 0.001000, 22.00s
2024-09-25 21:11:14 INFO     Saved model at 50
2024-09-25 21:11:14 INFO     Val loss decrease from 4.9636 to 4.9265, saving to ./libcity/cache/10002/model_cache/GWNET_CHITaxi20190406_epoch50.tar
2024-09-25 21:11:33 INFO     epoch complete!
2024-09-25 21:11:33 INFO     evaluating now!
2024-09-25 21:11:35 INFO     Epoch [51/200] train_loss: 4.0722, val_loss: 4.8481, lr: 0.001000, 21.82s
2024-09-25 21:11:36 INFO     Saved model at 51
2024-09-25 21:11:36 INFO     Val loss decrease from 4.9265 to 4.8481, saving to ./libcity/cache/10002/model_cache/GWNET_CHITaxi20190406_epoch51.tar
2024-09-25 21:11:56 INFO     epoch complete!
2024-09-25 21:11:56 INFO     evaluating now!
2024-09-25 21:11:58 INFO     Epoch [52/200] train_loss: 4.0138, val_loss: 5.4824, lr: 0.001000, 21.86s
2024-09-25 21:12:18 INFO     epoch complete!
2024-09-25 21:12:18 INFO     evaluating now!
2024-09-25 21:12:20 INFO     Epoch [53/200] train_loss: 3.9963, val_loss: 4.9799, lr: 0.001000, 21.92s
2024-09-25 21:12:39 INFO     epoch complete!
2024-09-25 21:12:39 INFO     evaluating now!
2024-09-25 21:12:42 INFO     Epoch [54/200] train_loss: 3.9988, val_loss: 6.1178, lr: 0.001000, 21.92s
2024-09-25 21:13:01 INFO     epoch complete!
2024-09-25 21:13:01 INFO     evaluating now!
2024-09-25 21:13:03 INFO     Epoch [55/200] train_loss: 3.9902, val_loss: 4.9946, lr: 0.001000, 21.83s
2024-09-25 21:13:23 INFO     epoch complete!
2024-09-25 21:13:23 INFO     evaluating now!
2024-09-25 21:13:25 INFO     Epoch [56/200] train_loss: 4.0083, val_loss: 4.7991, lr: 0.001000, 21.85s
2024-09-25 21:13:26 INFO     Saved model at 56
2024-09-25 21:13:26 INFO     Val loss decrease from 4.8481 to 4.7991, saving to ./libcity/cache/10002/model_cache/GWNET_CHITaxi20190406_epoch56.tar
2024-09-25 21:13:45 INFO     epoch complete!
2024-09-25 21:13:45 INFO     evaluating now!
2024-09-25 21:13:47 INFO     Epoch [57/200] train_loss: 3.9406, val_loss: 5.3838, lr: 0.001000, 21.89s
2024-09-25 21:14:07 INFO     epoch complete!
2024-09-25 21:14:07 INFO     evaluating now!
2024-09-25 21:14:09 INFO     Epoch [58/200] train_loss: 3.8884, val_loss: 4.9551, lr: 0.001000, 21.97s
2024-09-25 21:14:30 INFO     epoch complete!
2024-09-25 21:14:30 INFO     evaluating now!
2024-09-25 21:14:32 INFO     Epoch [59/200] train_loss: 3.8742, val_loss: 4.9696, lr: 0.001000, 22.26s
2024-09-25 21:14:52 INFO     epoch complete!
2024-09-25 21:14:52 INFO     evaluating now!
2024-09-25 21:14:54 INFO     Epoch [60/200] train_loss: 3.9015, val_loss: 5.7589, lr: 0.001000, 21.97s
2024-09-25 21:15:13 INFO     epoch complete!
2024-09-25 21:15:13 INFO     evaluating now!
2024-09-25 21:15:16 INFO     Epoch [61/200] train_loss: 3.8899, val_loss: 6.6145, lr: 0.001000, 21.87s
2024-09-25 21:15:36 INFO     epoch complete!
2024-09-25 21:15:36 INFO     evaluating now!
2024-09-25 21:15:38 INFO     Epoch [62/200] train_loss: 3.8750, val_loss: 4.9749, lr: 0.001000, 22.10s
2024-09-25 21:15:58 INFO     epoch complete!
2024-09-25 21:15:58 INFO     evaluating now!
2024-09-25 21:16:00 INFO     Epoch [63/200] train_loss: 3.8574, val_loss: 4.8670, lr: 0.001000, 22.00s
2024-09-25 21:16:19 INFO     epoch complete!
2024-09-25 21:16:19 INFO     evaluating now!
2024-09-25 21:16:21 INFO     Epoch [64/200] train_loss: 3.8390, val_loss: 4.9508, lr: 0.001000, 21.72s
2024-09-25 21:16:41 INFO     epoch complete!
2024-09-25 21:16:41 INFO     evaluating now!
2024-09-25 21:16:43 INFO     Epoch [65/200] train_loss: 3.8253, val_loss: 5.4968, lr: 0.001000, 21.83s
2024-09-25 21:17:03 INFO     epoch complete!
2024-09-25 21:17:03 INFO     evaluating now!
2024-09-25 21:17:05 INFO     Epoch [66/200] train_loss: 3.8032, val_loss: 5.1948, lr: 0.001000, 21.92s
2024-09-25 21:17:25 INFO     epoch complete!
2024-09-25 21:17:25 INFO     evaluating now!
2024-09-25 21:17:27 INFO     Epoch [67/200] train_loss: 3.8274, val_loss: 5.0714, lr: 0.001000, 21.95s
2024-09-25 21:17:47 INFO     epoch complete!
2024-09-25 21:17:47 INFO     evaluating now!
2024-09-25 21:17:49 INFO     Epoch [68/200] train_loss: 3.8066, val_loss: 5.8913, lr: 0.001000, 22.06s
2024-09-25 21:18:09 INFO     epoch complete!
2024-09-25 21:18:09 INFO     evaluating now!
2024-09-25 21:18:11 INFO     Epoch [69/200] train_loss: 3.7786, val_loss: 5.7558, lr: 0.001000, 22.10s
2024-09-25 21:18:31 INFO     epoch complete!
2024-09-25 21:18:31 INFO     evaluating now!
2024-09-25 21:18:33 INFO     Epoch [70/200] train_loss: 3.8273, val_loss: 4.9788, lr: 0.001000, 21.98s
2024-09-25 21:18:53 INFO     epoch complete!
2024-09-25 21:18:53 INFO     evaluating now!
2024-09-25 21:18:55 INFO     Epoch [71/200] train_loss: 3.7773, val_loss: 5.1665, lr: 0.001000, 21.75s
2024-09-25 21:18:55 WARNING  Early stopping at epoch: 71
2024-09-25 21:18:55 INFO     Trained totally 72 epochs, average train time is 20.129s, average eval time is 2.127s
2024-09-25 21:18:55 INFO     Loaded model at 56
2024-09-25 21:18:55 INFO     Saved model at ./libcity/cache/10002/model_cache/GWNET_CHITaxi20190406.m
2024-09-25 21:18:55 INFO     Start evaluating ...
2024-09-25 21:19:00 INFO     Note that you select the single mode to evaluate!
2024-09-25 21:19:00 INFO     Evaluate result is saved at ./libcity/cache/10002/evaluate_cache/2024_09_25_21_19_00_GWNET_CHITaxi20190406.csv
2024-09-25 21:19:00 INFO     
         MAE       RMSE
1   2.273302   6.781533
2   2.455652   7.720839
3   2.623837   8.792593
4   2.778988   9.711210
5   2.951029  10.501860
6   3.083445  11.701966
7   3.173857  12.661523
8   3.266253  13.382053
9   3.312029  13.562038
10  3.293373  13.465748
11  3.352008  13.431829
12  3.420224  13.818787
2024-09-25 21:19:01 INFO     ----------------------------------------------------------------------------
2024-09-25 21:19:01 INFO     # 3, Kownledge Graph Embedding: GIE, Experiment ids: 10003
2024-09-25 21:19:01 INFO     ----------------------------------------------------------------------------
2024-09-25 21:19:01 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=10003
2024-09-25 21:19:01 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10003, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'MultiHop', 'max_hop': 1, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-25 21:19:01 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-25 21:19:01 INFO     set_weight_link_or_dist: dist
2024-09-25 21:19:01 INFO     init_weight_inf_or_zero: inf
2024-09-25 21:19:01 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-25 21:19:01 INFO     Start Calculate the weight by Gauss kernel!
2024-09-25 21:19:01 INFO     Loading file CHITaxi20190406.dyna
2024-09-25 21:19:02 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-25 21:19:02 INFO     Dataset created
2024-09-25 21:19:02 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-25 21:19:02 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-25 21:19:02 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-25 21:19:02 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-25 21:19:02 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-25 21:19:02 INFO     NoneScaler
2024-09-25 21:19:02 INFO     add adj_mx to supports
2024-09-25 21:19:02 INFO     add apt_adj(v1 * v2) in forward process
2024-09-25 21:19:02 INFO     add multi hop score in forward process
2024-09-25 21:19:02 INFO     receptive_field: 14
2024-09-25 21:19:03 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(2, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-25 21:19:03 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-25 21:19:03 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-25 21:19:03 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:19:03 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:19:03 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:19:03 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:19:03 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:19:03 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:19:03 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:19:03 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:19:03 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:19:03 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:19:03 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:19:03 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:19:03 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:19:03 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:19:03 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:19:03 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:19:03 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-25 21:19:03 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-25 21:19:03 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-25 21:19:03 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-25 21:19:03 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-25 21:19:03 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-25 21:19:03 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-25 21:19:03 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-25 21:19:03 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     start_conv.weight	torch.Size([32, 2, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:19:03 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-25 21:19:03 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-25 21:19:03 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-25 21:19:03 INFO     Total parameter numbers: 323184
2024-09-25 21:19:03 INFO     You select `adam` optimizer.
2024-09-25 21:19:03 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-25 21:19:03 INFO     Start training ...
2024-09-25 21:19:03 INFO     num_batches:96
2024-09-25 21:19:23 INFO     epoch complete!
2024-09-25 21:19:23 INFO     evaluating now!
2024-09-25 21:19:25 INFO     Epoch [0/200] train_loss: 12.2080, val_loss: 9.4721, lr: 0.001000, 22.23s
2024-09-25 21:19:25 INFO     Saved model at 0
2024-09-25 21:19:25 INFO     Val loss decrease from inf to 9.4721, saving to ./libcity/cache/10003/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-25 21:19:46 INFO     epoch complete!
2024-09-25 21:19:46 INFO     evaluating now!
2024-09-25 21:19:48 INFO     Epoch [1/200] train_loss: 9.3158, val_loss: 9.2561, lr: 0.001000, 22.32s
2024-09-25 21:19:48 INFO     Saved model at 1
2024-09-25 21:19:48 INFO     Val loss decrease from 9.4721 to 9.2561, saving to ./libcity/cache/10003/model_cache/GWNET_CHITaxi20190406_epoch1.tar
2024-09-25 21:20:08 INFO     epoch complete!
2024-09-25 21:20:08 INFO     evaluating now!
2024-09-25 21:20:11 INFO     Epoch [2/200] train_loss: 8.2547, val_loss: 7.8540, lr: 0.001000, 22.22s
2024-09-25 21:20:11 INFO     Saved model at 2
2024-09-25 21:20:11 INFO     Val loss decrease from 9.2561 to 7.8540, saving to ./libcity/cache/10003/model_cache/GWNET_CHITaxi20190406_epoch2.tar
2024-09-25 21:20:31 INFO     epoch complete!
2024-09-25 21:20:31 INFO     evaluating now!
2024-09-25 21:20:33 INFO     Epoch [3/200] train_loss: 7.9616, val_loss: 7.9541, lr: 0.001000, 21.99s
2024-09-25 21:20:53 INFO     epoch complete!
2024-09-25 21:20:53 INFO     evaluating now!
2024-09-25 21:20:55 INFO     Epoch [4/200] train_loss: 7.8604, val_loss: 8.5194, lr: 0.001000, 21.90s
2024-09-25 21:21:15 INFO     epoch complete!
2024-09-25 21:21:15 INFO     evaluating now!
2024-09-25 21:21:17 INFO     Epoch [5/200] train_loss: 7.6882, val_loss: 8.0775, lr: 0.001000, 21.92s
2024-09-25 21:21:36 INFO     epoch complete!
2024-09-25 21:21:36 INFO     evaluating now!
2024-09-25 21:21:39 INFO     Epoch [6/200] train_loss: 7.3583, val_loss: 6.9826, lr: 0.001000, 21.77s
2024-09-25 21:21:39 INFO     Saved model at 6
2024-09-25 21:21:39 INFO     Val loss decrease from 7.8540 to 6.9826, saving to ./libcity/cache/10003/model_cache/GWNET_CHITaxi20190406_epoch6.tar
2024-09-25 21:21:59 INFO     epoch complete!
2024-09-25 21:21:59 INFO     evaluating now!
2024-09-25 21:22:01 INFO     Epoch [7/200] train_loss: 6.2226, val_loss: 5.8091, lr: 0.001000, 21.85s
2024-09-25 21:22:01 INFO     Saved model at 7
2024-09-25 21:22:01 INFO     Val loss decrease from 6.9826 to 5.8091, saving to ./libcity/cache/10003/model_cache/GWNET_CHITaxi20190406_epoch7.tar
2024-09-25 21:22:21 INFO     epoch complete!
2024-09-25 21:22:21 INFO     evaluating now!
2024-09-25 21:22:23 INFO     Epoch [8/200] train_loss: 5.8960, val_loss: 7.2687, lr: 0.001000, 21.59s
2024-09-25 21:22:42 INFO     epoch complete!
2024-09-25 21:22:42 INFO     evaluating now!
2024-09-25 21:22:44 INFO     Epoch [9/200] train_loss: 5.7495, val_loss: 6.2538, lr: 0.001000, 21.70s
2024-09-25 21:23:04 INFO     epoch complete!
2024-09-25 21:23:04 INFO     evaluating now!
2024-09-25 21:23:06 INFO     Epoch [10/200] train_loss: 5.5615, val_loss: 5.8415, lr: 0.001000, 21.90s
2024-09-25 21:23:26 INFO     epoch complete!
2024-09-25 21:23:26 INFO     evaluating now!
2024-09-25 21:23:28 INFO     Epoch [11/200] train_loss: 5.4618, val_loss: 6.1457, lr: 0.001000, 21.56s
2024-09-25 21:23:47 INFO     epoch complete!
2024-09-25 21:23:47 INFO     evaluating now!
2024-09-25 21:23:50 INFO     Epoch [12/200] train_loss: 5.4796, val_loss: 5.1872, lr: 0.001000, 21.75s
2024-09-25 21:23:50 INFO     Saved model at 12
2024-09-25 21:23:50 INFO     Val loss decrease from 5.8091 to 5.1872, saving to ./libcity/cache/10003/model_cache/GWNET_CHITaxi20190406_epoch12.tar
2024-09-25 21:24:10 INFO     epoch complete!
2024-09-25 21:24:10 INFO     evaluating now!
2024-09-25 21:24:12 INFO     Epoch [13/200] train_loss: 5.1863, val_loss: 5.2515, lr: 0.001000, 21.76s
2024-09-25 21:24:31 INFO     epoch complete!
2024-09-25 21:24:31 INFO     evaluating now!
2024-09-25 21:24:33 INFO     Epoch [14/200] train_loss: 5.0998, val_loss: 5.7727, lr: 0.001000, 21.56s
2024-09-25 21:24:53 INFO     epoch complete!
2024-09-25 21:24:53 INFO     evaluating now!
2024-09-25 21:24:55 INFO     Epoch [15/200] train_loss: 5.0784, val_loss: 5.5855, lr: 0.001000, 21.86s
2024-09-25 21:25:15 INFO     epoch complete!
2024-09-25 21:25:15 INFO     evaluating now!
2024-09-25 21:25:17 INFO     Epoch [16/200] train_loss: 5.1381, val_loss: 5.3032, lr: 0.001000, 21.91s
2024-09-25 21:25:37 INFO     epoch complete!
2024-09-25 21:25:37 INFO     evaluating now!
2024-09-25 21:25:39 INFO     Epoch [17/200] train_loss: 4.9370, val_loss: 5.5436, lr: 0.001000, 21.98s
2024-09-25 21:25:59 INFO     epoch complete!
2024-09-25 21:25:59 INFO     evaluating now!
2024-09-25 21:26:01 INFO     Epoch [18/200] train_loss: 4.9224, val_loss: 5.4353, lr: 0.001000, 21.98s
2024-09-25 21:26:21 INFO     epoch complete!
2024-09-25 21:26:21 INFO     evaluating now!
2024-09-25 21:26:23 INFO     Epoch [19/200] train_loss: 4.8038, val_loss: 5.2533, lr: 0.001000, 22.06s
2024-09-25 21:26:43 INFO     epoch complete!
2024-09-25 21:26:43 INFO     evaluating now!
2024-09-25 21:26:45 INFO     Epoch [20/200] train_loss: 4.7751, val_loss: 5.4769, lr: 0.001000, 22.20s
2024-09-25 21:27:05 INFO     epoch complete!
2024-09-25 21:27:05 INFO     evaluating now!
2024-09-25 21:27:08 INFO     Epoch [21/200] train_loss: 4.6599, val_loss: 5.0845, lr: 0.001000, 22.33s
2024-09-25 21:27:08 INFO     Saved model at 21
2024-09-25 21:27:08 INFO     Val loss decrease from 5.1872 to 5.0845, saving to ./libcity/cache/10003/model_cache/GWNET_CHITaxi20190406_epoch21.tar
2024-09-25 21:27:28 INFO     epoch complete!
2024-09-25 21:27:28 INFO     evaluating now!
2024-09-25 21:27:30 INFO     Epoch [22/200] train_loss: 4.6333, val_loss: 5.2349, lr: 0.001000, 22.21s
2024-09-25 21:27:50 INFO     epoch complete!
2024-09-25 21:27:50 INFO     evaluating now!
2024-09-25 21:27:52 INFO     Epoch [23/200] train_loss: 4.6028, val_loss: 5.4079, lr: 0.001000, 22.24s
2024-09-25 21:28:13 INFO     epoch complete!
2024-09-25 21:28:13 INFO     evaluating now!
2024-09-25 21:28:15 INFO     Epoch [24/200] train_loss: 4.6488, val_loss: 5.4876, lr: 0.001000, 22.34s
2024-09-25 21:28:35 INFO     epoch complete!
2024-09-25 21:28:35 INFO     evaluating now!
2024-09-25 21:28:37 INFO     Epoch [25/200] train_loss: 4.5171, val_loss: 5.2614, lr: 0.001000, 22.04s
2024-09-25 21:28:57 INFO     epoch complete!
2024-09-25 21:28:57 INFO     evaluating now!
2024-09-25 21:28:59 INFO     Epoch [26/200] train_loss: 4.4833, val_loss: 5.3773, lr: 0.001000, 22.01s
2024-09-25 21:29:19 INFO     epoch complete!
2024-09-25 21:29:19 INFO     evaluating now!
2024-09-25 21:29:21 INFO     Epoch [27/200] train_loss: 4.4560, val_loss: 5.2577, lr: 0.001000, 22.22s
2024-09-25 21:29:41 INFO     epoch complete!
2024-09-25 21:29:41 INFO     evaluating now!
2024-09-25 21:29:43 INFO     Epoch [28/200] train_loss: 4.4493, val_loss: 5.3947, lr: 0.001000, 22.16s
2024-09-25 21:30:03 INFO     epoch complete!
2024-09-25 21:30:03 INFO     evaluating now!
2024-09-25 21:30:05 INFO     Epoch [29/200] train_loss: 4.4053, val_loss: 5.1662, lr: 0.001000, 22.11s
2024-09-25 21:30:25 INFO     epoch complete!
2024-09-25 21:30:25 INFO     evaluating now!
2024-09-25 21:30:27 INFO     Epoch [30/200] train_loss: 4.3961, val_loss: 4.9515, lr: 0.001000, 21.54s
2024-09-25 21:30:27 INFO     Saved model at 30
2024-09-25 21:30:27 INFO     Val loss decrease from 5.0845 to 4.9515, saving to ./libcity/cache/10003/model_cache/GWNET_CHITaxi20190406_epoch30.tar
2024-09-25 21:30:47 INFO     epoch complete!
2024-09-25 21:30:47 INFO     evaluating now!
2024-09-25 21:30:49 INFO     Epoch [31/200] train_loss: 4.4271, val_loss: 5.1664, lr: 0.001000, 21.63s
2024-09-25 21:31:09 INFO     epoch complete!
2024-09-25 21:31:09 INFO     evaluating now!
2024-09-25 21:31:11 INFO     Epoch [32/200] train_loss: 4.3801, val_loss: 5.2791, lr: 0.001000, 22.08s
2024-09-25 21:31:31 INFO     epoch complete!
2024-09-25 21:31:31 INFO     evaluating now!
2024-09-25 21:31:33 INFO     Epoch [33/200] train_loss: 4.3064, val_loss: 5.5031, lr: 0.001000, 22.42s
2024-09-25 21:31:54 INFO     epoch complete!
2024-09-25 21:31:54 INFO     evaluating now!
2024-09-25 21:31:56 INFO     Epoch [34/200] train_loss: 4.3921, val_loss: 4.9536, lr: 0.001000, 22.51s
2024-09-25 21:32:16 INFO     epoch complete!
2024-09-25 21:32:16 INFO     evaluating now!
2024-09-25 21:32:18 INFO     Epoch [35/200] train_loss: 4.3402, val_loss: 5.1295, lr: 0.001000, 22.37s
2024-09-25 21:32:38 INFO     epoch complete!
2024-09-25 21:32:38 INFO     evaluating now!
2024-09-25 21:32:40 INFO     Epoch [36/200] train_loss: 4.2682, val_loss: 5.0878, lr: 0.001000, 22.07s
2024-09-25 21:33:00 INFO     epoch complete!
2024-09-25 21:33:00 INFO     evaluating now!
2024-09-25 21:33:02 INFO     Epoch [37/200] train_loss: 4.1990, val_loss: 5.0875, lr: 0.001000, 21.93s
2024-09-25 21:33:22 INFO     epoch complete!
2024-09-25 21:33:22 INFO     evaluating now!
2024-09-25 21:33:24 INFO     Epoch [38/200] train_loss: 4.2430, val_loss: 4.9606, lr: 0.001000, 22.10s
2024-09-25 21:33:44 INFO     epoch complete!
2024-09-25 21:33:44 INFO     evaluating now!
2024-09-25 21:33:46 INFO     Epoch [39/200] train_loss: 4.2064, val_loss: 6.9502, lr: 0.001000, 22.13s
2024-09-25 21:34:07 INFO     epoch complete!
2024-09-25 21:34:07 INFO     evaluating now!
2024-09-25 21:34:09 INFO     Epoch [40/200] train_loss: 4.1631, val_loss: 5.2146, lr: 0.001000, 22.41s
2024-09-25 21:34:29 INFO     epoch complete!
2024-09-25 21:34:29 INFO     evaluating now!
2024-09-25 21:34:31 INFO     Epoch [41/200] train_loss: 4.1865, val_loss: 5.7700, lr: 0.001000, 22.35s
2024-09-25 21:34:52 INFO     epoch complete!
2024-09-25 21:34:52 INFO     evaluating now!
2024-09-25 21:34:54 INFO     Epoch [42/200] train_loss: 4.1710, val_loss: 4.9256, lr: 0.001000, 22.66s
2024-09-25 21:34:54 INFO     Saved model at 42
2024-09-25 21:34:54 INFO     Val loss decrease from 4.9515 to 4.9256, saving to ./libcity/cache/10003/model_cache/GWNET_CHITaxi20190406_epoch42.tar
2024-09-25 21:35:14 INFO     epoch complete!
2024-09-25 21:35:14 INFO     evaluating now!
2024-09-25 21:35:17 INFO     Epoch [43/200] train_loss: 4.0865, val_loss: 5.1168, lr: 0.001000, 22.37s
2024-09-25 21:35:37 INFO     epoch complete!
2024-09-25 21:35:37 INFO     evaluating now!
2024-09-25 21:35:39 INFO     Epoch [44/200] train_loss: 4.1286, val_loss: 5.0253, lr: 0.001000, 22.28s
2024-09-25 21:35:59 INFO     epoch complete!
2024-09-25 21:35:59 INFO     evaluating now!
2024-09-25 21:36:01 INFO     Epoch [45/200] train_loss: 4.0663, val_loss: 4.7560, lr: 0.001000, 22.43s
2024-09-25 21:36:01 INFO     Saved model at 45
2024-09-25 21:36:01 INFO     Val loss decrease from 4.9256 to 4.7560, saving to ./libcity/cache/10003/model_cache/GWNET_CHITaxi20190406_epoch45.tar
2024-09-25 21:36:22 INFO     epoch complete!
2024-09-25 21:36:22 INFO     evaluating now!
2024-09-25 21:36:24 INFO     Epoch [46/200] train_loss: 4.0400, val_loss: 4.8020, lr: 0.001000, 22.55s
2024-09-25 21:36:44 INFO     epoch complete!
2024-09-25 21:36:44 INFO     evaluating now!
2024-09-25 21:36:46 INFO     Epoch [47/200] train_loss: 4.0591, val_loss: 4.9011, lr: 0.001000, 22.40s
2024-09-25 21:37:07 INFO     epoch complete!
2024-09-25 21:37:07 INFO     evaluating now!
2024-09-25 21:37:09 INFO     Epoch [48/200] train_loss: 4.0761, val_loss: 4.9133, lr: 0.001000, 22.55s
2024-09-25 21:37:29 INFO     epoch complete!
2024-09-25 21:37:29 INFO     evaluating now!
2024-09-25 21:37:31 INFO     Epoch [49/200] train_loss: 4.0414, val_loss: 4.8342, lr: 0.001000, 22.28s
2024-09-25 21:37:51 INFO     epoch complete!
2024-09-25 21:37:51 INFO     evaluating now!
2024-09-25 21:37:53 INFO     Epoch [50/200] train_loss: 4.0293, val_loss: 4.8453, lr: 0.001000, 21.97s
2024-09-25 21:38:13 INFO     epoch complete!
2024-09-25 21:38:13 INFO     evaluating now!
2024-09-25 21:38:15 INFO     Epoch [51/200] train_loss: 4.0434, val_loss: 5.1575, lr: 0.001000, 22.14s
2024-09-25 21:38:35 INFO     epoch complete!
2024-09-25 21:38:35 INFO     evaluating now!
2024-09-25 21:38:37 INFO     Epoch [52/200] train_loss: 3.9828, val_loss: 4.9973, lr: 0.001000, 21.92s
2024-09-25 21:38:57 INFO     epoch complete!
2024-09-25 21:38:57 INFO     evaluating now!
2024-09-25 21:38:59 INFO     Epoch [53/200] train_loss: 3.9809, val_loss: 5.2218, lr: 0.001000, 22.03s
2024-09-25 21:39:20 INFO     epoch complete!
2024-09-25 21:39:20 INFO     evaluating now!
2024-09-25 21:39:22 INFO     Epoch [54/200] train_loss: 3.9433, val_loss: 5.4841, lr: 0.001000, 22.99s
2024-09-25 21:39:42 INFO     epoch complete!
2024-09-25 21:39:42 INFO     evaluating now!
2024-09-25 21:39:44 INFO     Epoch [55/200] train_loss: 3.9357, val_loss: 4.9008, lr: 0.001000, 22.07s
2024-09-25 21:40:04 INFO     epoch complete!
2024-09-25 21:40:04 INFO     evaluating now!
2024-09-25 21:40:07 INFO     Epoch [56/200] train_loss: 3.9095, val_loss: 4.9662, lr: 0.001000, 22.22s
2024-09-25 21:40:27 INFO     epoch complete!
2024-09-25 21:40:27 INFO     evaluating now!
2024-09-25 21:40:29 INFO     Epoch [57/200] train_loss: 3.9358, val_loss: 4.8621, lr: 0.001000, 22.29s
2024-09-25 21:40:49 INFO     epoch complete!
2024-09-25 21:40:49 INFO     evaluating now!
2024-09-25 21:40:51 INFO     Epoch [58/200] train_loss: 3.9114, val_loss: 5.3422, lr: 0.001000, 21.94s
2024-09-25 21:41:11 INFO     epoch complete!
2024-09-25 21:41:11 INFO     evaluating now!
2024-09-25 21:41:13 INFO     Epoch [59/200] train_loss: 3.9261, val_loss: 4.9982, lr: 0.001000, 22.09s
2024-09-25 21:41:33 INFO     epoch complete!
2024-09-25 21:41:33 INFO     evaluating now!
2024-09-25 21:41:35 INFO     Epoch [60/200] train_loss: 3.8603, val_loss: 5.1407, lr: 0.001000, 22.25s
2024-09-25 21:41:35 WARNING  Early stopping at epoch: 60
2024-09-25 21:41:35 INFO     Trained totally 61 epochs, average train time is 19.999s, average eval time is 2.109s
2024-09-25 21:41:36 INFO     Loaded model at 45
2024-09-25 21:41:36 INFO     Saved model at ./libcity/cache/10003/model_cache/GWNET_CHITaxi20190406.m
2024-09-25 21:41:36 INFO     Start evaluating ...
2024-09-25 21:41:41 INFO     Note that you select the single mode to evaluate!
2024-09-25 21:41:41 INFO     Evaluate result is saved at ./libcity/cache/10003/evaluate_cache/2024_09_25_21_41_41_GWNET_CHITaxi20190406.csv
2024-09-25 21:41:41 INFO     
         MAE       RMSE
1   2.357948   6.892928
2   2.438303   7.581212
3   2.591323   8.657701
4   2.702741   9.159493
5   2.862084   9.660501
6   2.974806  10.204283
7   3.055264  10.576096
8   3.165951  10.861571
9   3.126055  11.036497
10  3.212318  11.186398
11  3.211461  11.573118
12  3.266861  11.999135
2024-09-25 21:41:42 INFO     ----------------------------------------------------------------------------
2024-09-25 21:41:42 INFO     # 4, Kownledge Graph Embedding: GIE, Experiment ids: 10004
2024-09-25 21:41:42 INFO     ----------------------------------------------------------------------------
2024-09-25 21:41:42 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=10004
2024-09-25 21:41:42 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10004, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'MultiHop', 'max_hop': 1, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-25 21:41:42 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-25 21:41:42 INFO     set_weight_link_or_dist: dist
2024-09-25 21:41:42 INFO     init_weight_inf_or_zero: inf
2024-09-25 21:41:42 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-25 21:41:42 INFO     Start Calculate the weight by Gauss kernel!
2024-09-25 21:41:42 INFO     Loading file CHITaxi20190406.dyna
2024-09-25 21:41:42 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-25 21:41:42 INFO     Dataset created
2024-09-25 21:41:42 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-25 21:41:42 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-25 21:41:42 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-25 21:41:42 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-25 21:41:42 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-25 21:41:42 INFO     NoneScaler
2024-09-25 21:41:43 INFO     add adj_mx to supports
2024-09-25 21:41:43 INFO     add apt_adj(v1 * v2) in forward process
2024-09-25 21:41:43 INFO     add multi hop score in forward process
2024-09-25 21:41:43 INFO     receptive_field: 14
2024-09-25 21:41:43 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(288, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(2, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-25 21:41:43 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-25 21:41:43 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-25 21:41:43 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:41:43 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:41:43 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:41:43 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:41:43 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:41:43 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:41:43 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:41:43 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:41:43 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:41:43 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:41:43 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:41:43 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:41:43 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:41:43 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:41:43 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:41:43 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-25 21:41:43 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-25 21:41:43 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-25 21:41:43 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-25 21:41:43 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-25 21:41:43 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-25 21:41:43 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-25 21:41:43 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-25 21:41:43 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-25 21:41:43 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 288, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     start_conv.weight	torch.Size([32, 2, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-25 21:41:43 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-25 21:41:43 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-25 21:41:43 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-25 21:41:43 INFO     Total parameter numbers: 323184
2024-09-25 21:41:43 INFO     You select `adam` optimizer.
2024-09-25 21:41:43 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-25 21:41:43 INFO     Start training ...
2024-09-25 21:41:43 INFO     num_batches:96
2024-09-25 21:42:03 INFO     epoch complete!
2024-09-25 21:42:03 INFO     evaluating now!
2024-09-25 21:42:05 INFO     Epoch [0/200] train_loss: 12.1858, val_loss: 9.7011, lr: 0.001000, 21.94s
2024-09-25 21:42:05 INFO     Saved model at 0
2024-09-25 21:42:05 INFO     Val loss decrease from inf to 9.7011, saving to ./libcity/cache/10004/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-25 21:42:25 INFO     epoch complete!
2024-09-25 21:42:25 INFO     evaluating now!
2024-09-25 21:42:27 INFO     Epoch [1/200] train_loss: 9.2798, val_loss: 9.2135, lr: 0.001000, 21.92s
2024-09-25 21:42:27 INFO     Saved model at 1
2024-09-25 21:42:27 INFO     Val loss decrease from 9.7011 to 9.2135, saving to ./libcity/cache/10004/model_cache/GWNET_CHITaxi20190406_epoch1.tar
2024-09-25 21:42:48 INFO     epoch complete!
2024-09-25 21:42:48 INFO     evaluating now!
2024-09-25 21:42:50 INFO     Epoch [2/200] train_loss: 8.6898, val_loss: 9.3291, lr: 0.001000, 22.27s
2024-09-25 21:43:09 INFO     epoch complete!
2024-09-25 21:43:09 INFO     evaluating now!
2024-09-25 21:43:12 INFO     Epoch [3/200] train_loss: 8.2048, val_loss: 8.5192, lr: 0.001000, 21.93s
2024-09-25 21:43:12 INFO     Saved model at 3
2024-09-25 21:43:12 INFO     Val loss decrease from 9.2135 to 8.5192, saving to ./libcity/cache/10004/model_cache/GWNET_CHITaxi20190406_epoch3.tar
2024-09-25 21:43:32 INFO     epoch complete!
2024-09-25 21:43:32 INFO     evaluating now!
2024-09-25 21:43:34 INFO     Epoch [4/200] train_loss: 7.8693, val_loss: 8.6879, lr: 0.001000, 21.93s
2024-09-25 21:43:54 INFO     epoch complete!
2024-09-25 21:43:54 INFO     evaluating now!
2024-09-25 21:43:56 INFO     Epoch [5/200] train_loss: 7.6606, val_loss: 8.1122, lr: 0.001000, 22.03s
2024-09-25 21:43:56 INFO     Saved model at 5
2024-09-25 21:43:56 INFO     Val loss decrease from 8.5192 to 8.1122, saving to ./libcity/cache/10004/model_cache/GWNET_CHITaxi20190406_epoch5.tar
2024-09-25 21:44:16 INFO     epoch complete!
2024-09-25 21:44:16 INFO     evaluating now!
2024-09-25 21:44:18 INFO     Epoch [6/200] train_loss: 7.4313, val_loss: 8.1251, lr: 0.001000, 21.99s
2024-09-25 21:44:38 INFO     epoch complete!
2024-09-25 21:44:38 INFO     evaluating now!
2024-09-25 21:44:40 INFO     Epoch [7/200] train_loss: 7.0796, val_loss: 7.0999, lr: 0.001000, 21.91s
2024-09-25 21:44:40 INFO     Saved model at 7
2024-09-25 21:44:40 INFO     Val loss decrease from 8.1122 to 7.0999, saving to ./libcity/cache/10004/model_cache/GWNET_CHITaxi20190406_epoch7.tar
2024-09-25 21:45:00 INFO     epoch complete!
2024-09-25 21:45:00 INFO     evaluating now!
2024-09-25 21:45:02 INFO     Epoch [8/200] train_loss: 6.1618, val_loss: 12.2820, lr: 0.001000, 22.12s
2024-09-25 21:45:23 INFO     epoch complete!
2024-09-25 21:45:23 INFO     evaluating now!
2024-09-25 21:45:25 INFO     Epoch [9/200] train_loss: 5.8989, val_loss: 5.6359, lr: 0.001000, 22.33s
2024-09-25 21:45:25 INFO     Saved model at 9
2024-09-25 21:45:25 INFO     Val loss decrease from 7.0999 to 5.6359, saving to ./libcity/cache/10004/model_cache/GWNET_CHITaxi20190406_epoch9.tar
2024-09-25 21:45:45 INFO     epoch complete!
2024-09-25 21:45:45 INFO     evaluating now!
2024-09-25 21:45:47 INFO     Epoch [10/200] train_loss: 5.5864, val_loss: 8.0500, lr: 0.001000, 22.38s
2024-09-25 21:46:08 INFO     epoch complete!
2024-09-25 21:46:08 INFO     evaluating now!
2024-09-25 21:46:10 INFO     Epoch [11/200] train_loss: 5.3151, val_loss: 6.3533, lr: 0.001000, 22.23s
2024-09-25 21:46:30 INFO     epoch complete!
2024-09-25 21:46:30 INFO     evaluating now!
2024-09-25 21:46:32 INFO     Epoch [12/200] train_loss: 5.3030, val_loss: 6.1866, lr: 0.001000, 22.31s
2024-09-25 21:46:52 INFO     epoch complete!
2024-09-25 21:46:52 INFO     evaluating now!
2024-09-25 21:46:54 INFO     Epoch [13/200] train_loss: 5.2045, val_loss: 5.8540, lr: 0.001000, 22.35s
2024-09-25 21:47:14 INFO     epoch complete!
2024-09-25 21:47:14 INFO     evaluating now!
2024-09-25 21:47:16 INFO     Epoch [14/200] train_loss: 5.1510, val_loss: 6.8692, lr: 0.001000, 21.92s
2024-09-25 21:47:36 INFO     epoch complete!
2024-09-25 21:47:36 INFO     evaluating now!
2024-09-25 21:47:38 INFO     Epoch [15/200] train_loss: 5.0204, val_loss: 5.8562, lr: 0.001000, 22.02s
2024-09-25 21:47:58 INFO     epoch complete!
2024-09-25 21:47:58 INFO     evaluating now!
2024-09-25 21:48:00 INFO     Epoch [16/200] train_loss: 4.8941, val_loss: 5.1540, lr: 0.001000, 21.83s
2024-09-25 21:48:00 INFO     Saved model at 16
2024-09-25 21:48:00 INFO     Val loss decrease from 5.6359 to 5.1540, saving to ./libcity/cache/10004/model_cache/GWNET_CHITaxi20190406_epoch16.tar
2024-09-25 21:48:20 INFO     epoch complete!
2024-09-25 21:48:20 INFO     evaluating now!
2024-09-25 21:48:22 INFO     Epoch [17/200] train_loss: 4.9191, val_loss: 5.0008, lr: 0.001000, 22.04s
2024-09-25 21:48:23 INFO     Saved model at 17
2024-09-25 21:48:23 INFO     Val loss decrease from 5.1540 to 5.0008, saving to ./libcity/cache/10004/model_cache/GWNET_CHITaxi20190406_epoch17.tar
2024-09-25 21:48:43 INFO     epoch complete!
2024-09-25 21:48:43 INFO     evaluating now!
2024-09-25 21:48:45 INFO     Epoch [18/200] train_loss: 4.8552, val_loss: 5.2660, lr: 0.001000, 22.43s
2024-09-25 21:49:06 INFO     epoch complete!
2024-09-25 21:49:06 INFO     evaluating now!
2024-09-25 21:49:08 INFO     Epoch [19/200] train_loss: 4.8322, val_loss: 5.2155, lr: 0.001000, 23.01s
2024-09-25 21:49:28 INFO     epoch complete!
2024-09-25 21:49:28 INFO     evaluating now!
2024-09-25 21:49:30 INFO     Epoch [20/200] train_loss: 4.7274, val_loss: 5.2582, lr: 0.001000, 22.26s
2024-09-25 21:49:50 INFO     epoch complete!
2024-09-25 21:49:50 INFO     evaluating now!
2024-09-25 21:49:52 INFO     Epoch [21/200] train_loss: 4.7144, val_loss: 5.4099, lr: 0.001000, 21.95s
2024-09-25 21:50:14 INFO     epoch complete!
2024-09-25 21:50:14 INFO     evaluating now!
2024-09-25 21:50:17 INFO     Epoch [22/200] train_loss: 4.6839, val_loss: 6.2289, lr: 0.001000, 24.95s
2024-09-25 21:50:41 INFO     epoch complete!
2024-09-25 21:50:41 INFO     evaluating now!
2024-09-25 21:50:43 INFO     Epoch [23/200] train_loss: 4.6063, val_loss: 6.6607, lr: 0.001000, 25.80s
2024-09-25 21:51:03 INFO     epoch complete!
2024-09-25 21:51:03 INFO     evaluating now!
2024-09-25 21:51:05 INFO     Epoch [24/200] train_loss: 4.6255, val_loss: 5.9316, lr: 0.001000, 22.30s
2024-09-25 21:51:25 INFO     epoch complete!
2024-09-25 21:51:25 INFO     evaluating now!
2024-09-25 21:51:27 INFO     Epoch [25/200] train_loss: 4.5237, val_loss: 5.1743, lr: 0.001000, 21.94s
2024-09-25 21:51:47 INFO     epoch complete!
2024-09-25 21:51:47 INFO     evaluating now!
2024-09-25 21:51:49 INFO     Epoch [26/200] train_loss: 4.5415, val_loss: 6.3701, lr: 0.001000, 22.28s
2024-09-25 21:52:10 INFO     epoch complete!
2024-09-25 21:52:10 INFO     evaluating now!
2024-09-25 21:52:12 INFO     Epoch [27/200] train_loss: 4.5460, val_loss: 5.0560, lr: 0.001000, 22.08s
2024-09-25 21:52:31 INFO     epoch complete!
2024-09-25 21:52:31 INFO     evaluating now!
2024-09-25 21:52:33 INFO     Epoch [28/200] train_loss: 4.4903, val_loss: 4.9293, lr: 0.001000, 21.90s
2024-09-25 21:52:34 INFO     Saved model at 28
2024-09-25 21:52:34 INFO     Val loss decrease from 5.0008 to 4.9293, saving to ./libcity/cache/10004/model_cache/GWNET_CHITaxi20190406_epoch28.tar
2024-09-25 21:52:54 INFO     epoch complete!
2024-09-25 21:52:54 INFO     evaluating now!
2024-09-25 21:52:56 INFO     Epoch [29/200] train_loss: 4.4264, val_loss: 6.1414, lr: 0.001000, 22.19s
2024-09-25 21:53:16 INFO     epoch complete!
2024-09-25 21:53:16 INFO     evaluating now!
2024-09-25 21:53:18 INFO     Epoch [30/200] train_loss: 4.4164, val_loss: 5.3023, lr: 0.001000, 21.94s
2024-09-25 21:53:38 INFO     epoch complete!
2024-09-25 21:53:38 INFO     evaluating now!
2024-09-25 21:53:40 INFO     Epoch [31/200] train_loss: 4.4099, val_loss: 5.5802, lr: 0.001000, 22.22s
2024-09-25 21:54:00 INFO     epoch complete!
2024-09-25 21:54:00 INFO     evaluating now!
2024-09-25 21:54:02 INFO     Epoch [32/200] train_loss: 4.3822, val_loss: 5.0377, lr: 0.001000, 22.12s
2024-09-25 21:54:22 INFO     epoch complete!
2024-09-25 21:54:22 INFO     evaluating now!
2024-09-25 21:54:24 INFO     Epoch [33/200] train_loss: 4.4230, val_loss: 5.2704, lr: 0.001000, 21.98s
2024-09-25 21:54:45 INFO     epoch complete!
2024-09-25 21:54:45 INFO     evaluating now!
2024-09-25 21:54:47 INFO     Epoch [34/200] train_loss: 4.3120, val_loss: 5.1082, lr: 0.001000, 22.61s
2024-09-25 21:55:07 INFO     epoch complete!
2024-09-25 21:55:07 INFO     evaluating now!
2024-09-25 21:55:09 INFO     Epoch [35/200] train_loss: 4.3044, val_loss: 5.9825, lr: 0.001000, 22.48s
2024-09-25 21:55:30 INFO     epoch complete!
2024-09-25 21:55:30 INFO     evaluating now!
2024-09-25 21:55:32 INFO     Epoch [36/200] train_loss: 4.2417, val_loss: 4.8375, lr: 0.001000, 22.49s
2024-09-25 21:55:32 INFO     Saved model at 36
2024-09-25 21:55:32 INFO     Val loss decrease from 4.9293 to 4.8375, saving to ./libcity/cache/10004/model_cache/GWNET_CHITaxi20190406_epoch36.tar
2024-09-25 21:55:52 INFO     epoch complete!
2024-09-25 21:55:52 INFO     evaluating now!
2024-09-25 21:55:54 INFO     Epoch [37/200] train_loss: 4.2606, val_loss: 4.9375, lr: 0.001000, 22.60s
2024-09-25 21:56:15 INFO     epoch complete!
2024-09-25 21:56:15 INFO     evaluating now!
2024-09-25 21:56:17 INFO     Epoch [38/200] train_loss: 4.2860, val_loss: 6.2402, lr: 0.001000, 22.64s
2024-09-25 21:56:38 INFO     epoch complete!
2024-09-25 21:56:38 INFO     evaluating now!
2024-09-25 21:56:40 INFO     Epoch [39/200] train_loss: 4.1682, val_loss: 4.9886, lr: 0.001000, 23.04s
2024-09-25 21:57:01 INFO     epoch complete!
2024-09-25 21:57:01 INFO     evaluating now!
2024-09-25 21:57:03 INFO     Epoch [40/200] train_loss: 4.2232, val_loss: 5.5630, lr: 0.001000, 23.03s
2024-09-25 21:57:23 INFO     epoch complete!
2024-09-25 21:57:23 INFO     evaluating now!
2024-09-25 21:57:25 INFO     Epoch [41/200] train_loss: 4.1911, val_loss: 5.5416, lr: 0.001000, 22.26s
2024-09-25 21:57:45 INFO     epoch complete!
2024-09-25 21:57:45 INFO     evaluating now!
2024-09-25 21:57:48 INFO     Epoch [42/200] train_loss: 4.1821, val_loss: 5.0271, lr: 0.001000, 22.15s
2024-09-25 21:58:08 INFO     epoch complete!
2024-09-25 21:58:08 INFO     evaluating now!
2024-09-25 21:58:10 INFO     Epoch [43/200] train_loss: 4.1305, val_loss: 6.1761, lr: 0.001000, 22.41s
2024-09-25 21:58:30 INFO     epoch complete!
2024-09-25 21:58:30 INFO     evaluating now!
2024-09-25 21:58:32 INFO     Epoch [44/200] train_loss: 4.1788, val_loss: 5.6355, lr: 0.001000, 22.37s
2024-09-25 21:58:52 INFO     epoch complete!
2024-09-25 21:58:52 INFO     evaluating now!
2024-09-25 21:58:55 INFO     Epoch [45/200] train_loss: 4.0669, val_loss: 6.5862, lr: 0.001000, 22.20s
2024-09-25 21:59:15 INFO     epoch complete!
2024-09-25 21:59:15 INFO     evaluating now!
2024-09-25 21:59:17 INFO     Epoch [46/200] train_loss: 4.1113, val_loss: 4.9875, lr: 0.001000, 22.50s
2024-09-25 21:59:37 INFO     epoch complete!
2024-09-25 21:59:37 INFO     evaluating now!
2024-09-25 21:59:39 INFO     Epoch [47/200] train_loss: 4.0269, val_loss: 5.2789, lr: 0.001000, 22.26s
2024-09-25 21:59:59 INFO     epoch complete!
2024-09-25 21:59:59 INFO     evaluating now!
2024-09-25 22:00:01 INFO     Epoch [48/200] train_loss: 4.0978, val_loss: 4.9482, lr: 0.001000, 21.98s
2024-09-25 22:00:21 INFO     epoch complete!
2024-09-25 22:00:21 INFO     evaluating now!
2024-09-25 22:00:23 INFO     Epoch [49/200] train_loss: 4.0419, val_loss: 4.9991, lr: 0.001000, 22.07s
2024-09-25 22:00:44 INFO     epoch complete!
2024-09-25 22:00:44 INFO     evaluating now!
2024-09-25 22:00:46 INFO     Epoch [50/200] train_loss: 3.9853, val_loss: 4.9853, lr: 0.001000, 23.11s
2024-09-25 22:01:07 INFO     epoch complete!
2024-09-25 22:01:07 INFO     evaluating now!
2024-09-25 22:01:09 INFO     Epoch [51/200] train_loss: 4.0243, val_loss: 5.6560, lr: 0.001000, 22.38s
2024-09-25 22:01:09 WARNING  Early stopping at epoch: 51
2024-09-25 22:01:09 INFO     Trained totally 52 epochs, average train time is 20.247s, average eval time is 2.125s
2024-09-25 22:01:09 INFO     Loaded model at 36
2024-09-25 22:01:09 INFO     Saved model at ./libcity/cache/10004/model_cache/GWNET_CHITaxi20190406.m
2024-09-25 22:01:09 INFO     Start evaluating ...
2024-09-25 22:01:15 INFO     Note that you select the single mode to evaluate!
2024-09-25 22:01:15 INFO     Evaluate result is saved at ./libcity/cache/10004/evaluate_cache/2024_09_25_22_01_15_GWNET_CHITaxi20190406.csv
2024-09-25 22:01:15 INFO     
         MAE       RMSE
1   2.320766   6.516870
2   2.287678   7.508341
3   2.543479   8.541428
4   2.704497   9.207774
5   2.879122   9.806307
6   2.957221  10.414422
7   3.148598  11.208022
8   3.201596  11.710840
9   3.196559  11.880233
10  3.263259  12.127913
11  3.288785  12.175187
12  3.295580  12.404389
2024-09-25 22:01:15 INFO     ----------------------------------------------------------------------------
2024-09-25 22:01:15 INFO     Kownledge Graph Embedding: GIE, Experiment ids: [10000, 10001, 10002, 10003, 10004]
2024-09-25 22:01:15 INFO     ----------------------------------------------------------------------------
2024-09-25 22:01:15 INFO     Average: 
         MAE       RMSE
0   2.270037   6.639758
1   2.371661   7.534196
2   2.564944   8.570495
3   2.699008   9.263122
4   2.854809   9.961819
5   2.971197  10.707820
6   3.095023  11.530908
7   3.233396  12.192310
8   3.221253  12.464447
9   3.279870  12.584049
10  3.316955  12.645879
11  3.365200  12.884754 
2024-09-25 22:01:15 INFO     Standard deviation: 
         MAE      RMSE
0   0.064786  0.165171
1   0.065008  0.128213
2   0.043825  0.189670
3   0.061311  0.313354
4   0.085965  0.483762
5   0.095293  0.892966
6   0.106465  1.297609
7   0.184875  1.576960
8   0.096359  1.477938
9   0.086702  1.210000
10  0.062054  0.927761
11  0.070842  0.847373
2024-09-25 22:01:15 INFO     ----------------------------------------------------------------------------
2024-09-25 22:01:15 INFO     12 steps Average: 
        MAE      RMSE
0  2.936946  10.58163
2024-09-25 22:01:15 INFO     12 steps Standard deviation: 
       MAE      RMSE
0  0.08529  0.792565
