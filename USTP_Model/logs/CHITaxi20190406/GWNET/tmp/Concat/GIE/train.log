2024-09-27 16:17:09 INFO     Saving logs in: ./logs/CHITaxi20190406/GWNET/Concat/GIE
2024-09-27 16:17:09 INFO     ----------------------------------------------------------------------------
2024-09-27 16:17:09 INFO     # 0, Kownledge Graph Embedding: GIE, Experiment ids: 10015
2024-09-27 16:17:09 INFO     ----------------------------------------------------------------------------
2024-09-27 16:17:09 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=10015
2024-09-27 16:17:09 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10015, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-27 16:17:09 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-27 16:17:09 INFO     set_weight_link_or_dist: dist
2024-09-27 16:17:09 INFO     init_weight_inf_or_zero: inf
2024-09-27 16:17:09 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-27 16:17:09 INFO     Start Calculate the weight by Gauss kernel!
2024-09-27 16:17:09 INFO     Loading file CHITaxi20190406.dyna
2024-09-27 16:17:10 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-27 16:17:12 INFO     Dataset created
2024-09-27 16:17:12 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-27 16:17:12 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-27 16:17:12 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-27 16:17:12 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-27 16:17:13 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-27 16:17:13 INFO     NoneScaler
2024-09-27 16:17:17 INFO     add adj_mx to supports
2024-09-27 16:17:17 INFO     add apt_adj(v1 * v2) in forward process
2024-09-27 16:17:17 INFO     receptive_field: 14
2024-09-27 16:17:18 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(34, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-27 16:17:18 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-27 16:17:18 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-27 16:17:18 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:17:18 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:17:18 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:17:18 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:17:18 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:17:18 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:17:18 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:17:18 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:17:18 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:17:18 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:17:18 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:17:18 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:17:18 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:17:18 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:17:18 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:17:18 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:17:18 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:17:18 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:17:18 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:17:18 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:17:18 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:17:18 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:17:18 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:17:18 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:17:18 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     start_conv.weight	torch.Size([32, 34, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:17:18 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-27 16:17:18 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-27 16:17:18 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-27 16:17:18 INFO     Total parameter numbers: 307824
2024-09-27 16:17:18 INFO     You select `adam` optimizer.
2024-09-27 16:17:18 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-27 16:17:18 INFO     Start training ...
2024-09-27 16:17:18 INFO     num_batches:96
2024-09-27 16:17:39 INFO     epoch complete!
2024-09-27 16:17:39 INFO     evaluating now!
2024-09-27 16:17:41 INFO     Epoch [0/200] train_loss: 13.2033, val_loss: 9.9597, lr: 0.001000, 23.05s
2024-09-27 16:17:41 INFO     Saved model at 0
2024-09-27 16:17:41 INFO     Val loss decrease from inf to 9.9597, saving to ./libcity/cache/10015/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-27 16:18:02 INFO     epoch complete!
2024-09-27 16:18:02 INFO     evaluating now!
2024-09-27 16:18:04 INFO     Epoch [1/200] train_loss: 8.7649, val_loss: 9.9828, lr: 0.001000, 22.67s
2024-09-27 16:18:25 INFO     epoch complete!
2024-09-27 16:18:25 INFO     evaluating now!
2024-09-27 16:18:27 INFO     Epoch [2/200] train_loss: 8.3553, val_loss: 9.5749, lr: 0.001000, 22.63s
2024-09-27 16:18:27 INFO     Saved model at 2
2024-09-27 16:18:27 INFO     Val loss decrease from 9.9597 to 9.5749, saving to ./libcity/cache/10015/model_cache/GWNET_CHITaxi20190406_epoch2.tar
2024-09-27 16:18:48 INFO     epoch complete!
2024-09-27 16:18:48 INFO     evaluating now!
2024-09-27 16:18:50 INFO     Epoch [3/200] train_loss: 8.1159, val_loss: 7.7957, lr: 0.001000, 22.85s
2024-09-27 16:18:50 INFO     Saved model at 3
2024-09-27 16:18:50 INFO     Val loss decrease from 9.5749 to 7.7957, saving to ./libcity/cache/10015/model_cache/GWNET_CHITaxi20190406_epoch3.tar
2024-09-27 16:19:11 INFO     epoch complete!
2024-09-27 16:19:11 INFO     evaluating now!
2024-09-27 16:19:13 INFO     Epoch [4/200] train_loss: 7.8874, val_loss: 8.4285, lr: 0.001000, 22.69s
2024-09-27 16:19:33 INFO     epoch complete!
2024-09-27 16:19:33 INFO     evaluating now!
2024-09-27 16:19:36 INFO     Epoch [5/200] train_loss: 7.7163, val_loss: 7.8510, lr: 0.001000, 22.84s
2024-09-27 16:19:56 INFO     epoch complete!
2024-09-27 16:19:56 INFO     evaluating now!
2024-09-27 16:19:58 INFO     Epoch [6/200] train_loss: 7.6362, val_loss: 7.3873, lr: 0.001000, 22.59s
2024-09-27 16:19:58 INFO     Saved model at 6
2024-09-27 16:19:58 INFO     Val loss decrease from 7.7957 to 7.3873, saving to ./libcity/cache/10015/model_cache/GWNET_CHITaxi20190406_epoch6.tar
2024-09-27 16:20:19 INFO     epoch complete!
2024-09-27 16:20:19 INFO     evaluating now!
2024-09-27 16:20:21 INFO     Epoch [7/200] train_loss: 7.5773, val_loss: 9.3727, lr: 0.001000, 22.57s
2024-09-27 16:20:41 INFO     epoch complete!
2024-09-27 16:20:41 INFO     evaluating now!
2024-09-27 16:20:44 INFO     Epoch [8/200] train_loss: 7.3549, val_loss: 7.0622, lr: 0.001000, 22.75s
2024-09-27 16:20:44 INFO     Saved model at 8
2024-09-27 16:20:44 INFO     Val loss decrease from 7.3873 to 7.0622, saving to ./libcity/cache/10015/model_cache/GWNET_CHITaxi20190406_epoch8.tar
2024-09-27 16:21:04 INFO     epoch complete!
2024-09-27 16:21:04 INFO     evaluating now!
2024-09-27 16:21:06 INFO     Epoch [9/200] train_loss: 6.5772, val_loss: 7.7769, lr: 0.001000, 22.65s
2024-09-27 16:21:27 INFO     epoch complete!
2024-09-27 16:21:27 INFO     evaluating now!
2024-09-27 16:21:29 INFO     Epoch [10/200] train_loss: 5.8452, val_loss: 5.4851, lr: 0.001000, 22.69s
2024-09-27 16:21:29 INFO     Saved model at 10
2024-09-27 16:21:29 INFO     Val loss decrease from 7.0622 to 5.4851, saving to ./libcity/cache/10015/model_cache/GWNET_CHITaxi20190406_epoch10.tar
2024-09-27 16:21:50 INFO     epoch complete!
2024-09-27 16:21:50 INFO     evaluating now!
2024-09-27 16:21:52 INFO     Epoch [11/200] train_loss: 5.5891, val_loss: 7.4531, lr: 0.001000, 22.41s
2024-09-27 16:22:12 INFO     epoch complete!
2024-09-27 16:22:12 INFO     evaluating now!
2024-09-27 16:22:14 INFO     Epoch [12/200] train_loss: 5.4861, val_loss: 7.8559, lr: 0.001000, 22.29s
2024-09-27 16:22:34 INFO     epoch complete!
2024-09-27 16:22:34 INFO     evaluating now!
2024-09-27 16:22:36 INFO     Epoch [13/200] train_loss: 5.3380, val_loss: 6.3435, lr: 0.001000, 22.43s
2024-09-27 16:22:57 INFO     epoch complete!
2024-09-27 16:22:57 INFO     evaluating now!
2024-09-27 16:22:59 INFO     Epoch [14/200] train_loss: 5.2358, val_loss: 9.9891, lr: 0.001000, 22.46s
2024-09-27 16:23:19 INFO     epoch complete!
2024-09-27 16:23:19 INFO     evaluating now!
2024-09-27 16:23:21 INFO     Epoch [15/200] train_loss: 5.2764, val_loss: 9.5369, lr: 0.001000, 22.62s
2024-09-27 16:23:42 INFO     epoch complete!
2024-09-27 16:23:42 INFO     evaluating now!
2024-09-27 16:23:44 INFO     Epoch [16/200] train_loss: 5.3263, val_loss: 6.5981, lr: 0.001000, 22.58s
2024-09-27 16:24:05 INFO     epoch complete!
2024-09-27 16:24:05 INFO     evaluating now!
2024-09-27 16:24:07 INFO     Epoch [17/200] train_loss: 5.0912, val_loss: 5.5351, lr: 0.001000, 22.80s
2024-09-27 16:24:27 INFO     epoch complete!
2024-09-27 16:24:27 INFO     evaluating now!
2024-09-27 16:24:30 INFO     Epoch [18/200] train_loss: 5.0821, val_loss: 6.7946, lr: 0.001000, 22.87s
2024-09-27 16:24:50 INFO     epoch complete!
2024-09-27 16:24:50 INFO     evaluating now!
2024-09-27 16:24:53 INFO     Epoch [19/200] train_loss: 4.9789, val_loss: 5.3119, lr: 0.001000, 22.82s
2024-09-27 16:24:53 INFO     Saved model at 19
2024-09-27 16:24:53 INFO     Val loss decrease from 5.4851 to 5.3119, saving to ./libcity/cache/10015/model_cache/GWNET_CHITaxi20190406_epoch19.tar
2024-09-27 16:25:13 INFO     epoch complete!
2024-09-27 16:25:13 INFO     evaluating now!
2024-09-27 16:25:16 INFO     Epoch [20/200] train_loss: 4.9794, val_loss: 5.6487, lr: 0.001000, 22.78s
2024-09-27 16:25:36 INFO     epoch complete!
2024-09-27 16:25:36 INFO     evaluating now!
2024-09-27 16:25:38 INFO     Epoch [21/200] train_loss: 4.8361, val_loss: 6.4822, lr: 0.001000, 22.79s
2024-09-27 16:25:59 INFO     epoch complete!
2024-09-27 16:25:59 INFO     evaluating now!
2024-09-27 16:26:01 INFO     Epoch [22/200] train_loss: 4.7680, val_loss: 6.2168, lr: 0.001000, 22.66s
2024-09-27 16:26:21 INFO     epoch complete!
2024-09-27 16:26:21 INFO     evaluating now!
2024-09-27 16:26:24 INFO     Epoch [23/200] train_loss: 4.8138, val_loss: 5.3831, lr: 0.001000, 22.60s
2024-09-27 16:26:44 INFO     epoch complete!
2024-09-27 16:26:44 INFO     evaluating now!
2024-09-27 16:26:46 INFO     Epoch [24/200] train_loss: 4.7650, val_loss: 5.2820, lr: 0.001000, 22.27s
2024-09-27 16:26:46 INFO     Saved model at 24
2024-09-27 16:26:46 INFO     Val loss decrease from 5.3119 to 5.2820, saving to ./libcity/cache/10015/model_cache/GWNET_CHITaxi20190406_epoch24.tar
2024-09-27 16:27:06 INFO     epoch complete!
2024-09-27 16:27:06 INFO     evaluating now!
2024-09-27 16:27:09 INFO     Epoch [25/200] train_loss: 4.7565, val_loss: 5.1983, lr: 0.001000, 22.46s
2024-09-27 16:27:09 INFO     Saved model at 25
2024-09-27 16:27:09 INFO     Val loss decrease from 5.2820 to 5.1983, saving to ./libcity/cache/10015/model_cache/GWNET_CHITaxi20190406_epoch25.tar
2024-09-27 16:27:29 INFO     epoch complete!
2024-09-27 16:27:29 INFO     evaluating now!
2024-09-27 16:27:31 INFO     Epoch [26/200] train_loss: 4.6813, val_loss: 6.8813, lr: 0.001000, 22.16s
2024-09-27 16:27:50 INFO     epoch complete!
2024-09-27 16:27:50 INFO     evaluating now!
2024-09-27 16:27:52 INFO     Epoch [27/200] train_loss: 4.6186, val_loss: 5.3872, lr: 0.001000, 21.43s
2024-09-27 16:28:12 INFO     epoch complete!
2024-09-27 16:28:12 INFO     evaluating now!
2024-09-27 16:28:14 INFO     Epoch [28/200] train_loss: 4.6709, val_loss: 6.1653, lr: 0.001000, 21.54s
2024-09-27 16:28:34 INFO     epoch complete!
2024-09-27 16:28:34 INFO     evaluating now!
2024-09-27 16:28:36 INFO     Epoch [29/200] train_loss: 4.5981, val_loss: 6.1728, lr: 0.001000, 22.00s
2024-09-27 16:28:56 INFO     epoch complete!
2024-09-27 16:28:56 INFO     evaluating now!
2024-09-27 16:28:58 INFO     Epoch [30/200] train_loss: 4.5277, val_loss: 4.9374, lr: 0.001000, 21.99s
2024-09-27 16:28:58 INFO     Saved model at 30
2024-09-27 16:28:58 INFO     Val loss decrease from 5.1983 to 4.9374, saving to ./libcity/cache/10015/model_cache/GWNET_CHITaxi20190406_epoch30.tar
2024-09-27 16:29:18 INFO     epoch complete!
2024-09-27 16:29:18 INFO     evaluating now!
2024-09-27 16:29:20 INFO     Epoch [31/200] train_loss: 4.6123, val_loss: 6.7364, lr: 0.001000, 21.77s
2024-09-27 16:29:39 INFO     epoch complete!
2024-09-27 16:29:39 INFO     evaluating now!
2024-09-27 16:29:41 INFO     Epoch [32/200] train_loss: 4.4260, val_loss: 6.5486, lr: 0.001000, 21.61s
2024-09-27 16:30:01 INFO     epoch complete!
2024-09-27 16:30:01 INFO     evaluating now!
2024-09-27 16:30:03 INFO     Epoch [33/200] train_loss: 4.4534, val_loss: 7.4505, lr: 0.001000, 21.60s
2024-09-27 16:30:23 INFO     epoch complete!
2024-09-27 16:30:23 INFO     evaluating now!
2024-09-27 16:30:25 INFO     Epoch [34/200] train_loss: 4.4404, val_loss: 6.8980, lr: 0.001000, 21.66s
2024-09-27 16:30:44 INFO     epoch complete!
2024-09-27 16:30:44 INFO     evaluating now!
2024-09-27 16:30:46 INFO     Epoch [35/200] train_loss: 4.4549, val_loss: 6.2195, lr: 0.001000, 21.54s
2024-09-27 16:31:06 INFO     epoch complete!
2024-09-27 16:31:06 INFO     evaluating now!
2024-09-27 16:31:08 INFO     Epoch [36/200] train_loss: 4.3800, val_loss: 5.1440, lr: 0.001000, 21.65s
2024-09-27 16:31:28 INFO     epoch complete!
2024-09-27 16:31:28 INFO     evaluating now!
2024-09-27 16:31:30 INFO     Epoch [37/200] train_loss: 4.3712, val_loss: 6.0187, lr: 0.001000, 21.75s
2024-09-27 16:31:49 INFO     epoch complete!
2024-09-27 16:31:49 INFO     evaluating now!
2024-09-27 16:31:52 INFO     Epoch [38/200] train_loss: 4.4247, val_loss: 5.4959, lr: 0.001000, 21.88s
2024-09-27 16:32:11 INFO     epoch complete!
2024-09-27 16:32:11 INFO     evaluating now!
2024-09-27 16:32:14 INFO     Epoch [39/200] train_loss: 4.3562, val_loss: 8.0316, lr: 0.001000, 22.02s
2024-09-27 16:32:33 INFO     epoch complete!
2024-09-27 16:32:33 INFO     evaluating now!
2024-09-27 16:32:36 INFO     Epoch [40/200] train_loss: 4.3170, val_loss: 5.3592, lr: 0.001000, 22.00s
2024-09-27 16:32:55 INFO     epoch complete!
2024-09-27 16:32:55 INFO     evaluating now!
2024-09-27 16:32:58 INFO     Epoch [41/200] train_loss: 4.2955, val_loss: 5.0554, lr: 0.001000, 22.01s
2024-09-27 16:33:17 INFO     epoch complete!
2024-09-27 16:33:17 INFO     evaluating now!
2024-09-27 16:33:19 INFO     Epoch [42/200] train_loss: 4.2968, val_loss: 5.2231, lr: 0.001000, 21.90s
2024-09-27 16:33:39 INFO     epoch complete!
2024-09-27 16:33:39 INFO     evaluating now!
2024-09-27 16:33:41 INFO     Epoch [43/200] train_loss: 4.2449, val_loss: 7.3368, lr: 0.001000, 21.61s
2024-09-27 16:34:00 INFO     epoch complete!
2024-09-27 16:34:00 INFO     evaluating now!
2024-09-27 16:34:03 INFO     Epoch [44/200] train_loss: 4.2390, val_loss: 5.4721, lr: 0.001000, 21.51s
2024-09-27 16:34:22 INFO     epoch complete!
2024-09-27 16:34:22 INFO     evaluating now!
2024-09-27 16:34:25 INFO     Epoch [45/200] train_loss: 4.2320, val_loss: 7.9633, lr: 0.001000, 21.94s
2024-09-27 16:34:25 WARNING  Early stopping at epoch: 45
2024-09-27 16:34:25 INFO     Trained totally 46 epochs, average train time is 20.115s, average eval time is 2.154s
2024-09-27 16:34:25 INFO     Loaded model at 30
2024-09-27 16:34:25 INFO     Saved model at ./libcity/cache/10015/model_cache/GWNET_CHITaxi20190406.m
2024-09-27 16:34:25 INFO     Start evaluating ...
2024-09-27 16:34:30 INFO     Note that you select the single mode to evaluate!
2024-09-27 16:34:30 INFO     Evaluate result is saved at ./libcity/cache/10015/evaluate_cache/2024_09_27_16_34_30_GWNET_CHITaxi20190406.csv
2024-09-27 16:34:30 INFO     
         MAE       RMSE  masked_MAPE
1   2.376383   6.922243     0.398376
2   2.593793   7.842726     0.419158
3   2.684084   9.011681     0.379327
4   2.913144  10.099662     0.397332
5   3.051647  11.323318     0.387108
6   3.200273  12.654145     0.389461
7   3.351583  13.883511     0.405064
8   3.385578  14.579082     0.392528
9   3.463345  14.854121     0.397310
10  3.605019  14.827068     0.435592
11  3.666406  14.750135     0.438460
12  3.697722  14.975885     0.429315
2024-09-27 16:34:30 INFO     ----------------------------------------------------------------------------
2024-09-27 16:34:30 INFO     # 1, Kownledge Graph Embedding: GIE, Experiment ids: 10016
2024-09-27 16:34:30 INFO     ----------------------------------------------------------------------------
2024-09-27 16:34:30 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=10016
2024-09-27 16:34:30 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10016, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-27 16:34:30 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-27 16:34:30 INFO     set_weight_link_or_dist: dist
2024-09-27 16:34:30 INFO     init_weight_inf_or_zero: inf
2024-09-27 16:34:30 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-27 16:34:30 INFO     Start Calculate the weight by Gauss kernel!
2024-09-27 16:34:30 INFO     Loading file CHITaxi20190406.dyna
2024-09-27 16:34:30 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-27 16:34:33 INFO     Dataset created
2024-09-27 16:34:33 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-27 16:34:33 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-27 16:34:33 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-27 16:34:33 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-27 16:34:33 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-27 16:34:33 INFO     NoneScaler
2024-09-27 16:34:35 INFO     add adj_mx to supports
2024-09-27 16:34:35 INFO     add apt_adj(v1 * v2) in forward process
2024-09-27 16:34:35 INFO     receptive_field: 14
2024-09-27 16:34:35 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(34, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-27 16:34:35 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-27 16:34:35 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-27 16:34:35 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:34:35 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:34:35 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:34:35 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:34:35 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:34:35 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:34:35 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:34:35 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:34:35 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:34:35 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:34:35 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:34:35 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:34:35 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:34:35 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:34:35 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:34:35 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:34:35 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:34:35 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:34:35 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:34:35 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:34:35 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:34:35 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:34:35 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:34:35 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:34:35 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     start_conv.weight	torch.Size([32, 34, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:34:35 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-27 16:34:35 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-27 16:34:35 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-27 16:34:35 INFO     Total parameter numbers: 307824
2024-09-27 16:34:35 INFO     You select `adam` optimizer.
2024-09-27 16:34:35 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-27 16:34:35 INFO     Start training ...
2024-09-27 16:34:35 INFO     num_batches:96
2024-09-27 16:34:54 INFO     epoch complete!
2024-09-27 16:34:54 INFO     evaluating now!
2024-09-27 16:34:56 INFO     Epoch [0/200] train_loss: 12.2403, val_loss: 12.4256, lr: 0.001000, 21.00s
2024-09-27 16:34:56 INFO     Saved model at 0
2024-09-27 16:34:56 INFO     Val loss decrease from inf to 12.4256, saving to ./libcity/cache/10016/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-27 16:35:15 INFO     epoch complete!
2024-09-27 16:35:15 INFO     evaluating now!
2024-09-27 16:35:17 INFO     Epoch [1/200] train_loss: 8.5983, val_loss: 8.3348, lr: 0.001000, 20.92s
2024-09-27 16:35:17 INFO     Saved model at 1
2024-09-27 16:35:17 INFO     Val loss decrease from 12.4256 to 8.3348, saving to ./libcity/cache/10016/model_cache/GWNET_CHITaxi20190406_epoch1.tar
2024-09-27 16:35:36 INFO     epoch complete!
2024-09-27 16:35:36 INFO     evaluating now!
2024-09-27 16:35:38 INFO     Epoch [2/200] train_loss: 8.2489, val_loss: 7.9463, lr: 0.001000, 21.07s
2024-09-27 16:35:39 INFO     Saved model at 2
2024-09-27 16:35:39 INFO     Val loss decrease from 8.3348 to 7.9463, saving to ./libcity/cache/10016/model_cache/GWNET_CHITaxi20190406_epoch2.tar
2024-09-27 16:35:58 INFO     epoch complete!
2024-09-27 16:35:58 INFO     evaluating now!
2024-09-27 16:36:00 INFO     Epoch [3/200] train_loss: 8.0026, val_loss: 10.1910, lr: 0.001000, 21.51s
2024-09-27 16:36:19 INFO     epoch complete!
2024-09-27 16:36:19 INFO     evaluating now!
2024-09-27 16:36:21 INFO     Epoch [4/200] train_loss: 8.1367, val_loss: 9.6136, lr: 0.001000, 21.21s
2024-09-27 16:36:40 INFO     epoch complete!
2024-09-27 16:36:40 INFO     evaluating now!
2024-09-27 16:36:42 INFO     Epoch [5/200] train_loss: 7.7567, val_loss: 8.5017, lr: 0.001000, 21.10s
2024-09-27 16:37:01 INFO     epoch complete!
2024-09-27 16:37:01 INFO     evaluating now!
2024-09-27 16:37:03 INFO     Epoch [6/200] train_loss: 7.7664, val_loss: 10.6618, lr: 0.001000, 20.79s
2024-09-27 16:37:22 INFO     epoch complete!
2024-09-27 16:37:22 INFO     evaluating now!
2024-09-27 16:37:24 INFO     Epoch [7/200] train_loss: 7.5910, val_loss: 13.4945, lr: 0.001000, 20.50s
2024-09-27 16:37:42 INFO     epoch complete!
2024-09-27 16:37:42 INFO     evaluating now!
2024-09-27 16:37:44 INFO     Epoch [8/200] train_loss: 7.4340, val_loss: 9.5934, lr: 0.001000, 20.54s
2024-09-27 16:38:03 INFO     epoch complete!
2024-09-27 16:38:03 INFO     evaluating now!
2024-09-27 16:38:06 INFO     Epoch [9/200] train_loss: 7.3181, val_loss: 9.1370, lr: 0.001000, 21.36s
2024-09-27 16:38:25 INFO     epoch complete!
2024-09-27 16:38:25 INFO     evaluating now!
2024-09-27 16:38:27 INFO     Epoch [10/200] train_loss: 7.1379, val_loss: 7.2659, lr: 0.001000, 21.20s
2024-09-27 16:38:27 INFO     Saved model at 10
2024-09-27 16:38:27 INFO     Val loss decrease from 7.9463 to 7.2659, saving to ./libcity/cache/10016/model_cache/GWNET_CHITaxi20190406_epoch10.tar
2024-09-27 16:38:45 INFO     epoch complete!
2024-09-27 16:38:45 INFO     evaluating now!
2024-09-27 16:38:48 INFO     Epoch [11/200] train_loss: 6.4201, val_loss: 8.1727, lr: 0.001000, 20.70s
2024-09-27 16:39:06 INFO     epoch complete!
2024-09-27 16:39:06 INFO     evaluating now!
2024-09-27 16:39:09 INFO     Epoch [12/200] train_loss: 5.7279, val_loss: 6.9520, lr: 0.001000, 21.08s
2024-09-27 16:39:09 INFO     Saved model at 12
2024-09-27 16:39:09 INFO     Val loss decrease from 7.2659 to 6.9520, saving to ./libcity/cache/10016/model_cache/GWNET_CHITaxi20190406_epoch12.tar
2024-09-27 16:39:28 INFO     epoch complete!
2024-09-27 16:39:28 INFO     evaluating now!
2024-09-27 16:39:30 INFO     Epoch [13/200] train_loss: 5.6360, val_loss: 11.4505, lr: 0.001000, 20.96s
2024-09-27 16:39:48 INFO     epoch complete!
2024-09-27 16:39:48 INFO     evaluating now!
2024-09-27 16:39:51 INFO     Epoch [14/200] train_loss: 5.3644, val_loss: 9.8630, lr: 0.001000, 20.82s
2024-09-27 16:40:09 INFO     epoch complete!
2024-09-27 16:40:09 INFO     evaluating now!
2024-09-27 16:40:11 INFO     Epoch [15/200] train_loss: 5.2711, val_loss: 5.3818, lr: 0.001000, 20.88s
2024-09-27 16:40:12 INFO     Saved model at 15
2024-09-27 16:40:12 INFO     Val loss decrease from 6.9520 to 5.3818, saving to ./libcity/cache/10016/model_cache/GWNET_CHITaxi20190406_epoch15.tar
2024-09-27 16:40:31 INFO     epoch complete!
2024-09-27 16:40:31 INFO     evaluating now!
2024-09-27 16:40:33 INFO     Epoch [16/200] train_loss: 5.1982, val_loss: 5.2658, lr: 0.001000, 21.12s
2024-09-27 16:40:33 INFO     Saved model at 16
2024-09-27 16:40:33 INFO     Val loss decrease from 5.3818 to 5.2658, saving to ./libcity/cache/10016/model_cache/GWNET_CHITaxi20190406_epoch16.tar
2024-09-27 16:40:52 INFO     epoch complete!
2024-09-27 16:40:52 INFO     evaluating now!
2024-09-27 16:40:54 INFO     Epoch [17/200] train_loss: 5.1189, val_loss: 5.6384, lr: 0.001000, 20.90s
2024-09-27 16:41:13 INFO     epoch complete!
2024-09-27 16:41:13 INFO     evaluating now!
2024-09-27 16:41:15 INFO     Epoch [18/200] train_loss: 5.0348, val_loss: 6.6208, lr: 0.001000, 21.16s
2024-09-27 16:41:34 INFO     epoch complete!
2024-09-27 16:41:34 INFO     evaluating now!
2024-09-27 16:41:36 INFO     Epoch [19/200] train_loss: 4.9723, val_loss: 5.7663, lr: 0.001000, 21.47s
2024-09-27 16:41:56 INFO     epoch complete!
2024-09-27 16:41:56 INFO     evaluating now!
2024-09-27 16:41:58 INFO     Epoch [20/200] train_loss: 5.0369, val_loss: 7.0584, lr: 0.001000, 21.60s
2024-09-27 16:42:17 INFO     epoch complete!
2024-09-27 16:42:17 INFO     evaluating now!
2024-09-27 16:42:19 INFO     Epoch [21/200] train_loss: 4.8944, val_loss: 5.3291, lr: 0.001000, 20.98s
2024-09-27 16:42:38 INFO     epoch complete!
2024-09-27 16:42:38 INFO     evaluating now!
2024-09-27 16:42:40 INFO     Epoch [22/200] train_loss: 5.1909, val_loss: 6.4640, lr: 0.001000, 21.11s
2024-09-27 16:42:59 INFO     epoch complete!
2024-09-27 16:42:59 INFO     evaluating now!
2024-09-27 16:43:01 INFO     Epoch [23/200] train_loss: 4.8137, val_loss: 6.3842, lr: 0.001000, 20.70s
2024-09-27 16:43:20 INFO     epoch complete!
2024-09-27 16:43:20 INFO     evaluating now!
2024-09-27 16:43:22 INFO     Epoch [24/200] train_loss: 4.7395, val_loss: 5.2202, lr: 0.001000, 21.07s
2024-09-27 16:43:22 INFO     Saved model at 24
2024-09-27 16:43:22 INFO     Val loss decrease from 5.2658 to 5.2202, saving to ./libcity/cache/10016/model_cache/GWNET_CHITaxi20190406_epoch24.tar
2024-09-27 16:43:41 INFO     epoch complete!
2024-09-27 16:43:41 INFO     evaluating now!
2024-09-27 16:43:43 INFO     Epoch [25/200] train_loss: 4.6991, val_loss: 6.2084, lr: 0.001000, 20.97s
2024-09-27 16:44:02 INFO     epoch complete!
2024-09-27 16:44:02 INFO     evaluating now!
2024-09-27 16:44:04 INFO     Epoch [26/200] train_loss: 4.6947, val_loss: 6.0169, lr: 0.001000, 20.95s
2024-09-27 16:44:23 INFO     epoch complete!
2024-09-27 16:44:23 INFO     evaluating now!
2024-09-27 16:44:25 INFO     Epoch [27/200] train_loss: 4.6387, val_loss: 6.5796, lr: 0.001000, 20.96s
2024-09-27 16:44:44 INFO     epoch complete!
2024-09-27 16:44:44 INFO     evaluating now!
2024-09-27 16:44:46 INFO     Epoch [28/200] train_loss: 4.7788, val_loss: 6.5609, lr: 0.001000, 20.81s
2024-09-27 16:45:05 INFO     epoch complete!
2024-09-27 16:45:05 INFO     evaluating now!
2024-09-27 16:45:07 INFO     Epoch [29/200] train_loss: 4.5508, val_loss: 5.0895, lr: 0.001000, 20.95s
2024-09-27 16:45:07 INFO     Saved model at 29
2024-09-27 16:45:07 INFO     Val loss decrease from 5.2202 to 5.0895, saving to ./libcity/cache/10016/model_cache/GWNET_CHITaxi20190406_epoch29.tar
2024-09-27 16:45:25 INFO     epoch complete!
2024-09-27 16:45:25 INFO     evaluating now!
2024-09-27 16:45:27 INFO     Epoch [30/200] train_loss: 4.6438, val_loss: 8.7863, lr: 0.001000, 20.70s
2024-09-27 16:45:46 INFO     epoch complete!
2024-09-27 16:45:46 INFO     evaluating now!
2024-09-27 16:45:49 INFO     Epoch [31/200] train_loss: 4.6671, val_loss: 6.2086, lr: 0.001000, 21.07s
2024-09-27 16:46:08 INFO     epoch complete!
2024-09-27 16:46:08 INFO     evaluating now!
2024-09-27 16:46:10 INFO     Epoch [32/200] train_loss: 4.5300, val_loss: 5.4792, lr: 0.001000, 21.35s
2024-09-27 16:46:29 INFO     epoch complete!
2024-09-27 16:46:29 INFO     evaluating now!
2024-09-27 16:46:31 INFO     Epoch [33/200] train_loss: 4.4250, val_loss: 5.9398, lr: 0.001000, 21.34s
2024-09-27 16:46:50 INFO     epoch complete!
2024-09-27 16:46:50 INFO     evaluating now!
2024-09-27 16:46:52 INFO     Epoch [34/200] train_loss: 4.4401, val_loss: 7.4442, lr: 0.001000, 20.89s
2024-09-27 16:47:12 INFO     epoch complete!
2024-09-27 16:47:12 INFO     evaluating now!
2024-09-27 16:47:14 INFO     Epoch [35/200] train_loss: 4.3960, val_loss: 5.5341, lr: 0.001000, 21.53s
2024-09-27 16:47:33 INFO     epoch complete!
2024-09-27 16:47:33 INFO     evaluating now!
2024-09-27 16:47:35 INFO     Epoch [36/200] train_loss: 4.3431, val_loss: 5.2166, lr: 0.001000, 21.60s
2024-09-27 16:47:55 INFO     epoch complete!
2024-09-27 16:47:55 INFO     evaluating now!
2024-09-27 16:47:57 INFO     Epoch [37/200] train_loss: 4.3388, val_loss: 6.4332, lr: 0.001000, 21.89s
2024-09-27 16:48:17 INFO     epoch complete!
2024-09-27 16:48:17 INFO     evaluating now!
2024-09-27 16:48:19 INFO     Epoch [38/200] train_loss: 4.3510, val_loss: 5.3813, lr: 0.001000, 21.71s
2024-09-27 16:48:38 INFO     epoch complete!
2024-09-27 16:48:38 INFO     evaluating now!
2024-09-27 16:48:40 INFO     Epoch [39/200] train_loss: 4.3685, val_loss: 5.5345, lr: 0.001000, 21.26s
2024-09-27 16:48:59 INFO     epoch complete!
2024-09-27 16:48:59 INFO     evaluating now!
2024-09-27 16:49:01 INFO     Epoch [40/200] train_loss: 4.3020, val_loss: 10.9300, lr: 0.001000, 20.62s
2024-09-27 16:49:19 INFO     epoch complete!
2024-09-27 16:49:19 INFO     evaluating now!
2024-09-27 16:49:21 INFO     Epoch [41/200] train_loss: 4.2626, val_loss: 5.6910, lr: 0.001000, 20.65s
2024-09-27 16:49:40 INFO     epoch complete!
2024-09-27 16:49:40 INFO     evaluating now!
2024-09-27 16:49:42 INFO     Epoch [42/200] train_loss: 4.3474, val_loss: 9.5342, lr: 0.001000, 20.71s
2024-09-27 16:50:01 INFO     epoch complete!
2024-09-27 16:50:01 INFO     evaluating now!
2024-09-27 16:50:03 INFO     Epoch [43/200] train_loss: 4.3056, val_loss: 5.7095, lr: 0.001000, 20.63s
2024-09-27 16:50:21 INFO     epoch complete!
2024-09-27 16:50:21 INFO     evaluating now!
2024-09-27 16:50:23 INFO     Epoch [44/200] train_loss: 4.2116, val_loss: 5.1371, lr: 0.001000, 20.33s
2024-09-27 16:50:23 WARNING  Early stopping at epoch: 44
2024-09-27 16:50:23 INFO     Trained totally 45 epochs, average train time is 18.973s, average eval time is 2.063s
2024-09-27 16:50:23 INFO     Loaded model at 29
2024-09-27 16:50:23 INFO     Saved model at ./libcity/cache/10016/model_cache/GWNET_CHITaxi20190406.m
2024-09-27 16:50:23 INFO     Start evaluating ...
2024-09-27 16:50:28 INFO     Note that you select the single mode to evaluate!
2024-09-27 16:50:28 INFO     Evaluate result is saved at ./libcity/cache/10016/evaluate_cache/2024_09_27_16_50_28_GWNET_CHITaxi20190406.csv
2024-09-27 16:50:28 INFO     
         MAE       RMSE  masked_MAPE
1   2.280654   7.101739     0.362336
2   2.494121   8.200933     0.374329
3   2.719201   9.399009     0.391106
4   2.783575   9.982463     0.388193
5   2.975260  10.646016     0.404240
6   3.140493  11.451638     0.405697
7   3.278074  12.658202     0.411616
8   3.428817  13.658342     0.419764
9   3.515743  14.438748     0.433165
10  3.580419  14.518662     0.435458
11  3.653759  14.487810     0.430361
12  3.695054  14.409463     0.453691
2024-09-27 16:50:28 INFO     ----------------------------------------------------------------------------
2024-09-27 16:50:28 INFO     # 2, Kownledge Graph Embedding: GIE, Experiment ids: 10017
2024-09-27 16:50:28 INFO     ----------------------------------------------------------------------------
2024-09-27 16:50:28 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=10017
2024-09-27 16:50:28 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10017, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-27 16:50:28 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-27 16:50:28 INFO     set_weight_link_or_dist: dist
2024-09-27 16:50:28 INFO     init_weight_inf_or_zero: inf
2024-09-27 16:50:28 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-27 16:50:28 INFO     Start Calculate the weight by Gauss kernel!
2024-09-27 16:50:28 INFO     Loading file CHITaxi20190406.dyna
2024-09-27 16:50:28 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-27 16:50:31 INFO     Dataset created
2024-09-27 16:50:31 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-27 16:50:31 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-27 16:50:31 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-27 16:50:31 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-27 16:50:31 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-27 16:50:31 INFO     NoneScaler
2024-09-27 16:50:33 INFO     add adj_mx to supports
2024-09-27 16:50:33 INFO     add apt_adj(v1 * v2) in forward process
2024-09-27 16:50:33 INFO     receptive_field: 14
2024-09-27 16:50:33 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(34, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-27 16:50:33 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-27 16:50:33 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-27 16:50:33 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:50:33 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:50:33 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:50:33 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:50:33 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:50:33 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:50:33 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:50:33 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:50:33 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:50:33 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:50:33 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:50:33 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:50:33 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:50:33 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:50:33 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:50:33 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 16:50:33 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:50:33 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:50:33 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:50:33 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:50:33 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:50:33 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:50:33 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:50:33 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-27 16:50:33 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     start_conv.weight	torch.Size([32, 34, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-27 16:50:33 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-27 16:50:33 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-27 16:50:33 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-27 16:50:33 INFO     Total parameter numbers: 307824
2024-09-27 16:50:33 INFO     You select `adam` optimizer.
2024-09-27 16:50:33 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-27 16:50:33 INFO     Start training ...
2024-09-27 16:50:33 INFO     num_batches:96
2024-09-27 16:50:52 INFO     epoch complete!
2024-09-27 16:50:52 INFO     evaluating now!
2024-09-27 16:50:54 INFO     Epoch [0/200] train_loss: 12.5572, val_loss: 9.7821, lr: 0.001000, 20.53s
2024-09-27 16:50:54 INFO     Saved model at 0
2024-09-27 16:50:54 INFO     Val loss decrease from inf to 9.7821, saving to ./libcity/cache/10017/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-27 16:51:13 INFO     epoch complete!
2024-09-27 16:51:13 INFO     evaluating now!
2024-09-27 16:51:15 INFO     Epoch [1/200] train_loss: 8.9366, val_loss: 12.5259, lr: 0.001000, 21.30s
2024-09-27 16:51:34 INFO     epoch complete!
2024-09-27 16:51:34 INFO     evaluating now!
2024-09-27 16:51:37 INFO     Epoch [2/200] train_loss: 8.2895, val_loss: 8.4712, lr: 0.001000, 21.35s
2024-09-27 16:51:37 INFO     Saved model at 2
2024-09-27 16:51:37 INFO     Val loss decrease from 9.7821 to 8.4712, saving to ./libcity/cache/10017/model_cache/GWNET_CHITaxi20190406_epoch2.tar
2024-09-27 16:51:56 INFO     epoch complete!
2024-09-27 16:51:56 INFO     evaluating now!
2024-09-27 16:51:58 INFO     Epoch [3/200] train_loss: 8.0946, val_loss: 7.8882, lr: 0.001000, 20.87s
2024-09-27 16:51:58 INFO     Saved model at 3
2024-09-27 16:51:58 INFO     Val loss decrease from 8.4712 to 7.8882, saving to ./libcity/cache/10017/model_cache/GWNET_CHITaxi20190406_epoch3.tar
2024-09-27 16:52:17 INFO     epoch complete!
2024-09-27 16:52:17 INFO     evaluating now!
2024-09-27 16:52:19 INFO     Epoch [4/200] train_loss: 7.9828, val_loss: 8.0855, lr: 0.001000, 20.89s
2024-09-27 16:52:37 INFO     epoch complete!
2024-09-27 16:52:37 INFO     evaluating now!
2024-09-27 16:52:39 INFO     Epoch [5/200] train_loss: 7.9343, val_loss: 8.6567, lr: 0.001000, 20.42s
2024-09-27 16:52:58 INFO     epoch complete!
2024-09-27 16:52:58 INFO     evaluating now!
2024-09-27 16:53:00 INFO     Epoch [6/200] train_loss: 7.7549, val_loss: 7.7439, lr: 0.001000, 20.55s
2024-09-27 16:53:00 INFO     Saved model at 6
2024-09-27 16:53:00 INFO     Val loss decrease from 7.8882 to 7.7439, saving to ./libcity/cache/10017/model_cache/GWNET_CHITaxi20190406_epoch6.tar
2024-09-27 16:53:18 INFO     epoch complete!
2024-09-27 16:53:18 INFO     evaluating now!
2024-09-27 16:53:20 INFO     Epoch [7/200] train_loss: 7.4783, val_loss: 8.0653, lr: 0.001000, 20.66s
2024-09-27 16:53:39 INFO     epoch complete!
2024-09-27 16:53:39 INFO     evaluating now!
2024-09-27 16:53:41 INFO     Epoch [8/200] train_loss: 7.4607, val_loss: 8.5991, lr: 0.001000, 20.59s
2024-09-27 16:54:00 INFO     epoch complete!
2024-09-27 16:54:00 INFO     evaluating now!
2024-09-27 16:54:02 INFO     Epoch [9/200] train_loss: 7.3729, val_loss: 7.6284, lr: 0.001000, 20.55s
2024-09-27 16:54:02 INFO     Saved model at 9
2024-09-27 16:54:02 INFO     Val loss decrease from 7.7439 to 7.6284, saving to ./libcity/cache/10017/model_cache/GWNET_CHITaxi20190406_epoch9.tar
2024-09-27 16:54:20 INFO     epoch complete!
2024-09-27 16:54:20 INFO     evaluating now!
2024-09-27 16:54:22 INFO     Epoch [10/200] train_loss: 7.2531, val_loss: 9.4438, lr: 0.001000, 20.46s
2024-09-27 16:54:41 INFO     epoch complete!
2024-09-27 16:54:41 INFO     evaluating now!
2024-09-27 16:54:43 INFO     Epoch [11/200] train_loss: 7.3249, val_loss: 7.7785, lr: 0.001000, 20.72s
2024-09-27 16:55:02 INFO     epoch complete!
2024-09-27 16:55:02 INFO     evaluating now!
2024-09-27 16:55:04 INFO     Epoch [12/200] train_loss: 6.9309, val_loss: 7.2148, lr: 0.001000, 21.50s
2024-09-27 16:55:04 INFO     Saved model at 12
2024-09-27 16:55:04 INFO     Val loss decrease from 7.6284 to 7.2148, saving to ./libcity/cache/10017/model_cache/GWNET_CHITaxi20190406_epoch12.tar
2024-09-27 16:55:24 INFO     epoch complete!
2024-09-27 16:55:24 INFO     evaluating now!
2024-09-27 16:55:26 INFO     Epoch [13/200] train_loss: 5.8281, val_loss: 11.6994, lr: 0.001000, 21.88s
2024-09-27 16:55:46 INFO     epoch complete!
2024-09-27 16:55:46 INFO     evaluating now!
2024-09-27 16:55:48 INFO     Epoch [14/200] train_loss: 5.6249, val_loss: 6.4953, lr: 0.001000, 21.89s
2024-09-27 16:55:48 INFO     Saved model at 14
2024-09-27 16:55:48 INFO     Val loss decrease from 7.2148 to 6.4953, saving to ./libcity/cache/10017/model_cache/GWNET_CHITaxi20190406_epoch14.tar
2024-09-27 16:56:08 INFO     epoch complete!
2024-09-27 16:56:08 INFO     evaluating now!
2024-09-27 16:56:10 INFO     Epoch [15/200] train_loss: 5.3500, val_loss: 5.7352, lr: 0.001000, 21.86s
2024-09-27 16:56:10 INFO     Saved model at 15
2024-09-27 16:56:10 INFO     Val loss decrease from 6.4953 to 5.7352, saving to ./libcity/cache/10017/model_cache/GWNET_CHITaxi20190406_epoch15.tar
2024-09-27 16:56:30 INFO     epoch complete!
2024-09-27 16:56:30 INFO     evaluating now!
2024-09-27 16:56:32 INFO     Epoch [16/200] train_loss: 5.3135, val_loss: 5.6291, lr: 0.001000, 21.90s
2024-09-27 16:56:32 INFO     Saved model at 16
2024-09-27 16:56:32 INFO     Val loss decrease from 5.7352 to 5.6291, saving to ./libcity/cache/10017/model_cache/GWNET_CHITaxi20190406_epoch16.tar
2024-09-27 16:56:52 INFO     epoch complete!
2024-09-27 16:56:52 INFO     evaluating now!
2024-09-27 16:56:54 INFO     Epoch [17/200] train_loss: 5.2475, val_loss: 6.7586, lr: 0.001000, 21.68s
2024-09-27 16:57:14 INFO     epoch complete!
2024-09-27 16:57:14 INFO     evaluating now!
2024-09-27 16:57:16 INFO     Epoch [18/200] train_loss: 5.1956, val_loss: 6.0511, lr: 0.001000, 21.61s
2024-09-27 16:57:35 INFO     epoch complete!
2024-09-27 16:57:35 INFO     evaluating now!
2024-09-27 16:57:38 INFO     Epoch [19/200] train_loss: 4.9453, val_loss: 6.0508, lr: 0.001000, 21.86s
2024-09-27 16:57:57 INFO     epoch complete!
2024-09-27 16:57:57 INFO     evaluating now!
2024-09-27 16:57:59 INFO     Epoch [20/200] train_loss: 4.9839, val_loss: 5.4372, lr: 0.001000, 21.88s
2024-09-27 16:58:00 INFO     Saved model at 20
2024-09-27 16:58:00 INFO     Val loss decrease from 5.6291 to 5.4372, saving to ./libcity/cache/10017/model_cache/GWNET_CHITaxi20190406_epoch20.tar
2024-09-27 16:58:19 INFO     epoch complete!
2024-09-27 16:58:19 INFO     evaluating now!
2024-09-27 16:58:21 INFO     Epoch [21/200] train_loss: 4.9490, val_loss: 7.8379, lr: 0.001000, 21.87s
2024-09-27 16:58:41 INFO     epoch complete!
2024-09-27 16:58:41 INFO     evaluating now!
2024-09-27 16:58:43 INFO     Epoch [22/200] train_loss: 4.9427, val_loss: 5.8980, lr: 0.001000, 21.90s
2024-09-27 16:59:03 INFO     epoch complete!
2024-09-27 16:59:03 INFO     evaluating now!
2024-09-27 16:59:05 INFO     Epoch [23/200] train_loss: 4.8468, val_loss: 9.4388, lr: 0.001000, 21.83s
2024-09-27 16:59:25 INFO     epoch complete!
2024-09-27 16:59:25 INFO     evaluating now!
2024-09-27 16:59:27 INFO     Epoch [24/200] train_loss: 4.8438, val_loss: 8.6421, lr: 0.001000, 21.89s
2024-09-27 16:59:47 INFO     epoch complete!
2024-09-27 16:59:47 INFO     evaluating now!
2024-09-27 16:59:49 INFO     Epoch [25/200] train_loss: 4.8540, val_loss: 8.0126, lr: 0.001000, 21.99s
2024-09-27 17:00:09 INFO     epoch complete!
2024-09-27 17:00:09 INFO     evaluating now!
2024-09-27 17:00:11 INFO     Epoch [26/200] train_loss: 4.7741, val_loss: 10.1737, lr: 0.001000, 21.77s
2024-09-27 17:00:30 INFO     epoch complete!
2024-09-27 17:00:30 INFO     evaluating now!
2024-09-27 17:00:33 INFO     Epoch [27/200] train_loss: 4.7768, val_loss: 5.6813, lr: 0.001000, 21.81s
2024-09-27 17:00:53 INFO     epoch complete!
2024-09-27 17:00:53 INFO     evaluating now!
2024-09-27 17:00:55 INFO     Epoch [28/200] train_loss: 4.7687, val_loss: 5.6734, lr: 0.001000, 22.11s
2024-09-27 17:01:15 INFO     epoch complete!
2024-09-27 17:01:15 INFO     evaluating now!
2024-09-27 17:01:17 INFO     Epoch [29/200] train_loss: 4.6070, val_loss: 8.7041, lr: 0.001000, 22.18s
2024-09-27 17:01:37 INFO     epoch complete!
2024-09-27 17:01:37 INFO     evaluating now!
2024-09-27 17:01:39 INFO     Epoch [30/200] train_loss: 4.5763, val_loss: 5.2123, lr: 0.001000, 22.09s
2024-09-27 17:01:39 INFO     Saved model at 30
2024-09-27 17:01:39 INFO     Val loss decrease from 5.4372 to 5.2123, saving to ./libcity/cache/10017/model_cache/GWNET_CHITaxi20190406_epoch30.tar
2024-09-27 17:01:59 INFO     epoch complete!
2024-09-27 17:01:59 INFO     evaluating now!
2024-09-27 17:02:01 INFO     Epoch [31/200] train_loss: 4.5899, val_loss: 7.3389, lr: 0.001000, 21.99s
2024-09-27 17:02:21 INFO     epoch complete!
2024-09-27 17:02:21 INFO     evaluating now!
2024-09-27 17:02:23 INFO     Epoch [32/200] train_loss: 4.5242, val_loss: 6.8107, lr: 0.001000, 21.94s
2024-09-27 17:02:43 INFO     epoch complete!
2024-09-27 17:02:43 INFO     evaluating now!
2024-09-27 17:02:45 INFO     Epoch [33/200] train_loss: 4.5276, val_loss: 5.2734, lr: 0.001000, 21.95s
2024-09-27 17:03:05 INFO     epoch complete!
2024-09-27 17:03:05 INFO     evaluating now!
2024-09-27 17:03:07 INFO     Epoch [34/200] train_loss: 4.4918, val_loss: 5.0852, lr: 0.001000, 21.97s
2024-09-27 17:03:07 INFO     Saved model at 34
2024-09-27 17:03:07 INFO     Val loss decrease from 5.2123 to 5.0852, saving to ./libcity/cache/10017/model_cache/GWNET_CHITaxi20190406_epoch34.tar
2024-09-27 17:03:27 INFO     epoch complete!
2024-09-27 17:03:27 INFO     evaluating now!
2024-09-27 17:03:29 INFO     Epoch [35/200] train_loss: 4.4541, val_loss: 5.1392, lr: 0.001000, 21.86s
2024-09-27 17:03:49 INFO     epoch complete!
2024-09-27 17:03:49 INFO     evaluating now!
2024-09-27 17:03:51 INFO     Epoch [36/200] train_loss: 4.4632, val_loss: 5.9251, lr: 0.001000, 21.92s
2024-09-27 17:04:11 INFO     epoch complete!
2024-09-27 17:04:11 INFO     evaluating now!
2024-09-27 17:04:13 INFO     Epoch [37/200] train_loss: 4.4482, val_loss: 5.2281, lr: 0.001000, 22.02s
2024-09-27 17:04:33 INFO     epoch complete!
2024-09-27 17:04:33 INFO     evaluating now!
2024-09-27 17:04:35 INFO     Epoch [38/200] train_loss: 4.4182, val_loss: 5.3087, lr: 0.001000, 22.06s
2024-09-27 17:04:55 INFO     epoch complete!
2024-09-27 17:04:55 INFO     evaluating now!
2024-09-27 17:04:57 INFO     Epoch [39/200] train_loss: 4.3760, val_loss: 5.6741, lr: 0.001000, 21.94s
2024-09-27 17:05:17 INFO     epoch complete!
2024-09-27 17:05:17 INFO     evaluating now!
2024-09-27 17:05:19 INFO     Epoch [40/200] train_loss: 4.3621, val_loss: 6.3166, lr: 0.001000, 21.85s
2024-09-27 17:05:39 INFO     epoch complete!
2024-09-27 17:05:39 INFO     evaluating now!
2024-09-27 17:05:41 INFO     Epoch [41/200] train_loss: 4.3263, val_loss: 4.9479, lr: 0.001000, 21.86s
2024-09-27 17:05:41 INFO     Saved model at 41
2024-09-27 17:05:41 INFO     Val loss decrease from 5.0852 to 4.9479, saving to ./libcity/cache/10017/model_cache/GWNET_CHITaxi20190406_epoch41.tar
2024-09-27 17:06:01 INFO     epoch complete!
2024-09-27 17:06:01 INFO     evaluating now!
2024-09-27 17:06:03 INFO     Epoch [42/200] train_loss: 4.2739, val_loss: 6.5941, lr: 0.001000, 21.83s
2024-09-27 17:06:22 INFO     epoch complete!
2024-09-27 17:06:22 INFO     evaluating now!
2024-09-27 17:06:24 INFO     Epoch [43/200] train_loss: 4.2145, val_loss: 7.8016, lr: 0.001000, 21.23s
2024-09-27 17:06:43 INFO     epoch complete!
2024-09-27 17:06:43 INFO     evaluating now!
2024-09-27 17:06:45 INFO     Epoch [44/200] train_loss: 4.3058, val_loss: 5.0028, lr: 0.001000, 20.99s
2024-09-27 17:07:04 INFO     epoch complete!
2024-09-27 17:07:04 INFO     evaluating now!
2024-09-27 17:07:06 INFO     Epoch [45/200] train_loss: 4.1530, val_loss: 5.8099, lr: 0.001000, 20.72s
2024-09-27 17:07:25 INFO     epoch complete!
2024-09-27 17:07:25 INFO     evaluating now!
2024-09-27 17:07:27 INFO     Epoch [46/200] train_loss: 4.1772, val_loss: 6.0773, lr: 0.001000, 21.05s
2024-09-27 17:07:46 INFO     epoch complete!
2024-09-27 17:07:46 INFO     evaluating now!
2024-09-27 17:07:48 INFO     Epoch [47/200] train_loss: 4.1640, val_loss: 5.4404, lr: 0.001000, 21.39s
2024-09-27 17:08:07 INFO     epoch complete!
2024-09-27 17:08:07 INFO     evaluating now!
2024-09-27 17:08:09 INFO     Epoch [48/200] train_loss: 4.1761, val_loss: 5.2480, lr: 0.001000, 21.08s
2024-09-27 17:08:28 INFO     epoch complete!
2024-09-27 17:08:28 INFO     evaluating now!
2024-09-27 17:08:30 INFO     Epoch [49/200] train_loss: 4.1325, val_loss: 7.5651, lr: 0.001000, 21.25s
2024-09-27 17:08:50 INFO     epoch complete!
2024-09-27 17:08:50 INFO     evaluating now!
2024-09-27 17:08:52 INFO     Epoch [50/200] train_loss: 4.1208, val_loss: 6.6111, lr: 0.001000, 21.52s
2024-09-27 17:09:12 INFO     epoch complete!
2024-09-27 17:09:12 INFO     evaluating now!
2024-09-27 17:09:14 INFO     Epoch [51/200] train_loss: 4.0770, val_loss: 5.6796, lr: 0.001000, 21.53s
2024-09-27 17:09:33 INFO     epoch complete!
2024-09-27 17:09:33 INFO     evaluating now!
2024-09-27 17:09:35 INFO     Epoch [52/200] train_loss: 4.1405, val_loss: 5.0341, lr: 0.001000, 21.46s
2024-09-27 17:09:54 INFO     epoch complete!
2024-09-27 17:09:54 INFO     evaluating now!
2024-09-27 17:09:56 INFO     Epoch [53/200] train_loss: 4.0679, val_loss: 6.4663, lr: 0.001000, 21.09s
2024-09-27 17:10:15 INFO     epoch complete!
2024-09-27 17:10:15 INFO     evaluating now!
2024-09-27 17:10:17 INFO     Epoch [54/200] train_loss: 4.0427, val_loss: 5.2247, lr: 0.001000, 21.08s
2024-09-27 17:10:36 INFO     epoch complete!
2024-09-27 17:10:36 INFO     evaluating now!
2024-09-27 17:10:38 INFO     Epoch [55/200] train_loss: 4.0688, val_loss: 5.9221, lr: 0.001000, 20.92s
2024-09-27 17:10:57 INFO     epoch complete!
2024-09-27 17:10:57 INFO     evaluating now!
2024-09-27 17:10:59 INFO     Epoch [56/200] train_loss: 4.0776, val_loss: 5.3375, lr: 0.001000, 21.15s
2024-09-27 17:10:59 WARNING  Early stopping at epoch: 56
2024-09-27 17:10:59 INFO     Trained totally 57 epochs, average train time is 19.372s, average eval time is 2.102s
2024-09-27 17:10:59 INFO     Loaded model at 41
2024-09-27 17:10:59 INFO     Saved model at ./libcity/cache/10017/model_cache/GWNET_CHITaxi20190406.m
2024-09-27 17:10:59 INFO     Start evaluating ...
2024-09-27 17:11:04 INFO     Note that you select the single mode to evaluate!
2024-09-27 17:11:04 INFO     Evaluate result is saved at ./libcity/cache/10017/evaluate_cache/2024_09_27_17_11_04_GWNET_CHITaxi20190406.csv
2024-09-27 17:11:04 INFO     
         MAE       RMSE  masked_MAPE
1   2.475191   7.102566     0.411462
2   2.632914   8.088553     0.398994
3   2.844265   9.106345     0.410897
4   2.961986   9.967042     0.394794
5   3.112968  10.651757     0.407876
6   3.185808  11.442190     0.389868
7   3.385197  12.227253     0.415899
8   3.338434  12.555022     0.389152
9   3.387674  12.533923     0.414540
10  3.359501  12.444936     0.399825
11  3.413896  12.694313     0.406101
12  3.628613  13.135916     0.452551
2024-09-27 17:11:05 INFO     ----------------------------------------------------------------------------
2024-09-27 17:11:05 INFO     # 3, Kownledge Graph Embedding: GIE, Experiment ids: 10018
2024-09-27 17:11:05 INFO     ----------------------------------------------------------------------------
2024-09-27 17:11:05 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=10018
2024-09-27 17:11:05 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10018, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-27 17:11:05 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-27 17:11:05 INFO     set_weight_link_or_dist: dist
2024-09-27 17:11:05 INFO     init_weight_inf_or_zero: inf
2024-09-27 17:11:05 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-27 17:11:05 INFO     Start Calculate the weight by Gauss kernel!
2024-09-27 17:11:05 INFO     Loading file CHITaxi20190406.dyna
2024-09-27 17:11:05 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-27 17:11:08 INFO     Dataset created
2024-09-27 17:11:08 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-27 17:11:08 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-27 17:11:08 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-27 17:11:08 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-27 17:11:08 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-27 17:11:08 INFO     NoneScaler
2024-09-27 17:11:10 INFO     add adj_mx to supports
2024-09-27 17:11:10 INFO     add apt_adj(v1 * v2) in forward process
2024-09-27 17:11:10 INFO     receptive_field: 14
2024-09-27 17:11:10 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(34, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-27 17:11:10 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-27 17:11:10 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-27 17:11:10 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:11:10 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:11:10 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:11:10 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:11:10 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:11:10 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:11:10 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:11:10 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:11:10 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:11:10 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:11:10 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:11:10 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:11:10 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:11:10 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:11:10 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:11:10 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:11:10 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-27 17:11:10 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-27 17:11:10 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-27 17:11:10 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-27 17:11:10 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-27 17:11:10 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-27 17:11:10 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-27 17:11:10 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-27 17:11:10 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     start_conv.weight	torch.Size([32, 34, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:11:10 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-27 17:11:10 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-27 17:11:10 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-27 17:11:10 INFO     Total parameter numbers: 307824
2024-09-27 17:11:10 INFO     You select `adam` optimizer.
2024-09-27 17:11:10 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-27 17:11:10 INFO     Start training ...
2024-09-27 17:11:10 INFO     num_batches:96
2024-09-27 17:11:29 INFO     epoch complete!
2024-09-27 17:11:29 INFO     evaluating now!
2024-09-27 17:11:31 INFO     Epoch [0/200] train_loss: 12.2485, val_loss: 10.9853, lr: 0.001000, 21.11s
2024-09-27 17:11:31 INFO     Saved model at 0
2024-09-27 17:11:31 INFO     Val loss decrease from inf to 10.9853, saving to ./libcity/cache/10018/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-27 17:11:50 INFO     epoch complete!
2024-09-27 17:11:50 INFO     evaluating now!
2024-09-27 17:11:52 INFO     Epoch [1/200] train_loss: 8.8600, val_loss: 9.9061, lr: 0.001000, 20.95s
2024-09-27 17:11:52 INFO     Saved model at 1
2024-09-27 17:11:52 INFO     Val loss decrease from 10.9853 to 9.9061, saving to ./libcity/cache/10018/model_cache/GWNET_CHITaxi20190406_epoch1.tar
2024-09-27 17:12:11 INFO     epoch complete!
2024-09-27 17:12:11 INFO     evaluating now!
2024-09-27 17:12:13 INFO     Epoch [2/200] train_loss: 8.3316, val_loss: 8.7773, lr: 0.001000, 20.72s
2024-09-27 17:12:13 INFO     Saved model at 2
2024-09-27 17:12:13 INFO     Val loss decrease from 9.9061 to 8.7773, saving to ./libcity/cache/10018/model_cache/GWNET_CHITaxi20190406_epoch2.tar
2024-09-27 17:12:32 INFO     epoch complete!
2024-09-27 17:12:32 INFO     evaluating now!
2024-09-27 17:12:34 INFO     Epoch [3/200] train_loss: 8.1596, val_loss: 9.9372, lr: 0.001000, 21.10s
2024-09-27 17:12:53 INFO     epoch complete!
2024-09-27 17:12:53 INFO     evaluating now!
2024-09-27 17:12:55 INFO     Epoch [4/200] train_loss: 7.9805, val_loss: 8.6919, lr: 0.001000, 21.03s
2024-09-27 17:12:55 INFO     Saved model at 4
2024-09-27 17:12:55 INFO     Val loss decrease from 8.7773 to 8.6919, saving to ./libcity/cache/10018/model_cache/GWNET_CHITaxi20190406_epoch4.tar
2024-09-27 17:13:14 INFO     epoch complete!
2024-09-27 17:13:14 INFO     evaluating now!
2024-09-27 17:13:16 INFO     Epoch [5/200] train_loss: 7.7221, val_loss: 8.2541, lr: 0.001000, 21.44s
2024-09-27 17:13:17 INFO     Saved model at 5
2024-09-27 17:13:17 INFO     Val loss decrease from 8.6919 to 8.2541, saving to ./libcity/cache/10018/model_cache/GWNET_CHITaxi20190406_epoch5.tar
2024-09-27 17:13:36 INFO     epoch complete!
2024-09-27 17:13:36 INFO     evaluating now!
2024-09-27 17:13:38 INFO     Epoch [6/200] train_loss: 7.5827, val_loss: 7.7797, lr: 0.001000, 21.07s
2024-09-27 17:13:38 INFO     Saved model at 6
2024-09-27 17:13:38 INFO     Val loss decrease from 8.2541 to 7.7797, saving to ./libcity/cache/10018/model_cache/GWNET_CHITaxi20190406_epoch6.tar
2024-09-27 17:13:57 INFO     epoch complete!
2024-09-27 17:13:57 INFO     evaluating now!
2024-09-27 17:13:59 INFO     Epoch [7/200] train_loss: 7.4643, val_loss: 12.5839, lr: 0.001000, 21.19s
2024-09-27 17:14:18 INFO     epoch complete!
2024-09-27 17:14:18 INFO     evaluating now!
2024-09-27 17:14:20 INFO     Epoch [8/200] train_loss: 7.4403, val_loss: 7.5301, lr: 0.001000, 21.23s
2024-09-27 17:14:20 INFO     Saved model at 8
2024-09-27 17:14:20 INFO     Val loss decrease from 7.7797 to 7.5301, saving to ./libcity/cache/10018/model_cache/GWNET_CHITaxi20190406_epoch8.tar
2024-09-27 17:14:40 INFO     epoch complete!
2024-09-27 17:14:40 INFO     evaluating now!
2024-09-27 17:14:42 INFO     Epoch [9/200] train_loss: 7.0438, val_loss: 6.2233, lr: 0.001000, 21.38s
2024-09-27 17:14:42 INFO     Saved model at 9
2024-09-27 17:14:42 INFO     Val loss decrease from 7.5301 to 6.2233, saving to ./libcity/cache/10018/model_cache/GWNET_CHITaxi20190406_epoch9.tar
2024-09-27 17:15:01 INFO     epoch complete!
2024-09-27 17:15:01 INFO     evaluating now!
2024-09-27 17:15:03 INFO     Epoch [10/200] train_loss: 6.2008, val_loss: 9.8743, lr: 0.001000, 21.28s
2024-09-27 17:15:23 INFO     epoch complete!
2024-09-27 17:15:23 INFO     evaluating now!
2024-09-27 17:15:25 INFO     Epoch [11/200] train_loss: 5.7806, val_loss: 12.5580, lr: 0.001000, 21.31s
2024-09-27 17:15:44 INFO     epoch complete!
2024-09-27 17:15:44 INFO     evaluating now!
2024-09-27 17:15:46 INFO     Epoch [12/200] train_loss: 5.6673, val_loss: 7.5160, lr: 0.001000, 21.28s
2024-09-27 17:16:05 INFO     epoch complete!
2024-09-27 17:16:05 INFO     evaluating now!
2024-09-27 17:16:08 INFO     Epoch [13/200] train_loss: 5.3729, val_loss: 6.5977, lr: 0.001000, 21.63s
2024-09-27 17:16:27 INFO     epoch complete!
2024-09-27 17:16:27 INFO     evaluating now!
2024-09-27 17:16:29 INFO     Epoch [14/200] train_loss: 5.2736, val_loss: 6.6867, lr: 0.001000, 21.59s
2024-09-27 17:16:49 INFO     epoch complete!
2024-09-27 17:16:49 INFO     evaluating now!
2024-09-27 17:16:51 INFO     Epoch [15/200] train_loss: 5.1685, val_loss: 5.8574, lr: 0.001000, 21.65s
2024-09-27 17:16:51 INFO     Saved model at 15
2024-09-27 17:16:51 INFO     Val loss decrease from 6.2233 to 5.8574, saving to ./libcity/cache/10018/model_cache/GWNET_CHITaxi20190406_epoch15.tar
2024-09-27 17:17:10 INFO     epoch complete!
2024-09-27 17:17:10 INFO     evaluating now!
2024-09-27 17:17:13 INFO     Epoch [16/200] train_loss: 5.0589, val_loss: 8.3323, lr: 0.001000, 21.56s
2024-09-27 17:17:32 INFO     epoch complete!
2024-09-27 17:17:32 INFO     evaluating now!
2024-09-27 17:17:34 INFO     Epoch [17/200] train_loss: 5.0778, val_loss: 6.6246, lr: 0.001000, 21.57s
2024-09-27 17:17:54 INFO     epoch complete!
2024-09-27 17:17:54 INFO     evaluating now!
2024-09-27 17:17:56 INFO     Epoch [18/200] train_loss: 5.0299, val_loss: 8.9745, lr: 0.001000, 21.55s
2024-09-27 17:18:15 INFO     epoch complete!
2024-09-27 17:18:15 INFO     evaluating now!
2024-09-27 17:18:17 INFO     Epoch [19/200] train_loss: 4.9760, val_loss: 6.8872, lr: 0.001000, 21.46s
2024-09-27 17:18:37 INFO     epoch complete!
2024-09-27 17:18:37 INFO     evaluating now!
2024-09-27 17:18:39 INFO     Epoch [20/200] train_loss: 4.9492, val_loss: 6.2767, lr: 0.001000, 21.52s
2024-09-27 17:18:58 INFO     epoch complete!
2024-09-27 17:18:58 INFO     evaluating now!
2024-09-27 17:19:00 INFO     Epoch [21/200] train_loss: 4.9032, val_loss: 6.3834, lr: 0.001000, 21.09s
2024-09-27 17:19:19 INFO     epoch complete!
2024-09-27 17:19:19 INFO     evaluating now!
2024-09-27 17:19:21 INFO     Epoch [22/200] train_loss: 4.8698, val_loss: 5.8706, lr: 0.001000, 21.09s
2024-09-27 17:19:39 INFO     epoch complete!
2024-09-27 17:19:39 INFO     evaluating now!
2024-09-27 17:19:41 INFO     Epoch [23/200] train_loss: 4.9105, val_loss: 7.2589, lr: 0.001000, 20.55s
2024-09-27 17:20:00 INFO     epoch complete!
2024-09-27 17:20:00 INFO     evaluating now!
2024-09-27 17:20:02 INFO     Epoch [24/200] train_loss: 4.7579, val_loss: 5.5306, lr: 0.001000, 20.50s
2024-09-27 17:20:02 INFO     Saved model at 24
2024-09-27 17:20:02 INFO     Val loss decrease from 5.8574 to 5.5306, saving to ./libcity/cache/10018/model_cache/GWNET_CHITaxi20190406_epoch24.tar
2024-09-27 17:20:21 INFO     epoch complete!
2024-09-27 17:20:21 INFO     evaluating now!
2024-09-27 17:20:23 INFO     Epoch [25/200] train_loss: 4.7567, val_loss: 6.2573, lr: 0.001000, 20.81s
2024-09-27 17:20:42 INFO     epoch complete!
2024-09-27 17:20:42 INFO     evaluating now!
2024-09-27 17:20:44 INFO     Epoch [26/200] train_loss: 4.6760, val_loss: 5.8447, lr: 0.001000, 20.90s
2024-09-27 17:21:03 INFO     epoch complete!
2024-09-27 17:21:03 INFO     evaluating now!
2024-09-27 17:21:05 INFO     Epoch [27/200] train_loss: 4.6199, val_loss: 5.8498, lr: 0.001000, 21.62s
2024-09-27 17:21:25 INFO     epoch complete!
2024-09-27 17:21:25 INFO     evaluating now!
2024-09-27 17:21:27 INFO     Epoch [28/200] train_loss: 4.5912, val_loss: 5.4315, lr: 0.001000, 21.49s
2024-09-27 17:21:27 INFO     Saved model at 28
2024-09-27 17:21:27 INFO     Val loss decrease from 5.5306 to 5.4315, saving to ./libcity/cache/10018/model_cache/GWNET_CHITaxi20190406_epoch28.tar
2024-09-27 17:21:46 INFO     epoch complete!
2024-09-27 17:21:46 INFO     evaluating now!
2024-09-27 17:21:48 INFO     Epoch [29/200] train_loss: 4.5662, val_loss: 6.6800, lr: 0.001000, 20.91s
2024-09-27 17:22:07 INFO     epoch complete!
2024-09-27 17:22:07 INFO     evaluating now!
2024-09-27 17:22:09 INFO     Epoch [30/200] train_loss: 4.5841, val_loss: 5.0345, lr: 0.001000, 21.14s
2024-09-27 17:22:09 INFO     Saved model at 30
2024-09-27 17:22:09 INFO     Val loss decrease from 5.4315 to 5.0345, saving to ./libcity/cache/10018/model_cache/GWNET_CHITaxi20190406_epoch30.tar
2024-09-27 17:22:28 INFO     epoch complete!
2024-09-27 17:22:28 INFO     evaluating now!
2024-09-27 17:22:30 INFO     Epoch [31/200] train_loss: 4.4601, val_loss: 5.4615, lr: 0.001000, 21.22s
2024-09-27 17:22:49 INFO     epoch complete!
2024-09-27 17:22:49 INFO     evaluating now!
2024-09-27 17:22:51 INFO     Epoch [32/200] train_loss: 4.4572, val_loss: 5.4284, lr: 0.001000, 20.88s
2024-09-27 17:23:10 INFO     epoch complete!
2024-09-27 17:23:10 INFO     evaluating now!
2024-09-27 17:23:12 INFO     Epoch [33/200] train_loss: 4.4182, val_loss: 5.0771, lr: 0.001000, 21.02s
2024-09-27 17:23:31 INFO     epoch complete!
2024-09-27 17:23:31 INFO     evaluating now!
2024-09-27 17:23:33 INFO     Epoch [34/200] train_loss: 4.4363, val_loss: 5.7674, lr: 0.001000, 20.76s
2024-09-27 17:23:52 INFO     epoch complete!
2024-09-27 17:23:52 INFO     evaluating now!
2024-09-27 17:23:54 INFO     Epoch [35/200] train_loss: 4.3757, val_loss: 5.6110, lr: 0.001000, 20.62s
2024-09-27 17:24:13 INFO     epoch complete!
2024-09-27 17:24:13 INFO     evaluating now!
2024-09-27 17:24:15 INFO     Epoch [36/200] train_loss: 4.4250, val_loss: 5.7582, lr: 0.001000, 20.86s
2024-09-27 17:24:33 INFO     epoch complete!
2024-09-27 17:24:33 INFO     evaluating now!
2024-09-27 17:24:35 INFO     Epoch [37/200] train_loss: 4.3202, val_loss: 6.6777, lr: 0.001000, 20.85s
2024-09-27 17:24:55 INFO     epoch complete!
2024-09-27 17:24:55 INFO     evaluating now!
2024-09-27 17:24:57 INFO     Epoch [38/200] train_loss: 4.3183, val_loss: 5.1796, lr: 0.001000, 21.28s
2024-09-27 17:25:16 INFO     epoch complete!
2024-09-27 17:25:16 INFO     evaluating now!
2024-09-27 17:25:18 INFO     Epoch [39/200] train_loss: 4.3519, val_loss: 5.5170, lr: 0.001000, 21.41s
2024-09-27 17:25:37 INFO     epoch complete!
2024-09-27 17:25:37 INFO     evaluating now!
2024-09-27 17:25:40 INFO     Epoch [40/200] train_loss: 4.2967, val_loss: 5.4106, lr: 0.001000, 21.33s
2024-09-27 17:25:59 INFO     epoch complete!
2024-09-27 17:25:59 INFO     evaluating now!
2024-09-27 17:26:01 INFO     Epoch [41/200] train_loss: 4.2305, val_loss: 6.1810, lr: 0.001000, 21.52s
2024-09-27 17:26:20 INFO     epoch complete!
2024-09-27 17:26:20 INFO     evaluating now!
2024-09-27 17:26:22 INFO     Epoch [42/200] train_loss: 4.2852, val_loss: 5.7823, lr: 0.001000, 21.42s
2024-09-27 17:26:42 INFO     epoch complete!
2024-09-27 17:26:42 INFO     evaluating now!
2024-09-27 17:26:44 INFO     Epoch [43/200] train_loss: 4.1642, val_loss: 5.1622, lr: 0.001000, 21.35s
2024-09-27 17:27:03 INFO     epoch complete!
2024-09-27 17:27:03 INFO     evaluating now!
2024-09-27 17:27:05 INFO     Epoch [44/200] train_loss: 4.1843, val_loss: 5.4153, lr: 0.001000, 21.29s
2024-09-27 17:27:24 INFO     epoch complete!
2024-09-27 17:27:24 INFO     evaluating now!
2024-09-27 17:27:26 INFO     Epoch [45/200] train_loss: 4.1239, val_loss: 5.2677, lr: 0.001000, 21.26s
2024-09-27 17:27:26 WARNING  Early stopping at epoch: 45
2024-09-27 17:27:26 INFO     Trained totally 46 epochs, average train time is 19.117s, average eval time is 2.073s
2024-09-27 17:27:26 INFO     Loaded model at 30
2024-09-27 17:27:26 INFO     Saved model at ./libcity/cache/10018/model_cache/GWNET_CHITaxi20190406.m
2024-09-27 17:27:27 INFO     Start evaluating ...
2024-09-27 17:27:31 INFO     Note that you select the single mode to evaluate!
2024-09-27 17:27:31 INFO     Evaluate result is saved at ./libcity/cache/10018/evaluate_cache/2024_09_27_17_27_31_GWNET_CHITaxi20190406.csv
2024-09-27 17:27:31 INFO     
         MAE       RMSE  masked_MAPE
1   2.428189   7.338541     0.375290
2   2.598302   8.397916     0.376592
3   2.843395   9.512730     0.393288
4   2.908041  10.492197     0.370693
5   3.151243  11.822526     0.380511
6   3.300653  13.025783     0.380325
7   3.435902  14.240105     0.395290
8   3.569425  15.029579     0.401893
9   3.569952  15.200252     0.390525
10  3.642515  15.298256     0.399120
11  3.666388  15.106023     0.412124
12  3.703306  15.169151     0.419648
2024-09-27 17:27:32 INFO     ----------------------------------------------------------------------------
2024-09-27 17:27:32 INFO     # 4, Kownledge Graph Embedding: GIE, Experiment ids: 10019
2024-09-27 17:27:32 INFO     ----------------------------------------------------------------------------
2024-09-27 17:27:32 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=10019
2024-09-27 17:27:32 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 10019, 'ke_model': 'GIE', 'ke_dim': 32, 'ke_method': 'Concat', 'load_external': True, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-27 17:27:32 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-27 17:27:32 INFO     set_weight_link_or_dist: dist
2024-09-27 17:27:32 INFO     init_weight_inf_or_zero: inf
2024-09-27 17:27:32 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-27 17:27:32 INFO     Start Calculate the weight by Gauss kernel!
2024-09-27 17:27:32 INFO     Loading file CHITaxi20190406.dyna
2024-09-27 17:27:32 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-27 17:27:35 INFO     Dataset created
2024-09-27 17:27:35 INFO     x shape: (4345, 12, 77, 34), y shape: (4345, 12, 77, 34)
2024-09-27 17:27:35 INFO     train	x: (3042, 12, 77, 34), y: (3042, 12, 77, 34)
2024-09-27 17:27:35 INFO     eval	x: (434, 12, 77, 34), y: (434, 12, 77, 34)
2024-09-27 17:27:35 INFO     test	x: (869, 12, 77, 34), y: (869, 12, 77, 34)
2024-09-27 17:27:35 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-27 17:27:35 INFO     NoneScaler
2024-09-27 17:27:37 INFO     add adj_mx to supports
2024-09-27 17:27:37 INFO     add apt_adj(v1 * v2) in forward process
2024-09-27 17:27:37 INFO     receptive_field: 14
2024-09-27 17:27:37 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(34, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-27 17:27:37 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-27 17:27:37 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-27 17:27:37 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:27:37 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:27:37 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:27:37 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:27:37 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:27:37 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:27:37 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:27:37 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:27:37 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:27:37 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:27:37 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:27:37 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:27:37 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:27:37 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:27:37 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:27:37 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 17:27:37 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-27 17:27:37 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-27 17:27:37 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-27 17:27:37 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-27 17:27:37 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-27 17:27:37 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-27 17:27:37 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-27 17:27:37 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-27 17:27:37 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     start_conv.weight	torch.Size([32, 34, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-27 17:27:37 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-27 17:27:37 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-27 17:27:37 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-27 17:27:37 INFO     Total parameter numbers: 307824
2024-09-27 17:27:37 INFO     You select `adam` optimizer.
2024-09-27 17:27:37 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-27 17:27:37 INFO     Start training ...
2024-09-27 17:27:37 INFO     num_batches:96
2024-09-27 17:27:57 INFO     epoch complete!
2024-09-27 17:27:57 INFO     evaluating now!
2024-09-27 17:27:59 INFO     Epoch [0/200] train_loss: 12.7148, val_loss: 10.7463, lr: 0.001000, 21.60s
2024-09-27 17:27:59 INFO     Saved model at 0
2024-09-27 17:27:59 INFO     Val loss decrease from inf to 10.7463, saving to ./libcity/cache/10019/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-27 17:28:18 INFO     epoch complete!
2024-09-27 17:28:18 INFO     evaluating now!
2024-09-27 17:28:20 INFO     Epoch [1/200] train_loss: 9.2737, val_loss: 8.7114, lr: 0.001000, 21.56s
2024-09-27 17:28:20 INFO     Saved model at 1
2024-09-27 17:28:20 INFO     Val loss decrease from 10.7463 to 8.7114, saving to ./libcity/cache/10019/model_cache/GWNET_CHITaxi20190406_epoch1.tar
2024-09-27 17:28:40 INFO     epoch complete!
2024-09-27 17:28:40 INFO     evaluating now!
2024-09-27 17:28:42 INFO     Epoch [2/200] train_loss: 8.5254, val_loss: 9.9255, lr: 0.001000, 21.52s
2024-09-27 17:29:01 INFO     epoch complete!
2024-09-27 17:29:01 INFO     evaluating now!
2024-09-27 17:29:03 INFO     Epoch [3/200] train_loss: 8.0999, val_loss: 7.9370, lr: 0.001000, 21.13s
2024-09-27 17:29:03 INFO     Saved model at 3
2024-09-27 17:29:03 INFO     Val loss decrease from 8.7114 to 7.9370, saving to ./libcity/cache/10019/model_cache/GWNET_CHITaxi20190406_epoch3.tar
2024-09-27 17:29:23 INFO     epoch complete!
2024-09-27 17:29:23 INFO     evaluating now!
2024-09-27 17:29:25 INFO     Epoch [4/200] train_loss: 7.8922, val_loss: 7.5441, lr: 0.001000, 21.15s
2024-09-27 17:29:25 INFO     Saved model at 4
2024-09-27 17:29:25 INFO     Val loss decrease from 7.9370 to 7.5441, saving to ./libcity/cache/10019/model_cache/GWNET_CHITaxi20190406_epoch4.tar
2024-09-27 17:29:44 INFO     epoch complete!
2024-09-27 17:29:44 INFO     evaluating now!
2024-09-27 17:29:46 INFO     Epoch [5/200] train_loss: 7.8484, val_loss: 12.4469, lr: 0.001000, 21.31s
2024-09-27 17:30:05 INFO     epoch complete!
2024-09-27 17:30:05 INFO     evaluating now!
2024-09-27 17:30:07 INFO     Epoch [6/200] train_loss: 7.9974, val_loss: 8.6001, lr: 0.001000, 20.86s
2024-09-27 17:30:26 INFO     epoch complete!
2024-09-27 17:30:26 INFO     evaluating now!
2024-09-27 17:30:28 INFO     Epoch [7/200] train_loss: 7.5793, val_loss: 11.5093, lr: 0.001000, 21.43s
2024-09-27 17:30:48 INFO     epoch complete!
2024-09-27 17:30:48 INFO     evaluating now!
2024-09-27 17:30:50 INFO     Epoch [8/200] train_loss: 7.5374, val_loss: 8.8587, lr: 0.001000, 21.38s
2024-09-27 17:31:09 INFO     epoch complete!
2024-09-27 17:31:09 INFO     evaluating now!
2024-09-27 17:31:11 INFO     Epoch [9/200] train_loss: 7.2073, val_loss: 12.8449, lr: 0.001000, 21.53s
2024-09-27 17:31:31 INFO     epoch complete!
2024-09-27 17:31:31 INFO     evaluating now!
2024-09-27 17:31:33 INFO     Epoch [10/200] train_loss: 6.3055, val_loss: 12.5855, lr: 0.001000, 21.42s
2024-09-27 17:31:52 INFO     epoch complete!
2024-09-27 17:31:52 INFO     evaluating now!
2024-09-27 17:31:54 INFO     Epoch [11/200] train_loss: 6.1949, val_loss: 6.9820, lr: 0.001000, 21.28s
2024-09-27 17:31:54 INFO     Saved model at 11
2024-09-27 17:31:54 INFO     Val loss decrease from 7.5441 to 6.9820, saving to ./libcity/cache/10019/model_cache/GWNET_CHITaxi20190406_epoch11.tar
2024-09-27 17:32:13 INFO     epoch complete!
2024-09-27 17:32:13 INFO     evaluating now!
2024-09-27 17:32:15 INFO     Epoch [12/200] train_loss: 5.7855, val_loss: 6.4252, lr: 0.001000, 21.26s
2024-09-27 17:32:15 INFO     Saved model at 12
2024-09-27 17:32:15 INFO     Val loss decrease from 6.9820 to 6.4252, saving to ./libcity/cache/10019/model_cache/GWNET_CHITaxi20190406_epoch12.tar
2024-09-27 17:32:34 INFO     epoch complete!
2024-09-27 17:32:34 INFO     evaluating now!
2024-09-27 17:32:36 INFO     Epoch [13/200] train_loss: 5.7583, val_loss: 5.6355, lr: 0.001000, 20.90s
2024-09-27 17:32:37 INFO     Saved model at 13
2024-09-27 17:32:37 INFO     Val loss decrease from 6.4252 to 5.6355, saving to ./libcity/cache/10019/model_cache/GWNET_CHITaxi20190406_epoch13.tar
2024-09-27 17:32:55 INFO     epoch complete!
2024-09-27 17:32:55 INFO     evaluating now!
2024-09-27 17:32:58 INFO     Epoch [14/200] train_loss: 5.3123, val_loss: 5.6631, lr: 0.001000, 21.06s
2024-09-27 17:33:17 INFO     epoch complete!
2024-09-27 17:33:17 INFO     evaluating now!
2024-09-27 17:33:19 INFO     Epoch [15/200] train_loss: 5.4662, val_loss: 5.9010, lr: 0.001000, 21.30s
2024-09-27 17:33:38 INFO     epoch complete!
2024-09-27 17:33:38 INFO     evaluating now!
2024-09-27 17:33:40 INFO     Epoch [16/200] train_loss: 5.1704, val_loss: 5.6974, lr: 0.001000, 21.41s
2024-09-27 17:34:00 INFO     epoch complete!
2024-09-27 17:34:00 INFO     evaluating now!
2024-09-27 17:34:02 INFO     Epoch [17/200] train_loss: 5.2414, val_loss: 5.5815, lr: 0.001000, 21.68s
2024-09-27 17:34:02 INFO     Saved model at 17
2024-09-27 17:34:02 INFO     Val loss decrease from 5.6355 to 5.5815, saving to ./libcity/cache/10019/model_cache/GWNET_CHITaxi20190406_epoch17.tar
2024-09-27 17:34:22 INFO     epoch complete!
2024-09-27 17:34:22 INFO     evaluating now!
2024-09-27 17:34:24 INFO     Epoch [18/200] train_loss: 5.1834, val_loss: 5.8019, lr: 0.001000, 21.61s
2024-09-27 17:34:43 INFO     epoch complete!
2024-09-27 17:34:43 INFO     evaluating now!
2024-09-27 17:34:45 INFO     Epoch [19/200] train_loss: 5.2415, val_loss: 7.1243, lr: 0.001000, 21.46s
2024-09-27 17:35:05 INFO     epoch complete!
2024-09-27 17:35:05 INFO     evaluating now!
2024-09-27 17:35:07 INFO     Epoch [20/200] train_loss: 5.1418, val_loss: 6.4799, lr: 0.001000, 21.40s
2024-09-27 17:35:26 INFO     epoch complete!
2024-09-27 17:35:26 INFO     evaluating now!
2024-09-27 17:35:28 INFO     Epoch [21/200] train_loss: 5.0964, val_loss: 6.4144, lr: 0.001000, 21.33s
2024-09-27 17:35:47 INFO     epoch complete!
2024-09-27 17:35:47 INFO     evaluating now!
2024-09-27 17:35:49 INFO     Epoch [22/200] train_loss: 4.9079, val_loss: 5.9378, lr: 0.001000, 21.19s
2024-09-27 17:36:08 INFO     epoch complete!
2024-09-27 17:36:08 INFO     evaluating now!
2024-09-27 17:36:10 INFO     Epoch [23/200] train_loss: 4.9106, val_loss: 5.7368, lr: 0.001000, 21.31s
2024-09-27 17:36:29 INFO     epoch complete!
2024-09-27 17:36:29 INFO     evaluating now!
2024-09-27 17:36:31 INFO     Epoch [24/200] train_loss: 4.8262, val_loss: 5.1493, lr: 0.001000, 20.94s
2024-09-27 17:36:31 INFO     Saved model at 24
2024-09-27 17:36:31 INFO     Val loss decrease from 5.5815 to 5.1493, saving to ./libcity/cache/10019/model_cache/GWNET_CHITaxi20190406_epoch24.tar
2024-09-27 17:36:50 INFO     epoch complete!
2024-09-27 17:36:50 INFO     evaluating now!
2024-09-27 17:36:52 INFO     Epoch [25/200] train_loss: 4.7358, val_loss: 5.6965, lr: 0.001000, 20.85s
2024-09-27 17:37:12 INFO     epoch complete!
2024-09-27 17:37:12 INFO     evaluating now!
2024-09-27 17:37:14 INFO     Epoch [26/200] train_loss: 4.7791, val_loss: 5.8281, lr: 0.001000, 21.27s
2024-09-27 17:37:32 INFO     epoch complete!
2024-09-27 17:37:32 INFO     evaluating now!
2024-09-27 17:37:34 INFO     Epoch [27/200] train_loss: 4.6932, val_loss: 5.3775, lr: 0.001000, 20.87s
2024-09-27 17:37:54 INFO     epoch complete!
2024-09-27 17:37:54 INFO     evaluating now!
2024-09-27 17:37:56 INFO     Epoch [28/200] train_loss: 4.7686, val_loss: 5.9233, lr: 0.001000, 21.52s
2024-09-27 17:38:15 INFO     epoch complete!
2024-09-27 17:38:15 INFO     evaluating now!
2024-09-27 17:38:18 INFO     Epoch [29/200] train_loss: 4.6657, val_loss: 5.4396, lr: 0.001000, 21.60s
2024-09-27 17:38:37 INFO     epoch complete!
2024-09-27 17:38:37 INFO     evaluating now!
2024-09-27 17:38:39 INFO     Epoch [30/200] train_loss: 4.6850, val_loss: 5.2596, lr: 0.001000, 21.56s
2024-09-27 17:38:58 INFO     epoch complete!
2024-09-27 17:38:58 INFO     evaluating now!
2024-09-27 17:39:00 INFO     Epoch [31/200] train_loss: 4.5464, val_loss: 6.2764, lr: 0.001000, 21.27s
2024-09-27 17:39:19 INFO     epoch complete!
2024-09-27 17:39:19 INFO     evaluating now!
2024-09-27 17:39:21 INFO     Epoch [32/200] train_loss: 4.5150, val_loss: 7.8650, lr: 0.001000, 20.86s
2024-09-27 17:39:44 INFO     epoch complete!
2024-09-27 17:39:44 INFO     evaluating now!
2024-09-27 17:39:47 INFO     Epoch [33/200] train_loss: 4.5243, val_loss: 7.0350, lr: 0.001000, 25.89s
2024-09-27 17:40:11 INFO     epoch complete!
2024-09-27 17:40:11 INFO     evaluating now!
2024-09-27 17:40:14 INFO     Epoch [34/200] train_loss: 4.5379, val_loss: 6.0806, lr: 0.001000, 26.98s
2024-09-27 17:40:38 INFO     epoch complete!
2024-09-27 17:40:38 INFO     evaluating now!
2024-09-27 17:40:41 INFO     Epoch [35/200] train_loss: 4.4823, val_loss: 6.9685, lr: 0.001000, 26.84s
2024-09-27 17:41:05 INFO     epoch complete!
2024-09-27 17:41:05 INFO     evaluating now!
2024-09-27 17:41:08 INFO     Epoch [36/200] train_loss: 4.4236, val_loss: 5.4822, lr: 0.001000, 26.98s
2024-09-27 17:41:32 INFO     epoch complete!
2024-09-27 17:41:32 INFO     evaluating now!
2024-09-27 17:41:35 INFO     Epoch [37/200] train_loss: 4.4282, val_loss: 6.3553, lr: 0.001000, 26.87s
2024-09-27 17:41:59 INFO     epoch complete!
2024-09-27 17:41:59 INFO     evaluating now!
2024-09-27 17:42:02 INFO     Epoch [38/200] train_loss: 4.4054, val_loss: 5.4852, lr: 0.001000, 26.96s
2024-09-27 17:42:26 INFO     epoch complete!
2024-09-27 17:42:26 INFO     evaluating now!
2024-09-27 17:42:29 INFO     Epoch [39/200] train_loss: 4.3487, val_loss: 7.0999, lr: 0.001000, 27.00s
2024-09-27 17:42:29 WARNING  Early stopping at epoch: 39
2024-09-27 17:42:29 INFO     Trained totally 40 epochs, average train time is 20.054s, average eval time is 2.203s
2024-09-27 17:42:29 INFO     Loaded model at 24
2024-09-27 17:42:29 INFO     Saved model at ./libcity/cache/10019/model_cache/GWNET_CHITaxi20190406.m
2024-09-27 17:42:29 INFO     Start evaluating ...
2024-09-27 17:42:35 INFO     Note that you select the single mode to evaluate!
2024-09-27 17:42:35 INFO     Evaluate result is saved at ./libcity/cache/10019/evaluate_cache/2024_09_27_17_42_35_GWNET_CHITaxi20190406.csv
2024-09-27 17:42:35 INFO     
         MAE       RMSE  masked_MAPE
1   2.334439   7.089529     0.388812
2   2.496644   8.046011     0.391162
3   2.667666   9.162521     0.392110
4   2.794218   9.769556     0.393849
5   2.918795  10.353758     0.403392
6   3.081375  11.126551     0.408003
7   3.067708  11.521702     0.395478
8   3.120304  11.931484     0.399067
9   3.170085  12.317232     0.393880
10  3.345328  12.562375     0.425243
11  3.393675  12.987165     0.412706
12  3.500504  13.595649     0.426583
2024-09-27 17:42:35 INFO     ----------------------------------------------------------------------------
2024-09-27 17:42:35 INFO     Kownledge Graph Embedding: GIE, Experiment ids: [10015, 10016, 10017, 10018, 10019]
2024-09-27 17:42:35 INFO     ----------------------------------------------------------------------------
2024-09-27 17:42:35 INFO     Average: 
         MAE       RMSE  masked_MAPE
0   2.378971   7.110923     0.387255
1   2.563155   8.115228     0.392047
2   2.751722   9.238457     0.393345
3   2.872193  10.062184     0.388972
4   3.041983  10.959475     0.396625
5   3.181721  11.940061     0.394671
6   3.303693  12.906154     0.404669
7   3.368512  13.550702     0.400481
8   3.421360  13.868855     0.405884
9   3.506557  13.930260     0.419047
10  3.558825  14.005089     0.419950
11  3.645040  14.257213     0.436358 
2024-09-27 17:42:35 INFO     Standard deviation: 
         MAE      RMSE  masked_MAPE
0   0.068318  0.132682     0.017183
1   0.056973  0.182766     0.016351
2   0.077027  0.187430     0.010111
3   0.070651  0.239731     0.009616
4   0.085671  0.536112     0.010776
5   0.072491  0.753251     0.010539
6   0.128655  1.017226     0.008330
7   0.146155  1.172132     0.010653
8   0.139301  1.204801     0.015954
9   0.127480  1.191570     0.016420
10  0.126834  0.975138     0.012301
11  0.077243  0.783106     0.014050
2024-09-27 17:42:35 INFO     ----------------------------------------------------------------------------
2024-09-27 17:42:35 INFO     12 steps Average: 
        MAE      RMSE  masked_MAPE
0  3.132811  11.66205     0.403275
2024-09-27 17:42:35 INFO     12 steps Standard deviation: 
        MAE      RMSE  masked_MAPE
0  0.098067  0.697995      0.01269
