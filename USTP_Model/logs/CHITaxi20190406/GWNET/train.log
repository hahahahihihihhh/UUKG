2024-09-27 21:06:55 INFO     Saving logs in: ./logs/CHITaxi20190406/GWNET/
2024-09-27 21:06:55 INFO     ----------------------------------------------------------------------------
2024-09-27 21:06:55 INFO     # 0, Kownledge Graph Embedding: None, Experiment ids: 100
2024-09-27 21:06:55 INFO     ----------------------------------------------------------------------------
2024-09-27 21:06:55 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=100
2024-09-27 21:06:55 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 100, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-27 21:06:56 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-27 21:06:56 INFO     set_weight_link_or_dist: dist
2024-09-27 21:06:56 INFO     init_weight_inf_or_zero: inf
2024-09-27 21:06:56 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-27 21:06:56 INFO     Start Calculate the weight by Gauss kernel!
2024-09-27 21:06:56 INFO     Loading file CHITaxi20190406.dyna
2024-09-27 21:06:56 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-27 21:06:56 INFO     Dataset created
2024-09-27 21:06:56 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-27 21:06:56 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-27 21:06:56 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-27 21:06:56 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-27 21:06:56 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-27 21:06:56 INFO     NoneScaler
2024-09-27 21:07:00 INFO     add adj_mx to supports
2024-09-27 21:07:00 INFO     add apt_adj(v1 * v2) in forward process
2024-09-27 21:07:00 INFO     receptive_field: 14
2024-09-27 21:07:02 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(2, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-27 21:07:02 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-27 21:07:02 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-27 21:07:02 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:07:02 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:07:02 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:07:02 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:07:02 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:07:02 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:07:02 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:07:02 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:07:02 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:07:02 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:07:02 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:07:02 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:07:02 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:07:02 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:07:02 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:07:02 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:07:02 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:07:02 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:07:02 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:07:02 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:07:02 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:07:02 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:07:02 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:07:02 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:07:02 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     start_conv.weight	torch.Size([32, 2, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:07:02 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-27 21:07:02 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-27 21:07:02 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-27 21:07:02 INFO     Total parameter numbers: 306800
2024-09-27 21:07:02 INFO     You select `adam` optimizer.
2024-09-27 21:07:02 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-27 21:07:02 INFO     Start training ...
2024-09-27 21:07:02 INFO     num_batches:96
2024-09-27 21:07:21 INFO     epoch complete!
2024-09-27 21:07:21 INFO     evaluating now!
2024-09-27 21:07:23 INFO     Epoch [0/200] train_loss: 12.3390, val_loss: 10.6498, lr: 0.001000, 21.49s
2024-09-27 21:07:23 INFO     Saved model at 0
2024-09-27 21:07:23 INFO     Val loss decrease from inf to 10.6498, saving to ./libcity/cache/100/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-27 21:07:42 INFO     epoch complete!
2024-09-27 21:07:42 INFO     evaluating now!
2024-09-27 21:07:45 INFO     Epoch [1/200] train_loss: 9.3299, val_loss: 8.8007, lr: 0.001000, 21.28s
2024-09-27 21:07:45 INFO     Saved model at 1
2024-09-27 21:07:45 INFO     Val loss decrease from 10.6498 to 8.8007, saving to ./libcity/cache/100/model_cache/GWNET_CHITaxi20190406_epoch1.tar
2024-09-27 21:08:04 INFO     epoch complete!
2024-09-27 21:08:04 INFO     evaluating now!
2024-09-27 21:08:06 INFO     Epoch [2/200] train_loss: 8.5216, val_loss: 8.1592, lr: 0.001000, 20.92s
2024-09-27 21:08:06 INFO     Saved model at 2
2024-09-27 21:08:06 INFO     Val loss decrease from 8.8007 to 8.1592, saving to ./libcity/cache/100/model_cache/GWNET_CHITaxi20190406_epoch2.tar
2024-09-27 21:08:25 INFO     epoch complete!
2024-09-27 21:08:25 INFO     evaluating now!
2024-09-27 21:08:27 INFO     Epoch [3/200] train_loss: 8.2006, val_loss: 8.5225, lr: 0.001000, 21.16s
2024-09-27 21:08:46 INFO     epoch complete!
2024-09-27 21:08:46 INFO     evaluating now!
2024-09-27 21:08:48 INFO     Epoch [4/200] train_loss: 7.8554, val_loss: 9.1567, lr: 0.001000, 21.10s
2024-09-27 21:09:07 INFO     epoch complete!
2024-09-27 21:09:07 INFO     evaluating now!
2024-09-27 21:09:09 INFO     Epoch [5/200] train_loss: 7.6049, val_loss: 7.5449, lr: 0.001000, 21.20s
2024-09-27 21:09:10 INFO     Saved model at 5
2024-09-27 21:09:10 INFO     Val loss decrease from 8.1592 to 7.5449, saving to ./libcity/cache/100/model_cache/GWNET_CHITaxi20190406_epoch5.tar
2024-09-27 21:09:29 INFO     epoch complete!
2024-09-27 21:09:29 INFO     evaluating now!
2024-09-27 21:09:31 INFO     Epoch [6/200] train_loss: 7.5616, val_loss: 8.5149, lr: 0.001000, 21.17s
2024-09-27 21:09:50 INFO     epoch complete!
2024-09-27 21:09:50 INFO     evaluating now!
2024-09-27 21:09:52 INFO     Epoch [7/200] train_loss: 7.4276, val_loss: 7.6303, lr: 0.001000, 21.14s
2024-09-27 21:10:11 INFO     epoch complete!
2024-09-27 21:10:11 INFO     evaluating now!
2024-09-27 21:10:13 INFO     Epoch [8/200] train_loss: 7.2738, val_loss: 7.2919, lr: 0.001000, 21.08s
2024-09-27 21:10:13 INFO     Saved model at 8
2024-09-27 21:10:13 INFO     Val loss decrease from 7.5449 to 7.2919, saving to ./libcity/cache/100/model_cache/GWNET_CHITaxi20190406_epoch8.tar
2024-09-27 21:10:32 INFO     epoch complete!
2024-09-27 21:10:32 INFO     evaluating now!
2024-09-27 21:10:34 INFO     Epoch [9/200] train_loss: 6.7306, val_loss: 7.6400, lr: 0.001000, 21.02s
2024-09-27 21:10:53 INFO     epoch complete!
2024-09-27 21:10:53 INFO     evaluating now!
2024-09-27 21:10:55 INFO     Epoch [10/200] train_loss: 5.9798, val_loss: 6.1404, lr: 0.001000, 21.14s
2024-09-27 21:10:56 INFO     Saved model at 10
2024-09-27 21:10:56 INFO     Val loss decrease from 7.2919 to 6.1404, saving to ./libcity/cache/100/model_cache/GWNET_CHITaxi20190406_epoch10.tar
2024-09-27 21:11:15 INFO     epoch complete!
2024-09-27 21:11:15 INFO     evaluating now!
2024-09-27 21:11:17 INFO     Epoch [11/200] train_loss: 5.6603, val_loss: 6.1567, lr: 0.001000, 21.08s
2024-09-27 21:11:36 INFO     epoch complete!
2024-09-27 21:11:36 INFO     evaluating now!
2024-09-27 21:11:38 INFO     Epoch [12/200] train_loss: 5.6720, val_loss: 9.9473, lr: 0.001000, 21.07s
2024-09-27 21:11:57 INFO     epoch complete!
2024-09-27 21:11:57 INFO     evaluating now!
2024-09-27 21:11:59 INFO     Epoch [13/200] train_loss: 5.3729, val_loss: 6.0747, lr: 0.001000, 21.21s
2024-09-27 21:11:59 INFO     Saved model at 13
2024-09-27 21:11:59 INFO     Val loss decrease from 6.1404 to 6.0747, saving to ./libcity/cache/100/model_cache/GWNET_CHITaxi20190406_epoch13.tar
2024-09-27 21:12:18 INFO     epoch complete!
2024-09-27 21:12:18 INFO     evaluating now!
2024-09-27 21:12:21 INFO     Epoch [14/200] train_loss: 5.3794, val_loss: 5.9443, lr: 0.001000, 21.22s
2024-09-27 21:12:21 INFO     Saved model at 14
2024-09-27 21:12:21 INFO     Val loss decrease from 6.0747 to 5.9443, saving to ./libcity/cache/100/model_cache/GWNET_CHITaxi20190406_epoch14.tar
2024-09-27 21:12:40 INFO     epoch complete!
2024-09-27 21:12:40 INFO     evaluating now!
2024-09-27 21:12:42 INFO     Epoch [15/200] train_loss: 5.1485, val_loss: 5.3458, lr: 0.001000, 21.11s
2024-09-27 21:12:42 INFO     Saved model at 15
2024-09-27 21:12:42 INFO     Val loss decrease from 5.9443 to 5.3458, saving to ./libcity/cache/100/model_cache/GWNET_CHITaxi20190406_epoch15.tar
2024-09-27 21:13:01 INFO     epoch complete!
2024-09-27 21:13:01 INFO     evaluating now!
2024-09-27 21:13:03 INFO     Epoch [16/200] train_loss: 5.0275, val_loss: 5.5614, lr: 0.001000, 21.25s
2024-09-27 21:13:22 INFO     epoch complete!
2024-09-27 21:13:22 INFO     evaluating now!
2024-09-27 21:13:25 INFO     Epoch [17/200] train_loss: 5.0151, val_loss: 5.5467, lr: 0.001000, 21.29s
2024-09-27 21:13:44 INFO     epoch complete!
2024-09-27 21:13:44 INFO     evaluating now!
2024-09-27 21:13:46 INFO     Epoch [18/200] train_loss: 5.0672, val_loss: 5.8314, lr: 0.001000, 21.14s
2024-09-27 21:14:05 INFO     epoch complete!
2024-09-27 21:14:05 INFO     evaluating now!
2024-09-27 21:14:07 INFO     Epoch [19/200] train_loss: 5.0043, val_loss: 5.3720, lr: 0.001000, 21.08s
2024-09-27 21:14:26 INFO     epoch complete!
2024-09-27 21:14:26 INFO     evaluating now!
2024-09-27 21:14:28 INFO     Epoch [20/200] train_loss: 4.8261, val_loss: 5.3461, lr: 0.001000, 20.98s
2024-09-27 21:14:47 INFO     epoch complete!
2024-09-27 21:14:47 INFO     evaluating now!
2024-09-27 21:14:49 INFO     Epoch [21/200] train_loss: 4.7744, val_loss: 5.4946, lr: 0.001000, 21.07s
2024-09-27 21:15:08 INFO     epoch complete!
2024-09-27 21:15:08 INFO     evaluating now!
2024-09-27 21:15:10 INFO     Epoch [22/200] train_loss: 4.7686, val_loss: 5.8932, lr: 0.001000, 20.97s
2024-09-27 21:15:29 INFO     epoch complete!
2024-09-27 21:15:29 INFO     evaluating now!
2024-09-27 21:15:31 INFO     Epoch [23/200] train_loss: 4.7638, val_loss: 7.7180, lr: 0.001000, 21.18s
2024-09-27 21:15:50 INFO     epoch complete!
2024-09-27 21:15:50 INFO     evaluating now!
2024-09-27 21:15:52 INFO     Epoch [24/200] train_loss: 4.5952, val_loss: 7.0149, lr: 0.001000, 21.20s
2024-09-27 21:16:11 INFO     epoch complete!
2024-09-27 21:16:11 INFO     evaluating now!
2024-09-27 21:16:13 INFO     Epoch [25/200] train_loss: 4.6201, val_loss: 5.6565, lr: 0.001000, 21.13s
2024-09-27 21:16:32 INFO     epoch complete!
2024-09-27 21:16:32 INFO     evaluating now!
2024-09-27 21:16:34 INFO     Epoch [26/200] train_loss: 4.5641, val_loss: 5.3782, lr: 0.001000, 21.18s
2024-09-27 21:16:54 INFO     epoch complete!
2024-09-27 21:16:54 INFO     evaluating now!
2024-09-27 21:16:56 INFO     Epoch [27/200] train_loss: 4.5170, val_loss: 5.3112, lr: 0.001000, 21.11s
2024-09-27 21:16:56 INFO     Saved model at 27
2024-09-27 21:16:56 INFO     Val loss decrease from 5.3458 to 5.3112, saving to ./libcity/cache/100/model_cache/GWNET_CHITaxi20190406_epoch27.tar
2024-09-27 21:17:15 INFO     epoch complete!
2024-09-27 21:17:15 INFO     evaluating now!
2024-09-27 21:17:17 INFO     Epoch [28/200] train_loss: 4.5308, val_loss: 5.0801, lr: 0.001000, 21.07s
2024-09-27 21:17:17 INFO     Saved model at 28
2024-09-27 21:17:17 INFO     Val loss decrease from 5.3112 to 5.0801, saving to ./libcity/cache/100/model_cache/GWNET_CHITaxi20190406_epoch28.tar
2024-09-27 21:17:36 INFO     epoch complete!
2024-09-27 21:17:36 INFO     evaluating now!
2024-09-27 21:17:38 INFO     Epoch [29/200] train_loss: 4.4741, val_loss: 5.2798, lr: 0.001000, 20.90s
2024-09-27 21:17:57 INFO     epoch complete!
2024-09-27 21:17:57 INFO     evaluating now!
2024-09-27 21:17:59 INFO     Epoch [30/200] train_loss: 4.5174, val_loss: 6.2384, lr: 0.001000, 21.13s
2024-09-27 21:18:18 INFO     epoch complete!
2024-09-27 21:18:18 INFO     evaluating now!
2024-09-27 21:18:20 INFO     Epoch [31/200] train_loss: 4.4235, val_loss: 6.1452, lr: 0.001000, 21.25s
2024-09-27 21:18:39 INFO     epoch complete!
2024-09-27 21:18:39 INFO     evaluating now!
2024-09-27 21:18:41 INFO     Epoch [32/200] train_loss: 4.4316, val_loss: 5.0685, lr: 0.001000, 21.23s
2024-09-27 21:18:42 INFO     Saved model at 32
2024-09-27 21:18:42 INFO     Val loss decrease from 5.0801 to 5.0685, saving to ./libcity/cache/100/model_cache/GWNET_CHITaxi20190406_epoch32.tar
2024-09-27 21:19:01 INFO     epoch complete!
2024-09-27 21:19:01 INFO     evaluating now!
2024-09-27 21:19:03 INFO     Epoch [33/200] train_loss: 4.3355, val_loss: 5.3006, lr: 0.001000, 21.11s
2024-09-27 21:19:22 INFO     epoch complete!
2024-09-27 21:19:22 INFO     evaluating now!
2024-09-27 21:19:24 INFO     Epoch [34/200] train_loss: 4.3321, val_loss: 4.9107, lr: 0.001000, 20.93s
2024-09-27 21:19:24 INFO     Saved model at 34
2024-09-27 21:19:24 INFO     Val loss decrease from 5.0685 to 4.9107, saving to ./libcity/cache/100/model_cache/GWNET_CHITaxi20190406_epoch34.tar
2024-09-27 21:19:43 INFO     epoch complete!
2024-09-27 21:19:43 INFO     evaluating now!
2024-09-27 21:19:45 INFO     Epoch [35/200] train_loss: 4.3455, val_loss: 5.4050, lr: 0.001000, 21.02s
2024-09-27 21:20:04 INFO     epoch complete!
2024-09-27 21:20:04 INFO     evaluating now!
2024-09-27 21:20:06 INFO     Epoch [36/200] train_loss: 4.2886, val_loss: 5.0019, lr: 0.001000, 20.88s
2024-09-27 21:20:25 INFO     epoch complete!
2024-09-27 21:20:25 INFO     evaluating now!
2024-09-27 21:20:27 INFO     Epoch [37/200] train_loss: 4.2867, val_loss: 5.5357, lr: 0.001000, 21.03s
2024-09-27 21:20:46 INFO     epoch complete!
2024-09-27 21:20:46 INFO     evaluating now!
2024-09-27 21:20:48 INFO     Epoch [38/200] train_loss: 4.2158, val_loss: 5.2857, lr: 0.001000, 20.98s
2024-09-27 21:21:07 INFO     epoch complete!
2024-09-27 21:21:07 INFO     evaluating now!
2024-09-27 21:21:09 INFO     Epoch [39/200] train_loss: 4.2376, val_loss: 5.3174, lr: 0.001000, 21.11s
2024-09-27 21:21:28 INFO     epoch complete!
2024-09-27 21:21:28 INFO     evaluating now!
2024-09-27 21:21:30 INFO     Epoch [40/200] train_loss: 4.2593, val_loss: 5.6211, lr: 0.001000, 21.19s
2024-09-27 21:21:49 INFO     epoch complete!
2024-09-27 21:21:49 INFO     evaluating now!
2024-09-27 21:21:51 INFO     Epoch [41/200] train_loss: 4.2105, val_loss: 4.9716, lr: 0.001000, 20.79s
2024-09-27 21:22:10 INFO     epoch complete!
2024-09-27 21:22:10 INFO     evaluating now!
2024-09-27 21:22:12 INFO     Epoch [42/200] train_loss: 4.1920, val_loss: 5.0089, lr: 0.001000, 21.08s
2024-09-27 21:22:31 INFO     epoch complete!
2024-09-27 21:22:31 INFO     evaluating now!
2024-09-27 21:22:33 INFO     Epoch [43/200] train_loss: 4.1904, val_loss: 5.0000, lr: 0.001000, 20.81s
2024-09-27 21:22:52 INFO     epoch complete!
2024-09-27 21:22:52 INFO     evaluating now!
2024-09-27 21:22:54 INFO     Epoch [44/200] train_loss: 4.1546, val_loss: 5.0054, lr: 0.001000, 21.08s
2024-09-27 21:23:13 INFO     epoch complete!
2024-09-27 21:23:13 INFO     evaluating now!
2024-09-27 21:23:15 INFO     Epoch [45/200] train_loss: 4.1175, val_loss: 4.9109, lr: 0.001000, 21.09s
2024-09-27 21:23:34 INFO     epoch complete!
2024-09-27 21:23:34 INFO     evaluating now!
2024-09-27 21:23:36 INFO     Epoch [46/200] train_loss: 4.1055, val_loss: 5.5226, lr: 0.001000, 21.01s
2024-09-27 21:23:55 INFO     epoch complete!
2024-09-27 21:23:55 INFO     evaluating now!
2024-09-27 21:23:57 INFO     Epoch [47/200] train_loss: 4.0839, val_loss: 5.6989, lr: 0.001000, 21.00s
2024-09-27 21:24:16 INFO     epoch complete!
2024-09-27 21:24:16 INFO     evaluating now!
2024-09-27 21:24:18 INFO     Epoch [48/200] train_loss: 4.1093, val_loss: 5.1843, lr: 0.001000, 20.76s
2024-09-27 21:24:37 INFO     epoch complete!
2024-09-27 21:24:37 INFO     evaluating now!
2024-09-27 21:24:39 INFO     Epoch [49/200] train_loss: 4.1068, val_loss: 5.1494, lr: 0.001000, 21.05s
2024-09-27 21:24:39 WARNING  Early stopping at epoch: 49
2024-09-27 21:24:39 INFO     Trained totally 50 epochs, average train time is 19.042s, average eval time is 2.048s
2024-09-27 21:24:39 INFO     Loaded model at 34
2024-09-27 21:24:39 INFO     Saved model at ./libcity/cache/100/model_cache/GWNET_CHITaxi20190406.m
2024-09-27 21:24:39 INFO     Start evaluating ...
2024-09-27 21:24:44 INFO     Note that you select the single mode to evaluate!
2024-09-27 21:24:44 INFO     Evaluate result is saved at ./libcity/cache/100/evaluate_cache/2024_09_27_21_24_44_GWNET_CHITaxi20190406.csv
2024-09-27 21:24:44 INFO     
         MAE       RMSE  masked_MAPE
1   2.503139   7.751454     0.391358
2   2.572186   8.323482     0.383322
3   2.686345   9.029162     0.385938
4   2.871137   9.923868     0.393526
5   2.938027  10.566954     0.400427
6   3.027129  11.042422     0.398151
7   3.132025  11.849757     0.409820
8   3.241955  12.310979     0.410647
9   3.230211  12.238692     0.403814
10  3.284522  12.370045     0.414937
11  3.339011  12.725085     0.416633
12  3.441969  13.298855     0.428593
2024-09-27 21:24:44 INFO     ----------------------------------------------------------------------------
2024-09-27 21:24:44 INFO     # 1, Kownledge Graph Embedding: None, Experiment ids: 101
2024-09-27 21:24:44 INFO     ----------------------------------------------------------------------------
2024-09-27 21:24:44 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=101
2024-09-27 21:24:44 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 101, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 1, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-27 21:24:44 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-27 21:24:45 INFO     set_weight_link_or_dist: dist
2024-09-27 21:24:45 INFO     init_weight_inf_or_zero: inf
2024-09-27 21:24:45 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-27 21:24:45 INFO     Start Calculate the weight by Gauss kernel!
2024-09-27 21:24:45 INFO     Loading file CHITaxi20190406.dyna
2024-09-27 21:24:45 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-27 21:24:45 INFO     Dataset created
2024-09-27 21:24:45 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-27 21:24:45 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-27 21:24:45 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-27 21:24:45 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-27 21:24:45 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-27 21:24:45 INFO     NoneScaler
2024-09-27 21:24:45 INFO     add adj_mx to supports
2024-09-27 21:24:45 INFO     add apt_adj(v1 * v2) in forward process
2024-09-27 21:24:45 INFO     receptive_field: 14
2024-09-27 21:24:45 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(2, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-27 21:24:45 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-27 21:24:45 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-27 21:24:45 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:24:45 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:24:45 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:24:45 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:24:45 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:24:45 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:24:45 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:24:45 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:24:45 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:24:45 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:24:45 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:24:45 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:24:45 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:24:45 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:24:45 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:24:45 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:24:45 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:24:45 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:24:45 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:24:45 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:24:45 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:24:45 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:24:45 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:24:45 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:24:45 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     start_conv.weight	torch.Size([32, 2, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:24:45 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-27 21:24:45 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-27 21:24:45 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-27 21:24:45 INFO     Total parameter numbers: 306800
2024-09-27 21:24:45 INFO     You select `adam` optimizer.
2024-09-27 21:24:45 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-27 21:24:45 INFO     Start training ...
2024-09-27 21:24:45 INFO     num_batches:96
2024-09-27 21:25:04 INFO     epoch complete!
2024-09-27 21:25:04 INFO     evaluating now!
2024-09-27 21:25:06 INFO     Epoch [0/200] train_loss: 12.5553, val_loss: 10.6113, lr: 0.001000, 20.48s
2024-09-27 21:25:06 INFO     Saved model at 0
2024-09-27 21:25:06 INFO     Val loss decrease from inf to 10.6113, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-27 21:25:24 INFO     epoch complete!
2024-09-27 21:25:24 INFO     evaluating now!
2024-09-27 21:25:26 INFO     Epoch [1/200] train_loss: 9.2322, val_loss: 15.4083, lr: 0.001000, 20.39s
2024-09-27 21:25:45 INFO     epoch complete!
2024-09-27 21:25:45 INFO     evaluating now!
2024-09-27 21:25:47 INFO     Epoch [2/200] train_loss: 8.4925, val_loss: 8.4569, lr: 0.001000, 20.30s
2024-09-27 21:25:47 INFO     Saved model at 2
2024-09-27 21:25:47 INFO     Val loss decrease from 10.6113 to 8.4569, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch2.tar
2024-09-27 21:26:05 INFO     epoch complete!
2024-09-27 21:26:05 INFO     evaluating now!
2024-09-27 21:26:07 INFO     Epoch [3/200] train_loss: 7.9661, val_loss: 8.1506, lr: 0.001000, 20.47s
2024-09-27 21:26:07 INFO     Saved model at 3
2024-09-27 21:26:07 INFO     Val loss decrease from 8.4569 to 8.1506, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch3.tar
2024-09-27 21:26:26 INFO     epoch complete!
2024-09-27 21:26:26 INFO     evaluating now!
2024-09-27 21:26:28 INFO     Epoch [4/200] train_loss: 7.7786, val_loss: 8.6969, lr: 0.001000, 20.34s
2024-09-27 21:26:46 INFO     epoch complete!
2024-09-27 21:26:46 INFO     evaluating now!
2024-09-27 21:26:48 INFO     Epoch [5/200] train_loss: 7.5834, val_loss: 7.8554, lr: 0.001000, 20.74s
2024-09-27 21:26:49 INFO     Saved model at 5
2024-09-27 21:26:49 INFO     Val loss decrease from 8.1506 to 7.8554, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch5.tar
2024-09-27 21:27:11 INFO     epoch complete!
2024-09-27 21:27:11 INFO     evaluating now!
2024-09-27 21:27:14 INFO     Epoch [6/200] train_loss: 7.6626, val_loss: 7.7420, lr: 0.001000, 25.01s
2024-09-27 21:27:14 INFO     Saved model at 6
2024-09-27 21:27:14 INFO     Val loss decrease from 7.8554 to 7.7420, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch6.tar
2024-09-27 21:27:32 INFO     epoch complete!
2024-09-27 21:27:32 INFO     evaluating now!
2024-09-27 21:27:34 INFO     Epoch [7/200] train_loss: 7.5663, val_loss: 7.4509, lr: 0.001000, 20.45s
2024-09-27 21:27:34 INFO     Saved model at 7
2024-09-27 21:27:34 INFO     Val loss decrease from 7.7420 to 7.4509, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch7.tar
2024-09-27 21:27:53 INFO     epoch complete!
2024-09-27 21:27:53 INFO     evaluating now!
2024-09-27 21:27:55 INFO     Epoch [8/200] train_loss: 7.3351, val_loss: 8.7865, lr: 0.001000, 20.53s
2024-09-27 21:28:14 INFO     epoch complete!
2024-09-27 21:28:14 INFO     evaluating now!
2024-09-27 21:28:16 INFO     Epoch [9/200] train_loss: 7.2633, val_loss: 8.9761, lr: 0.001000, 20.72s
2024-09-27 21:28:34 INFO     epoch complete!
2024-09-27 21:28:34 INFO     evaluating now!
2024-09-27 21:28:36 INFO     Epoch [10/200] train_loss: 7.1365, val_loss: 7.6286, lr: 0.001000, 20.70s
2024-09-27 21:28:55 INFO     epoch complete!
2024-09-27 21:28:55 INFO     evaluating now!
2024-09-27 21:28:57 INFO     Epoch [11/200] train_loss: 6.7701, val_loss: 8.2487, lr: 0.001000, 20.19s
2024-09-27 21:29:15 INFO     epoch complete!
2024-09-27 21:29:15 INFO     evaluating now!
2024-09-27 21:29:17 INFO     Epoch [12/200] train_loss: 5.8901, val_loss: 6.2665, lr: 0.001000, 20.50s
2024-09-27 21:29:17 INFO     Saved model at 12
2024-09-27 21:29:17 INFO     Val loss decrease from 7.4509 to 6.2665, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch12.tar
2024-09-27 21:29:36 INFO     epoch complete!
2024-09-27 21:29:36 INFO     evaluating now!
2024-09-27 21:29:38 INFO     Epoch [13/200] train_loss: 5.6070, val_loss: 6.2210, lr: 0.001000, 20.35s
2024-09-27 21:29:38 INFO     Saved model at 13
2024-09-27 21:29:38 INFO     Val loss decrease from 6.2665 to 6.2210, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch13.tar
2024-09-27 21:29:56 INFO     epoch complete!
2024-09-27 21:29:56 INFO     evaluating now!
2024-09-27 21:29:58 INFO     Epoch [14/200] train_loss: 5.3740, val_loss: 5.6537, lr: 0.001000, 20.70s
2024-09-27 21:29:59 INFO     Saved model at 14
2024-09-27 21:29:59 INFO     Val loss decrease from 6.2210 to 5.6537, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch14.tar
2024-09-27 21:30:17 INFO     epoch complete!
2024-09-27 21:30:17 INFO     evaluating now!
2024-09-27 21:30:19 INFO     Epoch [15/200] train_loss: 5.3454, val_loss: 6.7477, lr: 0.001000, 20.25s
2024-09-27 21:30:37 INFO     epoch complete!
2024-09-27 21:30:37 INFO     evaluating now!
2024-09-27 21:30:39 INFO     Epoch [16/200] train_loss: 5.2006, val_loss: 8.2146, lr: 0.001000, 20.65s
2024-09-27 21:30:58 INFO     epoch complete!
2024-09-27 21:30:58 INFO     evaluating now!
2024-09-27 21:31:00 INFO     Epoch [17/200] train_loss: 5.1844, val_loss: 5.5890, lr: 0.001000, 20.60s
2024-09-27 21:31:00 INFO     Saved model at 17
2024-09-27 21:31:00 INFO     Val loss decrease from 5.6537 to 5.5890, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch17.tar
2024-09-27 21:31:19 INFO     epoch complete!
2024-09-27 21:31:19 INFO     evaluating now!
2024-09-27 21:31:21 INFO     Epoch [18/200] train_loss: 5.1438, val_loss: 6.2486, lr: 0.001000, 20.61s
2024-09-27 21:31:40 INFO     epoch complete!
2024-09-27 21:31:40 INFO     evaluating now!
2024-09-27 21:31:42 INFO     Epoch [19/200] train_loss: 5.0139, val_loss: 5.6561, lr: 0.001000, 20.84s
2024-09-27 21:32:00 INFO     epoch complete!
2024-09-27 21:32:00 INFO     evaluating now!
2024-09-27 21:32:02 INFO     Epoch [20/200] train_loss: 4.8723, val_loss: 5.4712, lr: 0.001000, 20.75s
2024-09-27 21:32:03 INFO     Saved model at 20
2024-09-27 21:32:03 INFO     Val loss decrease from 5.5890 to 5.4712, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch20.tar
2024-09-27 21:32:21 INFO     epoch complete!
2024-09-27 21:32:21 INFO     evaluating now!
2024-09-27 21:32:23 INFO     Epoch [21/200] train_loss: 4.8772, val_loss: 5.2184, lr: 0.001000, 20.38s
2024-09-27 21:32:23 INFO     Saved model at 21
2024-09-27 21:32:23 INFO     Val loss decrease from 5.4712 to 5.2184, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch21.tar
2024-09-27 21:32:41 INFO     epoch complete!
2024-09-27 21:32:41 INFO     evaluating now!
2024-09-27 21:32:43 INFO     Epoch [22/200] train_loss: 4.8709, val_loss: 5.8544, lr: 0.001000, 20.44s
2024-09-27 21:33:02 INFO     epoch complete!
2024-09-27 21:33:02 INFO     evaluating now!
2024-09-27 21:33:04 INFO     Epoch [23/200] train_loss: 4.7707, val_loss: 6.0017, lr: 0.001000, 20.23s
2024-09-27 21:33:21 INFO     epoch complete!
2024-09-27 21:33:21 INFO     evaluating now!
2024-09-27 21:33:23 INFO     Epoch [24/200] train_loss: 4.8497, val_loss: 5.2984, lr: 0.001000, 19.33s
2024-09-27 21:33:41 INFO     epoch complete!
2024-09-27 21:33:41 INFO     evaluating now!
2024-09-27 21:33:42 INFO     Epoch [25/200] train_loss: 4.6896, val_loss: 5.6485, lr: 0.001000, 19.41s
2024-09-27 21:34:00 INFO     epoch complete!
2024-09-27 21:34:00 INFO     evaluating now!
2024-09-27 21:34:02 INFO     Epoch [26/200] train_loss: 4.7215, val_loss: 5.8754, lr: 0.001000, 19.07s
2024-09-27 21:34:19 INFO     epoch complete!
2024-09-27 21:34:19 INFO     evaluating now!
2024-09-27 21:34:21 INFO     Epoch [27/200] train_loss: 4.7170, val_loss: 5.1705, lr: 0.001000, 19.28s
2024-09-27 21:34:21 INFO     Saved model at 27
2024-09-27 21:34:21 INFO     Val loss decrease from 5.2184 to 5.1705, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch27.tar
2024-09-27 21:34:38 INFO     epoch complete!
2024-09-27 21:34:38 INFO     evaluating now!
2024-09-27 21:34:40 INFO     Epoch [28/200] train_loss: 4.6243, val_loss: 5.1316, lr: 0.001000, 19.13s
2024-09-27 21:34:40 INFO     Saved model at 28
2024-09-27 21:34:40 INFO     Val loss decrease from 5.1705 to 5.1316, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch28.tar
2024-09-27 21:34:57 INFO     epoch complete!
2024-09-27 21:34:57 INFO     evaluating now!
2024-09-27 21:34:59 INFO     Epoch [29/200] train_loss: 4.5763, val_loss: 6.1882, lr: 0.001000, 19.07s
2024-09-27 21:35:16 INFO     epoch complete!
2024-09-27 21:35:16 INFO     evaluating now!
2024-09-27 21:35:18 INFO     Epoch [30/200] train_loss: 4.5392, val_loss: 5.3181, lr: 0.001000, 18.96s
2024-09-27 21:35:35 INFO     epoch complete!
2024-09-27 21:35:35 INFO     evaluating now!
2024-09-27 21:35:37 INFO     Epoch [31/200] train_loss: 4.4983, val_loss: 5.1711, lr: 0.001000, 18.97s
2024-09-27 21:35:55 INFO     epoch complete!
2024-09-27 21:35:55 INFO     evaluating now!
2024-09-27 21:35:57 INFO     Epoch [32/200] train_loss: 4.4560, val_loss: 5.5877, lr: 0.001000, 19.98s
2024-09-27 21:36:15 INFO     epoch complete!
2024-09-27 21:36:15 INFO     evaluating now!
2024-09-27 21:36:17 INFO     Epoch [33/200] train_loss: 4.4746, val_loss: 5.6712, lr: 0.001000, 19.82s
2024-09-27 21:36:35 INFO     epoch complete!
2024-09-27 21:36:35 INFO     evaluating now!
2024-09-27 21:36:37 INFO     Epoch [34/200] train_loss: 4.4781, val_loss: 5.1257, lr: 0.001000, 19.91s
2024-09-27 21:36:37 INFO     Saved model at 34
2024-09-27 21:36:37 INFO     Val loss decrease from 5.1316 to 5.1257, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch34.tar
2024-09-27 21:36:55 INFO     epoch complete!
2024-09-27 21:36:55 INFO     evaluating now!
2024-09-27 21:36:57 INFO     Epoch [35/200] train_loss: 4.4356, val_loss: 5.1881, lr: 0.001000, 19.71s
2024-09-27 21:37:14 INFO     epoch complete!
2024-09-27 21:37:14 INFO     evaluating now!
2024-09-27 21:37:16 INFO     Epoch [36/200] train_loss: 4.3800, val_loss: 5.3351, lr: 0.001000, 19.05s
2024-09-27 21:37:34 INFO     epoch complete!
2024-09-27 21:37:34 INFO     evaluating now!
2024-09-27 21:37:36 INFO     Epoch [37/200] train_loss: 4.3088, val_loss: 5.1363, lr: 0.001000, 19.61s
2024-09-27 21:37:54 INFO     epoch complete!
2024-09-27 21:37:54 INFO     evaluating now!
2024-09-27 21:37:56 INFO     Epoch [38/200] train_loss: 4.3793, val_loss: 5.0954, lr: 0.001000, 20.08s
2024-09-27 21:37:56 INFO     Saved model at 38
2024-09-27 21:37:56 INFO     Val loss decrease from 5.1257 to 5.0954, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch38.tar
2024-09-27 21:38:14 INFO     epoch complete!
2024-09-27 21:38:14 INFO     evaluating now!
2024-09-27 21:38:16 INFO     Epoch [39/200] train_loss: 4.3163, val_loss: 5.1788, lr: 0.001000, 20.41s
2024-09-27 21:38:34 INFO     epoch complete!
2024-09-27 21:38:34 INFO     evaluating now!
2024-09-27 21:38:36 INFO     Epoch [40/200] train_loss: 4.3235, val_loss: 5.3274, lr: 0.001000, 20.03s
2024-09-27 21:38:54 INFO     epoch complete!
2024-09-27 21:38:54 INFO     evaluating now!
2024-09-27 21:38:56 INFO     Epoch [41/200] train_loss: 4.3107, val_loss: 5.1321, lr: 0.001000, 19.63s
2024-09-27 21:39:14 INFO     epoch complete!
2024-09-27 21:39:14 INFO     evaluating now!
2024-09-27 21:39:16 INFO     Epoch [42/200] train_loss: 4.2414, val_loss: 5.7330, lr: 0.001000, 20.13s
2024-09-27 21:39:34 INFO     epoch complete!
2024-09-27 21:39:34 INFO     evaluating now!
2024-09-27 21:39:36 INFO     Epoch [43/200] train_loss: 4.2436, val_loss: 5.2690, lr: 0.001000, 19.73s
2024-09-27 21:39:54 INFO     epoch complete!
2024-09-27 21:39:54 INFO     evaluating now!
2024-09-27 21:39:56 INFO     Epoch [44/200] train_loss: 4.1583, val_loss: 5.2943, lr: 0.001000, 20.12s
2024-09-27 21:40:14 INFO     epoch complete!
2024-09-27 21:40:14 INFO     evaluating now!
2024-09-27 21:40:16 INFO     Epoch [45/200] train_loss: 4.2280, val_loss: 5.4242, lr: 0.001000, 20.19s
2024-09-27 21:40:34 INFO     epoch complete!
2024-09-27 21:40:34 INFO     evaluating now!
2024-09-27 21:40:36 INFO     Epoch [46/200] train_loss: 4.2330, val_loss: 5.1445, lr: 0.001000, 19.74s
2024-09-27 21:40:54 INFO     epoch complete!
2024-09-27 21:40:54 INFO     evaluating now!
2024-09-27 21:40:56 INFO     Epoch [47/200] train_loss: 4.2068, val_loss: 5.1161, lr: 0.001000, 19.96s
2024-09-27 21:41:14 INFO     epoch complete!
2024-09-27 21:41:14 INFO     evaluating now!
2024-09-27 21:41:15 INFO     Epoch [48/200] train_loss: 4.1353, val_loss: 5.5783, lr: 0.001000, 19.81s
2024-09-27 21:41:33 INFO     epoch complete!
2024-09-27 21:41:33 INFO     evaluating now!
2024-09-27 21:41:35 INFO     Epoch [49/200] train_loss: 4.1100, val_loss: 4.9300, lr: 0.001000, 19.79s
2024-09-27 21:41:35 INFO     Saved model at 49
2024-09-27 21:41:35 INFO     Val loss decrease from 5.0954 to 4.9300, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch49.tar
2024-09-27 21:41:53 INFO     epoch complete!
2024-09-27 21:41:53 INFO     evaluating now!
2024-09-27 21:41:55 INFO     Epoch [50/200] train_loss: 4.0939, val_loss: 5.0626, lr: 0.001000, 19.59s
2024-09-27 21:42:13 INFO     epoch complete!
2024-09-27 21:42:13 INFO     evaluating now!
2024-09-27 21:42:15 INFO     Epoch [51/200] train_loss: 4.0949, val_loss: 4.9252, lr: 0.001000, 19.87s
2024-09-27 21:42:15 INFO     Saved model at 51
2024-09-27 21:42:15 INFO     Val loss decrease from 4.9300 to 4.9252, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch51.tar
2024-09-27 21:42:33 INFO     epoch complete!
2024-09-27 21:42:33 INFO     evaluating now!
2024-09-27 21:42:35 INFO     Epoch [52/200] train_loss: 4.1256, val_loss: 5.2547, lr: 0.001000, 19.74s
2024-09-27 21:42:52 INFO     epoch complete!
2024-09-27 21:42:52 INFO     evaluating now!
2024-09-27 21:42:54 INFO     Epoch [53/200] train_loss: 4.0643, val_loss: 5.3624, lr: 0.001000, 19.29s
2024-09-27 21:43:11 INFO     epoch complete!
2024-09-27 21:43:11 INFO     evaluating now!
2024-09-27 21:43:13 INFO     Epoch [54/200] train_loss: 4.0704, val_loss: 4.9006, lr: 0.001000, 19.19s
2024-09-27 21:43:13 INFO     Saved model at 54
2024-09-27 21:43:13 INFO     Val loss decrease from 4.9252 to 4.9006, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch54.tar
2024-09-27 21:43:31 INFO     epoch complete!
2024-09-27 21:43:31 INFO     evaluating now!
2024-09-27 21:43:33 INFO     Epoch [55/200] train_loss: 4.0417, val_loss: 5.4265, lr: 0.001000, 19.51s
2024-09-27 21:43:51 INFO     epoch complete!
2024-09-27 21:43:51 INFO     evaluating now!
2024-09-27 21:43:53 INFO     Epoch [56/200] train_loss: 4.0386, val_loss: 4.9867, lr: 0.001000, 20.22s
2024-09-27 21:44:11 INFO     epoch complete!
2024-09-27 21:44:11 INFO     evaluating now!
2024-09-27 21:44:13 INFO     Epoch [57/200] train_loss: 4.0320, val_loss: 5.0089, lr: 0.001000, 20.40s
2024-09-27 21:44:32 INFO     epoch complete!
2024-09-27 21:44:32 INFO     evaluating now!
2024-09-27 21:44:34 INFO     Epoch [58/200] train_loss: 4.0412, val_loss: 5.1574, lr: 0.001000, 20.65s
2024-09-27 21:44:53 INFO     epoch complete!
2024-09-27 21:44:53 INFO     evaluating now!
2024-09-27 21:44:55 INFO     Epoch [59/200] train_loss: 3.9865, val_loss: 4.9539, lr: 0.001000, 20.74s
2024-09-27 21:45:13 INFO     epoch complete!
2024-09-27 21:45:13 INFO     evaluating now!
2024-09-27 21:45:15 INFO     Epoch [60/200] train_loss: 3.9980, val_loss: 4.9835, lr: 0.001000, 20.44s
2024-09-27 21:45:34 INFO     epoch complete!
2024-09-27 21:45:34 INFO     evaluating now!
2024-09-27 21:45:36 INFO     Epoch [61/200] train_loss: 3.9942, val_loss: 4.8294, lr: 0.001000, 20.57s
2024-09-27 21:45:36 INFO     Saved model at 61
2024-09-27 21:45:36 INFO     Val loss decrease from 4.9006 to 4.8294, saving to ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406_epoch61.tar
2024-09-27 21:45:55 INFO     epoch complete!
2024-09-27 21:45:55 INFO     evaluating now!
2024-09-27 21:45:57 INFO     Epoch [62/200] train_loss: 3.9621, val_loss: 5.9155, lr: 0.001000, 20.90s
2024-09-27 21:46:16 INFO     epoch complete!
2024-09-27 21:46:16 INFO     evaluating now!
2024-09-27 21:46:18 INFO     Epoch [63/200] train_loss: 3.9454, val_loss: 4.8659, lr: 0.001000, 20.68s
2024-09-27 21:46:36 INFO     epoch complete!
2024-09-27 21:46:36 INFO     evaluating now!
2024-09-27 21:46:38 INFO     Epoch [64/200] train_loss: 3.9568, val_loss: 5.5253, lr: 0.001000, 20.63s
2024-09-27 21:46:57 INFO     epoch complete!
2024-09-27 21:46:57 INFO     evaluating now!
2024-09-27 21:46:59 INFO     Epoch [65/200] train_loss: 3.9490, val_loss: 5.8354, lr: 0.001000, 20.56s
2024-09-27 21:47:17 INFO     epoch complete!
2024-09-27 21:47:17 INFO     evaluating now!
2024-09-27 21:47:19 INFO     Epoch [66/200] train_loss: 3.9136, val_loss: 4.9390, lr: 0.001000, 20.32s
2024-09-27 21:47:38 INFO     epoch complete!
2024-09-27 21:47:38 INFO     evaluating now!
2024-09-27 21:47:40 INFO     Epoch [67/200] train_loss: 3.9344, val_loss: 5.4114, lr: 0.001000, 20.57s
2024-09-27 21:47:58 INFO     epoch complete!
2024-09-27 21:47:58 INFO     evaluating now!
2024-09-27 21:48:00 INFO     Epoch [68/200] train_loss: 3.9015, val_loss: 4.9417, lr: 0.001000, 20.37s
2024-09-27 21:48:18 INFO     epoch complete!
2024-09-27 21:48:18 INFO     evaluating now!
2024-09-27 21:48:20 INFO     Epoch [69/200] train_loss: 3.8553, val_loss: 5.2406, lr: 0.001000, 20.18s
2024-09-27 21:48:38 INFO     epoch complete!
2024-09-27 21:48:38 INFO     evaluating now!
2024-09-27 21:48:40 INFO     Epoch [70/200] train_loss: 3.8677, val_loss: 5.2711, lr: 0.001000, 19.93s
2024-09-27 21:48:58 INFO     epoch complete!
2024-09-27 21:48:58 INFO     evaluating now!
2024-09-27 21:49:00 INFO     Epoch [71/200] train_loss: 3.8644, val_loss: 5.2542, lr: 0.001000, 19.93s
2024-09-27 21:49:18 INFO     epoch complete!
2024-09-27 21:49:18 INFO     evaluating now!
2024-09-27 21:49:20 INFO     Epoch [72/200] train_loss: 3.8659, val_loss: 6.8284, lr: 0.001000, 19.95s
2024-09-27 21:49:38 INFO     epoch complete!
2024-09-27 21:49:38 INFO     evaluating now!
2024-09-27 21:49:40 INFO     Epoch [73/200] train_loss: 3.8554, val_loss: 5.3369, lr: 0.001000, 19.93s
2024-09-27 21:49:58 INFO     epoch complete!
2024-09-27 21:49:58 INFO     evaluating now!
2024-09-27 21:50:00 INFO     Epoch [74/200] train_loss: 3.8347, val_loss: 5.0904, lr: 0.001000, 20.04s
2024-09-27 21:50:18 INFO     epoch complete!
2024-09-27 21:50:18 INFO     evaluating now!
2024-09-27 21:50:20 INFO     Epoch [75/200] train_loss: 3.8352, val_loss: 4.8563, lr: 0.001000, 19.63s
2024-09-27 21:50:37 INFO     epoch complete!
2024-09-27 21:50:37 INFO     evaluating now!
2024-09-27 21:50:39 INFO     Epoch [76/200] train_loss: 3.8070, val_loss: 5.4706, lr: 0.001000, 19.39s
2024-09-27 21:50:39 WARNING  Early stopping at epoch: 76
2024-09-27 21:50:39 INFO     Trained totally 77 epochs, average train time is 18.162s, average eval time is 1.977s
2024-09-27 21:50:39 INFO     Loaded model at 61
2024-09-27 21:50:39 INFO     Saved model at ./libcity/cache/101/model_cache/GWNET_CHITaxi20190406.m
2024-09-27 21:50:39 INFO     Start evaluating ...
2024-09-27 21:50:44 INFO     Note that you select the single mode to evaluate!
2024-09-27 21:50:44 INFO     Evaluate result is saved at ./libcity/cache/101/evaluate_cache/2024_09_27_21_50_44_GWNET_CHITaxi20190406.csv
2024-09-27 21:50:44 INFO     
         MAE       RMSE  masked_MAPE
1   2.183107   6.444931     0.343164
2   2.370420   7.616379     0.340751
3   2.598632   8.534821     0.369781
4   2.798796   9.527636     0.373420
5   2.933881  10.535568     0.361526
6   3.078161  11.614341     0.358622
7   3.232746  12.770756     0.363564
8   3.327119  13.445004     0.358630
9   3.369237  13.499855     0.362207
10  3.306737  13.210414     0.353630
11  3.393171  13.072650     0.374639
12  3.431195  13.235802     0.377432
2024-09-27 21:50:44 INFO     ----------------------------------------------------------------------------
2024-09-27 21:50:44 INFO     # 2, Kownledge Graph Embedding: None, Experiment ids: 102
2024-09-27 21:50:44 INFO     ----------------------------------------------------------------------------
2024-09-27 21:50:44 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=102
2024-09-27 21:50:44 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 102, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 2, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-27 21:50:44 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-27 21:50:44 INFO     set_weight_link_or_dist: dist
2024-09-27 21:50:44 INFO     init_weight_inf_or_zero: inf
2024-09-27 21:50:44 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-27 21:50:44 INFO     Start Calculate the weight by Gauss kernel!
2024-09-27 21:50:44 INFO     Loading file CHITaxi20190406.dyna
2024-09-27 21:50:45 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-27 21:50:45 INFO     Dataset created
2024-09-27 21:50:45 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-27 21:50:45 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-27 21:50:45 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-27 21:50:45 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-27 21:50:45 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-27 21:50:45 INFO     NoneScaler
2024-09-27 21:50:45 INFO     add adj_mx to supports
2024-09-27 21:50:45 INFO     add apt_adj(v1 * v2) in forward process
2024-09-27 21:50:45 INFO     receptive_field: 14
2024-09-27 21:50:45 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(2, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-27 21:50:45 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-27 21:50:45 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-27 21:50:45 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:50:45 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:50:45 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:50:45 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:50:45 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:50:45 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:50:45 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:50:45 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:50:45 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:50:45 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:50:45 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:50:45 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:50:45 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:50:45 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:50:45 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:50:45 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 21:50:45 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:50:45 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:50:45 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:50:45 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:50:45 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:50:45 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:50:45 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:50:45 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-27 21:50:45 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     start_conv.weight	torch.Size([32, 2, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-27 21:50:45 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-27 21:50:45 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-27 21:50:45 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-27 21:50:45 INFO     Total parameter numbers: 306800
2024-09-27 21:50:45 INFO     You select `adam` optimizer.
2024-09-27 21:50:45 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-27 21:50:45 INFO     Start training ...
2024-09-27 21:50:45 INFO     num_batches:96
2024-09-27 21:51:03 INFO     epoch complete!
2024-09-27 21:51:03 INFO     evaluating now!
2024-09-27 21:51:05 INFO     Epoch [0/200] train_loss: 11.6781, val_loss: 8.8743, lr: 0.001000, 19.95s
2024-09-27 21:51:05 INFO     Saved model at 0
2024-09-27 21:51:05 INFO     Val loss decrease from inf to 8.8743, saving to ./libcity/cache/102/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-27 21:51:23 INFO     epoch complete!
2024-09-27 21:51:23 INFO     evaluating now!
2024-09-27 21:51:25 INFO     Epoch [1/200] train_loss: 8.7456, val_loss: 8.0317, lr: 0.001000, 20.00s
2024-09-27 21:51:25 INFO     Saved model at 1
2024-09-27 21:51:25 INFO     Val loss decrease from 8.8743 to 8.0317, saving to ./libcity/cache/102/model_cache/GWNET_CHITaxi20190406_epoch1.tar
2024-09-27 21:51:43 INFO     epoch complete!
2024-09-27 21:51:43 INFO     evaluating now!
2024-09-27 21:51:45 INFO     Epoch [2/200] train_loss: 8.3809, val_loss: 9.6818, lr: 0.001000, 19.80s
2024-09-27 21:52:03 INFO     epoch complete!
2024-09-27 21:52:03 INFO     evaluating now!
2024-09-27 21:52:05 INFO     Epoch [3/200] train_loss: 8.3672, val_loss: 7.6997, lr: 0.001000, 20.04s
2024-09-27 21:52:05 INFO     Saved model at 3
2024-09-27 21:52:05 INFO     Val loss decrease from 8.0317 to 7.6997, saving to ./libcity/cache/102/model_cache/GWNET_CHITaxi20190406_epoch3.tar
2024-09-27 21:52:23 INFO     epoch complete!
2024-09-27 21:52:23 INFO     evaluating now!
2024-09-27 21:52:25 INFO     Epoch [4/200] train_loss: 7.8149, val_loss: 10.9900, lr: 0.001000, 19.71s
2024-09-27 21:52:43 INFO     epoch complete!
2024-09-27 21:52:43 INFO     evaluating now!
2024-09-27 21:52:45 INFO     Epoch [5/200] train_loss: 7.8534, val_loss: 10.5009, lr: 0.001000, 19.93s
2024-09-27 21:53:04 INFO     epoch complete!
2024-09-27 21:53:04 INFO     evaluating now!
2024-09-27 21:53:06 INFO     Epoch [6/200] train_loss: 7.5042, val_loss: 10.7949, lr: 0.001000, 20.61s
2024-09-27 21:53:24 INFO     epoch complete!
2024-09-27 21:53:24 INFO     evaluating now!
2024-09-27 21:53:26 INFO     Epoch [7/200] train_loss: 7.5215, val_loss: 10.0388, lr: 0.001000, 20.37s
2024-09-27 21:53:45 INFO     epoch complete!
2024-09-27 21:53:45 INFO     evaluating now!
2024-09-27 21:53:47 INFO     Epoch [8/200] train_loss: 7.4621, val_loss: 11.2944, lr: 0.001000, 20.58s
2024-09-27 21:54:05 INFO     epoch complete!
2024-09-27 21:54:05 INFO     evaluating now!
2024-09-27 21:54:07 INFO     Epoch [9/200] train_loss: 7.3202, val_loss: 8.9420, lr: 0.001000, 20.68s
2024-09-27 21:54:26 INFO     epoch complete!
2024-09-27 21:54:26 INFO     evaluating now!
2024-09-27 21:54:28 INFO     Epoch [10/200] train_loss: 7.1693, val_loss: 7.3381, lr: 0.001000, 20.66s
2024-09-27 21:54:28 INFO     Saved model at 10
2024-09-27 21:54:28 INFO     Val loss decrease from 7.6997 to 7.3381, saving to ./libcity/cache/102/model_cache/GWNET_CHITaxi20190406_epoch10.tar
2024-09-27 21:54:47 INFO     epoch complete!
2024-09-27 21:54:47 INFO     evaluating now!
2024-09-27 21:54:49 INFO     Epoch [11/200] train_loss: 6.5865, val_loss: 7.0841, lr: 0.001000, 20.56s
2024-09-27 21:54:49 INFO     Saved model at 11
2024-09-27 21:54:49 INFO     Val loss decrease from 7.3381 to 7.0841, saving to ./libcity/cache/102/model_cache/GWNET_CHITaxi20190406_epoch11.tar
2024-09-27 21:55:08 INFO     epoch complete!
2024-09-27 21:55:08 INFO     evaluating now!
2024-09-27 21:55:10 INFO     Epoch [12/200] train_loss: 5.8034, val_loss: 5.7346, lr: 0.001000, 20.71s
2024-09-27 21:55:10 INFO     Saved model at 12
2024-09-27 21:55:10 INFO     Val loss decrease from 7.0841 to 5.7346, saving to ./libcity/cache/102/model_cache/GWNET_CHITaxi20190406_epoch12.tar
2024-09-27 21:55:29 INFO     epoch complete!
2024-09-27 21:55:29 INFO     evaluating now!
2024-09-27 21:55:31 INFO     Epoch [13/200] train_loss: 5.7266, val_loss: 5.5421, lr: 0.001000, 20.71s
2024-09-27 21:55:31 INFO     Saved model at 13
2024-09-27 21:55:31 INFO     Val loss decrease from 5.7346 to 5.5421, saving to ./libcity/cache/102/model_cache/GWNET_CHITaxi20190406_epoch13.tar
2024-09-27 21:55:49 INFO     epoch complete!
2024-09-27 21:55:49 INFO     evaluating now!
2024-09-27 21:55:51 INFO     Epoch [14/200] train_loss: 5.4131, val_loss: 5.7770, lr: 0.001000, 20.56s
2024-09-27 21:56:10 INFO     epoch complete!
2024-09-27 21:56:10 INFO     evaluating now!
2024-09-27 21:56:12 INFO     Epoch [15/200] train_loss: 5.2980, val_loss: 5.6098, lr: 0.001000, 20.80s
2024-09-27 21:56:31 INFO     epoch complete!
2024-09-27 21:56:31 INFO     evaluating now!
2024-09-27 21:56:33 INFO     Epoch [16/200] train_loss: 5.1903, val_loss: 8.2422, lr: 0.001000, 20.64s
2024-09-27 21:56:51 INFO     epoch complete!
2024-09-27 21:56:51 INFO     evaluating now!
2024-09-27 21:56:53 INFO     Epoch [17/200] train_loss: 5.0916, val_loss: 5.4787, lr: 0.001000, 20.72s
2024-09-27 21:56:53 INFO     Saved model at 17
2024-09-27 21:56:53 INFO     Val loss decrease from 5.5421 to 5.4787, saving to ./libcity/cache/102/model_cache/GWNET_CHITaxi20190406_epoch17.tar
2024-09-27 21:57:13 INFO     epoch complete!
2024-09-27 21:57:13 INFO     evaluating now!
2024-09-27 21:57:16 INFO     Epoch [18/200] train_loss: 5.1184, val_loss: 5.6765, lr: 0.001000, 22.42s
2024-09-27 21:57:39 INFO     epoch complete!
2024-09-27 21:57:39 INFO     evaluating now!
2024-09-27 21:57:41 INFO     Epoch [19/200] train_loss: 5.0471, val_loss: 5.6802, lr: 0.001000, 25.19s
2024-09-27 21:58:04 INFO     epoch complete!
2024-09-27 21:58:04 INFO     evaluating now!
2024-09-27 21:58:06 INFO     Epoch [20/200] train_loss: 5.1086, val_loss: 7.0594, lr: 0.001000, 25.16s
2024-09-27 21:58:29 INFO     epoch complete!
2024-09-27 21:58:29 INFO     evaluating now!
2024-09-27 21:58:31 INFO     Epoch [21/200] train_loss: 4.9405, val_loss: 8.2875, lr: 0.001000, 25.03s
2024-09-27 21:58:54 INFO     epoch complete!
2024-09-27 21:58:54 INFO     evaluating now!
2024-09-27 21:58:57 INFO     Epoch [22/200] train_loss: 4.8776, val_loss: 5.1109, lr: 0.001000, 25.33s
2024-09-27 21:58:57 INFO     Saved model at 22
2024-09-27 21:58:57 INFO     Val loss decrease from 5.4787 to 5.1109, saving to ./libcity/cache/102/model_cache/GWNET_CHITaxi20190406_epoch22.tar
2024-09-27 21:59:18 INFO     epoch complete!
2024-09-27 21:59:18 INFO     evaluating now!
2024-09-27 21:59:20 INFO     Epoch [23/200] train_loss: 4.7959, val_loss: 6.9823, lr: 0.001000, 23.52s
2024-09-27 21:59:38 INFO     epoch complete!
2024-09-27 21:59:38 INFO     evaluating now!
2024-09-27 21:59:40 INFO     Epoch [24/200] train_loss: 4.7574, val_loss: 5.0464, lr: 0.001000, 19.55s
2024-09-27 21:59:40 INFO     Saved model at 24
2024-09-27 21:59:40 INFO     Val loss decrease from 5.1109 to 5.0464, saving to ./libcity/cache/102/model_cache/GWNET_CHITaxi20190406_epoch24.tar
2024-09-27 21:59:58 INFO     epoch complete!
2024-09-27 21:59:58 INFO     evaluating now!
2024-09-27 22:00:00 INFO     Epoch [25/200] train_loss: 4.7056, val_loss: 6.3904, lr: 0.001000, 20.21s
2024-09-27 22:00:19 INFO     epoch complete!
2024-09-27 22:00:19 INFO     evaluating now!
2024-09-27 22:00:21 INFO     Epoch [26/200] train_loss: 4.7206, val_loss: 5.0278, lr: 0.001000, 20.59s
2024-09-27 22:00:21 INFO     Saved model at 26
2024-09-27 22:00:21 INFO     Val loss decrease from 5.0464 to 5.0278, saving to ./libcity/cache/102/model_cache/GWNET_CHITaxi20190406_epoch26.tar
2024-09-27 22:00:40 INFO     epoch complete!
2024-09-27 22:00:40 INFO     evaluating now!
2024-09-27 22:00:42 INFO     Epoch [27/200] train_loss: 4.6644, val_loss: 6.0035, lr: 0.001000, 20.69s
2024-09-27 22:01:00 INFO     epoch complete!
2024-09-27 22:01:00 INFO     evaluating now!
2024-09-27 22:01:02 INFO     Epoch [28/200] train_loss: 4.6305, val_loss: 5.1357, lr: 0.001000, 20.31s
2024-09-27 22:01:20 INFO     epoch complete!
2024-09-27 22:01:20 INFO     evaluating now!
2024-09-27 22:01:22 INFO     Epoch [29/200] train_loss: 4.5819, val_loss: 5.0046, lr: 0.001000, 20.30s
2024-09-27 22:01:22 INFO     Saved model at 29
2024-09-27 22:01:22 INFO     Val loss decrease from 5.0278 to 5.0046, saving to ./libcity/cache/102/model_cache/GWNET_CHITaxi20190406_epoch29.tar
2024-09-27 22:01:40 INFO     epoch complete!
2024-09-27 22:01:40 INFO     evaluating now!
2024-09-27 22:01:41 INFO     Epoch [30/200] train_loss: 4.5589, val_loss: 6.8359, lr: 0.001000, 19.21s
2024-09-27 22:01:59 INFO     epoch complete!
2024-09-27 22:01:59 INFO     evaluating now!
2024-09-27 22:02:01 INFO     Epoch [31/200] train_loss: 4.4991, val_loss: 6.0864, lr: 0.001000, 19.74s
2024-09-27 22:02:24 INFO     epoch complete!
2024-09-27 22:02:24 INFO     evaluating now!
2024-09-27 22:02:27 INFO     Epoch [32/200] train_loss: 4.4710, val_loss: 7.2349, lr: 0.001000, 25.74s
2024-09-27 22:02:50 INFO     epoch complete!
2024-09-27 22:02:50 INFO     evaluating now!
2024-09-27 22:02:52 INFO     Epoch [33/200] train_loss: 4.4232, val_loss: 5.2982, lr: 0.001000, 25.27s
2024-09-27 22:03:15 INFO     epoch complete!
2024-09-27 22:03:15 INFO     evaluating now!
2024-09-27 22:03:18 INFO     Epoch [34/200] train_loss: 4.4477, val_loss: 5.5073, lr: 0.001000, 25.48s
2024-09-27 22:03:40 INFO     epoch complete!
2024-09-27 22:03:40 INFO     evaluating now!
2024-09-27 22:03:43 INFO     Epoch [35/200] train_loss: 4.4015, val_loss: 5.2917, lr: 0.001000, 25.11s
2024-09-27 22:04:05 INFO     epoch complete!
2024-09-27 22:04:05 INFO     evaluating now!
2024-09-27 22:04:08 INFO     Epoch [36/200] train_loss: 4.3971, val_loss: 6.2485, lr: 0.001000, 25.23s
2024-09-27 22:04:31 INFO     epoch complete!
2024-09-27 22:04:31 INFO     evaluating now!
2024-09-27 22:04:33 INFO     Epoch [37/200] train_loss: 4.3354, val_loss: 5.5191, lr: 0.001000, 25.04s
2024-09-27 22:04:55 INFO     epoch complete!
2024-09-27 22:04:55 INFO     evaluating now!
2024-09-27 22:04:58 INFO     Epoch [38/200] train_loss: 4.3184, val_loss: 5.5972, lr: 0.001000, 24.93s
2024-09-27 22:05:21 INFO     epoch complete!
2024-09-27 22:05:21 INFO     evaluating now!
2024-09-27 22:05:23 INFO     Epoch [39/200] train_loss: 4.3510, val_loss: 5.4096, lr: 0.001000, 25.35s
2024-09-27 22:05:46 INFO     epoch complete!
2024-09-27 22:05:46 INFO     evaluating now!
2024-09-27 22:05:49 INFO     Epoch [40/200] train_loss: 4.2750, val_loss: 5.0968, lr: 0.001000, 25.53s
2024-09-27 22:06:12 INFO     epoch complete!
2024-09-27 22:06:12 INFO     evaluating now!
2024-09-27 22:06:15 INFO     Epoch [41/200] train_loss: 4.2826, val_loss: 5.0508, lr: 0.001000, 25.72s
2024-09-27 22:06:38 INFO     epoch complete!
2024-09-27 22:06:38 INFO     evaluating now!
2024-09-27 22:06:40 INFO     Epoch [42/200] train_loss: 4.2422, val_loss: 6.1575, lr: 0.001000, 25.57s
2024-09-27 22:07:03 INFO     epoch complete!
2024-09-27 22:07:03 INFO     evaluating now!
2024-09-27 22:07:06 INFO     Epoch [43/200] train_loss: 4.2145, val_loss: 5.1128, lr: 0.001000, 25.79s
2024-09-27 22:07:29 INFO     epoch complete!
2024-09-27 22:07:29 INFO     evaluating now!
2024-09-27 22:07:32 INFO     Epoch [44/200] train_loss: 4.2237, val_loss: 5.3894, lr: 0.001000, 25.78s
2024-09-27 22:07:32 WARNING  Early stopping at epoch: 44
2024-09-27 22:07:32 INFO     Trained totally 45 epochs, average train time is 20.104s, average eval time is 2.225s
2024-09-27 22:07:32 INFO     Loaded model at 29
2024-09-27 22:07:32 INFO     Saved model at ./libcity/cache/102/model_cache/GWNET_CHITaxi20190406.m
2024-09-27 22:07:32 INFO     Start evaluating ...
2024-09-27 22:07:38 INFO     Note that you select the single mode to evaluate!
2024-09-27 22:07:38 INFO     Evaluate result is saved at ./libcity/cache/102/evaluate_cache/2024_09_27_22_07_38_GWNET_CHITaxi20190406.csv
2024-09-27 22:07:38 INFO     
         MAE       RMSE  masked_MAPE
1   2.294599   7.223730     0.345221
2   2.474288   8.082612     0.350673
3   2.653457   8.859997     0.359063
4   2.823532   9.731302     0.359593
5   3.001486  10.960326     0.354887
6   3.247228  12.444136     0.355917
7   3.335938  13.472897     0.355560
8   3.488714  14.035684     0.371233
9   3.462948  13.963868     0.362354
10  3.478157  13.577268     0.373609
11  3.518830  13.566395     0.384511
12  3.523343  13.810405     0.385485
2024-09-27 22:07:38 INFO     ----------------------------------------------------------------------------
2024-09-27 22:07:38 INFO     # 3, Kownledge Graph Embedding: None, Experiment ids: 103
2024-09-27 22:07:38 INFO     ----------------------------------------------------------------------------
2024-09-27 22:07:38 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=103
2024-09-27 22:07:38 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 103, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 3, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-27 22:07:38 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-27 22:07:38 INFO     set_weight_link_or_dist: dist
2024-09-27 22:07:38 INFO     init_weight_inf_or_zero: inf
2024-09-27 22:07:38 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-27 22:07:38 INFO     Start Calculate the weight by Gauss kernel!
2024-09-27 22:07:38 INFO     Loading file CHITaxi20190406.dyna
2024-09-27 22:07:38 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-27 22:07:39 INFO     Dataset created
2024-09-27 22:07:39 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-27 22:07:39 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-27 22:07:39 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-27 22:07:39 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-27 22:07:39 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-27 22:07:39 INFO     NoneScaler
2024-09-27 22:07:39 INFO     add adj_mx to supports
2024-09-27 22:07:39 INFO     add apt_adj(v1 * v2) in forward process
2024-09-27 22:07:39 INFO     receptive_field: 14
2024-09-27 22:07:39 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(2, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-27 22:07:39 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-27 22:07:39 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-27 22:07:39 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:07:39 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:07:39 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:07:39 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:07:39 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:07:39 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:07:39 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:07:39 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:07:39 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:07:39 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:07:39 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:07:39 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:07:39 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:07:39 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:07:39 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:07:39 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:07:39 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-27 22:07:39 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-27 22:07:39 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-27 22:07:39 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-27 22:07:39 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-27 22:07:39 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-27 22:07:39 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-27 22:07:39 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-27 22:07:39 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     start_conv.weight	torch.Size([32, 2, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:07:39 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-27 22:07:39 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-27 22:07:39 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-27 22:07:39 INFO     Total parameter numbers: 306800
2024-09-27 22:07:39 INFO     You select `adam` optimizer.
2024-09-27 22:07:39 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-27 22:07:39 INFO     Start training ...
2024-09-27 22:07:39 INFO     num_batches:96
2024-09-27 22:08:02 INFO     epoch complete!
2024-09-27 22:08:02 INFO     evaluating now!
2024-09-27 22:08:05 INFO     Epoch [0/200] train_loss: 12.9379, val_loss: 10.5497, lr: 0.001000, 25.96s
2024-09-27 22:08:05 INFO     Saved model at 0
2024-09-27 22:08:05 INFO     Val loss decrease from inf to 10.5497, saving to ./libcity/cache/103/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-27 22:08:28 INFO     epoch complete!
2024-09-27 22:08:28 INFO     evaluating now!
2024-09-27 22:08:31 INFO     Epoch [1/200] train_loss: 9.8229, val_loss: 10.3807, lr: 0.001000, 25.47s
2024-09-27 22:08:31 INFO     Saved model at 1
2024-09-27 22:08:31 INFO     Val loss decrease from 10.5497 to 10.3807, saving to ./libcity/cache/103/model_cache/GWNET_CHITaxi20190406_epoch1.tar
2024-09-27 22:08:54 INFO     epoch complete!
2024-09-27 22:08:54 INFO     evaluating now!
2024-09-27 22:08:56 INFO     Epoch [2/200] train_loss: 8.6179, val_loss: 9.7099, lr: 0.001000, 25.62s
2024-09-27 22:08:57 INFO     Saved model at 2
2024-09-27 22:08:57 INFO     Val loss decrease from 10.3807 to 9.7099, saving to ./libcity/cache/103/model_cache/GWNET_CHITaxi20190406_epoch2.tar
2024-09-27 22:09:20 INFO     epoch complete!
2024-09-27 22:09:20 INFO     evaluating now!
2024-09-27 22:09:22 INFO     Epoch [3/200] train_loss: 8.0911, val_loss: 7.7020, lr: 0.001000, 25.04s
2024-09-27 22:09:22 INFO     Saved model at 3
2024-09-27 22:09:22 INFO     Val loss decrease from 9.7099 to 7.7020, saving to ./libcity/cache/103/model_cache/GWNET_CHITaxi20190406_epoch3.tar
2024-09-27 22:09:40 INFO     epoch complete!
2024-09-27 22:09:40 INFO     evaluating now!
2024-09-27 22:09:42 INFO     Epoch [4/200] train_loss: 7.8389, val_loss: 7.7287, lr: 0.001000, 20.14s
2024-09-27 22:10:00 INFO     epoch complete!
2024-09-27 22:10:00 INFO     evaluating now!
2024-09-27 22:10:02 INFO     Epoch [5/200] train_loss: 7.7894, val_loss: 7.4504, lr: 0.001000, 20.21s
2024-09-27 22:10:02 INFO     Saved model at 5
2024-09-27 22:10:02 INFO     Val loss decrease from 7.7020 to 7.4504, saving to ./libcity/cache/103/model_cache/GWNET_CHITaxi20190406_epoch5.tar
2024-09-27 22:10:21 INFO     epoch complete!
2024-09-27 22:10:21 INFO     evaluating now!
2024-09-27 22:10:23 INFO     Epoch [6/200] train_loss: 7.5386, val_loss: 8.9364, lr: 0.001000, 20.61s
2024-09-27 22:10:41 INFO     epoch complete!
2024-09-27 22:10:41 INFO     evaluating now!
2024-09-27 22:10:43 INFO     Epoch [7/200] train_loss: 7.4288, val_loss: 7.8852, lr: 0.001000, 20.42s
2024-09-27 22:11:02 INFO     epoch complete!
2024-09-27 22:11:02 INFO     evaluating now!
2024-09-27 22:11:04 INFO     Epoch [8/200] train_loss: 6.9300, val_loss: 7.4654, lr: 0.001000, 20.75s
2024-09-27 22:11:23 INFO     epoch complete!
2024-09-27 22:11:23 INFO     evaluating now!
2024-09-27 22:11:25 INFO     Epoch [9/200] train_loss: 6.1407, val_loss: 5.6935, lr: 0.001000, 20.75s
2024-09-27 22:11:25 INFO     Saved model at 9
2024-09-27 22:11:25 INFO     Val loss decrease from 7.4504 to 5.6935, saving to ./libcity/cache/103/model_cache/GWNET_CHITaxi20190406_epoch9.tar
2024-09-27 22:11:44 INFO     epoch complete!
2024-09-27 22:11:44 INFO     evaluating now!
2024-09-27 22:11:46 INFO     Epoch [10/200] train_loss: 5.9400, val_loss: 7.3948, lr: 0.001000, 20.39s
2024-09-27 22:12:04 INFO     epoch complete!
2024-09-27 22:12:04 INFO     evaluating now!
2024-09-27 22:12:06 INFO     Epoch [11/200] train_loss: 5.6835, val_loss: 8.6853, lr: 0.001000, 20.45s
2024-09-27 22:12:25 INFO     epoch complete!
2024-09-27 22:12:25 INFO     evaluating now!
2024-09-27 22:12:27 INFO     Epoch [12/200] train_loss: 5.7115, val_loss: 10.8840, lr: 0.001000, 20.67s
2024-09-27 22:12:45 INFO     epoch complete!
2024-09-27 22:12:45 INFO     evaluating now!
2024-09-27 22:12:47 INFO     Epoch [13/200] train_loss: 5.4095, val_loss: 5.5794, lr: 0.001000, 20.56s
2024-09-27 22:12:48 INFO     Saved model at 13
2024-09-27 22:12:48 INFO     Val loss decrease from 5.6935 to 5.5794, saving to ./libcity/cache/103/model_cache/GWNET_CHITaxi20190406_epoch13.tar
2024-09-27 22:13:06 INFO     epoch complete!
2024-09-27 22:13:06 INFO     evaluating now!
2024-09-27 22:13:08 INFO     Epoch [14/200] train_loss: 5.2701, val_loss: 6.9690, lr: 0.001000, 20.15s
2024-09-27 22:13:25 INFO     epoch complete!
2024-09-27 22:13:25 INFO     evaluating now!
2024-09-27 22:13:27 INFO     Epoch [15/200] train_loss: 5.4108, val_loss: 6.4953, lr: 0.001000, 19.10s
2024-09-27 22:13:44 INFO     epoch complete!
2024-09-27 22:13:44 INFO     evaluating now!
2024-09-27 22:13:46 INFO     Epoch [16/200] train_loss: 5.1379, val_loss: 6.3045, lr: 0.001000, 19.48s
2024-09-27 22:14:04 INFO     epoch complete!
2024-09-27 22:14:04 INFO     evaluating now!
2024-09-27 22:14:06 INFO     Epoch [17/200] train_loss: 5.1621, val_loss: 5.2737, lr: 0.001000, 19.90s
2024-09-27 22:14:06 INFO     Saved model at 17
2024-09-27 22:14:06 INFO     Val loss decrease from 5.5794 to 5.2737, saving to ./libcity/cache/103/model_cache/GWNET_CHITaxi20190406_epoch17.tar
2024-09-27 22:14:24 INFO     epoch complete!
2024-09-27 22:14:24 INFO     evaluating now!
2024-09-27 22:14:26 INFO     Epoch [18/200] train_loss: 5.0017, val_loss: 5.4220, lr: 0.001000, 20.08s
2024-09-27 22:14:44 INFO     epoch complete!
2024-09-27 22:14:44 INFO     evaluating now!
2024-09-27 22:14:46 INFO     Epoch [19/200] train_loss: 4.9096, val_loss: 5.6137, lr: 0.001000, 19.85s
2024-09-27 22:15:04 INFO     epoch complete!
2024-09-27 22:15:04 INFO     evaluating now!
2024-09-27 22:15:06 INFO     Epoch [20/200] train_loss: 4.9197, val_loss: 5.4364, lr: 0.001000, 19.75s
2024-09-27 22:15:24 INFO     epoch complete!
2024-09-27 22:15:24 INFO     evaluating now!
2024-09-27 22:15:26 INFO     Epoch [21/200] train_loss: 4.8243, val_loss: 5.5929, lr: 0.001000, 19.82s
2024-09-27 22:15:43 INFO     epoch complete!
2024-09-27 22:15:43 INFO     evaluating now!
2024-09-27 22:15:45 INFO     Epoch [22/200] train_loss: 4.7543, val_loss: 5.4513, lr: 0.001000, 19.52s
2024-09-27 22:16:03 INFO     epoch complete!
2024-09-27 22:16:03 INFO     evaluating now!
2024-09-27 22:16:05 INFO     Epoch [23/200] train_loss: 4.7322, val_loss: 6.4787, lr: 0.001000, 19.88s
2024-09-27 22:16:23 INFO     epoch complete!
2024-09-27 22:16:23 INFO     evaluating now!
2024-09-27 22:16:25 INFO     Epoch [24/200] train_loss: 4.6447, val_loss: 5.1745, lr: 0.001000, 19.67s
2024-09-27 22:16:25 INFO     Saved model at 24
2024-09-27 22:16:25 INFO     Val loss decrease from 5.2737 to 5.1745, saving to ./libcity/cache/103/model_cache/GWNET_CHITaxi20190406_epoch24.tar
2024-09-27 22:16:43 INFO     epoch complete!
2024-09-27 22:16:43 INFO     evaluating now!
2024-09-27 22:16:45 INFO     Epoch [25/200] train_loss: 4.6677, val_loss: 5.6850, lr: 0.001000, 19.64s
2024-09-27 22:17:02 INFO     epoch complete!
2024-09-27 22:17:02 INFO     evaluating now!
2024-09-27 22:17:04 INFO     Epoch [26/200] train_loss: 4.6362, val_loss: 5.6905, lr: 0.001000, 19.69s
2024-09-27 22:17:22 INFO     epoch complete!
2024-09-27 22:17:22 INFO     evaluating now!
2024-09-27 22:17:24 INFO     Epoch [27/200] train_loss: 4.6597, val_loss: 5.3832, lr: 0.001000, 19.31s
2024-09-27 22:17:41 INFO     epoch complete!
2024-09-27 22:17:41 INFO     evaluating now!
2024-09-27 22:17:43 INFO     Epoch [28/200] train_loss: 4.5982, val_loss: 5.2587, lr: 0.001000, 19.16s
2024-09-27 22:18:00 INFO     epoch complete!
2024-09-27 22:18:00 INFO     evaluating now!
2024-09-27 22:18:02 INFO     Epoch [29/200] train_loss: 4.5101, val_loss: 5.5464, lr: 0.001000, 19.46s
2024-09-27 22:18:20 INFO     epoch complete!
2024-09-27 22:18:20 INFO     evaluating now!
2024-09-27 22:18:22 INFO     Epoch [30/200] train_loss: 4.5570, val_loss: 5.5092, lr: 0.001000, 19.56s
2024-09-27 22:18:40 INFO     epoch complete!
2024-09-27 22:18:40 INFO     evaluating now!
2024-09-27 22:18:42 INFO     Epoch [31/200] train_loss: 4.5509, val_loss: 4.9790, lr: 0.001000, 19.92s
2024-09-27 22:18:42 INFO     Saved model at 31
2024-09-27 22:18:42 INFO     Val loss decrease from 5.1745 to 4.9790, saving to ./libcity/cache/103/model_cache/GWNET_CHITaxi20190406_epoch31.tar
2024-09-27 22:19:00 INFO     epoch complete!
2024-09-27 22:19:00 INFO     evaluating now!
2024-09-27 22:19:02 INFO     Epoch [32/200] train_loss: 4.4532, val_loss: 5.1942, lr: 0.001000, 19.79s
2024-09-27 22:19:19 INFO     epoch complete!
2024-09-27 22:19:19 INFO     evaluating now!
2024-09-27 22:19:21 INFO     Epoch [33/200] train_loss: 4.4671, val_loss: 5.9778, lr: 0.001000, 19.27s
2024-09-27 22:19:38 INFO     epoch complete!
2024-09-27 22:19:38 INFO     evaluating now!
2024-09-27 22:19:40 INFO     Epoch [34/200] train_loss: 4.4205, val_loss: 5.2383, lr: 0.001000, 19.21s
2024-09-27 22:19:58 INFO     epoch complete!
2024-09-27 22:19:58 INFO     evaluating now!
2024-09-27 22:20:00 INFO     Epoch [35/200] train_loss: 4.3997, val_loss: 5.5897, lr: 0.001000, 19.69s
2024-09-27 22:20:18 INFO     epoch complete!
2024-09-27 22:20:18 INFO     evaluating now!
2024-09-27 22:20:20 INFO     Epoch [36/200] train_loss: 4.3892, val_loss: 5.2421, lr: 0.001000, 19.77s
2024-09-27 22:20:38 INFO     epoch complete!
2024-09-27 22:20:38 INFO     evaluating now!
2024-09-27 22:20:40 INFO     Epoch [37/200] train_loss: 4.3671, val_loss: 5.3446, lr: 0.001000, 20.04s
2024-09-27 22:20:58 INFO     epoch complete!
2024-09-27 22:20:58 INFO     evaluating now!
2024-09-27 22:21:00 INFO     Epoch [38/200] train_loss: 4.3494, val_loss: 4.9586, lr: 0.001000, 20.01s
2024-09-27 22:21:00 INFO     Saved model at 38
2024-09-27 22:21:00 INFO     Val loss decrease from 4.9790 to 4.9586, saving to ./libcity/cache/103/model_cache/GWNET_CHITaxi20190406_epoch38.tar
2024-09-27 22:21:18 INFO     epoch complete!
2024-09-27 22:21:18 INFO     evaluating now!
2024-09-27 22:21:20 INFO     Epoch [39/200] train_loss: 4.3655, val_loss: 4.7870, lr: 0.001000, 19.90s
2024-09-27 22:21:20 INFO     Saved model at 39
2024-09-27 22:21:20 INFO     Val loss decrease from 4.9586 to 4.7870, saving to ./libcity/cache/103/model_cache/GWNET_CHITaxi20190406_epoch39.tar
2024-09-27 22:21:38 INFO     epoch complete!
2024-09-27 22:21:38 INFO     evaluating now!
2024-09-27 22:21:40 INFO     Epoch [40/200] train_loss: 4.2950, val_loss: 5.1406, lr: 0.001000, 20.05s
2024-09-27 22:21:58 INFO     epoch complete!
2024-09-27 22:21:58 INFO     evaluating now!
2024-09-27 22:22:00 INFO     Epoch [41/200] train_loss: 4.2646, val_loss: 5.5402, lr: 0.001000, 19.82s
2024-09-27 22:22:17 INFO     epoch complete!
2024-09-27 22:22:17 INFO     evaluating now!
2024-09-27 22:22:19 INFO     Epoch [42/200] train_loss: 4.3633, val_loss: 4.9483, lr: 0.001000, 19.80s
2024-09-27 22:22:37 INFO     epoch complete!
2024-09-27 22:22:37 INFO     evaluating now!
2024-09-27 22:22:39 INFO     Epoch [43/200] train_loss: 4.2430, val_loss: 5.1750, lr: 0.001000, 19.66s
2024-09-27 22:22:57 INFO     epoch complete!
2024-09-27 22:22:57 INFO     evaluating now!
2024-09-27 22:22:59 INFO     Epoch [44/200] train_loss: 4.2118, val_loss: 4.9977, lr: 0.001000, 19.75s
2024-09-27 22:23:16 INFO     epoch complete!
2024-09-27 22:23:16 INFO     evaluating now!
2024-09-27 22:23:18 INFO     Epoch [45/200] train_loss: 4.1681, val_loss: 5.2488, lr: 0.001000, 19.21s
2024-09-27 22:23:36 INFO     epoch complete!
2024-09-27 22:23:36 INFO     evaluating now!
2024-09-27 22:23:38 INFO     Epoch [46/200] train_loss: 4.1869, val_loss: 4.8583, lr: 0.001000, 19.66s
2024-09-27 22:23:55 INFO     epoch complete!
2024-09-27 22:23:55 INFO     evaluating now!
2024-09-27 22:23:57 INFO     Epoch [47/200] train_loss: 4.2237, val_loss: 4.8360, lr: 0.001000, 19.55s
2024-09-27 22:24:15 INFO     epoch complete!
2024-09-27 22:24:15 INFO     evaluating now!
2024-09-27 22:24:17 INFO     Epoch [48/200] train_loss: 4.1164, val_loss: 4.9735, lr: 0.001000, 19.69s
2024-09-27 22:24:35 INFO     epoch complete!
2024-09-27 22:24:35 INFO     evaluating now!
2024-09-27 22:24:37 INFO     Epoch [49/200] train_loss: 4.1101, val_loss: 5.2634, lr: 0.001000, 19.56s
2024-09-27 22:24:54 INFO     epoch complete!
2024-09-27 22:24:54 INFO     evaluating now!
2024-09-27 22:24:56 INFO     Epoch [50/200] train_loss: 4.1317, val_loss: 5.0141, lr: 0.001000, 19.70s
2024-09-27 22:25:14 INFO     epoch complete!
2024-09-27 22:25:14 INFO     evaluating now!
2024-09-27 22:25:16 INFO     Epoch [51/200] train_loss: 4.1017, val_loss: 4.9495, lr: 0.001000, 19.66s
2024-09-27 22:25:34 INFO     epoch complete!
2024-09-27 22:25:34 INFO     evaluating now!
2024-09-27 22:25:36 INFO     Epoch [52/200] train_loss: 4.0839, val_loss: 4.9774, lr: 0.001000, 19.77s
2024-09-27 22:25:54 INFO     epoch complete!
2024-09-27 22:25:54 INFO     evaluating now!
2024-09-27 22:25:56 INFO     Epoch [53/200] train_loss: 4.0683, val_loss: 5.1896, lr: 0.001000, 20.23s
2024-09-27 22:26:14 INFO     epoch complete!
2024-09-27 22:26:14 INFO     evaluating now!
2024-09-27 22:26:16 INFO     Epoch [54/200] train_loss: 4.0574, val_loss: 5.0184, lr: 0.001000, 20.04s
2024-09-27 22:26:16 WARNING  Early stopping at epoch: 54
2024-09-27 22:26:16 INFO     Trained totally 55 epochs, average train time is 18.290s, average eval time is 1.977s
2024-09-27 22:26:16 INFO     Loaded model at 39
2024-09-27 22:26:16 INFO     Saved model at ./libcity/cache/103/model_cache/GWNET_CHITaxi20190406.m
2024-09-27 22:26:16 INFO     Start evaluating ...
2024-09-27 22:26:21 INFO     Note that you select the single mode to evaluate!
2024-09-27 22:26:21 INFO     Evaluate result is saved at ./libcity/cache/103/evaluate_cache/2024_09_27_22_26_21_GWNET_CHITaxi20190406.csv
2024-09-27 22:26:21 INFO     
         MAE       RMSE  masked_MAPE
1   2.190500   6.772418     0.352671
2   2.334431   7.629096     0.353731
3   2.469484   8.542771     0.369840
4   2.562047   9.129863     0.375511
5   2.733902   9.596456     0.373595
6   2.822387   9.980216     0.371910
7   2.912541  10.453817     0.376912
8   3.031668  10.931396     0.378176
9   3.143679  11.518961     0.389480
10  3.206670  11.957194     0.384050
11  3.242820  12.139251     0.394783
12  3.309309  12.463647     0.404676
2024-09-27 22:26:21 INFO     ----------------------------------------------------------------------------
2024-09-27 22:26:21 INFO     # 4, Kownledge Graph Embedding: None, Experiment ids: 104
2024-09-27 22:26:21 INFO     ----------------------------------------------------------------------------
2024-09-27 22:26:21 INFO     Begin pipeline, task=traffic_state_pred, model_name=GWNET, dataset_name=CHITaxi20190406, exp_id=104
2024-09-27 22:26:21 INFO     {'task': 'traffic_state_pred', 'model': 'GWNET', 'dataset': 'CHITaxi20190406', 'saved_model': True, 'train': True, 'exp_id': 104, 'max_epoch': 200, 'patience': 15, 'use_early_stop': True, 'cache_dataset': False, 'output_window': 12, 'metrics': ['MAE', 'RMSE', 'masked_MAPE'], 'cur_times': 4, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'dropout': 0.3, 'blocks': 4, 'layers': 2, 'batch_size': 32, 'apt_layer': True, 'gcn_bool': True, 'adjtype': 'doubletransition', 'bidir_adj_mx': False, 'randomadj': True, 'kernel_size': 2, 'nhid': 32, 'residual_channels': 32, 'dilation_channels': 32, 'skip_channels': 256, 'end_channels': 512, 'scaler': 'standard', 'load_external': False, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': False, 'add_day_in_week': False, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_rel_adj': True, 'use_apt_adj': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'robustness_test': False, 'noise_type': 'gaussian', 'disturb_rate': 0.5, 'noise_mean': [5], 'noise_SD': [10], 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['inflow', 'outflow'], 'weight_col': 'cost', 'data_files': ['CHITaxi20190406'], 'geo_file': 'CHITaxi20190406', 'rel_file': 'CHITaxi20190406', 'output_dim': 2, 'time_intervals': 1800, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'ke_type': 'area', 'device': device(type='cuda', index=0)}
2024-09-27 22:26:21 INFO     Loaded file CHITaxi20190406.geo, num_nodes=77
2024-09-27 22:26:21 INFO     set_weight_link_or_dist: dist
2024-09-27 22:26:21 INFO     init_weight_inf_or_zero: inf
2024-09-27 22:26:21 INFO     Loaded file CHITaxi20190406.rel, shape=(77, 77)
2024-09-27 22:26:21 INFO     Start Calculate the weight by Gauss kernel!
2024-09-27 22:26:21 INFO     Loading file CHITaxi20190406.dyna
2024-09-27 22:26:21 INFO     Loaded file CHITaxi20190406.dyna, shape=(4368, 77, 2)
2024-09-27 22:26:21 INFO     Dataset created
2024-09-27 22:26:21 INFO     x shape: (4345, 12, 77, 2), y shape: (4345, 12, 77, 2)
2024-09-27 22:26:21 INFO     train	x: (3042, 12, 77, 2), y: (3042, 12, 77, 2)
2024-09-27 22:26:21 INFO     eval	x: (434, 12, 77, 2), y: (434, 12, 77, 2)
2024-09-27 22:26:21 INFO     test	x: (869, 12, 77, 2), y: (869, 12, 77, 2)
2024-09-27 22:26:22 INFO     StandardScaler mean: 11.137838123415046, std: 53.15358218315973
2024-09-27 22:26:22 INFO     NoneScaler
2024-09-27 22:26:22 INFO     add adj_mx to supports
2024-09-27 22:26:22 INFO     add apt_adj(v1 * v2) in forward process
2024-09-27 22:26:22 INFO     receptive_field: 14
2024-09-27 22:26:22 INFO     GWNET(
  (filter_convs): ModuleList(
    (0): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (1): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (2): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (3): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (4): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (5): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
    (6): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1))
    (7): Conv2d(32, 32, kernel_size=(1, 2), stride=(1, 1), dilation=(2, 2))
  )
  (gate_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (2): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (4): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
    (6): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 2), stride=(1,), dilation=(2,))
  )
  (residual_convs): ModuleList(
    (0): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 32, kernel_size=(1, 1), stride=(1,))
  )
  (skip_convs): ModuleList(
    (0): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (1): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (2): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (3): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (4): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (5): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (6): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
    (7): Conv1d(32, 256, kernel_size=(1, 1), stride=(1,))
  )
  (bn): ModuleList(
    (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (6): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (gconv): ModuleList(
    (0): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (3): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (4): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (5): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (6): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (7): GCN(
      (nconv): NConv()
      (mlp): Linear(
        (mlp): Conv2d(224, 32, kernel_size=(1, 1), stride=(1, 1))
      )
    )
  )
  (start_conv): Conv2d(2, 32, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_1): Conv2d(256, 512, kernel_size=(1, 1), stride=(1, 1))
  (end_conv_2): Conv2d(512, 12, kernel_size=(1, 1), stride=(1, 1))
)
2024-09-27 22:26:22 INFO     nodevec1	torch.Size([77, 10])	cuda:0	True
2024-09-27 22:26:22 INFO     nodevec2	torch.Size([10, 77])	cuda:0	True
2024-09-27 22:26:22 INFO     filter_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:26:22 INFO     filter_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     filter_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:26:22 INFO     filter_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     filter_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:26:22 INFO     filter_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     filter_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:26:22 INFO     filter_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     filter_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:26:22 INFO     filter_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     filter_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:26:22 INFO     filter_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     filter_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:26:22 INFO     filter_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     filter_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:26:22 INFO     filter_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     gate_convs.0.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:26:22 INFO     gate_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     gate_convs.1.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:26:22 INFO     gate_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     gate_convs.2.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:26:22 INFO     gate_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     gate_convs.3.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:26:22 INFO     gate_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     gate_convs.4.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:26:22 INFO     gate_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     gate_convs.5.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:26:22 INFO     gate_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     gate_convs.6.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:26:22 INFO     gate_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     gate_convs.7.weight	torch.Size([32, 32, 1, 2])	cuda:0	True
2024-09-27 22:26:22 INFO     gate_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     residual_convs.0.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     residual_convs.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     residual_convs.1.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     residual_convs.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     residual_convs.2.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     residual_convs.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     residual_convs.3.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     residual_convs.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     residual_convs.4.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     residual_convs.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     residual_convs.5.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     residual_convs.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     residual_convs.6.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     residual_convs.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     residual_convs.7.weight	torch.Size([32, 32, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     residual_convs.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     skip_convs.0.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     skip_convs.0.bias	torch.Size([256])	cuda:0	True
2024-09-27 22:26:22 INFO     skip_convs.1.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     skip_convs.1.bias	torch.Size([256])	cuda:0	True
2024-09-27 22:26:22 INFO     skip_convs.2.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     skip_convs.2.bias	torch.Size([256])	cuda:0	True
2024-09-27 22:26:22 INFO     skip_convs.3.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     skip_convs.3.bias	torch.Size([256])	cuda:0	True
2024-09-27 22:26:22 INFO     skip_convs.4.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     skip_convs.4.bias	torch.Size([256])	cuda:0	True
2024-09-27 22:26:22 INFO     skip_convs.5.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     skip_convs.5.bias	torch.Size([256])	cuda:0	True
2024-09-27 22:26:22 INFO     skip_convs.6.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     skip_convs.6.bias	torch.Size([256])	cuda:0	True
2024-09-27 22:26:22 INFO     skip_convs.7.weight	torch.Size([256, 32, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     skip_convs.7.bias	torch.Size([256])	cuda:0	True
2024-09-27 22:26:22 INFO     bn.0.weight	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     bn.0.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     bn.1.weight	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     bn.1.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     bn.2.weight	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     bn.2.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     bn.3.weight	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     bn.3.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     bn.4.weight	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     bn.4.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     bn.5.weight	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     bn.5.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     bn.6.weight	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     bn.6.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     bn.7.weight	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     bn.7.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     gconv.0.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     gconv.0.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     gconv.1.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     gconv.1.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     gconv.2.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     gconv.2.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     gconv.3.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     gconv.3.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     gconv.4.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     gconv.4.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     gconv.5.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     gconv.5.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     gconv.6.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     gconv.6.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     gconv.7.mlp.mlp.weight	torch.Size([32, 224, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     gconv.7.mlp.mlp.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     start_conv.weight	torch.Size([32, 2, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     start_conv.bias	torch.Size([32])	cuda:0	True
2024-09-27 22:26:22 INFO     end_conv_1.weight	torch.Size([512, 256, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     end_conv_1.bias	torch.Size([512])	cuda:0	True
2024-09-27 22:26:22 INFO     end_conv_2.weight	torch.Size([12, 512, 1, 1])	cuda:0	True
2024-09-27 22:26:22 INFO     end_conv_2.bias	torch.Size([12])	cuda:0	True
2024-09-27 22:26:22 INFO     Total parameter numbers: 306800
2024-09-27 22:26:22 INFO     You select `adam` optimizer.
2024-09-27 22:26:22 WARNING  Received none train loss func and will use the loss func defined in the model.
2024-09-27 22:26:22 INFO     Start training ...
2024-09-27 22:26:22 INFO     num_batches:96
2024-09-27 22:26:40 INFO     epoch complete!
2024-09-27 22:26:40 INFO     evaluating now!
2024-09-27 22:26:42 INFO     Epoch [0/200] train_loss: 12.3024, val_loss: 10.0108, lr: 0.001000, 20.07s
2024-09-27 22:26:42 INFO     Saved model at 0
2024-09-27 22:26:42 INFO     Val loss decrease from inf to 10.0108, saving to ./libcity/cache/104/model_cache/GWNET_CHITaxi20190406_epoch0.tar
2024-09-27 22:27:00 INFO     epoch complete!
2024-09-27 22:27:00 INFO     evaluating now!
2024-09-27 22:27:02 INFO     Epoch [1/200] train_loss: 9.3409, val_loss: 10.8411, lr: 0.001000, 19.65s
2024-09-27 22:27:19 INFO     epoch complete!
2024-09-27 22:27:19 INFO     evaluating now!
2024-09-27 22:27:21 INFO     Epoch [2/200] train_loss: 8.5152, val_loss: 8.7887, lr: 0.001000, 19.55s
2024-09-27 22:27:21 INFO     Saved model at 2
2024-09-27 22:27:21 INFO     Val loss decrease from 10.0108 to 8.7887, saving to ./libcity/cache/104/model_cache/GWNET_CHITaxi20190406_epoch2.tar
2024-09-27 22:27:39 INFO     epoch complete!
2024-09-27 22:27:39 INFO     evaluating now!
2024-09-27 22:27:41 INFO     Epoch [3/200] train_loss: 8.1531, val_loss: 10.4538, lr: 0.001000, 19.72s
2024-09-27 22:27:59 INFO     epoch complete!
2024-09-27 22:27:59 INFO     evaluating now!
2024-09-27 22:28:01 INFO     Epoch [4/200] train_loss: 7.9353, val_loss: 8.4263, lr: 0.001000, 19.66s
2024-09-27 22:28:01 INFO     Saved model at 4
2024-09-27 22:28:01 INFO     Val loss decrease from 8.7887 to 8.4263, saving to ./libcity/cache/104/model_cache/GWNET_CHITaxi20190406_epoch4.tar
2024-09-27 22:28:19 INFO     epoch complete!
2024-09-27 22:28:19 INFO     evaluating now!
2024-09-27 22:28:21 INFO     Epoch [5/200] train_loss: 7.7072, val_loss: 7.9748, lr: 0.001000, 19.90s
2024-09-27 22:28:21 INFO     Saved model at 5
2024-09-27 22:28:21 INFO     Val loss decrease from 8.4263 to 7.9748, saving to ./libcity/cache/104/model_cache/GWNET_CHITaxi20190406_epoch5.tar
2024-09-27 22:28:39 INFO     epoch complete!
2024-09-27 22:28:39 INFO     evaluating now!
2024-09-27 22:28:41 INFO     Epoch [6/200] train_loss: 7.5229, val_loss: 8.1024, lr: 0.001000, 19.70s
2024-09-27 22:28:59 INFO     epoch complete!
2024-09-27 22:28:59 INFO     evaluating now!
2024-09-27 22:29:00 INFO     Epoch [7/200] train_loss: 7.0615, val_loss: 7.7178, lr: 0.001000, 19.54s
2024-09-27 22:29:01 INFO     Saved model at 7
2024-09-27 22:29:01 INFO     Val loss decrease from 7.9748 to 7.7178, saving to ./libcity/cache/104/model_cache/GWNET_CHITaxi20190406_epoch7.tar
2024-09-27 22:29:18 INFO     epoch complete!
2024-09-27 22:29:18 INFO     evaluating now!
2024-09-27 22:29:20 INFO     Epoch [8/200] train_loss: 6.3870, val_loss: 8.9731, lr: 0.001000, 19.41s
2024-09-27 22:29:37 INFO     epoch complete!
2024-09-27 22:29:37 INFO     evaluating now!
2024-09-27 22:29:39 INFO     Epoch [9/200] train_loss: 5.9242, val_loss: 6.1106, lr: 0.001000, 19.16s
2024-09-27 22:29:39 INFO     Saved model at 9
2024-09-27 22:29:39 INFO     Val loss decrease from 7.7178 to 6.1106, saving to ./libcity/cache/104/model_cache/GWNET_CHITaxi20190406_epoch9.tar
2024-09-27 22:29:57 INFO     epoch complete!
2024-09-27 22:29:57 INFO     evaluating now!
2024-09-27 22:29:59 INFO     Epoch [10/200] train_loss: 5.8046, val_loss: 6.1699, lr: 0.001000, 19.66s
2024-09-27 22:30:17 INFO     epoch complete!
2024-09-27 22:30:17 INFO     evaluating now!
2024-09-27 22:30:19 INFO     Epoch [11/200] train_loss: 5.7815, val_loss: 6.3354, lr: 0.001000, 19.87s
2024-09-27 22:30:37 INFO     epoch complete!
2024-09-27 22:30:37 INFO     evaluating now!
2024-09-27 22:30:39 INFO     Epoch [12/200] train_loss: 5.5507, val_loss: 6.2995, lr: 0.001000, 19.61s
2024-09-27 22:30:56 INFO     epoch complete!
2024-09-27 22:30:56 INFO     evaluating now!
2024-09-27 22:30:58 INFO     Epoch [13/200] train_loss: 5.4598, val_loss: 7.3050, lr: 0.001000, 19.63s
2024-09-27 22:31:16 INFO     epoch complete!
2024-09-27 22:31:16 INFO     evaluating now!
2024-09-27 22:31:18 INFO     Epoch [14/200] train_loss: 5.6381, val_loss: 6.3286, lr: 0.001000, 20.06s
2024-09-27 22:31:36 INFO     epoch complete!
2024-09-27 22:31:36 INFO     evaluating now!
2024-09-27 22:31:38 INFO     Epoch [15/200] train_loss: 5.2833, val_loss: 6.7831, lr: 0.001000, 19.95s
2024-09-27 22:31:56 INFO     epoch complete!
2024-09-27 22:31:56 INFO     evaluating now!
2024-09-27 22:31:58 INFO     Epoch [16/200] train_loss: 5.2469, val_loss: 5.7383, lr: 0.001000, 19.85s
2024-09-27 22:31:58 INFO     Saved model at 16
2024-09-27 22:31:58 INFO     Val loss decrease from 6.1106 to 5.7383, saving to ./libcity/cache/104/model_cache/GWNET_CHITaxi20190406_epoch16.tar
2024-09-27 22:32:16 INFO     epoch complete!
2024-09-27 22:32:16 INFO     evaluating now!
2024-09-27 22:32:18 INFO     Epoch [17/200] train_loss: 5.2133, val_loss: 6.0151, lr: 0.001000, 19.69s
2024-09-27 22:32:36 INFO     epoch complete!
2024-09-27 22:32:36 INFO     evaluating now!
2024-09-27 22:32:38 INFO     Epoch [18/200] train_loss: 5.0546, val_loss: 5.5947, lr: 0.001000, 19.96s
2024-09-27 22:32:38 INFO     Saved model at 18
2024-09-27 22:32:38 INFO     Val loss decrease from 5.7383 to 5.5947, saving to ./libcity/cache/104/model_cache/GWNET_CHITaxi20190406_epoch18.tar
2024-09-27 22:32:56 INFO     epoch complete!
2024-09-27 22:32:56 INFO     evaluating now!
2024-09-27 22:32:58 INFO     Epoch [19/200] train_loss: 5.0619, val_loss: 5.6949, lr: 0.001000, 19.94s
2024-09-27 22:33:16 INFO     epoch complete!
2024-09-27 22:33:16 INFO     evaluating now!
2024-09-27 22:33:18 INFO     Epoch [20/200] train_loss: 4.8978, val_loss: 6.4398, lr: 0.001000, 19.91s
2024-09-27 22:33:36 INFO     epoch complete!
2024-09-27 22:33:36 INFO     evaluating now!
2024-09-27 22:33:38 INFO     Epoch [21/200] train_loss: 5.0466, val_loss: 5.6385, lr: 0.001000, 20.04s
2024-09-27 22:33:56 INFO     epoch complete!
2024-09-27 22:33:56 INFO     evaluating now!
2024-09-27 22:33:58 INFO     Epoch [22/200] train_loss: 4.8891, val_loss: 5.4197, lr: 0.001000, 19.93s
2024-09-27 22:33:58 INFO     Saved model at 22
2024-09-27 22:33:58 INFO     Val loss decrease from 5.5947 to 5.4197, saving to ./libcity/cache/104/model_cache/GWNET_CHITaxi20190406_epoch22.tar
2024-09-27 22:34:16 INFO     epoch complete!
2024-09-27 22:34:16 INFO     evaluating now!
2024-09-27 22:34:18 INFO     Epoch [23/200] train_loss: 4.8796, val_loss: 5.7436, lr: 0.001000, 20.01s
2024-09-27 22:34:36 INFO     epoch complete!
2024-09-27 22:34:36 INFO     evaluating now!
2024-09-27 22:34:38 INFO     Epoch [24/200] train_loss: 4.7931, val_loss: 5.6829, lr: 0.001000, 20.38s
2024-09-27 22:34:57 INFO     epoch complete!
2024-09-27 22:34:57 INFO     evaluating now!
2024-09-27 22:34:58 INFO     Epoch [25/200] train_loss: 4.8143, val_loss: 5.2553, lr: 0.001000, 20.10s
2024-09-27 22:34:59 INFO     Saved model at 25
2024-09-27 22:34:59 INFO     Val loss decrease from 5.4197 to 5.2553, saving to ./libcity/cache/104/model_cache/GWNET_CHITaxi20190406_epoch25.tar
2024-09-27 22:35:17 INFO     epoch complete!
2024-09-27 22:35:17 INFO     evaluating now!
2024-09-27 22:35:19 INFO     Epoch [26/200] train_loss: 4.7547, val_loss: 5.2845, lr: 0.001000, 20.30s
2024-09-27 22:35:37 INFO     epoch complete!
2024-09-27 22:35:37 INFO     evaluating now!
2024-09-27 22:35:39 INFO     Epoch [27/200] train_loss: 4.7387, val_loss: 5.8567, lr: 0.001000, 20.53s
2024-09-27 22:35:58 INFO     epoch complete!
2024-09-27 22:35:58 INFO     evaluating now!
2024-09-27 22:36:00 INFO     Epoch [28/200] train_loss: 4.6193, val_loss: 7.8225, lr: 0.001000, 20.70s
2024-09-27 22:36:19 INFO     epoch complete!
2024-09-27 22:36:19 INFO     evaluating now!
2024-09-27 22:36:21 INFO     Epoch [29/200] train_loss: 4.6477, val_loss: 5.5982, lr: 0.001000, 20.69s
2024-09-27 22:36:39 INFO     epoch complete!
2024-09-27 22:36:39 INFO     evaluating now!
2024-09-27 22:36:41 INFO     Epoch [30/200] train_loss: 4.5427, val_loss: 5.3234, lr: 0.001000, 20.60s
2024-09-27 22:37:00 INFO     epoch complete!
2024-09-27 22:37:00 INFO     evaluating now!
2024-09-27 22:37:02 INFO     Epoch [31/200] train_loss: 4.5299, val_loss: 5.5887, lr: 0.001000, 20.23s
2024-09-27 22:37:20 INFO     epoch complete!
2024-09-27 22:37:20 INFO     evaluating now!
2024-09-27 22:37:22 INFO     Epoch [32/200] train_loss: 4.6435, val_loss: 5.2668, lr: 0.001000, 20.42s
2024-09-27 22:37:41 INFO     epoch complete!
2024-09-27 22:37:41 INFO     evaluating now!
2024-09-27 22:37:43 INFO     Epoch [33/200] train_loss: 4.5888, val_loss: 5.3696, lr: 0.001000, 20.59s
2024-09-27 22:38:01 INFO     epoch complete!
2024-09-27 22:38:01 INFO     evaluating now!
2024-09-27 22:38:03 INFO     Epoch [34/200] train_loss: 4.4721, val_loss: 5.1808, lr: 0.001000, 20.77s
2024-09-27 22:38:04 INFO     Saved model at 34
2024-09-27 22:38:04 INFO     Val loss decrease from 5.2553 to 5.1808, saving to ./libcity/cache/104/model_cache/GWNET_CHITaxi20190406_epoch34.tar
2024-09-27 22:38:22 INFO     epoch complete!
2024-09-27 22:38:22 INFO     evaluating now!
2024-09-27 22:38:24 INFO     Epoch [35/200] train_loss: 4.4392, val_loss: 5.0267, lr: 0.001000, 20.44s
2024-09-27 22:38:24 INFO     Saved model at 35
2024-09-27 22:38:24 INFO     Val loss decrease from 5.1808 to 5.0267, saving to ./libcity/cache/104/model_cache/GWNET_CHITaxi20190406_epoch35.tar
2024-09-27 22:38:42 INFO     epoch complete!
2024-09-27 22:38:42 INFO     evaluating now!
2024-09-27 22:38:44 INFO     Epoch [36/200] train_loss: 4.4760, val_loss: 5.1031, lr: 0.001000, 20.29s
2024-09-27 22:39:03 INFO     epoch complete!
2024-09-27 22:39:03 INFO     evaluating now!
2024-09-27 22:39:05 INFO     Epoch [37/200] train_loss: 4.4643, val_loss: 5.5289, lr: 0.001000, 20.81s
2024-09-27 22:39:24 INFO     epoch complete!
2024-09-27 22:39:24 INFO     evaluating now!
2024-09-27 22:39:26 INFO     Epoch [38/200] train_loss: 4.4386, val_loss: 5.5889, lr: 0.001000, 20.77s
2024-09-27 22:39:44 INFO     epoch complete!
2024-09-27 22:39:44 INFO     evaluating now!
2024-09-27 22:39:47 INFO     Epoch [39/200] train_loss: 4.3905, val_loss: 5.2388, lr: 0.001000, 20.50s
2024-09-27 22:40:05 INFO     epoch complete!
2024-09-27 22:40:05 INFO     evaluating now!
2024-09-27 22:40:07 INFO     Epoch [40/200] train_loss: 4.3736, val_loss: 5.2474, lr: 0.001000, 20.83s
2024-09-27 22:40:26 INFO     epoch complete!
2024-09-27 22:40:26 INFO     evaluating now!
2024-09-27 22:40:28 INFO     Epoch [41/200] train_loss: 4.3647, val_loss: 4.6903, lr: 0.001000, 20.62s
2024-09-27 22:40:28 INFO     Saved model at 41
2024-09-27 22:40:28 INFO     Val loss decrease from 5.0267 to 4.6903, saving to ./libcity/cache/104/model_cache/GWNET_CHITaxi20190406_epoch41.tar
2024-09-27 22:40:47 INFO     epoch complete!
2024-09-27 22:40:47 INFO     evaluating now!
2024-09-27 22:40:49 INFO     Epoch [42/200] train_loss: 4.3151, val_loss: 4.8946, lr: 0.001000, 20.67s
2024-09-27 22:41:07 INFO     epoch complete!
2024-09-27 22:41:07 INFO     evaluating now!
2024-09-27 22:41:09 INFO     Epoch [43/200] train_loss: 4.2753, val_loss: 5.1491, lr: 0.001000, 20.62s
2024-09-27 22:41:28 INFO     epoch complete!
2024-09-27 22:41:28 INFO     evaluating now!
2024-09-27 22:41:30 INFO     Epoch [44/200] train_loss: 4.3062, val_loss: 4.7927, lr: 0.001000, 20.99s
2024-09-27 22:41:49 INFO     epoch complete!
2024-09-27 22:41:49 INFO     evaluating now!
2024-09-27 22:41:51 INFO     Epoch [45/200] train_loss: 4.3620, val_loss: 4.8262, lr: 0.001000, 20.86s
2024-09-27 22:42:10 INFO     epoch complete!
2024-09-27 22:42:10 INFO     evaluating now!
2024-09-27 22:42:12 INFO     Epoch [46/200] train_loss: 4.2497, val_loss: 5.5300, lr: 0.001000, 20.59s
2024-09-27 22:42:30 INFO     epoch complete!
2024-09-27 22:42:30 INFO     evaluating now!
2024-09-27 22:42:32 INFO     Epoch [47/200] train_loss: 4.2155, val_loss: 4.8894, lr: 0.001000, 20.62s
2024-09-27 22:42:51 INFO     epoch complete!
2024-09-27 22:42:51 INFO     evaluating now!
2024-09-27 22:42:53 INFO     Epoch [48/200] train_loss: 4.1915, val_loss: 4.7382, lr: 0.001000, 20.81s
2024-09-27 22:43:12 INFO     epoch complete!
2024-09-27 22:43:12 INFO     evaluating now!
2024-09-27 22:43:14 INFO     Epoch [49/200] train_loss: 4.1853, val_loss: 5.1076, lr: 0.001000, 20.81s
2024-09-27 22:43:33 INFO     epoch complete!
2024-09-27 22:43:33 INFO     evaluating now!
2024-09-27 22:43:35 INFO     Epoch [50/200] train_loss: 4.1865, val_loss: 5.0951, lr: 0.001000, 20.84s
2024-09-27 22:43:54 INFO     epoch complete!
2024-09-27 22:43:54 INFO     evaluating now!
2024-09-27 22:43:56 INFO     Epoch [51/200] train_loss: 4.1542, val_loss: 4.9876, lr: 0.001000, 20.94s
2024-09-27 22:44:15 INFO     epoch complete!
2024-09-27 22:44:15 INFO     evaluating now!
2024-09-27 22:44:17 INFO     Epoch [52/200] train_loss: 4.1156, val_loss: 4.7681, lr: 0.001000, 20.84s
2024-09-27 22:44:36 INFO     epoch complete!
2024-09-27 22:44:36 INFO     evaluating now!
2024-09-27 22:44:38 INFO     Epoch [53/200] train_loss: 4.1530, val_loss: 4.9518, lr: 0.001000, 20.86s
2024-09-27 22:44:56 INFO     epoch complete!
2024-09-27 22:44:56 INFO     evaluating now!
2024-09-27 22:44:58 INFO     Epoch [54/200] train_loss: 4.1039, val_loss: 4.8785, lr: 0.001000, 20.85s
2024-09-27 22:45:17 INFO     epoch complete!
2024-09-27 22:45:17 INFO     evaluating now!
2024-09-27 22:45:19 INFO     Epoch [55/200] train_loss: 4.1036, val_loss: 4.8628, lr: 0.001000, 20.62s
2024-09-27 22:45:38 INFO     epoch complete!
2024-09-27 22:45:38 INFO     evaluating now!
2024-09-27 22:45:40 INFO     Epoch [56/200] train_loss: 4.1074, val_loss: 5.2965, lr: 0.001000, 20.61s
2024-09-27 22:45:40 WARNING  Early stopping at epoch: 56
2024-09-27 22:45:40 INFO     Trained totally 57 epochs, average train time is 18.292s, average eval time is 1.980s
2024-09-27 22:45:40 INFO     Loaded model at 41
2024-09-27 22:45:40 INFO     Saved model at ./libcity/cache/104/model_cache/GWNET_CHITaxi20190406.m
2024-09-27 22:45:40 INFO     Start evaluating ...
2024-09-27 22:45:45 INFO     Note that you select the single mode to evaluate!
2024-09-27 22:45:45 INFO     Evaluate result is saved at ./libcity/cache/104/evaluate_cache/2024_09_27_22_45_45_GWNET_CHITaxi20190406.csv
2024-09-27 22:45:45 INFO     
         MAE       RMSE  masked_MAPE
1   2.281254   6.821905     0.370366
2   2.346876   7.609251     0.360841
3   2.496656   8.508824     0.366618
4   2.573183   9.003164     0.372586
5   2.653471   9.467945     0.385471
6   2.736904   9.763226     0.391554
7   2.806358  10.091213     0.392925
8   2.916924  10.445276     0.391284
9   2.893861  10.764869     0.411902
10  2.991219  10.982903     0.397227
11  3.047562  11.359650     0.393363
12  3.197702  11.930840     0.400167
2024-09-27 22:45:45 INFO     ----------------------------------------------------------------------------
2024-09-27 22:45:45 INFO     Kownledge Graph Embedding: None, Experiment ids: [100, 101, 102, 103, 104]
2024-09-27 22:45:45 INFO     ----------------------------------------------------------------------------
2024-09-27 22:45:45 INFO     Average: 
         MAE       RMSE  masked_MAPE
0   2.290520   7.002888     0.360556
1   2.419640   7.852164     0.357864
2   2.580915   8.695115     0.370248
3   2.725739   9.463167     0.374927
4   2.852153  10.225450     0.375181
5   2.982362  10.968868     0.375231
6   3.083922  11.727688     0.379756
7   3.201276  12.233668     0.381994
8   3.219987  12.397249     0.385951
9   3.253461  12.419565     0.384691
10  3.308279  12.572606     0.392786
11  3.380703  12.947910     0.399271 
2024-09-27 22:45:45 INFO     Standard deviation: 
         MAE      RMSE  masked_MAPE
0   0.115629  0.448623     0.018137
1   0.090812  0.296516     0.014273
2   0.085098  0.210894     0.008773
3   0.131232  0.349569     0.010855
4   0.134024  0.586905     0.016396
5   0.182853  1.002942     0.017039
6   0.197174  1.299957     0.019662
7   0.204809  1.386710     0.017796
8   0.196769  1.194256     0.020618
9   0.158273  0.921515     0.020785
10  0.157950  0.764195     0.013934
11  0.114224  0.666166     0.017645
2024-09-27 22:45:45 INFO     ----------------------------------------------------------------------------
2024-09-27 22:45:45 INFO     12 steps Average: 
       MAE       RMSE  masked_MAPE
0  2.94158  10.708861     0.378205
2024-09-27 22:45:45 INFO     12 steps Standard deviation: 
        MAE      RMSE  masked_MAPE
0  0.147404  0.760687     0.016326
